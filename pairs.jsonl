{"id": "APMO-2016-1", "contest": "APMO", "year": "2016", "problem_number": "1", "problem": "We say that a triangle \\(A B C\\) is great if the following holds: for any point \\(D\\) on the side \\(B C\\), if \\(P\\) and \\(Q\\) are the feet of the perpendiculars from \\(D\\) to the lines \\(A B\\) and \\(A C\\), respectively, then the reflection of \\(D\\) in the line \\(P Q\\) lies on the circumcircle of the triangle \\(A B C\\).\n\nProve that triangle \\(A B C\\) is great if and only if \\(\\angle A=90^{\\circ}\\) and \\(A B=A C\\).", "solution": "Solution. For every point \\(D\\) on the side \\(B C\\), let \\(D^{\\prime}\\) be the reflection of \\(D\\) in the line \\(P Q\\). We will first prove that if the triangle satisfies the condition then it is isosceles and right-angled at \\(A\\).\n\nChoose \\(D\\) to be the point where the angle bisector from \\(A\\) meets \\(B C\\). Note that \\(P\\) and \\(Q\\) lie on the rays \\(A B\\) and \\(A C\\) respectively. Furthermore, \\(P\\) and \\(Q\\) are reflections of each other in the line \\(A D\\), from which it follows that \\(P Q \\perp A D\\). Therefore, \\(D^{\\prime}\\) lies on the line \\(A D\\) and we may deduce that either \\(D^{\\prime}=A\\) or \\(D^{\\prime}\\) is the second point of the angle bisector at \\(A\\) and the circumcircle of \\(A B C\\). However, since \\(A P D Q\\) is a cyclic quadrilateral, the segment \\(P Q\\) intersects the segment \\(A D\\). Therefore, \\(D^{\\prime}\\) lies on the ray \\(D A\\) and therefore \\(D^{\\prime}=A\\). By angle chasing we obtain\n\\[\n\\angle P D^{\\prime} Q=\\angle P D Q=180^{\\circ}-\\angle B A C\n\\]\nand since \\(D^{\\prime}=A\\) we also know \\(\\angle P D^{\\prime} Q=\\angle B A C\\). This implies that \\(\\angle B A C=90^{\\circ}\\).\nNow we choose \\(D\\) to be the midpoint of \\(B C\\). Since \\(\\angle B A C=90^{\\circ}\\), we can deduce that \\(D Q P\\) is the medial triangle of triangle \\(A B C\\). Therefore, \\(P Q \\| B C\\) from which it follows that \\(D D^{\\prime} \\perp B C\\). But the distance from \\(D^{\\prime}\\) to \\(B C\\) is equal to both the circumradius of triangle \\(A B C\\) and to the distance from \\(A\\) to \\(B C\\). This can only happen if \\(A=D^{\\prime}\\). This implies that \\(A B C\\) is isosceles and right-angled at \\(A\\).\n![](https://cdn.mathpix.com/cropped/2025_08_23_0d61d483ddc68168f14bg-1.jpg?height=438&width=1629&top_left_y=1570&top_left_x=239)\n\nWe will now prove that if \\(A B C\\) is isosceles and right-angled at \\(A\\) then the required property in the problem holds. Let \\(D\\) be any point on side \\(B C\\). Then \\(D^{\\prime} P=D P\\) and we also have \\(D P=B P\\). Hence, \\(D^{\\prime} P=B P\\) and similarly \\(D^{\\prime} Q=C Q\\). Note that \\(A P D Q D^{\\prime}\\) is cyclic with diameter \\(P Q\\). Therefore, \\(\\angle A P D^{\\prime}=\\angle A Q D^{\\prime}\\), from which we obtain \\(\\angle B P D^{\\prime}=\\angle C Q D^{\\prime}\\). So triangles \\(D^{\\prime} P B\\) and \\(D^{\\prime} Q C\\) are similar. It follows that \\(\\angle P D^{\\prime} Q=\\angle P D^{\\prime} C+\\angle C D^{\\prime} Q= \\angle P D^{\\prime} C+\\angle B D^{\\prime} P=\\angle B D^{\\prime} C\\) and \\(\\frac{D^{\\prime} P}{D^{\\prime} Q}=\\frac{D^{\\prime} B}{D^{\\prime} C}\\). So we also obtain that triangles \\(D^{\\prime} P Q\\) and \\(D^{\\prime} B C\\) are similar. But since \\(D P Q\\) and \\(D^{\\prime} P Q\\) are congruent, we may deduce that \\(\\angle B D^{\\prime} C= \\angle P D^{\\prime} Q=\\angle P D Q=90^{\\circ}\\). Therefore, \\(D^{\\prime}\\) lies on the circle with diameter \\(B C\\), which is the circumcircle of triangle \\(A B C\\).", "source_pdf": "apmo_2016.pdf", "notes": ""}
{"id": "APMO-2016-2", "contest": "APMO", "year": "2016", "problem_number": "2", "problem": "A positive integer is called fancy if it can be expressed in the form\n\\[\n2^{a_{1}}+2^{a_{2}}+\\cdots+2^{a_{100}}\n\\]\nwhere \\(a_{1}, a_{2}, \\ldots, a_{100}\\) are non-negative integers that are not necessarily distinct.\nFind the smallest positive integer \\(n\\) such that no multiple of \\(n\\) is a fancy number.\nAnswer: The answer is \\(n=2^{101}-1\\).", "solution": "Solution. Let \\(k\\) be any positive integer less than \\(2^{101}-1\\). Then \\(k\\) can be expressed in binary notation using at most 100 ones, and therefore there exists a positive integer \\(r\\) and non-negative integers \\(a_{1}, a_{2}, \\ldots, a_{r}\\) such that \\(r \\leq 100\\) and \\(k=2^{a_{1}}+\\cdots+2^{a_{r}}\\). Notice that for a positive integer \\(s\\) we have:\n\\[\n\\begin{aligned}\n2^{s} k & =2^{a_{1}+s}+2^{a_{2}+s}+\\cdots+2^{a_{r-1}+s}+\\left(1+1+2+\\cdots+2^{s-1}\\right) 2^{a_{r}} \\\\\n& =2^{a_{1}+s}+2^{a_{2}+s}+\\cdots+2^{a_{r-1}+s}+2^{a_{r}}+2^{a_{r}}+\\cdots+2^{a_{r}+s-1}\n\\end{aligned}\n\\]\n\nThis shows that \\(k\\) has a multiple that is a sum of \\(r+s\\) powers of two. In particular, we may take \\(s=100-r \\geq 0\\), which shows that \\(k\\) has a multiple that is a fancy number.\n\nWe will now prove that no multiple of \\(n=2^{101}-1\\) is a fancy number. In fact we will prove a stronger statement, namely, that no multiple of \\(n\\) can be expressed as the sum of at most 100 powers of 2 .\n\nFor the sake of contradiction, suppose that there exists a positive integer \\(c\\) such that \\(c n\\) is the sum of at most 100 powers of 2 . We may assume that \\(c\\) is the smallest such integer. By repeatedly merging equal powers of two in the representation of \\(c n\\) we may assume that\n\\[\nc n=2^{a_{1}}+2^{a_{2}}+\\cdots+2^{a_{r}}\n\\]\nwhere \\(r \\leq 100\\) and \\(a_{1}<a_{2}<\\ldots<a_{r}\\) are distinct non-negative integers. Consider the following two cases:\n- If \\(a_{r} \\geq 101\\), then \\(2^{a_{r}}-2^{a_{r}-101}=2^{a_{r}-101} n\\). It follows that \\(2^{a_{1}}+2^{a_{2}}+\\cdots+2^{a_{r-1}}+2^{a_{r}-101}\\) would be a multiple of \\(n\\) that is smaller than \\(c n\\). This contradicts the minimality of \\(c\\).\n- If \\(a_{r} \\leq 100\\), then \\(\\left\\{a_{1}, \\ldots, a_{r}\\right\\}\\) is a proper subset of \\(\\{0,1, \\ldots, 100\\}\\). Then\n\\[\nn \\leq c n<2^{0}+2^{1}+\\cdots+2^{100}=n\n\\]\n\nThis is also a contradiction.\nFrom these contradictions we conclude that it is impossible for \\(c n\\) to be the sum of at most 100 powers of 2 . In particular, no multiple of \\(n\\) is a fancy number.", "source_pdf": "apmo_2016.pdf", "notes": ""}
{"id": "APMO-2016-3", "contest": "APMO", "year": "2016", "problem_number": "3", "problem": "Let \\(A B\\) and \\(A C\\) be two distinct rays not lying on the same line, and let \\(\\omega\\) be a circle with center \\(O\\) that is tangent to ray \\(A C\\) at \\(E\\) and ray \\(A B\\) at \\(F\\). Let \\(R\\) be a point on segment \\(E F\\). The line through \\(O\\) parallel to \\(E F\\) intersects line \\(A B\\) at \\(P\\). Let \\(N\\) be the intersection of lines \\(P R\\) and \\(A C\\), and let \\(M\\) be the intersection of line \\(A B\\) and the line through \\(R\\) parallel to \\(A C\\). Prove that line \\(M N\\) is tangent to \\(\\omega\\).", "solution": "Solution. We present two approaches. The first one introduces an auxiliary point and studies similarities in the figure. The second one reduces the problem to computations involving a particular exradius of a triangle. The second approach has two variants.\n\n\\section*{Solution 1.}\n![](https://cdn.mathpix.com/cropped/2025_08_23_0d61d483ddc68168f14bg-3.jpg?height=974&width=1200&top_left_y=254&top_left_x=425)\n\nLet the line through \\(N\\) tangent to \\(\\omega\\) at point \\(X \\neq E\\) intersect \\(A B\\) at point \\(M^{\\prime}\\). It suffices to show that \\(M^{\\prime} R \\| A C\\), since this would yield \\(M^{\\prime}=M\\).\n\nSuppose that the line \\(P O\\) intersects \\(A C\\) at \\(Q\\) and the circumcircle of \\(A M^{\\prime} O\\) at \\(Y\\), respectively. Then\n\\[\n\\angle A Y M^{\\prime}=\\angle A O M^{\\prime}=90^{\\circ}-\\angle M^{\\prime} O P .\n\\]\n\nBy angle chasing we have \\(\\angle E O Q=\\angle F O P=90^{\\circ}-\\angle A O F=\\angle M^{\\prime} A O=\\angle M^{\\prime} Y P\\) and by symmetry \\(\\angle E Q O=\\angle M^{\\prime} P Y\\). Therefore \\(\\triangle M^{\\prime} Y P \\sim \\triangle E O Q\\).\n\nOn the other hand, we have\n\\[\n\\begin{aligned}\n\\angle M^{\\prime} O P & =\\angle M^{\\prime} O F+\\angle F O P=\\frac{1}{2}(\\angle F O X+\\angle F O P+\\angle E O Q)= \\\\\n& =\\frac{1}{2}\\left(\\frac{180^{\\circ}-\\angle X O E}{2}\\right)=90^{\\circ}-\\frac{\\angle X O E}{2} .\n\\end{aligned}\n\\]\n\nSince we know that \\(\\angle A Y M^{\\prime}\\) and \\(\\angle M^{\\prime} O P\\) are complementary this implies\n\\[\n\\angle A Y M^{\\prime}=\\frac{\\angle X O E}{2}=\\angle N O E .\n\\]\n\nTherefore, \\(\\angle A Y M^{\\prime}\\) and \\(\\angle N O E\\) are congruent angles, and this means that \\(A\\) and \\(N\\) are corresponding points in the similarity of triangles \\(\\triangle M^{\\prime} Y P\\) and \\(\\triangle E O Q\\). It follows that\n\\[\n\\frac{A M^{\\prime}}{M^{\\prime} P}=\\frac{N E}{E Q}=\\frac{N R}{R P} .\n\\]\n\nWe conclude that \\(M^{\\prime} R \\| A C\\), as desired.\n\n\\section*{Solution 2a.}\n\nAs in Solution 1, we introduce point \\(M^{\\prime}\\) and reduce the problem to proving \\(\\frac{P R}{R N}=\\frac{P M^{\\prime}}{M^{\\prime} A}\\). Menelaus theorem in triangle \\(A N P\\) with transversal line \\(F R E\\) yields\n\\[\n\\frac{P R}{R N} \\cdot \\frac{N E}{E A} \\cdot \\frac{A F}{F P}=1 .\n\\]\n\nSince \\(A F=E A\\), we have \\(\\frac{F P}{N E}=\\frac{P R}{R N}\\), so that it suffices to prove\n\\[\n\\frac{F P}{N E}=\\frac{P M^{\\prime}}{M^{\\prime} A} .\n\\]\n\nThis is a computation regarding the triangle \\(A M^{\\prime} N\\) and its excircle opposite \\(A\\). Indeed, setting \\(a=M^{\\prime} N, b=N A, c=M^{\\prime} A, s=\\frac{a+b+c}{2}, x=s-a, y=s-b\\) and \\(z=s-c\\), then \\(A E=A F=s, M^{\\prime} F=z\\) and \\(N E=y\\). From \\(\\triangle O F P \\sim \\triangle A F O\\) we have \\(F P=\\frac{r_{a}^{2}}{s}\\), where \\(r_{a}=O F\\) is the exradius opposite \\(A\\). Combining the following two standard formulas for the area of a triangle\n\\[\n\\left|A M^{\\prime} N\\right|^{2}=x y z s \\quad \\text { (Heron's formula) and } \\quad\\left|A M^{\\prime} N\\right|=r_{a}(s-a),\n\\]\nwe have \\(r_{a}^{2}=\\frac{y z s}{x}\\). Therefore, \\(F P=\\frac{y z}{x}\\). We can now write everything in (1) in terms of \\(x, y, z\\). We conclude that we have to verify\n\\[\n\\frac{\\frac{y z}{x}}{y}=\\frac{z+\\frac{y z}{x}}{x+y},\n\\]\nwhich is easily seen to be true.\nNote: Antoher approach using Menalaus theorem is to construct the tangent from \\(M\\) to create a point \\(N^{\\prime}\\) in \\(A C\\) and then prove, using the theorem, that \\(P, R\\) and \\(N^{\\prime}\\) are collinear. This also reduces to an algebraic identity.\n\n\\section*{Solution 2b.}\n\nAs in Solution 1, we introduce point \\(M^{\\prime}\\). Let the line through \\(M^{\\prime}\\) and parallel to \\(A N\\) intersect \\(E F\\) at \\(R^{\\prime}\\). Let \\(P^{\\prime}\\) be the intersection of lines \\(N R^{\\prime}\\) and \\(A M\\). It suffices to show that \\(P^{\\prime} O \\| F E\\), since this would yield \\(P=P^{\\prime}\\), and then \\(R=R^{\\prime}\\) and \\(M=M^{\\prime}\\). Hence it is enough to prove that\n\\[\n\\frac{A F}{F P^{\\prime}}=\\frac{A D}{D O},\n\\]\nwhere \\(D\\) is the intersection of \\(A O\\) and \\(E F\\). Once again, this reduces to a computation regarding the triangle \\(A M^{\\prime} N\\) and its excircle opposite \\(A\\).\n\nLet \\(u=P^{\\prime} F\\) and \\(x, y, z, s\\) as in Solution 2a. Note that since \\(A E=A F\\) and \\(M^{\\prime} R^{\\prime} \\| A E\\), we have \\(M^{\\prime} R^{\\prime}=M^{\\prime} F=z\\). Since \\(M^{\\prime} R^{\\prime} \\| A N\\), we have \\(\\frac{P^{\\prime} M^{\\prime}}{P^{\\prime} A}=\\frac{M^{\\prime} R^{\\prime}}{N A}\\), that is,\n\\[\n\\frac{u+z}{u+x+y+z}=\\frac{z}{x+z} .\n\\]\n\nFrom this last equation we obtain \\(u=\\frac{y z}{x}\\). Hence \\(\\frac{A F}{F P^{\\prime}}=\\frac{x s}{y z}\\). Also, as in Solution 2a, we have \\(r_{a}^{2}=\\frac{y z s}{x}\\).\n\nFinally, using similar triangles \\(O D F, F D A\\) and \\(O F A\\), and the above equalities, we have\n\\[\n\\frac{A D}{D O}=\\frac{A D}{D F} \\cdot \\frac{D F}{D O}=\\frac{A F}{O F} \\cdot \\frac{A F}{O F}=\\frac{s^{2}}{r_{a}^{2}}=\\frac{s^{2}}{\\frac{y z s}{x}}=\\frac{x s}{y z}=\\frac{A F}{F P^{\\prime}},\n\\]\nas required.", "source_pdf": "apmo_2016.pdf", "notes": ""}
{"id": "APMO-2016-4", "contest": "APMO", "year": "2016", "problem_number": "4", "problem": "The country Dreamland consists of 2016 cities. The airline Starways wants to establish some one-way flights between pairs of cities in such a way that each city has exactly one flight out of it. Find the smallest positive integer \\(k\\) such that no matter how Starways establishes its flights, the cities can always be partitioned into \\(k\\) groups so that from any city it is not possible to reach another city in the same group by using at most 28 flights.\n\n\\section*{Answer: 57}", "solution": "Solution. The flights established by Starways yield a directed graph \\(G\\) on 2016 vertices in which each vertex has out-degree equal to 1 .\n\nWe first show that we need at least 57 groups. For this, suppose that \\(G\\) has a directed cycle of length 57. Then, for any two cities in the cycle, one is reachable from the other using at most 28 flights. So no two cities in the cycle can belong to the same group. Hence, we need at least 57 groups.\n\nWe will now show that 57 groups are enough. Consider another auxiliary directed graph \\(H\\) in which the vertices are the cities of Dreamland and there is an arrow from city \\(u\\) to city \\(v\\) if \\(u\\) can be reached from \\(v\\) using at most 28 flights. Each city has out-degree at most 28 . We will be done if we can split the cities of \\(H\\) in at most 57 groups such that there are no arrows between vertices of the same group. We prove the following stronger statement.\n\nLemma: Suppose we have a directed graph on \\(n \\geq 1\\) vertices such that each vertex has out-degree at most 28 . Then the vertices can be partitioned into 57 groups in such a way that no vertices in the same group are connected by an arrow.\n\nProof: We apply induction. The result is clear for 1 vertex. Now suppose we have more than one vertex. Since the out-degree of each vertex is at most 28 , there is a vertex, say \\(v\\), with in-degree at most 28. If we remove the vertex \\(v\\) we obtain a graph with fewer vertices which still satifies the conditions, so by inductive hypothesis we may split it into at most 57 groups with no adjacent vertices in the same group. Since \\(v\\) has in-degree and out-degree at most 28, it has at most 56 neighboors in the original directed graph. Therefore, we may add \\(v\\) back and place it in a group in which it has no neighbors. This completes the inductive step.", "source_pdf": "apmo_2016.pdf", "notes": ""}
{"id": "APMO-2016-5", "contest": "APMO", "year": "2016", "problem_number": "5", "problem": "Find all functions \\(f: \\mathbb{R}^{+} \\rightarrow \\mathbb{R}^{+}\\)such that\n\\[\n(z+1) f(x+y)=f(x f(z)+y)+f(y f(z)+x)\n\\]\nfor all positive real numbers \\(x, y, z\\).\nAnswer: The only solution is \\(f(x)=x\\) for all positive real numbers \\(x\\).", "solution": "Solution. The identity function \\(f(x)=x\\) clearly satisfies the functional equation. Now, let \\(f\\) be a function satisfying the functional equation. Plugging \\(x=y=1\\) into (3) we get \\(2 f(f(z)+1)=(z+1)(f(2))\\) for all \\(z \\in \\mathbb{R}^{+}\\). Hence, \\(f\\) is not bounded above.\n\nLemma. Let \\(a, b, c\\) be positive real numbers. If \\(c\\) is greater than \\(1, a / b\\) and \\(b / a\\), then the system of linear equations\n\\[\nc u+v=a \\quad u+c v=b\n\\]\nhas a positive real solution \\(u, v\\).\nProof. The solution is\n\\[\nu=\\frac{c a-b}{c^{2}-1} \\quad v=\\frac{c b-a}{c^{2}-1}\n\\]\n\nThe numbers \\(u\\) and \\(v\\) are positive if the conditions on \\(c\\) above are satisfied.\n\nWe will now prove that\n\\[\nf(a)+f(b)=f(c)+f(d) \\quad \\text { for all } a, b, c, d \\in \\mathbb{R}^{+} \\text {with } a+b=c+d\n\\]\n\nConsider \\(a, b, c, d \\in \\mathbb{R}^{+}\\)such that \\(a+b=c+d\\). Since \\(f\\) is not bounded above, we can choose a positive number \\(e\\) such that \\(f(e)\\) is greater than \\(1, a / b, b / a, c / d\\) and \\(d / c\\). Using the above lemma, we can find \\(u, v, w, t \\in \\mathbb{R}^{+}\\)satisfying\n\\[\n\\begin{array}{ll}\nf(e) u+v=a, & u+f(e) v=b \\\\\nf(e) w+t=c, & w+f(e) t=d .\n\\end{array}\n\\]\n\nNote that \\(u+v=w+t\\) since \\((u+v)(f(e)+1)=a+b\\) and \\((w+t)(f(e)+1)=c+d\\). Plugging \\(x=u, y=v\\) and \\(z=e\\) into (3) yields \\(f(a)+f(b)=(e+1) f(u+v)\\). Similarly, we have \\(f(c)+f(d)=(e+1) f(w+t)\\). The claim follows immediately.\n\nWe then have\n\\[\ny f(x)=f(x f(y)) \\quad \\text { for all } x, y \\in \\mathbb{R}^{+}\n\\]\nsince by (3) and (4),\n\\[\n(y+1) f(x)=f\\left(\\frac{x}{2} f(y)+\\frac{x}{2}\\right)+f\\left(\\frac{x}{2} f(y)+\\frac{x}{2}\\right)=f(x f(y))+f(x)\n\\]\n\nNow, let \\(a=f(1 / f(1))\\). Plugging \\(x=1\\) and \\(y=1 / f(1)\\) into (5) yields \\(f(a)=1\\). Hence \\(a=a f(a)\\) and \\(f(a f(a))=f(a)=1\\). Since \\(a f(a)=f(a f(a))\\) by (5), we have \\(f(1)=a=1\\). It follows from (5) that\n\\[\nf(f(y))=y \\quad \\text { for all } y \\in \\mathbb{R}^{+} .\n\\]\n\nUsing (4) we have for all \\(x, y \\in \\mathbb{R}^{+}\\)that\n\\[\n\\begin{aligned}\n& f(x+y)+f(1)=f(x)+f(y+1), \\quad \\text { and } \\\\\n& f(y+1)+f(1)=f(y)+f(2)\n\\end{aligned}\n\\]\n\nTherefore\n\\[\nf(x+y)=f(x)+f(y)+b \\quad \\text { for all } x, y \\in \\mathbb{R}^{+}\n\\]\nwhere \\(b=f(2)-2 f(1)=f(2)-2\\). Using (5), (7) and (6), we get\n\\[\n4+2 b=2 f(2)=f(2 f(2))=f(f(2)+f(2))=f(f(2))+f(f(2))+b=4+b\n\\]\n\nThis shows that \\(b=0\\) and thus\n\\[\nf(x+y)=f(x)+f(y) \\quad \\text { for all } x, y \\in \\mathbb{R}^{+} .\n\\]\n\nIn particular, \\(f\\) is strictly increasing.\nWe conclude as follows. Take any positive real number \\(x\\). If \\(f(x)>x\\), then \\(f(f(x))> f(x)>x=f(f(x))\\), a contradiction. Similarly, it is not possible that \\(f(x)<x\\). This shows that \\(f(x)=x\\) for all positive real numbers \\(x\\).", "source_pdf": "apmo_2016.pdf", "notes": ""}
{"id": "APMO-2018-1", "contest": "APMO", "year": "2018", "problem_number": "1", "problem": "Let \\(H\\) be the orthocenter of the triangle \\(A B C\\). Let \\(M\\) and \\(N\\) be the midpoints of the sides \\(A B\\) and \\(A C\\), respectively. Assume that \\(H\\) lies inside the quadrilateral \\(B M N C\\) and that the circumcircles of triangles \\(B M H\\) and \\(C N H\\) are tangent to each other. The line through \\(H\\) parallel to \\(B C\\) intersects the circumcircles of the triangles \\(B M H\\) and \\(C N H\\) in the points \\(K\\) and \\(L\\), respectively. Let \\(F\\) be the intersection point of \\(M K\\) and \\(N L\\) and let \\(J\\) be the incenter of triangle \\(M H N\\). Prove that \\(F J=F A\\).", "solution": "\\section*{Solution.}\n\nLemma 1. In a triangle \\(A B C\\), let \\(D\\) be the intersection of the interior angle bisector at \\(A\\) with the circumcircle of \\(A B C\\), and let \\(I\\) be the incenter of \\(\\triangle A B C\\). Then\n\\[\nD I=D B=D C .\n\\]\n![](https://cdn.mathpix.com/cropped/2025_08_23_94f4f829fd174a5ca813g-1.jpg?height=632&width=609&top_left_y=948&top_left_x=731)\n\nProof.\n\\[\n\\angle D B I=\\frac{\\angle B A C}{2}+\\frac{\\widehat{B}}{2}=\\angle D I B \\quad \\Rightarrow \\quad D I=D B\n\\]\n\nAnalogously \\(D I=D C\\).\nWe start solving the problem. First we state some position considerations. Since there is an arc of the circumcircle of \\(B H M\\) outside the triangle \\(A B C\\), it must happen that \\(K\\) and \\(N\\) lie on opposite sides of \\(A M\\). Similarly, \\(L\\) and \\(M\\) lie on opposite sides of \\(A N\\). Also, \\(K\\) and \\(L\\) lie on the same side of \\(M N\\), and opposite to \\(A\\). Therefore, \\(F\\) lies inside the triangle \\(A M N\\).\n\nNow, since \\(H\\) is the orthocenter of \\(\\triangle A B C\\) and the circumcircles of \\(B M H\\) and \\(C N H\\) are tangent we have\n\\[\n\\angle A B H=90^{\\circ}-\\angle B A C=\\angle A C H \\quad \\Rightarrow \\quad \\angle M H N=\\angle M B H+\\angle N C H=180^{\\circ}-2 \\angle B A C .\n\\]\n\nSo \\(\\angle M B H=\\angle M K H=\\angle N C H=\\angle N L H=90^{\\circ}-\\angle B A C\\) and, since \\(M N \\| K L\\), we have\n\\[\n\\angle F M N=\\angle F N M=90^{\\circ}-\\angle B A C \\quad \\Rightarrow \\quad \\angle M F N=2 \\angle B A C\n\\]\n\nThe relations (1) and (2) yield that the quadrilateral \\(M F N H\\) is cyclic, with the vertices in this order around the circumference. Since \\(F M=F N, \\angle M F N=2 \\angle B A C\\) and \\(F\\) is the correct side of \\(M N\\) we have that the point \\(F\\) is the circumcenter of triangle \\(A M N\\), and thus \\(F A=F M=F N\\).\n![](https://cdn.mathpix.com/cropped/2025_08_23_94f4f829fd174a5ca813g-2.jpg?height=786&width=1020&top_left_y=188&top_left_x=525)\n\nSince the quadrilateral \\(M F N H\\) is cyclic, \\(F M=F N\\) and \\(H\\) lies on the correct side of \\(M N\\), we have that \\(H, J\\) and \\(F\\) are collinear. According to Lemma \\(1, F J=F M=F N\\). So \\(F J=F A\\).\n\nSolution 2: According to Solution 1, we have \\(\\angle M H N=180^{\\circ}-2 \\angle B A C\\) and since the point \\(J\\) is the incenter of \\(\\triangle M H N\\), we have \\(\\angle M J N=90^{\\circ}+\\frac{1}{2} \\angle M H N=180^{\\circ}-\\angle B A C\\). So the quadrilateral \\(A M J N\\) is cyclic.\n\nAccording to Solution 1, the point \\(F\\) is the circumcenter of \\(\\triangle A M N\\). So \\(F J=F A\\).", "source_pdf": "apmo_2018.pdf", "notes": ""}
{"id": "APMO-2018-2", "contest": "APMO", "year": "2018", "problem_number": "2", "problem": "Let \\(f(x)\\) and \\(g(x)\\) be given by\n\\[\nf(x)=\\frac{1}{x}+\\frac{1}{x-2}+\\frac{1}{x-4}+\\cdots+\\frac{1}{x-2018}\n\\]\nand\n\\[\ng(x)=\\frac{1}{x-1}+\\frac{1}{x-3}+\\frac{1}{x-5}+\\cdots+\\frac{1}{x-2017} .\n\\]\n\nProve that\n\\[\n|f(x)-g(x)|>2\n\\]\nfor any non-integer real number \\(x\\) satisfying \\(0<x<2018\\).", "solution": "Solution 1 There are two cases: \\(2 n-1<x<2 n\\) and \\(2 n<x<2 n+1\\). Note that \\(f(2018-x)=-f(x)\\) and \\(g(2018-x)=-g(x)\\), that is, a half turn about the point \\((1009,0)\\) preserves the graphs of \\(f\\) and \\(g\\). So it suffices to consider only the case \\(2 n-1<x<2 n\\).\n\nLet \\(d(x)=g(x)-f(x)\\). We will show that \\(d(x)>2\\) whenever \\(2 n-1<x<2 n\\) and \\(n \\in\\{1,2, \\ldots, 1009\\}\\).\n\nFor any non-integer \\(x\\) with \\(0<x<2018\\), we have\n\\[\nd(x+2)-d(x)=\\left(\\frac{1}{x+1}-\\frac{1}{x+2}\\right)+\\left(\\frac{1}{x-2018}-\\frac{1}{x-2017}\\right)>0+0=0 .\n\\]\n\nHence it suffices to prove \\(d(x)>2\\) for \\(1<x<2\\). Since \\(x<2\\), it follows that \\(\\frac{1}{x-2 i-1}> \\frac{1}{x-2 i}\\) for \\(i=2,3, \\ldots, 1008\\). We also have \\(\\frac{1}{x-2018}<0\\). Hence it suffices to prove the following\nfor \\(1<x<2\\).\n\\[\n\\begin{aligned}\n& \\frac{1}{x-1}+\\frac{1}{x-3}-\\frac{1}{x}-\\frac{1}{x-2}>2 \\\\\n\\Leftrightarrow & \\left(\\frac{1}{x-1}+\\frac{1}{2-x}\\right)+\\left(\\frac{1}{x-3}-\\frac{1}{x}\\right)>2 \\\\\n\\Leftrightarrow & \\frac{1}{(x-1)(2-x)}+\\frac{3}{x(x-3)}>2\n\\end{aligned}\n\\]\n\nBy the \\(G M-H M\\) inequality (alternatively, by considering the maximum of the quadratic \\((x-1)(2-x))\\) we have\n\\[\n\\frac{1}{x-1} \\cdot \\frac{1}{2-x}>\\left(\\frac{2}{(x-1)+(2-x)}\\right)^{2}=4\n\\]\n\nTo find a lower bound for \\(\\frac{3}{x(x-3)}\\), note that \\(x(x-3)<0\\) for \\(1<x<2\\). So we seek an upper bound for \\(x(x-3)\\). From the shape of the quadratic, this occurs at \\(x=1\\) or \\(x=2\\), both of which yield \\(\\frac{3}{x(x-3)}>-\\frac{3}{2}\\).\n\nIt follows that \\(d(x)>4-\\frac{3}{2}>2\\), as desired.\n\n\\section*{Solution 2}\n\nAs in Solution 1, we may assume \\(2 n-1<x<2 n\\) for some \\(1 \\leq n \\leq 1009\\). Let \\(d(x)= f(x)-g(x)\\), and note that\n\\[\nd(x)=\\frac{1}{x}+\\sum_{m=1}^{1009} \\frac{1}{(x-2 m)(x-2 m+1)}\n\\]\n\nWe split the sum into three parts: the terms before \\(m=n\\), after \\(m=n\\), and the term \\(m=n\\). The first two are\n\\[\n\\begin{aligned}\n0 & \\leq \\sum_{m=1}^{n-1} \\frac{1}{(x-2 m)(x-2 m+1)} \\\\\n& \\leq \\sum_{m=1}^{n-1} \\frac{1}{(2 n-1-2 m)(2 n-2 m)}=\\sum_{i=1}^{n-1} \\frac{1}{(2 i)(2 i-1)} \\leq \\sum_{i=1}^{1008} \\frac{1}{2 i-1}-\\frac{1}{2 i} \\\\\n0 & \\leq \\sum_{m=n+1}^{1009} \\frac{1}{(2 m-x)(2 m-1-x)} \\\\\n& \\leq \\sum_{m=n+1}^{1009} \\frac{1}{(2 m-2 n+1)(2 m-2 n)}=\\sum_{i=1}^{1009-n} \\frac{1}{(2 i+1)(2 i)} \\leq \\sum_{i=1}^{1008} \\frac{1}{2 i}-\\frac{1}{2 i+1}\n\\end{aligned}\n\\]\n\nWhen we add the two sums the terms telescope and we are left with\n\\[\n0 \\leq \\sum_{1 \\leq m \\leq 1009, m \\neq n} \\frac{1}{(x-2 m)(x-2 m+1)} \\leq 1-\\frac{1}{2017}<1\n\\]\n\nFor the term \\(m=n\\), we write\n\\[\n0<-(x-2 n)(x-2 n+1)=0.25-(x-2 n+0.5)^{2} \\leq 0.25\n\\]\nwhence\n\\[\n-4 \\geq \\frac{1}{(x-2 n)(x-2 n+1)}\n\\]\n\nFinally, \\(\\frac{1}{x}<1\\) since \\(x>2 n-1 \\geq 1\\). Combining these we get\n\\[\nd(x)=\\frac{1}{x}+\\sum_{m=1}^{1009} \\frac{1}{(x-2 m)(x-2 m+1)}<1+1-4<-2 .\n\\]\n\n\\section*{Solution 3}\n\nFirst notice that\n\\[\nf(x)-g(x)=\\frac{1}{x}-\\frac{1}{x-1}+\\frac{1}{x-2}-\\cdots-\\frac{1}{x-2017}+\\frac{1}{x-2018} .\n\\]\n\nAs in Solution 1, we may deal only with the case \\(2 n<x<2 n+1\\). Then \\(x-2 k+1\\) and \\(x-2 k\\) never differ in sign for any integer \\(k\\). Then\n\\[\n\\begin{aligned}\n-\\frac{1}{x-2 k+1}+\\frac{1}{x-2 k} & =\\frac{1}{(x-2 k+1)(x-2 k)}>0 \\quad \\text { for } k=1,2, \\ldots, n-1, n+2, \\ldots, 1009 . \\\\\n\\frac{1}{x-2 n}-\\frac{1}{x-2 n-1} & =\\frac{1}{(x-2 n)(2 n+1-x)} \\geq\\left(\\frac{2}{x-2 n+2 n+1-x}\\right)^{2}=4,\n\\end{aligned}\n\\]\n\nTherefore, summing all inequalities and collecting the remaining terms we find \\(f(x)-g(x)> 4+\\frac{1}{x-2}>4-1=3\\) for \\(0<x<1\\) and, for \\(n>0\\),\n\\[\n\\begin{aligned}\nf(x)-g(x) & >\\frac{1}{x}-\\frac{1}{x-2 n+1}+4+\\frac{1}{x-2 n-2} \\\\\n& =\\frac{1}{x}-\\frac{1}{x-2 n+1}+4-\\frac{1}{2 n+2-x} \\\\\n& >\\frac{1}{x}-\\frac{1}{2 n-2 n+1}+4-\\frac{1}{2 n+2-2 n-1} \\\\\n& =2+\\frac{1}{x}>2 .\n\\end{aligned}\n\\]", "source_pdf": "apmo_2018.pdf", "notes": ""}
{"id": "APMO-2018-3", "contest": "APMO", "year": "2018", "problem_number": "3", "problem": "A collection of \\(n\\) squares on the plane is called tri-connected if the following criteria are satisfied:\n(i) All the squares are congruent.\n(ii) If two squares have a point \\(P\\) in common, then \\(P\\) is a vertex of each of the squares.\n(iii) Each square touches exactly three other squares.\n\nHow many positive integers \\(n\\) are there with \\(2018 \\leq n \\leq 3018\\), such that there exists a collection of \\(n\\) squares that is tri-connected?\n\nAnswer: 501", "solution": "Solution. We will prove that there is no tri-connected collection if \\(n\\) is odd, and that tri-connected collections exist for all even \\(n \\geq 38\\). Since there are 501 even numbers in the range from 2018 to 3018, this yields 501 as the answer.\n\nFor any two different squares \\(A\\) and \\(B\\), let us write \\(A \\sim B\\) to mean that square \\(A\\) touches square \\(B\\). Since each square touches exactly three other squares, and there are \\(n\\) squares in total, the total number of instances of \\(A \\sim B\\) is \\(3 n\\). But \\(A \\sim B\\) if and only if \\(B \\sim A\\). Hence the total number of instances of \\(A \\sim B\\) is even. Thus \\(3 n\\) and hence also \\(n\\) is even.\n\nWe now construct tri-connected collections for each even \\(n\\) in the range. We show two\nConstruction 1 The idea is to use the following two configurations. Observe that in each configuration every square is related to three squares except for the leftmost and rightmost squares which are related to two squares. Note that the configuration on the left is of variable length. Also observe that multiple copies of the configuration on the right can be chained together to end around corners.\n![](https://cdn.mathpix.com/cropped/2025_08_23_94f4f829fd174a5ca813g-5.jpg?height=156&width=363&top_left_y=753&top_left_x=628)\nand\n![](https://cdn.mathpix.com/cropped/2025_08_23_94f4f829fd174a5ca813g-5.jpg?height=147&width=247&top_left_y=759&top_left_x=1213)\n\nPutting the above two types of configurations together as in the following figure yields a tri-connected collection for every even \\(n \\geq 38\\).\n![](https://cdn.mathpix.com/cropped/2025_08_23_94f4f829fd174a5ca813g-5.jpg?height=296&width=781&top_left_y=1107&top_left_x=633)\n\nConstruction 2 Consider a regular \\(4 n-\\) gon \\(A_{1} A_{2} \\cdots A_{4 n}\\), and make \\(4 n\\) squares on the outside of the \\(4 n\\)-gon with one side being on the \\(4 n\\)-gon. Reflect squares sharing sides \\(A_{4 m+2} A_{4 m+3}, A_{4 m+3} A_{4 m+4}\\) across line \\(A_{4 m+2} A_{4 m+4}\\), for \\(0 \\leq m \\leq n-1\\). This will produce a tri-connected set of \\(6 n\\) squares, as long as the squares inside the \\(4 n\\)-gon do not intersect. When \\(n \\geq 4\\), this will be true. The picture for \\(n=24\\) is as follows:\n![](https://cdn.mathpix.com/cropped/2025_08_23_94f4f829fd174a5ca813g-5.jpg?height=806&width=812&top_left_y=1767&top_left_x=602)\n\nTo treat the other cases, consider the following gadget\n![](https://cdn.mathpix.com/cropped/2025_08_23_94f4f829fd174a5ca813g-6.jpg?height=181&width=267&top_left_y=302&top_left_x=873)\n\nTwo squares touch 3 other squares, and the squares containing \\(X, Y\\) touch 2 other squares. Take the \\(4 n\\)-gon from above, and break it into two along the line \\(A_{1} A_{2 n}\\), moving the two parts away from that line. Do so until the gaps can be exactly filled by inserting two copies of the above figure, so that the vertices \\(X, Y\\) touch the two vertices which used to be \\(A_{1}\\) in one instance, and the two vertices which used to be \\(A_{2 n}\\) in the other.\nThis gives us a valid configuration for \\(6 n+8\\) squares, \\(n \\geq 4\\). Finally, if we had instead spread the two parts out more and inserted two copies of the above figure into each gap, we would get \\(6 n+16\\) for \\(n \\geq 4\\), which finishes the proof for all even numbers at least 36 .", "source_pdf": "apmo_2018.pdf", "notes": ""}
{"id": "APMO-2018-4", "contest": "APMO", "year": "2018", "problem_number": "4", "problem": "Let \\(A B C\\) be an equilateral triangle. From the vertex \\(A\\) we draw a ray towards the interior of the triangle such that the ray reaches one of the sides of the triangle. When the ray reaches a side, it then bounces off following the law of reflection, that is, if it arrives with a directed angle \\(\\alpha\\), it leaves with a directed angle \\(180^{\\circ}-\\alpha\\). After \\(n\\) bounces, the ray returns to \\(A\\) without ever landing on any of the other two vertices. Find all possible values of \\(n\\).\n\nAnswer: All \\(n \\equiv 1,5 \\bmod 6\\) with the exception of 5 and 17", "solution": "Solution. Consider an equilateral triangle \\(A A_{1} A_{2}\\) of side length \\(m\\) and triangulate it with unitary triangles. See the figure. To each of the vertices that remain after the triangulation we can assign a pair of coordinates ( \\(a, b\\) ) where \\(a, b\\) are non-negative integers, \\(a\\) is the number of edges we travel in the \\(A A_{1}\\) direction and \\(b\\) is the number of edges we travel in the \\(A A_{2}\\) direction to arrive to the vertex, (we have \\(A=(0,0), A_{1}=(m, 0)\\) and \\(A_{2}=(0, m)\\) ). The unitary triangle with vertex \\(A\\) will be our triangle \\(A B C,(B=(1,0), C=(0,1))\\). We can obtain every unitary triangle by starting with \\(A B C\\) and performing reflections with respect to a side (the vertex \\((1,1)\\) is the reflection of \\(A\\) with respect to \\(B C\\), the vertex ( 0,2 ) is the reflection of \\(B=(1,0)\\) with respect to the side formed by \\(C=(1,0)\\) and \\((1,1)\\), and so on).\n\nWhen we reflect a vertex ( \\(a, b\\) ) with respect to a side of one of the triangles, the congruence of \\(a-b\\) is preserved modulo 3. Furthermore, an induction argument shows that any two vertices \\((a, b)\\) and \\(\\left(a^{\\prime}, b^{\\prime}\\right)\\) with \\(a-b \\equiv a^{\\prime}-b^{\\prime} \\bmod 3\\) can be obtained from each other by a series of such reflections. Therefore, the set of vertices \\(V\\) that result from the reflections of \\(A\\) will be those of the form \\((a, b)\\) satisfying \\(a \\equiv b \\bmod 3\\). See the green vertices in the figure.\n\nNow, let \\(U\\) be the set of vertices \\(u\\) that satisfy that the line segment between \\(u\\) and \\(A\\) does not pass through any other vertex. A pair \\((a, b)\\) is in \\(U\\) if and only if \\(\\operatorname{gcd}(a, b)=1\\), since otherwise for \\(d=\\operatorname{gcd}(a, b)\\) we have that the vertex \\((a / d, b / d)\\) also lies on the line segment between \\(u\\) and \\(A\\).\n\nObserve that the rays that come out from \\(A\\) and eventually return to \\(A\\) are those that come out towards a vertex in \\(V \\cap U\\) (they would be in \\(V\\) to be able to come back to \\(A\\) and in \\(U\\) so that they do not reach a vertex beforehand). In the diagram, a ray toward one such vertex ( \\(a, b\\) ) will intersect exactly \\((a-1)+(b-1)+(a+b-1)=2(a+b)-3\\) lines: \\(a-1\\) of them parallel to \\(A B, b-1\\) parallel to \\(A C\\) and \\(a+b-1\\) parallel to \\(B C\\). Therefore, in the triangle \\(A B C\\) the ray will bounce \\(2(a+b)-3\\) times before returning to \\(A\\). So we want to find all\n![](https://cdn.mathpix.com/cropped/2025_08_23_94f4f829fd174a5ca813g-7.jpg?height=880&width=1029&top_left_y=188&top_left_x=516)\n\\(n=2(a+b)-3\\) where \\(a \\equiv b \\bmod 3\\) and \\(\\operatorname{gcd}(a, b)=1\\).\nIf \\(a+b\\) is a multiple of 3 then we cannot satisfy both conditions simultaneously, therefore \\(n\\) is not a multiple of 3 . We also know that \\(n\\) is odd. Therefore \\(n \\equiv 1,5,7,11 \\bmod 12\\). Note that the pair \\((1,3 k+1)\\) satisfies the conditions and we can create \\(n=2(3 k+2)-3=6 k+1\\) for all \\(k \\geq 0\\) (this settles the question for \\(n \\equiv 1,7 \\bmod 12\\) ). For \\(n \\equiv 5 \\bmod 12\\) consider the pair \\((3 k-1,3 k+5)\\) when \\(k\\) is even or ( \\(3 k-4,3 k+8\\) ) when \\(k\\) is odd. This gives us all the integers of the form \\(12 k+5\\) for \\(k \\geq 2\\). For \\(11 \\bmod 12\\), take the pairs \\((3 k-1,3 k+2)\\) (with \\(k \\geq 1\\) ), which yield all positive integers of the form \\(12 k-1\\).\n\nFinally, to discard 5 and 17 note that the only pairs ( \\(a, b\\) ) that are solutions to \\(2(a+b)-3=5\\) or \\(2(a+b)-3=17\\) with the same residue mod 3 in this range are the non-relatively prime pairs \\((2,2),(2,8)\\) and \\((5,5)\\).", "source_pdf": "apmo_2018.pdf", "notes": ""}
{"id": "APMO-2018-5", "contest": "APMO", "year": "2018", "problem_number": "5", "problem": "Find all polynomials \\(P(x)\\) with integer coefficients such that for all real numbers \\(s\\) and \\(t\\), if \\(P(s)\\) and \\(P(t)\\) are both integers, then \\(P(s t)\\) is also an integer.\n\nAnswer: \\(P(x)=x^{n}+k,-x^{n}+k\\) for \\(n\\) a non-negative integer and \\(k\\) an integer.", "solution": "Solution 1: \\(P(x)=x^{n}+k,-x^{n}+k\\) for \\(n\\) a non-negative integer and \\(k\\) an integer.\nNotice that if \\(P(x)\\) is a solution, then so is \\(P(x)+k\\) and \\(-P(x)+k\\) for any integer \\(k\\), so we may assume that the leading coefficient of \\(P(x)\\) is positive and that \\(P(0)=0\\), i.e., we can assume that \\(P(x)=\\sum_{i=1}^{n} a_{i} x^{i}\\) with \\(a_{n}>0\\). We are going to prove that \\(P(x)=x^{n}\\) in this case.\n\nLet \\(p\\) be a large prime such that \\(p>\\sum_{i=1}^{n}\\left|a_{i}\\right|\\). Because \\(P\\) has a positive leading coefficient and \\(p\\) is large enough, we can find \\(t \\in \\mathbb{R}\\) such that \\(P(t)=p\\). Denote the greatest common divisor of the polynomial \\(P(x)-p\\) and \\(P(2 x)-P(2 t)\\) as \\(f(x)\\), and \\(t\\) is a root of it, so \\(f\\) is a non-constant polynomial. Notice that \\(P(2 t)\\) is an integer by using the hypothesis for \\(s=2\\) and \\(t\\). Since \\(P(x)-p\\) and \\(P(2 x)-P(2 t)\\) are polynomials with integer coefficients, \\(f\\) can be chosen as a polynomial with rational coefficients.\n\nIn the following, we will prove that \\(f\\) is the same as \\(P(x)-p\\) up to a constant multiplier. Say \\(P(x)-p=f(x) g(x)\\), where \\(f\\) and \\(g\\) are non-constant polynomials. By Gauss's lemma, we can get \\(f_{1}, g_{1}\\) with \\(P(x)-p=f_{1}(x) g_{1}(x)\\) where \\(f_{1}\\) is a scalar multiple of \\(f\\) and \\(g_{1}\\) is a scalar multiple of \\(g\\) and one of \\(f_{1}, g_{1}\\) has constant term \\(\\pm 1\\) (this is because \\(-p=P(0)-p=f(0) g(0)\\) with \\(p\\) prime). So \\(P(x)-p\\) has at least one root \\(r\\) with absolute value not greater than 1 (using\n\nVieta, the product of the roots of the polynomial with constant term \\(\\pm 1\\) is \\(\\pm 1\\) ), but\n\\[\n|P(r)-p|=\\left|\\sum_{i=1}^{n} a_{i} r^{i}-p\\right|>p-\\sum_{i=1}^{n}\\left|a_{i}\\right|>0\n\\]\nhence we get a contradiction!\nTherefore \\(f\\) is a constant multiple of \\(P(x)-p\\), so \\(P(2 x)-P(2 t)\\) is a constant multiple of \\(P(x)-p\\) because they both have the same degree. By comparing leading coefficients we get that \\(P(2 x)-P(2 t)=2^{n}(P(x)-p)\\). Comparing the rest of the coefficients we get that \\(P(x)=a_{n} x^{n}\\). If we let \\(a=b=\\left(1 / a_{n}\\right)^{1 / n}\\), then \\(P(a)=P(b)=1\\), so \\(P(a b)\\) must also be an integer. But \\(P(a b)=\\frac{1}{a_{n}}\\). Therefore \\(a_{n}=1\\) and the proof is complete.\n\nSolution 2: Assume \\(P(x)=\\sum_{i=0}^{n} a_{i} x^{i}\\). Consider the following system of equations\n\\[\n\\begin{aligned}\na_{0} & =P(0) \\\\\na_{n} t^{n}+a_{n-1} t^{n-1}+\\cdots+a_{0} & =P(t) \\\\\n2^{n} a_{n} t^{n}+2^{n-1} a_{n-1} t^{n-1}+\\cdots+a_{0} & =P(2 t) \\\\\n\\vdots & \\\\\nn^{n} a_{n} t^{n}+n^{n-1} a_{n-1} t^{n-1}+\\cdots+a_{0} & =P(n t)\n\\end{aligned}\n\\]\nviewing \\(a_{k} t^{k}\\) as variables. Note that if \\(P(t)\\) is an integer, then by the hypothesis all the terms on the right hand side of the equations are integers as well. By using Cramer's rule, we can get that \\(a_{k} t^{k}=D / M\\), where \\(D\\) is an integer and \\(M\\) is the following determinant\n\\[\n\\left|\\begin{array}{ccccc}\n1 & 0 & 0 & \\cdots & 0 \\\\\n1 & 1 & 1 & \\cdots & 1 \\\\\n1 & 2 & 4 & \\cdots & 2^{n} \\\\\n\\vdots & \\vdots & \\vdots & & \\vdots \\\\\n1 & n & n^{2} & \\cdots & n^{n}\n\\end{array}\\right| \\neq 0 .\n\\]\n\nThus, if we let \\(r\\) be the smallest positive index such that \\(a_{r} \\neq 0\\), we can express each \\(t \\in \\mathbb{R}\\) with \\(P(t) \\in \\mathbb{Z}\\) in the form \\(\\left(\\frac{m}{M^{\\prime}}\\right)^{1 / r}\\) for some integer \\(m\\), and where \\(M^{\\prime}=M \\times a_{r}\\) is a constant.\n\nWe can choose \\(L\\) large enough such that \\(\\left.P\\right|_{\\mathbb{R} \\geq L}\\) is injective, and for any larger \\(N\\), the growth order of the number of values in the form \\(\\left(\\frac{m}{M^{\\prime}}\\right)^{1 / r}\\) is \\(N^{r}\\), while the growth order of the number of integers in \\([P(L), P(N)]\\) is \\(N^{n}\\), so \\(r=n\\). Therefore \\(P(x)\\) is of the form \\(a_{n} x^{n}+k\\). The problem can be finished as in Solution 1.", "source_pdf": "apmo_2018.pdf", "notes": ""}
{"id": "APMO-2022-1", "contest": "APMO", "year": "2022", "problem_number": "1", "problem": "Find all pairs ( \\(a, b\\) ) of positive integers such that \\(a^{3}\\) is a multiple of \\(b^{2}\\) and \\(b-1\\) is a multiple of \\(a-1\\). Note: An integer \\(n\\) is said to be a multiple of an integer \\(m\\) if there is an integer \\(k\\) such that \\(n=k m\\).", "solution": "\\section*{Solution}\n\n\\section*{Solution 1.1}\n\nBy inspection, we see that the pairs ( \\(a, b\\) ) with \\(a=b\\) are solutions, and so too are the pairs ( \\(a, 1\\) ). We will see that these are the only solutions.\n- Case 1. Consider the case \\(b<a\\). Since \\(b-1\\) is a multiple of \\(a-1\\), it follows that \\(b=1\\). This yields the second set of solutions described above.\n- Case 2. This leaves the case \\(b \\geq a\\). Since the positive integer \\(a^{3}\\) is a multiple of \\(b^{2}\\), there is a positive integer \\(c\\) such that \\(a^{3}=b^{2} c\\).\nNote that \\(a \\equiv b \\equiv 1\\) modulo \\(a-1\\). So we have\n\\[\n1 \\equiv a^{3}=b^{2} c \\equiv c \\quad(\\bmod a-1) .\n\\]\n\nIf \\(c<a\\), then we must have \\(c=1\\), hence, \\(a^{3}=b^{2}\\). So there is a positive integer \\(d\\) such that \\(a=d^{2}\\) and \\(b=d^{3}\\). Now \\(a-1 \\mid b-1\\) yields \\(d^{2}-1 \\mid d^{3}-1\\). This implies that \\(d+1 \\mid d(d+1)+1\\), which is impossible.\nIf \\(c \\geq a\\), then \\(b^{2} c \\geq b^{2} a \\geq a^{3}=b^{2} c\\). So there's equality throughout, implying \\(a=c=b\\). This yields the first set of solutions described above.\n\nTherefore, the solutions described above are the only solutions.\n\n\\section*{Solution 1.2}\n\nWe will start by showing that there are positive integers \\(x, c, d\\) such that \\(a=x^{2} c d\\) and \\(b=x^{3} c\\). Let \\(g=\\operatorname{gcd}(a, b)\\) so that \\(a=g d\\) and \\(b=g x\\) for some coprime \\(d\\) and \\(x\\). Then, \\(b^{2} \\mid a^{3}\\) is equivalent to \\(g^{2} x^{2} \\mid g^{3} d^{3}\\), which is equivalent to \\(x^{2} \\mid g d^{3}\\). Since \\(x\\) and \\(d\\) are coprime, this implies \\(x^{2} \\mid g\\). Hence, \\(g=x^{2} c\\) for some \\(c\\), giving \\(a=x^{2} c d\\) and \\(b=x^{3} c\\) as required.\nNow, it remains to find all positive integers \\(x, c, d\\) satisfying\n\\[\nx^{2} c d-1 \\mid x^{3} c-1 .\n\\]\n\nThat is, \\(x^{3} c \\equiv 1\\left(\\bmod x^{2} c d-1\\right)\\). Assuming that this congruence holds, it follows that \\(d \\equiv x^{3} c d \\equiv x \\left(\\bmod x^{2} c d-1\\right)\\). Then, either \\(x=d\\) or \\(x-d \\geq x^{2} c d-1\\) or \\(d-x \\geq x^{2} c d-1\\).\n- If \\(x=d\\) then \\(b=a\\).\n- If \\(x-d \\geq x^{2} c d-1\\), then \\(x-d \\geq x^{2} c d-1 \\geq x-1 \\geq x-d\\). Hence, each of these inequalities must in fact be an equality. This implies that \\(x=c=d=1\\), which implies that \\(a=b=1\\).\n- If \\(d-x \\geq x^{2} c d-1\\), then \\(d-x \\geq x^{2} c d-1 \\geq d-1 \\geq d-x\\). Hence, each of these inequalities must in fact be an equality. This implies that \\(x=c=1\\), which implies that \\(b=1\\).\n\nHence the only solutions are the pairs ( \\(a, b\\) ) such that \\(a=b\\) or \\(b=1\\). These pairs can be checked to satisfy the given conditions.\n\n\\section*{Solution 1.3}\n\nAll answers are ( \\(n, n\\) ) and ( \\(n, 1\\) ) where \\(n\\) is any positive integer. They all clearly work.\nTo show that these are all solutions, note that we can easily eliminate the case \\(a=1\\) or \\(b=1\\). Thus, assume that \\(a, b \\neq 1\\) and \\(a \\neq b\\). By the second divisibility, we see that \\(a-1 \\mid b-a\\). However, \\(\\operatorname{gcd}(a, b) \\mid b-a\\) and \\(a-1\\) is relatively prime to \\(\\operatorname{gcd}(a, b)\\). This implies that \\((a-1) \\operatorname{gcd}(a, b) \\mid b-a\\), which implies \\(\\operatorname{gcd}(a, b) \\left\\lvert\\, \\frac{b-1}{a-1}-1\\right.\\).\nThe last relation implies that \\(\\operatorname{gcd}(a, b)<\\frac{b-1}{a-1}\\), since the right-hand side are positive. However, due to the first divisibility,\n\\[\n\\operatorname{gcd}(a, b)^{3}=\\operatorname{gcd}\\left(a^{3}, b^{3}\\right) \\geq \\operatorname{gcd}\\left(b^{2}, b^{3}\\right)=b^{2} .\n\\]\n\nCombining these two inequalities, we get that\n\\[\nb^{\\frac{2}{3}}<\\frac{b-1}{a-1}<2 \\frac{b}{a} .\n\\]\n\nThis implies \\(a<2 b^{\\frac{1}{3}}\\). However, \\(b^{2} \\mid a^{3}\\) gives \\(b \\leq a^{\\frac{3}{2}}\\). This forces\n\\[\na<2\\left(a^{\\frac{3}{2}}\\right)^{\\frac{1}{3}}=2 \\sqrt{a} \\Longrightarrow a<4 .\n\\]\n\nExtracting \\(a=2,3\\) by hand yields no additional solution.", "source_pdf": "apmo_2022.pdf", "notes": ""}
{"id": "APMO-2022-2", "contest": "APMO", "year": "2022", "problem_number": "2", "problem": "Let \\(A B C\\) be a right triangle with \\(\\angle B=90^{\\circ}\\). Point \\(D\\) lies on the line \\(C B\\) such that \\(B\\) is between \\(D\\) and \\(C\\). Let \\(E\\) be the midpoint of \\(A D\\) and let \\(F\\) be the second intersection point of the circumcircle of \\(\\triangle A C D\\) and the circumcircle of \\(\\triangle B D E\\). Prove that as \\(D\\) varies, the line \\(E F\\) passes through a fixed point.\n![](https://cdn.mathpix.com/cropped/2025_08_23_d0cc35e860272a0e8f74g-2.jpg?height=887&width=1272&top_left_y=1507&top_left_x=460)", "solution": "\\section*{Solution}\n\n\\section*{Solution 2.1}\n\nLet the line \\(E F\\) intersect the line \\(B C\\) at \\(P\\) and the circumcircle of \\(\\triangle A C D\\) at \\(G\\) distinct from \\(F\\). We will prove that \\(P\\) is the fixed point.\n\nFirst, notice that \\(\\triangle B E D\\) is isosceles with \\(E B=E D\\). This implies \\(\\angle E B C=\\angle E D P\\).\nThen, \\(\\angle D A G=\\angle D F G=\\angle E B C=\\angle E D P\\) which implies \\(A G \\| D C\\). Hence, \\(A G C D\\) is an isosceles trapezoid.\nAlso, \\(A G \\| D C\\) and \\(A E=E D\\). This implies \\(\\triangle A E G \\cong \\triangle D E P\\) and \\(A G=D P\\).\nSince \\(B\\) is the foot of the perpendicular from \\(A\\) onto the side \\(C D\\) of the isosceles trapezoid \\(A G C D\\), we have \\(P B=P D+D B=A G+D B=B C\\), which does not depend on the choice of \\(D\\). Hence, the initial statement is proven.\n\n\\section*{Solution 2.2}\n\nSet up a coordinate system where \\(B C\\) is along the positive \\(x\\)-axis, \\(B A\\) is along the positive \\(y\\)-axis, and \\(B\\) is the origin. Take \\(A=(0, a), B=(0,0), C=(c, 0), D=(-d, 0)\\) where \\(a, b, c, d>0\\). Then \\(E=\\left(-\\frac{d}{2}, \\frac{a}{2}\\right)\\). The general equation of a circle is\n\\[\nx^{2}+y^{2}+2 f x+2 g y+h=0\n\\]\n\nSubstituting the coordinates of \\(A, D, C\\) into (1) and solving for \\(f, g, h\\), we find that the equation of the circumcircle of \\(\\triangle A D C\\) is\n\\[\nx^{2}+y^{2}+(d-c) x+\\left(\\frac{c d}{a}-a\\right) y-c d=0 .\n\\]\n\nSimilarly, the equation of the circumcircle of \\(\\triangle B D E\\) is\n\\[\nx^{2}+y^{2}+d x+\\left(\\frac{d^{2}}{2 a}-\\frac{a}{2}\\right) y=0 .\n\\]\n\nThen (3)-(2) gives the equation of the line \\(D F\\) which is\n\\[\nc x+\\frac{a^{2}+d^{2}-2 c d}{2 a} y+c d=0 .\n\\]\n\nSolving (3) and (4) simultaneously, we get\n\\[\nF=\\left(\\frac{c\\left(d^{2}-a^{2}-2 c d\\right)}{a^{2}+(d-2 c)^{2}}, \\frac{2 a c(c-d)}{a^{2}+(d-2 c)^{2}}\\right),\n\\]\nand the other solution \\(D=(-d, 0)\\).\nFrom this we obtain the equation of the line \\(E F\\) which is \\(a x+(d-2 c) y+a c=0\\). It passes through \\(P(-c, 0)\\) which is independent of \\(d\\).", "source_pdf": "apmo_2022.pdf", "notes": ""}
{"id": "APMO-2022-3", "contest": "APMO", "year": "2022", "problem_number": "3", "problem": "Find all positive integers \\(k<202\\) for which there exists a positive integer \\(n\\) such that\n\\[\n\\left\\{\\frac{n}{202}\\right\\}+\\left\\{\\frac{2 n}{202}\\right\\}+\\cdots+\\left\\{\\frac{k n}{202}\\right\\}=\\frac{k}{2},\n\\]\nwhere \\(\\{x\\}\\) denote the fractional part of \\(x\\).\nNote: \\(\\{x\\}\\) denotes the real number \\(k\\) with \\(0 \\leq k<1\\) such that \\(x-k\\) is an integer.", "solution": "\\section*{Solution}\n\nDenote the equation in the problem statement as (*), and note that it is equivalent to the condition that the average of the remainders when dividing \\(n, 2 n, \\ldots, k n\\) by 202 is 101 . Since \\(\\left\\{\\frac{i n}{202}\\right\\}\\) is invariant in each residue class modulo 202 for each \\(1 \\leq i \\leq k\\), it suffices to consider \\(0 \\leq n<202\\).\n\nIf \\(n=0\\), so is \\(\\left\\{\\frac{i n}{202}\\right\\}\\), meaning that \\(\\left(^{*}\\right)\\) does not hold for any \\(k\\). If \\(n=101\\), then it can be checked that (*) is satisfied if and only if \\(k=1\\). From now on, we will assume that \\(101 \\nmid n\\).\nFor each \\(1 \\leq i \\leq k\\), let \\(a_{i}=\\left\\lfloor\\frac{i n}{202}\\right\\rfloor=\\frac{i n}{202}-\\left\\{\\frac{i n}{202}\\right\\}\\). Rewriting (*) and multiplying the equation by 202, we find that\n\\[\nn(1+2+\\ldots+k)-202\\left(a_{1}+a_{2}+\\ldots+a_{k}\\right)=101 k .\n\\]\n\nEquivalently, letting \\(z=a_{1}+a_{2}+\\ldots+a_{k}\\),\n\\[\nn k(k+1)-404 z=202 k .\n\\]\n\nSince \\(n\\) is not divisible by 101 , which is prime, it follows that \\(101 \\mid k(k+1)\\). In particular, \\(101 \\mid k\\) or \\(101 \\mid k+1\\). This means that \\(k \\in\\{100,101,201\\}\\). We claim that all these values of \\(k\\) work.\n- If \\(k=201\\), we may choose \\(n=1\\). The remainders when dividing \\(n, 2 n, \\ldots, k n\\) by 202 are 1,2 , \\(\\ldots, 201\\), which have an average of 101 .\n- If \\(k=100\\), we may choose \\(n=2\\). The remainders when dividing \\(n, 2 n, \\ldots, k n\\) by 202 are 2,4 , \\(\\ldots, 200\\), which have an average of 101 .\n- If \\(k=101\\), we may choose \\(n=51\\). To see this, note that the first four remainders are \\(51,102,153\\), 2 , which have an average of 77 . The next four remainders ( \\(53,104,155,4\\) ) are shifted upwards from the first four remainders by 2 each, and so on, until the 25 th set of the remainders ( 99 , 150, 201, 50) which have an average of 125 . Hence, the first 100 remainders have an average of \\(\\frac{77+125}{2}=101\\). The 101th remainder is also 101, meaning that the average of all 101 remainders is 101 .\n\nIn conclusion, all values \\(k \\in\\{1,100,101,201\\}\\) satisfy the initial condition.", "source_pdf": "apmo_2022.pdf", "notes": ""}
{"id": "APMO-2022-4", "contest": "APMO", "year": "2022", "problem_number": "4", "problem": "Let \\(n\\) and \\(k\\) be positive integers. Cathy is playing the following game. There are \\(n\\) marbles and \\(k\\) boxes, with the marbles labelled 1 to \\(n\\). Initially, all marbles are placed inside one box. Each turn, Cathy chooses a box and then moves the marbles with the smallest label, say \\(i\\), to either any empty box or the box containing marble \\(i+1\\). Cathy wins if at any point there is a box containing only marble \\(n\\).\nDetermine all pairs of integers ( \\(n, k\\) ) such that Cathy can win this game.", "solution": "\\section*{Solution}\n\nWe claim Cathy can win if and only if \\(n \\leq 2^{k-1}\\).\n\nFirst, note that each non-empty box always contains a consecutive sequence of labeled marbles. This is true since Cathy is always either removing from or placing in the lowest marble in a box. As a consequence, every move made is reversible.\n\nNext, we prove by induction that Cathy can win if \\(n=2^{k-1}\\). The base case of \\(n=k=1\\) is trivial. Assume a victory can be obtained for \\(m\\) boxes and \\(2^{m-1}\\) marbles. Consider the case of \\(m+1\\) boxes and \\(2^{m}\\) marbles. Cathy can first perform a sequence of moves so that only marbles \\(2^{m-1}, \\ldots, 2^{m}\\) are left in the starting box, while keeping one box, say \\(B\\), empty. Now move the marble \\(2^{m-1}\\) to box \\(B\\), then reverse all of the initial moves while treating \\(B\\) as the starting box. At the end of that, we will have marbles \\(2^{m-1}+1, \\ldots, 2^{m}\\) in the starting box, marbles \\(1,2, \\ldots, 2^{m-1}\\) in box \\(B\\), and \\(m-1\\) empty boxes. By repeating the original sequence of moves on marbles \\(2^{m-1}+1, \\ldots, 2^{m}\\), using the \\(m\\) boxes that are not box \\(B\\), we can reach a state where only marble \\(2^{m}\\) remains in the starting box. Therefore\na victory is possible if \\(n=2^{k-1}\\) or smaller.\n\nWe now prove by induction that Cathy loses if \\(n=2^{k-1}+1\\). The base case of \\(n=2\\) and \\(k=1\\) is trivial. Assume a victory is impossible for \\(m\\) boxes and \\(2^{m-1}+1\\) marbles. For the sake of contradiction, suppose that victory is possible for \\(m+1\\) boxes and \\(2^{m}+1\\) marbles. In a winning sequence of moves, consider the last time a marble \\(2^{m-1}+1\\) leaves the starting box, call this move \\(X\\). After \\(X\\), there cannot be a time when marbles \\(1, \\ldots, 2^{m-1}+1\\) are all in the same box. Otherwise, by reversing these moves after \\(X\\) and deleting marbles greater than \\(2^{m-1}+1\\), it gives us a winning sequence of moves for \\(2^{m-1}+1\\) marbles and \\(m\\) boxes (as the original starting box is not used here), contradicting the inductive hypothesis. Hence starting from \\(X\\), marbles 1 will never be in the same box as any marbles greater than or equal to \\(2^{m-1}+1\\).\n\nNow delete marbles \\(2, \\ldots, 2^{m-1}\\) and consider the winning moves starting from \\(X\\). Marble 1 would only move from one empty box to another, while blocking other marbles from entering its box. Thus we effectively have a sequence of moves for \\(2^{m-1}+1\\) marbles, while only able to use \\(m\\) boxes. This again contradicts the inductive hypothesis. Therefore, a victory is not possible if \\(n=2^{k-1}+1\\) or greater.", "source_pdf": "apmo_2022.pdf", "notes": ""}
{"id": "APMO-2022-5", "contest": "APMO", "year": "2022", "problem_number": "5", "problem": "Let \\(a, b, c, d\\) be real numbers such that \\(a^{2}+b^{2}+c^{2}+d^{2}=1\\). Determine the minimum value of \\((a-b)(b-c)(c-d)(d-a)\\) and determine all values of \\((a, b, c, d)\\) such that the minimum value is achieved.", "solution": "\\section*{Solution}\n\nThe minimum value is \\(-\\frac{1}{8}\\). There are eight equality cases in total. The first one is\n\\[\n\\left(\\frac{1}{4}+\\frac{\\sqrt{3}}{4},-\\frac{1}{4}-\\frac{\\sqrt{3}}{4}, \\frac{1}{4}-\\frac{\\sqrt{3}}{4},-\\frac{1}{4}+\\frac{\\sqrt{3}}{4}\\right) .\n\\]\n\nCyclic shifting all the entries give three more quadruples. Moreover, flipping the sign \\(((a, b, c, d) \\rightarrow (-a,-b,-c,-d)\\) ) all four entries in each of the four quadruples give four more equality cases.\n\n\\section*{Solution 5.1}\n\nSince the expression is cyclic, we could WLOG \\(a=\\max \\{a, b, c, d\\}\\). Let\n\\[\nS(a, b, c, d)=(a-b)(b-c)(c-d)(d-a)\n\\]\n\nNote that we have given \\((a, b, c, d)\\) such that \\(S(a, b, c, d)=-\\frac{1}{8}\\). Therefore, to prove that \\(S(a, b, c, d) \\geq -\\frac{1}{8}\\), we just need to consider the case where \\(S(a, b, c, d)<0\\).\n- Exactly 1 of \\(a-b, b-c, c-d, d-a\\) is negative.\n\nSince \\(a=\\max \\{a, b, c, d\\}\\), then we must have \\(d-a<0\\). This forces \\(a>b>c>d\\). Now, let us write\n\\[\nS(a, b, c, d)=-(a-b)(b-c)(c-d)(a-d)\n\\]\n\nWrite \\(a-b=y, b-c=x, c-d=w\\) for some positive reals \\(w, x, y>0\\). Plugging to the original condition, we have\n\\[\n(d+w+x+y)^{2}+(d+w+x)^{2}+(d+w)^{2}+d^{2}-1=0\n\\]\nand we want to prove that \\(w x y(w+x+y) \\leq \\frac{1}{8}\\). Consider the expression \\((*)\\) as a quadratic in \\(d\\) :\n\\[\n4 d^{2}+d(6 w+4 x+2 y)+\\left((w+x+y)^{2}+(w+x)^{2}+w^{2}-1\\right)=0\n\\]\n\nSince \\(d\\) is a real number, then the discriminant of the given equation has to be non-negative, i.e. we must have\n\\[\n\\begin{aligned}\n4 & \\geq 4\\left((w+x+y)^{2}+(w+x)^{2}+w^{2}\\right)-(3 w+2 x+y)^{2} \\\\\n& =\\left(3 w^{2}+2 w y+3 y^{2}\\right)+4 x(w+x+y) \\\\\n& \\geq 8 w y+4 x(w+x+y) \\\\\n& =4(x(w+x+y)+2 w y)\n\\end{aligned}\n\\]\n\nHowever, AM-GM gives us\n\\[\nw x y(w+x+y) \\leq \\frac{1}{2}\\left(\\frac{x(w+x+y)+2 w y}{2}\\right)^{2} \\leq \\frac{1}{8}\n\\]\n\nThis proves \\(S(a, b, c, d) \\geq-\\frac{1}{8}\\) for any \\(a, b, c, d \\in \\mathbb{R}\\) such that \\(a>b>c>d\\). Equality holds if and only if \\(w=y, x(w+x+y)=2 w y\\) and \\(w x y(w+x+y)=\\frac{1}{8}\\). Solving these equations gives us \\(w^{4}=\\frac{1}{16}\\) which forces \\(w=\\frac{1}{2}\\) since \\(w>0\\). Solving for \\(x\\) gives us \\(x(x+1)=\\frac{1}{2}\\), and we will get \\(x=-\\frac{1}{2}+\\frac{\\sqrt{3}}{2}\\) as \\(x>0\\). Plugging back gives us \\(d=-\\frac{1}{4}-\\frac{\\sqrt{3}}{4}\\), and this gives us\n\\[\n(a, b, c, d)=\\left(\\frac{1}{4}+\\frac{\\sqrt{3}}{4},-\\frac{1}{4}+\\frac{\\sqrt{3}}{4}, \\frac{1}{4}-\\frac{\\sqrt{3}}{4},-\\frac{1}{4}-\\frac{\\sqrt{3}}{4}\\right)\n\\]\n\nThus, any cyclic permutation of the above solution will achieve the minimum equality.\n- Exactly 3 of \\(a-b, b-c, c-d, d-a\\) are negative Since \\(a=\\max \\{a, b, c, d\\}\\), then \\(a-b\\) has to be positive. So we must have \\(b<c<d<a\\). Now, note that\n\\[\n\\begin{aligned}\nS(a, b, c, d) & =(a-b)(b-c)(c-d)(d-a) \\\\\n& =(a-d)(d-c)(c-b)(b-a) \\\\\n& =S(a, d, c, b)\n\\end{aligned}\n\\]\n\nNow, note that \\(a>d>c>b\\). By the previous case, \\(S(a, d, c, b) \\geq-\\frac{1}{8}\\), which implies that\n\\[\nS(a, b, c, d)=S(a, d, c, b) \\geq-\\frac{1}{8}\n\\]\nas well. Equality holds if and only if\n\\[\n(a, b, c, d)=\\left(\\frac{1}{4}+\\frac{\\sqrt{3}}{4},-\\frac{1}{4}-\\frac{\\sqrt{3}}{4}, \\frac{1}{4}-\\frac{\\sqrt{3}}{4},-\\frac{1}{4}+\\frac{\\sqrt{3}}{4}\\right)\n\\]\nand its cyclic permutation.\n\n\\section*{Solution 5.2}\n\nThe minimum value is \\(-\\frac{1}{8}\\). There are eight equality cases in total. The first one is\n\\[\n\\left(\\frac{1}{4}+\\frac{\\sqrt{3}}{4},-\\frac{1}{4}-\\frac{\\sqrt{3}}{4}, \\frac{1}{4}-\\frac{\\sqrt{3}}{4},-\\frac{1}{4}+\\frac{\\sqrt{3}}{4}\\right) .\n\\]\n\nCyclic shifting all the entries give three more quadruples. Moreover, flipping the sign \\(((a, b, c, d) \\rightarrow (-a,-b,-c,-d)\\) ) all four entries in each of the four quadruples give four more equality cases. We then begin the proof by the following optimization:\n\nClaim 1. In order to get the minimum value, we must have \\(a+b+c+d=0\\).\n\nProof. Assume not, let \\(\\delta=\\frac{a+b+c+d}{4}\\) and note that\n\\[\n(a-\\delta)^{2}+(b-\\delta)^{2}+(c-\\delta)^{2}+(d-\\delta)^{2}<a^{2}+b^{2}+c^{2}+d^{2}\n\\]\nso by shifting by \\(\\delta\\) and scaling, we get an even smaller value of \\((a-b)(b-c)(c-d)(d-a)\\).\n\nThe key idea is to substitute the variables\n\\[\n\\begin{aligned}\n& x=a c+b d \\\\\n& y=a b+c d \\\\\n& z=a d+b c\n\\end{aligned}\n\\]\nso that the original expression is just \\((x-y)(x-z)\\). We also have the conditions \\(x, y, z \\geq-0.5\\) because of:\n\\[\n2 x+\\left(a^{2}+b^{2}+c^{2}+d^{2}\\right)=(a+c)^{2}+(b+d)^{2} \\geq 0\n\\]\n\nMoreover, notice that\n\\[\n0=(a+b+c+d)^{2}=a^{2}+b^{2}+c^{2}+d^{2}+2(x+y+z) \\Longrightarrow x+y+z=\\frac{-1}{2}\n\\]\n\nNow, we reduce to the following optimization problem.\nClaim 2. Let \\(x, y, z \\geq-0.5\\) such that \\(x+y+z=-0.5\\). Then, the minimum value of\n\\[\n(x-y)(x-z)\n\\]\nis \\(-1 / 8\\). Moreover, the equality case occurs when \\(x=-1 / 4\\) and \\(\\{y, z\\}=\\{1 / 4,-1 / 2\\}\\).\nProof. We notice that\n\\[\n\\begin{aligned}\n(x-y)(x-z)+\\frac{1}{8} & =\\left(2 y+z+\\frac{1}{2}\\right)\\left(2 z+y+\\frac{1}{2}\\right)+\\frac{1}{8} \\\\\n& =\\frac{1}{8}(4 y+4 z+1)^{2}+\\left(y+\\frac{1}{2}\\right)\\left(z+\\frac{1}{2}\\right) \\geq 0\n\\end{aligned}\n\\]\n\nThe last inequality is true since both \\(y+\\frac{1}{2}\\) and \\(z+\\frac{1}{2}\\) are not less than zero.\nThe equality in the last inequality is attained when either \\(y+\\frac{1}{2}=0\\) or \\(z+\\frac{1}{2}=0\\), and \\(4 y+4 z+1=0\\). This system of equations give \\((y, z)=(1 / 4,-1 / 2)\\) or \\((y, z)=(-1 / 2,1 / 4)\\) as the desired equality cases.\n\nNote: We can also prove (the weakened) Claim 2 by using Lagrange Multiplier, as follows. We first prove that, in fact, \\(x, y, z \\in[-0.5,0.5]\\). This can be proved by considering that\n\\[\n-2 x+\\left(a^{2}+b^{2}+c^{2}+d^{2}\\right)=(a-c)^{2}+(b-d)^{2} \\geq 0\n\\]\n\nWe will prove the Claim 2, only that in this case, \\(x, y, z \\in[-0.5,0.5]\\). This is already sufficient to prove the original question. We already have the bounded domain \\([-0.5,0.5]^{3}\\), so the global minimum must occur somewhere. Thus, it suffices to consider two cases:\n- If the global minimum lies on the boundary of \\([-0.5,0.5]^{3}\\). Then, one of \\(x, y, z\\) must be -0.5 or 0.5 . By symmetry between \\(y\\) and \\(z\\), we split to a few more cases.\n- If \\(x=0.5\\), then \\(y=z=-0.5\\), so \\((x-y)(x-z)=1\\), not the minimum.\n- If \\(x=-0.5\\), then both \\(y\\) and \\(z\\) must be greater or equal to \\(x\\), so \\((x-y)(x-z) \\geq 0\\), not the minimum.\n- If \\(y=0.5\\), then \\(x=z=-0.5\\), so \\((x-y)(x-z)=0\\), not the minimum.\n- If \\(y=-0.5\\), then \\(z=-x\\), so\n\\[\n(x-y)(x-z)=2 x(x+0.5),\n\\]\nwhich obtain the minimum at \\(x=-1 / 4\\). This gives the desired equality case.\n- If the global minimum lies in the interior \\((-0.5,0.5)^{3}\\), then we apply Lagrange multiplier:\n\\[\n\\begin{aligned}\n\\frac{\\partial}{\\partial x}(x-y)(x-z) & =\\lambda \\frac{\\partial}{\\partial x}(x+y+z) \\\\\n\\frac{\\partial}{\\partial y}(x-y)(x-z) & =\\lambda \\frac{\\partial}{\\partial y}(x+y+z) \\Longrightarrow z-x=\\lambda . \\\\\n\\frac{\\partial}{\\partial z}(x-y)(x-z) & =\\lambda \\frac{\\partial}{\\partial z}(x+y+z) \\Longrightarrow y-x=\\lambda .\n\\end{aligned}\n\\]\n\nAdding the last two equations gives \\(\\lambda=0\\), or \\(x=y=z\\). This gives \\((x-y)(x-z)=0\\), not the minimum.\n\nHaving exhausted all cases, we are done.", "source_pdf": "apmo_2022.pdf", "notes": ""}
{"id": "APMO-2017-1", "contest": "APMO", "year": "2017", "problem_number": "1", "problem": "We call a 5-tuple of integers arrangeable if its elements can be labeled \\(a\\), \\(b, c, d, e\\) in some order so that \\(a-b+c-d+e=29\\). Determine all 2017-tuples of integers \\(n_{1}, n_{2}, \\ldots, n_{2017}\\) such that if we place them in a circle in clockwise order, then any 5 -tuple of numbers in consecutive positions on the circle is arrangeable.\n\nAnswer: \\(n_{1}=\\cdots=n_{2017}=29\\).", "solution": "Solution. A valid 2017-tuple is \\(n_{1}=\\cdots=n_{2017}=29\\). We will show that it is the only solution.\n\nWe first replace each number \\(n_{i}\\) in the circle by \\(m_{i}:=n_{i}-29\\). Since the condition \\(a-b+ c-d+e=29\\) can be rewritten as \\((a-29)-(b-29)+(c-29)-(d-29)+(e-29)=0\\), we have that any five consecutive replaced integers in the circle can be labeled \\(a, b, c, d, e\\) in such a way that \\(a-b+c-d+e=0\\). We claim that this is possible only when all of the \\(m_{i}\\) 's are 0 (and thus all of the original \\(n_{i}\\) 's are 29).\n\nWe work with indexes modulo 2017. Notice that for every \\(i, m_{i}\\) and \\(m_{i+5}\\) have the same parity. Indeed, this follows from \\(m_{i} \\equiv m_{i+1}+m_{i+2}+m_{i+3}+m_{i+4} \\equiv m_{i+5}(\\bmod 2)\\). Since \\(\\operatorname{gcd}(5,2017)=1\\), this implies that all \\(m_{i}\\) 's are of the same parity. Since \\(m_{1}+m_{2}+m_{3}+m_{4}+m_{5}\\) is even, all \\(m_{i}\\) 's must be even as well.\n\nSuppose for the sake of contradiction that not all \\(m_{i}\\) 's are zero. Then our condition still holds when we divide each number in the circle by 2 . However, by performing repeated divisions, we eventually reach a point where some \\(m_{i}\\) is odd. This is a contradiction.", "source_pdf": "apmo_2017.pdf", "notes": ""}
{"id": "APMO-2017-2", "contest": "APMO", "year": "2017", "problem_number": "2", "problem": "Let \\(A B C\\) be a triangle with \\(A B<A C\\). Let \\(D\\) be the intersection point of the internal bisector of angle \\(B A C\\) and the circumcircle of \\(A B C\\). Let \\(Z\\) be the intersection point of the perpendicular bisector of \\(A C\\) with the external bisector of angle \\(\\angle B A C\\). Prove that the midpoint of the segment \\(A B\\) lies on the circumcircle of triangle \\(A D Z\\).", "solution": "Solution 1. Let \\(N\\) be the midpoint of \\(A C\\). Let \\(M\\) be the intersection point of the circumcircle of triangle \\(A D Z\\) and the segment \\(A B\\). We will show that \\(M\\) is the midpoint of \\(A B\\). To do this, let \\(D^{\\prime}\\) the reflection of \\(D\\) with respect to \\(M\\). It suffices to show that \\(A D B D^{\\prime}\\) is a parallelogram.\n\nThe internal and external bisectors of an angle in a triangle are perpendicular. This implies that \\(Z D\\) is a diameter of the circumcircle of \\(A Z D\\) and thus \\(\\angle Z M D=90^{\\circ}\\). This means that \\(Z M\\) is the perpendicular bisector of \\(D^{\\prime} D\\) and thus \\(Z D^{\\prime}=Z D\\). By construction, \\(Z\\) is in the perpendicular bisector of \\(A C\\) and thus \\(Z A=Z C\\).\n\nNow, let \\(\\alpha\\) be the angle \\(\\angle B A D=\\angle D A C\\). In the cyclic quadrilateral \\(A Z D M\\) we get \\(\\angle M Z D=\\angle M A D=\\alpha\\), and thus \\(\\angle D^{\\prime} Z D=2 \\alpha\\). By angle chasing we get\n\\[\n\\angle A Z N=90^{\\circ}-\\angle Z A N=\\angle D A C=\\alpha,\n\\]\nwhich implies that \\(\\angle A Z C=2 \\alpha\\). Therefore,\n\\[\n\\angle D^{\\prime} Z A=\\angle D^{\\prime} Z D-\\angle A Z D=2 \\alpha-\\angle A Z D=\\angle A Z C-\\angle A Z D=\\angle D Z C .\n\\]\n\nCombining \\(\\angle D^{\\prime} Z A=\\angle D Z C, Z D^{\\prime}=Z D\\) and \\(Z A=Z C\\), we obtain by the \\(S A S\\) criterion that the triangles \\(D^{\\prime} Z A\\) and \\(D Z C\\) are congruent. In particular, \\(D^{\\prime} A=D C\\) and \\(\\angle D^{\\prime} A Z= \\angle D C Z\\). From here \\(D B=D C=D^{\\prime} A\\).\n\nFinally, let \\(\\beta=\\angle A B C=\\angle A D C\\). We get the first of the following equalities by the sum of angles around point \\(A\\) and the second one by the sum of internal angles of quadrilateral \\(A Z C D\\)\n\\[\n\\begin{aligned}\n& 360^{\\circ}=\\angle D^{\\prime} A Z+\\angle Z A D+\\angle D A B+\\angle B A D^{\\prime}=\\angle D^{\\prime} A Z+90^{\\circ}+\\alpha+\\angle B A D^{\\prime} \\\\\n& 360^{\\circ}=\\angle D C Z+\\angle Z A D+\\angle C Z A+\\angle A D C=\\angle D C Z+90^{\\circ}+2 \\alpha+\\beta .\n\\end{aligned}\n\\]\n\nBy canceling equal terms we conclude that \\(\\angle B A D^{\\prime}=\\alpha+\\beta\\). Also, \\(\\angle A B D=\\alpha+\\beta\\). Therefore, the segments \\(D^{\\prime} A\\) and \\(D B\\) are parallel and have the same length. We conclude that \\(A D B D^{\\prime}\\) is a parallelogram. As the diagonals of a parallelogram intersect at their midpoints, we obtain that \\(M\\) is the midpoint of \\(A B\\) as desired.\n![](https://cdn.mathpix.com/cropped/2025_08_23_20e80a7167e7927432a3g-2.jpg?height=983&width=1243&top_left_y=739&top_left_x=402)\n\nVariant of solution. The solution above is indirect in the sense that it assumes that \\(M\\) is in the circumcircle of \\(A Z D\\) and then shows that \\(M\\) is the midpoint of \\(A B\\). We point out that the same ideas in the solution can be used to give a direct solution. Here we present a sketch on how to proceed in this manner.\n\nNow we know that \\(M\\) is the midpoint of the side \\(A B\\). We construct the point \\(D^{\\prime}\\) in the same way. Now we have directly that \\(A D B D^{\\prime}\\) is a parallelogram and thus \\(D^{\\prime} A=D B=D C\\). By construction \\(Z A=Z C\\). Also, the two sums of angles equal to \\(360^{\\circ}\\) in the previous solution let us conclude that \\(\\angle D^{\\prime} A Z=\\angle D C Z\\). Once again, we use (differently) the \\(S A S\\) criterion and obtain that the triangles \\(D^{\\prime} A Z\\) and \\(D C Z\\) are congruent. Thus, \\(D^{\\prime} Z=D Z\\).\n\nWe finish the problem by noting that \\(Z M\\) is a median of the isosceles triangle \\(D^{\\prime} Z D\\), so it is also a perpendicular bisector. This shows that \\(\\angle D M Z=90^{\\circ}=\\angle D A Z\\), and therefore \\(M\\) lies in the circumcircle of \\(D A Z\\).\n\nSolution 2. We proceed directly. As above, we name\n\\[\n\\alpha=\\angle D A C=\\angle A Z N=\\angle C Z N=\\angle D C B .\n\\]\n\nLet \\(L\\) be the midpoint of the segment \\(B C\\). Since \\(M\\) and \\(N\\) are midpoints of \\(A B\\) and \\(A C\\), we have that \\(M N=C L\\) and that the segment \\(M N\\) is parallel to \\(B C\\). Thus, \\(\\angle A N M=\\angle A C B\\).\n\nTherefore, \\(\\angle Z N M=\\angle A C B+90^{\\circ}\\). Also, \\(\\angle D C Z=\\angle D C B+\\angle A C B+\\angle Z C A=\\angle A C B+90^{\\circ}\\). We conclude that \\(\\angle Z N M=\\angle D C Z\\).\n\nNow, the triangles \\(Z N C\\) and \\(C L D\\) are similar since \\(\\angle D C L=90^{\\circ}=\\angle C N Z\\) and \\(\\angle D C L= \\alpha=\\angle C Z N\\). We use this fact to obtain the following chain of equalities\n\\[\n\\frac{C D}{M N}=\\frac{C D}{C L}=\\frac{C Z}{Z N}\n\\]\n\nWe combine the equality above with \\(\\angle Z N M=\\angle D C Z\\) to conclude that the triangles \\(Z N M\\) and \\(Z C D\\) are similar. In particular, \\(\\angle M Z N=\\angle D Z C\\) and \\(\\frac{Z M}{Z N}=\\frac{Z D}{Z C}\\). Since we also have \\(\\angle M Z D=\\angle M Z N+\\angle N Z D=\\angle D Z C+\\angle N Z D=\\angle N Z C\\), we conclude that the triangles \\(M Z D\\) and \\(N Z C\\) are similar. This yields that \\(\\angle Z M D=90^{\\circ}\\) and therefore \\(M\\) is in the circumcircle of triangle \\(D A Z\\).\n\nSolution 3. Let \\(m\\) be the perpendicular bisector of \\(A D\\); thus \\(m\\) passes through the center \\(O\\) of the circumcircle of triangle \\(A B C\\). Since \\(A D\\) is the internal angle bisector of \\(A\\) and \\(O M\\) and \\(O N\\) are perpendicular to \\(A B\\) and \\(A C\\) respectively, we obtain that \\(O M\\) and \\(O N\\) form equal angles with \\(A D\\). This implies that they are symmetric with respect to \\(M\\).\n\nTherefore, the line \\(M O\\) passes through the point \\(Z^{\\prime}\\) symmetrical to \\(Z\\) with respect to \\(m\\). Since \\(\\angle D A Z=90^{\\circ}\\), then also \\(\\angle A D Z^{\\prime}=90^{\\circ}\\). Moreover, since \\(A Z=D Z^{\\prime}\\), we have that \\(\\angle A Z Z^{\\prime}=\\angle D Z^{\\prime} Z=90^{\\circ}\\), so \\(A Z Z^{\\prime} D\\) is a rectangle. Since \\(\\angle A M Z^{\\prime}=\\angle A M O=90^{\\circ}\\), we conclude that \\(M\\) is in the circle with diameter \\(A Z^{\\prime}\\), which is the circumcircle of the rectangle. Thus \\(M\\) lies on the circumcircle of the triangle \\(A D Z\\).", "source_pdf": "apmo_2017.pdf", "notes": ""}
{"id": "APMO-2017-3", "contest": "APMO", "year": "2017", "problem_number": "3", "problem": "Let \\(A(n)\\) denote the number of sequences \\(a_{1} \\geq a_{2} \\geq \\ldots \\geq a_{k}\\) of positive integers for which \\(a_{1}+\\cdots+a_{k}=n\\) and each \\(a_{i}+1\\) is a power of two ( \\(i=1,2, \\ldots, k\\) ). Let \\(B(n)\\) denote the number of sequences \\(b_{1} \\geq b_{2} \\geq \\ldots \\geq b_{m}\\) of positive integers for which \\(b_{1}+\\cdots+b_{m}=n\\) and each inequality \\(b_{j} \\geq 2 b_{j+1}\\) holds ( \\(j=1,2, \\ldots, m-1\\) ).\n\nProve that \\(A(n)=B(n)\\) for every positive integer \\(n\\).", "solution": "Solution. We say that a sequence \\(a_{1} \\geq a_{2} \\geq \\ldots \\geq a_{k}\\) of positive integers has type \\(A\\) if \\(a_{i}+1\\) is a power of two for \\(i=1,2, \\ldots, k\\). We say that a sequence \\(b_{1} \\geq b_{2} \\geq \\ldots \\geq b_{m}\\) of positive integer has type \\(B\\) if \\(b_{j} \\geq 2 b_{j+1}\\) for \\(j=1,2, \\ldots, m-1\\).\n\nRecall that the binary representation of a positive integer expresses it as a sum of distinct powers of two in a unique way. Furthermore, we have the following formula for every positive integer \\(N\\)\n\\[\n2^{N}-1=2^{N-1}+2^{N-2}+\\cdots+2^{1}+2^{0}\n\\]\n\nGiven a sequence \\(a_{1} \\geq a_{2} \\geq \\ldots \\geq a_{k}\\) of type \\(A\\), use the preceding formula to express each term as a sum of powers of two. Write these powers of two in left-aligned rows, in decreasing order of size. By construction, \\(a_{i}\\) is the sum of the numbers in the \\(i\\) th row. For example, we obtain the following array when we start with the type A sequence \\(15,15,7,3,3,3,1\\).\n\n\\begin{tabular}{llll}\n8 & 4 & 2 & 1 \\\\\n8 & 4 & 2 & 1 \\\\\n4 & 2 & 1 & \\\\\n2 & 1 & & \\\\\n2 & 1 & & \\\\\n2 & 1 & & \\\\\n1 & & & \\\\\n\\hline 27 & 13 & 5 & 2\n\\end{tabular}\n\nDefine the sequence \\(b_{1}, b_{2}, \\ldots, b_{n}\\) by setting \\(b_{j}\\) to be the sum of the numbers in the \\(j\\) th column of the array. For example, we obtain the sequence \\(27,13,5,2\\) from the array above. We now show that this new sequence has type B. This is clear from the fact that each column in the array contains at least as many entries as the column to the right of it and that each number larger than 1 in the array is twice the number to the right of it. Furthermore, it is clear that \\(a_{1}+a_{2}+\\cdots+a_{k}=b_{1}+b_{2}+\\cdots+b_{m}\\), since both are equal to the sum of all the entries in the array.\n\nWe now show that we can do this operation backwards. Suppose that we are given a type B sequence \\(b_{1} \\geq b_{2} \\geq \\ldots \\geq b_{m}\\). We construct an array inductively as follows:\n- We fill \\(b_{m}\\) left-aligned rows with the numbers \\(2^{m-1}, 2^{m-2}, \\ldots, 2^{1}, 2^{0}\\).\n- Then we fill \\(b_{m-1}-2 b_{m}\\) left aligned rows with the numbers \\(2^{m-2}, 2^{m-3}, \\ldots, 2^{1}, 2^{0}\\).\n- Then we fill \\(b_{m-2}-2 b_{m-1}\\) left aligned rows with the numbers \\(2^{m-3}, 2^{m-4}, \\ldots, 2^{1}, 2^{0}\\), and so on.\n- In the last step we fill \\(b_{1}-2 b_{2}\\) left-aligned rows with the number 1 .\n\nFor example, if we start with the type B sequence \\(27,13,5,2\\), we obtain once again the array above. We define the sequence \\(a_{1}, a_{2}, \\ldots, a_{k}\\) by setting \\(a_{i}\\) to be the sum of the numbers in the \\(i\\) th row of the array. By construction, this sequence has type A. Furthermore, it is clear that \\(a_{1}+\\cdots+a_{k}=b_{1}+\\cdots+b_{m}\\), since once again both sums are equal to the sum of all the entries in the array.\n\nWe have defined an operation that starts with a sequence of type A, produces an array whose row sums are given by the sequence, and outputs a sequence of type B corresponding to the column sums. We have also defined an operation that starts with a sequence of type B, produces an array whose column sums are given by the sequence, and outputs a sequence of type A corresponding to the row sums. The arrays produced in both cases comprise leftaligned rows of the form \\(2^{N-1}, 2^{N-2}, \\ldots, 2^{1}, 2^{0}\\), with non-increasing lengths. Let us refer to arrays obeying these properties as marvelous.\n\nTo show that these two operations are inverses of each other, it then suffices to prove that marvelous arrays are uniquely defined by either their row sums or their column sums. The former is obviously true and the latter arises from the observation that each step in the above inductive algorithm was forced in order to create a marvelous array with the prescribed column sums.\n\nThus, we have produced a bijection between the sequences of type A with sum \\(n\\) and the sequences of type B with sum \\(n\\). So we can conclude that \\(A(n)=B(n)\\) for every positive integer \\(n\\).\n\nRemark The solution above provides a bijection between type A and type B sequences via an algorithm. There are alternative ways to provide such a bijection. For example, given the numbers \\(a_{1} \\geq \\ldots \\geq a_{k}\\) we may define the \\(b_{i}\\) 's as\n\\[\nb_{j}=\\sum_{i}\\left\\lfloor\\frac{a_{i}+1}{2^{j}}\\right\\rfloor .\n\\]\n\nConversely, given the numbers \\(b_{1} \\geq \\ldots \\geq b_{m}\\), one may define the \\(a_{i}\\) 's by taking, as in the solution, \\(b_{m}\\) numbers equal to \\(2^{m}-1, b_{m-1}-2 b_{m}\\) numbers equal to \\(2^{m-1}-1, \\ldots\\), and \\(b_{1}-2 b_{2}\\) numbers equal to \\(2^{1}-1\\). One now needs to verify that these maps are mutually inverse.", "source_pdf": "apmo_2017.pdf", "notes": ""}
{"id": "APMO-2017-4", "contest": "APMO", "year": "2017", "problem_number": "4", "problem": "Call a rational number \\(r\\) powerful if \\(r\\) can be expressed in the form \\(\\frac{p^{k}}{q}\\) for some relatively prime positive integers \\(p, q\\) and some integer \\(k>1\\). Let \\(a, b, c\\) be positive\nrational numbers such that \\(a b c=1\\). Suppose there exist positive integers \\(x, y, z\\) such that \\(a^{x}+b^{y}+c^{z}\\) is an integer. Prove that \\(a, b, c\\) are all powerful.", "solution": "Solution. Let \\(a=\\frac{a_{1}}{b_{1}}, b=\\frac{a_{2}}{b_{2}}\\), where \\(\\operatorname{gcd}\\left(a_{1}, b_{1}\\right)=\\operatorname{gcd}\\left(a_{2}, b_{2}\\right)=1\\). Then \\(c=\\frac{b_{1} b_{2}}{a_{1} a_{2}}\\). The condition that \\(a^{x}+b^{y}+c^{z}\\) is an integer becomes\n\\[\n\\frac{a_{1}^{x+z} a_{2}^{z} b_{2}^{y}+a_{1}^{z} a_{2}^{y+z} b_{1}^{x}+b_{1}^{x+z} b_{2}^{y+z}}{a_{1}^{z} a_{2}^{z} b_{1}^{x} b_{2}^{y}} \\in \\mathbb{Z}\n\\]\nwhich can be restated as\n\\[\na_{1}^{z} a_{2}^{z} b_{1}^{x} b_{2}^{y} \\mid a_{1}^{x+z} a_{2}^{z} b_{2}^{y}+a_{1}^{z} a_{2}^{y+z} b_{1}^{x}+b_{1}^{x+z} b_{2}^{y+z}\n\\]\n\nIn particular, \\(a_{1}^{z}\\) divides the right-hand side. Since it divides the first and second terms in the sum, we conclude that \\(a_{1}^{z} \\mid b_{1}^{x+z} b_{2}^{y+z}\\). Since \\(\\operatorname{gcd}\\left(a_{1}, b_{1}\\right)=1\\), we have \\(a_{1}^{z} \\mid b_{2}^{y+z}\\).\n\nLet \\(p\\) be a prime that divides \\(a_{1}\\). Let \\(m, n \\geq 1\\) be integers such that \\(p^{n} \\| a_{1}\\) (i.e. \\(p^{n} \\mid a_{1}\\) but \\(p^{n+1} \\nmid a_{1}\\) ) and \\(p^{m} \\| b_{2}\\). The fact that \\(a_{1}^{z} \\mid b_{2}^{y+z}\\) implies \\(n z \\leq m(y+z)\\). Since \\(\\operatorname{gcd}\\left(a_{1}, b_{1}\\right)= \\operatorname{gcd}\\left(a_{2}, b_{2}\\right)=1\\), we have \\(p\\) does not divide \\(b_{1}\\) and does not divide \\(a_{2}\\). Thus\n\\[\np^{n z} \\| a_{1}^{z} a_{2}^{y+z} b_{1}^{x} \\text { and } p^{m(y+z)} \\| b_{1}^{x+z} b_{2}^{y+z}\n\\]\n\nOn the other hand, (1) implies that\n\\[\np^{n z+m y} \\mid a_{1}^{z} a_{2}^{y+z} b_{1}^{x}+b_{1}^{x+z} b_{2}^{y+z}\n\\]\n\nIf \\(n z<m(y+z)\\), then (2) gives \\(p^{n z} \\| a_{1}^{z} a_{2}^{y+z} b_{1}^{x}+b_{1}^{x+z} b_{2}^{y+z}\\), which contradicts (3). Thus \\(n z=m(y+z)\\) so \\(n\\) is divisible by \\(k:=\\frac{y+z}{\\operatorname{gcd}(z, y+z)}>1\\). Thus each exponent in the prime decomposition of \\(a_{1}\\) must be divisible by \\(k\\). Hence \\(a_{1}\\) is a perfect \\(k\\)-power which means \\(a\\) is powerful. Similarly, \\(b\\) and \\(c\\) are also powerful.", "source_pdf": "apmo_2017.pdf", "notes": ""}
{"id": "APMO-2017-5", "contest": "APMO", "year": "2017", "problem_number": "5", "problem": "Let \\(n\\) be a positive integer. A pair of \\(n\\)-tuples ( \\(a_{1}, \\ldots, a_{n}\\) ) and ( \\(b_{1}, \\ldots, b_{n}\\) ) with integer entries is called an exquisite pair if\n\\[\n\\left|a_{1} b_{1}+\\cdots+a_{n} b_{n}\\right| \\leq 1\n\\]\n\nDetermine the maximum number of distinct \\(n\\)-tuples with integer entries such that any two of them form an exquisite pair.\n\nAnswer: The maximum is \\(n^{2}+n+1\\).", "solution": "Solution. First, we construct an example with \\(n^{2}+n+1 n\\)-tuples, each two of them forming an exquisite pair. In the following list, \\(*\\) represents any number of zeros as long as the total number of entries is \\(n\\).\n- \\((*)\\)\n- \\((*, 1, *)\\)\n- \\((*,-1, *)\\)\n- \\((*, 1, *, 1, *)\\)\n- \\((*, 1, *,-1, *)\\)\n\nFor example, for \\(n=2\\) we have the tuples \\((0,0),(0,1),(1,0),(0,-1),(-1,0),(1,1),(1,-1)\\).\nThe total number of such tuples is \\(1+n+n+\\binom{n}{2}+\\binom{n}{2}=n^{2}+n+1\\). For any two of them, at most two of the products \\(a_{i} b_{i}\\) are non-zero. The only case in which two of them are non-zero is when we take a sequence ( \\(*, 1, *, 1, *\\) ) and a sequence ( \\(*, 1, *,-1, *\\) ) with zero entries in the same places. But in this case one \\(a_{i} b_{i}\\) is 1 and the other -1 . This shows that any two of these sequences form an exquisite pair.\n\nNext, we claim that among any \\(n^{2}+n+2\\) tuples, some two of them do not form an exquisite pair. We begin with lemma.\n\nLemma. Given \\(2 n+1\\) distinct non-zero \\(n\\)-tuples of real numbers, some two of them \\(\\left(a_{1}, \\ldots, a_{n}\\right)\\) and \\(\\left(b_{1}, \\ldots, b_{n}\\right)\\) satisfy \\(a_{1} b_{1}+\\cdots+a_{n} b_{n}>0\\).\n\nProof of Lemma. We proceed by induction. The statement is easy for \\(n=1\\) since for every three non-zero numbers there are two of them with the same sign. Assume that the statement is true for \\(n-1\\) and consider \\(2 n+1\\) tuples with \\(n\\) entries. Since we are working with tuples of real numbers, we claim that we may assume that one of the tuples is \\(a=(0,0, \\ldots, 0,-1)\\). Let us postpone the proof of this claim for the moment.\n\nIf one of the remaining tuples \\(b\\) has a negative last entry, then \\(a\\) and \\(b\\) satisfy the desired condition. So we may assume all the remaining tuples has a non-negative last entry. Now, from each tuple remove the last number. If two \\(n\\)-tuples \\(b\\) and \\(c\\) yield the same ( \\(n-1\\) )-tuple, then\n\\[\nb_{1} c_{1}+\\cdots+b_{n-1} c_{n-1}+b_{n} c_{n}=b_{1}^{2}+\\cdots+b_{n-1}^{2}+b_{n} c_{n}>0\n\\]\nand we are done. The remaining case is that all the \\(n\\)-tuples yield distinct ( \\(n-1\\) )-tuples. Then at most one of them is the zero ( \\(n-1\\) )-tuple, and thus we can use the inductive hypothesis on \\(2 n-1\\) of them. So we find \\(b\\) and \\(c\\) for which\n\\[\n\\left(b_{1} c_{1}+\\cdots+b_{n-1} c_{n-1}\\right)+b_{n} c_{n}>0+b_{n} c_{n}>0 .\n\\]\n\nThe only thing that we are left to prove is that in the inductive step we may assume that one of the tuples is \\(a=(0,0, \\ldots, 0,-1)\\). Fix one of the tuples \\(x=\\left(x_{1}, \\ldots, x_{n}\\right)\\). Set a real number \\(\\varphi\\) for which \\(\\tan \\varphi=\\frac{x_{1}}{x_{2}}\\). Change each tuple \\(a=\\left(a_{1}, a_{2}, \\ldots, a_{n}\\right)\\) (including \\(x\\) ), to the tuple\n\\[\n\\left(a_{1} \\cos \\varphi-a_{2} \\sin \\varphi, a_{1} \\sin \\varphi+a_{2} \\cos \\varphi, a_{3}, a_{4}, \\ldots, a_{n}\\right) .\n\\]\n\nA straightforward calculation shows that the first coordinate of the tuple \\(x\\) becomes 0 , and that all the expressions of the form \\(a_{1} b_{1}+\\cdots+a_{n} b_{n}\\) are preserved. We may iterate this process until all the entries of \\(x\\) except for the last one are equal to 0 . We finish by multiplying all the entries in all the tuples by a suitable constant that makes the last entry of \\(x\\) equal to -1 . This preserves the sign of all the expressions of the form \\(a_{1} b_{1}+\\cdots+a_{n} b_{n}\\).\n\nWe proceed to the proof of our claim. Let \\(A\\) be a set of non-zero tuples among which any two form an exquisite pair. It suffices to prove that \\(|A| \\leq n^{2}+n\\). We can write \\(A\\) as a disjoint union of subsets \\(A_{1} \\cup A_{2} \\cup \\ldots \\cup A_{n}\\), where \\(A_{i}\\) is the set of tuples in \\(A\\) whose last non-zero entry appears in the \\(i\\) th position. We will show that \\(\\left|A_{i}\\right| \\leq 2 i\\), which will finish our proof since \\(2+4+\\cdots+2 n=n^{2}+n\\).\n\nProceeding by contradiction, suppose that \\(\\left|A_{i}\\right| \\geq 2 i+1\\). If \\(A_{i}\\) has three or more tuples whose only non-zero entry is in the \\(i\\) th position, then for two of them this entry has the same sign. Since the tuples are different and their entries are integers, this yields two tuples for which \\(\\left|\\sum a_{i} b_{i}\\right| \\geq 2\\), a contradiction. So there are at most two such tuples. We remove them from \\(A_{i}\\).\n\nNow, for each of the remaining tuples \\(a\\), if it has a positive \\(i\\) th coordinate, we keep \\(a\\) as it is. If it has a negative \\(i\\) th coordinate, we replace it with the opposite tuple \\(-a\\) with entries with opposite signs. This does not changes the exquisite pairs condition.\n\nAfter making the necessary changes, we have two cases. The first case is that there are two tuples \\(a\\) and \\(b\\) that have the same first \\(i-1\\) coordinates and thus\n\\[\na_{1} b_{1}+\\cdots+a_{i-1} b_{i-1}=a_{1}^{2}+\\cdots+a_{i-1}^{2}>0\n\\]\nand thus is at least 1 (the entries are integers). The second case is that no two tuples have the same first \\(i-1\\) coordinates, but then by the Lemma we find two tuples \\(a\\) and \\(b\\) for which\n\\[\na_{1} b_{1}+\\cdots+a_{i-1} b_{i-1} \\geq 1\n\\]\n\nIn any case, we obtain\n\\[\na_{1} b_{1}+\\cdots+a_{i-1} b_{i-1}+a_{i} b_{i} \\geq 2 .\n\\]\n\nThis yields a final contradiction to the exquisite pair hypothesis.", "source_pdf": "apmo_2017.pdf", "notes": ""}
{"id": "APMO-2021-1", "contest": "APMO", "year": "2021", "problem_number": "1", "problem": "Prove that for each real number \\(r>2\\), there are exactly two or three positive real numbers \\(x\\) satisfying the equation \\(x^{2}=r\\lfloor x\\rfloor\\).\nNote: \\(\\lfloor x\\rfloor\\) denotes the largest integer less than or equal to \\(x\\)", "solution": "Solution Let \\(r>2\\) be a real number. Let \\(x\\) be a positive real number such that \\(x^{2}=r\\lfloor x\\rfloor\\) with \\(\\lfloor x\\rfloor=k\\). Since \\(x>0\\) and \\(x^{2}=r k\\), we also have \\(k>0\\). From \\(k \\leq x<k+1\\), we get \\(k^{2} \\leq x^{2}=r k< k^{2}+2 k+1 \\leq k^{2}+3 k\\), hence \\(k \\leq r<k+3\\), or \\(r-3<k \\leq r\\). There are at most three positive integers in the interval \\((r-3, r]\\). Thus there are at most three possible values for \\(k\\). Consequently, there are at most three positive solutions to the given equation.\n\nNow suppose that \\(k\\) is a positive integer in the interval \\([r-2, r]\\). There are at least two such positive integer. Observe that \\(k \\leq \\sqrt{r k} \\leq \\sqrt{(k+2) k}<k+1\\) and so \\(r k=r\\lfloor\\sqrt{r k}\\rfloor\\). We conclude that the equation \\(x^{2}=r\\lfloor x\\rfloor\\) has at least two positive solutions, namely \\(x=\\sqrt{r k}\\) with \\(k \\in[r-2, r]\\).", "source_pdf": "apmo_2021.pdf", "notes": ""}
{"id": "APMO-2021-2", "contest": "APMO", "year": "2021", "problem_number": "2", "problem": "For a polynomial \\(P\\) and a positive integer \\(n\\), define \\(P_{n}\\) as the number of positive integer pairs ( \\(a, b\\) ) such that \\(a<b \\leq n\\) and \\(|P(a)|-|P(b)|\\) is divisible by \\(n\\).\nDetermine all polynomial \\(P\\) with integer coefficients such that for all positive integers \\(n, P_{n} \\leq 2021\\).", "solution": "Solution There are two possible families of solutions:\n- \\(P(x)=x+d\\), for some integer \\(d \\geq-2022\\).\n- \\(P(x)=-x+d\\), for some integer \\(d \\leq 2022\\).\n\nSuppose \\(P\\) satisfies the problem conditions. Clearly \\(P\\) cannot be a constant polynomial. Notice that a polynomial \\(P\\) satifies the conditions if and only if \\(-P\\) also satisfies them. Hence, we may assume the leading coefficient of \\(P\\) is positive. Then, there exists positive integer \\(M\\) such that \\(P(x)>0\\) for \\(x \\geq M\\).\n\nLemma 1. For any positive integer \\(n\\), the integers \\(P(1), P(2), \\ldots, P(n)\\) leave pairwise distinct remainders upon division by \\(n\\).\n\nProof. Assume for contradiction that this is not the case. Then, for some \\(1 \\leq y<z \\leq n\\), there exists \\(0 \\leq r \\leq n-1\\) such that \\(P(y) \\equiv P(z) \\equiv r(\\bmod n)\\). Since \\(P(a n+b) \\equiv P(b)(\\bmod n)\\) for all \\(a, b\\) integers, we have \\(P(a n+y) \\equiv P(a n+z) \\equiv r(\\bmod n)\\) for any integer \\(a\\). Let \\(A\\) be a positive integer such that \\(A n \\geq M\\), and let \\(k\\) be a positive integer such that \\(k>2 A+2021\\). Each of the \\(2(k-A)\\) integers \\(P(A n+y), P(A n+z), P((A+1) n+y), P((A+1) n+z), \\ldots, P((k-1) n+y), P((k-1) n+z)\\) leaves one of the \\(k\\) remainders\n\\[\nr, n+r, 2 n+r, \\ldots,(k-1) n+r\n\\]\nupon division by \\(k n\\). This implies that at least \\(2(k-A)-k=k-2 A\\) (possibly overlapping) pairs leave the same remainder upon division by \\(k n\\). Since \\(k-2 A>2021\\) and all of the \\(2(k-A)\\) integers are positive, we find more than 2021 pairs \\(a, b\\) with \\(a<b \\leq k n\\) for which \\(|P(b)|-|P(a)|\\) is divisible by \\(k n-\\) hence, \\(P_{k n}>2021\\), a contradiction.\n\nNext, we show that \\(P\\) is linear. Assume that this is not the case, i.e., \\(\\operatorname{deg} P \\geq 2\\). Then we can find a positive integer \\(k\\) such that \\(P(k)-P(1) \\geq k\\). This means that among the integers \\(P(1), P(2), \\ldots, P(P(k)-P(1))\\), two of them, namely \\(P(k)\\) and \\(P(1)\\), leave the same remainder upon division by \\(P(k)-P(1)\\) - contradicting the lemma (by taking \\(n=P(k)-P(1)\\) ). Hence, \\(P\\) must be linear.\nWe can now write \\(P(x)=c x+d\\) with \\(c>0\\). We prove that \\(c=1\\) by two ways.\nSolution 1 If \\(c \\geq 2\\), then \\(P(1)\\) and \\(P(2)\\) leave the same remainder upon division by \\(c\\), contradicting the Lemma. Hence \\(c=1\\).\n\nSolution 2 Suppose \\(c \\geq 2\\). Let \\(n\\) be a positive integer such that \\(n>2 c M, n\\left(1-\\frac{3}{2 c}\\right)>2022\\) and \\(2 c \\mid n\\). Notice that for any positive integers \\(i\\) such that \\(\\frac{3 n}{2 c}+i<n, P\\left(\\frac{3 n}{2 c}+i\\right)-P\\left(\\frac{n}{2 c}+i\\right)=n\\). Hence, \\(\\left(\\frac{n}{2 c}+i, \\frac{3 n}{2 c}+i\\right)\\) satifies the condition in the question for all positive integers \\(i\\) such that \\(\\frac{3 n}{2 c}+i<n\\). Hence, \\(P_{n}>2021\\), a contradiction. Then, \\(c=1\\).\n\nIf \\(d \\leq-2023\\), then there are at least 2022 pairs \\(a<b\\) such that \\(P(a)=P(b)\\), namely \\((a, b)= (1,-2 d-1),(2,-2 d-2), \\ldots,(-d-1,-d+1)\\). This implies that \\(d \\geq-2022\\).\nFinally, we verify that \\(P(x)=x+d\\) satisfies the condition for any \\(d \\geq-2022\\). Fix a positive integer \\(n\\). Note that \\(||P(b)|-|P(a)||<n\\) for all positive integers \\(a<b \\leq n\\), so the only pairs \\(a, b\\) for which \\(|P(b)|-|P(a)|\\) could be divisible by \\(n\\) are those for which \\(|P(a)|=|P(b)|\\). When \\(d \\geq-2022\\), there are indeed at most 2021 such pairs.", "source_pdf": "apmo_2021.pdf", "notes": ""}
{"id": "APMO-2021-3", "contest": "APMO", "year": "2021", "problem_number": "3", "problem": "Let \\(A B C D\\) be a cyclic convex quadrilateral and \\(\\Gamma\\) be its circumcircle. Let \\(E\\) be the intersection of the diagonals \\(A C\\) and \\(B D\\), let \\(L\\) be the center of the circle tangent to sides \\(A B, B C\\), and \\(C D\\), and let \\(M\\) be the midpoint of the \\(\\operatorname{arc} B C\\) of \\(\\Gamma\\) not containing \\(A\\) and \\(D\\). Prove that the excenter of triangle \\(B C E\\) opposite \\(E\\) lies on the line \\(L M\\).", "solution": "\\section*{Solution 1}\n\nLet \\(L\\) be the intersection of the bisectors of \\(\\angle A B C\\) and \\(\\angle B C D\\). Let \\(N\\) be the \\(E\\)-excenter of \\(\\triangle B C E\\). Let \\(\\angle B A C=\\angle B D C=\\alpha, \\angle D B C=\\beta\\) and \\(\\angle A C B=\\gamma\\).\nWe have the following:\n\\[\n\\begin{array}{r}\n\\angle C B L=\\frac{1}{2} \\angle A B C=90^{\\circ}-\\frac{1}{2} \\alpha-\\frac{1}{2} \\gamma \\text { and } \\angle B C L=90^{\\circ}-\\frac{1}{2} \\alpha-\\frac{1}{2} \\beta, \\\\\n\\angle C B N=90^{\\circ}-\\frac{1}{2} \\beta \\text { and } \\angle B C N=90^{\\circ}-\\frac{1}{2} \\gamma, \\\\\n\\angle M B L=\\angle M B C+\\angle C B L=90^{\\circ}-\\frac{1}{2} \\gamma \\text { and } \\angle M C L=90^{\\circ}-\\frac{1}{2} \\beta, \\\\\n\\angle L C N=\\angle L B N=180^{\\circ}-\\frac{1}{2}(\\alpha+\\beta+\\gamma) .\n\\end{array}\n\\]\n\nApplying the sine rule to \\(\\triangle M B L\\) and \\(\\triangle M C L\\) we obtain\n\\[\n\\frac{M B}{M L}=\\frac{M C}{M L}=\\frac{\\sin \\angle B L M}{\\sin \\angle M B L}=\\frac{\\sin \\angle C L M}{\\sin \\angle M C L}\n\\]\n\nIt follows that\n\\[\n\\frac{\\sin \\angle B L M}{\\sin \\angle C L M}=\\frac{\\sin \\angle M B L}{\\sin \\angle M C L}=\\frac{\\cos (\\gamma / 2)}{\\cos (\\beta / 2)}\n\\]\n\nNow\n\\[\n\\frac{\\sin \\angle B L M}{\\sin \\angle M L C} \\cdot \\frac{\\sin \\angle L C N}{\\sin \\angle N C B} \\cdot \\frac{\\sin \\angle N B C}{\\sin \\angle N B L}=\\frac{\\cos (\\gamma / 2)}{\\cos (\\beta / 2)} \\cdot \\frac{\\sin \\left(90^{\\circ}-\\frac{1}{2} \\beta\\right)}{\\sin \\left(90^{\\circ}-\\frac{1}{2} \\gamma\\right)}=1 .\n\\]\n\nHence \\(L M, B N, C N\\) are concurrent and therefore \\(L, M, N\\) are collinear.\n\n\\section*{Alternative proof}\n\nWe proceed similarly as above until the equation (1).\nWe use the following lemma.\nLemma: If \\(\\pi>\\alpha, \\beta, \\gamma, \\delta>0, \\alpha+\\beta=\\gamma+\\delta<\\pi\\), and \\(\\frac{\\sin \\alpha}{\\sin \\beta}=\\frac{\\sin \\gamma}{\\sin \\delta}\\), then \\(\\alpha=\\gamma\\) and \\(\\beta=\\delta\\).\nProof of Lemma: Let \\(\\theta=\\alpha+\\beta=\\gamma+\\delta\\). Then \\(\\frac{\\sin (\\theta-\\beta)}{\\sin \\beta}=\\frac{\\sin (\\theta-\\delta)}{\\sin \\delta}\\).\n\\[\n\\begin{gathered}\n\\Longleftrightarrow \\sin (\\theta-\\beta) \\sin \\delta=\\sin (\\theta-\\delta) \\sin \\beta \\\\\n\\Longleftrightarrow(\\sin \\theta \\cos \\beta-\\sin \\beta \\cos \\theta) \\sin \\delta=(\\sin \\theta \\cos \\delta-\\sin \\delta \\cos \\theta) \\sin \\beta \\\\\n\\Longleftrightarrow \\sin \\theta \\cos \\beta \\sin \\delta=\\sin \\theta \\cos \\delta \\sin \\beta \\\\\n\\Longleftrightarrow \\sin \\theta \\sin (\\beta-\\delta)=0\n\\end{gathered}\n\\]\n\nSince \\(0<\\theta<\\pi\\), then \\(\\sin \\theta \\neq 0\\). Therefore, \\(\\sin (\\beta-\\delta)=0\\), and we must have \\(\\beta=\\delta\\).\nApplying the sine rule to \\(\\triangle N B L\\) and \\(\\triangle N C L\\) we obtain\n\\[\n\\begin{aligned}\n& \\frac{N B}{N L}=\\frac{\\sin \\angle B L N}{\\sin \\angle L B N}, \\\\\n& \\frac{N C}{N L}=\\frac{\\sin \\angle C L N}{\\sin \\angle L C N} .\n\\end{aligned}\n\\]\n\nSince \\(\\angle L B N=\\angle L C N\\), it follows that\n\\[\n\\frac{\\sin \\angle B L N}{\\sin \\angle C L N}=\\frac{N B}{N C}=\\frac{\\sin \\angle B C N}{\\sin \\angle C B N}=\\frac{\\cos (\\gamma / 2)}{\\cos (\\beta / 2)}=\\frac{\\sin \\angle B L M}{\\sin \\angle C L M} .\n\\]\n\nBy the lemma, it is concluded that \\(\\angle B L M=\\angle B L N\\) and \\(\\angle C L M=\\angle C L N\\). Therefore, \\(L, M, N\\) are collinear.\n\n\\section*{Solution 2}\n\nDenote by \\(N\\) the excenter of triangle \\(B C E\\) opposite \\(E\\). Since \\(B L\\) bisects \\(\\angle A B C\\), we have \\(\\angle C B L= \\frac{\\angle A B C}{2}\\). Since \\(M\\) is the midpoint of \\(\\operatorname{arc} B C\\), we have \\(\\angle M B C=\\frac{1}{2}(\\angle M B C+\\angle M C B)\\) It follows by angle chasing that\n\\[\n\\begin{aligned}\n\\angle M B L & =\\angle M B C+\\angle C B L=\\frac{1}{2}(\\angle M B C+\\angle M C B+\\angle A B C) \\\\\n& =\\frac{1}{2}(\\angle M B A+\\angle M C B)=90^{\\circ}-\\frac{\\angle B C E}{2}=\\angle B C N .\n\\end{aligned}\n\\]\n\nDenote by \\(X\\) and \\(Y\\) the second intersections of lines \\(B M\\) and \\(C M\\) with the circumcircle of \\(B C L\\), respectively. Since \\(\\angle M B C=\\angle M C B\\), we have \\(B C \\| X Y\\). It suffices to show that \\(B N \\| X L\\) and \\(C N \\| Y L\\). Indeed, from this it follows that \\(\\triangle B C N \\sim \\triangle X Y L\\), and therefore a homothety with center \\(M\\) that maps \\(B\\) to \\(X\\) and \\(C\\) to \\(Y\\) also maps \\(N\\) to \\(L\\), implying that \\(N\\) lies on the line \\(L M\\).\nBy symmetry, it suffices to show that \\(C N \\| Y L\\), which is equivalent to showing that \\(\\angle B C N=\\angle X Y L\\). But we have \\(\\angle B C N=\\angle M B L=\\angle X B L=\\angle X Y L\\), completing the proof.", "source_pdf": "apmo_2021.pdf", "notes": ""}
{"id": "APMO-2021-4", "contest": "APMO", "year": "2021", "problem_number": "4", "problem": "Given a \\(32 \\times 32\\) table, we put a mouse (facing up) at the bottom left cell and a piece of cheese at several other cells. The mouse then starts moving. It moves forward except that when it reaches a piece of cheese, it eats a part of it, turns right, and continues moving forward. We say that a subset of cells containing cheese is good if, during this process, the mouse tastes each piece of cheese exactly once and then falls off the table. Show that:\n(a) No good subset consists of 888 cells.\n(b) There exists a good subset consisting of at least 666 cells.", "solution": "\\section*{Solution.}\n(a) For the sake of contradiction, assume a good subset consisting of 888 cells exists. We call those cheese-cells and the other ones gap-cells. Observe that since each cheese-cell is visited once, each gap-cell is visited at most twice (once vertically and once horizontally). Define a finite sequence \\(s\\) whose \\(i\\)-th element is \\(C\\) if the \\(i\\)-th step of the mouse was onto a cheese-cell, and \\(G\\) if it was onto a gap-cell. By assumption, \\(s\\) contains \\(888 C\\) 's. Note that \\(s\\) does not contain a contiguous block of 4 (or more) \\(C\\) 's. Hence \\(s\\) contains at least \\(888 / 3=296\\) such \\(C\\)-blocks and thus at least \\(295 G\\) 's. But since each gap-cell is traversed at most twice, this implies there are at least \\(\\lceil 295 / 2\\rceil=148\\) gap-cells, for a total of \\(888+148=1036>32^{2}\\) cells, a contradiction.\n(b) Let \\(L_{i}, X_{i}\\) be two \\(2^{i} \\times 2^{i}\\) tiles that allow the mouse to \"turn left\" and \"cross\", respectively. In detail, the \"turn left\" tiles allow the mouse to enter at its bottom left cell facing up and to leave at its bottom left cell facing left. The \"cross\" tiles allow the mouse to enter at its top right facing down and leave at its bottom left facing left, while also to enter at its bottom left facing up and leave at its top right facing right.\n(a) Basic tiles\n(b) Inductive construction\n(c) \\(16 \\times 16\\)\n![](https://cdn.mathpix.com/cropped/2025_08_23_a9a5617aa8dc98dad087g-4.jpg?height=394&width=1649&top_left_y=1067&top_left_x=243)\n\nNote that given two \\(2^{i} \\times 2^{i}\\) tiles \\(L_{i}, X_{i}\\) we can construct larger \\(2^{i+1} \\times 2^{i+1}\\) tiles \\(L_{i+1}, X_{i+1}\\) inductively as shown on in (b). The construction works because the path intersects itself (or the other path) only inside the smaller \\(X\\)-tiles where it works by induction.\nFor a tile \\(T\\), let \\(|T|\\) be the number of pieces of cheese in it. By straightforward induction, \\(\\left|L_{i}\\right|=\\left|X_{i}\\right|+1\\) and \\(\\left|L_{i+1}\\right|=4 \\cdot\\left|L_{i}\\right|-1\\). From the initial condition \\(\\left|L_{1}\\right|=3\\). We now easily compute \\(\\left|L_{2}\\right|=11,\\left|L_{3}\\right|=43,\\left|L_{4}\\right|=171\\), and \\(\\left|L_{5}\\right|=683\\). Hence we get the desired subset.\n\n\\section*{Another proof of (a).}\n\nLet \\(X_{N}\\) be the largest possible density of cheese-cells in a good subset on an \\(N \\times N\\) table. We will show that \\(X_{N} \\leq 4 / 5+o(1)\\). Specifically, this gives \\(X_{32} \\leq 817 / 1024\\). We look at the (discrete analogue) of the winding number of the trajectory of the mouse. Since the mouse enters and leaves the table, for every 4 right turns in its trajectory there has to be a self-crossing. But each self-crossing requires a different empty square, hence \\(X_{N} \\leq 4 / 5\\).", "source_pdf": "apmo_2021.pdf", "notes": ""}
{"id": "APMO-2021-5", "contest": "APMO", "year": "2021", "problem_number": "5", "problem": "Determine all functions \\(f: \\mathbb{Z} \\rightarrow \\mathbb{Z}\\) such that \\(f(f(a)-b)+b f(2 a)\\) is a perfect square for all integers \\(a\\) and \\(b\\).", "solution": "Solution 1.\nThere are two families of functions which satisfy the condition:\n(1) \\(f(n)= \\begin{cases}0 & \\text { if } n \\text { is even, and } \\\\ \\text { any perfect square } & \\text { if } n \\text { is odd }\\end{cases}\\)\n(2) \\(f(n)=n^{2}\\), for every integer \\(n\\).\n\nIt is straightforward to verify that the two families of functions are indeed solutions. Now, suppose that f is any function which satisfies the condition that \\(f(f(a)-b)+b f(2 a)\\) is a perfect square for every pair ( \\(a, b\\) ) of integers. We denote this condition by (*). We will show that \\(f\\) must belong to either Family (1) or Family (2).\nClaim 1. \\(f(0)=0\\) and \\(f(n)\\) is a perfect square for every integer \\(n\\).\nProof. Plugging \\((a, b) \\rightarrow(0, f(0))\\) in \\((*)\\) shows that \\(f(0)(f(0)+1)=z^{2}\\) for some integer \\(z\\). Thus, \\((2 f(0)+1-2 z)(2 f(0)+1+2 z)=1\\). Therefore, \\(f(0)\\) is either -1 or 0 .\nSuppose, for sake of contradiction, that \\(f(0)=-1\\). For any integer \\(a\\), plugging \\((a, b) \\rightarrow(a, f(a))\\) implies that \\(f(a) f(2 a)-1\\) is a square. Thus, for each \\(a \\in \\mathbb{Z}\\), there exists \\(x \\in \\mathbb{Z}\\) such that \\(f(a) f(2 a)=x^{2}+1\\) This implies that any prime divisor of \\(f(a)\\) is either 2 or is congruent to \\(1(\\bmod 4)\\), and that \\(4 \\nmid f(a)\\), for every \\(a \\in \\mathbb{Z}\\).\nPlugging \\((a, b) \\rightarrow(0,3)\\) in \\((*)\\) shows that \\(f(-4)-3\\) is a square. Thus, there is \\(y \\in \\mathbb{Z}\\) such that \\(f(-4)=y^{2}+3\\). Since \\(4 \\nmid f(-4)\\), we note that \\(f(-4)\\) is a positive integer congruent to \\(3(\\bmod 4)\\), but any prime dividing \\(f(-4)\\) is either 2 or is congruent to \\(1(\\bmod 4)\\). This gives a contradiction. Therefore, \\(f(0)\\) must be 0 .\nFor every integer \\(n\\), plugging \\((a, b) \\rightarrow(0,-n)\\) in \\((*)\\) shows that \\(f(n)\\) is a square.\nReplacing \\(b\\) with \\(f(a)-b\\), we find that for all integers \\(a\\) and \\(b\\),\n\\[\nf(b)+(f(a)-b) f(2 a) \\text { is a square. }\n\\]\n\nNow, let \\(S\\) be the set of all integers \\(n\\) such that \\(f(n)=0\\). We have two cases:\n- Case 1: \\(S\\) is unbounded from above.\n\nWe claim that \\(f(2 n)=0\\) for any integer \\(n\\). Fix some integer \\(n\\), and let \\(k \\in S\\) with \\(k>f(n)\\). Then, plugging \\((a, b) \\mapsto(n, k)\\) in \\((* *)\\) gives us that \\(f(k)+(f(n)-k) f(2 n)=(f(n)-k) f(2 n)\\) is a square. But \\(f(n)-k<0\\) and \\(f(2 n)\\) is a square by Claim 1 . This is possible only if \\(f(2 n)=0\\). In summary, \\(f(n)=0\\) whenever \\(n\\) is even and Claim 1 shows that \\(f(n)\\) is a square whenever \\(n\\) is odd.\n- Case 2: \\(S\\) is bounded from above.\n\nLet \\(T\\) be the set of all integers \\(n\\) such that \\(f(n)=n^{2}\\). We show that \\(T\\) is unbounded from above. In fact, we show that \\(\\frac{p+1}{2} \\in T\\) for all primes \\(p\\) big enough.\nFix a prime number \\(p\\) big enough, and let \\(n=\\frac{p+1}{2}\\). Plugging \\((a, b) \\mapsto(n, 2 n)\\) in (**) shows us that \\(f(2 n)(f(n)-2 n+1)\\) is a square for any integer \\(n\\). For \\(p\\) big enough, we have \\(2 n \\notin S\\), so \\(f(2 n)\\) is a non-zero square. As a result, when \\(p\\) is big enough, \\(f(n)\\) and \\(f(n)-2 n+1=f(n)-p\\) are both squares. Writing \\(f(n)=k^{2}\\) and \\(f(n)-p=m^{2}\\) for some \\(k, m \\geq 0\\), we have\n\\[\n(k+m)(k-m)=k^{2}-m^{2}=p \\Longrightarrow k+m=p, k-m=1 \\Longrightarrow k=n, m=n-1 .\n\\]\n\nThus, \\(f(n)=k^{2}=n^{2}\\), giving us \\(n=\\frac{p+1}{2} \\in T\\).\nNext, for all \\(k \\in T\\) and \\(n \\in \\mathbb{Z}\\), plugging \\((a, b) \\mapsto(n, k)\\) in (**) shows us that \\(k^{2}+(f(n)-k) f(2 n)\\) is a square. But that means \\((2 k-f(2 n))^{2}-\\left(f(2 n)^{2}-4 f(n) f(2 n)\\right)=4\\left(k^{2}+(f(n)-k) f(2 n)\\right)\\) is also a square. When \\(k\\) is large enough, we have \\(\\left|f(2 n)^{2}-4 f(n) f(2 n)\\right|+1<|2 k-f(2 n)|\\). As a result, we must have \\(f(2 n)^{2}=4 f(n) f(2 n)\\) and thus \\(f(2 n) \\in\\{0,4 f(n)\\}\\) for all integers \\(n\\).\nFinally, we prove that \\(f(n)=n^{2}\\) for all integers \\(n\\). Fix \\(n\\), and take \\(k \\in T\\) big enough such that \\(2 k \\notin S\\). Then, we have \\(f(k)=k^{2}\\) and \\(f(2 k)=4 f(k)=4 k^{2}\\). Plugging \\((a, b) \\mapsto(k, n)\\) to (**) shows us that \\(f(n)+\\left(k^{2}-n\\right) 4 k^{2}=\\left(2 k^{2}-n\\right)^{2}+\\left(f(n)-n^{2}\\right)\\) is a square. Since \\(T\\) is unbounded from above, we can take \\(k \\in T\\) such that \\(2 k \\notin S\\) and also \\(\\left|2 k^{2}-n\\right|>\\left|f(n)-n^{2}\\right|\\). This forces \\(f(n)=n^{2}\\), giving us the second family of solution.\n\n\\section*{Another approach of Case 1.}\n\nClaim 2. One of the following is true.\n(i) For every integer \\(n, f(2 n)=0\\).\n(ii) There exists an integer \\(K>0\\) such that for every integer \\(n \\geq K, f(n)>0\\).\n\nProof. Suppose that there exists an integer \\(\\alpha \\neq 0\\) such that \\(f(2 \\alpha)>0\\). We claim that for every integer \\(n \\geq f(\\alpha)+1\\), we have \\(f(n)>0\\).\nFor every \\(n \\geq f(\\alpha)+1\\), plugging \\((a, b) \\rightarrow(\\alpha, f(\\alpha)-n)\\) in \\(\\left(^{*}\\right)\\) shows that \\(f(n)+(f(\\alpha)-n) f(2 \\alpha)\\) is a square, and in particular, is non-negative. Hence, \\(f(n) \\geq(n-f(\\alpha)) f(2 \\alpha)>0\\), as desired.\nIf \\(f\\) belongs to Case (i), Claim 1 shows that \\(f\\) belongs to Family (1).\nIf \\(f\\) belongs to Case (ii), then \\(S\\) is bounded from above. From Case 2 we get \\(f(n)=n^{2}\\).", "source_pdf": "apmo_2021.pdf", "notes": ""}
{"id": "APMO-2023-1", "contest": "APMO", "year": "2023", "problem_number": "1", "problem": "Let \\(n \\geq 5\\) be an integer. Consider \\(n\\) squares with side lengths \\(1,2, \\ldots, n\\), respectively. The squares are arranged in the plane with their sides parallel to the \\(x\\) and \\(y\\) axes. Suppose that no two squares touch, except possibly at their vertices.\nShow that it is possible to arrange these squares in a way such that every square touches exactly two other squares.", "solution": "\\section*{Solution 1}\n\nSet aside the squares with sidelengths \\(n-3, n-2, n-1\\), and \\(n\\) and suppose we can split the remaining squares into two sets \\(A\\) and \\(B\\) such that the sum of the sidelengths of the squares in \\(A\\) is 1 or 2 units larger than the sum of the sidelengths of the squares in \\(B\\).\nString the squares of each set \\(A, B\\) along two parallel diagonals, one for each diagonal. Now use the four largest squares along two perpendicular diagonals to finish the construction: one will have sidelengths \\(n\\) and \\(n-3\\), and the other, sidelengths \\(n-1\\) and \\(n-2\\). If the sum of the sidelengths of the squares in \\(A\\) is 1 unit larger than the sum of the sidelengths of the squares in \\(B\\), attach the squares with sidelengths \\(n-3\\) and \\(n-1\\) to the \\(A\\)-diagonal, and the other two squares to the \\(B\\)-diagonal. The resulting configuration, in which the \\(A\\) and \\(B\\)-diagonals are represented by unit squares, and the sidelengths \\(a_{i}\\) of squares from \\(A\\) and \\(b_{j}\\) of squares from \\(B\\) are indicated within each square, follows:\n![](https://cdn.mathpix.com/cropped/2025_08_23_f8a083d79305c9305a0cg-01.jpg?height=586&width=1329&top_left_y=1199&top_left_x=331)\n\nSince \\(\\left(a_{1}+a_{2}+\\cdots+a_{k}\\right) \\sqrt{2}+\\frac{((n-3)+(n-2)) \\sqrt{2}}{2}=\\left(b_{1}+b_{2}+\\cdots+b_{\\ell}+2\\right) \\sqrt{2}+\\frac{(n+(n-1)) \\sqrt{2}}{2}\\), this case is done.\nIf the sum of the sidelengths of the squares in \\(A\\) is 1 unit larger than the sum of the sidelengths of the squares in \\(B\\), attach the squares with sidelengths \\(n-3\\) and \\(n-2\\) to the \\(A\\)-diagonal, and the other two squares to the \\(B\\)-diagonal. The resulting configuration follows:\n![](https://cdn.mathpix.com/cropped/2025_08_23_f8a083d79305c9305a0cg-01.jpg?height=615&width=1329&top_left_y=2095&top_left_x=331)\n\nSince \\(\\left(a_{1}+a_{2}+\\cdots+a_{k}\\right) \\sqrt{2}+\\frac{((n-3)+(n-1)) \\sqrt{2}}{2}=\\left(b_{1}+b_{2}+\\cdots+b_{\\ell}+1\\right) \\sqrt{2}+\\frac{(n+(n-2)) \\sqrt{2}}{2}\\), this case is also done.\nIn both cases, the distance between the \\(A\\)-diagonal and the \\(B\\)-diagonal is \\(\\frac{((n-3)+n) \\sqrt{2}}{2}=\\frac{(2 n-3) \\sqrt{2}}{2}\\).\nSince \\(a_{i}, b_{j} \\leq n-4, \\frac{\\left(a_{i}+b_{j}\\right) \\sqrt{2}}{2}<\\frac{(2 n-4) \\sqrt{2}}{2}<\\frac{(2 n-3) \\sqrt{2}}{2}\\), and therefore the \\(A\\) - and \\(B\\)-diagonals do not overlap.\nFinally, we prove that it is possible to split the squares of sidelengths 1 to \\(n-4\\) into two sets \\(A\\) and \\(B\\) such that the sum of the sidelengths of the squares in \\(A\\) is 1 or 2 units larger than the sum of the sidelengths of the squares in \\(B\\). One can do that in several ways; we present two possibilities:\n- Direct construction: Split the numbers from 1 to \\(n-4\\) into several sets of four consecutive numbers \\(\\{t, t+1, t+2, t+3\\}\\), beginning with the largest numbers; put squares of sidelengths \\(t\\) and \\(t+3\\) in \\(A\\) and squares of sidelengths \\(t+1\\) and \\(t+2\\) in \\(B\\). Notice that \\(t+(t+3)= (t+1)+(t+2)\\). In the end, at most four numbers remain.\n- If only 1 remains, put the corresponding square in \\(A\\), so the sum of the sidelengths of the squares in \\(A\\) is one unit larger that those in \\(B\\);\n- If 1 and 2 remains, put the square of sidelength 2 in \\(A\\) and the square of sidelength 1 in \\(B\\) (the difference is 1 );\n- If 1,2, and 3 remains, put the squares of sidelengths 1 and 3 in \\(A\\), and the square of sidelength 2 in \\(B\\) (the difference is 2 );\n- If 1,2,3, and 4 remains, put the squares of sidelengths 2 and 4 in \\(A\\), and the squares of sidelengths 1 and 3 in \\(B\\) (the difference is 2 ).\n- Indirect construction: Starting with \\(A\\) and \\(B\\) as empty sets, add the squares of sidelengths \\(n-4, n-3, \\ldots, 2\\) to either \\(A\\) or \\(B\\) in that order such that at each stage the difference between the sum of the sidelengths in \\(A\\) and the sum of the sidelengths of B is minimized. By induction it is clear that after adding an integer \\(j\\) to one of the sets, this difference is at most \\(j\\). In particular, the difference is 0,1 or 2 at the end. Finally adding the final 1 to one of the sets can ensure that the final difference is 1 or 2 . If necessary, flip \\(A\\) and \\(B\\).\n\n\\section*{Solution 2}\n\nSolve the problem by induction in \\(n\\). Construct examples for \\(n=5,6,7,8,9,10\\) (one can use the constructions from the previous solution, for instance). For \\(n>10\\), set aside the six larger squares and arrange them in the following fashion:\n![](https://cdn.mathpix.com/cropped/2025_08_23_f8a083d79305c9305a0cg-02.jpg?height=804&width=1029&top_left_y=1955&top_left_x=482)\n\nBy the induction hypothesis, one can arrange the remaining \\(n-6\\) squares away from the six larger squares, so we are done.", "source_pdf": "apmo_2023.pdf", "notes": ""}
{"id": "APMO-2023-2", "contest": "APMO", "year": "2023", "problem_number": "2", "problem": "Find all integers \\(n\\) satisfying \\(n \\geq 2\\) and \\(\\frac{\\sigma(n)}{p(n)-1}=n\\), in which \\(\\sigma(n)\\) denotes the sum of all positive divisors of \\(n\\), and \\(p(n)\\) denotes the largest prime divisor of \\(n\\).\n\nAnswer: \\(n=6\\).", "solution": "\\section*{Solution}\n\nLet \\(n=p_{1}^{\\alpha_{1}} \\cdot \\ldots \\cdot p_{k}^{\\alpha_{k}}\\) be the prime factorization of \\(n\\) with \\(p_{1}<\\ldots<p_{k}\\), so that \\(p(n)=p_{k}\\) and \\(\\sigma(n)=\\left(1+p_{1}+\\cdots+p_{1}^{\\alpha_{1}}\\right) \\ldots\\left(1+p_{k}+\\cdots+p_{k}^{\\alpha_{k}}\\right)\\). Hence\n\\(p_{k}-1=\\frac{\\sigma(n)}{n}=\\prod_{i=1}^{k}\\left(1+\\frac{1}{p_{i}}+\\cdots+\\frac{1}{p_{i}^{\\alpha_{i}}}\\right)<\\prod_{i=1}^{k} \\frac{1}{1-\\frac{1}{p_{i}}}=\\prod_{i=1}^{k}\\left(1+\\frac{1}{p_{i}-1}\\right) \\leq \\prod_{i=1}^{k}\\left(1+\\frac{1}{i}\\right)=k+1\\),\nthat is, \\(p_{k}-1<k+1\\), which is impossible for \\(k \\geq 3\\), because in this case \\(p_{k}-1 \\geq 2 k-2 \\geq k+1\\). Then \\(k \\leq 2\\) and \\(p_{k}<k+2 \\leq 4\\), which implies \\(p_{k} \\leq 3\\).\nIf \\(k=1\\) then \\(n=p^{\\alpha}\\) and \\(\\sigma(n)=1+p+\\cdots+p^{\\alpha}\\), and in this case \\(n \\nmid \\sigma(n)\\), which is not possible. Thus \\(k=2\\), and \\(n=2^{\\alpha} 3^{\\beta}\\) with \\(\\alpha, \\beta>0\\). If \\(\\alpha>1\\) or \\(\\beta>1\\),\n\\[\n\\frac{\\sigma(n)}{n}>\\left(1+\\frac{1}{2}\\right)\\left(1+\\frac{1}{3}\\right)=2 .\n\\]\n\nTherefore \\(\\alpha=\\beta=1\\) and the only answer is \\(n=6\\).\nComment: There are other ways to deal with the case \\(n=2^{\\alpha} 3^{\\beta}\\). For instance, we have \\(2^{\\alpha+2} 3^{\\beta}=\\left(2^{\\alpha+1}-1\\right)\\left(3^{\\beta+1}-1\\right)\\). Since \\(2^{\\alpha+1}-1\\) is not divisible by 2 , and \\(3^{\\beta+1}-1\\) is not divisible by 3 , we have\n\\[\n\\left\\{\\begin{array} { l } \n{ 2 ^ { \\alpha + 1 } - 1 = 3 ^ { \\beta } } \\\\\n{ 3 ^ { \\beta + 1 } - 1 = 2 ^ { \\alpha + 2 } }\n\\end{array} \\Longleftrightarrow \\left\\{\\begin{array} { c } \n{ 2 ^ { \\alpha + 1 } - 1 = 3 ^ { \\beta } } \\\\\n{ 3 \\cdot ( 2 ^ { \\alpha + 1 } - 1 ) - 1 = 2 \\cdot 2 ^ { \\alpha + 1 } }\n\\end{array} \\Longleftrightarrow \\left\\{\\begin{array}{r}\n2^{\\alpha+1}=4 \\\\\n3^{\\beta}=3\n\\end{array},\\right.\\right.\\right.\n\\]\nand \\(n=2^{\\alpha} 3^{\\beta}=6\\).", "source_pdf": "apmo_2023.pdf", "notes": ""}
{"id": "APMO-2023-3", "contest": "APMO", "year": "2023", "problem_number": "3", "problem": "Let \\(A B C D\\) be a parallelogram. Let \\(W, X, Y\\), and \\(Z\\) be points on sides \\(A B, B C, C D\\), and \\(D A\\), respectively, such that the incenters of triangles \\(A W Z, B X W, C Y X\\) and \\(D Z Y\\) form a parallelogram. Prove that \\(W X Y Z\\) is a parallelogram.", "solution": "\\section*{Solution}\n\nLet the four incenters be \\(I_{1}, I_{2}, I_{3}\\), and \\(I_{4}\\) with inradii \\(r_{1}, r_{2}, r_{3}\\), and \\(r_{4}\\) respectively (in the order given in the question). Without loss of generality, let \\(I_{1}\\) be closer to \\(A B\\) than \\(I_{2}\\). Let the acute angle between \\(I_{1} I_{2}\\) and \\(A B\\) (and hence also the angle between \\(I_{3} I_{4}\\) and \\(C D\\) ) be \\(\\theta\\). Then\n\\[\nr_{2}-r_{1}=I_{1} I_{2} \\sin \\theta=I_{3} I_{4} \\sin \\theta=r_{4}-r_{3},\n\\]\nwhich implies \\(r_{1}+r_{4}=r_{2}+r_{3}\\). Similar arguments show that \\(r_{1}+r_{2}=r_{3}+r_{4}\\). Thus we obtain \\(r_{1}=r_{3}\\) and \\(r_{2}=r_{4}\\).\n![](https://cdn.mathpix.com/cropped/2025_08_23_f8a083d79305c9305a0cg-05.jpg?height=492&width=784&top_left_y=848&top_left_x=596)\n\nNow let's consider the possible positions of \\(W, X, Y, Z\\). Suppose \\(A Z \\neq C X\\). Without loss of generality assume \\(A Z>C X\\). Since the incircles of \\(A W Z\\) and \\(C Y X\\) are symmetric about the centre of the parallelogram \\(A B C D\\), this implies \\(C Y>A W\\). Using similar arguments, we have\n\\[\nC Y>A W \\Longrightarrow B W>D Y \\Longrightarrow D Z>B X \\Longrightarrow C X>A Z,\n\\]\nwhich is a contradiction. Therefore \\(A Z=C X \\Longrightarrow A W=C Y\\) and \\(W X Y Z\\) is a parallelogram.\nComment: There are several ways to prove that \\(r_{1}=r_{3}\\) and \\(r_{2}=r_{4}\\). The proposer shows the following three alternative approaches:\nUsing parallel lines: Let \\(O\\) be the centre of parallelogram \\(A B C D\\) and \\(P\\) be the centre of parallelogram \\(I_{1} I_{2} I_{3} I_{4}\\). Since \\(A I_{1}\\) and \\(C I_{3}\\) are angle bisectors, we must have \\(A I_{1} \\| C I_{3}\\). Let \\(\\ell_{1}\\) be the line through \\(O\\) parallel to \\(A I_{1}\\). Since \\(A O=O C, \\ell_{1}\\) is halfway between \\(A I_{1}\\) and \\(C I_{3}\\). Hence \\(P\\) must lie on \\(\\ell_{1}\\).\nSimilarly, \\(P\\) must also lie on \\(\\ell_{2}\\), the line through \\(O\\) parallel to \\(B I_{2}\\). Thus \\(P\\) is the intersection of \\(\\ell_{1}\\) and \\(\\ell_{2}\\), which must be \\(O\\). So the four incentres and hence the four incircles must be symmetric about \\(O\\), which implies \\(r_{1}=r_{3}\\) and \\(r_{2}=r_{4}\\).\nUsing a rotation: Let the bisectors of \\(\\angle D A B\\) and \\(\\angle A B C\\) meet at \\(X\\) and the bisectors of \\(\\angle B C D\\) and \\(\\angle C D A\\) meet at \\(Y\\). Then \\(I_{1}\\) is on \\(A X, I_{2}\\) is on \\(B X, I_{3}\\) is on \\(C Y\\), and \\(I_{4}\\) is on \\(D Y\\). Let \\(O\\) be the centre of \\(A B C D\\). Then a 180 degree rotation about \\(O\\) takes \\(\\triangle A X B\\) to \\(\\triangle C Y D\\). Under the same transformation \\(I_{1} I_{2}\\) is mapped to a parallel segment \\(I_{1}^{\\prime} I_{2}^{\\prime}\\) with \\(I_{1}^{\\prime}\\) on \\(C Y\\) and \\(I_{2}^{\\prime}\\) on \\(D Y\\). Since \\(I_{1} I_{2} I_{3} I_{4}\\) is a parallelogram, \\(I_{3} I_{4}=I_{1} I_{2}\\) and \\(I_{3} I_{4} \\| I_{1} I_{2}\\). Hence \\(I_{1}^{\\prime} I_{2}^{\\prime}\\) and \\(I_{3} I_{4}\\) are parallel, equal length segments on sides \\(C Y, D Y\\) and we conclude that \\(I_{1}^{\\prime}=I_{3}, I_{2}^{\\prime}=I_{4}\\). Hence the centre of \\(I_{1} I_{2} I_{3} I_{4}\\) is also \\(O\\) and we establish that by rotational symmetry that \\(r_{1}=r_{3}\\) and \\(r_{2}=r_{4}\\).\nUsing congruent triangles: Let \\(A I_{1}\\) and \\(B I_{2}\\) intersect at \\(E\\) and let \\(C I_{3}\\) and \\(D I_{4}\\) intersect at \\(F\\). Note that \\(\\triangle A B E\\) and \\(\\triangle C D F\\) are congruent, since \\(A B=C D\\) and corresponding pairs of angles are equal (equal opposite angles parallelogram \\(A B C D\\) are each bisected).\n\nSince \\(A I_{1} \\| C I_{3}\\) and \\(I_{1} I_{2} \\| I_{4} I_{3}, \\angle I_{2} I_{1} E=\\angle I_{4} I_{3} F\\). Similarly \\(\\angle I_{1} I_{2} E=\\angle I_{3} I_{4} F\\). Furthermore \\(I_{1} I_{2}=I_{3} I_{4}\\). Hence triangles \\(I_{2} I_{1} E\\) and \\(I 4 I_{3} F\\) are also congruent.\nHence \\(A B E I_{1} I_{2}\\) and \\(D C F I_{3} I_{4}\\) are congruent. Therefore, the perpendicular distance from \\(I_{1}\\) to \\(A B\\) equals the perpendicular distance from \\(I_{3}\\) to \\(C D\\), that is, \\(r_{1}=r_{3}\\). Similarly \\(r_{2}=r_{4}\\).", "source_pdf": "apmo_2023.pdf", "notes": ""}
{"id": "APMO-2023-4", "contest": "APMO", "year": "2023", "problem_number": "4", "problem": "Let \\(c>0\\) be a given positive real and \\(\\mathbb{R}_{>0}\\) be the set of all positive reals. Find all functions \\(f: \\mathbb{R}_{>0} \\rightarrow \\mathbb{R}_{>0}\\) such that\n\\[\nf((c+1) x+f(y))=f(x+2 y)+2 c x \\quad \\text { for all } x, y \\in \\mathbb{R}_{>0} .\n\\]\n\nAnswer: \\(f(x)=2 x\\) for all \\(x>0\\).", "solution": "\\section*{Solution 1}\n\nWe first prove that \\(f(x) \\geq 2 x\\) for all \\(x>0\\). Suppose, for the sake of contradiction, that \\(f(y)<2 y\\) for some positive \\(y\\). Choose \\(x\\) such that \\(f((c+1) x+f(y))\\) and \\(f(x+2 y)\\) cancel out, that is,\n\\[\n(c+1) x+f(y)=x+2 y \\Longleftrightarrow x=\\frac{2 y-f(y)}{c} .\n\\]\n\nNotice that \\(x>0\\) because \\(2 y-f(y)>0\\). Then \\(2 c x=0\\), which is not possible. This contradiction yields \\(f(y) \\geq 2 y\\) for all \\(y>0\\).\nNow suppose, again for the sake of contradiction, that \\(f(y)>2 y\\) for some \\(y>0\\). Define the following sequence: \\(a_{0}\\) is an arbitrary real greater than \\(2 y\\), and \\(f\\left(a_{n}\\right)=f\\left(a_{n-1}\\right)+2 c x\\), so that\n\\[\n\\left\\{\\begin{array}{r}\n(c+1) x+f(y)=a_{n} \\\\\nx+2 y=a_{n-1}\n\\end{array} \\Longleftrightarrow x=a_{n-1}-2 y \\quad \\text { and } \\quad a_{n}=(c+1)\\left(a_{n-1}-2 y\\right)+f(y) .\\right.\n\\]\n\nIf \\(x=a_{n-1}-2 y>0\\) then \\(a_{n}>f(y)>2 y\\), so inductively all the substitutions make sense.\nFor the sake of simplicity, let \\(b_{n}=a_{n}-2 y\\), so \\(b_{n}=(c+1) b_{n-1}+f(y)-2 y \\quad(*)\\). Notice that \\(x=b_{n-1}\\) in the former equation, so \\(f\\left(a_{n}\\right)=f\\left(a_{n-1}\\right)+2 c b_{n-1}\\). Telescoping yields\n\\[\nf\\left(a_{n}\\right)=f\\left(a_{0}\\right)+2 c \\sum_{i=0}^{n-1} b_{i}\n\\]\n\nOne can find \\(b_{n}\\) from the recurrence equation \\((*): b_{n}=\\left(b_{0}+\\frac{f(y)-2 y}{c}\\right)(c+1)^{n}-\\frac{f(y)-2 y}{c}\\), and then\n\\[\n\\begin{aligned}\nf\\left(a_{n}\\right) & =f\\left(a_{0}\\right)+2 c \\sum_{i=0}^{n-1}\\left(\\left(b_{0}+\\frac{f(y)-2 y}{c}\\right)(c+1)^{i}-\\frac{f(y)-2 y}{c}\\right) \\\\\n& =f\\left(a_{0}\\right)+2\\left(b_{0}+\\frac{f(y)-2 y}{c}\\right)\\left((c+1)^{n}-1\\right)-2 n(f(y)-2 y) .\n\\end{aligned}\n\\]\n\nSince \\(f\\left(a_{n}\\right) \\geq 2 a_{n}=2 b_{n}+4 y\\),\n\\[\n\\begin{aligned}\n& f\\left(a_{0}\\right)+2\\left(b_{0}+\\frac{f(y)-2 y}{c}\\right)\\left((c+1)^{n}-1\\right)-2 n(f(y)-2 y) \\geq 2 b_{n}+4 y \\\\\n= & 2\\left(b_{0}+\\frac{f(y)-2 y}{c}\\right)(c+1)^{n}-2 \\frac{f(y)-2 y}{c},\n\\end{aligned}\n\\]\nwhich implies\n\\[\nf\\left(a_{0}\\right)+2 \\frac{f(y)-2 y}{c} \\geq 2\\left(b_{0}+\\frac{f(y)-2 y}{c}\\right)+2 n(f(y)-2 y),\n\\]\nwhich is not true for sufficiently large \\(n\\).\nA contradiction is reached, and thus \\(f(y)=2 y\\) for all \\(y>0\\). It is immediate that this function satisfies the functional equation.\n\n\\section*{Solution 2}\n\nAfter proving that \\(f(y) \\geq 2 y\\) for all \\(y>0\\), one can define \\(g(x)=f(x)-2 x, g: \\mathbb{R}_{>0} \\rightarrow \\mathbb{R}_{\\geq 0}\\), and our goal is proving that \\(g(x)=0\\) for all \\(x>0\\). The problem is now rewritten as\n\\[\n\\begin{aligned}\n& g((c+1) x+g(y)+2 y)+2((c+1) x+g(y)+2 y)=g(x+2 y)+2(x+2 y)+2 c x \\\\\n\\Longleftrightarrow & g((c+1) x+g(y)+2 y)+2 g(y)=g(x+2 y) .\n\\end{aligned}\n\\]\n\nThis readily implies that \\(g(x+2 y) \\geq 2 g(y)\\), which can be interpreted as \\(z>2 y \\Longrightarrow g(z) \\geq 2 g(y)\\), by plugging \\(z=x+2 y\\).\nNow we prove by induction that \\(z>2 y \\Longrightarrow g(z) \\geq 2 m \\cdot g(y)\\) for any positive integer \\(2 m\\). In fact, since \\((c+1) x+g(y)+2 y>2 y, g((c+1) x+g(y)+2 y) \\geq 2 m \\cdot g(y)\\), and by \\((? ?)\\),\n\\[\ng(x+2 y) \\geq 2 m \\cdot g(y)+2 g(y)=2(m+1) g(y),\n\\]\nand we are done by plugging \\(z=x+2 y\\) again.\nThe problem now is done: if \\(g(y)>0\\) for some \\(y>0\\), choose a fixed \\(z>2 y\\) arbitrarily and and integer \\(m\\) such that \\(m>\\frac{g(z)}{2 g(y)}\\). Then \\(g(z)<2 m \\cdot g(y)\\), contradiction.", "source_pdf": "apmo_2023.pdf", "notes": ""}
{"id": "APMO-2023-5", "contest": "APMO", "year": "2023", "problem_number": "5", "problem": "There are \\(n\\) line segments on the plane, no three intersecting at a point, and each pair intersecting once in their respective interiors. Tony and his \\(2 n-1\\) friends each stand at a distinct endpoint of a line segment. Tony wishes to send Christmas presents to each of his friends as follows:\nFirst, he chooses an endpoint of each segment as a \"sink\". Then he places the present at the endpoint of the segment he is at. The present moves as follows:\n- If it is on a line segment, it moves towards the sink.\n- When it reaches an intersection of two segments, it changes the line segment it travels on and starts moving towards the new sink.\n\nIf the present reaches an endpoint, the friend on that endpoint can receive their present. Prove Tony can send presents to exactly \\(n\\) of his \\(2 n-1\\) friends.", "solution": "\\section*{Solution 1}\n\nDraw a circle that encloses all the intersection points between line segments and extend all line segments until they meet the circle, and then move Tony and all his friends to the circle. Number the intersection points with the circle from 1 to \\(2 n\\) anticlockwise, starting from Tony (Tony has number 1). We will prove that the friends eligible to receive presents are the ones on even-numbered intersection points.\nFirst part: at most \\(n\\) friends can receive a present.\nThe solution relies on a well-known result: the \\(n\\) lines determine regions inside the circle; then it is possible to paint the regions with two colors such that no regions with a common (line) boundary have the same color. The proof is an induction on \\(n\\) : the fact immediately holds for \\(n=0\\), and the induction step consists on taking away one line \\(\\ell\\), painting the regions obtained with \\(n-1\\) lines, drawing \\(\\ell\\) again and flipping all colors on exactly one half plane determined by \\(\\ell\\).\nNow consider the line starting on point 1 . Color the regions in red and blue such that neighboring regions have different colors, and such that the two regions that have point 1 as a vertex are red on the right and blue on the left, from Tony's point of view. Finally, assign to each red region the clockwise direction and to each blue region the anticlockwise direction. Because of the coloring, every boundary will have two directions assigned, but the directions are the same since every boundary divides regions of different colors. Then the present will follow the directions assigned to the regions: it certainly does for both regions in the beginning, and when the present reaches an intersection it will keep bordering one of the two regions it was dividing. To finish this part of the problem, consider the regions that share a boundary with the circle. The directions alternate between outcoming and incoming, starting from 1 (outcoming), so all even-numbered vertices are directed as incoming and are the only ones able to receive presents.\nSecond part: all even-numbered vertices can receive a present.\nFirst notice that, since every two chords intersect, every chord separates the endpoints of each of the other \\(n-1\\) chords. Therefore, there are \\(n-1\\) vertices on each side of every chord, and each chord connects vertices \\(k\\) and \\(k+n, 1 \\leq k \\leq n\\).\nWe prove a stronger result by induction in \\(n\\) : let \\(k\\) be an integer, \\(1 \\leq k \\leq n\\). Direct each chord from \\(i\\) to \\(i+n\\) if \\(1 \\leq i \\leq k\\) and from \\(i+n\\) to \\(i\\) otherwise; in other words, the sinks are \\(k+1, k+2, \\ldots, k+n\\). Now suppose that each chord sends a present, starting from the vertex opposite to each sink, and all presents move with the same rules. Then \\(k-i\\) sends a present to \\(k+i+1, i=0,1, \\ldots, n-1\\) (indices taken modulo \\(2 n\\) ). In particular, for \\(i=k-1\\), Tony, in vertex 1 , send a present to vertex \\(2 k\\). Also, the \\(n\\) paths the presents make do not cross (but they may touch.) More formally, for all \\(i, 1 \\leq i \\leq n\\), if one path takes a present from \\(k-i\\) to \\(k+i+1\\), separating the circle into two regions, all paths taking a present from \\(k-j\\) to \\(k+j+1, j<i\\), are completely contained in one region, and all paths taking a present from\n\\(k-j\\) to \\(k+j+1, j>i\\), are completely contained in the other region. For instance, possible \\({ }^{1}\\) paths for \\(k=3\\) and \\(n=5\\) follow:\n![](https://cdn.mathpix.com/cropped/2025_08_23_f8a083d79305c9305a0cg-10.jpg?height=535&width=543&top_left_y=291&top_left_x=708)\n\nThe result is true for \\(n=1\\). Let \\(n>1\\) and assume the result is true for less chords. Consider the chord that takes \\(k\\) to \\(k+n\\) and remove it. Apply the induction hypothesis to the remaining \\(n-1\\) lines: after relabeling, presents would go from \\(k-i\\) to \\(k+i+2,1 \\leq i \\leq n-1\\) if the chord were not there.\nReintroduce the chord that takes \\(k\\) to \\(k+n\\). From the induction hypothesis, the chord intersects the paths of the presents in the following order: the \\(i\\)-th path the chord intersects is the the one that takes \\(k-i\\) to \\(k+i, i=1,2, \\ldots, n-1\\).\n\n\\begin{figure}\n\\includegraphics[width=\\textwidth]{https://cdn.mathpix.com/cropped/2025_08_23_f8a083d79305c9305a0cg-10.jpg?height=601&width=724&top_left_y=1267&top_left_x=245}\n\\captionsetup{labelformat=empty}\n\\caption{Paths without chord \\(k \\rightarrow k+n\\)}\n\\end{figure}\n\n\\begin{figure}\n\\includegraphics[width=\\textwidth]{https://cdn.mathpix.com/cropped/2025_08_23_f8a083d79305c9305a0cg-10.jpg?height=606&width=723&top_left_y=1262&top_left_x=1022}\n\\captionsetup{labelformat=empty}\n\\caption{Corrected paths with chord \\(k \\rightarrow k+n\\)}\n\\end{figure}\n\nThen the presents cover the following new paths: the present from \\(k\\) will leave its chord and take the path towards \\(k+1\\); then, for \\(i=1,2, \\ldots, n-1\\), the present from \\(k-i\\) will meet the chord from \\(k\\) to \\(k+n\\), move towards the intersection with the path towards \\(k+i+1\\) and go to \\(k+i+1\\), as desired. Notice that the paths still do not cross. The induction (and the solution) is now complete.\n\n\\section*{Solution 2}\n\nFirst part: at most \\(n\\) friends can receive a present.\nSimilarly to the first solution, consider a circle that encompasses all line segments, extend the lines, and use the endpoints of the chords instead of the line segments, and prove that each chord connects vertices \\(k\\) and \\(k+n\\). We also consider, even in the first part, \\(n\\) presents leaving from \\(n\\) outcoming vertices.\nFirst we prove that a present always goes to a sink. If it does not, then it loops; let it first enter the loop at point \\(P\\) after turning from chord \\(a\\) to chord \\(b\\). Therefore after it loops once,\n\n\\footnotetext{\n\\({ }^{1}\\) The paths do not depend uniquely on \\(k\\) and \\(n\\); different chord configurations and vertex labelings may change the paths.\n}\nit must turn to chord \\(b\\) at \\(P\\). But \\(P\\) is the intersection of \\(a\\) and \\(b\\), so the present should turn from chord \\(a\\) to chord \\(b\\), which can only be done in one way - the same way it came in first. This means that some part of chord \\(a\\) before the present enters the loop at \\(P\\) is part of the loop, which contradicts the fact that \\(P\\) is the first point in the loop. So no present enters a loop, and every present goes to a sink.\n\n\\begin{figure}\n\\includegraphics[width=\\textwidth]{https://cdn.mathpix.com/cropped/2025_08_23_f8a083d79305c9305a0cg-11.jpg?height=215&width=255&top_left_y=428&top_left_x=585}\n\\captionsetup{labelformat=empty}\n\\caption{There are no loops}\n\\end{figure}\n\n\\begin{figure}\n\\includegraphics[width=\\textwidth]{https://cdn.mathpix.com/cropped/2025_08_23_f8a083d79305c9305a0cg-11.jpg?height=215&width=255&top_left_y=428&top_left_x=1136}\n\\captionsetup{labelformat=empty}\n\\caption{No two paths cross}\n\\end{figure}\n\nThe present paths also do not cross: in fact, every time two paths share a point \\(P\\), intersection of chords \\(a\\) and \\(b\\), one path comes from \\(a\\) to \\(b\\) and the other path comes from \\(b\\) to \\(a\\), and they touch at \\(P\\). This implies the following sequence of facts:\n- Every path divides the circle into two regions with paths connecting vertices within each region.\n- All \\(n\\) presents will be delivered to \\(n\\) different persons; that is, all sinks receive a present. This implies that every vertex is an endpoint of a path.\n- The number of chord endpoints inside each region is even, because they are connected within their own region.\n\nNow consider the path starting at vertex 1, with Tony. It divides the circle into two regions with an even number of vertices in their interior. Then there is an even number of vertices between Tony and the recipient of his present, that is, their vertex is an even numbered one. Second part: all even-numbered vertices can receive a present.\nThe construction is the same as the in the previous solution: direct each chord from \\(i\\) to \\(i+n\\) if \\(1 \\leq i \\leq k\\) and from \\(i+n\\) to \\(i\\) otherwise; in other words, the sinks are \\(k+1, k+2, \\ldots, k+n\\). Then, since the paths do not cross, \\(k\\) will send a present to \\(k+1, k-1\\) will send a present to \\(k+2\\), and so on, until 1 sends a present to \\((k+1)+(k-1)=2 k\\).", "source_pdf": "apmo_2023.pdf", "notes": ""}
{"id": "APMO-2020-1", "contest": "APMO", "year": "2020", "problem_number": "1", "problem": "Let \\(\\Gamma\\) be the circumcircle of \\(\\Delta A B C\\). Let \\(D\\) be a point on the side \\(B C\\). The tangent to \\(\\Gamma\\) at \\(A\\) intersects the parallel line to \\(B A\\) through \\(D\\) at point \\(E\\). The segment \\(C E\\) intersects \\(\\Gamma\\) again at \\(F\\). Suppose \\(B, D, F, E\\) are concyclic. Prove that \\(A C, B F, D E\\) are concurrent.", "solution": "Solution 1 From the conditions, we have\n![](https://cdn.mathpix.com/cropped/2025_08_23_3dc300bd078f86f0b35eg-1.jpg?height=744&width=708&top_left_y=769&top_left_x=710)\n\\[\n\\begin{aligned}\n\\angle C B A & =180^{\\circ}-\\angle E D B=180^{\\circ}-\\angle E F B \\\\\n& =180^{\\circ}-\\angle E F A-\\angle A F B \\\\\n& =180^{\\circ}-\\angle C B A-\\angle A C B=\\angle B A C .\n\\end{aligned}\n\\]\n\nLet \\(P\\) be the intersection of \\(A C\\) and \\(B F\\). Then we have\n\\[\n\\angle P A E=\\angle C B A=\\angle B A C=\\angle B F C\n\\]\n\nThis implies \\(A, P, F, E\\) are concyclic. It follows that\n\\[\n\\angle F P E=\\angle F A E=\\angle F B A\n\\]\nand hence \\(A B\\) and \\(E P\\) are parallel. So \\(E, P, D\\) are collinear, and the result follows.\n\n\\section*{Solution 2}\n\nLet \\(E^{\\prime}\\) be any point on the extension of \\(E A\\). From \\(\\angle A E D=\\angle E^{\\prime} A B=\\angle A C D\\), points \\(A, D, C, E\\) are concyclic.\n![](https://cdn.mathpix.com/cropped/2025_08_23_3dc300bd078f86f0b35eg-2.jpg?height=700&width=662&top_left_y=227&top_left_x=761)\n\nLet \\(P\\) be the intersection of \\(B F\\) and \\(D E\\). From \\(\\angle A F P=\\angle A C B=\\angle A E P\\), the points \\(A, P, F, E\\) are concyclic. In addition, from \\(\\angle E P A=\\angle E F A=\\angle D B A\\), points \\(A, B, D, P\\) are concyclic.\nBy considering the radical centre of ( \\(B D F E\\) ), ( \\(A P F E\\) ) and ( \\(B D P A\\) ), we find that the lines \\(B D, A P, E F\\) are concurrent at \\(C\\). The result follows.", "source_pdf": "apmo_2020.pdf", "notes": ""}
{"id": "APMO-2020-2", "contest": "APMO", "year": "2020", "problem_number": "2", "problem": "Show that \\(r=2\\) is the largest real number \\(r\\) which satisfies the following condition: If a sequence \\(a_{1}, a_{2}, \\ldots\\) of positive integers fulfills the inequalities\n\\[\na_{n} \\leq a_{n+2} \\leq \\sqrt{a_{n}^{2}+r a_{n+1}}\n\\]\nfor every positive integer \\(n\\), then there exists a positive integer \\(M\\) such that \\(a_{n+2}=a_{n}\\) for every \\(n \\geq M\\).", "solution": "Solution 1. First, let us assume that \\(r>2\\), and take a positive integer \\(a \\geq 1 /(r-2)\\). Then, if we let \\(a_{n}=a+\\lfloor n / 2\\rfloor\\) for \\(n=1,2, \\ldots\\), the sequence \\(a_{n}\\) satisfies the inequalities\n\\[\n\\sqrt{a_{n}^{2}+r a_{n+1}} \\geq \\sqrt{a_{n}^{2}+r a_{n}} \\geq \\sqrt{a_{n}^{2}+\\left(2+\\frac{1}{a}\\right) a_{n}} \\geq a_{n}+1=a_{n+2}\n\\]\nbut since \\(a_{n+2}>a_{n}\\) for any \\(n\\), we see that \\(r\\) does not satisfy the condition given in the problem.\nNow we show that \\(r=2\\) does satisfy the condition of the problem. Suppose \\(a_{1}, a_{2}, \\ldots\\) is a sequence of positive integers satisfying the inequalities given in the problem, and there exists a positive integer \\(m\\) for which \\(a_{m+2}>a_{m}\\) is satisfied.\nBy induction we prove the following assertion:\n( \\(\\dagger\\) ) \\(\\quad a_{m+2 k} \\leq a_{m+2 k-1}=a_{m+1}\\) holds for every positive integer \\(k\\).\nThe truth of ( \\(\\dagger\\) ) for \\(k=1\\) follows from the inequalities below\n\\[\n2 a_{m+2}-1=a_{m+2}^{2}-\\left(a_{m+2}-1\\right)^{2} \\leq a_{m}^{2}+2 a_{m+1}-\\left(a_{m+2}-1\\right)^{2} \\leq 2 a_{m+1}\n\\]\n\nLet us assume that \\((\\dagger)\\) holds for some positive integer \\(k\\). From\n\\[\na_{m+1}^{2} \\leq a_{m+2 k+1}^{2} \\leq a_{m+2 k-1}^{2}+2 a_{m+2 k} \\leq a_{m+1}^{2}+2 a_{m+1}<\\left(a_{m+1}+1\\right)^{2}\n\\]\nit follows that \\(a_{m+2 k+1}=a_{m+1}\\) must hold. Furthermore, since \\(a_{m+2 k} \\leq a_{m+1}\\), we have\n\\[\na_{m+2 k+2}^{2} \\leq a_{m+2 k}^{2}+2 a_{m+2 k+1} \\leq a_{m+1}^{2}+2 a_{m+1}<\\left(a_{m+1}+1\\right)^{2}\n\\]\nfrom which it follows that \\(a_{m+2 k+2} \\leq a_{m+1}\\), which proves the assertion ( \\(\\dagger\\) ).\nWe can conclude that for the value of \\(m\\) with which we started our argument above, \\(a_{m+2 k+1}=a_{m+1}\\) holds for every positive integer \\(k\\). Therefore, in order to finish the proof, it is enough to show that \\(a_{m+2 k}\\) becomes constant after some value of \\(k\\). Since every \\(a_{m+2 k}\\) is a positive integer less than or equal to \\(a_{m+1}\\), there exists \\(k=K\\) for which \\(a_{m+2 K}\\) takes the maximum value. By the monotonicity of \\(a_{m+2 k}\\), it then follows that \\(a_{m+2 k}=a_{m+2 K}\\) for all \\(k \\geq K\\).\n\n\\section*{Solution 2}\n\nWe only give an alternative proof of the assertion ( \\(\\dagger\\) ) in solution 1 . Let \\(\\left\\{a_{n}\\right\\}\\) be a sequence satisfying the inequalities given in the problem. We will use the following key observations:\n(a) If \\(a_{n+1} \\leq a_{n}\\) for some \\(n \\geq 1\\), then\n\\[\na_{n} \\leq a_{n+2} \\leq \\sqrt{a_{n}^{2}+2 a_{n+1}}<\\sqrt{a_{n}^{2}+2 a_{n}+1}=a_{n}+1,\n\\]\nhence \\(a_{n}=a_{n+2}\\).\n(b) If \\(a_{n} \\leq a_{n+1}\\) for some \\(n \\geq 1\\), then\n\\[\na_{n} \\leq a_{n+2} \\leq \\sqrt{a_{n}^{2}+2 a_{n+1}}<\\sqrt{a_{n+1}^{2}+2 a_{n+1}+1}=a_{n+1}+1,\n\\]\nhence \\(a_{n} \\leq a_{n+2} \\leq a_{n+1}\\).\nNow let \\(m\\) be a positive integer such that \\(a_{m+2}>a_{m}\\). By the observations above, we must have \\(a_{m}<a_{m+2} \\leq a_{m+1}\\). Thus the assertion ( \\(\\dagger\\) ) is true for \\(k=1\\). Assume that the assertion holds for some positive integer \\(k\\). Using observation (a), we get \\(a_{m+2 k+1}=a_{m+2 k-1}=a_{m+1}\\). Thus \\(a_{m+2 k} \\leq a_{m+2 k+1}\\), and then using observation (b), we get \\(a_{m+2 k+2} \\leq a_{m+2 k+1}=a_{m+1}\\), which proves the assertion ( \\(\\dagger\\) ).", "source_pdf": "apmo_2020.pdf", "notes": ""}
{"id": "APMO-2020-3", "contest": "APMO", "year": "2020", "problem_number": "3", "problem": "Determine all positive integers \\(k\\) for which there exist a positive integer \\(m\\) and a set \\(S\\) of positive integers such that any integer \\(n>m\\) can be written as a sum of distinct elements of \\(S\\) in exactly \\(k\\) ways.", "solution": "\\section*{Solution:}\n\nWe claim that \\(k=2^{a}\\) for all \\(a \\geq 0\\).\nLet \\(A=\\{1,2,4,8, \\ldots\\}\\) and \\(B=\\mathbb{N} \\backslash A\\). For any set \\(T\\), let \\(s(T)\\) denote the sum of the elements of \\(T\\). (If \\(T\\) is empty, we let \\(s(T)=0\\).)\nWe first show that any positive integer \\(k=2^{a}\\) satisfies the desired property. Let \\(B^{\\prime}\\) be a subset of \\(B\\) with \\(a\\) elements, and let \\(S=A \\cup B^{\\prime}\\). Recall that any nonnegative integer has a unique binary representation. Hence, for any integer \\(t>s\\left(B^{\\prime}\\right)\\) and any subset \\(B^{\\prime \\prime} \\subseteq B^{\\prime}\\), the number \\(t-s\\left(B^{\\prime \\prime}\\right)\\) can be written as a sum of distinct elements of \\(A\\) in a unique way. This means that \\(t\\) can be written as a sum of distinct elements of \\(B^{\\prime}\\) in exactly \\(2^{a}\\) ways.\nNext, assume that some positive integer \\(k\\) satisfies the desired property for a positive integer \\(m \\geq 2\\) and a set \\(S\\). Clearly, \\(S\\) is infinite.\nLemma: For all sufficiently large \\(x \\in S\\), the smallest element of \\(S\\) larger than \\(x\\) is \\(2 x\\).\nProof of Lemma: Let \\(x \\in S\\) with \\(x>3 m\\), and let \\(x<y<2 x\\). We will show that \\(y \\notin S\\). Suppose first that \\(y>x+m\\). Then \\(y-x\\) can be written as a sum of distinct elements of \\(S\\) not including \\(x\\) in \\(k\\) ways. If \\(y \\in S\\), then \\(y\\) can be written as a sum of distinct elements of \\(S\\) in at least \\(k+1\\) ways, a contradiction. Suppose now that \\(y \\leq x+m\\). We consider \\(z \\in(2 x-m, 2 x)\\). Similarly as before, \\(z-x\\) can be written as a sum of distinct elements of \\(S\\) not including \\(x\\) or \\(y\\) in \\(k\\) ways. If \\(y \\in S\\), then since \\(m<z-y<x, z-y\\) can be written as a sum of distinct elements of \\(S\\) not including \\(x\\) or \\(y\\). This means that \\(z\\) can be written as a sum of distinct elements of \\(S\\) in at least \\(k+1\\) ways, a contradiction.\nWe now show that \\(2 x \\in S\\); assume for contradiction that this is not the case. Observe that \\(2 x\\) can be written as a sum of distinct elements of \\(S\\) including \\(x\\) in exactly \\(k-1\\) ways. This means that \\(2 x\\) can also be written as a sum of distinct elements of \\(S\\) not including \\(x\\). If this sum includes any number less than \\(x-m\\), then removing this number, we can write some number \\(y \\in(x+m, 2 x)\\) as a sum of distinct elements of \\(S\\) not including \\(x\\). Now if \\(y=y^{\\prime}+x\\) where \\(y^{\\prime} \\in(m, x)\\) then \\(y^{\\prime}\\) can be written as\na sum of distinct elements of \\(S\\) including \\(x\\) in exactly \\(k\\) ways. Therefore \\(y\\) can be written as a sum of distinct elements of \\(S\\) in at least \\(k+1\\) ways, a contradiction. Hence the sum only includes numbers in the range \\([x-m, x)\\). Clearly two numbers do not suffice. On the other hand, three such numbers sum to at least \\(3(x-m)>2 x\\), a contradiction.\nFrom the Lemma, we have that \\(S=T \\cup U\\), where \\(T\\) is finite and \\(U=\\{x, 2 x, 4 x, 8 x, \\ldots\\}\\) for some positive integer \\(x\\). Let \\(y\\) be any positive integer greater than \\(s(T)\\). For any subset \\(T^{\\prime} \\subseteq T\\), if \\(y-s\\left(T^{\\prime}\\right) \\equiv 0(\\bmod x)\\), then \\(y-s\\left(T^{\\prime}\\right)\\) can be written as a sum of distinct elements of \\(U\\) in a unique way; otherwise \\(y-s\\left(T^{\\prime}\\right)\\) cannot be written as a sum of distinct elements of \\(U\\). Hence the number of ways to write \\(y\\) as a sum of distinct elements of \\(S\\) is equal to the number of subsets \\(T^{\\prime} \\subseteq T\\) such that \\(s\\left(T^{\\prime}\\right) \\equiv y(\\bmod x)\\). Since this holds for all \\(y\\), for any \\(0 \\leq a \\leq x-1\\) there are exactly \\(k\\) subsets \\(T^{\\prime} \\subseteq T\\) such that \\(s\\left(T^{\\prime}\\right) \\equiv a(\\bmod x)\\). This means that there are \\(k x\\) subsets of \\(T\\) in total. But the number of subsets of \\(T\\) is a power of 2 , and therefore \\(k\\) is a power of 2 , as claimed.\n\nSolution 2. We give an alternative proof of the first half of the lemma in the Solution 1 above.\nLet \\(s_{1}<s_{2}<\\cdots\\) be the elements of \\(S\\). For any positive integer \\(r\\), define \\(A_{r}(x)=\\prod_{n=1}^{r}\\left(1+x^{s_{n}}\\right)\\). For each \\(n\\) such that \\(m \\leq n<s_{r+1}\\), all \\(k\\) ways of writing \\(n\\) as a sum of elements of \\(S\\) must only use \\(s_{1}, \\ldots, s_{r}\\), so the coefficient of \\(x^{n}\\) in \\(A_{r}(x)\\) is \\(k\\). Similarly the number of ways of writing \\(s_{r+1}\\) as a sum of elements of \\(S\\) without using \\(s_{r+1}\\) is exactly \\(k-1\\). Hence the coefficient of \\(x^{s_{r+1}}\\) in \\(A_{r}(x)\\) is \\(k-1\\).\nFix a \\(t\\) such that \\(s_{t}>2(m+1)\\). Write\n\\[\nA_{t-1}(x)=u(x)+k\\left(x^{m+1}+\\cdots+x^{s_{t}-1}\\right)+x^{s_{t}} v(x)\n\\]\nfor some \\(u(x), v(x)\\) where \\(u(x)\\) is of degree at most \\(m\\).\nNote that\n\\[\nA_{t+1}(x)=A_{t-1}(x)+x^{s_{t}} A_{t-1}(x)+x^{s_{t+1}} A_{t-1}(x)+x^{s_{t}+s_{t+1}} A_{t-1}(x) .\n\\]\n\nIf \\(s_{t+1}+m+1<2 s_{t}\\), we can find the term \\(x^{s_{t+1}+m+1}\\) in \\(x^{s_{t}} A_{t-1}(x)\\) and in \\(x^{s_{t+1}} A_{t-1}(x)\\). Hence the coefficient of \\(x^{s_{t+1}+m+1}\\) in \\(A_{t+1}(x)\\) is at least \\(2 k\\), which is impossible. So \\(s_{t+1} \\geq 2 s_{t}-(m+1)> s_{t}+m+1\\).\n\nNow\n\\[\nA_{t}(x)=A_{t-1}(x)+x^{s_{t}} u(x)+k\\left(x^{s_{t}+m+1}+\\cdots x^{2 s_{t}-1}\\right)+x^{2 s_{t}} v(x) .\n\\]\n\nRecall that the coefficent of \\(x^{s_{t+1}}\\) in \\(A_{t}(x)\\) is \\(k-1\\). But if \\(s_{t}+m+1<s_{t+1}<s_{2 t}\\), then the coefficient of \\(x^{s_{t+1}}\\) in \\(A_{t}(x)\\) is at least \\(k\\), which is a contradiction. Therefore \\(s_{t+1} \\geq 2 s_{t}\\).", "source_pdf": "apmo_2020.pdf", "notes": ""}
{"id": "APMO-2020-4", "contest": "APMO", "year": "2020", "problem_number": "4", "problem": "Let \\(\\mathbb{Z}\\) denote the set of all integers. Find all polynomials \\(P(x)\\) with integer coefficients that satisfy the following property:\nFor any infinite sequence \\(a_{1}, a_{2}, \\ldots\\) of integers in which each integer in \\(\\mathbb{Z}\\) appears exactly once, there exist indices \\(i<j\\) and an integer \\(k\\) such that \\(a_{i}+a_{i+1}+\\cdots+a_{j}=P(k)\\).", "solution": "\\section*{Solution:}\n\nPart 1: All polynomials with \\(\\operatorname{deg} P=1\\) satisfy the given property.\nSuppose \\(P(x)=c x+d\\), and assume without loss of generality that \\(c>d \\geq 0\\). Denote \\(s_{i}=a_{1}+a_{2}+ \\cdots+a_{i}(\\bmod c)\\). It suffices to show that there exist indices \\(i\\) and \\(j\\) such that \\(j-i \\geq 2\\) and \\(s_{j}-s_{i} \\equiv d (\\bmod c)\\).\nConsider \\(c+1\\) indices \\(e_{1}, e_{2}, \\ldots, e_{c+1}>1\\) such that \\(a_{e_{l}} \\equiv d(\\bmod c)\\). By the pigeonhole principle, among the \\(n+1\\) pairs \\(\\left(s_{e_{1}-1}, s_{e_{1}}\\right),\\left(s_{e_{2}-1}, s_{e_{2}}\\right), \\ldots,\\left(s_{e_{n+1}-1}, s_{e_{n+1}}\\right)\\), some two are equal, say \\(\\left(s_{m-1}, s_{m}\\right)\\) and \\(\\left(s_{n-1}, s_{n}\\right)\\). We can then take \\(i=m-1\\) and \\(j=n\\).\n\\(\\underline{\\text { Part 2: All polynomials with } \\operatorname{deg} P \\neq 1 \\text { do not satisfy the given property. }}\\)\nLemma: If \\(\\operatorname{deg} P \\neq 1\\), then for any positive integers \\(A, B\\), and \\(C\\), there exists an integer \\(y\\) with \\(|y|>C\\) such that no value in the range of \\(P\\) falls within the interval \\([y-A, y+B]\\).\nProof of Lemma: The claim is immediate when \\(P\\) is constant or when \\(\\operatorname{deg} P\\) is even since \\(P\\) is bounded from below. Let \\(P(x)=a_{n} x^{n}+\\cdots+a_{1} x+a_{0}\\) be of odd degree greater than 1 , and assume without\nloss of generality that \\(a_{n}>0\\). Since \\(P(x+1)-P(x)=a_{n} n x^{n-1}+\\ldots\\), and \\(n-1>0\\), the gap between \\(P(x)\\) and \\(P(x+1)\\) grows arbitrarily for large \\(x\\). The claim follows.\nSuppose \\(\\operatorname{deg} P \\neq 1\\). We will inductively construct a sequence \\(\\left\\{a_{i}\\right\\}\\) such that for any indices \\(i<j\\) and any integer \\(k\\) it holds that \\(a_{i}+a_{i+1}+\\cdots+a_{j} \\neq P(k)\\). Suppose that we have constructed the sequence up to \\(a_{i}\\), and \\(m\\) is an integer with smallest magnitude yet to appear in the sequence. We will add two more terms to the sequence. Take \\(a_{i+2}=m\\). Consider all the new sums of at least two consecutive terms; each of them contains \\(a_{i+1}\\). Hence all such sums are in the interval \\(\\left[a_{i+1}-A, a_{i+1}+B\\right]\\) for fixed constants \\(A, B\\). The lemma allows us to choose \\(a_{i+1}\\) so that all such sums avoid the range of \\(P\\).\nAlternate Solution for Part 1: Again, suppose \\(P(x)=c x+d\\), and assume without loss of generality that \\(c>d \\geq 0\\). Let \\(S_{i}=\\left\\{a_{j}+a_{j+1}+\\cdots+a_{i}(\\bmod c) \\mid j=1,2, \\ldots, i\\right\\}\\). Then \\(S_{i+1}=\\left\\{s_{i}+a_{i+1}\\right. \\left.(\\bmod c) \\mid s_{i} \\in S_{i}\\right\\} \\cup\\left\\{a_{i+1}(\\bmod c)\\right\\}\\). Hence \\(\\left|S_{i+1}\\right|=\\left|S_{i}\\right|\\) or \\(S_{i+1}=\\left|S_{i}\\right|+1\\), with the former occuring exactly when \\(0 \\in S_{i}\\). Since \\(\\left|S_{i}\\right| \\leq c\\), the latter can only occur finitely many times, so there exists \\(I\\) such that \\(0 \\in S_{i}\\) for all \\(i \\geq I\\). Let \\(t>I\\) be an index with \\(a_{t} \\equiv d(\\bmod c)\\). Then we can find a sum of at least two consecutive terms ending at \\(a_{t}\\) and congruent to \\(d(\\bmod c)\\).\nAlternate Construction when \\(P(x)\\) is constant or of even degree\nIf \\(P(x)\\) is of even degree, then \\(P\\) is bounded from below or from above. In case of \\(P\\) is constant or bounded from above, then there exists a positive integer \\(c\\) such that \\(P(x)<c\\). Let \\(\\left\\{a_{i}\\right\\}\\) be the sequence\n\\[\n0,1,-1,2,3,-2,4,5,-3, \\cdots\n\\]\nwhich is given by \\(a_{3 n+1}=2 n, a_{3 n+2}=2 n+1, a_{3 n+3}=-(n+1)\\) for all \\(n \\geq 0\\). Notice that for any \\(i<j\\) we have \\(a_{i}+\\cdots+a_{j} \\geq 0\\). Then for the sequence \\(\\left\\{b_{n}\\right\\}\\) defined by \\(b_{n}=a_{n}+c\\), clearly \\(b_{i}+\\cdots+b_{j} \\geq\\left(a_{i}+\\cdots+a_{j}\\right)+2 c>c\\) which is out side the range of \\(P(x)\\).\nNow if \\(P\\) is bounded from below, there exist a positive integer \\(c\\) such that \\(P(x)>-c\\). In this case, take \\(b_{n}\\) to be \\(b_{n}=-a_{n}-c\\). Then for all \\(i<j\\) we have \\(b_{i}+\\cdots+b_{j} \\leq-\\left(a_{1}+\\cdots a_{n}\\right)-2 c<-c\\) which is again out side the range of \\(P(x)\\).", "source_pdf": "apmo_2020.pdf", "notes": ""}
{"id": "APMO-2020-5", "contest": "APMO", "year": "2020", "problem_number": "5", "problem": "Let \\(n \\geq 3\\) be a fixed integer. The number 1 is written \\(n\\) times on a blackboard. Below the blackboard, there are two buckets that are initially empty. A move consists of erasing two of the numbers \\(a\\) and \\(b\\), replacing them with the numbers 1 and \\(a+b\\), then adding one stone to the first bucket and \\(\\operatorname{gcd}(a, b)\\) stones to the second bucket. After some finite number of moves, there are \\(s\\) stones in the first bucket and \\(t\\) stones in the second bucket, where \\(s\\) and \\(t\\) are positive integers. Find all possible values of the ratio \\(\\frac{t}{s}\\).", "solution": "\\section*{Solution:}\n\nThe answer is the set of all rational numbers in the interval \\([1, n-1)\\). First, we show that no other numbers are possible. Clearly the ratio is at least 1, since for every move, at least one stone is added to the second bucket. Note that the number \\(s\\) of stones in the first bucket is always equal to \\(p-n\\), where \\(p\\) is the sum of the numbers on the blackboard. We will assume that the numbers are written in a row, and whenever two numbers \\(a\\) and \\(b\\) are erased, \\(a+b\\) is written in the place of the number on the right. Let \\(a_{1}, a_{2}, \\ldots, a_{n}\\) be the numbers on the blackboard from left to right, and let\n\\[\nq=0 \\cdot a_{1}+1 \\cdot a_{2}+\\cdots+(n-1) a_{n} .\n\\]\n\nSince each number \\(a_{i}\\) is at least 1 , we always have\n\\[\nq \\leq(n-1) p-(1+\\cdots+(n-1))=(n-1) p-\\frac{n(n-1)}{2}=(n-1) s+\\frac{n(n-1)}{2} .\n\\]\n\nAlso, if a move changes \\(a_{i}\\) and \\(a_{j}\\) with \\(i<j\\), then \\(t\\) changes by \\(\\operatorname{gcd}\\left(a_{i}, a_{j}\\right) \\leq a_{i}\\) and \\(q\\) increases by\n\\[\n(j-1) a_{i}-(i-1)\\left(a_{i}-1\\right) \\geq i a_{i}-(i-1)\\left(a_{i}-1\\right) \\geq a_{i} .\n\\]\n\nHence \\(q-t\\) never decreases. We may assume without loss of generality that the first move involves the rightmost 1 . Then immediately after this move, \\(q=0+1+\\cdots+(n-2)+(n-1) \\cdot 2=\\frac{(n+2)(n-1)}{2}\\) and\n\\(t=1\\). So after that move, we always have\n\\[\n\\begin{aligned}\nt & \\leq q+1-\\frac{(n+2)(n-1)}{2} \\\\\n& \\leq(n-1) s+\\frac{n(n-1)}{2}-\\frac{(n+2)(n-1)}{2}+1 \\\\\n& =(n-1) s-(n-2)<(n-1) s\n\\end{aligned}\n\\]\n\nHence, \\(\\frac{t}{s}<n-1\\). So \\(\\frac{t}{s}\\) must be a rational number in \\([1, n-1)\\).\nAfter a single move, we have \\(\\frac{t}{s}=1\\), so it remains to prove that \\(\\frac{t}{s}\\) can be any rational number in \\((1, n-1)\\). We will now show by induction on \\(n\\) that for any positive integer \\(a\\), it is possible to reach a situation where there are \\(n-1\\) occurrences of 1 on the board and the number \\(a^{n-1}\\), with \\(t\\) and \\(s\\) equal to \\(a^{n-2}(a-1)(n-1)\\) and \\(a^{n-1}-1\\), respectively. For \\(n=2\\), this is clear as there is only one possible move at each step, so after \\(a-1\\) moves \\(s\\) and \\(t\\) will both be equal to \\(a-1\\). Now assume that the claim is true for \\(n-1\\), where \\(n>2\\). Call the algorithm which creates this situation using \\(n-1\\) numbers algorithm \\(A\\). Then to reach the situation for size \\(n\\), we apply algorithm \\(A\\), to create the number \\(a^{n-2}\\). Next, apply algorithm \\(A\\) again and then add the two large numbers, repeat until we get the number \\(a^{n-1}\\). Then algorithm \\(A\\) was applied \\(a\\) times and the two larger numbers were added \\(a-1\\) times. Each time the two larger numbers are added, \\(t\\) increases by \\(a^{n-2}\\) and each time algorithm \\(A\\) is applied, \\(t\\) increases by \\(a^{n-3}(a-1)(n-2)\\). Hence, the final value of \\(t\\) is\n\\[\nt=(a-1) a^{n-2}+a \\cdot a^{n-3}(a-1)(n-2)=a^{n-2}(a-1)(n-1) .\n\\]\n\nThis completes the induction.\nNow we can choose 1 and the large number \\(b\\) times for any positive integer \\(b\\), and this will add \\(b\\) stones to each bucket. At this point we have\n\\[\n\\frac{t}{s}=\\frac{a^{n-2}(a-1)(n-1)+b}{a^{n-1}-1+b} .\n\\]\n\nSo we just need to show that for any rational number \\(\\frac{p}{q} \\in(1, n-1)\\), there exist positive integers \\(a\\) and \\(b\\) such that\n\\[\n\\frac{p}{q}=\\frac{a^{n-2}(a-1)(n-1)+b}{a^{n-1}-1+b}\n\\]\n\nRearranging, we see that this happens if and only if\n\\[\nb=\\frac{q a^{n-2}(a-1)(n-1)-p\\left(a^{n-1}-1\\right)}{p-q} .\n\\]\n\nIf we choose \\(a \\equiv 1(\\bmod p-q)\\), then this will be an integer, so we just need to check that the numerator is positive for sufficiently large \\(a\\).\n\\[\n\\begin{aligned}\nq a^{n-2}(a-1)(n-1)-p\\left(a^{n-1}-1\\right) & >q a^{n-2}(a-1)(n-1)-p a^{n-1} \\\\\n& =a^{n-2}(a(q(n-1)-p)-(n-1))\n\\end{aligned}\n\\]\nwhich is positive for sufficiently large \\(a\\) since \\(q(n-1)-p>0\\).\n\nAlternative solution for the upper bound. Rather than starting with \\(n\\) occurrences of 1 , we may start with infinitely many 1 s , but we are restricted to having at most \\(n-1\\) numbers which are not equal to 1 on the board at any time. It is easy to see that this does not change the problem. Note also that we can ignore the 1 we write on the board each move, so the allowed move is to rub off two numbers and write their sum. We define the width and score of a number on the board as follows. Colour that number red, then reverse every move up to that point all the way back to the situation when the numbers are all 1 s . Whenever a red number is split, colour the two replacement numbers\nred. The width of the original number is equal to the maximum number of red integers greater than 1 which appear on the board at the same time. The score of the number is the number of stones which were removed from the second bucket during these splits. Then clearly the width of any number is at most \\(n-1\\). Also, \\(t\\) is equal to the sum of the scores of the final numbers. We claim that if a number \\(p>1\\) has a width of at most \\(w\\), then its score is at most \\((p-1) w\\). We will prove this by strong induction on \\(p\\). If \\(p=1\\), then clearly \\(p\\) has a score of 0 , so the claim is true. If \\(p>1\\), then \\(p\\) was formed by adding two smaller numbers \\(a\\) and \\(b\\). Clearly \\(a\\) and \\(b\\) both have widths of at most \\(w\\). Moreover, if \\(a\\) has a width of \\(w\\), then at some point in the reversed process there will be \\(w\\) numbers in the set \\(\\{2,3,4, \\ldots\\}\\) that have split from \\(a\\), and hence there can be no such numbers at this point which have split from \\(b\\). Between this point and the final situation, there must always be at least one number in the set \\(\\{2,3,4, \\ldots\\}\\) that split from \\(a\\), so the width of \\(b\\) is at most \\(w-1\\). Therefore, \\(a\\) and \\(b\\) cannot both have widths of \\(w\\), so without loss of generality, \\(a\\) has width at most \\(w\\) and \\(b\\) has width at most \\(w-1\\). Then by the inductive hypothesis, \\(a\\) has score at most \\((a-1) w\\) and \\(b\\) has score at most \\((b-1)(w-1)\\). Hence, the score of \\(p\\) is at most\n\\[\n\\begin{aligned}\n(a-1) w+(b-1)(w-1)+\\operatorname{gcd}(a, b) & \\leq(a-1) w+(b-1)(w-1)+b \\\\\n& =(p-1) w+1-w \\\\\n& \\leq(p-1) w\n\\end{aligned}\n\\]\n\nThis completes the induction.\nNow, since each number \\(p\\) in the final configuration has width at most ( \\(n-1\\) ), it has score less than \\((n-1)(p-1)\\). Hence the number \\(t\\) of stones in the second bucket is less than the sum over the values of \\((n-1)(p-1)\\), and \\(s\\) is equal to the sum of the the values of \\((p-1)\\). Therefore, \\(\\frac{t}{s}<n-1\\).", "source_pdf": "apmo_2020.pdf", "notes": ""}
{"id": "APMO-2019-1", "contest": "APMO", "year": "2019", "problem_number": "1", "problem": "Let \\(\\mathbb{Z}^{+}\\)be the set of positive integers. Determine all functions \\(f: \\mathbb{Z}^{+} \\rightarrow \\mathbb{Z}^{+}\\) such that \\(a^{2}+f(a) f(b)\\) is divisible by \\(f(a)+b\\) for all positive integers \\(a\\) and \\(b\\).\n\nAnswer: The answer is \\(f(n)=n\\) for all positive integers \\(n\\).\nClearly, \\(f(n)=n\\) for all \\(n \\in \\mathbb{Z}^{+}\\)satisfies the original relation. We show some possible approaches to prove that this is the only possible function.", "solution": "Solution. First we perform the following substitutions on the original relation:", "source_pdf": "apmo_2019.pdf", "notes": ""}
{"id": "APMO-2019-1", "contest": "APMO", "year": "2019", "problem_number": "1", "problem": "With \\(a=b=1\\), we find that \\(f(1)+1 \\mid f(1)^{2}+1\\), which implies \\(f(1)=1\\).", "solution": "", "source_pdf": "apmo_2019.pdf", "notes": ""}
{"id": "APMO-2019-2", "contest": "APMO", "year": "2019", "problem_number": "2", "problem": "With \\(a=1\\), we find that \\(b+1 \\mid f(b)+1\\). In particular, \\(b \\leq f(b)\\) for all \\(b \\in \\mathbb{Z}^{+}\\).", "solution": "", "source_pdf": "apmo_2019.pdf", "notes": ""}
{"id": "APMO-2019-3", "contest": "APMO", "year": "2019", "problem_number": "3", "problem": "With \\(b=1\\), we find that \\(f(a)+1 \\mid a^{2}+f(a)\\), and thus \\(f(a)+1 \\mid a^{2}-1\\). In particular, \\(f(a) \\leq a^{2}-2\\) for all \\(a \\geq 2\\).\n\nNow, let \\(p\\) be any odd prime. Substituting \\(a=p\\) and \\(b=f(p)\\) in the original relation, we find that \\(2 f(p) \\mid p^{2}+f(p) f(f(p))\\). Therefore, \\(f(p) \\mid p^{2}\\). Hence the possible values of \\(f(p)\\) are \\(1, p\\) and \\(p^{2}\\). By (2) above, \\(f(p) \\geq p\\) and by (3) above \\(f(p) \\leq p^{2}-2\\). So \\(f(p)=p\\) for all primes \\(p\\).\n\nSubstituting \\(a=p\\) into the original relation, we find that \\(b+p \\mid p^{2}+p f(b)\\). However, since \\((b+p)(f(b)+p-b)=p^{2}-b^{2}+b f(b)+p f(b)\\), we have \\(b+p \\mid b f(b)-b^{2}\\). Thus, for any fixed \\(b\\) this holds for arbitrarily large primes \\(p\\) and therefore we must have \\(b f(b)-b^{2}=0\\), or \\(f(b)=b\\), as desired.", "solution": "Solution 2: As above, we have relations (1)-(3). In (2) and (3), for \\(b=2\\) we have \\(3 \\mid f(2)+1\\) and \\(f(2)+1 \\mid 3\\). These imply \\(f(2)=2\\).\n\nNow, using \\(a=2\\) we get \\(2+b \\mid 4+2 f(b)\\). Let \\(f(b)=x\\). We have\n\\[\n\\begin{aligned}\n1+x \\equiv 0 & (\\bmod b+1) \\\\\n4+2 x \\equiv 0 & (\\bmod b+2)\n\\end{aligned}\n\\]\n\nFrom the first equation \\(x \\equiv b(\\bmod b+1)\\) so \\(x=b+(b+1) t\\) for some integer \\(t \\geq 0\\). Then\n\\[\n0 \\equiv 4+2 x \\equiv 4+2(b+(b+1) t) \\equiv 4+2(-2-t) \\equiv-2 t \\quad(\\bmod b+2)\n\\]\n\nAlso \\(t \\leq b-2\\) because \\(1+x \\mid b^{2}-1\\) by (3).\nIf \\(b+2\\) is odd, then \\(t \\equiv 0(\\bmod b+2)\\). Then \\(t=0\\), which implies \\(f(b)=b\\).\nIf \\(b+2\\) is even, then \\(t \\equiv 0(\\bmod (b+2) / 2)\\). Then \\(t=0\\) or \\(t=(b+2) / 2\\). But if \\(t \\neq 0\\), then by definition \\((b+4) / 2=(1+t)=(x+1) /(b+1)\\) and since \\(x+1 \\mid b^{2}-1\\), then \\((b+4) / 2\\) divides \\(b-1\\). Therefore \\(b+4 \\mid 10\\) and the only possibility is \\(b=6\\). So for even \\(b, b \\neq 6\\) we have \\(f(b)=b\\).\n\nFinally, by (2) and (3), for \\(b=6\\) we have \\(7 \\mid f(6)+1\\) and \\(f(6)+1 \\mid 35\\). This means \\(f(6)=6\\) or \\(f(6)=34\\). The later is discarded as, for \\(a=5, b=6\\), we have by the original equation that \\(11 \\mid 5(5+f(6))\\). Therefore \\(f(n)=n\\) for every positive integer \\(n\\).\n\nSolution 3: We proceed by induction. As in Solution 1, we have \\(f(1)=1\\). Suppose that \\(f(n-1)=n-1\\) for some integer \\(n \\geq 2\\).\n\nWith the substitution \\(a=n\\) and \\(b=n-1\\) in the original relation we obtain that \\(f(n)+ n-1 \\mid n^{2}+f(n)(n-1)\\). Since \\(f(n)+n-1 \\mid(n-1)(f(n)+n-1)\\), then \\(f(n)+n-1 \\mid 2 n-1\\).\n\nWith the substitution \\(a=n-1\\) and \\(b=n\\) in the original relation we obtain that \\(2 n- 1 \\mid(n-1)^{2}+(n-1) f(n)=(n-1)(n-1+f(n))\\). Since \\((2 n-1, n-1)=1\\), we deduce that \\(2 n-1 \\mid f(n)+n-1\\).\n\nTherefore, \\(f(n)+n-1=2 n-1\\), which implies the desired \\(f(n)=n\\).", "source_pdf": "apmo_2019.pdf", "notes": ""}
{"id": "APMO-2019-2", "contest": "APMO", "year": "2019", "problem_number": "2", "problem": "Let \\(m\\) be a fixed positive integer. The infinite sequence \\(\\left\\{a_{n}\\right\\}_{n \\geq 1}\\) is defined in the following way: \\(a_{1}\\) is a positive integer, and for every integer \\(n \\geq 1\\) we have\n\\[\na_{n+1}= \\begin{cases}a_{n}^{2}+2^{m} & \\text { if } a_{n}<2^{m} \\\\ a_{n} / 2 & \\text { if } a_{n} \\geq 2^{m}\\end{cases}\n\\]\n\nFor each \\(m\\), determine all possible values of \\(a_{1}\\) such that every term in the sequence is an integer.\n\nAnswer: The only value of \\(m\\) for which valid values of \\(a_{1}\\) exist is \\(m=2\\). In that case, the only solutions are \\(a_{1}=2^{\\ell}\\) for \\(\\ell \\geq 1\\).", "solution": "Solution. Suppose that for integers \\(m\\) and \\(a_{1}\\) all the terms of the sequence are integers. For each \\(i \\geq 1\\), write the \\(i\\) th term of the sequence as \\(a_{i}=b_{i} 2^{c_{i}}\\) where \\(b_{i}\\) is the largest odd divisor of \\(a_{i}\\) (the \"odd part\" of \\(a_{i}\\) ) and \\(c_{i}\\) is a nonnegative integer.\n\nLemma 1. The sequence \\(b_{1}, b_{2}, \\ldots\\) is bounded above by \\(2^{m}\\).\nProof. Suppose this is not the case and take an index \\(i\\) for which \\(b_{i}>2^{m}\\) and for which \\(c_{i}\\) is minimal. Since \\(a_{i} \\geq b_{i}>2^{m}\\), we are in the second case of the recursion. Therefore, \\(a_{i+1}=a_{i} / 2\\) and thus \\(b_{i+1}=b_{i}>2^{m}\\) and \\(c_{i+1}=c_{i}-1<c_{i}\\). This contradicts the minimality of \\(c_{i}\\).\n\nLemma 2. The sequence \\(b_{1}, b_{2}, \\ldots\\) is nondecreasing.\nProof. If \\(a_{i} \\geq 2^{m}\\), then \\(a_{i+1}=a_{i} / 2\\) and thus \\(b_{i+1}=b_{i}\\). On the other hand, if \\(a_{i}<2^{m}\\), then\n\\[\na_{i+1}=a_{i}^{2}+2^{m}=b_{i}^{2} 2^{2 c_{i}}+2^{m}\n\\]\nand we have the following cases:\n- If \\(2 c_{i}>m\\), then \\(a_{i+1}=2^{m}\\left(b_{i}^{2} 2^{2 c_{i}-m}+1\\right)\\), so \\(b_{i+1}=b_{i}^{2} 2^{2 c_{i}-m}+1>b_{i}\\).\n- If \\(2 c_{i}<m\\), then \\(a_{i+1}=2^{2 c_{i}}\\left(b_{i}^{2}+2^{m-2 c_{i}}\\right)\\), so \\(b_{i+1}=b_{i}^{2}+2^{m-2 c_{i}}>b_{i}\\).\n- If \\(2 c_{i}=m\\), then \\(a_{i+1}=2^{m+1} \\cdot \\frac{b_{i}^{2}+1}{2}\\), so \\(b_{i+1}=\\left(b_{i}^{2}+1\\right) / 2 \\geq b_{i}\\) since \\(b_{i}^{2}+1 \\equiv 2(\\bmod 4)\\).\n\nBy combining these two lemmas we obtain that the sequence \\(b_{1}, b_{2}, \\ldots\\) is eventually constant. Fix an index \\(j\\) such that \\(b_{k}=b_{j}\\) for all \\(k \\geq j\\). Since \\(a_{n}\\) descends to \\(a_{n} / 2\\) whenever \\(a_{n} \\geq 2^{m}\\), there are infinitely many terms which are smaller than \\(2^{m}\\). Thus, we can choose an \\(i>j\\) such that \\(a_{i}<2^{m}\\). From the proof of Lemma \\(2, a_{i}<2^{m}\\) and \\(b_{i+1}=b_{i}\\) can happen simultaneously only when \\(2 c_{i}=m\\) and \\(b_{i+1}=b_{i}=1\\). By Lemma 2 , the sequence \\(b_{1}, b_{2}, \\ldots\\) is constantly 1 and thus \\(a_{1}, a_{2}, \\ldots\\) are all powers of two. Tracing the sequence starting from \\(a_{i}=2^{c_{i}}=2^{m / 2}<2^{m}\\),\n\\[\n2^{m / 2} \\rightarrow 2^{m+1} \\rightarrow 2^{m} \\rightarrow 2^{m-1} \\rightarrow 2^{2 m-2}+2^{m}\n\\]\n\nNote that this last term is a power of two if and only if \\(2 m-2=m\\). This implies that \\(m\\) must be equal to 2 . When \\(m=2\\) and \\(a_{1}=2^{\\ell}\\) for \\(\\ell \\geq 1\\) the sequence eventually cycles through \\(2,8,4,2, \\ldots\\) When \\(m=2\\) and \\(a_{1}=1\\) the sequence fails as the first terms are \\(1,5,5 / 2\\).\n\nSolution 2: Let \\(m\\) be a positive integer and suppose that \\(\\left\\{a_{n}\\right\\}\\) consists only of positive integers. Call a number small if it is smaller than \\(2^{m}\\) and large otherwise. By the recursion,\nafter a small number we have a large one and after a large one we successively divide by 2 until we get a small one.\n\nFirst, we note that \\(\\left\\{a_{n}\\right\\}\\) is bounded. Indeed, \\(a_{1}\\) turns into a small number after a finite number of steps. After this point, each small number is smaller than \\(2^{m}\\), so each large number is smaller than \\(2^{2 m}+2^{m}\\). Now, since \\(\\left\\{a_{n}\\right\\}\\) is bounded and consists only of positive integers, it is eventually periodic. We focus only on the cycle.\n\nAny small number \\(a_{n}\\) in the cycle can be writen as \\(a / 2\\) for \\(a\\) large, so \\(a_{n} \\geq 2^{m-1}\\), then \\(a_{n+1} \\geq 2^{2 m-2}+2^{m}=2^{m-2}\\left(4+2^{m}\\right)\\), so we have to divide \\(a_{n+1}\\) at least \\(m-1\\) times by 2 until we get a small number. This means that \\(a_{n+m}=\\left(a_{n}^{2}+2^{m}\\right) / 2^{m-1}\\), so \\(2^{m-1} \\mid a_{n}^{2}\\), and therefore \\(2^{\\lceil(m-1) / 2\\rceil} \\mid a_{n}\\) for any small number \\(a_{n}\\) in the cycle. On the other hand, \\(a_{n} \\leq 2^{m}-1\\), so \\(a_{n+1} \\leq 2^{2 m}-2^{m+1}+1+2^{m} \\leq 2^{m}\\left(2^{m}-1\\right)\\), so we have to divide \\(a_{n+1}\\) at most \\(m\\) times by two until we get a small number. This means that after \\(a_{n}\\), the next small number is either \\(N=a_{m+n}=\\left(a_{n}^{2} / 2^{m-1}\\right)+2\\) or \\(a_{m+n+1}=N / 2\\). In any case, \\(2^{\\lceil(m-1) / 2\\rceil}\\) divides \\(N\\).\n\nIf \\(m\\) is odd, then \\(x^{2} \\equiv-2\\left(\\bmod 2^{\\lceil(m-1) / 2\\rceil}\\right)\\) has a solution \\(x=a_{n} / 2^{(m-1) / 2}\\). If \\((m-1) / 2 \\geq 2 \\Longleftrightarrow m \\geq 5\\) then \\(x^{2} \\equiv-2(\\bmod 4)\\), which has no solution. So if \\(m\\) is odd, then \\(m \\leq 3\\).\n\nIf \\(m\\) is even, then \\(2^{m-1}\\left|a_{n}^{2} \\Longrightarrow 2^{\\lceil(m-1) / 2\\rceil}\\right| a_{n} \\Longleftrightarrow 2^{m / 2} \\mid a_{n}\\). Then if \\(a_{n}=2^{m / 2} x\\), \\(2 x^{2} \\equiv-2\\left(\\bmod 2^{m / 2}\\right) \\Longleftrightarrow x^{2} \\equiv-1\\left(\\bmod 2^{(m / 2)-1}\\right)\\), which is not possible for \\(m \\geq 6\\). So if \\(m\\) is even, then \\(m \\leq 4\\).\n\nThe cases \\(m=1,2,3,4\\) are handed manually, checking the possible small numbers in the cycle, which have to be in the interval \\(\\left[2^{m-1}, 2^{m}\\right)\\) and be divisible by \\(2^{\\lceil(m-1) / 2\\rceil}\\) :\n- For \\(m=1\\), the only small number is 1 , which leads to 5 , then \\(5 / 2\\).\n- For \\(m=2\\), the only eligible small number is 2 , which gives the cycle \\((2,8,4)\\). The only way to get to 2 is by dividing 4 by 2 , so the starting numbers greater than 2 are all numbers that lead to 4 , which are the powers of 2 .\n- For \\(m=3\\), the eligible small numbers are 4 and 6 ; we then obtain \\(4,24,12,6,44,22,11,11 / 2\\).\n- For \\(m=4\\), the eligible small numbers are 8 and 12 ; we then obtain \\(8,80,40,20,10, \\ldots\\) or \\(12,160,80,40,20,10, \\ldots\\), but in either case 10 is not an elegible small number.\n\n\\section*{Problem 3. Let \\(A B C\\)}\nbe a scalene triangle with circumcircle \\(\\Gamma\\). Let \\(M\\) be the midpoint of \\(B C\\). A variable point \\(P\\) is selected in the line segment \\(A M\\). The circumcircles of triangles \\(B P M\\) and \\(C P M\\) intersect \\(\\Gamma\\) again at points \\(D\\) and \\(E\\), respectively. The lines \\(D P\\) and \\(E P\\) intersect (a second time) the circumcircles to triangles \\(C P M\\) and \\(B P M\\) at \\(X\\) and \\(Y\\), respectively. Prove that as \\(P\\) varies, the circumcircle of \\(\\triangle A X Y\\) passes through a fixed point \\(T\\) distinct from \\(A\\).\n\nSolution. Let \\(N\\) be the radical center of the circumcircles of triangles \\(A B C, B M P\\) and \\(C M P\\). The pairwise radical axes of these circles are \\(B D, C E\\) and \\(P M\\), and hence they concur at \\(N\\). Now, note that in directed angles:\n\\[\n\\angle M C E=\\angle M P E=\\angle M P Y=\\angle M B Y .\n\\]\n![](https://cdn.mathpix.com/cropped/2025_08_23_38d1d30bc7219c0da581g-4.jpg?height=1323&width=1326&top_left_y=174&top_left_x=371)\n\nIt follows that \\(B Y\\) is parallel to \\(C E\\), and analogously that \\(C X\\) is parallel to \\(B D\\). Then, if \\(L\\) is the intersection of \\(B Y\\) and \\(C X\\), it follows that \\(B N C L\\) is a parallelogram. Since \\(B M=M C\\) we deduce that \\(L\\) is the reflection of \\(N\\) with respect to \\(M\\), and therefore \\(L \\in A M\\). Using power of a point from \\(L\\) to the circumcircles of triangles \\(B P M\\) and \\(C P M\\), we have\n\\[\nL Y \\cdot L B=L P \\cdot L M=L X \\cdot L C\n\\]\n\nHence, \\(B Y X C\\) is cyclic. Using the cyclic quadrilateral we find in directed angles:\n\\[\n\\angle L X Y=\\angle L B C=\\angle B C N=\\angle N D E .\n\\]\n\nSince \\(C X \\| B N\\), it follows that \\(X Y \\| D E\\).\nLet \\(Q\\) and \\(R\\) be two points in \\(\\Gamma\\) such that \\(C Q, B R\\), and \\(A M\\) are all parallel. Then in directed angles:\n\\[\n\\angle Q D B=\\angle Q C B=\\angle A M B=\\angle P M B=\\angle P D B .\n\\]\n\nThen \\(D, P, Q\\) are collinear. Analogously \\(E, P, R\\) are collinear. From here we get \\(\\angle P R Q= \\angle P D E=\\angle P X Y\\), since \\(X Y\\) and \\(D E\\) are parallel. Therefore \\(Q R Y X\\) is cyclic. Let \\(S\\) be the radical center of the circumcircle of triangle \\(A B C\\) and the circles \\(B C Y X\\) and \\(Q R Y X\\). This point lies in the lines \\(B C, Q R\\) and \\(X Y\\) because these are the radical axes of the circles. Let \\(T\\) be the second intersection of \\(A S\\) with \\(\\Gamma\\). By power of a point from \\(S\\) to the circumcircle of \\(A B C\\) and the circle \\(B C X Y\\) we have\n\\[\nS X \\cdot S Y=S B \\cdot S C=S T \\cdot S A\n\\]\n\nTherefore \\(T\\) is in the circumcircle of triangle \\(A X Y\\). Since \\(Q\\) and \\(R\\) are fixed regardless of the choice of \\(P\\), then \\(S\\) is also fixed, since it is the intersection of \\(Q R\\) and \\(B C\\). This implies \\(T\\) is also fixed, and therefore, the circumcircle of triangle \\(A X Y\\) goes through \\(T \\neq A\\) for any choice of \\(P\\).\n\nNow we show an alternative way to prove that \\(B C X Y\\) and \\(Q R X T\\) are cyclic.\nSolution 2. Let the lines \\(D P\\) and \\(E P\\) meet the circumcircle of \\(A B C\\) again at \\(Q\\) and \\(R\\), respectively. Then \\(\\angle D Q C \\angle D B C=\\angle D P M\\), so \\(Q C \\| P M\\). Similarly, \\(R B \\| P M\\).\n![](https://cdn.mathpix.com/cropped/2025_08_23_38d1d30bc7219c0da581g-5.jpg?height=635&width=986&top_left_y=642&top_left_x=539)\n\nNow, \\(\\angle Q C B=\\angle P M B=\\angle P X C=\\angle(Q X, C X)\\), which is half of the arc \\(Q C\\) in the circumcircle \\(\\omega_{C}\\) of \\(Q X C\\). So \\(\\omega_{C}\\) is tangent to \\(B S\\); analogously, \\(\\omega_{B}\\), the circumcicle of \\(R Y B\\), is also tangent to \\(B C\\). Since \\(B R \\| C Q\\), the inscribed trapezoid \\(B R Q C\\) is isosceles, and by symmetry \\(Q R\\) is also tangent to both circles, and the common perpendicular bisector of \\(B R\\) and \\(C Q\\) passes through the centers of \\(\\omega_{B}\\) and \\(\\omega_{C}\\). Since \\(M B=M C\\) and \\(P M\\|B R\\| C Q\\), the line \\(P M\\) is the radical axis of \\(\\omega_{B}\\) and \\(\\omega_{C}\\).\n\nHowever, \\(P M\\) is also the radical axis of the circumcircles \\(\\gamma_{B}\\) of \\(P M B\\) and \\(\\gamma_{C}\\) of \\(P M C\\). Let \\(C X\\) and \\(P M\\) meet at \\(Z\\). Let \\(p(K, \\omega)\\) denote the power of a point \\(K\\) with respect to a circumference \\(\\omega\\). We have\n\\[\np\\left(Z, \\gamma_{B}\\right)=p\\left(Z, \\gamma_{C}\\right)=Z X \\cdot Z C=p\\left(Z, \\omega_{B}\\right)=p\\left(Z, \\omega_{C}\\right) .\n\\]\n\nPoint \\(Z\\) is thus the radical center of \\(\\gamma_{B}, \\gamma_{C}, \\omega_{B}, \\omega_{C}\\). Thus, the radical axes \\(B Y, C X, P M\\) meet at \\(Z\\). From here,\n\\[\n\\begin{aligned}\n& Z Y \\cdot Z B=Z C \\cdot Z X \\Rightarrow B C X Y \\text { cyclic } \\\\\n& P Y \\cdot P R=P X \\cdot P Q \\Rightarrow Q R X T \\text { cyclic. }\n\\end{aligned}\n\\]\n\nWe may now finish as in Solution 1.", "source_pdf": "apmo_2019.pdf", "notes": ""}
{"id": "APMO-2019-4", "contest": "APMO", "year": "2019", "problem_number": "4", "problem": "Consider a \\(2018 \\times 2019\\) board with integers in each unit square. Two unit squares are said to be neighbours if they share a common edge. In each turn, you choose some unit squares. Then for each chosen unit square the average of all its neighbours is calculated. Finally, after these calculations are done, the number in each chosen unit square is replaced by the corresponding average. Is it always possible to make the numbers in all squares become the same after finitely many turns?\n\nAnswer: No", "solution": "Solution. Let \\(n\\) be a positive integer relatively prime to 2 and 3 . We may study the whole process modulo \\(n\\) by replacing divisions by \\(2,3,4\\) with multiplications by the corresponding inverses modulo \\(n\\). If at some point the original process makes all the numbers equal, then the process modulo \\(n\\) will also have all the numbers equal. Our aim is to choose \\(n\\) and an initial configuration modulo \\(n\\) for which no process modulo \\(n\\) reaches a board with all numbers equal modulo \\(n\\). We split this goal into two lemmas.\n\nLemma 1. There is a \\(2 \\times 3\\) board that stays constant modulo 5 and whose entries are not all equal.\n\nProof. Here is one such a board:\n![](https://cdn.mathpix.com/cropped/2025_08_23_38d1d30bc7219c0da581g-6.jpg?height=207&width=307&top_left_y=702&top_left_x=879)\n\nThe fact that the board remains constant regardless of the choice of squares can be checked square by square.\n\nLemma 2. If there is an \\(r \\times s\\) board with \\(r \\geq 2, s \\geq 2\\), that stays constant modulo 5 , then there is also a \\(k r \\times l s\\) board with the same property.\n\nProof. We prove by a case by case analysis that repeateadly reflecting the \\(r \\times s\\) with respect to an edge preserves the property:\n- If a cell had 4 neighbors, after reflections it still has the same neighbors.\n- If a cell with \\(a\\) had 3 neighbors \\(b, c, d\\), we have by hypothesis that \\(a \\equiv 3^{-1}(b+c+d) \\equiv 2(b+c+d)(\\bmod 5)\\). A reflection may add \\(a\\) as a neighbor of the cell and now\n\\[\n4^{-1}(a+b+c+d) \\equiv 4(a+b+c+d) \\equiv 4 a+2 a \\equiv a \\quad(\\bmod 5)\n\\]\n- If a cell with \\(a\\) had 2 neighbors \\(b, c\\), we have by hypothesis that \\(a \\equiv 2^{-1}(b+c) \\equiv 3(b+c) (\\bmod 5)\\). If the reflections add one \\(a\\) as neighbor, now\n\\[\n3^{-1}(a+b+c) \\equiv 2(3(b+c)+b+c) \\equiv 8(b+c) \\equiv 3(b+c) \\equiv a(\\bmod 5)\n\\]\n- If a cell with \\(a\\) had 2 neighbors \\(b, c\\), we have by hypothesis that \\(a \\equiv 2^{-1}(b+c)(\\bmod 5)\\).\n\nIf the reflections add two \\(a\\) 's as neighbors, now\n\\[\n4^{-1}(2 a+b+c) \\equiv\\left(2^{-1} a+2^{-1} a\\right) \\equiv a \\quad(\\bmod 5)\n\\]\n\nIn the three cases, any cell is still preserved modulo 5 after an operation. Hence we can fill in the \\(k r \\times l s\\) board by \\(k \\times l\\) copies by reflection.\n\nSince \\(2 \\mid 2018\\) and \\(3 \\mid 2019\\), we can get through reflections the following board:\n![](https://cdn.mathpix.com/cropped/2025_08_23_38d1d30bc7219c0da581g-6.jpg?height=412&width=620&top_left_y=2324&top_left_x=725)\n\nBy the lemmas above, the board is invariant modulo 5, so the answer is no.", "source_pdf": "apmo_2019.pdf", "notes": ""}
{"id": "APMO-2019-5", "contest": "APMO", "year": "2019", "problem_number": "5", "problem": "Determine all the functions \\(f: \\mathbb{R} \\rightarrow \\mathbb{R}\\) such that\n\\[\nf\\left(x^{2}+f(y)\\right)=f(f(x))+f\\left(y^{2}\\right)+2 f(x y)\n\\]\nfor all real number \\(x\\) and \\(y\\).\nAnswer: The possible functions are \\(f(x)=0\\) for all \\(x\\) and \\(f(x)=x^{2}\\) for all \\(x\\).", "solution": "Solution. By substituting \\(x=y=0\\) in the given equation of the problem, we obtain that \\(f(0)=0\\). Also, by substituting \\(y=0\\), we get \\(f\\left(x^{2}\\right)=f(f(x))\\) for any \\(x\\).\n\nFurthermore, by letting \\(y=1\\) and simplifying, we get\n\\[\n2 f(x)=f\\left(x^{2}+f(1)\\right)-f\\left(x^{2}\\right)-f(1),\n\\]\nfrom which it follows that \\(f(-x)=f(x)\\) must hold for every \\(x\\).\nSuppose now that \\(f(a)=f(b)\\) holds for some pair of numbers \\(a, b\\). Then, by letting \\(y=a\\) and \\(y=b\\) in the given equation, comparing the two resulting identities and using the fact that \\(f\\left(a^{2}\\right)=f(f(a))=f(f(b))=f\\left(b^{2}\\right)\\) also holds under the assumption, we get the fact that\n\\[\nf(a)=f(b) \\Rightarrow f(a x)=f(b x) \\quad \\text { for any real number } x\n\\]\n\nConsequently, if for some \\(a \\neq 0, f(a)=0\\), then we see that, for any \\(x, f(x)=f\\left(a \\cdot \\frac{x}{a}\\right)= f\\left(0 \\cdot \\frac{x}{a}\\right)=f(0)=0\\), which gives a trivial solution to the problem.\n\nIn the sequel, we shall try to find a non-trivial solution for the problem. So, let us assume from now on that if \\(a \\neq 0\\) then \\(f(a) \\neq 0\\) must hold. We first note that since \\(f(f(x))=f\\left(x^{2}\\right)\\) for all \\(x\\), the right-hand side of the given equation equals \\(f\\left(x^{2}\\right)+f\\left(y^{2}\\right)+2 f(x y)\\), which is invariant if we interchange \\(x\\) and \\(y\\). Therefore, we have\n\\[\nf\\left(x^{2}\\right)+f\\left(y^{2}\\right)+2 f(x y)=f\\left(x^{2}+f(y)\\right)=f\\left(y^{2}+f(x)\\right) \\quad \\text { for every pair } x, y .\n\\]\n\nNext, let us show that for any \\(x, f(x) \\geq 0\\) must hold. Suppose, on the contrary, \\(f(s)=-t^{2}\\) holds for some pair \\(s, t\\) of non-zero real numbers. By setting \\(x=s, y=t\\) in the right hand side of (2), we get \\(f\\left(s^{2}+f(t)\\right)=f\\left(t^{2}+f(s)\\right)=f(0)=0\\), so \\(f(t)=-s^{2}\\). We also have \\(f\\left(t^{2}\\right)=f\\left(-t^{2}\\right)=f(f(s))=f\\left(s^{2}\\right)\\). By applying (2) with \\(x=\\sqrt{s^{2}+t^{2}}\\) and \\(y=s\\), we obtain\n\\[\nf\\left(s^{2}+t^{2}\\right)+2 f\\left(s \\cdot \\sqrt{s^{2}+t^{2}}\\right)=0\n\\]\nand similarly, by applying (2) with \\(x=\\sqrt{s^{2}+t^{2}}\\) and \\(y=t\\), we obtain\n\\[\nf\\left(s^{2}+t^{2}\\right)+2 f\\left(t \\cdot \\sqrt{s^{2}+t^{2}}\\right)=0\n\\]\n\nConsequently, we obtain\n\\[\nf\\left(s \\cdot \\sqrt{s^{2}+t^{2}}\\right)=f\\left(t \\cdot \\sqrt{s^{2}+t^{2}}\\right)\n\\]\n\nBy applying (1) with \\(a=s \\sqrt{s^{2}+t^{2}}, b=t \\sqrt{s^{2}+t^{2}}\\) and \\(x=1 / \\sqrt{s^{2}+t^{2}}\\), we obtain \\(f(s)= f(t)=-s^{2}\\), from which it follows that\n\\[\n0=f\\left(s^{2}+f(s)\\right)=f\\left(s^{2}\\right)+f\\left(s^{2}\\right)+2 f\\left(s^{2}\\right)=4 f\\left(s^{2}\\right)\n\\]\na contradiction to the fact \\(s^{2}>0\\). Thus we conclude that for all \\(x \\neq 0, f(x)>0\\) must be satisfied.\n\nNow, we show the following fact\n\\[\nk>0, f(k)=1 \\Leftrightarrow k=1 .\n\\]\n\nLet \\(k>0\\) for which \\(f(k)=1\\). We have \\(f\\left(k^{2}\\right)=f(f(k))=f(1)\\), so by \\((1), f(1 / k)=f(k)=\\) 1 , so we may assume \\(k \\geq 1\\). By applying (2) with \\(x=\\sqrt{k^{2}-1}\\) and \\(y=k\\), and using \\(f(x) \\geq 0\\), we get\n\\[\nf\\left(k^{2}-1+f(k)\\right)=f\\left(k^{2}-1\\right)+f\\left(k^{2}\\right)+2 f\\left(k \\sqrt{k^{2}-1}\\right) \\geq f\\left(k^{2}-1\\right)+f\\left(k^{2}\\right) .\n\\]\n\nThis simplifies to \\(0 \\geq f\\left(k^{2}-1\\right) \\geq 0\\), so \\(k^{2}-1=0\\) and thus \\(k=1\\).\nNext we focus on showing \\(f(1)=1\\). If \\(f(1)=m \\leq 1\\), then we may proceed as above by setting \\(x=\\sqrt{1-m}\\) and \\(y=1\\) to get \\(m=1\\). If \\(f(1)=m \\geq 1\\), now we note that \\(f(m)=f(f(1))=f\\left(1^{2}\\right)=f(1)=m \\leq m^{2}\\). We may then proceed as above with \\(x=\\sqrt{m^{2}-m}\\) and \\(y=1\\) to show \\(m^{2}=m\\) and thus \\(m=1\\).\n\nWe are now ready to finish. Let \\(x>0\\) and \\(m=f(x)\\). Since \\(f(f(x))=f\\left(x^{2}\\right)\\), then \\(f\\left(x^{2}\\right)= f(m)\\). But by (1), \\(f\\left(m / x^{2}\\right)=1\\). Therefore \\(m=x^{2}\\). For \\(x<0\\), we have \\(f(x)=f(-x)=f\\left(x^{2}\\right)\\) as well. Therefore, for all \\(x, f(x)=x^{2}\\).\n\nSolution 2 After proving that \\(f(x)>0\\) for \\(x \\neq 0\\) as in the previous solution, we may also proceed as follows. We claim that \\(f\\) is injective on the positive real numbers. Suppose that \\(a>b>0\\) satisfy \\(f(a)=f(b)\\). Then by setting \\(x=1 / b\\) in (1) we have \\(f(a / b)=f(1)\\). Now, by induction on \\(n\\) and iteratively setting \\(x=a / b\\) in (1) we get \\(f\\left((a / b)^{n}\\right)=1\\) for any positive integer \\(n\\).\n\nNow, let \\(m=f(1)\\) and \\(n\\) be a positive integer such that \\((a / b)^{n}>m\\). By setting \\(x= \\sqrt{(a / b)^{n}-m}\\) and \\(y=1\\) in (2) we obtain that\n\\[\nf\\left((a / b)^{n}-m+f(1)\\right)=f\\left((a / b)^{n}-m\\right)+f\\left(1^{2}\\right)+2 f\\left(\\sqrt{\\left.(a / b)^{n}-m\\right)}\\right) \\geq f\\left((a / b)^{n}-m\\right)+f(1) .\n\\]\n\nSince \\(f\\left((a / b)^{n}\\right)=f(1)\\), this last equation simplifies to \\(f\\left((a / b)^{n}-m\\right) \\leq 0\\) and thus \\(m= (a / b)^{n}\\). But this is impossible since \\(m\\) is constant and \\(a / b>1\\). Thus, \\(f\\) is injective on the positive real numbers. Since \\(f(f(x))=f\\left(x^{2}\\right)\\), we obtain that \\(f(x)=x^{2}\\) for any real value \\(x\\).", "source_pdf": "apmo_2019.pdf", "notes": ""}
{"id": "APMO-2024-1", "contest": "APMO", "year": "2024", "problem_number": "1", "problem": "Let \\(A B C\\) be an acute triangle. Let \\(D\\) be a point on side \\(A B\\) and \\(E\\) be a point on side \\(A C\\) such that lines \\(B C\\) and \\(D E\\) are parallel. Let \\(X\\) be an interior point of \\(B C E D\\). Suppose rays \\(D X\\) and \\(E X\\) meet side \\(B C\\) at points \\(P\\) and \\(Q\\), respectively such that both \\(P\\) and \\(Q\\) lie between \\(B\\) and \\(C\\). Suppose that the circumcircles of triangles \\(B Q X\\) and \\(C P X\\) intersect at a point \\(Y \\neq X\\). Prove that points \\(A, X\\), and \\(Y\\) are collinear.", "solution": "\\section*{Solution 1}\n![](https://cdn.mathpix.com/cropped/2025_08_23_cf9a878261b0acb030afg-01.jpg?height=700&width=989&top_left_y=691&top_left_x=502)\n\nLet \\(\\ell\\) be the radical axis of circles \\(B Q X\\) and \\(C P X\\). Since \\(X\\) and \\(Y\\) are on \\(\\ell\\), it is sufficient to show that \\(A\\) is on \\(\\ell\\). Let line \\(A X\\) intersect segments \\(B C\\) and \\(D E\\) at \\(Z\\) and \\(Z^{\\prime}\\), respectively. Then it is sufficient to show that \\(Z\\) is on \\(\\ell\\). By \\(B C \\| D E\\), we obtain\n\\[\n\\frac{B Z}{Z C}=\\frac{D Z^{\\prime}}{Z^{\\prime} E}=\\frac{P Z}{Z Q},\n\\]\nthus \\(B Z \\cdot Q Z=C Z \\cdot P Z\\), which implies that \\(Z\\) is on \\(\\ell\\).\n\n\\section*{Solution 2}\n![](https://cdn.mathpix.com/cropped/2025_08_23_cf9a878261b0acb030afg-01.jpg?height=701&width=992&top_left_y=2004&top_left_x=502)\n\nLet circle \\(B Q X\\) intersect line \\(A B\\) at a point \\(S\\) which is different from \\(B\\). Then \\(\\angle D E X= \\angle X Q C=\\angle B S X\\), thus \\(S\\) is on circle \\(D E X\\). Similarly, let circle \\(C P X\\) intersect line \\(A C\\) at a point \\(T\\) which is different from \\(C\\). Then \\(T\\) is on circle \\(D E X\\). The power of \\(A\\) with respect to the circle \\(D E X\\) is \\(A S \\cdot A D=A T \\cdot A E\\). Since \\(\\frac{A D}{A B}=\\frac{A E}{A C}, A S \\cdot A B=A T \\cdot A C\\). Then \\(A\\) is in the radical axis of circles \\(B Q X\\) and \\(C P X\\), which implies that three points \\(A, X\\) and \\(Y\\) are collinear.\n\n\\section*{Solution 3}\n\nConsider the (direct) homothety that takes triangle \\(A D E\\) to triangle \\(A B C\\), and let \\(Y^{\\prime}\\) be the image of \\(Y\\) under this homothety; in other words, let \\(Y^{\\prime}\\) be the intersection of the line parallel to \\(B Y\\) through \\(D\\) and the line parallel to \\(C Y\\) through \\(E\\).\n![](https://cdn.mathpix.com/cropped/2025_08_23_cf9a878261b0acb030afg-02.jpg?height=704&width=992&top_left_y=693&top_left_x=502)\n\nThe homothety implies that \\(A, Y\\), and \\(Y^{\\prime}\\) are collinear, and that \\(\\angle D Y^{\\prime} E=\\angle B Y C\\). Since \\(B Q X Y\\) and \\(C P X Y\\) are cyclic,\n\\(\\angle D Y^{\\prime} E=\\angle B Y C=\\angle B Y X+\\angle X Y C=\\angle X Q P+\\angle X P Q=180^{\\circ}-\\angle P X Q=180^{\\circ}-\\angle D X E\\),\nwhich implies that \\(D Y^{\\prime} E X\\) is cyclic. Therefore\n\\[\n\\angle D Y^{\\prime} X=\\angle D E X=\\angle P Q X=\\angle B Y X,\n\\]\nwhich, combined with \\(D Y^{\\prime} \\| B Y\\), implies \\(Y^{\\prime} X \\| Y X\\). This proves that \\(X, Y\\), and \\(Y^{\\prime}\\) are collinear, which in turn shows that \\(A, X\\), and \\(Y\\) are collinear.", "source_pdf": "apmo_2024.pdf", "notes": ""}
{"id": "APMO-2024-2", "contest": "APMO", "year": "2024", "problem_number": "2", "problem": "Consider a \\(100 \\times 100\\) table, and identify the cell in row \\(a\\) and column \\(b, 1 \\leq a, b \\leq 100\\), with the ordered pair \\((a, b)\\). Let \\(k\\) be an integer such that \\(51 \\leq k \\leq 99\\). A \\(k\\)-knight is a piece that moves one cell vertically or horizontally and \\(k\\) cells to the other direction; that is, it moves from \\((a, b)\\) to ( \\(c, d\\) ) such that ( \\(|a-c|,|b-d|\\) ) is either ( \\(1, k\\) ) or ( \\(k, 1\\) ). The \\(k\\)-knight starts at cell \\((1,1)\\), and performs several moves. A sequence of moves is a sequence of cells \\(\\left(x_{0}, y_{0}\\right)=(1,1)\\), \\(\\left(x_{1}, y_{1}\\right),\\left(x_{2}, y_{2}\\right), \\ldots,\\left(x_{n}, y_{n}\\right)\\) such that, for all \\(i=1,2, \\ldots, n, 1 \\leq x_{i}, y_{i} \\leq 100\\) and the \\(k\\)-knight can move from \\(\\left(x_{i-1}, y_{i-1}\\right)\\) to \\(\\left(x_{i}, y_{i}\\right)\\). In this case, each cell \\(\\left(x_{i}, y_{i}\\right)\\) is said to be reachable. For each \\(k\\), find \\(L(k)\\), the number of reachable cells.\n\nAnswer: \\(L(k)=\\left\\{\\begin{array}{ll}100^{2}-(2 k-100)^{2} & \\text { if } k \\text { is even } \\\\ \\frac{100^{2}-(2 k-100)^{2}}{2} & \\text { if } k \\text { is odd }\\end{array}\\right.\\).", "solution": "\\section*{Solution}\n\nCell ( \\(x, y\\) ) is directly reachable from another cell if and only if \\(x-k \\geq 1\\) or \\(x+k \\leq 100\\) or \\(y-k \\geq 1\\) or \\(y+k \\leq 100\\), that is, \\(x \\geq k+1\\) or \\(x \\leq 100-k\\) or \\(y \\geq k+1\\) or \\(y \\leq 100-k(*)\\). Therefore the cells ( \\(x, y\\) ) for which \\(101-k \\leq x \\leq k\\) and \\(101-k \\leq y \\leq k\\) are unreachable. Let \\(S\\) be this set of unreachable cells in this square, namely the square of cells \\((x, y), 101-k \\leq x, y \\leq k\\).\nIf condition (*) is valid for both ( \\(x, y\\) ) and ( \\(x \\pm 2, y \\pm 2\\) ) then one can move from ( \\(x, y\\) ) to \\((x \\pm 2, y \\pm 2)\\), if they are both in the table, with two moves: either \\(x \\leq 50\\) or \\(x \\geq 51\\); the same is true for \\(y\\). In the first case, move \\((x, y) \\rightarrow(x+k, y \\pm 1) \\rightarrow(x, y \\pm 2)\\) or \\((x, y) \\rightarrow (x \\pm 1, y+k) \\rightarrow(x \\pm 2, y)\\). In the second case, move \\((x, y) \\rightarrow(x-k, y \\pm 1) \\rightarrow(x, y \\pm 2)\\) or \\((x, y) \\rightarrow(x \\pm 1, y-k) \\rightarrow(x \\pm 2, y)\\).\nHence if the table is colored in two colors like a chessboard, if \\(k \\leq 50\\), cells with the same color as \\((1,1)\\) are reachable. Moreover, if \\(k\\) is even, every other move changes the color of the occupied cell, and all cells are potentially reachable; otherwise, only cells with the same color as \\((1,1)\\) can be visited. Therefore, if \\(k\\) is even then the reachable cells consists of all cells except the center square defined by \\(101-k \\leq x \\leq k\\) and \\(101-k \\leq y \\leq k\\), that is, \\(L(k)=100^{2}-(2 k-100)^{2}\\); if \\(k\\) is odd, then only half of the cells are reachable: the ones with the same color as \\((1,1)\\), and \\(L(k)=\\frac{1}{2}\\left(100^{2}-(2 k-100)^{2}\\right)\\).", "source_pdf": "apmo_2024.pdf", "notes": ""}
{"id": "APMO-2024-3", "contest": "APMO", "year": "2024", "problem_number": "3", "problem": "Let \\(n\\) be a positive integer and \\(a_{1}, a_{2}, \\ldots, a_{n}\\) be positive real numbers. Prove that\n\\[\n\\sum_{i=1}^{n} \\frac{1}{2^{i}}\\left(\\frac{2}{1+a_{i}}\\right)^{2^{i}} \\geq \\frac{2}{1+a_{1} a_{2} \\ldots a_{n}}-\\frac{1}{2^{n}}\n\\]", "solution": "\\section*{Solution}\n\nWe first prove the following lemma:\nLemma 1. For \\(k\\) positive integer and \\(x, y>0\\),\n\\[\n\\left(\\frac{2}{1+x}\\right)^{2^{k}}+\\left(\\frac{2}{1+y}\\right)^{2^{k}} \\geq 2\\left(\\frac{2}{1+x y}\\right)^{2^{k-1}} .\n\\]\n\nThe proof goes by induction. For \\(k=1\\), we have\n\\[\n\\left(\\frac{2}{1+x}\\right)^{2}+\\left(\\frac{2}{1+y}\\right)^{2} \\geq 2\\left(\\frac{2}{1+x y}\\right)\n\\]\nwhich reduces to\n\\[\nx y(x-y)^{2}+(x y-1)^{2} \\geq 0 .\n\\]\n\nFor \\(k>1\\), by the inequality \\(2\\left(A^{2}+B^{2}\\right) \\geq(A+B)^{2}\\) applied at \\(A=\\left(\\frac{2}{1+x}\\right)^{2^{k-1}}\\) and \\(B=\\left(\\frac{2}{1+y}\\right)^{2^{k-1}}\\) followed by the induction hypothesis\n\\[\n\\begin{aligned}\n2\\left(\\left(\\frac{2}{1+x}\\right)^{2^{k}}+\\left(\\frac{2}{1+y}\\right)^{2^{k}}\\right) & \\geq\\left(\\left(\\frac{2}{1+x}\\right)^{2^{k-1}}+\\left(\\frac{2}{1+y}\\right)^{2^{k-1}}\\right)^{2} \\\\\n& \\geq\\left(2\\left(\\frac{2}{1+x y}\\right)^{2^{k-2}}\\right)^{2}=4\\left(\\frac{2}{1+x y}\\right)^{2^{k-1}}\n\\end{aligned}\n\\]\nfrom which the lemma follows.\nThe problem now can be deduced from summing the following applications of the lemma, multiplied by the appropriate factor:\n\\[\n\\begin{aligned}\n\\frac{1}{2^{n}}\\left(\\frac{2}{1+a_{n}}\\right)^{2^{n}}+\\frac{1}{2^{n}}\\left(\\frac{2}{1+1}\\right)^{2^{n}} & \\geq \\frac{1}{2^{n-1}}\\left(\\frac{2}{1+a_{n} \\cdot 1}\\right)^{2^{n-1}} \\\\\n\\frac{1}{2^{n-1}}\\left(\\frac{2}{1+a_{n-1}}\\right)^{2^{n-1}}+\\frac{1}{2^{n-1}}\\left(\\frac{2}{1+a_{n}}\\right)^{2^{n-1}} & \\geq \\frac{1}{2^{n-2}}\\left(\\frac{2}{1+a_{n-1} a_{n}}\\right)^{2^{n-2}} \\\\\n\\frac{1}{2^{n-2}}\\left(\\frac{2}{1+a_{n-2}}\\right)^{2^{n-2}}+\\frac{1}{2^{n-2}}\\left(\\frac{2}{1+a_{n-1} a_{n}}\\right)^{2^{n-2}} & \\geq \\frac{1}{2^{n-3}}\\left(\\frac{2}{1+a_{n-2} a_{n-1} a_{n}}\\right)^{2^{n-3}} \\\\\n\\cdots & 2^{2^{k}} \\\\\n\\frac{1}{2^{k}}\\left(\\frac{2}{1+a_{k}}\\right)^{2^{k}}+\\frac{1}{2^{k}}\\left(\\frac{2}{1+a_{k+1} \\ldots a_{n-1} a_{n}}\\right)^{2^{k-1}} & \\geq \\frac{1}{2^{k-1}}\\left(\\frac{2}{1+a_{k} \\ldots a_{n-2} a_{n-1} a_{n}}\\right)^{-} \\\\\n\\frac{1}{2}\\left(\\frac{2}{1+a_{1}}\\right)^{2}+\\frac{1}{2}\\left(\\frac{2}{1+a_{2} \\ldots a_{n-1} a_{n}}\\right)^{2} & \\geq \\frac{2}{1+a_{1} \\ldots a_{n-2} a_{n-1} a_{n}}\n\\end{aligned}\n\\]\n\nComment: Equality occurs if and only if \\(a_{1}=a_{2}=\\cdots=a_{n}=1\\).\n\nComment: The main motivation for the lemma is trying to \"telescope\" the sum\n\\[\n\\frac{1}{2^{n}}+\\sum_{i=1}^{n} \\frac{1}{2^{i}}\\left(\\frac{2}{1+a_{i}}\\right)^{2^{i}},\n\\]\nthat is,\n\\[\n\\frac{1}{2}\\left(\\frac{2}{1+a_{1}}\\right)^{2}+\\cdots+\\frac{1}{2^{n-1}}\\left(\\frac{2}{1+a_{n-1}}\\right)^{2^{n-1}}+\\frac{1}{2^{n}}\\left(\\frac{2}{1+a_{n}}\\right)^{2^{n}}+\\frac{1}{2^{n}}\\left(\\frac{2}{1+1}\\right)^{2^{n}}\n\\]\nto obtain an expression larger than or equal to\n\\[\n\\frac{2}{1+a_{1} a_{2} \\ldots a_{n}} .\n\\]\n\nIt seems reasonable to obtain a inequality that can be applied from right to left, decreases the exponent of the factor \\(1 / 2^{k}\\) by 1 , and multiplies the variables in the denominator. Given that, the lemma is quite natural:\n\\[\n\\frac{1}{2^{k}}\\left(\\frac{2}{1+x}\\right)^{2^{k}}+\\frac{1}{2^{k}}\\left(\\frac{2}{1+y}\\right)^{2^{k}} \\geq \\frac{1}{2^{k-1}}\\left(\\frac{2}{1+x y}\\right)^{2^{i-1}},\n\\]\nor\n\\[\n\\left(\\frac{2}{1+x}\\right)^{2^{k}}+\\left(\\frac{2}{1+y}\\right)^{2^{k}} \\geq 2\\left(\\frac{2}{1+x y}\\right)^{2^{k-1}} .\n\\]", "source_pdf": "apmo_2024.pdf", "notes": ""}
{"id": "APMO-2024-4", "contest": "APMO", "year": "2024", "problem_number": "4", "problem": "Prove that for every positive integer \\(t\\) there is a unique permutation \\(a_{0}, a_{1}, \\ldots, a_{t-1}\\) of \\(0,1, \\ldots, t-\\) 1 such that, for every \\(0 \\leq i \\leq t-1\\), the binomial coefficient \\(\\binom{t+i}{2 a_{i}}\\) is odd and \\(2 a_{i} \\neq t+i\\).", "solution": "\\section*{Solution}\n\nWe constantly make use of Kummer's theorem which, in particular, implies that \\(\\binom{n}{k}\\) is odd if and only if \\(k\\) and \\(n-k\\) have ones in different positions in binary. In other words, if \\(S(x)\\) is the set of positions of the digits 1 of \\(x\\) in binary (in which the digit multiplied by \\(2^{i}\\) is in position \\(i),\\binom{n}{k}\\) is odd if and only if \\(S(k) \\subseteq S(n)\\). Moreover, if we set \\(k<n, S(k)\\) is a proper subset of \\(S(n)\\), that is, \\(|S(k)|<|S(n)|\\).\nWe start with a lemma that guides us how the permutation should be set.\n\n\\section*{Lemma 1.}\n\\[\n\\sum_{i=0}^{t-1}|S(t+i)|=t+\\sum_{i=0}^{t-1}|S(2 i)| .\n\\]\n\nThe proof is just realizing that \\(S(2 i)=\\{1+x, x \\in S(i)\\}\\) and \\(S(2 i+1)=\\{0\\} \\cup\\{1+x, x \\in S(i)\\}\\), because \\(2 i\\) in binary is \\(i\\) followed by a zero and \\(2 i+1\\) in binary is \\(i\\) followed by a one. Therefore\n\\[\n\\begin{aligned}\n\\sum_{i=0}^{t-1}|S(t+i)| & =\\sum_{i=0}^{2 t-1}|S(i)|-\\sum_{i=0}^{t-1}|S(i)|=\\sum_{i=0}^{t-1}|S(2 i)|+\\sum_{i=0}^{t-1}|S(2 i+1)|-\\sum_{i=0}^{t-1}|S(i)| \\\\\n& =\\sum_{i=0}^{t-1}|S(i)|+\\sum_{i=0}^{t-1}(1+|S(i)|)-\\sum_{i=0}^{t-1}|S(i)|=t+\\sum_{i=0}^{t-1}|S(i)|=t+\\sum_{i=0}^{t-1}|S(2 i)| .\n\\end{aligned}\n\\]\n\nThe lemma has an immediate corollary: since \\(t+i>2 a_{i}\\) and \\(\\binom{t+i}{2 a_{i}}\\) is odd for all \\(i, 0 \\leq i \\leq t-1\\), \\(S\\left(2 a_{i}\\right) \\subset S(t+i)\\) with \\(\\left|S\\left(2 a_{i}\\right)\\right| \\leq|S(t+i)|-1\\). Since the sum of \\(\\left|S\\left(2 a_{i}\\right)\\right|\\) is \\(t\\) less than the sum of \\(|S(t+i)|\\), and there are \\(t\\) values of \\(i\\), equality must occur, that is, \\(\\left|S\\left(2 a_{i}\\right)\\right|=|S(t+i)|-1\\), which in conjunction with \\(S\\left(2 a_{i}\\right) \\subset S(t+i)\\) means that \\(t+i-2 a_{i}=2^{k_{i}}\\) for every \\(i, 0 \\leq i \\leq t-1\\), \\(k_{i} \\in S(t+i)\\) (more precisely, \\(\\left\\{k_{i}\\right\\}=S(t+i) \\backslash S\\left(2 a_{i}\\right)\\).)\nIn particular, for \\(t+i\\) odd, this means that \\(t+i-2 a_{i}=1\\), because the only odd power of 2 is 1. Then \\(a_{i}=\\frac{t+i-1}{2}\\) for \\(t+i\\) odd, which takes up all the numbers greater than or equal to \\(\\frac{t-1}{2}\\). Now we need to distribute the numbers that are smaller than \\(\\frac{t-1}{2}\\) (call these numbers small). If \\(t+i\\) is even then by Lucas' Theorem \\(\\binom{t+i}{2 a_{i}} \\equiv\\left(\\frac{t+i}{2}\\right)(\\bmod 2)\\), so we pair numbers from \\(\\lceil t / 2\\rceil\\) to \\(t-1\\) (call these numbers big) with the small numbers.\nSay that a set \\(A\\) is paired with another set \\(B\\) whenever \\(|A|=|B|\\) and there exists a bijection \\(\\pi: A \\rightarrow B\\) such that \\(S(a) \\subset S(\\pi(a))\\) and \\(|S(a)|=|S(\\pi(a))|-1\\); we also say that \\(a\\) and \\(\\pi(a)\\) are paired. We prove by induction in \\(t\\) that \\(A_{t}=\\{0,1,2, \\ldots,\\lfloor t / 2\\rfloor-1\\}\\) (the set of small numbers) and \\(B_{t}=\\{\\lceil t / 2\\rceil, \\ldots, t-2, t-1\\}\\) (the set of big numbers) can be uniquely paired.\nThe claim is immediate for \\(t=1\\) and \\(t=2\\). For \\(t>2\\), there is exactly one power of two in \\(B_{t}\\), since \\(t / 2 \\leq 2^{a}<t \\Longleftrightarrow a=\\left\\lceil\\log _{2}(t / 2)\\right\\rceil\\). Let \\(2^{a}\\) be this power of two. Then, since \\(2^{a} \\geq t / 2\\), no number in \\(A_{t}\\) has a one in position \\(a\\) in binary. Since for every number \\(x, 2^{a} \\leq x<t, a \\in S(x)\\) and \\(a \\notin S(y)\\) for all \\(y \\in A_{t}, x\\) can only be paired with \\(x-2^{a}\\), since \\(S(x)\\) needs to be stripped of exactly one position. This takes cares of \\(x \\in B_{t}, 2^{a} \\leq x<t\\), and \\(y \\in A_{t}, 0 \\leq y<t-2^{a}\\).\nNow we need to pair the numbers from \\(A^{\\prime}=\\left\\{t-2^{a}, t-2^{a}+1, \\ldots,\\lfloor t / 2\\rfloor-1\\right\\} \\subset A\\) with the numbers from \\(B^{\\prime}=\\left\\{\\lceil t / 2\\rceil,\\lceil t / 2\\rceil+1, \\ldots, 2^{a}-1\\right\\} \\subset B\\). In order to pair these \\(t-2\\left(t-2^{a}\\right)= 2^{a+1}-t<t\\) numbers, we use the induction hypothesis and a bijection between \\(A^{\\prime} \\cup B^{\\prime}\\) and \\(B_{2^{a+1}{ }_{-t}} \\cup A_{2^{a+1}{ }_{-t}}\\). Let \\(S=S\\left(2^{a}-1\\right)=\\{0,1,2, \\ldots, a-1\\}\\). Then take a pair \\(x, y, x \\in A_{2^{a+1}-t}\\) and \\(y \\in B_{2^{a+1}-t}\\) and biject it with \\(2^{a}-1-x \\in B^{\\prime}\\) and \\(2^{a}-1-y \\in A^{\\prime}\\). In fact,\n\\[\n0 \\leq x \\leq\\left\\lfloor\\frac{2^{a+1}-t}{2}\\right\\rfloor-1=2^{a}-\\left\\lceil\\frac{t}{2}\\right\\rceil-1 \\Longleftrightarrow\\left\\lceil\\frac{t}{2}\\right\\rceil \\leq 2^{a}-1-x \\leq 2^{a}-1\n\\]\nand\n\\[\n\\left\\lceil\\frac{2^{a+1}-t}{2}\\right\\rceil=2^{a}-\\left\\lfloor\\frac{t}{2}\\right\\rfloor \\leq y \\leq 2^{a+1}-t-1 \\Longleftrightarrow t-2^{a} \\leq 2^{a}-1-y \\leq\\left\\lfloor\\frac{t}{2}\\right\\rfloor-1 .\n\\]\n\nMoreover, \\(S\\left(2^{a}-1-x\\right)=S \\backslash S(x)\\) and \\(S\\left(2^{a}-1-y\\right)=S \\backslash S(y)\\) are complements with respect to \\(S\\), and \\(S(x) \\subset S(y)\\) and \\(|S(x)|=|S(y)|-1\\) implies \\(S\\left(2^{a}-1-y\\right) \\subset S\\left(2^{a}-1-x\\right)\\) and \\(\\left|S\\left(2^{a}-1-y\\right)\\right|=\\left|S\\left(2^{a}-1-x\\right)\\right|-1\\). Therefore a pairing between \\(A^{\\prime}\\) and \\(B^{\\prime}\\) corresponds to a pairing between \\(A_{2^{a+1}-t}\\) and \\(B_{2^{a+1}-t}\\). Since the latter pairing is unique, the former pairing is also unique, and the result follows.\nWe illustrate the bijection by showing the case \\(t=23\\) :\n\\[\nA_{23}=\\{0,1,2, \\ldots, 10\\}, \\quad B_{23}=\\{12,13,14, \\ldots, 22\\}\n\\]\n\nThe pairing is\n\\[\n\\left(\\begin{array}{ccccccccccc}\n12 & 13 & 14 & 15 & 16 & 17 & 18 & 19 & 20 & 21 & 22 \\\\\n8 & 9 & 10 & 7 & 0 & 1 & 2 & 3 & 4 & 5 & 6\n\\end{array}\\right)\n\\]\nin which the bijection is between\n\\[\n\\left(\\begin{array}{cccc}\n12 & 13 & 14 & 15 \\\\\n8 & 9 & 10 & 7\n\\end{array}\\right) \\quad \\text { and } \\quad\\left(\\begin{array}{cccc}\n3 & 2 & 1 & 0 \\\\\n7 & 6 & 5 & 8\n\\end{array}\\right) \\rightarrow\\left(\\begin{array}{cccc}\n5 & 6 & 7 & 8 \\\\\n1 & 2 & 3 & 0\n\\end{array}\\right)\n\\]", "source_pdf": "apmo_2024.pdf", "notes": ""}
{"id": "APMO-2024-5", "contest": "APMO", "year": "2024", "problem_number": "5", "problem": "Line \\(\\ell\\) intersects sides \\(B C\\) and \\(A D\\) of cyclic quadrilateral \\(A B C D\\) in its interior points \\(R\\) and \\(S\\) respectively, and intersects ray \\(D C\\) beyond point \\(C\\) at \\(Q\\), and ray \\(B A\\) beyond point \\(A\\) at \\(P\\). Circumcircles of the triangles \\(Q C R\\) and \\(Q D S\\) intersect at \\(N \\neq Q\\), while circumcircles of the triangles \\(P A S\\) and \\(P B R\\) intersect at \\(M \\neq P\\). Let lines \\(M P\\) and \\(N Q\\) meet at point \\(X\\), lines \\(A B\\) and \\(C D\\) meet at point \\(K\\) and lines \\(B C\\) and \\(A D\\) meet at point \\(L\\). Prove that point \\(X\\) lies on line \\(K L\\).", "solution": "\\section*{Solution 1}\n\nWe start with the following lemma.\nLemma 1. Points \\(M, N, P, Q\\) are concyclic.\nPoint \\(M\\) is the Miquel point of lines \\(A P=A B, P S=\\ell, A S=A D\\), and \\(B R=B C\\), and point \\(N\\) is the Miquel point of lines \\(C Q=C D, R C=B C, Q R=\\ell\\), and \\(D S=A D\\). Both points \\(M\\) and \\(N\\) are on the circumcircle of the triangle determined by the common lines \\(A D, \\ell\\), and \\(B C\\), which is \\(L R S\\).\nThen, since quadrilaterals \\(Q N R C, P M A S\\), and \\(A B C D\\) are all cyclic, using directed angles (modulo \\(180^{\\circ}\\) )\n\\[\n\\begin{aligned}\n\\measuredangle N M P & =\\measuredangle N M S+\\measuredangle S M P=\\measuredangle N R S+\\measuredangle S A P=\\measuredangle N R Q+\\measuredangle D A B=\\measuredangle N R Q+\\measuredangle D C B \\\\\n& =\\measuredangle N R Q+\\measuredangle Q C R=\\measuredangle N R Q+\\measuredangle Q N R=\\measuredangle N Q R=\\measuredangle N Q P,\n\\end{aligned}\n\\]\nwhich implies that \\(M N Q P\\) is a cyclic quadrilateral.\n![](https://cdn.mathpix.com/cropped/2025_08_23_cf9a878261b0acb030afg-08.jpg?height=952&width=1094&top_left_y=1319&top_left_x=451)\n\nLet \\(E\\) be the Miquel point of \\(A B C D\\) (that is, of lines \\(A B, B C, C D, D A\\) ). It is well known that \\(E\\) lies in the line \\(t\\) connecting the intersections of the opposite lines of \\(A B C D\\). Let lines \\(N Q\\) and \\(t\\) meet at \\(T\\). If \\(T \\neq E\\), using directed angles, looking at the circumcircles of \\(L A B\\) (which contains, by definition, \\(E\\) and \\(M\\) ), \\(A P S\\) (which also contains \\(M\\) ), and \\(M N Q P\\),\n\\[\n\\measuredangle T E M=\\measuredangle L E M=\\measuredangle L A M=\\measuredangle S A M=\\measuredangle S P M=\\measuredangle Q P M=\\measuredangle Q N M=\\measuredangle T N M,\n\\]\nthat is, \\(T\\) lies in the circumcircle \\(\\omega\\) of \\(E M N\\). If \\(T=E\\), the same computation shows that \\(\\measuredangle L E M=\\measuredangle E N M\\), which means that \\(t\\) is tangent to \\(\\omega\\).\n\nNow let lines \\(M P\\) and \\(t\\) meet at \\(V\\). An analogous computation shows, by looking at the circumcircles of \\(L C D\\) (which contains \\(E\\) and \\(N\\) ), \\(C Q R\\), and \\(M N Q P\\), that \\(V\\) lies in \\(\\omega\\) as well, and that if \\(V=E\\) then \\(t\\) is tangent to \\(\\omega\\).\nTherefore, since \\(\\omega\\) meet \\(t\\) at \\(T, V\\), and \\(E\\), either \\(T=V\\) if both \\(T \\neq E\\) and \\(V \\neq E\\) or \\(T=V=E\\). At any rate, the intersection of lines \\(M P\\) and \\(N Q\\) lies in \\(t\\).\n\n\\section*{Solution 2}\n\nBarycentric coordinates are a viable way to solve the problem, but even the solution we have found had some clever computations. Here is an outline of this solution.\n\nLemma 2. Denote by \\(\\operatorname{pow}_{\\omega} X\\) the power of point \\(X\\) with respect to circle \\(\\omega\\). Let \\(\\Gamma_{1}\\) and \\(\\Gamma_{2}\\) be circles with different centers. Considering \\(A B C\\) as the reference triangle in barycentric coordinates, the radical axis of \\(\\Gamma_{1}\\) and \\(\\Gamma_{2}\\) is given by\n\\[\n\\left(\\operatorname{pow}_{\\Gamma_{1}} A-\\operatorname{pow}_{\\Gamma_{2}} A\\right) x+\\left(\\operatorname{pow}_{\\Gamma_{1}} B-\\operatorname{pow}_{\\Gamma_{2}} B\\right) y+\\left(\\operatorname{pow}_{\\Gamma_{1}} C-\\operatorname{pow}_{\\Gamma_{2}} C\\right) z=0 .\n\\]\n\nProof: Let \\(\\Gamma_{i}\\) have the equation \\(\\Gamma_{i}(x, y, z)=-a^{2} y z-b^{2} z x-c^{2} x y+(x+y+z)\\left(r_{i} x+s_{i} y+t_{i} z\\right)\\). Then \\(\\operatorname{pow}_{\\Gamma_{i}} P=\\Gamma_{i}(P)\\). In particular, \\(\\operatorname{pow}_{\\Gamma_{i}} A=\\Gamma_{i}(1,0,0)=r_{i}\\) and, similarly, \\(\\operatorname{pow}_{\\Gamma_{i}} B=s_{i}\\) and \\(\\operatorname{pow}_{\\Gamma_{i}} C=t_{i}\\).\nFinally, the radical axis is\n\\[\n\\begin{aligned}\n& \\operatorname{pow}_{\\Gamma_{1}} P=\\operatorname{pow}_{\\Gamma_{2}} P \\\\\n\\Longleftrightarrow & \\Gamma_{1}(x, y, z)=\\Gamma_{2}(x, y, z) \\\\\n\\Longleftrightarrow & r_{1} x+s_{1} y+t_{1} z=r_{2} x+s_{2} y+t_{2} z \\\\\n\\Longleftrightarrow & \\left(\\operatorname{pow}_{\\Gamma_{1}} A-\\operatorname{pow}_{\\Gamma_{2}} A\\right) x+\\left(\\operatorname{pow}_{\\Gamma_{1}} B-\\operatorname{pow}_{\\Gamma_{2}} B\\right) y+\\left(\\operatorname{pow}_{\\Gamma_{1}} C-\\operatorname{pow}_{\\Gamma_{2}} C\\right) z=0 .\n\\end{aligned}\n\\]\n\nWe still use the Miquel point \\(E\\) of \\(A B C D\\). Notice that the problem is equivalent to proving that lines \\(M P, N Q\\), and \\(E K\\) are concurrent. The main idea is writing these three lines as radical axes. In fact, by definition of points \\(M, N\\), and \\(E\\) :\n- \\(M P\\) is the radical axis of the circumcircles of \\(P A S\\) and \\(P B R\\);\n- \\(N Q\\) is the radical axis of the circumcircles of \\(Q C R\\) and \\(Q D S\\);\n- \\(E K\\) is the radical axis of the circumcircles of \\(K B C\\) and \\(K A D\\).\n\nLooking at these facts and the diagram, it makes sense to take triangle \\(K Q P\\) the reference triangle. Because of that, we do not really need to draw circles nor even points \\(M\\) and \\(N\\), as all powers can be computed directly from points in lines \\(K P, K Q\\), and \\(P Q\\).\n![](https://cdn.mathpix.com/cropped/2025_08_23_cf9a878261b0acb030afg-09.jpg?height=507&width=1035&top_left_y=2058&top_left_x=482)\n\nAssociate \\(P\\) with the \\(x\\)-coordinate, \\(Q\\) with the \\(y\\)-coordinate, and \\(K\\) with the \\(z\\)-coordinate. Applying the lemma, the equations of lines \\(P M, Q N\\), and \\(E K\\) are\n- \\(M P:(K A \\cdot K P-K B \\cdot K P) x+(Q S \\cdot Q P-Q R \\cdot Q P) y=0\\)\n- \\(N Q:(K C \\cdot K Q-K D \\cdot K Q) x+(P R \\cdot P Q-P S \\cdot P Q) z=0\\)\n- \\(M P:(-Q C \\cdot Q K+Q D \\cdot Q K) y+(P B \\cdot P K-P A \\cdot P K) z=0\\)\n\nThese equations simplify to\n- \\(M P:(A B \\cdot K P) x+(P Q \\cdot R S) y=0\\)\n- \\(N Q:(-C D \\cdot K Q) x+(P Q \\cdot R S) z=0\\)\n- \\(M P:(C D \\cdot K Q) y+(A B \\cdot K P) z=0\\)\n\nNow, if \\(u=A B \\cdot K P, v=P Q \\cdot R S\\), and \\(w=C D \\cdot K Q\\), it suffices to show that\n\\[\n\\left|\\begin{array}{ccc}\nu & v & 0 \\\\\n-w & 0 & v \\\\\n0 & w & u\n\\end{array}\\right|=0,\n\\]\nwhich is a straightforward computation.", "source_pdf": "apmo_2024.pdf", "notes": ""}
{"id": "APMO-2025-1", "contest": "APMO", "year": "2025", "problem_number": "1", "problem": "Let \\(A B C\\) be an acute triangle inscribed in a circle \\(\\Gamma\\). Let \\(A_{1}\\) be the orthogonal projection of \\(A\\) onto \\(B C\\) so that \\(A A_{1}\\) is an altitude. Let \\(B_{1}\\) and \\(C_{1}\\) be the orthogonal projections of \\(A_{1}\\) onto \\(A B\\) and \\(A C\\), respectively. Point \\(P\\) is such that quadrilateral \\(A B_{1} P C_{1}\\) is convex and has the same area as triangle \\(A B C\\). Is it possible that \\(P\\) strictly lies in the interior of circle \\(\\Gamma\\) ? Justify your answer.\n\nAnswer: No.", "solution": "\\section*{Solution}\n\nFirst notice that, since angles \\(\\angle A A_{1} B_{1}\\) and \\(\\angle A A_{1} C_{1}\\) are both right, the points \\(B_{1}\\) and \\(C_{1}\\) lie on the circle with \\(A A_{1}\\) as a diameter. Therefore, \\(A C_{1}=A A_{1} \\sin \\angle A A_{1} C_{1}=A A_{1} \\sin \\left(90^{\\circ}-\\right. \\left.\\angle A_{1} A C\\right)=A A_{1} \\sin \\angle C\\), similarly \\(A B_{1}=A A_{1} \\sin \\angle B\\), and \\(B_{1} C_{1}=A A_{1} \\sin \\angle A\\). Hence; triangles \\(A C_{1} B_{1}\\) and \\(A B C\\) are similar.\n![](https://cdn.mathpix.com/cropped/2025_08_23_c776d6401e128283d249g-1.jpg?height=672&width=601&top_left_y=936&top_left_x=696)\n\nLet \\(O\\) be the circumcenter of \\(A B C\\) and \\(A D\\) be one of its diameters. Since \\(\\angle O A C=\\frac{1}{2}\\left(180^{\\circ}-\\right. \\angle A O C)=90^{\\circ}-\\angle B=90^{\\circ}-\\angle A C_{1} B_{1}\\), it follows that \\(A D\\) is perpendicular to \\(B_{1} C_{1}\\). Let \\(A D=2 R\\); recall that, from the law of sines, \\(\\frac{B C}{\\sin \\angle A}=2 R \\Longleftrightarrow B C=2 R \\sin \\angle A\\). The area of quadrilateral \\(A B_{1} D C_{1}\\) is\n\\[\n\\frac{B_{1} C_{1} \\cdot A D}{2}=\\frac{A A_{1} \\sin \\angle A \\cdot 2 R}{2}=\\frac{A A_{1} \\cdot B C}{2},\n\\]\nwhich is indeed the area of \\(A B C\\).\nSince \\(B_{1}\\) and \\(C_{1}\\) are fixed points, the loci of the points \\(P\\) such that \\(A B_{1} P C_{1}\\) is a convex quadrilateral with the same area as \\(A B C\\) is a line parallel to \\(B_{1} C_{1}\\). That is, perpendicular to \\(A D\\). Since the area of \\(A B_{1} D C_{1}\\) is the same as the area of \\(A B C\\), this locus is the line perpendicular to \\(A D\\) through \\(D\\), which is tangent to the circumcircle of \\(A B C\\). Therefore, it is not possible that the point \\(P\\) lies inside the circumcircle of \\(A B C\\).", "source_pdf": "apmo_2025.pdf", "notes": ""}
{"id": "APMO-2025-2", "contest": "APMO", "year": "2025", "problem_number": "2", "problem": "Let \\(\\alpha\\) and \\(\\beta\\) be positive real numbers. Emerald makes a trip in the coordinate plane, starting off from the origin \\((0,0)\\). Each minute she moves one unit up or one unit to the right, restricting herself to the region \\(|x-y|<2025\\), in the coordinate plane. By the time she visits a point ( \\(x, y\\) ) she writes down the integer \\(\\lfloor x \\alpha+y \\beta\\rfloor\\) on it. It turns out that Emerald wrote each non-negative integer exactly once. Find all the possible pairs ( \\(\\alpha, \\beta\\) ) for which such a trip would be possible.\n\nAnswer: \\((\\alpha, \\beta)\\) such that \\(\\alpha+\\beta=2\\).", "solution": "\\section*{Solution}\n\nLet \\(\\left(x_{n}, y_{n}\\right)\\) be the point that Emerald visits after \\(n\\) minutes. Then \\(\\left(x_{n+1}, y_{n+1}\\right) \\in\\left\\{\\left(x_{n}+\\right.\\right. \\left.\\left.1, y_{n}\\right),\\left(x_{n}, y_{n}+1\\right)\\right\\}\\). Either way, \\(x_{n+1}+y_{n+1}=x_{n}+y_{n}+1\\), and since \\(x_{0}+y_{0}=0+0=0\\), \\(x_{n}+y_{n}=n\\).\nThe \\(n\\)-th number would be then\n\\[\nz_{n}=\\left\\lfloor x_{n} \\alpha+\\left(n-x_{n}\\right) \\beta\\right\\rfloor \\Longrightarrow n \\beta+x_{n}(\\alpha-\\beta)-1<z_{n}<n \\beta+x_{n}(\\alpha-\\beta),\n\\]\nin which\n\\[\n-2025<x_{n}-y_{n}<2025 \\Longleftrightarrow \\frac{n-2025}{2}<x_{n}<\\frac{n+2025}{2} .\n\\]\n\nSuppose without loss of generality that \\(\\alpha \\geq \\beta\\). Then\n\\[\nn \\beta+\\frac{n-2025}{2}(\\alpha-\\beta)-1<z_{n}<n \\beta+\\frac{n+2025}{2}(\\alpha-\\beta),\n\\]\nwhich reduces to\n\\[\n\\left|z_{n}-\\frac{\\alpha+\\beta}{2} n\\right|<\\frac{2025}{2}(\\alpha-\\beta)+1 .\n\\]\n\nOn the other hand, \\(z_{n+1}=\\left\\lfloor x_{n+1} \\alpha+y_{n+1} \\beta\\right\\rfloor \\in\\left\\{\\left\\lfloor x_{n} \\alpha+y_{n} \\beta+\\alpha\\right\\rfloor,\\left\\lfloor x_{n} \\alpha+y_{n} \\beta+\\beta\\right\\rfloor\\right\\}\\), which implies \\(z_{n+1} \\geq z_{n}\\). Since every non-negative integer appears exactly once, in increasing order, it follows that \\(z_{n}=n\\).\nTherefore, for all positive integers \\(n\\),\n\\[\n\\left|n-\\frac{\\alpha+\\beta}{2} n\\right|<\\frac{2025}{2}(\\alpha-\\beta)+1,\n\\]\nwhich can only be possible if \\(\\alpha+\\beta=2\\); otherwise, the left hand side would be unbounded. If \\(\\alpha+\\beta=2\\), consider \\(x_{n}=\\left\\lceil\\frac{n}{2}\\right\\rceil\\) and \\(y_{n}=\\left\\lfloor\\frac{n}{2}\\right\\rfloor\\). If \\(n\\) is even,\n\\[\nz_{n}=\\left\\lfloor\\frac{n}{2} \\alpha+\\frac{n}{2} \\beta\\right\\rfloor=n ;\n\\]\nif \\(n\\) is odd,\n\\[\nz_{n}=\\left\\lfloor\\frac{n+1}{2} \\alpha+\\frac{n-1}{2} \\beta\\right\\rfloor=n+\\left\\lfloor\\frac{\\alpha-\\beta}{2}\\right\\rfloor,\n\\]\nwhich equals \\(n\\) because \\(0<\\beta \\leq \\alpha<\\alpha+\\beta=2 \\Longrightarrow 0 \\leq \\alpha-\\beta<2\\).", "source_pdf": "apmo_2025.pdf", "notes": ""}
{"id": "APMO-2025-3", "contest": "APMO", "year": "2025", "problem_number": "3", "problem": "Let \\(P(x)\\) be a non-constant polynomial with integer coefficients such that \\(P(0) \\neq 0\\). Let \\(a_{1}, a_{2}, a_{3}, \\ldots\\) be an infinite sequence of integers such that \\(P(i-j)\\) divides \\(a_{i}-a_{j}\\) for all distinct positive integers \\(i, j\\). Prove that the sequence \\(a_{1}, a_{2}, a_{3}, \\ldots\\) must be constant, that is, \\(a_{n}\\) equals a constant \\(c\\) for all \\(n\\) positive integer.", "solution": "\\section*{Solution}\n\nLet \\(a_{0}=P(0) \\neq 0\\) be the independent coefficient, i.e., the constant term of \\(P(x)\\). Then there are infinitely many primes \\(p\\) such that \\(p\\) divides \\(P(k)\\) but \\(p\\) does not divide \\(k\\). In fact, since \\(P(k)-a_{0}\\) is a multiple of \\(k, \\operatorname{gcd}(P(k), k)=\\operatorname{gcd}\\left(k, a_{0}\\right) \\leq a_{0}\\) is bounded, so pick, say, \\(k\\) with prime factors each larger than \\(a_{0}\\).\nSince \\(P(k)\\) divides \\(a_{i+k}-a_{i}, p\\) divides \\(a_{i+k}-a_{i}\\). Moreover, since \\(P(k+p) \\equiv P(k) \\equiv 0(\\bmod p)\\), \\(p\\) also divides \\(a_{i+k+p}-a_{i}\\). Therefore, \\(a_{i} \\bmod p\\) is periodic with periods \\(k+p\\) and \\(k\\). By Bezout's theorem, \\(\\operatorname{gcd}(k+p, k)=1\\) is also a period, that is, \\(p\\) divides \\(a_{i+1}-a_{i}\\) for all \\(i\\) and \\(p\\) such that \\(p \\mid P(k)\\) and \\(p \\nmid k\\) for some \\(k\\). Since there are infinitely many such primes \\(p, a_{i+1}-a_{i}\\) is divisible by infinitely many primes, which implies \\(a_{i+1}=a_{i}\\), that is, the sequence is constant.", "source_pdf": "apmo_2025.pdf", "notes": ""}
{"id": "APMO-2025-4", "contest": "APMO", "year": "2025", "problem_number": "4", "problem": "Let \\(n \\geq 3\\) be an integer. There are \\(n\\) cells on a circle, and each cell is assigned either 0 or 1 . There is a rooster on one of these cells, and it repeats the following operations:\n- If the rooster is on a cell assigned 0 , it changes the assigned number to 1 and moves to the next cell counterclockwise.\n- If the rooster is on a cell assigned 1 , it changes the assigned number to 0 and moves to the cell after the next cell counterclockwise.\n\nProve that the following statement holds true after sufficiently many operations:\nIf the rooster is on a cell \\(C\\), then the rooster would go around the circle exactly three times, stopping again at \\(C\\). Moreover, every cell would be assigned the same number as it was assigned right before the rooster went around the circle 3 times.", "solution": "\\section*{Solution 1}\n\nReformulate the problem as a \\(n\\)-string of numbers in \\(\\{0,1\\}\\) and a position at which the action described in the problem is performed, and add 1 or 2 modulo \\(n\\) to the position according to the action. Say that a lap is complete for each time the position resets to 0 or 1 . We will prove that the statement claim holds after at most two laps, after which the \\(n\\)-tuple cycles every three laps.\nSay the rooster stops at a position in a certain lap if it performs an action at that position on that lap; otherwise, the rooster bypasses that position. We start with some immediate claims:\n- The rooster has to stop at at least one of each two consecutive positions.\n- The rooster stops at every position preceded by a 0 . Indeed, if the numbers preceding that position are 00 then the rooster will definitely stop at the second zero, and it the numbers preceding that position are 10 then the rooster will either stop at 1 and go directly to the position or bypass 1 and stop at the second zero, and then stop at the position.\n- Therefore, if the rooster bypasses a position, then it is preceded by a 1 , and that 1 must be changed to a 0 . This means that the rooster never bypasses a position in two consecutive laps.\n- The rooster bypasses every position preceded by 01 . Indeed, the rooster stops at either 1 or at 0 , after which it will move to 1 ; at any rate, it stops at 1 and bypasses the position.\n\nOur goal is to prove that, eventually, for every three consecutive laps, each position is bypassed exactly once. Then each position changes states exactly twice, so it gets back to its initial state after three laps. The following two lemmata achieve this goal:\n\nLemma 1. If the rooster stops at a certain position in two laps in a row, it bypasses it on the next lap, except for the \\(n\\)-string 1010 . . . 10, for which the problem statement holds.\n\nProof. If the rooster stopped at a position in lap \\(t\\), then it is preceded by either (A) a 0 that was changed to 1 , (B) a 11 that was changed to 01 , or (C) a 10 in which the rooster stopped at 1 . In case (A), the position must be preceded by 11 in the lap \\(t+1\\), which becomes 01 , so the rooster will bypass the position in the lap \\(t+2\\). In case (B), the position will be bypassed in lap \\(t+1\\).\nNow we deal with case ( C ): suppose that the position was preceded by \\(m\\) occurrences of 10 , that is, \\((10)^{m}\\), on lap \\(t\\) and take \\(m \\leq \\frac{n}{2}\\) maximal. The rooster stopped at the 1 from each occurrence of 10 , except possibly the first one.\n\nFirst, suppose that \\(n \\geq 2 m+2\\). After lap \\(t,(10)^{m}\\) becomes either \\((00)^{m}\\) or \\(11(00)^{m-1}\\) in lap \\(t+1\\). In the latter case, initially we had \\(1(10)^{m}\\), which became \\(011(00)^{m-1}\\). It will then become \\(a 01(11)^{m-1}\\) in lap \\(t+2\\), in which the rooster will bypass the position. In the former case, \\((10)^{m}\\) becomes \\((00)^{m}\\), so it was either \\(00(10)^{m}\\) or \\(11(10)^{m}\\) in lap \\(t\\), which becomes respectively \\(a 1(00)^{m}\\) and \\(01(00)^{m}\\) in lap \\(t+1\\), respectively. In the second sub-case, it becomes \\(b 001(11)^{m-1}\\) in lap \\(t+2\\), and the position will be bypassed. In the first sub-case, it must be \\(11(00)^{m}\\) after which it becomes either \\(01(11)^{m}\\) or \\(1001(11)^{m-1}\\). In any case, the position will be bypassed in lap \\(t+2\\). If \\(n=2 m+1\\), the possible configurations are\n\\[\n(10)^{m} 0 \\rightarrow(00)^{m} 1 \\rightarrow(11)^{m} 0 \\rightarrow(10)^{m} 0\n\\]\nthe rooster stops at the 1 from the first 10 because it was preceded by a 0 .\n\\[\n(10)^{m} 1 \\rightarrow(00)^{m} 0 \\rightarrow 0(11)^{m} \\rightarrow 1(01)^{m}\n\\]\nor\n\\[\n(10)^{m} 1 \\rightarrow 11(00)^{m-1} 0 \\rightarrow 01(11)^{m-1} 1 \\rightarrow(10)^{m} 1\n\\]\n\nIn any case, the position is bypassed in lap \\(t+2\\).\nIf \\(n=2 m\\), the entire configuration is \\((10)^{m}, m \\geq 2\\). If the rooster did not stop at the first 1 , it becomes \\(11(00)^{m-1}\\) in the lap \\(t+1\\), then \\(01(11)^{m-1}\\) in the lap \\(t+2\\), so the position is bypassed in this last lap. If the rooster stopped at the first 1 , it becomes \\((00)^{m}\\), then \\((11)^{m}\\), then \\((01)^{m}\\), then \\(10(00)^{m-1}\\), then \\((11)^{m}\\), and then it cycles between \\((11)^{m},(01)^{m}\\) and \\(10(00)^{m-1}\\).\nSo, apart from this specific string, the rooster will stop at most two laps in a row at each position.\n\nLemma 2. If the rooster bypasses one position on a lap, then it stops at that position on the next two laps, with the same exception as lemma 1.\n\nProof. The position must be preceded by 1 in lap \\(t\\). If it is preceded by 11 , it changes to 10 in lap \\(t+1\\). Then it becomes 00 because the 1 was already skipped in the previous lap, and the rooster will stop at the position in the lap \\(t+2\\).\nNow suppose that the position was preceded by \\((01)^{m}\\) on lap \\(t\\) and take \\(m \\leq \\frac{n}{2}\\) maximal. It becomes \\(10(00)^{m-1}\\) or \\((00)^{m}\\) in lap \\(t+1\\). In the former case, in lap \\(t+2\\) it becomes either \\(00(11)^{m-1}\\), after which the rooster stops at the position again, or \\((11)^{m}\\), which we'll study later. In the former case, \\((00)^{m}\\) becomes \\((11)^{m}\\) or \\(01(11)^{m-1}\\). In the latter case, the 0 was bypassed, so it must be sopped in the next lap, becoming \\((10)^{m}\\). In the \\((11)^{m}\\) case, in order to bypass the position in lap \\(t+2\\), it must become \\((10)^{m}\\). All in all, the preceding terms are \\((01)^{m}\\). Then, either \\(10(00)^{m-1}\\) or \\((00)^{m}\\), then either \\((11)^{m}\\) or \\(01(11)^{m-1}\\), then \\((10)^{m}\\). Then the second term in \\((01)^{m}\\) is 1 , then 0 , then 1 , and then 0 , that is, it changed three times. So we fall under the exception to lemma 1.\n\nThe result then immediately follows from lemmata 1 and 2 .\n\n\\section*{Solution 2}\n\nDefine positions, laps, stoppings, and bypassing as in Solution 1. This other pair of lemmata also solves the problem.\n\nLemma 3. There is a position and a lap in which the rooster stops twice and bypasses once (in some order) in the next three laps.\n\nProof. There is a position \\(j\\) the rooster stops for infinitely many times. Each time it stops at \\(j\\), it changes between stopping and bypassing \\(j+1\\). So the rooster stops and bypasses \\(j+1\\) infinitely many times. Then there is a lap in which the rooster stops at \\(j+1\\), and bypasses it in the next. As in solution 1 , it cannot bypass \\(j+1\\) two times in a row, so it stops at \\(j+1\\) in the next lap.\n\nLemma 4. If the rooster stops twice and bypasses once (in some order) at some position in three consecutive laps, it also stops twice and bypasses once at the next position (in some order) in the same laps (or in the next laps, in case the lap changes from one position to the other).\n\nProof. When the rooster bypasses the position, it must stop at the next one. In the two times it stops at the position, the cell has different numbers on it, so the rooster will stop once and bypass once at the next position.\n\nBy lemmata 3 and 4, there would be a moment that the rooster stops twice and bypasses once (in some order) at any position after this moment. After this moment, if the rooster is in a cell \\(C\\) in lap \\(t\\), we know that it stopped; stopped-bypassed; and bypassed-stopped at \\(C\\) in laps \\(t, t+1, t+2\\). Since it stopped twice and bypassed once (in some order) in laps \\(t+1, t+2, t+3\\), it must stop at \\(C\\) in lap \\(t+3\\). Moreover, the rooster stopped twice and bypassed once (in some order) each cell between stopping at \\(C\\) in laps \\(t\\) and \\(t+3\\), so every cell has the same assigned number before and after going around the circle three times.\n\n\\section*{Solution 3}\n\nLet us reformulate the problem in terms of Graphs: we have a directed graph \\(G\\) with \\(V= \\left\\{v_{1}, v_{2}, \\ldots, v_{n}\\right\\}\\) representing positions and \\(E=\\left\\{v_{i} \\rightarrow v_{i+1}, v_{i} \\rightarrow v_{i+2} \\mid 1 \\leq i \\leq n\\right\\}\\) representing moves. Indices are taken \\(\\bmod n\\). Note that each vertex has in-degree and out-degree both equal to 2 . We say that the edge \\(v_{i} \\rightarrow v_{i+1}\\) is active and \\(v_{i} \\rightarrow v_{i+2}\\) is inactive if the number on \\(v_{i}\\) is 0 , or the edge \\(v_{i} \\rightarrow v_{i+2}\\) is active and \\(v_{i} \\rightarrow v_{i+1}\\) is inactive if the number on \\(v_{i}\\) is 1 . The rooster then traces an infinite trail on the graph in the following manner;\n- it starts at \\(v_{1}\\);\n- if the rooster is at \\(v_{i}\\), it uses the active edge going out of \\(v_{i}\\) to continue the path, and changes the number on \\(v_{i}\\).\n\nTake the first vertex that appears 3 times on the rooster's trail, and suppose without any loss of generality that it is \\(v_{1}\\) (otherwise, just ignore the path before the first time that this vertex appears). Consider the sub-trail from the first to the third time \\(v_{1}\\) appears: \\(C=v_{1} \\rightarrow \\cdots \\rightarrow v_{1} \\rightarrow \\cdots \\rightarrow v_{1}\\). Trail \\(C\\) induces a circuit \\(C^{*}\\) on \\(G\\) that passes through \\(v_{1}\\) twice.\nIn between two occurrences of \\(v_{1}\\), the rooster must have completed at least one lap. Vertex \\(v_{1}\\) appears three times at \\(C\\), so \\(C\\) contains at least two laps. Since (as per Solution 1) no vertex is bypassed twice in a row, \\(C^{*}\\) must contain every vertex. Moreover, \\(v_{1}\\) is the first (and only) vertex that appeared three times on the rooster's path, so each vertex appear at most twice on \\(C^{*}\\).\n\nLemma 5. Take \\(V^{\\prime}\\) to be the subset of \\(V\\) containing the vertices that only appears once on \\(C^{*}\\) and \\(E^{\\prime}\\) to be the edges of \\(G\\) that don't appear on \\(C^{*}\\). So \\(G^{\\prime}=\\left(V^{\\prime}, E^{\\prime}\\right)\\) is a simple cycle or \\(V^{\\prime}=E^{\\prime}=\\emptyset\\).\n\nProof. We will first prove that each edge in \\(C^{*}\\) appears exactly one. Suppose, for the sake of contradiction, that there is an edge \\(u \\rightarrow v\\) that appears twice on \\(C^{*}\\). So \\(u\\) must appear times in \\(C\\), because the active edge going out of \\(u\\) changes at each visit to it. So \\(u=v_{1}\\), but the rooster only goes out of \\(v_{1}\\) twice in \\(C\\), which is a contradiction.\nNow, since \\(C^{*}\\) does not have repeated edges, all four edges through \\(v\\) are in \\(C^{*}\\) if \\(v\\) is visited twice in this cycle. So the edges on \\(E^{\\prime}\\) cannot pass through vertices in \\(V \\backslash V^{\\prime}\\), then \\(G^{\\prime}\\) is well-defined.\nSince \\(v \\in V^{\\prime}\\) is visited once on \\(C^{*}\\), it has \\(\\operatorname{deg}_{\\text {in }}(v)=\\operatorname{deg}_{\\text {out }}(v)=1\\) in \\(G^{\\prime}\\), so \\(G^{\\prime}\\) is a union of disjoint simple cycles. Each of these cycles completes at least one lap, and \\(v_{1}\\) is skipped on these laps, so all cycles must use the edge \\(v_{n} \\rightarrow v_{2}\\). But the cycles are disjoint, so there is at most one cycle.\n\nLemma 6. The rooster eventually traverses a contiguous Eulerian circuit of \\(G\\).\n\nProof. If \\(V^{\\prime}=E^{\\prime}=\\emptyset, C^{*}\\) is already an Eulerian circuit traversed in \\(C\\). If not, take \\(u_{1}\\) to be the first vertex of \\(C\\) that is in \\(V^{\\prime}\\). Let \\(U=u_{1} \\rightarrow \\cdots \\rightarrow u_{k} \\rightarrow u_{1}\\) be the cycle determined by \\(G^{\\prime}\\) by Lemma 5, \\(C_{1}=v_{1} \\rightarrow \\cdots \\rightarrow u_{1}\\) be the sub-path of \\(C\\) from the first \\(v_{1}\\) to \\(u_{1}\\), and \\(C_{2}=u_{1} \\rightarrow \\cdots \\rightarrow v_{1}\\) be the rest of \\(C\\).\nEach vertex on \\(V \\backslash V^{\\prime}\\) has been changed twice, so they would be in their initial states after \\(C\\); every vertex on \\(V^{\\prime}\\) has been changed only once, and therefore are not on their initial states. Let us trace the rooster's trail after it traversed \\(C\\). By the minimality of \\(u_{1}\\), all the edges of \\(C_{1}\\) are active after \\(C\\), so the rooster traverses \\(C_{1}\\) after \\(C\\). Moreover, each \\(u_{i}\\) was visited exactly once in \\(C\\) and has not yet used the edge \\(u_{i} \\rightarrow u_{i+1}\\). Since all their states have changed, all edges of \\(U\\) are active after \\(C\\). Therefore, the rooster traverse \\(U\\) after \\(C_{1}\\), flipping all the vertices in \\(U\\) to their initial states. Then, since every state in \\(U\\) was changed, the rooster traverses \\(C_{2}\\) instead of \\(U\\). The trail is then \\(C \\rightarrow C_{1} \\rightarrow U \\rightarrow C_{2}\\), and hen \\(C_{1} \\rightarrow U \\rightarrow C_{2}\\) is an Eulerian circuit.\n\nHaving this in mind, after the rooster completes an Eulerian circuit, it has passed through each vertex twice and returned to its initial vertex, so the state of the rooster and of the edges are the same before and after the Eulerian cycle. The rooster will then traverse the Eulerian circuit repeatedly.\nThe edges \\(v_{i} \\rightarrow v_{i+1}\\) move forward by one position and the edges \\(v_{i} \\rightarrow v_{i+2}\\) move forward by two positions. Since all edges are used, each time the rooster traverses the Eulerian circuit, it moves forward a total of \\(n(1+2)=3 n\\) positions, which corresponds to three laps. The proof is now complete.\n\nComment: Solution 1 presents a somewhat brute-force case analysis; the main ideas are\n- Lemma 1: The rooster stops at one position in at most two consecutive laps, with one notable exception.\n- Lemma 2: If the rooster bypasses one position then it stops at it in the next two laps, with the same notable exception.\n\nSolution 2 has a recursive nature; the main ideas are\n- Lemma 3: Proving that one position changes states exactly two out of three laps.\n- Lemma 4: Given that this happens to one position, it also happens to the next position in the same laps, so it happens to every position.\n\nSolution 3 cleverly identifies the moves the rooster performs within a graph theoretical framework. The main goal is to prove that the rooster traces an Eulerian circuit in a graph.\n- Lemma 5: Analyzing what happens after the rooster first visits a position three times.\n- Lemma 6: Proving that the rooster traces an Eulerian circuit.", "source_pdf": "apmo_2025.pdf", "notes": ""}
{"id": "APMO-2025-5", "contest": "APMO", "year": "2025", "problem_number": "5", "problem": "Consider an infinite sequence \\(a_{1}, a_{2}, \\ldots\\) of positive integers such that\n\\[\n100!\\left(a_{m}+a_{m+1}+\\cdots+a_{n}\\right) \\quad \\text { is a multiple of } \\quad a_{n-m+1} a_{n+m}\n\\]\nfor all positive integers \\(m, n\\) such that \\(m \\leq n\\).\nProve that the sequence is either bounded or linear.\nObservation: A sequence of positive integers is bounded if there exists a constant \\(N\\) such that \\(a_{n}<N\\) for all \\(n \\in \\mathbb{Z}_{>0}\\). A sequence is linear if \\(a_{n}=n \\cdot a_{1}\\) for all \\(n \\in \\mathbb{Z}_{>0}\\).", "solution": "\\section*{Solution}\n\nLet \\(c=100\\) !. Suppose that \\(n \\geq m+2\\). Then \\(a_{m+n}=a_{(m+1)+(n-1)}\\) divides both \\(c\\left(a_{m}+a_{m+1}+\\right. \\left.\\cdots+a_{n-1}+a_{n}\\right)\\) and \\(c\\left(a_{m+1}+\\cdots+a_{n-1}\\right)\\), so it also divides the difference \\(c\\left(a_{m}+a_{n}\\right)\\). Notice that if \\(n=m+1\\) then \\(a_{m+n}\\) divides \\(c\\left(a_{m}+a_{m+1}\\right)=c\\left(a_{m}+a_{n}\\right)\\), and if \\(n=m\\) then \\(a_{m+n}\\) divides both \\(c a_{m}\\) and \\(2 c a_{m}=c\\left(a_{m}+a_{n}\\right)\\). In either cases; \\(a_{m+n}\\) divides \\(c\\left(a_{m}+a_{n}\\right)\\).\nAnalogously, one can prove that if \\(m>n, a_{m-n}=a_{(m-1)-(n-1)}\\) divides \\(c\\left(a_{m}-a_{n}\\right)\\), as it divides both \\(c\\left(a_{n+1}+\\cdots+a_{m}\\right)\\) and \\(c\\left(a_{n}+\\cdots+a_{m-1}\\right)\\).\nFrom now on, drop the original divisibility statement and keep the statements \" \\(a_{m+n}\\) divides \\(c\\left(a_{m}+a_{n}\\right)\\) \" and \" \\(a_{m-n}\\) divides \\(c\\left(a_{m}-a_{n}\\right)\\).\" Now, all conditions are linear, and we can suppose without loss of generality that there is no integer \\(D>1\\) that divides every term of the sequence; if there is such an integer \\(D\\), divide all terms by \\(D\\).\nHaving this in mind, notice that \\(a_{m}=a_{m+n-n}\\) divides \\(c\\left(a_{m+n}-a_{n}\\right)\\) and also \\(c\\left(a_{m+n}-a_{m}-a_{n}\\right)\\); analogously, \\(a_{n}\\) also divides \\(c\\left(a_{m+n}-a_{m}-a_{n}\\right)\\), and since \\(a_{m+n}\\) divides \\(c\\left(a_{m}+a_{n}\\right)\\), it also divides \\(c\\left(a_{m+n}-a_{m}-a_{n}\\right)\\). Therefore, \\(c\\left(a_{m+n}-a_{m}-a_{n}\\right)\\) is divisible by \\(a_{m}, a_{n}\\), and \\(a_{m+n}\\), and therefore also by \\(\\operatorname{lcm}\\left(a_{m}, a_{n}, a_{m+n}\\right)\\). In particular, \\(c a_{m+n} \\equiv c\\left(a_{m}+a_{n}\\right)\\left(\\bmod \\operatorname{lcm}\\left(a_{m}, a_{n}\\right)\\right)\\).\nSince \\(a_{m+n}\\) divides \\(c\\left(a_{m}+a_{n}\\right), a_{m+n} \\leq c\\left(a_{m}+a_{n}\\right)\\).\nFrom now on, we divide the problem in two cases.\nCase 1: there exist \\(m, n\\) such that \\(\\operatorname{lcm}\\left(a_{m}, a_{n}\\right)>c^{2}\\left(a_{m}+a_{n}\\right)\\).\nIf \\(\\operatorname{lcm}\\left(a_{m}, a_{n}\\right)>c^{2}\\left(a_{m}+a_{n}\\right)>c\\left(a_{m}+a_{n}\\right)\\) then both \\(c\\left(a_{m}+a_{n}\\right)\\) and \\(c a_{m+n}\\) are less than \\(c a_{m+n} \\leq c^{2}\\left(a_{m}+a_{n}\\right)<\\operatorname{lcm}\\left(a_{m}, a_{n}\\right)\\). This implies \\(c a_{m+n}=c\\left(a_{m}+a_{n}\\right) \\Longleftrightarrow a_{m+n}=a_{m}+a_{n}\\). Now we can extend this further: since \\(\\operatorname{gcd}\\left(a_{m}, a_{m+n}\\right)=\\operatorname{gcd}\\left(a_{m}, a_{m}+a_{n}\\right)=\\operatorname{gcd}\\left(a_{m}, a_{n}\\right)\\), it follows that\n\\[\n\\begin{aligned}\n\\operatorname{lcm}\\left(a_{m}, a_{m+n}\\right) & =\\frac{a_{m} a_{m+n}}{\\operatorname{gcd}\\left(a_{m}, a_{n}\\right)}=\\frac{a_{m+n}}{a_{n}} \\operatorname{lcm}\\left(a_{m}, a_{n}\\right)>\\frac{c^{2}\\left(a_{m}+a_{n}\\right)^{2}}{a_{n}} \\\\\n& >\\frac{c^{2}\\left(2 a_{m} a_{n}+a_{n}^{2}\\right)}{a_{n}}=c^{2}\\left(2 a_{m}+a_{n}\\right)=c^{2}\\left(a_{m}+a_{m+n}\\right)\n\\end{aligned}\n\\]\n\nWe can iterate this reasoning to obtain that \\(a_{k m+n}=k a_{m}+a_{n}\\), for all \\(k \\in \\mathbb{Z}_{>0}\\). In fact, if the condition \\(\\operatorname{lcm}\\left(a_{m}, a_{n}\\right)>c^{2}\\left(a_{m}+a_{n}\\right)\\) holds for the pair ( \\(n, m\\) ), then it also holds for the pairs \\((m+n, m),(2 m+n, m), \\ldots,((k-1) m+n, m)\\), which implies \\(a_{k m+n}=a_{(k-1) m+n}+a_{m}= a_{(k-2) m+n}+2 a_{m}=\\cdots=a_{n}+k a_{m}\\).\nSimilarly, \\(a_{m+k n}=a_{m}+k a_{n}\\).\nNow, \\(a_{m+n+m n}=a_{n+(n+1) m}=a_{m+(m+1) n} \\Longrightarrow a_{n}+(n+1) a_{m}=a_{m}+(m+1) a_{n} \\Longleftrightarrow m a_{n}= n a_{m}\\). If \\(d=\\operatorname{gcd}(m, n)\\) then \\(\\frac{n}{d} a_{m}=\\frac{m}{d} a_{n}\\).\nTherefore, since \\(\\operatorname{gcd}\\left(\\frac{m}{d}, \\frac{n}{d}\\right)=1, \\frac{m}{d}\\) divides \\(a_{m}\\) and \\(\\frac{n}{d}\\) divides \\(a_{n}\\), which means that\n\\[\na_{n}=\\frac{m}{d} \\cdot t=\\frac{t}{d} m \\quad \\text { and } \\quad a_{m}=\\frac{n}{d} \\cdot t=\\frac{t}{d} n, \\quad \\text { for some } t \\in \\mathbb{Z}_{>0}\n\\]\nwhich also implies\n\\[\na_{k m+n}=\\frac{t}{d}(k m+n) \\quad \\text { and } \\quad a_{m+k n}=\\frac{t}{d}(m+k n), \\quad \\text { for all } k \\in \\mathbb{Z}_{>0} .\n\\]\n\nNow let's prove that \\(a_{k d}=t k=\\frac{t}{d}(k d)\\) for all \\(k \\in \\mathbb{Z}_{>0}\\). In fact, there exist arbitrarily large positive integers \\(R, S\\) such that \\(k d=R m-S n=(n+(R+1) m)-(m+(S+1) n)\\) (for instance, let \\(u, v \\in \\mathbb{Z}\\) such that \\(k d=m u-n v\\) and take \\(R=u+Q n\\) and \\(S=v+Q m\\) for \\(Q\\) sufficiently large.)\nLet \\(x=n+(R+1) m\\) and \\(y=m+(S+1) n\\). Then \\(k d=x-y \\Longleftrightarrow x=y+k d, a_{x}=\\frac{t}{d} x\\), and \\(a_{y}=\\frac{t}{d} y=\\frac{t}{d}(x-k d)=a_{x}-t k\\). Thus \\(a_{x}\\) divides \\(c\\left(a_{y}+a_{k d}\\right)=c\\left(a_{k d}+a_{x}-t k\\right)\\), and therefore also \\(c\\left(a_{k d}-t k\\right)\\). Since \\(a_{x}=\\frac{t}{d} x\\) can be arbitrarily large, \\(a_{k d}=t k=\\frac{t}{d}(k d)\\). In particular, \\(a_{d}=t\\), so \\(a_{k d}=k a_{d}\\).\nSince \\(k a_{d}=a_{k d}=a_{1+(k d-1)}\\) divides \\(c\\left(a_{1}+a_{k d-1}\\right), b_{k}=a_{k d-1}\\) is unbounded. Pick \\(p>a_{k d-1}\\) a large prime and consider \\(a_{p d}=p a_{d}\\). Then\n\\[\n\\operatorname{lcm}\\left(a_{p d}, a_{k d-1}\\right) \\geq \\operatorname{lcm}\\left(p, a_{k d-1}\\right)=p a_{k d-1}\n\\]\n\nWe can pick \\(a_{k d-1}\\) and \\(p\\) large enough so that their product is larger than a particular linear combination of them, that is,\n\\[\n\\operatorname{lcm}\\left(p, a_{k d-1}\\right)=p a_{k d-1}>c^{2}\\left(p a_{d}+a_{k d-1}\\right)=c^{2}\\left(a_{p d}+a_{k d-1}\\right)\n\\]\n\nThen all the previous facts can be applied, and since \\(\\operatorname{gcd}(p d, k d-1)=1, a_{k}=a_{k \\operatorname{gcd}(p d, k d-1)} =k a_{\\operatorname{gcd}(p d, k d-1)}=k a_{1}\\), that is, the sequence is linear. Also, since \\(a_{1}\\) divides all terms, \\(a_{1}=1\\).\nCase 2: \\(\\operatorname{lcm}\\left(a_{m}, a_{n}\\right) \\leq c^{2}\\left(a_{m}+a_{n}\\right)\\) for all \\(m, n\\).\nSuppose that \\(a_{m} \\leq a_{n}\\); then \\(\\operatorname{lcm}\\left(a_{m}, a_{n}\\right)=M a_{n} \\leq c^{2}\\left(a_{m}+a_{n}\\right) \\leq 2 c^{2} a_{n} \\Longrightarrow M \\leq 2 c^{2}\\), that is, the factor in the smaller term that is not in the larger term is at most \\(2 c^{2}\\).\nWe prove that in this case the sequence must be bounded. Suppose on the contrary; then there is a term \\(a_{m}\\) that is divisible by a large prime power \\(p^{d}\\). Then every larger term \\(a_{n}\\) is divisible by a factor larger than \\(\\frac{p^{d}}{2 c^{2}}\\). So we pick \\(p^{d}>\\left(2 c^{2}\\right)^{2}\\), so that every large term \\(a_{n}\\) is divisible by the prime power \\(p^{e}>2 c^{2}\\). Finally, fix \\(a_{k}\\) for any \\(k\\). It follows from \\(a_{k+n} \\mid c\\left(a_{k}+a_{n}\\right)\\) that \\(\\left(a_{n}\\right)\\) is unbounded, so we can pick \\(a_{n}\\) and \\(a_{k+n}\\) large enough such that both are divisible by \\(p^{e}\\). Hence any \\(a_{k}\\) is divisible by \\(p\\), which is a contradiction to the fact that there is no \\(D>1\\) that divides every term in the sequence.", "source_pdf": "apmo_2025.pdf", "notes": ""}
{"id": "EGMO-2016-1", "contest": "EGMO", "year": "2016", "problem_number": "1", "problem": "Let \\(n\\) be an odd positive integer, and let \\(x_{1}, x_{2}, \\ldots, x_{n}\\) be non-negative real numbers. Show that\n\\[\n\\min _{i=1, \\ldots, n}\\left(x_{i}^{2}+x_{i+1}^{2}\\right) \\leq \\max _{j=1, \\ldots, n}\\left(2 x_{j} x_{j+1}\\right),\n\\]\nwhere \\(x_{n+1}=x_{1}\\).", "solution": "In what follows, indices are reduced modulo \\(n\\). Consider the \\(n\\) differences \\(x_{k+1}-x_{k}, k=1, \\ldots, n\\). Since \\(n\\) is odd, there exists an index \\(j\\) such that \\(\\left(x_{j+1}-x_{j}\\right)\\left(x_{j+2}-x_{j+1}\\right) \\geq 0\\). Without loss of generality, we may and will assume both factors non-negative, so \\(x_{j} \\leq x_{j+1} \\leq x_{j+2}\\). Consequently,\n\\[\n\\min _{k=1, \\ldots, n}\\left(x_{k}^{2}+x_{k+1}^{2}\\right) \\leq x_{j}^{2}+x_{j+1}^{2} \\leq 2 x_{j+1}^{2} \\leq 2 x_{j+1} x_{j+2} \\leq \\max _{k=1, \\ldots, n}\\left(2 x_{k} x_{k+1}\\right) .\n\\]", "source_pdf": "egmo_2016.pdf", "notes": ""}
{"id": "EGMO-2016-2", "contest": "EGMO", "year": "2016", "problem_number": "2", "problem": "Let \\(A B C D\\) be a cyclic quadrilateral, and let diagonals \\(A C\\) and \\(B D\\) intersect at \\(X\\). Let \\(C_{1}, D_{1}\\) and \\(M\\) be the midpoints of segments \\(C X\\), \\(D X\\) and \\(C D\\), respectively. Lines \\(A D_{1}\\) and \\(B C_{1}\\) intersect at \\(Y\\), and line \\(M Y\\) intersects diagonals \\(A C\\) and \\(B D\\) at different points \\(E\\) and \\(F\\), respectively. Prove that line \\(X Y\\) is tangent to the circle through \\(E, F\\) and \\(X\\).", "solution": "We are to prove that \\(\\angle E X Y=\\angle E F X\\); alternatively, but equivalently, \\(\\angle A Y X+\\angle X A Y=\\angle B Y F+\\angle X B Y\\).\n\nSince the quadrangle \\(A B C D\\) is cyclic, the triangles \\(X A D\\) and \\(X B C\\) are similar, and since \\(A D_{1}\\) and \\(B C_{1}\\) are corresponding medians in these triangles, it follows that \\(\\angle X A Y=\\angle X A D_{1}=\\angle X B C_{1}=\\angle X B Y\\).\n\nFinally, \\(\\angle A Y X=\\angle B Y F\\), since \\(X\\) and \\(M\\) are corresponding points in the similar triangles \\(A B Y\\) and \\(C_{1} D_{1} Y\\) : indeed, \\(\\angle X A B=\\angle X D C=\\angle M C_{1} D_{1}\\), and \\(\\angle X B A=\\angle X C D=\\angle M D_{1} C_{1}\\).", "source_pdf": "egmo_2016.pdf", "notes": ""}
{"id": "EGMO-2016-3", "contest": "EGMO", "year": "2016", "problem_number": "3", "problem": "Let \\(m\\) be a positive integer. Consider a \\(4 m \\times 4 m\\) array of square unit cells. Two different cells are related to each other if they are in either the same row or in the same column. No cell is related to itself. Some cells are coloured blue, such that every cell is related to at least two blue cells. Determine the minimum number of blue cells.", "solution": "Solution 1 (Israel). The required minimum is \\(6 m\\) and is achieved by a diagonal string of \\(m 4 \\times 4\\) blocks of the form below (bullets mark centres of blue cells):\n\nIn particular, this configuration shows that the required minimum does not exceed 6 m .\n\nWe now show that any configuration of blue cells satisfying the condition in the statement has cardinality at least 6 m .\n\nFix such a configuration and let \\(m_{1}^{r}\\) be the number of blue cells in rows containing exactly one such, let \\(m_{2}^{r}\\) be the number of blue cells in rows containing exactly two such, and let \\(m_{3}^{r}\\) be the number of blue cells in rows containing at least three such; the numbers \\(m_{1}^{c}, m_{2}^{c}\\) and \\(m_{3}^{c}\\) are defined similarly.\n\nBegin by noticing that \\(m_{3}^{c} \\geq m_{1}^{r}\\) and, similarly, \\(m_{3}^{r} \\geq m_{1}^{c}\\). Indeed, if a blue cell is alone in its row, respectively column, then there are at least two other blue cells in its column, respectively row, and the claim follows.\n\nSuppose now, if possible, the total number of blue cells is less than \\(6 m\\). We will show that \\(m_{1}^{r}>m_{3}^{r}\\) and \\(m_{1}^{c}>m_{3}^{c}\\), and reach a contradiction by the preceding: \\(m_{1}^{r}>m_{3}^{r} \\geq m_{1}^{c}>m_{3}^{c} \\geq m_{1}^{r}\\).\n\nWe prove the first inequality; the other one is dealt with similarly. To this end, notice that there are no empty rows - otherwise, each column would contain at least two blue cells, whence a total of at least \\(8 m>6 m\\) blue cells, which is a contradiction. Next, count rows to get \\(m_{1}^{r}+m_{2}^{r} / 2+m_{3}^{r} / 3 \\geq 4 m\\),\nand count blue cells to get \\(m_{1}^{r}+m_{2}^{r}+m_{3}^{r}<6 m\\). Subtraction of the latter from the former multiplied by \\(3 / 2\\) yields \\(m_{1}^{r}-m_{3}^{r}>m_{2}^{r} / 2 \\geq 0\\), and the conclusion follows.\n\nSolution 2. To prove that a minimal configuration of blue cells satisfying the condition in the statement has cardinality at least \\(6 m\\), consider a bipartite graph whose vertex parts are the rows and the columns of the array, respectively, a row and a column being joined by an edge if and only if the two cross at a blue cell. Clearly, the number of blue cells is equal to the number of edges of this graph, and the relationship condition in the statement reads: for every row \\(r\\) and every column \\(c, \\operatorname{deg} r+\\operatorname{deg} c-\\epsilon(r, c) \\geq 2\\), where \\(\\epsilon(r, c)=2\\) if \\(r\\) and \\(c\\) are joined by an edge, and \\(\\epsilon(r, c)=0\\) otherwise.\n\nNotice that there are no empty rows/columns, so the graph has no isolated vertices. By the preceding, the cardinality of every connected component of the graph is at least 4 , so there are at most \\(2 \\cdot 4 m / 4=2 m\\) such and, consequently, the graph has at least \\(8 m-2 m=6 m\\) edges. This completes the proof.", "source_pdf": "egmo_2016.pdf", "notes": ""}
{"id": "EGMO-2016-4", "contest": "EGMO", "year": "2016", "problem_number": "4", "problem": "Two circles, \\(\\omega_{1}\\) and \\(\\omega_{2}\\), of equal radius intersect at different points \\(X_{1}\\) and \\(X_{2}\\). Consider a circle \\(\\omega\\) externally tangent to \\(\\omega_{1}\\) at a point \\(T_{1}\\), and internally tangent to \\(\\omega_{2}\\) at a point \\(T_{2}\\). Prove that lines \\(X_{1} T_{1}\\) and \\(X_{2} T_{2}\\) intersect at a point lying on \\(\\omega\\).", "solution": "Solution 1. Let the line \\(X_{k} T_{k}\\) and \\(\\omega\\) meet again at \\(X_{k}^{\\prime}, k=1,2\\), and notice that the tangent \\(t_{k}\\) to \\(\\omega_{k}\\) at \\(X_{k}\\) and the tangent \\(t_{k}^{\\prime}\\) to \\(\\omega\\) at \\(X_{k}^{\\prime}\\) are parallel. Since the \\(\\omega_{k}\\) have equal radii, the \\(t_{k}\\) are parallel, so the \\(t_{k}^{\\prime}\\) are parallel, and consequently the points \\(X_{1}^{\\prime}\\) and \\(X_{2}^{\\prime}\\) coincide (they are not antipodal, since they both lie on the same side of the line \\(T_{1} T_{2}\\) ). The conclusion follows.\n\nSolution 2. The circle \\(\\omega\\) is the image of \\(\\omega_{k}\\) under a homothety \\(h_{k}\\) centred at \\(T_{k}, k=1,2\\). The tangent to \\(\\omega\\) at \\(X_{k}^{\\prime}=h_{k}\\left(X_{k}\\right)\\) is therefore parallel to the tangent \\(t_{k}\\) to \\(\\omega_{k}\\) at \\(X_{k}\\). Since the \\(\\omega_{k}\\) have equal radii, the \\(t_{k}\\) are parallel, so \\(X_{1}^{\\prime}=X_{2}^{\\prime}\\); and since the points \\(X_{k}, T_{k}\\) and \\(X_{k}^{\\prime}\\) are collinear, the conclusion follows.\n\nSolution 3. Invert from \\(X_{1}\\) and use an asterisk to denote images under this inversion. Notice that \\(\\omega_{k}^{*}\\) is the tangent from \\(X_{2}^{*}\\) to \\(\\omega^{*}\\) at \\(T_{k}^{*}\\), and the pole \\(X_{1}\\) lies on the bisectrix of the angle formed by the \\(\\omega_{k}^{*}\\), not containing \\(\\omega^{*}\\). Letting \\(X_{1} T_{1}^{*}\\) and \\(\\omega^{*}\\) meet again at \\(Y\\), standard angle chase shows that \\(Y\\) lies on the circle \\(X_{1} X_{2}^{*} T_{2}^{*}\\), and the conclusion follows.", "source_pdf": "egmo_2016.pdf", "notes": ""}
{"id": "EGMO-2016-5", "contest": "EGMO", "year": "2016", "problem_number": "5", "problem": "Let \\(k\\) and \\(n\\) be integers such that \\(k \\geq 2\\) and \\(k \\leq n \\leq 2 k-1\\). Place rectangular tiles, each of size \\(1 \\times k\\) or \\(k \\times 1\\), on an \\(n \\times n\\) chessboard so that each tile covers exactly \\(k\\) cells, and no two tiles overlap. Do this until\nno further tile can be placed in this way. For each such \\(k\\) and \\(n\\), determine the minimum number of tiles that such an arrangement may contain.", "solution": "The required minimum is \\(n\\) if \\(n=k\\), and it is \\(\\min (n, 2 n-2 k+2)\\) if \\(k<n<2 k\\).\n\nThe case \\(n=k\\) being clear, assume henceforth \\(k<n<2 k\\). Begin by describing maximal arrangements on the board \\([0, n] \\times[0, n]\\), having the above mentioned cardinalities.\n\nIf \\(k<n<2 k-1\\), then \\(\\min (n, 2 n-2 k+2)=2 n-2 k+2\\). To obtain a maximal arrangement of this cardinality, place four tiles, \\([0, k] \\times[0,1]\\), \\([0,1] \\times[1, k+1],[1, k+1] \\times[k, k+1]\\) and \\([k, k+1] \\times[0, k]\\) in the square \\([0, k] \\times[0, k]\\), stack \\(n-k-1\\) horizontal tiles in the rectangle \\([1, k+1] \\times[k+1, n]\\), and erect \\(n-k-1\\) vertical tiles in the rectangle \\([k+1, n] \\times[1, k+1]\\).\n\nIf \\(n=2 k-1\\), then \\(\\min (n, 2 n-2 k+2)=n=2 k-1\\). A maximal arrangement of \\(2 k-1\\) tiles is obtained by stacking \\(k-1\\) horizontal tiles in the rectangle \\([0, k] \\times[0, k-1]\\), another \\(k-1\\) horizontal tiles in the rectangle \\([0, k] \\times[k, 2 k-1]\\), and adding the horizontal tile \\([k-1,2 k-1] \\times[k-1, k]\\).\n\nThe above examples show that the required minimum does not exceed the mentioned values.\n\nTo prove the reverse inequality, consider a maximal arrangement and let \\(r\\), respectively \\(c\\), be the number of rows, respectively columns, not containing a tile.\n\nIf \\(r=0\\) or \\(c=0\\), the arrangement clearly contains at least \\(n\\) tiles.\nIf \\(r\\) and \\(c\\) are both positive, we show that the arrangement contains at least \\(2 n-2 k+2\\) tiles. To this end, we will prove that the rows, respectively columns, not containing a tile are consecutive. Assume this for the moment, to notice that these \\(r\\) rows and \\(c\\) columns cross to form an \\(r \\times c\\) rectangular array containing no tile at all, so \\(r<k\\) and \\(c<k\\) by maximality. Consequently, there are \\(n-r \\geq n-k+1\\) rows containing at least one horizontal tile each, and \\(n-c \\geq n-k+1\\) columns containing at least one vertical tile each, whence a total of at least \\(2 n-2 k+2\\) tiles.\n\nWe now show that the rows not containing a tile are consecutive; columns are dealt with similarly. Consider a horizontal tile \\(T\\). Since \\(n<2 k\\), the nearest horizontal side of the board is at most \\(k-1\\) rows away from the row containing \\(T\\). These rows, if any, cross the \\(k\\) columns \\(T\\) crosses to form a rectangular array no vertical tile fits in. Maximality forces each of these rows to contain a horizontal tile and the claim follows.\n\nConsequently, the cardinality of every maximal arrangement is at least \\(\\min (n, 2 n-2 k+2)\\), and the conclusion follows.", "source_pdf": "egmo_2016.pdf", "notes": ""}
{"id": "EGMO-2016-6", "contest": "EGMO", "year": "2016", "problem_number": "6", "problem": "Let \\(S\\) be the set of all positive integers \\(n\\) such that \\(n^{4}\\) has a divisor in the range \\(n^{2}+1, n^{2}+2, \\ldots, n^{2}+2 n\\). Prove that there are infinitely many elements of \\(S\\) of each of the forms \\(7 m, 7 m+1,7 m+2,7 m+5,7 m+6\\) and no elements of \\(S\\) of the form \\(7 m+3\\) or \\(7 m+4\\), where \\(m\\) is an integer.", "solution": "The conclusion is a consequence of the lemma below which actually provides a recursive description of \\(S\\). The proof of the lemma is at the end of the solution.\n\nLemma. The fourth power of a positive integer \\(n\\) has a divisor in the range \\(n^{2}+1, n^{2}+2, \\ldots, n^{2}+2 n\\) if and only if at least one of the numbers \\(2 n^{2}+1\\) and \\(12 n^{2}+9\\) is a perfect square.\n\nConsequently, a positive integer \\(n\\) is a member of \\(S\\) if and only if \\(m^{2}- 2 n^{2}=1\\) or \\(m^{2}-12 n^{2}=9\\) for some positive integer \\(m\\).\n\nThe former is a Pell equation whose solutions are \\(\\left(m_{1}, n_{1}\\right)=(3,2)\\) and\n\\[\n\\left(m_{k+1}, n_{k+1}\\right)=\\left(3 m_{k}+4 n_{k}, 2 m_{k}+3 n_{k}\\right), \\quad k=1,2,3, \\ldots\n\\]\n\nIn what follows, all congruences are modulo 7. Iteration shows that \\(\\left(m_{k+3}, n_{k+3}\\right) \\equiv\\left(m_{k}, n_{k}\\right)\\). Since \\(\\left(m_{1}, n_{1}\\right) \\equiv(3,2),\\left(m_{2}, n_{2}\\right) \\equiv(3,-2)\\), and\n\\(\\left(m_{3}, n_{3}\\right) \\equiv(1,0)\\), it follows that \\(S\\) contains infinitely many integers from each of the residue classes 0 and \\(\\pm 2\\) modulo 7 .\n\nThe other equation is easily transformed into a Pell equation, \\(m^{\\prime 2}- 12 n^{\\prime 2}=1\\), by noticing that \\(m\\) and \\(n\\) are both divisible by 3 , say \\(m=3 m^{\\prime}\\) and \\(n=3 n^{\\prime}\\). In this case, the solutions are \\(\\left(m_{1}, n_{1}\\right)=(21,6)\\) and\n\\[\n\\left(m_{k+1}, n_{k+1}\\right)=\\left(7 m_{k}+24 n_{k}, 2 m_{k}+7 n_{k}\\right), \\quad k=1,2,3, \\ldots\n\\]\n\nThis time iteration shows that \\(\\left(m_{k+4}, n_{k+4}\\right) \\equiv\\left(m_{k}, n_{k}\\right)\\). Since \\(\\left(m_{1}, n_{1}\\right) \\equiv (0,-1),\\left(m_{2}, n_{2}\\right) \\equiv(-3,0),\\left(m_{3}, n_{3}\\right) \\equiv(0,1)\\), and \\(\\left(m_{4}, n_{4}\\right) \\equiv(3,0)\\), it follows that \\(S\\) contains infinitely many integers from each of the residue classes 0 and \\(\\pm 1\\) modulo 7 .\n\nFinally, since the \\(n_{k}\\) from the two sets of formulae exhaust \\(S\\), by the preceding no integer in the residue classes \\(\\pm 3\\) modulo 7 is a member of \\(S\\).\n\nWe now turn to the proof of the lemma. Let \\(n\\) be a member of \\(S\\), and let \\(d=n^{2}+m\\) be a divisor of \\(n^{4}\\) in the range \\(n^{2}+1, n^{2}+2, \\ldots, n^{2}+2 n\\), so \\(1 \\leq m \\leq 2 n\\). Consideration of the square of \\(n^{2}=d-m\\) shows \\(m^{2}\\) divisible by \\(d\\), so \\(m^{2} / d\\) is a positive integer. Since \\(n^{2}<d<(n+1)^{2}\\), it follows that \\(d\\) is not a square; in particular, \\(m^{2} / d \\neq 1\\), so \\(m^{2} / d \\geq 2\\). On the other hand, \\(1 \\leq m \\leq 2 n\\), so \\(m^{2} / d=m^{2} /\\left(n^{2}+m\\right) \\leq 4 n^{2} /\\left(n^{2}+1\\right)<4\\). Consequently, \\(m^{2} / d=2\\) or \\(m^{2} / d=3\\); that is, \\(m^{2} /\\left(n^{2}+m\\right)=2\\) or \\(m^{2} /\\left(n^{2}+m\\right)=3\\). In the former case, \\(2 n^{2}+1=(m-1)^{2}\\), and in the latter, \\(12 n^{2}+9=(2 m-3)^{2}\\).\n\nConversely, if \\(2 n^{2}+1=m^{2}\\) for some positive integer \\(m\\), then \\(1<m^{2}< 4 n^{2}\\), so \\(1<m<2 n\\), and \\(n^{4}=\\left(n^{2}+m+1\\right)\\left(n^{2}-m+1\\right)\\), so the first factor is the desired divisor.\n\nSimilarly, if \\(12 n^{2}+9=m^{2}\\) for some positive integer \\(m\\), then \\(m\\) is odd, \\(n \\geq 6\\), and \\(n^{4}=\\left(n^{2}+m / 2+3 / 2\\right)\\left(n^{2}-m / 2+3 / 2\\right)\\), and again the first factor is the desired divisor.", "source_pdf": "egmo_2016.pdf", "notes": ""}
{"id": "EGMO-2017-1", "contest": "EGMO", "year": "2017", "problem_number": "1", "problem": "Let \\(A B C D\\) be a convex quadrilateral with \\(\\angle D A B=\\angle B C D=90^{\\circ}\\) and \\(\\angle A B C>\\angle C D A\\). Let \\(Q\\) and \\(R\\) be points on the segments \\(B C\\) and \\(C D\\), respectively, such that the line \\(Q R\\) intersects lines \\(A B\\) and \\(A D\\) at points \\(P\\) and \\(S\\), respectively. It is given that \\(P Q=R S\\). Let the midpoint of \\(B D\\) be \\(M\\) and the midpoint of \\(Q R\\) be \\(N\\). Prove that \\(M, N, A\\) and \\(C\\) lie on a circle.", "solution": "Note that \\(N\\) is also the midpoint of \\(P S\\). From right-angled triangles \\(P A S\\) and \\(C Q R\\) we obtain \\(\\angle A N P= 2 \\angle A S P, \\angle C N Q=2 \\angle C R Q\\), hence \\(\\angle A N C=\\angle A N P+\\angle C N Q=2(\\angle A S P+\\angle C R Q)=2(\\angle R S D+\\angle D R S)= 2 \\angle A D C\\). Similarly, using right-angled triangles \\(B A D\\) and \\(B C D\\), we obtain \\(\\angle A M C=2 \\angle A D C\\). Thus \\(\\angle A M C=\\angle A N C\\), and the required statement follows.", "source_pdf": "egmo_2017.pdf", "notes": ""}
{"id": "EGMO-2017-2", "contest": "EGMO", "year": "2017", "problem_number": "2", "problem": "Find the smallest positive integer \\(k\\) for which there exist a colouring of the positive integers \\(\\mathbb{Z}_{>0}\\) with \\(k\\) colours and a function \\(f: \\mathbb{Z}_{>0} \\rightarrow \\mathbb{Z}_{>0}\\) with the following two properties: (i) For all positive integers \\(m, n\\) of the same colour, \\(f(m+n)=f(m)+f(n)\\). (ii) There are positive integers \\(m, n\\) such that \\(f(m+n) \\neq f(m)+f(n)\\).", "solution": "The answer is \\(k=3\\). First we show that there is such a function and coloring for \\(k=3\\). Consider \\(f: \\mathbb{Z}_{>0} \\rightarrow \\mathbb{Z}_{>0}\\) given by \\(f(n)=n\\) for all \\(n \\equiv 1\\) or 2 modulo 3 , and \\(f(n)=2 n\\) for \\(n \\equiv 0\\) modulo 3 . Moreover, give a positive integer \\(n\\) the \\(i\\)-th color if \\(n \\equiv i(3)\\). By construction we have \\(f(1+2)=6 \\neq 3=f(1)+f(2)\\) and hence \\(f\\) has property (ii). Now let \\(n, m\\) be positive integers with the same color \\(i\\). If \\(i=0\\), then \\(n+m\\) has color 0 , so \\(f(n+m)= 2(n+m)=2 n+2 m=f(n)+f(m)\\). If \\(i=1\\), then \\(n+m\\) has color 2 , so \\(f(n+m)=n+m=f(n)+f(m)\\). Finally, if \\(i=2\\), then \\(n+m\\) has color 1 , so \\(f(n+m)=n+m=f(n)+f(m)\\). Therefore \\(f\\) also satisfies condition (i). Next we show that there is no such function and coloring for \\(k=2\\). Consider any coloring of \\(\\mathbb{Z}_{>0}\\) with 2 colors and any function \\(f: \\mathbb{Z}_{>0} \\rightarrow \\mathbb{Z}_{>0}\\) satisfying conditions (i) and (ii). Then there exist positive integers \\(m\\) and \\(n\\) such that \\(f(m+n) \\neq f(m)+f(n)\\). Choose \\(m\\) and \\(n\\) such that their sum is minimal among all such \\(m, n\\) and define \\(a=m+n\\). Then in particular for every \\(b<a\\) we have \\(f(b)=b f(1)\\) and \\(f(a) \\neq a f(1)\\). If \\(a\\) is even, then condition (i) for \\(m=n=\\frac{a}{2}\\) implies \\(f(a)=f\\left(\\frac{a}{2}\\right)+f\\left(\\frac{a}{2}\\right)=f(1) a\\), a contradiction. Hence \\(a\\) is odd. We will prove two lemmas. Lemma 1. Any odd integer \\(b<a\\) has a different color than \\(a\\). Proof. Suppose that \\(b<a\\) is an odd integer, and that \\(a\\) and \\(b\\) have the same color. Then on the one hand, \\(f(a+b)=f(a)+b f(1)\\). On the other hand, we also have \\(f(a+b)=f\\left(\\frac{a+b}{2}\\right)+f\\left(\\frac{a+b}{2}\\right)=(a+b) f(1)\\), as \\(\\frac{a+b}{2}\\) is a positive integer smaller than \\(a\\). Hence \\(f(a)=f(a+b)-b f(1)=(a+b) f(1)-b f(1)=a f(1)\\), which is again a contradiction. Therefore all odd integers smaller than \\(a\\) have a color different from that of \\(a\\). Lemma 2. Any even integer \\(b<a\\) has the same color as a Proof. Suppose \\(b<a\\) is an even integer, and that \\(a\\) and \\(b\\) have different colors. Then \\(a-b\\) is an odd integer smaller than \\(a\\), so it has the same color as \\(b\\). Thus \\(f(a)=f(a-b)+f(b)=(a-b) f(1)+b f(1)=a f(1)\\), a contradiction. Hence all even integers smaller than \\(a\\) have the same color as \\(a\\). Suppose now \\(a+1\\) has the same color as \\(a\\). As \\(a>1\\), we have \\(\\frac{a+1}{2}<a\\) and therefore \\(f(a+1)=2 f\\left(\\frac{a+1}{2}\\right)= (a+1) f(1)\\). As \\(a-1\\) is an even integer smaller than \\(a\\), we have by Lemma 2 that \\(a-1\\) also has the same color as \\(a\\). Hence \\(2 f(a)=f(2 a)=f(a+1)+f(a-1)=(a+1) f(1)+(a-1) f(1)=2 a f(1)\\), which implies that \\(f(a)=a f(1)\\), a contradiction. So \\(a\\) and \\(a+1\\) have different colors. Since \\(a-2\\) is an odd integer smaller than \\(a\\), by Lemma 1 it has a color different from that of \\(a\\), so \\(a-2\\) and \\(a+1\\) have the same color. Also, we have seen by Lemma 2 that \\(a-1\\) and \\(a\\) have the same color. So \\(f(a)+f(a-1)=f(2 a-1)=f(a+1)+f(a-2)=(a+1) f(1)+(a-2) f(1)=(2 a-1) f(1)\\), from which it follows that \\(f(a)=(2 a-1) f(1)-f(a-1)=(2 a-1) f(1)-(a-1) f(1)=a f(1)\\), which contradicts our choice of \\(a\\) and finishes the proof.", "source_pdf": "egmo_2017.pdf", "notes": ""}
{"id": "EGMO-2017-3", "contest": "EGMO", "year": "2017", "problem_number": "3", "problem": "There are 2017 lines in a plane such that no 3 of them go through the same point. Turbo the snail can slide along the lines in the following fashion: she initially moves on one of the lines and continues moving on a given line until she reaches an intersection of 2 lines. At the intersection, she follows her journey on the other line turning left or right, alternating the direction she chooses at each intersection point she passes. Can it happen that she slides through a line segment for a second time in her journey but in the opposite direction as she did for the first time?", "solution": "We show that this is not possible. The lines divide the plane into disjoint regions. We claim that there exists an alternating 2 -coloring of these regions, that is each region can be colored in black or white, such that if two regions share a line segment, they have a different color. We show this inductively. If there are no lines, this is obvious. Consider now an arrangement of \\(n\\) lines in the plane and an alternating 2 -coloring of the regions. If we add a line \\(g\\), we can simply switch the colors of all regions in one of the half planes divided by \\(g\\) from white to black and vice versa. Any line segment not in \\(g\\) will still be between two regions of different color. Any line segment in \\(g\\) cuts a region determined by the \\(n\\) lines in two, and since we switched colors on one side of \\(g\\) this segment will also lie between two regions of different color. Now without loss of generality we may assume, that Turbo starts on a line segment with a white region on her left and a black one on her right. At any intersection, if she turns right, she will keep the black tile to her right. If she turns left, she will keep the white tile to her left. Thus wherever she goes, she will always have a white tile on her left and a black tile on her right. As a consequence, she can cross every line segment only in the direction where she has a white tile to her left, and never the opposite direction where she would have a black tile to the left.", "source_pdf": "egmo_2017.pdf", "notes": ""}
{"id": "EGMO-2017-4", "contest": "EGMO", "year": "2017", "problem_number": "4", "problem": "Let \\(n \\geq 1\\) be an integer and let \\(t_{1}<t_{2}<\\ldots<t_{n}\\) be positive integers. In a group of \\(t_{n}+1\\) people, some games of chess are played. Two people can play each other at most once. Prove that it is possible for the following conditions to hold at the same time: i) The number of games played by each person is one of \\(t_{1}, t_{2}, \\ldots, t_{n}\\), ii) For every \\(i\\) with \\(1 \\leq i \\leq n\\), there is someone who has played exactly \\(t_{i}\\) games of chess.", "solution": "Let \\(\\mathcal{T}=\\left\\{t_{1}, \\ldots, t_{n}\\right\\}\\). The proof proceeds by induction on \\(n=|\\mathcal{T}|\\). If \\(n=1\\) and \\(\\mathcal{T}=\\{t\\}\\), choose a group of \\(t+1\\) people and let every pair of two persons play against each other. Then every person has played \\(t\\) games and the conditions of the problem are satisfied. In the inductive step, suppose that \\(\\mathcal{T}\\) has \\(n \\geq 2\\) elements \\(t_{1}<t_{2}<\\cdots<t_{n}\\). Consider the set \\(\\mathcal{T}^{\\prime}=\\left\\{t_{n}-t_{n-1}, t_{n}-t_{n-2}, \\ldots, t_{n}-t_{1}\\right\\} .\\) By the inductive hypothesis, there exists a group \\(G^{\\prime}\\) of \\(t_{n}-t_{1}+1\\) people that satisfies the conditions of the problem for \\(T^{\\prime}\\). Next construct a group \\(G^{\\prime \\prime}\\) of \\(t_{n}+1\\) people by adding \\(t_{1}\\) people who do not know any of the other \\(t_{n}-t_{1}+1\\) people in \\(G^{\\prime}\\). Finally, construct a group \\(G\\) by complementing the knowledge relation in \\(G^{\\prime \\prime}\\) : two persons play against each other in \\(G\\) if and only if they do not play against each other in \\(G^{\\prime \\prime}\\). By construction \\(t \\in \\mathcal{T}\\) if and only if there exists a person in \\(G^{\\prime \\prime}\\) that played against exactly \\(t_{n}-t\\) other people (if \\(t=t_{n}\\), choose one of the \\(t_{1}\\) people added to \\(\\left.G^{\\prime}\\right)\\). That person knows \\(t_{n}-\\left(t_{n}-t\\right)=t\\) other students in \\(G\\), completing the proof.", "source_pdf": "egmo_2017.pdf", "notes": ""}
{"id": "EGMO-2017-5", "contest": "EGMO", "year": "2017", "problem_number": "5", "problem": "Let \\(n \\geq 2\\) be an integer. An \\(n\\)-tuple ( \\(a_{1}, a_{2}, \\ldots, a_{n}\\) ) of positive integers is expensive if there exists a positive integer \\(k\\) such that \\[ \\left(a_{1}+a_{2}\\right)\\left(a_{2}+a_{3}\\right) \\cdots \\cdots\\left(a_{n-1}+a_{n}\\right)\\left(a_{n}+a_{1}\\right)=2^{2 k-1} \\] a) Find all positive integers \\(n \\geq 2\\) for which there exists an expensive \\(n\\)-tuple. b) Prove that for every positive integer \\(m\\) there exists an integer \\(n \\geq 2\\) such that \\(m\\) belongs to an expensive \\(n\\)-tuple.", "solution": "a) Notice that for odd integers \\(n>2\\), the tuple \\((1,1, \\ldots, 1)\\) is expensive. We will prove that there are no expensive \\(n\\)-tuples for even \\(n\\). Lemma 0.1. If an expensive \\(n\\)-tuple exists for some \\(n \\geq 4\\), then also an expensive \\(n-2\\)-tuple. Proof. In what follows all indices are considered modulo \\(n\\). Let \\(\\left(a_{1}, a_{2}, \\ldots, a_{n}\\right)\\) be an expensive \\(n\\)-tuple and \\(a_{t}\\) the largest element of the tuple. We have the inequalities \\[ \\begin{gathered} a_{t-1}+a_{t} \\leq 2 a_{t}<2\\left(a_{t}+a_{t+1}\\right) \\\\ a_{t}+a_{t+1} \\leq 2 a_{t}<2\\left(a_{t-1}+a_{t}\\right) \\end{gathered} \\] Since both \\(a_{t-1}+a_{t}\\) and \\(a_{t}+a_{t+1}\\) are powers of 2 (they are divisors of a power of 2 ), we deduce from (1) and (2) \\[ a_{t-1}+a_{t}=a_{t}+a_{t+1}=2^{r} \\] for some positive integer \\(r\\), and in particular \\(a_{t-1}=a_{t+1}\\). Consider now the \\(n-2\\)-tuple ( \\(b_{1}, \\ldots, b_{n-2}\\) ) obtained by removing \\(a_{t}\\) and \\(a_{t+1}\\) from ( \\(a_{1}, a_{2}, \\ldots, a_{n}\\) ). By what we just said we have \\[ \\prod_{i=1}^{n-2}\\left(b_{i}+b_{i+1}\\right)=\\frac{\\prod_{i=1}^{n}\\left(a_{i}+a_{i+1}\\right)}{\\left(a_{t-1}+a_{t}\\right)\\left(a_{t}+a_{t+1}\\right)}=2^{2(k-r)-1}, \\] and hence ( \\(b_{1}, \\ldots, b_{n-2}\\) ) is again expensive. From the lemma we now conclude that if there exists an expensive \\(n\\)-tuple for some even \\(n\\), then also an expensive 2 -tuple i.e. \\[ \\left(a_{1}+a_{2}\\right)^{2}=2^{2 k-1} \\] for some positive integers \\(a_{1}, a_{2}\\), which is impossible since the right hand side is not a square. b) We prove this by induction. In \\(a\\) ) we saw that 1 belongs to an expensive \\(n\\)-tuple. Assume now that all odd positive integers less that \\(2^{k}\\) belong to an expensive \\(n\\)-tuple, for some \\(k \\geq 1\\). Hence for any odd \\(r<2^{k}\\) there is an integer \\(n\\) and an expensive \\(n\\)-tuple \\(\\left(a_{1}, \\ldots, r, \\ldots, a_{n}\\right)\\). We notice that then also \\(\\left(a_{1}, \\ldots, r, 2^{k+1}-\\right. r, r, \\ldots, a_{n}\\) ) is expensive. Since \\(2^{k+1}-r\\) can take all odd values between \\(2^{k}\\) and \\(2^{k+1}\\) the induction step is complete.", "source_pdf": "egmo_2017.pdf", "notes": ""}
{"id": "EGMO-2017-6", "contest": "EGMO", "year": "2017", "problem_number": "6", "problem": "Let \\(A B C\\) be an acute-angled triangle in which no two sides have the same length. The reflections of the centroid \\(G\\) and the circumcentre \\(O\\) of \\(A B C\\) in its sides \\(B C, C A, A B\\) are denoted by \\(G_{1}, G_{2}, G_{3}\\), and \\(O_{1}, O_{2}, O_{3}\\), respectively. Show that the circumcircles of the triangles \\(G_{1} G_{2} C, G_{1} G_{3} B, G_{2} G_{3} A, O_{1} O_{2} C, O_{1} O_{3} B, O_{2} O_{3} A\\) and \\(A B C\\) have a common point.", "solution": "Let \\(H\\) denote the orthocenter of \\(A B C\\), and let \\(e\\) denote its Euler line. Let \\(e_{1}, e_{2}, e_{3}\\) denote the respective reflections of \\(e\\) in \\(B C, C A, A B\\). The proof naturally divides into two parts: we first show that pairwise intersections of the circles in question correspond to pairwise intersections of \\(e_{1}, e_{2}, e_{3}\\), and then prove that \\(e_{1}, e_{2}, e_{3}\\) intersect in a single point on the circumcircle of \\(A B C\\). Now consider for example the circumcircles of \\(O_{1} O_{2} C\\) and \\(G_{1} G_{2} C\\). By construction, it is clear that \\(\\angle O_{2} C O_{1}=\\angle G_{2} C G_{1}=2 \\angle A C B\\). Let \\(G_{1} O_{1}\\) and \\(G_{2} O_{2}\\) meet at \\(X\\), and let \\(e\\) meet \\(e_{1}, e_{2}\\) at \\(E_{1}, E_{2}\\), respectively, as shown in the diagram below. Chasing angles, \\[ \\begin{aligned} \\angle G_{2} X G_{1}=\\angle O_{2} X O_{1} & =\\angle E_{2} X E_{1}=180^{\\circ}-\\angle E_{1} E_{2} X-\\angle X E_{1} E_{2} \\\\ & =180^{\\circ}-2 \\angle E_{1} E_{2} C-\\left(\\angle C E_{1} E_{2}-\\angle C E_{1} X\\right) . \\end{aligned} \\] But \\(\\angle C E_{1} X=\\angle B E_{1} O_{1}=\\angle B E_{1} O=180^{\\circ}-\\angle C E_{1} E_{2}\\), and thus \\[ \\angle G_{2} X G_{1}=\\angle O_{2} X O_{1}=2\\left(180^{\\circ}-\\angle E_{1} E_{2} C-\\angle C E_{1} E_{2}\\right)=2 \\angle A C B . \\] It follows from this that \\(X\\) lies on the circumcircles of \\(G_{1} G_{2} C\\) and \\(O_{1} O_{2} C\\). In other words, the second point of intersection of the circumcircles of \\(G_{1} G_{2} C\\) and \\(O_{1} O_{2} C\\) is the intersection of \\(e_{1}\\) and \\(e_{2}\\). Similarly, the circumcircles of \\(G_{1} G_{3} B\\) and \\(O_{1} O_{3} B\\) meet again at the intersection of \\(e_{1}\\) and \\(e_{3}\\), and those of \\(G_{2} G_{3} A\\) and \\(O_{2} O_{3} A\\) meet again at the intersection of \\(e_{2}\\) and \\(e_{3}\\). It thus remains to show that \\(e_{1}, e_{2}, e_{3}\\) are concurrent, and intersect on the circumcircle of \\(A B C\\). Let \\(e\\) meet the circumcircles of the triangles \\(B C H, A C H, A B H\\) at \\(X_{1}, X_{2}, X_{3}\\), respectively. It is well known that the reflections of \\(H\\) in the sides of \\(A B C\\) lie on the circumcircle of \\(A B C\\). For this reason, the circumcircles of \\(B C H, A C H, A B H\\) have the same radius as the circumcircle of \\(A B C\\), and hence the reflections \\(X_{1}^{\\prime}, X_{2}^{\\prime}, X_{3}^{\\prime}\\) of \\(X_{1}, X_{2}, X_{3}\\) in the sides \\([B C],[C A],[A B]\\) lie on the circumcircle of \\(A B C\\). By definition, \\(X_{1}^{\\prime}, X_{2}^{\\prime}, X_{3}^{\\prime}\\) lie on \\(e_{1}, e_{2}, e_{3}\\), respectively. It thus remains to show that they coincide. To show that, for example, \\(X_{1}^{\\prime}=X_{2}^{\\prime}\\), it will be sufficient to show that \\(\\angle X_{2} A C=\\angle X_{1}^{\\prime} A C\\), since we have already shown that \\(X_{1}^{\\prime}\\) and \\(X_{2}^{\\prime}\\) lie on the circumcircle of \\(A B C\\). But, chasing angles in the diagram above, \\[ \\begin{aligned} \\angle X_{1}^{\\prime} A C & =\\angle X_{1}^{\\prime} A B-\\angle B A C=\\left(180^{\\circ}-\\angle X_{1}^{\\prime} C B\\right)-\\angle B A C \\\\ & =180^{\\circ}-\\angle X_{1} C B-\\angle B A C=\\left(180^{\\circ}-\\angle B A C\\right)-\\angle X_{1} H B \\\\ & =\\angle B H C-\\angle X_{1} H B=\\angle X_{2} H C=\\angle X_{2} A C \\end{aligned} \\] where we have used the fact that \\(B H C X_{1}\\) and \\(A H X_{2} C\\) are cyclic by construction, and the fact that \\(\\angle B H C=180^{\\circ}-\\angle B A C\\). This shows that \\(X_{1}^{\\prime}=X_{2}^{\\prime}\\). Similarly, \\(X_{1}^{\\prime}=X_{3}^{\\prime}\\), which completes the proof.", "source_pdf": "egmo_2017.pdf", "notes": ""}
{"id": "EGMO-2018-1", "contest": "EGMO", "year": "2018", "problem_number": "1", "problem": "Let \\(A B C\\) be a triangle with \\(C A=C B\\) and \\(\\angle A C B=120^{\\circ}\\), and let \\(M\\) be the midpoint of \\(A B\\). Let \\(P\\) be a variable point on the circumcircle of \\(A B C\\), and let \\(Q\\) be the point on the segment \\(C P\\) such that \\(Q P=2 Q C\\). It is given that the line through \\(P\\) and perpendicular to \\(A B\\) intersects the line \\(M Q\\) at a unique point \\(N\\). Prove that there exists a fixed circle such that \\(N\\) lies on this circle for all possible positions of \\(P\\). (Velina Ivanova, Bulgaria)", "solution": "Let \\(O\\) be the circumcenter of \\(A B C\\). From the assumption that \\(\\angle A C B=120^{\\circ}\\) it follows that \\(M\\) is the midpoint of \\(C O\\). Let \\(\\omega\\) denote the circle with center in \\(C\\) and radius \\(C O\\). This circle in the image of the circumcircle of \\(A B C\\) through the translation that sends \\(O\\) to \\(C\\). We claim that \\(N\\) lies on \\(\\omega\\). Let us consider the triangles \\(Q N P\\) and \\(Q M C\\). The angles in \\(Q\\) are equal. Since \\(N P\\) is parallel to \\(M C\\) (both lines are perpendicular to \\(A B\\) ), it turns out that \\(\\angle Q N P=\\angle Q M C\\), and hence the two triangles are similar. Since \\(Q P=2 Q C\\), it follows that \\[ N P=2 M C=C O, \\] which proves that \\(N\\) lies on \\(\\omega\\).", "source_pdf": "egmo_2018.pdf", "notes": ""}
{"id": "EGMO-2018-2", "contest": "EGMO", "year": "2018", "problem_number": "2", "problem": "Consider the set \\[ A=\\left\\{1+\\frac{1}{k}: k=1,2,3, \\ldots\\right\\} \\] (a) Prove that every integer \\(x \\geq 2\\) can be written as the product of one or more elements of \\(A\\), which are not necessarily different. (b) For every integer \\(x \\geq 2\\), let \\(f(x)\\) denote the minimum integer such that \\(x\\) can be written as the product of \\(f(x)\\) elements of \\(A\\), which are not necessarily different. Prove that there exist infinitely many pairs ( \\(x, y\\) ) of integers with \\(x \\geq 2, y \\geq 2\\), and \\[ f(x y)<f(x)+f(y) \\] (Pairs \\(\\left(x_{1}, y_{1}\\right)\\) and \\(\\left(x_{2}, y_{2}\\right)\\) are different if \\(x_{1} \\neq x_{2}\\) or \\(y_{1} \\neq y_{2}\\) ). (Mihail Baluna, Romania)", "solution": "Every integer \\(x \\geq 2\\) can be written as the telescopic product of \\(x-1\\) elements of \\(A\\) as \\[ x=\\left(1+\\frac{1}{x-1}\\right) \\cdot\\left(1+\\frac{1}{x-2}\\right) \\cdot \\ldots \\cdot\\left(1+\\frac{1}{2}\\right) \\cdot\\left(1+\\frac{1}{1}\\right) \\] which is enough to establish part (a). We now consider part (b). Notice that for any positive integer \\(k\\) we have \\[ f\\left(2^{k}+1\\right) \\leq k+1 \\] because \\(2^{k}+1=\\left(1+\\frac{1}{2^{k}}\\right) \\cdot 2^{k}\\) is a representation of \\(2^{k}+1\\) as a product of \\(k+1\\) elements of \\(A\\). We claim that all the pairs \\((x, y)\\) of the form \\[ x=5, \\quad y=\\frac{2^{4 k+2}+1}{5} \\] satisfy the required inequality. Notice that \\(y\\) is an integer for any positive value of \\(k\\), because \\(2^{4 k+2}+1 \\equiv 16^{k} \\cdot 4+1 \\equiv 5 \\equiv 0(\\bmod 5)\\). Furthermore, \\(f(x y)=f\\left(2^{4 k+2}+1\\right) \\leq 4 k+3\\) (and \\(f(x)=f\\left(2^{2}+1\\right) \\leq 3\\) ) by the above. We now need some lower bounds on the values of \\(f\\). Notice that no element of \\(A\\) exceeds 2, and therefore the product of at most \\(k\\) elements of \\(A\\) does not exceed \\(2^{k}\\) : it follows that \\[ f(n) \\geq\\left\\lceil\\log _{2}(n)\\right\\rceil \\] and in particular that \\[ f(5)=f\\left(2^{2}+1\\right) \\geq\\left\\lceil\\log _{2}(5)\\right\\rceil=3 \\] We have thus proven \\(f(x)=f(5)=3\\). We want to show \\(f(x y)<f(x)+f(y)\\), and since we know \\(f(x y) \\leq 4 k+3\\) and \\(f(x)=3\\) we are reduced to showing \\(f(y)>4 k\\). Since \\(y>2^{4 k-1}\\), from (Q2.1) we already know that \\(f(y) \\geq 4 k\\), and hence we just need to exclude that \\(f(y)=4 k\\). Let us assume that we can represent \\(y\\) in the form \\(a_{1} \\cdot \\ldots \\cdot a_{4 k}\\) with every \\(a_{i}\\) in \\(A\\). At least one of the \\(a_{i}\\) is not 2 (otherwise the product would be a power of 2 , while \\(y\\) is odd), and hence it is less than or equal to \\(3 / 2\\). It follows that \\[ a_{1} \\cdot \\ldots \\cdot a_{4 k} \\leq 2^{4 k-1} \\cdot \\frac{3}{2}=15 \\cdot \\frac{2^{4 k-2}}{5}<\\frac{2^{4 k+2}}{5}<y \\] which contradicts the fact that \\(a_{1} \\cdot \\ldots \\cdot a_{4 k}\\) is a representation of \\(y\\). Note. Using a similar approach one can also prove that all pairs of the form \\[ \\left(3, \\frac{2^{2 k+1}+1}{3}\\right) \\quad \\text { and } \\quad\\left(11, \\frac{2^{10 k+5}+1}{11}\\right) \\] satisfy the required inequality.", "source_pdf": "egmo_2018.pdf", "notes": ""}
{"id": "EGMO-2018-3", "contest": "EGMO", "year": "2018", "problem_number": "3", "problem": "The \\(n\\) contestants of an EGMO are named \\(C_{1}, \\ldots, C_{n}\\). After the competition they queue in front of the restaurant according to the following rules. - The Jury chooses the initial order of the contestants in the queue. - Every minute, the Jury chooses an integer \\(i\\) with \\(1 \\leq i \\leq n\\). - If contestant \\(C_{i}\\) has at least \\(i\\) other contestants in front of her, she pays one euro to the Jury and moves forward in the queue by exactly \\(i\\) positions. - If contestant \\(C_{i}\\) has fewer than \\(i\\) other contestants in front of her, the restaurant opens and the process ends. (a) Prove that the process cannot continue indefinitely, regardless of the Jury's choices. (b) Determine for every \\(n\\) the maximum number of euros that the Jury can collect by cunningly choosing the initial order and the sequence of moves. (Hungary)", "solution": "The maximal number of euros is \\(2^{n}-n-1\\). To begin with, we show that it is possible for the Jury to collect this number of euros. We argue by induction. Let us assume that the Jury can collect \\(M_{n}\\) euros in a configuration with \\(n\\) contestants. Then we show that the Jury can collect at least \\(2 M_{n}+n\\) moves in a configuration with \\(n+1\\) contestants. Indeed, let us begin with all the contestants lined up in reverse order. In the first \\(M_{n}\\) moves the Jury keeps \\(C_{n+1}\\) in first position and reverses the order of the remaining contestants, then in the next \\(n\\) moves all contestants \\(C_{1}, \\ldots, C_{n}\\) (in this order) jump over \\(C_{n+1}\\) and end up in the first \\(n\\) positions of the line in reverse order, and finally in the last \\(M_{n}\\) moves the Jury rearranges the first \\(n\\) positions. Since \\(M_{1}=0\\) and \\(M_{n+1} \\geq 2 M_{n}+n\\), an easy induction shows that \\(M_{n} \\geq 2^{n}-n-1\\). \\[ \\begin{gathered} n+1 \\\\ \\begin{array}{c} n \\\\ n-1 \\\\ \\vdots \\\\ 2 \\\\ 1 \\\\ \\hline \\end{array} \\\\ \\xrightarrow{M_{n} \\text { moves }} \\end{gathered} \\begin{gathered} n+1 \\\\ {\\left[\\begin{array}{c} 1 \\\\ 2 \\\\ \\vdots \\\\ n-1 \\\\ n \\\\ \\hline \\end{array}\\right.} \\end{gathered} \\xrightarrow{n \\text { moves }} \\underset{n+1}{\\left[\\begin{array}{c} n \\\\ n-1 \\\\ \\vdots \\\\ 2 \\\\ 1 \\\\ \\hline \\end{array}\\right]} \\xrightarrow{M_{n} \\text { moves }} \\begin{array}{|c|} \\left\\lvert\\, \\begin{array}{c} 1 \\\\ 2 \\\\ \\vdots \\\\ n-1 \\\\ n \\\\ \\hline \\end{array}\\right. \\\\ \\hline \\end{array} \\] Let us show now that at most \\(2^{n}-n-1\\) moves are possible. To this end, let us identify a line of contestants with a permutation \\(\\sigma\\) of \\(\\{1, \\ldots, n\\}\\). To each permutation we associate the set of reverse pairs \\[ R(\\sigma):=\\{(i, j): 1 \\leq i<j \\leq n \\text { and } \\sigma(i)>\\sigma(j)\\}, \\] and the nonnegative integer \\[ W(\\sigma):=\\sum_{(i, j) \\in R(\\sigma)} 2^{i}, \\] which we call the total weight of the permutation. We claim that the total weight decreases after any move of the contestants. Indeed, let us assume that \\(C_{i}\\) moves forward in the queue, let \\(\\sigma\\) be the permutation before the move, and let \\(\\sigma^{\\prime}\\) denote the permutation after the move. Since \\(C_{i}\\) jumps over exactly \\(i\\) contestants, necessarily she jumps over at least one contestant \\(C_{j}\\) with index \\(j>i\\). This means that the pair \\((i, j)\\) is reverse with respect to \\(\\sigma\\) but not with respect to \\(\\sigma^{\\prime}\\), and this yields a reduction of \\(2^{i}\\) in the total weight. On the other hand, the move by \\(C_{i}\\) can create new reverse pairs of the form ( \\(k, i\\) ) with \\(k<i\\), but their total contribution is at most \\[ 2^{0}+2^{1}+\\ldots+2^{i-1}=2^{i}-1 . \\] In conclusion, when passing from \\(\\sigma\\) to \\(\\sigma^{\\prime}\\), at least one term \\(2^{i}\\) disappears from the computation of the total weight, and the sum of all the new terms that might have been created is at most \\(2^{i}-1\\). This shows that \\(W\\left(\\sigma^{\\prime}\\right) \\leq W(\\sigma)-1\\). We conclude by observing that the maximum possible value of \\(W(\\sigma)\\) is realized when all pairs are reverse, in which case \\[ W(\\sigma)=\\sum_{i=1}^{n}(i-1) 2^{i}=2^{n}-n-1 \\] This proves that the number of moves is less than or equal to \\(2^{n}-n-1\\), and in particular it is finite.", "source_pdf": "egmo_2018.pdf", "notes": ""}
{"id": "EGMO-2018-4", "contest": "EGMO", "year": "2018", "problem_number": "4", "problem": "A domino is a \\(1 \\times 2\\) or \\(2 \\times 1\\) tile. Let \\(n \\geq 3\\) be an integer. Dominoes are placed on an \\(n \\times n\\) board in such a way that each domino covers exactly two cells of the board, and dominoes do not overlap. The value of a row or column is the number of dominoes that cover at least one cell of this row or column. The configuration is called balanced if there exists some \\(k \\geq 1\\) such that each row and each column has a value of \\(k\\). Prove that a balanced configuration exists for every \\(n \\geq 3\\), and find the minimum number of dominoes needed in such a configuration. (Merlijn Staps, The Netherlands)", "solution": "The minimal number of dominoes required in a balanced configuration is \\(2 n / 3\\) if \\(n\\) is a multiple of 3 , and \\(2 n\\) otherwise. In order to show that this number is necessary, we count in two different ways the number of elements of the set \\(S\\) of all pairs ( \\(\\ell, d\\) ), where \\(\\ell\\) is a row or a column of the board, and \\(d\\) is a domino that covers at least one cell of that row or column. On the one hand, since each row or column intersects the same number \\(k\\) of dominoes, the set \\(S\\) has \\(2 n k\\) elements. On the other hand, since each domino intersects 3 rows/columns, the set \\(S\\) has \\(3 D\\) elements, where \\(D\\) is the total number of dominoes on the board. This leads to the equality \\[ 2 n k=3 D . \\] If \\(n\\) is a multiple of 3 , from the trivial inequality \\(k \\geq 1\\) we obtain that \\(D \\geq 2 n / 3\\). If \\(n\\) is not a multiple of 3 , then \\(k\\) is a multiple of 3 , which means that \\(k \\geq 3\\) and hence \\(D \\geq 2 n\\). Now we need to exhibit a balanced configuration with this number of dominoes. The following diagram shows a balanced configuration with \\(n=3\\) and \\(k=1\\). If \\(n\\) is any multiple of 3 , we can obtain a balanced configuration with \\(k=1\\) by using \\(n / 3\\) of these \\(3 \\times 3\\) blocks along the principal diagonal of the board. The following diagrams show balanced configurations with \\(k=3\\) and \\(n \\in\\{4,5,6,7\\}\\). Any \\(n \\geq 8\\) can be written in the form \\(4 A+r\\) where \\(A\\) is a positive integer and \\(r \\in\\{4,5,6,7\\}\\). Therefore, we can obtain a balanced configuration with \\(n \\geq 8\\) and \\(k=3\\) by using one block with size \\(r \\times r\\), and \\(A\\) blocks with size \\(4 \\times 4\\) along the principal diagonal of the board. In particular, this construction covers all the cases where \\(n\\) is not a multiple of 3 .", "source_pdf": "egmo_2018.pdf", "notes": ""}
{"id": "EGMO-2018-5", "contest": "EGMO", "year": "2018", "problem_number": "5", "problem": "Let \\(\\Gamma\\) be the circumcircle of triangle \\(A B C\\). A circle \\(\\Omega\\) is tangent to the line segment \\(A B\\) and is tangent to \\(\\Gamma\\) at a point lying on the same side of the line \\(A B\\) as \\(C\\). The angle bisector of \\(\\angle B C A\\) intersects \\(\\Omega\\) at two different points \\(P\\) and \\(Q\\). Prove that \\(\\angle A B P=\\angle Q B C\\). (Dominika Regiec, Poland)", "solution": "Solution 1 Let \\(M\\) be the midpoint of the arc \\(A B\\) that does not contain \\(C\\), let \\(V\\) be the intersection of \\(\\Omega\\) and \\(\\Gamma\\), and let \\(U\\) be the intersection of \\(\\Omega\\) and \\(A B\\). The proof can be divided in two steps: 1. Proving that \\(M P \\cdot M Q=M B^{2}\\). It is well-known that \\(V, U\\) and \\(M\\) are collinear (indeed the homothety with center in \\(V\\) that sends \\(\\Omega\\) to \\(\\Gamma\\) sends \\(U\\) to the point of \\(\\Gamma\\) where the tangent to \\(\\Gamma\\) is parallel to \\(A B\\), and this point is \\(M\\) ), and \\[ M V \\cdot M U=M A^{2}=M B^{2} \\] This follows from the similitude between the triangles \\(\\triangle M A V\\) and \\(\\triangle M U A\\). Alternatively, it is a consequence of the following well-known lemma: Given a circle \\(\\Gamma\\) with a chord \\(A B\\), let \\(M\\) be the middle point of one of the two arcs \\(A B\\). Take a line through \\(M\\) which intersects \\(\\Gamma\\) again at \\(X\\) and \\(A B\\) at \\(Y\\). Then \\(M X \\cdot M Y\\) is independent of the choice of the line. Computing the power of \\(M\\) with respect to \\(\\Omega\\) we obtain that \\[ M P \\cdot M Q=M U \\cdot M V=M B^{2} \\] 2. Conclude the proof given that \\(M P \\cdot M Q=M B^{2}\\). The relation \\(M P \\cdot M Q=M B^{2}\\) in turn implies that triangle \\(\\triangle M B P\\) is similar to triangle \\(\\triangle M Q B\\), and in particular \\(\\angle M B P=\\angle M Q B\\). Keeping into account that \\(\\angle M C B= \\angle M B A\\), we finally conclude that \\[ \\angle Q B C=\\angle M Q B-\\angle M C B=\\angle M B P-\\angle M B A=\\angle P B A, \\] as required. Solution 2 The second solution is in fact a different proof of the first part of Solution 1. Let us consider the inversion with respect to circle with center \\(M\\) and radius \\(M A=M B\\). This inversion switches \\(A B\\) and \\(\\Gamma\\), and fixes the line passing through \\(M, U, V\\). As a consequence, it keeps \\(\\Omega\\) fixed, and therefore it switches \\(P\\) and \\(Q\\). This is because they are the intersections between the fixed line \\(M C\\) and \\(\\Omega\\), and the only fixed point on the segment \\(M C\\) is its intersection with the inversion circle (thus \\(P\\) and \\(Q\\) are switched). This implies that \\(M P \\cdot M Q=M B^{2}\\). Solution 3 This solution is instead a different proof of the second step of Solution 1. Let \\(I\\) and \\(J\\) be the incenter and the \\(C\\)-excenter of \\(\\triangle A B C\\) respectively. It is well-known that \\(M A=M I=M J\\), therefore the relation \\(M P \\cdot M Q=M A^{2}\\) implies that \\((P, Q, I, J)=-1\\). Now observe that \\(\\angle I B J=90^{\\circ}\\), thus \\(B I\\) is the angle bisector of \\(\\angle P B Q\\) as it is well-known from the theory of harmonic pencils, and this leads easily to the conclusion. Solution 4 Let \\(D\\) denote the intersection of \\(A B\\) and \\(C M\\). Let us consider an inversion with respect to \\(B\\), and let us use primes to denote corresponding points in the transformed diagram, with the gentlemen agreement that \\(B^{\\prime}=B\\). Since inversion preserves angles, it turns out that \\[ \\angle A^{\\prime} B^{\\prime} M^{\\prime}=\\angle A^{\\prime} M^{\\prime} B^{\\prime}=\\angle A C B \\] and in particular triangle \\(A^{\\prime} B^{\\prime} M^{\\prime}\\) is isosceles with basis \\(B^{\\prime} M^{\\prime}\\). The image of \\(C M\\) is the circumcircle of \\(B^{\\prime} C^{\\prime} M^{\\prime}\\), which we denote by \\(\\omega^{\\prime}\\). It follows that the centers of both \\(\\omega^{\\prime}\\) and the image \\(\\Omega^{\\prime}\\) of \\(\\Omega\\) lie on the perpendicular bisector of \\(B^{\\prime} M^{\\prime}\\). Therefore, the whole transformed diagram is symmetric with respect to the perpendicular bisector of \\(B^{\\prime} M^{\\prime}\\), and in particular the arcs \\(D^{\\prime} P^{\\prime}\\) and \\(Q^{\\prime} C^{\\prime}\\) of \\(\\omega^{\\prime}\\) are equal. This is enough to conclude that \\(\\angle D^{\\prime} B^{\\prime} P^{\\prime}=\\angle Q^{\\prime} B^{\\prime} C^{\\prime}\\), which implies the conclusion.", "source_pdf": "egmo_2018.pdf", "notes": ""}
{"id": "EGMO-2018-6", "contest": "EGMO", "year": "2018", "problem_number": "6", "problem": "(a) Prove that for every real number \\(t\\) such that \\(0<t<\\frac{1}{2}\\) there exists a positive integer \\(n\\) with the following property: for every set \\(S\\) of \\(n\\) positive integers there exist two different elements \\(x\\) and \\(y\\) of \\(S\\), and a non-negative integer \\(m\\) (i.e. \\(m \\geq 0\\) ), such that \\[ |x-m y| \\leq t y . \\] (b) Determine whether for every real number \\(t\\) such that \\(0<t<\\frac{1}{2}\\) there exists an infinite set \\(S\\) of positive integers such that \\[ |x-m y|>t y \\] for every pair of different elements \\(x\\) and \\(y\\) of \\(S\\) and every positive integer \\(m\\) (i.e. \\(m>0\\) ). (Merlijn Staps, The Netherlands)", "solution": "Part (a) Let \\(n\\) be any positive integer such that \\[ (1+t)^{n-1} \\geq \\frac{1}{t} \\] (this inequality is actually true for every large enough \\(n\\) due to Bernoulli's inequality). Let \\(S\\) be any set of \\(n\\) distinct positive integers, which we denote by \\[ s_{1}<s_{2}<\\ldots<s_{n} \\] We distinguish two cases. - If \\(s_{i+1} \\leq(1+t) s_{i}\\) for some \\(i \\in\\{1, \\ldots, n-1\\}\\), then \\[ \\left|s_{i+1}-s_{i}\\right|=s_{i+1}-s_{i} \\leq t s_{i} \\] and therefore the required inequality is satisfied with \\(x=s_{i+1}, y=s_{i}\\), and \\(m=1\\). - If \\(s_{i+1}>(1+t) s_{i}\\) for every \\(i \\in\\{1, \\ldots, n-1\\}\\), then by induction we obtain that \\[ s_{n}>(1+t)^{n-1} s_{1} . \\] As a consequence, from (Q6.1) it follows that \\[ \\left|s_{1}\\right|=s_{1}<\\frac{1}{(1+t)^{n-1}} \\cdot s_{n} \\leq t s_{n} \\] and therefore the required inequality is satisfied with \\(x=s_{1}, y=s_{n}\\), and \\(m=0\\). Part (b) (Explicit formula) We claim that an infinite set with the required property exists. To this end, we rewrite the required condition in the form \\[ \\left|\\frac{x}{y}-m\\right|>t . \\] This is equivalent to saying that the distance between the ratio \\(x / y\\) and the set of positive integers is greater than \\(t\\). Now we construct an increasing sequence \\(s_{n}\\) of odd coprime positive integers satisfying \\[ \\frac{1}{2}-\\frac{1}{2 s_{n}}>t \\quad \\forall n \\geq 1, \\] and such that for every \\(j>i\\) it turns out that \\[ \\frac{s_{i}}{s_{j}}<\\frac{1}{2} \\quad \\text { and } \\quad t<\\left\\{\\frac{s_{j}}{s_{i}}\\right\\}<\\frac{1}{2}, \\] where \\(\\{\\alpha\\}\\) denotes the fractional part of \\(\\alpha\\). This is enough to show that the set \\(S:=\\left\\{s_{n}: n \\geq 1\\right\\}\\) has the required property. To this end, we consider the sequence defined recursively by \\[ s_{n+1}=\\frac{\\left(s_{1} \\cdot \\ldots \\cdot s_{n}\\right)^{2}+1}{2}, \\] with \\(s_{1}\\) large enough. An easy induction shows that this is an increasing sequence of odd positive integers. For every \\(i \\in\\{1, \\ldots, n\\}\\) it turns out that \\[ \\frac{s_{i}}{s_{n+1}} \\leq \\frac{2}{s_{i}} \\leq \\frac{2}{s_{1}}<\\frac{1}{2} \\] because \\(s_{1}\\) is large enough, which proves the first relation in (Q6.3). Moreover, it turns out that \\[ \\frac{s_{n+1}}{s_{i}}=\\frac{\\left(s_{1} \\cdot \\ldots \\cdot s_{n}\\right)^{2}}{2 s_{i}}+\\frac{1}{2 s_{i}} . \\] The first term is a positive integer plus \\(1 / 2\\), from which it follows that the distance of \\(s_{n+1} / s_{i}\\) from the positive integers is greater than or equal to \\[ \\frac{1}{2}-\\frac{1}{2 s_{i}} \\geq \\frac{1}{2}-\\frac{1}{2 s_{1}}, \\] which is greater than \\(t\\) if \\(s_{1}\\) is large enough. This proves the second relation in (Q6.3). Part (b) (Arithmetic approach) We produce an increasing sequence \\(s_{n}\\) of odd and coprime positive integers that satisfies (Q6.3) every \\(j>i\\). As in the previous solution, this is enough to conclude. We argue by induction. To begin with, we choose \\(s_{1}\\) to be any odd integer satisfying the inequality in (Q6.2). Let us assume now that \\(s_{1}, \\ldots, s_{n}\\) have already been chosen, and let us choose \\(s_{n+1}\\) in such a way that \\[ s_{n+1} \\equiv \\frac{s_{i}-1}{2} \\quad\\left(\\bmod s_{i}\\right) \\quad \\forall i \\in\\{1, \\ldots, n\\} . \\] We can solve this system because the previously chosen integers are odd and coprime. Moreover, any solution of this system is coprime with \\(s_{1}, \\ldots, s_{n}\\). Indeed, for every \\(1 \\leq i \\leq n\\) it turns out that \\[ s_{n+1}=\\frac{s_{i}-1}{2}+k_{i} s_{i} \\] for some positive integer \\(k_{i}\\). Therefore, any prime \\(p\\) that divides both \\(s_{n+1}\\) and \\(s_{i}\\) divides also \\(\\left(2 k_{i}+1\\right) s_{i}-2 s_{n+1}=1\\), which is absurd. Finally, we observe that we can assume that \\(s_{n+1}\\) is odd and large enough. In this way we can guarantee that \\[ \\frac{s_{i}}{s_{n+1}}<\\frac{1}{2} \\quad \\forall i \\in\\{1, \\ldots, n\\}, \\] which is the first requirement in (Q6.3), and \\[ k_{i}+t<k_{i}+\\frac{1}{2}-\\frac{1}{2 s_{i}}=\\frac{s_{n+1}}{s_{i}}<k_{i}+\\frac{1}{2} \\quad \\forall i \\in\\{1, \\ldots, n\\}, \\] which implies the second requirement in (Q6.3). Part (b) (Algebraic approach) Again we produce an increasing sequence \\(s_{n}\\) of positive integers that satisfies (Q6.3) every \\(j>i\\). To this end, for every positive integer \\(x\\), we define its security region \\[ S(x):=\\bigcup_{n \\geq 1}\\left((n+t) x,\\left(n+\\frac{1}{2}\\right) x\\right) . \\] The security region \\(S(x)\\) is a periodic countable union of intervals of length \\(\\left(\\frac{1}{2}-t\\right) x\\), whose left-hand or right-hand endpoints form an arithmetic sequence. It has the property that \\[ t<\\left\\{\\frac{y}{x}\\right\\}<\\frac{1}{2} \\quad \\forall y \\in S(x) . \\] Now we prove by induction that we can choose a sequence \\(s_{n}\\) of positive integers satisfying (Q6.3) and in addition the fact that every interval of the security region \\(S\\left(s_{n}\\right)\\) contains at least one interval of \\(S\\left(s_{n-1}\\right)\\). To begin with, we choose \\(s_{1}\\) large enough so that the length of the intervals of \\(S\\left(s_{1}\\right)\\) is larger than 1 . This guarantees that any interval of \\(S\\left(s_{1}\\right)\\) contains at least a positive integer. Now let us choose a positive integer \\(s_{2} \\in S\\left(s_{1}\\right)\\) that is large enough. This guarantees that \\(s_{1} / s_{2}\\) is small enough, that the fractional part of \\(s_{2} / s_{1}\\) is in ( \\(t, 1 / 2\\) ), and that every interval of the security region \\(S\\left(s_{2}\\right)\\) contains at least one interval of \\(S\\left(s_{1}\\right)\\), and hence at least one positive integer. Let us now assume that \\(s_{1}, \\ldots, s_{n}\\) have been already chosen with the required properties. We know that every interval of \\(S\\left(s_{n}\\right)\\) contains at least one interval of \\(S\\left(s_{n-1}\\right)\\), which in turn contains an interval in \\(S\\left(s_{n-2}\\right)\\), and so on up to \\(S\\left(s_{1}\\right)\\). As a consequence, we can choose a large enough positive integer \\(s_{n+1}\\) that lies in \\(S\\left(s_{k}\\right)\\) for every \\(k \\in\\{1, \\ldots, n\\}\\). Since \\(s_{n+1}\\) is large enough, we are sure that \\[ \\frac{s_{k}}{s_{n+1}}<t \\quad \\forall k \\in\\{1, \\ldots, n\\} . \\] Moreover, we are sure also that all the intervals of \\(S\\left(s_{n+1}\\right)\\) are large enough, and therefore they contain at least one interval of \\(S\\left(s_{n}\\right)\\), which in turn contains at least one interval of \\(S\\left(s_{n-1}\\right)\\), and so on. Finally, the condition \\[ t<\\left\\{\\frac{s_{n-1}}{s_{n}}\\right\\}<\\frac{1}{2} \\] is guaranteed by the fact that \\(s_{n+1}\\) was chosen in an interval that is contained in \\(S\\left(s_{k}\\right)\\) for every \\(k \\in\\{1, \\ldots, n\\}\\). This completes the induction.", "source_pdf": "egmo_2018.pdf", "notes": ""}
{"id": "EGMO-2019-1", "contest": "EGMO", "year": "2019", "problem_number": "1", "problem": "Find all triples \\((a, b, c)\\) of real numbers such that \\(a b+b c+c a=1\\) and \\[ a^{2} b+c=b^{2} c+a=c^{2} a+b \\]", "solution": "Answer: \\(( \\pm 1 / \\sqrt{3}, \\pm 1 / \\sqrt{3}, \\pm 1 / \\sqrt{3})\\) where the signs correspond, and \\(( \\pm 1, \\pm 1,0)\\) and permutations where the signs correspond. These work and we prove that is all.\n\nWe begin by eliminating the condition via homogenization: the first equality now reads\n\\[ \\begin{aligned} a^{2} b+c[a b+b c+c a] & =b^{2} c+a[a b+b c+c a] \\\\ \\Longleftrightarrow c^{2}(b+a) & =c\\left(b^{2}+a^{2}\\right) \\\\ \\Longleftrightarrow c & =0 \\text { or } a^{2}+b^{2}=c(a+b) \\end{aligned} \\]\n\nCyclic variations hold. So we have two cases.\n- If any of the variables is zero, say \\(a=0\\), then the other two are nonzero. So from \\(b^{2}=b c\\) we get \\(b=c\\) giving \\(( \\pm 1, \\pm 1,0)\\).\n- Now assume all three variables are nonzero, so \\(a^{2}+b^{2}=c(a+b)\\). If we sum cyclically we get\n\\[ 2\\left(a^{2}+b^{2}+c^{2}\\right)=2(a b+b c+c a) \\Longleftrightarrow(a-b)^{2}+(b-c)^{2}+(c-a)^{2}=0 \\]\nwhich forces \\(a=b=c\\) and gives the last solution.", "source_pdf": "egmo_2019.pdf", "notes": ""}
{"id": "EGMO-2019-2", "contest": "EGMO", "year": "2019", "problem_number": "2", "problem": "Let \\(n\\) be a positive integer. Dominoes are placed on a \\(2 n \\times 2 n\\) board in such a way that every cell of the board is (orthogonally) adjacent to exactly one cell covered by a domino. For each \\(n\\), determine the largest number of dominoes that can be placed in this way.", "solution": "The answer is \\(\\binom{n+1}{2}\\) and a construction is shown below.\nFor each domino, its aura consists of all the cells which are adjacent to a cell of the domino. There are up to eight squares in each aura, but some auras could be cut off by the boundary of the board, which means that there could be as few as five squares. So we want to estimate how many auras get cut off.\n\nWe denote by \\(a, b, c, k\\) the number of auras with \\(5,6,7,8\\) cells on the boundary, so we want an upper bound on \\(a+b+c+k\\). Note also that \\(a \\leq 4\\) since such a cell uses a corner of the grid.\n\nThe big observation about the auras on the edge:\nClaim - The auras of type \\(a, b, c\\) have 4,4, and 3-4 cells on the boundary of the grid, respectively. (The boundary is the \\(4(2 n-1)\\) cells touching an edge of the board.)\n\nConsequently, we have a bound \\(4 a+4 b+3 c \\leq 4(2 n-1)\\). On the other hand, we obviously have \\(5 a+6 b+7 c+8 k=4 n^{2}\\). Therefore,\n\\[ \\begin{aligned} 4 n^{2}+2(2 n-1) & \\geq(5 a+6 b+7 c+8 k)+(2 a+2 b+1.5 c) \\\\ & =8(a+b+c+k)+0.5 c-a \\\\ & \\geq 8(a+b+c+k)+0-4 \\\\ \\Longrightarrow \\frac{n(n+1)}{2}+\\frac{1}{4} & \\geq a+b+c+k \\end{aligned} \\]\nwhich implies the desired bound after taking the floor of left-hand side.\n\nRemark. In fact IMO 1999/3 shows the reverse bound: we now give a proof that every tiling in this problem has exactly \\(\\frac{1}{2} n(n+1)\\) dominoes. Color the board as shown below into \"rings\".\n\nEvery aura covers exactly four blue cells. Done.", "source_pdf": "egmo_2019.pdf", "notes": ""}
{"id": "EGMO-2019-3", "contest": "EGMO", "year": "2019", "problem_number": "3", "problem": "Let \\(A B C\\) be a triangle such that \\(\\angle C A B>\\angle A B C\\), and let \\(I\\) be its incenter. Let \\(D\\) be the point on segment \\(B C\\) such that \\(\\angle C A D=\\angle A B C\\). Let \\(\\omega\\) be the circle tangent to \\(A C\\) at \\(A\\) and passing through \\(I\\). Let \\(X\\) be the second point of intersection of \\(\\omega\\) and the circumcircle of \\(A B C\\). Prove that the angle bisectors of \\(\\angle D A B\\) and \\(\\angle C X B\\) intersect at a point on line \\(B C\\).", "solution": "Here is a cross-ratio/trig solution: rare for me to do one of these, but this problem called out to me that way. As usual, let \\(\\alpha=\\angle B A C\\), etc.\n\nLet \\(T\\) be the foot of the bisector of \\(\\angle B A D\\) on \\(\\overline{B D}\\), so that\n\\[ \\frac{T B}{T C}=\\frac{A B \\sin \\angle B A T}{A C \\sin \\angle C A T}=\\frac{A B \\sin \\frac{\\alpha-\\beta}{2}}{A C \\sin \\frac{\\alpha+\\beta}{2}} \\]\n\nAlso, call ( \\(A B C\\) ) by \\(\\Gamma\\) and let ray \\(X I\\) meet \\(\\Gamma\\) again at \\(W\\), meaning that \\(\\angle W X A= \\angle I X A=\\angle I A C=\\frac{\\beta}{2}\\), since we assume \\(\\overline{A C}\\) was tangent to ( \\(I A X\\) ). Thus arc \\(\\widehat{A W}\\) also has measure \\(\\beta\\).\n\nNow,\n\\[ \\begin{aligned} \\frac{X B}{X C} & =-\\left(B C ; X M_{a}\\right)_{\\Gamma} \\stackrel{I}{=}-\\left(M_{b} M_{c} ; W A\\right)_{\\Gamma} \\\\ & =-\\frac{\\sin \\frac{1}{2} \\mathrm{~m} \\widehat{M_{b} W}}{\\sin \\frac{1}{2} \\mathrm{~m} \\widehat{M_{c} W}} \\div \\frac{\\sin \\frac{1}{2} \\mathrm{~m} \\widehat{M_{b} A}}{\\sin \\frac{1}{2} \\mathrm{~m} \\widehat{M_{c} A}}=\\frac{\\sin \\frac{\\alpha-\\beta}{2}}{\\sin \\frac{\\alpha+\\gamma}{2}} \\div \\frac{\\sin \\frac{\\gamma}{2}}{\\sin \\frac{\\beta}{2}} \\end{aligned} \\]\n\nTherefore,\n\\[ \\frac{X B}{X C} \\div \\frac{T B}{T C}=\\frac{\\sin \\frac{\\alpha+\\beta}{2} \\sin \\frac{\\gamma}{2}}{\\sin \\frac{\\alpha+\\gamma}{2} \\sin \\frac{\\beta}{2}} \\div \\frac{A B}{A C}=\\frac{2 \\cos \\frac{\\gamma}{2} \\sin \\frac{\\gamma}{2}}{2 \\cos \\frac{\\beta}{2} \\sin \\frac{\\beta}{2}} \\div \\frac{A B}{A C}=1 \\]\nthe last step being the law of sines \\(A B / A C=\\sin \\gamma / \\sin \\beta\\).", "source_pdf": "egmo_2019.pdf", "notes": ""}
{"id": "EGMO-2019-4", "contest": "EGMO", "year": "2019", "problem_number": "4", "problem": "Let \\(A B C\\) be a triangle with incenter \\(I\\). The circle through \\(B\\) tangent to \\(A I\\) at \\(I\\) meets side \\(A B\\) again at \\(P\\). The circle through \\(C\\) tangent to \\(A I\\) at \\(I\\) meets side \\(A C\\) again at \\(Q\\). Prove that \\(P Q\\) is tangent to the incircle of \\(A B C\\).", "solution": "Let \\(E\\) and \\(F\\) be the tangency points of the incircle on \\(A C\\) and \\(A B\\). By angle chasing,\n\\[ \\angle P I F=\\angle A I F-\\angle A I P=\\left(90^{\\circ}-\\frac{1}{2} \\angle A\\right)-\\frac{1}{2} \\angle B=\\frac{1}{2} \\angle C . \\]\n\nSimilarly, \\(\\angle E I Q=\\frac{1}{2} \\angle B\\).\n\nLet \\(T_{p}, T_{q}\\) denote the second tangency of \\(P, Q\\) to the incircle. Then \\(\\angle E I T_{q}=\\angle B\\) and \\(\\angle T_{p} I F=\\angle C\\). Since \\(\\angle E I F=\\angle B+\\angle C\\), it follows \\(T_{p}=T_{q}\\).\n\nRemark. Notice we really only need \\(\\angle P I Q=90^{\\circ}-\\frac{1}{2} \\angle A\\) by essentially the same argument.", "source_pdf": "egmo_2019.pdf", "notes": ""}
{"id": "EGMO-2019-5", "contest": "EGMO", "year": "2019", "problem_number": "5", "problem": "Let \\(n \\geq 2\\) be an integer, and let \\(a_{1}, a_{2}, \\ldots, a_{n}\\) be positive integers. Show that there exist positive integers \\(b_{1}, b_{2}, \\ldots, b_{n}\\) satisfying the following three conditions:\n(a) \\(a_{i} \\leq b_{i}\\) for \\(i=1,2, \\ldots, n\\);\n(b) the remainders of \\(b_{1}, b_{2}, \\ldots, b_{n}\\) on division by \\(n\\) are pairwise different,\n(c) \\(b_{1}+\\cdots+b_{n} \\leq n\\left(\\frac{n-1}{2}+\\left\\lfloor\\frac{a_{1}+\\cdots+a_{n}}{n}\\right\\rfloor\\right)\\).", "solution": "Note that if \\(a_{i}>n\\), we can replace \\(a_{i}\\) with \\(a_{i}-n\\) and \\(b_{i}\\) with \\(b_{i}-n\\), and nothing changes. So we may as well assume \\(a_{i} \\in\\{1, \\ldots, n\\}\\) for each \\(i\\).\n\nWe choose our \\(b_{i}\\) 's in the following way. Draw an \\(n \\times n\\) grid and in the \\(i\\) th column fill in the bottom \\(a_{i}-1\\) cells red. We can select \\(b_{i}\\) by marking \\(n\\) cells, one in each row or column. If we chose \\(j\\) th lowest row in the \\(i\\) th column, then we would set \\(b_{i}=j\\) on non-red cells and \\(b_{i}=j+n\\) on red cells.\n\nIn this way, define the penalty \\(p\\) as the number of selected cells which are red. Then\n\\[ b_{1}+\\cdots+b_{n}=(1+2+\\cdots+n)+n \\cdot p=n \\cdot \\frac{n-1}{2}+n \\cdot(p+1) . \\]\nand we seek to minimize the penalty \\(p\\).\n\nBut the expected penalty of a random permutation is the red area divided by \\(n\\), which is\n\\[ \\mathbb{E}[p]=\\frac{\\left(a_{1}-1\\right)+\\cdots+\\left(a_{n}-1\\right)}{n} \\]\nand so there exists a choice for which the penalty is at most \\(\\lfloor\\mathbb{E}[p]\\rfloor\\). This gives the required result.\n\nRemark. The visual aid can be excised from the solution; which can then be rewritten more tersely as follows. After assuming \\(1 \\leq a_{i} \\leq n\\) for each \\(n\\), pick a uniformly random\npermutation \\(\\sigma\\) on \\(\\{1, \\ldots, n\\}\\) and define\n\\[ b_{i}= \\begin{cases}n+\\sigma(i) & a_{i}>\\sigma(i) \\\\ \\sigma(i) & \\text { otherwise }\\end{cases} \\]\n\nAs before \\(\\mathbb{E}\\left[e_{\\sigma}\\right]=\\sum_{i=1}^{n} \\frac{a_{i}-1}{n}\\) and the rest is the same.", "source_pdf": "egmo_2019.pdf", "notes": ""}
{"id": "EGMO-2019-6", "contest": "EGMO", "year": "2019", "problem_number": "6", "problem": "On a circle, Alina draws 2019 chords, the endpoints of which are all different. A point is considered marked if it is either\n(i) one of the 4038 endpoints of a chord; or\n(ii) an intersection point of at least two chords.\n\nOf the 4038 points meeting criterion (i), Alina labels 2019 points with a 0 and the other 2019 points with a 1. She labels each point meeting criterion (ii) with an arbitrary integer (not necessarily positive).\n\nAlong each chord, Alina considers the segments connecting two consecutive marked points. (A chord with \\(k\\) marked points has \\(k-1\\) such segments.) She labels each such segment in yellow with the sum of the labels of its two endpoints and in blue with the absolute value of their difference. Alina finds that the \\(N+1\\) yellow labels take each value \\(0,1, \\ldots, N\\) exactly once. Show that at least one blue label is a multiple of 3 .", "solution": "Only the labels mod 3 matter at all.\nAssume for contradiction no blue labels are divisible by 3 . Let \\(e_{i j}\\) denote the number of segments joining \\(i(\\bmod 3)\\) to \\(j(\\bmod 3)\\). By double-counting (noting that points in (ii) are counted an even number of times but points in (i) are counted once) we derive that\n\\[ \\begin{aligned} & e_{01}+e_{02} \\equiv 2019 \\quad(\\bmod 2) \\\\ & e_{01}+e_{12} \\equiv 2019 \\quad(\\bmod 2) \\\\ & e_{02}+e_{12} \\equiv 0 \\quad(\\bmod 2) \\end{aligned} \\]\nwhich gives\n\\[ e_{02} \\equiv e_{12} \\equiv 1-e_{01} \\quad(\\bmod 2) \\]\n\nHowever, one can check this is incompatible with the hypothesis that the yellow labels are \\(0,1, \\ldots, N\\).\n\nRemark. In addition, we can replace the points/segments by any graph \\(G\\) for which there are\n- an odd number of leaves (or just odd-degree vertices) labeled 0 ,\n- an odd number of leaves (or just odd-degree vertices) labeled 1 ,\n- and the remaining vertices have even degree.\n\nThus the geometry of the problem is smoke and mirrors, too.", "source_pdf": "egmo_2019.pdf", "notes": ""}
{"id": "EGMO-2020-1", "contest": "EGMO", "year": "2020", "problem_number": "1", "problem": "The positive integers \\(a_{0}, a_{1}, a_{2}, \\ldots, a_{3030}\\) satisfy \\[ 2 a_{n+2}=a_{n+1}+4 a_{n} \\text { for } n=0,1,2, \\ldots, 3028 \\] Prove that at least one of the numbers \\(a_{0}, a_{1}, a_{2}, \\ldots, a_{3030}\\) is divisible by \\(2^{2020}\\).", "solution": "There are different ways of solving the problem. All of these use some induction argument. Most of these proofs use one of the following two lemmas. In many places, they can be used interchangeably. Lemma. If \\(a, b, c, d\\) are integers with \\(2 c=b+4 a\\) and \\(2 d=c+4 b\\), then \\(4 \\mid b\\). Proof: From \\(2 d=c+4 b\\) we have that \\(c\\) is even, and then from \\(2 c=b+4 a\\) it follows that \\(b\\) is divisible by 4 . Lemma'. For \\(0 \\leq n \\leq 3030\\), denote by \\(v_{n}\\) the largest integer such that \\(2^{v_{n}}\\) divides \\(a_{n}\\). We claim the following: \\[ v_{n+1} \\geq \\min \\left(v_{n}+2, v_{n+2}+1\\right) \\quad \\text { for } n=0,1, \\ldots, 3028 \\] Proof: Let \\(0 \\leq n \\leq 3028\\) and let \\(s=\\min \\left(v_{n}+2, v_{n+2}+1\\right)\\). Then \\(s \\leq v_{n}+2\\) implies \\(2^{s} \\mid 4 a_{n}\\) and \\(s \\leq v_{n+2}+1\\) implies \\(2^{s} \\mid 2 a_{n+2}\\). It follows that \\(a_{n+1}=2 a_{n+2}-4 a_{n}\\) is also divisible by \\(2^{s}\\), hence \\(s \\leq v_{n+1}\\), which proves ( \\(*)\\ ). Here are different ways of working out the induction argument that is crucial in the proofs. [The solution continues with multiple induction arguments and alternatives.]", "source_pdf": "egmo_2020.pdf", "notes": ""}
{"id": "EGMO-2020-2", "contest": "EGMO", "year": "2020", "problem_number": "2", "problem": "Find all lists ( \\(x_{1}, x_{2}, \\ldots, x_{2020}\\) ) of non-negative real numbers such that the following three conditions are all satisfied: (i) \\(x_{1} \\leq x_{2} \\leq \\ldots \\leq x_{2020}\\); (ii) \\(x_{2020} \\leq x_{1}+1\\); (iii) there is a permutation \\(\\left(y_{1}, y_{2}, \\ldots, y_{2020}\\right)\\) of \\(\\left(x_{1}, x_{2}, \\ldots, x_{2020}\\right)\\) such that \\[ \\sum_{i=1}^{2020}\\left(\\left(x_{i}+1\\right)\\left(y_{i}+1\\right)\\right)^{2}=8 \\sum_{i=1}^{2020} x_{i}^{3} . \\] A permutation of a list is a list of the same length, with the same entries, but the entries are allowed to be in any order. For example, ( \\(2,1,2\\) ) is a permutation of ( \\(1,2,2\\) ), and they are both permutations of \\((2,2,1)\\). Note that any list is a permutation of itself.", "solution": "Answer. There are two solutions: \\((\\underbrace{0,0, \\ldots, 0}_{1010}, \\underbrace{1,1, \\ldots, 1}_{1010})\\) and \\((\\underbrace{1,1, \\ldots, 1}_{1010}, \\underbrace{2,2, \\ldots, 2}_{1010})\\). Solution A. We first prove the inequality \\[ ((x+1)(y+1))^{2} \\geq 4\\left(x^{3}+y^{3}\\right) \\] for real numbers \\(x, y \\geq 0\\) satisfying \\(|x-y| \\leq 1\\), with equality if and only if \\(\\{x, y\\}=\\{0,1\\}\\) or \\(\\{x, y\\}=\\{1,2\\}\\). Indeed, \\[ \\begin{aligned} 4\\left(x^{3}+y^{3}\\right) & =4(x+y)\\left(x^{2}-x y+y^{2}\\right) \\\\ & \\leq\\left((x+y)+\\left(x^{2}-x y+y^{2}\\right)\\right)^{2} \\\\ & =\\left(x y+x+y+(x-y)^{2}\\right)^{2} \\\\ & \\leq(x y+x+y+1)^{2} \\\\ & =((x+1)(y+1))^{2}, \\end{aligned} \\] where the first inequality follows by applying the AM-GM inequality on \\(x+y\\) and \\(x^{2}-x y+y^{2}\\) (which are clearly nonnegative). Equality holds in the first inequality precisely if \\(x+y= x^{2}-x y+y^{2}\\) and in the second one if and only if \\(|x-y|=1\\). Combining these equalities we have \\(x+y=(x-y)^{2}+x y=1+x y\\) or \\((x-1)(y-1)=0\\), which yields the solutions \\(\\{x, y\\}=\\{0,1\\}\\) or \\(\\{x, y\\}=\\{1,2\\}\\). Now, let \\(\\left(x_{1}, x_{2}, \\ldots, x_{2020}\\right)\\) be any sequence satisfying conditions (i) and (ii) and let \\(\\left(y_{1}, y_{2}, \\ldots, y_{2020}\\right)\\) be any permutation of \\(\\left(x_{1}, x_{2}, \\ldots, x_{2020}\\right)\\). As \\(0 \\leq \\min \\left(x_{i}, y_{i}\\right) \\leq \\max \\left(x_{i}, y_{i}\\right) \\leq \\min \\left(x_{i}, y_{i}\\right)+1\\), we can applying inequality (1) to the pair ( \\(x_{i}, y_{i}\\) ) and sum over all \\(1 \\leq i \\leq 2020\\) to conclude that \\[ \\sum_{i=1}^{2020}\\left(\\left(x_{i}+1\\right)\\left(y_{i}+1\\right)\\right)^{2} \\geq 4 \\sum_{i=1}^{2020}\\left(x_{i}^{3}+y_{i}^{3}\\right)=8 \\sum_{i=1}^{2020} x_{i}^{3} . \\] Therefore, in order to satisfy condition (iii), every inequality must be an equality. Hence, for every \\(1 \\leq i \\leq 2020\\) we must have \\(\\left\\{x_{i}, y_{i}\\right\\}=\\{0,1\\}\\) or \\(\\left\\{x_{i}, y_{i}\\right\\}=\\{1,2\\}\\). By condition (ii), we see that either \\(\\left\\{x_{i}, y_{i}\\right\\}=\\{0,1\\}\\) for all \\(i\\) or \\(\\left\\{x_{i}, y_{i}\\right\\}=\\{1,2\\}\\) for all \\(i\\). If \\(\\left\\{x_{i}, y_{i}\\right\\}=\\{0,1\\}\\) for every \\(1 \\leq i \\leq 2020\\), this implies that the sequences \\(\\left(x_{1}, x_{2}, \\ldots, x_{2020}\\right)\\) and ( \\(y_{1}, y_{2}, \\ldots, y_{2020}\\) ) together have 2020 zeroes and 2020 ones. As ( \\(y_{1}, y_{2}, \\ldots, y_{2020}\\) ) is a permutation of \\(\\left(x_{1}, x_{2}, \\ldots, x_{2020}\\right)\\) this implies that \\(\\left(x_{1}, x_{2}, \\ldots, x_{2020}\\right)=(0,0, \\ldots, 0,1,1, \\ldots, 1)\\) with 1010 zeroes and 1010 ones. Conversely, note that this sequence satisfies conditions (i), (ii), and (iii) (in (iii), we take \\(\\left(y_{1}, y_{2}, \\ldots, y_{2020}\\right)=\\left(x_{2020}, x_{2019}, \\ldots, x_{1}\\right)\\) ), showing that this sequence indeed works. The same reasoning holds for the case that \\(\\left\\{x_{i}, y_{i}\\right\\}=\\{1,2\\}\\) for all \\(i\\).", "source_pdf": "egmo_2020.pdf", "notes": ""}
{"id": "EGMO-2020-3", "contest": "EGMO", "year": "2020", "problem_number": "3", "problem": "Let \\(A B C D E F\\) be a convex hexagon such that \\(\\angle A=\\angle C=\\angle E\\) and \\(\\angle B=\\angle D= \\angle F\\) and the (interior) angle bisectors of \\(\\angle A, \\angle C\\), and \\(\\angle E\\) are concurrent. Prove that the (interior) angle bisectors of \\(\\angle B, \\angle D\\), and \\(\\angle F\\) must also be concurrent. Note that \\(\\angle A=\\angle F A B\\). The other interior angles of the hexagon are similarly described.", "solution": "Solution A. Denote the angle bisector of \\(A\\) by \\(a\\) and similarly for the other bisectors. Thus, given that \\(a, c, e\\) have a common point \\(M\\), we need to prove that \\(b, d, f\\) are concurrent. We write \\(\\angle(x, y)\\) for the value of the directed angle between the lines \\(x\\) and \\(y\\), i.e. the angle of the counterclockwise rotation from \\(x\\) to \\(y\\left(\\right.\\) defined \\(\\left(\\bmod 180^{\\circ}\\right)\\right)\\). Since the sum of the angles of a convex hexagon is \\(720^{\\circ}\\), from the angle conditions we get that the sum of any two consecutive angles is equal to \\(240^{\\circ}\\). In particular, it now follows that \\(\\angle(b, a)=\\angle(c, b)=\\angle(d, c)=\\angle(e, d)=\\angle(f, e)=\\angle(a, f)=60^{\\circ}\\) (assuming the hexagon is clockwise oriented). Let \\(X=A B \\cap C D, Y=C D \\cap E F\\) and \\(Z=E F \\cap A B\\). Similarly, let \\(P=B C \\cap D E, Q=D E \\cap F A\\) and \\(R=F A \\cap B C\\). From \\(\\angle B+\\angle C=240^{\\circ}\\) it follows that \\(\\angle(Z X, X Y)=\\angle(B X, X C)=60^{\\circ}\\). Similarly we have \\(\\angle(X Y, Y Z)=\\angle(Y Z, Z X)=60^{\\circ}\\), so triangle \\(X Y Z\\) (and similarly triangle \\(P Q R\\) ) is equilateral. We see that the hexagon \\(A B C D E F\\) is obtained by intersecting the two equilateral triangles \\(X Y Z\\) and \\(P Q R\\). We have \\(\\angle(A M, M C)=\\angle(a, c)=\\angle(a, b)+\\angle(b, c)=60^{\\circ}\\), and since \\[ \\angle(A M, M C)=\\angle(A X, X C)=\\angle(A R, R C)=60^{\\circ}, \\] \\(A, C, M, X, R\\) are concyclic. Because \\(M\\) lies on the bisector of angle \\(\\angle X A R\\), we must have \\(M R=M X\\), so triangle \\(M R X\\) is isosceles. Moreover, we have \\(\\angle(M R, M X)=\\angle(C R, C X)= \\angle(B C, C D)\\), which is angle \\(C\\) of the hexagon. We now see that the triangles \\(M R X, M P Y\\) and \\(M Q Z\\) are isosceles and similar. This implies that there is a rotation centered at \\(M\\) that sends \\(X, Y\\) and \\(Z\\) to \\(R, P\\) and \\(Q\\) respectively. In particular, the equilateral triangles \\(X Y Z\\) and \\(P Q R\\) are congruent. It follows that there also exists a rotation sending \\(X, Y, Z\\) to \\(P, Q, R\\) respectively. Define \\(N\\) as the center of this rotation. Triangles \\(N X Z\\) and \\(N P R\\) are congruent and equally oriented, hence \\(N\\) is equidistant from \\(X Z\\) and \\(P R\\) and lies on the inner bisector \\(b\\) of \\(\\angle B\\) (we know \\(N\\) lies on the inner, not the outer bisector because the rotation centered at \\(N\\) is clockwise). In the same way we can show that \\(N\\) is on \\(d\\) and on \\(f\\), so \\(b, d, f\\) are concurrent at \\(N\\).", "source_pdf": "egmo_2020.pdf", "notes": ""}
{"id": "EGMO-2020-4", "contest": "EGMO", "year": "2020", "problem_number": "4", "problem": "A permutation of the integers \\(1,2, \\ldots, m\\) is called fresh if there exists no positive integer \\(k<m\\) such that the first \\(k\\) numbers in the permutation are \\(1,2, \\ldots, k\\) in some order. Let \\(f_{m}\\) be the number of fresh permutations of the integers \\(1,2, \\ldots, m\\). Prove that \\(f_{n} \\geq n \\cdot f_{n-1}\\) for all \\(n \\geq 3\\). For example, if \\(m=4\\), then the permutation ( \\(3,1,4,2\\) ) is fresh, whereas the permutation (2, 3, 1, 4) is not.", "solution": "Solution A. Let \\(\\sigma=\\left(\\sigma_{1}, \\ldots, \\sigma_{n-1}\\right)\\) be a fresh permutation of the integers \\(1,2, \\ldots, n-1\\). We claim that for any \\(1 \\leq i \\leq n-1\\) the permutation \\[ \\sigma^{(i)}=\\left(\\sigma_{1}, \\ldots, \\sigma_{i-1}, n, \\sigma_{i}, \\ldots, \\sigma_{n-1}\\right) \\] is a fresh permutation of the integers \\(1,2, \\ldots, n\\). Indeed, let \\(1 \\leq k \\leq n-1\\). If \\(k \\geq i\\) then we have \\(n \\in\\left\\{\\sigma_{1}^{(i)}, \\ldots, \\sigma_{k}^{(i)}\\right\\}\\), but \\(n \\notin\\{1,2, \\ldots, k\\}\\). And if \\(k<i\\) we have \\(k<n-1\\), and \\(\\left\\{\\sigma_{1}^{(i)}, \\ldots, \\sigma_{k}^{(i)}\\right\\}=\\left\\{\\sigma_{1}, \\ldots, \\sigma_{k}\\right\\} \\neq\\{1,2, \\ldots, k\\}\\), since \\(\\sigma\\) is fresh. Moreover, it is easy to see that when we apply this construction to all fresh permutations of \\(1,2, \\ldots, n-1\\), we obtain \\((n-1) \\cdot f_{n-1}\\) distinct fresh permutations of \\(1,2, \\ldots, n\\). Note that a fresh permutation of \\(1,2, \\ldots, n-1\\) cannot end in \\(n-1\\), and hence none of the previously constructed fresh permutations of \\(1,2, \\ldots, n\\) will end in \\(n-1\\) either. Therefore, we will complete the proof by finding \\(f_{n-1}\\) fresh permutations of \\(1,2, \\ldots, n\\) that end in \\(n-1\\). To do this, let \\(\\sigma=\\left(\\sigma_{1}, \\ldots, \\sigma_{n-1}\\right)\\) be a fresh permutation of \\(1,2, \\ldots, n-1\\) and let \\(j\\) be such that \\(\\sigma_{j}=n-1\\). Define \\[ \\sigma^{\\prime}=\\left(\\sigma_{1}, \\ldots, \\sigma_{j-1}, n, \\sigma_{j+1}, \\ldots, \\sigma_{n-1}, n-1\\right), \\] then clearly \\(\\sigma^{\\prime}\\) is a permutation of \\(1,2, \\ldots, n\\) that ends in \\(n-1\\). We show that \\(\\sigma^{\\prime}\\) is fresh, so let \\(1 \\leq k \\leq n-1\\). If \\(k \\geq j\\) then \\(n \\in\\left\\{\\sigma_{1}^{\\prime}, \\ldots, \\sigma_{k}^{\\prime}\\right\\}\\) but \\(n \\notin\\{1,2, \\ldots, k\\}\\); if \\(k<j\\), then \\(k<n-1\\) and \\(\\left\\{\\sigma_{1}^{\\prime}, \\ldots, \\sigma_{k}^{\\prime}\\right\\}=\\left\\{\\sigma_{1}, \\ldots, \\sigma_{k}\\right\\} \\neq\\{1,2, \\ldots, k\\}\\), since \\(\\sigma\\) is fresh. So we have constructed \\(f_{n-1}\\) additional fresh permutations of \\(1,2, \\ldots, n\\) (which again are all different), and the total number \\(f_{n}\\) of fresh permutations of \\(1,2, \\ldots, n\\) must at least be \\((n-1) f_{n-1}+f_{n-1}=n f_{n-1}\\), as required.", "source_pdf": "egmo_2020.pdf", "notes": ""}
{"id": "EGMO-2020-5", "contest": "EGMO", "year": "2020", "problem_number": "5", "problem": "Consider the triangle \\(A B C\\) with \\(\\angle B C A>90^{\\circ}\\). The circumcircle \\(\\Gamma\\) of \\(A B C\\) has radius \\(R\\). There is a point \\(P\\) in the interior of the line segment \\(A B\\) such that \\(P B=P C\\) and the length of \\(P A\\) is \\(R\\). The perpendicular bisector of \\(P B\\) intersects \\(\\Gamma\\) at the points \\(D\\) and \\(E\\). Prove that \\(P\\) is the incentre of triangle \\(C D E\\).", "solution": "Solution A. The angle bisector of \\(\\angle E C D\\) intersects the circumcircle of \\(C D E\\) (which is \\(\\Gamma\\) ) at the midpoint \\(M\\) of arc \\(D B E\\). It is well-known that the incentre is the intersection of the angle bisector segment \\(C M\\) and the circle with centre at \\(M\\) and passing through \\(D, E\\). We will verify this property for \\(P\\). By the conditions we have \\(A P=O A=O B=O C=O D=O E=R\\). Both lines \\(O M\\) and \\(A P B\\) are perpendicular to \\(E D\\), therefore \\(A P \\| O M\\); in the quadrilateral \\(A O M P\\) we have \\(A P=O A=A M=R\\) and \\(A P \\| O M\\), so \\(A O M P\\) is a rhombus and its fourth side is \\(P M=R\\). In the convex quadrilateral \\(O M B P\\) we have \\(O M \\| P B\\), so \\(O M B P\\) is a symmetric trapezoid; the perpendicular bisector of its bases \\(A O\\) and \\(P B\\) coincide. From this symmetry we obtain \\(M D=O D=R\\) and \\(M E=O E=R\\). (Note that the triangles \\(O E M\\) ad \\(O M D\\) are equilateral.) We already have \\(M P=M D=M E=R\\), so \\(P\\) indeed lies on the circle with center \\(M\\) and passing through \\(D, E\\). (Notice that this circle is the reflection of \\(\\Gamma\\) about \\(D E\\).) From \\(P B=P C\\) and \\(O B=O C\\) we know that \\(B\\) and \\(C\\) are symmetrical about \\(O P\\); from the rhombus \\(A O M P\\) we find that \\(A\\) and \\(M\\) are also symmetrical about \\(O P\\). By reflecting the collinear points \\(B, P, A\\) (with \\(P\\) lying in the middle) we get that \\(C, P, M\\) are collinear (and \\(P\\) is in the middle). Hence, \\(P\\) lies on the line segments \\(C M\\).", "source_pdf": "egmo_2020.pdf", "notes": ""}
{"id": "EGMO-2020-6", "contest": "EGMO", "year": "2020", "problem_number": "6", "problem": "Let \\(m>1\\) be an integer. A sequence \\(a_{1}, a_{2}, a_{3}, \\ldots\\) is defined by \\(a_{1}=a_{2}=1\\), \\(a_{3}=4\\), and for all \\(n \\geq 4\\), \\[ a_{n}=m\\left(a_{n-1}+a_{n-2}\\right)-a_{n-3} \\] Determine all integers \\(m\\) such that every term of the sequence is a square.", "solution": "Answer. The only such \\(m\\) are \\(m=2\\) and \\(m=10\\). Solution A. Consider an integer \\(m>1\\) for which the sequence defined in the problem statement contains only perfect squares. We shall first show that \\(m-1\\) is a power of 3 . Suppose that \\(m-1\\) is even. Then \\(a_{4}=5 m-1\\) should be divisible by 4 and hence \\(m \\equiv 1(\\bmod 4)\\). But then \\(a_{5}=5 m^{2}+3 m-1 \\equiv 3(\\bmod 4)\\) cannot be a square, a contradiction. Therefore \\(m-1\\) is odd. Suppose that an odd prime \\(p \\neq 3\\) divides \\(m-1\\). Note that \\(a_{n}-a_{n-1} \\equiv a_{n-2}-a_{n-3}(\\bmod p)\\). It follows that modulo \\(p\\) the sequence takes the form \\(1,1,4,4,7,7,10,10, \\ldots\\); indeed, a simple induction shows that \\(a_{2 k} \\equiv a_{2 k-1} \\equiv 3 k-2(\\bmod p)\\) for \\(k \\geq 1\\). Since \\(\\operatorname{gcd}(p, 3)=1\\) we get that the sequence \\(a_{n}(\\bmod p)\\) contains all the residues modulo \\(p\\), a contradiction since only \\((p+1) / 2\\) residues modulo \\(p\\) are squares. This shows that \\(m-1\\) is a power of 3 . Let \\(h, k\\) be integers such that \\(m=3^{k}+1\\) and \\(a_{4}=h^{2}\\). We then have \\(5 \\cdot 3^{k}=(h-2)(h+2)\\). Since \\(\\operatorname{gcd}(h-2, h+2)=1\\), it follows that \\(h-2\\) equals either \\(1,3^{k}\\) or 5 , and \\(h+2\\) equals either \\(5 \\cdot 3^{k}, 5\\) or \\(3^{k}\\), respectively. In the first two cases we get \\(k=0\\) and in the last case we get \\(k=2\\). This implies that either \\(m=2\\) or \\(m=10\\). We now show the converse. Suppose that \\(m=2\\) or \\(m=10\\). Let \\(t=1\\) or \\(t=3\\) so that \\(m=t^{2}+1\\). Let \\(b_{1}, b_{2}, b_{3}, \\ldots\\) be a sequence of integers defined by \\(b_{1}=1, b_{2}=1, b_{3}=2\\), and \\[ b_{n}=t b_{n-1}+b_{n-2}, \\quad \\text { for all } n \\geq 4 . \\] Clearly, \\(a_{n}=b_{n}^{2}\\) for \\(n=1,2,3\\). Note that if \\(m=2\\) then \\(a_{4}=9\\) and \\(b_{4}=3\\), and if \\(m=10\\) then \\(a_{4}=49\\) and \\(b_{4}=7\\). In both the cases we have \\(a_{4}=b_{4}^{2}\\). If \\(n \\geq 5\\) then we have \\[ b_{n}^{2}+b_{n-3}^{2}=\\left(t b_{n-1}+b_{n-2}\\right)^{2}+\\left(b_{n-1}-t b_{n-2}\\right)^{2}=\\left(t^{2}+1\\right)\\left(b_{n-1}^{2}+b_{n-2}^{2}\\right)=m\\left(b_{n-1}^{2}+b_{n-2}^{2}\\right) . \\] Therefore, it follows by induction that \\(a_{n}=b_{n}^{2}\\) for all \\(n \\geq 1\\). This completes the solution.", "source_pdf": "egmo_2020.pdf", "notes": ""}
{"id": "EGMO-2021-1", "contest": "EGMO", "year": "2021", "problem_number": "1", "problem": "According to Anna, the number 2021 is fantabulous. She states that if any element of the set \\(\\{m, 2 m+1,3 m\\}\\) is fantabulous for a positive integer \\(m\\), then they are all fantabulous. Is the number \\(2021^{2021}\\) fantabulous?", "solution": "Consider the sequence of positive integers \\(m, 3 m, 6 m+1,12 m+3,4 m+1,2 m\\). Since each number in the sequence is fantabulous if and only if the next one is, we deduce that \\(m\\) is fantabulous if and only if \\(2 m\\) is fantabulous.\n\nCombined with the fact that \\(m\\) is fantabulous if and only if \\(2 m+1\\) is fantabulous, this implies that \\(m>1\\) is fantabulous if and only if \\(f(m)=\\left[\\frac{m}{2}\\right]\\) is fantabulous. We can apply \\(f\\) sufficiently many times to any positive integer \\(n\\) to conclude that \\(n\\) is fantabulous if and only if 1 is fantabulous. Therefore, the fact that 2021 is fantabulous implies that 1 is fantabulous, which in turn implies that \\(2021^{2021}\\) is fantabulous.", "source_pdf": "egmo_2021.pdf", "notes": ""}
{"id": "EGMO-2021-2", "contest": "EGMO", "year": "2021", "problem_number": "2", "problem": "Find all functions \\(f: \\mathbb{Q} \\rightarrow \\mathbb{Q}\\) such that the equation\n\\[\nf(x f(x)+y)=f(y)+x^{2}\n\\]\nholds for all rational numbers \\(x\\) and \\(y\\). Here, \\(\\mathbb{Q}\\) denotes the set of rational numbers.", "solution": "Denote the equation from the statement by (1). Let \\(x f(x)=A\\) and \\(x^{2}=B\\). The equation (1) is of the form\n\\[\nf(A+y)=f(y)+B\n\\]\n\nAlso, if we put \\(y \\rightarrow-A+y\\), we have \\(f(A-A+y)=f(-A+y)+B\\). Therefore\n\\[\nf(-A+y)=f(y)-B\n\\]\n\nWe can easily show that for any integer \\(n\\) we even have\n\\[\nf(n A+y)=f(y)+n B\n\\]\n\nIndeed, it's trivially true for \\(n=0\\) and if this holds true for some integer \\(n\\), then\n\\[\nf((n+1) A+y)=f(A+y+n A)=f(n y+A)+B=f(y)+n B+B=f(y)+(n+1) B\n\\]\nand\n\\[\nf((n-1) A+y)=f(-A+n A+y)=f(n A+y)-B=f(y)+n B-B=f(y)+(n-1) B .\n\\]\n\nSo, equation (2) follows from the induction on \\(n\\).\nNow we can say that for any integer \\(k\\) it holds\n\\[\nf(n x f(x)+y)=f(y)+n x^{2}\n\\]\n\nIf \\(y\\) is given, then \\(f(y)+n x^{2}\\) can be any rational number, since \\(n x^{2}\\) can be any rational number. If it is supposed to be \\(\\frac{p}{q}\\), where \\(q \\neq 0\\), then we may take \\(n=p q\\), and \\(x=\\frac{1}{q}\\). Therefore \\(f\\) is surjective on \\(\\mathbb{Q}\\). So there's a rational number \\(c\\) such that \\(f(c)=0\\). Be putting \\(x=c\\) into (1) we immediately get \\(c=0\\), i.e. \\(f(0)=0\\). Therefore, \\(f(x)=0\\) if and only if \\(x=0\\).\nFor any integer \\(n\\) and for any rational \\(x, y\\) it holds\n\\[\nf\\left(n^{2} x f(x)+y\\right)=f(y)+n^{2} x^{2}=f(y)+(n x)^{2}=f(n x f(n x)+y)\n\\]\n\nAfter taking \\(y=-n x f(n x)\\) in (4), the right-hand side becomes 0 , therefore\n\\[\nn^{2} x f(x)-n x f(n x)=0\n\\]\n\nThis simplifies into \\(n f(x)=f(n x)\\) for \\(x \\neq 0\\), but it also holds for \\(x=0\\). Therefore, for any rational number \\(x=\\frac{p}{q}\\) we have,\n\\[\nf(x)=f\\left(\\frac{p}{q}\\right)=f\\left(p \\cdot \\frac{1}{q}\\right)=p \\cdot f\\left(\\frac{1}{p}\\right)=p \\cdot \\frac{f\\left(q \\cdot \\frac{1}{q}\\right)}{q}=\\frac{p}{q} \\cdot f(1)=x f(1)\n\\]\n\nSo, we have \\(f(x)=k x\\), for some rational number \\(k\\). Let's put this answer in (1) and we get \\(k(x k x+y)=k y+x^{2}\\), thus \\(k^{2}=1\\). Therefore \\(f(x)=x\\) and \\(f(x)=-x\\) are solutions.", "source_pdf": "egmo_2021.pdf", "notes": ""}
{"id": "EGMO-2021-3", "contest": "EGMO", "year": "2021", "problem_number": "3", "problem": "Let \\(A B C\\) be a triangle with an obtuse angle at \\(A\\). Let \\(E\\) and \\(F\\) be the intersections of the external bisector of angle \\(A\\) with the altitudes of ABC through \\(B\\) and \\(C\\) respectively. Let \\(M\\) and \\(N\\) be the points on the segments \\(E C\\) and \\(F B\\) respectively such that \\(\\angle E M A=\\angle B C A\\) and \\(\\angle A N F=\\angle A B C\\). Prove that the points \\(E, F, N, M\\) lie on a circle.", "solution": "The first solution is based on the main Lemma. We present this Lemma with two different proofs.\nLemma: Let \\(A B C\\) be an acute triangle with \\(A B=B C\\). Let \\(P\\) be any point on \\(A C\\). Line passing through \\(P\\) perpendicular to \\(A B\\), intersects ray \\(B C\\) in point \\(T\\). If the line \\(A T\\) intersects the circumscribed circle of the triangle \\(A B C\\) the second time at point \\(K\\), then \\(\\angle A K P=\\angle A B P\\).\n\nProof 1:\n\nLet \\(H\\) be the orthocenter of the triangle \\(A B P\\). Then\n\\[\n\\angle B H P=180^{\\circ}-\\angle B A C=180^{\\circ}-\\angle B C P .\n\\]\n\nSo \\(B H P C\\) is cyclic. Then we get\n\\[\nT K \\cdot T A=T C \\cdot T B=T P \\cdot T H .\n\\]\n\nSo, \\(A H P K\\) is also cyclic. But then\n\\[\n\\angle A K P=180^{\\circ}-\\angle A H P=\\angle A B P .\n\\]\n\nProof 2:\n\nConsider the symmetric points \\(B^{\\prime}\\) and \\(C^{\\prime}\\) of \\(B\\) and \\(C\\), respectively, with respect to the line \\(P T\\). It is clear that\n\\[\n\\mathrm{TC}^{\\prime} \\cdot T B^{\\prime}=T C \\cdot T B=T K \\cdot T A\n\\]\n\nSo \\(B^{\\prime} C^{\\prime} K A\\) is cyclic. Also, because of the symmetry we have\n\\[\n\\angle P C^{\\prime} B^{\\prime}=\\angle P C B=\\angle P A B\n\\]\n\nSo \\(B^{\\prime} C^{\\prime} P A\\) is also cyclic. Therefore, the points \\(B^{\\prime}, C^{\\prime}, K, P\\) and \\(A\\) all lie on the common circle. Because of this fact and because of the symmetry again we have\n\\[\n\\angle P K A=\\angle P B^{\\prime} A=\\angle P B A .\n\\]\n\nSo, lemma is proved and now return to the problem.\n\nLet \\(H\\) be intersection point of the altitudes at \\(B\\) and \\(C\\). Denote by \\(M^{\\prime}\\) and \\(N^{\\prime}\\) the intersection points of the circumcircle of the triangle \\(H E F\\) with the segments \\(E C\\) and \\(F B\\), respectively. We are going to show that \\(M=M^{\\prime}\\) and \\(N=N^{\\prime}\\) and it will prove the points \\(E, F, N, M\\) lie on a common circle.\n\nOf course, \\(A\\) is an orthocenter of the triangle \\(B C H\\). Therefore \\(\\angle B H A=\\angle B C A, \\angle C H A=\\angle C B A\\) and \\(\\angle H B A=\\angle H C A\\). Thus\n\\[\n\\angle H E F=\\angle H B A+\\angle E A B=\\angle H C A+\\angle F A C=\\angle H F E .\n\\]\n\nSo, the triangle \\(H E F\\) is isosceles, \\(H E=H F\\).\nBy using lemma, we get\n\\[\n\\angle A M^{\\prime} E=\\angle A H E=\\angle A C B\n\\]\nand\n\\[\n\\angle A N^{\\prime} F=\\angle A H F=\\angle A B C .\n\\]\n\nTherefore \\(M=M^{\\prime}\\) and \\(N=N^{\\prime}\\) and we are done.", "source_pdf": "egmo_2021.pdf", "notes": ""}
{"id": "EGMO-2021-4", "contest": "EGMO", "year": "2021", "problem_number": "4", "problem": "Let \\(A B C\\) be a triangle with incentre I and let \\(D\\) be an arbitrary point on the side \\(B C\\). Let the line through \\(D\\) perpendicular to \\(B I\\) intersect \\(C I\\) at \\(E\\). Let the line through \\(D\\) perpendicular to \\(C I\\) intersect \\(B I\\) at \\(F\\). Prove that the reflection of \\(A\\) in the line \\(E F\\) lies on the line \\(B C\\).", "solution": "Let us consider the case when \\(I\\) lies inside of triangle \\(E F D\\). For the other cases the proof is almost the same only with the slight difference.\n\nWe are going to prove that the intersection point of the circumcircles of \\(A E C\\) and \\(A F B\\) (denote it by \\(T\\) ) lies on the line \\(B C\\) and this point is the symmetric point of \\(A\\) with respect to \\(E F\\). First of all we prove that \\(A E I F\\) is cyclic, which implies that \\(T\\) lies on the line \\(B C\\), because\n\nDenote by \\(N\\) an intersection point of the lines \\(D F\\) and \\(A C\\). Of course \\(N\\) is the symmetric point with respect to \\(C I\\). Thus, \\(\\angle I N A=\\angle I D B\\). Also,\n\\[\n\\angle I F D=\\angle N D C-\\angle I B C=90^{\\circ}-\\angle I C B-\\angle I B C=\\angle I A N .\n\\]\n\nSo, we get that \\(A, I, N\\) and \\(F\\) lie on a common circle. Therefore, we have \\(\\angle A F I=\\angle I N A=\\angle I D B\\). Analogously, \\(\\angle A E I=\\angle I D C\\) and we have\n\\[\n\\angle A F I+\\angle A E I=\\angle I D B+\\angle I D C\n\\]\n\nSo \\(\\angle A F I+\\angle A E I=180^{\\circ}\\), thus \\(A E I F\\) is cyclic and \\(T\\) lies on the line \\(B C\\).\n\nBecause \\(E C\\) bisects the angle \\(A C B\\) and \\(A E T C\\) is cyclic we get \\(E A=E T\\). Because of the similar reasons we have \\(F A=F T\\). Therefore \\(T\\) is the symmetric point of \\(A\\) with respect to the line \\(E F\\) and it lies on the line \\(B C\\).", "source_pdf": "egmo_2021.pdf", "notes": ""}
{"id": "EGMO-2021-5", "contest": "EGMO", "year": "2021", "problem_number": "5", "problem": "A plane has a special point \\(O\\) called the origin. Let \\(P\\) be a set of 2021 points in the plane, such that (i) no three points in \\(P\\) lie on a line and (ii) no two points in \\(P\\) lie on a line through the origin. A triangle with vertices in \\(P\\) is fat, if \\(O\\) is strictly inside the triangle. Find the maximum number of fat triangles.", "solution": "We will count minimal number of triangles that are not fat. Let \\(F\\) set of fat triangles, and \\(S\\) set of triangles that are not fat. If triangle \\(X Y Z \\in S\\), we call \\(X\\) and \\(Z\\) good vertices if \\(O Y\\) is located between \\(O X\\) and \\(O Z\\). For \\(A \\in P\\) let \\(S_{A} \\subseteq S\\) be set of triangles in \\(S\\) for which \\(A\\) is one of the good vertex.\n\nIt is easy to see that\n\\[\n2|S|=\\sum_{A \\in P}\\left|S_{A}\\right|\n\\]\n\nFor \\(A \\in P\\), let \\(R_{A} \\subset P\\) and \\(L_{A} \\subset P\\) be parts of \\(P \\backslash\\{A\\}\\) divided by \\(A O\\). Suppose for \\(A X Y \\in S\\) vertex \\(A\\) is good, then clearly \\(X, Y \\in R_{A}\\) or \\(X, Y \\in L_{A}\\). On the other hand, if \\(X, Y \\in R_{A}\\) or \\(X, Y \\in L_{A}\\) then clearly \\(A X Y \\in S\\) and \\(A\\) is its good vertex. Therefore,\n\\[\n\\left|S_{A}\\right|=\\binom{\\left|R_{A}\\right|}{2}+\\binom{\\left|L_{A}\\right|}{2}\n\\]\n\nIt is easy to show following identity:\n\\[\n\\frac{x(x-1)}{2}+\\frac{y(y-1)}{2}-2 \\cdot \\frac{\\frac{x+y}{2}\\left(\\frac{x+y}{2}-1\\right)}{2}=\\frac{(x-y)^{2}}{4}\n\\]\n\nBy using (2) and (3) we get\n\\[\n\\left|S_{A}\\right| \\geq 2 \\cdot\\left(\\frac{\\frac{\\left|R_{A}\\right|+\\left|L_{A}\\right|}{2}}{2}\\right)=2 \\cdot\\binom{1010}{2}=1010 \\cdot 1009\n\\]\nand the equality holds when \\(\\left|R_{A}\\right|=\\left|L_{A}\\right|=1010\\). Hence\n\\[\n|S|=\\frac{\\sum_{A \\in P}\\left|S_{A}\\right|}{2} \\geq \\frac{2021 \\cdot 1010 \\cdot 1009}{2}=2021 \\cdot 505 \\cdot 1009 .\n\\]\n\nTherefore,\n\\[\n|F|=\\binom{2021}{3}-|S| \\leq 2021 \\cdot 1010 \\cdot 673-2021 \\cdot 505 \\cdot 1009=2021 \\cdot 505 \\cdot 337 .\n\\]\n\nFor configuration of points on regular 2021-gon which is centered at \\(O\\), inequalities in (4), (5), (6) become equalities. Hence \\(2021 \\cdot 505 \\cdot 337\\) is indeed the answer.", "source_pdf": "egmo_2021.pdf", "notes": ""}
{"id": "EGMO-2021-6", "contest": "EGMO", "year": "2021", "problem_number": "6", "problem": "Does there exist a nonnegative integer \\(a\\) for which the equation\n\\[\n\\left\\lfloor\\frac{m}{1}\\right\\rfloor+\\left\\lfloor\\frac{m}{2}\\right\\rfloor+\\left\\lfloor\\frac{m}{3}\\right\\rfloor+\\cdots+\\left\\lfloor\\frac{m}{m}\\right\\rfloor=n^{2}+a\n\\]\nhas more than one million different solutions ( \\(m, n\\) ) where \\(m\\) and \\(n\\) are positive integers?\n(The expression \\(\\lfloor x\\rfloor\\) denotesthe integer part(orfloor) of the real number x. Thus \\(\\lfloor\\sqrt{2}\\rfloor=1,\\lfloor\\pi\\rfloor=\\left\\lfloor\\frac{22}{7}\\right\\rfloor=\\) 3 , \\(\\lfloor 42\\rfloor=42\\) and \\(\\lfloor 0\\rfloor=0\\) )", "solution": "Denote the equation from the statement by (1). The left hand side of (1) depends only on \\(m\\), and will throughout be denoted by \\(L(m)\\). Fix an integer \\(q>10^{7}\\) and note that for \\(m=q^{3}\\)\n\\[\nL\\left(q^{3}\\right)=\\sum_{k=1}^{q^{3}}\\left[\\frac{q^{3}}{k}\\right] \\leq \\sum_{k=1}^{q^{3}} \\frac{q^{3}}{k} \\leq q^{3} \\cdot \\sum_{k=1}^{q^{3}} \\frac{1}{k} \\leq q^{3} \\cdot q=q^{4}\n\\]\n\nIndeed, the first inequality results from \\([x] \\leq x\\). The second inequality can be seen (for instance) as follows. We divide the terms in the sum \\(\\sum_{k=1}^{q^{3}} \\frac{1}{k}\\) into several groups: For \\(j \\geq 0\\), the \\(j\\)-th group contains the \\(2^{j}\\) consecutive terms \\(\\frac{1}{2^{j}}, \\ldots, \\frac{1}{2^{j+1}-1}\\). Since every term in the \\(j\\)-th group is bounded by \\(\\frac{1}{2^{j}}\\), the overall contribution of the \\(j\\)-th group to the sum is at most 1 . Since the first \\(q\\) groups together would contain \\(2^{q}-1>q^{3}\\) terms, the number of groups does not exceed \\(q\\), and hence the value of the sum under consideration is indeed bounded by \\(q\\).\n\nCall an integer \\(m\\) special, if it satisfies \\(1 \\leq L(m) \\leq q^{4}\\). Denote by \\(g(m) \\geq 1\\) the largest integer whose square is bounded by \\(L(m)\\); in other words \\(g^{2}(m) \\leq L(m)<(g(m)+1)^{2}\\). Note that \\(g(m) \\leq q^{2}\\) for all special \\(m\\), which implies\n\\[\n0 \\leq L(m)-g^{2}(m)<(g(m)+1)^{2}-g^{2}(m)=2 g(m)+1 \\leq 2 q^{2}+1 .\n\\]\n\nFinally, we do some counting. Inequality (2) and the monotonicity of \\(L(m)\\) imply that there exist at least \\(q^{3}\\) special integers. Because of (3), every special integer \\(m\\) has \\(0 \\leq L(m)-g^{2}(m) \\leq 2 q^{2}+1\\). By averaging, at least \\(\\frac{q^{3}}{2 q^{2}+2}>10^{6}\\) special integers must yield the same value \\(L(m)-g^{2}(m)\\). This frequently occurring value is our choice for \\(\\alpha\\), which yields more than \\(10^{6}\\) solutions ( \\(m, g(m)\\) ) to equation (1). Hence, the answer to the problem is YES.", "source_pdf": "egmo_2021.pdf", "notes": ""}
{"id": "EGMO-2022-1", "contest": "EGMO", "year": "2022", "problem_number": "1", "problem": "Let \\(A B C\\) be an acute-angled triangle in which \\(B C<A B\\) and \\(B C<C A\\). Let point \\(P\\) lie on segment \\(A B\\) and point \\(Q\\) lie on segment \\(A C\\) such that \\(P \\neq B, Q \\neq C\\) and \\(B Q=B C=C P\\). Let \\(T\\) be the circumcentre of triangle \\(A P Q, H\\) the orthocentre of triangle \\(A B C\\), and \\(S\\) the point of intersection of the lines \\(B Q\\) and \\(C P\\). Prove that \\(T, H\\) and \\(S\\) are collinear.", "solution": "We show that \\(T\\) and \\(H\\) are both on the angle bisector \\(\\ell\\) of \\(\\angle B S C\\). We first prove that \\(H \\in \\ell\\). The altitude \\(C H\\) in triangle \\(A B C\\) is also the altitude in isosceles triangle \\(P B C\\) with \\(C P=C B\\). Therefore, \\(C H\\) is also the angle bisector of \\(\\angle P C B\\) and hence also of \\(\\angle S C B\\). Analogously, \\(B H\\) is the angle bisector of \\(\\angle S B C\\). We conclude that \\(H\\), as the intersection of two angle bisectors of \\(\\triangle B S C\\), is also on the third angle bisector, which is \\(\\ell\\). We now prove that \\(T \\in \\ell\\). Variant 1. In the isosceles triangles \\(\\triangle B C P\\) and \\(\\triangle C B Q\\) we see that \\(\\angle B C P=180^{\\circ}-2 \\angle B\\) and \\(\\angle C B Q=180^{\\circ}-2 \\angle C\\). This yields \\(\\angle P S Q=\\angle B S C=180^{\\circ}-\\left(180^{\\circ}-2 \\angle B\\right)-\\left(180^{\\circ}-2 \\angle C\\right)= 180^{\\circ}-2 \\angle A\\). Furthermore, \\(\\angle P T Q=2 \\angle P A Q=2 \\angle A\\) ( \\(T\\) being circumcentre of \\(\\triangle A P Q\\) ). Now \\(\\angle P T Q+\\angle P S Q=180^{\\circ}\\), so \\(P T Q S\\) is a cyclic quadrilateral. From \\(P T=T Q\\) we then obtain that \\(\\angle P S T=\\angle P Q T=\\angle Q P T=\\angle Q S T\\), so \\(T\\) is on the angle bisector \\(\\angle P S Q\\), which is also \\(\\ell\\). We conclude that \\(T, S\\) and \\(H\\) are collinear. Variant 2. Let \\(R\\) be the second intersection of \\(B Q\\) and \\(\\odot A P Q\\). \\(A P R Q\\) is cyclic quadrilateral, so \\(\\angle P R S=\\angle A, \\angle A P R=\\angle B Q C=\\angle C\\). On the other hand \\(\\angle B P C=\\angle B\\). Therefore \\(\\angle R P S=180^{\\circ}-\\angle B-\\angle C=\\angle A\\). Hence, the triangle \\(P R S\\) is isosceles with \\(S P=S R\\); then \\(\\ell\\) is the perpendicular bisector of the chord \\(P R\\) in the circle that passes through \\(T\\). Note that if \\(B Q\\) is tangent to \\(\\odot A P Q\\), then \\(C P\\) is also tangent to \\(\\odot A P Q\\) and triangle \\(A B C\\) is isosceles, so \\(T, S\\) and \\(H\\) lie on the altitude from \\(A\\). Remark. The fact that \\(C P\\) is also tangent to \\(\\odot A P Q\\) could be shown with \\(P T Q S\\) beeing a cyclic quadrilateral like in the first variant of the solution. Otherwise we can consider \\(R\\) the second intersection of \\(C P\\) and \\(\\odot A P Q\\) and prove that triangle \\(Q R S\\) is isosceles. In the same way as in the previous solution, we see that \\(\\angle P S Q=180^{\\circ}-2 \\angle A\\), so \\(\\angle C S Q=2 \\angle A\\). From the cyclic quadrilateral \\(A E H D\\) (with \\(E\\) and \\(D\\) feet of the altitudes \\(C H\\) and \\(B H\\) ) we see that \\(\\angle D H C=\\angle D A E=\\angle A\\). Since \\(B H\\) is the perpendicular bisector of \\(C Q\\), we have \\(\\angle D H Q=\\angle A\\) as well, so \\(\\angle C H Q=2 \\angle A\\). From \\(\\angle C H Q=2 \\angle A=\\angle C S Q\\), we see \\(C H S Q\\) is a cyclic quadrilateral. This means \\(\\angle Q H S=\\angle Q C S\\). Since triangles \\(P T Q\\) and \\(C H Q\\) are both isosceles with apex \\(2 \\angle A\\), we get \\(\\triangle P T Q \\sim \\triangle C H Q\\). We see that one can be obtained from the other by a spiral similarity centered at \\(Q\\), so we also obtain \\(\\triangle Q T H \\sim \\triangle Q P C\\). This means that \\(\\angle Q H T=\\angle Q C P\\). Combining this with \\(\\angle Q H S=\\angle Q C S\\), we see that \\(\\angle Q H T=\\angle Q C P=\\angle Q C S=\\angle Q H S\\). So \\(\\angle Q H T=\\angle Q H S\\), which means that \\(T, S\\) and \\(H\\) are collinear. Let us draw a parallel \\(f\\) to \\(B C\\) through \\(A\\). Let \\(B^{\\prime}=B Q \\cap f, C^{\\prime}=C P \\cap f\\). Then \\(A Q B^{\\prime} \\sim C Q B\\) and \\(A P C^{\\prime} \\sim B P C\\), therefore both \\(Q A B^{\\prime}\\) and \\(A P C^{\\prime}\\) will be isosceles. Also, \\(B C S \\sim B^{\\prime} C^{\\prime} S\\) with respect to the similarity with center \\(S\\), therefore if we take the image of the line \\(B H\\) (which is the perpendicular bisector of the segment \\(C Q\\) ) through this transformation, it will go through the point \\(B^{\\prime}\\), and be perpendicular to \\(A Q\\) (as the image of \\(C Q\\) is parallel to \\(C Q\\) ). As \\(A Q B^{\\prime}\\) is isosceles, this line is the perpendicular bisector of the segment \\(A Q\\). This means it goes through \\(T\\), the circumcenter of \\(A P Q\\). Similarly on the other side the image of \\(C H\\) also goes through \\(T\\). This means that the image of \\(H\\) with respect to the similarity though \\(S\\) will be \\(T\\), so \\(T, S, H\\) are collinear.", "source_pdf": "egmo_2022.pdf", "notes": ""}
{"id": "EGMO-2022-2", "contest": "EGMO", "year": "2022", "problem_number": "2", "problem": "Let \\(\\mathbb{N}=\\{1,2,3, \\ldots\\}\\) be the set of all positive integers. Find all functions \\(f: \\mathbb{N} \\rightarrow \\mathbb{N}\\) such that for any positive integers \\(a\\) and \\(b\\), the following two conditions hold: (1) \\(f(a b)=f(a) f(b)\\), and (2) at least two of the numbers \\(f(a), f(b)\\) and \\(f(a+b)\\) are equal.", "solution": "Answer: \\(\\quad f(n)=a^{v_{p}(n)}\\), where \\(a \\in \\mathbb{N}, p\\) is a prime and \\(v_{p}(n)\\) is the largest exponent of \\(p\\) dividing \\(n\\). Solution 1. First, all such functions \\(f\\) satisfy the conditions, as \\(v_{p}(a) \\neq v_{p}(b)\\) implies \\(v_{p}(a+b)= \\min \\left(v_{p}(a), v_{p}(b)\\right)\\). Plugging \\(a, b=1\\) into (1) gives \\(f(1)=1\\). Also, a simple induction gives that \\(f\\left(\\prod_{i=1}^{k} p_{i}^{a_{i}}\\right)=\\prod_{i=1}^{k} f\\left(p_{i}\\right)^{a_{i}}\\). Let \\(S\\) be the set of all primes \\(p\\) such that \\(f(p) \\neq 1\\). If \\(|S|=1\\), then \\(S=\\{p\\}\\) and \\(f(p)=a\\) for some \\(a \\neq 1\\), and thus \\(f(n)=a^{v_{p}(n)}\\) for all \\(n\\). If \\(S=\\emptyset\\) then \\(f(n)=1\\) for all \\(n\\), which can be also written in the above form for \\(a=1\\). Now suppose that \\(S\\) contains at least two primes. Let \\(p<q\\) be the two smallest elements of \\(S\\). Since all prime divisors of \\(q-p\\) are smaller than \\(q\\) and not equal to \\(p, f(q-p)=1\\). Using (2) for \\(p\\) and \\(q-p\\) gives us that some two of \\(f(p) \\neq 1, f(p-q)=1\\) and \\(f(q) \\neq 1\\) are equal, meaning that \\(f(p)=f(q)\\). Let \\(t \\geq 2\\) be the smallest integer such that \\(p^{t}>q\\), and let \\(p^{t}=a q+b\\) with \\(0 \\leq b \\leq q\\). Since \\(q \\geq p^{t-1}\\) and \\(q\\) is not divisible by \\(p\\), we have \\(q>p^{t-1}\\), so \\(a<p\\), and thus \\(f(a)=1\\). Therefore \\(a q\\) is not divisible by \\(p\\), thus neither is \\(b\\), and since \\(b<q, f(b)=1\\). Now using (2) for \\(a q\\) and \\(b\\) we get that some two of \\(f(a q)=f(a) f(q)=f(q)=f(p), f(b)=1\\) and \\(f(a q+b)=f\\left(p^{t}\\right)=f(p)^{t}\\) are equal, which is a contradiction. Solution 1B (for the main part). Suppose that there are two primes, \\(p<q\\) such that \\(f(p)>1\\) and \\(f(q)>1\\), and these are the two smallest such primes. \\(1<p-q<q\\) and it is not divisible by \\(p\\) and \\(q\\), therefore its prime factors are smaller than \\(q\\), so we conclude \\(f(q-p)=1\\). By (2), two of \\(f(q-p)=1, f(q-p)>1\\) and \\(f(q)>1\\) are equal, so \\(f(q)=f(p)=a\\). If \\(p^{2}<q\\) then \\(q-p^{2}\\) is not divisible by \\(p\\) and \\(q\\), so we conclude \\(f\\left(q-p^{2}\\right)=1\\) in the same way. Then \\(f\\left(p^{2}\\right)=f(p)^{2}=a^{2}, f\\left(q-p^{2}\\right)=1\\) and \\(f(q)=a\\) are distinct, contradicting (2). Hence, \\(q<p^{2}\\). Let \\(c=\\left\\lfloor p^{2} / q\\right\\rfloor\\); then \\(0<c<p\\), so \\(f(c)=1\\). By \\(0<p^{2}-c q<q\\), we get \\(f\\left(p^{2}-c q\\right)=1\\). Now \\(f\\left(p^{2}-c q\\right)=1, f\\left(p^{2}\\right)=a^{2}\\) and \\(f(c q)=a\\) are distinct, contradicting (2) again. Solution 2 (for the main part). Suppose there exists a positive integer \\(n\\) such that \\(f(n) \\neq 1\\) and \\(f(n+1) \\neq 1\\). We know that \\(f(1)=1\\), so by (2) two of \\(f(n) \\neq 1, f(n+1) \\neq 1\\) and \\(f(1)=1\\) are equal, therefore \\(f(n)=f(n+1)\\). \\(f\\left(n^{2}\\right)=f(n)^{2} \\neq 1\\) and \\(f\\left(n^{2}-1\\right)=f(n+1) f(n-1)=f(n) f(n-1) \\neq 1\\), but by (2) two of \\(f(1)=1, f\\left(n^{2}-1\\right) \\neq 1\\) and \\(f\\left(n^{2}\\right) \\neq 1\\) are equal, so \\(f\\left(n^{2}-1\\right)=f\\left(n^{2}\\right)\\) and thus \\(f(n) f(n-1)=f(n)^{2}\\), therefore \\(f(n-1)=f(n)\\). Then for \\(n-1\\), it is also true that \\(f(n-1) \\neq 1\\) and \\(f(n-1+1) \\neq 1\\), so the same proof applies, \\(f(n-1-1)=f(n-1)\\) and so on. By induction we get that \\(f(n)=f(1)\\), which is a contradiction, as \\(f(1)=1\\) and we assumed that \\(f(n) \\neq 1\\). Therefore, there can't be any \\(n\\) for which \\(f(n) \\neq 1\\) and \\(f(n+1) \\neq 1\\). Now suppose there are two primes, \\(p \\neq q \\in S\\) such that \\(f(p) \\neq 1\\) and \\(f(q) \\neq 1\\). Then by the Chinese remainder theorem, there exists a number \\(n\\) such that \\(p \\mid n\\) and \\(q \\mid n+1\\), so \\(f(p) \\mid f(n)\\) and \\(f(q) \\mid f(n+1)\\) thus \\(f(n) \\neq 1\\) and \\(f(n+1) \\neq 1\\). This is a contradiction, so \\(S\\) can't have two distinct elements. Solution 3 (Joseph Myers) (for the second part). Claim 3.1. If \\(f(m)>1\\) for some \\(m \\in \\mathbb{N}\\), then there are less than \\(m\\) different prime numbers \\(p_{i}\\) with \\(f\\left(p_{i}\\right)>1\\). Proof. On the one hand, if \\(f(m)=c>1\\), then for any \\(n \\in \\mathbb{N}\\), there is some \\(k \\in\\{n+1, n+2 \\ldots, n+m\\}\\) such that \\(f(k) \\in\\{1, c\\}\\). To show this, it is enough to see that condition (2) implies that for any \\(n \\in \\mathbb{N}\\) - if \\(f(n)=c\\), then \\(f(n+1) \\in\\{1, c\\}\\); - if \\(f(n)=1\\), then \\(f(n+m) \\in\\{1, c\\}\\). On the other hand, if we suppose that there are \\(m\\) different prime numbers \\(p_{1}, p_{2}, \\ldots, p_{m}\\), then we know (by the Chinese Remainder Theorem) that for any number \\(t \\in \\mathbb{N}\\), there exists a number \\(n_{t} \\in \\mathbb{N}\\) such that \\(p_{k}^{t} \\mid n_{t}+k\\) for each \\(k \\in\\{1,2, \\ldots, m\\}\\). Hence for each \\(k\\), we have \\[ f\\left(n_{t}+k\\right) \\geq f\\left(p_{i}^{t}\\right)=f\\left(p_{i}\\right)^{t} \\geq 2^{t} . \\] If \\(2^{t}>c\\), then it means that \\(f(k)>c\\) for all \\(k \\in\\left\\{n_{t}+1, n_{t}+2 \\ldots, n_{t}+m\\right\\}\\). Now we can suppose that for some \\(m \\geq 2\\), the set of primes with \\(f(p)>1\\) is \\(S=\\left\\{p_{1}, p_{2}, \\ldots, p_{m}\\right\\}\\). Now let \\(S_{1}\\) and \\(S_{2}\\) be two disjoint nonempty subsets such that \\(S_{1} \\cup S_{2}=S\\). Let \\(a=\\prod_{p_{i} \\in S_{1}} p_{i}\\) and \\(b=\\prod_{p_{j} \\in S_{2}} p_{j}\\). Now for any \\(k, \\ell \\in \\mathbb{N}, a^{k}+b^{\\ell}\\) is coprime to all primes in \\(S\\), hence \\(f\\left(a^{k}+b^{\\ell}\\right)=1\\). It is easy to see that we can choose \\(k\\) and \\(\\ell\\) such that \\(f\\left(a^{k}\\right) \\neq f\\left(b^{\\ell}\\right)\\), which contradicts condition (2). Solution 4 (for the main part). Let \\(p\\) the minimal (prime) number with \\(f(p)=c>1\\). Claim 4.1. For any \\(k \\in \\mathbb{N}, f\\left(1+p+p^{2}+\\ldots+p^{k}\\right) \\in\\left\\{1, c, c^{2}, \\ldots, c^{k}\\right\\}\\). Proof of the claim. Use condition (2) recursively. Now suppose that there exists some prime \\(q>p\\) with \\(f(q)>1\\), and consider the following three values of \\(f\\) : - \\(f(1)=1\\). - \\(f\\left(p^{q-1}-1\\right)=f(p-1) f\\left(p^{q-2}+p^{q-3}+\\ldots+p+1\\right) \\in\\left\\{1, c, c^{2}, \\ldots, c^{q-2}\\right\\}\\) using our claim, (note that we know \\(f(p-1)=1\\) by the minimality of \\(p\\) ). But we also know (by Fermat's little theorem) that \\(q \\mid p^{q-1}-1\\), hence \\(f(q) \\mid f\\left(p^{q-1}-1\\right)\\). Therefore we have that: \\(f\\left(p^{q-1}-1\\right) \\in\\left\\{c, c^{2}, \\ldots, c^{q-2}\\right\\}\\). - \\(f\\left(p^{q-1}\\right)=c^{q-1}\\). These are three different values, hence we have a contradiction by condition (2). Solution 4B (for the main part). Let \\(p\\) the minimal (prime) number with \\(f(p)=c>1\\). Lemma 4B.1. For any \\(k \\in \\mathbb{N}, f\\left(1+p+p^{2}+\\ldots+p^{k}\\right)=1\\). Proof of the Lemma, by induction. \\(k=0\\) is trivial. \\(k=1\\) is also easy, as \\(p+1\\) cannot be a prime, except in the case of \\(p=2\\), which is also easy. (If \\(f(2)=c>1\\), then \\(f(3) \\in\\{1, c\\}\\) by \\(3=1+2\\) and \\(f(3) \\in\\left\\{1, c^{2}\\right\\}\\) by \\(2^{2}=1+3\\).) From now we suppose \\(k \\geq 2\\) and \\(f\\left(1+p+\\ldots+p^{k-1}\\right)=1\\). By condition (2), we have that: - As \\(f\\left(1+p+\\ldots+p^{k-1}\\right)=1\\) and \\(f\\left(p^{k}\\right)=c^{k}\\), we have that \\(f\\left(1+p+\\ldots+p^{k-1}\\right) \\in\\left\\{1, c^{k}\\right\\}\\) - As \\(f(1)=1\\) and \\(f\\left(p+\\ldots+p^{k}\\right)=f(p) f\\left(1+p+\\ldots+p^{k-1}\\right)=c\\), we also have that \\(f\\left(1+p+\\ldots+p^{k-1}\\right) \\in\\{1, c\\}\\). If \\(k>1, c \\neq c^{k}\\), therefore \\(f\\left(1+p+\\ldots+p^{k}\\right)=1\\). Now suppose that there exists some prime \\(q>p\\) with \\(f(q)>1\\). Then by condition (1), \\[ f\\left(p^{q-1}-1\\right)=f(p-1) f\\left(1+p+\\ldots+p^{q-2}\\right) \\] here \\(f(p-1)=1\\) (by the minimality of \\(p\\) ) and \\(f\\left(1+p+\\ldots+p^{q-2}\\right)=1\\) by the lemma. But we also know (by Fermat's little theorem) that \\(q \\mid p^{q-1}-1\\), hence \\(1<f(q) \\leq f\\left(p^{q-1}-1\\right)\\), which is a contradiction. Solution 5 (for the main part). Lemma 5.1. If \\(f(m) \\neq f(n)\\), then \\(f(n+m)=f(n-m)\\) (for all \\(n>m \\in \\mathbb{N}\\) ). Proof of the Lemma. By condition (2), \\(\\{f(n+m), f(n-m)\\} \\subseteq\\{f(n), f(m)\\}\\). We also have that: \\[ f(n-m) f(n+m)=f\\left(n^{2}-m^{2}\\right) \\in\\left\\{f(n)^{2}, f(m)^{2}\\right\\} \\] which is only possible if \\(f(n-m)=f(n+m)=f(n)\\) or \\(f(n-m)=f(n+m)=f(m)\\). Now let \\(p\\) be the smallest (prime) number with \\(f(p)>1\\). Claim 5.2. If \\(p\\) does not divide \\(n\\), then \\(f(n)=1\\). Proof of the Claim. Let \\(n\\) be the minimal counterexample, and and let \\(n=d p+r\\) with \\(0<r<p\\). Here \\(d \\geq 1\\) by the minimality of \\(p\\). Now \\(1<f(d) f(p)=f(d p) \\neq f(r)=1\\), hence by our lemma, \\(f(d p+r)=f(d p-r)=1\\), contradiction.", "source_pdf": "egmo_2022.pdf", "notes": ""}
{"id": "EGMO-2022-3", "contest": "EGMO", "year": "2022", "problem_number": "3", "problem": "An infinite sequence of positive integers \\(a_{1}, a_{2}, \\ldots\\) is called good if (1) \\(a_{1}\\) is a perfect square, and (2) for any integer \\(n \\geq 2, a_{n}\\) is the smallest positive integer such that \\[ n a_{1}+(n-1) a_{2}+\\ldots+2 a_{n-1}+a_{n} \\] is a perfect square. Prove that for any good sequence \\(a_{1}, a_{2}, \\ldots\\), there exists a positive integer \\(k\\) such that \\(a_{n}=a_{k}\\) for all integers \\(n \\geq k\\).", "solution": "Solution. Define the following auxiliary sequences: \\[ \\begin{array}{ll} b_{1}=a_{1}, & b_{n}=a_{1}+a_{2}+\\cdots+a_{n}, \\\\ c_{1}=b_{1}, & c_{n}=b_{1}+b_{2}+\\cdots+b_{n} . \\end{array} \\] Observe that \\[ \\begin{gathered} c_{n}-c_{n-1}=b_{n} \\\\ b_{n}-b_{n-1}=\\left(c_{n}-c_{n-1}\\right)-\\left(c_{n-1}-c_{n-2}\\right)=a_{n} \\end{gathered} \\] Therefore, \\[ c_{n}=\\left(2 c_{n-1}-c_{n-2}\\right)+a_{n} \\] is the smallest square greater than \\(2 c_{n-1}-c_{n-2}\\). Claim. \\(\\sqrt{c_{n}}-\\sqrt{c_{n-1}} \\leq \\sqrt{c_{n-1}}-\\sqrt{c_{n-2}}\\) Proof 1. Let \\(c_{n}=m_{n}^{2}, c_{n-1}=m_{n-1}^{2}, c_{n-2}=m_{n-2}^{2}\\), where the value of \\(c_{n}\\) is momentarily permitted to exceed its minimum. Any value is permitted for which \\[ \\left(m_{n}-m_{n-1}\\right)\\left(m_{n}+m_{n-1}\\right)>\\left(m_{n-1}-m_{n-2}\\right)\\left(m_{n-1}+m_{n-2}\\right) . \\] In the case that \\(m_{n}-m_{n-1}=m_{n-1}-m_{n-2}\\), this inequality clearly holds, as \\(m_{n}+m_{n-1}>m_{n-1}+m_{n-2}\\). Thus, the minimal possible value of \\(m_{n}\\) satisfies the claimed inequality. Proof 2. Denote \\(c_{n-1}=x^{2}, c_{n-2}=(x-d)^{2}\\). Then \\[ 2 c_{n-1}-c_{n-2}=2 x^{2}-(x-d)^{2}=x^{2}+2 d x-d^{2}=(x+d)^{2}-2 d^{2}<(x+d)^{2} . \\] It follows that \\(c_{n} \\leq(x+d)^{2}\\). And so the sequence of positive integers \\(\\sqrt{c_{n}}-\\sqrt{c_{n-1}}\\) is decreasing. Any such sequence is eventually constant. As a corollary, \\(c_{n}=(x+n d)^{2}\\) for sufficiently large \\(n\\), with fixed integers \\(x\\) and \\(d\\). Along the lines above, it becomes clear that \\(a_{n}=c_{n}-2 c_{n-1}+c_{n-2}=2 d^{2}\\), so the sequence ( \\(a_{n}\\) ) is constant. Solution. We write: \\[ s_{n}^{2}=S_{n}=a_{1}+\\left(a_{1}+a_{2}\\right)+\\ldots+\\left(a_{1}+\\ldots+a_{n}\\right) . \\] So, setting \\(b_{n}:=a_{1}+\\ldots+a_{n}\\), we have \\(S_{n}=b_{1}+b_{2}+\\ldots+b_{n}\\) and, in particular \\(S_{n+1}=S_{n}+b_{n+1}\\). Now, we study the quantity \\(S_{n} b_{n}=+b_{1}+b_{2}+\\ldots+b_{n}+b_{n}\\) in two different ways. Since \\(b_{n+1}\\) is the smallest integer strictly greater than \\(b_{n}\\) such that \\(b_{1}+\\ldots+b_{n}+b_{n+1}\\) is a perfect square, we must have \\[ b_{1}+b_{2}+\\ldots+b_{n}+b_{n} \\geq\\left(s_{n+1}-1\\right)^{2} \\] However, we also have \\[ b_{1}+b_{2}+\\ldots+b_{n}+b_{n}=S_{n}+b_{n}=2 S_{n}-S_{n-1} \\] Combining, we obtain \\[ s_{n}^{2} \\geq \\frac{s_{n-1}^{2}+\\left(s_{n+1}-1\\right)^{2}}{2}>\\left(\\frac{s_{n-1}+s_{n+1}-1}{2}\\right)^{2} \\] where the final inequality is strict since the sequence ( \\(s_{k}\\) ) is strictly increasing. Taking a square root, and noting that all the ( \\(s_{n}\\) ) are integers, one obtains \\(s_{n+1}-s_{n} \\leq s_{n}-s_{n-1}\\). Now we focus on the sequence \\(d_{n}=s_{n+1}-s_{n}\\). ( \\(s_{k}\\) ) is strictly increasing thus ( \\(d_{k}\\) ) is positive. However we proved that \\(d_{n+1} \\leq d_{n}\\), so the sequence ( \\(d_{k}\\) ) is eventually constant, so eventually \\(s_{n}=b n+c\\) and \\(S_{n}=(b n+c)^{2}\\) with some numbers \\(b, c\\); then \\[ a_{n+2}=S_{n+2}-2 S_{n+1}+S_{n}=(b(n+2)+c)^{2}-2(b(n+1)+c)^{2}+(b n+c)^{2}=2 b^{2} . \\] Remark. The key idea is to use the \\(D\\) difference operator on the space of sequences. That is a function which takes a sequence as an input and outputs another sequence the following way: if ( \\(x\\) ) is the input sequence, then \\[ D(x)=D\\left(\\left(x_{1}, x_{2}, x_{3}, x_{4}, \\ldots\\right)\\right)=\\left(x_{2}-x_{1}, x_{3}-x_{2}, x_{4}-x_{3}, \\ldots\\right) . \\] Here \\(D D(S)=(a)\\) (with some shift), \\(D(s)=(d)\\). This \\(D\\) operator has some nice properties; if someone studied calculus, these properties will be familiar. \\(D(x+y)=D(x)+D(y) ; D(\\lambda x)=\\lambda D(x) ;(x)\\) constant iff \\(D x\\) zero ; ( \\(x\\) ) is linear iff \\(D x\\) constant ; in general ( \\(x\\) ) is a polynomial with degree \\(l+1\\) iff \\(D(x)\\) is a polynomial with degree \\(l\\). First we proved that sequence ( \\(d\\) ) is eventually constant, thus \\(D(d)=D D(s)\\) is eventually zero. Therefore the sequence ( \\(s\\) ) is eventually a linear function, hence \\(s^{2}=S\\) is eventually a quadratic polynomial, therefore \\(0=D D D(S)=D(a)\\), so \\((a)\\) is constant eventually.", "source_pdf": "egmo_2022.pdf", "notes": ""}
{"id": "EGMO-2022-4", "contest": "EGMO", "year": "2022", "problem_number": "4", "problem": "Given a positive integer \\(n \\geq 2\\), determine the largest positive integer \\(N\\) for which there exist \\(N+1\\) real numbers \\(a_{0}, a_{1}, \\ldots, a_{N}\\) such that (1) \\(a_{0}+a_{1}=-\\frac{1}{n}\\), and (2) \\(\\left(a_{k}+a_{k-1}\\right)\\left(a_{k}+a_{k+1}\\right)=a_{k-1}-a_{k+1}\\) for \\(1 \\leq k \\leq N-1\\).", "solution": "Solution 1. \\(\\left(a_{k}+a_{k-1}\\right)\\left(a_{k}+a_{k+1}\\right)=a_{k-1}-a_{k+1}\\) is equivalent to \\(\\left(a_{k}+a_{k-1}+1\\right)\\left(a_{k}+a_{k+1}-1\\right)=-1\\). Let \\(b_{k}=a_{k}+a_{k+1}\\). Thus we need \\(b_{0}, b_{1}, \\ldots\\) the following way: \\(b_{0}=-\\frac{1}{n}\\) and \\(\\left(b_{k-1}+1\\right)\\left(b_{k}-1\\right)=-1\\). There is a proper sequence \\(b_{0}, b_{1}, \\ldots, b_{N-1}\\) if and only if there is proper sequence \\(a_{0}, a_{1}, \\ldots, a_{N}\\), because from a a proper ( \\(a_{k}\\) ) sequence we can get a proper ( \\(b_{k}\\) ) sequence with \\(b_{k}=a_{k}+a_{k+1}\\) for \\(k=0,1, \\ldots, N-1\\) and from a proper ( \\(b_{k}\\) ) sequence we can get a proper ( \\(a_{k}\\) ) sequence by arbitrarily setting \\(a_{0}\\) and then inductively defining \\(a_{k}=b_{k-1}-a_{k-1}\\) for \\(k=1,2, \\ldots, N\\). We prove by induction that \\(b_{k}=-\\frac{1}{n-k}\\) for \\(k<n\\). This is true for \\(k=0\\), as \\(b_{0}=-\\frac{1}{n}\\) and \\[ b_{k}=1-\\frac{1}{b_{k-1}+1}=1-\\frac{1}{1-\\frac{1}{n-k+1}}=-\\frac{1}{n-k} \\] for \\(k<n\\). Thus there is a proper sequence \\(b_{0}, b_{1}, \\ldots, b_{n-1}\\), but it can't be continued, because \\(b_{n-1}+1=\\) 0 so there is no \\(b_{n}\\) for which \\(\\left(b_{n-1}+1\\right)\\left(b_{n}-1\\right)=-1\\). Therefore the longest proper sequence ( \\(b_{k}\\) ) is \\(n\\)-long, so the longest proper sequence ( \\(a_{k}\\) ) is \\(n+1\\) long, so \\(N=n\\). Solution 2. The required maximum is \\(N=n\\). To rule out the case \\(N \\geq n+1\\), it is clearly sufficient to rule out the case \\(N=n+1\\). Assume for contradiction that \\(a_{0}, a_{1}, \\ldots, a_{n+1}\\) are real numbers satisfying both conditions in the statement. It is sufficient to show that \\(a_{k}+a_{k+1}=0\\) for some \\(k \\leq n\\), because then \\(a_{k-1}-a_{k+1}=0\\) so \\(a_{k+1}=a_{k-1}\\), therefore \\(a_{k-1}+a_{k}=0\\) and so on, by backwards recursion we get that \\(a_{j}+a_{j+1}=0\\) for all \\(0 \\leq j \\leq k\\), but this is a contradiction with \\(a_{0}+a_{1}=-\\frac{1}{n}\\). To prove that \\(a_{k}+a_{k+1}=0\\) for some \\(k \\leq n\\), assume that \\(a_{k}+a_{k+1} \\neq 0\\) for all \\(k \\leq n\\), to rewrite the second condition in the statement in the form \\[ \\frac{1}{a_{k}+a_{k+1}}-\\frac{1}{a_{k-1}+a_{k}}=1, \\quad k=1, \\ldots, n . \\] and sum both sides over the full range from \\(k=1\\) to \\(n\\). This gives \\[ \\frac{1}{a_{n}+a_{n+1}}-\\frac{1}{a_{0}+a_{1}}=n . \\] As \\(a_{0}+a_{1}=-\\frac{1}{n}\\), this means that \\(\\frac{1}{a_{n}+a_{n+1}}=0\\), which is a contradiction. Consequently, \\(N \\leq n\\). To provide \\(n+1\\) real numbers satisfying both conditions in the statement, fix \\(a_{0}\\) and go through the telescoping procedure above to obtain \\[ a_{k}=(-1)^{k} a_{0}+\\sum_{j=1}^{k} \\frac{(-1)^{k-j+1}}{n-j+1}, \\quad k=1, \\ldots, n . \\] This concludes the proof.", "source_pdf": "egmo_2022.pdf", "notes": ""}
{"id": "EGMO-2022-5", "contest": "EGMO", "year": "2022", "problem_number": "5", "problem": "For all positive integers \\(n, k\\), let \\(f(n, 2 k)\\) be the number of ways an \\(n \\times 2 k\\) board can be fully covered by \\(n k\\) dominoes of size \\(2 \\times 1\\). (For example, \\(f(2,2)=2\\) and \\(f(3,2)=3\\).) Find all positive integers \\(n\\) such that for every positive integer \\(k\\), the number \\(f(n, 2 k)\\) is odd.", "solution": "Solution. The integers \\(n\\) with the requested property are exactly the ones of the form \\(2^{k}-1\\). In what follows, let \\(f(m, n)\\) denote the number of domino tilings of an \\(m \\times n\\) grid. (For convenience, we also allow \\(m\\) and \\(n\\) to be 0 , in which case \\(f(m, n)=1\\).) Claim. \\(f(m, 2 n+1) \\equiv f(m, n)(\\bmod 2)\\) for all \\(n\\) and even \\(m\\) Proof. Consider reflecting \\(m \\times(2 n+1)\\) tilings across the central column. In this way, the tilings are grouped into singletons and pairs, so modulo \\(2, f(m, 2 n+1)\\) is congruent to the number of singletons. If a tiling is invariant under reflection in the central column, then every domino with one cell in that column must have both cells in that column. In other words, the central column is filled with \\(\\frac{m}{2}\\) vertical dominoes, splitting the remainder of the grid into two \\(m \\times n\\) grids. Obeying the symmetry constraint, there are \\(f(m, n)\\) tilings: each of the tilings of the left grid fixes the tiling of the right grid. Claim. \\(f(n, n) \\equiv 0(\\bmod 2)\\) for all even \\(n \\geq 2\\). (Recall that \\(f(0,0)=1\\) is odd.) Proof. Consider reflecting \\(n \\times n\\) tilings across the diagonal. This groups the tilings into pairs, (no tiling is grouped with itself). Hence the number of \\(n \\times n\\) tilings is even. We are ready to complete the solution. - If \\(n\\) is odd, the first claim shows that \\(n\\) satisfies the property if and only if \\(\\frac{1}{2}(n-1)\\) does. - If \\(n \\geq 2\\) is even, the second claim shows that \\(n\\) does not satisfy the property. - If \\(n=0\\), then \\(n\\) satisfies the property, as \\(f(m, 0)=1\\) always. This concludes the proof that the sought numbers are the ones of the form \\(2^{k}-1\\). Solution 2. Color the board as a chessboard. Consider the bipartite graph whose vertices are the squares and the neighbors are connected by an edge. Notice that a domino tiling described in the problem corresponds to a perfect matching in this bipartite graph, so we are interested in the number of perfect matchings. And that is the permanent of the (bipartite) adjacency matrix. However we need to compute it \\(\\bmod 2\\) (over \\(F_{2}\\) ), so that is the determinant of that matrix. So our goal is to decide whether the determinant is 0 or \\(1 \\bmod 2\\), or in other world, that matrix is singular or not. From now we compute everything mod 2. Now we understand what does it mean, that a vector \\(v\\) is in the nullspace (has eigenvalue 0 ). But each entry of \\(v\\) is \\(0-1\\), so in other words we choose a subset of the black squares ( \\(v\\) is the characteristic vector of that subset). So in the language of the board, there is a nontrivial \\(v\\) in the nullspace iff we have a subspace of black square such a way that each white square has even number of black chosen neighbors. If \\(n\\) is even, then we can choose a subset such a way in the \\(n \\times n\\) square: the diagonal. Now we prove similar connection between \\(n\\) and \\(2 n+1\\) : there is a construction for \\(n\\) iff we have one for \\(2 n+1 . k\\) is always even. If we have a construction in \\(n \\times k\\) then we have one in \\((2 n+1) \\times k\\) : we mirror the construction to the middle row. Now we prove that from a construction in \\((2 n+1) \\times k\\) we can make a construction in \\(n \\times k\\). First, we don't have any chosen black square in the middle row. Then the chosen black squares in the upper (or lower) \\(n \\times k\\) rectangle is a construction for \\(n \\times k\\). Second, we have some chosen black square in the middle row. Because we can find a white square in the middle row such that is has only one chosen black neighbor in the middle row. Thus this construction isn't symmetric to the horizontal line the symmetric difference of the construction and its reflection (to the vertical line) is a nontrivial vector in the nullspace, thus we can use the first case.", "source_pdf": "egmo_2022.pdf", "notes": ""}
{"id": "EGMO-2022-6", "contest": "EGMO", "year": "2022", "problem_number": "6", "problem": "Let \\(A B C D\\) be a cyclic quadrilateral with circumcentre \\(O\\). Let the internal angle bisectors at \\(A\\) and \\(B\\) meet at \\(X\\), the internal angle bisectors at \\(B\\) and \\(C\\) meet at \\(Y\\), the internal angle bisectors at \\(C\\) and \\(D\\) meet at \\(Z\\), and the internal angle bisectors at \\(D\\) and \\(A\\) meet at \\(W\\). Further, let \\(A C\\) and \\(B D\\) meet at \\(P\\). Suppose that the points \\(X, Y, Z, W, O\\) and \\(P\\) are distinct. Prove that \\(O, X, Y, Z\\) and \\(W\\) lie on the same circle if and only if \\(P, X, Y, Z\\) and \\(W\\) lie on the same circle.", "solution": "Solution 1. Let \\(\\Omega\\) be the circumcircle of the quadrilateral \\(A B C D\\) and let \\(r\\) be its radius. First, notice that the points \\(X, Y, Z, W\\) are concyclic. Indeed, using oriented (modulo \\(180^{\\circ}\\) ) angles, \\[ \\angle(X W, X Y)+\\angle(Z Y, Z W)=\\angle(X A, X B)+\\angle(Z C, Z D)=-\\frac{\\angle A+\\angle B}{2}-\\frac{\\angle C+\\angle D}{2}=0 . \\] Let \\(\\omega\\) be the circle passing through these four points. Our goal is to prove that \\(O \\in \\omega\\) occurs if and only if \\(P \\in \\omega\\). Next, we rule out the case when \\(A B C D\\) is a trapezium. Suppose that if \\(A B C D\\) is an isosceles trapezium; without loss of generality say \\(A B \\| C D\\). By symmetry, points \\(X, Z, O\\) and \\(P\\) lie on the symmetry axis (that is, the common perpendicular bisector of \\(A B\\) and \\(C D\\) ), therefore they are collinear. By the conditions of the problem, these four points are distinct and \\(X\\) and \\(Z\\) are on \\(\\omega\\), so neither \\(O\\), nor \\(P\\) can lie on \\(\\omega\\); therefore the problem statement is obvious. From now on we assume that \\(A B \\nVdash C D\\) and \\(B C \\nmid A D\\). Let \\(A B\\) and \\(C D\\) meet at \\(Q\\), and let \\(B C\\) and \\(A D\\) meet at \\(R\\). Without loss of generality, suppose that \\(B\\) lies between \\(A\\) and \\(Q\\), and \\(D\\) lies between \\(A\\) and \\(R\\). Now we show that line \\(Q R\\) is the radical axis between circles \\(\\Omega\\) and \\(\\omega\\). Point \\(W\\) is the intersection point of the bisectors of \\(\\angle A\\) and \\(\\angle D\\), so in triangle \\(A D Q\\), point \\(W\\) is the incentre. Similary, \\(B Y\\) and \\(C Y\\) are the external bisectors of \\(\\angle Q B C\\) and \\(\\angle B C Q\\), so in triangle \\(B C Q\\), point \\(Y\\) is the excentre opposite to \\(Q\\). Hence, both \\(Y\\) and \\(W\\) lie on the bisector of \\(\\angle D Q A\\). By \\(\\angle D Q A=180^{\\circ}-\\angle D-\\angle A=\\angle B-\\angle A\\) we get \\[ \\angle B Y Q=\\angle Y B A-\\angle Y Q B=\\frac{\\angle B}{2}-\\frac{\\angle D Q A}{2}=\\frac{\\angle B}{2}-\\frac{\\angle B-\\angle A}{2}=\\frac{\\angle A}{2}=\\angle B A W, \\] so the points \\(A, B, Y, W\\) are concyclic, and therefore \\(Q A \\cdot Q B=Q Y \\cdot Q W\\); hence, \\(Q\\) has equal power with respect to \\(\\Omega\\) and \\(\\omega\\). It can be seen similarly that \\(R\\) has equal power with respect to the circles \\(\\Omega\\) and \\(\\omega\\). Hence, the radical axis of \\(\\Omega\\) and \\(\\omega\\) is line \\(Q R\\). Let lines \\(O P\\) and \\(Q R\\) meet at point \\(S\\). It is well-known that with respect to circle \\(A B C D\\), the diagonal triangle \\(P Q R\\) is autopolar. As consequences we have \\(O P \\perp Q R\\), and the points \\(P\\) and \\(S\\) are symmetric to circle \\(A B C D\\), so \\(O S \\cdot O P=r^{2}\\). Notice that \\(P\\) and \\(O\\) lie inside \\(\\Omega\\), so the polar line \\(Q R\\) lies entirely outside, so \\(S\\) is different from \\(P\\) and \\(O\\). Moreover, \\[ S O \\cdot S P=O S \\cdot(O S-O P)=O S^{2}-O S \\cdot O P=S O^{2}-r^{2}, \\] so \\(S O \\cdot S P\\) is equal to the power of \\(S\\) with respect to \\(\\Omega\\). Since \\(S\\) lies on the radical axis \\(Q R\\), it has equal power with respect to the two circles; therefore, \\(S O \\cdot S P\\) is equal to the power of \\(S\\) with respect to \\(\\omega\\). From this, it follows that \\(O \\in \\omega\\) if and only if \\(P \\in \\omega\\). Solution 2. We will prove that the points \\(X, Y, Z, W, O, P\\) lie on a conic section \\(\\Gamma\\). Five distinct points uniquely determine a conic section, therefore \\[ X, Y, Z, W, O \\text { are concyclic } \\Leftrightarrow \\Gamma \\text { is a circle } \\Leftrightarrow X, Y, Z, W, P \\text { are concyclic. } \\] Let \\(A^{\\prime}, B^{\\prime}, C^{\\prime}\\) and \\(D^{\\prime}\\) be the second intersection of the angle bisectors of \\(\\angle D A C\\), \\(\\angle A B C, \\angle B C D\\) and \\(\\angle C D A\\) with the circumcircle of \\(A B C D\\), respectively. Notice that \\(A^{\\prime}\\) and \\(C^{\\prime}\\) are the midpoints of the two arcs of \\(B D\\) and \\(B^{\\prime}\\) and \\(D^{\\prime}\\) are the midpoints of arcs corresponding to \\(A C\\) so the lines \\(A^{\\prime} C^{\\prime}\\) and \\(B^{\\prime} D^{\\prime}\\) intersect in \\(O\\). We will prove that the points \\(X, Y, Z, W, P\\) and \\(O\\) lie on a conic section. This is a more general statement because five points uniquely determine a conic sections so if \\(X, Y, Z, W\\) and \\(P\\) lie on a circle then this circle is the conic section so \\(O\\) also lies on this circle. In the same way if \\(X, Y, Z\\), \\(W\\) and \\(O\\) are on a circle then it also contains \\(P\\). Let \\(E\\) be the intersection of the lines \\(A^{\\prime} B\\) and \\(C D^{\\prime}\\). Let \\(F\\) be the intersection of the lines \\(A^{\\prime} D\\) and \\(B^{\\prime} C\\). Finally, let \\(G\\) be the intesection of \\(X Y\\) and \\(Z W\\). Now we use Pascal's theorem five times: 1. From \\(B D D^{\\prime} C A A^{\\prime}\\) we see that the points \\(P, W\\) and \\(E\\) are collinear. 2. From \\(B B^{\\prime} D^{\\prime} C C^{\\prime} A^{\\prime}\\) we see that the points \\(Y, O\\) and \\(E\\) are collinear. 3. From \\(B^{\\prime} B D A^{\\prime} A C\\) we see that the points \\(X, P\\) and \\(F\\) are collinear. 4. From \\(B^{\\prime} D^{\\prime} D A^{\\prime} C^{\\prime} C\\) we see that the points \\(O, Z\\) and \\(F\\) are collinear. 5. From \\(D^{\\prime} C B^{\\prime} B A^{\\prime} D\\) we see that the points \\(E, F\\) and \\(G\\) are collinear. So the opposite sides of the hexagon \\(P X Y O Z W\\) intersect at points \\(F, G\\) and \\(E\\), which are collinear, so by the converse of Pascal's theorem the points \\(X, Y, Z, W, P\\) and \\(O\\) indeed lie on a conic section.", "source_pdf": "egmo_2022.pdf", "notes": ""}
{"id": "EGMO-2023-1", "contest": "EGMO", "year": "2023", "problem_number": "1", "problem": "There are \\(n \\geqslant 3\\) positive real numbers \\(a_{1}, a_{2}, \\ldots, a_{n}\\). For each \\(1 \\leqslant i \\leqslant n\\) we let \\(b_{i}=\\frac{a_{i-1}+a_{i+1}}{a_{i}}\\) (here we define \\(a_{0}\\) to be \\(a_{n}\\) and \\(a_{n+1}\\) to be \\(a_{1}\\) ). Assume that for all \\(i\\) and \\(j\\) in the range 1 to \\(n\\), we have \\(a_{i} \\leqslant a_{j}\\) if and only if \\(b_{i} \\leqslant b_{j}\\).\n\nProve that \\(a_{1}=a_{2}=\\cdots=a_{n}\\).", "solution": "Suppose that not all \\(a_{i}\\) are equal. Consider an index \\(i\\) such that \\(a_{i}\\) is maximal and \\(a_{i+1}<a_{i}\\). Then\n\\[\nb_{i}=\\frac{a_{i-1}+a_{i+1}}{a_{i}}<\\frac{2 a_{i}}{a_{i}}=2 .\n\\]\n\nBut since \\(a_{i}\\) is maximal, \\(b_{i}\\) is also maximal, so we must have \\(b_{j}<2\\) for all \\(j \\in\\{1,2, \\ldots, n\\}\\).\nHowever, consider the product \\(b_{1} b_{2} \\ldots b_{n}\\). We have\n\\[\n\\begin{aligned}\nb_{1} b_{2} \\ldots b_{n} & =\\frac{a_{n}+a_{2}}{a_{1}} \\cdot \\frac{a_{1}+a_{3}}{a_{2}} \\cdot \\ldots \\cdot \\frac{a_{n-1}+a_{1}}{a_{n}} \\\\\n& \\geqslant 2^{n} \\frac{\\sqrt{a_{n} a_{2}} \\sqrt{a_{1} a_{3}} \\ldots \\sqrt{a_{n-1} a_{1}}}{a_{1} a_{2} \\ldots a_{n}} \\\\\n& =2^{n}\n\\end{aligned}\n\\]\nwhere we used the inequality \\(x+y \\geqslant 2 \\sqrt{x y}\\) for \\(x=a_{i-1}, y=a_{i+1}\\) for all \\(i \\in\\{1,2, \\ldots, n\\}\\) in the second row.\n\nSince the product of all \\(b_{i}\\) is at least \\(2^{n}\\), at least one of them must be greater than 2 , which is a contradiction with the previous conclusion.\n\nThus, all \\(a_{i}\\) must be equal.\n\nSolution 2. This is a version of Solution 1 without use of proof by contradiction.\nTaking \\(a_{i}\\) such that it is maximal among \\(a_{1}, \\ldots, a_{n}\\), we obtain \\(b_{i} \\leqslant 2\\). Thus \\(b_{i} \\leqslant 2\\) for all \\(j \\in\\{1,2, \\ldots, n\\}\\).\n\nThe second part of Solution 1 then gives \\(2^{n} \\geqslant b_{1} \\cdots b_{n} \\geqslant 2^{n}\\), which together with \\(b_{i} \\leqslant 2\\) for all \\(j \\in\\{1,2, \\ldots, n\\}\\) implies that \\(b_{j}=2\\) for all \\(j \\in\\{1,2, \\ldots, n\\}\\). Since we have \\(b_{1}= b_{2}=\\cdots=b_{n}\\), the condition that \\(a_{i} \\leqslant a_{j} \\Longleftrightarrow b_{i} \\leqslant b_{j}\\) gives that \\(a_{1}=a_{2}=\\cdots=a_{n}\\).\n\nSolution 3. We first show that \\(b_{j} \\leqslant 2\\) for all \\(j\\) as in Solution 2. Then\n\\[\n\\begin{aligned}\n2 n & \\geqslant b_{1}+\\cdots+b_{n}=\\frac{a_{n}}{a_{1}}+\\frac{a_{2}}{a_{1}}+\\frac{a_{1}}{a_{2}}+\\frac{a_{3}}{a_{2}}+\\cdots+\\frac{a_{n-1}}{a_{n}}+\\frac{a_{1}}{a_{n}} \\\\\n& \\geqslant 2 n \\sqrt[n]{\\frac{a_{n}}{a_{1}} \\cdot \\frac{a_{2}}{a_{1}} \\cdot \\frac{a_{1}}{a_{2}} \\cdot \\frac{a_{3}}{a_{2}} \\cdots \\frac{a_{n-1}}{a_{n}} \\cdot \\frac{a_{1}}{a_{n}}}=2 n \\cdot 1=2 n,\n\\end{aligned}\n\\]\nwhere we used the AM-GM inequality.\nIt follows that all \\(b_{j}\\) 's are equal which as in Solution 2 gives \\(a_{1}=a_{2}=\\cdots=a_{n}\\).\n\nSolution 4. By assumption \\(a_{i} b_{i}=a_{i-1}+a_{i+1}\\) for \\(i=\\{1,2, \\ldots, n\\}\\), hence,\n\\[\n\\sum_{i=1}^{n} a_{i} b_{i}=2 \\sum_{i=1}^{n} a_{i} .\n\\]\n\nSince \\(a_{i} \\leqslant a_{j}\\) if and only if \\(b_{i} \\leqslant b_{j}\\), the Chebyshev's inequality implies\n\\[\n\\left(\\sum_{i=1}^{n} a_{i}\\right) \\cdot\\left(\\sum_{i=1}^{n} b_{i}\\right) \\leqslant n \\cdot \\sum_{i=1}^{n} a_{i} b_{i}=2 n \\cdot \\sum_{i=1}^{n} a_{i}\n\\]\nand so \\(\\sum_{i=1}^{n} b_{i} \\leqslant 2 n\\). On the other hand, we have\n\\[\n\\sum_{i=1}^{n} b_{i}=\\sum_{i=1}^{n} \\frac{a_{i-1}}{a_{i}}+\\sum_{i=1}^{n} \\frac{a_{i+1}}{a_{i}}=\\sum_{i=1}^{n} \\frac{a_{i-1}}{a_{i}}+\\sum_{i=1}^{n} \\frac{a_{i}}{a_{i-1}}=\\sum_{i=1}^{n}\\left(\\frac{a_{i-1}}{a_{i}}+\\frac{a_{i}}{a_{i-1}}\\right),\n\\]\nso we can use the AM-GM inequality to estimate\n\\[\n\\sum_{i=1}^{n} b_{i} \\geqslant \\sum_{i=1}^{n} 2 \\sqrt{\\frac{a_{i-1}}{a_{i}} \\cdot \\frac{a_{i}}{a_{i-1}}}=2 n .\n\\]\n\nWe conclude that we must have equalities in all the above, which implies \\(\\frac{a_{i-1}}{a_{i}}=\\frac{a_{i}}{a_{i-1}}\\) and consequently \\(a_{i}=a_{i-1}\\) for all positive integers \\(i\\). Hence, all \\(a\\) 's are equal.\n\nSolution 5. As in Solution 4 we show that \\(\\sum_{i=1}^{n} b_{i} \\leqslant 2 n\\) and as in Solution 1 we show that \\(\\prod_{i=1}^{n} b_{i} \\geqslant 2^{n}\\). We now use the AM-GM inequality and the first inequality to get\n\\[\n\\prod_{i=1}^{n} b_{i} \\leqslant\\left(\\frac{1}{n} \\sum_{i=1}^{n} b_{i}\\right)^{n} \\leqslant\\left(\\frac{1}{n} \\cdot 2 n\\right)^{n}=2^{n}\n\\]\n\nThis implies that we must have equalities in all the above. In particular, we have equality in the AM-GM inequality, so all \\(b\\) 's are equal and as in Solution 2 then all \\(a\\) 's are equal.\n\nSolution 6. Let \\(a_{i}\\) to be minimal and \\(a_{j}\\) maximal among all \\(a\\) 's. Then\n\\[\nb_{j}=\\frac{a_{j-1}+a_{j+1}}{a_{j}} \\leqslant \\frac{2 a_{j}}{a_{j}}=2=\\frac{2 a_{i}}{a_{i}} \\leqslant \\frac{a_{i-1}+a_{i+1}}{a_{i}}=b_{i}\n\\]\nand by assumption \\(b_{i} \\leqslant b_{j}\\). Hence, we have equalities in the above so \\(b_{j}=2\\) so \\(a_{j-1}+ a_{j+1}=2 a_{j}\\) and therefore \\(a_{j-1}=a_{j}=a_{j+1}\\). We have thus shown that the two neighbors of a maximal \\(a\\) are also maximal. By an inductive argument all \\(a\\) 's are maximal, hence equal.\n\nSolution 7. Choose an arbitrary index \\(i\\) and assume without loss of generality that \\(a_{i} \\leqslant a_{i+1}\\). (If the opposite inequality holds, reverse all the inequalities below.) By induction we will show that for each \\(k \\in \\mathbb{N}_{0}\\) the following two inequalities hold\n\\[\n\\begin{gathered}\na_{i+1+k} \\geqslant a_{i-k} \\\\\na_{i+1+k} a_{i+1-k} \\geqslant a_{i-k} a_{i+k}\n\\end{gathered}\n\\]\n(where all indices are cyclic modulo \\(n\\) ). Both inequalities trivially hold for \\(k=0\\).\nAssume now that both inequalities hold for some \\(k \\geqslant 0\\). The inequality \\(a_{i+1+k} \\geqslant a_{i-k}\\) implies \\(b_{i+1+k} \\geqslant b_{i-k}\\), so\n\\[\n\\frac{a_{i+k}+a_{i+2+k}}{a_{i+1+k}} \\geqslant \\frac{a_{i-1-k}+a_{i+1-k}}{a_{i-k}} .\n\\]\n\nWe may rearrange this inequality by making \\(a_{i+2+k}\\) the subject so\n\\[\na_{i+2+k} \\geqslant \\frac{a_{i+1+k} a_{i-1-k}}{a_{i-k}}+\\frac{a_{i+1-k} a_{i+1+k}-a_{i+k} a_{i-k}}{a_{i-k}} \\geqslant \\frac{a_{i+1+k} a_{i-1-k}}{a_{i-k}},\n\\]\nwhere the last inequality holds by (2). It follows that\n\\[\na_{(i+1)+(k+1)} a_{(i+1)-(k+1)} \\geqslant a_{i+(k+1)} a_{i-(k+1)},\n\\]\ni.e. the inequality (2) holds also for \\(k+1\\). Using (1) we now get\n\\[\na_{(i+1)+(k+1)} \\geqslant \\frac{a_{i+k+1}}{a_{i-k}} a_{i-(k+1)} \\geqslant a_{i-(k+1)}\n\\]\ni.e. (1) holds for \\(k+1\\).\nNow we use the inequality (1) for \\(k=n-1\\). We get \\(a_{i} \\geqslant a_{i+1}\\), and since at the beginning we assumed \\(a_{i} \\leqslant a_{i+1}\\), we get that any two consecutive \\(a\\) 's are equal, so all of them are equal.\n\nSolution 8. We first prove the following claim by induction:\nClaim 1: If \\(a_{k} a_{k+2}<a_{k+1}^{2}\\) and \\(a_{k}<a_{k+1}\\), then \\(a_{j} a_{j+2}<a_{j+1}^{2}\\) and \\(a_{j}<a_{j+1}\\) for all \\(j\\).\nWe assume that \\(a_{i} a_{i+2}<a_{i+1}^{2}\\) and \\(a_{i}<a_{i+1}\\), and then show that \\(a_{i-1} a_{i+1}<a_{i}^{2}\\) and \\(a_{i-1}<a_{i}\\).\n\nSince \\(a_{i} \\leq a_{i+1}\\) we have that \\(b_{i} \\leq b_{i+1}\\). By plugging in the definition of \\(b_{i}\\) and \\(b_{i+1}\\) we have that\n\\[\na_{i+1} a_{i-1}+a_{i+1}^{2} \\leq a_{i}^{2}+a_{i+2} a_{i} .\n\\]\n\nUsing \\(a_{i} a_{i+2}<a_{i+1}^{2}\\) we get that\n\\[\na_{i+1} a_{i-1}<a_{i}^{2}\n\\]\n\nSince \\(a_{i}<a_{i+1}\\) we have that \\(a_{i-1}<a_{i}\\), which concludes the induction step and hence proves the claim.\n\nWe cannot have that \\(a_{j}<a_{j+1}\\) for all indices \\(j\\). Similar as in the above claim, one can prove that if \\(a_{k} a_{k+2}<a_{k+1}^{2}\\) and \\(a_{k+2}<a_{k+1}\\), then \\(a_{j+1}<a_{j}\\) for all \\(j\\), which also cannot be the case. Thus we have that \\(a_{k} a_{k+2} \\geq a_{k+1}^{2}\\) for all indices \\(k\\).\n\nNext observe (e.g. by taking the product over all indices) that this implies \\(a_{k} a_{k+2}=a_{k+1}^{2}\\) for all indices \\(k\\), which is equivalent to \\(b_{k}=b_{k+1}\\) for all \\(k\\) and hence \\(a_{k+1}=a_{k}\\) for all \\(k\\).\n\nSolution 9. Define \\(c_{i}:=\\frac{a_{i}}{a_{i+1}}\\), then \\(b_{i}=c_{i-1}+1 / c_{i}\\). Assume that not all \\(c_{i}\\) are equal to 1. Since, \\(\\prod_{i=1}^{n} c_{i}=1\\) there exists a \\(k\\) such that \\(c_{k} \\geqslant 1\\). From the condition given in the problem statement for \\((i, j)=(k, k+1)\\) we have\n\\[\nc_{k} \\geqslant 1 \\Longleftrightarrow c_{k-1}+\\frac{1}{c_{k}} \\geqslant c_{k}+\\frac{1}{c_{k+1}} \\Longleftrightarrow c_{k-1} c_{k} c_{k+1}+c_{k+1} \\geqslant c_{k}^{2} c_{k+1}+c_{k}\n\\]\n\nNow since \\(c_{k+1} \\leqslant c_{k}^{2} c_{k+1}\\), it follows that\n\\[\nc_{i-1} c_{i} c_{i+1} \\geqslant c_{i} \\Longrightarrow\\left(c_{i-1} \\geqslant 1 \\text { or } c_{i+1} \\geqslant 1\\right) .\n\\]\n\nSo there exist a set of at least 2 consecutive integers, such that the corresponding \\(c_{i}\\) are greater or equal to one. By the innitial assumption there must exist an index \\(\\ell\\), such that \\(c_{\\ell-1}, c_{\\ell} \\geqslant 1\\) and \\(c_{\\ell+1}<1\\). We distinguish two cases:\n\nCase 1: \\(c_{\\ell}>c_{\\ell-1} \\geqslant 1\\)\nFrom \\(c_{\\ell-1} c_{\\ell} c_{\\ell+1}<c_{\\ell}^{2} c_{\\ell+1}\\) and the inequality (5), we get that \\(c_{\\ell+1}>c_{\\ell} \\geqslant 1\\), which is a contradiction to our choice of \\(\\ell\\).\n\nCase 2: \\(c_{\\ell-1} \\geqslant c_{\\ell} \\geqslant 1\\)\nOnce again looking at the inequality (5) we can find that\n\\[\nc_{\\ell-2} c_{\\ell-1} c_{\\ell} \\geqslant c_{\\ell-1}^{2} c_{\\ell} \\Longrightarrow c_{\\ell-2} \\geqslant c_{\\ell-1}\n\\]\n\nNote that we only needed \\(c_{\\ell-1} \\geqslant c_{\\ell} \\geqslant 1\\) to show \\(c_{\\ell-2} \\geqslant c_{\\ell-1} \\geqslant 1\\). So using induction we can easily show \\(c_{\\ell-s-1} \\geqslant c_{\\ell-s}\\) for all \\(s\\).\nSo\n\\[\nc_{1} \\leqslant c_{2} \\leqslant \\cdots \\leqslant c_{n} \\leqslant c_{1}\n\\]\na contradiction to our innitial assumption.\n\nSo our innitial assumtion must have been wrong, which implies that all the \\(a_{i}\\) must have been equal from the start.", "source_pdf": "egmo_2023.pdf", "notes": "fallback-regex"}
{"id": "EGMO-2023-2", "contest": "EGMO", "year": "2023", "problem_number": "2", "problem": "We are given an acute triangle \\(A B C\\). Let \\(D\\) be the point on its circumcircle such that \\(A D\\) is a diameter. Suppose that points \\(K\\) and \\(L\\) lie on segments \\(A B\\) and \\(A C\\), respectively, and that \\(D K\\) and \\(D L\\) are tangent to circle \\(A K L\\).\n\nShow that line \\(K L\\) passes through the orthocentre of \\(A B C\\).\nThe altitudes of a triangle meet at its orthocentre.", "solution": "\\begin{figure}\n\\includegraphics[width=\\textwidth]{https://cdn.mathpix.com/cropped/2025_08_23_146291bab5ef73d6732cg-07.jpg?height=1066&width=992&top_left_y=708&top_left_x=533}\n\\captionsetup{labelformat=empty}\n\\caption{Figure 1: Diagram to solution 1}\n\\end{figure}\n\nSolution 1. Let \\(M\\) be the midpoint of \\(K L\\). We will prove that \\(M\\) is the orthocentre of \\(A B C\\). Since \\(D K\\) and \\(D L\\) are tangent to the same circle, \\(|D K|=|D L|\\) and hence \\(D M \\perp K L\\). The theorem of Thales in circle \\(A B C\\) also gives \\(D B \\perp B A\\) and \\(D C \\perp C A\\). The right angles then give that quadrilaterals \\(B D M K\\) and \\(D M L C\\) are cyclic.\n\nIf \\(\\angle B A C=\\alpha\\), then clearly \\(\\angle D K M=\\angle M L D=\\alpha\\) by angle in the alternate segment of circle \\(A K L\\), and so \\(\\angle M D K=\\angle L D M=\\frac{\\pi}{2}-\\alpha\\), which thanks to cyclic quadrilaterals gives \\(\\angle M B K=\\angle L C M=\\frac{\\pi}{2}-\\alpha\\). From this, we have \\(B M \\perp A C\\) and \\(C M \\perp A B\\), and so \\(M\\) indeed is the orthocentre of \\(A B C\\).\n\n\\section*{Solution 2. Preliminaries}\n\nLet \\(A B C\\) be a triangle with circumcircle \\(\\Gamma\\). Let \\(X\\) be a point in the plane. The Simson line (Wallace-Simson line) is defined via the following theorem. Drop perpendiculars from \\(X\\) to each of the three side lines of \\(A B C\\). The feet of these perpendiculars are collinear (on\nthe Simson line of \\(X\\) ) if and only if \\(X\\) lies of \\(\\Gamma\\). The Simson line of \\(X\\) in the circumcircle bisects the line segment \\(X H\\) where \\(H\\) is the orthocentre of triangle \\(A B C\\). See Figure 2\n\n\\begin{figure}\n\\includegraphics[width=\\textwidth]{https://cdn.mathpix.com/cropped/2025_08_23_146291bab5ef73d6732cg-08.jpg?height=573&width=1184&top_left_y=396&top_left_x=436}\n\\captionsetup{labelformat=empty}\n\\caption{Figure 2: The Wallace-Simson configuration}\n\\end{figure}\n\nWhen \\(X\\) is on \\(\\Gamma\\), we can enlarge from \\(X\\) with scale factor 2 (a homothety) to take the Simson line to the doubled Simson line which passes through the orthocentre \\(H\\) and contains the reflections of \\(X\\) in each of the three sides of \\(A B C\\).\n\n\\section*{Solution of the problem}\n\n\\begin{figure}\n\\includegraphics[width=\\textwidth]{https://cdn.mathpix.com/cropped/2025_08_23_146291bab5ef73d6732cg-08.jpg?height=798&width=795&top_left_y=1376&top_left_x=633}\n\\captionsetup{labelformat=empty}\n\\caption{Figure 3: Three circles do the work}\n\\end{figure}\n\nLet \\(\\Gamma\\) be the circle \\(A B C, \\Sigma\\) be the circle \\(A K L\\) with centre \\(O\\), and \\(\\Omega\\) be the circle on diameter \\(O D\\) so \\(K\\) and \\(L\\) are on this circle by converse of Thales. Let \\(\\Omega\\) and \\(\\Gamma\\) meet at \\(D\\) and \\(F\\). By Thales in both circles, \\(\\angle A F D\\) and \\(\\angle O F D\\) are both right angles so \\(A O F\\) is a line. Let \\(A F\\) meet \\(\\Sigma\\) again at \\(T\\) so \\(A T\\) (containing \\(O\\) ) is a diameter of this circle and by Thales, \\(T L \\perp A C\\).\n\nLet \\(G\\) (on \\(\\Sigma\\) ) be the reflection of \\(K\\) in \\(A F\\). Now \\(A T\\) is the internal angle bisector of \\(\\angle G A K\\) so, by an upmarket use of angles in the same segment (of \\(\\Sigma\\) ), \\(T L\\) is the internal\nangle bisector of \\(\\angle G L K\\). Thus the line \\(G L\\) is the reflection of the line \\(K L\\) in \\(T L\\), and so also the reflection of \\(K L\\) in the line \\(A C\\) (internal and external angle bisectors).\n\nOur next project is to show that \\(L G F\\) are collinear. Well \\(\\angle F L K=\\angle F O K\\) (angles in the same segment of \\(\\Omega)\\) and \\(\\angle G L K=\\angle G A K(\\) angles in the same segment of \\(\\Sigma)=2 \\angle O A K\\) ( \\(A K G\\) is isosceles with apex \\(A\\) ) = \\(\\angle T O K\\) (since \\(O A K\\) is isosceles with apex \\(O\\), and this is an external angle at \\(O\\) ). The point \\(T\\) lies in the interior of the line segment \\(F O\\) so \\(\\angle T O K=\\angle F O K\\). Therefore \\(\\angle F L K=\\angle G L K\\) so \\(L G F\\) is a line.\n\nNow from the second paragraph, \\(F\\) is on the reflection of \\(K L\\) in \\(A C\\). By symmetry, \\(F\\) is also on the reflection of \\(K L\\) in \\(A B\\). Therefore the reflections of \\(F\\) in \\(A B\\) and \\(A C\\) are both on \\(K L\\) which must therefore be the doubled Wallace-Simson line of \\(F\\). Therefore the orthocentre of \\(A B C\\) lies on \\(K L\\).\n\nSolution 3. Let \\(H\\) be the orthocentre of triangle \\(A B C\\) and \\(\\Sigma\\) the circumcircle of \\(A K L\\) with centre \\(O\\). Let \\(\\Omega\\) be the circle with diameter \\(O D\\), which contains \\(K\\) and \\(L\\) by Thales, and let \\(\\Gamma\\) be the circumcircle of \\(A B C\\) containing \\(D\\). Denote the second intersection of \\(\\Omega\\) and \\(\\Gamma\\) by \\(F\\). Since \\(O D\\) and \\(A D\\) are diameters of \\(\\Omega\\) and \\(\\Gamma\\) we have \\(\\angle O F D=\\frac{\\pi}{2}=\\angle A F D\\), so the points \\(A, O, F\\) are collinear. Let \\(M\\) and \\(N\\) be the second intersections of \\(C H\\) and \\(B H\\) with \\(\\Gamma\\), respectively. It is well-known that \\(M\\) and \\(N\\) are the reflections of \\(H\\) in \\(A B\\) and \\(A C\\), respectively (because \\(\\angle N C A=\\angle N B A=\\angle A C M=\\angle A B M\\) ). By collinearity of \\(A, O, F\\) and the angles in \\(\\Gamma\\) we have\n\\[\n\\angle N F O=\\angle N F A=\\angle N B A=\\frac{\\pi}{2}-\\angle B A C=\\frac{\\pi}{2}-\\angle K A L .\n\\]\n\nSince \\(D L\\) is tangent to \\(\\Sigma\\) we obtain\n\\[\n\\angle N F O=\\frac{\\pi}{2}-\\angle K L D=\\angle L D O,\n\\]\nwhere the last equality follows from the fact that \\(O D\\) is bisector of \\(\\angle L D K\\) since \\(L D\\)\n\n\\begin{figure}\n\\includegraphics[width=\\textwidth]{https://cdn.mathpix.com/cropped/2025_08_23_146291bab5ef73d6732cg-09.jpg?height=801&width=795&top_left_y=1798&top_left_x=633}\n\\captionsetup{labelformat=empty}\n\\caption{Figure 4: Diagram to Solution 3}\n\\end{figure}\nand \\(K D\\) are tangent to \\(\\Sigma\\). Furthermore, \\(\\angle L D O=\\angle L F O\\) since these are angles in \\(\\Omega\\). Hence, \\(\\angle N F O=\\angle L F O\\), which implies that points \\(N, L, F\\) are collinear. Similarly points \\(M, K, F\\) are collinear. Since \\(N\\) and \\(M\\) are reflections of \\(H\\) in \\(A C\\) and \\(A B\\) we have\n\\[\n\\angle L H N=\\angle H N L=\\angle B N F=\\angle B M F=\\angle B M K=\\angle K H B .\n\\]\n\nHence,\n\\[\n\\angle L H K=\\angle L H N+\\angle N H K=\\angle K H B+\\angle N H K=\\pi\n\\]\nand the points \\(L, H, K\\) are collinear.\n\nSolution 4. As in Solution 3 let \\(M\\) and \\(N\\) be the reflections of the orthocentre in \\(A B\\) and \\(A C\\). Let \\(\\angle B A C=\\alpha\\). Then \\(\\angle N D M=\\pi-\\angle M A N=\\pi-2 \\alpha\\).\n\nLet \\(M K\\) and \\(N L\\) intersect at \\(F\\). See Figure 3.\nClaim. \\(\\angle N F M=\\pi-2 \\alpha\\), so \\(F\\) lies on the circumcircle.\nProof. Since \\(K D\\) and \\(L D\\) are tangents to circle \\(A K L\\), we have \\(|D K|=|D L|\\) and \\(\\angle D K L=\\angle K L D=\\alpha\\), so \\(\\angle L D K=\\pi-2 \\alpha\\).\n\nBy definition of \\(M, N\\) and \\(D, \\angle M N D=\\angle A N D-\\angle A N M=\\frac{\\pi}{2}-\\left(\\frac{\\pi}{2}-\\alpha\\right)=\\alpha\\) and analogously \\(\\angle D M N=\\alpha\\). Hence \\(|D M|=|D N|\\).\n\nFrom \\(\\angle N D M=\\angle L D K=\\pi-2 \\alpha\\) if follows that \\(\\angle L D N=\\angle K D M\\). Since \\(|D K|=|D L|\\) and \\(|D M|=|D N|\\), triangles \\(M D K\\) and \\(N D L\\) are related by a rotation about \\(D\\) through angle \\(\\pi-2 \\alpha\\), and hence the angle between \\(M K\\) and \\(N L\\) is \\(\\pi-2 \\alpha\\), which proved the claim.\n\nWe now finish as in Solution 3:\n\\[\n\\begin{gathered}\n\\angle M H K=\\angle K M H=\\angle F M C=\\angle F A C, \\\\\n\\angle L H N=\\angle H N L=\\angle B N F=\\angle B A F .\n\\end{gathered}\n\\]\n\nAs \\(\\angle B A F+\\angle F A C=\\alpha\\), we have \\(\\angle L H K=\\alpha+\\angle N H M=\\alpha+\\pi-\\alpha=\\pi\\), so \\(H\\) lies on \\(K L\\) \u3002\n\nSolution 5. Since \\(A D\\) is a diameter, it is well known that \\(D B H C\\) is a parallelogram (indeed, both \\(B D\\) and \\(C H\\) are perpendicular to \\(A B\\), hence parallel, and similarly for \\(D C \\| B H\\) ). Let \\(B^{\\prime}, C^{\\prime}\\) be the reflections of \\(D\\) in lines \\(A K B\\) and \\(A L C\\), respectively; since \\(A B D\\) and \\(A C D\\) are right angles, these are also the factor-2 homotheties of \\(B\\) and \\(C\\) with respect to \\(D\\), hence \\(H\\) is the midpoint of \\(B^{\\prime} C^{\\prime}\\). We will prove that \\(B^{\\prime} K C^{\\prime} L\\) is a parallelogram: it will then follow that the midpoint of \\(B^{\\prime} C^{\\prime}\\), which is \\(H\\), is also the midpoint of \\(K L\\), and in particular is on the line, as we wanted to show.\n\nWe will prove \\(B^{\\prime} K C^{\\prime} L\\) is a parallelogram by showing that \\(B^{\\prime} K\\) and \\(C^{\\prime} L\\) are the same length and direction. Indeed, for lengths we have \\(K B^{\\prime}=K D=L D=L C^{\\prime}\\), where the first and last equalities arise from the reflections defining \\(B^{\\prime}\\) and \\(C^{\\prime}\\), and the middle one\nis equality of tangents. For directions, let \\(\\alpha, \\beta, \\gamma\\) denote the angles of triangle \\(A K L\\). Immediate angle chasing in the circle \\(A K L\\), and the properties of the reflections, yield\n\\[\n\\begin{gathered}\n\\angle C^{\\prime} L C=\\angle C L D=\\angle A K L=\\beta \\\\\n\\angle B K B^{\\prime}=\\angle D K B=\\angle K L A=\\gamma \\\\\n\\angle L D K=2 \\alpha-\\pi\n\\end{gathered}\n\\]\nand therefore in directed angles \\((\\bmod 2 \\pi)\\) we have\n\\(\\angle\\left(C^{\\prime} L, B^{\\prime} K\\right)=\\angle C^{\\prime} L C+\\angle C L D+\\angle L D K+\\angle D K B+\\angle B K B^{\\prime}=2 \\alpha+2 \\beta+2 \\gamma-\\pi=\\pi\\)\nand hence \\(C^{\\prime} L\\) and \\(B^{\\prime} K\\) are parallel and in opposite directions, i.e. \\(C^{\\prime} L\\) and \\(K B^{\\prime}\\) are in the same direction, as claimed. Comment. While not necessary for the final solution, the following related observation motivates how the fact that \\(H\\) is the midpoint of \\(K L\\) (and therefore \\(B^{\\prime} K C^{\\prime} L\\) is a parallelogram) was first conjectured. We have \\(A B^{\\prime}=A D=A C^{\\prime}\\) by the reflections, i.e. \\(B^{\\prime} A C^{\\prime}\\) is an isosceles triangle with \\(H\\) being the midpoint of the base. Thus \\(A H\\) is the median, altitude and angle bisector in \\(B^{\\prime} A C^{\\prime}\\), thus \\(\\angle B^{\\prime} A K+\\angle K A H=\\angle H A L+\\angle L A C^{\\prime}\\). Since from the reflections we also have \\(\\angle B^{\\prime} A K=\\angle K A D\\) and \\(\\angle D A L=\\angle L A C^{\\prime}\\) it follows that \\(\\angle H A L=\\angle K A D\\) and \\(\\angle K A H=\\angle D A L\\). Since \\(D\\) is the symmedian point in \\(A K L\\), the angle conjugation implies \\(A H\\) is the median line of \\(K L\\). Thus, if \\(H\\) is indeed on \\(K L\\) (as the problem assures us), it can only be the midpoint of \\(K L\\).\n\nSolution 6. There are a number of \"phantom point\" arguments which define \\(K^{\\prime}\\) and \\(L^{\\prime}\\) in terms of angles and then deduce that these points are actually \\(K\\) and \\(L\\).\n\nNote: In these solutions it is necessary to show that \\(K\\) and \\(L\\) are uniquely determined by the conditions of the problem. One example of doing this is the following:\n\nTo prove uniqueness of \\(K\\) and \\(L\\), let us consider that there exist two other points \\(K^{\\prime}\\) and \\(L^{\\prime}\\) that satisfy the same properties ( \\(K^{\\prime}\\) on \\(A B\\) and \\(L^{\\prime}\\) on \\(A C\\) such that \\(D K^{\\prime}\\) and \\(D L^{\\prime}\\) are tangent to the circle \\(A K^{\\prime} L^{\\prime}\\) ).\nThen, we have that \\(D K=D L\\) and \\(D K^{\\prime}=D L^{\\prime}\\). We also have that \\(\\angle K D L=\\angle K^{\\prime} D L^{\\prime}= \\pi-2 \\angle A\\). Hence, we deduce \\(\\angle K D K^{\\prime}=\\angle K D L-\\angle K^{\\prime} D L=\\angle K^{\\prime} D L^{\\prime}-\\angle K^{\\prime} D L=\\angle L D L^{\\prime}\\) Thus we have that \\(\\triangle K D K^{\\prime} \\equiv \\triangle L D L^{\\prime}\\), so we deduce \\(\\angle D K A=\\angle D K K^{\\prime}=\\angle D L L^{\\prime}= \\pi-\\angle A L D\\). This implies that \\(A K D L\\) is concyclic, which is clearly a contradiction since \\(\\angle K A L+\\angle K D L=\\pi-\\angle B A C\\).\n\nSolution 7. We will use the usual complex number notation, where we will use a capital letter (like \\(Z\\) ) to denote the point associated to a complex number (like \\(z\\) ). Consider \\(\\triangle A K L\\) on the unit circle. So, we have \\(a \\cdot \\bar{a}=k \\cdot \\bar{k}=l \\cdot \\bar{l}=1\\) As point \\(D\\) is the intersection of the tangents to the unit circle at \\(K\\) and \\(L\\), we have that\n\\[\nd=\\frac{2 k l}{k+l} \\text { and } \\bar{d}=\\frac{2}{k+l}\n\\]\n\nDefining \\(B\\) as the foot of the perpendicular from \\(D\\) on the line \\(A K\\), and \\(C\\) as the foot of the perpendicular from \\(D\\) on the line \\(A L\\), we have the formulas:\n\\[\nb=\\frac{1}{2}\\left(d+\\frac{(a-k) \\bar{d}+\\bar{a} k-a \\bar{k}}{\\bar{a}-\\bar{k}}\\right)\n\\]\n\\[\nc=\\frac{1}{2}\\left(d+\\frac{(a-l) \\bar{d}+\\bar{a} l-a \\bar{l}}{\\bar{a}-\\bar{l}}\\right)\n\\]\n\nSimplyfing these formulas, we get:\n\\[\n\\begin{gathered}\nb=\\frac{1}{2}\\left(d+\\frac{(a-k) \\frac{2}{k+l}+\\frac{k}{a}-\\frac{a}{k}}{\\frac{1}{a}-\\frac{1}{k}}\\right)=\\frac{1}{2}\\left(d+\\frac{\\frac{2(a-k)}{k+l}+\\frac{k^{2}-a^{2}}{a k}}{\\frac{k-a}{a k}}\\right) \\\\\nb=\\frac{1}{2}\\left(\\frac{2 k l}{k+l}-\\frac{2 a k}{k+l}+(a+k)\\right)=\\frac{k(l-a)}{k+l}+\\frac{1}{2}(k+a) \\\\\nc=\\frac{1}{2}\\left(d+\\frac{(a-l) \\frac{2}{k+l}+\\frac{l}{a}-\\frac{a}{l}}{\\frac{1}{a}-\\frac{1}{l}}\\right)=\\frac{1}{2}\\left(d+\\frac{\\frac{2(a-l)}{k+l}+\\frac{l^{2}-a^{2}}{a l}}{\\frac{l-a}{a l}}\\right) \\\\\nc=\\frac{1}{2}\\left(\\frac{2 k l}{k+l}-\\frac{2 a l}{k+l}+(a+l)\\right)=\\frac{l(k-a)}{k+l}+\\frac{1}{2}(l+a)\n\\end{gathered}\n\\]\n\nLet \\(O\\) be the the circumcenter of triangle \\(\\triangle A B C\\). As \\(A D\\) is the diameter of this circle, we have that:\n\\[\no=\\frac{a+d}{2}\n\\]\n\nDefining \\(H\\) as the orthocentre of the \\(\\triangle A B C\\), we get that:\n\\[\n\\begin{gathered}\nh=a+b+c-2 \\cdot o=a+\\left(\\frac{k(l-a)}{k+l}+\\frac{1}{2}(k+a)\\right)+\\left(\\frac{l(k-a)}{k+l}+\\frac{1}{2}(l+a)\\right)-(a+d) \\\\\nh=a+\\frac{2 k l}{k+l}-\\frac{a(k+l)}{k+l}+\\frac{1}{2} k++\\frac{1}{2} l++a-\\left(a+\\frac{2 k l}{k+l}\\right) \\\\\nh=\\frac{1}{2}(k+l)\n\\end{gathered}\n\\]\n\nHence, we conclude that \\(H\\) is the midpoint of \\(K L\\), so \\(H, K, L\\) are collinear.\n\nSolution 8. Let us employ the barycentric coordinates. Set \\(A(1,0,0), K(0,1,0), L(0,0,1)\\). The tangent at \\(K\\) of ( \\(A K L\\) ) is \\(a^{2} z+c^{2} x=0\\), and the tangent of of \\(L\\) at ( \\(A K L\\) ) is \\(a^{2} y+b^{2} x=0\\). Their intersection is\n\\[\nD\\left(-a^{2}: b^{2}: c^{2}\\right)\n\\]\n\nSince \\(B \\in A K\\), we can let \\(B(1-t, t, 0)\\). Solving for \\(\\overrightarrow{A B} \\cdot \\overrightarrow{B D}=0\\) gives\n\\[\nt=\\frac{3 b^{2}+c^{2}-a^{2}}{2\\left(b^{2}+c^{2}-a^{2}\\right)} \\Longrightarrow B=\\left(\\frac{-a^{2}-b^{2}+c^{2}}{2\\left(b^{2}+c^{2}-a^{2}\\right)}, \\frac{-a^{2}+3 b^{2}+c^{2}}{2\\left(b^{2}+c^{2}-a^{2}\\right)}, 0\\right)\n\\]\n\nLikewise, \\(C\\) has the coordinate\n\\[\nC=\\left(\\frac{-a^{2}+b^{2}-c^{2}}{2\\left(b^{2}+c^{2}-a^{2}\\right)}, 0, \\frac{-a^{2}+b^{2}+3 c^{2}}{2\\left(b^{2}+c^{2}-a^{2}\\right)}\\right)\n\\]\n\nThe altitude from \\(B\\) for triangle \\(A B C\\) is\n\\[\n-b^{2}\\left(x-z-\\frac{-a^{2}-b^{2}+c^{2}}{2\\left(b^{2}+c^{2}-a^{2}\\right)}\\right)+\\left(c^{2}-a^{2}\\right)\\left(y-\\frac{-a^{2}+3 b^{2}+c^{2}}{2\\left(b^{2}+c^{2}-a^{2}\\right)}\\right)=0\n\\]\n\nAlso the altitude from \\(C\\) for triangle \\(A B C\\) is\n\\[\n-c^{2}\\left(x-y-\\frac{-a^{2}+b^{2}-c^{2}}{2\\left(b^{2}+c^{2}-a^{2}\\right)}\\right)+\\left(a^{2}-b^{2}\\right)\\left(z-\\frac{-a^{2}+b^{2}+3 c^{2}}{2\\left(b^{2}+c^{2}-a^{2}\\right)}\\right)=0 .\n\\]\n\nThe intersection of these two altitudes, which is the orthocenter of triangle \\(A B C\\), has the barycentric coordinate\n\\[\nH=(0,1 / 2,1 / 2),\n\\]\nwhich is the midpoint of the segment \\(K L\\).", "source_pdf": "egmo_2023.pdf", "notes": "fallback-regex"}
{"id": "EGMO-2023-3", "contest": "EGMO", "year": "2023", "problem_number": "3", "problem": "Let \\(k\\) be a positive integer. Lexi has a dictionary \\(\\mathcal{D}\\) consisting of some \\(k\\)-letter strings containing only the letters \\(A\\) and \\(B\\). Lexi would like to write either the letter \\(A\\) or the letter \\(B\\) in each cell of a \\(k \\times k\\) grid so that each column contains a string from \\(\\mathcal{D}\\) when read from top-to-bottom and each row contains a string from \\(\\mathcal{D}\\) when read from left-to-right.\n\nWhat is the smallest integer \\(m\\) such that if \\(\\mathcal{D}\\) contains at least \\(m\\) different strings, then Lexi can fill her grid in this manner, no matter what strings are in \\(\\mathcal{D}\\) ?", "solution": "We claim the minimum value of \\(m\\) is \\(2^{k-1}\\).\nFirstly, we provide a set \\(\\mathcal{S}\\) of size \\(2^{k-1}-1\\) for which Lexi cannot fill her grid. Consider the set of all length- \\(k\\) strings containing only \\(A\\) s and \\(B\\) s which end with a \\(B\\), and remove the string consisting of \\(k B\\) s. Clearly there are 2 independent choices for each of the first \\(k-1\\) letters and 1 for the last letter, and since exactly one string is excluded, there must be exactly \\(2^{k-1}-1\\) strings in this set.\n\nSuppose Lexi tries to fill her grid. For each row to have a valid string, it must end in a \\(B\\). But then the right column would necessarily contain \\(k B s\\), and not be in our set. Thus, Lexi cannot fill her grid with our set, and we must have \\(m \\geqslant 2^{k-1}\\).\n\nNow, consider any set \\(\\mathcal{S}\\) with at least \\(2^{k-1}\\) strings. Clearly, if \\(\\mathcal{S}\\) contained either the uniform string with \\(k A\\) s or the string with \\(k B\\) s, then Lexi could fill her grid with all of the relevant letters and each row and column would contain that string.\n\nConsider the case where \\(\\mathcal{S}\\) contains neither of those strings. Among all \\(2^{k}\\) possible length\\(k\\) strings with \\(A\\) s and \\(B\\) s, each has a complement which corresponds to the string with \\(B\\) s in every position where first string had \\(A\\) s and vice-versa. Clearly, the string with all \\(A\\) s is paired with the string with all \\(B\\) s. We may assume that we do not take the two uniform strings and thus applying the pigeonhole principle to the remaining set of strings, we must have two strings which are complementary.\n\nLet this pair of strings be \\(\\ell, \\ell^{\\prime} \\in \\mathcal{S}\\) in some order. Define the set of indices \\(\\mathcal{J}\\) corresponding to the \\(A\\) s in \\(\\ell\\) and thus the \\(B\\) s in \\(\\ell^{\\prime}\\), and all other indices (not in \\(\\mathcal{J}\\) ) correspond to \\(B\\) s in \\(\\ell\\) (and thus \\(A\\) s in \\(\\ell^{\\prime}\\) ). Then, we claim that Lexi puts an \\(A\\) in the cell in row \\(r\\), column \\(c\\) if \\(r, c \\in \\mathcal{J}\\) or \\(r, c \\notin \\mathcal{J}\\), and a \\(B\\) otherwise, each row and column contains a string in \\(\\mathcal{S}\\).\n\nWe illustrate this with a simple example: If \\(k=6\\) and we have that \\(A A A B A B\\) and \\(B B B A B A\\) are both in the dictionary, then Lexi could fill the table as follows:\n\n\\begin{tabular}{|c|c|c|c|c|c|}\n\\hline A & A & A & B & A & B \\\\\n\\hline A & A & A & B & A & B \\\\\n\\hline A & A & A & B & A & B \\\\\n\\hline B & B & B & A & B & A \\\\\n\\hline A & A & A & B & A & B \\\\\n\\hline B & B & B & A & B & A \\\\\n\\hline\n\\end{tabular}\n\nSuppose we are looking at row \\(i\\) or column \\(i\\) for \\(i \\in \\mathcal{J}\\). Then by construction the string in this row/column contains \\(A\\) s at indices \\(k\\) with \\(k \\in \\mathcal{J}\\) and \\(B\\) s elsewhere, and thus is precisely \\(\\ell\\). Suppose instead we are looking at row \\(i\\) or column \\(i\\) for \\(i \\notin \\mathcal{J}\\). Then again\nby construction the string in this row/column contains \\(A\\) s at indices \\(k\\) with \\(k \\notin \\mathcal{J}\\) and \\(B\\) s elsewhere, and thus is precisely \\(\\ell^{\\prime}\\). So each row and column indeed contains a string in \\(\\mathcal{S}\\).\nThus, for any \\(\\mathcal{S}\\) with \\(|\\mathcal{S}| \\geqslant 2^{k-1}\\), Lexi can definitely fill the grid appropriately. Since we know \\(m \\geqslant 2^{k-1}, 2^{k-1}\\) is the minimum possible value of \\(m\\) as claimed.", "source_pdf": "egmo_2023.pdf", "notes": "fallback-regex"}
{"id": "EGMO-2023-5", "contest": "EGMO", "year": "2023", "problem_number": "5", "problem": "We are given a positive integer \\(s \\geqslant 2\\). For each positive integer \\(k\\), we define its twist \\(k^{\\prime}\\) as follows: write \\(k\\) as \\(a s+b\\), where \\(a, b\\) are non-negative integers and \\(b<s\\), then \\(k^{\\prime}=b s+a\\). For the positive integer \\(n\\), consider the infinite sequence \\(d_{1}, d_{2}, \\ldots\\) where \\(d_{1}=n\\) and \\(d_{i+1}\\) is the twist of \\(d_{i}\\) for each positive integer \\(i\\).\n\nProve that this sequence contains 1 if and only if the remainder when \\(n\\) is divided by \\(s^{2}-1\\) is either 1 or \\(s\\).", "solution": "Solution 1. First, we consider the difference \\(k-k^{\\prime \\prime}\\). If \\(k=a s+b\\) as in the problem statement, then \\(k^{\\prime}=b s+a\\). We write \\(a=l s+m\\) with \\(m, l\\) non-negative numbers and \\(m \\leq s-1\\). This gives \\(k^{\\prime \\prime}=m s+(b+l)\\) and hence \\(k-k^{\\prime \\prime}=(a-m) s-l=l\\left(s^{2}-1\\right)\\).\n\nWe conclude\nFact 1.1. \\(k \\geq k^{\\prime \\prime}\\) for every every \\(k \\geq 1\\)\nFact 1.2. \\(s^{2}-1\\) divides the difference \\(k-k^{\\prime \\prime}\\).\nFact 1.2 implies that the sequences \\(d_{1}, d_{3}, d_{5}, \\ldots\\) and \\(d_{2}, d_{4}, d_{6}, \\ldots\\) are constant modulo \\(s^{2}-1\\). Moreover, Fact 1.1 says that the sequences are (weakly) decreasing and hence eventually constant. In other words, the sequence \\(d_{1}, d_{2}, d_{3}, \\ldots\\) is 2 -periodic modulo \\(s^{2}-1\\) (from the start) and is eventually 2 -periodic.\n\nNow, assume that some term in the sequence is equal to 1 . The next term is equal to \\(1^{\\prime}=s\\) and since the sequence is 2 -periodic from the start modulo \\(s^{2}-1\\), we conclude that \\(d_{1}\\) is either equal to 1 or \\(s\\) modulo \\(s^{2}-1\\). This proves the first implication.\n\nTo prove the other direction, assume that \\(d_{1}\\) is congruent to 1 or \\(s\\) modulo \\(s^{2}-1\\). We need the observation that once one of the sequences \\(d_{1}, d_{3}, d_{5}, \\ldots\\) or \\(d_{2}, d_{4}, d_{6}, \\ldots\\) stabilises, then their value is less than \\(s^{2}\\). This is implied by the following fact.\n\nFact 1.3. If \\(k=k^{\\prime \\prime}\\), then \\(k=k^{\\prime \\prime}<s^{2}\\).\n\nProof. We use the expression for \\(k-k^{\\prime \\prime}\\) found before. If \\(k=k^{\\prime \\prime}\\), then \\(l=0\\), and so \\(k^{\\prime \\prime}=m s+b\\). Both \\(m\\) and \\(b\\) are reminders after division by \\(s\\), so they are both \\(\\leq s-1\\). This gives \\(k^{\\prime \\prime} \\leq(s-1) s+(s-1)<s^{2}\\).\n\nUsing Fact 1.2, it follows that the sequence \\(d_{1}, d_{3}, d_{5}, \\ldots\\) is constant to 1 or \\(s\\) modulo \\(s^{2}-1\\) and stabilises to 1 or \\(s\\) by Fact 1.3. Since \\(s^{\\prime}=1\\), we conclude that the sequence contains a 1 .\n\nSolution 2. We make a number of initial observations. Let \\(k\\) be a positive integer.\nFact 2.1. If \\(k \\geq s^{2}\\), then \\(k^{\\prime}<k\\).\nProof. Write \\(k=a s+b\\), as in the problem statement. If \\(k \\geq s^{2}\\), then \\(a \\geq s\\) because \\(b<s\\). So, \\(k^{\\prime}=b s+a \\leq(s-1) s+a \\leq a s \\leq a s+b=k\\). Moreover, we cannot have equality since that would imply \\(s-1=b=0\\).\n\nFact 2.2. If \\(k \\leq s^{2}-1\\), then \\(k^{\\prime} \\leq s^{2}-1\\) and \\(k^{\\prime \\prime}=k\\).\n\nProof. Write \\(k=a s+b\\), as in the problem statement. If \\(k<s^{2}\\), then it must hold \\(1 \\leq a, b<s\\), hence \\(k^{\\prime}=b s+a<s^{2}\\) and \\(k^{\\prime \\prime}=(b s+a)^{\\prime}=a s+b=k\\).\n\nFact 2.3. We have \\(k^{\\prime} \\equiv s k\\left(\\bmod s^{2}-1\\right)\\left(\\right.\\) or equivalently \\(\\left.k \\equiv s k^{\\prime}\\left(\\bmod s^{2}-1\\right)\\right)\\).\nProof. We write \\(k=a s+b\\), as in the problem statement. Now,\n\\[\ns k-k^{\\prime}=s(a s+b)-(b s+a)=a\\left(s^{2}-1\\right) \\equiv 0 \\quad\\left(\\bmod s^{2}-1\\right),\n\\]\nas desired.\n\nCombining Facts 2.1 and 2.2, we find that the sequence \\(d_{1}, d_{2}, d_{3} \\ldots\\) is eventually periodic with period 2 , starting at the first value less than \\(s^{2}\\). From Fact 2.3 , it follows that\n\\[\nk^{\\prime \\prime} \\equiv s k^{\\prime} \\equiv s^{2} k \\equiv k \\quad\\left(\\bmod s^{2}-1\\right)\n\\]\nand hence the sequence is periodic modulo \\(s^{2}-1\\) from the start with period 2 .\n\nNow, if the sequence contains 1 , the sequence eventually alternates between 1 and \\(s\\) since the twist of 1 is \\(s\\) and vice versa. Using periodicity modulo \\(s^{2}-1\\), we must have \\(n \\equiv 1, s \\left(\\bmod s^{2}-1\\right)\\). Conversely, if \\(n \\equiv 1, s\\left(\\bmod s^{2}-1\\right)\\) then the eventual period must contain at least one value congruent to either 1 or \\(s\\) modulo \\(s^{2}-1\\). Since these values must be less than \\(s^{2}\\), this implies that the sequence eventually alternates between 1 and \\(s\\), showing that it contains a 1 .\n\nSolution 3. We give an alternate proof of the direct implication: if the sequence contains a 1 , then the first term is 1 or \\(s\\) modulo \\(s^{2}-1\\). We prove the following fact, which is a combination of Facts 2.1 and 2.3.\n\nFact 3.1. For all \\(k \\geq s^{2}\\), we have \\(\\left(k-s^{2}+1\\right)^{\\prime} \\in\\left\\{k^{\\prime}, k^{\\prime}-s^{2}+1\\right\\}\\).\nProof. We write \\(k=a s+b\\), as in the problem statement. Since \\(k \\geq s^{2}\\), we have \\(a \\geq s\\). If \\(b<s-1\\), then\n\\[\n\\left(k-s^{2}+1\\right)^{\\prime}=((a-s) s+(b+1))^{\\prime}=(b+1) s+(a-s)=b s+a=k^{\\prime}\n\\]\n\nOn the other hand, if \\(b=s-1\\), then\n\\[\n\\left(k-s^{2}+1\\right)^{\\prime}=((a-s+1) s+0)^{\\prime}=0 s+(a-s+1)=a-s+1=k^{\\prime}-s^{2}+1\n\\]\n\nNow assume \\(n \\geq s^{2}\\) and the sequence \\(d_{1}, d_{2}, \\ldots\\) contains a 1 . Denote by \\(e_{1}, e_{2}, \\ldots\\) the sequence constructed as in the problem statement, but with initial value \\(e_{1}=n-s^{2}+1\\). Using the above fact, we deduce that \\(e_{i} \\equiv d_{i}\\left(\\bmod s^{2}-1\\right)\\) and \\(e_{i} \\leq d_{i}\\) for all \\(i \\geq 1\\) by induction on \\(i\\). Hence, the sequence \\(e_{1}, e_{2}, \\ldots\\) also contains a 1 .\n\nSince the conclusion we are trying to reach only depends on the residue of \\(d_{1}\\) modulo \\(s^{2}-1\\), we conclude that without loss of generality we can assume \\(n<s^{2}\\).\n\nUsing Fact 2.2, it now follows that the sequence \\(d_{1}, d_{2}, \\ldots\\) is periodic with period two. Since 1 and \\(s\\) are twists of each other, it follows that if this sequence contains a 1 , it must be alternating between 1 and \\(s\\). Hence, \\(d_{1} \\equiv 1, s\\left(\\bmod s^{2}-1\\right)\\) as desired.\n\nFor the other direction we can make a similar argument, observing that the second of the two cases in the proof of Fact 3.1 can only apply to finitely many terms of the sequence \\(d_{1}, d_{2}, d_{3}, \\ldots\\), allowing us to also go the other way.\n\nSolution 4. First assume that \\(d_{k}=1\\) for some \\(k\\). Let \\(k\\) be the smallest such index. If \\(k=1\\) then \\(n=1\\), so we may assume \\(k \\geqslant 2\\).\n\nThen \\(d_{k-1}=a s+b\\) for some non-negative integers \\(a, b\\) satisfying \\(b<s\\) and \\(b s+a=1\\). The only solution is \\(b=0, a=1\\), so \\(d_{k-1}=s\\). So, if \\(k=2\\), then \\(n=s\\), so we may assume \\(k \\geqslant 3\\).\n\nThen there exist non-negative integers \\(c, d\\) satisfying \\(d_{k-2}=c s+d, d<s\\) and \\(d s+c=s\\). We have two solutions: \\(d=0, c=s\\) and \\(d=1, c=0\\). However, in the second case we get \\(d_{k-2}=1\\), which contradicts the minimality of \\(k\\). Hence, \\(d_{k-2}=s^{2}\\). If \\(k=3\\), then \\(n=d_{1}=s^{2}\\), which gives remainder 1 when divided by \\(s^{2}-1\\).\n\nAssume now that \\(k \\geqslant 4\\). We will show that for each \\(m \\in\\{3,4, \\ldots, k-1\\}\\) there exist \\(b_{1}, b_{2}, \\ldots, b_{m-2} \\in\\{0,1, \\ldots, s-1\\}\\) such that\n\\[\nd_{k-m}=s^{m}-\\sum_{i=1}^{m-2} b_{i}\\left(s^{m-i}-s^{m-i-2}\\right)\n\\]\n\nWe will prove this equality by induction on \\(m\\). If \\(m=3\\), then \\(d_{k-3}=a_{1} s+b_{1}\\) for some non-negative integers \\(a_{1}, b_{1}\\) satisfying \\(b_{1}<s\\) and \\(b_{1} s+a_{1}=d_{k-2}=s^{2}\\). Then \\(a_{1}=s^{2}-b_{1} s\\), so \\(d_{k-3}=s^{3}-b_{1}\\left(s^{2}-1\\right)\\), which proves (9) for \\(m=3\\).\n\nAssume that (9) holds for some \\(m\\) and consider \\(d_{k-(m+1)}\\). There exist non-negative integers \\(a_{m-1}, b_{m-1}\\) such that \\(d_{k-(m+1)}=a_{m-1} s+b_{m-1}, b_{m-1}<s\\) and \\(d_{k-m}=b_{m-1} s+a_{m-1}\\). Using the inductive assumption we get\n\\[\na_{m-1}=d_{k-m}-b_{m-1} s=s^{m}-\\sum_{i=1}^{m-2} b_{i}\\left(s^{m-i}-s^{m-i-2}\\right)-b_{m-1} s,\n\\]\ntherefore\n\\[\n\\begin{aligned}\nd_{k-(m+1)} & =a_{m-1} s+b_{m-1}=s^{m+1}-\\sum_{i=1}^{m-2} b_{i}\\left(s^{m-i}-s^{m-i-2}\\right) s-b_{m-1} s^{2}+b_{m-1} \\\\\n& =s^{m+1}-\\sum_{i=1}^{m-1} b_{i}\\left(s^{m+1-i}-s^{m-i-1}\\right)\n\\end{aligned}\n\\]\nwhich completes the proof of (9). In particular, for \\(m=k-1\\) we get\n\\[\nd_{1}=s^{k-1}-\\sum_{i=1}^{k-3} b_{i}\\left(s^{k-i-1}-s^{k-i-3}\\right) .\n\\]\n\nThe above sum is clearly divisible by \\(s^{2}-1\\), and it is clear that the remainder of \\(s^{k-1}\\) when divided by \\(s^{2}-1\\) is 1 when \\(k\\) is odd, and \\(s\\) when \\(k\\) is even. It follows that the remainder when \\(n=d_{1}\\) is divided by \\(s^{2}-1\\) is either 1 or \\(s\\).\n\nTo prove the other implication, assume that \\(n\\) gives remainder 1 or \\(s\\) when divided by \\(s^{2}-1\\). If \\(n \\in\\left\\{1, s, s^{2}\\right\\}\\), then one of the numbers \\(d_{1}, d_{2}\\) and \\(d_{3}\\) is 1 . We therefore assume that \\(n>s^{2}\\). Since the reminder when a power of \\(s\\) is divided by \\(s^{2}-1\\) is either 1 or \\(s\\), there exists a positive integer \\(m\\) such that \\(s^{m}-n\\) is non-negative and divisible by \\(s^{2}-1\\). By our assumption \\(m \\geqslant 3\\). We also take the smallest such \\(m\\), so that \\(n>s^{m-2}\\). The quotient \\(\\frac{s^{m}-n}{s^{2}-1}\\) is therefore smaller than \\(s^{m-2}\\), so there exist \\(b_{1}, \\ldots, b_{m-2} \\in\\{0,1, \\ldots, s-1\\}\\) such that \\(\\frac{s^{m}-n}{s^{2}-1}=\\sum_{i=1}^{m-2} b_{i} s^{i-1}\\). It follows that\n\\[\nn=s^{m}-\\sum_{i=1}^{m-2} b_{i}\\left(s^{i+1}-s^{i-1}\\right)\n\\]\n\nWe now show that\n\\[\nd_{j}=s^{m+1-j}-\\sum_{i=1}^{m-1-j} b_{i}\\left(s^{i+1}-s^{i-1}\\right)\n\\]\nfor \\(j=1,2, \\ldots, m-2\\) by induction on \\(j\\). For \\(j=1\\) this follows from \\(d_{1}=n\\). Assume now that (10) holds for some \\(j<m-2\\). Then\n\\[\nd_{j}=\\left(s^{m-j}-\\sum_{i=2}^{m-1-j} b_{i}\\left(s^{i}-s^{i-2}\\right)-b_{1} s\\right) s+b_{1} .\n\\]\n\nAs \\(d_{j}\\) is positive and \\(b_{1} \\in\\{0,1, \\ldots, s-1\\}\\), the expression \\(s^{m-j}-\\sum_{i=2}^{m-1-j} b_{i}\\left(s^{i}-s^{i-2}\\right)-b_{1} s\\) has to be non-negative, so we can compute the twist of \\(d_{j}\\) as\n\\[\nd_{j+1}=b_{1} s+s^{m-j}-\\sum_{i=2}^{m-1-j} b_{i}\\left(s^{i}-s^{i-2}\\right)-b_{1} s=s^{m-j}-\\sum_{i=1}^{m-2-j} b_{i}\\left(s^{i+1}-s^{i-1}\\right),\n\\]\nwhich finishes the induction.\nNow we use (10) for \\(j=m-2\\) and get \\(d_{m-2}=s^{3}-b_{1}\\left(s^{2}-1\\right)=\\left(s^{2}-b_{1} s\\right)+b_{1}\\). Then \\(d_{m-1}=b_{1} s+s^{2}-b_{1} s=s^{2}=s \\cdot s+0, d_{m}=0 \\cdot s+s=s=1 \\cdot s+0\\) and \\(d_{m+1}=0 \\cdot s+1=1\\).", "source_pdf": "egmo_2023.pdf", "notes": "fallback-regex"}
{"id": "EGMO-2023-6", "contest": "EGMO", "year": "2023", "problem_number": "6", "problem": "Let \\(A B C\\) be a triangle with circumcircle \\(\\Omega\\). Let \\(S_{b}\\) and \\(S_{c}\\) respectively denote the midpoints of the arcs \\(A C\\) and \\(A B\\) that do not contain the third vertex. Let \\(N_{a}\\) denote the midpoint of \\(\\operatorname{arc} B A C\\) (the \\(\\operatorname{arc} B C\\) containing \\(A\\) ). Let \\(I\\) be the incentre of \\(A B C\\). Let \\(\\omega_{b}\\) be the circle that is tangent to \\(A B\\) and internally tangent to \\(\\Omega\\) at \\(S_{b}\\), and let \\(\\omega_{c}\\) be the circle that is tangent to \\(A C\\) and internally tangent to \\(\\Omega\\) at \\(S_{c}\\). Show that the line \\(I N_{a}\\), and the line through the intersections of \\(\\omega_{b}\\) and \\(\\omega_{c}\\), meet on \\(\\Omega\\).\n\nThe incentre of a triangle is the centre of its incircle, the circle inside the triangle that is tangent to all three sides.", "solution": "\\begin{figure}\n\\includegraphics[width=\\textwidth]{https://cdn.mathpix.com/cropped/2025_08_23_146291bab5ef73d6732cg-23.jpg?height=989&width=1111&top_left_y=805&top_left_x=471}\n\\captionsetup{labelformat=empty}\n\\caption{Figure 6: Diagram to Solution 1}\n\\end{figure}\n\nSolution 1. Part I: First we show that A lies on the radical axis of \\(\\omega_{b}\\) and \\(\\omega_{c}\\).\nWe first note that the line through the intersections of two circles is the radical line of the two circles. Let the tangents to \\(\\Omega\\) at \\(S_{b}\\) and \\(S_{c}\\) intersect at \\(T\\). Clearly \\(T\\) is on the radical axis of \\(\\omega_{b}\\) and \\(\\omega_{c}\\) (and in fact is the radical centre of \\(\\omega_{b}, \\omega_{c}\\) and \\(\\Omega\\) ).\n\nWe next show that \\(A\\) lies on the radical axis of \\(\\omega_{b}\\) and \\(\\omega_{c}\\). Let \\(P_{b}\\) denote the point of tangency of \\(\\omega_{b}\\) and \\(A B\\), and let \\(P_{c}\\) denote the point of tangency of \\(\\omega_{c}\\) and \\(A C\\). Furthermore, let \\(U\\) be the intersection of the tangent to \\(\\Omega\\) at \\(S_{b}\\) with the line \\(A B\\), and let \\(V\\) be the intersection of the tangent to \\(\\Omega\\) at \\(S_{c}\\) with the line \\(A C\\). Then \\(T V A U\\) is parallelogram. Morover, due to equality of tangent segments we have \\(\\left|U S_{b}\\right|=\\left|U P_{b}\\right|,\\left|V P_{c}\\right|=\\left|V S_{c}\\right|\\) and \\(\\left|T S_{b}\\right|=\\left|T S_{c}\\right|\\). It follows that\n\\[\n\\begin{aligned}\n\\left|A P_{b}\\right| & =\\left|U P_{b}\\right|-|U A|=\\left|U S_{b}\\right|-|T V|=\\left|T S_{b}\\right|-|T U|-|T V| \\\\\n& =\\left|T S_{s}\\right|-|T V|-|T U|=\\left|V S_{c}\\right|-|A V|=\\left|V P_{c}\\right|-|V A|=\\left|A P_{c}\\right|\n\\end{aligned}\n\\]\n\nBut \\(\\left|A P_{b}\\right|,\\left|A P_{c}\\right|\\) are exactly the square roots of powers of \\(A\\) with respect to \\(\\omega_{b}\\) and \\(\\omega_{c}\\), hence \\(A\\) is indeed on their radical axis.\n\nThus, the radical axis of \\(\\omega_{b}, \\omega_{c}\\) is \\(A T\\).\nPart II: Consider the triangle \\(A S_{b} S_{c}\\). Note that since \\(T\\) is the intersection of the tangents at \\(S_{b}\\) and \\(S_{c}\\) to the circumcircle of \\(A S_{b} S_{c}\\), it follows that \\(A T\\) is the symmedian of \\(A\\) in this triangle. Let \\(X\\) denote the second intersection of the symmedian \\(A T\\) with \\(\\Omega\\). We wish to show that \\(X\\) is also on \\(I N_{a}\\).\n\nNote that \\(A N_{a}\\) is the external angle bisector of angle \\(A\\), and therefore it is parallel to \\(S_{b} S_{c}\\). Let \\(M\\) denote the midpoint of \\(S_{b} S_{c}\\), and let \\(Y\\) be the second intersection of \\(A M\\) with \\(\\Omega\\). Since in \\(A S_{b} S_{c}, A X T\\) is the symmedian and \\(A M Y\\) is the median, it follows that \\(X Y\\) is also parallel to \\(S_{b} S_{c}\\). Thus, reflecting in the perpendicular bisector of \\(S_{b} S_{c}\\) sends the line \\(A M Y\\) to line \\(N_{a} M X\\).\n\nNext, consider the quadrilateral \\(A S_{b} I S_{c}\\). From the trillium theorem we have \\(\\left|S_{b} A\\right|=\\left|S_{b} I\\right|\\) and \\(\\left|S_{c} A\\right|=\\left|S_{c} I\\right|\\), thus the quadrilateral is a kite, from which it follows that the reflection of the line \\(A M\\) in \\(S_{b} S_{c}\\) is the line \\(I M\\). But previously we have seen that this is also the line \\(N_{a} M X\\). Thus \\(M, I, N_{a}\\) and \\(X\\) are collinear, as we wanted to show.\n\nSolution 2. This is a variation of Solution 1 which avoids the theory of the symmedian point.\n\nWe begin by showing that the radical axis of \\(\\omega_{b}, \\omega_{c}\\) is \\(A T\\) as in Solution 1 .\nPart II: We introduce the point \\(S_{a}\\) with the obvious meaning. Observe that the incentre \\(I\\) of \\(A B C\\) is the orthocentre of \\(S_{a} S_{b} S_{c}\\) either because this is well-known, or because of an angle argument that \\(A\\) reflects in \\(S_{b} S_{c}\\) to \\(I\\) (and similar results by cyclic change of letters). Therefore \\(A S_{a}\\) is perpendicular to \\(S_{b} S_{c}\\).\n\n\\begin{figure}\n\\includegraphics[width=\\textwidth]{https://cdn.mathpix.com/cropped/2025_08_23_146291bab5ef73d6732cg-24.jpg?height=786&width=1494&top_left_y=1690&top_left_x=237}\n\\captionsetup{labelformat=empty}\n\\caption{Figure 7: A reflections argument for Solution 2}\n\\end{figure}\n\nLet \\(M\\) denote the midpoint of \\(S_{b} S_{c}\\). Then \\(A\\) is the reflection of \\(S_{a}\\) in the diameter parallel to \\(S_{b} S_{c}\\), so the reflection of \\(A\\) in the diameter perpendicular to \\(S_{b} S_{c}\\) is \\(N_{a}\\), the antipode\nof \\(S_{a}\\). Let the reflection of \\(X\\) in \\(T M\\) be \\(Y\\), so \\(T Y\\) passes through \\(N_{a}\\) and is the reflection of \\(T X\\) in \\(T M\\).\n\nNow \\(S_{b} S_{c}\\) is the polar line of \\(T\\) with respect to \\(\\Omega\\), so \\(A Y\\) and \\(N_{a} X\\) meet on this line, and by symmetry at its midpoint \\(M\\). The line \\(N_{a} M X\\) is therefore the reflection of the line \\(Y M A\\) in \\(S_{b} S_{c}\\), and so \\(N_{a} M X\\) passes through \\(I\\) (the reflection of \\(A\\) in \\(S_{b} S_{c}\\) ).\n\nThe triangle \\(A S_{c} S_{b}\\) can be taken as generic, and from the argument above we can extract the fact that the symmedian point and the centroid are isogonal conjugates in that triangle.\n\nSolution 3. Assume the notation from Solution 1, part I of Solution 1, and let \\(O\\) be the centre of \\(\\Omega\\).\n\n\\begin{figure}\n\\includegraphics[width=\\textwidth]{https://cdn.mathpix.com/cropped/2025_08_23_146291bab5ef73d6732cg-25.jpg?height=1186&width=1101&top_left_y=942&top_left_x=479}\n\\captionsetup{labelformat=empty}\n\\caption{Figure 8: Diagram to Solution 3}\n\\end{figure}\n\nPart II: As in Solution 1, by the trillelium theorem, \\(S_{c} S_{b}\\) bisects \\(A I\\), and since \\(N_{a} A \\| S_{b} S_{c}\\), then \\(O T\\) is a bisector of \\(A N_{a}\\). This implies \\(\\left|M N_{a}\\right|=|M A|=|M I|\\), since \\(M\\) is the midpoint of \\(S_{c} S_{b}\\) and lies also on \\(O T\\). Hence, \\(M\\) is the circumcentre of triangle \\(I A N_{a}\\). But this triangle has a right angle at \\(A\\) (since \\(A I\\) and \\(A N_{a}\\) are the inner and outer angle bisector at \\(A\\) ), hence \\(M\\) lies on \\(I N_{a}\\).\n\nAgain, let \\(X\\) be the second intersection of \\(T A\\) and \\(\\Omega\\). By the above, it suffices to prove that \\(X\\) lies on the line \\(N_{a} M\\). From the power of point \\(T\\) with respect to \\(\\Omega\\) we get \\(|T A| \\cdot|T X|=\\left|T S_{c}\\right|^{2}\\). Since \\(M\\) is the foot of the altitude of right triangle \\(T S_{c} O\\), we obtain\n\\(\\left|T S_{c}\\right|^{2}=|T M| \\cdot|T O|\\). Hence, \\(|T A| \\cdot|T X|=|T M| \\cdot|T O|\\) so the points \\(O, M, A, X\\) are concyclic. It follows that \\(\\angle M X A=\\angle M O A=\\frac{1}{2} \\angle N_{a} O A=\\angle N_{a} X A\\). Hence, \\(X\\) lies on the line \\(N_{a} M\\).\n\nRemark. To show that \\(O M A X\\) is cyclic, one can also invert the line \\(T A X\\) in the circumcircle of the triangle \\(A B C\\).\n\nSolution 4. Part I is done as in solution 1.\n\n\\begin{figure}\n\\includegraphics[width=\\textwidth]{https://cdn.mathpix.com/cropped/2025_08_23_146291bab5ef73d6732cg-26.jpg?height=1097&width=1249&top_left_y=722&top_left_x=399}\n\\captionsetup{labelformat=empty}\n\\caption{Figure 9: Diagram to Solution 4}\n\\end{figure}\n\nPart II: as in Solution 1 we show that \\(A N_{a} \\| S_{b} S_{c}\\). In particular, \\(\\angle N_{a} O T=\\angle T O A\\). The conclusion of the problem trivially holds if \\(|A B|=|A C|\\), therefore we assume without loss of generality that \\(|A C|>|A B|\\). Let \\(S_{a}\\) be the midpoint of the arc \\(B C\\) which does not contain \\(A\\). Then \\(N_{a} S_{a}\\) is a diameter, so \\(\\angle S_{a} B N_{a}=\\frac{\\pi}{2}=\\angle O S_{c} T\\). We also compute \\(\\angle B N_{a} S_{a}=\\angle B A S_{a}=\\frac{1}{2} \\angle B A C=\\frac{1}{2} \\angle S_{c} T S_{b}=\\angle S_{c} T O\\). It follows that the triangles \\(T S_{c} O\\) and \\(N_{a} B S_{a}\\) are similar. In particular,\n\\[\n\\frac{\\left|N_{a} B\\right|}{\\left|T S_{c}\\right|}=\\frac{\\left|S_{a} B\\right|}{\\left|O S_{c}\\right|} .\n\\]\n\nNext we compute\n\\[\n\\angle I S_{a} B=\\angle N_{a} S_{a} B-\\angle N_{a} S_{a} I=\\angle T O S_{c}-\\frac{1}{2} \\angle N_{a} O A=\\angle T O S_{c}-\\angle T O A=\\angle A O S_{c}\n\\]\nand\n\\(\\angle I B N_{a}=\\angle C B N_{a}-\\angle C B I=\\frac{1}{2}\\left(\\pi-\\angle B N_{a} C\\right)-\\frac{1}{2} \\angle C B A=\\frac{1}{2} \\angle A C B=\\angle A C S_{c}=\\angle A S_{c} T\\),\nhence\n\\[\n\\angle S_{a} B I=\\frac{\\pi}{2}-\\angle I B N_{a}=\\frac{\\pi}{2}-\\angle A S_{c} T=\\angle O S_{c} A .\n\\]\n\nTogether with (13) it follows that the triangles \\(I B S_{a}\\) and \\(A S_{c} O\\) are similar, so \\(\\frac{\\left|S_{a} B\\right|}{\\left|O S_{c}\\right|}= \\frac{|I B|}{\\left|A S_{c}\\right|}\\), and (12) implies \\(\\frac{\\left|N_{a} B\\right|}{\\left|T S_{c}\\right|}=\\frac{|I B|}{\\left|A S_{c}\\right|}\\). Consequently, by (14) the triangles \\(T S_{c} A\\) and \\(N_{a} B I\\) are similar and therefore \\(\\angle S_{c} T A=\\angle B N_{a} I\\). Now let \\(Q\\) be the second intersection of \\(N_{a} I\\) with \\(\\Omega\\). Then \\(\\angle B N_{a} I=\\angle B N_{a} Q=\\angle B A Q\\), so \\(\\angle S_{c} T A=\\angle B A Q\\). Since \\(A B\\) is parallel to \\(T S_{c}\\), we get \\(A Q \\| T A\\), i.e. \\(A, T, Q\\) are collinear.\n\nRemark. After proving similarity of triangles \\(T S_{c} O\\) and \\(N_{a} B S_{a}\\) one can use spiral symmetry to show similarity of triangles \\(T S_{c} A\\) and \\(N_{a} B I\\).\n\nSolution 5. Part I: First we show that \\(A\\) lies on the radical axis between \\(\\omega_{b}\\) and \\(\\omega_{c}\\).\nLet \\(T\\) be the radical center of the circumcircle, \\(\\omega_{b}\\) and \\(\\omega_{c}\\); then \\(T S_{b}\\) and \\(T S_{c}\\) are common tangents of the circles, as shown in Figure 5a. Moreover, let \\(P_{b}=A B \\cap S_{b} S_{c}\\) and \\(P_{c}= A C \\cap S_{b} S_{c}\\). The triangle \\(T S_{c} S_{b}\\) is isosceles: \\(A B \\| T S_{c}\\) and \\(A C \\| T S_{b}\\) so\n\\[\n\\angle A P_{b} P_{c}=\\angle T S_{c} S_{b}=\\angle S_{c} S_{b} T=\\angle P_{b} P_{c} A .\n\\]\n\nFrom these angles we can see that \\(\\omega_{b}\\) passes through \\(P_{b}, \\omega_{c}\\) passes through \\(P_{c}\\), and finally \\(A P_{b}\\) and \\(A P_{c}\\) are equal tangents to \\(\\omega_{b}\\) and \\(\\omega_{c}\\), so \\(A\\) lies on the radical axis.\n\n\\begin{figure}\n\\includegraphics[width=\\textwidth]{https://cdn.mathpix.com/cropped/2025_08_23_146291bab5ef73d6732cg-27.jpg?height=964&width=686&top_left_y=1604&top_left_x=345}\n\\captionsetup{labelformat=empty}\n\\caption{Figure 5a}\n\\end{figure}\n\n\\begin{figure}\n\\includegraphics[width=\\textwidth]{https://cdn.mathpix.com/cropped/2025_08_23_146291bab5ef73d6732cg-27.jpg?height=964&width=661&top_left_y=1604&top_left_x=1050}\n\\captionsetup{labelformat=empty}\n\\caption{Figure 5b}\n\\end{figure}\n\nPart II. Let the radical axis \\(T A\\) meet the circumcircle again at \\(X\\), let \\(S_{a}\\) be the midpoint of the arc \\(B C\\) opposite to \\(A\\), and let \\(X I\\) meet the circumcirlce again at \\(N\\). (See Figure 2.) For solving the problem, we have prove that \\(N_{a}=N\\).\n\nThe triples of points \\(A, I, S_{a} ; B, I, S_{b}\\) and \\(C, I, S_{c}\\) are collinear because they lie on the angle bisectors of the triangle \\(A B C\\).\n\nNotice that the quadrilateral \\(A S_{c} X S_{b}\\) is harmonic, because the tangents at \\(S_{b}\\) and \\(S_{c}\\), and the line \\(A X\\) are concurrent at \\(T\\). This quadrilateral can be projected (or inverted) to the quadrilateral \\(S_{a} C N B\\) through \\(I\\). So, \\(S_{a} C N B\\) also is a harmonic quadrilateral. Due to \\(S_{a} B=S_{a} C\\), this implies \\(N B=N C\\), so \\(N=N_{a}\\). Done.\n\nRemark. Instead of mentioning inversion and harmonic quadrilaterals, from the similar triangles \\(\\triangle T S_{c} A \\sim \\triangle T X S_{c}\\) and \\(\\triangle T A S_{b} \\sim \\triangle T S_{b} X\\) we can get\n\\[\n\\frac{A S_{c}}{S_{c} X}=\\frac{A S_{b}}{S_{b} X} .\n\\]\n\nThen, we can apply the trigonometric form of Ceva's theorem to triangle \\(B C X\\)\n\\[\n\\frac{\\sin \\angle B X N_{a}}{\\sin \\angle N_{a} X C} \\cdot \\frac{\\sin \\angle C B S_{b}}{\\sin \\angle S_{b} B X} \\cdot \\frac{\\sin \\angle X C S_{c}}{\\sin \\angle S_{c} C B}=\\frac{B N_{a}}{N_{a} C} \\cdot \\frac{-C S_{b}}{S_{b} X} \\cdot \\frac{X S_{c}}{-S_{c} B}=1 \\cdot \\frac{S_{b} A}{S_{b} N_{a}} \\cdot \\frac{N_{a} S_{c}}{S_{c} B}=1,\n\\]\nso the Cevians \\(B S_{b}, C S_{c}\\) and \\(X N_{a}\\) are concurrent.\n\nSolution 6. Part I: First let's show that this is equivalent to proving that \\(T A\\) and \\(N_{a} I\\) intersect in \\(\\Omega\\).\n\nLemma: Let's recall that if we have two circles \\(\\omega_{1}\\) and \\(\\omega_{2}\\) which are internally tangent at point \\(X\\) and if we have a line \\(A B\\) tangent to \\(\\omega_{2}\\) at \\(Y\\). Let \\(M\\) be the midpoint of the arc \\(A B\\) not containing \\(Z\\). We have that \\(Z, Y, M\\) are collinear.\n\n\\begin{figure}\n\\includegraphics[width=\\textwidth]{https://cdn.mathpix.com/cropped/2025_08_23_146291bab5ef73d6732cg-28.jpg?height=460&width=483&top_left_y=1796&top_left_x=782}\n\\captionsetup{labelformat=empty}\n\\caption{Solution 6: Lemma}\n\\end{figure}\n\nLet \\(P_{b}=A B \\cap \\omega_{b}\\) and \\(P_{c}=A C \\cap \\omega_{c}\\). We can notice by the lemma that \\(S_{b}, P_{b}\\) and \\(S_{c}\\) are collinear, and similarly \\(S_{c}, P_{c}\\) and \\(S_{b}\\) are also collinear. Therefore \\(S_{c}, P_{b}, P_{c}\\), and \\(S_{b}\\) are collinear, and since \\(\\angle A P_{b} P_{c}=\\frac{\\angle A B C}{2}+\\frac{\\angle A C B}{2}=\\angle A P_{c} P_{b}\\) then \\(A P_{b}=A P_{c}\\) so \\(A\\) is on the radical axis of \\(\\omega_{b}\\) and \\(\\omega_{c}\\). Let \\(T\\) be the intersection of the tangent lines of \\(\\Omega\\) through \\(S_{c}\\) and \\(S_{b}\\). Since \\(T S_{c}=T S_{b}\\) then \\(A T\\) is the radical axis between \\(\\omega_{b}\\) and \\(\\omega_{c}\\).\n\nPart II: \\(T A\\) and \\(N_{a} I\\) intersect in \\(\\Omega\\).\n\nLet \\(\\omega_{a}\\) the \\(A\\)-mixtilinear incircle (that is, the circle internally tangent to \\(\\Omega\\), and tangent to both \\(A B\\) and \\(A C\\) ), and let \\(X=\\Omega \\cap \\omega_{a}\\). It is known that \\(N_{a}, I, X\\) are collinear.\n\nLet \\(M_{c}\\) and \\(M_{b}\\) be the tangent points of \\(\\omega_{A}\\) to \\(A B\\) and \\(A C\\) respectively, then by the lemma \\(X, M_{c}, S_{c}\\) are collinear and \\(X, M_{b}, S_{b}\\) are collinear. We can see that \\(S_{c} T S_{b}\\) and \\(M_{c} A M_{b}\\) are homothetic with respect to \\(X\\); therefore \\(T\\) and \\(A\\) are homothetic with respect to \\(X\\), impying that \\(T, A, X\\) are collinear.\n\n\\begin{figure}\n\\includegraphics[width=\\textwidth]{https://cdn.mathpix.com/cropped/2025_08_23_146291bab5ef73d6732cg-29.jpg?height=1320&width=1003&top_left_y=628&top_left_x=525}\n\\captionsetup{labelformat=empty}\n\\caption{Figure 10: Diagram to Solution 6}\n\\end{figure}", "source_pdf": "egmo_2023.pdf", "notes": "fallback-regex"}
{"id": "EGMO-2024-1", "contest": "EGMO", "year": "2024", "problem_number": "1", "problem": "Two different integers \\(u\\) and \\(v\\) are written on a board. We perform a sequence of steps. At each step we do one of the following two operations: (i) If \\(a\\) and \\(b\\) are different integers on the board, then we can write \\(a+b\\) on the board, if it is not already there. (ii) If \\(a, b\\) and \\(c\\) are three different integers on the board, and if an integer \\(x\\) satisfies \\(a x^{2}+b x+c=0\\), then we can write \\(x\\) on the board, if it is not already there. Determine all pairs of starting numbers ( \\(u, v\\) ) from which any integer can eventually be written on the board after a finite sequence of steps.", "solution": "We will show that the answer are the integer pairs ( \\(u, v\\) ) such that \\(u \\neq 0\\), \\(v \\neq 0,\\{u, v\\} \\neq\\{-1,1\\}\\) and \\(u>0\\) or \\(v>0\\). If \\(u=0\\) or \\(v=0\\), then (i) will never yield a new number and we cannot use (ii) with only two numbers. Hence, if \\(u=0\\) or \\(v=0\\), we cannot reach every possible \\(y\\). From now on, assume \\(u \\neq 0\\) and \\(v \\neq 0\\). If both numbers \\(u, v\\) were negative, we will show that there can only be negative numbers on the board. With negative numbers \\(a, b\\), operation (i) will only yield a negative number. The same holds for operation (ii), because for a non-negative \\(x\\) and negative \\(a, b, c\\), we have \\(a x^{2}+b x+c<0\\). Hence, if both \\(u<0\\) and \\(v<0\\), then we cannot reach every possible \\(y\\). From now on, assume that at least one of \\(u, v\\) is positive. Without loss of generality take \\(u<v\\), and so \\(v>0\\). After one step, we can have the numbers \\(u, v, u+v\\), which are mutually distinct due to \\(u, v\\) being nonzero. Notice that the equation \\(u x^{2}+(u+v) x+v=0\\) has a root -1 , and so we can have -1 on the board. We now check two cases: case \\(v=1\\), and case \\(v>1\\). If \\(v=1\\), then \\(u<0\\). Further split the case of \\(v=1\\) based on whether \\(u=-1\\) or \\(u<-1\\). If \\(v=1\\) and \\(u=-1\\), we can only additionally write number 0 on the board using operation (i); and no additional numbers using (ii) because setting \\(\\{a, b, c\\}\\) to \\(\\{-1,0,1\\}\\) in any order only has solutions for \\(x\\) in \\(\\{-1,0,1\\}\\). Hence, if \\(\\{u, v\\}=\\{-1,1\\}\\), then we cannot reach every possible \\(y\\). If \\(v=1\\) and \\(u<-1\\), we can use operation (i) on numbers \\(u,-1\\) (and then repeat choosing the obtained result and -1 ) to get any negative number smaller than \\(u\\), and operation (i) on numbers ( \\(u, 1\\) ) (and then repeat choosing the obtained result and 1) to get any negative number larger than \\(u\\), as well as 0 . Then, we set \\((a, b, c)=(0,1,-2)\\) and apply operation (ii) to additionally get number 2. Applying (i) on (2,1) (and then repeat choosing the obtained result and 1), we can get all the remaining integers too. From now on, assume \\(v>1\\). Recall that we can make \\(u+v\\) and -1 . We will now apply operation (i). First, ( \\(v,-1\\) ) gives \\(v-1\\). Next, ( \\(v, v-1\\) ) gives \\(2 v-1\\). Since \\(v>1\\), we know \\(v \\neq 2 v-1\\), so we can apply operation (i) on \\((v, 2 v-1)\\) to get \\(3 v-1\\), and then continue adding \\((v, k v-1)\\) to get \\((k+1) v-1\\) for any positive \\(k\\). Since \\(v>1\\), we can get an arbitrarily large integer by repeating this. If \\(a\\) is any positive number on the board, applying (i) to \\((a,-1)\\) gives \\(a-1\\). By repeating this, we have that we can get all numbers smaller than \\(a\\) and larger than or equal to -1 . Together with previously having found a way to get an arbitrarily large integer, we have that we can get any integer \\(l \\geq-1\\) on the board. Now, we set \\((a, b, c)=(0,1,2)\\) and apply operation (ii) to additionally get number -2. Then we can repeat operation (i) on ( \\(-1,-2\\) ) (and afterwards on -1 and the obtained result) to get any negative number. Therefore, if \\(u \\neq 0, v \\neq 0,\\{u, v\\} \\neq\\{-1,1\\}\\) and \\(u>0\\) or \\(v>0\\), we can write every integer on the board. Remark. There are of course many other ways to create all integers in case of ( \\(u, v\\) ) that satisfies all the requirements. Basically you will always use (i) to create arbitrarily large numbers and then (ii) to create a number in a range that you didn't have before.", "source_pdf": "egmo_2024.pdf", "notes": ""}
{"id": "EGMO-2024-2", "contest": "EGMO", "year": "2024", "problem_number": "2", "problem": "Let \\(A B C\\) be a triangle with \\(A C>A B\\), and denote its circumcircle by \\(\\Omega\\) and incentre by \\(I\\). Let its incircle meet sides \\(B C, C A, A B\\) at \\(D, E, F\\) respectively. Let \\(X\\) and \\(Y\\) be two points on minor arcs \\(\\widehat{D F}\\) and \\(\\widehat{D E}\\) of the incircle, respectively, such that \\(\\angle B X D=\\angle D Y C\\). Let line \\(X Y\\) meet line \\(B C\\) at \\(K\\). Let \\(T\\) be the point on \\(\\Omega\\) such that \\(K T\\) is tangent to \\(\\Omega\\) and \\(T\\) is on the same side of line \\(B C\\) as \\(A\\). Prove that lines \\(T D\\) and \\(A I\\) meet on \\(\\Omega\\).", "solution": "By the alternate segment theorem we have that: \\[ 180^{\\circ}=\\angle D C Y+\\angle C Y D+\\angle Y D C=\\angle D C Y+\\angle D X B+\\angle Y X D=\\angle D C Y+\\angle Y X B . \\] Therefore opposite angle of \\(B X Y C\\) are supplementary and so \\(C Y X B\\) cyclic. One can apply power of a point at \\(K\\) : \\[ K T^{2}=K B \\cdot K C=K X \\cdot K Y=K D^{2} \\Longrightarrow K T=K D . \\] (Alternatively you can sidestep power of a point by observing that \\(K\\) is the radical centre of the incircle \\(D E F\\), the circumcircle \\(\\Gamma\\) and the circle \\(C Y X B\\) and so \\(K T^{2}=K D^{2}\\).) Now let \\(A I\\) meet \\(\\Omega\\) at \\(M\\), the midpoint of \\(\\widehat{B C}\\) not containing \\(A\\). Let the tangent at \\(M\\) meet \\(K T\\) at \\(Q\\). Observe that \\(Q M \\| K D\\) so \\(\\angle T K D=\\angle T Q M\\) and also \\(K T=K D\\), \\(Q T=Q M\\) hence \\(\\triangle T K D \\sim \\triangle T Q M\\). As \\(T, K, Q\\) are collinear, this means that \\(T, D, M\\) are collinear so \\(T D\\) and \\(A I\\) meet at \\(M\\) which lies on \\(\\Omega\\).", "source_pdf": "egmo_2024.pdf", "notes": ""}
{"id": "EGMO-2024-3", "contest": "EGMO", "year": "2024", "problem_number": "3", "problem": "We call a positive integer \\(n\\) peculiar if, for any positive divisor \\(d\\) of \\(n\\), the integer \\(d(d+1)\\) divides \\(n(n+1)\\). Prove that for any four different peculiar positive integers \\(A, B, C\\) and \\(D\\), the following holds: \\[ \\operatorname{gcd}(A, B, C, D)=1 \\] Here \\(\\operatorname{gcd}(A, B, C, D)\\) is the largest positive integer that divides all of \\(A, B, C\\) and \\(D\\).", "solution": "Observe that \\(n=1\\) is peculiar and that every prime is peculiar. Consider \\(\\frac{n}{d}\\), where \\(d>1\\) is a divisor of \\(n\\). Then \\(\\frac{n}{d}\\left(\\frac{n}{d}+1\\right)\\) divides \\(n(n+1)\\), equivalent to \\(n+d\\) dividing \\(d^{2}(n+1)\\). Since \\(n \\equiv-d(\\bmod n+d)\\), we obtain that \\(n+d\\) divides \\(d^{3}-d^{2}\\), hence \\(n+d \\leq d^{3}-d^{2}\\) and in particular \\(n<d^{3}\\). Now taking \\(d\\) to be the smallest prime divisor of \\(n\\), we deduce that \\(n\\) cannot have more than two prime factors, counting multiplicities. Hence from now on we work with \\(n=p q\\), where \\(p\\) and \\(q\\) are primes. In fact, \\(p \\neq q\\), as otherwise \\(p+1 \\mid p^{2}-p\\), i.e. \\(p+1 \\mid 2\\), contradiction. The only relations of concern are \\(p(p+1) \\mid n(n+1)\\) and \\(q(q+1) \\mid n(n+1)\\). The former yields \\(p(p+1) \\mid p q(p q+1)\\), i.e. \\(p+1 \\mid q(p q+1)\\), that is, \\(p+1 \\mid q(q-1)\\); analogously \\(q+1 \\mid p(p-1)\\). Without loss of generality assume \\(p>q\\). If \\(q\\) does not divide \\(p+1\\), then since \\(p+1\\) and \\(q\\) are relatively prime, we obtain from \\(p+1 \\mid q(q-1)\\) that \\(p+1\\) divides \\(q-1\\) and hence \\(p<p+1 \\leq q-1<q\\), contradiction. Hence \\(q\\) divides \\(p+1\\). Also, \\(p\\) does not divide \\(q+1\\) due to \\(p>q(\\) unless \\(p=q+1\\), i.e. \\(p=3, q=2\\), but then \\(p+1 \\nmid q(q-1))\\) and now from \\(q+1 \\mid p(p-1)\\) we deduce that \\(q+1\\) divides \\(p-1\\). Write \\(p+1=m q\\) for some positive integer \\(m\\). Then \\(q+1\\) divides \\(p-1=m q-2= m(q+1)-m-2\\), so \\(q+1\\) divides \\(m+2\\). On the other hand, \\(p+1 \\mid q(q-1)\\) implies that \\(m\\) divides \\(q-1\\). If the ratio of the latter is greater than 1 , then \\(m \\leq \\frac{q-1}{2}\\), but \\(q+1\\) dividing \\(m+2\\) from above insists on \\(q \\leq m+1\\), so \\(m \\leq \\frac{q-1}{2} \\leq \\frac{m}{2}\\), contradiction. Hence \\(m=q-1\\) and we have proven the following: if \\(n>1\\) is composite and peculiar, then \\(n=p q\\), where \\(p>q\\) are primes and \\(p=q^{2}-q-1\\). In conclusion, a prime \\(p\\) can only divide the peculiar numbers \\(p, p\\left(p^{2}-p-1\\right)\\) (if \\(p^{2}-p-1\\) is prime) and \\(p q\\) where \\(p=q^{2}-q-1\\) (if \\(q\\) is prime). In particular, the greatest common divisor of more than three peculiar numbers must be 1 . (Note that three peculiar numbers may indeed have a common divisor, e.g. 5, \\(15=3 \\cdot 5\\) and \\(95=5 \\cdot 19\\) are all peculiar.)", "source_pdf": "egmo_2024.pdf", "notes": ""}
{"id": "EGMO-2024-4", "contest": "EGMO", "year": "2024", "problem_number": "4", "problem": "For a sequence \\(a_{1}<a_{2}<\\cdots<a_{n}\\) of integers, a pair ( \\(a_{i}, a_{j}\\) ) with \\(1 \\leq i<j \\leq n\\) is called interesting if there exists a pair ( \\(a_{k}, a_{l}\\) ) of integers with \\(1 \\leq k<l \\leq n\\) such that \\[ \\frac{a_{l}-a_{k}}{a_{j}-a_{i}}=2 \\] For each \\(n \\geq 3\\), find the largest possible number of interesting pairs in a sequence of length \\(n\\).", "solution": "Consider the numbers \\(a_{i}=2^{i}\\) for \\(2 \\leq i \\leq n\\) and \\(a_{1}=0\\), and choose any pair \\((i, j)\\) with \\(1 \\leq i<j \\leq n\\). If \\(i=1\\), the pair \\((1, j)\\) is interesting for all \\(2 \\leq j \\leq n-1\\), as \\(\\frac{a_{j+1}-a_{1}}{a_{j}-a_{1}}=\\frac{2^{j+1}}{2^{j}}=2\\). If \\(i \\geq 2\\), the pair \\((i, j)\\) is also interesting for all \\(j\\) such that \\(i+1 \\leq j \\leq n-1\\), since \\(\\frac{a_{j+1}-a_{i+1}}{a_{j}-a_{i}}=\\frac{2^{j+1}-2^{i+1}}{2^{j}-2^{i}}=2\\). In addition, the pair \\((n-1, n)\\) is interesting, as \\(\\frac{a_{n}-a_{0}}{a_{n}-a_{n-1}}=2\\). Hence, all pairs in which \\(j \\leq n-1\\), and additionally the pair ( \\(n-1, n\\) ), are interesting, giving \\(\\frac{1}{2}(n-1)(n-2)+1\\) pairs in total. Now, let's show that there can't be more interesting pairs. To this end we show that at least \\(\\frac{1}{2} n(n-1)-\\left(\\frac{1}{2}(n-1)(n-2)+1\\right)=n-2\\) pairs are not interesting. Clearly, the pair ( \\(1, n\\) ) is not interesting. Let's make the following observation: if a pair \\((i, j)\\) is interesting and it's not \\((1, n)\\), then \\(a_{j}-a_{i}\\) can't exceed \\(\\frac{1}{2}\\left(a_{n}-a_{1}\\right)\\). (Since, if \\((i, j)\\) is interesting then \\(a_{l}-a_{k}=2\\left(a_{j}-a_{i}\\right)\\) for some pair ( \\(k, l\\) ). If then \\(2\\left(a_{j}-a_{i}\\right)>a_{n}-a_{1}\\) we would have \\(a_{l}-a_{k}>a_{n}-a_{1}\\), which is not possible.) Finally, for any \\(2 \\leq i \\leq n-1\\) consider pairs ( \\(1, i\\) ) and ( \\(i, n\\) ). If both of them are interesting, then, following the observation above, the only possibility is \\(a_{i}-a_{1}=a_{n}-a_{i}=\\frac{a_{n}-a_{1}}{2}\\). Clearly, this is possible for at most one \\(i\\), so for all other \\(n-3\\) values of \\(i\\), at least one of pairs ( \\(1, i\\) ) and ( \\(i, n\\) ) is not interesting. Combining with the pair ( \\(1, n\\) ), we get at least \\(n-2\\) not interesting pairs in total, as desired.", "source_pdf": "egmo_2024.pdf", "notes": ""}
{"id": "EGMO-2024-5", "contest": "EGMO", "year": "2024", "problem_number": "5", "problem": "Let \\(\\mathbb{N}\\) denote the set of positive integers. Find all functions \\(f: \\mathbb{N} \\rightarrow \\mathbb{N}\\) such that the following assertions are true for every pair of positive integers ( \\(x, y\\) ): - \\(x\\) and \\(f(x)\\) have the same number of positive divisors. - If \\(x\\) does not divide \\(y\\) and \\(y\\) does not divide \\(x\\), then \\[ \\operatorname{gcd}(f(x), f(y))>f(\\operatorname{gcd}(x, y)) . \\] Here \\(\\operatorname{gcd}(m, n)\\) is the largest positive integer that divides both \\(m\\) and \\(n\\).", "solution": "Throughout this proof, when we write divisors we mean positive divisors. Let \\(f\\) be a function satisfying these properties. From the first one, it follows that \\(f(1)=1\\) and for each prime number \\(p, f(p)=q_{p}\\) for some prime number \\(q_{p}\\). Assume \\(p \\neq 2\\), the pair ( \\(2, p\\) ) in property 2 gives \\[ \\operatorname{gcd}\\left(q_{2}, q_{p}\\right)=\\operatorname{gcd}(f(2), f(p))>f(\\operatorname{gcd}(2, p))=f(1)=1, \\] so \\(q_{p}=q_{2}\\) for all \\(p\\). Set \\(q=q_{2}\\). Denote by \\(d(n)\\) the number of divisors of a positive integer \\(n\\). We will prove the following claim by induction on \\(k \\geq 0\\), the number of distinct prime divisors of \\(n\\) : For a positive integer \\(n, f(n)\\) is a power of \\(q\\). The claim, together with the first property, imply that \\(f(n)=q^{d(n)-1}\\). For \\(k=0\\) the claim is already proved. For \\(k=1\\), we need to prove that \\(f\\left(p^{m}\\right)\\) is a power of \\(q\\) for all positive \\(m\\). The case \\(m=1\\) was already proved. Assume now the result being proved for all positive integers \\(\\leq m\\). As \\(d\\left(p^{t}\\right)=t+1\\), we then know \\(f\\left(p^{t}\\right)=q^{t}\\) for all \\(t \\leq m\\). Now we consider \\(t=m+1\\). Let \\(r \\neq p\\) be a prime. Plug the pair ( \\(p^{m-1} r, p^{m}\\) ) into the second property: \\[ \\operatorname{gcd}\\left(f\\left(p^{m-1} r\\right), q^{m}\\right)=\\operatorname{gcd}\\left(f\\left(p^{m-1} r\\right), f\\left(p^{m}\\right)\\right)>f\\left(p^{m-1}\\right)=q^{m-1} . \\] This implies \\(q^{m}\\) divides \\(f\\left(p^{m-1} r\\right)\\). Since \\(f\\left(p^{m-1} r\\right)\\) has \\(2 m\\) divisors, and \\(v_{q}\\left(f\\left(p^{m-1} r\\right)\\right) \\geq m\\), it follows that \\(f\\left(p^{m-1} r\\right)\\) does not have prime divisors other than \\(q\\), since it would then have at least \\(2 \\cdot\\left(v_{q}\\left(f\\left(p^{m-1} r\\right)\\right)+1\\right)>2 m\\) divisors. Thus, \\(f\\left(p^{m-1} r\\right)\\) is a power of \\(q\\). And since it has \\(2 m\\) divisors, we must have \\(f\\left(p^{m-1} r\\right)=q^{2 m-1}\\). Now, plug the pair ( \\(p^{m+1}, p^{m-1} r\\) ) into the second property. We have \\[ \\operatorname{gcd}\\left(f\\left(p^{m+1}\\right), q^{2 m-1}\\right)=\\operatorname{gcd}\\left(f\\left(p^{m+1}\\right), f\\left(p^{m-1} r\\right)\\right)>f\\left(p^{m-1}\\right)=q^{m-1} . \\] Then \\(f\\left(p^{m+1}\\right)\\) is divisible by \\(q^{m}\\). If \\(f\\left(p^{m+1}\\right)\\) had a prime factor other than \\(q\\), it would have at least \\(2(m+1)\\) divisors, but it has \\(m+2\\) divisors and \\(2(m+1)>m+2\\) since \\(m \\geq 1\\). Hence, \\(f\\left(p^{m+1}\\right)\\) must also be a power of \\(q\\). By induction, the proof is finished for \\(k=1\\). Suppose the claim is true for all integers \\(n\\) with at most \\(k\\) distinct prime factors, for some \\(k \\geq 1\\). In order to prove the claim for integers with \\(k+1\\) distinct prime factors, it suffices to show that for every positive integer \\(N\\) with \\(k\\) distinct prime factors, every positive integer \\(m\\) and every prime \\(p\\) which does not divide \\(N\\), the number \\(f\\left(N p^{m}\\right)\\) is a power of \\(q\\). We will prove this by induction on \\(m\\). The case \\(m=0\\) follows from the previous induction hypothesis. Now suppose it has already been proved for a certain \\(m \\geq 0\\). Let \\(s\\) be a prime divisor of \\(N\\). Consider the numbers ( \\(N p^{m+1}, N s p^{m}\\) ). By the second property, \\[ \\operatorname{gcd}\\left(f\\left(N p^{m+1}\\right), q^{d\\left(N s p^{m}\\right)-1}\\right)=\\operatorname{gcd}\\left(f\\left(N p^{m+1}\\right), f\\left(N s p^{m}\\right)\\right)>f\\left(N p^{m}\\right)=q^{d\\left(N p^{m}\\right)-1} . \\] Then \\(q^{d\\left(N p^{m}\\right)}\\) divides \\(f\\left(N p^{m+1}\\right)\\). If \\(f\\left(N p^{m+1}\\right)\\) has a prime factor other than \\(q\\), it would have at least \\(2\\left(d\\left(N p^{m}\\right)+1\\right)=2((m+1) d(N)+1)=(2 m+2) d(N)+2\\) divisors, but it has only \\((m+2) d(N)\\) divisors. Hence, \\(f\\left(N p^{m+1}\\right)\\) must also be a power of \\(q\\). Finally, let us check that the function \\(f(n)=q^{d(n)-1}\\) does satisfy the properties of the problem for any prime number \\(q\\). The first property obviously holds. To check the second one, note that \\[ \\operatorname{gcd}(f(x), f(y))=q^{\\min (d(x), d(y))}>q^{d(\\operatorname{gcd}(x, y))}=f(\\operatorname{gcd}(x, y)) \\] whenever \\(x \\nmid y\\) and \\(y \\nmid x\\).", "source_pdf": "egmo_2024.pdf", "notes": ""}
{"id": "EGMO-2024-6", "contest": "EGMO", "year": "2024", "problem_number": "6", "problem": "Find all positive integers \\(d\\) for which there exists a degree \\(d\\) polynomial \\(P\\) with real coefficients such that there are at most \\(d\\) different values among \\(P(0), P(1), \\ldots, P\\left(d^{2}-\\right. d)\\).", "solution": "We claim that such polynomials exist if and only if \\(d \\leq 3\\). The following examples show that such polynomials do exist for \\(d \\leq 3\\) : \\[ \\begin{array}{llll} d=1: & d^{2}-d=0, & P_{1}(x)=x, & P(0)=0 ; \\\\ d=2: & d^{2}-d=2, & P_{2}(x)=x(x-1), & \\left\\{\\begin{array}{l} P(0)=P(1)=0 \\\\ P(2)=2 ; \\end{array}\\right. \\\\ d=3: & d^{2}-d=6, & P_{3}(x)=x(x-4)(x-5), & \\left\\{\\begin{array}{l} P(0)=P(4)=P(5)=0 \\\\ P(1)=P(2)=P(6)=12 \\\\ P(3)=6 \\end{array}\\right. \\end{array} \\] We can make more examples by adding constants. Now we will show that there are no examples of degree greater than 3 . From now on we assume (without loss of generality) that the leading coefficient of our polynomial \\(P\\) is positive and that all values \\(P(i)\\) are positive (by adding a constant if necessary) for integers \\(i\\) in the range \\(0 \\leq i \\leq d^{2}-d+1\\). Assume (for contradiction) that \\(P\\) is a polynomial of degree \\(d \\geq 4\\) that satisfies the conditions of the problem and let \\(P(0), \\ldots, P\\left(d^{2}-d\\right)\\) take values among \\(p_{1}<\\cdots<p_{d}\\). For \\(i=1, \\ldots, d\\), let \\(n_{i} \\geq 0\\) be the number of appearances of \\(p_{i}\\) among \\(P(0), \\ldots, P\\left(d^{2}-d\\right)\\). By definition \\(n_{1}+\\cdots+n_{d}=d^{2}-d+1\\). Since \\(P\\) has degree \\(d, n_{i} \\leq d\\). The key observation is now the following. Claim 1 Make the convention that \\(n_{0}=n_{d+1}=0\\). If \\(n_{i}=d\\) for some \\(i\\) in the range \\(1 \\leq i \\leq d\\), then \\(n_{i \\pm 1} \\leq d-2\\). Proof. Up to scaling and hence without loss of generality, \\(P\\) has leading coefficient +1 . Since \\(n_{i}=d\\), there exist non-negative integers \\(a_{1, i}<\\cdots<a_{d, i} \\leq d^{2}-d\\) such that \\[ P(X)=\\left(X-a_{1, i}\\right) \\cdots\\left(X-a_{d, i}\\right)+p_{i} . \\] By construction, each of the \\(d-1\\) intervals \\(I_{j}=\\left[a_{j, i}, a_{j+1, i}\\right]\\) contains at least one local extremum of \\(P\\), so contains exactly one such extremum because \\(P\\), having degree \\(d\\), has at most \\(d-1\\) such extrema. Suppose that \\(i \\leq d-1\\) and that \\(P(m)=p_{i+1}>p_{i}\\) for some \\(m \\in\\left\\{0, \\ldots, d^{2}-d\\right\\}\\). Since \\(P\\) has positive leading coefficient, \\[ m \\in\\left(a_{d, i}, \\infty\\right) \\cup\\left(a_{d-2, i}, a_{d-1, i}\\right) \\cup \\cdots \\cup\\left(a_{i, 1}, a_{2, i}\\right) \\] if \\(d\\) is odd or \\[ m \\in\\left(a_{d, i}, \\infty\\right) \\cup\\left(a_{d-2, i}, a_{d-1, i}\\right) \\cup \\cdots \\cup\\left(-\\infty, a_{1, i}\\right) \\] if \\(d\\) is even. Suppose that \\(a_{j, i}<m<a_{j+1, i}\\), for some \\(j \\in\\{1, \\ldots, d-1\\}\\). If \\(a_{j, i}+1<m<a_{j+1, i}-1\\), then, because \\(I_{j}\\) contains exactly one local extremum (which is a maximum), Either \\(p_{i+1}=P(m)>P\\left(a_{j, i}+1\\right)\\) or \\(p_{i+1}=P(m)>P\\left(a_{j+1, i}-1\\right)\\). Since \\(P\\left(a_{j, i}+1\\right)> P\\left(a_{j, i}\\right)=p_{i}\\) and \\(P\\left(a_{j, i}-1\\right)>P\\left(a_{j+1, i}\\right)=p_{i}\\), this contradicts the requirement that \\(P\\left(a_{j, i}+1\\right), P\\left(a_{j+1, i}-1\\right) \\in\\left\\{p_{1}, \\ldots, p_{d}\\right\\}\\). Hence \\(m=a_{j, i}+1\\) or \\(m=a_{j, i}-1\\). Similarly, if \\(m>a_{d, i}\\), then \\(m=a_{d, i}+1\\), but if \\(m<a_{i, 1}\\) (which may arise when \\(d\\) is even), then \\(m=a_{i, 1}-1\\). This shows that \\(m\\) belongs to this list: \\[ a_{d, i}+1, a_{d-1, i}-1, \\ldots, a_{2, i}+(-1)^{d}, a_{1, i}-(-1)^{d} \\] This list contains at most \\(d\\) different integers. It follows in particular that, if \\(n_{i+1}>d-2\\), then either \\[ P\\left(a_{d, i}+1\\right)=p_{i+1}=P\\left(a_{d-1, i}-1\\right) \\] or \\[ P\\left(a_{2, i}+(-1)^{d}\\right)=p_{i+1}=P\\left(a_{1, i}-(-1)^{d}\\right) \\] with, additionally, \\(a_{2, i}+(-1)^{d} \\neq a_{1, i}-(-1)^{d}\\). We have \\[ \\left|P\\left(a_{1, i} \\pm 1\\right)-p_{i}\\right|=1 \\cdot\\left|a_{1, i} \\pm 1-a_{2, i}\\right| \\cdot \\prod_{j=3}^{d}\\left|a_{1, i} \\pm 1-a_{j, i}\\right| \\] and \\[ \\left|P\\left(a_{2, i} \\mp 1\\right)-p_{i}\\right|=\\left|a_{2, i} \\mp 1-a_{1, i}\\right| \\cdot 1 \\cdot \\prod_{j=3}^{d}\\left|a_{2, i} \\mp 1-a_{j, i}\\right| . \\] As \\(a_{1, i}<a_{2, i}<a_{3, i}<\\ldots<a_{d, i}\\) we have \\(\\left|a_{1, i} \\pm 1-a_{j, i}\\right| \\geq\\left|a_{2, i} \\mp 1-a_{j, i}\\right|\\) with equality possible only if \\(a_{1, i}+1=a_{2, i}-1\\). We also have \\(\\left|a_{1, i} \\pm 1-a_{2, i}\\right|=\\left|a_{2, i} \\mp 1-a_{1, i}\\right|\\), which can be zero only if \\(a_{1, i}+1=a_{2, i}-1\\). We conclude that \\(\\left|P\\left(a_{1, i} \\pm 1\\right)-p_{i}\\right|>\\left|P\\left(a_{2, i} \\mp 1\\right)-p_{i}\\right|\\) or \\(a_{1, i}+1=a_{2, i}-1\\). Looking at the other end of the list of \\(\\left(a_{j, i}\\right)\\) as \\(j\\) varies, we have \\[ \\left|P\\left(a_{d-1, i}-1\\right)-p_{i}\\right|=1 \\cdot\\left|a_{d-1, i}-1-a_{d, i}\\right| \\cdot \\prod_{j=1}^{d-2}\\left|a_{d-1, i}-1-a_{j, i}\\right| \\] and \\[ \\left|P\\left(a_{d, i}+1\\right)-p_{i}\\right|=\\left|a_{d, i}+1-a_{d-1, i}\\right| \\cdot 1 \\cdot \\prod_{j=1}^{d-2}\\left|a_{d, i}+1-a_{j, i}\\right| \\] In these two formulas the shared factor outside the product is at least 2 and so is not 0 . Now look at the factors behind the product symbols. As \\(a_{1, i}<a_{2, i}<a_{3, i}<\\ldots<a_{d, i}\\), for \\(j \\leq d-2\\) we have \\(\\left|a_{d, i}+1-a_{j, i}\\right|>\\left|a_{d-1, i}-1-a_{j, i}\\right|\\). We conclude that \\(\\left|P\\left(a_{d, i}+1\\right)-p_{i}\\right|> \\left|P\\left(a_{d-1, i}-1\\right)-p_{i}\\right|\\). Claim 1 is proved. For each \\(i \\in\\{1, \\ldots, d-1\\}\\), there are three possibilities: - \\(n_{i}, n_{i+1} \\leq d-1\\) - \\(n_{i}=d\\) and \\(n_{i+1} \\leq d-2\\) - \\(n_{i+1}=d\\) and \\(n_{i} \\leq d-2\\). In all three cases, \\(n_{i}+n_{i+1} \\leq 2(d-1)\\). If \\(n\\) is even, this leads to the contradiction \\[ d^{2}-d+1=\\left(n_{1}+n_{2}\\right)+\\cdots+\\left(n_{d-1}+n_{d}\\right) \\leq(d / 2)[2(d-1)]=d^{2}-d \\] This is an important staging point in the argument because we have eliminated the possibility of a polynomial of even degree \\(d\\) satisfying the conditions of the problem if \\(d \\geq 4\\). From now on we assume that \\(d \\geq 5\\) is odd, and \\(d^{2}-d+1=\\left(n_{1}+n_{2}\\right)+\\cdots+\\left(n_{d-2}+n_{d-1}\\right)+n_{d} \\leq[(d-1) / 2][2(d-1)]+d=d^{2}-d+1\\). Equality must therefore hold throughout. Since the sum can also be grouped as \\[ n_{1}+\\left(n_{2}+n_{3}\\right)+\\cdots+\\left(n_{d-1}+n_{d}\\right), \\] this requires \\(n_{1}=n_{d}=d, n_{i}+n_{i+1}=2(d-1)\\) for \\(i=1,2, \\ldots, d-1\\) i.e. \\(n_{i}=d\\) for odd \\(i\\) and \\(n_{i}=d-2\\) for even \\(i\\). We are interested in the degree of \\(P\\) being \\(d \\geq 5\\) and odd, and showing that no polynomial \\(P\\) satisfying the conditions of the problem can exist. There are \\(d-1 \\geq 4\\) extremal points points which alternate between local maxima and minima (in that order) as you read from left to right (we normalize so that \\(P\\) is monic). For any \\(p_{i}\\) with \\(i\\) odd, the line \\(y=p_{i}\\) (with \\(i\\) odd) crosses the graph of \\(P\\) in \\(d\\) places with \\(x\\)-coordinates in the real closed interval \\(\\left[0, d^{2}-d+1\\right]\\) at points \\(\\left(z, p_{i}\\right)\\) so each \\(z\\) must be an integer. Suppose that \\(J\\) is a real interval on the \\(x\\)-axis ending at adjacent local extrema. The function defined by \\(P\\) is monotonic on each \\(J\\). The line \\(y=p_{i}\\) ( \\(i\\) odd) meets the graph at most once on \\(J\\). Therefore it meets the graph of \\(P\\) exactly once in the interior of each \\(J\\) (there are \\(d-2\\) such intervals) and at the only two possible places outside the union of these intervals. Now consider \\(p_{j}\\) when \\(j\\) is even (so \\(n_{j}=d-2\\) ). These \\(d-2\\) intervals \\(J\\) afford \\(d-2\\) real values at which \\(P\\) will take \\(p_{j}\\) as a value where \\(j\\) is fixed and even. The question is, are the corresponding arguments integers? The proof of Claim 1 tells us that in the middle of the run \\(\\left\\{0,1, \\ldots, d^{2}-d+1\\right\\}\\) all is well: the polynomial is assuming the value \\(p_{j}\\) at an integer where the polynomial assumes the values \\(p_{j-1}\\) and \\(p_{j+1}\\) at adjacent integers in some order. The problem is at the ends of the run where \\(\\left|P\\left(a_{1, i}+1\\right)-p_{i}\\right|>\\left|P\\left(a_{2, i}-1\\right)-p_{i}\\right|\\) and \\(\\left|P\\left(a_{d, i}+1\\right)-p_{i}\\right|>\\left|P\\left(a_{d-1, i}-1\\right)-p_{i}\\right|\\). When \\(j\\) is even, two of the roots of \\(P(x)-p_{j}\\) are not integers, and we now know approximately where this trouble is happening (at the ends). At this point we could finish if \\(d \\geq 7\\), because the run of regular behaviour in the middle is sufficiently long that we could obtain a contradiction. However we have to work a little harder to include the case \\(d=5\\). We now show that the run of regular behaviour is slightly longer than we have currently established. We do this using Claim 2. Claim 2. If \\(d\\) is odd, and \\(n_{i}=d, n_{i \\pm 1}=d-2\\) for some \\(i\\), then \\(P\\) attains \\(p_{i \\pm 1}\\) precisely at the \\(d-2\\) integers \\[ a_{2, i}-1, a_{3, i}+1, \\cdots, a_{d-2, i}-1, a_{d-1, i}+1 . \\] Proof Suppose (for contradiction) \\(a_{1, i}+1 \\neq a_{2, i}-1\\) and \\(P\\left(a_{1, i}+1\\right)=p_{i+1}\\). Now \\(a_{1, i}<a_{2, i}\\) so either \\(a_{1, i}+1<a_{2, i}-1\\) or \\(a_{1, i}=a_{2, i}-1\\). In the latter case, \\(P\\left(a_{1, i}+1\\right)=P\\left(a_{2, i}\\right)=p_{i}\\), a contradiction. In the former case, the proof of Claim 1 shows that \\[ \\left|P\\left(a_{2, i}-1\\right)-p_{i}\\right|<\\left|P\\left(a_{1, i}+1\\right)-p_{i}\\right|=\\left|p_{i+1}-p_{i}\\right|=p_{i+1}-p_{i} \\] so \\(P\\left(a_{2, i}-1\\right)<p_{i+1}\\). The polynomial is decreasing on the interval \\(\\left(a_{2, d}, a_{2,1}\\right)\\) so \\(p_{i}<P\\left(a_{2, i}-1\\right)<p_{i+1}\\) which is absurd because \\(P\\left(a_{2, i}-1\\right)=p_{j}\\) for some \\(j\\). Therefore \\(P\\left(a_{2, i}-1\\right)=p_{i+1}\\) for all odd \\(i\\). A similar argument shows that \\(P\\left(a_{d-1, i}+1\\right)=p_{i+1}\\) so Claim 2 is established. Now we have n sequence of alternating falling then rising then falling etc. full runs starting at ( \\(a_{2, d}, p_{d}\\) ) and ending at ( \\(a_{d-1,1}, p_{1}\\) ) so the initial run of \\(3 d+1\\) terms of this run of values is \\[ p_{d}, p_{d-1}, \\cdots p_{1}, p_{1}, p_{2}, \\ldots, p_{d}, p_{d}, p_{d-1}, \\cdots p_{1}, p_{1} \\] which starts at ( \\(a_{2, d}, p_{d}\\) ) and ends at ( \\(a_{4,1}+1, p_{1}\\) ) which is fine because \\(4 \\leq d-1\\). There are now various ways we can finish. (a) Consider the run of length \\(2 d\\) consecutive values \\[ p_{d}, p_{d-1}, \\cdots p_{1}, p_{1}, p_{2}, \\ldots, p_{d} \\] The first \\(d+1\\) points determine \\(P(x)\\). The last \\(d+1\\) values also determine \\(P\\) but the values are in the reverse order, so \\(P(X)=P(c-X)\\) for some constant \\(c\\). However, the coefficients of \\(X^{d}\\) are have opposite signs ( \\(d\\) is odd) so this is absurd. (b) The idea in (a) can be expressed in terms of Lagrange interpolation to obtain essentially the same contradiction. Construct \\(P\\) in two ways using Lagrange interpolation on both the first \\(d+1\\) and the last \\(d+1\\) points. The symmetry in the data forces the graph of \\(P\\) to have a vertical axis of symmetry. This is absurd because the degree of \\(P\\) is odd. (c) The initial fragment length \\(3 d+1\\) mentioned above at ( \\(*)\\ ) includes two identical runs of values of \\(P\\) (in the same order) of length \\(d+1\\). The polynomial \\(P\\) is determined by each of them and so \\(P(X)=P(X+c)\\) for some constant \\(c\\) and so the polynomial defines a bounded function which is absurd.", "source_pdf": "egmo_2024.pdf", "notes": ""}
{"id": "EGMO-2025-P1", "contest": "EGMO", "year": "2025", "problem_number": "P1", "problem": "For a positive integer N, let c_{1}<c_{2}<\\cdots<c_{m} be all the positive integers smaller than N that are coprime to N. Find all N \\geq 3 such that \\[ \\operatorname{gcd}\\left(N, c_{i}+c_{i+1}\\right) \\neq 1 \\] for all 1 \\leq i \\leq m-1. Here \\operatorname{gcd}(a, b) is the largest positive integer that divides both a and b. Integers a and b are coprime if \\operatorname{gcd}(a, b)=1.", "solution": "The answer is all even integers and all powers of 3. First we show that these work. - When N is even, all c_{i} are odd, and so 2 \\mid \\operatorname{gcd}\\left(N, c_{i}+c_{i+1}\\right) for every i. - When N is a power of 3 , the c_{i} are exactly the numbers in the range 1,2, \\ldots, N-1 that are not divisible by 3 . So, the sequence c_{1}, \\ldots, c_{m} alternates between numbers congruent to 1(\\bmod 3) and 2(\\bmod 3). Thus 3 \\mid \\operatorname{gcd}\\left(N, c_{i}+c_{i+1}\\right) for every i. Now we show that no other positive integer works. For the sake of contradiction, consider an odd candidate N that is not a power of 3 , and suppose it satisfies the problem condition. Then, since c_{1}=1 and c_{2}=2, we have \\operatorname{gcd}(N, 1+2) \\neq 1, so 3 \\mid N. Thus, we can write N as 3^{k} M, where k \\geq 1 and \\operatorname{gcd}(M, 6)=1. We have M \\geq 5 (as M \\neq 1 by assumption) and M+2<N. We now split into two cases based on M modulo 3. Case 1. M \\equiv 1(\\bmod 3). As 3 \\mid M-1 and M \\mid M, neither M-1 nor M are in the sequence \\left\\{c_{i}\\right\\}. As M is odd and M \\equiv 1 (\\bmod 3), M-2 and M+1 are congruent to 1(\\bmod 3), are coprime to M, and are smaller than N. Thus, both M-2 and M+1 are in the sequence, and they are consecutive terms. However, this means \\operatorname{gcd}(N, 2 M-1) \\neq 1. This gives a contradiction, as both 3 and M are coprime to 2 M-1. Case 2. M \\equiv 2(\\bmod 3). This case is similar to Case 1. Neither M nor M+1 are in the sequence, but M-1 and M+2 are. We obtain a similar contradiction from \\operatorname{gcd}(N, 2 M+1) \\neq 1.", "source_pdf": "egmo_2025.pdf", "notes": ""}
{"id": "EGMO-2025-P2", "contest": "EGMO", "year": "2025", "problem_number": "P2", "problem": "An infinite increasing sequence a_{1}<a_{2}<a_{3}<\\cdots of positive integers is called central if for every positive integer n, the arithmetic mean of the first a_{n} terms of the sequence is equal to a_{n}. Show that there exists an infinite sequence b_{1}, b_{2}, b_{3}, \\ldots of positive integers such that for every central sequence a_{1}, a_{2}, a_{3}, \\ldots, there are infinitely many positive integers n with a_{n}=b_{n}.", "solution": "We claim that the sequence b_{1}, b_{2}, b_{3}, \\ldots defined by b_{i}=2 i-1 has this property. Let d_{i}=a_{i}-b_{i}=a_{i}-2 i+1. The condition a_{i}<a_{i+1} now becomes d_{i}+2 i-1<d_{i+1}+2 i+1, which can be rewritten as d_{i+1} \\geqslant d_{i}-1. Thus, if d_{i+1}<d_{i}, then d_{i+1} must be equal to d_{i}-1. This implies in particular that if d_{i_{0}} \\geqslant 0 but d_{i_{1}} \\leqslant 0 for some indices i_{1}>i_{0}, there must be some intermediate index i_{0} \\leqslant i \\leqslant i_{1} with d_{i}=0. Because the average of the first a_{n} terms of the sequence is equal to a_{n}, we know for all n that \\[ \\sum_{i=1}^{a_{n}} d_{i}=\\sum_{i=1}^{a_{n}}\\left(a_{i}-2 i+1\\right)=\\sum_{i=1}^{a_{n}} a_{i}-\\sum_{i=1}^{a_{n}}(2 i-1)=a_{n}^{2}-a_{n}^{2}=0 \\] Because the sequence ( a_{n} ) is increasing, this implies that the sequence ( d_{i} ) contains infinitely many non-negative ( d_{i} \\geqslant 0 ) and infinitely many non-positive ( d_{i} \\leqslant 0 ) terms. In particular, we can find arbitrarily large indices i_{0} \\leqslant i_{1} such that d_{i_{0}} \\geqslant 0 and d_{i_{1}} \\leqslant 0. By our earlier observation, it follows that there are infinitely many i such that d_{i}=0, as desired.", "source_pdf": "egmo_2025.pdf", "notes": ""}
{"id": "EGMO-2025-P3", "contest": "EGMO", "year": "2025", "problem_number": "P3", "problem": "Let A B C be an acute triangle. Points B, D, E, and C lie on a line in this order and satisfy B D= D E=E C. Let M and N be the midpoints of A D and A E, respectively. Let H be the orthocentre of triangle A D E. Let P and Q be points on lines B M and C N, respectively, such that D, H, M, and P are concyclic and E, H, N, and Q are concyclic. Prove that P, Q, N, and M are concyclic. The orthocentre of a triangle is the point of intersection of its altitudes.", "solution": "Denote by B^{\\prime} and C^{\\prime} the reflections of B and C in M and N, respectively. Points C^{\\prime}, A, B^{\\prime} are clearly collinear and D E B^{\\prime} A is a parallelogram. Since E H \\perp A D, we have E H \\perp E B^{\\prime}. Also H A \\perp A B^{\\prime}, so points H, E, B^{\\prime}, A are concyclic. This gives \\[ \\angle C^{\\prime} Q H=\\angle N Q H=\\angle N E H=\\angle A E H=\\angle A B^{\\prime} H=\\angle C^{\\prime} B^{\\prime} H, \\] and so points C^{\\prime}, B^{\\prime}, Q, H are concyclic. Analogously points C^{\\prime}, B^{\\prime}, P, H are concyclic, and so all points B^{\\prime}, C^{\\prime}, P, Q, H are. Now we have \\[ \\angle N M B^{\\prime}=\\angle A B^{\\prime} M=\\angle C^{\\prime} B^{\\prime} P=\\angle C^{\\prime} Q P=\\angle N Q P, \\] which proves that P, Q, N, M are also concyclic.", "source_pdf": "egmo_2025.pdf", "notes": ""}
{"id": "EGMO-2025-P4", "contest": "EGMO", "year": "2025", "problem_number": "P4", "problem": "Let A B C be an acute triangle with incentre I and A B \\neq A C. Let lines B I and C I intersect the circumcircle of A B C at P \\neq B and Q \\neq C, respectively. Consider points R and S such that A Q R B and A C S P are parallelograms (with A Q\\|R B, A B\\| Q R, A C \\| S P, and A P \\| C S ). Let T be the point of intersection of lines R B and S C. Prove that points R, S, T, and I are concyclic.", "solution": "We will prove that \\triangle B I R \\sim \\triangle C I S, since the statement then follows from \\angle T R I=\\angle B R I=\\angle C S I= \\angle T S I. Step 1. Let us prove \\angle R B I=\\angle S C I. We will use directed angles: \\[ \\begin{aligned} (B R, B I) & =(B R, A B)+(A B, B I)=(A Q, A B)+(B I, B C) \\\\ & =(C Q, B C)+(B I, B C)=(C I, C B)+(B I, B C), \\end{aligned} \\] which is symmetric in B, C. Therefore, analogously we would obtain the same expression for ( C S, C I ). Step 2. Let us prove B R / B I=C S / C I. Clearly B R=A Q and C S=A P. Angle chasing gives \\angle I C B=\\angle Q C B=\\angle A P Q, and similarly \\angle P Q A=\\angle C B I, and so \\triangle I B C \\sim \\triangle A Q P, from which the desired A Q / B I=A P / C I follows. This finishes the solution.", "source_pdf": "egmo_2025.pdf", "notes": ""}
{"id": "EGMO-2025-P5", "contest": "EGMO", "year": "2025", "problem_number": "P5", "problem": "Let n>1 be an integer. In a configuration of an n \\times n board, each of the n^{2} cells contains an arrow, either pointing up, down, left, or right. Given a starting configuration, Turbo the snail starts in one of the cells of the board and travels from cell to cell. In each move, Turbo moves one square unit in the direction indicated by the arrow in her cell (possibly leaving the board). After each move, the arrows in all of the cells rotate 90^{\\circ} counterclockwise. We call a cell good if, starting from that cell, Turbo visits each cell of the board exactly once, without leaving the board, and returns to her initial cell at the end. Determine, in terms of n, the maximum number of good cells over all possible starting configurations.", "solution": "We will show that the maximum number of good cells over all possible starting configurations is \\[ \\begin{aligned} \\frac{n^{2}}{4} & \\text { if } n \\text { is even and } \\\\ 0 & \\text { if } n \\text { is odd. } \\end{aligned} \\] Odd n First, we will prove that there are no good cells if n is an odd number. For Turbo to reach her goal, she must return to her initial cell after visiting every cell exactly once. Consider the chessboard coloring of the board. Without loss of generality, we assume that Turbo starts in a black cell. Since, at every step, Turbo moves to a cell of a different color; she will be in a white cell after n^{2} \\equiv 1 \\bmod 2 moves. Thus, it is impossible for Turbo to come back to her initial black cell on her n^{2}-th move, which is a contradiction. Thus there are no good cells. Lower bound for even n We will now construct a starting configuration with \\frac{n^{2}}{4} good cells for even n. Let (i, j) denote the cell in row i and column j. Consider the following cycle \\[ \\begin{aligned} (1,1) & \\rightarrow(1,2) \\rightarrow(1,3) \\rightarrow \\ldots \\rightarrow(1, n) \\\\ & \\rightarrow(2, n) \\rightarrow(2, n-1) \\rightarrow \\ldots \\rightarrow(2,2) \\\\ & \\ldots \\\\ & \\rightarrow(2 i-1,2) \\rightarrow(2 i-1,3) \\rightarrow \\ldots \\rightarrow(2 i-1, n) \\\\ & \\rightarrow(2 i, n) \\rightarrow(2 i, n-1) \\rightarrow \\ldots \\rightarrow(2 i, 2) \\\\ & \\ldots \\\\ & \\rightarrow(n, n) \\rightarrow(n, n-1) \\rightarrow \\ldots \\rightarrow(n, 2) \\\\ & \\rightarrow(n, 1) \\rightarrow(n-1,1) \\rightarrow \\ldots \\rightarrow(2,1) \\rightarrow(1,1) \\end{aligned} \\] Note that the cycle returns to the initial cell after visiting every cell exactly once. To prove that (1,1) is good, we need to find a starting configuration such that Turbo traverses this cycle. Let c_{i} be the (i-1)-th cell on the cycle: so we have c_{0}=(1,1), c_{2}=(1,2), \\ldots, c_{n^{2}-1}=(2,1). For every i, we draw an arrow in cell c_{i} pointing towards cell c_{i+1} (or pointing towards c_{0} if i=n^{2}-1 ) and then rotate this arrow i times 90^{\\circ} in the clockwise direction. After i moves, the arrow in c_{i} will have rotated i times 90^{\\circ} counterclockwise and be in the same direction as on the path defined above. Thus, Turbo will traverse the cycle c_{0}, c_{1}, c_{2}, \\ldots, c_{n^{2}-1}, c_{0} and ( 1,1 ) is good. Every four moves, all arrows point in the same direction as in the beginning. Moreover, the board will return to its initial configuration after traversing the full cycle, since n^{2}, the length of the cycle, is divisible by 4 . Therefore Turbo can also start at any c_{i} with 4 \\mid i and follow the same route. Hence the cells c_{0}, c_{4}, c_{8}, \\ldots, c_{n^{2}-4} are good and there are \\frac{n^{2}}{4} of such cells. Upper bound for even n We will prove that for even n and any start configuration there are at most \\frac{n^{2}}{4} good cells. Let a_{0} be a good cell. Let a_{0}, a_{1}, a_{2}, \\ldots, a_{n^{2}-1}, a_{n^{2}}=a_{0} be the sequence of cells that Turbo visits when she starts at a_{0}. Now suppose there is another good cell b_{0} and let b_{0}, b_{1}, b_{2}, \\ldots, b_{n^{2}-1}, b_{n^{2}}=b_{0} be the sequence of cells that Turbo visits when she starts at b_{0}. Note that, since 4 \\mid n^{2}, the arrows are back to their initial configuration after n^{2} steps. Thus, if Turbo keeps walking after returning to her initial cell, she would just traverse the same cycle over and over again. Consider the upper left corner of the board. With standard row and column numbering, the corner cell is (1,1). This cell has only two neighbours, so both the a-route and the b-route must have cells (2,1),(1,1),(1,2) in that order or (1,2),(1,1),(2,1) in that order. Without loss of generality, a_{i-1}= (2,1), a_{i}=(1,1) and a_{i+1}=(1,2) for some i. Let j be such that b_{j}= (1,1). If b_{j-1}=(2,1)=a_{i-1}, then the arrow in cell (2,1) must be pointed in the same direction after i-1 steps and after j-1 steps, so i \\equiv j \\bmod 4. But then the arrow in cell b_{j}=(1,1)=a_{i} must also be pointed in the same direction after i and after j steps, so Turbo moves to b_{j+1}=a_{i+1} in both cases, and again finds the arrow pointed in the same direction in both cases. Continuing, we find that the b-route is actually identical to a_{4 t}, a_{4 t+1}, \\ldots, a_{n^{2}}=a_{0}, a_{1}, \\ldots, a_{4 t-1}, a_{4 t} for some t, as any other starting point would have the arrows in the wrong direction initially. Now suppose instead that b_{j+1}=(2,1)=a_{i-1}. Considering the a-route, the arrows in the upper left corner after i-1 steps must be like this: or Considering the b-route instead, the arrows after j-1 steps must be like this: or From the arrows in cell (1,1) we see that i \\equiv j+1 \\bmod 4. However, for the cells (2,1) and (1,2) this gives a contradiction. We conclude that the only possible good cells are a_{4 t} for t=0,1, \\ldots, \\frac{n^{2}}{4}-1, which gives at most \\frac{n^{2}}{4} good cells.", "source_pdf": "egmo_2025.pdf", "notes": ""}
{"id": "EGMO-2025-P6", "contest": "EGMO", "year": "2025", "problem_number": "P6", "problem": "In each cell of a 2025 \\times 2025 board, a nonnegative real number is written in such a way that the sum of the numbers in each row is equal to 1 , and the sum of the numbers in each column is equal to 1 . Define r_{i} to be the largest value in row i, and let R=r_{1}+r_{2}+\\cdots+r_{2025}. Similarly, define c_{i} to be the largest value in column i, and let C=c_{1}+c_{2}+\\cdots+c_{2025}. What is the largest possible value of \\frac{R}{C} ?", "solution": "Answer: \\frac{2025}{89}. In general, if the table is m^{2} \\times m^{2}, the answer is \\frac{m^{2}}{2 m-1}. The example is as follows: label rows and columns from 1 to m^{2}, from top to bottom and left to right. For the first m columns, write \\frac{1}{m} in all squares whose coordinates have the same residue modulo m and place 0 everywhere else. For the remaining m^{2}-m columns, place \\frac{1}{m^{2}} everywhere. Then R=m^{2} \\cdot \\frac{1}{m}=m, and C=m \\cdot \\frac{1}{m}+\\left(m^{2}-m\\right) \\cdot \\frac{1}{m^{2}}=2-\\frac{1}{m}. So the ratio is as claimed. In particular, when n:=m^{2}=2025, we get \\frac{2025}{89}. Now we need to show that \\frac{R}{C} \\leq \\frac{n}{2 \\sqrt{n}-1}. For each row, select one cell having the largest value appearing in said row and colour it red. Then, without loss of generality, we may rearrange the columns such that the red cells appear in the first k columns from the left, and each such column contains at least one red cell, for some k \\leq n. For the j^{\\text {th }} column, for all 1 \\leq j \\leq k, let p_{j} and n_{j} denote the sum and number of red cells in it, respectively. We observe that c_{j}, the biggest number in the j^{\\text {th }} column, is at least \\frac{p_{j}}{n_{j}}, for all 1 \\leq j \\leq k. For all other columns, the largest value they contain is at least \\frac{1}{n}, as their sum is 1 . Thus, C \\geq \\frac{p_{1}}{n_{1}}+\\frac{p_{2}}{n_{2}}+\\cdots+\\frac{p_{k}}{n_{k}}+\\frac{n-k}{n}. We can also observe that R=p_{1}+p_{2}+\\cdots+p_{k}. Therefore we have to show that: \\[ p_{1}+p_{2}+\\cdots+p_{k} \\leq \\frac{n}{2 \\sqrt{n}-1} \\cdot\\left(\\frac{p_{1}}{n_{1}}+\\frac{p_{2}}{n_{2}}+\\cdots+\\frac{p_{k}}{n_{k}}+\\frac{n-k}{n}\\right) . \\] By construction, n_{1}+n_{2}+\\cdots+n_{k}=n, and, as the numbers in every column are nonnegative, we see that p_{j} \\leq 1 for every j. Also, since each number in a red cell is at least \\frac{1}{n}, we also have p_{j} \\geq \\frac{n_{j}}{n}. Since our inequality is linear in each p_{j}, it suffices to prove it when each variable equals one of its two critical values. By relabeling, we may assume that p_{j}=\\frac{n_{j}}{n} for 1 \\leq j \\leq t, and p_{j}=1 for t+1 \\leq j \\leq k, for an integer 0 \\leq t \\leq k. First, if t=k, we observe that p_{1}+p_{2}+\\cdots+p_{k}=\\frac{n_{1}}{n}+\\frac{n_{2}}{n}+\\cdots+\\frac{n_{k}}{n}=1, and that \\frac{p_{1}}{n_{1}}+\\frac{p_{2}}{n_{2}}+\\cdots+\\frac{p_{k}}{n_{k}}= \\frac{k}{n}, so the inequality becomes 1 \\leq \\frac{n}{2 \\sqrt{n}-1}, which is true. From now on we may assume that t<k. We need to show that: \\[ \\frac{n_{1}+\\cdots+n_{t}}{n}+k-t \\leq \\frac{n}{2 \\sqrt{n}-1} \\cdot\\left(\\frac{t}{n}+\\frac{1}{n_{t+1}}+\\cdots+\\frac{1}{n_{k}}+\\frac{n-k}{n}\\right) . \\] By Cauchy-Schwarz inequality we have that: \\[ \\frac{1}{n_{t+1}}+\\cdots+\\frac{1}{n_{k}} \\geq \\frac{(k-t)^{2}}{n_{t+1}+\\cdots+n_{k}}=\\frac{(k-t)^{2}}{n-\\left(n_{1}+\\cdots+n_{t}\\right)} . \\] Let n_{1}+\\cdots+n_{t}=n \\cdot q, where 0 \\leq q<1. Thus, it is now enough to show that: \\[ q+k-t \\leq \\frac{1}{2 \\sqrt{n}-1} \\cdot\\left(n-\\ell+\\frac{\\ell^{2}}{1-q}\\right) \\] Let k-t=\\ell \\geq 1. The inequality becomes: \\[ q+\\ell \\leq \\frac{1}{2 \\sqrt{n}-1} \\cdot\\left(n-\\ell+\\frac{\\ell^{2}}{1-q}\\right) \\] Rearranging this we get: \\[ n+q+\\frac{\\ell^{2}}{1-q} \\geq 2(q+\\ell) \\sqrt{n} \\] If q=0 the inequality is trivially true by A M-G M. Suppose now that 0<q<1. Then, by Cauchy-Schwarz, we have: \\[ q+\\frac{\\ell^{2}}{1-q}=\\frac{q^{2}}{q}+\\frac{\\ell^{2}}{1-q} \\geq(q+\\ell)^{2} \\] It is therefore enough to show that n+(q+\\ell)^{2} \\geq 2(q+\\ell) \\sqrt{n}, which is true by A M-G M, completing the proof.", "source_pdf": "egmo_2025.pdf", "notes": ""}
{"id": "IMO-2016-5", "contest": "IMO", "year": "2016", "problem_number": "A6", "problem": "The equation\n\\[\n(x-1)(x-2) \\cdots(x-2016)=(x-1)(x-2) \\cdots(x-2016)\n\\]\nis written on the board. One tries to erase some linear factors from both sides so that each side still has at least one factor, and the resulting equation has no real roots. Find the least number of linear factors one needs to erase to achieve this.", "solution": "Answer. 2016.\n\n. Since there are 2016 common linear factors on both sides, we need to erase at least 2016 factors. We claim that the equation has no real roots if we erase all factors ( \\(x-k\\) ) on the left-hand side with \\(k \\equiv 2,3(\\bmod 4)\\), and all factors \\((x-m)\\) on the right-hand side with \\(m \\equiv 0,1(\\bmod 4)\\). Therefore, it suffices to show that no real number \\(x\\) satisfies\n\\[\n\\prod_{j=0}^{503}(x-4 j-1)(x-4 j-4)=\\prod_{j=0}^{503}(x-4 j-2)(x-4 j-3)\n\\]\n- Case 1. \\(x=1,2, \\ldots, 2016\\).\n\nIn this case, one side of (1) is zero while the other side is not. This shows \\(x\\) cannot satisfy (1).\n- Case 2. \\(4 k+1<x<4 k+2\\) or \\(4 k+3<x<4 k+4\\) for some \\(k=0,1, \\ldots, 503\\).\n\nFor \\(j=0,1, \\ldots, 503\\) with \\(j \\neq k\\), the product \\((x-4 j-1)(x-4 j-4)\\) is positive. For \\(j=k\\), the product \\((x-4 k-1)(x-4 k-4)\\) is negative. This shows the left-hand side of (1) is negative. On the other hand, each product \\((x-4 j-2)(x-4 j-3)\\) on the right-hand side of (1) is positive. This yields a contradiction.\n- Case 3. \\(x<1\\) or \\(x>2016\\) or \\(4 k<x<4 k+1\\) for some \\(k=1,2, \\ldots, 503\\).\n\nThe equation (1) can be rewritten as\n\\[\n1=\\prod_{j=0}^{503} \\frac{(x-4 j-1)(x-4 j-4)}{(x-4 j-2)(x-4 j-3)}=\\prod_{j=0}^{503}\\left(1-\\frac{2}{(x-4 j-2)(x-4 j-3)}\\right) .\n\\]\n\nNote that \\((x-4 j-2)(x-4 j-3)>2\\) for \\(0 \\leqslant j \\leqslant 503\\) in this case. So each term in the product lies strictly between 0 and 1 , and the whole product must be less than 1 , which is impossible.\n- Case 4. \\(4 k+2<x<4 k+3\\) for some \\(k=0,1, \\ldots, 503\\).\n\nThis time we rewrite (1) as\n\\[\n\\begin{aligned}\n1 & =\\frac{x-1}{x-2} \\cdot \\frac{x-2016}{x-2015} \\prod_{j=1}^{503} \\frac{(x-4 j)(x-4 j-1)}{(x-4 j+1)(x-4 j-2)} \\\\\n& =\\frac{x-1}{x-2} \\cdot \\frac{x-2016}{x-2015} \\prod_{j=1}^{503}\\left(1+\\frac{2}{(x-4 j+1)(x-4 j-2)}\\right)\n\\end{aligned}\n\\]\n\nClearly, \\(\\frac{x-1}{x-2}\\) and \\(\\frac{x-2016}{x-2015}\\) are both greater than 1 . For the range of \\(x\\) in this case, each term in the product is also greater than 1 . Then the right-hand side must be greater than 1 and hence a contradiction arises.\n\nFrom the four cases, we conclude that (1) has no real roots. Hence, the minimum number of linear factors to be erased is 2016.\n\nComment. We discuss the general case when 2016 is replaced by a positive integer \\(n\\). The above solution works equally well when \\(n\\) is divisible by 4 .\n\nIf \\(n \\equiv 2(\\bmod 4)\\), one may leave \\(l(x)=(x-1)(x-2) \\cdots\\left(x-\\frac{n}{2}\\right)\\) on the left-hand side and \\(r(x)=\\left(x-\\frac{n}{2}-1\\right)\\left(x-\\frac{n}{2}-2\\right) \\cdots(x-n)\\) on the right-hand side. One checks that for \\(x<\\frac{n+1}{2}\\), we have \\(|l(x)|<|r(x)|\\), while for \\(x>\\frac{n+1}{2}\\), we have \\(|l(x)|>|r(x)|\\).\n\nIf \\(n \\equiv 3(\\bmod 4)\\), one may leave \\(l(x)=(x-1)(x-2) \\cdots\\left(x-\\frac{n+1}{2}\\right)\\) on the left-hand side and \\(r(x)=\\left(x-\\frac{n+3}{2}\\right)\\left(x-\\frac{x+5}{2}\\right) \\cdots(x-n)\\) on the right-hand side. For \\(x<1\\) or \\(\\frac{n+1}{2}<x<\\frac{n+3}{2}\\), we have \\(l(x)>0>r(x)\\). For \\(1<x<\\frac{n+1}{2}\\), we have \\(|l(x)|<|r(x)|\\). For \\(x>\\frac{n+3}{2}\\), we have \\(|l(x)|>|r(x)|\\).\n\nIf \\(n \\equiv 1(\\bmod 4)\\), as the proposer mentioned, the situation is a bit more out of control. Since the construction for \\(n-1 \\equiv 0(\\bmod 4)\\) works, the answer can be either \\(n\\) or \\(n-1\\). For \\(n=5\\), we can leave the products \\((x-1)(x-2)(x-3)(x-4)\\) and \\((x-5)\\). For \\(n=9\\), the only example that works is \\(l(x)=(x-1)(x-2)(x-9)\\) and \\(r(x)=(x-3)(x-4) \\cdots(x-8)\\), while there seems to be no such partition for \\(n=13\\).", "source_pdf": "imosl_2016.pdf", "notes": "fallback-regex"}
{"id": "IMO-2016-2", "contest": "IMO", "year": "2016", "problem_number": "C4", "problem": "Find all positive integers \\(n\\) for which we can fill in the entries of an \\(n \\times n\\) table with the following properties:\n- each entry can be one of \\(I, M\\) and \\(O\\);\n- in each row and each column, the letters \\(I, M\\) and \\(O\\) occur the same number of times; and\n- in any diagonal whose number of entries is a multiple of three, the letters \\(I, M\\) and \\(O\\) occur the same number of times.", "solution": "Answer. \\(n\\) can be any multiple of 9 .\n\n. We first show that such a table exists when \\(n\\) is a multiple of 9 . Consider the following \\(9 \\times 9\\) table.\n\\[\n\\left(\\begin{array}{ccccccccc}\nI & I & I & M & M & M & O & O & O \\\\\nM & M & M & O & O & O & I & I & I \\\\\nO & O & O & I & I & I & M & M & M \\\\\nI & I & I & M & M & M & O & O & O \\\\\nM & M & M & O & O & O & I & I & I \\\\\nO & O & O & I & I & I & M & M & M \\\\\nI & I & I & M & M & M & O & O & O \\\\\nM & M & M & O & O & O & I & I & I \\\\\nO & O & O & I & I & I & M & M & M\n\\end{array}\\right)\n\\]\n\nIt is a direct checking that the table (1) satisfies the requirements. For \\(n=9 k\\) where \\(k\\) is a positive integer, we form an \\(n \\times n\\) table using \\(k \\times k\\) copies of (1). For each row and each column of the table of size \\(n\\), since there are three \\(I\\) 's, three \\(M\\) 's and three \\(O\\) 's for any nine consecutive entries, the numbers of \\(I, M\\) and \\(O\\) are equal. In addition, every diagonal of the large table whose number of entries is divisible by 3 intersects each copy of (1) at a diagonal with number of entries divisible by 3 (possibly zero). Therefore, every such diagonal also contains the same number of \\(I, M\\) and \\(O\\).\n\nNext, consider any \\(n \\times n\\) table for which the requirements can be met. As the number of entries of each row should be a multiple of 3 , we let \\(n=3 k\\) where \\(k\\) is a positive integer. We divide the whole table into \\(k \\times k\\) copies of \\(3 \\times 3\\) blocks. We call the entry at the centre of such a \\(3 \\times 3\\) square a vital entry. We also call any row, column or diagonal that contains at least one vital entry a vital line. We compute the number of pairs ( \\(l, c\\) ) where \\(l\\) is a vital line and \\(c\\) is an entry belonging to \\(l\\) that contains the letter \\(M\\). We let this number be \\(N\\).\n\nOn the one hand, since each vital line contains the same number of \\(I, M\\) and \\(O\\), it is obvious that each vital row and each vital column contain \\(k\\) occurrences of \\(M\\). For vital diagonals in either direction, we count there are exactly\n\\[\n1+2+\\cdots+(k-1)+k+(k-1)+\\cdots+2+1=k^{2}\n\\]\noccurrences of \\(M\\). Therefore, we have \\(N=4 k^{2}\\).\n\nOn the other hand, there are \\(3 k^{2}\\) occurrences of \\(M\\) in the whole table. Note that each entry belongs to exactly 1 or 4 vital lines. Therefore, \\(N\\) must be congruent to \\(3 k^{2} \\bmod 3\\).\n\nFrom the double counting, we get \\(4 k^{2} \\equiv 3 k^{2}(\\bmod 3)\\), which forces \\(k\\) to be a multiple of 3. Therefore, \\(n\\) has to be a multiple of 9 and the proof is complete.", "source_pdf": "imosl_2016.pdf", "notes": "fallback-regex"}
{"id": "IMO-2016-6", "contest": "IMO", "year": "2016", "problem_number": "C7", "problem": "Let \\(n \\geqslant 2\\) be an integer. In the plane, there are \\(n\\) segments given in such a way that any two segments have an intersection point in the interior, and no three segments intersect at a single point. Jeff places a snail at one of the endpoints of each of the segments and claps his hands \\(n-1\\) times. Each time when he claps his hands, all the snails move along their own segments and stay at the next intersection points until the next clap. Since there are \\(n-1\\) intersection points on each segment, all snails will reach the furthest intersection points from their starting points after \\(n-1\\) claps.\n(a) Prove that if \\(n\\) is odd then Jeff can always place the snails so that no two of them ever occupy the same intersection point.\n(b) Prove that if \\(n\\) is even then there must be a moment when some two snails occupy the same intersection point no matter how Jeff places the snails.", "solution": ". We consider a big disk which contains all the segments. We extend each segment to a line \\(l_{i}\\) so that each of them cuts the disk at two distinct points \\(A_{i}, B_{i}\\).\n(a) For odd \\(n\\), we travel along the circumference of the disk and mark each of the points \\(A_{i}\\) or \\(B_{i}\\) 'in' and 'out' alternately. Since every pair of lines intersect in the disk, there are exactly \\(n-1\\) points between \\(A_{i}\\) and \\(B_{i}\\) for any fixed \\(1 \\leqslant i \\leqslant n\\). As \\(n\\) is odd, this means one of \\(A_{i}\\) and \\(B_{i}\\) is marked 'in' and the other is marked 'out'. Then Jeff can put a snail on the endpoint of each segment which is closer to the 'in' side of the corresponding line. We claim that the snails on \\(l_{i}\\) and \\(l_{j}\\) do not meet for any pairs \\(i, j\\), hence proving part (a).\n![](https://cdn.mathpix.com/cropped/2025_08_23_f2fea43c73934c4e593ag-43.jpg?height=695&width=1491&top_left_y=1509&top_left_x=401)\n\nWithout loss of generality, we may assume the snails start at \\(A_{i}\\) and \\(A_{j}\\) respectively. Let \\(l_{i}\\) intersect \\(l_{j}\\) at \\(P\\). Note that there is an odd number of points between \\(\\operatorname{arc} A_{i} A_{j}\\). Each of these points belongs to a line \\(l_{k}\\). Such a line \\(l_{k}\\) must intersect exactly one of\nthe segments \\(A_{i} P\\) and \\(A_{j} P\\), making an odd number of intersections. For the other lines, they may intersect both segments \\(A_{i} P\\) and \\(A_{j} P\\), or meet none of them. Therefore, the total number of intersection points on segments \\(A_{i} P\\) and \\(A_{j} P\\) (not counting \\(P\\) ) is odd. However, if the snails arrive at \\(P\\) at the same time, then there should be the same number of intersections on \\(A_{i} P\\) and \\(A_{j} P\\), which gives an even number of intersections. This is a contradiction so the snails do not meet each other.\n(b) For even \\(n\\), we consider any way that Jeff places the snails and mark each of the points \\(A_{i}\\) or \\(B_{i}\\) 'in' and 'out' according to the directions travelled by the snails. In this case there must be two neighbouring points \\(A_{i}\\) and \\(A_{j}\\) both of which are marked 'in'. Let \\(P\\) be the intersection of the segments \\(A_{i} B_{i}\\) and \\(A_{j} B_{j}\\). Then any other segment meeting one of the segments \\(A_{i} P\\) and \\(A_{j} P\\) must also meet the other one, and so the number of intersections on \\(A_{i} P\\) and \\(A_{j} P\\) are the same. This shows the snails starting from \\(A_{i}\\) and \\(A_{j}\\) will meet at \\(P\\).\n\nComment. The conclusions do not hold for pseudosegments, as can be seen from the following examples.\n![](https://cdn.mathpix.com/cropped/2025_08_23_f2fea43c73934c4e593ag-44.jpg?height=378&width=1202&top_left_y=1170&top_left_x=414)", "source_pdf": "imosl_2016.pdf", "notes": "fallback-regex"}
{"id": "IMO-2016-1", "contest": "IMO", "year": "2016", "problem_number": "G1", "problem": "In a convex pentagon \\(A B C D E\\), let \\(F\\) be a point on \\(A C\\) such that \\(\\angle F B C=90^{\\circ}\\). Suppose triangles \\(A B F, A C D\\) and \\(A D E\\) are similar isosceles triangles with\n\\[\n\\angle F A B=\\angle F B A=\\angle D A C=\\angle D C A=\\angle E A D=\\angle E D A .\n\\]\n\nLet \\(M\\) be the midpoint of \\(C F\\). Point \\(X\\) is chosen such that \\(A M X E\\) is a parallelogram. Show that \\(B D, E M\\) and \\(F X\\) are concurrent.", "solution": "1. Denote the common angle in (1) by \\(\\theta\\). As \\(\\triangle A B F \\sim \\triangle A C D\\), we have \\(\\frac{A B}{A C}=\\frac{A F}{A D}\\) so that \\(\\triangle A B C \\sim \\triangle A F D\\). From \\(E A=E D\\), we get\n\\[\n\\angle A F D=\\angle A B C=90^{\\circ}+\\theta=180^{\\circ}-\\frac{1}{2} \\angle A E D .\n\\]\n\nHence, \\(F\\) lies on the circle with centre \\(E\\) and radius \\(E A\\). In particular, \\(E F=E A=E D\\). As \\(\\angle E F A=\\angle E A F=2 \\theta=\\angle B F C\\), points \\(B, F, E\\) are collinear.\n\nAs \\(\\angle E D A=\\angle M A D\\), we have \\(E D / / A M\\) and hence \\(E, D, X\\) are collinear. As \\(M\\) is the midpoint of \\(C F\\) and \\(\\angle C B F=90^{\\circ}\\), we get \\(M F=M B\\). In the isosceles triangles \\(E F A\\) and \\(M F B\\), we have \\(\\angle E F A=\\angle M F B\\) and \\(A F=B F\\). Therefore, they are congruent to each other. Then we have \\(B M=A E=X M\\) and \\(B E=B F+F E=A F+F M=A M=E X\\). This shows \\(\\triangle E M B \\cong \\triangle E M X\\). As \\(F\\) and \\(D\\) lie on \\(E B\\) and \\(E X\\) respectively and \\(E F=E D\\), we know that lines \\(B D\\) and \\(X F\\) are symmetric with respect to \\(E M\\). It follows that the three lines are concurrent.\n![](https://cdn.mathpix.com/cropped/2025_08_23_f2fea43c73934c4e593ag-47.jpg?height=860&width=1053&top_left_y=1528&top_left_x=566)\n\nSolution 2. From \\(\\angle C A D=\\angle E D A\\), we have \\(A C / / E D\\). Together with \\(A C / / E X\\), we know that \\(E, D, X\\) are collinear. Denote the common angle in (1) by \\(\\theta\\). From \\(\\triangle A B F \\sim \\triangle A C D\\), we get \\(\\frac{A B}{A C}=\\frac{A F}{A D}\\) so that \\(\\triangle A B C \\sim \\triangle A F D\\). This yields \\(\\angle A F D=\\angle A B C=90^{\\circ}+\\theta\\) and hence \\(\\angle F D C=90^{\\circ}\\), implying that \\(B C D F\\) is cyclic. Let \\(\\Gamma_{1}\\) be its circumcircle.\n\nNext, from \\(\\triangle A B F \\sim \\triangle A D E\\), we have \\(\\frac{A B}{A D}=\\frac{A F}{A E}\\) so that \\(\\triangle A B D \\sim \\triangle A F E\\). Therefore,\n\\[\n\\angle A F E=\\angle A B D=\\theta+\\angle F B D=\\theta+\\angle F C D=2 \\theta=180^{\\circ}-\\angle B F A .\n\\]\n\nThis implies \\(B, F, E\\) are collinear. Note that \\(F\\) is the incentre of triangle \\(D A B\\). Point \\(E\\) lies on the internal angle bisector of \\(\\angle D B A\\) and lies on the perpendicular bisector of \\(A D\\). It follows that \\(E\\) lies on the circumcircle \\(\\Gamma_{2}\\) of triangle \\(A B D\\), and \\(E A=E F=E D\\).\n\nAlso, since \\(C F\\) is a diameter of \\(\\Gamma_{1}\\) and \\(M\\) is the midpoint of \\(C F, M\\) is the centre of \\(\\Gamma_{1}\\) and hence \\(\\angle A M D=2 \\theta=\\angle A B D\\). This shows \\(M\\) lies on \\(\\Gamma_{2}\\). Next, \\(\\angle M D X=\\angle M A E=\\angle D X M\\) since \\(A M X E\\) is a parallelogram. Hence \\(M D=M X\\) and \\(X\\) lies on \\(\\Gamma_{1}\\).\n![](https://cdn.mathpix.com/cropped/2025_08_23_f2fea43c73934c4e593ag-48.jpg?height=895&width=1088&top_left_y=954&top_left_x=468)\n\nWe now have two ways to complete the solution.\n- Method 1. From \\(E F=E A=X M\\) and \\(E X / / F M, E F M X\\) is an isosceles trapezoid and is cyclic. Denote its circumcircle by \\(\\Gamma_{3}\\). Since \\(B D, E M, F X\\) are the three radical axes of \\(\\Gamma_{1}, \\Gamma_{2}, \\Gamma_{3}\\), they must be concurrent.\n- Method 2. As \\(\\angle D M F=2 \\theta=\\angle B F M\\), we have \\(D M / / E B\\). Also,\n\\[\n\\angle B F D+\\angle X B F=\\angle B F C+\\angle C F D+90^{\\circ}-\\angle C B X=2 \\theta+\\left(90^{\\circ}-\\theta\\right)+90^{\\circ}-\\theta=180^{\\circ}\n\\]\nimplies \\(D F / / X B\\). These show the corresponding sides of triangles \\(D M F\\) and \\(B E X\\) are parallel. By Desargues' Theorem, the two triangles are perspective and hence \\(D B, M E, F X\\) meet at a point.\n\nComment. In Solution 2, both the Radical Axis Theorem and Desargues' Theorem could imply \\(D B, M E, F X\\) are parallel. However, this is impossible as can be seen from the configuration. For example, it is obvious that \\(D B\\) and \\(M E\\) meet each other.\n\nSolution 3. Let the common angle in (1) be \\(\\theta\\). From \\(\\triangle A B F \\sim \\triangle A C D\\), we have \\(\\frac{A B}{A C}=\\frac{A F}{A D}\\) so that \\(\\triangle A B C \\sim \\triangle A F D\\). Then \\(\\angle A D F=\\angle A C B=90^{\\circ}-2 \\theta=90^{\\circ}-\\angle B A D\\) and hence \\(D F \\perp A B\\). As \\(F A=F B\\), this implies \\(\\triangle D A B\\) is isosceles with \\(D A=D B\\). Then \\(F\\) is the incentre of \\(\\triangle D A B\\).\n\nNext, from \\(\\angle A E D=180^{\\circ}-2 \\theta=180^{\\circ}-\\angle D B A\\), points \\(A, B, D, E\\) are concyclic. Since we also have \\(E A=E D\\), this shows \\(E, F, B\\) are collinear and \\(E A=E F=E D\\).\n![](https://cdn.mathpix.com/cropped/2025_08_23_f2fea43c73934c4e593ag-49.jpg?height=882&width=1053&top_left_y=815&top_left_x=566)\n\nNote that \\(C\\) lies on the internal angle bisector of \\(\\angle B A D\\) and lies on the external angle bisector of \\(\\angle D B A\\). It follows that it is the \\(A\\)-excentre of triangle \\(D A B\\). As \\(M\\) is the midpoint of \\(C F, M\\) lies on the circumcircle of triangle \\(D A B\\) and it is the centre of the circle passing through \\(D, F, B, C\\). By symmetry, \\(D E F M\\) is a rhombus. Then the midpoints of \\(A X, E M\\) and \\(D F\\) coincide, and it follows that \\(D A F X\\) is a parallelogram.\n\nLet \\(P\\) be the intersection of \\(B D\\) and \\(E M\\), and \\(Q\\) be the intersection of \\(A D\\) and \\(B E\\). From \\(\\angle B A C=\\angle D C A\\), we know that \\(D C, A B, E M\\) are parallel. Thus we have \\(\\frac{D P}{P B}=\\frac{C M}{M A}\\). This is further equal to \\(\\frac{A E}{B E}\\) since \\(C M=D M=D E=A E\\) and \\(M A=B E\\). From \\(\\triangle A E Q \\sim \\triangle B E A\\), we find that\n\\[\n\\frac{D P}{P B}=\\frac{A E}{B E}=\\frac{A Q}{B A}=\\frac{Q F}{F B}\n\\]\nby the Angle Bisector Theorem. This implies \\(Q D / / F P\\) and hence \\(F, P, X\\) are collinear, as desired.", "source_pdf": "imosl_2016.pdf", "notes": "fallback-regex"}
{"id": "IMO-2016-4", "contest": "IMO", "year": "2016", "problem_number": "N3", "problem": "Define \\(P(n)=n^{2}+n+1\\). For any positive integers \\(a\\) and \\(b\\), the set\n\\[\n\\{P(a), P(a+1), P(a+2), \\ldots, P(a+b)\\}\n\\]\nis said to be fragrant if none of its elements is relatively prime to the product of the other elements. Determine the smallest size of a fragrant set.", "solution": "Answer. 6.\n\n. We have the following observations.\n(i) \\((P(n), P(n+1))=1\\) for any \\(n\\).\n\nWe have \\((P(n), P(n+1))=\\left(n^{2}+n+1, n^{2}+3 n+3\\right)=\\left(n^{2}+n+1,2 n+2\\right)\\). Noting that \\(n^{2}+n+1\\) is odd and \\(\\left(n^{2}+n+1, n+1\\right)=(1, n+1)=1\\), the claim follows.\n(ii) \\((P(n), P(n+2))=1\\) for \\(n \\not \\equiv 2(\\bmod 7)\\) and \\((P(n), P(n+2))=7\\) for \\(n \\equiv 2(\\bmod 7)\\). From \\((2 n+7) P(n)-(2 n-1) P(n+2)=14\\) and the fact that \\(P(n)\\) is odd, \\((P(n), P(n+2))\\) must be a divisor of 7 . The claim follows by checking \\(n \\equiv 0,1, \\ldots, 6(\\bmod 7)\\) directly.\n(iii) \\((P(n), P(n+3))=1\\) for \\(n \\not \\equiv 1(\\bmod 3)\\) and \\(3 \\mid(P(n), P(n+3))\\) for \\(n \\equiv 1(\\bmod 3)\\). From \\((n+5) P(n)-(n-1) P(n+3)=18\\) and the fact that \\(P(n)\\) is odd, \\((P(n), P(n+3))\\) must be a divisor of 9 . The claim follows by checking \\(n \\equiv 0,1,2(\\bmod 3)\\) directly.\n\nSuppose there exists a fragrant set with at most 5 elements. We may assume it contains exactly 5 elements \\(P(a), P(a+1), \\ldots, P(a+4)\\) since the following argument also works with fewer elements. Consider \\(P(a+2)\\). From (i), it is relatively prime to \\(P(a+1)\\) and \\(P(a+3)\\). Without loss of generality, assume \\((P(a), P(a+2))>1\\). From (ii), we have \\(a \\equiv 2(\\bmod 7)\\). The same observation implies \\((P(a+1), P(a+3))=1\\). In order that the set is fragrant, ( \\(P(a), P(a+3)\\) ) and ( \\(P(a+1), P(a+4)\\) ) must both be greater than 1 . From (iii), this holds only when both \\(a\\) and \\(a+1\\) are congruent to \\(1 \\bmod 3\\), which is a contradiction.\n\nIt now suffices to construct a fragrant set of size 6. By the Chinese Remainder Theorem, we can take a positive integer \\(a\\) such that\n\\[\na \\equiv 7 \\quad(\\bmod 19), \\quad a+1 \\equiv 2 \\quad(\\bmod 7), \\quad a+2 \\equiv 1 \\quad(\\bmod 3) .\n\\]\n\nFor example, we may take \\(a=197\\). From (ii), both \\(P(a+1)\\) and \\(P(a+3)\\) are divisible by 7. From (iii), both \\(P(a+2)\\) and \\(P(a+5)\\) are divisible by 3 . One also checks from \\(19 \\mid P(7)=57\\) and \\(19 \\mid P(11)=133\\) that \\(P(a)\\) and \\(P(a+4)\\) are divisible by 19. Therefore, the set \\(\\{P(a), P(a+1), \\ldots, P(a+5)\\}\\) is fragrant.\n\nTherefore, the smallest size of a fragrant set is 6 .\nComment. \"Fragrant Harbour\" is the English translation of \"Hong Kong\".\nA stronger version of this problem is to show that there exists a fragrant set of size \\(k\\) for any \\(k \\geqslant 6\\). We present a proof here.\n\nFor each even positive integer \\(m\\) which is not divisible by 3 , since \\(m^{2}+3 \\equiv 3(\\bmod 4)\\), we can find a prime \\(p_{m} \\equiv 3(\\bmod 4)\\) such that \\(p_{m} \\mid m^{2}+3\\). Clearly, \\(p_{m}>3\\).\n\nIf \\(b=2 t \\geqslant 6\\), we choose \\(a\\) such that \\(3 \\mid 2(a+t)+1\\) and \\(p_{m} \\mid 2(a+t)+1\\) for each \\(1 \\leqslant m \\leqslant b\\) with \\(m \\equiv 2,4(\\bmod 6)\\). For \\(0 \\leqslant r \\leqslant t\\) and \\(3 \\mid r\\), we have \\(a+t \\pm r \\equiv 1(\\bmod 3)\\) so that \\(3 \\mid P(a+t \\pm r)\\). For \\(0 \\leqslant r \\leqslant t\\) and \\((r, 3)=1\\), we have\n\\[\n4 P(a+t \\pm r) \\equiv(-1 \\pm 2 r)^{2}+2(-1 \\pm 2 r)+4=4 r^{2}+3 \\equiv 0 \\quad\\left(\\bmod p_{2 r}\\right)\n\\]\n\nHence, \\(\\{P(a), P(a+1), \\ldots, P(a+b)\\}\\) is fragrant.\nIf \\(b=2 t+1 \\geqslant 7\\) (the case \\(b=5\\) has been done in the original problem), we choose \\(a\\) such that \\(3 \\mid 2(a+t)+1\\) and \\(p_{m} \\mid 2(a+t)+1\\) for \\(1 \\leqslant m \\leqslant b\\) with \\(m \\equiv 2,4(\\bmod 6)\\), and that \\(a+b \\equiv 9(\\bmod 13)\\). Note that \\(a\\) exists by the Chinese Remainder Theorem since \\(p_{m} \\neq 13\\) for all \\(m\\). The even case shows that \\(\\{P(a), P(a+1), \\ldots, P(a+b-1)\\}\\) is fragrant. Also, one checks from \\(13 \\mid P(9)=91\\) and \\(13 \\mid P(3)=13\\) that \\(P(a+b)\\) and \\(P(a+b-6)\\) are divisible by 13. The proof is thus complete.", "source_pdf": "imosl_2016.pdf", "notes": "fallback-regex"}
{"id": "IMO-2016-3", "contest": "IMO", "year": "2016", "problem_number": "N7", "problem": "Let \\(n\\) be an odd positive integer. In the Cartesian plane, a cyclic polygon \\(P\\) with area \\(S\\) is chosen. All its vertices have integral coordinates, and the squares of its side lengths are all divisible by \\(n\\). Prove that \\(2 S\\) is an integer divisible by \\(n\\).", "solution": ". Let \\(P=A_{1} A_{2} \\ldots A_{k}\\) and let \\(A_{k+i}=A_{i}\\) for \\(i \\geqslant 1\\). By the Shoelace Formula, the area of any convex polygon with integral coordinates is half an integer. Therefore, \\(2 S\\) is an integer. We shall prove by induction on \\(k \\geqslant 3\\) that \\(2 S\\) is divisible by \\(n\\). Clearly, it suffices to consider \\(n=p^{t}\\) where \\(p\\) is an odd prime and \\(t \\geqslant 1\\).\n\nFor the base case \\(k=3\\), let the side lengths of \\(P\\) be \\(\\sqrt{n a}, \\sqrt{n b}, \\sqrt{n c}\\) where \\(a, b, c\\) are positive integers. By Heron's Formula,\n\\[\n16 S^{2}=n^{2}\\left(2 a b+2 b c+2 c a-a^{2}-b^{2}-c^{2}\\right)\n\\]\n\nThis shows \\(16 S^{2}\\) is divisible by \\(n^{2}\\). Since \\(n\\) is odd, \\(2 S\\) is divisible by \\(n\\).\nAssume \\(k \\geqslant 4\\). If the square of length of one of the diagonals is divisible by \\(n\\), then that diagonal divides \\(P\\) into two smaller polygons, to which the induction hypothesis applies. Hence we may assume that none of the squares of diagonal lengths is divisible by \\(n\\). As usual, we denote by \\(\\nu_{p}(r)\\) the exponent of \\(p\\) in the prime decomposition of \\(r\\). We claim the following.\n- Claim. \\(\\nu_{p}\\left(A_{1} A_{m}^{2}\\right)>\\nu_{p}\\left(A_{1} A_{m+1}^{2}\\right)\\) for \\(2 \\leqslant m \\leqslant k-1\\).\n\nProof. The case \\(m=2\\) is obvious since \\(\\nu_{p}\\left(A_{1} A_{2}^{2}\\right) \\geqslant p^{t}>\\nu_{p}\\left(A_{1} A_{3}^{2}\\right)\\) by the condition and the above assumption.\n\nSuppose \\(\\nu_{p}\\left(A_{1} A_{2}^{2}\\right)>\\nu_{p}\\left(A_{1} A_{3}^{2}\\right)>\\cdots>\\nu_{p}\\left(A_{1} A_{m}^{2}\\right)\\) where \\(3 \\leqslant m \\leqslant k-1\\). For the induction step, we apply Ptolemy's Theorem to the cyclic quadrilateral \\(A_{1} A_{m-1} A_{m} A_{m+1}\\) to get\n\\[\nA_{1} A_{m+1} \\times A_{m-1} A_{m}+A_{1} A_{m-1} \\times A_{m} A_{m+1}=A_{1} A_{m} \\times A_{m-1} A_{m+1}\n\\]\nwhich can be rewritten as\n\\[\n\\begin{aligned}\nA_{1} A_{m+1}^{2} \\times A_{m-1} A_{m}^{2}= & A_{1} A_{m-1}^{2} \\times A_{m} A_{m+1}^{2}+A_{1} A_{m}^{2} \\times A_{m-1} A_{m+1}^{2} \\\\\n& -2 A_{1} A_{m-1} \\times A_{m} A_{m+1} \\times A_{1} A_{m} \\times A_{m-1} A_{m+1}\n\\end{aligned}\n\\]\n\nFrom this, \\(2 A_{1} A_{m-1} \\times A_{m} A_{m+1} \\times A_{1} A_{m} \\times A_{m-1} A_{m+1}\\) is an integer. We consider the component of \\(p\\) of each term in (1). By the inductive hypothesis, we have \\(\\nu_{p}\\left(A_{1} A_{m-1}^{2}\\right)>\\nu_{p}\\left(A_{1} A_{m}^{2}\\right)\\). Also, we have \\(\\nu_{p}\\left(A_{m} A_{m+1}^{2}\\right) \\geqslant p^{t}>\\nu_{p}\\left(A_{m-1} A_{m+1}^{2}\\right)\\). These give\n\\[\n\\nu_{p}\\left(A_{1} A_{m-1}^{2} \\times A_{m} A_{m+1}^{2}\\right)>\\nu_{p}\\left(A_{1} A_{m}^{2} \\times A_{m-1} A_{m+1}^{2}\\right)\n\\]\n\nNext, we have \\(\\nu_{p}\\left(4 A_{1} A_{m-1}^{2} \\times A_{m} A_{m+1}^{2} \\times A_{1} A_{m}^{2} \\times A_{m-1} A_{m+1}^{2}\\right)=\\nu_{p}\\left(A_{1} A_{m-1}^{2} \\times A_{m} A_{m+1}^{2}\\right)+ \\nu_{p}\\left(A_{1} A_{m}^{2} \\times A_{m-1} A_{m+1}^{2}\\right)>2 \\nu_{p}\\left(A_{1} A_{m}^{2} \\times A_{m-1} A_{m+1}^{2}\\right)\\) from (2). This implies\n\\[\n\\nu_{p}\\left(2 A_{1} A_{m-1} \\times A_{m} A_{m+1} \\times A_{1} A_{m} \\times A_{m-1} A_{m+1}\\right)>\\nu_{p}\\left(A_{1} A_{m}^{2} \\times A_{m-1} A_{m+1}^{2}\\right)\n\\]\n\nCombining (1), (2) and (3), we conclude that\n\\[\n\\nu_{p}\\left(A_{1} A_{m+1}^{2} \\times A_{m-1} A_{m}^{2}\\right)=\\nu_{p}\\left(A_{1} A_{m}^{2} \\times A_{m-1} A_{m+1}^{2}\\right)\n\\]\n\nBy \\(\\nu_{p}\\left(A_{m-1} A_{m}^{2}\\right) \\geqslant p^{t}>\\nu_{p}\\left(A_{m-1} A_{m+1}^{2}\\right)\\), we get \\(\\nu_{p}\\left(A_{1} A_{m+1}^{2}\\right)<\\nu_{p}\\left(A_{1} A_{m}^{2}\\right)\\). The Claim follows by induction.\n\nFrom the Claim, we get a chain of inequalities\n\\[\np^{t}>\\nu_{p}\\left(A_{1} A_{3}^{2}\\right)>\\nu_{p}\\left(A_{1} A_{4}^{2}\\right)>\\cdots>\\nu_{p}\\left(A_{1} A_{k}^{2}\\right) \\geqslant p^{t}\n\\]\nwhich yields a contradiction. Therefore, we can show by induction that \\(2 S\\) is divisible by \\(n\\).\nComment. The condition that \\(P\\) is cyclic is crucial. As a counterexample, consider the rhombus with vertices \\((0,3),(4,0),(0,-3),(-4,0)\\). Each of its squares of side lengths is divisible by 5 , while \\(2 S=48\\) is not.\n\nThe proposer also gives a proof for the case \\(n\\) is even. One just needs an extra technical step for the case \\(p=2\\).", "source_pdf": "imosl_2016.pdf", "notes": "fallback-regex"}
{"id": "IMO-2017-2", "contest": "IMO", "year": "2017", "problem_number": "A6", "problem": "Find all functions \\(f: \\mathbb{R} \\rightarrow \\mathbb{R}\\) such that\n\\[\nf(f(x) f(y))+f(x+y)=f(x y)\n\\]\nfor all \\(x, y \\in \\mathbb{R}\\).", "solution": "Answer: There are 3 solutions:\n\\[\nx \\mapsto 0 \\quad \\text { or } \\quad x \\mapsto x-1 \\quad \\text { or } \\quad x \\mapsto 1-x \\quad(x \\in \\mathbb{R}) .\n\\]\n\n. An easy check shows that all the 3 above mentioned functions indeed satisfy the original equation (*).\n\nIn order to show that these are the only solutions, first observe that if \\(f(x)\\) is a solution then \\(-f(x)\\) is also a solution. Hence, without loss of generality we may (and will) assume that \\(f(0) \\leqslant 0\\) from now on. We have to show that either \\(f\\) is identically zero or \\(f(x)=x-1 (\\forall x \\in \\mathbb{R})\\).\n\nObserve that, for a fixed \\(x \\neq 1\\), we may choose \\(y \\in \\mathbb{R}\\) so that \\(x+y=x y \\Longleftrightarrow y=\\frac{x}{x-1}\\), and therefore from the original equation (*) we have\n\\[\nf\\left(f(x) \\cdot f\\left(\\frac{x}{x-1}\\right)\\right)=0 \\quad(x \\neq 1)\n\\]\n\nIn particular, plugging in \\(x=0\\) in (1), we conclude that \\(f\\) has at least one zero, namely \\((f(0))^{2}\\) :\n\\[\nf\\left((f(0))^{2}\\right)=0\n\\]\n\nWe analyze two cases (recall that \\(f(0) \\leqslant 0\\) ):\nCase 1: \\(f(0)=0\\).\nSetting \\(y=0\\) in the original equation we get the identically zero solution:\n\\[\nf(f(x) f(0))+f(x)=f(0) \\Longrightarrow f(x)=0 \\text { for all } x \\in \\mathbb{R}\n\\]\n\nFrom now on, we work on the main\nCase 2: \\(f(0)<0\\).\nWe begin with the following\nClaim 1.\n\\[\nf(1)=0, \\quad f(a)=0 \\Longrightarrow a=1, \\quad \\text { and } \\quad f(0)=-1 .\n\\]\n\nProof. We need to show that 1 is the unique zero of \\(f\\). First, observe that \\(f\\) has at least one zero \\(a\\) by (2); if \\(a \\neq 1\\) then setting \\(x=a\\) in (1) we get \\(f(0)=0\\), a contradiction. Hence from (2) we get \\((f(0))^{2}=1\\). Since we are assuming \\(f(0)<0\\), we conclude that \\(f(0)=-1\\).\n\nSetting \\(y=1\\) in the original equation (*) we get\n\\(f(f(x) f(1))+f(x+1)=f(x) \\Longleftrightarrow f(0)+f(x+1)=f(x) \\Longleftrightarrow f(x+1)=f(x)+1 \\quad(x \\in \\mathbb{R})\\).\nAn easy induction shows that\n\\[\nf(x+n)=f(x)+n \\quad(x \\in \\mathbb{R}, n \\in \\mathbb{Z}) .\n\\]\n\nNow we make the following\nClaim 2. \\(f\\) is injective.\nProof. Suppose that \\(f(a)=f(b)\\) with \\(a \\neq b\\). Then by (4), for all \\(N \\in \\mathbb{Z}\\),\n\\[\nf(a+N+1)=f(b+N)+1 .\n\\]\n\nChoose any integer \\(N<-b\\); then there exist \\(x_{0}, y_{0} \\in \\mathbb{R}\\) with \\(x_{0}+y_{0}=a+N+1, x_{0} y_{0}=b+N\\). Since \\(a \\neq b\\), we have \\(x_{0} \\neq 1\\) and \\(y_{0} \\neq 1\\). Plugging in \\(x_{0}\\) and \\(y_{0}\\) in the original equation (*) we get\n\\[\n\\begin{aligned}\nf\\left(f\\left(x_{0}\\right) f\\left(y_{0}\\right)\\right)+f(a+N+1)=f(b+N) & \\Longleftrightarrow f\\left(f\\left(x_{0}\\right) f\\left(y_{0}\\right)\\right)+1=0 \\\\\n& \\Longleftrightarrow f\\left(f\\left(x_{0}\\right) f\\left(y_{0}\\right)+1\\right)=0 \\\\\n& \\Longleftrightarrow f\\left(x_{0}\\right) f\\left(y_{0}\\right)=0\n\\end{aligned}\n\\]\n\nHowever, by Claim 1 we have \\(f\\left(x_{0}\\right) \\neq 0\\) and \\(f\\left(y_{0}\\right) \\neq 0\\) since \\(x_{0} \\neq 1\\) and \\(y_{0} \\neq 1\\), a contradiction.\nNow the end is near. For any \\(t \\in \\mathbb{R}\\), plug in \\((x, y)=(t,-t)\\) in the original equation (*) to get\n\\[\n\\begin{aligned}\nf(f(t) f(-t))+f(0)=f\\left(-t^{2}\\right) & \\Longleftrightarrow f(f(t) f(-t))=f\\left(-t^{2}\\right)+1 \\quad \\text { by (3) } \\\\\n& \\Longleftrightarrow f(f(t) f(-t))=f\\left(-t^{2}+1\\right) \\quad \\text { by (4) } \\\\\n& \\Longleftrightarrow f(t) f(-t)=-t^{2}+1 \\quad \\text { by injectivity of } f .\n\\end{aligned}\n\\]\n\nSimilarly, plugging in \\((x, y)=(t, 1-t)\\) in \\((*)\\) we get\n\\[\n\\begin{aligned}\nf(f(t) f(1-t))+f(1)=f(t(1-t)) & \\Longleftrightarrow f(f(t) f(1-t))=f(t(1-t)) \\quad \\text { by }(3) \\\\\n& \\Longleftrightarrow f(t) f(1-t)=t(1-t) \\quad \\text { by injectivity of } f .\n\\end{aligned}\n\\]\n\nBut since \\(f(1-t)=1+f(-t)\\) by (4), we get\n\\[\n\\begin{aligned}\nf(t) f(1-t)=t(1-t) & \\Longleftrightarrow f(t)(1+f(-t))=t(1-t) \\Longleftrightarrow f(t)+\\left(-t^{2}+1\\right)=t(1-t) \\\\\n& \\Longleftrightarrow f(t)=t-1,\n\\end{aligned}\n\\]\nas desired.\n\nComment. Other approaches are possible. For instance, after Claim 1, we may define\n\\[\ng(x) \\stackrel{\\text { def }}{=} f(x)+1 .\n\\]\n\nReplacing \\(x+1\\) and \\(y+1\\) in place of \\(x\\) and \\(y\\) in the original equation (*), we get\n\\[\nf(f(x+1) f(y+1))+f(x+y+2)=f(x y+x+y+1) \\quad(x, y \\in \\mathbb{R}),\n\\]\nand therefore, using (4) (so that in particular \\(g(x)=f(x+1)\\) ), we may rewrite ( \\(*\\) ) as\n\\[\ng(g(x) g(y))+g(x+y)=g(x y+x+y) \\quad(x, y \\in \\mathbb{R}) .\n\\]\n\nWe are now to show that \\(g(x)=x\\) for all \\(x \\in \\mathbb{R}\\) under the assumption (Claim 1) that 0 is the unique zero of \\(g\\).\nClaim 3. Let \\(n \\in \\mathbb{Z}\\) and \\(x \\in \\mathbb{R}\\). Then\n(a) \\(g(x+n)=x+n\\), and the conditions \\(g(x)=n\\) and \\(x=n\\) are equivalent.\n(b) \\(g(n x)=n g(x)\\).\n\nProof. For part (a), just note that \\(g(x+n)=x+n\\) is just a reformulation of (4). Then \\(g(x)=n \\Longleftrightarrow g(x-n)=0 \\Longleftrightarrow x-n=0\\) since 0 is the unique zero of \\(g\\). For part (b), we may assume that \\(x \\neq 0\\) since the result is obvious when \\(x=0\\). Plug in \\(y=n / x\\) in ( \\(* *\\) ) and use part (a) to get\n\\[\ng\\left(g(x) g\\left(\\frac{n}{x}\\right)\\right)+g\\left(x+\\frac{n}{x}\\right)=g\\left(n+x+\\frac{n}{x}\\right) \\Longleftrightarrow g\\left(g(x) g\\left(\\frac{n}{x}\\right)\\right)=n \\Longleftrightarrow g(x) g\\left(\\frac{n}{x}\\right)=n .\n\\]\n\nIn other words, for \\(x \\neq 0\\) we have\n\\[\ng(x)=\\frac{n}{g(n / x)}\n\\]\n\nIn particular, for \\(n=1\\), we get \\(g(1 / x)=1 / g(x)\\), and therefore replacing \\(x \\leftarrow n x\\) in the last equation we finally get\n\\[\ng(n x)=\\frac{n}{g(1 / x)}=n g(x)\n\\]\nas required.\nClaim 4. The function \\(g\\) is additive, i.e., \\(g(a+b)=g(a)+g(b)\\) for all \\(a, b \\in \\mathbb{R}\\).\nProof. Set \\(x \\leftarrow-x\\) and \\(y \\leftarrow-y\\) in ( \\(* *\\) ); since \\(g\\) is an odd function (by Claim 3(b) with \\(n=-1\\) ), we get\n\\[\ng(g(x) g(y))-g(x+y)=-g(-x y+x+y)\n\\]\n\nSubtracting the last relation from (**) we have\n\\[\n2 g(x+y)=g(x y+x+y)+g(-x y+x+y)\n\\]\nand since by Claim 3(b) we have \\(2 g(x+y)=g(2(x+y))\\), we may rewrite the last equation as\n\\[\ng(\\alpha+\\beta)=g(\\alpha)+g(\\beta) \\quad \\text { where } \\quad\\left\\{\\begin{array}{l}\n\\alpha=x y+x+y \\\\\n\\beta=-x y+x+y\n\\end{array}\\right.\n\\]\n\nIn other words, we have additivity for all \\(\\alpha, \\beta \\in \\mathbb{R}\\) for which there are real numbers \\(x\\) and \\(y\\) satisfying\n\\[\nx+y=\\frac{\\alpha+\\beta}{2} \\quad \\text { and } \\quad x y=\\frac{\\alpha-\\beta}{2}\n\\]\ni.e., for all \\(\\alpha, \\beta \\in \\mathbb{R}\\) such that \\(\\left(\\frac{\\alpha+\\beta}{2}\\right)^{2}-4 \\cdot \\frac{\\alpha-\\beta}{2} \\geqslant 0\\). Therefore, given any \\(a, b \\in \\mathbb{R}\\), we may choose \\(n \\in \\mathbb{Z}\\) large enough so that we have additivity for \\(\\alpha=n a\\) and \\(\\beta=n b\\), i.e.,\n\\[\ng(n a)+g(n b)=g(n a+n b) \\Longleftrightarrow n g(a)+n g(b)=n g(a+b)\n\\]\nby Claim 3(b). Cancelling \\(n\\), we get the desired result. (Alternatively, setting either \\((\\alpha, \\beta)=(a, b)\\) or \\((\\alpha, \\beta)=(-a,-b)\\) will ensure that \\(\\left(\\frac{\\alpha+\\beta}{2}\\right)^{2}-4 \\cdot \\frac{\\alpha-\\beta}{2} \\geqslant 0\\) ).\n\nNow we may finish the solution. Set \\(y=1\\) in ( \\(* *\\) ), and use Claim 3 to get\n\\[\ng(g(x) g(1))+g(x+1)=g(2 x+1) \\Longleftrightarrow g(g(x))+g(x)+1=2 g(x)+1 \\Longleftrightarrow g(g(x))=g(x) .\n\\]\n\nBy additivity, this is equivalent to \\(g(g(x)-x)=0\\). Since 0 is the unique zero of \\(g\\) by assumption, we finally get \\(g(x)-x=0 \\Longleftrightarrow g(x)=x\\) for all \\(x \\in \\mathbb{R}\\).", "source_pdf": "imosl_2017.pdf", "notes": "fallback-regex"}
{"id": "IMO-2017-5", "contest": "IMO", "year": "2017", "problem_number": "C4", "problem": "Let \\(N \\geqslant 2\\) be an integer. \\(N(N+1)\\) soccer players, no two of the same height, stand in a row in some order. Coach Ralph wants to remove \\(N(N-1)\\) people from this row so that in the remaining row of \\(2 N\\) players, no one stands between the two tallest ones, no one stands between the third and the fourth tallest ones, ..., and finally no one stands between the two shortest ones. Show that this is always possible.\n(Russia)", "solution": "1. Split the row into \\(N\\) blocks with \\(N+1\\) consecutive people each. We will show how to remove \\(N-1\\) people from each block in order to satisfy the coach's wish.\n\nFirst, construct a \\((N+1) \\times N\\) matrix where \\(x_{i, j}\\) is the height of the \\(i^{\\text {th }}\\) tallest person of the \\(j^{\\text {th }}\\) block-in other words, each column lists the heights within a single block, sorted in decreasing order from top to bottom.\n\nWe will reorder this matrix by repeatedly swapping whole columns. First, by column permutation, make sure that \\(x_{2,1}=\\max \\left\\{x_{2, i}: i=1,2, \\ldots, N\\right\\}\\) (the first column contains the largest height of the second row). With the first column fixed, permute the other ones so that \\(x_{3,2}=\\max \\left\\{x_{3, i}: i=2, \\ldots, N\\right\\}\\) (the second column contains the tallest person of the third row, first column excluded). In short, at step \\(k(k=1,2, \\ldots, N-1)\\), we permute the columns from \\(k\\) to \\(N\\) so that \\(x_{k+1, k}=\\max \\left\\{x_{i, k}: i=k, k+1, \\ldots, N\\right\\}\\), and end up with an array like this:\n\n\\begin{tabular}{cccccc}\n\\(\\boldsymbol{x}_{\\mathbf{1 , 1}}\\) & \\(x_{1,2}\\) & \\(x_{1,3}\\) & \\(\\cdots\\) & \\(x_{1, N-1}\\) & \\(x_{1, N}\\) \\\\\n\\(\\vee\\) & \\(\\vee\\) & \\(\\vee\\) & & \\(\\vee\\) & \\(\\vee\\) \\\\\n\\(\\boldsymbol{x}_{\\mathbf{2 , 1}} \\boldsymbol{>}\\) & \\(\\boldsymbol{x}_{\\mathbf{2 , 2}}\\) & \\(x_{2,3}\\) & \\(\\cdots\\) & \\(x_{2, N-1}\\) & \\(x_{2, N}\\) \\\\\n\\(\\vee\\) & \\(\\vee\\) & \\(\\vee\\) & & \\(\\vee\\) & \\(\\vee\\) \\\\\n\\(x_{3,1}\\) & \\(\\boldsymbol{x}_{\\mathbf{3 , 2}}\\) & \\(\\boldsymbol{x}_{\\mathbf{3 , 3}}\\) & \\(\\cdots\\) & \\(x_{3, N-1}\\) & \\(x_{3, N}\\) \\\\\n\\(\\vee\\) & \\(\\vee\\) & \\(\\vee\\) & & \\(\\vee\\) & \\(\\vee\\) \\\\\n\\(\\vdots\\) & \\(\\vdots\\) & \\(\\vdots\\) & \\(\\ddots\\) & \\(\\vdots\\) & \\(\\vdots\\) \\\\\n\\(\\vee\\) & \\(\\vee\\) & \\(\\vee\\) & & \\(\\vee\\) & \\(\\vee\\) \\\\\n\\(x_{N, 1}\\) & \\(x_{N, 2}\\) & \\(x_{N, 3}\\) & \\(\\cdots\\) & \\(\\boldsymbol{x}_{\\boldsymbol{N , N - 1}}>\\) & \\(\\boldsymbol{x}_{\\boldsymbol{N , N}}\\) \\\\\n\\(\\vee\\) & \\(\\vee\\) & \\(\\vee\\) & & \\(\\vee\\) & \\(\\vee\\) \\\\\n\\(x_{N+1,1}\\) & \\(x_{N+1,2}\\) & \\(x_{N+1,3} \\cdots\\) & \\(x_{N+1, N-1}\\) & \\(\\boldsymbol{x}_{\\boldsymbol{N}+\\mathbf{1 , N}}\\)\n\\end{tabular}\n\nNow we make the bold choice: from the original row of people, remove everyone but those with heights\n\\[\nx_{1,1}>x_{2,1}>x_{2,2}>x_{3,2}>\\cdots>x_{N, N-1}>x_{N, N}>x_{N+1, N}\n\\]\n\nOf course this height order (*) is not necessarily their spatial order in the new row. We now need to convince ourselves that each pair ( \\(x_{k, k} ; x_{k+1, k}\\) ) remains spatially together in this new row. But \\(x_{k, k}\\) and \\(x_{k+1, k}\\) belong to the same column/block of consecutive \\(N+1\\) people; the only people that could possibly stand between them were also in this block, and they are all gone.\n\nSolution 2. Split the people into \\(N\\) groups by height: group \\(G_{1}\\) has the \\(N+1\\) tallest ones, group \\(G_{2}\\) has the next \\(N+1\\) tallest, and so on, up to group \\(G_{N}\\) with the \\(N+1\\) shortest people.\n\nNow scan the original row from left to right, stopping as soon as you have scanned two people (consecutively or not) from the same group, say, \\(G_{i}\\). Since we have \\(N\\) groups, this must happen before or at the \\((N+1)^{\\text {th }}\\) person of the row. Choose this pair of people, removing all the other people from the same group \\(G_{i}\\) and also all people that have been scanned so far. The only people that could separate this pair's heights were in group \\(G_{i}\\) (and they are gone); the only people that could separate this pair's positions were already scanned (and they are gone too).\n\nWe are now left with \\(N-1\\) groups (all except \\(G_{i}\\) ). Since each of them lost at most one person, each one has at least \\(N\\) unscanned people left in the row. Repeat the scanning process from left to right, choosing the next two people from the same group, removing this group and\neveryone scanned up to that point. Once again we end up with two people who are next to each other in the remaining row and whose heights cannot be separated by anyone else who remains (since the rest of their group is gone). After picking these 2 pairs, we still have \\(N-2\\) groups with at least \\(N-1\\) people each.\n\nIf we repeat the scanning process a total of \\(N\\) times, it is easy to check that we will end up with 2 people from each group, for a total of \\(2 N\\) people remaining. The height order is guaranteed by the grouping, and the scanning construction from left to right guarantees that each pair from a group stand next to each other in the final row. We are done.\n\nSolution 3. This is essentially the same as solution 1, but presented inductively. The essence of the argument is the following lemma.\nLemma. Assume that we have \\(N\\) disjoint groups of at least \\(N+1\\) people in each, all people have distinct heights. Then one can choose two people from each group so that among the chosen people, the two tallest ones are in one group, the third and the fourth tallest ones are in one group, ..., and the two shortest ones are in one group.\nProof. Induction on \\(N \\geqslant 1\\); for \\(N=1\\), the statement is trivial.\nConsider now \\(N\\) groups \\(G_{1}, \\ldots, G_{N}\\) with at least \\(N+1\\) people in each for \\(N \\geqslant 2\\). Enumerate the people by \\(1,2, \\ldots, N(N+1)\\) according to their height, say, from tallest to shortest. Find the least \\(s\\) such that two people among \\(1,2, \\ldots, s\\) are in one group (without loss of generality, say this group is \\(G_{N}\\) ). By the minimality of \\(s\\), the two mentioned people in \\(G_{N}\\) are \\(s\\) and some \\(i<s\\).\n\nNow we choose people \\(i\\) and \\(s\\) in \\(G_{N}\\), forget about this group, and remove the people \\(1,2, \\ldots, s\\) from \\(G_{1}, \\ldots, G_{N-1}\\). Due to minimality of \\(s\\) again, each of the obtained groups \\(G_{1}^{\\prime}, \\ldots, G_{N-1}^{\\prime}\\) contains at least \\(N\\) people. By the induction hypothesis, one can choose a pair of people from each of \\(G_{1}^{\\prime}, \\ldots, G_{N-1}^{\\prime}\\) so as to satisfy the required conditions. Since all these people have numbers greater than \\(s\\), addition of the pair \\((s, i)\\) from \\(G_{N}\\) does not violate these requirements.\n\nTo solve the problem, it suffices now to split the row into \\(N\\) contiguous groups with \\(N+1\\) people in each and apply the Lemma to those groups.\n\nComment 1. One can identify each person with a pair of indices ( \\(p, h)(p, h \\in\\{1,2, \\ldots, N(N+1)\\}\\) ) so that the \\(p^{\\text {th }}\\) person in the row (say, from left to right) is the \\(h^{\\text {th }}\\) tallest person in the group. Say that ( \\(a, b\\) ) separates ( \\(x_{1}, y_{1}\\) ) and ( \\(x_{2}, y_{2}\\) ) whenever \\(a\\) is strictly between \\(x_{1}\\) and \\(y_{1}\\), or \\(b\\) is strictly between \\(x_{2}\\) and \\(y_{2}\\). So the coach wants to pick \\(2 N\\) people \\(\\left(p_{i}, h_{i}\\right)(i=1,2, \\ldots, 2 N)\\) such that no chosen person separates ( \\(p_{1}, h_{1}\\) ) from ( \\(p_{2}, h_{2}\\) ), no chosen person separates ( \\(p_{3}, h_{3}\\) ) and ( \\(p_{4}, h_{4}\\) ), and so on. This formulation reveals a duality between positions and heights. In that sense, solutions 1 and 2 are dual of each other.\n\nComment 2. The number \\(N(N+1)\\) is sharp for \\(N=2\\) and \\(N=3\\), due to arrangements \\(1,5,3,4,2\\) and \\(1,10,6,4,3,9,5,8,7,2,11\\).", "source_pdf": "imosl_2017.pdf", "notes": "fallback-regex"}
{"id": "IMO-2017-3", "contest": "IMO", "year": "2017", "problem_number": "C5", "problem": "A hunter and an invisible rabbit play a game in the Euclidean plane. The hunter's starting point \\(H_{0}\\) coincides with the rabbit's starting point \\(R_{0}\\). In the \\(n^{\\text {th }}\\) round of the game ( \\(n \\geqslant 1\\) ), the following happens.\n(1) First the invisible rabbit moves secretly and unobserved from its current point \\(R_{n-1}\\) to some new point \\(R_{n}\\) with \\(R_{n-1} R_{n}=1\\).\n(2) The hunter has a tracking device (e.g. dog) that returns an approximate position \\(R_{n}^{\\prime}\\) of the rabbit, so that \\(R_{n} R_{n}^{\\prime} \\leqslant 1\\).\n(3) The hunter then visibly moves from point \\(H_{n-1}\\) to a new point \\(H_{n}\\) with \\(H_{n-1} H_{n}=1\\).\n\nIs there a strategy for the hunter that guarantees that after \\(10^{9}\\) such rounds the distance between the hunter and the rabbit is below 100 ?\n(Austria)", "solution": "Answer: There is no such strategy for the hunter. The rabbit \"wins\".\n\n. If the answer were \"yes\", the hunter would have a strategy that would \"work\", no matter how the rabbit moved or where the radar pings \\(R_{n}^{\\prime}\\) appeared. We will show the opposite: with bad luck from the radar pings, there is no strategy for the hunter that guarantees that the distance stays below 100 in \\(10^{9}\\) rounds.\n\nSo, let \\(d_{n}\\) be the distance between the hunter and the rabbit after \\(n\\) rounds. Of course, if \\(d_{n} \\geqslant 100\\) for any \\(n<10^{9}\\), the rabbit has won - it just needs to move straight away from the hunter, and the distance will be kept at or above 100 thereon.\n\nWe will now show that, while \\(d_{n}<100\\), whatever given strategy the hunter follows, the rabbit has a way of increasing \\(d_{n}^{2}\\) by at least \\(\\frac{1}{2}\\) every 200 rounds (as long as the radar pings are lucky enough for the rabbit). This way, \\(d_{n}^{2}\\) will reach \\(10^{4}\\) in less than \\(2 \\cdot 10^{4} \\cdot 200=4 \\cdot 10^{6}<10^{9}\\) rounds, and the rabbit wins.\n\nSuppose the hunter is at \\(H_{n}\\) and the rabbit is at \\(R_{n}\\). Suppose even that the rabbit reveals its position at this moment to the hunter (this allows us to ignore all information from previous radar pings). Let \\(r\\) be the line \\(H_{n} R_{n}\\), and \\(Y_{1}\\) and \\(Y_{2}\\) be points which are 1 unit away from \\(r\\) and 200 units away from \\(R_{n}\\), as in the figure below.\n![](https://cdn.mathpix.com/cropped/2025_08_23_4b06fd0385d65a4d803fg-46.jpg?height=446&width=1140&top_left_y=1636&top_left_x=462)\n\nThe rabbit's plan is simply to choose one of the points \\(Y_{1}\\) or \\(Y_{2}\\) and hop 200 rounds straight towards it. Since all hops stay within 1 distance unit from \\(r\\), it is possible that all radar pings stay on \\(r\\). In particular, in this case, the hunter has no way of knowing whether the rabbit chose \\(Y_{1}\\) or \\(Y_{2}\\).\n\nLooking at such pings, what is the hunter going to do? If the hunter's strategy tells him to go 200 rounds straight to the right, he ends up at point \\(H^{\\prime}\\) in the figure. Note that the hunter does not have a better alternative! Indeed, after these 200 rounds he will always end up at a point to the left of \\(H^{\\prime}\\). If his strategy took him to a point above \\(r\\), he would end up even further from \\(Y_{2}\\); and if his strategy took him below \\(r\\), he would end up even further from \\(Y_{1}\\). In other words, no matter what strategy the hunter follows, he can never be sure his distance to the rabbit will be less than \\(y \\stackrel{\\text { def }}{=} H^{\\prime} Y_{1}=H^{\\prime} Y_{2}\\) after these 200 rounds.\n\nTo estimate \\(y^{2}\\), we take \\(Z\\) as the midpoint of segment \\(Y_{1} Y_{2}\\), we take \\(R^{\\prime}\\) as a point 200 units to the right of \\(R_{n}\\) and we define \\(\\varepsilon=Z R^{\\prime}\\) (note that \\(H^{\\prime} R^{\\prime}=d_{n}\\) ). Then\n\\[\ny^{2}=1+\\left(H^{\\prime} Z\\right)^{2}=1+\\left(d_{n}-\\varepsilon\\right)^{2}\n\\]\nwhere\n\\[\n\\varepsilon=200-R_{n} Z=200-\\sqrt{200^{2}-1}=\\frac{1}{200+\\sqrt{200^{2}-1}}>\\frac{1}{400} .\n\\]\n\nIn particular, \\(\\varepsilon^{2}+1=400 \\varepsilon\\), so\n\\[\ny^{2}=d_{n}^{2}-2 \\varepsilon d_{n}+\\varepsilon^{2}+1=d_{n}^{2}+\\varepsilon\\left(400-2 d_{n}\\right)\n\\]\n\nSince \\(\\varepsilon>\\frac{1}{400}\\) and we assumed \\(d_{n}<100\\), this shows that \\(y^{2}>d_{n}^{2}+\\frac{1}{2}\\). So, as we claimed, with this list of radar pings, no matter what the hunter does, the rabbit might achieve \\(d_{n+200}^{2}>d_{n}^{2}+\\frac{1}{2}\\). The wabbit wins.\n\nComment 1. Many different versions of the solution above can be found by replacing 200 with some other number \\(N\\) for the number of hops the rabbit takes between reveals. If this is done, we have:\n\\[\n\\varepsilon=N-\\sqrt{N^{2}-1}>\\frac{1}{N+\\sqrt{N^{2}-1}}>\\frac{1}{2 N}\n\\]\nand\n\\[\n\\varepsilon^{2}+1=2 N \\varepsilon\n\\]\nso, as long as \\(N>d_{n}\\), we would find\n\\[\ny^{2}=d_{n}^{2}+\\varepsilon\\left(2 N-2 d_{n}\\right)>d_{n}^{2}+\\frac{N-d_{n}}{N}\n\\]\n\nFor example, taking \\(N=101\\) is already enough-the squared distance increases by at least \\(\\frac{1}{101}\\) every 101 rounds, and \\(101^{2} \\cdot 10^{4}=1.0201 \\cdot 10^{8}<10^{9}\\) rounds are enough for the rabbit. If the statement is made sharper, some such versions might not work any longer.\n\nComment 2. The original statement asked whether the distance could be kept under \\(10^{10}\\) in \\(10^{100}\\) rounds.", "source_pdf": "imosl_2017.pdf", "notes": "fallback-regex"}
{"id": "IMO-2017-4", "contest": "IMO", "year": "2017", "problem_number": "G2", "problem": "Let \\(R\\) and \\(S\\) be distinct points on circle \\(\\Omega\\), and let \\(t\\) denote the tangent line to \\(\\Omega\\) at \\(R\\). Point \\(R^{\\prime}\\) is the reflection of \\(R\\) with respect to \\(S\\). A point \\(I\\) is chosen on the smaller arc \\(R S\\) of \\(\\Omega\\) so that the circumcircle \\(\\Gamma\\) of triangle \\(I S R^{\\prime}\\) intersects \\(t\\) at two different points. Denote by \\(A\\) the common point of \\(\\Gamma\\) and \\(t\\) that is closest to \\(R\\). Line \\(A I\\) meets \\(\\Omega\\) again at \\(J\\). Show that \\(J R^{\\prime}\\) is tangent to \\(\\Gamma\\).\n(Luxembourg)", "solution": "1. In the circles \\(\\Omega\\) and \\(\\Gamma\\) we have \\(\\angle J R S=\\angle J I S=\\angle A R^{\\prime} S\\). On the other hand, since \\(R A\\) is tangent to \\(\\Omega\\), we get \\(\\angle S J R=\\angle S R A\\). So the triangles \\(A R R^{\\prime}\\) and \\(S J R\\) are similar, and\n\\[\n\\frac{R^{\\prime} R}{R J}=\\frac{A R^{\\prime}}{S R}=\\frac{A R^{\\prime}}{S R^{\\prime}} .\n\\]\n\nThe last relation, together with \\(\\angle A R^{\\prime} S=\\angle J R R^{\\prime}\\), yields \\(\\triangle A S R^{\\prime} \\sim \\triangle R^{\\prime} J R\\), hence \\(\\angle S A R^{\\prime}=\\angle R R^{\\prime} J\\). It follows that \\(J R^{\\prime}\\) is tangent to \\(\\Gamma\\) at \\(R^{\\prime}\\).\n![](https://cdn.mathpix.com/cropped/2025_08_23_4b06fd0385d65a4d803fg-60.jpg?height=1089&width=1597&top_left_y=936&top_left_x=234)\n\nSolution 2. As in Solution 1, we notice that \\(\\angle J R S=\\angle J I S=\\angle A R^{\\prime} S\\), so we have \\(R J \\| A R^{\\prime}\\).\nLet \\(A^{\\prime}\\) be the reflection of \\(A\\) about \\(S\\); then \\(A R A^{\\prime} R^{\\prime}\\) is a parallelogram with center \\(S\\), and hence the point \\(J\\) lies on the line \\(R A^{\\prime}\\).\n\nFrom \\(\\angle S R^{\\prime} A^{\\prime}=\\angle S R A=\\angle S J R\\) we get that the points \\(S, J, A^{\\prime}, R^{\\prime}\\) are concyclic. This proves that \\(\\angle S R^{\\prime} J=\\angle S A^{\\prime} J=\\angle S A^{\\prime} R=\\angle S A R^{\\prime}\\), so \\(J R^{\\prime}\\) is tangent to \\(\\Gamma\\) at \\(R^{\\prime}\\).", "source_pdf": "imosl_2017.pdf", "notes": "fallback-regex"}
{"id": "IMO-2017-1", "contest": "IMO", "year": "2017", "problem_number": "N1", "problem": "The sequence \\(a_{0}, a_{1}, a_{2}, \\ldots\\) of positive integers satisfies\n\\[\na_{n+1}=\\left\\{\\begin{array}{ll}\n\\sqrt{a_{n}}, & \\text { if } \\sqrt{a_{n}} \\text { is an integer } \\\\\na_{n}+3, & \\text { otherwise }\n\\end{array} \\quad \\text { for every } n \\geqslant 0 .\\right.\n\\]\n\nDetermine all values of \\(a_{0}>1\\) for which there is at least one number \\(a\\) such that \\(a_{n}=a\\) for infinitely many values of \\(n\\).\n(South Africa)", "solution": "Answer: All positive multiples of 3.\n\n. Since the value of \\(a_{n+1}\\) only depends on the value of \\(a_{n}\\), if \\(a_{n}=a_{m}\\) for two different indices \\(n\\) and \\(m\\), then the sequence is eventually periodic. So we look for the values of \\(a_{0}\\) for which the sequence is eventually periodic.\nClaim 1. If \\(a_{n} \\equiv-1(\\bmod 3)\\), then, for all \\(m>n, a_{m}\\) is not a perfect square. It follows that the sequence is eventually strictly increasing, so it is not eventually periodic.\nProof. A square cannot be congruent to -1 modulo 3 , so \\(a_{n} \\equiv-1(\\bmod 3)\\) implies that \\(a_{n}\\) is not a square, therefore \\(a_{n+1}=a_{n}+3>a_{n}\\). As a consequence, \\(a_{n+1} \\equiv a_{n} \\equiv-1(\\bmod 3)\\), so \\(a_{n+1}\\) is not a square either. By repeating the argument, we prove that, from \\(a_{n}\\) on, all terms of the sequence are not perfect squares and are greater than their predecessors, which completes the proof.\n\nClaim 2. If \\(a_{n} \\not \\equiv-1(\\bmod 3)\\) and \\(a_{n}>9\\) then there is an index \\(m>n\\) such that \\(a_{m}<a_{n}\\).\nProof. Let \\(t^{2}\\) be the largest perfect square which is less than \\(a_{n}\\). Since \\(a_{n}>9, t\\) is at least 3. The first square in the sequence \\(a_{n}, a_{n}+3, a_{n}+6, \\ldots\\) will be \\((t+1)^{2},(t+2)^{2}\\) or \\((t+3)^{2}\\), therefore there is an index \\(m>n\\) such that \\(a_{m} \\leqslant t+3<t^{2}<a_{n}\\), as claimed.\n\nClaim 3. If \\(a_{n} \\equiv 0(\\bmod 3)\\), then there is an index \\(m>n\\) such that \\(a_{m}=3\\).\nProof. First we notice that, by the definition of the sequence, a multiple of 3 is always followed by another multiple of 3 . If \\(a_{n} \\in\\{3,6,9\\}\\) the sequence will eventually follow the periodic pattern \\(3,6,9,3,6,9, \\ldots\\). If \\(a_{n}>9\\), let \\(j\\) be an index such that \\(a_{j}\\) is equal to the minimum value of the set \\(\\left\\{a_{n+1}, a_{n+2}, \\ldots\\right\\}\\). We must have \\(a_{j} \\leqslant 9\\), otherwise we could apply Claim 2 to \\(a_{j}\\) and get a contradiction on the minimality hypothesis. It follows that \\(a_{j} \\in\\{3,6,9\\}\\), and the proof is complete.\n\nClaim 4. If \\(a_{n} \\equiv 1(\\bmod 3)\\), then there is an index \\(m>n\\) such that \\(a_{m} \\equiv-1(\\bmod 3)\\).\nProof. In the sequence, 4 is always followed by \\(2 \\equiv-1(\\bmod 3)\\), so the claim is true for \\(a_{n}=4\\). If \\(a_{n}=7\\), the next terms will be \\(10,13,16,4,2, \\ldots\\) and the claim is also true. For \\(a_{n} \\geqslant 10\\), we again take an index \\(j>n\\) such that \\(a_{j}\\) is equal to the minimum value of the set \\(\\left\\{a_{n+1}, a_{n+2}, \\ldots\\right\\}\\), which by the definition of the sequence consists of non-multiples of 3 . Suppose \\(a_{j} \\equiv 1(\\bmod 3)\\). Then we must have \\(a_{j} \\leqslant 9\\) by Claim 2 and the minimality of \\(a_{j}\\). It follows that \\(a_{j} \\in\\{4,7\\}\\), so \\(a_{m}=2<a_{j}\\) for some \\(m>j\\), contradicting the minimality of \\(a_{j}\\). Therefore, we must have \\(a_{j} \\equiv-1(\\bmod 3)\\).\n\nIt follows from the previous claims that if \\(a_{0}\\) is a multiple of 3 the sequence will eventually reach the periodic pattern \\(3,6,9,3,6,9, \\ldots\\); if \\(a_{0} \\equiv-1(\\bmod 3)\\) the sequence will be strictly increasing; and if \\(a_{0} \\equiv 1\\) (mod 3 ) the sequence will be eventually strictly increasing.\n\nSo the sequence will be eventually periodic if, and only if, \\(a_{0}\\) is a multiple of 3 .", "source_pdf": "imosl_2017.pdf", "notes": "fallback-regex"}
{"id": "IMO-2017-6", "contest": "IMO", "year": "2017", "problem_number": "N7", "problem": "Say that an ordered pair \\((x, y)\\) of integers is an irreducible lattice point if \\(x\\) and \\(y\\) are relatively prime. For any finite set \\(S\\) of irreducible lattice points, show that there is a homogenous polynomial in two variables, \\(f(x, y)\\), with integer coefficients, of degree at least 1 , such that \\(f(x, y)=1\\) for each ( \\(x, y\\) ) in the set \\(S\\).\n\nNote: A homogenous polynomial of degree \\(n\\) is any nonzero polynomial of the form\n\\[\nf(x, y)=a_{0} x^{n}+a_{1} x^{n-1} y+a_{2} x^{n-2} y^{2}+\\cdots+a_{n-1} x y^{n-1}+a_{n} y^{n} .\n\\]", "solution": "1. First of all, we note that finding a homogenous polynomial \\(f(x, y)\\) such that \\(f(x, y)= \\pm 1\\) is enough, because we then have \\(f^{2}(x, y)=1\\). Label the irreducible lattice points \\(\\left(x_{1}, y_{1}\\right)\\) through \\(\\left(x_{n}, y_{n}\\right)\\). If any two of these lattice points ( \\(x_{i}, y_{i}\\) ) and ( \\(x_{j}, y_{j}\\) ) lie on the same line through the origin, then \\(\\left(x_{j}, y_{j}\\right)=\\left(-x_{i},-y_{i}\\right)\\) because both of the points are irreducible. We then have \\(f\\left(x_{j}, y_{j}\\right)= \\pm f\\left(x_{i}, y_{i}\\right)\\) whenever \\(f\\) is homogenous, so we can assume that no two of the lattice points are collinear with the origin by ignoring the extra lattice points.\n\nConsider the homogenous polynomials \\(\\ell_{i}(x, y)=y_{i} x-x_{i} y\\) and define\n\\[\ng_{i}(x, y)=\\prod_{j \\neq i} \\ell_{j}(x, y)\n\\]\n\nThen \\(\\ell_{i}\\left(x_{j}, y_{j}\\right)=0\\) if and only if \\(j=i\\), because there is only one lattice point on each line through the origin. Thus, \\(g_{i}\\left(x_{j}, y_{j}\\right)=0\\) for all \\(j \\neq i\\). Define \\(a_{i}=g_{i}\\left(x_{i}, y_{i}\\right)\\), and note that \\(a_{i} \\neq 0\\).\n\nNote that \\(g_{i}(x, y)\\) is a degree \\(n-1\\) polynomial with the following two properties:\n1. \\(g_{i}\\left(x_{j}, y_{j}\\right)=0\\) if \\(j \\neq i\\).\n2. \\(g_{i}\\left(x_{i}, y_{i}\\right)=a_{i}\\).\n\nFor any \\(N \\geqslant n-1\\), there also exists a polynomial of degree \\(N\\) with the same two properties. Specifically, let \\(I_{i}(x, y)\\) be a degree 1 homogenous polynomial such that \\(I_{i}\\left(x_{i}, y_{i}\\right)=1\\), which exists since \\(\\left(x_{i}, y_{i}\\right)\\) is irreducible. Then \\(I_{i}(x, y)^{N-(n-1)} g_{i}(x, y)\\) satisfies both of the above properties and has degree \\(N\\).\n\nWe may now reduce the problem to the following claim:\nClaim: For each positive integer \\(a\\), there is a homogenous polynomial \\(f_{a}(x, y)\\), with integer coefficients, of degree at least 1 , such that \\(f_{a}(x, y) \\equiv 1(\\bmod a)\\) for all relatively prime \\((x, y)\\).\n\nTo see that this claim solves the problem, take \\(a\\) to be the least common multiple of the numbers \\(a_{i}(1 \\leqslant i \\leqslant n)\\). Take \\(f_{a}\\) given by the claim, choose some power \\(f_{a}(x, y)^{k}\\) that has degree at least \\(n-1\\), and subtract appropriate multiples of the \\(g_{i}\\) constructed above to obtain the desired polynomial.\n\nWe prove the claim by factoring \\(a\\). First, if \\(a\\) is a power of a prime ( \\(a=p^{k}\\) ), then we may choose either:\n- \\(f_{a}(x, y)=\\left(x^{p-1}+y^{p-1}\\right)^{\\phi(a)}\\) if \\(p\\) is odd;\n- \\(f_{a}(x, y)=\\left(x^{2}+x y+y^{2}\\right)^{\\phi(a)}\\) if \\(p=2\\).\n\nNow suppose \\(a\\) is any positive integer, and let \\(a=q_{1} q_{2} \\cdots q_{k}\\), where the \\(q_{i}\\) are prime powers, pairwise relatively prime. Let \\(f_{q_{i}}\\) be the polynomials just constructed, and let \\(F_{q_{i}}\\) be powers of these that all have the same degree. Note that\n\\[\n\\frac{a}{q_{i}} F_{q_{i}}(x, y) \\equiv \\frac{a}{q_{i}} \\quad(\\bmod a)\n\\]\nfor any relatively prime \\(x, y\\). By B\u00e9zout's lemma, there is an integer linear combination of the \\(\\frac{a}{q_{i}}\\) that equals 1 . Thus, there is a linear combination of the \\(F_{q_{i}}\\) such that \\(F_{q_{i}}(x, y) \\equiv 1 (\\bmod a)\\) for any relatively prime ( \\(x, y\\) ); and this polynomial is homogenous because all the \\(F_{q_{i}}\\) have the same degree.\n\nSolution 2. As in the previous solution, label the irreducible lattice points \\(\\left(x_{1}, y_{1}\\right), \\ldots,\\left(x_{n}, y_{n}\\right)\\) and assume without loss of generality that no two of the points are collinear with the origin. We induct on \\(n\\) to construct a homogenous polynomial \\(f(x, y)\\) such that \\(f\\left(x_{i}, y_{i}\\right)=1\\) for all \\(1 \\leqslant i \\leqslant n\\).\n\nIf \\(n=1\\) : Since \\(x_{1}\\) and \\(y_{1}\\) are relatively prime, there exist some integers \\(c, d\\) such that \\(c x_{1}+d y_{1}=1\\). Then \\(f(x, y)=c x+d y\\) is suitable.\n\nIf \\(n \\geqslant 2\\) : By the induction hypothesis we already have a homogeneous polynomial \\(g(x, y)\\) with \\(g\\left(x_{1}, y_{1}\\right)=\\ldots=g\\left(x_{n-1}, y_{n-1}\\right)=1\\). Let \\(j=\\operatorname{deg} g\\),\n\\[\ng_{n}(x, y)=\\prod_{k=1}^{n-1}\\left(y_{k} x-x_{k} y\\right)\n\\]\nand \\(a_{n}=g_{n}\\left(x_{n}, y_{n}\\right)\\). By assumption, \\(a_{n} \\neq 0\\). Take some integers \\(c, d\\) such that \\(c x_{n}+d y_{n}=1\\). We will construct \\(f(x, y)\\) in the form\n\\[\nf(x, y)=g(x, y)^{K}-C \\cdot g_{n}(x, y) \\cdot(c x+d y)^{L}\n\\]\nwhere \\(K\\) and \\(L\\) are some positive integers and \\(C\\) is some integer. We assume that \\(L=K j-n+1\\) so that \\(f\\) is homogenous.\n\nDue to \\(g\\left(x_{1}, y_{1}\\right)=\\ldots=g\\left(x_{n-1}, y_{n-1}\\right)=1\\) and \\(g_{n}\\left(x_{1}, y_{1}\\right)=\\ldots=g_{n}\\left(x_{n-1}, y_{n-1}\\right)=0\\), the property \\(f\\left(x_{1}, y_{1}\\right)=\\ldots=f\\left(x_{n-1}, y_{n-1}\\right)=1\\) is automatically satisfied with any choice of \\(K, L\\), and \\(C\\).\n\nFurthermore,\n\\[\nf\\left(x_{n}, y_{n}\\right)=g\\left(x_{n}, y_{n}\\right)^{K}-C \\cdot g_{n}\\left(x_{n}, y_{n}\\right) \\cdot\\left(c x_{n}+d y_{n}\\right)^{L}=g\\left(x_{n}, y_{n}\\right)^{K}-C a_{n} .\n\\]\n\nIf we have an exponent \\(K\\) such that \\(g\\left(x_{n}, y_{n}\\right)^{K} \\equiv 1\\left(\\bmod a_{n}\\right)\\), then we may choose \\(C\\) such that \\(f\\left(x_{n}, y_{n}\\right)=1\\). We now choose such a \\(K\\).\n\nConsider an arbitrary prime divisor \\(p\\) of \\(a_{n}\\). By\n\\[\np \\mid a_{n}=g_{n}\\left(x_{n}, y_{n}\\right)=\\prod_{k=1}^{n-1}\\left(y_{k} x_{n}-x_{k} y_{n}\\right)\n\\]\nthere is some \\(1 \\leqslant k<n\\) such that \\(x_{k} y_{n} \\equiv x_{n} y_{k}(\\bmod p)\\). We first show that \\(x_{k} x_{n}\\) or \\(y_{k} y_{n}\\) is relatively prime with \\(p\\). This is trivial in the case \\(x_{k} y_{n} \\equiv x_{n} y_{k} \\not \\equiv 0(\\bmod p)\\). In the other case, we have \\(x_{k} y_{n} \\equiv x_{n} y_{k} \\equiv 0(\\bmod p)\\), If, say \\(p \\mid x_{k}\\), then \\(p \\nmid y_{k}\\) because ( \\(x_{k}, y_{k}\\) ) is irreducible, so \\(p \\mid x_{n}\\); then \\(p \\nmid y_{n}\\) because ( \\(x_{k}, y_{k}\\) ) is irreducible. In summary, \\(p \\mid x_{k}\\) implies \\(p \\nmid y_{k} y_{n}\\). Similarly, \\(p \\mid y_{n}\\) implies \\(p \\nmid x_{k} x_{n}\\) \u3002\n\nBy the homogeneity of \\(g\\) we have the congruences\n\\[\nx_{k}^{d} \\cdot g\\left(x_{n}, y_{n}\\right)=g\\left(x_{k} x_{n}, x_{k} y_{n}\\right) \\equiv g\\left(x_{k} x_{n}, y_{k} x_{n}\\right)=x_{n}^{d} \\cdot g\\left(x_{k}, y_{k}\\right)=x_{n}^{d} \\quad(\\bmod p)\n\\]\nand\n\\[\ny_{k}^{d} \\cdot g\\left(x_{n}, y_{n}\\right)=g\\left(y_{k} x_{n}, y_{k} y_{n}\\right) \\equiv g\\left(x_{k} y_{n}, y_{k} y_{n}\\right)=y_{n}^{d} \\cdot g\\left(x_{k}, y_{k}\\right)=y_{n}^{d} \\quad(\\bmod p)\n\\]\n\nIf \\(p \\nmid x_{k} x_{n}\\), then take the \\((p-1)^{s t}\\) power of (1.1); otherwise take the \\((p-1)^{s t}\\) power of (1.2); by Fermat's theorem, in both cases we get\n\\[\ng\\left(x_{n}, y_{n}\\right)^{p-1} \\equiv 1 \\quad(\\bmod p)\n\\]\n\nIf \\(p^{\\alpha} \\mid m\\), then we have\n\\[\ng\\left(x_{n}, y_{n}\\right)^{p^{\\alpha-1}(p-1)} \\equiv 1 \\quad\\left(\\bmod p^{\\alpha}\\right)\n\\]\nwhich implies that the exponent \\(K=n \\cdot \\varphi\\left(a_{n}\\right)\\), which is a multiple of all \\(p^{\\alpha-1}(p-1)\\), is a suitable choice. (The factor \\(n\\) is added only so that \\(K \\geqslant n\\) and so \\(L>0\\).)\n\nComment. It is possible to show that there is no constant \\(C\\) for which, given any two irreducible lattice points, there is some homogenous polynomial \\(f\\) of degree at most \\(C\\) with integer coefficients that takes the value 1 on the two points. Indeed, if one of the points is \\((1,0)\\) and the other is \\((a, b)\\), the polynomial \\(f(x, y)=a_{0} x^{n}+a_{1} x^{n-1} y+\\cdots+a_{n} y^{n}\\) should satisfy \\(a_{0}=1\\), and so \\(a^{n} \\equiv 1(\\bmod b)\\). If \\(a=3\\) and \\(b=2^{k}\\) with \\(k \\geqslant 3\\), then \\(n \\geqslant 2^{k-2}\\). If we choose \\(2^{k-2}>C\\), this gives a contradiction.", "source_pdf": "imosl_2017.pdf", "notes": "fallback-regex"}
{"id": "IMO-2018-2", "contest": "IMO", "year": "2018", "problem_number": "A2", "problem": "Find all positive integers \\(n \\geqslant 3\\) for which there exist real numbers \\(a_{1}, a_{2}, \\ldots, a_{n}\\), \\(a_{n+1}=a_{1}, a_{n+2}=a_{2}\\) such that\n\\[\na_{i} a_{i+1}+1=a_{i+2}\n\\]\nfor all \\(i=1,2, \\ldots, n\\).\n(Slovakia)", "solution": "Answer: \\(n\\) can be any multiple of 3 .\n\n1. For the sake of convenience, extend the sequence \\(a_{1}, \\ldots, a_{n+2}\\) to an infinite periodic sequence with period \\(n\\). ( \\(n\\) is not necessarily the shortest period.)\n\nIf \\(n\\) is divisible by 3 , then \\(\\left(a_{1}, a_{2}, \\ldots\\right)=(-1,-1,2,-1,-1,2, \\ldots)\\) is an obvious solution.\nWe will show that in every periodic sequence satisfying the recurrence, each positive term is followed by two negative values, and after them the next number is positive again. From this, it follows that \\(n\\) is divisible by 3 .\n\nIf the sequence contains two consecutive positive numbers \\(a_{i}, a_{i+1}\\), then \\(a_{i+2}=a_{i} a_{i+1}+1>1\\), so the next value is positive as well; by induction, all numbers are positive and greater than 1. But then \\(a_{i+2}=a_{i} a_{i+1}+1 \\geqslant 1 \\cdot a_{i+1}+1>a_{i+1}\\) for every index \\(i\\), which is impossible: our sequence is periodic, so it cannot increase everywhere.\n\nIf the number 0 occurs in the sequence, \\(a_{i}=0\\) for some index \\(i\\), then it follows that \\(a_{i+1}=a_{i-1} a_{i}+1\\) and \\(a_{i+2}=a_{i} a_{i+1}+1\\) are two consecutive positive elements in the sequences and we get the same contradiction again.\n\nNotice that after any two consecutive negative numbers the next one must be positive: if \\(a_{i}<0\\) and \\(a_{i+1}<0\\), then \\(a_{i+2}=a_{1} a_{i+1}+1>1>0\\). Hence, the positive and negative numbers follow each other in such a way that each positive term is followed by one or two negative values and then comes the next positive term.\n\nConsider the case when the positive and negative values alternate. So, if \\(a_{i}\\) is a negative value then \\(a_{i+1}\\) is positive, \\(a_{i+2}\\) is negative and \\(a_{i+3}\\) is positive again.\n\nNotice that \\(a_{i} a_{i+1}+1=a_{i+2}<0<a_{i+3}=a_{i+1} a_{i+2}+1\\); by \\(a_{i+1}>0\\) we conclude \\(a_{i}<a_{i+2}\\). Hence, the negative values form an infinite increasing subsequence, \\(a_{i}<a_{i+2}<a_{i+4}<\\ldots\\), which is not possible, because the sequence is periodic.\n\nThe only case left is when there are consecutive negative numbers in the sequence. Suppose that \\(a_{i}\\) and \\(a_{i+1}\\) are negative; then \\(a_{i+2}=a_{i} a_{i+1}+1>1\\). The number \\(a_{i+3}\\) must be negative. We show that \\(a_{i+4}\\) also must be negative.\n\nNotice that \\(a_{i+3}\\) is negative and \\(a_{i+4}=a_{i+2} a_{i+3}+1<1<a_{i} a_{i+1}+1=a_{i+2}\\), so\n\\[\na_{i+5}-a_{i+4}=\\left(a_{i+3} a_{i+4}+1\\right)-\\left(a_{i+2} a_{i+3}+1\\right)=a_{i+3}\\left(a_{i+4}-a_{i+2}\\right)>0\n\\]\ntherefore \\(a_{i+5}>a_{i+4}\\). Since at most one of \\(a_{i+4}\\) and \\(a_{i+5}\\) can be positive, that means that \\(a_{i+4}\\) must be negative.\n\nNow \\(a_{i+3}\\) and \\(a_{i+4}\\) are negative and \\(a_{i+5}\\) is positive; so after two negative and a positive terms, the next three terms repeat the same pattern. That completes the solution.\n\nSolution 2. We prove that the shortest period of the sequence must be 3. Then it follows that \\(n\\) must be divisible by 3 .\n\nNotice that the equation \\(x^{2}+1=x\\) has no real root, so the numbers \\(a_{1}, \\ldots, a_{n}\\) cannot be all equal, hence the shortest period of the sequence cannot be 1 .\n\nBy applying the recurrence relation for \\(i\\) and \\(i+1\\),\n\\[\n\\begin{gathered}\n\\left(a_{i+2}-1\\right) a_{i+2}=a_{i} a_{i+1} a_{i+2}=a_{i}\\left(a_{i+3}-1\\right), \\quad \\text { so } \\\\\na_{i+2}^{2}-a_{i} a_{i+3}=a_{i+2}-a_{i} .\n\\end{gathered}\n\\]\n\nBy summing over \\(i=1,2, \\ldots, n\\), we get\n\\[\n\\sum_{i=1}^{n}\\left(a_{i}-a_{i+3}\\right)^{2}=0 .\n\\]\n\nThat proves that \\(a_{i}=a_{i+3}\\) for every index \\(i\\), so the sequence \\(a_{1}, a_{2}, \\ldots\\) is indeed periodic with period 3 . The shortest period cannot be 1 , so it must be 3 ; therefore, \\(n\\) is divisible by 3 .\n\nComment. By solving the system of equations \\(a b+1=c, \\quad b c+1=a, \\quad c a+1=b\\), it can be seen that the pattern ( \\(-1,-1,2\\) ) is repeated in all sequences satisfying the problem conditions.", "source_pdf": "imosl_2018.pdf", "notes": "fallback-regex"}
{"id": "IMO-2018-4", "contest": "IMO", "year": "2018", "problem_number": "C2", "problem": "Queenie and Horst play a game on a \\(20 \\times 20\\) chessboard. In the beginning the board is empty. In every turn, Horst places a black knight on an empty square in such a way that his new knight does not attack any previous knights. Then Queenie places a white queen on an empty square. The game gets finished when somebody cannot move.\n\nFind the maximal positive \\(K\\) such that, regardless of the strategy of Queenie, Horst can put at least \\(K\\) knights on the board.\n(Armenia)", "solution": "Answer: \\(K=20^{2} / 4=100\\). In case of a \\(4 N \\times 4 M\\) board, the answer is \\(K=4 N M\\).\n\n. We show two strategies, one for Horst to place at least 100 knights, and another strategy for Queenie that prevents Horst from putting more than 100 knights on the board.\n\nA strategy for Horst: Put knights only on black squares, until all black squares get occupied.\n\nColour the squares of the board black and white in the usual way, such that the white and black squares alternate, and let Horst put his knights on black squares as long as it is possible. Two knights on squares of the same colour never attack each other. The number of black squares is \\(20^{2} / 2=200\\). The two players occupy the squares in turn, so Horst will surely find empty black squares in his first 100 steps.\n\nA strategy for Queenie: Group the squares into cycles of length 4, and after each step of Horst, occupy the opposite square in the same cycle.\n\nConsider the squares of the board as vertices of a graph; let two squares be connected if two knights on those squares would attack each other. Notice that in a \\(4 \\times 4\\) board the squares can be grouped into 4 cycles of length 4 , as shown in Figure 1. Divide the board into parts of size \\(4 \\times 4\\), and perform the same grouping in every part; this way we arrange the 400 squares of the board into 100 cycles (Figure 2).\n\n\\begin{figure}\n\\includegraphics[width=\\textwidth]{https://cdn.mathpix.com/cropped/2025_08_23_9fba422e6efd92ed50fcg-27.jpg?height=352&width=355&top_left_y=1587&top_left_x=311}\n\\captionsetup{labelformat=empty}\n\\caption{Figure 1}\n\\end{figure}\n\n\\begin{figure}\n\\includegraphics[width=\\textwidth]{https://cdn.mathpix.com/cropped/2025_08_23_9fba422e6efd92ed50fcg-27.jpg?height=355&width=415&top_left_y=1584&top_left_x=776}\n\\captionsetup{labelformat=empty}\n\\caption{Figure 2}\n\\end{figure}\n\n\\begin{figure}\n\\includegraphics[width=\\textwidth]{https://cdn.mathpix.com/cropped/2025_08_23_9fba422e6efd92ed50fcg-27.jpg?height=347&width=455&top_left_y=1587&top_left_x=1302}\n\\captionsetup{labelformat=empty}\n\\caption{Figure 3}\n\\end{figure}\n\nThe strategy of Queenie can be as follows: Whenever Horst puts a new knight to a certain square \\(A\\), which is part of some cycle \\(A-B-C-D-A\\), let Queenie put her queen on the opposite square \\(C\\) in that cycle (Figure 3). From this point, Horst cannot put any knight on \\(A\\) or \\(C\\) because those squares are already occupied, neither on \\(B\\) or \\(D\\) because those squares are attacked by the knight standing on \\(A\\). Hence, Horst can put at most one knight on each cycle, that is at most 100 knights in total.\n\nComment 1. Queenie's strategy can be prescribed by a simple rule: divide the board into \\(4 \\times 4\\) parts; whenever Horst puts a knight in a part \\(P\\), Queenie reflects that square about the centre of \\(P\\) and puts her queen on the reflected square.\n\nComment 2. The result remains the same if Queenie moves first. In the first turn, she may put her first queen arbitrarily. Later, if she has to put her next queen on a square that already contains a queen, she may move arbitrarily again.", "source_pdf": "imosl_2018.pdf", "notes": "fallback-regex"}
{"id": "IMO-2018-3", "contest": "IMO", "year": "2018", "problem_number": "C4", "problem": "An anti-Pascal pyramid is a finite set of numbers, placed in a triangle-shaped array so that the first row of the array contains one number, the second row contains two numbers, the third row contains three numbers and so on; and, except for the numbers in the bottom row, each number equals the absolute value of the difference of the two numbers below it. For instance, the triangle below is an anti-Pascal pyramid with four rows, in which every integer from 1 to \\(1+2+3+4=10\\) occurs exactly once:\n\\[\n\n\\]\n\nIs it possible to form an anti-Pascal pyramid with 2018 rows, using every integer from 1 to \\(1+2+\\cdots+2018\\) exactly once?\n(Iran)", "solution": "Answer: No, it is not possible.\n\n. Let \\(T\\) be an anti-Pascal pyramid with \\(n\\) rows, containing every integer from 1 to \\(1+2+\\cdots+n\\), and let \\(a_{1}\\) be the topmost number in \\(T\\) (Figure 1). The two numbers below \\(a_{1}\\) are some \\(a_{2}\\) and \\(b_{2}=a_{1}+a_{2}\\), the two numbers below \\(b_{2}\\) are some \\(a_{3}\\) and \\(b_{3}=a_{1}+a_{2}+a_{3}\\), and so on and so forth all the way down to the bottom row, where some \\(a_{n}\\) and \\(b_{n}=a_{1}+a_{2}+\\cdots+a_{n}\\) are the two neighbours below \\(b_{n-1}=a_{1}+a_{2}+\\cdots+a_{n-1}\\). Since the \\(a_{k}\\) are \\(n\\) pairwise distinct positive integers whose sum does not exceed the largest number in \\(T\\), which is \\(1+2+\\cdots+n\\), it follows that they form a permutation of \\(1,2, \\ldots, n\\).\n\n\\begin{figure}\n\\includegraphics[width=\\textwidth]{https://cdn.mathpix.com/cropped/2025_08_23_9fba422e6efd92ed50fcg-29.jpg?height=392&width=449&top_left_y=1416&top_left_x=445}\n\\captionsetup{labelformat=empty}\n\\caption{Figure 1}\n\\end{figure}\n\n\\begin{figure}\n\\includegraphics[width=\\textwidth]{https://cdn.mathpix.com/cropped/2025_08_23_9fba422e6efd92ed50fcg-29.jpg?height=398&width=458&top_left_y=1410&top_left_x=1170}\n\\captionsetup{labelformat=empty}\n\\caption{Figure 2}\n\\end{figure}\n\nConsider now (Figure 2) the two 'equilateral' subtriangles of \\(T\\) whose bottom rows contain the numbers to the left, respectively right, of the pair \\(a_{n}, b_{n}\\). (One of these subtriangles may very well be empty.) At least one of these subtriangles, say \\(T^{\\prime}\\), has side length \\(\\ell \\geqslant\\lceil(n-2) / 2\\rceil\\). Since \\(T^{\\prime}\\) obeys the anti-Pascal rule, it contains \\(\\ell\\) pairwise distinct positive integers \\(a_{1}^{\\prime}, a_{2}^{\\prime}, \\ldots, a_{\\ell}^{\\prime}\\), where \\(a_{1}^{\\prime}\\) is at the apex, and \\(a_{k}^{\\prime}\\) and \\(b_{k}^{\\prime}=a_{1}^{\\prime}+a_{2}^{\\prime}+\\cdots+a_{k}^{\\prime}\\) are the two neighbours below \\(b_{k-1}^{\\prime}\\) for each \\(k=2,3 \\ldots, \\ell\\). Since the \\(a_{k}\\) all lie outside \\(T^{\\prime}\\), and they form a permutation of \\(1,2, \\ldots, n\\), the \\(a_{k}^{\\prime}\\) are all greater than \\(n\\). Consequently,\n\\[\n\\begin{array}{r}\nb_{\\ell}^{\\prime} \\geqslant(n+1)+(n+2)+\\cdots+(n+\\ell)=\\frac{\\ell(2 n+\\ell+1)}{2} \\\\\n\\geqslant \\frac{1}{2} \\cdot \\frac{n-2}{2}\\left(2 n+\\frac{n-2}{2}+1\\right)=\\frac{5 n(n-2)}{8},\n\\end{array}\n\\]\nwhich is greater than \\(1+2+\\cdots+n=n(n+1) / 2\\) for \\(n=2018\\). A contradiction.\nComment. The above estimate may be slightly improved by noticing that \\(b_{\\ell}^{\\prime} \\neq b_{n}\\). This implies \\(n(n+1) / 2=b_{n}>b_{\\ell}^{\\prime} \\geqslant\\lceil(n-2) / 2\\rceil(2 n+\\lceil(n-2) / 2\\rceil+1) / 2\\), so \\(n \\leqslant 7\\) if \\(n\\) is odd, and \\(n \\leqslant 12\\) if \\(n\\) is even. It seems that the largest anti-Pascal pyramid whose entries are a permutation of the integers from 1 to \\(1+2+\\cdots+n\\) has 5 rows.", "source_pdf": "imosl_2018.pdf", "notes": "fallback-regex"}
{"id": "IMO-2018-1", "contest": "IMO", "year": "2018", "problem_number": "G1", "problem": "Let \\(A B C\\) be an acute-angled triangle with circumcircle \\(\\Gamma\\). Let \\(D\\) and \\(E\\) be points on the segments \\(A B\\) and \\(A C\\), respectively, such that \\(A D=A E\\). The perpendicular bisectors of the segments \\(B D\\) and \\(C E\\) intersect the small arcs \\(\\widehat{A B}\\) and \\(\\widehat{A C}\\) at points \\(F\\) and \\(G\\) respectively. Prove that \\(D E \\| F G\\).\n(Greece)", "solution": "1. In the sequel, all the considered arcs are small arcs.\nLet \\(P\\) be the midpoint of the \\(\\operatorname{arc} \\widehat{B C}\\). Then \\(A P\\) is the bisector of \\(\\angle B A C\\), hence, in the isosceles triangle \\(A D E, A P \\perp D E\\). So, the statement of the problem is equivalent to \\(A P \\perp F G\\).\n\nIn order to prove this, let \\(K\\) be the second intersection of \\(\\Gamma\\) with \\(F D\\). Then the triangle \\(F B D\\) is isosceles, therefore\n\\[\n\\angle A K F=\\angle A B F=\\angle F D B=\\angle A D K,\n\\]\nyielding \\(A K=A D\\). In the same way, denoting by \\(L\\) the second intersection of \\(\\Gamma\\) with \\(G E\\), we get \\(A L=A E\\). This shows that \\(A K=A L\\).\n![](https://cdn.mathpix.com/cropped/2025_08_23_9fba422e6efd92ed50fcg-38.jpg?height=550&width=598&top_left_y=1087&top_left_x=736)\n\nNow \\(\\angle F B D=\\angle F D B\\) gives \\(\\widehat{A F}=\\widehat{B F}+\\widehat{A K}=\\widehat{B F}+\\widehat{A L}\\), hence \\(\\widehat{B F}=\\widehat{L F}\\). In a similar way, we get \\(\\widetilde{C G}=\\widetilde{G K}\\). This yields\n\\[\n\\angle(A P, F G)=\\frac{\\widehat{A F}+\\widehat{P G}}{2}=\\frac{\\widehat{A L}+\\overparen{L F}+\\overparen{P C}+\\overparen{C G}}{2}=\\frac{\\overparen{K L}+\\overparen{L B}+\\overparen{B C}+\\overparen{C K}}{4}=90^{\\circ} .\n\\]\n\nSolution 2. Let \\(Z=A B \\cap F G, T=A C \\cap F G\\). It suffices to prove that \\(\\angle A T Z=\\angle A Z T\\).\nLet \\(X\\) be the point for which \\(F X A D\\) is a parallelogram. Then\n\\[\n\\angle F X A=\\angle F D A=180^{\\circ}-\\angle F D B=180^{\\circ}-\\angle F B D,\n\\]\nwhere in the last equality we used that \\(F D=F B\\). It follows that the quadrilateral \\(B F X A\\) is cyclic, so \\(X\\) lies on \\(\\Gamma\\).\n![](https://cdn.mathpix.com/cropped/2025_08_23_9fba422e6efd92ed50fcg-38.jpg?height=547&width=509&top_left_y=2238&top_left_x=779)\n\nAnalogously, if \\(Y\\) is the point for which \\(G Y A E\\) is a parallelogram, then \\(Y\\) lies on \\(\\Gamma\\). So the quadrilateral \\(X F G Y\\) is cyclic and \\(F X=A D=A E=G Y\\), hence \\(X F G Y\\) is an isosceles trapezoid.\n\nNow, by \\(X F \\| A Z\\) and \\(Y G \\| A T\\), it follows that \\(\\angle A T Z=\\angle Y G F=\\angle X F G=\\angle A Z T\\).\nSolution 3. As in the first solution, we prove that \\(F G \\perp A P\\), where \\(P\\) is the midpoint of the small arc \\(\\widehat{B C}\\).\n\nLet \\(O\\) be the circumcentre of the triangle \\(A B C\\), and let \\(M\\) and \\(N\\) be the midpoints of the small arcs \\(\\widehat{A B}\\) and \\(\\widehat{A C}\\), respectively. Then \\(O M\\) and \\(O N\\) are the perpendicular bisectors of \\(A B\\) and \\(A C\\), respectively.\n![](https://cdn.mathpix.com/cropped/2025_08_23_9fba422e6efd92ed50fcg-39.jpg?height=538&width=598&top_left_y=733&top_left_x=736)\n\nThe distance \\(d\\) between \\(O M\\) and the perpendicular bisector of \\(B D\\) is \\(\\frac{1}{2} A B-\\frac{1}{2} B D=\\frac{1}{2} A D\\), hence it is equal to the distance between \\(O N\\) and the perpendicular bisector of \\(C E\\).\n\nThis shows that the isosceles trapezoid determined by the diameter \\(\\delta\\) of \\(\\Gamma\\) through \\(M\\) and the chord parallel to \\(\\delta\\) through \\(F\\) is congruent to the isosceles trapezoid determined by the diameter \\(\\delta^{\\prime}\\) of \\(\\Gamma\\) through \\(N\\) and the chord parallel to \\(\\delta^{\\prime}\\) through \\(G\\). Therefore \\(M F=N G\\), yielding \\(M N \\| F G\\).\n\nNow\n\\[\n\\angle(M N, A P)=\\frac{1}{2}(\\overparen{A M}+\\overparen{P C}+\\overparen{C N})=\\frac{1}{4}(\\overparen{A B}+\\overparen{B C}+\\overparen{C A})=90^{\\circ},\n\\]\nhence \\(M N \\perp A P\\), and the conclusion follows.", "source_pdf": "imosl_2018.pdf", "notes": "fallback-regex"}
{"id": "IMO-2018-6", "contest": "IMO", "year": "2018", "problem_number": "G6", "problem": "A convex quadrilateral \\(A B C D\\) satisfies \\(A B \\cdot C D=B C \\cdot D A\\). A point \\(X\\) is chosen inside the quadrilateral so that \\(\\angle X A B=\\angle X C D\\) and \\(\\angle X B C=\\angle X D A\\). Prove that \\(\\angle A X B+ \\angle C X D=180^{\\circ}\\).\n(Poland)", "solution": "1. Let \\(B^{\\prime}\\) be the reflection of \\(B\\) in the internal angle bisector of \\(\\angle A X C\\), so that \\(\\angle A X B^{\\prime}=\\angle C X B\\) and \\(\\angle C X B^{\\prime}=\\angle A X B\\). If \\(X, D\\), and \\(B^{\\prime}\\) are collinear, then we are done. Now assume the contrary.\n\nOn the ray \\(X B^{\\prime}\\) take a point \\(E\\) such that \\(X E \\cdot X B=X A \\cdot X C\\), so that \\(\\triangle A X E \\sim \\triangle B X C\\) and \\(\\triangle C X E \\sim \\triangle B X A\\). We have \\(\\angle X C E+\\angle X C D=\\angle X B A+\\angle X A B<180^{\\circ}\\) and \\(\\angle X A E+\\angle X A D=\\angle X D A+\\angle X A D<180^{\\circ}\\), which proves that \\(X\\) lies inside the angles \\(\\angle E C D\\) and \\(\\angle E A D\\) of the quadrilateral \\(E A D C\\). Moreover, \\(X\\) lies in the interior of exactly one of the two triangles \\(E A D, E C D\\) (and in the exterior of the other).\n![](https://cdn.mathpix.com/cropped/2025_08_23_9fba422e6efd92ed50fcg-50.jpg?height=478&width=581&top_left_y=899&top_left_x=742)\n\nThe similarities mentioned above imply \\(X A \\cdot B C=X B \\cdot A E\\) and \\(X B \\cdot C E=X C \\cdot A B\\). Multiplying these equalities with the given equality \\(A B \\cdot C D=B C \\cdot D A\\), we obtain \\(X A \\cdot C D\\). \\(C E=X C \\cdot A D \\cdot A E\\), or, equivalently,\n\\[\n\\frac{X A \\cdot D E}{A D \\cdot A E}=\\frac{X C \\cdot D E}{C D \\cdot C E} .\n\\]\n\nLemma. Let \\(P Q R\\) be a triangle, and let \\(X\\) be a point in the interior of the angle \\(Q P R\\) such that \\(\\angle Q P X=\\angle P R X\\). Then \\(\\frac{P X \\cdot Q R}{P Q \\cdot P R}<1\\) if and only if \\(X\\) lies in the interior of the triangle \\(P Q R\\). Proof. The locus of points \\(X\\) with \\(\\angle Q P X=\\angle P R X\\) lying inside the angle \\(Q P R\\) is an arc \\(\\alpha\\) of the circle \\(\\gamma\\) through \\(R\\) tangent to \\(P Q\\) at \\(P\\). Let \\(\\gamma\\) intersect the line \\(Q R\\) again at \\(Y\\) (if \\(\\gamma\\) is tangent to \\(Q R\\), then set \\(Y=R\\) ). The similarity \\(\\triangle Q P Y \\sim \\triangle Q R P\\) yields \\(P Y=\\frac{P Q \\cdot P R}{Q R}\\). Now it suffices to show that \\(P X<P Y\\) if and only if \\(X\\) lies in the interior of the triangle \\(P Q R\\). Let \\(m\\) be a line through \\(Y\\) parallel to \\(P Q\\). Notice that the points \\(Z\\) of \\(\\gamma\\) satisfying \\(P Z<P Y\\) are exactly those between the lines \\(m\\) and \\(P Q\\).\n\nCase 1: \\(Y\\) lies in the segment \\(Q R\\) (see the left figure below).\nIn this case \\(Y\\) splits \\(\\alpha\\) into two \\(\\operatorname{arcs} \\overparen{P Y}\\) and \\(\\overparen{Y R}\\). The arc \\(\\overparen{P Y}\\) lies inside the triangle \\(P Q R\\), and \\(\\widehat{P Y}\\) lies between \\(m\\) and \\(P Q\\), hence \\(P X<P Y\\) for points \\(X \\in \\widehat{P Y}\\). The other \\(\\operatorname{arc} \\widehat{Y R}\\) lies outside triangle \\(P Q R\\), and \\(\\overline{Y R}\\) is on the opposite side of \\(m\\) than \\(P\\), hence \\(P X>P Y\\) for \\(X \\in \\widehat{Y R}\\).\n\nCase 2: \\(Y\\) lies on the ray \\(Q R\\) beyond \\(R\\) (see the right figure below).\nIn this case the whole arc \\(\\alpha\\) lies inside triangle \\(P Q R\\), and between \\(m\\) and \\(P Q\\), thus \\(P X< P Y\\) for all \\(X \\in \\alpha\\).\n![](https://cdn.mathpix.com/cropped/2025_08_23_9fba422e6efd92ed50fcg-51.jpg?height=404&width=1112&top_left_y=405&top_left_x=479)\n\nApplying the Lemma (to \\(\\triangle E A D\\) with the point \\(X\\), and to \\(\\triangle E C D\\) with the point \\(X\\) ), we obtain that exactly one of two expressions \\(\\frac{X A \\cdot D E}{A D \\cdot A E}\\) and \\(\\frac{X C \\cdot D E}{C D \\cdot C E}\\) is less than 1 , which contradicts (*).\n\nComment 1. One may show that \\(A B \\cdot C D=X A \\cdot X C+X B \\cdot X D\\). We know that \\(D, X, E\\) are collinear and \\(\\angle D C E=\\angle C X D=180^{\\circ}-\\angle A X B\\). Therefore,\n\\[\nA B \\cdot C D=X B \\cdot \\frac{\\sin \\angle A X B}{\\sin \\angle B A X} \\cdot D E \\cdot \\frac{\\sin \\angle C E D}{\\sin \\angle D C E}=X B \\cdot D E .\n\\]\n\nFurthermore, \\(X B \\cdot D E=X B \\cdot(X D+X E)=X B \\cdot X D+X B \\cdot X E=X B \\cdot X D+X A \\cdot X C\\).\nComment 2. For a convex quadrilateral \\(A B C D\\) with \\(A B \\cdot C D=B C \\cdot D A\\), it is known that \\(\\angle D A C+\\angle A B D+\\angle B C A+\\angle C D B=180^{\\circ}\\) (among other, it was used as a problem on the Regional round of All-Russian olympiad in 2012), but it seems that there is no essential connection between this fact and the original problem.\n\nSolution 2. The solution consists of two parts. In Part 1 we show that it suffices to prove that\n\\[\n\\frac{X B}{X D}=\\frac{A B}{C D}\n\\]\nand\n\\[\n\\frac{X A}{X C}=\\frac{D A}{B C} .\n\\]\n\nIn Part 2 we establish these equalities.\nPart 1. Using the sine law and applying (1) we obtain\n\\[\n\\frac{\\sin \\angle A X B}{\\sin \\angle X A B}=\\frac{A B}{X B}=\\frac{C D}{X D}=\\frac{\\sin \\angle C X D}{\\sin \\angle X C D},\n\\]\nso \\(\\sin \\angle A X B=\\sin \\angle C X D\\) by the problem conditions. Similarly, (2) yields \\(\\sin \\angle D X A= \\sin \\angle B X C\\). If at least one of the pairs ( \\(\\angle A X B, \\angle C X D\\) ) and ( \\(\\angle B X C, \\angle D X A\\) ) consists of supplementary angles, then we are done. Otherwise, \\(\\angle A X B=\\angle C X D\\) and \\(\\angle D X A=\\angle B X C\\). In this case \\(X=A C \\cap B D\\), and the problem conditions yield that \\(A B C D\\) is a parallelogram and hence a rhombus. In this last case the claim also holds.\n\nPart 2. To prove the desired equality (1), invert \\(A B C D\\) at centre \\(X\\) with unit radius; the images of points are denoted by primes.\n\nWe have\n\\[\n\\angle A^{\\prime} B^{\\prime} C^{\\prime}=\\angle X B^{\\prime} A^{\\prime}+\\angle X B^{\\prime} C^{\\prime}=\\angle X A B+\\angle X C B=\\angle X C D+\\angle X C B=\\angle B C D .\n\\]\n\nSimilarly, the corresponding angles of quadrilaterals \\(A B C D\\) and \\(D^{\\prime} A^{\\prime} B^{\\prime} C^{\\prime}\\) are equal.\nMoreover, we have\n\\[\nA^{\\prime} B^{\\prime} \\cdot C^{\\prime} D^{\\prime}=\\frac{A B}{X A \\cdot X B} \\cdot \\frac{C D}{X C \\cdot X D}=\\frac{B C}{X B \\cdot X C} \\cdot \\frac{D A}{X D \\cdot D A}=B^{\\prime} C^{\\prime} \\cdot D^{\\prime} A^{\\prime} .\n\\]\n![](https://cdn.mathpix.com/cropped/2025_08_23_9fba422e6efd92ed50fcg-52.jpg?height=584&width=1092&top_left_y=462&top_left_x=488)\n\nNow we need the following Lemma.\nLemma. Assume that the corresponding angles of convex quadrilaterals \\(X Y Z T\\) and \\(X^{\\prime} Y^{\\prime} Z^{\\prime} T^{\\prime}\\) are equal, and that \\(X Y \\cdot Z T=Y Z \\cdot T X\\) and \\(X^{\\prime} Y^{\\prime} \\cdot Z^{\\prime} T^{\\prime}=Y^{\\prime} Z^{\\prime} \\cdot T^{\\prime} X^{\\prime}\\). Then the two quadrilaterals are similar.\nProof. Take the quadrilateral \\(X Y Z_{1} T_{1}\\) similar to \\(X^{\\prime} Y^{\\prime} Z^{\\prime} T^{\\prime}\\) and sharing the side \\(X Y\\) with \\(X Y Z T\\), such that \\(Z_{1}\\) and \\(T_{1}\\) lie on the rays \\(Y Z\\) and \\(X T\\), respectively, and \\(Z_{1} T_{1} \\| Z T\\). We need to prove that \\(Z_{1}=Z\\) and \\(T_{1}=T\\). Assume the contrary. Without loss of generality, \\(T X>X T_{1}\\). Let segments \\(X Z\\) and \\(Z_{1} T_{1}\\) intersect at \\(U\\). We have\n\\[\n\\frac{T_{1} X}{T_{1} Z_{1}}<\\frac{T_{1} X}{T_{1} U}=\\frac{T X}{Z T}=\\frac{X Y}{Y Z}<\\frac{X Y}{Y Z_{1}},\n\\]\nthus \\(T_{1} X \\cdot Y Z_{1}<T_{1} Z_{1} \\cdot X Y\\). A contradiction.\n![](https://cdn.mathpix.com/cropped/2025_08_23_9fba422e6efd92ed50fcg-52.jpg?height=335&width=432&top_left_y=1667&top_left_x=816)\n\nIt follows from the Lemma that the quadrilaterals \\(A B C D\\) and \\(D^{\\prime} A^{\\prime} B^{\\prime} C^{\\prime}\\) are similar, hence\n\\[\n\\frac{B C}{A B}=\\frac{A^{\\prime} B^{\\prime}}{D^{\\prime} A^{\\prime}}=\\frac{A B}{X A \\cdot X B} \\cdot \\frac{X D \\cdot X A}{D A}=\\frac{A B}{A D} \\cdot \\frac{X D}{X B},\n\\]\nand therefore\n\\[\n\\frac{X B}{X D}=\\frac{A B^{2}}{B C \\cdot A D}=\\frac{A B^{2}}{A B \\cdot C D}=\\frac{A B}{C D} .\n\\]\n\nWe obtain (1), as desired; (2) is proved similarly.\n\nComment. Part 1 is an easy one, while part 2 seems to be crucial. On the other hand, after the proof of the similarity \\(D^{\\prime} A^{\\prime} B^{\\prime} C^{\\prime} \\sim A B C D\\) one may finish the solution in different ways, e.g., as follows. The similarity taking \\(D^{\\prime} A^{\\prime} B^{\\prime} C^{\\prime}\\) to \\(A B C D\\) maps \\(X\\) to the point \\(X^{\\prime}\\) isogonally conjugate of \\(X\\) with respect to \\(A B C D\\) (i.e. to the point \\(X^{\\prime}\\) inside \\(A B C D\\) such that \\(\\angle B A X=\\angle D A X^{\\prime}\\), \\(\\angle C B X=\\angle A B X^{\\prime}, \\angle D C X=\\angle B C X^{\\prime}, \\angle A D X=\\angle C D X^{\\prime}\\) ). It is known that the required equality \\(\\angle A X B+\\angle C X D=180^{\\circ}\\) is one of known conditions on a point \\(X\\) inside \\(A B C D\\) equivalent to the existence of its isogonal conjugate.", "source_pdf": "imosl_2018.pdf", "notes": "fallback-regex"}
{"id": "IMO-2018-5", "contest": "IMO", "year": "2018", "problem_number": "N4", "problem": "Let \\(a_{1}, a_{2}, \\ldots, a_{n}, \\ldots\\) be a sequence of positive integers such that\n\\[\n\\frac{a_{1}}{a_{2}}+\\frac{a_{2}}{a_{3}}+\\cdots+\\frac{a_{n-1}}{a_{n}}+\\frac{a_{n}}{a_{1}}\n\\]\nis an integer for all \\(n \\geqslant k\\), where \\(k\\) is some positive integer. Prove that there exists a positive integer \\(m\\) such that \\(a_{n}=a_{n+1}\\) for all \\(n \\geqslant m\\).\n(Mongolia)", "solution": "1. The argument hinges on the following two facts: Let \\(a, b, c\\) be positive integers such that \\(N=b / c+(c-b) / a\\) is an integer.\n(1) If \\(\\operatorname{gcd}(a, c)=1\\), then \\(c\\) divides \\(b\\); and\n(2) If \\(\\operatorname{gcd}(a, b, c)=1\\), then \\(\\operatorname{gcd}(a, b)=1\\).\n\nTo prove (1), write \\(a b=c(a N+b-c)\\). Since \\(\\operatorname{gcd}(a, c)=1\\), it follows that \\(c\\) divides \\(b\\). To prove (2), write \\(c^{2}-b c=a(c N-b)\\) to infer that \\(a\\) divides \\(c^{2}-b c\\). Letting \\(d=\\operatorname{gcd}(a, b)\\), it follows that \\(d\\) divides \\(c^{2}\\), and since the two are relatively prime by hypothesis, \\(d=1\\).\n\nNow, let \\(s_{n}=a_{1} / a_{2}+a_{2} / a_{3}+\\cdots+a_{n-1} / a_{n}+a_{n} / a_{1}\\), let \\(\\delta_{n}=\\operatorname{gcd}\\left(a_{1}, a_{n}, a_{n+1}\\right)\\) and write\n\\[\ns_{n+1}-s_{n}=\\frac{a_{n}}{a_{n+1}}+\\frac{a_{n+1}-a_{n}}{a_{1}}=\\frac{a_{n} / \\delta_{n}}{a_{n+1} / \\delta_{n}}+\\frac{a_{n+1} / \\delta_{n}-a_{n} / \\delta_{n}}{a_{1} / \\delta_{n}} .\n\\]\n\nLet \\(n \\geqslant k\\). Since \\(\\operatorname{gcd}\\left(a_{1} / \\delta_{n}, a_{n} / \\delta_{n}, a_{n+1} / \\delta_{n}\\right)=1\\), it follows by (2) that \\(\\operatorname{gcd}\\left(a_{1} / \\delta_{n}, a_{n} / \\delta_{n}\\right)=1\\). Let \\(d_{n}=\\operatorname{gcd}\\left(a_{1}, a_{n}\\right)\\). Then \\(d_{n}=\\delta_{n} \\cdot \\operatorname{gcd}\\left(a_{1} / \\delta_{n}, a_{n} / \\delta_{n}\\right)=\\delta_{n}\\), so \\(d_{n}\\) divides \\(a_{n+1}\\), and therefore \\(d_{n}\\) divides \\(d_{n+1}\\).\n\nConsequently, from some rank on, the \\(d_{n}\\) form a nondecreasing sequence of integers not exceeding \\(a_{1}\\), so \\(d_{n}=d\\) for all \\(n \\geqslant \\ell\\), where \\(\\ell\\) is some positive integer.\n\nFinally, since \\(\\operatorname{gcd}\\left(a_{1} / d, a_{n+1} / d\\right)=1\\), it follows by (1) that \\(a_{n+1} / d\\) divides \\(a_{n} / d\\), so \\(a_{n} \\geqslant a_{n+1}\\) for all \\(n \\geqslant \\ell\\). The conclusion follows.\n\nSolution 2. We use the same notation \\(s_{n}\\). This time, we explore the exponents of primes in the prime factorizations of the \\(a_{n}\\) for \\(n \\geqslant k\\).\n\nTo start, for every \\(n \\geqslant k\\), we know that the number\n\\[\ns_{n+1}-s_{n}=\\frac{a_{n}}{a_{n+1}}+\\frac{a_{n+1}}{a_{1}}-\\frac{a_{n}}{a_{1}}\n\\]\nis integer. Multiplying it by \\(a_{1}\\) we obtain that \\(a_{1} a_{n} / a_{n+1}\\) is integer as well, so that \\(a_{n+1} \\mid a_{1} a_{n}\\). This means that \\(a_{n} \\mid a_{1}^{n-k} a_{k}\\), so all prime divisors of \\(a_{n}\\) are among those of \\(a_{1} a_{k}\\). There are finitely many such primes; therefore, it suffices to prove that the exponent of each of them in the prime factorization of \\(a_{n}\\) is eventually constant.\n\nChoose any prime \\(p \\mid a_{1} a_{k}\\). Recall that \\(v_{p}(q)\\) is the standard notation for the exponent of \\(p\\) in the prime factorization of a nonzero rational number \\(q\\). Say that an index \\(n \\geqslant k\\) is large if \\(v_{p}\\left(a_{n}\\right) \\geqslant v_{p}\\left(a_{1}\\right)\\). We separate two cases.\n\nCase 1: There exists a large index \\(n\\).\nIf \\(v_{p}\\left(a_{n+1}\\right)<v_{p}\\left(a_{1}\\right)\\), then \\(v_{p}\\left(a_{n} / a_{n+1}\\right)\\) and \\(v_{p}\\left(a_{n} / a_{1}\\right)\\) are nonnegative, while \\(v_{p}\\left(a_{n+1} / a_{1}\\right)<0\\); hence (*) cannot be an integer. This contradiction shows that index \\(n+1\\) is also large.\n\nOn the other hand, if \\(v_{p}\\left(a_{n+1}\\right)>v_{p}\\left(a_{n}\\right)\\), then \\(v_{p}\\left(a_{n} / a_{n+1}\\right)<0\\), while \\(v_{p}\\left(\\left(a_{n+1}-a_{n}\\right) / a_{1}\\right) \\geqslant 0\\), so (*) is not integer again. Thus, \\(v_{p}\\left(a_{1}\\right) \\leqslant v_{p}\\left(a_{n+1}\\right) \\leqslant v_{p}\\left(a_{n}\\right)\\).\n\nThe above arguments can now be applied successively to indices \\(n+1, n+2, \\ldots\\), showing that all the indices greater than \\(n\\) are large, and the sequence \\(v_{p}\\left(a_{n}\\right), v_{p}\\left(a_{n+1}\\right), v_{p}\\left(a_{n+2}\\right), \\ldots\\) is nonincreasing - hence eventually constant.\n\nCase 2: There is no large index.\nWe have \\(v_{p}\\left(a_{1}\\right)>v_{p}\\left(a_{n}\\right)\\) for all \\(n \\geqslant k\\). If we had \\(v_{p}\\left(a_{n+1}\\right)<v_{p}\\left(a_{n}\\right)\\) for some \\(n \\geqslant k\\), then \\(v_{p}\\left(a_{n+1} / a_{1}\\right)<v_{p}\\left(a_{n} / a_{1}\\right)<0<v_{p}\\left(a_{n} / a_{n+1}\\right)\\) which would also yield that \\((*)\\) is not integer. Therefore, in this case the sequence \\(v_{p}\\left(a_{k}\\right), v_{p}\\left(a_{k+1}\\right), v_{p}\\left(a_{k+2}\\right), \\ldots\\) is nondecreasing and bounded by \\(v_{p}\\left(a_{1}\\right)\\) from above; hence it is also eventually constant.\n\nComment. Given any positive odd integer \\(m\\), consider the \\(m\\)-tuple ( \\(2,2^{2}, \\ldots, 2^{m-1}, 2^{m}\\) ). Appending an infinite string of 1's to this \\(m\\)-tuple yields an eventually constant sequence of integers satisfying the condition in the statement, and shows that the rank from which the sequence stabilises may be arbitrarily large.\n\nThere are more sophisticated examples. The solution to part (b) of 10532, Amer. Math. Monthly, Vol. 105 No. 8 (Oct. 1998), 775-777 (available at https://www.jstor.org/stable/2589009), shows that, for every integer \\(m \\geqslant 5\\), there exists an \\(m\\)-tuple ( \\(a_{1}, a_{2}, \\ldots, a_{m}\\) ) of pairwise distinct positive integers such that \\(\\operatorname{gcd}\\left(a_{1}, a_{2}\\right)=\\operatorname{gcd}\\left(a_{2}, a_{3}\\right)=\\cdots=\\operatorname{gcd}\\left(a_{m-1}, a_{m}\\right)=\\operatorname{gcd}\\left(a_{m}, a_{1}\\right)=1\\), and the sum \\(a_{1} / a_{2}+a_{2} / a_{3}+\\cdots+a_{m-1} / a_{m}+a_{m} / a_{1}\\) is an integer. Letting \\(a_{m+k}=a_{1}, k=1,2, \\ldots\\), extends such an \\(m\\)-tuple to an eventually constant sequence of positive integers satisfying the condition in the statement of the problem at hand.\n\nHere is the example given by the proposers of 10532. Let \\(b_{1}=2\\), let \\(b_{k+1}=1+b_{1} \\cdots b_{k}= 1+b_{k}\\left(b_{k}-1\\right), k \\geqslant 1\\), and set \\(B_{m}=b_{1} \\cdots b_{m-4}=b_{m-3}-1\\). The \\(m\\)-tuple ( \\(a_{1}, a_{2}, \\ldots, a_{m}\\) ) defined below satisfies the required conditions:\n\\[\n\\begin{aligned}\na_{1}=1, & a_{2}=\\left(8 B_{m}+1\\right) B_{m}+8, \\quad a_{3}=8 B_{m}+1, \\quad a_{k}=b_{m-k} \\quad \\text { for } 4 \\leqslant k \\leqslant m-1, \\\\\n& a_{m}=\\frac{a_{2}}{2} \\cdot a_{3} \\cdot \\frac{B_{m}}{2}=\\left(\\frac{1}{2}\\left(8 B_{m}+1\\right) B_{m}+4\\right) \\cdot\\left(8 B_{m}+1\\right) \\cdot \\frac{B_{m}}{2} .\n\\end{aligned}\n\\]\n\nIt is readily checked that \\(a_{1}<a_{m-1}<a_{m-2}<\\cdots<a_{3}<a_{2}<a_{m}\\). For further details we refer to the solution mentioned above. Acquaintance with this example (or more elaborated examples derived from) offers no advantage in tackling the problem.", "source_pdf": "imosl_2018.pdf", "notes": "fallback-regex"}
{"id": "IMO-2019-1", "contest": "IMO", "year": "2019", "problem_number": "A1", "problem": "Let \\(\\mathbb{Z}\\) be the set of integers. Determine all functions \\(f: \\mathbb{Z} \\rightarrow \\mathbb{Z}\\) such that, for all integers \\(a\\) and \\(b\\),\n\\[\nf(2 a)+2 f(b)=f(f(a+b)) .\n\\]\n(South Africa)", "solution": "Answer: The solutions are \\(f(n)=0\\) and \\(f(n)=2 n+K\\) for any constant \\(K \\in \\mathbb{Z}\\).\nCommon remarks. Most solutions to this problem first prove that \\(f\\) must be linear, before determining all linear functions satisfying (1).\n\n1. Substituting \\(a=0, b=n+1\\) gives \\(f(f(n+1))=f(0)+2 f(n+1)\\). Substituting \\(a=1, b=n\\) gives \\(f(f(n+1))=f(2)+2 f(n)\\).\n\nIn particular, \\(f(0)+2 f(n+1)=f(2)+2 f(n)\\), and so \\(f(n+1)-f(n)=\\frac{1}{2}(f(2)-f(0))\\). Thus \\(f(n+1)-f(n)\\) must be constant. Since \\(f\\) is defined only on \\(\\mathbb{Z}\\), this tells us that \\(f\\) must be a linear function; write \\(f(n)=M n+K\\) for arbitrary constants \\(M\\) and \\(K\\), and we need only determine which choices of \\(M\\) and \\(K\\) work.\n\nNow, (1) becomes\n\\[\n2 M a+K+2(M b+K)=M(M(a+b)+K)+K\n\\]\nwhich we may rearrange to form\n\\[\n(M-2)(M(a+b)+K)=0\n\\]\n\nThus, either \\(M=2\\), or \\(M(a+b)+K=0\\) for all values of \\(a+b\\). In particular, the only possible solutions are \\(f(n)=0\\) and \\(f(n)=2 n+K\\) for any constant \\(K \\in \\mathbb{Z}\\), and these are easily seen to work.\n\nSolution 2. Let \\(K=f(0)\\).\nFirst, put \\(a=0\\) in (1); this gives\n\\[\nf(f(b))=2 f(b)+K\n\\]\nfor all \\(b \\in \\mathbb{Z}\\).\nNow put \\(b=0\\) in (1); this gives\n\\[\nf(2 a)+2 K=f(f(a))=2 f(a)+K,\n\\]\nwhere the second equality follows from (2). Consequently,\n\\[\nf(2 a)=2 f(a)-K\n\\]\nfor all \\(a \\in \\mathbb{Z}\\).\nSubstituting (2) and (3) into (1), we obtain\n\\[\n\\begin{aligned}\nf(2 a)+2 f(b) & =f(f(a+b)) \\\\\n2 f(a)-K+2 f(b) & =2 f(a+b)+K \\\\\nf(a)+f(b) & =f(a+b)+K .\n\\end{aligned}\n\\]\n\nThus, if we set \\(g(n)=f(n)-K\\) we see that \\(g\\) satisfies the Cauchy equation \\(g(a+b)= g(a)+g(b)\\). The solution to the Cauchy equation over \\(\\mathbb{Z}\\) is well-known; indeed, it may be proven by an easy induction that \\(g(n)=M n\\) for each \\(n \\in \\mathbb{Z}\\), where \\(M=g(1)\\) is a constant.\n\nTherefore, \\(f(n)=M n+K\\), and we may proceed as in Solution 1.\nComment 1. Instead of deriving (3) by substituting \\(b=0\\) into (1), we could instead have observed that the right hand side of (1) is symmetric in \\(a\\) and \\(b\\), and thus\n\\[\nf(2 a)+2 f(b)=f(2 b)+2 f(a) .\n\\]\n\nThus, \\(f(2 a)-2 f(a)=f(2 b)-2 f(b)\\) for any \\(a, b \\in \\mathbb{Z}\\), and in particular \\(f(2 a)-2 f(a)\\) is constant. Setting \\(a=0\\) shows that this constant is equal to \\(-K\\), and so we obtain (3).\n\nComment 2. Some solutions initially prove that \\(f(f(n))\\) is linear (sometimes via proving that \\(f(f(n))-3 K\\) satisfies the Cauchy equation). However, one can immediately prove that \\(f\\) is linear by substituting something of the form \\(f(f(n))=M^{\\prime} n+K^{\\prime}\\) into (2).", "source_pdf": "imosl_2019.pdf", "notes": "fallback-regex"}
{"id": "IMO-2019-5", "contest": "IMO", "year": "2019", "problem_number": "C3", "problem": "Let \\(n\\) be a positive integer. Harry has \\(n\\) coins lined up on his desk, each showing heads or tails. He repeatedly does the following operation: if there are \\(k\\) coins showing heads and \\(k>0\\), then he flips the \\(k^{\\text {th }}\\) coin over; otherwise he stops the process. (For example, the process starting with THT would be THT \\(\\rightarrow\\) HHT \\(\\rightarrow H T T \\rightarrow T T T\\), which takes three steps.)\n\nLetting \\(C\\) denote the initial configuration (a sequence of \\(n H\\) 's and \\(T\\) 's), write \\(\\ell(C)\\) for the number of steps needed before all coins show \\(T\\). Show that this number \\(\\ell(C)\\) is finite, and determine its average value over all \\(2^{n}\\) possible initial configurations \\(C\\).", "solution": "Answer: The average is \\(\\frac{1}{4} n(n+1)\\).\nCommon remarks. Throughout all these solutions, we let \\(E(n)\\) denote the desired average value.\n\n1. We represent the problem using a directed graph \\(G_{n}\\) whose vertices are the length- \\(n\\) strings of \\(H\\) 's and \\(T\\) 's. The graph features an edge from each string to its successor (except for \\(T T \\cdots T T\\), which has no successor). We will also write \\(\\bar{H}=T\\) and \\(\\bar{T}=H\\).\n\nThe graph \\(G_{0}\\) consists of a single vertex: the empty string. The main claim is that \\(G_{n}\\) can be described explicitly in terms of \\(G_{n-1}\\) :\n- We take two copies, \\(X\\) and \\(Y\\), of \\(G_{n-1}\\).\n- In \\(X\\), we take each string of \\(n-1\\) coins and just append a \\(T\\) to it. In symbols, we replace \\(s_{1} \\cdots s_{n-1}\\) with \\(s_{1} \\cdots s_{n-1} T\\).\n- In \\(Y\\), we take each string of \\(n-1\\) coins, flip every coin, reverse the order, and append an \\(H\\) to it. In symbols, we replace \\(s_{1} \\cdots s_{n-1}\\) with \\(\\bar{s}_{n-1} \\bar{s}_{n-2} \\cdots \\bar{s}_{1} H\\).\n- Finally, we add one new edge from \\(Y\\) to \\(X\\), namely \\(H H \\cdots H H H \\rightarrow H H \\cdots H H T\\).\n\nWe depict \\(G_{4}\\) below, in a way which indicates this recursive construction:\n![](https://cdn.mathpix.com/cropped/2025_08_23_54ae86499e5425f8b31eg-034.jpg?height=498&width=1109&top_left_y=1858&top_left_x=485)\n\nWe prove the claim inductively. Firstly, \\(X\\) is correct as a subgraph of \\(G_{n}\\), as the operation on coins is unchanged by an extra \\(T\\) at the end: if \\(s_{1} \\cdots s_{n-1}\\) is sent to \\(t_{1} \\cdots t_{n-1}\\), then \\(s_{1} \\cdots s_{n-1} T\\) is sent to \\(t_{1} \\cdots t_{n-1} T\\).\n\nNext, \\(Y\\) is also correct as a subgraph of \\(G_{n}\\), as if \\(s_{1} \\cdots s_{n-1}\\) has \\(k\\) occurrences of \\(H\\), then \\(\\bar{s}_{n-1} \\cdots \\bar{s}_{1} H\\) has \\((n-1-k)+1=n-k\\) occurrences of \\(H\\), and thus (provided that \\(k>0\\) ), if \\(s_{1} \\cdots s_{n-1}\\) is sent to \\(t_{1} \\cdots t_{n-1}\\), then \\(\\bar{s}_{n-1} \\cdots \\bar{s}_{1} H\\) is sent to \\(\\bar{t}_{n-1} \\cdots \\bar{t}_{1} H\\).\n\nFinally, the one edge from \\(Y\\) to \\(X\\) is correct, as the operation does send \\(H H \\cdots H H H\\) to HH \\(\\cdots\\) H HT.\n\nTo finish, note that the sequences in \\(X\\) take an average of \\(E(n-1)\\) steps to terminate, whereas the sequences in \\(Y\\) take an average of \\(E(n-1)\\) steps to reach \\(H H \\cdots H\\) and then an additional \\(n\\) steps to terminate. Therefore, we have\n\\[\nE(n)=\\frac{1}{2}(E(n-1)+(E(n-1)+n))=E(n-1)+\\frac{n}{2} .\n\\]\n\nWe have \\(E(0)=0\\) from our description of \\(G_{0}\\). Thus, by induction, we have \\(E(n)=\\frac{1}{2}(1+\\cdots+ n)=\\frac{1}{4} n(n+1)\\), which in particular is finite.\n\nSolution 2. We consider what happens with configurations depending on the coins they start and end with.\n- If a configuration starts with \\(H\\), the last \\(n-1\\) coins follow the given rules, as if they were all the coins, until they are all \\(T\\), then the first coin is turned over.\n- If a configuration ends with \\(T\\), the last coin will never be turned over, and the first \\(n-1\\) coins follow the given rules, as if they were all the coins.\n- If a configuration starts with \\(T\\) and ends with \\(H\\), the middle \\(n-2\\) coins follow the given rules, as if they were all the coins, until they are all \\(T\\). After that, there are \\(2 n-1\\) more steps: first coins \\(1,2, \\ldots, n-1\\) are turned over in that order, then coins \\(n, n-1, \\ldots, 1\\) are turned over in that order.\n\nAs this covers all configurations, and the number of steps is clearly finite for 0 or 1 coins, it follows by induction on \\(n\\) that the number of steps is always finite.\n\nWe define \\(E_{A B}(n)\\), where \\(A\\) and \\(B\\) are each one of \\(H, T\\) or *, to be the average number of steps over configurations of length \\(n\\) restricted to those that start with \\(A\\), if \\(A\\) is not *, and that end with \\(B\\), if \\(B\\) is not * (so * represents \"either \\(H\\) or \\(T\\) \"). The above observations tell us that, for \\(n \\geqslant 2\\) :\n- \\(E_{H *}(n)=E(n-1)+1\\).\n- \\(E_{* T}(n)=E(n-1)\\).\n- \\(E_{H T}(n)=E(n-2)+1\\) (by using both the observations for \\(H *\\) and for \\(* T\\) ).\n- \\(E_{T H}(n)=E(n-2)+2 n-1\\).\n\nNow \\(E_{H *}(n)=\\frac{1}{2}\\left(E_{H H}(n)+E_{H T}(n)\\right)\\), so \\(E_{H H}(n)=2 E(n-1)-E(n-2)+1\\). Similarly, \\(E_{T T}(n)=2 E(n-1)-E(n-2)-1\\). So\n\\[\nE(n)=\\frac{1}{4}\\left(E_{H T}(n)+E_{H H}(n)+E_{T T}(n)+E_{T H}(n)\\right)=E(n-1)+\\frac{n}{2} .\n\\]\n\nWe have \\(E(0)=0\\) and \\(E(1)=\\frac{1}{2}\\), so by induction on \\(n\\) we have \\(E(n)=\\frac{1}{4} n(n+1)\\).\nSolution 3. Let \\(H_{i}\\) be the number of heads in positions 1 to \\(i\\) inclusive (so \\(H_{n}\\) is the total number of heads), and let \\(I_{i}\\) be 1 if the \\(i^{\\text {th }}\\) coin is a head, 0 otherwise. Consider the function\n\\[\nt(i)=I_{i}+2\\left(\\min \\left\\{i, H_{n}\\right\\}-H_{i}\\right)\n\\]\n\nWe claim that \\(t(i)\\) is the total number of times coin \\(i\\) is turned over (which implies that the process terminates). Certainly \\(t(i)=0\\) when all coins are tails, and \\(t(i)\\) is always a nonnegative integer, so it suffices to show that when the \\(k^{\\text {th }}\\) coin is turned over (where \\(\\left.k=H_{n}\\right), t(k)\\) goes down by 1 and all the other \\(t(i)\\) are unchanged. We show this by splitting into cases:\n- If \\(i<k, I_{i}\\) and \\(H_{i}\\) are unchanged, and \\(\\min \\left\\{i, H_{n}\\right\\}=i\\) both before and after the coin flip, so \\(t(i)\\) is unchanged.\n- If \\(i>k, \\min \\left\\{i, H_{n}\\right\\}=H_{n}\\) both before and after the coin flip, and both \\(H_{n}\\) and \\(H_{i}\\) change by the same amount, so \\(t(i)\\) is unchanged.\n- If \\(i=k\\) and the coin is heads, \\(I_{i}\\) goes down by 1 , as do both \\(\\min \\left\\{i, H_{n}\\right\\}=H_{n}\\) and \\(H_{i}\\); so \\(t(i)\\) goes down by 1 .\n- If \\(i=k\\) and the coin is tails, \\(I_{i}\\) goes up by \\(1, \\min \\left\\{i, H_{n}\\right\\}=i\\) is unchanged and \\(H_{i}\\) goes up by 1 ; so \\(t(i)\\) goes down by 1 .\n\nWe now need to compute the average value of\n\\[\n\\sum_{i=1}^{n} t(i)=\\sum_{i=1}^{n} I_{i}+2 \\sum_{i=1}^{n} \\min \\left\\{i, H_{n}\\right\\}-2 \\sum_{i=1}^{n} H_{i} .\n\\]\n\nThe average value of the first term is \\(\\frac{1}{2} n\\), and that of the third term is \\(-\\frac{1}{2} n(n+1)\\). To compute the second term, we sum over choices for the total number of heads, and then over the possible values of \\(i\\), getting\n\\[\n2^{1-n} \\sum_{j=0}^{n}\\binom{n}{j} \\sum_{i=1}^{n} \\min \\{i, j\\}=2^{1-n} \\sum_{j=0}^{n}\\binom{n}{j}\\left(n j-\\binom{j}{2}\\right) .\n\\]\n\nNow, in terms of trinomial coefficients,\n\\[\n\\sum_{j=0}^{n} j\\binom{n}{j}=\\sum_{j=1}^{n}\\binom{n}{n-j, j-1,1}=n \\sum_{j=0}^{n-1}\\binom{n-1}{j}=2^{n-1} n\n\\]\nand\n\\[\n\\sum_{j=0}^{n}\\binom{j}{2}\\binom{n}{j}=\\sum_{j=2}^{n}\\binom{n}{n-j, j-2,2}=\\binom{n}{2} \\sum_{j=0}^{n-2}\\binom{n-2}{j}=2^{n-2}\\binom{n}{2}\n\\]\n\nSo the second term above is\n\\[\n2^{1-n}\\left(2^{n-1} n^{2}-2^{n-2}\\binom{n}{2}\\right)=n^{2}-\\frac{n(n-1)}{4}\n\\]\nand the required average is\n\\[\nE(n)=\\frac{1}{2} n+n^{2}-\\frac{n(n-1)}{4}-\\frac{1}{2} n(n+1)=\\frac{n(n+1)}{4} .\n\\]\n\nSolution 4. Harry has built a Turing machine to flip the coins for him. The machine is initially positioned at the \\(k^{\\text {th }}\\) coin, where there are \\(k\\) heads (and the position before the first coin is considered to be the \\(0^{\\text {th }}\\) coin). The machine then moves according to the following rules, stopping when it reaches the position before the first coin: if the coin at its current position is \\(H\\), it flips the coin and moves to the previous coin, while if the coin at its current position is \\(T\\), it flips the coin and moves to the next position.\n\nConsider the maximal sequences of consecutive moves in the same direction. Suppose the machine has \\(a\\) consecutive moves to the next coin, before a move to the previous coin. After those \\(a\\) moves, the \\(a\\) coins flipped in those moves are all heads, as is the coin the machine is now at, so at least the next \\(a+1\\) moves will all be moves to the previous coin. Similarly, \\(a\\) consecutive moves to the previous coin are followed by at least \\(a+1\\) consecutive moves to\nthe next coin. There cannot be more than \\(n\\) consecutive moves in the same direction, so this proves that the process terminates (with a move from the first coin to the position before the first coin).\n\nThus we have a (possibly empty) sequence \\(a_{1}<\\cdots<a_{t} \\leqslant n\\) giving the lengths of maximal sequences of consecutive moves in the same direction, where the final \\(a_{t}\\) moves must be moves to the previous coin, ending before the first coin. We claim there is a bijection between initial configurations of the coins and such sequences. This gives\n\\[\nE(n)=\\frac{1}{2}(1+2+\\cdots+n)=\\frac{n(n+1)}{4}\n\\]\nas required, since each \\(i\\) with \\(1 \\leqslant i \\leqslant n\\) will appear in half of the sequences, and will contribute \\(i\\) to the number of moves when it does.\n\nTo see the bijection, consider following the sequence of moves backwards, starting with the machine just before the first coin and all coins showing tails. This certainly determines a unique configuration of coins that could possibly correspond to the given sequence. Furthermore, every coin flipped as part of the \\(a_{j}\\) consecutive moves is also flipped as part of all subsequent sequences of \\(a_{k}\\) consecutive moves, for all \\(k>j\\), meaning that, as we follow the moves backwards, each coin is always in the correct state when flipped to result in a move in the required direction. (Alternatively, since there are \\(2^{n}\\) possible configurations of coins and \\(2^{n}\\) possible such ascending sequences, the fact that the sequence of moves determines at most one configuration of coins, and thus that there is an injection from configurations of coins to such ascending sequences, is sufficient for it to be a bijection, without needing to show that coins are in the right state as we move backwards.)\n\nSolution 5. We explicitly describe what happens with an arbitrary sequence \\(C\\) of \\(n\\) coins. Suppose that \\(C\\) contain \\(k\\) heads at positions \\(1 \\leqslant c_{1}<c_{2}<\\cdots<c_{k} \\leqslant n\\).\n\nLet \\(i\\) be the minimal index such that \\(c_{i} \\geqslant k\\). Then the first few steps will consist of turning over the \\(k^{\\text {th }},(k+1)^{\\text {th }}, \\ldots, c_{i}{ }^{\\text {th }},\\left(c_{i}-1\\right)^{\\text {th }},\\left(c_{i}-2\\right)^{\\text {th }}, \\ldots, k^{\\text {th }}\\) coins in this order. After that we get a configuration with \\(k-1\\) heads at the same positions as in the initial one, except for \\(c_{i}\\). This part of the process takes \\(2\\left(c_{i}-k\\right)+1\\) steps.\n\nAfter that, the process acts similarly; by induction on the number of heads we deduce that the process ends. Moreover, if the \\(c_{i}\\) disappear in order \\(c_{i_{1}}, \\ldots, c_{i_{k}}\\), the whole process takes\n\\[\n\\ell(C)=\\sum_{j=1}^{k}\\left(2\\left(c_{i_{j}}-(k+1-j)\\right)+1\\right)=2 \\sum_{j=1}^{k} c_{j}-2 \\sum_{j=1}^{k}(k+1-j)+k=2 \\sum_{j=1}^{k} c_{j}-k^{2}\n\\]\nsteps.\nNow let us find the total value \\(S_{k}\\) of \\(\\ell(C)\\) over all \\(\\binom{n}{k}\\) configurations with exactly \\(k\\) heads. To sum up the above expression over those, notice that each number \\(1 \\leqslant i \\leqslant n\\) appears as \\(c_{j}\\) exactly \\(\\binom{n-1}{k-1}\\) times. Thus\n\\[\n\\begin{array}{r}\nS_{k}=2\\binom{n-1}{k-1} \\sum_{i=1}^{n} i-\\binom{n}{k} k^{2}=2 \\frac{(n-1) \\cdots(n-k+1)}{(k-1)!} \\cdot \\frac{n(n+1)}{2}-\\frac{n \\cdots(n-k+1)}{k!} k^{2} \\\\\n=\\frac{n(n-1) \\cdots(n-k+1)}{(k-1)!}((n+1)-k)=n(n-1)\\binom{n-2}{k-1}+n\\binom{n-1}{k-1} .\n\\end{array}\n\\]\n\nTherefore, the total value of \\(\\ell(C)\\) over all configurations is\n\\[\n\\sum_{k=1}^{n} S_{k}=n(n-1) \\sum_{k=1}^{n}\\binom{n-2}{k-1}+n \\sum_{k=1}^{n}\\binom{n-1}{k-1}=n(n-1) 2^{n-2}+n 2^{n-1}=2^{n} \\frac{n(n+1)}{4} .\n\\]\n\nHence the required average is \\(E(n)=\\frac{n(n+1)}{4}\\).", "source_pdf": "imosl_2019.pdf", "notes": "fallback-regex"}
{"id": "IMO-2019-3", "contest": "IMO", "year": "2019", "problem_number": "C5", "problem": "On a certain social network, there are 2019 users, some pairs of which are friends, where friendship is a symmetric relation. Initially, there are 1010 people with 1009 friends each and 1009 people with 1010 friends each. However, the friendships are rather unstable, so events of the following kind may happen repeatedly, one at a time:\n\nLet \\(A, B\\), and \\(C\\) be people such that \\(A\\) is friends with both \\(B\\) and \\(C\\), but \\(B\\) and \\(C\\) are not friends; then \\(B\\) and \\(C\\) become friends, but \\(A\\) is no longer friends with them.\n\nProve that, regardless of the initial friendships, there exists a sequence of such events after which each user is friends with at most one other user.\n(Croatia)", "solution": "Common remarks. The problem has an obvious rephrasing in terms of graph theory. One is given a graph \\(G\\) with 2019 vertices, 1010 of which have degree 1009 and 1009 of which have degree 1010. One is allowed to perform operations on \\(G\\) of the following kind:\n\nSuppose that vertex \\(A\\) is adjacent to two distinct vertices \\(B\\) and \\(C\\) which are not adjacent to each other. Then one may remove the edges \\(A B\\) and \\(A C\\) from \\(G\\) and add the edge \\(B C\\) into \\(G\\).\n\nCall such an operation a refriending. One wants to prove that, via a sequence of such refriendings, one can reach a graph which is a disjoint union of single edges and vertices.\n\nAll of the solutions presented below will use this reformulation.\n\n1. Note that the given graph is connected, since the total degree of any two vertices is at least 2018 and hence they are either adjacent or have at least one neighbour in common. Hence the given graph satisfies the following condition:\n\n> Every connected component of \\(G\\) with at least three vertices is not complete and has a vertex of odd degree.\n\nWe will show that if a graph \\(G\\) satisfies condition (1) and has a vertex of degree at least 2, then there is a refriending on \\(G\\) that preserves condition (1). Since refriendings decrease the total number of edges of \\(G\\), by using a sequence of such refriendings, we must reach a graph \\(G\\) with maximal degree at most 1 , so we are done.\n![](https://cdn.mathpix.com/cropped/2025_08_23_54ae86499e5425f8b31eg-041.jpg?height=846&width=852&top_left_y=1901&top_left_x=608)\n\nPick a vertex \\(A\\) of degree at least 2 in a connected component \\(G^{\\prime}\\) of \\(G\\). Since no component of \\(G\\) with at least three vertices is complete we may assume that not all of the neighbours of \\(A\\) are adjacent to one another. (For example, pick a maximal complete subgraph \\(K\\) of \\(G^{\\prime}\\). Some vertex \\(A\\) of \\(K\\) has a neighbour outside \\(K\\), and this neighbour is not adjacent to every vertex of \\(K\\) by maximality.) Removing \\(A\\) from \\(G\\) splits \\(G^{\\prime}\\) into smaller connected components \\(G_{1}, \\ldots, G_{k}\\) (possibly with \\(k=1\\) ), to each of which \\(A\\) is connected by at least one edge. We divide into several cases.\n\nCase 1: \\(k \\geqslant 2\\) and \\(A\\) is connected to some \\(G_{i}\\) by at least two edges.\nChoose a vertex \\(B\\) of \\(G_{i}\\) adjacent to \\(A\\), and a vertex \\(C\\) in another component \\(G_{j}\\) adjacent to \\(A\\). The vertices \\(B\\) and \\(C\\) are not adjacent, and hence removing edges \\(A B\\) and \\(A C\\) and adding in edge \\(B C\\) does not disconnect \\(G^{\\prime}\\). It is easy to see that this preserves the condition, since the refriending does not change the parity of the degrees of vertices.\n\nCase 2: \\(k \\geqslant 2\\) and \\(A\\) is connected to each \\(G_{i}\\) by exactly one edge.\nConsider the induced subgraph on any \\(G_{i}\\) and the vertex \\(A\\). The vertex \\(A\\) has degree 1 in this subgraph; since the number of odd-degree vertices of a graph is always even, we see that \\(G_{i}\\) has a vertex of odd degree (in \\(G\\) ). Thus if we let \\(B\\) and \\(C\\) be any distinct neighbours of \\(A\\), then removing edges \\(A B\\) and \\(A C\\) and adding in edge \\(B C\\) preserves the above condition: the refriending creates two new components, and if either of these components has at least three vertices, then it cannot be complete and must contain a vertex of odd degree (since each \\(G_{i}\\) does).\n\nCase 3: \\(k=1\\) and \\(A\\) is connected to \\(G_{1}\\) by at least three edges.\nBy assumption, \\(A\\) has two neighbours \\(B\\) and \\(C\\) which are not adjacent to one another. Removing edges \\(A B\\) and \\(A C\\) and adding in edge \\(B C\\) does not disconnect \\(G^{\\prime}\\). We are then done as in Case 1.\n\nCase 4: \\(k=1\\) and \\(A\\) is connected to \\(G_{1}\\) by exactly two edges.\nLet \\(B\\) and \\(C\\) be the two neighbours of \\(A\\), which are not adjacent. Removing edges \\(A B\\) and \\(A C\\) and adding in edge \\(B C\\) results in two new components: one consisting of a single vertex; and the other containing a vertex of odd degree. We are done unless this second component would be a complete graph on at least 3 vertices. But in this case, \\(G_{1}\\) would be a complete graph minus the single edge \\(B C\\), and hence has at least 4 vertices since \\(G^{\\prime}\\) is not a 4-cycle. If we let \\(D\\) be a third vertex of \\(G_{1}\\), then removing edges \\(B A\\) and \\(B D\\) and adding in edge \\(A D\\) does not disconnect \\(G^{\\prime}\\). We are then done as in Case 1.\n![](https://cdn.mathpix.com/cropped/2025_08_23_54ae86499e5425f8b31eg-042.jpg?height=310&width=266&top_left_y=2215&top_left_x=902)\n\nComment. In fact, condition 1 above precisely characterises those graphs which can be reduced to a graph of maximal degree \\(\\leqslant 1\\) by a sequence of refriendings.\n\nSolution 2. As in the previous solution, note that a refriending preserves the property that a graph has a vertex of odd degree and (trivially) the property that it is not complete; note also that our initial graph is connected. We describe an algorithm to reduce our initial graph to a graph of maximal degree at most 1 , proceeding in two steps.\n\nStep 1: There exists a sequence of refriendings reducing the graph to a tree.\nProof. Since the number of edges decreases with each refriending, it suffices to prove the following: as long as the graph contains a cycle, there exists a refriending such that the resulting graph is still connected. We will show that the graph in fact contains a cycle \\(Z\\) and vertices \\(A, B, C\\) such that \\(A\\) and \\(B\\) are adjacent in the cycle \\(Z, C\\) is not in \\(Z\\), and is adjacent to \\(A\\) but not \\(B\\). Removing edges \\(A B\\) and \\(A C\\) and adding in edge \\(B C\\) keeps the graph connected, so we are done.\n![](https://cdn.mathpix.com/cropped/2025_08_23_54ae86499e5425f8b31eg-043.jpg?height=373&width=477&top_left_y=870&top_left_x=788)\n\nTo find this cycle \\(Z\\) and vertices \\(A, B, C\\), we pursue one of two strategies. If the graph contains a triangle, we consider a largest complete subgraph \\(K\\), which thus contains at least three vertices. Since the graph itself is not complete, there is a vertex \\(C\\) not in \\(K\\) connected to a vertex \\(A\\) of \\(K\\). By maximality of \\(K\\), there is a vertex \\(B\\) of \\(K\\) not connected to \\(C\\), and hence we are done by choosing a cycle \\(Z\\) in \\(K\\) through the edge \\(A B\\).\n![](https://cdn.mathpix.com/cropped/2025_08_23_54ae86499e5425f8b31eg-043.jpg?height=366&width=477&top_left_y=1593&top_left_x=788)\n\nIf the graph is triangle-free, we consider instead a smallest cycle \\(Z\\). This cycle cannot be Hamiltonian (i.e. it cannot pass through every vertex of the graph), since otherwise by minimality the graph would then have no other edges, and hence would have even degree at every vertex. We may thus choose a vertex \\(C\\) not in \\(Z\\) adjacent to a vertex \\(A\\) of \\(Z\\). Since the graph is triangle-free, it is not adjacent to any neighbour \\(B\\) of \\(A\\) in \\(Z\\), and we are done.\n\nStep 2: Any tree may be reduced to a disjoint union of single edges and vertices by a sequence of refriendings.\n\nProof. The refriending preserves the property of being acyclic. Hence, after applying a sequence of refriendings, we arrive at an acyclic graph in which it is impossible to perform any further refriendings. The maximal degree of any such graph is 1 : if it had a vertex \\(A\\) with two neighbours \\(B, C\\), then \\(B\\) and \\(C\\) would necessarily be nonadjacent since the graph is cycle-free, and so a refriending would be possible. Thus we reach a graph with maximal degree at most 1 as desired.", "source_pdf": "imosl_2019.pdf", "notes": "fallback-regex"}
{"id": "IMO-2019-2", "contest": "IMO", "year": "2019", "problem_number": "G3", "problem": "In triangle \\(A B C\\), let \\(A_{1}\\) and \\(B_{1}\\) be two points on sides \\(B C\\) and \\(A C\\), and let \\(P\\) and \\(Q\\) be two points on segments \\(A A_{1}\\) and \\(B B_{1}\\), respectively, so that line \\(P Q\\) is parallel to \\(A B\\). On ray \\(P B_{1}\\), beyond \\(B_{1}\\), let \\(P_{1}\\) be a point so that \\(\\angle P P_{1} C=\\angle B A C\\). Similarly, on ray \\(Q A_{1}\\), beyond \\(A_{1}\\), let \\(Q_{1}\\) be a point so that \\(\\angle C Q_{1} Q=\\angle C B A\\). Show that points \\(P, Q, P_{1}\\), and \\(Q_{1}\\) are concyclic.\n(Ukraine)", "solution": "1. Throughout the solution we use oriented angles.\nLet rays \\(A A_{1}\\) and \\(B B_{1}\\) intersect the circumcircle of \\(\\triangle A C B\\) at \\(A_{2}\\) and \\(B_{2}\\), respectively. By\n\\[\n\\angle Q P A_{2}=\\angle B A A_{2}=\\angle B B_{2} A_{2}=\\angle Q B_{2} A_{2},\n\\]\npoints \\(P, Q, A_{2}, B_{2}\\) are concyclic; denote the circle passing through these points by \\(\\omega\\). We shall prove that \\(P_{1}\\) and \\(Q_{1}\\) also lie on \\(\\omega\\).\n![](https://cdn.mathpix.com/cropped/2025_08_23_54ae86499e5425f8b31eg-060.jpg?height=592&width=843&top_left_y=925&top_left_x=611)\n\nBy\n\\[\n\\angle C A_{2} A_{1}=\\angle C A_{2} A=\\angle C B A=\\angle C Q_{1} Q=\\angle C Q_{1} A_{1},\n\\]\npoints \\(C, Q_{1}, A_{2}, A_{1}\\) are also concyclic. From that we get\n\\[\n\\angle Q Q_{1} A_{2}=\\angle A_{1} Q_{1} A_{2}=\\angle A_{1} C A_{2}=\\angle B C A_{2}=\\angle B A A_{2}=\\angle Q P A_{2},\n\\]\nso \\(Q_{1}\\) lies on \\(\\omega\\).\nIt follows similarly that \\(P_{1}\\) lies on \\(\\omega\\).\nSolution 2. First consider the case when lines \\(P P_{1}\\) and \\(Q Q_{1}\\) intersect each other at some point \\(R\\).\n\nLet line \\(P Q\\) meet the sides \\(A C\\) and \\(B C\\) at \\(E\\) and \\(F\\), respectively. Then\n\\[\n\\angle P P_{1} C=\\angle B A C=\\angle P E C,\n\\]\nso points \\(C, E, P, P_{1}\\) lie on a circle; denote that circle by \\(\\omega_{P}\\). It follows analogously that points \\(C, F, Q, Q_{1}\\) lie on another circle; denote it by \\(\\omega_{Q}\\).\n\nLet \\(A Q\\) and \\(B P\\) intersect at \\(T\\). Applying Pappus' theorem to the lines \\(A A_{1} P\\) and \\(B B_{1} Q\\) provides that points \\(C=A B_{1} \\cap B A_{1}, R=A_{1} Q \\cap B_{1} P\\) and \\(T=A Q \\cap B P\\) are collinear.\n\nLet line \\(R C T\\) meet \\(P Q\\) and \\(A B\\) at \\(S\\) and \\(U\\), respectively. From \\(A B \\| P Q\\) we obtain\n\\[\n\\frac{S P}{S Q}=\\frac{U B}{U A}=\\frac{S F}{S E},\n\\]\n\nSO\n\\[\nS P \\cdot S E=S Q \\cdot S F .\n\\]\n![](https://cdn.mathpix.com/cropped/2025_08_23_54ae86499e5425f8b31eg-061.jpg?height=780&width=1066&top_left_y=217&top_left_x=502)\n\nSo, point \\(S\\) has equal powers with respect to \\(\\omega_{P}\\) and \\(\\omega_{Q}\\), hence line \\(R C S\\) is their radical axis; then \\(R\\) also has equal powers to the circles, so \\(R P \\cdot R P_{1}=R Q \\cdot R Q_{1}\\), proving that points \\(P, P_{1}, Q, Q_{1}\\) are indeed concyclic.\n\nNow consider the case when \\(P P_{1}\\) and \\(Q Q_{1}\\) are parallel. Like in the previous case, let \\(A Q\\) and \\(B P\\) intersect at \\(T\\). Applying Pappus' theorem again to the lines \\(A A_{1} P\\) and \\(B B_{1} Q\\), in this limit case it shows that line \\(C T\\) is parallel to \\(P P_{1}\\) and \\(Q Q_{1}\\).\n\nLet line \\(C T\\) meet \\(P Q\\) and \\(A B\\) at \\(S\\) and \\(U\\), as before. The same calculation as in the previous case shows that \\(S P \\cdot S E=S Q \\cdot S F\\), so \\(S\\) lies on the radical axis between \\(\\omega_{P}\\) and \\(\\omega_{Q}\\).\n![](https://cdn.mathpix.com/cropped/2025_08_23_54ae86499e5425f8b31eg-061.jpg?height=787&width=1040&top_left_y=1424&top_left_x=511)\n\nLine \\(C S T\\), that is the radical axis between \\(\\omega_{P}\\) and \\(\\omega_{Q}\\), is perpendicular to the line \\(\\ell\\) of centres of \\(\\omega_{P}\\) and \\(\\omega_{Q}\\). Hence, the chords \\(P P_{1}\\) and \\(Q Q_{1}\\) are perpendicular to \\(\\ell\\). So the quadrilateral \\(P P_{1} Q_{1} Q\\) is an isosceles trapezium with symmetry axis \\(\\ell\\), and hence is cyclic.\n\nComment. There are several ways of solving the problem involving Pappus' theorem. For example, one may consider the points \\(K=P B_{1} \\cap B C\\) and \\(L=Q A_{1} \\cap A C\\). Applying Pappus' theorem to the lines \\(A A_{1} P\\) and \\(Q B_{1} B\\) we get that \\(K, L\\), and \\(P Q \\cap A B\\) are collinear, i.e. that \\(K L \\| A B\\). Therefore, cyclicity of \\(P, Q, P_{1}\\), and \\(Q_{1}\\) is equivalent to that of \\(K, L, P_{1}\\), and \\(Q_{1}\\). The latter is easy after noticing that \\(C\\) also lies on that circle. Indeed, e.g. \\(\\angle(L K, L C)=\\angle(A B, A C)=\\angle\\left(P_{1} K, P_{1} C\\right)\\) shows that \\(K\\) lies on circle \\(K L C\\).\n\nThis approach also has some possible degeneracy, as the points \\(K\\) and \\(L\\) may happen to be ideal.", "source_pdf": "imosl_2019.pdf", "notes": "fallback-regex"}
{"id": "IMO-2019-6", "contest": "IMO", "year": "2019", "problem_number": "G7", "problem": "The incircle \\(\\omega\\) of acute-angled scalene triangle \\(A B C\\) has centre \\(I\\) and meets sides \\(B C\\), \\(C A\\), and \\(A B\\) at \\(D, E\\), and \\(F\\), respectively. The line through \\(D\\) perpendicular to \\(E F\\) meets \\(\\omega\\) again at \\(R\\). Line \\(A R\\) meets \\(\\omega\\) again at \\(P\\). The circumcircles of triangles \\(P C E\\) and \\(P B F\\) meet again at \\(Q \\neq P\\). Prove that lines \\(D I\\) and \\(P Q\\) meet on the external bisector of angle \\(B A C\\).\n(India)", "solution": "Common remarks. Throughout the\n\n, \\(\\angle(a, b)\\) denotes the directed angle between lines \\(a\\) and \\(b\\), measured modulo \\(\\pi\\).\n\n\\section*{Solution 1.}\n\nStep 1. The external bisector of \\(\\angle B A C\\) is the line through \\(A\\) perpendicular to \\(I A\\). Let \\(D I\\) meet this line at \\(L\\) and let \\(D I\\) meet \\(\\omega\\) at \\(K\\). Let \\(N\\) be the midpoint of \\(E F\\), which lies on \\(I A\\) and is the pole of line \\(A L\\) with respect to \\(\\omega\\). Since \\(A N \\cdot A I=A E^{2}=A R \\cdot A P\\), the points \\(R\\), \\(N, I\\), and \\(P\\) are concyclic. As \\(I R=I P\\), the line \\(N I\\) is the external bisector of \\(\\angle P N R\\), so \\(P N\\) meets \\(\\omega\\) again at the point symmetric to \\(R\\) with respect to \\(A N\\) - i.e. at \\(K\\).\n\nLet \\(D N\\) cross \\(\\omega\\) again at \\(S\\). Opposite sides of any quadrilateral inscribed in the circle \\(\\omega\\) meet on the polar line of the intersection of the diagonals with respect to \\(\\omega\\). Since \\(L\\) lies on the polar line \\(A L\\) of \\(N\\) with respect to \\(\\omega\\), the line \\(P S\\) must pass through \\(L\\). Thus it suffices to prove that the points \\(S, Q\\), and \\(P\\) are collinear.\n![](https://cdn.mathpix.com/cropped/2025_08_23_54ae86499e5425f8b31eg-074.jpg?height=872&width=1355&top_left_y=1179&top_left_x=356)\n\nStep 2. Let \\(\\Gamma\\) be the circumcircle of \\(\\triangle B I C\\). Notice that\n\\[\n\\begin{aligned}\n\\angle(B Q, Q C)=\\angle & (B Q, Q P)+\\angle(P Q, Q C)=\\angle(B F, F P)+\\angle(P E, E C) \\\\\n& =\\angle(E F, E P)+\\angle(F P, F E)=\\angle(F P, E P)=\\angle(D F, D E)=\\angle(B I, I C)\n\\end{aligned}\n\\]\nso \\(Q\\) lies on \\(\\Gamma\\). Let \\(Q P\\) meet \\(\\Gamma\\) again at \\(T\\). It will now suffice to prove that \\(S, P\\), and \\(T\\) are collinear. Notice that \\(\\angle(B I, I T)=\\angle(B Q, Q T)=\\angle(B F, F P)=\\angle(F K, K P)\\). Note \\(F D \\perp F K\\) and \\(F D \\perp B I\\) so \\(F K \\| B I\\) and hence \\(I T\\) is parallel to the line \\(K N P\\). Since \\(D I=I K\\), the line \\(I T\\) crosses \\(D N\\) at its midpoint \\(M\\).\nStep 3. Let \\(F^{\\prime}\\) and \\(E^{\\prime}\\) be the midpoints of \\(D E\\) and \\(D F\\), respectively. Since \\(D E^{\\prime} \\cdot E^{\\prime} F=D E^{\\prime 2}= B E^{\\prime} \\cdot E^{\\prime} I\\), the point \\(E^{\\prime}\\) lies on the radical axis of \\(\\omega\\) and \\(\\Gamma\\); the same holds for \\(F^{\\prime}\\). Therefore, this radical axis is \\(E^{\\prime} F^{\\prime}\\), and it passes through \\(M\\). Thus \\(I M \\cdot M T=D M \\cdot M S\\), so \\(S, I, D\\), and \\(T\\) are concyclic. This shows \\(\\angle(D S, S T)=\\angle(D I, I T)=\\angle(D K, K P)=\\angle(D S, S P)\\), whence the points \\(S, P\\), and \\(T\\) are collinear, as desired.\n![](https://cdn.mathpix.com/cropped/2025_08_23_54ae86499e5425f8b31eg-075.jpg?height=1080&width=986&top_left_y=205&top_left_x=536)\n\nComment. Here is a longer alternative proof in step 1 that \\(P, S\\), and \\(L\\) are collinear, using a circular inversion instead of the fact that opposite sides of a quadrilateral inscribed in a circle \\(\\omega\\) meet on the polar line with respect to \\(\\omega\\) of the intersection of the diagonals. Let \\(G\\) be the foot of the altitude from \\(N\\) to the line \\(D I K L\\). Observe that \\(N, G, K, S\\) are concyclic (opposite right angles) so\n\\[\n\\angle D I P=2 \\angle D K P=\\angle G K N+\\angle D S P=\\angle G S N+\\angle N S P=\\angle G S P,\n\\]\nhence \\(I, G, S, P\\) are concyclic. We have \\(I G \\cdot I L=I N \\cdot I A=r^{2}\\) since \\(\\triangle I G N \\sim \\triangle I A L\\). Inverting the circle \\(I G S P\\) in circle \\(\\omega\\), points \\(P\\) and \\(S\\) are fixed and \\(G\\) is taken to \\(L\\) so we find that \\(P, S\\), and \\(L\\) are collinear.\n\nSolution 2. We start as in Solution 1. Namely, we introduce the same points \\(K, L, N\\), and \\(S\\), and show that the triples ( \\(P, N, K\\) ) and ( \\(P, S, L\\) ) are collinear. We conclude that \\(K\\) and \\(R\\) are symmetric in \\(A I\\), and reduce the problem statement to showing that \\(P, Q\\), and \\(S\\) are collinear.\n\nStep 1. Let \\(A R\\) meet the circumcircle \\(\\Omega\\) of \\(A B C\\) again at \\(X\\). The lines \\(A R\\) and \\(A K\\) are isogonal in the angle \\(B A C\\); it is well known that in this case \\(X\\) is the tangency point of \\(\\Omega\\) with the \\(A\\)-mixtilinear circle. It is also well known that for this point \\(X\\), the line \\(X I\\) crosses \\(\\Omega\\) again at the midpoint \\(M^{\\prime}\\) of \\(\\operatorname{arc} B A C\\).\n\nStep 2. Denote the circles \\(B F P\\) and \\(C E P\\) by \\(\\Omega_{B}\\) and \\(\\Omega_{C}\\), respectively. Let \\(\\Omega_{B}\\) cross \\(A R\\) and \\(E F\\) again at \\(U\\) and \\(Y\\), respectively. We have\n\\[\n\\angle(U B, B F)=\\angle(U P, P F)=\\angle(R P, P F)=\\angle(R F, F A),\n\\]\nso \\(U B \\| R F\\).\n![](https://cdn.mathpix.com/cropped/2025_08_23_54ae86499e5425f8b31eg-076.jpg?height=995&width=1477&top_left_y=896&top_left_x=254)\n\nNext, we show that the points \\(B, I, U\\), and \\(X\\) are concyclic. Since\n\\[\n\\angle(U B, U X)=\\angle(R F, R X)=\\angle(A F, A R)+\\angle(F R, F A)=\\angle\\left(M^{\\prime} B, M^{\\prime} X\\right)+\\angle(D R, D F),\n\\]\nit suffices to prove \\(\\angle(I B, I X)=\\angle\\left(M^{\\prime} B, M^{\\prime} X\\right)+\\angle(D R, D F)\\), or \\(\\angle\\left(I B, M^{\\prime} B\\right)=\\angle(D R, D F)\\). But both angles equal \\(\\angle(C I, C B)\\), as desired. (This is where we used the fact that \\(M^{\\prime}\\) is the midpoint of arc \\(B A C\\) of \\(\\Omega\\).)\n\nIt follows now from circles BUIX and BPUFY that\n\\[\n\\begin{aligned}\n\\angle(I U, U B)=\\angle(I X, B X)=\\angle\\left(M^{\\prime} X, B X\\right)= & \\frac{\\pi-\\angle A}{2} \\\\\n& =\\angle(E F, A F)=\\angle(Y F, B F)=\\angle(Y U, B U),\n\\end{aligned}\n\\]\nso the points \\(Y, U\\), and \\(I\\) are collinear.\nLet \\(E F\\) meet \\(B C\\) at \\(W\\). We have\n\\[\n\\angle(I Y, Y W)=\\angle(U Y, F Y)=\\angle(U B, F B)=\\angle(R F, A F)=\\angle(C I, C W),\n\\]\nso the points \\(W, Y, I\\), and \\(C\\) are concyclic.\n\nSimilarly, if \\(V\\) and \\(Z\\) are the second meeting points of \\(\\Omega_{C}\\) with \\(A R\\) and \\(E F\\), we get that the 4-tuples ( \\(C, V, I, X\\) ) and ( \\(B, I, Z, W\\) ) are both concyclic.\n\nStep 3. Let \\(Q^{\\prime}=C Y \\cap B Z\\). We will show that \\(Q^{\\prime}=Q\\).\nFirst of all, we have\n\\[\n\\begin{aligned}\n\\angle\\left(Q^{\\prime} Y, Q^{\\prime} B\\right)=\\angle(C Y, & Z B)=\\angle(C Y, Z Y)+\\angle(Z Y, B Z) \\\\\n& =\\angle(C I, I W)+\\angle(I W, I B)=\\angle(C I, I B)=\\frac{\\pi-\\angle A}{2}=\\angle(F Y, F B),\n\\end{aligned}\n\\]\nso \\(Q^{\\prime} \\in \\Omega_{B}\\). Similarly, \\(Q^{\\prime} \\in \\Omega_{C}\\). Thus \\(Q^{\\prime} \\in \\Omega_{B} \\cap \\Omega_{C}=\\{P, Q\\}\\) and it remains to prove that \\(Q^{\\prime} \\neq P\\). If we had \\(Q^{\\prime}=P\\), we would have \\(\\angle(P Y, P Z)=\\angle\\left(Q^{\\prime} Y, Q^{\\prime} Z\\right)=\\angle(I C, I B)\\). This would imply\n\\[\n\\angle(P Y, Y F)+\\angle(E Z, Z P)=\\angle(P Y, P Z)=\\angle(I C, I B)=\\angle(P E, P F),\n\\]\nso circles \\(\\Omega_{B}\\) and \\(\\Omega_{C}\\) would be tangent at \\(P\\). That is excluded in the problem conditions, so \\(Q^{\\prime}=Q\\).\n![](https://cdn.mathpix.com/cropped/2025_08_23_54ae86499e5425f8b31eg-077.jpg?height=960&width=1475&top_left_y=1076&top_left_x=256)\n\nStep 4. Now we are ready to show that \\(P, Q\\), and \\(S\\) are collinear.\nNotice that \\(A\\) and \\(D\\) are the poles of \\(E W\\) and \\(D W\\) with respect to \\(\\omega\\), so \\(W\\) is the pole of \\(A D\\). Hence, \\(W I \\perp A D\\). Since \\(C I \\perp D E\\), this yields \\(\\angle(I C, W I)=\\angle(D E, D A)\\). On the other hand, \\(D A\\) is a symmedian in \\(\\triangle D E F\\), so \\(\\angle(D E, D A)=\\angle(D N, D F)=\\angle(D S, D F)\\). Therefore,\n\\[\n\\begin{aligned}\n\\angle(P S, P F)=\\angle(D S, D F)=\\angle(D E, D A)= & \\angle(I C, I W) \\\\\n& =\\angle(Y C, Y W)=\\angle(Y Q, Y F)=\\angle(P Q, P F)\n\\end{aligned}\n\\]\nwhich yields the desired collinearity.", "source_pdf": "imosl_2019.pdf", "notes": "fallback-regex"}
{"id": "IMO-2019-4", "contest": "IMO", "year": "2019", "problem_number": "N1", "problem": "Find all pairs ( \\(m, n\\) ) of positive integers satisfying the equation\n\\[\n\\left(2^{n}-1\\right)\\left(2^{n}-2\\right)\\left(2^{n}-4\\right) \\cdots\\left(2^{n}-2^{n-1}\\right)=m!\n\\]\n(El Salvador)", "solution": "Answer: The only such pairs are ( 1,1 ) and ( 3,2 ).\nCommon remarks. In all solutions, for any prime \\(p\\) and positive integer \\(N\\), we will denote by \\(v_{p}(N)\\) the exponent of the largest power of \\(p\\) that divides \\(N\\). The left-hand side of (1) will be denoted by \\(L_{n}\\); that is, \\(L_{n}=\\left(2^{n}-1\\right)\\left(2^{n}-2\\right)\\left(2^{n}-4\\right) \\cdots\\left(2^{n}-2^{n-1}\\right)\\).\n\n1. We will get an upper bound on \\(n\\) from the speed at which \\(v_{2}\\left(L_{n}\\right)\\) grows.\nFrom\n\\[\nL_{n}=\\left(2^{n}-1\\right)\\left(2^{n}-2\\right) \\cdots\\left(2^{n}-2^{n-1}\\right)=2^{1+2+\\cdots+(n-1)}\\left(2^{n}-1\\right)\\left(2^{n-1}-1\\right) \\cdots\\left(2^{1}-1\\right)\n\\]\nwe read\n\\[\nv_{2}\\left(L_{n}\\right)=1+2+\\cdots+(n-1)=\\frac{n(n-1)}{2} .\n\\]\n\nOn the other hand, \\(v_{2}(m!)\\) is expressed by the Legendre formula as\n\\[\nv_{2}(m!)=\\sum_{i=1}^{\\infty}\\left\\lfloor\\frac{m}{2^{i}}\\right\\rfloor .\n\\]\n\nAs usual, by omitting the floor functions,\n\\[\nv_{2}(m!)<\\sum_{i=1}^{\\infty} \\frac{m}{2^{i}}=m .\n\\]\n\nThus, \\(L_{n}=m!\\) implies the inequality\n\\[\n\\frac{n(n-1)}{2}<m .\n\\]\n\nIn order to obtain an opposite estimate, observe that\n\\[\nL_{n}=\\left(2^{n}-1\\right)\\left(2^{n}-2\\right) \\cdots\\left(2^{n}-2^{n-1}\\right)<\\left(2^{n}\\right)^{n}=2^{n^{2}} .\n\\]\n\nWe claim that\n\\[\n2^{n^{2}}<\\left(\\frac{n(n-1)}{2}\\right)!\\text { for } n \\geqslant 6 .\n\\]\n\nFor \\(n=6\\) the estimate (3) is true because \\(2^{6^{2}}<6.9 \\cdot 10^{10}\\) and \\(\\left(\\frac{n(n-1)}{2}\\right)!=15!>1.3 \\cdot 10^{12}\\).\nFor \\(n \\geqslant 7\\) we prove (3) by the following inequalities:\n\\[\n\\begin{aligned}\n\\left(\\frac{n(n-1)}{2}\\right)! & =15!\\cdot 16 \\cdot 17 \\cdots \\frac{n(n-1)}{2}>2^{36} \\cdot 16^{\\frac{n(n-1)}{2}-15} \\\\\n& =2^{2 n(n-1)-24}=2^{n^{2}} \\cdot 2^{n(n-2)-24}>2^{n^{2}} .\n\\end{aligned}\n\\]\n\nPutting together (2) and (3), for \\(n \\geqslant 6\\) we get a contradiction, since\n\\[\nL_{n}<2^{n^{2}}<\\left(\\frac{n(n-1)}{2}\\right)!<m!=L_{n} .\n\\]\n\nHence \\(n \\geqslant 6\\) is not possible.\nChecking manually the cases \\(n \\leqslant 5\\) we find\n\\[\n\\begin{gathered}\nL_{1}=1=1!, \\quad L_{2}=6=3!, \\quad 5!<L_{3}=168<6!, \\\\\n7!<L_{4}=20160<8!\\quad \\text { and } \\quad 10!<L_{5}=9999360<11!.\n\\end{gathered}\n\\]\n\nSo, there are two solutions:\n\\[\n(m, n) \\in\\{(1,1),(3,2)\\} .\n\\]\n\nSolution 2. Like in the previous solution, the cases \\(n=1,2,3,4\\) are checked manually. We will exclude \\(n \\geqslant 5\\) by considering the exponents of 3 and 31 in (1).\n\nFor odd primes \\(p\\) and distinct integers \\(a, b\\), coprime to \\(p\\), with \\(p \\mid a-b\\), the Lifting The Exponent lemma asserts that\n\\[\nv_{p}\\left(a^{k}-b^{k}\\right)=v_{p}(a-b)+v_{p}(k) .\n\\]\n\nNotice that 3 divides \\(2^{k}-1\\) if only if \\(k\\) is even; moreover, by the Lifting The Exponent lemma we have\n\\[\nv_{3}\\left(2^{2 k}-1\\right)=v_{3}\\left(4^{k}-1\\right)=1+v_{3}(k)=v_{3}(3 k) .\n\\]\n\nHence,\n\\[\nv_{3}\\left(L_{n}\\right)=\\sum_{2 k \\leqslant n} v_{3}\\left(4^{k}-1\\right)=\\sum_{k \\leqslant\\left\\lfloor\\frac{n}{2}\\right\\rfloor} v_{3}(3 k) .\n\\]\n\nNotice that the last expression is precisely the exponent of 3 in the prime factorisation of \\(\\left(3\\left\\lfloor\\frac{n}{2}\\right\\rfloor\\right)!\\). Therefore\n\\[\n\\begin{aligned}\nv_{3}(m!)=v_{3}\\left(L_{n}\\right) & =v_{3}\\left(\\left(3\\left\\lfloor\\frac{n}{2}\\right\\rfloor\\right)!\\right) \\\\\n3\\left\\lfloor\\frac{n}{2}\\right\\rfloor & \\leqslant m \\leqslant 3\\left\\lfloor\\frac{n}{2}\\right\\rfloor+2\n\\end{aligned}\n\\]\n\nSuppose that \\(n \\geqslant 5\\). Note that every fifth factor in \\(L_{n}\\) is divisible by \\(31=2^{5}-1\\), and hence we have \\(v_{31}\\left(L_{n}\\right) \\geqslant\\left\\lfloor\\frac{n}{5}\\right\\rfloor\\). Then\n\\[\n\\frac{n}{10} \\leqslant\\left\\lfloor\\frac{n}{5}\\right\\rfloor \\leqslant v_{31}\\left(L_{n}\\right)=v_{31}(m!)=\\sum_{k=1}^{\\infty}\\left\\lfloor\\frac{m}{31^{k}}\\right\\rfloor<\\sum_{k=1}^{\\infty} \\frac{m}{31^{k}}=\\frac{m}{30} .\n\\]\n\nBy combining (4) and (5),\n\\[\n3 n<m \\leqslant \\frac{3 n}{2}+2\n\\]\nso \\(n<\\frac{4}{3}\\) which is inconsistent with the inequality \\(n \\geqslant 5\\).\nComment 1. There are many combinations of the ideas above; for example combining (2) and (4) also provides \\(n<5\\). Obviously, considering the exponents of any two primes in (1), or considering one prime and the magnitude orders lead to an upper bound on \\(n\\) and \\(m\\).\n\nComment 2. This problem has a connection to group theory. Indeed, the left-hand side is the order of the group \\(G L_{n}\\left(\\mathbb{F}_{2}\\right)\\) of invertible \\(n\\)-by- \\(n\\) matrices with entries modulo 2 , while the right-hand side is the order of the symmetric group \\(S_{m}\\) on \\(m\\) elements. The result thus shows that the only possible isomorphisms between these groups are \\(G L_{1}\\left(\\mathbb{F}_{2}\\right) \\cong S_{1}\\) and \\(G L_{2}\\left(\\mathbb{F}_{2}\\right) \\cong S_{3}\\), and there are in fact isomorphisms in both cases. In general, \\(G L_{n}\\left(\\mathbb{F}_{2}\\right)\\) is a simple group for \\(n \\geqslant 3\\), as it is isomorphic to \\(P S L_{n}\\left(\\mathbb{F}_{2}\\right)\\).\n\nThere is also a near-solution of interest: the left-hand side for \\(n=4\\) is half of the right-hand side when \\(m=8\\); this turns out to correspond to an isomorphism \\(G L_{4}\\left(\\mathbb{F}_{2}\\right) \\cong A_{8}\\) with the alternating group on eight elements.\n\nHowever, while this indicates that the problem is a useful one, knowing group theory is of no use in solving it!", "source_pdf": "imosl_2019.pdf", "notes": "fallback-regex"}
{"id": "IMO-2020-2", "contest": "IMO", "year": "2020", "problem_number": "A4", "problem": "Let \\(a, b, c, d\\) be four real numbers such that \\(a \\geqslant b \\geqslant c \\geqslant d>0\\) and \\(a+b+c+d=1\\). Prove that\n\\[\n(a+2 b+3 c+4 d) a^{a} b^{b} c^{c} d^{d}<1\n\\]\n(Belgium)", "solution": "1. The weighted AM-GM inequality with weights \\(a, b, c, d\\) gives\n\\[\na^{a} b^{b} c^{c} d^{d} \\leqslant a \\cdot a+b \\cdot b+c \\cdot c+d \\cdot d=a^{2}+b^{2}+c^{2}+d^{2}\n\\]\nso it suffices to prove that \\((a+2 b+3 c+4 d)\\left(a^{2}+b^{2}+c^{2}+d^{2}\\right)<1=(a+b+c+d)^{3}\\). This can be done in various ways, for example:\n\\[\n\\begin{aligned}\n(a+b+c+d)^{3}> & a^{2}(a+3 b+3 c+3 d)+b^{2}(3 a+b+3 c+3 d) \\\\\n& +c^{2}(3 a+3 b+c+3 d)+d^{2}(3 a+3 b+3 c+d) \\\\\n\\geqslant & \\left(a^{2}+b^{2}+c^{2}+d^{2}\\right) \\cdot(a+2 b+3 c+4 d)\n\\end{aligned}\n\\]\n\nSolution 2. From \\(b \\geqslant d\\) we get\n\\[\na+2 b+3 c+4 d \\leqslant a+3 b+3 c+3 d=3-2 a\n\\]\n\nIf \\(a<\\frac{1}{2}\\), then the statement can be proved by\n\\[\n(a+2 b+3 c+4 d) a^{a} b^{b} c^{c} d^{d} \\leqslant(3-2 a) a^{a} a^{b} a^{c} a^{d}=(3-2 a) a=1-(1-a)(1-2 a)<1\n\\]\n\nFrom now on we assume \\(\\frac{1}{2} \\leqslant a<1\\).\nBy \\(b, c, d<1-a\\) we have\n\\[\nb^{b} c^{c} d^{d}<(1-a)^{b} \\cdot(1-a)^{c} \\cdot(1-a)^{d}=(1-a)^{1-a}\n\\]\n\nTherefore,\n\\[\n(a+2 b+3 c+4 d) a^{a} b^{b} c^{c} d^{d}<(3-2 a) a^{a}(1-a)^{1-a}\n\\]\n\nFor \\(0<x<1\\), consider the functions \\(f(x)=(3-2 x) x^{x}(1-x)^{1-x} \\quad\\) and \\(\\quad g(x)=\\log f(x)=\\log (3-2 x)+x \\log x+(1-x) \\log (1-x) ;\\) hereafter, log denotes the natural logarithm. It is easy to verify that\n\\[\ng^{\\prime \\prime}(x)=-\\frac{4}{(3-2 x)^{2}}+\\frac{1}{x}+\\frac{1}{1-x}=\\frac{1+8(1-x)^{2}}{x(1-x)(3-2 x)^{2}}>0\n\\]\nso \\(g\\) is strictly convex on \\((0,1)\\).\nBy \\(g\\left(\\frac{1}{2}\\right)=\\log 2+2 \\cdot \\frac{1}{2} \\log \\frac{1}{2}=0\\) and \\(\\lim _{x \\rightarrow 1-} g(x)=0\\), we have \\(g(x) \\leqslant 0(\\) and hence \\(f(x) \\leqslant 1)\\) for all \\(x \\in\\left[\\frac{1}{2}, 1\\right)\\), and therefore\n\\[\n(a+2 b+3 c+4 d) a^{a} b^{b} c^{c} d^{d}<f(a) \\leqslant 1\n\\]\n\nComment. For a large number of variables \\(a_{1} \\geqslant a_{2} \\geqslant \\ldots \\geqslant a_{n}>0\\) with \\(\\sum_{i} a_{i}=1\\), the inequality\n\\[\n\\left(\\sum_{i} i a_{i}\\right) \\prod_{i} a_{i}^{a_{i}} \\leqslant 1\n\\]\ndoes not necessarily hold. Indeed, let \\(a_{2}=a_{3}=\\ldots=a_{n}=\\varepsilon\\) and \\(a_{1}=1-(n-1) \\varepsilon\\), where \\(n\\) and \\(\\varepsilon \\in(0,1 / n)\\) will be chosen later. Then\n\\[\n\\left(\\sum_{i} i a_{i}\\right) \\prod_{i} a_{i}^{a_{i}}=\\left(1+\\frac{n(n-1)}{2} \\varepsilon\\right) \\varepsilon^{(n-1) \\varepsilon}(1-(n-1) \\varepsilon)^{1-(n-1) \\varepsilon} .\n\\]\n\nIf \\(\\varepsilon=C / n^{2}\\) with an arbitrary fixed \\(C>0\\) and \\(n \\rightarrow \\infty\\), then the factors \\(\\varepsilon^{(n-1) \\varepsilon}=\\exp ((n-1) \\varepsilon \\log \\varepsilon)\\) and \\((1-(n-1) \\varepsilon)^{1-(n-1) \\varepsilon}\\) tend to 1 , so the limit of (1) in this set-up equals \\(1+C / 2\\). This is not simply greater than 1 , but it can be arbitrarily large.", "source_pdf": "imosl_2020.pdf", "notes": "fallback-regex"}
{"id": "IMO-2020-4", "contest": "IMO", "year": "2020", "problem_number": "C3", "problem": "Let \\(n\\) be an integer with \\(n \\geqslant 2\\). On a slope of a mountain, \\(n^{2}\\) checkpoints are marked, numbered from 1 to \\(n^{2}\\) from the bottom to the top. Each of two cable car companies, \\(A\\) and \\(B\\), operates \\(k\\) cable cars numbered from 1 to \\(k\\); each cable car provides a transfer from some checkpoint to a higher one. For each company, and for any \\(i\\) and \\(j\\) with \\(1 \\leqslant i<j \\leqslant k\\), the starting point of car \\(j\\) is higher than the starting point of car \\(i\\); similarly, the finishing point of car \\(j\\) is higher than the finishing point of car \\(i\\). Say that two checkpoints are linked by some company if one can start from the lower checkpoint and reach the higher one by using one or more cars of that company (no movement on foot is allowed).\n\nDetermine the smallest \\(k\\) for which one can guarantee that there are two checkpoints that are linked by each of the two companies.\n(India)", "solution": "Answer: \\(k=n^{2}-n+1\\).\n\n. We start with showing that for any \\(k \\leqslant n^{2}-n\\) there may be no pair of checkpoints linked by both companies. Clearly, it suffices to provide such an example for \\(k=n^{2}-n\\).\n\nLet company \\(A\\) connect the pairs of checkpoints of the form \\((i, i+1)\\), where \\(n \\nmid i\\). Then all pairs of checkpoints ( \\(i, j\\) ) linked by \\(A\\) satisfy \\(\\lceil i / n\\rceil=\\lceil j / n\\rceil\\).\n\nLet company \\(B\\) connect the pairs of the form \\((i, i+n)\\), where \\(1 \\leqslant i \\leqslant n^{2}-n\\). Then pairs of checkpoints \\((i, j)\\) linked by \\(B\\) satisfy \\(i \\equiv j(\\bmod n)\\). Clearly, no pair \\((i, j)\\) satisfies both conditions, so there is no pair linked by both companies.\n\nNow we show that for \\(k=n^{2}-n+1\\) there always exist two required checkpoints. Define an \\(A\\)-chain as a sequence of checkpoints \\(a_{1}<a_{2}<\\ldots<a_{t}\\) such that company \\(A\\) connects \\(a_{i}\\) with \\(a_{i+1}\\) for all \\(1 \\leqslant i \\leqslant t-1\\), but there is no \\(A\\)-car transferring from some checkpoint to \\(a_{1}\\) and no \\(A\\)-car transferring from \\(a_{t}\\) to any other checkpoint. Define \\(B\\)-chains similarly. Moving forth and back, one easily sees that any checkpoint is included in a unique \\(A\\)-chain (possibly consisting of that single checkpoint), as well as in a unique \\(B\\)-chain. Now, put each checkpoint into a correspondence to the pair of the \\(A\\)-chain and the \\(B\\)-chain it belongs to.\n\nAll finishing points of \\(A\\)-cars are distinct, so there are \\(n^{2}-k=n-1\\) checkpoints that are not such finishing points. Each of them is a starting point of a unique \\(A\\)-chain, so the number of \\(A\\)-chains is \\(n-1\\). Similarly, the number of \\(B\\)-chains also equals \\(n-1\\). Hence, there are \\((n-1)^{2}\\) pairs consisting of an \\(A\\) - and a \\(B\\)-chain. Therefore, two of the \\(n^{2}\\) checkpoints correspond to the same pair, so that they belong to the same \\(A\\)-chain, as well as to the same \\(B\\)-chain. This means that they are linked by both companies, as required.\n\nComment 1. The condition that the \\(i^{\\text {th }}\\) car starts and finishes lower than the \\(j^{\\text {th }}\\) one is used only in the \"moving forth and back\" argument and in the counting of starting points of the chains. In both cases, the following weaker assumption suffices: No two cars of the same company start at the same checkpoint, and no two such cars finish at the same checkpoint.\n\nThus, the problem conditions could be weakened in this way,, with no affect on the solution.\nComment 2. If the number of checkpoints were \\(N\\), then the answer would be \\(N-\\lceil\\sqrt{N}\\rceil+1\\). The solution above works verbatim for this generalization.", "source_pdf": "imosl_2020.pdf", "notes": "fallback-regex"}
{"id": "IMO-2020-3", "contest": "IMO", "year": "2020", "problem_number": "C6", "problem": "\\(4 n\\) coins of weights \\(1,2,3, \\ldots, 4 n\\) are given. Each coin is colored in one of \\(n\\) colors and there are four coins of each color. Show that all these coins can be partitioned into two sets with the same total weight, such that each set contains two coins of each color.\n(Hungary)", "solution": "1. Let us pair the coins with weights summing up to \\(4 n+1\\), resulting in the set \\(S\\) of \\(2 n\\) pairs: \\(\\{1,4 n\\},\\{2,4 n-1\\}, \\ldots,\\{2 n, 2 n+1\\}\\). It suffices to partition \\(S\\) into two sets, each consisting of \\(n\\) pairs, such that each set contains two coins of each color.\n\nIntroduce a multi-graph \\(G\\) (i.e., a graph with loops and multiple edges allowed) on \\(n\\) vertices, so that each vertex corresponds to a color. For each pair of coins from \\(S\\), we add an edge between the vertices corresponding to the colors of those coins. Note that each vertex has degree 4. Also, a desired partition of the coins corresponds to a coloring of the edges of \\(G\\) in two colors, say red and blue, so that each vertex has degree 2 with respect to each color (i.e., each vertex has equal red and blue degrees).\n\nTo complete the solution, it suffices to provide such a coloring for each component \\(G^{\\prime}\\) of \\(G\\). Since all degrees of the vertices are even, in \\(G^{\\prime}\\) there exists an Euler circuit \\(C\\) (i.e., a circuit passing through each edge of \\(G^{\\prime}\\) exactly once). Note that the number of edges in \\(C\\) is even (it equals twice the number of vertices in \\(G^{\\prime}\\) ). Hence all the edges can be colored red and blue so that any two edges adjacent in \\(C\\) have different colors (one may move along \\(C\\) and color the edges one by one alternating red and blue colors). Thus in \\(G^{\\prime}\\) each vertex has equal red and blue degrees, as desired.\n\nComment 1. To complete Solution 1, any partition of the edges of \\(G\\) into circuits of even lengths could be used. In the solution above it was done by the reference to the well-known Euler Circuit Lemma: Let \\(G\\) be a connected graph with all its vertices of even degrees. Then there exists a circuit passing through each edge of \\(G\\) exactly once.\n\nSolution 2. As in Solution 1, we will show that it is possible to partition \\(2 n\\) pairs \\(\\{1,4 n\\}\\), \\(\\{2,4 n-1\\}, \\ldots,\\{2 n, 2 n+1\\}\\) into two sets, each consisting of \\(n\\) pairs, such that each set contains two coins of each color.\n\nIntroduce a multi-graph (i.e., a graph with multiple edges allowed) \\(\\Gamma\\) whose vertices correspond to coins; thus we have \\(4 n\\) vertices of \\(n\\) colors so that there are four vertices of each color. Connect pairs of vertices \\(\\{1,4 n\\},\\{2,4 n-1\\}, \\ldots,\\{2 n, 2 n+1\\}\\) by \\(2 n\\) black edges.\n\nFurther, for each monochromatic quadruple of vertices \\(i, j, k, \\ell\\) we add a pair of grey edges forming a matching, e.g., \\((i, j)\\) and \\((k, \\ell)\\). In each of \\(n\\) colors of coins we can choose one of three possible matchings; this results in \\(3^{n}\\) ways of constructing grey edges. Let us call each of \\(3^{n}\\) possible graphs \\(\\Gamma\\) a cyclic graph. Note that in a cyclic graph \\(\\Gamma\\) each vertex has both black and grey degrees equal to 1 . Hence \\(\\Gamma\\) is a union of disjoint cycles, and in each cycle black and grey edges alternate (in particular, all cycles have even lengths).\n\nIt suffices to find a cyclic graph with all its cycle lengths divisible by 4 . Indeed, in this case, for each cycle we start from some vertex, move along the cycle and recolor the black edges either to red or to blue, alternating red and blue colors. Now blue and red edges define the required partition, since for each monochromatic quadruple of vertices the grey edges provide a bijection between the endpoints of red and blue edges.\n\nAmong all possible cyclic graphs, let us choose graph \\(\\Gamma_{0}\\) having the minimal number of components (i.e., cycles). The following claim completes the solution.\nClaim. In \\(\\Gamma_{0}\\), all cycle lengths are divisible by 4 .\nProof. Assuming the contrary, choose a cycle \\(C_{1}\\) with an odd number of grey edges. For some color \\(c\\) the cycle \\(C_{1}\\) contains exactly one grey edge joining two vertices \\(i, j\\) of color \\(c\\), while the other edge joining two vertices \\(k, \\ell\\) of color \\(c\\) lies in another cycle \\(C_{2}\\). Now delete edges \\((i, j)\\) and ( \\(k, \\ell\\) ) and add edges ( \\(i, k\\) ) and ( \\(j, \\ell\\) ). By this switch we again obtain a cyclic graph \\(\\Gamma_{0}^{\\prime}\\) and decrease the number of cycles by 1 . This contradicts the choice of \\(\\Gamma_{0}\\).\n\nComment 2. Use of an auxiliary graph and reduction to a new problem in terms of this graph is one of the crucial steps in both solutions presented. In fact, graph \\(G\\) from Solution 1 could be obtained from any graph \\(\\Gamma\\) from Solution 2 by merging the vertices of the same color.", "source_pdf": "imosl_2020.pdf", "notes": "fallback-regex"}
{"id": "IMO-2020-1", "contest": "IMO", "year": "2020", "problem_number": "G2", "problem": "Let \\(A B C D\\) be a convex quadrilateral. Suppose that \\(P\\) is a point in the interior of \\(A B C D\\) such that\n\\[\n\\angle P A D: \\angle P B A: \\angle D P A=1: 2: 3=\\angle C B P: \\angle B A P: \\angle B P C .\n\\]\n\nThe internal bisectors of angles \\(A D P\\) and \\(P C B\\) meet at a point \\(Q\\) inside the triangle \\(A B P\\). Prove that \\(A Q=B Q\\).\n(Poland)", "solution": "1. Let \\(\\varphi=\\angle P A D\\) and \\(\\psi=\\angle C B P\\); then we have \\(\\angle P B A=2 \\varphi, \\angle D P A=3 \\varphi\\), \\(\\angle B A P=2 \\psi\\) and \\(\\angle B P C=3 \\psi\\). Let \\(X\\) be the point on segment \\(A D\\) with \\(\\angle X P A=\\varphi\\). Then\n\\[\n\\angle P X D=\\angle P A X+\\angle X P A=2 \\varphi=\\angle D P A-\\angle X P A=\\angle D P X .\n\\]\n\nIt follows that triangle \\(D P X\\) is isosceles with \\(D X=D P\\) and therefore the internal angle bisector of \\(\\angle A D P\\) coincides with the perpendicular bisector of \\(X P\\). Similarly, if \\(Y\\) is a point on \\(B C\\) such that \\(\\angle B P Y=\\psi\\), then the internal angle bisector of \\(\\angle P C B\\) coincides with the perpendicular bisector of \\(P Y\\). Hence, we have to prove that the perpendicular bisectors of \\(X P\\), \\(P Y\\), and \\(A B\\) are concurrent.\n![](https://cdn.mathpix.com/cropped/2025_08_23_b01e523c913a1e72c2d0g-52.jpg?height=649&width=707&top_left_y=1159&top_left_x=676)\n\nNotice that\n\\[\n\\angle A X P=180^{\\circ}-\\angle P X D=180^{\\circ}-2 \\varphi=180^{\\circ}-\\angle P B A .\n\\]\n\nHence the quadrilateral \\(A X P B\\) is cyclic; in other words, \\(X\\) lies on the circumcircle of triangle \\(A P B\\). Similarly, \\(Y\\) lies on the circumcircle of triangle \\(A P B\\). It follows that the perpendicular bisectors of \\(X P, P Y\\), and \\(A B\\) all pass through the center of circle \\((A B Y P X)\\). This finishes the proof.\n\nComment. Introduction of points \\(X\\) and \\(Y\\) seems to be the key step in the solution above. Note that the same point \\(X\\) could be introduced in different ways, e.g., as the point on the ray \\(C P\\) beyond \\(P\\) such that \\(\\angle P B X=\\varphi\\), or as a point where the circle ( \\(A P B\\) ) meets again \\(A B\\). Different definitions of \\(X\\) could lead to different versions of the further solution.\n\nSolution 2. We define the angles \\(\\varphi=\\angle P A D, \\psi=\\angle C B P\\) and use \\(\\angle P B A=2 \\varphi, \\angle D P A= 3 \\varphi, \\angle B A P=2 \\psi\\) and \\(\\angle B P C=3 \\psi\\) again. Let \\(O\\) be the circumcenter of \\(\\triangle A P B\\).\n\nNotice that \\(\\angle A D P=180^{\\circ}-\\angle P A D-\\angle D P A=180^{\\circ}-4 \\varphi\\), which, in particular, means that \\(4 \\varphi<180^{\\circ}\\). Further, \\(\\angle P O A=2 \\angle P B A=4 \\varphi=180^{\\circ}-\\angle A D P\\), therefore the quadrilateral \\(A D P O\\) is cyclic. By \\(A O=O P\\), it follows that \\(\\angle A D O=\\angle O D P\\). Thus \\(D O\\) is the internal bisector of \\(\\angle A D P\\). Similarly, \\(C O\\) is the internal bisector of \\(\\angle P C B\\).\n![](https://cdn.mathpix.com/cropped/2025_08_23_b01e523c913a1e72c2d0g-53.jpg?height=663&width=1006&top_left_y=208&top_left_x=528)\n\nFinally, \\(O\\) lies on the perpendicular bisector of \\(A B\\) as it is the circumcenter of \\(\\triangle A P B\\). Therefore the three given lines in the problem statement concur at point \\(O\\).", "source_pdf": "imosl_2020.pdf", "notes": "fallback-regex"}
{"id": "IMO-2020-6", "contest": "IMO", "year": "2020", "problem_number": "G9", "problem": "Prove that there exists a positive constant \\(c\\) such that the following statement is true:\n\nAssume that \\(n\\) is an integer with \\(n \\geqslant 2\\), and let \\(\\mathcal{S}\\) be a set of \\(n\\) points in the plane such that the distance between any two distinct points in \\(\\mathcal{S}\\) is at least 1 . Then there is a line \\(\\ell\\) separating \\(\\mathcal{S}\\) such that the distance from any point of \\(\\mathcal{S}\\) to \\(\\ell\\) is at least \\(c n^{-1 / 3}\\).\n(A line \\(\\ell\\) separates a point set \\(\\mathcal{S}\\) if some segment joining two points in \\(\\mathcal{S}\\) crosses \\(\\ell\\).)\n(Taiwan)", "solution": ". We prove that the desired statement is true with \\(c=\\frac{1}{8}\\). Set \\(\\delta=\\frac{1}{8} n^{-1 / 3}\\). For any line \\(\\ell\\) and any point \\(X\\), let \\(X_{\\ell}\\) denote the projection of \\(X\\) to \\(\\ell\\); a similar notation applies to sets of points.\n\nSuppose that, for some line \\(\\ell\\), the set \\(\\mathcal{S}_{\\ell}\\) contains two adjacent points \\(X\\) and \\(Y\\) with \\(X Y=2 d\\). Then the line perpendicular to \\(\\ell\\) and passing through the midpoint of segment \\(X Y\\) separates \\(\\mathcal{S}\\), and all points in \\(\\mathcal{S}\\) are at least \\(d\\) apart from \\(\\ell\\). Thus, if \\(d \\geqslant \\delta\\), then a desired line has been found. For the sake of contradiction, we assume that no such points exist, in any projection.\n\nChoose two points \\(A\\) and \\(B\\) in \\(\\mathcal{S}\\) with the maximal distance \\(M=A B\\) (i.e., \\(A B\\) is a diameter of \\(\\mathcal{S}\\) ); by the problem condition, \\(M \\geqslant 1\\). Denote by \\(\\ell\\) the line \\(A B\\). The set \\(\\mathcal{S}\\) is contained in the intersection of two disks \\(D_{A}\\) and \\(D_{B}\\) of radius \\(M\\) centered at \\(A\\) and \\(B\\), respectively. Hence, the projection \\(\\mathcal{S}_{\\ell}\\) is contained in the segment \\(A B\\). Moreover, the points in \\(\\mathcal{S}_{\\ell}\\) divide that segment into at most \\(n-1\\) parts, each of length less than \\(2 \\delta\\). Therefore,\n\\[\nM<n \\cdot 2 \\delta .\n\\]\n![](https://cdn.mathpix.com/cropped/2025_08_23_b01e523c913a1e72c2d0g-69.jpg?height=409&width=906&top_left_y=1410&top_left_x=582)\n\nChoose a point \\(H\\) on segment \\(A B\\) with \\(A H=\\frac{1}{2}\\). Let \\(P\\) be a strip between the lines \\(a\\) and \\(h\\) perpendicular to \\(A B\\) and passing through \\(A\\) and \\(H\\), respectively; we assume that \\(P\\) contains its boundary, which consists of lines \\(a\\) and \\(h\\). Set \\(\\mathcal{T}=P \\cap \\mathcal{S}\\) and let \\(t=|\\mathcal{T}|\\). By our assumption, segment \\(A H\\) contains at least \\(\\left\\lceil\\frac{1}{2}:(2 \\delta)\\right\\rceil\\) points of \\(S_{\\ell}\\), which yields\n\\[\nt \\geqslant \\frac{1}{4 \\delta} .\n\\]\n\nNotice that \\(\\mathcal{T}\\) is contained in \\(Q=P \\cap D_{B}\\). The set \\(Q\\) is a circular segment, and its projection \\(Q_{a}\\) is a line segment of length\n\\[\n2 \\sqrt{M^{2}-\\left(M-\\frac{1}{2}\\right)^{2}}<2 \\sqrt{M} .\n\\]\n\nOn the other hand, for any two points \\(X, Y \\in \\mathcal{T}\\), we have \\(X Y \\geqslant 1\\) and \\(X_{\\ell} Y_{\\ell} \\leqslant \\frac{1}{2}\\), so \\(X_{a} Y_{a}= \\sqrt{X Y^{2}-X_{\\ell} Y_{\\ell}^{2}} \\geqslant \\frac{\\sqrt{3}}{2}\\). To summarize, \\(t\\) points constituting \\(\\mathcal{T}_{a}\\) lie on the segment of length less than \\(2 \\sqrt{M}\\), and are at least \\(\\frac{\\sqrt{3}}{2}\\) apart from each other. This yields \\(2 \\sqrt{M}>(t-1) \\frac{\\sqrt{3}}{2}\\), or\n\\[\nt<1+\\frac{4 \\sqrt{M}}{\\sqrt{3}}<4 \\sqrt{M},\n\\]\nas \\(M \\geqslant 1\\).\nCombining the estimates (1), (2), and (3), we finally obtain\n\\[\n\\frac{1}{4 \\delta} \\leqslant t<4 \\sqrt{M}<4 \\sqrt{2 n \\delta}, \\quad \\text { or } \\quad 512 n \\delta^{3}>1\n\\]\nwhich does not hold for the chosen value of \\(\\delta\\).\nComment 1. As the proposer mentions, the exponent \\(-1 / 3\\) in the problem statement is optimal. In fact, for any \\(n \\geqslant 2\\), there is a configuration \\(\\mathcal{S}\\) of \\(n\\) points in the plane such that any two points in \\(\\mathcal{S}\\) are at least 1 apart, but every line \\(\\ell\\) separating \\(\\mathcal{S}\\) is at most \\(c^{\\prime} n^{-1 / 3} \\log n\\) apart from some point in \\(\\mathcal{S}\\); here \\(c^{\\prime}\\) is some absolute constant.\n\nThe original proposal suggested to prove the estimate of the form \\(c n^{-1 / 2}\\). That version admits much easier solutions. E.g., setting \\(\\delta=\\frac{1}{16} n^{-1 / 2}\\) and applying (1), we see that \\(\\mathcal{S}\\) is contained in a disk \\(D\\) of radius \\(\\frac{1}{8} n^{1 / 2}\\). On the other hand, for each point \\(X\\) of \\(\\mathcal{S}\\), let \\(D_{X}\\) be the disk of radius \\(\\frac{1}{2}\\) centered at \\(X\\); all these disks have disjoint interiors and lie within the disk concentric to \\(D\\), of radius \\(\\frac{1}{16} n^{1 / 2}+\\frac{1}{2}<\\frac{1}{2} n^{1 / 2}\\). Comparing the areas, we get\n\\[\nn \\cdot \\frac{\\pi}{4} \\leqslant \\pi\\left(\\frac{n^{1 / 2}}{16}+\\frac{1}{2}\\right)^{2}<\\frac{\\pi n}{4}\n\\]\nwhich is a contradiction.\nThe Problem Selection Committee decided to choose a harder version for the Shortlist.\nComment 2. In this comment, we discuss some versions of the solution above, which avoid concentrating on the diameter of \\(\\mathcal{S}\\). We start with introducing some terminology suitable for those versions.\n\nPut \\(\\delta=c n^{-1 / 3}\\) for a certain sufficiently small positive constant \\(c\\). For the sake of contradiction, suppose that, for some set \\(\\mathcal{S}\\) satisfying the conditions in the problem statement, there is no separating line which is at least \\(\\delta\\) apart from each point of \\(\\mathcal{S}\\).\n\nLet \\(C\\) be the convex hull of \\(\\mathcal{S}\\). A line is separating if and only if it meets \\(C\\) (we assume that a line passing through a point of \\(\\mathcal{S}\\) is always separating). Consider a strip between two parallel separating lines \\(a\\) and \\(a^{\\prime}\\) which are, say, \\(\\frac{1}{4}\\) apart from each other. Define a slice determined by the strip as the intersection of \\(\\mathcal{S}\\) with the strip. The length of the slice is the diameter of the projection of the slice to \\(a\\).\n\nIn this terminology, the arguments used in the proofs of (2) and (3) show that for any slice \\(\\mathcal{T}\\) of length \\(L\\), we have\n\\[\n\\frac{1}{8 \\delta} \\leqslant|\\mathcal{T}| \\leqslant 1+\\frac{4}{\\sqrt{15}} L\n\\]\n\nThe key idea of the solution is to apply these estimates to a peel slice, where line \\(a\\) does not cross the interior of \\(C\\). In the above solution, this idea was applied to one carefully chosen peel slice. Here, we outline some different approach involving many of them. We always assume that \\(n\\) is sufficiently large.\n\nConsider a peel slice determined by lines \\(a\\) and \\(a^{\\prime}\\), where \\(a\\) contains no interior points of \\(C\\). We orient \\(a\\) so that \\(C\\) lies to the left of \\(a\\). Line \\(a\\) is called a supporting line of the slice, and the obtained direction is the direction of the slice; notice that the direction determines uniquely the supporting line and hence the slice. Fix some direction \\(\\mathbf{v}_{0}\\), and for each \\(\\alpha \\in[0,2 \\pi)\\) denote by \\(\\mathcal{T}_{\\alpha}\\) the peel slice whose direction is \\(\\mathbf{v}_{0}\\) rotated by \\(\\alpha\\) counterclockwise.\n\nWhen speaking about the slice, we always assume that the figure is rotated so that its direction is vertical from the bottom to the top; then the points in \\(\\mathcal{T}\\) get a natural order from the bottom to the top. In particular, we may speak about the top half \\(\\mathrm{T}(\\mathcal{T})\\) consisting of \\(\\lfloor|\\mathcal{T}| / 2\\rfloor\\) topmost points in \\(\\mathcal{T}\\), and similarly about its bottom half \\(\\mathrm{B}(\\mathcal{T})\\). By (4), each half contains at least 10 points when \\(n\\) is large. Claim. Consider two angles \\(\\alpha, \\beta \\in[0, \\pi / 2]\\) with \\(\\beta-\\alpha \\geqslant 40 \\delta=: \\phi\\). Then all common points of \\(\\mathcal{T}_{\\alpha}\\) and \\(\\mathcal{T}_{\\beta}\\) lie in \\(\\mathrm{T}\\left(\\mathcal{T}_{\\alpha}\\right) \\cap \\mathrm{B}\\left(\\mathcal{T}_{\\beta}\\right)\\).\n![](https://cdn.mathpix.com/cropped/2025_08_23_b01e523c913a1e72c2d0g-71.jpg?height=726&width=1318&top_left_y=208&top_left_x=376)\n\nProof. By symmetry, it suffices to show that all those points lie in \\(\\mathrm{T}\\left(\\mathcal{T}_{\\alpha}\\right)\\). Let \\(a\\) be the supporting line of \\(\\mathcal{T}_{\\alpha}\\), and let \\(\\ell\\) be a line perpendicular to the direction of \\(\\mathcal{T}_{\\beta}\\). Let \\(P_{1}, \\ldots, P_{k}\\) list all points in \\(\\mathcal{T}_{\\alpha}\\), numbered from the bottom to the top; by (4), we have \\(k \\geqslant \\frac{1}{8} \\delta^{-1}\\).\n\nIntroduce the Cartesian coordinates so that the (oriented) line \\(a\\) is the \\(y\\)-axis. Let \\(P_{i}\\) be any point in \\(\\mathrm{B}\\left(\\mathcal{T}_{\\alpha}\\right)\\). The difference of ordinates of \\(P_{k}\\) and \\(P_{i}\\) is at least \\(\\frac{\\sqrt{15}}{4}(k-i)>\\frac{1}{3} k\\), while their abscissas differ by at most \\(\\frac{1}{4}\\). This easily yields that the projections of those points to \\(\\ell\\) are at least\n\\[\n\\frac{k}{3} \\sin \\phi-\\frac{1}{4} \\geqslant \\frac{1}{24 \\delta} \\cdot 20 \\delta-\\frac{1}{4}>\\frac{1}{4}\n\\]\napart from each other, and \\(P_{k}\\) is closer to the supporting line of \\(\\mathcal{T}_{\\beta}\\) than \\(P_{i}\\), so that \\(P_{i}\\) does not belong to \\(\\mathcal{T}_{\\beta}\\).\n\nNow, put \\(\\alpha_{i}=40 \\delta i\\), for \\(i=0,1, \\ldots,\\left\\lfloor\\frac{1}{40} \\delta^{-1} \\cdot \\frac{\\pi}{2}\\right\\rfloor\\), and consider the slices \\(\\mathcal{T}_{\\alpha_{i}}\\). The Claim yields that each point in \\(\\mathcal{S}\\) is contained in at most two such slices. Hence, the union \\(\\mathcal{U}\\) of those slices contains at least\n\\[\n\\frac{1}{2} \\cdot \\frac{1}{8 \\delta} \\cdot \\frac{1}{40 \\delta} \\cdot \\frac{\\pi}{2}=\\frac{\\lambda}{\\delta^{2}}\n\\]\npoints (for some constant \\(\\lambda\\) ), and each point in \\(\\mathcal{U}\\) is at most \\(\\frac{1}{4}\\) apart from the boundary of \\(C\\).\nIt is not hard now to reach a contradiction with (1). E.g., for each point \\(X \\in \\mathcal{U}\\), consider a closest point \\(f(X)\\) on the boundary of \\(C\\). Obviously, \\(f(X) f(Y) \\geqslant X Y-\\frac{1}{2} \\geqslant \\frac{1}{2} X Y\\) for all \\(X, Y \\in \\mathcal{U}\\). This yields that the perimeter of \\(C\\) is at least \\(\\mu \\delta^{-2}\\), for some constant \\(\\mu\\), and hence the diameter of \\(\\mathcal{S}\\) is of the same order.\n\nAlternatively, one may show that the projection of \\(\\mathcal{U}\\) to the line at the angle of \\(\\pi / 4\\) with \\(\\mathbf{v}_{0}\\) has diameter at least \\(\\mu \\delta^{-2}\\) for some constant \\(\\mu\\).\n\n\\section*{Number Theory}", "source_pdf": "imosl_2020.pdf", "notes": "fallback-regex"}
{"id": "IMO-2020-5", "contest": "IMO", "year": "2020", "problem_number": "N3", "problem": "Let \\(n\\) be an integer with \\(n \\geqslant 2\\). Does there exist a sequence ( \\(a_{1}, \\ldots, a_{n}\\) ) of positive integers with not all terms being equal such that the arithmetic mean of every two terms is equal to the geometric mean of some (one or more) terms in this sequence?\n(Estonia)", "solution": "Answer: No such sequence exists.\n\n1. Suppose that \\(a_{1}, \\ldots, a_{n}\\) satisfy the required properties. Let \\(d=\\operatorname{gcd}\\left(a_{1} \\ldots, a_{n}\\right)\\). If \\(d>1\\) then replace the numbers \\(a_{1}, \\ldots, a_{n}\\) by \\(\\frac{a_{1}}{d}, \\ldots, \\frac{a_{n}}{d}\\); all arithmetic and all geometric means will be divided by \\(d\\), so we obtain another sequence satisfying the condition. Hence, without loss of generality, we can assume that \\(\\operatorname{gcd}\\left(a_{1} \\ldots, a_{n}\\right)=1\\).\n\nWe show two numbers, \\(a_{m}\\) and \\(a_{k}\\) such that their arithmetic mean, \\(\\frac{a_{m}+a_{k}}{2}\\) is different from the geometric mean of any (nonempty) subsequence of \\(a_{1} \\ldots, a_{n}\\). That proves that there cannot exist such a sequence.\n\nChoose the index \\(m \\in\\{1, \\ldots, n\\}\\) such that \\(a_{m}=\\max \\left(a_{1}, \\ldots, a_{n}\\right)\\). Note that \\(a_{m} \\geqslant 2\\), because \\(a_{1}, \\ldots, a_{n}\\) are not all equal. Let \\(p\\) be a prime divisor of \\(a_{m}\\).\n\nLet \\(k \\in\\{1, \\ldots, n\\}\\) be an index such that \\(a_{k}=\\max \\left\\{a_{i}: p \\nmid a_{i}\\right\\}\\). Due to \\(\\operatorname{gcd}\\left(a_{1} \\ldots, a_{n}\\right)=1\\), not all \\(a_{i}\\) are divisible by \\(p\\), so such a \\(k\\) exists. Note that \\(a_{m}>a_{k}\\) because \\(a_{m} \\geqslant a_{k}, p \\mid a_{m}\\) and \\(p \\nmid a_{k}\\).\n\nLet \\(b=\\frac{a_{m}+a_{k}}{2}\\); we will show that \\(b\\) cannot be the geometric mean of any subsequence of \\(a_{1}, \\ldots, a_{n}\\).\n\nConsider the geometric mean, \\(g=\\sqrt[t]{a_{i_{1}} \\cdot \\ldots \\cdot a_{i_{t}}}\\) of an arbitrary subsequence of \\(a_{1}, \\ldots, a_{n}\\).\nIf none of \\(a_{i_{1}}, \\ldots, a_{i_{t}}\\) is divisible by \\(p\\), then they are not greater than \\(a_{k}\\), so\n\\[\ng=\\sqrt[t]{a_{i_{1}} \\cdot \\ldots \\cdot a_{i_{t}}} \\leqslant a_{k}<\\frac{a_{m}+a_{k}}{2}=b,\n\\]\nand therefore \\(g \\neq b\\).\nOtherwise, if at least one of \\(a_{i_{1}}, \\ldots, a_{i_{t}}\\) is divisible by \\(p\\), then \\(2 g=2 \\sqrt[t]{a_{i_{1}} \\cdot \\ldots \\cdot a_{i_{t}}}\\) is either not an integer or is divisible by \\(p\\), while \\(2 b=a_{m}+a_{k}\\) is an integer not divisible by \\(p\\), so \\(g \\neq b\\) again.\n\nSolution 2. Like in the previous solution, we assume that the numbers \\(a_{1}, \\ldots, a_{n}\\) have no common divisor greater than 1 . The arithmetic mean of any two numbers in the sequence is half of an integer; on the other hand, it is a (some integer order) root of an integer. This means each pair's mean is an integer, so all terms in the sequence must be of the same parity; hence they all are odd. Let \\(d=\\min \\left\\{\\operatorname{gcd}\\left(a_{i}, a_{j}\\right): a_{i} \\neq a_{j}\\right\\}\\). By reordering the sequence we can assume that \\(\\operatorname{gcd}\\left(a_{1}, a_{2}\\right)=d\\), the sum \\(a_{1}+a_{2}\\) is maximal among such pairs, and \\(a_{1}>a_{2}\\).\n\nWe will show that \\(\\frac{a_{1}+a_{2}}{2}\\) cannot be the geometric mean of any subsequence of \\(a_{1} \\ldots, a_{n}\\).\nLet \\(a_{1}=x d\\) and \\(a_{2}=y d\\) where \\(x, y\\) are coprime, and suppose that there exist some \\(b_{1}, \\ldots, b_{t} \\in\\left\\{a_{1}, \\ldots, a_{n}\\right\\}\\) whose geometric mean is \\(\\frac{a_{1}+a_{2}}{2}\\). Let \\(d_{i}=\\operatorname{gcd}\\left(a_{1}, b_{i}\\right)\\) for \\(i=1,2, \\ldots, t\\) and let \\(D=d_{1} d_{2} \\cdot \\ldots \\cdot d_{t}\\). Then\n\\[\nD=d_{1} d_{2} \\cdot \\ldots \\cdot d_{t} \\left\\lvert\\, b_{1} b_{2} \\cdot \\ldots \\cdot b_{t}=\\left(\\frac{a_{1}+a_{2}}{2}\\right)^{t}=\\left(\\frac{x+y}{2}\\right)^{t} d^{t}\\right.\n\\]\n\nWe claim that \\(D \\mid d^{t}\\). Consider an arbitrary prime divisor \\(p\\) of \\(D\\). Let \\(\\nu_{p}(x)\\) denote the exponent of \\(p\\) in the prime factorization of \\(x\\). If \\(p \\left\\lvert\\, \\frac{x+y}{2}\\right.\\), then \\(p \\nmid x, y\\), so \\(p\\) is coprime with \\(x\\); hence, \\(\\nu_{p}\\left(d_{i}\\right) \\leqslant \\nu_{p}\\left(a_{1}\\right)=\\nu_{p}(x d)=\\nu_{p}(d)\\) for every \\(1 \\leqslant i \\leqslant t\\), therefore \\(\\nu_{p}(D)=\\sum_{i} \\nu_{p}\\left(d_{i}\\right) \\leqslant t \\nu_{p}(d)=\\nu_{p}\\left(d^{t}\\right)\\). Otherwise, if \\(p\\) is coprime to \\(\\frac{x+y}{2}\\), we have \\(\\nu_{p}(D) \\leqslant \\nu_{p}\\left(d^{t}\\right)\\) trivially. The claim has been proved.\n\nNotice that \\(d_{i}=\\operatorname{gcd}\\left(b_{i}, a_{1}\\right) \\geqslant d\\) for \\(1 \\leqslant i \\leqslant t\\) : if \\(b_{i} \\neq a_{1}\\) then this follows from the definition of \\(d\\); otherwise we have \\(b_{i}=a_{1}\\), so \\(d_{i}=a_{1} \\geqslant d\\). Hence, \\(D=d_{1} \\cdot \\ldots \\cdot d_{t} \\geqslant d^{t}\\), and the claim forces \\(d_{1}=\\ldots=d_{t}=d\\).\n\nFinally, by \\(\\frac{a_{1}+a_{2}}{2}>a_{2}\\) there must be some \\(b_{k}\\) which is greater than \\(a_{2}\\). From \\(a_{1}>a_{2} \\geqslant d=\\operatorname{gcd}\\left(a_{1}, b_{k}\\right)\\) it follows that \\(a_{1} \\neq b_{k}\\). Now the have a pair \\(a_{1}, b_{k}\\) such that \\(\\operatorname{gcd}\\left(a_{1}, b_{k}\\right)=d\\) but \\(a_{1}+b_{k}>a_{1}+a_{2}\\); that contradicts the choice of \\(a_{1}\\) and \\(a_{2}\\).\n\nComment. The original problem proposal contained a second question asking if there exists a nonconstant sequence \\(\\left(a_{1}, \\ldots, a_{n}\\right)\\) of positive integers such that the geometric mean of every two terms is equal the arithmetic mean of some terms.\n\nFor \\(n \\geqslant 3\\) such a sequence is \\((4,1,1, \\ldots, 1)\\). The case \\(n=2\\) can be done by the trivial estimates\n\\[\n\\min \\left(a_{1}, a_{2}\\right)<\\sqrt{a_{1} a_{2}}<\\frac{a_{1}+a_{2}}{2}<\\max \\left(a_{1}, a_{2}\\right) .\n\\]\n\nThe Problem Selection Committee found this variant less interesting and suggests using only the first question.", "source_pdf": "imosl_2020.pdf", "notes": "fallback-regex"}
{"id": "IMO-2021-2", "contest": "IMO", "year": "2021", "problem_number": "A4", "problem": "Show that for all real numbers \\(x_{1}, \\ldots, x_{n}\\) the following inequality holds:\n\\[\n\\sum_{i=1}^{n} \\sum_{j=1}^{n} \\sqrt{\\left|x_{i}-x_{j}\\right|} \\leqslant \\sum_{i=1}^{n} \\sum_{j=1}^{n} \\sqrt{\\left|x_{i}+x_{j}\\right|} .\n\\]", "solution": "1. If we add \\(t\\) to all the variables then the left-hand side remains constant and the right-hand side becomes\n\\[\nH(t):=\\sum_{i=1}^{n} \\sum_{j=1}^{n} \\sqrt{\\left|x_{i}+x_{j}+2 t\\right|} .\n\\]\n\nLet \\(T\\) be large enough such that both \\(H(-T)\\) and \\(H(T)\\) are larger than the value \\(L\\) of the lefthand side of the inequality we want to prove. Not necessarily distinct points \\(p_{i, j}:=-\\left(x_{i}+x_{j}\\right) / 2\\) together with \\(T\\) and \\(-T\\) split the real line into segments and two rays such that on each of these segments and rays the function \\(H(t)\\) is concave since \\(f(t):=\\sqrt{|\\ell+2 t|}\\) is concave on both intervals \\((-\\infty,-\\ell / 2]\\) and \\([-\\ell / 2,+\\infty)\\). Let \\([a, b]\\) be the segment containing zero. Then concavity implies \\(H(0) \\geqslant \\min \\{H(a), H(b)\\}\\) and, since \\(H( \\pm T)>L\\), it suffices to prove the inequalities \\(H\\left(-\\left(x_{i}+x_{j}\\right) / 2\\right) \\geqslant L\\), that is to prove the original inequality in the case when all numbers are shifted in such a way that two variables \\(x_{i}\\) and \\(x_{j}\\) add up to zero. In the following we denote the shifted variables still by \\(x_{i}\\).\n\nIf \\(i=j\\), i.e. \\(x_{i}=0\\) for some index \\(i\\), then we can remove \\(x_{i}\\) which will decrease both sides by \\(2 \\sum_{k} \\sqrt{\\left|x_{k}\\right|}\\). Similarly, if \\(x_{i}+x_{j}=0\\) for distinct \\(i\\) and \\(j\\) we can remove both \\(x_{i}\\) and \\(x_{j}\\) which decreases both sides by\n\\[\n2 \\sqrt{2\\left|x_{i}\\right|}+2 \\cdot \\sum_{k \\neq i, j}\\left(\\sqrt{\\left|x_{k}+x_{i}\\right|}+\\sqrt{\\left|x_{k}+x_{j}\\right|}\\right) .\n\\]\n\nIn either case we reduced our inequality to the case of smaller \\(n\\). It remains to note that for \\(n=0\\) and \\(n=1\\) the inequality is trivial.\n\nSolution 2. For real \\(p\\) consider the integral\n\\[\nI(p)=\\int_{0}^{\\infty} \\frac{1-\\cos (p x)}{x \\sqrt{x}} d x\n\\]\nwhich clearly converges to a strictly positive number. By changing the variable \\(y=|p| x\\) one notices that \\(I(p)=\\sqrt{|p|} I(1)\\). Hence, by using the trigonometric formula \\(\\cos (\\alpha-\\beta)-\\cos (\\alpha+ \\beta)=2 \\sin \\alpha \\sin \\beta\\) we obtain\n\\(\\sqrt{|a+b|}-\\sqrt{|a-b|}=\\frac{1}{I(1)} \\int_{0}^{\\infty} \\frac{\\cos ((a-b) x)-\\cos ((a+b) x)}{x \\sqrt{x}} d x=\\frac{1}{I(1)} \\int_{0}^{\\infty} \\frac{2 \\sin (a x) \\sin (b x)}{x \\sqrt{x}} d x\\),\nfrom which our inequality immediately follows:\n\\[\n\\sum_{i=1}^{n} \\sum_{j=1}^{n} \\sqrt{\\left|x_{i}+x_{j}\\right|}-\\sum_{i=1}^{n} \\sum_{j=1}^{n} \\sqrt{\\left|x_{i}-x_{j}\\right|}=\\frac{2}{I(1)} \\int_{0}^{\\infty} \\frac{\\left(\\sum_{i=1}^{n} \\sin \\left(x_{i} x\\right)\\right)^{2}}{x \\sqrt{x}} d x \\geqslant 0 .\n\\]\n\nComment 1. A more general inequality\n\\[\n\\sum_{i=1}^{n} \\sum_{j=1}^{n}\\left|x_{i}-x_{j}\\right|^{r} \\leqslant \\sum_{i=1}^{n} \\sum_{j=1}^{n}\\left|x_{i}+x_{j}\\right|^{r}\n\\]\nholds for any \\(r \\in[0,2]\\). The first solution can be repeated verbatim for any \\(r \\in[0,1]\\) but not for \\(r>1\\). In the second solution, by putting \\(x^{r+1}\\) in the denominator in place of \\(x \\sqrt{x}\\) we can prove the inequality for any \\(r \\in(0,2)\\) and the cases \\(r=0,2\\) are easy to check by hand.\n\nComment 2. In fact, the integral from Solution 2 can be computed explicitly, we have \\(I(1)=\\sqrt{2 \\pi}\\).", "source_pdf": "imosl_2021.pdf", "notes": "fallback-regex"}
{"id": "IMO-2021-6", "contest": "IMO", "year": "2021", "problem_number": "A6", "problem": "Let \\(A\\) be a finite set of (not necessarily positive) integers, and let \\(m \\geqslant 2\\) be an integer. Assume that there exist non-empty subsets \\(B_{1}, B_{2}, B_{3}, \\ldots, B_{m}\\) of \\(A\\) whose elements add up to the sums \\(m^{1}, m^{2}, m^{3}, \\ldots, m^{m}\\), respectively. Prove that \\(A\\) contains at least \\(m / 2\\) elements.", "solution": ". Let \\(A=\\left\\{a_{1}, \\ldots, a_{k}\\right\\}\\). Assume that, on the contrary, \\(k=|A|<m / 2\\). Let\n\\[\ns_{i}:=\\sum_{j: a_{j} \\in B_{i}} a_{j}\n\\]\nbe the sum of elements of \\(B_{i}\\). We are given that \\(s_{i}=m^{i}\\) for \\(i=1, \\ldots, m\\).\nNow consider all \\(m^{m}\\) expressions of the form\n\\[\nf\\left(c_{1}, \\ldots, c_{m}\\right):=c_{1} s_{1}+c_{2} s_{2}+\\ldots+c_{m} s_{m}, c_{i} \\in\\{0,1, \\ldots, m-1\\} \\text { for all } i=1,2, \\ldots, m .\n\\]\n\nNote that every number \\(f\\left(c_{1}, \\ldots, c_{m}\\right)\\) has the form\n\\[\n\\alpha_{1} a_{1}+\\ldots+\\alpha_{k} a_{k}, \\alpha_{i} \\in\\{0,1, \\ldots, m(m-1)\\} .\n\\]\n\nHence, there are at most \\((m(m-1)+1)^{k}<m^{2 k}<m^{m}\\) distinct values of our expressions; therefore, at least two of them coincide.\n\nSince \\(s_{i}=m^{i}\\), this contradicts the uniqueness of representation of positive integers in the base- \\(m\\) system.\n\nComment 1. For other rapidly increasing sequences of sums of \\(B_{i}\\) 's the similar argument also provides lower estimates on \\(k=|A|\\). For example, if the sums of \\(B_{i}\\) are equal to \\(1!, 2!, 3!, \\ldots, m!\\), then for any fixed \\(\\varepsilon>0\\) and large enough \\(m\\) we get \\(k \\geqslant(1 / 2-\\varepsilon) m\\). The proof uses the fact that the combinations \\(\\sum c_{i} i!\\) with \\(c_{i} \\in\\{0,1, \\ldots, i\\}\\) are all distinct.\n\nComment 2. The problem statement holds also if \\(A\\) is a set of real numbers (not necessarily integers), the above proofs work in the real case.", "source_pdf": "imosl_2021.pdf", "notes": "fallback-regex"}
{"id": "IMO-2021-5", "contest": "IMO", "year": "2021", "problem_number": "C3", "problem": "A thimblerigger has 2021 thimbles numbered from 1 through 2021. The thimbles are arranged in a circle in arbitrary order. The thimblerigger performs a sequence of 2021 moves; in the \\(k^{\\text {th }}\\) move, he swaps the positions of the two thimbles adjacent to thimble \\(k\\).\n\nProve that there exists a value of \\(k\\) such that, in the \\(k^{\\text {th }}\\) move, the thimblerigger swaps some thimbles \\(a\\) and \\(b\\) such that \\(a<k<b\\).", "solution": ". Assume the contrary. Say that the \\(k^{\\text {th }}\\) thimble is the central thimble of the \\(k^{\\text {th }}\\) move, and its position on that move is the central position of the move.\nStep 1: Black and white colouring.\nBefore the moves start, let us paint all thimbles in white. Then, after each move, we repaint its central thimble in black. This way, at the end of the process all thimbles have become black.\n\nBy our assumption, in every move \\(k\\), the two swapped thimbles have the same colour (as their numbers are either both larger or both smaller than \\(k\\) ). At every moment, assign the colours of the thimbles to their current positions; then the only position which changes its colour in a move is its central position. In particular, each position is central for exactly one move (when it is being repainted to black).\nStep 2: Red and green colouring.\nNow we introduce a colouring of the positions. If in the \\(k^{\\text {th }}\\) move, the numbers of the two swapped thimbles are both less than \\(k\\), then we paint the central position of the move in red; otherwise we paint that position in green. This way, each position has been painted in red or green exactly once. We claim that among any two adjacent positions, one becomes green and the other one becomes red; this will provide the desired contradiction since 2021 is odd.\n\nConsider two adjacent positions \\(A\\) and \\(B\\), which are central in the \\(a^{\\text {th }}\\) and in the \\(b^{\\text {th }}\\) moves, respectively, with \\(a<b\\). Then in the \\(a^{\\text {th }}\\) move the thimble at position \\(B\\) is white, and therefore has a number greater than \\(a\\). After the \\(a^{\\text {th }}\\) move, position \\(A\\) is green and the thimble at position \\(A\\) is black. By the arguments from Step 1, position \\(A\\) contains only black thimbles after the \\(a^{\\text {th }}\\) step. Therefore, on the \\(b^{\\text {th }}\\) move, position \\(A\\) contains a black thimble whose number is therefore less than \\(b\\), while thimble \\(b\\) is at position \\(B\\). So position \\(B\\) becomes red, and hence \\(A\\) and \\(B\\) have different colours.\n\nComment 1. Essentially, Step 1 provides the proof of the following two assertions (under the indirect assumption):\n(1) Each position \\(P\\) becomes central in exactly one move (denote that move's number by \\(k\\) ); and\n(2) Before the \\(k^{\\text {th }}\\) move, position \\(P\\) always contains a thimble whose number is larger than the number of the current move, while after the \\(k^{\\text {th }}\\) move the position always contains a thimble whose number is smaller than the number of the current move.\n\nBoth (1) and (2) can be proved without introduction of colours, yet the colours help to visualise the argument.\n\nAfter these two assertions have been proved, Step 2 can be performed in various ways, e.g., as follows.\n\nAt any moment in the process, the black positions are split into several groups consisting of one or more contiguous black positions each; different groups are separated by white positions. Now one can prove by induction on \\(k\\) that, after the \\(k^{\\text {th }}\\) move, all groups have odd sizes. Indeed, in every move, the new black position either forms a separate group, or merges two groups (say, of lengths \\(a\\) and \\(b\\) ) into a single group of length \\(a+b+1\\).\n\nHowever, after the \\(2020^{\\text {th }}\\) move the black positions should form one group of length 2020. This is a contradiction.\n\nThis argument has several variations; e.g., one can check in a similar way that, after the process starts, at least one among the groups of white positions has an even size.\n\nComment 2. The solution above works equally well for any odd number of thimbles greater than 1 , instead of 2021. On the other hand, a similar statement with an even number \\(n=2 k \\geqslant 4\\) of thimbles is wrong. To show that, the thimblerigger can enumerate positions from 1 through \\(n\\) clockwise, and then put thimbles \\(1,2, \\ldots, k\\) at the odd positions, and thimbles \\(k+1, k+2, \\ldots, 2 k\\) at the even positions.", "source_pdf": "imosl_2021.pdf", "notes": "fallback-regex"}
{"id": "IMO-2021-4", "contest": "IMO", "year": "2021", "problem_number": "G2", "problem": "Let \\(A B C D\\) be a convex quadrilateral circumscribed around a circle with centre \\(I\\). Let \\(\\omega\\) be the circumcircle of the triangle \\(A C I\\). The extensions of \\(B A\\) and \\(B C\\) beyond \\(A\\) and \\(C\\) meet \\(\\omega\\) at \\(X\\) and \\(Z\\), respectively. The extensions of \\(A D\\) and \\(C D\\) beyond \\(D\\) meet \\(\\omega\\) at \\(Y\\) and \\(T\\), respectively. Prove that the perimeters of the (possibly self-intersecting) quadrilaterals \\(A D T X\\) and \\(C D Y Z\\) are equal.", "solution": ". The point \\(I\\) is the intersection of the external bisector of the angle \\(T C Z\\) with the circumcircle \\(\\omega\\) of the triangle \\(T C Z\\), so \\(I\\) is the midpoint of the arc \\(T C Z\\) and \\(I T=I Z\\). Similarly, \\(I\\) is the midpoint of the arc \\(Y A X\\) and \\(I X=I Y\\). Let \\(O\\) be the centre of \\(\\omega\\). Then \\(X\\) and \\(T\\) are the reflections of \\(Y\\) and \\(Z\\) in \\(I O\\), respectively. So \\(X T=Y Z\\).\n![](https://cdn.mathpix.com/cropped/2025_08_23_53f86fa89253df1f58beg-44.jpg?height=912&width=943&top_left_y=736&top_left_x=559)\n\nLet the incircle of \\(A B C D\\) touch \\(A B, B C, C D\\), and \\(D A\\) at points \\(P, Q, R\\), and \\(S\\), respectively.\n\nThe right triangles \\(I X P\\) and \\(I Y S\\) are congruent, since \\(I P=I S\\) and \\(I X=I Y\\). Similarly, the right triangles \\(I R T\\) and \\(I Q Z\\) are congruent. Therefore, \\(X P=Y S\\) and \\(R T=Q Z\\).\n\nDenote the perimeters of \\(A D T X\\) and \\(C D Y Z\\) by \\(P_{A D T X}\\) and \\(P_{C D Y Z}\\) respectively. Since \\(A S=A P, C Q=R C\\), and \\(S D=D R\\), we obtain\n\\[\n\\begin{aligned}\nP_{A D T X}=X T+X A+A S+ & S D+D T=X T+X P+R T \\\\\n& =Y Z+Y S+Q Z=Y Z+Y D+D R+R C+C Z=P_{C D Y Z}\n\\end{aligned}\n\\]\nas required.\nComment 1. After proving that \\(X\\) and \\(T\\) are the reflections of \\(Y\\) and \\(Z\\) in \\(I O\\), respectively, one can finish the solution as follows. Since \\(X T=Y Z\\), the problem statement is equivalent to\n\\[\nX A+A D+D T=Y D+D C+C Z .\n\\]\n\nSince \\(A B C D\\) is circumscribed, \\(A B-A D=B C-C D\\). Adding this to (1), we come to an equivalent equality \\(X A+A B+D T=Y D+B C+C Z\\), or\n\\[\nX B+D T=Y D+B Z .\n\\]\n\nLet \\(\\lambda=\\frac{X Z}{A C}=\\frac{T Y}{A C}\\). Since \\(X A C Z\\) is cyclic, the triangles \\(Z B X\\) and \\(A B C\\) are similar, hence\n\\[\n\\frac{X B}{B C}=\\frac{B Z}{A B}=\\frac{X Z}{A C}=\\lambda .\n\\]\n\nIt follows that \\(X B=\\lambda B C\\) and \\(B Z=\\lambda A B\\). Likewise, the triangles \\(T D Y\\) and \\(A D C\\) are similar, hence\n\\[\n\\frac{D T}{A D}=\\frac{D Y}{C D}=\\frac{T Y}{A C}=\\lambda\n\\]\n\nTherefore, (2) rewrites as \\(\\lambda B C+\\lambda A D=\\lambda C D+\\lambda A B\\).\nThis is equivalent to \\(B C+A D=C D+A B\\) which is true as \\(A B C D\\) is circumscribed.\nComment 2. Here is a more difficult modification of the original problem, found by the PSC.\nLet \\(A B C D\\) be a convex quadrilateral circumscribed around a circle with centre \\(I\\). Let \\(\\omega\\) be the circumcircle of the triangle \\(A C I\\). The extensions of \\(B A\\) and \\(B C\\) beyond \\(A\\) and \\(C\\) meet \\(\\omega\\) at \\(X\\) and \\(Z\\), respectively. The extensions of \\(A D\\) and \\(C D\\) beyond \\(D\\) meet \\(\\omega\\) at \\(Y\\) and \\(T\\), respectively. Let \\(U=B C \\cap A D\\) and \\(V=B A \\cap C D\\). Let \\(I_{U}\\) be the incentre of \\(U Y Z\\) and let \\(J_{V}\\) be the \\(V\\)-excentre of \\(V X T\\). Then \\(I_{U} J_{V} \\perp B D\\).\n\n\\section*{G3.}\n\nVersion 1. Let \\(n\\) be a fixed positive integer, and let S be the set of points ( \\(x, y\\) ) on the Cartesian plane such that both coordinates \\(x\\) and \\(y\\) are nonnegative integers smaller than \\(2 n\\) (thus \\(|\\mathrm{S}|=4 n^{2}\\) ). Assume that \\(\\mathcal{F}\\) is a set consisting of \\(n^{2}\\) quadrilaterals such that all their vertices lie in S , and each point in S is a vertex of exactly one of the quadrilaterals in \\(\\mathcal{F}\\).\n\nDetermine the largest possible sum of areas of all \\(n^{2}\\) quadrilaterals in \\(\\mathcal{F}\\).\nVersion 2. Let \\(n\\) be a fixed positive integer, and let S be the set of points ( \\(x, y\\) ) on the Cartesian plane such that both coordinates \\(x\\) and \\(y\\) are nonnegative integers smaller than \\(2 n\\) (thus \\(|\\mathrm{S}|=4 n^{2}\\) ). Assume that \\(\\mathcal{F}\\) is a set of polygons such that all vertices of polygons in \\(\\mathcal{F}\\) lie in S , and each point in S is a vertex of exactly one of the polygons in \\(\\mathcal{F}\\).\n\nDetermine the largest possible sum of areas of all polygons in \\(\\mathcal{F}\\).\nAnswer for both Versions: The largest possible sum of areas is \\(\\Sigma(n):=\\frac{1}{3} n^{2}(2 n+1)(2 n-1)\\).\nCommon remarks. Throughout all solutions, the area of a polygon \\(P\\) will be denoted by \\([P]\\).\nWe say that a polygon is legal if all its vertices belong to S . Let \\(O=\\left(n-\\frac{1}{2}, n-\\frac{1}{2}\\right)\\) be the centre of S . We say that a legal square is central if its centre is situated at \\(O\\). Finally, say that a set \\(\\mathcal{F}\\) of polygons is acceptable if it satisfies the problem requirements, i.e. if all polygons in \\(\\mathcal{F}\\) are legal, and each point in S is a vertex of exactly one polygon in \\(\\mathcal{F}\\). For an acceptable set \\(\\mathcal{F}\\), we denote by \\(\\Sigma(\\mathcal{F})\\) the sum of areas of polygons in \\(\\mathcal{F}\\).\n\nSolution 1, for both Versions. Each point in S is a vertex of a unique central square. Thus the set \\(\\mathcal{G}\\) of central squares is acceptable. We will show that\n\\[\n\\Sigma(\\mathcal{F}) \\leqslant \\Sigma(\\mathcal{G})=\\Sigma(n),\n\\]\nthus establishing the answer.\nWe will use the following key lemma.\nLemma 1. Let \\(P=A_{1} A_{2} \\ldots A_{m}\\) be a polygon, and let \\(O\\) be an arbitrary point in the plane. Then\n\\[\n[P] \\leqslant \\frac{1}{2} \\sum_{i=1}^{m} O A_{i}^{2} ;\n\\]\nmoreover, if \\(P\\) is a square centred at \\(O\\), then the inequality (2) turns into an equality.\nProof. Put \\(A_{n+1}=A_{1}\\). For each \\(i=1,2, \\ldots, m\\), we have\n\\[\n\\left[O A_{i} A_{i+1}\\right] \\leqslant \\frac{O A_{i} \\cdot O A_{i+1}}{2} \\leqslant \\frac{O A_{i}^{2}+O A_{i+1}^{2}}{4} .\n\\]\n\nTherefore,\n\\[\n[P] \\leqslant \\sum_{i=1}^{m}\\left[O A_{i} A_{i+1}\\right] \\leqslant \\frac{1}{4} \\sum_{i=1}^{m}\\left(O A_{i}^{2}+O A_{i+1}^{2}\\right)=\\frac{1}{2} \\sum_{i=1}^{m} O A_{i}^{2},\n\\]\nwhich proves (2). Finally, all the above inequalities turn into equalities when \\(P\\) is a square centred at \\(O\\).\n\nBack to the problem, consider an arbitrary acceptable set \\(\\mathcal{F}\\). Applying Lemma 1 to each element in \\(\\mathcal{F}\\) and to each element in \\(\\mathcal{G}\\) (achieving equality in the latter case), we obtain\n\\[\n\\Sigma(\\mathcal{F}) \\leqslant \\frac{1}{2} \\sum_{A \\in \\mathrm{~S}} O A^{2}=\\Sigma(\\mathcal{G}),\n\\]\nwhich establishes the left inequality in (1).\n\nIt remains to compute \\(\\Sigma(\\mathcal{G})\\). We have\n\\[\n\\begin{aligned}\n\\Sigma(\\mathcal{G})= & \\frac{1}{2} \\sum_{A \\in S} O A^{2}=\\frac{1}{2} \\sum_{i=0}^{2 n-1} \\sum_{j=0}^{2 n-1}\\left(\\left(n-\\frac{1}{2}-i\\right)^{2}+\\left(n-\\frac{1}{2}-j\\right)^{2}\\right) \\\\\n& =\\frac{1}{8} \\cdot 4 \\cdot 2 n \\sum_{i=0}^{n-1}(2 n-2 i-1)^{2}=n \\sum_{j=0}^{n-1}(2 j+1)^{2}=n\\left(\\sum_{j=1}^{2 n} j^{2}-\\sum_{j=1}^{n}(2 j)^{2}\\right) \\\\\n& =n\\left(\\frac{2 n(2 n+1)(4 n+1)}{6}-4 \\cdot \\frac{n(n+1)(2 n+1)}{6}\\right)=\\frac{n^{2}(2 n+1)(2 n-1)}{3}=\\Sigma(n) .\n\\end{aligned}\n\\]\n\nComment. There are several variations of the above solution, also working for both versions of the problem. E.g., one may implement only the inequality \\(\\left[O A_{i} A_{i+1}\\right] \\leqslant \\frac{1}{2} O A_{i} \\cdot O A_{i+1}\\) to obtain\n\\[\n\\Sigma(\\mathcal{F}) \\leqslant \\frac{1}{2} \\sum_{i=1}^{4 n^{2}} O K_{i} \\cdot O L_{i}\n\\]\nwhere both \\(\\left(K_{i}\\right)\\) and \\(\\left(L_{i}\\right)\\) are permutations of all points in S . The right hand side can then be bounded from above by means of the rearrangement inequality; the bound is also achieved on the collection \\(\\mathcal{G}\\).\n\nHowever, Version 2 seems to be more difficult than Version 1. First of all, the optimal model for this version is much less easy to guess, until one finds an idea for proving the upper bound. Moreover, Version 1 allows different solutions which do not seem to be generalized easily - such as Solution 2 below.\n\nSolution 2, for Version 1. Let \\(\\mathcal{F}\\) be an accessible set of quadrilaterals. For every quadrilateral \\(A B C D\\) in \\(\\mathcal{F}\\) write\n\\[\n[A B C D]=\\frac{A C \\cdot B D}{2} \\sin \\phi \\leqslant \\frac{A C^{2}+B D^{2}}{4},\n\\]\nwhere \\(\\phi\\) is the angle between \\(A C\\) and \\(B D\\). Applying this estimate to all members in \\(\\mathcal{F}\\) we obtain\n\\[\n\\Sigma(\\mathcal{F}) \\leqslant \\frac{1}{4} \\sum_{i=1}^{2 n^{2}} A_{i} B_{i}^{2}\n\\]\nwhere \\(A_{1}, A_{2}, \\ldots, A_{2 n^{2}}, B_{1}, B_{2}, \\ldots, B_{2 n^{2}}\\) is some permutation of \\(S\\). For brevity, denote\n\\[\nf\\left(\\left(A_{i}\\right),\\left(B_{i}\\right)\\right):=\\sum_{i=1}^{2 n^{2}} A_{i} B_{i}^{2}\n\\]\n\nThe rest of the solution is based on the following lemma.\nLemma 2. The maximal value of \\(f\\left(\\left(A_{i}\\right),\\left(B_{i}\\right)\\right)\\) over all permutations of S equals \\(\\frac{4}{3} n^{2}\\left(4 n^{2}-1\\right)\\) and is achieved when \\(A_{i}\\) is symmetric to \\(B_{i}\\) with respect to \\(O\\), for every \\(i=1,2, \\ldots, 2 n^{2}\\).\nProof. Let \\(A_{i}=\\left(p_{i}, q_{i}\\right)\\) and \\(B_{i}=\\left(r_{i}, s_{i}\\right)\\), for \\(i=1,2, \\ldots, 2 n^{2}\\). We have\n\\[\nf\\left(\\left(A_{i}\\right),\\left(B_{i}\\right)\\right)=\\sum_{i=1}^{2 n^{2}}\\left(p_{i}-r_{i}\\right)^{2}+\\sum_{i=1}^{2 n^{2}}\\left(q_{i}-s_{i}\\right)^{2} ;\n\\]\nit suffices to bound the first sum, the second is bounded similarly. This can be done, e.g., by means of the QM-AM inequality as follows:\n\\[\n\\begin{aligned}\n& \\sum_{i=1}^{2 n^{2}}\\left(p_{i}-r_{i}\\right)^{2}=\\sum_{i=1}^{2 n^{2}}\\left(2 p_{i}^{2}+2 r_{i}^{2}-\\left(p_{i}+r_{i}\\right)^{2}\\right)=4 n \\sum_{j=0}^{2 n-1} j^{2}-\\sum_{i=1}^{2 n^{2}}\\left(p_{i}+r_{i}\\right)^{2} \\\\\n& \\leqslant 4 n \\sum_{j=0}^{2 n-1} j^{2}-\\frac{1}{2 n^{2}}\\left(\\sum_{i=1}^{2 n^{2}}\\left(p_{i}+r_{i}\\right)\\right)^{2}=4 n \\sum_{j=0}^{2 n-1} j^{2}-\\frac{1}{2 n^{2}}\\left(2 n \\cdot \\sum_{j=0}^{2 n-1} j\\right)^{2} \\\\\n& \\quad=4 n \\cdot \\frac{2 n(2 n-1)(4 n-1)}{6}-2 n^{2}(2 n-1)^{2}=\\frac{2 n^{2}(2 n-1)(2 n+1)}{3}\n\\end{aligned}\n\\]\n\nAll the estimates are sharp if \\(p_{i}+r_{i}=2 n-1\\) for all \\(i\\). Thus,\n\\[\nf\\left(\\left(A_{i}\\right),\\left(B_{i}\\right)\\right) \\leqslant \\frac{4 n^{2}\\left(4 n^{2}-1\\right)}{3}\n\\]\nand the estimate is sharp when \\(p_{i}+r_{i}=q_{i}+s_{i}=2 n-1\\) for all \\(i\\), i.e. when \\(A_{i}\\) and \\(B_{i}\\) are symmetric with respect to \\(O\\).\n\nLemma 2 yields\n\\[\n\\Sigma(\\mathcal{F}) \\leqslant \\frac{1}{4} \\cdot \\frac{4 n^{2}\\left(4 n^{2}-1\\right)}{3}=\\frac{n^{2}(2 n-1)(2 n+1)}{3}\n\\]\n\nFinally, all estimates are achieved simultaneously on the set \\(\\mathcal{G}\\) of central squares.\nComment 2. Lemma 2 also allows different proofs. E.g., one may optimize the sum \\(\\sum_{i} p_{i} r_{i}\\) step by step: if \\(p_{i}<p_{j}\\) and \\(r_{i}<r_{j}\\), then a swap \\(r_{i} \\leftrightarrow r_{j}\\) increases the sum. By applying a proper chain of such replacements (possibly swapping elements in some pairs \\(\\left(p_{i}, r_{i}\\right)\\) ), one eventually comes to a permutation where \\(p_{i}+r_{i}=2 n-1\\) for all \\(i\\).\n\nComment 3. Version 2 can also be considered for a square grid with odd number \\(n\\) of points on each side. If we allow a polygon consisting of one point, then Solution 1 is applied verbatim, providing an answer \\(\\frac{1}{12} n^{2}\\left(n^{2}-1\\right)\\). If such polygons are not allowed, then one needs to subtract \\(\\frac{1}{2}\\) from the answer.", "source_pdf": "imosl_2021.pdf", "notes": "fallback-regex"}
{"id": "IMO-2021-3", "contest": "IMO", "year": "2021", "problem_number": "G7", "problem": "A point \\(D\\) is chosen inside an acute-angled triangle \\(A B C\\) with \\(A B>A C\\) so that \\(\\angle B A D=\\angle D A C\\). A point \\(E\\) is constructed on the segment \\(A C\\) so that \\(\\angle A D E=\\angle D C B\\). Similarly, a point \\(F\\) is constructed on the segment \\(A B\\) so that \\(\\angle A D F=\\angle D B C\\). A point \\(X\\) is chosen on the line \\(A C\\) so that \\(C X=B X\\). Let \\(O_{1}\\) and \\(O_{2}\\) be the circumcentres of the triangles \\(A D C\\) and \\(D X E\\). Prove that the lines \\(B C, E F\\), and \\(O_{1} O_{2}\\) are concurrent.", "solution": "Common remarks. Let \\(Q\\) be the isogonal conjugate of \\(D\\) with respect to the triangle \\(A B C\\). Since \\(\\angle B A D=\\angle D A C\\), the point \\(Q\\) lies on \\(A D\\). Then \\(\\angle Q B A=\\angle D B C=\\angle F D A\\), so the points \\(Q, D, F\\), and \\(B\\) are concyclic. Analogously, the points \\(Q, D, E\\), and \\(C\\) are concyclic. Thus \\(A F \\cdot A B=A D \\cdot A Q=A E \\cdot A C\\) and so the points \\(B, F, E\\), and \\(C\\) are also concyclic.\n![](https://cdn.mathpix.com/cropped/2025_08_23_53f86fa89253df1f58beg-60.jpg?height=470&width=1197&top_left_y=736&top_left_x=434)\n\nLet \\(T\\) be the intersection of \\(B C\\) and \\(F E\\).\nClaim. \\(T D^{2}=T B \\cdot T C=T F \\cdot T E\\).\nProof. We will prove that the circles ( \\(D E F\\) ) and ( \\(B D C\\) ) are tangent to each other. Indeed, using the above arguments, we get\n\\[\n\\begin{gathered}\n\\angle B D F=\\angle A F D-\\angle A B D=\\left(180^{\\circ}-\\angle F A D-\\angle F D A\\right)-(\\angle A B C-\\angle D B C) \\\\\n=180^{\\circ}-\\angle F A D-\\angle A B C=180^{\\circ}-\\angle D A E-\\angle F E A=\\angle F E D+\\angle A D E=\\angle F E D+\\angle D C B,\n\\end{gathered}\n\\]\nwhich implies the desired tangency.\nSince the points \\(B, C, E\\), and \\(F\\) are concyclic, the powers of the point \\(T\\) with respect to the circles ( \\(B D C\\) ) and ( \\(E D F\\) ) are equal. So their radical axis, which coincides with the common tangent at \\(D\\), passes through \\(T\\), and hence \\(T D^{2}=T E \\cdot T F=T B \\cdot T C\\).\n\n1. Let \\(T A\\) intersect the circle ( \\(A B C\\) ) again at \\(M\\). Due to the circles ( \\(B C E F\\) ) and \\((A M C B)\\), and using the above Claim, we get \\(T M \\cdot T A=T F \\cdot T E=T B \\cdot T C=T D^{2}\\); in particular, the points \\(A, M, E\\), and \\(F\\) are concyclic.\n\nUnder the inversion with centre \\(T\\) and radius \\(T D\\), the point \\(M\\) maps to \\(A\\), and \\(B\\) maps to \\(C\\), which implies that the circle ( \\(M B D\\) ) maps to the circle ( \\(A D C\\) ). Their common point \\(D\\) lies on the circle of the inversion, so the second intersection point \\(K\\) also lies on that circle, which means \\(T K=T D\\). It follows that the point \\(T\\) and the centres of the circles ( \\(K D E\\) ) and \\((A D C)\\) lie on the perpendicular bisector of \\(K D\\).\n\nSince the center of \\((A D C)\\) is \\(O_{1}\\), it suffices to show now that the points \\(D, K, E\\) and \\(X\\) are concyclic (the center of the corresponding circle will be \\(O_{2}\\) ).\n\nThe lines \\(B M, D K\\), and \\(A C\\) are the pairwise radical axes of the circles ( \\(A B C M\\) ), ( \\(A C D K\\) ) and ( \\(B M D K\\) ), so they are concurrent at some point \\(P\\). Also, \\(M\\) lies on the circle ( \\(A E F\\) ), thus\n\\[\n\\begin{aligned}\n\\Varangle(E X, X B) & =\\Varangle(C X, X B)=\\Varangle(X C, B C)+\\Varangle(B C, B X)=2 \\Varangle(A C, C B) \\\\\n& =\\Varangle(A C, C B)+\\Varangle(E F, F A)=\\Varangle(A M, B M)+\\Varangle(E M, M A)=\\Varangle(E M, B M),\n\\end{aligned}\n\\]\nso the points \\(M, E, X\\), and \\(B\\) are concyclic. Therefore, \\(P E \\cdot P X=P M \\cdot P B=P K \\cdot P D\\), so the points \\(E, K, D\\), and \\(X\\) are concyclic, as desired.\n![](https://cdn.mathpix.com/cropped/2025_08_23_53f86fa89253df1f58beg-61.jpg?height=926&width=1457&top_left_y=205&top_left_x=308)\n\nComment 1. We present here a different solution which uses similar ideas.\nPerform the inversion \\(\\iota\\) with centre \\(T\\) and radius \\(T D\\). It swaps \\(B\\) with \\(C\\) and \\(E\\) with \\(F\\); the point \\(D\\) maps to itself. Let \\(X^{\\prime}=\\iota(X)\\). Observe that the points \\(E, F, X\\), and \\(X^{\\prime}\\) are concyclic, as well as the points \\(B, C, X\\), and \\(X^{\\prime}\\). Then\n\\[\n\\begin{aligned}\n\\Varangle\\left(C X^{\\prime}, X^{\\prime} F\\right)=\\Varangle\\left(C X^{\\prime},\\right. & \\left.X^{\\prime} X\\right)+\\Varangle\\left(X^{\\prime} X, X^{\\prime} F\\right)=\\Varangle(C B, B X)+\\Varangle(E X, E F) \\\\\n& =\\Varangle(X C, C B)+\\Varangle(E C, E F)=\\Varangle(C A, C B)+\\Varangle(B C, B F)=\\Varangle(C A, A F),\n\\end{aligned}\n\\]\ntherefore the points \\(C, X^{\\prime}, A\\), and \\(F\\) are concyclic.\nLet \\(X^{\\prime} F\\) intersect \\(A C\\) at \\(P\\), and let \\(K\\) be the second common point of \\(D P\\) and the circle ( \\(A C D\\) ). Then\n\\[\nP K \\cdot P D=P A \\cdot P C=P X^{\\prime} \\cdot P F=P E \\cdot P X\n\\]\nhence, the points \\(K, X, D\\), and \\(E\\) lie on some circle \\(\\omega_{1}\\), while the points \\(K, X^{\\prime}, D\\), and \\(F\\) lie on some circle \\(\\omega_{2}\\). (These circles are distinct since \\(\\angle E X F+\\angle E D F<\\angle E A F+\\angle D C B+\\angle D B C<180^{\\circ}\\) ). The inversion \\(\\iota\\) swaps \\(\\omega_{1}\\) with \\(\\omega_{2}\\) and fixes their common point \\(D\\), so it fixes their second common point \\(K\\). Thus \\(T D=T K\\) and the perpendicular bisector of \\(D K\\) passes through \\(T\\), as well as through the centres of the circles ( \\(C D K A\\) ) and ( \\(D E K X\\) ).\n![](https://cdn.mathpix.com/cropped/2025_08_23_53f86fa89253df1f58beg-61.jpg?height=755&width=1149&top_left_y=2004&top_left_x=459)\n\nSolution 2. We use only the first part of the Common remarks, namely, the facts that the tuples ( \\(C, D, Q, E\\) ) and ( \\(B, C, E, F\\) ) are both concyclic. We also introduce the point \\(T= B C \\cap E F\\). Let the circle ( \\(C D E\\) ) meet \\(B C\\) again at \\(E_{1}\\). Since \\(\\angle E_{1} C Q=\\angle D C E\\), the arcs \\(D E\\) and \\(Q E_{1}\\) of the circle ( \\(C D Q\\) ) are equal, so \\(D Q \\| E E_{1}\\).\n\nSince \\(B F E C\\) is cyclic, the line \\(A D\\) forms equal angles with \\(B C\\) and \\(E F\\), hence so does \\(E E_{1}\\). Therefore, the triangle \\(E E_{1} T\\) is isosceles, \\(T E=T E_{1}\\), and \\(T\\) lies on the common perpendicular bisector of \\(E E_{1}\\) and \\(D Q\\).\n\nLet \\(U\\) and \\(V\\) be the centres of circles ( \\(A D E\\) ) and ( \\(C D Q E\\) ), respectively. Then \\(U O_{1}\\) is the perpendicular bisector of \\(A D\\). Moreover, the points \\(U, V\\), and \\(O_{2}\\) belong to the perpendicular bisector of \\(D E\\). Since \\(U O_{1} \\| V T\\), in order to show that \\(O_{1} O_{2}\\) passes through \\(T\\), it suffices to show that\n\\[\n\\frac{O_{2} U}{O_{2} V}=\\frac{O_{1} U}{T V} .\n\\]\n\nDenote angles \\(A, B\\), and \\(C\\) of the triangle \\(A B C\\) by \\(\\alpha, \\beta\\), and \\(\\gamma\\), respectively. Projecting onto \\(A C\\) we obtain\n\\[\n\\frac{O_{2} U}{O_{2} V}=\\frac{(X E-A E) / 2}{(X E+E C) / 2}=\\frac{A X}{C X}=\\frac{A X}{B X}=\\frac{\\sin (\\gamma-\\beta)}{\\sin \\alpha}\n\\]\n\nThe projection of \\(O_{1} U\\) onto \\(A C\\) is \\((A C-A E) / 2=C E / 2\\); the angle between \\(O_{1} U\\) and \\(A C\\) is \\(90^{\\circ}-\\alpha / 2\\), so\n\\[\n\\frac{O_{1} U}{E C}=\\frac{1}{2 \\sin (\\alpha / 2)}\n\\]\n\nNext, we claim that \\(E, V, C\\), and \\(T\\) are concyclic. Indeed, the point \\(V\\) lies on the perpendicular bisector of \\(C E\\), as well as on the internal angle bisector of \\(\\angle C T F\\). Therefore, \\(V\\) coincides with the midpoint of the arc \\(C E\\) of the circle ( \\(T C E\\) ).\n\nNow we have \\(\\angle E V C=2 \\angle E E_{1} C=180^{\\circ}-(\\gamma-\\beta)\\) and \\(\\angle V E T=\\angle V E_{1} T=90^{\\circ}-\\angle E_{1} E C= 90^{\\circ}-\\alpha / 2\\). Therefore,\n\\[\n\\frac{E C}{T V}=\\frac{\\sin \\angle E T C}{\\sin \\angle V E T}=\\frac{\\sin (\\gamma-\\beta)}{\\cos (\\alpha / 2)} .\n\\]\n![](https://cdn.mathpix.com/cropped/2025_08_23_53f86fa89253df1f58beg-62.jpg?height=986&width=1523&top_left_y=1773&top_left_x=274)\n\nRecalling (2) and multiplying (3) and (4) we establish (1):\n\\[\n\\frac{O_{2} U}{O_{2} V}=\\frac{\\sin (\\gamma-\\beta)}{\\sin \\alpha}=\\frac{1}{2 \\sin (\\alpha / 2)} \\cdot \\frac{\\sin (\\gamma-\\beta)}{\\cos (\\alpha / 2)}=\\frac{O_{1} U}{E C} \\cdot \\frac{E C}{T V}=\\frac{O_{1} U}{T V} .\n\\]\n\nSolution 3. Notice that \\(\\angle A Q E=\\angle Q C B\\) and \\(\\angle A Q F=\\angle Q B C\\); so, if we replace the point \\(D\\) with \\(Q\\) in the problem set up, the points \\(E, F\\), and \\(T\\) remain the same. So, by the Claim, we have \\(T Q^{2}=T B \\cdot T C=T D^{2}\\).\n\nThus, there exists a circle \\(\\Gamma\\) centred at \\(T\\) and passing through \\(D\\) and \\(Q\\). We denote the second meeting point of the circles \\(\\Gamma\\) and \\((A D C)\\) by \\(K\\). Let the line \\(A C\\) meet the circle \\((D E K)\\) again at \\(Y\\); we intend to prove that \\(Y=X\\). As in Solution 1, this will yield that the point \\(T\\), as well as the centres \\(O_{1}\\) and \\(O_{2}\\), all lie on the perpendicular bisector of \\(D K\\).\n\nLet \\(L=A D \\cap B C\\). We perform an inversion centred at \\(C\\); the images of the points will be denoted by primes, e.g., \\(A^{\\prime}\\) is the image of \\(A\\). We obtain the following configuration, constructed in a triangle \\(A^{\\prime} C L^{\\prime}\\).\n\nThe points \\(D^{\\prime}\\) and \\(Q^{\\prime}\\) are chosen on the circumcircle \\(\\Omega\\) of \\(A^{\\prime} L^{\\prime} C\\) such that \\(\\Varangle\\left(L^{\\prime} C, D^{\\prime} C\\right)= \\Varangle\\left(Q^{\\prime} C, A^{\\prime} C\\right)\\), which means that \\(A^{\\prime} L^{\\prime} \\| D^{\\prime} Q^{\\prime}\\). The lines \\(D^{\\prime} Q^{\\prime}\\) and \\(A^{\\prime} C\\) meet at \\(E^{\\prime}\\).\n\nA circle \\(\\Gamma^{\\prime}\\) centred on \\(C L^{\\prime}\\) passes through \\(D^{\\prime}\\) and \\(Q^{\\prime}\\). Notice here that \\(B^{\\prime}\\) lies on the segment \\(C L^{\\prime}\\), and that \\(\\angle A^{\\prime} B^{\\prime} C=\\angle B A C=2 \\angle L A C=2 \\angle A^{\\prime} L^{\\prime} C\\), so that \\(B^{\\prime} L^{\\prime}=B^{\\prime} A^{\\prime}\\), and \\(B^{\\prime}\\) lies on the perpendicular bisector of \\(A^{\\prime} L^{\\prime}\\) (which coincides with that of \\(D^{\\prime} Q^{\\prime}\\) ). All this means that \\(B^{\\prime}\\) is the centre of \\(\\Gamma^{\\prime}\\).\n\nFinally, \\(K^{\\prime}\\) is the second meeting point of \\(A^{\\prime} D^{\\prime}\\) and \\(\\Gamma^{\\prime}\\), and \\(Y^{\\prime}\\) is the second meeting point of the circle ( \\(D^{\\prime} K^{\\prime} E^{\\prime}\\) ) and the line \\(A^{\\prime} E^{\\prime}\\), We have \\(\\Varangle\\left(Y^{\\prime} K^{\\prime}, K^{\\prime} A^{\\prime}\\right)=\\Varangle\\left(Y^{\\prime} E^{\\prime}, E^{\\prime} D^{\\prime}\\right)= \\Varangle\\left(Y^{\\prime} A^{\\prime}, A^{\\prime} L^{\\prime}\\right)\\), so \\(A^{\\prime} L^{\\prime}\\) is tangent to the circumcircle \\(\\omega\\) of the triangle \\(Y^{\\prime} A^{\\prime} K^{\\prime}\\).\n\nLet \\(O\\) and \\(O^{*}\\) be the centres of \\(\\Omega\\) and \\(\\omega\\), respectively. Then \\(O^{*} A^{\\prime} \\perp A^{\\prime} L^{\\prime} \\perp B^{\\prime} O\\). The projections of vectors \\(\\overrightarrow{O^{*} A^{\\prime}}\\) and \\(\\overrightarrow{B^{\\prime} O}\\) onto \\(K^{\\prime} D^{\\prime}\\) are equal to \\(\\overrightarrow{K^{\\prime} A^{\\prime}} / 2=\\overrightarrow{K^{\\prime} D^{\\prime}} / 2-\\overrightarrow{A^{\\prime} D^{\\prime}} / 2\\). So \\(\\overrightarrow{O^{*} A^{\\prime}}=\\overrightarrow{B^{\\prime} O}\\), or equivalently \\(\\overrightarrow{A^{\\prime} O}=\\overrightarrow{O^{*} B^{\\prime}}\\). Projecting this equality onto \\(A^{\\prime} C\\), we see that the projection of \\(\\overrightarrow{O^{*} B^{\\prime}}\\) equals \\(\\overrightarrow{A^{\\prime} C} / 2\\). Since \\(O^{*}\\) is projected to the midpoint of \\(A^{\\prime} Y^{\\prime}\\), this yields that \\(B^{\\prime}\\) is projected to the midpoint of \\(C Y^{\\prime}\\), i.e., \\(B^{\\prime} Y^{\\prime}=B^{\\prime} C\\) and \\(\\angle B^{\\prime} Y^{\\prime} C=\\angle B^{\\prime} C Y^{\\prime}\\). In the original figure, this rewrites as \\(\\angle C B Y=\\angle B C Y\\), so \\(Y\\) lies on the perpendicular bisector of \\(B C\\), as desired.\n![](https://cdn.mathpix.com/cropped/2025_08_23_53f86fa89253df1f58beg-63.jpg?height=840&width=1309&top_left_y=1790&top_left_x=376)\n\nComment 2. The point \\(K\\) appears to be the same in Solutions 1 and 3 (and Comment 1 as well). One can also show that \\(K\\) lies on the circle passing through \\(A, X\\), and the midpoint of the arc \\(B A C\\).\n\nComment 3. There are different proofs of the facts from the Common remarks, namely, the cyclicity of \\(B, C, E\\), and \\(F\\), and the Claim. We present one such alternative proof here.\n\nWe perform the composition \\(\\phi\\) of a homothety with centre \\(A\\) and the reflection in \\(A D\\), which maps \\(E\\) to \\(B\\). Let \\(U=\\phi(D)\\). Then \\(\\Varangle(B C, C D)=\\Varangle(A D, D E)=\\Varangle(B U, U D)\\), so the points \\(B, U, C\\), and \\(D\\) are concyclic. Therefore, \\(\\Varangle(C U, U D)=\\Varangle(C B, B D)=\\Varangle(A D, D F)\\), so \\(\\phi(F)=C\\). Then the coefficient of the homothety is \\(A C / A F=A B / A E\\), and thus points \\(C, E, F\\), and \\(B\\) are concyclic.\n\nDenote the centres of the circles ( \\(E D F\\) ) and ( \\(B U C D\\) ) by \\(O_{3}\\) and \\(O_{4}\\), respectively. Then \\(\\phi\\left(O_{3}\\right)= O_{4}\\), hence \\(\\Varangle\\left(O_{3} D, D A\\right)=-\\Varangle\\left(O_{4} U, U A\\right)=\\Varangle\\left(O_{4} D, D A\\right)\\), whence the circle ( \\(B D C\\) ) is tangent to the circle ( \\(E D F\\) ).\n\nNow, the radical axes of circles ( \\(D E F\\) ), ( \\(B D C\\) ) and ( \\(B C E F\\) ) intersect at \\(T\\), and the claim follows.\n![](https://cdn.mathpix.com/cropped/2025_08_23_53f86fa89253df1f58beg-64.jpg?height=858&width=918&top_left_y=693&top_left_x=576)\n\nThis suffices for Solution 1 to work. However, Solutions 2 and 3 need properties of point \\(Q\\), established in Common remarks before Solution 1.\n\nComment 4. In the original problem proposal, the point \\(X\\) was hidden. Instead, a circle \\(\\gamma\\) was constructed such that \\(D\\) and \\(E\\) lie on \\(\\gamma\\), and its center is collinear with \\(O_{1}\\) and \\(T\\). The problem requested to prove that, in a fixed triangle \\(A B C\\), independently from the choice of \\(D\\) on the bisector of \\(\\angle B A C\\), all circles \\(\\gamma\\) pass through a fixed point.", "source_pdf": "imosl_2021.pdf", "notes": "fallback-regex"}
{"id": "IMO-2021-1", "contest": "IMO", "year": "2021", "problem_number": "N2", "problem": "Let \\(n \\geqslant 100\\) be an integer. The numbers \\(n, n+1, \\ldots, 2 n\\) are written on \\(n+1\\) cards, one number per card. The cards are shuffled and divided into two piles. Prove that one of the piles contains two cards such that the sum of their numbers is a perfect square.", "solution": ". To solve the problem it suffices to find three squares and three cards with numbers \\(a, b, c\\) on them such that pairwise sums \\(a+b, b+c, a+c\\) are equal to the chosen squares. By choosing the three consecutive squares \\((2 k-1)^{2},(2 k)^{2},(2 k+1)^{2}\\) we arrive at the triple\n\\[\n(a, b, c)=\\left(2 k^{2}-4 k, \\quad 2 k^{2}+1, \\quad 2 k^{2}+4 k\\right)\n\\]\n\nWe need a value for \\(k\\) such that\n\\[\nn \\leqslant 2 k^{2}-4 k, \\quad \\text { and } \\quad 2 k^{2}+4 k \\leqslant 2 n .\n\\]\n\nA concrete \\(k\\) is suitable for all \\(n\\) with\n\\[\nn \\in\\left[k^{2}+2 k, 2 k^{2}-4 k+1\\right]=: I_{k}\n\\]\n\nFor \\(k \\geqslant 9\\) the intervals \\(I_{k}\\) and \\(I_{k+1}\\) overlap because\n\\[\n(k+1)^{2}+2(k+1) \\leqslant 2 k^{2}-4 k+1 .\n\\]\n\nHence \\(I_{9} \\cup I_{10} \\cup \\ldots=[99, \\infty)\\), which proves the statement for \\(n \\geqslant 99\\).\nComment 1. There exist approaches which only work for sufficiently large \\(n\\).\nOne possible approach is to consider three cards with numbers \\(70 k^{2}, 99 k^{2}, 126 k^{2}\\) on them. Then their pairwise sums are perfect squares and so it suffices to find \\(k\\) such that \\(70 k^{2} \\geqslant n\\) and \\(126 k^{2} \\leqslant 2 n\\) which exists for sufficiently large \\(n\\).\n\nAnother approach is to prove, arguing by contradiction, that \\(a\\) and \\(a-2\\) are in the same pile provided that \\(n\\) is large enough and \\(a\\) is sufficiently close to \\(n\\). For that purpose, note that every pair of neighbouring numbers in the sequence \\(a, x^{2}-a, a+(2 x+1), x^{2}+2 x+3-a, a-2\\) adds up to a perfect square for any \\(x\\); so by choosing \\(x=\\lfloor\\sqrt{2 a}\\rfloor+1\\) and assuming that \\(n\\) is large enough we conclude that \\(a\\) and \\(a-2\\) are in the same pile for any \\(a \\in[n+2,3 n / 2]\\). This gives a contradiction since it is easy to find two numbers from \\([n+2,3 n / 2]\\) of the same parity which sum to a square.\n\nIt then remains to separately cover the cases of small \\(n\\) which appears to be quite technical.\nComment 2. An alternative formulation for this problem could ask for a proof of the statement for all \\(n>10^{6}\\). An advantage of this formulation is that some solutions, e.g. those mentioned in Comment 1 need not contain a technical part which deals with the cases of small \\(n\\). However, the original formulation seems to be better because the bound it gives for \\(n\\) is almost sharp, see the next comment for details.\n\nComment 3. The statement of the problem is false for \\(n=98\\). As a counterexample, the first pile may contain the even numbers from 98 to 126, the odd numbers from 129 to 161, and the even numbers from 162 to 196.", "source_pdf": "imosl_2021.pdf", "notes": "fallback-regex"}
{"id": "IMO-2022-2", "contest": "IMO", "year": "2022", "problem_number": "A3", "problem": "Let \\(\\mathbb{R}_{>0}\\) be the set of positive real numbers. Find all functions \\(f: \\mathbb{R}_{>0} \\rightarrow \\mathbb{R}_{>0}\\) such that, for every \\(x \\in \\mathbb{R}_{>0}\\), there exists a unique \\(y \\in \\mathbb{R}_{>0}\\) satisfying\n\\[\nx f(y)+y f(x) \\leqslant 2 .\n\\]\n(Netherlands)", "solution": "Answer: The function \\(f(x)=1 / x\\) is the only\n\n.\nSolution 1. First we prove that the function \\(f(x)=1 / x\\) satisfies the condition of the problem statement. The AM-GM inequality gives\n\\[\n\\frac{x}{y}+\\frac{y}{x} \\geqslant 2\n\\]\nfor every \\(x, y>0\\), with equality if and only if \\(x=y\\). This means that, for every \\(x>0\\), there exists a unique \\(y>0\\) such that\n\\[\n\\frac{x}{y}+\\frac{y}{x} \\leqslant 2,\n\\]\nnamely \\(y=x\\).\nLet now \\(f: \\mathbb{R}_{>0} \\rightarrow \\mathbb{R}_{>0}\\) be a function that satisfies the condition of the problem statement. We say that a pair of positive real numbers ( \\(x, y\\) ) is good if \\(x f(y)+y f(x) \\leqslant 2\\). Observe that if ( \\(x, y\\) ) is good, then so is ( \\(y, x\\) ).\nLemma 1.0. If ( \\(x, y\\) ) is good, then \\(x=y\\).\nProof. Assume that there exist positive real numbers \\(x \\neq y\\) such that ( \\(x, y\\) ) is good. The uniqueness assumption says that \\(y\\) is the unique positive real number such that ( \\(x, y\\) ) is good. In particular, ( \\(x, x\\) ) is not a good pair. This means that\n\\[\nx f(x)+x f(x)>2\n\\]\nand thus \\(x f(x)>1\\). Similarly, ( \\(y, x\\) ) is a good pair, so ( \\(y, y\\) ) is not a good pair, which implies \\(y f(y)>1\\). We apply the AM-GM inequality to obtain\n\\[\nx f(y)+y f(x) \\geqslant 2 \\sqrt{x f(y) \\cdot y f(x)}=2 \\sqrt{x f(x) \\cdot y f(y)}>2 .\n\\]\n\nThis is a contradiction, since ( \\(x, y\\) ) is a good pair.\nBy assumption, for any \\(x>0\\), there always exists a good pair containing \\(x\\), however Lemma 1 implies that the only good pair that can contain \\(x\\) is ( \\(x, x\\) ), so\n\\[\nx f(x) \\leqslant 1 \\quad \\Longleftrightarrow \\quad f(x) \\leqslant \\frac{1}{x},\n\\]\nfor every \\(x>0\\).\nIn particular, with \\(x=1 / f(t)\\) for \\(t>0\\), we obtain\n\\[\n\\frac{1}{f(t)} \\cdot f\\left(\\frac{1}{f(t)}\\right) \\leqslant 1 .\n\\]\n\nHence\n\\[\nt \\cdot f\\left(\\frac{1}{f(t)}\\right) \\leqslant t f(t) \\leqslant 1\n\\]\n\nWe claim that \\((t, 1 / f(t))\\) is a good pair for every \\(t>0\\). Indeed,\n\\[\nt \\cdot f\\left(\\frac{1}{f(t)}\\right)+\\frac{1}{f(t)} f(t)=t \\cdot f\\left(\\frac{1}{f(t)}\\right)+1 \\leqslant 2\n\\]\n\nLemma 1 implies that \\(t=1 / f(t) \\Longleftrightarrow f(t)=1 / t\\) for every \\(t>0\\).\n\nSolution 1.1. We give an alternative way to prove that \\(f(x)=1 / x\\) assuming \\(f(x) \\leqslant 1 / x\\) for every \\(x>0\\).\n\nIndeed, if \\(f(x)<1 / x\\) then for every \\(a>0\\) with \\(f(x)<1 / a<1 / x\\) (and there are at least two of them), we have\n\\[\na f(x)+x f(a)<1+\\frac{x}{a}<2 .\n\\]\n\nHence ( \\(x, a\\) ) is a good pair for every such \\(a\\), a contradiction. We conclude that \\(f(x)=1 / x\\).\nSolution 1.2. We can also conclude from Lemma 1 and \\(f(x) \\leqslant 1 / x\\) as follows.\nLemma 2. The function \\(f\\) is decreasing.\nProof. Let \\(y>x>0\\). Lemma 1 says that ( \\(x, y\\) ) is not a good pair, but ( \\(y, y\\) ) is. Hence\n\\[\nx f(y)+y f(x)>2 \\geqslant 2 y f(y)>y f(y)+x f(y),\n\\]\nwhere we used \\(y>x\\) (and \\(f(y)>0\\) ) in the last inequality. This implies that \\(f(x)>f(y)\\), showing that \\(f\\) is decreasing.\n\nWe now prove that \\(f(x)=1 / x\\) for all \\(x\\). Fix a value of \\(x\\) and note that for \\(y>x\\) we must have \\(x f(x)+y f(x)>x f(y)+y f(x)>2\\) (using that \\(f\\) is decreasing for the first step), hence \\(f(x)>\\frac{2}{x+y}\\). The last inequality is true for every \\(y>x>0\\). If we fix \\(x\\) and look for the supremum of the expression \\(\\frac{2}{x+y}\\) over all \\(y>x\\), we get\n\\[\nf(x) \\geqslant \\frac{2}{x+x}=\\frac{1}{x}\n\\]\n\nSince we already know that \\(f(x) \\leqslant 1 / x\\), we conclude that \\(f(x)=1 / x\\).\nSolution 2.0. As in the first solution, we note that \\(f(x)=1 / x\\) is a solution, and we set out to prove that it is the only one. We write \\(g(x)\\) for the unique positive real number such that \\((x, g(x))\\) is a good pair. In this solution, we prove Lemma 2 without assuming Lemma 1.\nLemma 2. The function \\(f\\) is decreasing.\nProof. Consider \\(x<y\\). It holds that \\(y f(g(y))+g(y) f(y) \\leqslant 2\\). Moreover, because \\(y\\) is the only positive real number such that \\((g(y), y)\\) is a good pair and \\(x \\neq y\\), we have \\(x f(g(y))+g(y) f(x)>\\) 2. Combining these two inequalities yields\n\\[\nx f(g(y))+g(y) f(x)>2 \\geqslant y f(g(y))+g(y) f(y),\n\\]\nor \\(f(g(y))(x-y)>g(y)(f(y)-f(x))\\). Because \\(g(y)\\) and \\(f(g(y))\\) are both positive while \\(x-y\\) is negative, it follows that \\(f(y)<f(x)\\), showing that \\(f\\) is decreasing.\n\nWe now prove Lemma 1 using Lemma 2. Suppose that \\(x \\neq y\\) but \\(x f(y)+y f(x) \\leqslant 2\\). As in the first solution, we get \\(x f(x)+x f(x)>2\\) and \\(y f(y)+y f(y)>2\\), which implies \\(x f(x)+y f(y)>2\\). Now\n\\[\nx f(x)+y f(y)>2 \\geqslant x f(y)+y f(x)\n\\]\nimplies \\((x-y)(f(x)-f(y))>0\\), which contradicts the fact that \\(f\\) is decreasing. So \\(y=x\\) is the unique \\(y\\) such that ( \\(x, y\\) ) is a good pair, and in particular we have \\(f(x) \\leqslant 1 / x\\).\n\nWe can now conclude the proof as in any of the Solutions 1.x.\nSolution 3.0. As in the other solutions we verify that the function \\(f(x)=1 / x\\) is a solution. We first want to prove the following lemma:\nLemma 3. For all \\(x \\in \\mathbb{R}_{>0}\\) we actually have \\(x f(g(x))+g(x) f(x)=2\\) (that is: the inequality is actually an equality).\n\nProof. We proceed by contradiction: Assume there exists some number \\(x>0\\) such that for \\(y=g(x)\\) we have \\(x f(y)+y f(x)<2\\). Then for any \\(0<\\epsilon<\\frac{2-x f(y)-y f(x)}{2 f(x)}\\) we have, by uniqueness of \\(y\\), that \\(x f(y+\\epsilon)+(y+\\epsilon) f(x)>2\\). Therefore\n\\[\n\\begin{aligned}\nf(y+\\epsilon) & >\\frac{2-(y+\\epsilon) f(x)}{x}=\\frac{2-y f(x)-\\epsilon f(x)}{x} \\\\\n& >\\frac{2-y f(x)-\\frac{2-x f(y)-y f(x)}{2}}{x} \\\\\n& =\\frac{2-x f(y)-y f(x)}{2 x}+f(y)>f(y)\n\\end{aligned}\n\\]\n\nFurthermore, for every such \\(\\epsilon\\) we have \\(g(y+\\epsilon) f(y+\\epsilon)+(y+\\epsilon) f(g(y+\\epsilon)) \\leqslant 2\\) and \\(g(y+\\epsilon) f(y)+y f(g(y+\\epsilon))>2\\) (since \\(y \\neq y+\\epsilon=g(g(y+\\epsilon)))\\). This gives us the two inequalities\n\\[\nf(g(y+\\epsilon)) \\leqslant \\frac{2-g(y+\\epsilon) f(y+\\epsilon)}{y+\\epsilon} \\quad \\text { and } \\quad f(g(y+\\epsilon))>\\frac{2-g(y+\\epsilon) f(y)}{y} .\n\\]\n\nCombining these two inequalities and rearranging the terms leads to the inequality\n\\[\n2 \\epsilon<g(y+\\epsilon)[(y+\\epsilon) f(y)-y f(y+\\epsilon)] .\n\\]\n\nMoreover combining with the inequality (1) we obtain\n\\(2 \\epsilon<g(y+\\epsilon)\\left[(y+\\epsilon) f(y)-y\\left(\\frac{2-x f(y)-y f(x)}{2 x}+f(y)\\right)\\right]=g(y+\\epsilon)\\left[\\epsilon f(y)-y \\frac{2-x f(y)-y f(x)}{2 x}\\right]\\).\nWe now reach the desired contradiction, since for \\(\\epsilon\\) sufficiently small we have that the left hand side is positive while the right hand side is negative.\n\nWith this lemma it then follows that for all \\(x, y \\in \\mathbb{R}_{>0}\\) we have\n\\[\nx f(y)+y f(x) \\geqslant 2\n\\]\nsince for \\(y=g(x)\\) we have equality and by uniqueness for \\(y \\neq g(x)\\) the inequality is strict.\nIn particular for every \\(x \\in \\mathbb{R}_{>0}\\) and for \\(y=x\\) we have \\(2 x f(x) \\geqslant 2\\), or equivalently \\(f(x) \\geqslant 1 / x\\) for all \\(x \\in \\mathbb{R}_{>0}\\). With this inequality we obtain for all \\(x \\in \\mathbb{R}_{>0}\\)\n\\[\n2 \\geqslant x f(g(x))+g(x) f(x) \\geqslant \\frac{x}{g(x)}+\\frac{g(x)}{x} \\geqslant 2\n\\]\nwhere the first inequality comes from the problem statement. Consequently each of these inequalities must actually be an equality, and in particular we obtain \\(f(x)=1 / x\\) for all \\(x \\in \\mathbb{R}_{>0}\\).\n\nSolution 4. Again, let us prove that \\(f(x)=1 / x\\) is the only solution. Let again \\(g(x)\\) be the unique positive real number such that ( \\(x, g(x)\\) ) is a good pair.\nLemma 4. The function \\(f\\) is strictly convex.\nProof. Consider the function \\(q_{s}(x)=f(x)+s x\\) for some real number \\(s\\). If \\(f\\) is not strictly convex, then there exist \\(u<v\\) and \\(t \\in(0,1)\\) such that\n\\[\nf(t u+(1-t) v) \\geqslant t f(u)+(1-t) f(v) .\n\\]\n\nHence\n\\[\n\\begin{aligned}\nq_{s}(t u+(1-t) v) & \\geqslant t f(u)+(1-t) f(v)+s(t u+(1-t) v) \\\\\n& =t q_{s}(u)+(1-t) q_{s}(v)\n\\end{aligned}\n\\]\n\nLet \\(w=t u+(1-t) v\\) and consider the case \\(s=f(g(w)) / g(w)\\). For that particular choice of \\(s\\), the function \\(q_{s}(x)\\) has a unique minimum at \\(x=w\\). However, since \\(q_{s}(w) \\geqslant t q_{s}(u)+(1-t) q_{s}(v)\\), it must hold \\(q_{s}(u) \\leqslant q_{s}(w)\\) or \\(q_{s}(v) \\leqslant q_{s}(w)\\), a contradiction.\nLemma 5. The function \\(f\\) is continuous.\nProof. Since \\(f\\) is strictly convex and defined on an open interval, it is also continuous.\nAs in Solution 1, we can prove that \\(f(x) \\leqslant 1 / x\\). If \\(f(x)<1 / x\\), then we consider the function \\(h(y)=x f(y)+y f(x)\\) which is continuous. Since \\(h(x)<2\\), there exist at least two distinct \\(z \\neq x\\) such that \\(h(z)<2\\) giving that \\((x, z)\\) is good pair for both values of \\(z\\), a contradiction. We conclude that \\(f(x)=1 / x\\) as desired.\n\nComment. Lemma 5 implies Lemma 3, using an argument similar as in the end of Solution 4.", "source_pdf": "imosl_2022.pdf", "notes": "fallback-regex"}
{"id": "IMO-2022-1", "contest": "IMO", "year": "2022", "problem_number": "C2", "problem": "The Bank of Oslo issues coins made out of two types of metal: aluminium (denoted \\(A\\) ) and copper (denoted \\(C\\) ). Morgane has \\(n\\) aluminium coins, and \\(n\\) copper coins, and arranges her \\(2 n\\) coins in a row in some arbitrary initial order. Given a fixed positive integer \\(k \\leqslant 2 n\\), she repeatedly performs the following operation: identify the largest subsequence containing the \\(k\\)-th coin from the left which consists of consecutive coins made of the same metal, and move all coins in that subsequence to the left end of the row. For example, if \\(n=4\\) and \\(k=4\\), the process starting from the configuration \\(A A C C C A C A\\) would be\n\\[\nA A C C C A C A \\rightarrow C C C A A A C A \\rightarrow A A A C C C C A \\rightarrow C C C C A A A A \\rightarrow \\cdots .\n\\]\n\nFind all pairs ( \\(n, k\\) ) with \\(1 \\leqslant k \\leqslant 2 n\\) such that for every initial configuration, at some point of the process there will be at most one aluminium coin adjacent to a copper coin.\n(France)", "solution": "Answer: All pairs \\((n, k)\\) such that \\(n \\leqslant k \\leqslant \\frac{3 n+1}{2}\\).\n\n. Define a block to be a maximal subsequence of consecutive coins made out of the same metal, and let \\(M^{b}\\) denote a block of \\(b\\) coins of metal \\(M\\). The property that there is at most one aluminium coin adjacent to a copper coin is clearly equivalent to the configuration having two blocks, one consisting of all \\(A\\)-s and one consisting of all \\(C\\)-s.\n\nFirst, notice that if \\(k<n\\), the sequence \\(A^{n-1} C^{n-1} A C\\) remains fixed under the operation, and will therefore always have 4 blocks. Next, if \\(k>\\frac{3 n+1}{2}\\), let \\(a=k-n-1, b=2 n-k+1\\). Then \\(k>2 a+b, k>2 b+a\\), so the configuration \\(A^{a} C^{b} A^{b} C^{a}\\) will always have four blocks:\n\\[\nA^{a} C^{b} A^{b} C^{a} \\rightarrow C^{a} A^{a} C^{b} A^{b} \\rightarrow A^{b} C^{a} A^{a} C^{b} \\rightarrow C^{b} A^{b} C^{a} A^{a} \\rightarrow A^{a} C^{b} A^{b} C^{a} \\rightarrow \\ldots\n\\]\n\nTherefore a pair ( \\(n, k\\) ) can have the desired property only if \\(n \\leqslant k \\leqslant \\frac{3 n+1}{2}\\). We claim that all such pairs in fact do have the desired property. Clearly, the number of blocks in a configuration cannot increase, so whenever the operation is applied, it either decreases or remains constant. We show that unless there are only two blocks, after a finite amount of steps the number of blocks will decrease.\n\nConsider an arbitrary configuration with \\(c \\geqslant 3\\) blocks. We note that as \\(k \\geqslant n\\), the leftmost block cannot be moved, because in this case all \\(n\\) coins of one type are in the leftmost block, meaning there are only two blocks. If a block which is not the leftmost or rightmost block is moved, its neighbor blocks will be merged, causing the number of blocks to decrease.\n\nHence the only case in which the number of blocks does not decrease in the next step is if the rightmost block is moved. If \\(c\\) is odd, the leftmost and the rightmost blocks are made of the same metal, so this would merge two blocks. Hence \\(c \\geqslant 4\\) must be even. Suppose there is a configuration of \\(c\\) blocks with the \\(i\\)-th block having size \\(a_{i}\\) so that the operation always moves the rightmost block:\n\\[\nA^{a_{1}} \\ldots A^{a_{c-1}} C^{a_{c}} \\rightarrow C^{a_{c}} A^{a_{1}} \\ldots A^{a_{c-1}} \\rightarrow A^{a_{c-1}} C^{a_{c}} A^{a_{1}} \\ldots C^{a_{c-2}} \\rightarrow \\ldots\n\\]\n\nBecause the rightmost block is always moved, \\(k \\geqslant 2 n+1-a_{i}\\) for all \\(i\\). Because \\(\\sum a_{i}=2 n\\), summing this over all \\(i\\) we get \\(c k \\geqslant 2 c n+c-\\sum a_{i}=2 c n+c-2 n\\), so \\(k \\geqslant 2 n+1-\\frac{2 n}{c} \\geqslant \\frac{3 n}{2}+1\\). But this contradicts \\(k \\leqslant \\frac{3 n+1}{2}\\). Hence at some point the operation will not move the rightmost block, meaning that the number of blocks will decrease, as desired.", "source_pdf": "imosl_2022.pdf", "notes": "fallback-regex"}
{"id": "IMO-2022-4", "contest": "IMO", "year": "2022", "problem_number": "G1", "problem": "Let \\(A B C D E\\) be a convex pentagon such that \\(B C=D E\\). Assume there is a point \\(T\\) inside \\(A B C D E\\) with \\(T B=T D, T C=T E\\) and \\(\\angle T B A=\\angle A E T\\). Let lines \\(C D\\) and \\(C T\\) intersect line \\(A B\\) at points \\(P\\) and \\(Q\\), respectively, and let lines \\(C D\\) and \\(D T\\) intersect line \\(A E\\) at points \\(R\\) and \\(S\\), respectively. Assume that points \\(P, B, A, Q\\) and \\(R, E, A, S\\) respectively, are collinear and occur on their lines in this order. Prove that the points \\(P, S, Q, R\\) are concyclic.\n(Slovakia)", "solution": "1. By the conditions we have \\(B C=D E, C T=E T\\) and \\(T B=T D\\), so the triangles \\(T B C\\) and \\(T D E\\) are congruent, in particular \\(\\angle B T C=\\angle D T E\\).\n\nIn triangles \\(T B Q\\) and \\(T E S\\) we have \\(\\angle T B Q=\\angle S E T\\) and \\(\\angle Q T B=180^{\\circ}-\\angle B T C=180^{\\circ}- \\angle D T E=\\angle E T S\\), so these triangles are similar to each other. It follows that \\(\\angle T S E=\\angle B Q T\\) and\n\\[\n\\frac{T D}{T Q}=\\frac{T B}{T Q}=\\frac{T E}{T S}=\\frac{T C}{T S} .\n\\]\n\nBy rearranging this relation we get \\(T D \\cdot T S=T C \\cdot T Q\\), so \\(C, D, Q\\) and \\(S\\) are concyclic. (Alternatively, we can get \\(\\angle C Q D=\\angle C S D\\) from the similar triangles \\(T C S\\) and \\(T D Q\\).) Hence, \\(\\angle D C Q=\\angle D S Q\\).\n\nFinally, from the angles of triangle \\(C Q P\\) we get\n\\[\n\\angle R P Q=\\angle R C Q-\\angle P Q C=\\angle D S Q-\\angle D S R=\\angle R S Q,\n\\]\nwhich proves that \\(P, Q, R\\) and \\(S\\) are concyclic.\n![](https://cdn.mathpix.com/cropped/2025_08_23_bba1c16f961fdd6f4eb4g-46.jpg?height=563&width=1483&top_left_y=1513&top_left_x=291)\n\nSolution 2. As in the previous solution, we note that triangles \\(T B C\\) and \\(T D E\\) are congruent. Denote the intersection point of \\(D T\\) and \\(B A\\) by \\(V\\), and the intersection point of \\(C T\\) and \\(E A\\) by \\(W\\). From triangles \\(B C Q\\) and \\(D E S\\) we then have\n\\[\n\\begin{aligned}\n\\angle V S W & =\\angle D S E=180^{\\circ}-\\angle S E D-\\angle E D S=180^{\\circ}-\\angle A E T-\\angle T E D-\\angle E D T \\\\\n& =180^{\\circ}-\\angle T B A-\\angle T C B-\\angle C B T=180^{\\circ}-\\angle Q C B-\\angle C B Q=\\angle B Q C=\\angle V Q W,\n\\end{aligned}\n\\]\nmeaning that \\(V S Q W\\) is cyclic, and in particular \\(\\angle W V Q=\\angle W S Q\\). Since\n\\[\n\\angle V T B=180^{\\circ}-\\angle B T C-\\angle C T D=180^{\\circ}-\\angle C T D-\\angle D T E=\\angle E T W,\n\\]\nand \\(\\angle T B V=\\angle W E T\\) by assumption, we have that the triangles \\(V T B\\) and \\(W T E\\) are similar, hence\n\\[\n\\frac{V T}{W T}=\\frac{B T}{E T}=\\frac{D T}{C T} .\n\\]\n\nThus \\(C D \\| V W\\), and angle chasing yields\n\\[\n\\angle R P Q=\\angle W V Q=\\angle W S Q=\\angle R S Q\n\\]\nconcluding the proof.", "source_pdf": "imosl_2022.pdf", "notes": "fallback-regex"}
{"id": "IMO-2022-5", "contest": "IMO", "year": "2022", "problem_number": "N4", "problem": "Find all triples of positive integers \\((a, b, p)\\) with \\(p\\) prime and\n\\[\na^{p}=b!+p .\n\\]\n(Belgium)", "solution": "Answer: (2, 2, 2) and (3, 4, 3).\n\n1. Clearly, \\(a>1\\). We consider three cases.\nCase 1: We have \\(a<p\\). Then we either have \\(a \\leqslant b\\) which implies \\(a \\mid a^{p}-b!=p\\) leading to a contradiction, or \\(a>b\\) which is also impossible since in this case we have \\(b!\\leqslant a!<a^{p}-p\\), where the last inequality is true for any \\(p>a>1\\).\nCase 2: We have \\(a>p\\). In this case \\(b!=a^{p}-p>p^{p}-p \\geqslant p!\\) so \\(b>p\\) which means that \\(a^{p}=b!+p\\) is divisible by \\(p\\). Hence, \\(a\\) is divisible by \\(p\\) and \\(b!=a^{p}-p\\) is not divisible by \\(p^{2}\\). This means that \\(b<2 p\\). If \\(a<p^{2}\\) then \\(a / p<p\\) divides both \\(a^{p}\\) and \\(b!\\) and hence it also divides \\(p=a^{p}-b!\\) which is impossible. On the other hand, the case \\(a \\geqslant p^{2}\\) is also impossible since then \\(a^{p} \\geqslant\\left(p^{2}\\right)^{p}>(2 p-1)!+p \\geqslant b!+p\\).\n\nComment. The inequality \\(p^{2 p}>(2 p-1)!+p\\) can be shown e.g. by using\n\\[\n(2 p-1)!=[1 \\cdot(2 p-1)] \\cdot[2 \\cdot(2 p-2)] \\cdots \\cdots[(p-1)(p+1)] \\cdot p<\\left(\\left(\\frac{2 p}{2}\\right)^{2}\\right)^{p-1} \\cdot p=p^{2 p-1}\n\\]\nwhere the inequality comes from applying AM-GM to each of the terms in square brackets.\nCase 3: We have \\(a=p\\). In this case \\(b!=p^{p}-p\\). One can check that the values \\(p=2,3\\) lead to the claimed solutions and \\(p=5\\) does not lead to a solution. So we now assume that \\(p \\geqslant 7\\). We have \\(b!=p^{p}-p>p!\\) and so \\(b \\geqslant p+1\\) which implies that\n\\(v_{2}((p+1)!) \\leqslant v_{2}(b!)=v_{2}\\left(p^{p-1}-1\\right) \\stackrel{L T E}{=} 2 v_{2}(p-1)+v_{2}(p+1)-1=v_{2}\\left(\\frac{p-1}{2} \\cdot(p-1) \\cdot(p+1)\\right)\\),\nwhere in the middle we used lifting-the-exponent lemma. On the RHS we have three factors of \\((p+1)\\) !. But, due to \\(p+1 \\geqslant 8\\), there are at least 4 even numbers among \\(1,2, \\ldots, p+1\\), so this case is not possible.\n\nSolution 2. The cases \\(a \\neq p\\) are covered as in solution 1 , as are \\(p=2,3\\). For \\(p \\geqslant 5\\) we have \\(b!=p\\left(p^{p-1}-1\\right)\\). By Zsigmondy's Theorem there exists some prime \\(q\\) that divides \\(p^{p-1}-1\\) but does not divide \\(p^{k}-1\\) for \\(k<p-1\\). It follows that \\(\\operatorname{ord}_{q}(p)=p-1\\), and hence \\(q \\equiv 1 \\bmod (p-1)\\). Note that \\(p \\neq q\\). But then we must have \\(q \\geqslant 2 p-1\\), giving\n\\(b!\\geqslant(2 p-1)!=[1 \\cdot(2 p-1)] \\cdot[2 \\cdot(2 p-2)] \\cdots \\cdots[(p-1) \\cdot(p+1)] \\cdot p>(2 p-1)^{p-1} p>p^{p}>p^{p}-p\\), a contradiction.\n\nSolution 3. The cases \\(a \\neq p\\) are covered as in solution 1 , as are \\(p=2,3\\). Also \\(b>p\\), as \\(p^{p}>p!+p\\) for \\(p>2\\). The cases \\(p=5,7,11\\) are also checked manually, so assume \\(p \\geqslant 13\\). Let \\(q \\mid p+1\\) be an odd prime. By LTE\n\\[\nv_{q}\\left(p^{p}-p\\right)=v_{q}\\left(\\left(p^{2}\\right)^{\\frac{p-1}{2}}-1\\right)=v_{q}\\left(p^{2}-1\\right)+v_{q}\\left(\\frac{p-1}{2}\\right)=v_{q}(p+1) .\n\\]\n\nBut \\(b \\geqslant p+1\\), so then \\(v_{q}(b!)>v_{q}(p+1)\\), since \\(q<p+1\\), a contradiction. This means that \\(p+1\\) has no odd prime divisor, i.e. \\(p+1=2^{k}\\) for some \\(k\\).\n\nNow let \\(q \\mid p-1\\) be an odd prime. By LTE\n\\[\nv_{q}\\left(p^{p}-p\\right)=2 v_{q}(p-1)\n\\]\n\nLet \\(d=v_{q}(p-1)\\). Then \\(p \\geqslant 1+q^{d}\\), so\n\\[\nv_{q}(b!) \\geqslant v_{q}(p!) \\geqslant v_{q}\\left(q^{d}!\\right)>q^{d-1} \\geqslant 2 d\n\\]\nprovided \\(d \\geqslant 2\\) and \\(q>3\\), or \\(d \\geqslant 3\\).\nIf \\(q=3, d=2\\) and \\(p \\geqslant 13\\) then \\(v_{q}(b!) \\geqslant v_{q}(p!) \\geqslant v_{q}(13!)=5>2 d\\). Either way, \\(d \\leqslant 1\\).\nIf \\(p>2 q+1\\) (so \\(p>3 q\\), as \\(q \\mid p-1\\) ) then\n\\[\nv_{q}(b!) \\geqslant v_{q}((3 q)!)=3\n\\]\nso we must have \\(q \\geqslant \\frac{p}{2}\\), in other words, \\(p-1=2 q\\). This implies that \\(p=2^{k}-1\\) and \\(q=2^{k-1}-1\\) are both prime, but it is not possible to have two consecutive Mersenne primes.\n\nSolution 4. Let \\(a=p, b>p\\) and \\(p \\geqslant 5\\) (the remaining cases are dealt with as in solution 3). Modulo \\((p+1)^{2}\\) it holds that\n\\(p^{p}-p=(p+1-1)^{p}-p \\equiv\\binom{p}{1}(p+1)(-1)^{p-1}+(-1)^{p}-p=p(p+1)-1-p=p^{2}-1 \\not \\equiv 0 \\quad \\bmod \\left((p+1)^{2}\\right)\\).\nSince \\(p \\geqslant 5\\), the numbers 2 and \\(\\frac{p+1}{2}\\) are distinct and less than or equal to \\(p\\). Therefore, \\(p+1 \\mid p!\\), and so \\((p+1)^{2} \\mid(p+1)\\) !.\nBut \\(b \\geqslant p+1\\), so \\(b!\\equiv 0 \\not \\equiv p^{p}-p \\bmod (p+1)^{2}\\), a contradiction.", "source_pdf": "imosl_2022.pdf", "notes": "fallback-regex"}
{"id": "IMO-2022-3", "contest": "IMO", "year": "2022", "problem_number": "N7", "problem": "Let \\(k\\) be a positive integer and let \\(S\\) be a finite set of odd prime numbers. Prove that there is at most one way (modulo rotation and reflection) to place the elements of \\(S\\) around a circle such that the product of any two neighbors is of the form \\(x^{2}+x+k\\) for some positive integer \\(x\\).", "solution": ". Let us allow the value \\(x=0\\) as well; we prove the same statement under this more general constraint. Obviously that implies the statement with the original conditions.\n\nCall a pair \\(\\{p, q\\}\\) of primes with \\(p \\neq q\\) special if \\(p q=x^{2}+x+k\\) for some nonnegative integer \\(x\\). The following claim is the key mechanism of the problem:\nClaim.\n(a) For every prime \\(r\\), there are at most two primes less than \\(r\\) forming a special pair with \\(r\\).\n(b) If such \\(p\\) and \\(q\\) exist, then \\(\\{p, q\\}\\) is itself special.\n\nWe present two proofs of the claim.\nProof 1. We are interested in integers \\(1 \\leqslant x<r\\) satsfying\n\\[\nx^{2}+x+k \\equiv 0 \\quad(\\bmod r)\n\\]\n\nSince there are at most two residues modulo \\(r\\) that can satisfy that quadratic congruence, there are at most two possible values of \\(x\\). That proves (a).\n\nNow suppose there are primes \\(p, q\\) with \\(p<q<r\\) and nonnegative integers \\(x, y\\) such that\n\\[\n\\begin{aligned}\n& x^{2}+x+k=p r \\\\\n& y^{2}+y+k=q r .\n\\end{aligned}\n\\]\n\nFrom \\(p<q<r\\) we can see that \\(0 \\leqslant x<y \\leqslant r-1\\). The numbers \\(x, y\\) are the two solutions of (1); by Vieta's formulas, we should have \\(x+y \\equiv-1(\\bmod r)\\), so \\(x+y=r-1\\).\n\nLetting \\(K=4 k-1, X=2 x+1\\), and \\(Y=2 y+1\\), we obtain\n\\[\n\\begin{gathered}\n4 p r=X^{2}+K, \\\\\n4 q r=Y^{2}+K\n\\end{gathered}\n\\]\nwith \\(X+Y=2 r\\). Multiplying the two above equations,\n\\[\n\\begin{aligned}\n16 p q r^{2} & =\\left(X^{2}+K\\right)\\left(Y^{2}+K\\right) \\\\\n& =(X Y-K)^{2}+K(X+Y)^{2} \\\\\n& =(X Y-K)^{2}+4 K r^{2}, \\\\\n4 p q & =\\left(\\frac{X Y-K}{2 r}\\right)^{2}+K .\n\\end{aligned}\n\\]\n\nIn particular, the number \\(Z=\\frac{X Y-K}{2 r}\\) should be an integer, and so \\(4 p q=Z^{2}+K\\). By parity, \\(Z\\) is odd, and thus\n\\[\np q=z^{2}+z+k \\quad \\text { where } z=\\frac{Z-1}{2}\n\\]\nso \\(\\{p, q\\}\\) is special.\n\nProof 2. As before, we suppose that\n\\[\n\\begin{aligned}\n& x^{2}+x+k=p r \\\\\n& y^{2}+y+k=q r .\n\\end{aligned}\n\\]\n\nSubtracting, we have\n\\[\n(x+y+1)(x-y)=r(p-q) .\n\\]\n\nAs before, we have \\(x+y=r-1\\), so \\(x-y=p-q\\), and\n\\[\n\\begin{aligned}\n& x=\\frac{1}{2}(r+p-q-1) \\\\\n& y=\\frac{1}{2}(r+q-p-1)\n\\end{aligned}\n\\]\n\nThen,\n\\[\n\\begin{aligned}\nk=p r-x^{2}-x & =\\frac{1}{4}\\left(4 p r-(r+p-q-1)^{2}-2(r+p-q-1)\\right) \\\\\n& =\\frac{1}{4}\\left(4 p r-(r+p-q)^{2}+1\\right) \\\\\n& =\\frac{1}{4}\\left(2 p q+2 p r+2 q r-p^{2}-q^{2}-r^{2}+1\\right),\n\\end{aligned}\n\\]\nwhich is symmetric in \\(p, q, r\\), so\n\\[\np q=z^{2}+z+k \\quad \\text { where } z=\\frac{1}{2}(p+q-r-1)\n\\]\nand \\(\\{p, q\\}\\) is special.\nNow we settle the problem by induction on \\(|S|\\), with \\(|S| \\leqslant 3\\) clear.\nSuppose we have proven it for \\(|S|=n\\) and consider \\(|S|=n+1\\). Let \\(r\\) be the largest prime in \\(S\\); the claim tells us that in any valid cycle of primes:\n- the neighbors of \\(r\\) are uniquely determined, and\n- removing \\(r\\) from the cycle results in a smaller valid cycle.\n\nIt follows that there is at most one valid cycle, completing the inductive step.\nComment. The statement is not as inapplicable as it might seem. For example, for \\(k=41\\), the following 385 primes form a valid cycle of primes:\n\\[\n\\begin{aligned}\n& 53,4357,104173,65921,36383,99527,193789,2089123,1010357,2465263,319169,15559,3449,2647,1951,152297, \\\\\n& 542189,119773,91151,66431,222137,1336799,469069,45613,1047941,656291,355867,146669,874879,2213327, \\\\\n& 305119,3336209,1623467,520963,794201,1124833,28697,15683,42557,6571,39607,1238833,835421,2653681, \\\\\n& 5494387,9357539,511223,1515317,8868173,114079681,59334071,22324807,3051889,5120939,7722467,266239, \\\\\n& 693809,3931783,1322317,100469,13913,74419,23977,1361,62983,935021,512657,1394849,216259,45827, \\\\\n& 31393,100787,1193989,600979,209543,357661,545141,19681,10691,28867,165089,2118023,6271891,12626693, \\\\\n& 21182429,1100467,413089,772867,1244423,1827757,55889,1558873,5110711,1024427,601759,290869,91757, \\\\\n& 951109,452033,136471,190031,4423,9239,15809,24133,115811,275911,34211,877,6653,88001,46261,317741, \\\\\n& 121523,232439,379009,17827,2699,15937,497729,335539,205223,106781,1394413,4140947,8346383,43984757, \\\\\n& 14010721,21133961,729451,4997297,1908223,278051,529747,40213,768107,456821,1325351,225961,1501921, \\\\\n& 562763,75527,5519,9337,14153,499,1399,2753,14401,94583,245107,35171,397093,195907,2505623,34680911, \\\\\n& 18542791,7415917,144797293,455529251,86675291,252704911,43385123,109207907,204884269,330414209, \\\\\n& 14926789,1300289,486769,2723989,907757,1458871,65063,4561,124427,81343,252887,2980139,1496779, \\\\\n& 3779057,519193,47381,135283,268267,446333,669481,22541,54167,99439,158357,6823,32497,1390709, \\\\\n& 998029,670343,5180017,13936673,2123491,4391941,407651,209953,77249,867653,427117,141079,9539,227, \\\\\n& 1439,18679,9749,25453,3697,42139,122327,712303,244261,20873,52051,589997,4310569,1711069,291563, \\\\\n& 3731527,11045429,129098443,64620427,162661963,22233269,37295047,1936969,5033449,725537,1353973, \\\\\n& 6964457,2176871,97231,7001,11351,55673,16747,169003,1218571,479957,2779783,949609,4975787,1577959, \\\\\n& 2365007,3310753,79349,23189,107209,688907,252583,30677,523,941,25981,205103,85087,1011233,509659, \\\\\n& 178259,950479,6262847,2333693,305497,3199319,9148267,1527563,466801,17033,9967,323003,4724099, \\\\\n& 14278309,2576557,1075021,6462593,2266021,63922471,209814503,42117791,131659867,270892249,24845153, \\\\\n& 12104557,3896003,219491,135913,406397,72269,191689,2197697,1091273,2727311,368227,1911661,601883, \\\\\n& 892657,28559,4783,60497,31259,80909,457697,153733,11587,1481,26161,15193,7187,2143,21517,10079, \\\\\n& 207643,1604381,657661,126227,372313,2176331,748337,64969,844867,2507291,29317943,14677801,36952793, \\\\\n& 69332267,111816223,5052241,8479717,441263,3020431,1152751,13179611,38280013,6536771,16319657, \\\\\n& 91442699,30501409,49082027,72061511,2199433,167597,317963,23869,2927,3833,17327,110879,285517, \\\\\n& 40543,4861,21683,50527,565319,277829,687917,3846023,25542677,174261149,66370753,9565711,1280791, \\\\\n& 91393,6011,7283,31859,8677,10193,43987,11831,13591,127843,358229,58067,15473,65839,17477,74099, \\\\\n& 19603,82847,21851,61 .\n\\end{aligned}\n\\]", "source_pdf": "imosl_2022.pdf", "notes": "fallback-regex"}
{"id": "IMO-2023-4", "contest": "IMO", "year": "2023", "problem_number": "A3", "problem": "Let \\(x_{1}, x_{2}, \\ldots, x_{2023}\\) be distinct real positive numbers such that\n\\[\na_{n}=\\sqrt{\\left(x_{1}+x_{2}+\\cdots+x_{n}\\right)\\left(\\frac{1}{x_{1}}+\\frac{1}{x_{2}}+\\cdots+\\frac{1}{x_{n}}\\right)}\n\\]\nis an integer for every \\(n=1,2, \\ldots, 2023\\). Prove that \\(a_{2023} \\geqslant 3034\\).\n(Netherlands)", "solution": "1. We start with some basic observations. First note that the sequence \\(a_{1}, a_{2}, \\ldots, a_{2023}\\) is increasing and thus, since all elements are integers, \\(a_{n+1}-a_{n} \\geqslant 1\\). We also observe that \\(a_{1}=1\\) and\n\\[\na_{2}=\\sqrt{\\left(x_{1}+x_{2}\\right)\\left(\\frac{1}{x_{1}}+\\frac{1}{x_{2}}\\right)}>2\n\\]\nby Cauchy-Schwarz inequality and using \\(x_{1} \\neq x_{2}\\). So, \\(a_{2} \\geqslant 3\\).\nNow, we proceed to the main part of the argument. We observe that 3034 is about three halves of 2023. Motivated by this observation, we will prove the following.\nClaim. If \\(a_{n+1}-a_{n}=1\\), then \\(a_{n+2}-a_{n+1} \\geqslant 2\\).\nIn other words, the sequence has to increase by at least 2 at least half of the times. Assuming the claim is true, since \\(a_{1}=1\\), we would be done since\n\\[\n\\begin{aligned}\na_{2023} & =\\left(a_{2023}-a_{2022}\\right)+\\left(a_{2022}-a_{2021}\\right)+\\cdots+\\left(a_{2}-a_{1}\\right)+a_{1} \\\\\n& \\geqslant(2+1) \\cdot 1011+1 \\\\\n& =3034\n\\end{aligned}\n\\]\n\nWe now prove the claim. We start by observing that\n\\[\n\\begin{aligned}\na_{n+1}^{2}= & \\left(x_{1}+\\cdots+x_{n+1}\\right)\\left(\\frac{1}{x_{1}}+\\cdots+\\frac{1}{x_{n+1}}\\right) \\\\\n= & \\left(x_{1}+\\cdots+x_{n}\\right)\\left(\\frac{1}{x_{1}}+\\cdots+\\frac{1}{x_{n}}\\right)+1 \\\\\n& \\quad+\\frac{1}{x_{n+1}}\\left(x_{1}+\\cdots+x_{n}\\right)+x_{n+1}\\left(\\frac{1}{x_{1}}+\\cdots+\\frac{1}{x_{n}}\\right) \\\\\n\\geqslant & a_{n}^{2}+1+2 \\sqrt{\\frac{1}{x_{n+1}}\\left(x_{1}+\\cdots+x_{n}\\right) \\cdot x_{n+1}\\left(\\frac{1}{x_{1}}+\\cdots+\\frac{1}{x_{n}}\\right)} \\\\\n= & a_{n}^{2}+1+2 a_{n} \\\\\n= & \\left(a_{n}+1\\right)^{2}\n\\end{aligned}\n\\]\nwhere we used AM-GM to obtain the inequality. In particular, if \\(a_{n+1}=a_{n}+1\\), then\n\\[\n\\frac{1}{x_{n+1}}\\left(x_{1}+\\cdots+x_{n}\\right)=x_{n+1}\\left(\\frac{1}{x_{1}}+\\cdots+\\frac{1}{x_{n}}\\right)\n\\]\n\nNow, assume for the sake of contradiction that both \\(a_{n+1}=a_{n}+1\\) and \\(a_{n+2}=a_{n+1}+1\\) hold. In this case, (1) gives\n\\[\n\\frac{1}{x_{n+2}}\\left(x_{1}+\\cdots+x_{n+1}\\right)=x_{n+2}\\left(\\frac{1}{x_{1}}+\\cdots+\\frac{1}{x_{n+1}}\\right) .\n\\]\n\nWe can rewrite this relation as\n\\[\n\\frac{x_{n+1}}{x_{n+2}}\\left(\\frac{1}{x_{n+1}}\\left(x_{1}+\\cdots+x_{n}\\right)+1\\right)=\\frac{x_{n+2}}{x_{n+1}}\\left(x_{n+1}\\left(\\frac{1}{x_{1}}+\\cdots+\\frac{1}{x_{n}}\\right)+1\\right)\n\\]\n\nFrom (1) again, we conclude that \\(x_{n+1}=x_{n+2}\\) which is a contradiction.\n\nSolution 2. The trick is to compare \\(a_{n+2}\\) and \\(a_{n}\\). Observe that\n\\[\n\\begin{aligned}\na_{n+2}^{2}= & \\left(x_{1}+\\cdots+x_{n+2}\\right)\\left(\\frac{1}{x_{1}}+\\cdots+\\frac{1}{x_{n+2}}\\right) \\\\\n= & \\left(x_{1}+\\cdots+x_{n}\\right)\\left(\\frac{1}{x_{1}}+\\cdots+\\frac{1}{x_{n}}\\right)+\\left(x_{n+1}+x_{n+2}\\right)\\left(\\frac{1}{x_{n+1}}+\\frac{1}{x_{n+2}}\\right) \\\\\n& \\quad+\\left(x_{1}+\\cdots+x_{n}\\right)\\left(\\frac{1}{x_{n+1}}+\\frac{1}{x_{n+2}}\\right)+\\left(x_{n+1}+x_{n+2}\\right)\\left(\\frac{1}{x_{1}}+\\cdots+\\frac{1}{x_{n}}\\right) \\\\\n\\geqslant & a_{n}^{2}+\\left(x_{n+1}+x_{n+2}\\right)\\left(\\frac{1}{x_{n+1}}+\\frac{1}{x_{n+2}}\\right) \\\\\n& \\quad+2 \\sqrt{\\left(x_{n+1}+x_{n+2}\\right)\\left(\\frac{1}{x_{n+1}}+\\frac{1}{x_{n+2}}\\right)\\left(x_{1}+\\cdots+x_{n}\\right)\\left(\\frac{1}{x_{1}}+\\cdots+\\frac{1}{x_{n}}\\right)} \\\\\n= & a_{n}^{2}+\\left(x_{n+1}+x_{n+2}\\right)\\left(\\frac{1}{x_{n+1}}+\\frac{1}{x_{n+2}}\\right)+2 a_{n} \\sqrt{\\left(x_{n+1}+x_{n+2}\\right)\\left(\\frac{1}{x_{n+1}}+\\frac{1}{x_{n+2}}\\right)},\n\\end{aligned}\n\\]\nwhere we used AM-GM to obtain the inequality. Furthermore, we have\n\\[\n\\left(x_{n+1}+x_{n+2}\\right)\\left(\\frac{1}{x_{n+1}}+\\frac{1}{x_{n+2}}\\right)>4\n\\]\nbecause \\(x_{n+1} \\neq x_{n+2}\\) by assumption. Therefore, it follows that\n\\[\na_{n+2}^{2}>a_{n}^{2}+4+4 a_{n}=\\left(a_{n}+2\\right)^{2}\n\\]\n\nBecause \\(a_{n+2}\\) and \\(a_{n}\\) are both positive integers, we conclude that\n\\[\na_{n+2} \\geqslant a_{n}+3 .\n\\]\n\nA simple induction gives \\(a_{2 k+1} \\geqslant 3 k+a_{1}\\) for every \\(k \\geqslant 0\\). Since \\(a_{1}=1\\), it follows that \\(a_{2 k+1} \\geqslant 3 k+1\\). We get the desired conclusion for \\(k=1011\\).\n\nComment 1. A similar argument as in Solution 2 shows that \\(a_{2} \\geqslant 3\\) and \\(a_{2 k} \\geqslant 3 k\\) for every \\(k \\geqslant 1\\). Actually, these lower bounds on \\(a_{n}\\) are sharp (at least for \\(n \\leqslant 2023\\) ). In other words, there exists a sequence of distinct values \\(x_{1}, \\ldots, x_{2023}>0\\) for which\n\\[\na_{n}= \\begin{cases}\\frac{3 n-1}{2} & \\text { if } n \\text { is odd }, \\\\ \\frac{3 n}{2} & \\text { if } n \\text { is even },\\end{cases}\n\\]\nfor \\(n=1, \\ldots, 2023\\). The value of \\(x_{1}\\) can be chosen arbitrarily. The next values can be obtained inductively by solving the quadratic equation\n\\[\na_{n+1}^{2}=a_{n}^{2}+1+\\left(\\sum_{i=1}^{n} x_{i}\\right) \\frac{1}{x_{n+1}}+\\left(\\sum_{i=1}^{n} \\frac{1}{x_{i}}\\right) x_{n+1}\n\\]\nfor \\(x_{n+1}\\). Computation gives, for \\(n \\geqslant 1\\),\n\\[\nx_{n+1}= \\begin{cases}\\frac{3 n}{2\\left(\\sum_{i=1}^{n} \\frac{1}{x_{i}}\\right)} & \\text { if } n \\text { is even } \\\\ \\frac{6 n+1 \\pm 3 \\sqrt{n(3 n+2)}}{2\\left(\\sum_{i=1}^{n} \\frac{1}{x_{i}}\\right)} & \\text { if } n \\text { is odd }\\end{cases}\n\\]\n\nOne can check (with the help of a computer), that the values \\(x_{1}, \\ldots, x_{2023}\\) obtained by choosing \\(x_{1}=1\\) and \" + \" every time in the odd case are indeed distinct.\n\nIt is interesting to note that the discriminant always vanishes in the even case. This is a consequence of \\(a_{n+1}=a_{n}+1\\) being achieved as an equality case of AM-GM. Another cute observation is that the ratio \\(x_{2} / x_{1}\\) is equal to the fourth power of the golden ratio.\n\nComment 2. The estimations in Solutions 1 and 2 can be made more efficiently if one applies the following form of the Cauchy-Schwarz inequality instead:\n\\[\n\\sqrt{(a+b)(c+d)} \\geqslant \\sqrt{a c}+\\sqrt{b d}\n\\]\nfor arbitrary nonnegative numbers \\(a, b, c, d\\). Equality occurs if and only if \\(a: c=b: d=(a+b):(c+d)\\).\nFor instance, by applying (2) to \\(a=x_{1}+\\cdots+x_{n}, b=x_{n+1}, c=\\frac{1}{x_{1}}+\\cdots+\\frac{1}{x_{n}}\\) and \\(d=\\frac{1}{x_{n+1}}\\) we get\n\\[\n\\begin{aligned}\na_{n+1} & =\\sqrt{\\left(x_{1}+\\cdots+x_{n}+x_{n+1}\\right)\\left(\\frac{1}{x_{1}}+\\cdots+\\frac{1}{x_{n}}+\\frac{1}{x_{n+1}}\\right)} \\\\\n& \\geqslant \\sqrt{\\left(x_{1}+\\cdots+x_{n}\\right)\\left(\\frac{1}{x_{1}}+\\cdots+\\frac{1}{x_{n}}\\right)}+\\sqrt{x_{n+1} \\cdot \\frac{1}{x_{n+1}}}=a_{n}+1\n\\end{aligned}\n\\]\n\nA study of equality cases show that equality cannot occur twice in a row, as in Solution 1. Suppose that \\(a_{n+1}=a_{n}+1\\) and \\(a_{n+2}=a_{n+1}+1\\) for some index \\(n\\). By the equality case in (2) we have\n\\[\n\\frac{\\left(x_{1}+\\cdots+x_{n}\\right)+x_{n+1}}{\\left(\\frac{1}{x_{1}}+\\cdots+\\frac{1}{x_{n}}\\right)+\\frac{1}{x_{n+1}}}=\\frac{x_{n+1}}{1 / x_{n+1}}=x_{n+1}^{2} \\quad \\text { because } a_{n+1}=a_{n}+1\n\\]\nand\n\\[\n\\frac{x_{1}+\\cdots+x_{n}+x_{n+1}}{\\frac{1}{x_{1}}+\\cdots+\\frac{1}{x_{n}}+\\frac{1}{x_{n+1}}}=\\frac{x_{n+2}}{1 / x_{n+2}}=x_{n+2}^{2} \\quad \\text { because } a_{n+2}=a_{n+1}+1\n\\]\n\nThe left-hand sides are the same, so \\(x_{n+1}=x_{n+2}\\), but this violates the condition that \\(x_{n+1}\\) and \\(x_{n+2}\\) are distinct.\n\nThe same trick applies to Solution 2. We can compare \\(a_{n}\\) and \\(a_{n+2}\\) directly as\n\\[\n\\begin{aligned}\na_{n+2} & =\\sqrt{\\left(x_{1}+\\cdots+x_{n}+x_{n+1}+x_{n+2}\\right)\\left(\\frac{1}{x_{1}}+\\cdots+\\frac{1}{x_{n}}+\\frac{1}{x_{n+1}}+\\frac{1}{x_{n+2}}\\right)} \\\\\n& \\geqslant \\sqrt{\\left(x_{1}+\\cdots+x_{n}\\right)\\left(\\frac{1}{x_{1}}+\\cdots+\\frac{1}{x_{n}}\\right)}+\\sqrt{\\left(x_{n+1}+x_{n+2}\\right) \\cdot\\left(\\frac{1}{x_{n+1}}+\\frac{1}{x_{n+2}}\\right)} \\\\\n& =a_{n}+\\sqrt{\\left(x_{n+1}+x_{n+2}\\right) \\cdot\\left(\\frac{1}{x_{n+1}}+\\frac{1}{x_{n+2}}\\right)} \\\\\n& \\geqslant a_{n}+2 .\n\\end{aligned}\n\\]\n\nIn the last estimate, equality is not possible because \\(x_{n+1}\\) and \\(x_{n+2}\\) are distinct, so \\(a_{n+2}>a_{n}+2\\) and therefore \\(a_{n+2} \\geqslant a_{n}+3\\).", "source_pdf": "imosl_2023.pdf", "notes": "fallback-regex"}
{"id": "IMO-2023-3", "contest": "IMO", "year": "2023", "problem_number": "A6", "problem": "Let \\(k \\geqslant 2\\) be an integer. Determine all sequences of positive integers \\(a_{1}, a_{2}, \\ldots\\) for which there exists a monic polynomial \\(P\\) of degree \\(k\\) with non-negative integer coefficients such that\n\\[\nP\\left(a_{n}\\right)=a_{n+1} a_{n+2} \\cdots a_{n+k}\n\\]\nfor every integer \\(n \\geqslant 1\\).\n(Malaysia)", "solution": "Answer: The sequence ( \\(a_{n}\\) ) must be an arithmetic progression consisting of positive integers with common difference \\(d \\geqslant 0\\), and \\(P(x)=(x+d) \\cdots(x+k d)\\).\n\nCommon remarks. The following arguments and observations are implicit in the solutions given below.\n\nSuppose the sequence \\(\\left(a_{n}\\right)\\) is an arithmetic progression with common difference \\(d \\geqslant 0\\). Then it satisfies the condition with\n\\[\nP(x)=(x+d) \\cdots(x+k d)\n\\]\n\nThis settles one direction. Now suppose \\(\\left(a_{n}\\right)\\) is a sequence satisfying the condition. We will show that it is a non-decreasing arithmetic progression.\n\nSince \\(P(x)\\) has non-negative integer coefficients, it is strictly increasing on the positive real line. In particular, it holds that, for any positive integer \\(x, y\\),\n\\[\nP(x)<P(y) \\quad \\Longleftrightarrow \\quad x<y .\n\\]\n\nFurthermore, if the sequence ( \\(a_{n}\\) ) is eventually constant, then \\(P(x)=x^{k}\\) and the sequence \\(\\left(a_{n}\\right)\\) is actually constant. Indeed, if \\(P(x)\\) were not the polynomial \\(x^{k}\\), then \\(P\\left(a_{n}\\right)=a_{n+1} \\cdots a_{n+k}\\) cannot be satisfied for \\(n\\) such that \\(a_{n}=\\cdots=a_{n+k}\\). By a descending induction, we conclude that \\(\\left(a_{n}\\right)\\) is constant. Thus we can restrict to the case \\(\\left(a_{n}\\right)\\) is not eventually constant.\n\n1. We assume that \\(\\left(a_{n}\\right)\\) is not eventually constant.\nStep 1. The first goal is to show that the sequence must be increasing, i.e. \\(a_{n}<a_{n+1}\\) for all \\(n \\geqslant 1\\).\n\nFirst, by comparing the two equalities\n\\[\n\\begin{aligned}\nP\\left(a_{n}\\right) & =a_{n+1} a_{n+2} \\cdots a_{n+k} \\\\\nP\\left(a_{n+1}\\right) & =a_{n+2} \\cdots a_{n+k} a_{n+k+1}\n\\end{aligned}\n\\]\nwe observe that\n\\[\n\\begin{aligned}\n& a_{n}<a_{n+1} \\Longleftrightarrow P\\left(a_{n}\\right)<P\\left(a_{n+1}\\right) \\Longleftrightarrow a_{n+1}<a_{n+k+1}, \\\\\n& a_{n}>a_{n+1} \\Longleftrightarrow P\\left(a_{n}\\right)>P\\left(a_{n+1}\\right) \\Longleftrightarrow a_{n+1}>a_{n+k+1}, \\\\\n& a_{n}=a_{n+1} \\Longleftrightarrow P\\left(a_{n}\\right)=P\\left(a_{n+1}\\right) \\Longleftrightarrow a_{n+1}=a_{n+k+1} .\n\\end{aligned}\n\\]\n\nClaim 1. \\(\\quad a_{n} \\leqslant a_{n+1}\\) for all \\(n \\geqslant 1\\).\nProof. Suppose, to the contrary, that \\(a_{n(0)-1}>a_{n(0)}\\) for some \\(n(0) \\geqslant 2\\). We will give an infinite sequence of positive integers \\(n(0)<n(1)<\\cdots\\) satisfying\n\\[\na_{n(i)-1}>a_{n(i)} \\text { and } a_{n(i)}>a_{n(i+1)}\n\\]\n\nThen \\(a_{n(0)}, a_{n(1)}, a_{n(2)}, \\ldots\\) is an infinite decreasing sequence of positive integers, which is absurd.\nWe construct such a sequence inductively. If we have chosen \\(n(i)\\), then we let \\(n(i+1)\\) be the smallest index larger than \\(n(i)\\) such that \\(a_{n(i)}>a_{n(i+1)}\\). Note that such an index always exists and satisfies \\(n(i)+1 \\leqslant n(i+1) \\leqslant n(i)+k\\) because \\(a_{n(i)}>a_{n(i)+k}\\) by (2). We need to check that \\(a_{n(i+1)-1}>a_{n(i+1)}\\). This is immediate if \\(n(i+1)=n(i)+1\\) by construction. If \\(n(i+1) \\geqslant n(i)+2\\), then \\(a_{n(i+1)-1} \\geqslant a_{n(i)}\\) by minimality of \\(n(i+1)\\), and so \\(a_{n(i+1)-1} \\geqslant a_{n(i)}>a_{n(i+1)}\\).\n\nWe are now ready to prove that the sequence \\(a_{n}\\) is increasing. Suppose \\(a_{n}=a_{n+1}\\) for some \\(n \\geqslant 1\\). Then we also have \\(a_{n+1}=a_{n+k+1}\\) by (3), and since the sequence is non-decreasing we have \\(a_{n}=a_{n+1}=a_{n+2}=\\cdots=a_{n+k+1}\\). We repeat the argument for \\(a_{n+k}=a_{n+k+1}\\) and get that the sequence is eventually constant, which contradicts our assumption. Hence\n\\[\na_{n}<a_{n+1} \\text { for all } n \\geqslant 1\n\\]\n\nStep 2. The next and final goal is to prove that the sequence \\(a_{n}\\) is an arithmetic progression. Observe that we can make differences of terms appear as follows\n\\[\n\\begin{aligned}\nP\\left(a_{n}\\right) & =a_{n+1} a_{n+2} \\cdots a_{n+k} \\\\\n& =\\left(a_{n}+\\left(a_{n+1}-a_{n}\\right)\\right)\\left(a_{n}+\\left(a_{n+2}-a_{n}\\right)\\right) \\cdots\\left(a_{n}+\\left(a_{n+k}-a_{n}\\right)\\right) .\n\\end{aligned}\n\\]\n\nWe will prove that, for \\(n\\) large enough, the sum\n\\[\n\\left(a_{n+1}-a_{n}\\right)+\\left(a_{n+2}-a_{n}\\right)+\\cdots+\\left(a_{n+k}-a_{n}\\right)\n\\]\nis equal to the coefficient \\(b\\) of the term \\(x^{k-1}\\) in \\(P\\). The argument is based on the following claim.\nClaim 2. There exists a bound \\(A\\) with the following properties:\n1. If \\(\\left(c_{1}, \\ldots, c_{k}\\right)\\) is a \\(k\\)-tuple of positive integers with \\(c_{1}+\\cdots+c_{k}>b\\), then for every \\(x \\geqslant A\\) we have \\(P(x)<\\left(x+c_{1}\\right)\\left(x+c_{2}\\right) \\cdots\\left(x+c_{k}\\right)\\).\n2. If \\(\\left(c_{1}, \\ldots, c_{k}\\right)\\) is a \\(k\\)-tuple of positive integers with \\(c_{1}+\\cdots+c_{k}<b\\), then for every \\(x \\geqslant A\\) we have \\(P(x)>\\left(x+c_{1}\\right)\\left(x+c_{2}\\right) \\cdots\\left(x+c_{k}\\right)\\).\nProof. It suffices to show parts 1 and 2 separately, because then we can take the maximum of two bounds.\n\nWe first show part 1 . For each single \\(\\left(c_{1}, \\ldots, c_{k}\\right)\\) such a bound \\(A\\) exists since\n\\[\nP(x)-\\left(x+c_{1}\\right)\\left(x+c_{2}\\right) \\cdots\\left(x+c_{k}\\right)=\\left(b-\\left(c_{1}+\\cdots+c_{k}\\right)\\right) x^{k-1}+(\\text { terms of degree } \\leqslant k-2)\n\\]\nhas negative leading coefficient and hence takes negative values for \\(x\\) large enough.\nSuppose \\(A\\) is a common bound for all tuples \\(c=\\left(c_{1}, \\ldots, c_{k}\\right)\\) satisfying \\(c_{1}+\\cdots+c_{k}=b+1\\) (note that there are only finitely many such tuples). Then, for any tuple \\(c^{\\prime}=\\left(c_{1}^{\\prime}, \\ldots, c_{k}^{\\prime}\\right)\\) with \\(c_{1}^{\\prime}+\\cdots+c_{k}^{\\prime}>b\\), there exists a tuple \\(c=\\left(c_{1}, \\ldots, c_{k}\\right)\\) with \\(c_{1}+\\cdots+c_{k}=b+1\\) and \\(c_{i}^{\\prime} \\geqslant c_{i}\\), and then the inequality for \\(c^{\\prime}\\) follows from the inequality for \\(c\\).\n\nWe can show part 2 either in a similar way, or by using that there are only finitely many such tuples.\n\nTake \\(A\\) satisfying the assertion of Claim 2, and take \\(N\\) such that \\(n \\geqslant N\\) implies \\(a_{n} \\geqslant A\\). Then for each \\(n \\geqslant N\\), we have\n\\[\n\\left(a_{n+1}-a_{n}\\right)+\\cdots+\\left(a_{n+k}-a_{n}\\right)=b .\n\\]\n\nBy taking the difference of this equality and the equality for \\(n+1\\), we obtain\n\\[\na_{n+k+1}-a_{n+1}=k\\left(a_{n+1}-a_{n}\\right)\n\\]\nfor every \\(n \\geqslant N\\).\nWe conclude using an extremal principle. Let \\(d=\\min \\left\\{a_{n+1}-a_{n} \\mid n \\geqslant N\\right\\}\\), and suppose it is attained at some index \\(n \\geqslant N\\). Since\n\\[\nk d=k\\left(a_{n+1}-a_{n}\\right)=a_{n+k+1}-a_{n+1}=\\sum_{i=1}^{k}\\left(a_{n+i+1}-a_{n+i}\\right)\n\\]\nand each summand is at least \\(d\\), we conclude that \\(d\\) is also attained at \\(n+1, \\ldots, n+k\\), and inductively at all \\(n^{\\prime} \\geqslant n\\). We see that the equation \\(P(x)=(x+d)(x+2 d) \\cdots(x+k d)\\) is true for infinitely many values of \\(x\\) (all \\(a_{n^{\\prime}}\\) for \\(n^{\\prime} \\geqslant n\\) ), hence this is an equality of polynomials. Finally we use (backward) induction to show that \\(a_{n+1}-a_{n}=d\\) for every \\(n \\geqslant 1\\).\n\nSolution 2. We assume that \\(\\left(a_{n}\\right)\\) is not eventually constant. In this solution, we first prove an alternative version of Claim 1.\nClaim 3. There exist infinitely many \\(n \\geqslant 1\\) with\n\\[\na_{n} \\leqslant \\min \\left\\{a_{n+1}, \\ldots, a_{n+k}\\right\\} .\n\\]\n\nProof. Suppose not, then for all but finitely many \\(n \\geqslant 1\\), it holds that \\(a_{n}>\\min \\left\\{a_{n+1}, \\ldots, a_{n+k}\\right\\}\\). Hence for all large enough \\(n\\), there always exist some \\(1 \\leqslant l \\leqslant k\\) such that \\(a_{n}>a_{n+l}\\). This induces an infinite decreasing sequence \\(a_{n}>a_{n+l_{1}}>a_{n+l_{2}}>\\cdots\\) of positive integers, which is absurd.\n\nWe use Claim 3 to quickly settle the case \\(P(x)=x^{k}\\). In that case, for every \\(n\\) with \\(a_{n} \\leqslant \\min \\left\\{a_{n+1}, \\ldots, a_{n+k}\\right\\}\\), since \\(a_{n+1} \\cdots a_{n+k}=a_{n}^{k}\\), it implies \\(a_{n}=a_{n+1}=\\cdots=a_{n+k}\\). This shows that the sequence is eventually constant, which contradicts our assumption.\n\nFrom now on, assume\n\\[\nP(x)>x^{k} \\text { for all } x>0 .\n\\]\n\nClaim 4. For every \\(M>0\\), there exists some \\(N>0\\) such that \\(a_{n}>M\\) for all \\(n>N\\).\nProof. Suppose there exists some \\(M>0\\), such that \\(a_{n} \\leqslant M\\) for infinitely many \\(n\\). For each \\(i\\) with \\(a_{i} \\leqslant M\\), we consider the \\(k\\)-tuple ( \\(a_{i+1}, \\ldots, a_{i+k}\\) ). Then each of the terms in the \\(k\\)-tuple is bounded from above by \\(P\\left(a_{i}\\right)\\), and hence by \\(P(M)\\) too. Since the number of such \\(k\\)-tuples is bounded by \\(P(M)^{k}\\), we deduce by the Pigeonhole Principle that there exist some indices \\(i<j\\) such that \\(\\left(a_{i+1}, \\ldots, a_{i+k}\\right)=\\left(a_{j+1}, \\ldots, a_{j+k}\\right)\\). Since \\(a_{n}\\) is uniquely determined by the \\(k\\) terms before it, we conclude that \\(a_{i+k+1}=a_{j+k+1}\\) must hold, and similarly \\(a_{i+l}=a_{j+l}\\) for all \\(l \\geqslant 0\\), so the sequence is eventually periodic, for some period \\(p=j-i\\).\n\nTake \\(K\\) such that \\(a_{n}=a_{n+p}\\) for every \\(n \\geqslant K\\). Then, by taking the products of the inequalities\n\\[\na_{n}^{k}<P\\left(a_{n}\\right)=a_{n+1} \\cdots a_{n+k}\n\\]\nfor \\(K \\leqslant n \\leqslant K+p-1\\), we obtain\n\\[\n\\begin{aligned}\n\\prod_{n=K}^{K+p-1} a_{n}^{k} & <\\prod_{n=K}^{K+p-1} a_{n+1} \\cdots a_{n+k} \\\\\n& =a_{K+1} a_{K+2}^{2} \\cdots a_{K+k-1}^{k-1}\\left(\\prod_{n=K+k}^{K+p} a_{n}\\right)^{k} a_{K+p+1}^{k-1} \\cdots a_{K+p+k-2}^{2} a_{K+p+k-1} \\\\\n& =\\left(\\prod_{n=K}^{K+p-1} a_{n}\\right)^{k} \\quad(\\text { by periodicity }),\n\\end{aligned}\n\\]\nwhich is a contradiction.\nWrite \\(P(x)=x^{k}+b x^{k-1}+Q(x)\\), where \\(Q(x)\\) is of degree at most \\(k-2\\). Take \\(M\\) such that \\(x>M\\) implies \\(x^{k-1}>Q(x)\\).\nClaim 5. There exist non-negative integers \\(b_{1}, \\cdots, b_{k}\\) such that \\(P(x)=\\left(x+b_{1}\\right) \\cdots\\left(x+b_{k}\\right)\\), and such that, for infinitely many \\(n \\geqslant 1\\), we have \\(a_{n+i}=a_{n}+b_{i}\\) for every \\(1 \\leqslant i \\leqslant k\\).\nProof. By Claims 3 and 4, there are infinitely many \\(n\\) such that\n\\[\na_{n}>M \\text { and } a_{n} \\leqslant \\min \\left\\{a_{n+1}, \\ldots, a_{n+k}\\right\\} .\n\\]\n\nCall such indices \\(n\\) to be good. We claim that if \\(n\\) is a good index then\n\\[\n\\max \\left\\{a_{n+1}, \\ldots, a_{n+k}\\right\\} \\leqslant a_{n}+b\n\\]\n\nIndeed, if \\(a_{n+i} \\geqslant a_{n}+b+1\\), then together with \\(a_{n} \\leqslant \\min \\left\\{a_{n+1}, \\ldots, a_{n+k}\\right\\}\\) and \\(a_{n}^{k-1}>Q\\left(a_{n}\\right)\\), we have\n\\[\na_{n}^{k}+(b+1) a_{n}^{k-1}>a_{n}^{k}+b a_{n}^{k-1}+Q\\left(a_{n}\\right)=P\\left(a_{n}\\right) \\geqslant\\left(a_{n}+b+1\\right) a_{n}^{k-1}\n\\]\na contradiction.\nHence for each good index \\(n\\), we may write \\(a_{n+i}=a_{n}+b_{i}\\) for all \\(1 \\leqslant i \\leqslant k\\) for some choices of \\(\\left(b_{1}, \\ldots, b_{k}\\right)\\) (which may depend on \\(n\\) ) and \\(0 \\leqslant b_{i} \\leqslant b\\). Again by Pigeonhole Principle, some \\(k\\)-tuple ( \\(b_{1}, \\ldots, b_{k}\\) ) must be chosen for infinitely such good indices \\(n\\). This means that the equation \\(P\\left(a_{n}\\right)=\\left(a_{n}+b_{1}\\right) \\cdots\\left(a_{n}+b_{k}\\right)\\) is satisfied by infinitely many good indices \\(n\\). By Claim 4, \\(a_{n}\\) is unbounded among these \\(a_{n}\\) 's, hence \\(P(x)=\\left(x+b_{1}\\right) \\cdots\\left(x+b_{k}\\right)\\) must hold identically.\nClaim 6. We have \\(b_{i}=i b_{1}\\) for all \\(1 \\leqslant i \\leqslant k\\).\nProof. Call an index \\(n\\) excellent if \\(a_{n+i}=a_{n}+b_{i}\\) for every \\(1 \\leqslant i \\leqslant k\\). From Claim 5 we know there are infinitely many excellent \\(n\\).\n\nWe first show that for any pair \\(1 \\leqslant i<j \\leqslant k\\) there is \\(1 \\leqslant l \\leqslant k\\) such that \\(b_{j}=b_{i}+b_{l}\\). Indeed, for such \\(i\\) and \\(j\\) and for excellent \\(n, a_{n}+b_{j}\\) (which is equal to \\(a_{n+j}\\) ) divides \\(P\\left(a_{n+i}\\right)= \\prod_{l=1}^{k}\\left(a_{n}+b_{i}+b_{l}\\right)\\), and hence divides \\(\\prod_{l=1}^{k}\\left(b_{i}+b_{l}-b_{j}\\right)\\). Since \\(a_{n}+b_{j}\\) is unbounded among excellent \\(n\\), we have \\(\\prod_{l=1}^{k}\\left(b_{i}+b_{l}-b_{j}\\right)=0\\), hence there is \\(l\\) such that \\(b_{j}=b_{i}+b_{l}\\).\n\nIn particular, \\(b_{j}=b_{i}+b_{l} \\geqslant b_{i}\\), i.e. ( \\(b_{1}, \\ldots, b_{k}\\) ) is non-decreasing.\nSuppose \\(b_{1}=0\\) and \\(n\\) is an excellent number. In particular, it holds that \\(a_{n}=a_{n+1}\\). Moreover, since\n\\[\na_{n+k+1} P\\left(a_{n}\\right)=a_{n+1} \\cdots a_{n+k+1}=a_{n+1} P\\left(a_{n+1}\\right)\n\\]\nwe have \\(a_{n}=a_{n+1}=a_{n+k+1}\\), which divides \\(P\\left(a_{n+i}\\right)=\\prod_{l=1}^{k}\\left(a_{n}+b_{i}+b_{l}\\right)\\) for each \\(1 \\leqslant i \\leqslant k\\). Hence \\(a_{n}\\) divides \\(\\prod_{l=1}^{k}\\left(b_{i}+b_{l}\\right)\\). By the same reasoning, we have \\(b_{i}+b_{l}=0\\) for some \\(l\\), but since \\(b_{i}, b_{l} \\geqslant 0\\) we obtain \\(b_{i}=0\\) for each \\(1 \\leqslant i \\leqslant k\\).\n\nNow suppose \\(b_{1} \\geqslant 1\\). Then, for each \\(1 \\leqslant i<j \\leqslant k\\), we have \\(b_{j}-b_{i}=b_{l} \\geqslant b_{1} \\geqslant 1\\), hence ( \\(b_{1}, \\ldots, b_{k}\\) ) is strictly increasing. Therefore, the \\(k-1\\) elements \\(b_{2}<b_{3}<\\cdots<b_{k}\\) are exactly equal to \\(b_{1}+b_{1}<\\cdots<b_{1}+b_{k-1}\\), since they cannot be equal to \\(b_{1}+b_{k}\\). This gives \\(b_{i}=i b_{1}\\) for all \\(1 \\leqslant i \\leqslant k\\) as desired.\n\nClaim 6 implies \\(P(x)=(x+d)(x+2 d) \\cdots(x+k d)\\) for some \\(d \\geqslant 1\\), and there are infinitely many indices \\(n\\) with \\(a_{n+i}=a_{n}+i d\\) for \\(1 \\leqslant i \\leqslant k\\). By backwards induction, \\(P\\left(a_{n-1}\\right)= a_{n} \\cdots a_{n+k-1}\\) implies \\(a_{n-1}=a_{n}-d\\), and so on. Thus \\(a_{1}, \\ldots, a_{n}\\) forms an arithmetic progression with common difference \\(d\\). Since \\(n\\) can be arbitrarily large, the whole sequence is an arithmetic progression too, as desired.\n\nComment 1. A typical solution would first show some kind of increasing property (assuming \\(a_{n}\\) is not constant), and then use that property to deduce informations on the numbers \\(a_{n+i}-a_{n}(1 \\leqslant i \\leqslant k)\\) and/or on the polynomial \\(P\\).\n\nSolution 1 shows a strict one: \\(a_{n}<a_{n+1}\\) (arguments after Claim 1), which makes the latter part easier. Solution 2 (Claims 3 and 4) shows only weaker increasing properties, which require more complicated/tricky arguments in the latter part but still can solve the problem.\n\nComment 2. It would be interesting to sort out the case when \\(P\\) can take negative integer coefficients, or ( \\(a_{n}\\) ) is just an integer sequence. Then a decreasing arithmetic progression is possible too, yet that is not the only possibility. There exist bounded examples such as \\(1,-1,1,-1, \\ldots\\) with \\(P(x)=-x^{2}\\), or \\(0,1,-1,0,1,-1, \\ldots\\) with \\(P(x)=x^{2}-1\\). If furthermore \\(P\\) is allowed to be non-monic, then the situation is even more unclear. For instance, the sequence \\(1,2,4,8, \\ldots\\) works for the polynomial \\(P(x)=8 x^{2}\\).", "source_pdf": "imosl_2023.pdf", "notes": "fallback-regex"}
{"id": "IMO-2023-2", "contest": "IMO", "year": "2023", "problem_number": "G4", "problem": "Let \\(A B C\\) be an acute-angled triangle with \\(A B<A C\\). Denote its circumcircle by \\(\\Omega\\) and denote the midpoint of \\(\\operatorname{arc} C A B\\) by \\(S\\). Let the perpendicular from \\(A\\) to \\(B C\\) meet \\(B S\\) and \\(\\Omega\\) at \\(D\\) and \\(E \\neq A\\) respectively. Let the line through \\(D\\) parallel to \\(B C\\) meet line \\(B E\\) at \\(L\\) and denote the circumcircle of triangle \\(B D L\\) by \\(\\omega\\). Let \\(\\omega\\) meet \\(\\Omega\\) again at \\(P \\neq B\\).\n\nProve that the line tangent to \\(\\omega\\) at \\(P\\), and line \\(B S\\) intersect on the internal bisector of \\(\\angle B A C\\).\n(Portugal)", "solution": "1 (Triangles in Perspective). Let \\(S^{\\prime}\\) be the midpoint of \\(\\operatorname{arc} B C\\) of \\(\\Omega\\), diametrically opposite to \\(S\\) so \\(S S^{\\prime}\\) is a diameter in \\(\\Omega\\) and \\(A S^{\\prime}\\) is the angle bisector of \\(\\angle B A C\\). Let the tangent of \\(\\omega\\) at \\(P\\) meet \\(\\Omega\\) again at \\(Q \\neq P\\), then we have \\(\\angle S Q S^{\\prime}=90^{\\circ}\\).\n\nWe will show that triangles \\(A P D\\) and \\(S^{\\prime} Q S\\) are similar and their corresponding sides are parallel. Then it will follow that the lines connecting the corresponding vertices, namely line \\(A S^{\\prime}\\), that is the angle bisector of \\(\\angle B A C\\), line \\(P Q\\), that is the tangent to \\(\\omega\\) at \\(P\\), and \\(D S\\) are concurrent. Note that the sides \\(A D\\) and \\(S^{\\prime} S\\) have opposite directions, so the three lines cannot be parallel.\n![](https://cdn.mathpix.com/cropped/2025_08_23_2cb0be1b73ef2aa9a4e9g-65.jpg?height=1083&width=1346&top_left_y=1099&top_left_x=359)\n\nFirst we show that \\(A P \\perp D P\\). Indeed, from cyclic quadrilaterals \\(A P B E\\) and \\(D P L B\\) we can see that\n\\[\n\\angle P A D=\\angle P A E=180^{\\circ}-\\angle E B P=\\angle P B L=\\angle P D L=90^{\\circ}-\\angle A D P .\n\\]\n\nThen, in triangle \\(A P D\\) we have \\(\\angle D P A=180^{\\circ}-\\angle P A D-\\angle A D P=90^{\\circ}\\).\nNow we can see that:\n- Both lines \\(A D E\\) and \\(S S^{\\prime}\\) are perpendicular to \\(B C\\), so \\(A D \\| S^{\\prime} S\\).\n- Line \\(P Q\\) is tangent to circle \\(\\omega\\) at \\(P\\) so \\(\\angle D P Q=\\angle D B P=\\angle S B P=\\angle S Q P\\); it follows that \\(P D \\| Q S\\).\n- Finally, since \\(A P \\perp P D \\| Q S \\perp S^{\\prime} Q\\), we have \\(A P \\| S^{\\prime} Q\\) as well.\n\nHence the corresponding sides of triangles \\(A P D\\) and \\(S^{\\prime} Q S\\) are parallel completing the solution.\n\nSolution 2 (Pascal). Again, let \\(S^{\\prime}\\) be the midpoint of arc \\(B C\\), diametrically opposite to \\(S\\), so \\(A E S^{\\prime} S\\) is an isosceles trapezoid, and \\(\\angle S^{\\prime} B S=\\angle S^{\\prime} P S=90^{\\circ}\\). Let lines \\(A E\\) and \\(P S^{\\prime}\\) meet at \\(T\\) and let \\(A P\\) and \\(S^{\\prime} B\\) meet at point \\(M\\).\n\nWe will need that points \\(L, P, S\\) are collinear, and points \\(T\\) and \\(M\\) lie on circle \\(\\omega\\).\n- From \\(\\angle L P B=\\angle L D B=90^{\\circ}-\\angle B D E=90^{\\circ}-\\angle B S S^{\\prime}=\\angle S S^{\\prime} B=180^{\\circ}-\\angle B P S\\) we get \\(\\angle L P B+\\angle B P S=180^{\\circ}\\), so \\(L, P\\) and \\(S\\) are indeed collinear.\n- Since \\(S S^{\\prime}\\) is a diameter in \\(\\Omega\\), lines \\(L P S\\) and \\(P T S^{\\prime}\\) are perpendicular. We also have \\(L D \\| B C \\perp A E\\) hence \\(\\angle L D T=\\angle L P T=90^{\\circ}\\) and therefore \\(T \\in \\omega\\).\n- By \\(\\angle L P M=\\angle S P A=\\angle S E A=\\angle E A S^{\\prime}=\\angle E B S^{\\prime}=\\angle L B M\\), point \\(M\\) is concyclic with \\(B, P, L\\) so \\(M \\in \\omega\\).\n![](https://cdn.mathpix.com/cropped/2025_08_23_2cb0be1b73ef2aa9a4e9g-67.jpg?height=1086&width=1349&top_left_y=919&top_left_x=368)\n\nNow let \\(X\\) be the intersection of line \\(B D S\\) with the tangent of \\(\\omega\\) at \\(P\\) and apply Pascal's theorem to the degenerate cyclic hexagon \\(P P M B D T\\). This gives points \\(P P \\cap B D=X\\), \\(P M \\cap D T=A\\) and \\(M B \\cap T P=S^{\\prime}\\) are collinear so \\(X\\) lies on line \\(A S^{\\prime}\\), that is the bisector of \\(\\angle B A C\\).\n\nComment. It is easy to see that LMTD is a rectangle, but we did not need this information for the solution.\n\nSolution 3 (Projections). Let \\(A^{\\prime}\\) and \\(S^{\\prime}\\) be the points of \\(\\Omega\\) diametrically opposite to \\(A\\) and \\(S\\) respectively. It is well-known that \\(E\\) and \\(A^{\\prime}\\) are reflections with respect to \\(S S^{\\prime}\\) so \\(A S^{\\prime}\\) is the angle bisector of \\(\\angle E A A^{\\prime}\\). Define point \\(T\\) to be the intersection of \\(A E\\) and \\(P S^{\\prime}\\). As in the previous two solutions, we have: \\(\\angle D P A=90^{\\circ}\\) so \\(P D\\) passes through \\(A^{\\prime}\\); points \\(L, P, S\\) are collinear; and \\(T \\in \\omega\\).\n\nLet lines \\(A S^{\\prime}\\) and \\(P D A^{\\prime}\\) meet at \\(R\\). From the angles of triangles \\(P R S^{\\prime}\\) and \\(P T E\\) we get\n\\[\n\\angle A R P=\\angle A S^{\\prime} P+\\angle S^{\\prime} P A^{\\prime}=\\angle A E P+\\angle E P S^{\\prime}=\\angle A T P\n\\]\nso points \\(A, P, T, R\\) are concyclic. Denote their circle by \\(\\gamma\\). Due to \\(\\angle R P A=\\angle D P A=90^{\\circ}\\), segment \\(A R\\) is a diameter in \\(\\gamma\\).\n![](https://cdn.mathpix.com/cropped/2025_08_23_2cb0be1b73ef2aa9a4e9g-68.jpg?height=1181&width=1306&top_left_y=756&top_left_x=388)\n\nWe claim that circles \\(\\omega\\) and \\(\\gamma\\) are perpendicular. Let line \\(L P S\\) meet \\(\\gamma\\) again at \\(U \\neq P\\), and consider triangles \\(P L T\\) and \\(P T U\\). By \\(\\angle L P T=\\angle T P U=90^{\\circ}\\) and\n\\[\n\\angle P T L=\\angle P B L=180^{\\circ}-\\angle E B P=\\angle P A E=\\angle P A T=\\angle P U T,\n\\]\ntriangles PLT and PTU are similar. It follows that the spiral similarity that takes PLT to \\(P T U\\), maps \\(\\omega\\) to \\(\\gamma\\) and the angle of this similarity is \\(90^{\\circ}\\), so circles \\(\\omega\\) and \\(\\gamma\\) are indeed perpendicular.\n\nFinally, let lines \\(B D S\\) and \\(A R S^{\\prime}\\) meet at \\(X\\). We claim that \\(X\\) bisects \\(A R\\), so point \\(X\\) is the centre of \\(\\gamma\\) and, as \\(\\omega\\) and \\(\\gamma\\) are perpendicular, \\(P X\\) is tangent to \\(\\omega\\).\n\nLet \\(t\\) be the tangent of \\(\\omega\\) at \\(D\\). From \\(\\angle(D T, t)=\\angle T P D=\\angle S^{\\prime} P A^{\\prime}=\\angle E A S^{\\prime}\\) it can be seen that \\(t \\| A S^{\\prime}\\). Let \\(I\\) be the common point at infinity of \\(t\\) and \\(A S^{\\prime}\\). Moreover, let lines \\(L P S\\) and \\(A D T E\\) meet at \\(V\\). By projecting line \\(A S^{\\prime}\\) to circle \\(\\omega\\) through \\(D\\), then projecting \\(\\omega\\) to line \\(A E\\) through \\(L\\), finally projecting \\(A E\\) to \\(\\Omega\\) through \\(P\\), we find\n\\[\n\\frac{A X}{R X}=(A, R ; X, I) \\stackrel{D}{=}(T, P ; B, D) \\stackrel{L}{=}(T, V ; E, D) \\stackrel{P}{=}\\left(S^{\\prime}, S ; E, A^{\\prime}\\right)=-1,\n\\]\nso \\(X\\) is the midpoint of \\(A R\\).", "source_pdf": "imosl_2023.pdf", "notes": "fallback-regex"}
{"id": "IMO-2023-6", "contest": "IMO", "year": "2023", "problem_number": "G8", "problem": "Let \\(A B C\\) be an equilateral triangle. Points \\(A_{1}, B_{1}, C_{1}\\) lie inside triangle \\(A B C\\) such that triangle \\(A_{1} B_{1} C_{1}\\) is scalene, \\(B A_{1}=A_{1} C, C B_{1}=B_{1} A, A C_{1}=C_{1} B\\) and\n\\[\n\\angle B A_{1} C+\\angle C B_{1} A+\\angle A C_{1} B=480^{\\circ} .\n\\]\n\nLines \\(B C_{1}\\) and \\(C B_{1}\\) intersect at \\(A_{2}\\); lines \\(C A_{1}\\) and \\(A C_{1}\\) intersect at \\(B_{2}\\); and lines \\(A B_{1}\\) and \\(B A_{1}\\) intersect at \\(C_{2}\\).\n\nProve that the circumcircles of triangles \\(A A_{1} A_{2}, B B_{1} B_{2}, C C_{1} C_{2}\\) have two common points.", "solution": ". Let \\(\\delta_{A}, \\delta_{B}, \\delta_{C}\\) be the circumcircles of \\(\\triangle A A_{1} A_{2}, \\triangle B B_{1} B_{2}, \\triangle C C_{1} C_{2}\\). The general strategy of the solution is to find two different points having equal power with respect to \\(\\delta_{A}, \\delta_{B}, \\delta_{C}\\).\nClaim. \\(A_{1}\\) is the circumcentre of \\(A_{2} B C\\) and cyclic variations.\nProof. Since \\(A_{1}\\) lies on the perpendicular bisector of \\(B C\\) and inside \\(\\triangle B A_{2} C\\), it suffices to prove \\(\\angle B A_{1} C=2 \\angle B A_{2} C\\). This follows from\n\\[\n\\begin{aligned}\n\\angle B A_{2} C & =\\angle A_{2} B A+\\angle B A C+\\angle A C A_{2} \\\\\n& =\\frac{1}{2}\\left(\\left(180^{\\circ}-\\angle A C_{1} B\\right)+\\left(180^{\\circ}-\\angle C B_{1} A\\right)\\right)+60^{\\circ} \\\\\n& =240^{\\circ}-\\frac{1}{2}\\left(480^{\\circ}-\\angle B A_{1} C\\right) \\\\\n& =\\frac{1}{2} \\angle B A_{1} C\n\\end{aligned}\n\\]\n![](https://cdn.mathpix.com/cropped/2025_08_23_2cb0be1b73ef2aa9a4e9g-80.jpg?height=864&width=1006&top_left_y=1541&top_left_x=531)\n\nThe circumcentres above give\n\\[\n\\angle B_{1} B_{2} C_{1}=\\angle B_{1} B_{2} A=\\angle B_{2} A B_{1}=\\angle C_{1} A C_{2}=\\angle A C_{2} C_{1}=\\angle B_{1} C_{2} C_{1}\n\\]\nand so \\(B_{1} C_{1} B_{2} C_{2}\\) is cyclic. Likewise \\(C_{1} A_{1} C_{2} A_{2}\\) and \\(A_{1} B_{1} A_{2} B_{2}\\) are cyclic. Note that hexagon \\(A_{1} B_{2} C_{1} A_{2} B_{1} C_{2}\\) is not cyclic since\n\\[\n\\angle C_{2} A_{1} B_{2}+\\angle B_{2} C_{1} A_{2}+\\angle A_{2} B_{1} C_{2}=480^{\\circ} \\neq 360^{\\circ} .\n\\]\n\nThus we can apply radical axis theorem to the three circles to show that \\(A_{1} A_{2}, B_{1} B_{2}, C_{1}, C_{2}\\) concur at a point \\(X\\) and this point has equal power with respect to \\(\\delta_{A}, \\delta_{B}, \\delta_{C}\\).\n\nLet the circumcircle of \\(\\triangle A_{2} B C\\) meet \\(\\delta_{A}\\) at \\(A_{3} \\neq A_{2}\\). Define \\(B_{3}\\) and \\(C_{3}\\) similarly.\nClaim. \\(B C B_{3} C_{3}\\) cyclic.\nProof. Using directed angles\n\\[\n\\begin{aligned}\n\\npreceq B C_{3} C & =\\Varangle B C_{3} C_{2}+\\npreceq C_{2} C_{3} C \\\\\n& =\\Varangle B A C_{2}+\\npreceq C_{2} C_{1} C \\\\\n& =90^{\\circ}+\\npreceq\\left(C_{1} C, A C_{2}\\right)+\\npreceq C_{2} C_{1} C \\\\\n& =90^{\\circ}+\\npreceq C_{1} C_{2} B_{1} .\n\\end{aligned}\n\\]\n\nSimilarly \\(\\Varangle C B_{3} B=90^{\\circ}+\\Varangle B_{1} B_{2} C_{1}\\). Hence, using \\(B_{1} C_{1} B_{2} C_{2}\\) cyclic\n\\[\n\\Varangle B B_{3} C=90^{\\circ}+\\Varangle C_{1} B_{2} B_{1}=90^{\\circ}+\\Varangle C_{1} C_{2} B_{1}=\\Varangle B C_{3} C\n\\]\nas required.\n![](https://cdn.mathpix.com/cropped/2025_08_23_2cb0be1b73ef2aa9a4e9g-81.jpg?height=1032&width=1475&top_left_y=1102&top_left_x=296)\n\nSimilarly \\(C A C_{3} A_{3}\\) and \\(A B A_{3} B_{3}\\) are cyclic. \\(A C_{3} B A_{3} C B_{3}\\) is not cyclic because then \\(A B_{2} C B_{3}\\) cyclic would mean \\(B_{2}\\) lies on \\(\\odot A B C\\) which is impossible since \\(B_{2}\\) lies inside \\(\\triangle A B C\\). Thus we can apply radical axis theorem to the three circles to get \\(A A_{3}, B B_{3}, C C_{3}\\) concur at a point \\(Y\\) which has equal power with respect to \\(\\delta_{A}, \\delta_{B}, \\delta_{C}\\).\n\nWe now make some technical observations before finishing.\n- Let \\(O\\) be the centre of \\(\\triangle A B C\\). We have that\n\\[\n\\angle B A_{1} C=480^{\\circ}-\\angle C B_{1} A-\\angle A C_{1} B>480^{\\circ}-180^{\\circ}-180^{\\circ}=120^{\\circ} .\n\\]\nso \\(A_{1}\\) lies inside \\(\\triangle B O C\\). We have similar results for \\(B_{1}, C_{1}\\) and thus \\(\\triangle B A_{1} C, \\triangle C B_{1} A\\), \\(\\triangle A C_{1} B\\) have disjoint interiors. It follows that \\(A_{1} B_{2} C_{1} A_{2} B_{1} C_{2}\\) is a convex hexagon thus \\(X\\) lies on segment \\(A_{1} A_{2}\\) and therefore is inside \\(\\delta_{A}\\).\n- Since \\(A_{1}\\) is the centre of \\(A_{2} B C\\) we have that \\(A_{1} A_{2}=A_{1} A_{3}\\) so, from cyclic quadrilateral \\(A A_{2} A_{1} A_{3}\\) we get that lines \\(A A_{2}\\) and \\(A A_{3} \\equiv A Y\\) are reflections in line \\(A A_{1}\\). As \\(X\\) lies on segment \\(A_{1} A_{2}\\), the only way \\(X \\equiv Y\\) is if \\(A_{1}\\) and \\(A_{2}\\) both lie on the perpendicular bisector of \\(B C\\). But this forces \\(B_{1}\\) and \\(C_{1}\\) to also be reflections in this line meaning \\(A_{1} B_{1}=A_{1} C_{1}\\) contradicting the scalene condition.\n\nSummarising, we have distinct points \\(X, Y\\) with equal power with respect to \\(\\delta_{A}, \\delta_{B}, \\delta_{C}\\) thus these circles have a common radical axis. As \\(X\\) lies inside \\(\\delta_{A}\\) (and similarly \\(\\delta_{B}, \\delta_{C}\\) ), this radical axis intersects the circles at two points and so \\(\\delta_{A}, \\delta_{B}, \\delta_{C}\\) have two points in common.\n\nComment. An alternative construction for \\(Y\\) comes by observing that\n\\[\n\\frac{\\sin \\angle B A A_{2}}{\\sin \\angle A_{2} A C}=\\frac{\\frac{A_{2} B}{A A_{2}} \\sin \\angle A_{2} B A}{\\frac{A_{2} C}{A A_{2}} \\sin \\angle A C A_{2}}=\\frac{A_{2} B}{A_{2} C} \\cdot \\frac{\\sin \\angle C_{1} B A}{\\sin \\angle A C B_{1}}=\\frac{\\sin \\angle B_{1} C B}{\\sin \\angle C B C_{1}} \\cdot \\frac{\\sin \\angle C_{1} B A}{\\sin \\angle A C B_{1}}\n\\]\nand hence\n\\[\n\\frac{\\sin \\angle B A A_{2}}{\\sin \\angle A_{2} A C} \\cdot \\frac{\\sin \\angle C B B_{2}}{\\sin \\angle B_{2} B A} \\cdot \\frac{\\sin \\angle A C C_{2}}{\\sin \\angle C_{2} C B}=1\n\\]\nso by Ceva's theorem, \\(A A_{2}, B B_{2}, C C_{2}\\) concur and thus we can construct the isogonal conjugate of this point of concurrency which turns out to be \\(Y\\).\n\n\\section*{Number Theory}", "source_pdf": "imosl_2023.pdf", "notes": "fallback-regex"}
{"id": "IMO-2023-1", "contest": "IMO", "year": "2023", "problem_number": "N1", "problem": "Determine all positive, composite integers \\(n\\) that satisfy the following property: if the positive divisors of \\(n\\) are \\(1=d_{1}<d_{2}<\\cdots<d_{k}=n\\), then \\(d_{i}\\) divides \\(d_{i+1}+d_{i+2}\\) for every \\(1 \\leqslant i \\leqslant k-2\\).\n(Colombia)", "solution": "Answer: \\(n=p^{r}\\) is a prime power for some \\(r \\geqslant 2\\).\n\n1. It is easy to see that such an \\(n=p^{r}\\) with \\(r \\geqslant 2\\) satisfies the condition as \\(d_{i}=p^{i-1}\\) with \\(1 \\geqslant i \\geqslant k=r+1\\) and clearly\n\\[\np^{i-1} \\mid p^{i}+p^{i+1}\n\\]\n\nNow, let us suppose that there is a positive integer \\(n\\) that satisfies the divisibility condition of the problem and that has two different prime divisors \\(p\\) and \\(q\\). Without lost of generality, we assume \\(p<q\\) and that they are the two smallest prime divisors of \\(n\\). Then there is a positive integer \\(j\\) such that\n\\[\nd_{1}=1, d_{2}=p, \\ldots, d_{j}=p^{j-1}, d_{j+1}=p^{j}, d_{j+2}=q\n\\]\nand it follows that\n\\[\nd_{k-j-1}=\\frac{n}{q}, d_{k-j}=\\frac{n}{p^{j}}, d_{k-j+1}=\\frac{n}{p^{j-1}}, \\ldots, d_{k-1}=\\frac{n}{p}, d_{k}=n\n\\]\n\nThus\n\\[\nd_{k-j-1}=\\frac{n}{q} \\left\\lvert\\, d_{k-j}+d_{k-j+1}=\\frac{n}{p^{j}}+\\frac{n}{p^{j-1}}=\\frac{n}{p^{j}}(p+1)\\right.\n\\]\n\nThis gives \\(p^{j} \\mid q(p+1)\\), which is a contradiction since \\(\\operatorname{gcd}(p, p+1)=1\\) and \\(p \\neq q\\).\nSolution 2. Since \\(d_{i} d_{k+1-i}=n\\), we have the equivalence:\n\\[\nd_{k-i-1}\\left|d_{k-i}+d_{k-i+1} \\Longleftrightarrow \\frac{n}{d_{i+2}}\\right| \\frac{n}{d_{i+1}}+\\frac{n}{d_{i}}\n\\]\n\nWe multiply both sides by \\(d_{i} d_{i+1} d_{i+2}\\) and cancel the \\(n\\) 's to get\n\\[\nd_{i} d_{i+1} \\mid d_{i} d_{i+2}+d_{i+1} d_{i+2}\n\\]\n\nHence,\n\\[\nd_{i} \\mid d_{i+1} d_{i+2}\n\\]\n\nMoreover, by the condition of the problem,\n\\[\nd_{i} \\mid d_{i+1}\\left(d_{i+1}+d_{i+2}\\right)=d_{i+1}^{2}+d_{i+1} d_{i+2}\n\\]\n\nCombining this with (2) we get that \\(d_{i} \\mid d_{i+1}^{2}\\) for all \\(1 \\leqslant i \\leqslant k-2\\).\nLet \\(d_{2}=p\\) be the smallest prime divisor of \\(n\\). By induction on \\(i\\) we prove that \\(p \\mid d_{i}\\) for all \\(2 \\leqslant i \\leqslant k-1\\). The base case \\(d_{2}=p\\) is obvious. Let us suppose that \\(p \\mid d_{j}\\) for some \\(2 \\leqslant j \\leqslant k-2\\). Then we have that\n\\[\np\\left|d_{j}\\right| d_{j+1}^{2} \\Longrightarrow p \\mid d_{j+1}\n\\]\nas \\(p\\) is prime, which completes the induction. This implies that \\(n\\) has to be a prime power, as otherwise there would be another prime \\(q\\) that divides \\(n\\) and we would get that \\(p \\mid q\\) which is obviously false.\n\nWe finally check that the powers of \\(p\\) satisfy the condition in the statement of the problem as in Solution 1.\n\nSolution 3. We start by proving the following claim:\nClaim. \\(d_{i} \\mid d_{i+1}\\) for every \\(1 \\leqslant i \\leqslant k-1\\).\nProof. We prove the Claim by induction on \\(i\\); it is trivial for \\(i=1\\) because \\(d_{1}=1\\). Suppose that \\(2 \\leqslant i \\leqslant k-1\\) and the Claim is true for \\(i-1\\), i.e. \\(d_{i-1} \\mid d_{i}\\). By the induction hypothesis and the problem condition, \\(d_{i-1} \\mid d_{i}\\) and \\(d_{i-1} \\mid d_{i}+d_{i+1}\\), so \\(d_{i-1} \\mid d_{i+1}\\).\n\nNow consider the divisors \\(d_{k-i}=\\frac{n}{d_{i+1}}, d_{k-i+1}=\\frac{n}{d_{i}}, d_{k-i+2}=\\frac{n}{d_{i-1}}\\). By the problem condition,\n\\[\n\\frac{d_{k-i+1}+d_{k-i+2}}{d_{k-i}}=\\frac{\\frac{n}{d_{i}}+\\frac{n}{d_{i-1}}}{\\frac{n}{d_{i+1}}}=\\frac{d_{i+1}}{d_{i}}+\\frac{d_{i+1}}{d_{i-1}}\n\\]\nis an integer. We conclude that \\(\\frac{d_{i+1}}{d_{i}}\\) is an integer, so \\(d_{i} \\mid d_{i+1}\\).\nBy the Claim, \\(n\\) cannot have two different prime divisors because the smallest one would divide the other one. Hence, \\(n\\) must be a power of a prime, and powers of primes satisfy the condition of the problem as we saw in Solution 1.\n\nSolution 4. We present here a more technical way of finishing Solution 1 after obtaining (1). We let \\(v_{p}(m)\\) denote the \\(p\\)-adic valuation of \\(m\\). Notice that \\(v_{p}(n / q)=v_{p}(n)\\) as \\(\\operatorname{gcd}(p, q)=1\\) and that\n\\[\nv_{p}\\left(\\frac{n}{p^{j}}(p+1)\\right)=v_{p}(n)-j\n\\]\nas \\(\\operatorname{gcd}(p, p+1)=1\\). But (1) implies\n\\[\nv_{p}(n)=v_{p}(n / q) \\leqslant v_{p}\\left(\\frac{n}{p^{j}}(p+1)\\right)=v_{p}(n)-j\n\\]\nwhich is a contradiction. Thus \\(n\\) has only one prime divisor as desired.", "source_pdf": "imosl_2023.pdf", "notes": "fallback-regex"}
{"id": "IMO-2024-1", "contest": "IMO", "year": "2024", "problem_number": "A1", "problem": "Determine all real numbers \\(\\alpha\\) such that the number\n\\[\n\\lfloor\\alpha\\rfloor+\\lfloor 2 \\alpha\\rfloor+\\cdots+\\lfloor n \\alpha\\rfloor\n\\]\nis a multiple of \\(n\\) for every positive integer \\(n\\). (Here \\(\\lfloor z\\rfloor\\) denotes the greatest integer less than or equal to \\(z\\).)\n(Colombia)", "solution": "Answer: All even integers satisfy the condition of the problem and no other real number \\(\\alpha\\) does so.\n\n1. First we will show that even integers satisfy the condition. If \\(\\alpha=2 m\\) where \\(m\\) is an integer then\n\\[\n\\lfloor\\alpha\\rfloor+\\lfloor 2 \\alpha\\rfloor+\\cdots+\\lfloor n \\alpha\\rfloor=2 m+4 m+\\cdots+2 m n=m n(n+1)\n\\]\nwhich is a multiple of \\(n\\).\nNow we will show that they are the only real numbers satisfying the conditions of the problem. Let \\(\\alpha=k+\\epsilon\\) where \\(k\\) is an integer and \\(0 \\leqslant \\epsilon<1\\). Then the number\n\\[\n\\begin{aligned}\n\\lfloor\\alpha\\rfloor+\\lfloor 2 \\alpha\\rfloor+\\cdots+\\lfloor n \\alpha\\rfloor & =k+\\lfloor\\epsilon\\rfloor+2 k+\\lfloor 2 \\epsilon\\rfloor+\\cdots+n k+\\lfloor n \\epsilon\\rfloor \\\\\n& =\\frac{k n(n+1)}{2}+\\lfloor\\epsilon\\rfloor+\\lfloor 2 \\epsilon\\rfloor+\\cdots+\\lfloor n \\epsilon\\rfloor\n\\end{aligned}\n\\]\nhas to be a multiple of \\(n\\). We consider two cases based on the parity of \\(k\\).\nCase 1: \\(k\\) is even.\nThen \\(\\frac{k n(n+1)}{2}\\) is always a multiple of \\(n\\). Thus\n\\[\n\\lfloor\\epsilon\\rfloor+\\lfloor 2 \\epsilon\\rfloor+\\cdots+\\lfloor n \\epsilon\\rfloor\n\\]\nalso has to be a multiple of \\(n\\).\nWe will prove that \\(\\lfloor n \\epsilon\\rfloor=0\\) for every positive integer \\(n\\) by strong induction. The base case \\(n=1\\) follows from the fact that \\(0 \\leqslant \\epsilon<1\\). Let us suppose that \\(\\lfloor m \\epsilon\\rfloor=0\\) for every \\(1 \\leqslant m<n\\). Then the number\n\\[\n\\lfloor\\epsilon\\rfloor+\\lfloor 2 \\epsilon\\rfloor+\\cdots+\\lfloor n \\epsilon\\rfloor=\\lfloor n \\epsilon\\rfloor\n\\]\nhas to be a multiple of \\(n\\). As \\(0 \\leqslant \\epsilon<1\\) then \\(0 \\leqslant n \\epsilon<n\\), which means that the number \\(\\lfloor n \\epsilon\\rfloor\\) has to be equal to 0 .\n\nThe equality \\(\\lfloor n \\epsilon\\rfloor=0\\) implies \\(0 \\leqslant \\epsilon<1 / n\\). Since this has to happen for all \\(n\\), we conclude that \\(\\epsilon=0\\) and then \\(\\alpha\\) is an even integer.\n\n\\section*{Case 2: \\(k\\) is odd.}\n\nWe will prove that \\(\\lfloor n \\epsilon\\rfloor=n-1\\) for every natural number \\(n\\) by strong induction. The base case \\(n=1\\) again follows from the fact that \\(0 \\leqslant \\epsilon<1\\). Let us suppose that \\(\\lfloor m \\epsilon\\rfloor=m-1\\) for every \\(1 \\leqslant m<n\\). We need the number\n\\[\n\\begin{aligned}\n\\frac{k n(n+1)}{2}+\\lfloor\\epsilon\\rfloor+\\lfloor 2 \\epsilon\\rfloor+\\cdots+\\lfloor n \\epsilon\\rfloor & =\\frac{k n(n+1)}{2}+0+1+\\cdots+(n-2)+\\lfloor n \\epsilon\\rfloor \\\\\n& =\\frac{k n(n+1)}{2}+\\frac{(n-2)(n-1)}{2}+\\lfloor n \\epsilon\\rfloor \\\\\n& =\\frac{k+1}{2} n^{2}+\\frac{k-3}{2} n+1+\\lfloor n \\epsilon\\rfloor\n\\end{aligned}\n\\]\nto be a multiple of \\(n\\). As \\(k\\) is odd, we need \\(1+\\lfloor n \\epsilon\\rfloor\\) to be a multiple of \\(n\\). Again, as \\(0 \\leqslant \\epsilon<1\\) then \\(0 \\leqslant n \\epsilon<n\\), so \\(\\lfloor n \\epsilon\\rfloor=n-1\\) as we wanted.\n\nThis implies that \\(1-\\frac{1}{n} \\leqslant \\epsilon<1\\) for all \\(n\\) which is absurd. So there are no other solutions in this case.\n\nSolution 2. As in Solution 1 we check that for even integers the condition is satisfied. Then, without loss of generality we can assume \\(0 \\leqslant \\alpha<2\\). We set \\(S_{n}=\\lfloor\\alpha\\rfloor+\\lfloor 2 \\alpha\\rfloor+\\cdots+\\lfloor n \\alpha\\rfloor\\).\n\nNotice that\n\\[\n\\begin{array}{ll}\nS_{n} \\equiv 0 & (\\bmod n) \\\\\nS_{n} \\equiv S_{n}-S_{n-1}=\\lfloor n \\alpha\\rfloor & (\\bmod n-1)\n\\end{array}\n\\]\n\nSince \\(\\operatorname{gcd}(n, n-1)=1\\), (1) and (2) imply that\n\\[\nS_{n} \\equiv n\\lfloor n \\alpha\\rfloor \\quad(\\bmod n(n-1))\n\\]\n\nIn addition,\n\\[\n0 \\leqslant n\\lfloor n \\alpha\\rfloor-S_{n}=\\sum_{k=1}^{n}(\\lfloor n \\alpha\\rfloor-\\lfloor k \\alpha\\rfloor)<\\sum_{k=1}^{n}(n \\alpha-k \\alpha+1)=\\frac{n(n-1)}{2} \\alpha+n\n\\]\n\nFor \\(n\\) large enough, the RHS of (4) is less than \\(n(n-1)\\). Then (3) forces\n\\[\n0=S_{n}-n\\lfloor n \\alpha\\rfloor=\\sum_{k=1}^{n}(\\lfloor n \\alpha\\rfloor-\\lfloor k \\alpha\\rfloor)\n\\]\nfor \\(n\\) large enough.\nSince \\(\\lfloor n \\alpha\\rfloor-\\lfloor k \\alpha\\rfloor \\geqslant 0\\) for \\(1 \\leqslant k \\leqslant n\\), we get from (5) that, for all \\(n\\) large enough, all these inequalities are equalities. In particular \\(\\lfloor\\alpha\\rfloor=\\lfloor n \\alpha\\rfloor\\) for all \\(n\\) large enough, which is absurd unless \\(\\alpha=0\\).\n\nComment. An alternative ending to the previous solution is as follows.\nBy definition we have \\(S_{n} \\leqslant \\alpha \\frac{n(n+1)}{2}\\), on the other hand (5) implies \\(S_{n} \\geqslant \\alpha n^{2}-n\\) for all \\(n\\) large enough, so \\(\\alpha=0\\).\n\nSolution 3. As in other solutions, without loss of generality we may assume that \\(0 \\leqslant \\alpha<2\\). Even integers satisfy the condition, so we assume \\(0<\\alpha<2\\) and we will derive a contradiction.\n\nBy induction on \\(n\\), we will simultaneously show that\n\\[\n\\begin{gathered}\n\\lfloor\\alpha\\rfloor+\\lfloor 2 \\alpha\\rfloor+\\cdots+\\lfloor n \\alpha\\rfloor=n^{2}, \\\\\n\\text { and } \\quad \\frac{2 n-1}{n} \\leqslant \\alpha<2 .\n\\end{gathered}\n\\]\n\nThe base case is \\(n=1\\) : If \\(\\alpha<1\\), consider \\(m=\\left\\lceil\\frac{1}{\\alpha}\\right\\rceil>1\\), then\n\\[\n\\lfloor\\alpha\\rfloor+\\lfloor 2 \\alpha\\rfloor+\\cdots+\\lfloor m \\alpha\\rfloor=1\n\\]\nis not a multiple of \\(m\\), so we deduce (7). Hence, \\(\\lfloor\\alpha\\rfloor=1\\) and (6) follows.\nFor the induction step: assume the induction hypothesis to be true for \\(n\\), then by (7)\n\\[\n2 n+1-\\frac{1}{n} \\leqslant(n+1) \\alpha<2 n+2\n\\]\n\nHence,\n\\[\nn^{2}+2 n \\leqslant\\lfloor\\alpha\\rfloor+\\lfloor 2 \\alpha\\rfloor+\\cdots+\\lfloor n \\alpha\\rfloor+\\lfloor(n+1) \\alpha\\rfloor=n^{2}+\\lfloor(n+1) \\alpha\\rfloor<n^{2}+2 n+2 .\n\\]\n\nSo, necessarily \\(\\lfloor(n+1) \\alpha\\rfloor=2 n+1\\) and\n\\[\n\\lfloor\\alpha\\rfloor+\\lfloor 2 \\alpha\\rfloor+\\cdots+\\lfloor n \\alpha\\rfloor+\\lfloor(n+1) \\alpha\\rfloor=(n+1)^{2}\n\\]\nin order to obtain a multiple of \\(n+1\\). These two equalities give (6) and (7) respectively.\nFinally, we notice that condition (7) being true for all \\(n\\) gives a contradiction.\nSolution 4. As in other solutions without loss of generality we will assume that \\(0<\\alpha<2\\) and derive a contradiction. For each \\(n\\), we define\n\\[\nb_{n}=\\frac{\\lfloor\\alpha\\rfloor+\\lfloor 2 \\alpha\\rfloor+\\cdots+\\lfloor n \\alpha\\rfloor}{n},\n\\]\nwhich is a nonnegative integer by the problem condition and our assumption. Note that\n\\[\n\\lfloor(n+1) \\alpha\\rfloor \\geqslant\\lfloor\\alpha\\rfloor,\\lfloor 2 \\alpha\\rfloor, \\ldots,\\lfloor n \\alpha\\rfloor \\quad \\text { and } \\quad\\lfloor(n+1) \\alpha\\rfloor>\\lfloor\\alpha\\rfloor\n\\]\nfor all \\(n>\\frac{1}{\\alpha}\\). It follows that \\(b_{n+1}>b_{n} \\Longrightarrow b_{n+1} \\geqslant b_{n}+1\\) for \\(n>\\frac{1}{\\alpha}\\). Thus, for all such \\(n\\),\n\\[\nb_{n} \\geqslant n+C\n\\]\nwhere \\(C\\) is a fixed integer. On the other hand, the definition of \\(b_{n}\\) gives\n\\[\nb_{n}=\\frac{\\lfloor\\alpha\\rfloor+\\lfloor 2 \\alpha\\rfloor+\\cdots+\\lfloor n \\alpha\\rfloor}{n} \\leqslant \\frac{\\alpha+2 \\alpha+\\cdots+n \\alpha}{n}=\\frac{\\alpha}{2}(n+1),\n\\]\nwhich is a contradiction for sufficiently large \\(n\\).", "source_pdf": "imosl_2024.pdf", "notes": "fallback-regex"}
{"id": "IMO-2024-6", "contest": "IMO", "year": "2024", "problem_number": "A7", "problem": "Let \\(\\mathbb{Q}\\) be the set of rational numbers. Let \\(f: \\mathbb{Q} \\rightarrow \\mathbb{Q}\\) be a function such that the following property holds: for all \\(x, y \\in \\mathbb{Q}\\),\n\\[\nf(x+f(y))=f(x)+y \\quad \\text { or } \\quad f(f(x)+y)=x+f(y)\n\\]\n\nDetermine the maximum possible number of elements of \\(\\{f(x)+f(-x) \\mid x \\in \\mathbb{Q}\\}\\).\n(Japan)", "solution": "Answer: 2 is the maximum number of elements.\nCommon remarks. Suppose that \\(f\\) is a function satisfying the condition of the problem. We will use the following throughout all solutions.\n- \\(a \\sim b\\) if either \\(f(a)=b\\) or \\(f(b)=a\\),\n- \\(a \\rightarrow b\\) if \\(f(a)=b\\),\n- \\(P(x, y)\\) to denote the proposition that either \\(f(x+f(y))=f(x)+y\\) or \\(f(f(x)+y)= x+f(y)\\),\n- \\(g(x)=f(x)+f(-x)\\).\n\nWith this, the condition \\(P(x, y)\\) could be rephrased as saying that \\(x+f(y) \\sim f(x)+y\\), and we are asked to determine the maximum possible number of elements of \\(\\{g(x) \\mid x \\in \\mathbb{Q}\\}\\).\n\n1. We begin by providing an example of a function \\(f\\) for which there are two values of \\(g(x)\\). We take the function \\(f(x)=\\lfloor x\\rfloor-\\{x\\}\\), where \\(\\lfloor x\\rfloor\\) denotes the floor of \\(x\\) (that is, the largest integer less than or equal to \\(x\\) ) and \\(\\{x\\}=x-\\lfloor x\\rfloor\\) denotes the fractional part of \\(x\\).\n\nFirst, we show that \\(f\\) satisfies \\(P(x, y)\\). Given \\(x, y \\in \\mathbb{Q}\\), we have\n\\[\n\\begin{aligned}\n& f(x)+y=\\lfloor x\\rfloor-\\{x\\}+\\lfloor y\\rfloor+\\{y\\}=(\\lfloor x\\rfloor+\\lfloor y\\rfloor)+(\\{y\\}-\\{x\\}) ; \\\\\n& x+f(y)=\\lfloor x\\rfloor+\\{x\\}+\\lfloor y\\rfloor-\\{y\\}=(\\lfloor x\\rfloor+\\lfloor y\\rfloor)+(\\{x\\}-\\{y\\}) .\n\\end{aligned}\n\\]\n\nIf \\(\\{x\\}<\\{y\\}\\), then we have that the fractional part of \\(f(x)+y\\) is \\(\\{y\\}-\\{x\\}\\) and the floor is \\(\\lfloor x\\rfloor+\\lfloor y\\rfloor\\), so \\(f(x)+y \\rightarrow x+f(y)\\). Likewise, if \\(\\{x\\}>\\{y\\}\\), then \\(x+f(y) \\rightarrow f(x)+y\\). Finally, if \\(\\{x\\}=\\{y\\}\\), then \\(f(x)+y=x+f(y)=\\lfloor x\\rfloor+\\lfloor y\\rfloor\\) is an integer. In all cases, the relation \\(P\\) is satisfied.\n\nFinally, we observe that if \\(x\\) is an integer then \\(g(x)=0\\), and if \\(x\\) is not an integer then \\(g(x)=-2\\), so there are two values for \\(g(x)\\) as required.\n\nNow, we prove that there cannot be more than two values of \\(g(x) . P(x, x)\\) tells us that \\(x+f(x) \\sim x+f(x)\\), or in other words, for all \\(x\\),\n\\[\nf(x+f(x))=x+f(x)\n\\]\n\nWe begin with the following lemma.\nLemma 1. \\(f\\) is a bijection, and satisfies\n\\[\nf(-f(-x))=x .\n\\]\n\nProof. We first prove that \\(f\\) is injective. Suppose that \\(f\\left(x_{1}\\right)=f\\left(x_{2}\\right)\\); then \\(P\\left(x_{1}, x_{2}\\right)\\) tells us that \\(f\\left(x_{1}\\right)+x_{2} \\sim f\\left(x_{2}\\right)+x_{1}\\). Without loss of generality, suppose that \\(f\\left(x_{1}\\right)+x_{2} \\rightarrow f\\left(x_{2}\\right)+x_{1}\\).\n\nBut \\(f\\left(x_{1}\\right)=f\\left(x_{2}\\right)\\), so \\(f\\left(f\\left(x_{1}\\right)+x_{2}\\right)=f\\left(f\\left(x_{2}\\right)+x_{2}\\right)=f\\left(x_{2}\\right)+x_{2}\\) by (1). Therefore, \\(f\\left(x_{2}\\right)+x_{1}=f\\left(x_{2}\\right)+x_{2}\\), as required.\n\nNow, (1) with \\(x=0\\) tells us that \\(f(f(0))=f(0)\\) and so by injectivity \\(f(0)=0\\).\nApplying \\(P(x,-f(x))\\) tells us that \\(0 \\sim x+f(-f(x))\\), so either \\(0=f(0)=x+f(-f(x))\\) or \\(f(x+f(-f(x)))=0\\) which implies that \\(x+f(-f(x))=0\\) by injectivity. Either way, we deduce that \\(x=-f(-f(x))\\), or \\(x=f(-f(-x))\\) by replacing \\(x\\) with \\(-x\\).\n\nFinally, note that bijectivity follows immediately from (2).\nSince \\(f\\) is bijective, it has an inverse, which we denote \\(f^{-1}\\). Rearranging (2) (after replacing \\(x\\) with \\(-x)\\) gives that \\(f(-x)=-f^{-1}(x)\\). We have \\(g(x)=f(x)+f(-x)=f(x)-f^{-1}(x)\\).\n\nSuppose \\(g(x)=u\\) and \\(g(y)=v\\), where \\(u \\neq v\\) are both nonzero. Define \\(x^{\\prime}=f^{-1}(x)\\) and \\(y^{\\prime}=f^{-1}(y)\\); by definition, we have\n\\[\n\\begin{aligned}\n& x^{\\prime} \\rightarrow x \\rightarrow x^{\\prime}+u \\\\\n& y^{\\prime} \\rightarrow y \\rightarrow y^{\\prime}+v .\n\\end{aligned}\n\\]\n\nPutting in \\(P\\left(x^{\\prime}, y\\right)\\) gives \\(x+y \\sim x^{\\prime}+y^{\\prime}+v\\), and putting in \\(P\\left(x, y^{\\prime}\\right)\\) gives \\(x+y \\sim x^{\\prime}+y^{\\prime}+u\\). These are not equal since \\(u \\neq v\\), and \\(x+y\\) may have only one incoming and outgoing arrow because \\(f\\) is a bijection, so we must have either \\(x^{\\prime}+y^{\\prime}+u \\rightarrow x+y \\rightarrow x^{\\prime}+y^{\\prime}+v\\) or the same with the arrows reversed. Swapping \\((x, u)\\) and \\((y, v)\\) if necessary, we may assume without loss of generality that this is the correct direction for the arrows.\n\nAlso, we have \\(-x^{\\prime}-u \\rightarrow-x \\rightarrow-x^{\\prime}\\) by Lemma 1. Putting in \\(P\\left(x+y,-x^{\\prime}-u\\right)\\) gives \\(y \\sim y^{\\prime}+v-u\\), and so \\(y^{\\prime}+v-u\\) must be either \\(y^{\\prime}+v\\) or \\(y^{\\prime}\\). This means \\(u\\) must be either 0 or \\(v\\), and this contradicts our assumption about \\(u\\) and \\(v\\).\n\nComment. Lemma 1 can also be proven as follows. We start by proving that \\(f\\) must be surjective. Suppose not; then, there must be some \\(t\\) which does not appear in the output of \\(f\\). \\(P(x, t-f(x))\\) tells us that \\(t \\sim x+f(t-f(x))\\), and so by assumption \\(f(t)=x+f(t-f(x))\\) for all \\(x\\). But setting \\(x=f(t)-t\\) gives \\(t=f(t-f(f(t)-t))\\), contradicting our assumption about \\(t\\).\n\nNow, choose some \\(t\\) such that \\(f(t)=0\\); such a \\(t\\) must exist by surjectivity. \\(P(t, t)\\) tells us that \\(f(t)=t\\), or in other words \\(t=0\\) and \\(f(0)=0\\). The remainder of the proof is the same as the proof given in Solution 1.\n\nSolution 2. We again start with Lemma 1 , and note \\(f(0)=0\\) as in the proof of that lemma.\n\\(P(x,-f(y))\\) gives \\(x+f(-f(y)) \\sim f(x)-f(y)\\), and using (2) this becomes \\(x-y \\sim f(x)-f(y)\\). In other words, either \\(f(x-y)=f(x)-f(y)\\) or \\(x-y=f(f(x)-f(y))\\). In the latter case, we deduce that\n\\[\n\\begin{aligned}\nf(-(x-y)) & =f(-f(f(x)-f(y))) \\\\\nf(y-x) & =f(-f(f(x)-f(y))) \\\\\n& =f(y)-f(x)\n\\end{aligned}\n\\]\n\nThus, \\(f(y)-f(x)\\) is equal to either \\(f(y-x)\\) or \\(-f(x-y)\\). Replacing \\(y\\) with \\(x+d\\), we deduce that \\(f(x+d)-f(x) \\in\\{f(d),-f(-d)\\}\\).\n\nNow, we prove the following claim.\nClaim. For any \\(n \\in \\mathbb{Z}_{>0}\\) and \\(d \\in \\mathbb{Q}\\), we have that either \\(g(d)=0\\) or \\(g(d)= \\pm g(d / n)\\).\nIn particular, if \\(g(d / n)=0\\) then \\(g(d)=0\\).\n\nProof. We first prove that if \\(g(d / n)=0\\) then \\(g(d)=0\\). Suppose that \\(g(d / n)=0\\). Then \\(f(d / n)=-f(-d / n)\\) and so \\(f(x+d / n)-f(x)=f(d / n)\\) for any \\(x\\). Applying this repeatedly, we deduce that \\(f(x+d)-f(x)=n f(d / n)\\) for any \\(x\\). Applying this with \\(x=0\\) and \\(x=-d\\) and adding gives \\(f(d)+f(-d)=0\\), so \\(g(d)=0\\), and in particular the claim is true whenever \\(g(d)=0\\).\n\nNow, select \\(n \\in \\mathbb{Z}_{>0}\\) and \\(d \\in \\mathbb{Q}\\) such that \\(g(d) \\neq 0\\), and observe that we must have \\(g(d / n) \\neq\\) 0 . Observe that for any \\(k \\in \\mathbb{Z}\\) we have that \\(f(k d / n)-f((k-1) d / n) \\in\\{f(d / n),-f(-d / n)\\}\\). Let \\(A_{i}\\) be the number of \\(k \\in \\mathbb{Z}\\) with \\(i-n<k \\leqslant i\\) such that this difference equals \\(f(d / n)\\).\n\nWe deduce that for any \\(i \\in \\mathbb{Z}\\),\n\\[\n\\begin{aligned}\nf(i d / n)-f(i d / n-d) & =\\sum_{i-n<k \\leqslant i} f(k d / n)-f((k-1) d / n) \\\\\n& =A_{i} f(d / n)-\\left(n-A_{i}\\right) f(-d / n) \\\\\n& =-n f(-d / n)+A_{i} g(d / n)\n\\end{aligned}\n\\]\n\nSince \\(g(d / n)\\) is nonzero, this is a nonconstant linear function of \\(A_{i}\\). However, there are only two possible values for \\(f(i d / n)-f(i d / n-d)\\), so there must be at most two possible values for \\(A_{i}\\) as \\(i\\) varies. And since \\(A_{i+1}-A_{i} \\in\\{-1,0,1\\}\\), those two values must differ by 1 (if there are two values).\n\nNow, we have\n\\[\n\\begin{aligned}\nf(d)-f(0) & =-n f(-d / n)+A_{n} g(d / n), \\quad \\text { and } \\\\\nf(0)-f(-d) & =-n f(-d / n)+A_{0} g(d / n)\n\\end{aligned}\n\\]\n\nSubtracting these (using the fact that \\(f(0)=0\\) ) we obtain\n\\[\n\\begin{aligned}\nf(d)+f(-d) & =\\left(A_{n}-A_{0}\\right) g(d / n) \\\\\n& = \\pm g(d / n)\n\\end{aligned}\n\\]\nwhere the last line follows from the fact that \\(g(d)\\) is nonzero.\nIt immediately follows that there can only be one nonzero number of the form \\(g(x)\\) up to sign; to see why, if \\(g(d)\\) and \\(g\\left(d^{\\prime}\\right)\\) are both nonzero, then for some \\(n, n^{\\prime} \\in \\mathbb{Z}_{>0}\\) we have \\(d / n=d^{\\prime} / n^{\\prime}\\). But\n\\[\ng(d)= \\pm g(d / n)= \\pm g\\left(d^{\\prime}\\right)\n\\]\n\nFinally, suppose that for some \\(d, d^{\\prime}\\) we have \\(g(d)=c\\) and \\(g\\left(d^{\\prime}\\right)=-c\\) for some nonzero \\(c\\). So we have\n\\[\nf(d)+f(-d)-f\\left(d^{\\prime}\\right)-f\\left(-d^{\\prime}\\right)=2 c\n\\]\nwhich rearranges to become \\(\\left(f(d)-f\\left(d^{\\prime}\\right)\\right)-\\left(f\\left(-d^{\\prime}\\right)-f(-d)\\right)=2 c\\).\nEach of the bracketed terms must be equal to either \\(f\\left(d-d^{\\prime}\\right)\\) or \\(-f\\left(d^{\\prime}-d\\right)\\). However, they cannot be equal since \\(c\\) is nonzero, so \\(g\\left(d-d^{\\prime}\\right)=f\\left(d-d^{\\prime}\\right)+f\\left(d^{\\prime}-d\\right)= \\pm 2 c\\). This contradicts the assertion that \\(g(-x)= \\pm c\\) for all \\(x\\).\n\nSolution 3. As in Solution 1, we start by establishing Lemma 1 as above, and write \\(f^{-1}(x)= -f(-x)\\) for the inverse of \\(f\\), and \\(g(x)=f(x)-f^{-1}(x)\\).\n\nWe now prove the following.\nLemma 2. If \\(g(x) \\neq g(y)\\), then \\(g(x+y)= \\pm(g(x)-g(y))\\).\n\nProof. Assume \\(x\\) and \\(y\\) are such that \\(g(x) \\neq g(y)\\). Applying \\(P\\left(x, f^{-1}(y)\\right)\\) gives \\(x+y \\sim f(x)+f^{-1}(y)\\), and applying \\(P\\left(f^{-1}(x), y\\right)\\) gives \\(x+y \\sim f^{-1}(x)+f(y)\\).\n\nObserve that\n\\[\n\\begin{aligned}\n\\left(f(x)+f^{-1}(y)\\right)-\\left(f^{-1}(x)+f(y)\\right) & =\\left(f(x)-f^{-1}(x)\\right)-\\left(f(y)-f^{-1}(y)\\right) \\\\\n& =g(x)-g(y) .\n\\end{aligned}\n\\]\n\nBy assumption, \\(g(x) \\neq g(y)\\), and so \\(f(x)+f^{-1}(y) \\neq f^{-1}(x)+f(y)\\). Since \\(f\\) is bijective, this means that these two values must be \\(f(x+y)\\) and \\(f^{-1}(x+y)\\) in some order, and so \\(g(x+y)=f(x+y)-f^{-1}(x+y)\\) must be their difference up to sign, which is either \\(g(x)-g(y)\\) or \\(g(y)-g(x)\\).\n\nClaim. If \\(x\\) and \\(q\\) are rational numbers such that \\(g(q)=0\\) and \\(n\\) is an integer, then \\(g(x+n q)= g(x)\\).\n\nProof. If \\(g(b)=0\\) and \\(g(a) \\neq g(a+b)\\), then the lemma tells us that \\(g(b)= \\pm(g(a+b)-g(a))\\), which contradicts our assumptions. Therefore, \\(g(a)=g(a+b)\\) whenever \\(g(b)=0\\).\n\nA simple induction then gives that \\(g(n b)=0\\) for any positive integer \\(n\\), and \\(g(n b)=0\\) for negative \\(n\\) as \\(g(x)=g(-x)\\). The claim follows immediately.\n\nLemma 3. There cannot be both positive and negative elements in the range of \\(g\\).\nProof. Suppose that \\(g(x)>0\\) and \\(g(y)<0\\). Let \\(\\mathcal{S}\\) be the set of numbers of the form \\(m x+n y\\) for integers \\(m, n\\). We first show that \\(g(\\mathcal{S})\\) has infinitely many elements. Indeed, suppose \\(g(\\mathcal{S})\\) is finite, and let \\(a \\in \\mathcal{S}\\) maximise \\(g\\) and \\(b \\in \\mathcal{S}\\) maximise \\(-g\\). Then \\(a+b \\in \\mathcal{S}\\), and \\(g(a+b)=g(a)-g(b)\\) or \\(g(b)-g(a)\\). In the first case \\(g(a+b)>g(a)\\) and in the second case \\(g(a+b)<g(b)\\); in either case we get a contradiction.\n\nNow, we show that there must exist some nonzero rational number \\(q\\) with \\(g(q)=0\\). Indeed, suppose first that \\(a+f(a)=0\\) for all \\(a\\). Then \\(g(a)=f(a)+f(-a)=0\\) for all \\(a\\), and so \\(g\\) takes no nonzero value. Otherwise, there is some \\(a\\) with \\(a+f(a) \\neq 0\\), and so (1) yields that \\(f(q)=0\\) for \\(q=a+f(a) \\neq 0\\). Noting that \\(f(-q)=0\\) from Lemma 1 tells us that \\(g(q)=0\\), as required.\n\nNow, there must exist integers \\(s\\) and \\(s^{\\prime}\\) such that \\(x s=q s^{\\prime}\\) and integers \\(t\\) and \\(t^{\\prime}\\) such that \\(y t=q t^{\\prime}\\). The claim above gives that the value of \\(g(m x+n y)\\) depends only on the values of \\(m \\bmod s\\) and \\(n \\bmod t\\), so \\(g(m x+n y)\\) can only take finitely many values.\n\nFinally, suppose that \\(g(x)=u\\) and \\(g(y)=v\\) where \\(u \\neq v\\) have the same sign. Assume \\(u, v>0\\) (the other case is similar) and assume \\(u>v\\) without loss of generality.\n\\(P\\left(f^{-1}(x), f^{-1}(y)\\right)\\) gives \\(x-y \\sim f^{-1}(x)-f^{-1}(y)=f(x)-f(y)-(u-v)\\), and \\(P(x, y)\\) gives \\(x-y \\sim f(x)-f(y) . u-v\\) is nonzero, so \\(f(x-y)\\) and \\(f^{-1}(x-y)\\) must be \\(f(x)-f(y)-(u-v)\\) and \\(f(x)-f(y)\\) in some order, and since \\(g(x-y)\\) must be nonnegative, we have\n\\[\nf(x)-f(y)-(u-v) \\rightarrow x-y \\rightarrow f(x)-f(y) .\n\\]\n\nThen, \\(P\\left(x-y, f^{-1}(y)\\right)\\) tells us that \\((x-y)+y \\sim(f(x)-f(y))+(f(y)-v)\\), so \\(x \\sim f(x)-v\\), contradicting either \\(v \\neq u\\) or \\(v>0\\).\n\nComment. Lemma 2 also follows from \\(f(x+d)-f(x) \\in\\{f(d),-f(-d)\\}\\) as proven in Solution 2. Indeed, we also have \\(f(-x)-f(-x-d) \\in\\{f(d),-f(-d)\\}\\), and then subtracting the second from the first we get \\(g(x+d)-g(x) \\in\\{g(d),-g(d), 0\\}\\). Replacing \\(x+d\\) and \\(x\\) with \\(x\\) and \\(-y\\) gives the statement of Lemma 2.\n\nComment. It is possible to prove using Lemma 2 that \\(g\\) must have image of the form \\(\\{0, c, 2 c\\}\\) if it has size greater than 2 . Indeed, if \\(g(x)=c\\) and \\(g(y)=d\\) with \\(0<c<d\\), then \\(g(x+y)=d-c\\) as it must be nonnegative, and \\(g(y)=g((x+y)+(-x))=|d-2 c|\\) provided that \\(d \\neq 2 c\\).\n\nHowever, it is not possible to rule out \\(\\{0, c, 2 c\\}\\) based entirely on the conclusion of Lemma 2; indeed, the function given by\n\\[\ng(x)= \\begin{cases}0, & \\text { if } x=2 n \\text { for } n \\in \\mathbb{Z} \\\\ 2, & \\text { if } x=2 n+1 \\text { for } n \\in \\mathbb{Z} \\\\ 1, & \\text { if } x \\notin \\mathbb{Z}\\end{cases}\n\\]\nsatisfies the conclusion of Lemma 2 (even though there is no function \\(f\\) giving this choice of \\(g\\) ).\nNote. Solution 1 actually implies that the result also holds over \\(\\mathbb{R}\\). The proposal was originally submitted and evaluated over \\(\\mathbb{Q}\\) as it is presented here, and the Problem Selection Committee believes that this form is more suitable for the competition because it allows for more varied and interesting approaches once Lemma 1 has been established. Even the variant here defined over \\(\\mathbb{Q}\\) was found to be fairly challenging.", "source_pdf": "imosl_2024.pdf", "notes": "fallback-regex"}
{"id": "IMO-2024-5", "contest": "IMO", "year": "2024", "problem_number": "C4", "problem": "On a board with 2024 rows and 2023 columns, Turbo the snail tries to move from the first row to the last row. On each attempt, he chooses to start on any cell in the first row, then moves one step at a time to an adjacent cell sharing a common side. He wins if he reaches any cell in the last row. However, there are 2022 predetermined, hidden monsters in 2022 of the cells, one in each row except the first and last rows, such that no two monsters share the same column. If Turbo unfortunately reaches a cell with a monster, his attempt ends and he is transported back to the first row to start a new attempt. The monsters do not move.\n\nSuppose Turbo is allowed to take \\(n\\) attempts. Determine the minimum value of \\(n\\) for which he has a strategy that guarantees reaching the last row, regardless of the locations of the monsters.\n(Hong Kong)\n\nComment. One of the main difficulties of solving this question is in determining the correct expression for \\(n\\). Students may spend a long time attempting to prove bounds for the wrong value for \\(n\\) before finding better strategies.\n\nStudents may incorrectly assume that Turbo is not allowed to backtrack to squares he has already visited within a single attempt. Fortunately, making this assumption does not change the", "solution": "answer to the problem, though it may make it slightly harder to find a winning strategy.\n\nAnswer: The answer is \\(n=3\\).\n\n. First we demonstrate that there is no winning strategy if Turbo has 2 attempts.\nSuppose that \\((2, i)\\) is the first cell in the second row that Turbo reaches on his first attempt. There can be a monster in this cell, in which case Turbo must return to the first row immediately, and he cannot have reached any other cells past the first row.\n\nNext, suppose that \\((3, j)\\) is the first cell in the third row that Turbo reaches on his second attempt. Turbo must have moved to this cell from \\((2, j)\\), so we know \\(j \\neq i\\). So it is possible that there is a monster on \\((3, j)\\), in which case Turbo also fails on his second attempt. Therefore Turbo cannot guarantee to reach the last row in 2 attempts.\n\nNext, we exhibit a strategy for \\(n=3\\). On the first attempt, Turbo travels along the path\n\\[\n(1,1) \\rightarrow(2,1) \\rightarrow(2,2) \\rightarrow \\cdots \\rightarrow(2,2023) .\n\\]\n\nThis path meets every cell in the second row, so Turbo will find the monster in row 2 and his attempt will end.\n\nIf the monster in the second row is not on the edge of the board (that is, it is in cell \\((2, i)\\) with \\(2 \\leqslant i \\leqslant 2022\\) ), then Turbo takes the following two paths in his second and third attempts:\n\\[\n\\begin{aligned}\n& (1, i-1) \\rightarrow(2, i-1) \\rightarrow(3, i-1) \\rightarrow(3, i) \\rightarrow(4, i) \\rightarrow \\cdots \\rightarrow(2024, i) . \\\\\n& (1, i+1) \\rightarrow(2, i+1) \\rightarrow(3, i+1) \\rightarrow(3, i) \\rightarrow(4, i) \\rightarrow \\cdots \\rightarrow(2024, i) .\n\\end{aligned}\n\\]\n\nThe only cells that may contain monsters in either of these paths are ( \\(3, i-1\\) ) and ( \\(3, i+1\\) ). At most one of these can contain a monster, so at least one of the two paths will be successful.\n\n\\begin{figure}\n\\includegraphics[width=\\textwidth]{https://cdn.mathpix.com/cropped/2025_08_23_9a42685711bc262db31dg-046.jpg?height=703&width=1423&top_left_y=237&top_left_x=322}\n\\captionsetup{labelformat=empty}\n\\caption{Figure 1: Turbo's first attempt, and his second and third attempts in the case where the monster on the second row is not on the edge. The cross indicates the location of a monster, and the shaded cells are cells guaranteed to not contain a monster.}\n\\end{figure}\n\nIf the monster in the second row is on the edge of the board, without loss of generality we may assume it is in \\((2,1)\\). Then, on the second attempt, Turbo takes the following path:\n\\[\n(1,2) \\rightarrow(2,2) \\rightarrow(2,3) \\rightarrow(3,3) \\rightarrow \\cdots \\rightarrow(2022,2023) \\rightarrow(2023,2023) \\rightarrow(2024,2023) .\n\\]\n\n\\begin{figure}\n\\includegraphics[width=\\textwidth]{https://cdn.mathpix.com/cropped/2025_08_23_9a42685711bc262db31dg-046.jpg?height=709&width=1429&top_left_y=1479&top_left_x=319}\n\\captionsetup{labelformat=empty}\n\\caption{Figure 2: Turbo's second and third attempts in the case where the monster on the second row is on the edge. The light gray cells on the right diagram indicate cells that were visited on the previous attempt. Note that not all safe cells have been shaded.}\n\\end{figure}\n\nIf there are no monsters on this path, then Turbo wins. Otherwise, let \\((i, j)\\) be the first cell on which Turbo encounters a monster. We have that \\(j=i\\) or \\(j=i+1\\). Then, on the third attempt, Turbo takes the following path:\n\\[\n\\begin{aligned}\n(1,2) & \\rightarrow(2,2) \\rightarrow(2,3) \\rightarrow(3,3) \\rightarrow \\cdots \\rightarrow(i-2, i-1) \\rightarrow(i-1, i-1) \\\\\n& \\rightarrow(i, i-1) \\rightarrow(i, i-2) \\rightarrow \\cdots \\rightarrow(i, 2) \\rightarrow(i, 1) \\\\\n& \\rightarrow(i+1,1) \\rightarrow \\cdots \\rightarrow(2023,1) \\rightarrow(2024,1) .\n\\end{aligned}\n\\]\n\n\\section*{Now note that}\n- The cells from \\((1,2)\\) to \\((i-1, i-1)\\) do not contain monsters because they were reached earlier than \\((i, j)\\) on the previous attempt.\n- The cells \\((i, k)\\) for \\(1 \\leqslant k \\leqslant i-1\\) do not contain monsters because there is only one monster in row \\(i\\), and it lies in \\((i, i)\\) or \\((i, i+1)\\).\n- The cells \\((k, 1)\\) for \\(i \\leqslant k \\leqslant 2024\\) do not contain monsters because there is at most one monster in column 1 , and it lies in \\((2,1)\\).\n\nTherefore Turbo will win on the third attempt.\nComment. A small variation on Turbo's strategy when the monster on the second row is on the edge is possible. On the second attempt, Turbo can instead take the path\n\\[\n\\begin{aligned}\n(1,2023) & \\rightarrow(2,2023) \\rightarrow(2,2022) \\rightarrow \\cdots \\rightarrow(2,3) \\rightarrow(2,2) \\rightarrow(2,3) \\rightarrow \\cdots \\rightarrow(2,2023) \\\\\n& \\rightarrow(3,2023) \\rightarrow(3,2022) \\rightarrow \\cdots \\rightarrow(3,4) \\rightarrow(3,3) \\rightarrow(3,4) \\rightarrow \\cdots \\rightarrow(3,2023) \\\\\n& \\rightarrow \\cdots \\\\\n& \\rightarrow(2022,2023) \\rightarrow(2022,2022) \\rightarrow(2022,2023) \\\\\n& \\rightarrow(2023,2023) \\\\\n& \\rightarrow(2024,2023) .\n\\end{aligned}\n\\]\n\nIf there is a monster on this path, say in cell \\((i, j)\\), then on the third attempt Turbo can travel straight down to the cell just left of the monster instead of following the path traced out in the second attempt.\n\\[\n\\begin{aligned}\n(1, j-1) & \\rightarrow(2, j-1) \\rightarrow \\cdots \\rightarrow(i-1, j-1) \\rightarrow(i, j-1) \\\\\n& \\rightarrow(i, j-2) \\rightarrow \\cdots \\rightarrow(i, 2) \\rightarrow(i, 1) \\\\\n& \\rightarrow(i+1,1) \\rightarrow \\cdots \\rightarrow(2023,1) \\rightarrow(2024,1) .\n\\end{aligned}\n\\]\n\n\\begin{figure}\n\\includegraphics[width=\\textwidth]{https://cdn.mathpix.com/cropped/2025_08_23_9a42685711bc262db31dg-047.jpg?height=709&width=1432&top_left_y=1707&top_left_x=319}\n\\captionsetup{labelformat=empty}\n\\caption{Figure 3: Alternative strategy for Turbo's second and third attempts.}\n\\end{figure}", "source_pdf": "imosl_2024.pdf", "notes": "fallback-regex"}
{"id": "IMO-2024-3", "contest": "IMO", "year": "2024", "problem_number": "C7", "problem": "Let \\(N\\) be a positive integer and let \\(a_{1}, a_{2}, \\ldots\\) be an infinite sequence of positive integers. Suppose that, for each \\(n>N, a_{n}\\) is equal to the number of times \\(a_{n-1}\\) appears in the list \\(a_{1}, a_{2}, \\ldots, a_{n-1}\\).\n\nProve that at least one of the sequences \\(a_{1}, a_{3}, a_{5}, \\ldots\\) and \\(a_{2}, a_{4}, a_{6}, \\ldots\\) is eventually periodic.\n(Australia)", "solution": "1. Let \\(M>\\max \\left(a_{1}, \\ldots, a_{N}\\right)\\). We first prove that some integer appears infinitely many times. If not, then the sequence contains arbitrarily large integers. The first time each integer larger than \\(M\\) appears, it is followed by a 1 . So 1 appears infinitely many times, which is a contradiction.\n\nNow we prove that every integer \\(x \\geqslant M\\) appears at most \\(M-1\\) times. If not, consider the first time that any \\(x \\geqslant M\\) appears for the \\(M^{\\text {th }}\\) time. Up to this point, each appearance of \\(x\\) is preceded by an integer which has appeared \\(x \\geqslant M\\) times. So there must have been at least \\(M\\) numbers that have already appeared at least \\(M\\) times before \\(x\\) does, which is a contradiction.\n\nThus there are only finitely many numbers that appear infinitely many times. Let the largest of these be \\(k\\). Since \\(k\\) appears infinitely many times there must be infinitely many integers greater than \\(M\\) which appear at least \\(k\\) times in the sequence, so each integer \\(1,2, \\ldots, k-1\\) also appears infinitely many times. Since \\(k+1\\) doesn't appear infinitely often there must only be finitely many numbers which appear more than \\(k\\) times. Let the largest such number be \\(l \\geqslant k\\). From here on we call an integer \\(x\\) big if \\(x>l\\), medium if \\(l \\geqslant x>k\\) and small if \\(x \\leqslant k\\). To summarise, each small number appears infinitely many times in the sequence, while each big number appears at most \\(k\\) times in the sequence.\n\nChoose a large enough \\(N^{\\prime}>N\\) such that \\(a_{N^{\\prime}}\\) is small, and in \\(a_{1}, \\ldots, a_{N^{\\prime}}\\) :\n- every medium number has already made all of its appearances;\n- every small number has made more than \\(\\max (k, N)\\) appearances.\n\nSince every small number has appeared more than \\(k\\) times, past this point each small number must be followed by a big number. Also, by definition each big number appears at most \\(k\\) times, so it must be followed by a small number. Hence the sequence alternates between big and small numbers after \\(a_{N^{\\prime}}\\).\nLemma 1. Let \\(g\\) be a big number that appears after \\(a_{N^{\\prime}}\\). If \\(g\\) is followed by the small number \\(h\\), then \\(h\\) equals the amount of small numbers which have appeared at least \\(g\\) times before that point.\nProof. By the definition of \\(N^{\\prime}\\), the small number immediately preceding \\(g\\) has appeared more than \\(\\max (k, N)\\) times, so \\(g>\\max (k, N)\\). And since \\(g>N\\), the \\(g^{\\text {th }}\\) appearance of every small number must occur after \\(a_{N}\\) and hence is followed by \\(g\\). Since there are \\(k\\) small numbers and \\(g\\) appears at most \\(k\\) times, \\(g\\) must appear exactly \\(k\\) times, always following a small number after \\(a_{N}\\). Hence on the \\(h^{\\text {th }}\\) appearance of \\(g\\), exactly \\(h\\) small numbers have appeared at least \\(g\\) times before that point.\n\nDenote by \\(a_{[i, j]}\\) the subsequence \\(a_{i}, a_{i+1}, \\ldots, a_{j}\\).\nLemma 2. Suppose that \\(i\\) and \\(j\\) satisfy the following conditions:\n(a) \\(j>i>N^{\\prime}+2\\),\n(b) \\(a_{i}\\) is small and \\(a_{i}=a_{j}\\),\n(c) no small value appears more than once in \\(a_{[i, j-1]}\\).\n\nThen \\(a_{i-2}\\) is equal to some small number in \\(a_{[i, j-1]}\\).\n\nProof. Let \\(\\mathcal{I}\\) be the set of small numbers that appear at least \\(a_{i-1}\\) times in \\(a_{[1, i-1]}\\). By Lemma 1, \\(a_{i}=|\\mathcal{I}|\\). Similarly, let \\(\\mathcal{J}\\) be the set of small numbers that appear at least \\(a_{j-1}\\) times in \\(a_{[1, j-1]}\\). Then by Lemma \\(1, a_{j}=|\\mathcal{J}|\\) and hence by (b), \\(|\\mathcal{I}|=|\\mathcal{J}|\\). Also by definition, \\(a_{i-2} \\in \\mathcal{I}\\) and \\(a_{j-2} \\in \\mathcal{J}\\).\n\nSuppose the small number \\(a_{j-2}\\) is not in \\(\\mathcal{I}\\). This means \\(a_{j-2}\\) has appeared less than \\(a_{i-1}\\) times in \\(a_{[1, i-1]}\\). By (c), \\(a_{j-2}\\) has appeared at most \\(a_{i-1}\\) times in \\(a_{[1, j-1]}\\), hence \\(a_{j-1} \\leqslant a_{i-1}\\). Combining with \\(a_{[1, i-1]} \\subset a_{[1, j-1]}\\), this implies \\(\\mathcal{I} \\subseteq \\mathcal{J}\\). But since \\(a_{j-2} \\in \\mathcal{J} \\backslash \\mathcal{I}\\), this contradicts \\(|\\mathcal{I}|=|\\mathcal{J}|\\). So \\(a_{j-2} \\in \\mathcal{I}\\), which means it has appeared at least \\(a_{i-1}\\) times in \\(a_{[1, i-1]}\\) and one more time in \\(a_{[i, j-1]}\\). Therefore \\(a_{j-1}>a_{i-1}\\).\n\nBy (c), any small number appearing at least \\(a_{j-1}\\) times in \\(a_{[1, j-1]}\\) has also appeared \\(a_{j-1}-1 \\geqslant a_{i-1}\\) times in \\(a_{[1, i-1]}\\). So \\(\\mathcal{J} \\subseteq \\mathcal{I}\\) and hence \\(\\mathcal{I}=\\mathcal{J}\\). Therefore, \\(a_{i-2} \\in \\mathcal{J}\\), so it must appear at least \\(a_{j-1}-a_{i-1}=1\\) more time in \\(a_{[i, j-1]}\\).\n\nFor each small number \\(a_{n}\\) with \\(n>N^{\\prime}+2\\), let \\(p_{n}\\) be the smallest number such that \\(a_{n+p_{n}}=a_{i}\\) is also small for some \\(i\\) with \\(n \\leqslant i<n+p_{n}\\). In other words, \\(a_{n+p_{n}}=a_{i}\\) is the first small number to occur twice after \\(a_{n-1}\\). If \\(i>n\\), Lemma 2 (with \\(j=n+p_{n}\\) ) implies that \\(a_{i-2}\\) appears again before \\(a_{n+p_{n}}\\), contradicting the minimality of \\(p_{n}\\). So \\(i=n\\). Lemma 2 also implies that \\(p_{n} \\geqslant p_{n-2}\\). So \\(p_{n}, p_{n+2}, p_{n+4}, \\ldots\\) is a nondecreasing sequence bounded above by \\(2 k\\) (as there are only \\(k\\) small numbers). Therefore, \\(p_{n}, p_{n+2}, p_{n+4}, \\ldots\\) is eventually constant and the subsequence of small numbers is eventually periodic with period at most \\(k\\).\n\nNote. Since every small number appears infinitely often, Solution 1 additionally proves that the sequence of small numbers has period \\(k\\). The repeating part of the sequence of small numbers is thus a permutation of the integers from 1 to \\(k\\). It can be shown that every permutation of the integers from 1 to \\(k\\) is attainable in this way.\n\nSolution 2. We follow Solution 1 until after Lemma 1. For each \\(n>N^{\\prime}\\) we keep track of how many times each of \\(1,2, \\ldots, k\\) has appeared in \\(a_{1}, \\ldots, a_{n}\\). We will record this information in an updating ( \\(k+1\\) )-tuple\n\\[\n\\left(b_{1}, b_{2}, \\ldots, b_{k} ; j\\right)\n\\]\nwhere each \\(b_{i}\\) records the number of times \\(i\\) has appeared. The final element \\(j\\) of the \\((k+1)\\) tuple, also called the active element, represents the latest small number that has appeared in \\(a_{1}, \\ldots, a_{n}\\).\n\nAs \\(n\\) increases, the value of ( \\(b_{1}, b_{2}, \\ldots, b_{k} ; j\\) ) is updated whenever \\(a_{n}\\) is small. The ( \\(k+1\\) )tuple updates deterministically based on its previous value. In particular, when \\(a_{n}=j\\) is small, the active element is updated to \\(j\\) and we increment \\(b_{j}\\) by 1 . The next big number is \\(a_{n+1}=b_{j}\\). By Lemma 1, the next value of the active element, or the next small number \\(a_{n+2}\\), is given by the number of \\(b\\) terms greater than or equal to the newly updated \\(b_{j}\\), or\n\\[\n\\left|\\left\\{i \\mid 1 \\leqslant i \\leqslant k, b_{i} \\geqslant b_{j}\\right\\}\\right| .\n\\]\n\nEach sufficiently large integer which appears \\(i+1\\) times must also appear \\(i\\) times, with both of these appearances occurring after the initial block of \\(N\\). So there exists a global constant \\(C\\) such that \\(b_{i+1}-b_{i} \\leqslant C\\). Suppose that for some \\(r, b_{r+1}-b_{r}\\) is unbounded from below. Since the value of \\(b_{r+1}-b_{r}\\) changes by at most 1 when it is updated, there must be some update where \\(b_{r+1}-b_{r}\\) decreases and \\(b_{r+1}-b_{r}<-(k-1) C\\). Combining with the fact that \\(b_{i}-b_{i-1} \\leqslant C\\) for all \\(i\\), we see that at this particular point, by the triangle inequality\n\\[\n\\min \\left(b_{1}, \\ldots, b_{r}\\right)>\\max \\left(b_{r+1}, \\ldots, b_{k}\\right)\n\\]\n\nSince \\(b_{r+1}-b_{r}\\) just decreased, the new active element is \\(r\\). From this point on, if the new active element is at most \\(r\\), by (1) and (2), the next element to increase is once again from \\(b_{1}, \\ldots, b_{r}\\). Thus only \\(b_{1}, \\ldots, b_{r}\\) will increase from this point onwards, and \\(b_{k}\\) will no longer increase, contradicting the fact that \\(k\\) must appear infinitely often in the sequence. Therefore \\(\\left|b_{r+1}-b_{r}\\right|\\) is bounded.\n\nSince \\(\\left|b_{r+1}-b_{r}\\right|\\) is bounded, it follows that each of \\(\\left|b_{i}-b_{1}\\right|\\) is bounded for \\(i=1, \\ldots, k\\). This means that there are only finitely many different states for ( \\(b_{1}-b_{1}, b_{2}-b_{1}, \\ldots, b_{k}-b_{1} ; j\\) ). Since the next active element is completely determined by the relative sizes of \\(b_{1}, b_{2}, \\ldots, b_{k}\\) to each other, and the update of \\(b\\) terms depends on the active element, the active element must be eventually periodic. Therefore the small numbers subsequence, which is either \\(a_{1}, a_{3}, a_{5}, \\ldots\\) or \\(a_{2}, a_{4}, a_{6}, \\ldots\\), must be eventually periodic.", "source_pdf": "imosl_2024.pdf", "notes": "fallback-regex"}
{"id": "IMO-2024-4", "contest": "IMO", "year": "2024", "problem_number": "G2", "problem": "Let \\(A B C\\) be a triangle with \\(A B<A C<B C\\), incentre \\(I\\) and incircle \\(\\omega\\). Let \\(X\\) be the point in the interior of side \\(B C\\) such that the line through \\(X\\) parallel to \\(A C\\) is tangent to \\(\\omega\\). Similarly, let \\(Y\\) be the point in the interior of side \\(B C\\) such that the line through \\(Y\\) parallel to \\(A B\\) is tangent to \\(\\omega\\). Let \\(A I\\) intersect the circumcircle of triangle \\(A B C\\) again at \\(P \\neq A\\). Let \\(K\\) and \\(L\\) be the midpoints of \\(A B\\) and \\(A C\\), respectively.\n\nProve that \\(\\angle K I L+\\angle Y P X=180^{\\circ}\\).\n(Poland)", "solution": "1. Let \\(A^{\\prime}\\) be the reflection of \\(A\\) in \\(I\\), then \\(A^{\\prime}\\) lies on the angle bisector \\(A P\\). Lines \\(A^{\\prime} X\\) and \\(A^{\\prime} Y\\) are the reflections of \\(A C\\) and \\(A B\\) in \\(I\\), respectively, and so they are the tangents to \\(\\omega\\) from \\(X\\) and \\(Y\\). As is well-known, \\(P B=P C=P I\\), and since \\(\\angle B A P=\\angle P A C>30^{\\circ}\\), \\(P B=P C\\) is greater than the circumradius. Hence \\(P I>\\frac{1}{2} A P>A I\\); we conclude that \\(A^{\\prime}\\) lies in the interior of segment \\(A P\\).\n![](https://cdn.mathpix.com/cropped/2025_08_23_9a42685711bc262db31dg-067.jpg?height=1072&width=1003&top_left_y=990&top_left_x=531)\n\nWe have \\(\\angle A P B=\\angle A C B\\) in the circumcircle and \\(\\angle A C B=\\angle A^{\\prime} X C\\) because \\(A^{\\prime} X \\| A C\\). Hence, \\(\\angle A P B=\\angle A^{\\prime} X C\\), and so quadrilateral \\(B P A^{\\prime} X\\) is cyclic. Similarly, it follows that \\(C Y A^{\\prime} P\\) is cyclic.\n\nNow we are ready to transform \\(\\angle K I L+\\angle Y P X\\) to the sum of angles in triangle \\(A^{\\prime} C B\\). By a homothety of factor 2 at \\(A\\) we have \\(\\angle K I L=\\angle C A^{\\prime} B\\). In circles \\(B P A^{\\prime} X\\) and \\(C Y A^{\\prime} P\\) we have \\(\\angle A P X=\\angle A^{\\prime} B C\\) and \\(\\angle Y P A=\\angle B C A^{\\prime}\\), therefore\n\\[\n\\angle K I L+\\angle Y P X=\\angle C A^{\\prime} B+(\\angle Y P A+\\angle A P X)=\\angle C A^{\\prime} B+\\angle B C A^{\\prime}+\\angle A^{\\prime} B C=180^{\\circ} .\n\\]\n\nComment. The constraint \\(A B<A C<B C\\) was added by the Problem Selection Committee in order to reduce case-sensitivity. Without that, there would be two more possible configurations according to the possible orders of points \\(A, P\\) and \\(A^{\\prime}\\), as shown in the pictures below. The solution for these cases is broadly the same, but some extra care is required in the degenerate case when \\(A^{\\prime}\\) coincides with \\(P\\) and line \\(A P\\) is a common tangent to circles \\(B P X\\) and \\(C P Y\\).\n![](https://cdn.mathpix.com/cropped/2025_08_23_9a42685711bc262db31dg-068.jpg?height=987&width=1564&top_left_y=515&top_left_x=251)\n\nSolution 2. Let \\(B C=a, A C=b, A B=c\\) and \\(s=\\frac{a+b+c}{2}\\), and let the radii of the incircle, \\(B\\)-excircle and \\(C\\)-excircle be \\(r, r_{b}\\) and \\(r_{c}\\), respectively. Let the incircle be tangent to \\(A C\\) and \\(A B\\) at \\(B_{0}\\) and \\(C_{0}\\), respectively; let the \\(B\\)-excircle be tangent to \\(A C\\) at \\(B_{1}\\), and let the \\(C\\)-excircle be tangent to \\(A B\\) at \\(C_{1}\\). As is well-known, \\(A B_{1}=s-c\\) and area \\((\\triangle A B C)=r s=r_{c}(s-c)\\).\n\nLet the line through \\(X\\), parallel to \\(A C\\) be tangent to the incircle at \\(E\\), and the line through \\(Y\\), parallel to \\(A B\\) be tangent to the incircle at \\(D\\). Finally, let \\(A P\\) meet \\(B B_{1}\\) at \\(F\\).\n![](https://cdn.mathpix.com/cropped/2025_08_23_9a42685711bc262db31dg-069.jpg?height=915&width=1566&top_left_y=582&top_left_x=251)\n\nIt is well-known that points \\(B, E\\), and \\(B_{1}\\) are collinear by the homothety between the incircle and the \\(B\\)-excircle, and \\(B E \\| I K\\) because \\(I K\\) is a midline in triangle \\(B_{0} E B_{1}\\). Similarly, it follows that \\(C, D\\), and \\(C_{1}\\) are collinear and \\(C D \\| I L\\). Hence, the problem reduces to proving \\(\\angle Y P A=\\angle C B E\\) (and its symmetric counterpart \\(\\angle A P X=\\angle D C B\\) with respect to the vertex \\(C\\) ), so it suffices to prove that \\(F Y P B\\) is cyclic. Since \\(A C P B\\) is cyclic, that is equivalent to \\(F Y \\| B_{1} C\\) and \\(\\frac{B F}{F B_{1}}=\\frac{B Y}{Y C}\\).\n\nBy the angle bisector theorem we have\n\\[\n\\frac{B F}{F B_{1}}=\\frac{A B}{A B_{1}}=\\frac{c}{s-c} .\n\\]\n\nThe homothety at \\(C\\) that maps the incircle to the \\(C\\)-excircle sends \\(Y\\) to \\(B\\), so\n\\[\n\\frac{B C}{Y C}=\\frac{r_{c}}{r}=\\frac{s}{s-c} .\n\\]\n\nSo,\n\\[\n\\frac{B Y}{Y C}=\\frac{B C}{Y C}-1=\\frac{s}{s-c}-1=\\frac{c}{s-c}=\\frac{B F}{F B_{1}},\n\\]\nwhich completes the solution.", "source_pdf": "imosl_2024.pdf", "notes": "fallback-regex"}
{"id": "IMO-2024-2", "contest": "IMO", "year": "2024", "problem_number": "N4", "problem": "Determine all positive integers \\(a\\) and \\(b\\) such that there exists a positive integer \\(g\\) such that \\(\\operatorname{gcd}\\left(a^{n}+b, b^{n}+a\\right)=g\\) for all sufficiently large \\(n\\).\n(Indonesia)", "solution": "Answer: The only\n\nis \\((a, b)=(1,1)\\).\nSolution 1. It is clear that we may take \\(g=2\\) for \\((a, b)=(1,1)\\). Supposing that \\((a, b)\\) satisfies the conditions in the problem, let \\(N\\) be a positive integer such that \\(\\operatorname{gcd}\\left(a^{n}+b, b^{n}+a\\right)=g\\) for all \\(n \\geqslant N\\).\nLemma. We have that \\(g=\\operatorname{gcd}(a, b)\\) or \\(g=2 \\operatorname{gcd}(a, b)\\).\nProof. Note that both \\(a^{N}+b\\) and \\(a^{N+1}+b\\) are divisible by \\(g\\). Hence\n\\[\na\\left(a^{N}+b\\right)-\\left(a^{N+1}+b\\right)=a b-b=a(b-1)\n\\]\nis divisible by \\(g\\). Analogously, \\(b(a-1)\\) is divisible by \\(g\\). Their difference \\(a-b\\) is then divisible by \\(g\\), so \\(g\\) also divides \\(a(b-1)+a(a-b)=a^{2}-a\\). All powers of \\(a\\) are then congruent modulo \\(g\\), so \\(a+b \\equiv a^{N}+b \\equiv 0(\\bmod g)\\). Then \\(2 a=(a+b)+(a-b)\\) and \\(2 b=(a+b)-(a-b)\\) are both divisible by \\(g\\), so \\(g \\mid 2 \\operatorname{gcd}(a, b)\\). On the other hand, it is clear that \\(\\operatorname{gcd}(a, b) \\mid g\\), thus proving the Lemma.\n\nLet \\(d=\\operatorname{gcd}(a, b)\\), and write \\(a=d x\\) and \\(b=d y\\) for coprime positive integers \\(x\\) and \\(y\\). We have that\n\\[\n\\operatorname{gcd}\\left((d x)^{n}+d y,(d y)^{n}+d x\\right)=d \\operatorname{gcd}\\left(d^{n-1} x^{n}+y, d^{n-1} y^{n}+x\\right),\n\\]\nso the Lemma tells us that\n\\[\n\\operatorname{gcd}\\left(d^{n-1} x^{n}+y, d^{n-1} y^{n}+x\\right) \\leqslant 2\n\\]\nfor all \\(n \\geqslant N\\). Defining \\(K=d^{2} x y+1\\), note that \\(K\\) is coprime to each of \\(d, x\\), and \\(y\\). By Euler's theorem, for \\(n \\equiv-1(\\bmod \\varphi(K))\\) we have that\n\\[\nd^{n-1} x^{n}+y \\equiv d^{-2} x^{-1}+y \\equiv d^{-2} x^{-1}\\left(1+d^{2} x y\\right) \\equiv 0 \\quad(\\bmod K)\n\\]\nso \\(K \\mid d^{n-1} x^{n}+y\\). Analogously, we have that \\(K \\mid d^{n-1} y^{n}+x\\). Taking such an \\(n\\) which also satisfies \\(n \\geqslant N\\) gives us that\n\\[\nK \\mid \\operatorname{gcd}\\left(d^{n-1} x^{n}+y, d^{n-1} y^{n}+x\\right) \\leqslant 2 .\n\\]\n\nThis is only possible when \\(d=x=y=1\\), which yields the only solution \\((a, b)=(1,1)\\).\nSolution 2. After proving the Lemma, one can finish the solution as follows.\nFor any prime factor \\(p\\) of \\(a b+1, p\\) is coprime to \\(a\\) and \\(b\\). Take an \\(n \\geqslant N\\) such that \\(n \\equiv-1 (\\bmod p-1)\\). By Fermat's little theorem, we have that\n\\[\n\\begin{aligned}\n& a^{n}+b \\equiv a^{-1}+b=a^{-1}(1+a b) \\equiv 0 \\quad(\\bmod p) \\\\\n& b^{n}+a \\equiv b^{-1}+a=b^{-1}(1+a b) \\equiv 0 \\quad(\\bmod p)\n\\end{aligned}\n\\]\nthen \\(p\\) divides \\(g\\). By the Lemma, we have that \\(p \\mid 2 \\operatorname{gcd}(a, b)\\), and thus \\(p=2\\). Therefore, \\(a b+1\\) is a power of 2 , and \\(a\\) and \\(b\\) are both odd numbers.\n\nIf \\((a, b) \\neq(1,1)\\), then \\(a b+1\\) is divisible by 4 , hence \\(\\{a, b\\}=\\{-1,1\\}(\\bmod 4)\\). For odd \\(n \\geqslant N\\), we have that\n\\[\na^{n}+b \\equiv b^{n}+a \\equiv(-1)+1=0 \\quad(\\bmod 4)\n\\]\nthen \\(4 \\mid g\\). But by the Lemma, we have that \\(\\nu_{2}(g) \\leqslant \\nu_{2}(2 \\operatorname{gcd}(a, b))=1\\), which is a contradiction. So the only solution to the problem is \\((a, b)=(1,1)\\).", "source_pdf": "imosl_2024.pdf", "notes": "fallback-regex"}
{"id": "IMO-2025-1", "contest": "IMO", "year": "2025", "problem_number": "1", "problem": "A line in the plane is called sunny if it is not parallel to any of the \\(x\\)-axis, the \\(y\\)-axis, or the line \\(x+y=0\\). Let \\(n \\geq 3\\) be a given integer. Determine all nonnegative integers \\(k\\) such that there exist \\(n\\) distinct lines in the plane satisfying both of the following: - for all positive integers \\(a\\) and \\(b\\) with \\(a+b \\leq n+1\\), the point \\((a, b)\\) lies on at least one of the lines; and - exactly \\(k\\) of the \\(n\\) lines are sunny.", "solution": "The answer is 0,1 , or 3 sunny lines. In what follows, we draw the grid as equilateral instead of a right triangle; this has no effect on the problem statement but is more symmetric. We say a long line is one of the three lines at the edge of the grid, i.e. one of the (non-sunny) lines passing through \\(n\\) points. The main claim is the following. Claim - If \\(n \\geq 4\\), any set of \\(n\\) lines must have at least one long line. Proof. Consider the \\(3(n-1)\\) points on the outer edge of the grid. If there was no long line, each of the \\(n\\) lines passes through at most two such points. So we obtain \\(2 n \\geq 3(n-1)\\), which forces \\(n \\leq 3\\). Hence, by induction we may repeatedly delete a long line without changing the number of sunny lines until \\(n=3\\) (and vice-versa: given a construction for smaller \\(n\\) we can increase \\(n\\) by one and add a long line). We now classify all the ways to cover the \\(1+2+3=6\\) points in an \\(n=3\\) grid with 3 lines. - If there is a long line (say, the red one in the figure), the remaining \\(1+2=3\\) points (circled in blue) are covered with two lines. One of the lines passes through 2 points and must not be sunny; the other line may or may not be sunny. Hence in this case the possible counts of sunny lines are 0 or 1 . - If there is no long line, each of the three lines passes through at most 2 points. But there are 6 total lines, so in fact each line must pass through exactly two points. The only way to do this is depicted in the figure in the right. In this case there are 3 sunny lines. This proves that \\(0,1,3\\) are the only possible answers. Remark. The concept of a sunny line is not that important to the problem. The proof above essentially classifies all the ways to cover the \\(1+2+\\cdots+n\\) points with exactly \\(n\\) lines. Namely, one should repeatedly take a long line and decrease \\(n\\) until \\(n=3\\), and then pick one of the finitely many cases for \\(n=3\\). The count of sunny lines just happens to be whatever is possible for \\(n=3\\), since long lines are not sunny.", "source_pdf": "imo_2025.pdf", "notes": ""}
{"id": "IMO-2025-2", "contest": "IMO", "year": "2025", "problem_number": "2", "problem": "Let \\(\\Omega\\) and \\(\\Gamma\\) be circles with centres \\(M\\) and \\(N\\), respectively, such that the radius of \\(\\Omega\\) is less than the radius of \\(\\Gamma\\). Suppose \\(\\Omega\\) and \\(\\Gamma\\) intersect at two distinct points \\(A\\) and \\(B\\). Line \\(M N\\) intersects \\(\\Omega\\) at \\(C\\) and \\(\\Gamma\\) at \\(D\\), so that \\(C, M, N, D\\) lie on \\(M N\\) in that order. Let \\(P\\) be the circumcenter of triangle \\(A C D\\). Line \\(A P\\) meets \\(\\Omega\\) again at \\(E \\neq A\\) and meets \\(\\Gamma\\) again at \\(F \\neq A\\). Let \\(H\\) be the orthocenter of triangle \\(P M N\\). Prove that the line through \\(H\\) parallel to \\(A P\\) is tangent to the circumcircle of triangle \\(B E F\\).", "solution": "Throughout the solution, we define \\[ \\begin{aligned} & \\alpha:=\\measuredangle D C A=\\measuredangle B C D \\Longrightarrow \\measuredangle P A D=\\measuredangle C A B=90^{\\circ}-\\alpha \\\\ & \\beta:=\\measuredangle A D C=\\measuredangle C D B \\Longrightarrow \\measuredangle C A P=\\measuredangle B A D=90^{\\circ}-\\beta . \\end{aligned} \\] Ignore the points \\(H, M, N\\) for now and focus on the remaining ones. Claim - We have \\(\\overline{C E} \\| \\overline{A D}\\) and \\(\\overline{D F} \\| \\overline{A C}\\). Proof. \\(\\measuredangle A E C=\\measuredangle A B C=\\measuredangle C A B=90^{\\circ}-\\alpha\\). Hence, if we let \\(A^{\\prime}:=\\overline{C E} \\cap \\overline{D F}\\), we have a parallelogram \\(A C A^{\\prime} D\\). Note in particular that \\(\\overline{B A^{\\prime}} \\| \\overline{C D}\\). Next, let \\(T\\) denote the circumcenter of \\(\\triangle A^{\\prime} E F\\). (This will be the tangency point later in the problem.) Claim - Point \\(T\\) also lies on \\(\\overline{B A^{\\prime}}\\) and is also the arc midpoint of \\(\\widehat{E F}\\) on \\((B E F)\\). Proof. We compute the angles of \\(\\triangle A^{\\prime} E F\\) : \\[ \\begin{aligned} & \\measuredangle F E A^{\\prime}=\\measuredangle A E C=\\measuredangle A B C=\\measuredangle C A B=90^{\\circ}-\\alpha \\\\ & \\measuredangle A^{\\prime} F E=\\measuredangle D F A=\\measuredangle D B A=\\measuredangle B A D=90^{\\circ}-\\beta \\\\ & \\measuredangle E A^{\\prime} F=\\alpha+\\beta . \\end{aligned} \\] Then, since \\(T\\) is the circumcenter, it follows that: \\[ \\measuredangle E A^{\\prime} T=\\measuredangle 90^{\\circ}-\\measuredangle A^{\\prime} F E=\\beta=\\measuredangle A^{\\prime} C D=\\measuredangle C A^{\\prime} B . \\] This shows that \\(T\\) lies on \\(\\overline{B A^{\\prime}}\\). Also, we have \\(\\measuredangle E T F=2 \\measuredangle E A^{\\prime} F=2(\\alpha+\\beta)\\) and \\[ \\measuredangle E B F=\\measuredangle E B A+\\measuredangle A B F=\\measuredangle E C A+\\measuredangle A D F \\] \\[ =\\measuredangle A^{\\prime} C A+\\measuredangle A D A^{\\prime}=(\\alpha+\\beta)+(\\alpha+\\beta)=2(\\alpha+\\beta) \\] which proves that \\(T\\) also lies on \\(\\overline{A B^{\\prime}}\\). We then bring \\(M\\) and \\(N\\) into the picture as follows: Claim - Point \\(T\\) lies on both lines \\(M E\\) and \\(N F\\). Proof. To show that \\(F, T, N\\) are collinear, note that \\(\\triangle F E A^{\\prime} \\sim \\triangle F A D\\) via a homothety at \\(F\\). This homothety maps \\(T\\) to \\(N\\). We now deal with point \\(H\\) using two claims. Claim - We have \\(\\overline{M H} \\| \\overline{A D}\\) and \\(\\overline{N H} \\| \\overline{A C}\\). Proof. Note that \\(\\overline{M H} \\perp \\overline{P N}\\), but \\(\\overline{P N}\\) is the perpendicular bisector of \\(\\overline{A D}\\), so in fact \\(\\overline{M H} \\| \\overline{A D}\\). Similarly, \\(\\overline{N H} \\| \\overline{A C}\\). Claim - Lines \\(\\overline{M H}\\) and \\(\\overline{N H}\\) bisect \\(\\angle N M T\\) and \\(\\angle M N T\\). In fact, point \\(H\\) is the incenter of \\(\\triangle T M N\\), and \\(\\measuredangle N T H=\\measuredangle H T M=90^{\\circ}-(\\alpha+\\beta)\\). Proof. Hence, \\(\\measuredangle H M N=\\measuredangle A^{\\prime} C D=\\measuredangle A D C=\\beta\\). But \\(\\measuredangle T M N=\\measuredangle C M E=2 \\measuredangle C A E= -2\\left(90^{\\circ}-2 \\beta\\right)=2 \\beta\\). That proves \\(\\overline{M H}\\) bisects \\(\\angle N M T\\); the other one is similar. To show that \\(H\\) is an incenter (rather than an excenter) and get the last angle equality, we need to temporarily undirect our angles. Assume WLOG that \\(\\triangle A C D\\) is directed counterclockwise. The problem condition that \\(C\\) and \\(D\\) are the farther intersections of line \\(M N\\) mean that \\(\\angle N H M=\\angle C A D>90^{\\circ}\\). We are also promised \\(C, M, N, D\\) are collinear in that order. Hence the reflections of line \\(M N\\) over lines \\(M H\\) and \\(N H\\), which meet at \\(T\\), should meet at a point for which \\(T\\) lies on the same side as \\(H\\). In other words, \\(\\triangle M T N\\) is oriented counterclockwise and contains \\(H\\). Working with undirected \\(\\alpha=\\angle D C A\\) and \\(\\beta=\\angle A D C\\) with \\(\\alpha+\\beta<90^{\\circ}\\), \\[ \\angle N T H=\\angle H T M=\\frac{1}{2} \\angle N T M=\\frac{1}{2}\\left(180^{\\circ}-2(\\alpha+\\beta)\\right)=90^{\\circ}-(\\alpha+\\beta) . \\] This matches the claim and finishes the result. Now \\[ \\measuredangle N F A=90^{\\circ}-\\measuredangle A D F=90^{\\circ}-(\\alpha+\\beta)=\\measuredangle N T H \\] so \\(\\overline{H T} \\| \\overline{A P}\\). And since \\(T E=T F\\), we have the tangency requested too now, as desired. Remark. There are many other ways to describe the point \\(T\\). For example, \\(A M T N\\) is a parallelogram and \\(M B T N\\) is an isosceles trapezoid. In coordination, we joked that it was impossible to write a false conjecture.", "source_pdf": "imo_2025.pdf", "notes": ""}
{"id": "IMO-2025-3", "contest": "IMO", "year": "2025", "problem_number": "3", "problem": "A function \\(f: \\mathbb{N} \\rightarrow \\mathbb{N}\\) is said to be bonza if \\[ f(a) \\text { divides } b^{a}-f(b)^{f(a)} \\] for all positive integers \\(a\\) and \\(b\\). Determine the smallest real constant \\(c\\) such that \\(f(n) \\leq c n\\) for all bonza functions \\(f\\) and all positive integers \\(n\\).", "solution": "The answer is \\(c=4\\). Let \\(P(a, b)\\) denote the given statement \\(f(a) \\mid b^{a}-f(b)^{f(a)}\\). Claim - We have \\(f(n) \\mid n^{n}\\) for all \\(n\\). Proof. Take \\(P(n, n)\\). Claim - Unless \\(f=\\mathrm{id}\\), we have \\(f(p)=1\\) for all odd primes \\(p\\). Proof. Consider any prime \\(q\\) with \\(f(q)>1\\). Then \\(f(q)\\) is a power of \\(q\\), and for each \\(n\\) we get \\[ P(q, n) \\Longrightarrow q|f(q)| n^{q}-f(n)^{f(q)} \\text {. } \\] Fermat's little theorem now gives \\(n^{q} \\equiv n(\\bmod q)\\) and \\(f(n)^{f(q)} \\equiv f(n)(\\bmod q)(\\) since \\(f(q)\\) is a power of \\(q\\) ), and therefore \\(q \\mid n-f(n)\\). Hence, unless \\(f\\) is the identity function, only finitely many \\(q\\) could have \\(f(q)>1\\). Now let \\(p\\) be any odd prime, and let \\(q\\) be a large prime such that \\(q \\not \\equiv 1(\\bmod p)\\) (possible for all \\(p>2\\), say by Dirichlet). Then \\[ P(p, q) \\Longrightarrow f(p) \\mid q^{p}-1^{p} \\] The RHS is \\(q^{p}-1 \\equiv q-1 \\not \\equiv 0(\\bmod p)\\), so \\(f(p)=1\\). Claim - We have \\(f(n) \\mid 2^{\\infty}\\) for all \\(n\\). Proof. If \\(p \\mid f(n)\\) is odd then \\(P(n, p)\\) gives \\(p|f(n)| p^{n}-1^{n}\\), contradiction. (In particular, we now know \\(f(n)=1\\) for all odd \\(n\\), though we don't use this.) Claim - We have \\(f(n) \\leq 2^{\\nu_{2}(n)+2}\\) for all \\(n\\). Proof. Consider \\(P(n, 5) \\Longrightarrow f(n) \\mid 5^{n}-1^{n}\\). It's well-known that \\(\\nu_{2}\\left(5^{n}-1\\right)=\\nu_{2}(n)+2\\) for all \\(n\\). This immediately shows \\(f(n) \\leq 4 n\\) for all \\(n\\), hence \\(c=4\\) in the problem statement works. For the construction, the simplest one seems to be \\[ f(n)= \\begin{cases}1 & n \\text { odd } \\\\ 16 & n=4 \\\\ 2 & n \\text { even, } n \\neq 4\\end{cases} \\] which is easily checked to work and has \\(f(4)=16\\). Remark. With a little more case analysis we can classify all functions \\(f\\). The two trivial solutions are \\(f(n)=n\\) and \\(f(n)=1\\); the others are described by writing \\(f(n)=2^{e(n)}\\) for any function \\(e\\) satisfying - \\(e(n)=0\\) for odd \\(n\\); - \\(1 \\leq e(2) \\leq 2\\); - \\(1 \\leq e(n) \\leq \\nu_{2}(n)+2\\) for even \\(n>2\\). This basically means that there are almost no additional constraints beyond what is suggested by the latter two claims.", "source_pdf": "imo_2025.pdf", "notes": ""}
{"id": "IMO-2025-4", "contest": "IMO", "year": "2025", "problem_number": "4", "problem": "An infinite sequence \\(a_{1}, a_{2}, \\ldots\\) consists of positive integers has each of which has at least three proper divisors. Suppose that for each \\(n \\geq 1, a_{n+1}\\) is the sum of the three largest proper divisors of \\(a_{n}\\). Determine all possible values of \\(a_{1}\\).", "solution": "The answer is \\(a_{1}=12^{e} \\cdot 6 \\cdot \\ell\\) for any \\(e, \\ell \\geq 0\\) with \\(\\operatorname{gcd}(\\ell, 10)=1\\). Let \\(\\mathbf{S}\\) denote the set of positive integers with at least three divisors. For \\(x \\in \\mathbf{S}\\), let \\(\\psi(x)\\) denote the sum of the three largest ones, so that \\(\\psi\\left(a_{n}\\right)=a_{n+1}\\). Proof that all such \\(a_{1}\\) work. Let \\(x=12^{e} \\cdot 6 \\cdot \\ell \\in \\mathbf{S}\\) with \\(\\operatorname{gcd}(\\ell, 10)=1\\). As \\(\\frac{1}{2}+\\frac{1}{3}+\\frac{1}{4}=\\frac{13}{12}\\), we get \\[ \\psi(x)= \\begin{cases}x & e=0 \\\\ \\frac{13}{12} x & e>0\\end{cases} \\] so by induction on the value of \\(e\\) we see that \\(\\psi(x) \\in \\mathbf{S}\\) (the base \\(e=0\\) coming from \\(\\psi\\) fixing \\(x\\) ). IT Proof that all \\(a_{1}\\) are of this form. In what follows \\(x\\) is always an element of \\(\\mathbf{S}\\), not necessarily an element of the sequence. Claim - Let \\(x \\in \\mathbf{S}\\). If \\(2 \\mid \\psi(x)\\) then \\(2 \\mid x\\). Proof. If \\(x\\) is odd then every divisor of \\(x\\) is odd, so \\(\\psi(x)\\) is the sum of three odd numbers. Claim - Let \\(x \\in \\mathbf{S}\\). If \\(6 \\mid \\psi(x)\\) then \\(6 \\mid x\\). Proof. We consider only \\(x\\) even because of the previous claim. We prove the contrapositive that \\(3 \\nmid x \\Longrightarrow 6 \\nmid \\psi(x)\\) (for even \\(x\\) ). - If \\(4 \\mid x\\), then letting \\(d\\) be the third largest proper divisor of \\(x\\), \\[ \\psi(x)=\\frac{x}{2}+\\frac{x}{4}+d=\\frac{3}{4} x+d \\equiv d \\not \\equiv 0 \\quad(\\bmod 3) . \\] - Otherwise, let \\(p \\mid x\\) be the smallest prime dividing \\(x\\), with \\(p>3\\). If the thirdsmallest nontrivial divisor of \\(x\\) is \\(2 p\\), then \\[ \\psi(x)=\\frac{x}{2}+\\frac{x}{p}+\\frac{x}{2 p}=\\frac{3}{2 p} x+\\frac{x}{2} \\equiv \\frac{x}{2} \\not \\equiv 0 \\quad(\\bmod 3) . \\] If the third-smallest nontrivial divisor of \\(x\\) is instead an odd prime \\(q\\), then \\[ \\psi(x)=\\frac{x}{2}+\\frac{x}{p}+\\frac{x}{q} \\equiv 1+0+0 \\equiv 1 \\quad(\\bmod 2) \\] To tie these two claims into the problem, we assert: Claim - Every \\(a_{i}\\) must be divisible by 6. Proof. The idea is to combine the previous two claims (which have no dependence on the sequence) with a size argument. - For odd \\(x \\in \\mathbf{S}\\) note that \\(\\psi(x)<\\left(\\frac{1}{3}+\\frac{1}{5}+\\frac{1}{7}\\right) x<x\\) and \\(\\psi(x)\\) is still odd. So if any \\(a_{i}\\) is odd the sequence is strictly decreasing and that's impossible. Hence, we may assume \\(a_{1}, a_{2}, \\ldots\\) are all even. - If \\(x \\in \\mathbf{S}\\) is even but \\(3 \\nmid x\\) then \\(\\psi(x)<\\left(\\frac{1}{2}+\\frac{1}{4}+\\frac{1}{5}\\right) x<x\\) and \\(\\psi(x)\\) is still not a multiple of 3 . So if any \\(a_{i}\\) is not divisible by 3 the sequence is again strictly decreasing. On the other hand, if \\(x\\) is a multiple of 6 , we have the following formula for \\(\\psi(x)\\) : \\[ \\psi(x)= \\begin{cases}\\frac{13}{12} x & 4 \\mid x \\\\ \\frac{31}{30} x & 4 \\nmid x \\text { but } 5 \\mid x \\\\ x & 4 \\nmid x \\text { and } 5 \\nmid x .\\end{cases} \\] Looking back on our sequence of \\(a_{i}\\) (which are all multiples of 6 ), the center case cannot happen with our \\(a_{i}\\), because \\(\\frac{31}{30} x\\) is odd when \\(x \\equiv 2(\\bmod 4)\\). Hence in actuality \\[ a_{n+1}=\\frac{13}{12} a_{n} \\quad \\text { or } \\quad a_{n+1}=a_{n} \\] for every \\(n\\). Let \\(T\\) be the smallest index such that \\(a_{T}=a_{T+1}=a_{T+2}=\\cdots\\) (it must exist because we cannot multiply by \\(\\frac{13}{12}\\) forever). Then we can exactly describe the sequence by \\[ a_{n}=a_{1} \\cdot\\left(\\frac{13}{12}\\right)^{\\min (n, T)-1} \\] Hence \\(a_{1}=\\left(\\frac{12}{13}\\right)^{T-1} a_{T}\\), and since \\(a_{T}\\) is a multiple of 6 not divisible by 4 or 5 , it follows \\(a_{1}\\) has the required form.", "source_pdf": "imo_2025.pdf", "notes": ""}
{"id": "IMO-2025-5", "contest": "IMO", "year": "2025", "problem_number": "5", "problem": "Alice and Bazza are playing the inekoalaty game, a two-player game whose rules depend on a positive real number \\(\\lambda\\) which is known to both players. On the \\(n\\)th turn of the game (starting with \\(n=1\\) ) the following happens: - If \\(n\\) is odd, Alice chooses a nonnegative real number \\(x_{n}\\) such that \\[ x_{1}+x_{2}+\\cdots+x_{n} \\leq \\lambda n . \\] - If \\(n\\) is even, Bazza chooses a nonnegative real number \\(x_{n}\\) such that \\[ x_{1}^{2}+x_{2}^{2}+\\cdots+x_{n}^{2} \\leq n . \\] If a player cannot choose a suitable \\(x_{n}\\), the game ends and the other player wins. If the game goes on forever, neither player wins. All chosen numbers are known to both players. Determine all values of \\(\\lambda\\) for which Alice has a winning strategy and all those for which Bazza has a winning strategy.", "solution": "The answer is that Alice has a winning strategy for \\(\\lambda>1 / \\sqrt{2}\\), and Bazza has a winning strategy for \\(\\lambda<1 / \\sqrt{2}\\). (Neither player can guarantee winning for \\(\\lambda=1 / \\sqrt{2}\\).) We divide the proof into two parts. If Alice's strategy when \\(\\lambda \\geq 1 / \\sqrt{2}\\). Consider the strategy where Alice always plays \\(x_{2 i+1}=0\\) for \\(i=0, \\ldots, k-1\\). In this situation, when \\(n=2 k+1\\) we have \\[ \\begin{aligned} \\sum_{1}^{2 k} x_{i} & =0+x_{2}+0+x_{4}+\\cdots+0+x_{2 k} \\\\ & \\leq k \\cdot \\sqrt{\\frac{x_{2}^{2}+\\cdots+x_{2 k}^{2}}{k}}=\\sqrt{2} \\cdot k<\\lambda \\cdot(2 k+1) \\end{aligned} \\] and so the choices for \\(x_{2 k+1}\\) are \\[ x_{2 k+1} \\in[0, \\lambda \\cdot(2 k+1)-\\sqrt{2} k] \\] which is nonempty. Hence Alice can't ever lose with this strategy. But suppose further \\(\\lambda>\\frac{1}{\\sqrt{2}}\\); we show Alice can win. Choose \\(k\\) large enough that \\[ \\sqrt{2} \\cdot k<\\lambda \\cdot(2 k+1)-\\sqrt{2 k+2} . \\] Then on the ( \\(2 k+1\\) )st turn, Alice can (after playing 0 on all earlier turns) play a number greater than \\(\\sqrt{2 k+2}\\) and cause Bazza to lose. Bazza strategy when \\(\\lambda \\leq 1 / \\sqrt{2}\\). Consider the strategy where Bazza always plays \\(x_{2 i+2}=\\sqrt{2-x_{2 i+1}^{2}}\\) for all \\(i=0, \\ldots, k-1\\) (i.e. that is, the largest possible value Bazza can play). To analyze Bazza's choices on each of his turns, we first need to estimate \\(x_{2 k+1}\\). We do this by writing \\[ \\begin{aligned} \\lambda \\cdot(2 k+1) \\geq & x_{1}+x_{2}+\\cdots+x_{2 k+1} \\\\ = & \\left(x_{1}+\\sqrt{2-x_{1}^{2}}\\right)+\\left(x_{3}+\\sqrt{2-x_{3}^{2}}\\right) \\\\ & \\quad+\\cdots+\\left(x_{2 k-1}+\\sqrt{2-x_{2 k}^{2}}\\right)+x_{2 k+1} \\\\ \\geq & \\underbrace{\\sqrt{2}+\\cdots+\\sqrt{2}}_{k \\text { times }}+x_{2 k+1}=\\sqrt{2} \\cdot k+x_{2 k+1} \\end{aligned} \\] where we have used the fact that \\(t+\\sqrt{2-t^{2}} \\geq 2\\) for all \\(t \\geq 0\\). This means that \\[ x_{2 k+1} \\leq \\lambda \\cdot(2 k+1)-\\sqrt{2} k<\\sqrt{2} . \\] And \\(x_{1}^{2}+x_{2}^{2}+\\cdots+x_{2 k}^{2}+x_{2 k+1}^{2}=(2+\\cdots+2)+x_{2 k+1}^{2}\\), Bazza can indeed choose \\(x_{2 k+2}=\\sqrt{2-x_{2 k+1}^{2}}\\) and always has a move. But suppose further \\(\\lambda<1 / \\sqrt{2}\\). Then the above calculation also shows that Alice couldn't have made a valid choice for large enough \\(k\\), since \\(\\lambda \\cdot(2 k+1)-\\sqrt{2} k<0\\) for large \\(k\\). Remark. In the strategies above, we saw that Alice prefers to always play 0 and Bazza prefers to always play as large as possible. One could consider what happens in the opposite case: - If Alice tries to always play the largest number possible, her strategy still wins for \\(\\lambda>1\\). - If Bazza tries to always play 0 , Alice can win no matter the value for \\(\\lambda>0\\).", "source_pdf": "imo_2025.pdf", "notes": ""}
{"id": "IMO-2025-6", "contest": "IMO", "year": "2025", "problem_number": "6", "problem": "Consider a \\(2025 \\times 2025\\) grid of unit squares. Matilda wishes to place on the grid some rectangular tiles, possibly of different sizes, such that each side of every tile lies on a grid line and every unit square is covered by at most one tile. Determine the minimum number of tiles Matilda needs to place so that each row and each column of the grid has exactly one unit square that is not covered by any tile.", "solution": "The answer is \\(2112=2025+2 \\cdot 45-3\\). In general, the answer turns out to be \\(\\lceil n+2 \\sqrt{n}-3\\rceil\\), but when \\(n\\) is not a perfect square the solution is more complicated. Remark. The 2017 Romanian Masters in Math asked the same problem where the tiles are replaced by sticks, i.e. \\(1 \\times k\\) tiles. The answer to that problem is completely different and as far as I know there is no connection at all to the present IMO problem. Construction. We show a general construction when \\(n=k^{2}\\) illustrated below for \\(k=5\\); it generalizes readily. There are a total of \\((k-1)^{2}\\) tiles which are \\(k \\times k\\) squares and another \\(4(k-1)\\) tiles on the boundary, giving a total of \\[ (k-1)^{2}+4(k-1)=k^{2}+2 k-3 \\] tiles as promised. Bound. There are several approaches (all hard), but the shortest proof seems to be the following one that exploits the Erd\u00f6s-Szekeres theorem; it is Solution 6 in the shortlist. The theorem being quoted is: Theorem (Erd\u00f6s-Szekeres) Let \\(n \\geq 1\\) be an integer. Given a permutation of \\((1, \\ldots, n)\\), if a longest increasing subsequence (LIS) has length \\(a\\) and a longest decreasing subsequence (LDS) has length \\(b\\), then \\(a b \\geq n\\). This is a stronger version of the theorem compared to another version which instead just asserts that \\(\\max (a, b) \\geq \\sqrt{n}\\). To apply this to the present problem, take the \\(n\\) uncovered squares which we henceforth call \"black\" as a permutation. Then consider both an LIS of length \\(a\\) and an LDS of length \\(b\\). We do the following artistic illustration: - Draw the LIS as a broken line, then connect it to the southwest and northwest corner of the board. - Similarly, draw the LDS as a broken line, then connect it to the northwest and southeast corner of the board. - These two steps partition the board into four quadrants, which we call north, east, south, west. - For each black cell in the north quadrant, write an \\(\\mathbf{N}\\) in the cell above it (for the cell in the first row, this will be off the board). Do the same for \\(\\mathbf{E}\\) (east), \\(\\mathbf{S}\\) (south), \\(\\mathbf{W}\\) (west). - Some black cells are in multiple quadrants (i.e. part of the LIS/LDS). Write all letters in that case. We observe that: Claim - In this algorithm, the total number of letters written is exactly \\[ C:= \\begin{cases}n+a+b+1 & \\text { if the LIS and LDS intersect } \\\\ n+a+b & \\text { otherwise }\\end{cases} \\] Proof. This is obvious. Each black square contributes at least one letter. Each black square on exactly one of the LIS and LDS contributes one extra letter. And a black square on both contributes 4 letters instead of \\(1+1+1\\). Note by AM-GM we have \\(a+b \\geq 2 \\sqrt{a b} \\geq 2 \\sqrt{n}\\), so we have a bound of \\[ C \\geq n+2 \\sqrt{n}+\\varepsilon \\quad \\text { where } \\quad \\varepsilon:= \\begin{cases}1 & \\text { if the LIS and LDS intersect } \\\\ 0 & \\text { otherwise } .\\end{cases} \\] To relate \\(C\\) to the number of tiles, the critical claim is the following, which is by construction: Claim - None of Matilda's tiles can have more than one letter written in any cell. Proof. This follows from the construction. We split into two cases based on \\(\\varepsilon\\). - When \\(\\varepsilon=1\\), at most four letters go off the grid (one for each direction), the number of tiles is at least \\(C-4 \\geq n+2 \\sqrt{n}-3\\). - Suppose \\(\\varepsilon=0\\). Then \\(C-4 \\geq n+2 \\sqrt{n}-4\\). However, we make the additional observation here that the tile where the LIS and LDS meet has no letters on it either; hence there are at least \\(1+(C-4) \\geq n+2 \\sqrt{n}-3\\) tiles. Remark. USJL mentions that when \\(n=a b\\), it is in fact always possible to guarantee \\(\\varepsilon=1\\). Moreover, when \\(a \\neq b\\), the AM-GM inequality is strict. This gives a way to avoid the additional observation needed for \\(\\varepsilon=0\\) above.", "source_pdf": "imo_2025.pdf", "notes": ""}
{"id": "IMOSL-2016-A1", "contest": "IMOSL", "year": "2016", "problem_number": "A1", "problem": "Let \\(a, b\\) and \\(c\\) be positive real numbers such that \\(\\min \\{a b, b c, c a\\} \\geqslant 1\\). Prove that\n\\[\n\\sqrt[3]{\\left(a^{2}+1\\right)\\left(b^{2}+1\\right)\\left(c^{2}+1\\right)} \\leqslant\\left(\\frac{a+b+c}{3}\\right)^{2}+1\n\\]", "solution": "1. We first show the following.\n- Claim. For any positive real numbers \\(x, y\\) with \\(x y \\geqslant 1\\), we have\n\\[\n\\left(x^{2}+1\\right)\\left(y^{2}+1\\right) \\leqslant\\left(\\left(\\frac{x+y}{2}\\right)^{2}+1\\right)^{2}\n\\]\n\nProof. Note that \\(x y \\geqslant 1\\) implies \\(\\left(\\frac{x+y}{2}\\right)^{2}-1 \\geqslant x y-1 \\geqslant 0\\). We find that\n\\[\n\\left(x^{2}+1\\right)\\left(y^{2}+1\\right)=(x y-1)^{2}+(x+y)^{2} \\leqslant\\left(\\left(\\frac{x+y}{2}\\right)^{2}-1\\right)^{2}+(x+y)^{2}=\\left(\\left(\\frac{x+y}{2}\\right)^{2}+1\\right)^{2} .\n\\]\n\nWithout loss of generality, assume \\(a \\geqslant b \\geqslant c\\). This implies \\(a \\geqslant 1\\). Let \\(d=\\frac{a+b+c}{3}\\). Note that\n\\[\na d=\\frac{a(a+b+c)}{3} \\geqslant \\frac{1+1+1}{3}=1 .\n\\]\n\nThen we can apply (2) to the pair ( \\(a, d\\) ) and the pair ( \\(b, c\\) ). We get\n\\[\n\\left(a^{2}+1\\right)\\left(d^{2}+1\\right)\\left(b^{2}+1\\right)\\left(c^{2}+1\\right) \\leqslant\\left(\\left(\\frac{a+d}{2}\\right)^{2}+1\\right)^{2}\\left(\\left(\\frac{b+c}{2}\\right)^{2}+1\\right)^{2}\n\\]\n\nNext, from\n\\[\n\\frac{a+d}{2} \\cdot \\frac{b+c}{2} \\geqslant \\sqrt{a d} \\cdot \\sqrt{b c} \\geqslant 1\n\\]\nwe can apply (2) again to the pair \\(\\left(\\frac{a+d}{2}, \\frac{b+c}{2}\\right)\\). Together with (3), we have\n\\[\n\\left(a^{2}+1\\right)\\left(d^{2}+1\\right)\\left(b^{2}+1\\right)\\left(c^{2}+1\\right) \\leqslant\\left(\\left(\\frac{a+b+c+d}{4}\\right)^{2}+1\\right)^{4}=\\left(d^{2}+1\\right)^{4}\n\\]\n\nTherefore, \\(\\left(a^{2}+1\\right)\\left(b^{2}+1\\right)\\left(c^{2}+1\\right) \\leqslant\\left(d^{2}+1\\right)^{3}\\), and (1) follows by taking cube root of both sides.\n\nComment. After justifying the Claim, one may also obtain (1) by mixing variables. Indeed, the function involved is clearly continuous, and hence it suffices to check that the condition \\(x y \\geqslant 1\\) is preserved under each mixing step. This is true since whenever \\(a b, b c, c a \\geqslant 1\\), we have\n\\[\n\\frac{a+b}{2} \\cdot \\frac{a+b}{2} \\geqslant a b \\geqslant 1 \\quad \\text { and } \\quad \\frac{a+b}{2} \\cdot c \\geqslant \\frac{1+1}{2}=1 .\n\\]\n\nSolution 2. Let \\(f(x)=\\ln \\left(1+x^{2}\\right)\\). Then the inequality (1) to be shown is equivalent to\n\\[\n\\frac{f(a)+f(b)+f(c)}{3} \\leqslant f\\left(\\frac{a+b+c}{3}\\right)\n\\]\nwhile (2) becomes\n\\[\n\\frac{f(x)+f(y)}{2} \\leqslant f\\left(\\frac{x+y}{2}\\right)\n\\]\nfor \\(x y \\geqslant 1\\).\nWithout loss of generality, assume \\(a \\geqslant b \\geqslant c\\). From the Claim in Solution 1, we have\n\\[\n\\frac{f(a)+f(b)+f(c)}{3} \\leqslant \\frac{f(a)+2 f\\left(\\frac{b+c}{2}\\right)}{3} .\n\\]\n\nNote that \\(a \\geqslant 1\\) and \\(\\frac{b+c}{2} \\geqslant \\sqrt{b c} \\geqslant 1\\). Since\n\\[\nf^{\\prime \\prime}(x)=\\frac{2\\left(1-x^{2}\\right)}{\\left(1+x^{2}\\right)^{2}}\n\\]\nwe know that \\(f\\) is concave on \\([1, \\infty)\\). Then we can apply Jensen's Theorem to get\n\\[\n\\frac{f(a)+2 f\\left(\\frac{b+c}{2}\\right)}{3} \\leqslant f\\left(\\frac{a+2 \\cdot \\frac{b+c}{2}}{3}\\right)=f\\left(\\frac{a+b+c}{3}\\right)\n\\]\n\nThis completes the proof.", "source_pdf": "imosl_2016.pdf", "notes": "fallback-regex"}
{"id": "IMOSL-2016-A2", "contest": "IMOSL", "year": "2016", "problem_number": "A2", "problem": "Find the smallest real constant \\(C\\) such that for any positive real numbers \\(a_{1}, a_{2}, a_{3}, a_{4}\\) and \\(a_{5}\\) (not necessarily distinct), one can always choose distinct subscripts \\(i, j, k\\) and \\(l\\) such that\n\\[\n\\left|\\frac{a_{i}}{a_{j}}-\\frac{a_{k}}{a_{l}}\\right| \\leqslant C\n\\]", "solution": "Answer. The smallest \\(C\\) is \\(\\frac{1}{2}\\).\n\n. We first show that \\(C \\leqslant \\frac{1}{2}\\). For any positive real numbers \\(a_{1} \\leqslant a_{2} \\leqslant a_{3} \\leqslant a_{4} \\leqslant a_{5}\\), consider the five fractions\n\\[\n\\frac{a_{1}}{a_{2}}, \\frac{a_{3}}{a_{4}}, \\frac{a_{1}}{a_{5}}, \\frac{a_{2}}{a_{3}}, \\frac{a_{4}}{a_{5}}\n\\]\n\nEach of them lies in the interval ( 0,1 ]. Therefore, by the Pigeonhole Principle, at least three of them must lie in ( \\(0, \\frac{1}{2}\\) ] or lie in ( \\(\\frac{1}{2}, 1\\) ] simultaneously. In particular, there must be two consecutive terms in (2) which belong to an interval of length \\(\\frac{1}{2}\\) (here, we regard \\(\\frac{a_{1}}{a_{2}}\\) and \\(\\frac{a_{4}}{a_{5}}\\) as consecutive). In other words, the difference of these two fractions is less than \\(\\frac{1}{2}\\). As the indices involved in these two fractions are distinct, we can choose them to be \\(i, j, k, l\\) and conclude that \\(C \\leqslant \\frac{1}{2}\\).\n\nNext, we show that \\(C=\\frac{1}{2}\\) is best possible. Consider the numbers \\(1,2,2,2, n\\) where \\(n\\) is a large real number. The fractions formed by two of these numbers in ascending order are \\(\\frac{1}{n}, \\frac{2}{n}, \\frac{1}{2}, \\frac{2}{2}, \\frac{2}{1}, \\frac{n}{2}, \\frac{n}{1}\\). Since the indices \\(i, j, k, l\\) are distinct, \\(\\frac{1}{n}\\) and \\(\\frac{2}{n}\\) cannot be chosen simultaneously. Therefore the minimum value of the left-hand side of (1) is \\(\\frac{1}{2}-\\frac{2}{n}\\). When \\(n\\) tends to infinity, this value approaches \\(\\frac{1}{2}\\), and so \\(C\\) cannot be less than \\(\\frac{1}{2}\\).\n\nThese conclude that \\(C=\\frac{1}{2}\\) is the smallest possible choice.\nComment. The conclusion still holds if \\(a_{1}, a_{2}, \\ldots, a_{5}\\) are pairwise distinct, since in the construction, we may replace the 2's by real numbers sufficiently close to 2 .\n\nThere are two possible simplifications for this problem:\n(i) the answer \\(C=\\frac{1}{2}\\) is given to the contestants; or\n(ii) simply ask the contestants to prove the inequality (1) for \\(C=\\frac{1}{2}\\).", "source_pdf": "imosl_2016.pdf", "notes": "fallback-regex"}
{"id": "IMOSL-2016-A3", "contest": "IMOSL", "year": "2016", "problem_number": "A3", "problem": "Find all integers \\(n \\geqslant 3\\) with the following property: for all real numbers \\(a_{1}, a_{2}, \\ldots, a_{n}\\) and \\(b_{1}, b_{2}, \\ldots, b_{n}\\) satisfying \\(\\left|a_{k}\\right|+\\left|b_{k}\\right|=1\\) for \\(1 \\leqslant k \\leqslant n\\), there exist \\(x_{1}, x_{2}, \\ldots, x_{n}\\), each of which is either -1 or 1 , such that\n\\[\n\\left|\\sum_{k=1}^{n} x_{k} a_{k}\\right|+\\left|\\sum_{k=1}^{n} x_{k} b_{k}\\right| \\leqslant 1\n\\]", "solution": "Answer. \\(n\\) can be any odd integer greater than or equal to 3 .\n\n1. For any even integer \\(n \\geqslant 4\\), we consider the case\n\\[\na_{1}=a_{2}=\\cdots=a_{n-1}=b_{n}=0 \\quad \\text { and } \\quad b_{1}=b_{2}=\\cdots=b_{n-1}=a_{n}=1 .\n\\]\n\nThe condition \\(\\left|a_{k}\\right|+\\left|b_{k}\\right|=1\\) is satisfied for each \\(1 \\leqslant k \\leqslant n\\). No matter how we choose each \\(x_{k}\\), both sums \\(\\sum_{k=1}^{n} x_{k} a_{k}\\) and \\(\\sum_{k=1}^{n} x_{k} b_{k}\\) are odd integers. This implies \\(\\left|\\sum_{k=1}^{n} x_{k} a_{k}\\right| \\geqslant 1\\) and \\(\\left|\\sum_{k=1}^{n} x_{k} b_{k}\\right| \\geqslant 1\\), which shows (1) cannot hold.\n\nFor any odd integer \\(n \\geqslant 3\\), we may assume without loss of generality \\(b_{k} \\geqslant 0\\) for \\(1 \\leqslant k \\leqslant n\\) (this can be done by flipping the pair ( \\(a_{k}, b_{k}\\) ) to ( \\(-a_{k},-b_{k}\\) ) and \\(x_{k}\\) to \\(-x_{k}\\) if necessary) and \\(a_{1} \\geqslant a_{2} \\geqslant \\cdots \\geqslant a_{m} \\geqslant 0>a_{m+1} \\geqslant \\cdots \\geqslant a_{n}\\). We claim that the choice \\(x_{k}=(-1)^{k+1}\\) for \\(1 \\leqslant k \\leqslant n\\) will work. Define\n\\[\ns=\\sum_{k=1}^{m} x_{k} a_{k} \\quad \\text { and } \\quad t=-\\sum_{k=m+1}^{n} x_{k} a_{k}\n\\]\n\nNote that\n\\[\ns=\\left(a_{1}-a_{2}\\right)+\\left(a_{3}-a_{4}\\right)+\\cdots \\geqslant 0\n\\]\nby the assumption \\(a_{1} \\geqslant a_{2} \\geqslant \\cdots \\geqslant a_{m}\\) (when \\(m\\) is odd, there is a single term \\(a_{m}\\) at the end, which is also positive). Next, we have\n\\[\ns=a_{1}-\\left(a_{2}-a_{3}\\right)-\\left(a_{4}-a_{5}\\right)-\\cdots \\leqslant a_{1} \\leqslant 1 .\n\\]\n\nSimilarly,\n\\[\nt=\\left(-a_{n}+a_{n-1}\\right)+\\left(-a_{n-2}+a_{n-3}\\right)+\\cdots \\geqslant 0\n\\]\nand\n\\[\nt=-a_{n}+\\left(a_{n-1}-a_{n-2}\\right)+\\left(a_{n-3}-a_{n-4}\\right)+\\cdots \\leqslant-a_{n} \\leqslant 1 .\n\\]\n\nFrom the condition, we have \\(a_{k}+b_{k}=1\\) for \\(1 \\leqslant k \\leqslant m\\) and \\(-a_{k}+b_{k}=1\\) for \\(m+1 \\leqslant k \\leqslant n\\). It follows that \\(\\sum_{k=1}^{n} x_{k} a_{k}=s-t\\) and \\(\\sum_{k=1}^{n} x_{k} b_{k}=1-s-t\\). Hence it remains to prove\n\\[\n|s-t|+|1-s-t| \\leqslant 1\n\\]\nunder the constraint \\(0 \\leqslant s, t \\leqslant 1\\). By symmetry, we may assume \\(s \\geqslant t\\). If \\(1-s-t \\geqslant 0\\), then we have\n\\[\n|s-t|+|1-s-t|=s-t+1-s-t=1-2 t \\leqslant 1\n\\]\n\nIf \\(1-s-t \\leqslant 0\\), then we have\n\\[\n|s-t|+|1-s-t|=s-t-1+s+t=2 s-1 \\leqslant 1\n\\]\n\nHence, the inequality is true in both cases.\nThese show \\(n\\) can be any odd integer greater than or equal to 3 .\n\nSolution 2. The even case can be handled in the same way as Solution 1. For the odd case, we prove by induction on \\(n\\).\n\nFirstly, for \\(n=3\\), we may assume without loss of generality \\(a_{1} \\geqslant a_{2} \\geqslant a_{3} \\geqslant 0\\) and \\(b_{1}=a_{1}-1\\) (if \\(b_{1}=1-a_{1}\\), we may replace each \\(b_{k}\\) by \\(-b_{k}\\) ).\n- Case 1. \\(b_{2}=a_{2}-1\\) and \\(b_{3}=a_{3}-1\\), in which case we take \\(\\left(x_{1}, x_{2}, x_{3}\\right)=(1,-1,1)\\).\n\nLet \\(c=a_{1}-a_{2}+a_{3}\\) so that \\(0 \\leqslant c \\leqslant 1\\). Then \\(\\left|b_{1}-b_{2}+b_{3}\\right|=\\left|a_{1}-a_{2}+a_{3}-1\\right|=1-c\\) and hence \\(|c|+\\left|b_{1}-b_{2}+b_{3}\\right|=1\\).\n- Case 2. \\(b_{2}=1-a_{2}\\) and \\(b_{3}=1-a_{3}\\), in which case we take \\(\\left(x_{1}, x_{2}, x_{3}\\right)=(1,-1,1)\\).\n\nLet \\(c=a_{1}-a_{2}+a_{3}\\) so that \\(0 \\leqslant c \\leqslant 1\\). Since \\(a_{3} \\leqslant a_{2}\\) and \\(a_{1} \\leqslant 1\\), we have\n\\[\nc-1 \\leqslant b_{1}-b_{2}+b_{3}=a_{1}+a_{2}-a_{3}-1 \\leqslant 1-c .\n\\]\n\nThis gives \\(\\left|b_{1}-b_{2}+b_{3}\\right| \\leqslant 1-c\\) and hence \\(|c|+\\left|b_{1}-b_{2}+b_{3}\\right| \\leqslant 1\\).\n- Case 3. \\(b_{2}=a_{2}-1\\) and \\(b_{3}=1-a_{3}\\), in which case we take \\(\\left(x_{1}, x_{2}, x_{3}\\right)=(-1,1,1)\\).\n\nLet \\(c=-a_{1}+a_{2}+a_{3}\\). If \\(c \\geqslant 0\\), then \\(a_{3} \\leqslant 1\\) and \\(a_{2} \\leqslant a_{1}\\) imply\n\\[\nc-1 \\leqslant-b_{1}+b_{2}+b_{3}=-a_{1}+a_{2}-a_{3}+1 \\leqslant 1-c .\n\\]\n\nIf \\(c<0\\), then \\(a_{1} \\leqslant a_{2}+1\\) and \\(a_{3} \\geqslant 0\\) imply\n\\[\n-c-1 \\leqslant-b_{1}+b_{2}+b_{3}=-a_{1}+a_{2}-a_{3}+1 \\leqslant 1+c .\n\\]\n\nIn both cases, we get \\(\\left|-b_{1}+b_{2}+b_{3}\\right| \\leqslant 1-|c|\\) and hence \\(|c|+\\left|-b_{1}+b_{2}+b_{3}\\right| \\leqslant 1\\).\n- Case 4. \\(b_{2}=1-a_{2}\\) and \\(b_{3}=a_{3}-1\\), in which case we take \\(\\left(x_{1}, x_{2}, x_{3}\\right)=(-1,1,1)\\).\n\nLet \\(c=-a_{1}+a_{2}+a_{3}\\). If \\(c \\geqslant 0\\), then \\(a_{2} \\leqslant 1\\) and \\(a_{3} \\leqslant a_{1}\\) imply\n\\[\nc-1 \\leqslant-b_{1}+b_{2}+b_{3}=-a_{1}-a_{2}+a_{3}+1 \\leqslant 1-c .\n\\]\n\nIf \\(c<0\\), then \\(a_{1} \\leqslant a_{3}+1\\) and \\(a_{2} \\geqslant 0\\) imply\n\\[\n-c-1 \\leqslant-b_{1}+b_{2}+b_{3}=-a_{1}-a_{2}+a_{3}+1 \\leqslant 1+c .\n\\]\n\nIn both cases, we get \\(\\left|-b_{1}+b_{2}+b_{3}\\right| \\leqslant 1-|c|\\) and hence \\(|c|+\\left|-b_{1}+b_{2}+b_{3}\\right| \\leqslant 1\\).\nWe have found \\(x_{1}, x_{2}, x_{3}\\) satisfying (1) in each case for \\(n=3\\).\nNow, let \\(n \\geqslant 5\\) be odd and suppose the result holds for any smaller odd cases. Again we may assume \\(a_{k} \\geqslant 0\\) for each \\(1 \\leqslant k \\leqslant n\\). By the Pigeonhole Principle, there are at least three indices \\(k\\) for which \\(b_{k}=a_{k}-1\\) or \\(b_{k}=1-a_{k}\\). Without loss of generality, suppose \\(b_{k}=a_{k}-1\\) for \\(k=1,2,3\\). Again by the Pigeonhole Principle, as \\(a_{1}, a_{2}, a_{3}\\) lies between 0 and 1 , the difference of two of them is at most \\(\\frac{1}{2}\\). By changing indices if necessary, we may assume \\(0 \\leqslant d=a_{1}-a_{2} \\leqslant \\frac{1}{2}\\).\n\nBy the inductive hypothesis, we can choose \\(x_{3}, x_{4}, \\ldots, x_{n}\\) such that \\(a^{\\prime}=\\sum_{k=3}^{n} x_{k} a_{k}\\) and \\(b^{\\prime}=\\sum_{k=3}^{n} x_{k} b_{k}\\) satisfy \\(\\left|a^{\\prime}\\right|+\\left|b^{\\prime}\\right| \\leqslant 1\\). We may further assume \\(a^{\\prime} \\geqslant 0\\).\n- Case 1. \\(b^{\\prime} \\geqslant 0\\), in which case we take \\(\\left(x_{1}, x_{2}\\right)=(-1,1)\\).\n\nWe have \\(\\left|-a_{1}+a_{2}+a^{\\prime}\\right|+\\left|-\\left(a_{1}-1\\right)+\\left(a_{2}-1\\right)+b^{\\prime}\\right|=\\left|-d+a^{\\prime}\\right|+\\left|-d+b^{\\prime}\\right| \\leqslant \\max \\left\\{a^{\\prime}+b^{\\prime}-2 d, a^{\\prime}-b^{\\prime}, b^{\\prime}-a^{\\prime}, 2 d-a^{\\prime}-b^{\\prime}\\right\\} \\leqslant 1\\) since \\(0 \\leqslant a^{\\prime}, b^{\\prime}, a^{\\prime}+b^{\\prime} \\leqslant 1\\) and \\(0 \\leqslant d \\leqslant \\frac{1}{2}\\).\n- Case 2. \\(0>b^{\\prime} \\geqslant-a^{\\prime}\\), in which case we take \\(\\left(x_{1}, x_{2}\\right)=(-1,1)\\).\n\nWe have \\(\\left|-a_{1}+a_{2}+a^{\\prime}\\right|+\\left|-\\left(a_{1}-1\\right)+\\left(a_{2}-1\\right)+b^{\\prime}\\right|=\\left|-d+a^{\\prime}\\right|+\\left|-d+b^{\\prime}\\right|\\). If \\(-d+a^{\\prime} \\geqslant 0\\), this equals \\(a^{\\prime}-b^{\\prime}=\\left|a^{\\prime}\\right|+\\left|b^{\\prime}\\right| \\leqslant 1\\). If \\(-d+a^{\\prime}<0\\), this equals \\(2 d-a^{\\prime}-b^{\\prime} \\leqslant 2 d \\leqslant 1\\).\n- Case 3. \\(b^{\\prime}<-a^{\\prime}\\), in which case we take \\(\\left(x_{1}, x_{2}\\right)=(1,-1)\\).\n\nWe have \\(\\left|a_{1}-a_{2}+a^{\\prime}\\right|+\\left|\\left(a_{1}-1\\right)-\\left(a_{2}-1\\right)+b^{\\prime}\\right|=\\left|d+a^{\\prime}\\right|+\\left|d+b^{\\prime}\\right|\\). If \\(d+b^{\\prime} \\geqslant 0\\), this equals \\(2 d+a^{\\prime}+b^{\\prime}<2 d \\leqslant 1\\). If \\(d+b^{\\prime}<0\\), this equals \\(a^{\\prime}-b^{\\prime}=\\left|a^{\\prime}\\right|+\\left|b^{\\prime}\\right| \\leqslant 1\\).\n\nTherefore, we have found \\(x_{1}, x_{2}, \\ldots, x_{n}\\) satisfying (1) in each case. By induction, the property holds for all odd integers \\(n \\geqslant 3\\).", "source_pdf": "imosl_2016.pdf", "notes": "fallback-regex"}
{"id": "IMOSL-2016-A4", "contest": "IMOSL", "year": "2016", "problem_number": "A4", "problem": "Denote by \\(\\mathbb{R}^{+}\\)the set of all positive real numbers. Find all functions \\(f: \\mathbb{R}^{+} \\rightarrow \\mathbb{R}^{+}\\)such that\n\\[\nx f\\left(x^{2}\\right) f(f(y))+f(y f(x))=f(x y)\\left(f\\left(f\\left(x^{2}\\right)\\right)+f\\left(f\\left(y^{2}\\right)\\right)\\right)\n\\]\nfor all positive real numbers \\(x\\) and \\(y\\).", "solution": "Answer. \\(f(x)=\\frac{1}{x}\\) for any \\(x \\in \\mathbb{R}^{+}\\).\n\n1. Taking \\(x=y=1\\) in (1), we get \\(f(1) f(f(1))+f(f(1))=2 f(1) f(f(1))\\) and hence \\(f(1)=1\\). Swapping \\(x\\) and \\(y\\) in (1) and comparing with (1) again, we find\n\\[\nx f\\left(x^{2}\\right) f(f(y))+f(y f(x))=y f\\left(y^{2}\\right) f(f(x))+f(x f(y)) .\n\\]\n\nTaking \\(y=1\\) in (2), we have \\(x f\\left(x^{2}\\right)+f(f(x))=f(f(x))+f(x)\\), that is,\n\\[\nf\\left(x^{2}\\right)=\\frac{f(x)}{x}\n\\]\n\nTake \\(y=1\\) in (1) and apply (3) to \\(x f\\left(x^{2}\\right)\\). We get \\(f(x)+f(f(x))=f(x)\\left(f\\left(f\\left(x^{2}\\right)\\right)+1\\right)\\), which implies\n\\[\nf\\left(f\\left(x^{2}\\right)\\right)=\\frac{f(f(x))}{f(x)}\n\\]\n\nFor any \\(x \\in \\mathbb{R}^{+}\\), we find that\n\\[\nf\\left(f(x)^{2}\\right) \\stackrel{(3)}{=} \\frac{f(f(x))}{f(x)} \\stackrel{(4)}{=} f\\left(f\\left(x^{2}\\right)\\right) \\stackrel{(3)}{=} f\\left(\\frac{f(x)}{x}\\right)\n\\]\n\nIt remains to show the following key step.\n- Claim. The function \\(f\\) is injective.\n\nProof. Using (3) and (4), we rewrite (1) as\n\\[\nf(x) f(f(y))+f(y f(x))=f(x y)\\left(\\frac{f(f(x))}{f(x)}+\\frac{f(f(y))}{f(y)}\\right)\n\\]\n\nTake \\(x=y\\) in (6) and apply (3). This gives \\(f(x) f(f(x))+f(x f(x))=2 \\frac{f(f(x))}{x}\\), which means\n\\[\nf(x f(x))=f(f(x))\\left(\\frac{2}{x}-f(x)\\right)\n\\]\n\nUsing (3), equation (2) can be rewritten as\n\\[\nf(x) f(f(y))+f(y f(x))=f(y) f(f(x))+f(x f(y)) .\n\\]\n\nSuppose \\(f(x)=f(y)\\) for some \\(x, y \\in \\mathbb{R}^{+}\\). Then (8) implies\n\\[\nf(y f(y))=f(y f(x))=f(x f(y))=f(x f(x)) .\n\\]\n\nUsing (7), this gives\n\\[\nf(f(y))\\left(\\frac{2}{y}-f(y)\\right)=f(f(x))\\left(\\frac{2}{x}-f(x)\\right)\n\\]\n\nNoting \\(f(x)=f(y)\\), we find \\(x=y\\). This establishes the injectivity.\n\nBy the Claim and (5), we get the only possible solution \\(f(x)=\\frac{1}{x}\\). It suffices to check that this is a solution. Indeed, the left-hand side of (1) becomes\n\\[\nx \\cdot \\frac{1}{x^{2}} \\cdot y+\\frac{x}{y}=\\frac{y}{x}+\\frac{x}{y},\n\\]\nwhile the right-hand side becomes\n\\[\n\\frac{1}{x y}\\left(x^{2}+y^{2}\\right)=\\frac{x}{y}+\\frac{y}{x}\n\\]\n\nThe two sides agree with each other.\nSolution 2. Taking \\(x=y=1\\) in (1), we get \\(f(1) f(f(1))+f(f(1))=2 f(1) f(f(1))\\) and hence \\(f(1)=1\\). Putting \\(x=1\\) in (1), we have \\(f(f(y))+f(y)=f(y)\\left(1+f\\left(f\\left(y^{2}\\right)\\right)\\right)\\) so that\n\\[\nf(f(y))=f(y) f\\left(f\\left(y^{2}\\right)\\right) .\n\\]\n\nPutting \\(y=1\\) in (1), we get \\(x f\\left(x^{2}\\right)+f(f(x))=f(x)\\left(f\\left(f\\left(x^{2}\\right)\\right)+1\\right)\\). Using (9), this gives\n\\[\nx f\\left(x^{2}\\right)=f(x)\n\\]\n\nReplace \\(y\\) by \\(\\frac{1}{x}\\) in (1). Then we have\n\\[\nx f\\left(x^{2}\\right) f\\left(f\\left(\\frac{1}{x}\\right)\\right)+f\\left(\\frac{f(x)}{x}\\right)=f\\left(f\\left(x^{2}\\right)\\right)+f\\left(f\\left(\\frac{1}{x^{2}}\\right)\\right) .\n\\]\n\nThe relation (10) shows \\(f\\left(\\frac{f(x)}{x}\\right)=f\\left(f\\left(x^{2}\\right)\\right)\\). Also, using (9) with \\(y=\\frac{1}{x}\\) and using (10) again, the last equation reduces to\n\\[\nf(x) f\\left(\\frac{1}{x}\\right)=1\n\\]\n\nReplace \\(x\\) by \\(\\frac{1}{x}\\) and \\(y\\) by \\(\\frac{1}{y}\\) in (1) and apply (11). We get\n\\[\n\\frac{1}{x f\\left(x^{2}\\right) f(f(y))}+\\frac{1}{f(y f(x))}=\\frac{1}{f(x y)}\\left(\\frac{1}{f\\left(f\\left(x^{2}\\right)\\right)}+\\frac{1}{f\\left(f\\left(y^{2}\\right)\\right)}\\right) .\n\\]\n\nClearing denominators, we can use (1) to simplify the numerators and obtain\n\\[\nf(x y)^{2} f\\left(f\\left(x^{2}\\right)\\right) f\\left(f\\left(y^{2}\\right)\\right)=x f\\left(x^{2}\\right) f(f(y)) f(y f(x)) .\n\\]\n\nUsing (9) and (10), this is the same as\n\\[\nf(x y)^{2} f(f(x))=f(x)^{2} f(y) f(y f(x)) .\n\\]\n\nSubstitute \\(y=f(x)\\) in (12) and apply (10) (with \\(x\\) replaced by \\(f(x)\\) ). We have\n\\[\nf(x f(x))^{2}=f(x) f(f(x)) .\n\\]\n\nTaking \\(y=x\\) in (12), squaring both sides, and using (10) and (13), we find that\n\\[\nf(f(x))=x^{4} f(x)^{3} .\n\\]\n\nFinally, we combine (9), (10) and (14) to get\n\\[\ny^{4} f(y)^{3} \\stackrel{(14)}{=} f(f(y)) \\stackrel{(9)}{=} f(y) f\\left(f\\left(y^{2}\\right)\\right) \\stackrel{(14)}{=} f(y) y^{8} f\\left(y^{2}\\right)^{3} \\stackrel{(10)}{=} y^{5} f(y)^{4},\n\\]\nwhich implies \\(f(y)=\\frac{1}{y}\\). This is a solution by the checking in Solution 1.\n\n\\section*{A5.}\n(a) Prove that for every positive integer \\(n\\), there exists a fraction \\(\\frac{a}{b}\\) where \\(a\\) and \\(b\\) are integers satisfying \\(0<b \\leqslant \\sqrt{n}+1\\) and \\(\\sqrt{n} \\leqslant \\frac{a}{b} \\leqslant \\sqrt{n+1}\\).\n(b) Prove that there are infinitely many positive integers \\(n\\) such that there is no fraction \\(\\frac{a}{b}\\) where \\(a\\) and \\(b\\) are integers satisfying \\(0<b \\leqslant \\sqrt{n}\\) and \\(\\sqrt{n} \\leqslant \\frac{a}{b} \\leqslant \\sqrt{n+1}\\).\n\n\\section*{Solution.}\n(a) Let \\(r\\) be the unique positive integer for which \\(r^{2} \\leqslant n<(r+1)^{2}\\). Write \\(n=r^{2}+s\\). Then we have \\(0 \\leqslant s \\leqslant 2 r\\). We discuss in two cases according to the parity of \\(s\\).\n- Case 1. \\(s\\) is even.\n\nConsider the number \\(\\left(r+\\frac{s}{2 r}\\right)^{2}=r^{2}+s+\\left(\\frac{s}{2 r}\\right)^{2}\\). We find that\n\\[\nn=r^{2}+s \\leqslant r^{2}+s+\\left(\\frac{s}{2 r}\\right)^{2} \\leqslant r^{2}+s+1=n+1\n\\]\n\nIt follows that\n\\[\n\\sqrt{n} \\leqslant r+\\frac{s}{2 r} \\leqslant \\sqrt{n+1}\n\\]\n\nSince \\(s\\) is even, we can choose the fraction \\(r+\\frac{s}{2 r}=\\frac{r^{2}+(s / 2)}{r}\\) since \\(r \\leqslant \\sqrt{n}\\).\n- Case 2. \\(s\\) is odd.\n\nConsider the number \\(\\left(r+1-\\frac{2 r+1-s}{2(r+1)}\\right)^{2}=(r+1)^{2}-(2 r+1-s)+\\left(\\frac{2 r+1-s}{2(r+1)}\\right)^{2}\\). We find that\n\\[\n\\begin{aligned}\nn=r^{2}+s=(r+1)^{2}-(2 r+1-s) & \\leqslant(r+1)^{2}-(2 r+1-s)+\\left(\\frac{2 r+1-s}{2(r+1)}\\right)^{2} \\\\\n& \\leqslant(r+1)^{2}-(2 r+1-s)+1=n+1\n\\end{aligned}\n\\]\n\nIt follows that\n\\[\n\\sqrt{n} \\leqslant r+1-\\frac{2 r+1-s}{2(r+1)} \\leqslant \\sqrt{n+1}\n\\]\n\nSince \\(s\\) is odd, we can choose the fraction \\((r+1)-\\frac{2 r+1-s}{2(r+1)}=\\frac{(r+1)^{2}-r+((s-1) / 2)}{r+1}\\) since \\(r+1 \\leqslant \\sqrt{n}+1\\).\n(b) We show that for every positive integer \\(r\\), there is no fraction \\(\\frac{a}{b}\\) with \\(b \\leqslant \\sqrt{r^{2}+1}\\) such that \\(\\sqrt{r^{2}+1} \\leqslant \\frac{a}{b} \\leqslant \\sqrt{r^{2}+2}\\). Suppose on the contrary that such a fraction exists. Since \\(b \\leqslant \\sqrt{r^{2}+1}<r+1\\) and \\(b\\) is an integer, we have \\(b \\leqslant r\\). Hence,\n\\[\n(b r)^{2}<b^{2}\\left(r^{2}+1\\right) \\leqslant a^{2} \\leqslant b^{2}\\left(r^{2}+2\\right) \\leqslant b^{2} r^{2}+2 b r<(b r+1)^{2} .\n\\]\n\nThis shows the square number \\(a^{2}\\) is strictly bounded between the two consecutive squares \\((b r)^{2}\\) and \\((b r+1)^{2}\\), which is impossible. Hence, we have found infinitely many \\(n=r^{2}+1\\) for which there is no fraction of the desired form.", "source_pdf": "imosl_2016.pdf", "notes": "fallback-regex"}
{"id": "IMOSL-2016-A7", "contest": "IMOSL", "year": "2016", "problem_number": "A7", "problem": "Denote by \\(\\mathbb{R}\\) the set of all real numbers. Find all functions \\(f: \\mathbb{R} \\rightarrow \\mathbb{R}\\) such that \\(f(0) \\neq 0\\) and\n\\[\nf(x+y)^{2}=2 f(x) f(y)+\\max \\left\\{f\\left(x^{2}\\right)+f\\left(y^{2}\\right), f\\left(x^{2}+y^{2}\\right)\\right\\}\n\\]\nfor all real numbers \\(x\\) and \\(y\\).\n\n\\section*{", "solution": "Answer.}\n- \\(f(x)=-1\\) for any \\(x \\in \\mathbb{R}\\); or\n- \\(f(x)=x-1\\) for any \\(x \\in \\mathbb{R}\\).\n\n1. Taking \\(x=y=0\\) in (1), we get \\(f(0)^{2}=2 f(0)^{2}+\\max \\{2 f(0), f(0)\\}\\). If \\(f(0)>0\\), then \\(f(0)^{2}+2 f(0)=0\\) gives no positive solution. If \\(f(0)<0\\), then \\(f(0)^{2}+f(0)=0\\) gives \\(f(0)=-1\\). Putting \\(y=0\\) in (1), we have \\(f(x)^{2}=-2 f(x)+f\\left(x^{2}\\right)\\), which is the same as \\((f(x)+1)^{2}=f\\left(x^{2}\\right)+1\\). Let \\(g(x)=f(x)+1\\). Then for any \\(x \\in \\mathbb{R}\\), we have\n\\[\ng\\left(x^{2}\\right)=g(x)^{2} \\geqslant 0 .\n\\]\n\nFrom (1), we find that \\(f(x+y)^{2} \\geqslant 2 f(x) f(y)+f\\left(x^{2}\\right)+f\\left(y^{2}\\right)\\). In terms of \\(g\\), this becomes \\((g(x+y)-1)^{2} \\geqslant 2(g(x)-1)(g(y)-1)+g\\left(x^{2}\\right)+g\\left(y^{2}\\right)-2\\). Using (2), this means\n\\[\n(g(x+y)-1)^{2} \\geqslant(g(x)+g(y)-1)^{2}-1 .\n\\]\n\nPutting \\(x=1\\) in (2), we get \\(g(1)=0\\) or 1 . The two cases are handled separately.\n- Case 1. \\(g(1)=0\\), which is the same as \\(f(1)=-1\\).\n\nWe put \\(x=-1\\) and \\(y=0\\) in (1). This gives \\(f(-1)^{2}=-2 f(-1)-1\\), which forces \\(f(-1)=-1\\). Next, we take \\(x=-1\\) and \\(y=1\\) in (1) to get \\(1=2+\\max \\{-2, f(2)\\}\\). This clearly implies \\(1=2+f(2)\\) and hence \\(f(2)=-1\\), that is, \\(g(2)=0\\). From (2), we can prove inductively that \\(g\\left(2^{2^{n}}\\right)=g(2)^{2^{n}}=0\\) for any \\(n \\in \\mathbb{N}\\). Substitute \\(y=2^{2^{n}}-x\\) in (3). We obtain\n\\[\n\\left(g(x)+g\\left(2^{2^{n}}-x\\right)-1\\right)^{2} \\leqslant\\left(g\\left(2^{2^{n}}\\right)-1\\right)^{2}+1=2 .\n\\]\n\nFor any fixed \\(x \\geqslant 0\\), we consider \\(n\\) to be sufficiently large so that \\(2^{2^{n}}-x>0\\). From (2), this implies \\(g\\left(2^{2^{n}}-x\\right) \\geqslant 0\\) so that \\(g(x) \\leqslant 1+\\sqrt{2}\\). Using (2) again, we get\n\\[\ng(x)^{2^{n}}=g\\left(x^{2^{n}}\\right) \\leqslant 1+\\sqrt{2}\n\\]\nfor any \\(n \\in \\mathbb{N}\\). Therefore, \\(|g(x)| \\leqslant 1\\) for any \\(x \\geqslant 0\\).\nIf there exists \\(a \\in \\mathbb{R}\\) for which \\(g(a) \\neq 0\\), then for sufficiently large \\(n\\) we must have \\(g\\left(\\left(a^{2}\\right)^{\\frac{1}{2^{n}}}\\right)=g\\left(a^{2}\\right)^{\\frac{1}{2^{n}}}>\\frac{1}{2}\\). By taking \\(x=-y=-\\left(a^{2}\\right)^{\\frac{1}{2^{n}}}\\) in (1), we obtain\n\\[\n\\begin{aligned}\n1 & =2 f(x) f(-x)+\\max \\left\\{2 f\\left(x^{2}\\right), f\\left(2 x^{2}\\right)\\right\\} \\\\\n& =2(g(x)-1)(g(-x)-1)+\\max \\left\\{2\\left(g\\left(x^{2}\\right)-1\\right), g\\left(2 x^{2}\\right)-1\\right\\} \\\\\n& \\leqslant 2\\left(-\\frac{1}{2}\\right)\\left(-\\frac{1}{2}\\right)+0=\\frac{1}{2}\n\\end{aligned}\n\\]\nsince \\(|g(-x)|=|g(x)| \\in\\left(\\frac{1}{2}, 1\\right]\\) by (2) and the choice of \\(x\\), and since \\(g(z) \\leqslant 1\\) for \\(z \\geqslant 0\\). This yields a contradiction and hence \\(g(x)=0\\) must hold for any \\(x\\). This means \\(f(x)=-1\\) for any \\(x \\in \\mathbb{R}\\), which clearly satisfies (1).\n- Case 2. \\(g(1)=1\\), which is the same as \\(f(1)=0\\).\n\nWe put \\(x=-1\\) and \\(y=1\\) in (1) to get \\(1=\\max \\{0, f(2)\\}\\). This clearly implies \\(f(2)=1\\) and hence \\(g(2)=2\\). Setting \\(x=2 n\\) and \\(y=2\\) in (3), we have\n\\[\n(g(2 n+2)-1)^{2} \\geqslant(g(2 n)+1)^{2}-1\n\\]\n\nBy induction on \\(n\\), it is easy to prove that \\(g(2 n) \\geqslant n+1\\) for all \\(n \\in \\mathbb{N}\\). For any real number \\(a>1\\), we choose a large \\(n \\in \\mathbb{N}\\) and take \\(k\\) to be the positive integer such that \\(2 k \\leqslant a^{2^{n}}<2 k+2\\). From (2) and (3), we have\n\\[\n\\left(g(a)^{2^{n}}-1\\right)^{2}+1=\\left(g\\left(a^{2^{n}}\\right)-1\\right)^{2}+1 \\geqslant\\left(g(2 k)+g\\left(a^{2^{n}}-2 k\\right)-1\\right)^{2} \\geqslant k^{2}>\\frac{1}{4}\\left(a^{2^{n}}-2\\right)^{2}\n\\]\nsince \\(g\\left(a^{2^{n}}-2 k\\right) \\geqslant 0\\). For large \\(n\\), this clearly implies \\(g(a)^{2^{n}}>1\\). Thus,\n\\[\n\\left(g(a)^{2^{n}}\\right)^{2}>\\left(g(a)^{2^{n}}-1\\right)^{2}+1>\\frac{1}{4}\\left(a^{2^{n}}-2\\right)^{2} .\n\\]\n\nThis yields\n\\[\ng(a)^{2^{n}}>\\frac{1}{2}\\left(a^{2^{n}}-2\\right)\n\\]\n\nNote that\n\\[\n\\frac{a^{2^{n}}}{a^{2^{n}}-2}=1+\\frac{2}{a^{2^{n}}-2} \\leqslant\\left(1+\\frac{2}{2^{n}\\left(a^{2^{n}}-2\\right)}\\right)^{2^{n}}\n\\]\nby binomial expansion. This can be rewritten as\n\\[\n\\left(a^{2^{n}}-2\\right)^{\\frac{1}{2^{n}}} \\geqslant \\frac{a}{1+\\frac{2}{2^{n}\\left(a^{2^{n}}-2\\right)}}\n\\]\n\nTogether with (4), we conclude \\(g(a) \\geqslant a\\) by taking \\(n\\) sufficiently large.\nConsider \\(x=n a\\) and \\(y=a>1\\) in (3). This gives \\((g((n+1) a)-1)^{2} \\geqslant(g(n a)+g(a)-1)^{2}-1\\). By induction on \\(n\\), it is easy to show \\(g(n a) \\geqslant(n-1)(g(a)-1)+a\\) for any \\(n \\in \\mathbb{N}\\). We choose a large \\(n \\in \\mathbb{N}\\) and take \\(k\\) to be the positive integer such that \\(k a \\leqslant 2^{2^{n}}<(k+1) a\\). Using (2) and (3), we have\n\\(2^{2^{n+1}}>\\left(2^{2^{n}}-1\\right)^{2}+1=\\left(g\\left(2^{2^{n}}\\right)-1\\right)^{2}+1 \\geqslant\\left(g\\left(2^{2^{n}}-k a\\right)+g(k a)-1\\right)^{2} \\geqslant((k-1)(g(a)-1)+a-1)^{2}\\), from which it follows that\n\\[\n2^{2^{n}} \\geqslant(k-1)(g(a)-1)+a-1>\\frac{2^{2^{n}}}{a}(g(a)-1)-2(g(a)-1)+a-1\n\\]\nholds for sufficiently large \\(n\\). Hence, we must have \\(\\frac{g(a)-1}{a} \\leqslant 1\\), which implies \\(g(a) \\leqslant a+1\\) for any \\(a>1\\). Then for large \\(n \\in \\mathbb{N}\\), from (3) and (2) we have\n\\[\n4 a^{2^{n+1}}=\\left(2 a^{2^{n}}\\right)^{2} \\geqslant\\left(g\\left(2 a^{2^{n}}\\right)-1\\right)^{2} \\geqslant\\left(2 g\\left(a^{2^{n}}\\right)-1\\right)^{2}-1=\\left(2 g(a)^{2^{n}}-1\\right)^{2}-1 .\n\\]\n\nThis implies\n\\[\n2 a^{2^{n}}>\\frac{1}{2}\\left(1+\\sqrt{4 a^{2^{n+1}}+1}\\right) \\geqslant g(a)^{2^{n}}\n\\]\n\nWhen \\(n\\) tends to infinity, this forces \\(g(a) \\leqslant a\\). Together with \\(g(a) \\geqslant a\\), we get \\(g(a)=a\\) for all real numbers \\(a>1\\), that is, \\(f(a)=a-1\\) for all \\(a>1\\).\n\nFinally, for any \\(x \\in \\mathbb{R}\\), we choose \\(y\\) sufficiently large in (1) so that \\(y, x+y>1\\). This gives \\((x+y-1)^{2}=2 f(x)(y-1)+\\max \\left\\{f\\left(x^{2}\\right)+y^{2}-1, x^{2}+y^{2}-1\\right\\}\\), which can be rewritten as\n\\[\n2(x-1-f(x)) y=-x^{2}+2 x-2-2 f(x)+\\max \\left\\{f\\left(x^{2}\\right), x^{2}\\right\\}\n\\]\n\nAs the right-hand side is fixed, this can only hold for all large \\(y\\) when \\(f(x)=x-1\\). We now check that this function satisfies (1). Indeed, we have\n\\[\n\\begin{aligned}\nf(x+y)^{2} & =(x+y-1)^{2}=2(x-1)(y-1)+\\left(x^{2}+y^{2}-1\\right) \\\\\n& =2 f(x) f(y)+\\max \\left\\{f\\left(x^{2}\\right)+f\\left(y^{2}\\right), f\\left(x^{2}+y^{2}\\right)\\right\\}\n\\end{aligned}\n\\]\n\nSolution 2. Taking \\(x=y=0\\) in (1), we get \\(f(0)^{2}=2 f(0)^{2}+\\max \\{2 f(0), f(0)\\}\\). If \\(f(0)>0\\), then \\(f(0)^{2}+2 f(0)=0\\) gives no positive solution. If \\(f(0)<0\\), then \\(f(0)^{2}+f(0)=0\\) gives \\(f(0)=-1\\). Putting \\(y=0\\) in (1), we have\n\\[\nf(x)^{2}=-2 f(x)+f\\left(x^{2}\\right) .\n\\]\n\nReplace \\(x\\) by \\(-x\\) in (5) and compare with (5) again. We get \\(f(x)^{2}+2 f(x)=f(-x)^{2}+2 f(-x)\\), which implies\n\\[\nf(x)=f(-x) \\quad \\text { or } \\quad f(x)+f(-x)=-2 .\n\\]\n\nTaking \\(x=y\\) and \\(x=-y\\) respectively in (1) and comparing the two equations obtained, we have\n\\[\nf(2 x)^{2}-2 f(x)^{2}=1-2 f(x) f(-x) .\n\\]\n\nCombining (6) and (7) to eliminate \\(f(-x)\\), we find that \\(f(2 x)\\) can be \\(\\pm 1\\) (when \\(f(x)=f(-x)\\) ) or \\(\\pm(2 f(x)+1)\\) (when \\(f(x)+f(-x)=-2\\) ).\n\nWe prove the following.\n- Claim. \\(f(x)+f(-x)=-2\\) for any \\(x \\in \\mathbb{R}\\).\n\nProof. Suppose there exists \\(a \\in \\mathbb{R}\\) such that \\(f(a)+f(-a) \\neq-2\\). Then \\(f(a)=f(-a) \\neq-1\\) and we may assume \\(a>0\\). We first show that \\(f(a) \\neq 1\\). Suppose \\(f(a)=1\\). Consider \\(y=a\\) in (7). We get \\(f(2 a)^{2}=1\\). Taking \\(x=y=a\\) in (1), we have \\(1=2+\\max \\left\\{2 f\\left(a^{2}\\right), f\\left(2 a^{2}\\right)\\right\\}\\). From (5), \\(f\\left(a^{2}\\right)=3\\) so that \\(1 \\geqslant 2+6\\). This is impossible, and thus \\(f(a) \\neq 1\\).\n\nAs \\(f(a) \\neq \\pm 1\\), we have \\(f(a)= \\pm\\left(2 f\\left(\\frac{a}{2}\\right)+1\\right)\\). Similarly, \\(f(-a)= \\pm\\left(2 f\\left(-\\frac{a}{2}\\right)+1\\right)\\). These two expressions are equal since \\(f(a)=f(-a)\\). If \\(f\\left(\\frac{a}{2}\\right)=f\\left(-\\frac{a}{2}\\right)\\), then the above argument works when we replace \\(a\\) by \\(\\frac{a}{2}\\). In particular, we have \\(f(a)^{2}=f\\left(2 \\cdot \\frac{a}{2}\\right)^{2}=1\\), which is a contradiction. Therefore, (6) forces \\(f\\left(\\frac{a}{2}\\right)+f\\left(-\\frac{a}{2}\\right)=-2\\). Then we get\n\\[\n\\pm\\left(2 f\\left(\\frac{a}{2}\\right)+1\\right)= \\pm\\left(-2 f\\left(\\frac{a}{2}\\right)-3\\right) .\n\\]\n\nFor any choices of the two signs, we either get a contradiction or \\(f\\left(\\frac{a}{2}\\right)=-1\\), in which case \\(f\\left(\\frac{a}{2}\\right)=f\\left(-\\frac{a}{2}\\right)\\) and hence \\(f(a)= \\pm 1\\) again. Therefore, there is no such real number \\(a\\) and the Claim follows.\n\nReplace \\(x\\) and \\(y\\) by \\(-x\\) and \\(-y\\) in (1) respectively and compare with (1). We get\n\\[\nf(x+y)^{2}-2 f(x) f(y)=f(-x-y)^{2}-2 f(-x) f(-y) .\n\\]\n\nUsing the Claim, this simplifies to \\(f(x+y)=f(x)+f(y)+1\\). In addition, (5) can be rewritten as \\((f(x)+1)^{2}=f\\left(x^{2}\\right)+1\\). Therefore, the function \\(g\\) defined by \\(g(x)=f(x)+1\\) satisfies \\(g(x+y)=g(x)+g(y)\\) and \\(g(x)^{2}=g\\left(x^{2}\\right)\\). The latter relation shows \\(g(y)\\) is nonnegative for \\(y \\geqslant 0\\). For such a function satisfying the Cauchy Equation \\(g(x+y)=g(x)+g(y)\\), it must be monotonic increasing and hence \\(g(x)=c x\\) for some constant \\(c\\).\n\nFrom \\((c x)^{2}=g(x)^{2}=g\\left(x^{2}\\right)=c x^{2}\\), we get \\(c=0\\) or 1 , which corresponds to the two functions \\(f(x)=-1\\) and \\(f(x)=x-1\\) respectively, both of which are solutions to (1) as checked in Solution 1.\n\nSolution 3. As in Solution 2, we find that \\(f(0)=-1\\),\n\\[\n(f(x)+1)^{2}=f\\left(x^{2}\\right)+1\n\\]\nand\n\\[\nf(x)=f(-x) \\quad \\text { or } \\quad f(x)+f(-x)=-2\n\\]\nfor any \\(x \\in \\mathbb{R}\\). We shall show that one of the statements in (9) holds for all \\(x \\in \\mathbb{R}\\). Suppose \\(f(a)=f(-a)\\) but \\(f(a)+f(-a) \\neq-2\\), while \\(f(b) \\neq f(-b)\\) but \\(f(b)+f(-b)=-2\\). Clearly, \\(a, b \\neq 0\\) and \\(f(a), f(b) \\neq-1\\).\n\nTaking \\(y=a\\) and \\(y=-a\\) in (1) respectively and comparing the two equations obtained, we have \\(f(x+a)^{2}=f(x-a)^{2}\\), that is, \\(f(x+a)= \\pm f(x-a)\\). This implies \\(f(x+2 a)= \\pm f(x)\\) for all \\(x \\in \\mathbb{R}\\). Putting \\(x=b\\) and \\(x=-2 a-b\\) respectively, we find \\(f(2 a+b)= \\pm f(b)\\) and \\(f(-2 a-b)= \\pm f(-b)= \\pm(-2-f(b))\\). Since \\(f(b) \\neq-1\\), the term \\(\\pm(-2-f(b))\\) is distinct from \\(\\pm f(b)\\) in any case. So \\(f(2 a+b) \\neq f(-2 a-b)\\). From (9), we must have \\(f(2 a+b)+f(-2 a-b)=-2\\). Note that we also have \\(f(b)+f(-b)=-2\\) where \\(|f(b)|,|f(-b)|\\) are equal to \\(|f(2 a+b)|,|f(-2 a-b)|\\) respectively. The only possible case is \\(f(2 a+b)=f(b)\\) and \\(f(-2 a-b)=f(-b)\\).\n\nApplying the argument to \\(-a\\) instead of \\(a\\) and using induction, we have \\(f(2 k a+b)=f(b)\\) and \\(f(2 k a-b)=f(-b)\\) for any integer \\(k\\). Note that \\(f(b)+f(-b)=-2\\) and \\(f(b) \\neq-1\\) imply one of \\(f(b), f(-b)\\) is less than -1 . Without loss of generality, assume \\(f(b)<-1\\). We consider \\(x=\\sqrt{2 k a+b}\\) in (8) for sufficiently large \\(k\\) so that\n\\[\n(f(x)+1)^{2}=f(2 k a+b)+1=f(b)+1<0\n\\]\nyields a contradiction. Therefore, one of the statements in (9) must hold for all \\(x \\in \\mathbb{R}\\).\n- Case 1. \\(f(x)=f(-x)\\) for any \\(x \\in \\mathbb{R}\\).\n\nFor any \\(a \\in \\mathbb{R}\\), setting \\(x=y=\\frac{a}{2}\\) and \\(x=-y=\\frac{a}{2}\\) in (1) respectively and comparing these, we obtain \\(f(a)^{2}=f(0)^{2}=1\\), which means \\(f(a)= \\pm 1\\) for all \\(a \\in \\mathbb{R}\\). If \\(f(a)=1\\) for some \\(a\\), we may assume \\(a>0\\) since \\(f(a)=f(-a)\\). Taking \\(x=y=\\sqrt{a}\\) in (1), we get\n\\[\nf(2 \\sqrt{a})^{2}=2 f(\\sqrt{a})^{2}+\\max \\{2, f(2 a)\\}=2 f(\\sqrt{a})^{2}+2 .\n\\]\n\nNote that the left-hand side is \\(\\pm 1\\) while the right-hand side is an even integer. This is a contradiction. Therefore, \\(f(x)=-1\\) for all \\(x \\in \\mathbb{R}\\), which is clearly a solution.\n- Case 2. \\(f(x)+f(-x)=-2\\) for any \\(x \\in \\mathbb{R}\\).\n\nThis case can be handled in the same way as in Solution 2, which yields another solution \\(f(x)=x-1\\).", "source_pdf": "imosl_2016.pdf", "notes": "fallback-regex"}
{"id": "IMOSL-2016-A8", "contest": "IMOSL", "year": "2016", "problem_number": "A8", "problem": "Determine the largest real number \\(a\\) such that for all \\(n \\geqslant 1\\) and for all real numbers \\(x_{0}, x_{1}, \\ldots, x_{n}\\) satisfying \\(0=x_{0}<x_{1}<x_{2}<\\cdots<x_{n}\\), we have\n\\[\n\\frac{1}{x_{1}-x_{0}}+\\frac{1}{x_{2}-x_{1}}+\\cdots+\\frac{1}{x_{n}-x_{n-1}} \\geqslant a\\left(\\frac{2}{x_{1}}+\\frac{3}{x_{2}}+\\cdots+\\frac{n+1}{x_{n}}\\right) .\n\\]", "solution": "Answer. The largest \\(a\\) is \\(\\frac{4}{9}\\).\n\n1. We first show that \\(a=\\frac{4}{9}\\) is admissible. For each \\(2 \\leqslant k \\leqslant n\\), by the CauchySchwarz Inequality, we have\n\\[\n\\left(x_{k-1}+\\left(x_{k}-x_{k-1}\\right)\\right)\\left(\\frac{(k-1)^{2}}{x_{k-1}}+\\frac{3^{2}}{x_{k}-x_{k-1}}\\right) \\geqslant(k-1+3)^{2}\n\\]\nwhich can be rewritten as\n\\[\n\\frac{9}{x_{k}-x_{k-1}} \\geqslant \\frac{(k+2)^{2}}{x_{k}}-\\frac{(k-1)^{2}}{x_{k-1}}\n\\]\n\nSumming (2) over \\(k=2,3, \\ldots, n\\) and adding \\(\\frac{9}{x_{1}}\\) to both sides, we have\n\\[\n9 \\sum_{k=1}^{n} \\frac{1}{x_{k}-x_{k-1}} \\geqslant 4 \\sum_{k=1}^{n} \\frac{k+1}{x_{k}}+\\frac{n^{2}}{x_{n}}>4 \\sum_{k=1}^{n} \\frac{k+1}{x_{k}}\n\\]\n\nThis shows (1) holds for \\(a=\\frac{4}{9}\\).\nNext, we show that \\(a=\\frac{4}{9}\\) is the optimal choice. Consider the sequence defined by \\(x_{0}=0\\) and \\(x_{k}=x_{k-1}+k(k+1)\\) for \\(k \\geqslant 1\\), that is, \\(x_{k}=\\frac{1}{3} k(k+1)(k+2)\\). Then the left-hand side of (1) equals\n\\[\n\\sum_{k=1}^{n} \\frac{1}{k(k+1)}=\\sum_{k=1}^{n}\\left(\\frac{1}{k}-\\frac{1}{k+1}\\right)=1-\\frac{1}{n+1}\n\\]\nwhile the right-hand side equals\n\\[\na \\sum_{k=1}^{n} \\frac{k+1}{x_{k}}=3 a \\sum_{k=1}^{n} \\frac{1}{k(k+2)}=\\frac{3}{2} a \\sum_{k=1}^{n}\\left(\\frac{1}{k}-\\frac{1}{k+2}\\right)=\\frac{3}{2}\\left(1+\\frac{1}{2}-\\frac{1}{n+1}-\\frac{1}{n+2}\\right) a .\n\\]\n\nWhen \\(n\\) tends to infinity, the left-hand side tends to 1 while the right-hand side tends to \\(\\frac{9}{4} a\\). Therefore \\(a\\) has to be at most \\(\\frac{4}{9}\\).\n\nHence the largest value of \\(a\\) is \\(\\frac{4}{9}\\).\nSolution 2. We shall give an alternative method to establish (1) with \\(a=\\frac{4}{9}\\). We define \\(y_{k}=x_{k}-x_{k-1}>0\\) for \\(1 \\leqslant k \\leqslant n\\). By the Cauchy-Schwarz Inequality, for \\(1 \\leqslant k \\leqslant n\\), we have\n\\[\n\\left(y_{1}+y_{2}+\\cdots+y_{k}\\right)\\left(\\sum_{j=1}^{k} \\frac{1}{y_{j}}\\binom{j+1}{2}^{2}\\right) \\geqslant\\left(\\binom{2}{2}+\\binom{3}{2}+\\cdots+\\binom{k+1}{2}\\right)^{2}=\\binom{k+2}{3}^{2} .\n\\]\n\nThis can be rewritten as\n\\[\n\\frac{k+1}{y_{1}+y_{2}+\\cdots+y_{k}} \\leqslant \\frac{36}{k^{2}(k+1)(k+2)^{2}}\\left(\\sum_{j=1}^{k} \\frac{1}{y_{j}}\\binom{j+1}{2}^{2}\\right) .\n\\]\n\nSumming (3) over \\(k=1,2, \\ldots, n\\), we get\n\\[\n\\frac{2}{y_{1}}+\\frac{3}{y_{1}+y_{2}}+\\cdots+\\frac{n+1}{y_{1}+y_{2}+\\cdots+y_{n}} \\leqslant \\frac{c_{1}}{y_{1}}+\\frac{c_{2}}{y_{2}}+\\cdots+\\frac{c_{n}}{y_{n}}\n\\]\nwhere for \\(1 \\leqslant m \\leqslant n\\),\n\\[\n\\begin{aligned}\nc_{m} & =36\\binom{m+1}{2}^{2} \\sum_{k=m}^{n} \\frac{1}{k^{2}(k+1)(k+2)^{2}} \\\\\n& =\\frac{9 m^{2}(m+1)^{2}}{4} \\sum_{k=m}^{n}\\left(\\frac{1}{k^{2}(k+1)^{2}}-\\frac{1}{(k+1)^{2}(k+2)^{2}}\\right) \\\\\n& =\\frac{9 m^{2}(m+1)^{2}}{4}\\left(\\frac{1}{m^{2}(m+1)^{2}}-\\frac{1}{(n+1)^{2}(n+2)^{2}}\\right)<\\frac{9}{4} .\n\\end{aligned}\n\\]\n\nFrom (4), the inequality (1) holds for \\(a=\\frac{4}{9}\\). This is also the upper bound as can be verified in the same way as Solution 1.\n\n\\section*{Combinatorics}", "source_pdf": "imosl_2016.pdf", "notes": "fallback-regex"}
{"id": "IMOSL-2016-C1", "contest": "IMOSL", "year": "2016", "problem_number": "C1", "problem": "The leader of an IMO team chooses positive integers \\(n\\) and \\(k\\) with \\(n>k\\), and announces them to the deputy leader and a contestant. The leader then secretly tells the deputy leader an \\(n\\)-digit binary string, and the deputy leader writes down all \\(n\\)-digit binary strings which differ from the leader's in exactly \\(k\\) positions. (For example, if \\(n=3\\) and \\(k=1\\), and if the leader chooses 101, the deputy leader would write down 001, 111 and 100.) The contestant is allowed to look at the strings written by the deputy leader and guess the leader's string. What is the minimum number of guesses (in terms of \\(n\\) and \\(k\\) ) needed to guarantee the correct", "solution": "answer?\n\nAnswer. The minimum number of guesses is 2 if \\(n=2 k\\) and 1 if \\(n \\neq 2 k\\).\n\n1. Let \\(X\\) be the binary string chosen by the leader and let \\(X^{\\prime}\\) be the binary string of length \\(n\\) every digit of which is different from that of \\(X\\). The strings written by the deputy leader are the same as those in the case when the leader's string is \\(X^{\\prime}\\) and \\(k\\) is changed to \\(n-k\\). In view of this, we may assume \\(k \\geqslant \\frac{n}{2}\\). Also, for the particular case \\(k=\\frac{n}{2}\\), this argument shows that the strings \\(X\\) and \\(X^{\\prime}\\) cannot be distinguished, and hence in that case the contestant has to guess at least twice.\n\nIt remains to show that the number of guesses claimed suffices. Consider any string \\(Y\\) which differs from \\(X\\) in \\(m\\) digits where \\(0<m<2 k\\). Without loss of generality, assume the first \\(m\\) digits of \\(X\\) and \\(Y\\) are distinct. Let \\(Z\\) be the binary string obtained from \\(X\\) by changing its first \\(k\\) digits. Then \\(Z\\) is written by the deputy leader. Note that \\(Z\\) differs from \\(Y\\) by \\(|m-k|\\) digits where \\(|m-k|<k\\) since \\(0<m<2 k\\). From this observation, the contestant must know that \\(Y\\) is not the desired string.\n\nAs we have assumed \\(k \\geqslant \\frac{n}{2}\\), when \\(n<2 k\\), every string \\(Y \\neq X\\) differs from \\(X\\) in fewer than \\(2 k\\) digits. When \\(n=2 k\\), every string except \\(X\\) and \\(X^{\\prime}\\) differs from \\(X\\) in fewer than \\(2 k\\) digits. Hence, the answer is as claimed.\n\nSolution 2. Firstly, assume \\(n \\neq 2 k\\). Without loss of generality suppose the first digit of the leader's string is 1 . Then among the \\(\\binom{n}{k}\\) strings written by the deputy leader, \\(\\binom{n-1}{k}\\) will begin with 1 and \\(\\binom{n-1}{k-1}\\) will begin with 0 . Since \\(n \\neq 2 k\\), we have \\(k+(k-1) \\neq n-1\\) and so \\(\\binom{n-1}{k} \\neq\\binom{ n-1}{k-1}\\). Thus, by counting the number of strings written by the deputy leader that start with 0 and 1 , the contestant can tell the first digit of the leader's string. The same can be done on the other digits, so 1 guess suffices when \\(n \\neq 2 k\\).\n\nSecondly, for the case \\(n=2\\) and \\(k=1\\), the answer is clearly 2. For the remaining cases where \\(n=2 k>2\\), the deputy leader would write down the same strings if the leader's string \\(X\\) is replaced by \\(X^{\\prime}\\) obtained by changing each digit of \\(X\\). This shows at least 2 guesses are needed. We shall show that 2 guesses suffice in this case. Suppose the first two digits of the leader's string are the same. Then among the strings written by the deputy leader, the prefices 01 and 10 will occur \\(\\binom{2 k-2}{k-1}\\) times each, while the prefices 00 and 11 will occur \\(\\binom{2 k-2}{k}\\) times each. The two numbers are interchanged if the first two digits of the leader's string are different. Since \\(\\binom{2 k-2}{k-1} \\neq\\binom{ 2 k-2}{k}\\), the contestant can tell whether the first two digits of the leader's string are the same or not. He can work out the relation of the first digit and the\nother digits in the same way and reduce the leader's string to only 2 possibilities. The proof is complete.", "source_pdf": "imosl_2016.pdf", "notes": "fallback-regex"}
{"id": "IMOSL-2016-C2", "contest": "IMOSL", "year": "2016", "problem_number": "C2", "problem": "Find all positive integers \\(n\\) for which all positive divisors of \\(n\\) can be put into the cells of a rectangular table under the following constraints:\n- each cell contains a distinct divisor;\n- the sums of all rows are equal; and\n- the sums of all columns are equal.", "solution": "Answer. 1.\n\n1. Suppose all positive divisors of \\(n\\) can be arranged into a rectangular table of size \\(k \\times l\\) where the number of rows \\(k\\) does not exceed the number of columns \\(l\\). Let the sum of numbers in each column be \\(s\\). Since \\(n\\) belongs to one of the columns, we have \\(s \\geqslant n\\), where equality holds only when \\(n=1\\).\n\nFor \\(j=1,2, \\ldots, l\\), let \\(d_{j}\\) be the largest number in the \\(j\\)-th column. Without loss of generality, assume \\(d_{1}>d_{2}>\\cdots>d_{l}\\). Since these are divisors of \\(n\\), we have\n\\[\nd_{l} \\leqslant \\frac{n}{l}\n\\]\n\nAs \\(d_{l}\\) is the maximum entry of the \\(l\\)-th column, we must have\n\\[\nd_{l} \\geqslant \\frac{s}{k} \\geqslant \\frac{n}{k}\n\\]\n\nThe relations (1) and (2) combine to give \\(\\frac{n}{l} \\geqslant \\frac{n}{k}\\), that is, \\(k \\geqslant l\\). Together with \\(k \\leqslant l\\), we conclude that \\(k=l\\). Then all inequalities in (1) and (2) are equalities. In particular, \\(s=n\\) and so \\(n=1\\), in which case the conditions are clearly satisfied.\n\nSolution 2. Clearly \\(n=1\\) works. Then we assume \\(n>1\\) and let its prime factorization be \\(n=p_{1}^{r_{1}} p_{2}^{r_{2}} \\cdots p_{t}^{r_{t}}\\). Suppose the table has \\(k\\) rows and \\(l\\) columns with \\(1<k \\leqslant l\\). Note that \\(k l\\) is the number of positive divisors of \\(n\\) and the sum of all entries is the sum of positive divisors of \\(n\\), which we denote by \\(\\sigma(n)\\). Consider the column containing \\(n\\). Since the column sum is \\(\\frac{\\sigma(n)}{l}\\), we must have \\(\\frac{\\sigma(n)}{l}>n\\). Therefore, we have\n\\[\n\\begin{aligned}\n\\left(r_{1}+1\\right)\\left(r_{2}+1\\right) \\cdots\\left(r_{t}+1\\right) & =k l \\leqslant l^{2}<\\left(\\frac{\\sigma(n)}{n}\\right)^{2} \\\\\n& =\\left(1+\\frac{1}{p_{1}}+\\cdots+\\frac{1}{p_{1}^{r_{1}}}\\right)^{2} \\cdots\\left(1+\\frac{1}{p_{t}}+\\cdots+\\frac{1}{p_{t}^{r_{t}}}\\right)^{2} .\n\\end{aligned}\n\\]\n\nThis can be rewritten as\n\\[\nf\\left(p_{1}, r_{1}\\right) f\\left(p_{2}, r_{2}\\right) \\cdots f\\left(p_{t}, r_{t}\\right)<1\n\\]\nwhere\n\\[\nf(p, r)=\\frac{r+1}{\\left(1+\\frac{1}{p}+\\cdots+\\frac{1}{p^{r}}\\right)^{2}}=\\frac{(r+1)\\left(1-\\frac{1}{p}\\right)^{2}}{\\left(1-\\frac{1}{p^{r+1}}\\right)^{2}}\n\\]\n\nDirect computation yields\n\\[\nf(2,1)=\\frac{8}{9}, \\quad f(2,2)=\\frac{48}{49}, \\quad f(3,1)=\\frac{9}{8}\n\\]\n\nAlso, we find that\n\\[\n\\begin{aligned}\n& f(2, r) \\geqslant\\left(1-\\frac{1}{2^{r+1}}\\right)^{-2}>1 \\quad \\text { for } r \\geqslant 3 \\\\\n& f(3, r) \\geqslant \\frac{4}{3}\\left(1-\\frac{1}{3^{r+1}}\\right)^{-2}>\\frac{4}{3}>\\frac{9}{8} \\quad \\text { for } r \\geqslant 2, \\text { and } \\\\\n& f(p, r) \\geqslant \\frac{32}{25}\\left(1-\\frac{1}{p^{r+1}}\\right)^{-2}>\\frac{32}{25}>\\frac{9}{8} \\quad \\text { for } p \\geqslant 5\n\\end{aligned}\n\\]\n\nFrom these values and bounds, it is clear that (3) holds only when \\(n=2\\) or 4 . In both cases, it is easy to see that the conditions are not satisfied. Hence, the only possible \\(n\\) is 1 .", "source_pdf": "imosl_2016.pdf", "notes": "fallback-regex"}
{"id": "IMOSL-2016-C3", "contest": "IMOSL", "year": "2016", "problem_number": "C3", "problem": "Let \\(n\\) be a positive integer relatively prime to 6 . We paint the vertices of a regular \\(n\\)-gon with three colours so that there is an odd number of vertices of each colour. Show that there exists an isosceles triangle whose three vertices are of different colours.", "solution": ". For \\(k=1,2,3\\), let \\(a_{k}\\) be the number of isosceles triangles whose vertices contain exactly \\(k\\) colours. Suppose on the contrary that \\(a_{3}=0\\). Let \\(b, c, d\\) be the number of vertices of the three different colours respectively. We now count the number of pairs ( \\(\\triangle, E\\) ) where \\(\\triangle\\) is an isosceles triangle and \\(E\\) is a side of \\(\\triangle\\) whose endpoints are of different colours.\n\nOn the one hand, since we have assumed \\(a_{3}=0\\), each triangle in the pair must contain exactly two colours, and hence each triangle contributes twice. Thus the number of pairs is \\(2 a_{2}\\).\n\nOn the other hand, if we pick any two vertices \\(A, B\\) of distinct colours, then there are three isosceles triangles having these as vertices, two when \\(A B\\) is not the base and one when \\(A B\\) is the base since \\(n\\) is odd. Note that the three triangles are all distinct as \\((n, 3)=1\\). In this way, we count the number of pairs to be \\(3(b c+c d+d b)\\). However, note that \\(2 a_{2}\\) is even while \\(3(b c+c d+d b)\\) is odd, as each of \\(b, c, d\\) is. This yields a contradiction and hence \\(a_{3} \\geqslant 1\\).\n\nComment. A slightly stronger version of this problem is to replace the condition \\((n, 6)=1\\) by \\(n\\) being odd (where equilateral triangles are regarded as isosceles triangles). In that case, the only difference in the proof is that by fixing any two vertices \\(A, B\\), one can find exactly one or three isosceles triangles having these as vertices. But since only parity is concerned in the solution, the proof goes the same way.\n\nThe condition that there is an odd number of vertices of each colour is necessary, as can be seen from the following example. Consider \\(n=25\\) and we label the vertices \\(A_{0}, A_{1}, \\ldots, A_{24}\\). Suppose colour 1 is used for \\(A_{0}\\), colour 2 is used for \\(A_{5}, A_{10}, A_{15}, A_{20}\\), while colour 3 is used for the remaining vertices. Then any isosceles triangle having colours 1 and 2 must contain \\(A_{0}\\) and one of \\(A_{5}, A_{10}, A_{15}, A_{20}\\). Clearly, the third vertex must have index which is a multiple of 5 so it is not of colour 3 .", "source_pdf": "imosl_2016.pdf", "notes": "fallback-regex"}
{"id": "IMOSL-2016-C5", "contest": "IMOSL", "year": "2016", "problem_number": "C5", "problem": "Let \\(n \\geqslant 3\\) be a positive integer. Find the maximum number of diagonals of a regular \\(n\\)-gon one can select, so that any two of them do not intersect in the interior or they are perpendicular to each other.", "solution": "Answer. \\(n-2\\) if \\(n\\) is even and \\(n-3\\) if \\(n\\) is odd.\n\n1. We consider two cases according to the parity of \\(n\\).\n- Case 1. \\(n\\) is odd.\n\nWe first claim that no pair of diagonals is perpendicular. Suppose \\(A, B, C, D\\) are vertices where \\(A B\\) and \\(C D\\) are perpendicular, and let \\(E\\) be the vertex lying on the perpendicular bisector of \\(A B\\). Let \\(E^{\\prime}\\) be the opposite point of \\(E\\) on the circumcircle of the regular polygon. Since \\(E C=E^{\\prime} D\\) and \\(C, D, E\\) are vertices of the regular polygon, \\(E^{\\prime}\\) should also belong to the polygon. This contradicts the fact that a regular polygon with an odd number of vertices does not contain opposite points on the circumcircle.\n![](https://cdn.mathpix.com/cropped/2025_08_23_f2fea43c73934c4e593ag-39.jpg?height=505&width=1253&top_left_y=1065&top_left_x=493)\n\nTherefore in the odd case we can only select diagonals which do not intersect. In the maximal case these diagonals should divide the regular \\(n\\)-gon into \\(n-2\\) triangles, so we can select at most \\(n-3\\) diagonals. This can be done, for example, by selecting all diagonals emanated from a particular vertex.\n- Case 2. \\(n\\) is even.\n\nIf there is no intersection, then the proof in the odd case works. Suppose there are two perpendicular diagonals selected. We consider the set \\(S\\) of all selected diagonals parallel to one of them which intersect with some selected diagonals. Suppose \\(S\\) contains \\(k\\) diagonals and the number of distinct endpoints of the \\(k\\) diagonals is \\(l\\).\n\nFirstly, consider the longest diagonal in one of the two directions in \\(S\\). No other diagonal in \\(S\\) can start from either endpoint of that diagonal, since otherwise it has to meet another longer diagonal in \\(S\\). The same holds true for the other direction. Ignoring these two longest diagonals and their four endpoints, the remaining \\(k-2\\) diagonals share \\(l-4\\) endpoints where each endpoint can belong to at most two diagonals. This gives \\(2(l-4) \\geqslant 2(k-2)\\), so that \\(k \\leqslant l-2\\).\n![](https://cdn.mathpix.com/cropped/2025_08_23_f2fea43c73934c4e593ag-40.jpg?height=434&width=1454&top_left_y=290&top_left_x=287)\n\nConsider a group of consecutive vertices of the regular \\(n\\)-gon so that each of the two outermost vertices is an endpoint of a diagonal in \\(S\\), while the interior points are not. There are \\(l\\) such groups. We label these groups \\(P_{1}, P_{2}, \\ldots, P_{l}\\) in this order. We claim that each selected diagonal outside \\(S\\) must connect vertices of the same group \\(P_{i}\\). Consider any diagonal \\(d\\) joining vertices from distinct groups \\(P_{i}\\) and \\(P_{j}\\). Let \\(d_{1}\\) and \\(d_{2}\\) be two diagonals in \\(S\\) each having one of the outermost points of \\(P_{i}\\) as endpoint. Then \\(d\\) must meet either \\(d_{1}, d_{2}\\) or a diagonal in \\(S\\) which is perpendicular to both \\(d_{1}\\) and \\(d_{2}\\). In any case \\(d\\) should belong to \\(S\\) by definition, which is a contradiction.\n\nWithin the same group \\(P_{i}\\), there are no perpendicular diagonals since the vertices belong to the same side of a diameter of the circumcircle. Hence there can be at most \\(\\left|P_{i}\\right|-2\\) selected diagonals within \\(P_{i}\\), including the one joining the two outermost points of \\(P_{i}\\) when \\(\\left|P_{i}\\right|>2\\). Therefore, the maximum number of diagonals selected is\n\\[\n\\sum_{i=1}^{l}\\left(\\left|P_{i}\\right|-2\\right)+k=\\sum_{i=1}^{l}\\left|P_{i}\\right|-2 l+k=(n+l)-2 l+k=n-l+k \\leqslant n-2 .\n\\]\n\nThis upper bound can be attained as follows. We take any vertex \\(A\\) and let \\(A^{\\prime}\\) be the vertex for which \\(A A^{\\prime}\\) is a diameter of the circumcircle. If we select all diagonals emanated from \\(A\\) together with the diagonal \\(d^{\\prime}\\) joining the two neighbouring vertices of \\(A^{\\prime}\\), then the only pair of diagonals that meet each other is \\(A A^{\\prime}\\) and \\(d^{\\prime}\\), which are perpendicular to each other. In total we can take \\(n-2\\) diagonals.\n![](https://cdn.mathpix.com/cropped/2025_08_23_f2fea43c73934c4e593ag-40.jpg?height=448&width=416&top_left_y=1810&top_left_x=807)\n\nSolution 2. The constructions and the odd case are the same as Solution 1. Instead of dealing separately with the case where \\(n\\) is even, we shall prove by induction more generally that we can select at most \\(n-2\\) diagonals for any cyclic \\(n\\)-gon with circumcircle \\(\\Gamma\\).\n\nThe base case \\(n=3\\) is trivial since there is no diagonal at all. Suppose the upper bound holds for any cyclic polygon with fewer than \\(n\\) sides. For a cyclic \\(n\\)-gon, if there is a selected diagonal which does not intersect any other selected diagonal, then this diagonal divides the \\(n\\)-gon into an \\(m\\)-gon and an \\(l\\)-gon (with \\(m+l=n+2\\) ) so that each selected diagonal belongs to one of them. Without loss of generality, we may assume the \\(m\\)-gon lies on the same side of a diameter of \\(\\Gamma\\). Then no two selected diagonals of the \\(m\\)-gon can intersect, and hence we can select at most \\(m-3\\) diagonals. Also, we can apply the inductive hypothesis to the \\(l\\)-gon. This shows the maximum number of selected diagonals is \\((m-3)+(l-2)+1=n-2\\).\n\nIt remains to consider the case when all selected diagonals meet at least one other selected diagonal. Consider a pair of selected perpendicular diagonals \\(d_{1}, d_{2}\\). They divide the circumference of \\(\\Gamma\\) into four arcs, each of which lies on the same side of a diameter of \\(\\Gamma\\). If there are two selected diagonals intersecting each other and neither is parallel to \\(d_{1}\\) or \\(d_{2}\\), then their endpoints must belong to the same arc determined by \\(d_{1}, d_{2}\\), and hence they cannot be perpendicular. This violates the condition, and hence all selected diagonals must have the same direction as one of \\(d_{1}, d_{2}\\).\n![](https://cdn.mathpix.com/cropped/2025_08_23_f2fea43c73934c4e593ag-41.jpg?height=416&width=1220&top_left_y=1051&top_left_x=504)\n\nTake the longest selected diagonal in one of the two directions. We argue as in Solution 1 that its endpoints do not belong to any other selected diagonal. The same holds true for the longest diagonal in the other direction. Apart from these four endpoints, each of the remaining \\(n-4\\) vertices can belong to at most two selected diagonals. Thus we can select at most \\(\\frac{1}{2}(2(n-4)+4)=n-2\\) diagonals. Then the proof follows by induction.", "source_pdf": "imosl_2016.pdf", "notes": "fallback-regex"}
{"id": "IMOSL-2016-C6", "contest": "IMOSL", "year": "2016", "problem_number": "C6", "problem": "There are \\(n \\geqslant 3\\) islands in a city. Initially, the ferry company offers some routes between some pairs of islands so that it is impossible to divide the islands into two groups such that no two islands in different groups are connected by a ferry route.\n\nAfter each year, the ferry company will close a ferry route between some two islands \\(X\\) and \\(Y\\). At the same time, in order to maintain its service, the company will open new routes according to the following rule: for any island which is connected by a ferry route to exactly one of \\(X\\) and \\(Y\\), a new route between this island and the other of \\(X\\) and \\(Y\\) is added.\n\nSuppose at any moment, if we partition all islands into two nonempty groups in any way, then it is known that the ferry company will close a certain route connecting two islands from the two groups after some years. Prove that after some years there will be an island which is connected to all other islands by ferry routes.", "solution": ". Initially, we pick any pair of islands \\(A\\) and \\(B\\) which are connected by a ferry route and put \\(A\\) in set \\(\\mathcal{A}\\) and \\(B\\) in set \\(\\mathcal{B}\\). From the condition, without loss of generality there must be another island which is connected to \\(A\\). We put such an island \\(C\\) in set \\(\\mathcal{B}\\). We say that two sets of islands form a network if each island in one set is connected to each island in the other set.\n\nNext, we shall included all islands to \\(\\mathcal{A} \\cup \\mathcal{B}\\) one by one. Suppose we have two sets \\(\\mathcal{A}\\) and \\(\\mathcal{B}\\) which form a network where \\(3 \\leqslant|\\mathcal{A} \\cup \\mathcal{B}|<n\\). This relation no longer holds only when a ferry route between islands \\(A \\in \\mathcal{A}\\) and \\(B \\in \\mathcal{B}\\) is closed. In that case, we define \\(\\mathcal{A}^{\\prime}=\\{A, B\\}\\), and \\(\\mathcal{B}^{\\prime}=(\\mathcal{A} \\cup \\mathcal{B})-\\{A, B\\}\\). Note that \\(\\mathcal{B}^{\\prime}\\) is nonempty. Consider any island \\(C \\in \\mathcal{A}-\\{A\\}\\). From the relation of \\(\\mathcal{A}\\) and \\(\\mathcal{B}\\), we know that \\(C\\) is connected to \\(B\\). If \\(C\\) was not connected to \\(A\\) before the route between \\(A\\) and \\(B\\) closes, then there will be a route added between \\(C\\) and \\(A\\) afterwards. Hence, \\(C\\) must now be connected to both \\(A\\) and \\(B\\). The same holds true for any island in \\(\\mathcal{B}-\\{B\\}\\). Therefore, \\(\\mathcal{A}^{\\prime}\\) and \\(\\mathcal{B}^{\\prime}\\) form a network, and \\(\\mathcal{A}^{\\prime} \\cup \\mathcal{B}^{\\prime}=\\mathcal{A} \\cup \\mathcal{B}\\). Hence these islands can always be partitioned into sets \\(\\mathcal{A}\\) and \\(\\mathcal{B}\\) which form a network.\n\nAs \\(|\\mathcal{A} \\cup \\mathcal{B}|<n\\), there are some islands which are not included in \\(\\mathcal{A} \\cup \\mathcal{B}\\). From the condition, after some years there must be a ferry route between an island \\(A\\) in \\(\\mathcal{A} \\cup \\mathcal{B}\\) and an island \\(D\\) outside \\(\\mathcal{A} \\cup \\mathcal{B}\\) which closes. Without loss of generality assume \\(A \\in \\mathcal{A}\\). Then each island in \\(\\mathcal{B}\\) must then be connected to \\(D\\), no matter it was or not before. Hence, we can put \\(D\\) in set \\(\\mathcal{A}\\) so that the new sets \\(\\mathcal{A}\\) and \\(\\mathcal{B}\\) still form a network and the size of \\(\\mathcal{A} \\cup \\mathcal{B}\\) is increased by 1 . The same process can be done to increase the size of \\(\\mathcal{A} \\cup \\mathcal{B}\\). Eventually, all islands are included in this way so we may now assume \\(|\\mathcal{A} \\cup \\mathcal{B}|=n\\).\n\nSuppose a ferry route between \\(A \\in \\mathcal{A}\\) and \\(B \\in \\mathcal{B}\\) is closed after some years. We put \\(A\\) and \\(B\\) in set \\(\\mathcal{A}^{\\prime}\\) and all remaining islands in set \\(\\mathcal{B}^{\\prime}\\). Then \\(\\mathcal{A}^{\\prime}\\) and \\(\\mathcal{B}^{\\prime}\\) form a network. This relation no longer holds only when a route between \\(A\\), without loss of generality, and \\(C \\in \\mathcal{B}^{\\prime}\\) is closed. Since this must eventually occur, at that time island \\(B\\) will be connected to all other islands and the result follows.", "source_pdf": "imosl_2016.pdf", "notes": "fallback-regex"}
{"id": "IMOSL-2016-C8", "contest": "IMOSL", "year": "2016", "problem_number": "C8", "problem": "Let \\(n\\) be a positive integer. Determine the smallest positive integer \\(k\\) with the following property: it is possible to mark \\(k\\) cells on a \\(2 n \\times 2 n\\) board so that there exists a unique partition of the board into \\(1 \\times 2\\) and \\(2 \\times 1\\) dominoes, none of which contains two marked cells.", "solution": "Answer. 2n.\n\n. We first construct an example of marking \\(2 n\\) cells satisfying the requirement. Label the rows and columns \\(1,2, \\ldots, 2 n\\) and label the cell in the \\(i\\)-th row and the \\(j\\)-th column \\((i, j)\\).\n\nFor \\(i=1,2, \\ldots, n\\), we mark the cells \\((i, i)\\) and \\((i, i+1)\\). We claim that the required partition exists and is unique. The two diagonals of the board divide the board into four regions. Note that the domino covering cell \\((1,1)\\) must be vertical. This in turn shows that each domino covering \\((2,2),(3,3), \\ldots,(n, n)\\) is vertical. By induction, the dominoes in the left region are all vertical. By rotational symmetry, the dominoes in the bottom region are horizontal, and so on. This shows that the partition exists and is unique.\n![](https://cdn.mathpix.com/cropped/2025_08_23_f2fea43c73934c4e593ag-45.jpg?height=313&width=817&top_left_y=1089&top_left_x=704)\n\nIt remains to show that this value of \\(k\\) is the smallest possible. Assume that only \\(k<2 n\\) cells are marked, and there exists a partition \\(P\\) satisfying the requirement. It suffices to show there exists another desirable partition distinct from \\(P\\). Let \\(d\\) be the main diagonal of the board.\n\nConstruct the following graph with edges of two colours. Its vertices are the cells of the board. Connect two vertices with a red edge if they belong to the same domino of \\(P\\). Connect two vertices with a blue edge if their reflections in \\(d\\) are connected by a red edge. It is possible that two vertices are connected by edges of both colours. Clearly, each vertex has both red and blue degrees equal to 1 . Thus the graph splits into cycles where the colours of edges in each cycle alternate (a cycle may have length 2 ).\n\nConsider any cell \\(c\\) lying on the diagonal \\(d\\). Its two edges are symmetrical with respect to \\(d\\). Thus they connect \\(c\\) to different cells. This shows \\(c\\) belongs to a cycle \\(C(c)\\) of length at least 4 . Consider a part of this cycle \\(c_{0}, c_{1}, \\ldots, c_{m}\\) where \\(c_{0}=c\\) and \\(m\\) is the least positive integer such that \\(c_{m}\\) lies on \\(d\\). Clearly, \\(c_{m}\\) is distinct from \\(c\\). From the construction, the path symmetrical to this with respect to \\(d\\) also lies in the graph, and so these paths together form \\(C(c)\\). Hence, \\(C(c)\\) contains exactly two cells from \\(d\\). Then all \\(2 n\\) cells in \\(d\\) belong to \\(n\\) cycles \\(C_{1}, C_{2}, \\ldots, C_{n}\\), each has length at least 4.\n\nBy the Pigeonhole Principle, there exists a cycle \\(C_{i}\\) containing at most one of the \\(k\\) marked cells. We modify \\(P\\) as follows. We remove all dominoes containing the vertices of \\(C_{i}\\), which\ncorrespond to the red edges of \\(C_{i}\\). Then we put the dominoes corresponding to the blue edges of \\(C_{i}\\). Since \\(C_{i}\\) has at least 4 vertices, the resultant partition \\(P^{\\prime}\\) is different from \\(P\\). Clearly, no domino in \\(P^{\\prime}\\) contains two marked cells as \\(C_{i}\\) contains at most one marked cell. This shows the partition is not unique and hence \\(k\\) cannot be less than \\(2 n\\).\n\n\\section*{Geometry}", "source_pdf": "imosl_2016.pdf", "notes": "fallback-regex"}
{"id": "IMOSL-2016-G2", "contest": "IMOSL", "year": "2016", "problem_number": "G2", "problem": "Let \\(A B C\\) be a triangle with circumcircle \\(\\Gamma\\) and incentre \\(I\\). Let \\(M\\) be the midpoint of side \\(B C\\). Denote by \\(D\\) the foot of perpendicular from \\(I\\) to side \\(B C\\). The line through \\(I\\) perpendicular to \\(A I\\) meets sides \\(A B\\) and \\(A C\\) at \\(F\\) and \\(E\\) respectively. Suppose the circumcircle of triangle \\(A E F\\) intersects \\(\\Gamma\\) at a point \\(X\\) other than \\(A\\). Prove that lines \\(X D\\) and \\(A M\\) meet on \\(\\Gamma\\).", "solution": "1. Let \\(A M\\) meet \\(\\Gamma\\) again at \\(Y\\) and \\(X Y\\) meet \\(B C\\) at \\(D^{\\prime}\\). It suffices to show \\(D^{\\prime}=D\\). We shall apply the following fact.\n- Claim. For any cyclic quadrilateral \\(P Q R S\\) whose diagonals meet at \\(T\\), we have\n\\[\n\\frac{Q T}{T S}=\\frac{P Q \\cdot Q R}{P S \\cdot S R}\n\\]\n\nProof. We use \\(\\left[W_{1} W_{2} W_{3}\\right]\\) to denote the area of \\(W_{1} W_{2} W_{3}\\). Then\n\\[\n\\frac{Q T}{T S}=\\frac{[P Q R]}{[P S R]}=\\frac{\\frac{1}{2} P Q \\cdot Q R \\sin \\angle P Q R}{\\frac{1}{2} P S \\cdot S R \\sin \\angle P S R}=\\frac{P Q \\cdot Q R}{P S \\cdot S R}\n\\]\n\nApplying the Claim to \\(A B Y C\\) and \\(X B Y C\\) respectively, we have \\(1=\\frac{B M}{M C}=\\frac{A B \\cdot B Y}{A C \\cdot C Y}\\) and \\(\\frac{B D^{\\prime}}{D^{\\prime} C}=\\frac{X B \\cdot B Y}{X C \\cdot C Y}\\). These combine to give\n\\[\n\\frac{B D^{\\prime}}{C D^{\\prime}}=\\frac{X B}{X C} \\cdot \\frac{B Y}{C Y}=\\frac{X B}{X C} \\cdot \\frac{A C}{A B}\n\\]\n\nNext, we use directed angles to find that \\(\\measuredangle X B F=\\measuredangle X B A=\\measuredangle X C A=\\measuredangle X C E\\) and \\(\\measuredangle X F B=\\measuredangle X F A=\\measuredangle X E A=\\measuredangle X E C\\). This shows triangles \\(X B F\\) and \\(X C E\\) are directly similar. In particular, we have\n\\[\n\\frac{X B}{X C}=\\frac{B F}{C E}\n\\]\n\nIn the following, we give two ways to continue the proof.\n- Method 1. Here is a geometrical method. As \\(\\angle F I B=\\angle A I B-90^{\\circ}=\\frac{1}{2} \\angle A C B=\\angle I C B\\) and \\(\\angle F B I=\\angle I B C\\), the triangles \\(F B I\\) and \\(I B C\\) are similar. Analogously, triangles \\(E I C\\) and \\(I B C\\) are also similar. Hence, we get\n\\[\n\\frac{F B}{I B}=\\frac{B I}{B C} \\quad \\text { and } \\quad \\frac{E C}{I C}=\\frac{I C}{B C}\n\\]\n![](https://cdn.mathpix.com/cropped/2025_08_23_f2fea43c73934c4e593ag-51.jpg?height=1007&width=983&top_left_y=262&top_left_x=617)\n\nNext, construct a line parallel to \\(B C\\) and tangent to the incircle. Suppose it meets sides \\(A B\\) and \\(A C\\) at \\(B_{1}\\) and \\(C_{1}\\) respectively. Let the incircle touch \\(A B\\) and \\(A C\\) at \\(B_{2}\\) and \\(C_{2}\\) respectively. By homothety, the line \\(B_{1} I\\) is parallel to the external angle bisector of \\(\\angle A B C\\), and hence \\(\\angle B_{1} I B=90^{\\circ}\\). Since \\(\\angle B B_{2} I=90^{\\circ}\\), we get \\(B B_{2} \\cdot B B_{1}=B I^{2}\\), and similarly \\(C C_{2} \\cdot C C_{1}=C I^{2}\\). Hence,\n\\[\n\\frac{B I^{2}}{C I^{2}}=\\frac{B B_{2} \\cdot B B_{1}}{C C_{2} \\cdot C C_{1}}=\\frac{B B_{1}}{C C_{1}} \\cdot \\frac{B D}{C D}=\\frac{A B}{A C} \\cdot \\frac{B D}{C D}\n\\]\n\nCombining (1), (2), (3) and (4), we conclude\n\\[\n\\frac{B D^{\\prime}}{C D^{\\prime}}=\\frac{X B}{X C} \\cdot \\frac{A C}{A B}=\\frac{B F}{C E} \\cdot \\frac{A C}{A B}=\\frac{B I^{2}}{C I^{2}} \\cdot \\frac{A C}{A B}=\\frac{B D}{C D}\n\\]\nso that \\(D^{\\prime}=D\\). The result then follows.\n- Method 2. We continue the proof of Solution 1 using trigonometry. Let \\(\\beta=\\frac{1}{2} \\angle A B C\\) and \\(\\gamma=\\frac{1}{2} \\angle A C B\\). Observe that \\(\\angle F I B=\\angle A I B-90^{\\circ}=\\gamma\\). Hence, \\(\\frac{B F}{F I}=\\frac{\\sin \\angle F I B}{\\sin \\angle I B F}=\\frac{\\sin \\gamma}{\\sin \\beta}\\). Similarly, \\(\\frac{C E}{E I}=\\frac{\\sin \\beta}{\\sin \\gamma}\\). As \\(F I=E I\\), we get\n\\[\n\\frac{B F}{C E}=\\frac{B F}{F I} \\cdot \\frac{E I}{C E}=\\left(\\frac{\\sin \\gamma}{\\sin \\beta}\\right)^{2} .\n\\]\n\nTogether with (1) and (2), we find that\n\\[\n\\frac{B D^{\\prime}}{C D^{\\prime}}=\\frac{A C}{A B} \\cdot\\left(\\frac{\\sin \\gamma}{\\sin \\beta}\\right)^{2}=\\frac{\\sin 2 \\beta}{\\sin 2 \\gamma} \\cdot\\left(\\frac{\\sin \\gamma}{\\sin \\beta}\\right)^{2}=\\frac{\\tan \\gamma}{\\tan \\beta}=\\frac{I D / C D}{I D / B D}=\\frac{B D}{C D}\n\\]\n\nThis shows \\(D^{\\prime}=D\\) and the result follows.\nSolution 2. Let \\(\\omega_{A}\\) be the \\(A\\)-mixtilinear incircle of triangle \\(A B C\\). From the properties of mixtilinear incircles, \\(\\omega_{A}\\) touches sides \\(A B\\) and \\(A C\\) at \\(F\\) and \\(E\\) respectively. Suppose \\(\\omega_{A}\\) is tangent to \\(\\Gamma\\) at \\(T\\). Let \\(A M\\) meet \\(\\Gamma\\) again at \\(Y\\), and let \\(D_{1}, T_{1}\\) be the reflections of \\(D\\) and \\(T\\) with respect to the perpendicular bisector of \\(B C\\) respectively. It is well-known that \\(\\angle B A T=\\angle D_{1} A C\\) so that \\(A, D_{1}, T_{1}\\) are collinear.\n![](https://cdn.mathpix.com/cropped/2025_08_23_f2fea43c73934c4e593ag-52.jpg?height=865&width=1093&top_left_y=897&top_left_x=477)\n\nWe then show that \\(X, M, T_{1}\\) are collinear. Let \\(R\\) be the radical centre of \\(\\omega_{A}, \\Gamma\\) and the circumcircle of triangle \\(A E F\\). Then \\(R\\) lies on \\(A X, E F\\) and the tangent at \\(T\\) to \\(\\Gamma\\). Let \\(A T\\) meet \\(\\omega_{A}\\) again at \\(S\\) and meet \\(E F\\) at \\(P\\). Obviously, \\(S F T E\\) is a harmonic quadrilateral. Projecting from \\(T\\), the pencil ( \\(R, P ; F, E\\) ) is harmonic. We further project the pencil onto \\(\\Gamma\\) from \\(A\\), so that \\(X B T C\\) is a harmonic quadrilateral. As \\(T T_{1} / / B C\\), the projection from \\(T_{1}\\) onto \\(B C\\) maps \\(T\\) to a point at infinity, and hence maps \\(X\\) to the midpoint of \\(B C\\), which is \\(M\\). This shows \\(X, M, T_{1}\\) are collinear.\n\nWe have two ways to finish the proof.\n- Method 1. Note that both \\(A Y\\) and \\(X T_{1}\\) are chords of \\(\\Gamma\\) passing through the midpoint \\(M\\) of the chord \\(B C\\). By the Butterfly Theorem, \\(X Y\\) and \\(A T_{1}\\) cut \\(B C\\) at a pair of symmetric points with respect to \\(M\\), and hence \\(X, D, Y\\) are collinear. The proof is thus complete.\n- Method 2. Here, we finish the proof without using the Butterfly Theorem. As \\(D T T_{1} D_{1}\\) is an isosceles trapezoid, we have\n\\[\n\\measuredangle Y T D=\\measuredangle Y T T_{1}+\\measuredangle T_{1} T D=\\measuredangle Y A T_{1}+\\measuredangle A D_{1} D=\\measuredangle Y M D\n\\]\nso that \\(D, T, Y, M\\) are concyclic. As \\(X, M, T_{1}\\) are collinear, we have\n\\[\n\\measuredangle A Y D=\\measuredangle M T D=\\measuredangle D_{1} T_{1} M=\\measuredangle A T_{1} X=\\measuredangle A Y X .\n\\]\n\nThis shows \\(X, D, Y\\) are collinear.", "source_pdf": "imosl_2016.pdf", "notes": "fallback-regex"}
{"id": "IMOSL-2016-G3", "contest": "IMOSL", "year": "2016", "problem_number": "G3", "problem": "Let \\(B=(-1,0)\\) and \\(C=(1,0)\\) be fixed points on the coordinate plane. A nonempty, bounded subset \\(S\\) of the plane is said to be nice if\n(i) there is a point \\(T\\) in \\(S\\) such that for every point \\(Q\\) in \\(S\\), the segment \\(T Q\\) lies entirely in \\(S\\); and\n(ii) for any triangle \\(P_{1} P_{2} P_{3}\\), there exists a unique point \\(A\\) in \\(S\\) and a permutation \\(\\sigma\\) of the indices \\(\\{1,2,3\\}\\) for which triangles \\(A B C\\) and \\(P_{\\sigma(1)} P_{\\sigma(2)} P_{\\sigma(3)}\\) are similar.\n\nProve that there exist two distinct nice subsets \\(S\\) and \\(S^{\\prime}\\) of the set \\(\\{(x, y): x \\geqslant 0, y \\geqslant 0\\}\\) such that if \\(A \\in S\\) and \\(A^{\\prime} \\in S^{\\prime}\\) are the unique choices of points in (ii), then the product \\(B A \\cdot B A^{\\prime}\\) is a constant independent of the triangle \\(P_{1} P_{2} P_{3}\\).", "solution": ". If in the similarity of \\(\\triangle A B C\\) and \\(\\triangle P_{\\sigma(1)} P_{\\sigma(2)} P_{\\sigma(3)}, B C\\) corresponds to the longest side of \\(\\triangle P_{1} P_{2} P_{3}\\), then we have \\(B C \\geqslant A B \\geqslant A C\\). The condition \\(B C \\geqslant A B\\) is equivalent to \\((x+1)^{2}+y^{2} \\leqslant 4\\), while \\(A B \\geqslant A C\\) is trivially satisfied for any point in the first quadrant. Then we first define\n\\[\nS=\\left\\{(x, y):(x+1)^{2}+y^{2} \\leqslant 4, x \\geqslant 0, y \\geqslant 0\\right\\} .\n\\]\n\nNote that \\(S\\) is the intersection of a disk and the first quadrant, so it is bounded and convex, and we can choose any \\(T \\in S\\) to meet condition (i). For any point \\(A\\) in \\(S\\), the relation \\(B C \\geqslant A B \\geqslant A C\\) always holds. Therefore, the point \\(A\\) in (ii) is uniquely determined, while its existence is guaranteed by the above construction.\n![](https://cdn.mathpix.com/cropped/2025_08_23_f2fea43c73934c4e593ag-54.jpg?height=646&width=852&top_left_y=1455&top_left_x=609)\n\nNext, if in the similarity of \\(\\triangle A^{\\prime} B C\\) and \\(\\triangle P_{\\sigma(1)} P_{\\sigma(2)} P_{\\sigma(3)}, B C\\) corresponds to the second longest side of \\(\\triangle P_{1} P_{2} P_{3}\\), then we have \\(A^{\\prime} B \\geqslant B C \\geqslant A^{\\prime} C\\). The two inequalities are equivalent to \\((x+1)^{2}+y^{2} \\geqslant 4\\) and \\((x-1)^{2}+y^{2} \\leqslant 4\\) respectively. Then we define\n\\[\nS^{\\prime}=\\left\\{(x, y):(x+1)^{2}+y^{2} \\geqslant 4,(x-1)^{2}+y^{2} \\leqslant 4, x \\geqslant 0, y \\geqslant 0\\right\\}\n\\]\n\nThe boundedness condition is satisfied while (ii) can be argued as in the previous case. For (i), note that \\(S^{\\prime}\\) contains points inside the disk \\((x-1)^{2}+y^{2} \\leqslant 4\\) and outside the disk \\((x+1)^{2}+y^{2} \\geqslant 4\\). This shows we can take \\(T^{\\prime}=(1,2)\\) in (i), which is the topmost point of the circle \\((x-1)^{2}+y^{2}=4\\).\n\nIt remains to check that the product \\(B A \\cdot B A^{\\prime}\\) is a constant. Suppose we are given a triangle \\(P_{1} P_{2} P_{3}\\) with \\(P_{1} P_{2} \\geqslant P_{2} P_{3} \\geqslant P_{3} P_{1}\\). By the similarity, we have\n\\[\nB A=B C \\cdot \\frac{P_{2} P_{3}}{P_{1} P_{2}} \\quad \\text { and } \\quad B A^{\\prime}=B C \\cdot \\frac{P_{1} P_{2}}{P_{2} P_{3}}\n\\]\n\nThus \\(B A \\cdot B A^{\\prime}=B C^{2}=4\\), which is certainly independent of the triangle \\(P_{1} P_{2} P_{3}\\).\nComment. The original version of this problem includes the condition that the interiors of \\(S\\) and \\(S^{\\prime}\\) are disjoint. We remove this condition since it is hard to define the interior of a point set rigorously.", "source_pdf": "imosl_2016.pdf", "notes": "fallback-regex"}
{"id": "IMOSL-2016-G4", "contest": "IMOSL", "year": "2016", "problem_number": "G4", "problem": "Let \\(A B C\\) be a triangle with \\(A B=A C \\neq B C\\) and let \\(I\\) be its incentre. The line \\(B I\\) meets \\(A C\\) at \\(D\\), and the line through \\(D\\) perpendicular to \\(A C\\) meets \\(A I\\) at \\(E\\). Prove that the reflection of \\(I\\) in \\(A C\\) lies on the circumcircle of triangle \\(B D E\\).\n\n\\section*{", "solution": "1.}\n![](https://cdn.mathpix.com/cropped/2025_08_23_f2fea43c73934c4e593ag-56.jpg?height=676&width=1161&top_left_y=509&top_left_x=436)\n\nLet \\(\\Gamma\\) be the circle with centre \\(E\\) passing through \\(B\\) and \\(C\\). Since \\(E D \\perp A C\\), the point \\(F\\) symmetric to \\(C\\) with respect to \\(D\\) lies on \\(\\Gamma\\). From \\(\\angle D C I=\\angle I C B=\\angle C B I\\), the line \\(D C\\) is a tangent to the circumcircle of triangle \\(I B C\\). Let \\(J\\) be the symmetric point of \\(I\\) with respect to \\(D\\). Using directed lengths, from\n\\[\nD C \\cdot D F=-D C^{2}=-D I \\cdot D B=D J \\cdot D B\n\\]\nthe point \\(J\\) also lies on \\(\\Gamma\\). Let \\(I^{\\prime}\\) be the reflection of \\(I\\) in \\(A C\\). Since \\(I J\\) and \\(C F\\) bisect each other, \\(C J F I\\) is a parallelogram. From \\(\\angle F I^{\\prime} C=\\angle C I F=\\angle F J C\\), we find that \\(I^{\\prime}\\) lies on \\(\\Gamma\\). This gives \\(E I^{\\prime}=E B\\).\n\nNote that \\(A C\\) is the internal angle bisector of \\(\\angle B D I^{\\prime}\\). This shows \\(D E\\) is the external angle bisector of \\(\\angle B D I^{\\prime}\\) as \\(D E \\perp A C\\). Together with \\(E I^{\\prime}=E B\\), it is well-known that \\(E\\) lies on the circumcircle of triangle \\(B D I^{\\prime}\\).\n\nSolution 2. Let \\(I^{\\prime}\\) be the reflection of \\(I\\) in \\(A C\\) and let \\(S\\) be the intersection of \\(I^{\\prime} C\\) and \\(A I\\). Using directed angles, we let \\(\\theta=\\measuredangle A C I=\\measuredangle I C B=\\measuredangle C B I\\). We have\n\\[\n\\measuredangle I^{\\prime} S E=\\measuredangle I^{\\prime} C A+\\measuredangle C A I=\\theta+\\left(\\frac{\\pi}{2}+2 \\theta\\right)=3 \\theta+\\frac{\\pi}{2}\n\\]\nand\n\\[\n\\measuredangle I^{\\prime} D E=\\measuredangle I^{\\prime} D C+\\frac{\\pi}{2}=\\measuredangle C D I+\\frac{\\pi}{2}=\\measuredangle D C B+\\measuredangle C B D+\\frac{\\pi}{2}=3 \\theta+\\frac{\\pi}{2} .\n\\]\n\nThis shows \\(I^{\\prime}, D, E, S\\) are concyclic.\nNext, we find \\(\\measuredangle I^{\\prime} S B=2 \\measuredangle I^{\\prime} S E=6 \\theta\\) and \\(\\measuredangle I^{\\prime} D B=2 \\measuredangle C D I=6 \\theta\\). Therefore, \\(I^{\\prime}, D, B, S\\) are concyclic so that \\(I^{\\prime}, D, E, B, S\\) lie on the same circle. The result then follows.\n![](https://cdn.mathpix.com/cropped/2025_08_23_f2fea43c73934c4e593ag-57.jpg?height=614&width=1039&top_left_y=246&top_left_x=590)\n\nComment. The point \\(S\\) constructed in Solution 2 may lie on the same side as \\(A\\) of \\(B C\\). Also, since \\(S\\) lies on the circumcircle of the non-degenerate triangle \\(B D E\\), we implicitly know that \\(S\\) is not an ideal point. Indeed, one can verify that \\(I^{\\prime} C\\) and \\(A I\\) are parallel if and only if triangle \\(A B C\\) is equilateral.\n\nSolution 3. Let \\(I^{\\prime}\\) be the reflection of \\(I\\) in \\(A C\\), and let \\(D^{\\prime}\\) be the second intersection of \\(A I\\) and the circumcircle of triangle \\(A B D\\). Since \\(A D^{\\prime}\\) bisects \\(\\angle B A D\\), point \\(D^{\\prime}\\) is the midpoint of the arc \\(B D\\) and \\(D D^{\\prime}=B D^{\\prime}=C D^{\\prime}\\). Obviously, \\(A, E, D^{\\prime}\\) lie on \\(A I\\) in this order.\n![](https://cdn.mathpix.com/cropped/2025_08_23_f2fea43c73934c4e593ag-57.jpg?height=519&width=795&top_left_y=1268&top_left_x=718)\n\nWe find that \\(\\angle E D^{\\prime} D=\\angle A D^{\\prime} D=\\angle A B D=\\angle I B C=\\angle I C B\\). Next, since \\(D^{\\prime}\\) is the circumcentre of triangle \\(B C D\\), we have \\(\\angle E D D^{\\prime}=90^{\\circ}-\\angle D^{\\prime} D C=\\angle C B D=\\angle I B C\\). The two relations show that triangles \\(E D^{\\prime} D\\) and \\(I C B\\) are similar. Therefore, we have\n\\[\n\\frac{B C}{C I^{\\prime}}=\\frac{B C}{C I}=\\frac{D D^{\\prime}}{D^{\\prime} E}=\\frac{B D^{\\prime}}{D^{\\prime} E}\n\\]\n\nAlso, we get\n\\[\n\\angle B C I^{\\prime}=\\angle B C A+\\angle A C I^{\\prime}=\\angle B C A+\\angle I C A=\\angle B C A+\\angle D B C=\\angle B D A=\\angle B D^{\\prime} E .\n\\]\n\nThese show triangles \\(B C I^{\\prime}\\) and \\(B D^{\\prime} E\\) are similar, and hence triangles \\(B C D^{\\prime}\\) and \\(B I^{\\prime} E\\) are similar. As \\(B C D^{\\prime}\\) is isosceles, we obtain \\(B E=I^{\\prime} E\\).\n\nAs \\(D E\\) is the external angle bisector of \\(\\angle B D I^{\\prime}\\) and \\(E I^{\\prime}=E B\\), we know that \\(E\\) lies on the circumcircle of triangle \\(B D I^{\\prime}\\).\n\nSolution 4. Let \\(A I\\) and \\(B I\\) meet the circumcircle of triangle \\(A B C\\) again at \\(A^{\\prime}\\) and \\(B^{\\prime}\\) respectively, and let \\(E^{\\prime}\\) be the reflection of \\(E\\) in \\(A C\\). From\n\\[\n\\begin{aligned}\n\\angle B^{\\prime} A E^{\\prime} & =\\angle B^{\\prime} A D-\\angle E^{\\prime} A D=\\frac{\\angle A B C}{2}-\\frac{\\angle B A C}{2}=90^{\\circ}-\\angle B A C-\\frac{\\angle A B C}{2} \\\\\n& =90^{\\circ}-\\angle B^{\\prime} D A=\\angle B^{\\prime} D E^{\\prime},\n\\end{aligned}\n\\]\npoints \\(B^{\\prime}, A, D, E^{\\prime}\\) are concyclic. Then\n\\[\n\\angle D B^{\\prime} E^{\\prime}=\\angle D A E^{\\prime}=\\frac{\\angle B A C}{2}=\\angle B A A^{\\prime}=\\angle D B^{\\prime} A^{\\prime}\n\\]\nand hence \\(B^{\\prime}, E^{\\prime}, A^{\\prime}\\) are collinear. It is well-known that \\(A^{\\prime} B^{\\prime}\\) is the perpendicular bisector of \\(C I\\), so that \\(C E^{\\prime}=I E^{\\prime}\\). Let \\(I^{\\prime}\\) be the reflection of \\(I\\) in \\(A C\\). This implies \\(B E=C E=I^{\\prime} E\\). As \\(D E\\) is the external angle bisector of \\(\\angle B D I^{\\prime}\\) and \\(E I^{\\prime}=E B\\), we know that \\(E\\) lies on the circumcircle of triangle \\(B D I^{\\prime}\\).\n![](https://cdn.mathpix.com/cropped/2025_08_23_f2fea43c73934c4e593ag-58.jpg?height=744&width=766&top_left_y=964&top_left_x=655)\n\nSolution 5. Let \\(F\\) be the intersection of \\(C I\\) and \\(A B\\). Clearly, \\(F\\) and \\(D\\) are symmetric with respect to \\(A I\\). Let \\(O\\) be the circumcentre of triangle \\(B I F\\), and let \\(I^{\\prime}\\) be the reflection of \\(I\\) in \\(A C\\).\n![](https://cdn.mathpix.com/cropped/2025_08_23_f2fea43c73934c4e593ag-58.jpg?height=518&width=757&top_left_y=1919&top_left_x=634)\n\nFrom \\(\\angle B F O=90^{\\circ}-\\angle F I B=\\frac{1}{2} \\angle B A C=\\angle B A I\\), we get \\(E I / / F O\\). Also, from the relation \\(\\angle O I B=90^{\\circ}-\\angle B F I=90^{\\circ}-\\angle C D I=\\angle I^{\\prime} I D\\), we know that \\(O, I, I^{\\prime}\\) are collinear.\n\nNote that \\(E D / / O I\\) since both are perpendicular to \\(A C\\). Then \\(\\angle F E I=\\angle D E I=\\angle O I E\\). Together with \\(E I / / F O\\), the quadrilateral \\(E F O I\\) is an isosceles trapezoid. Therefore, we find that \\(\\angle D I E=\\angle F I E=\\angle O E I\\) so \\(O E / / I D\\). Then \\(D E O I\\) is a parallelogram. Hence, we have \\(D I^{\\prime}=D I=E O\\), which shows \\(D E O I^{\\prime}\\) is an isosceles trapezoid. In addition, \\(E D=O I=O B\\) and \\(O E / / B D\\) imply \\(E O B D\\) is another isosceles trapezoid. In particular, both \\(D E O I^{\\prime}\\) and \\(E O B D\\) are cyclic. This shows \\(B, D, E, I^{\\prime}\\) are concyclic.\n\nSolution 6. Let \\(I^{\\prime}\\) be the reflection of \\(I\\) in \\(A C\\). Denote by \\(T\\) and \\(M\\) the projections from \\(I\\) to sides \\(A B\\) and \\(B C\\) respectively. Since \\(B I\\) is the perpendicular bisector of \\(T M\\), we have\n\\[\nD T=D M .\n\\]\n\nSince \\(\\angle A D E=\\angle A T I=90^{\\circ}\\) and \\(\\angle D A E=\\angle T A I\\), we have \\(\\triangle A D E \\sim \\triangle A T I\\). This shows \\(\\frac{A D}{A E}=\\frac{A T}{A I}=\\frac{A T}{A I^{\\prime}}\\). Together with \\(\\angle D A T=2 \\angle D A E=\\angle E A I^{\\prime}\\), this yields \\(\\triangle D A T \\sim \\triangle E A I^{\\prime}\\). In particular, we have\n\\[\n\\frac{D T}{E I^{\\prime}}=\\frac{A T}{A I^{\\prime}}=\\frac{A T}{A I}\n\\]\n\nObviously, the right-angled triangles \\(A M B\\) and \\(A T I\\) are similar. Then we get\n\\[\n\\frac{A M}{A B}=\\frac{A T}{A I} .\n\\]\n\nNext, from \\(\\triangle A M B \\sim \\triangle A T I \\sim \\triangle A D E\\), we have \\(\\frac{A M}{A B}=\\frac{A D}{A E}\\) so that \\(\\triangle A D M \\sim \\triangle A E B\\). It follows that\n\\[\n\\frac{D M}{E B}=\\frac{A M}{A B}\n\\]\n\nCombining (1), (2), (3) and (4), we get \\(E B=E I^{\\prime}\\). As \\(D E\\) is the external angle bisector of \\(\\angle B D I^{\\prime}\\), we know that \\(E\\) lies on the circumcircle of triangle \\(B D I^{\\prime}\\).\n![](https://cdn.mathpix.com/cropped/2025_08_23_f2fea43c73934c4e593ag-59.jpg?height=608&width=768&top_left_y=1780&top_left_x=748)\n\nComment. A stronger version of this problem is to ask the contestants to prove the reflection of \\(I\\) in \\(A C\\) lies on the circumcircle of triangle \\(B D E\\) if and only if \\(A B=A C\\). Some of the above solutions can be modified to prove the converse statement to the original problem. For example, we borrow some ideas from Solution 2 to establish the converse as follows.\n![](https://cdn.mathpix.com/cropped/2025_08_23_f2fea43c73934c4e593ag-60.jpg?height=603&width=1045&top_left_y=506&top_left_x=490)\n\nLet \\(I^{\\prime}\\) be the reflection of \\(I\\) in \\(A C\\) and suppose \\(B, E, D, I^{\\prime}\\) lie on a circle \\(\\Gamma\\). Let \\(A I\\) meet \\(\\Gamma\\) again at \\(S\\). As \\(D E\\) is the external angle bisector of \\(\\angle B D I^{\\prime}\\), we have \\(E B=E I^{\\prime}\\). Using directed angles, we get\n\\[\n\\measuredangle C I^{\\prime} S=\\measuredangle C I^{\\prime} D+\\measuredangle D I^{\\prime} S=\\measuredangle D I C+\\measuredangle D E S=\\measuredangle D I C+\\measuredangle D E A=\\measuredangle D I C+\\measuredangle D C B=0 .\n\\]\n\nThis means \\(I^{\\prime}, C, S\\) are collinear. From this we get \\(\\measuredangle B S E=\\measuredangle E S I^{\\prime}=\\measuredangle E S C\\) and hence \\(A S\\) bisects both \\(\\angle B A C\\) and \\(\\angle B S C\\). Clearly, \\(S\\) and \\(A\\) are distinct points. It follows that \\(\\triangle B A S \\cong \\triangle C A S\\) and thus \\(A B=A C\\).\n\nAs in some of the above solutions, an obvious way to prove the stronger version is to establish the following equivalence: \\(B E=E I^{\\prime}\\) if and only if \\(A B=A C\\). In addition to the ideas used in those solutions, one can use trigonometry to express the lengths of \\(B E\\) and \\(E I^{\\prime}\\) in terms of the side lengths of triangle \\(A B C\\) and to establish the equivalence.", "source_pdf": "imosl_2016.pdf", "notes": "fallback-regex"}
{"id": "IMOSL-2016-G5", "contest": "IMOSL", "year": "2016", "problem_number": "G5", "problem": "Let \\(D\\) be the foot of perpendicular from \\(A\\) to the Euler line (the line passing through the circumcentre and the orthocentre) of an acute scalene triangle \\(A B C\\). A circle \\(\\omega\\) with centre \\(S\\) passes through \\(A\\) and \\(D\\), and it intersects sides \\(A B\\) and \\(A C\\) at \\(X\\) and \\(Y\\) respectively. Let \\(P\\) be the foot of altitude from \\(A\\) to \\(B C\\), and let \\(M\\) be the midpoint of \\(B C\\). Prove that the circumcentre of triangle \\(X S Y\\) is equidistant from \\(P\\) and \\(M\\).", "solution": "1. Denote the orthocentre and circumcentre of triangle \\(A B C\\) by \\(H\\) and \\(O\\) respectively. Let \\(Q\\) be the midpoint of \\(A H\\) and \\(N\\) be the nine-point centre of triangle \\(A B C\\). It is known that \\(Q\\) lies on the nine-point circle of triangle \\(A B C, N\\) is the midpoint of \\(Q M\\) and that \\(Q M\\) is parallel to \\(A O\\).\n\nLet the perpendicular from \\(S\\) to \\(X Y\\) meet line \\(Q M\\) at \\(S^{\\prime}\\). Let \\(E\\) be the foot of altitude from \\(B\\) to side \\(A C\\). Since \\(Q\\) and \\(S\\) lie on the perpendicular bisector of \\(A D\\), using directed angles, we have\n\\[\n\\begin{aligned}\n\\measuredangle S D Q & =\\measuredangle Q A S=\\measuredangle X A S-\\measuredangle X A Q=\\left(\\frac{\\pi}{2}-\\measuredangle A Y X\\right)-\\measuredangle B A P=\\measuredangle C B A-\\measuredangle A Y X \\\\\n& =(\\measuredangle C B A-\\measuredangle A C B)-\\measuredangle B C A-\\measuredangle A Y X=\\measuredangle P E M-(\\measuredangle B C A+\\measuredangle A Y X) \\\\\n& =\\measuredangle P Q M-\\angle(B C, X Y)=\\frac{\\pi}{2}-\\angle\\left(S^{\\prime} Q, B C\\right)-\\angle(B C, X Y)=\\measuredangle S S^{\\prime} Q\n\\end{aligned}\n\\]\n\nThis shows \\(D, S^{\\prime}, S, Q\\) are concyclic.\n![](https://cdn.mathpix.com/cropped/2025_08_23_f2fea43c73934c4e593ag-61.jpg?height=760&width=947&top_left_y=1328&top_left_x=631)\n\nLet the perpendicular from \\(N\\) to \\(B C\\) intersect line \\(S S^{\\prime}\\) at \\(O_{1}\\). (Note that the two lines coincide when \\(S\\) is the midpoint of \\(A O\\), in which case the result is true since the circumcentre of triangle \\(X S Y\\) must lie on this line.) It suffices to show that \\(O_{1}\\) is the circumcentre of triangle \\(X S Y\\) since \\(N\\) lies on the perpendicular bisector of \\(P M\\). From\n\\[\n\\measuredangle D S^{\\prime} O_{1}=\\measuredangle D Q S=\\measuredangle S Q A=\\angle(S Q, Q A)=\\angle\\left(O D, O_{1} N\\right)=\\measuredangle D N O_{1}\n\\]\nsince \\(S Q / / O D\\) and \\(Q A / / O_{1} N\\), we know that \\(D, O_{1}, S^{\\prime}, N\\) are concyclic. Therefore, we get\n\\[\n\\measuredangle S D S^{\\prime}=\\measuredangle S Q S^{\\prime}=\\angle\\left(S Q, Q S^{\\prime}\\right)=\\angle\\left(N D, N S^{\\prime}\\right)=\\measuredangle D N S^{\\prime}\n\\]\nso that \\(S D\\) is a tangent to the circle through \\(D, O_{1}, S^{\\prime}, N\\). Then we have\n\\[\nS S^{\\prime} \\cdot S O_{1}=S D^{2}=S X^{2}\n\\]\n\nNext, we show that \\(S\\) and \\(S^{\\prime}\\) are symmetric with respect to \\(X Y\\). By the Sine Law, we have\n\\[\n\\frac{S S^{\\prime}}{\\sin \\angle S Q S^{\\prime}}=\\frac{S Q}{\\sin \\angle S S^{\\prime} Q}=\\frac{S Q}{\\sin \\angle S D Q}=\\frac{S Q}{\\sin \\angle S A Q}=\\frac{S A}{\\sin \\angle S Q A} .\n\\]\n\nIt follows that\n\\[\nS S^{\\prime}=S A \\cdot \\frac{\\sin \\angle S Q S^{\\prime}}{\\sin \\angle S Q A}=S A \\cdot \\frac{\\sin \\angle H O A}{\\sin \\angle O H A}=S A \\cdot \\frac{A H}{A O}=S A \\cdot 2 \\cos A,\n\\]\nwhich is twice the distance from \\(S\\) to \\(X Y\\). Note that \\(S\\) and \\(C\\) lie on the same side of the perpendicular bisector of \\(P M\\) if and only if \\(\\angle S A C<\\angle O A C\\) if and only if \\(\\angle Y X A>\\angle C B A\\). This shows \\(S\\) and \\(O_{1}\\) lie on different sides of \\(X Y\\). As \\(S^{\\prime}\\) lies on ray \\(S O_{1}\\), it follows that \\(S\\) and \\(S^{\\prime}\\) cannot lie on the same side of \\(X Y\\). Therefore, \\(S\\) and \\(S^{\\prime}\\) are symmetric with respect to \\(X Y\\).\n\nLet \\(d\\) be the diameter of the circumcircle of triangle \\(X S Y\\). As \\(S S^{\\prime}\\) is twice the distance from \\(S\\) to \\(X Y\\) and \\(S X=S Y\\), we have \\(S S^{\\prime}=2 \\frac{S X^{2}}{d}\\). It follows from (1) that \\(d=2 S O_{1}\\). As \\(S O_{1}\\) is the perpendicular bisector of \\(X Y\\), point \\(O_{1}\\) is the circumcentre of triangle \\(X S Y\\).\n\nSolution 2. Denote the orthocentre and circumcentre of triangle \\(A B C\\) by \\(H\\) and \\(O\\) respectively. Let \\(O_{1}\\) be the circumcentre of triangle \\(X S Y\\). Consider two other possible positions of \\(S\\). We name them \\(S^{\\prime}\\) and \\(S^{\\prime \\prime}\\) and define the analogous points \\(X^{\\prime}, Y^{\\prime}, O_{1}^{\\prime}, X^{\\prime \\prime}, Y^{\\prime \\prime} O_{1}^{\\prime \\prime}\\) accordingly. Note that \\(S, S^{\\prime}, S^{\\prime \\prime}\\) lie on the perpendicular bisector of \\(A D\\).\n\nAs \\(X X^{\\prime}\\) and \\(Y Y^{\\prime}\\) meet at \\(A\\) and the circumcircles of triangles \\(A X Y\\) and \\(A X^{\\prime} Y^{\\prime}\\) meet at \\(D\\), there is a spiral similarity with centre \\(D\\) mapping \\(X Y\\) to \\(X^{\\prime} Y^{\\prime}\\). We find that\n\\[\n\\measuredangle S X Y=\\frac{\\pi}{2}-\\measuredangle Y A X=\\frac{\\pi}{2}-\\measuredangle Y^{\\prime} A X^{\\prime}=\\measuredangle S^{\\prime} X^{\\prime} Y^{\\prime}\n\\]\nand similarly \\(\\measuredangle S Y X=\\measuredangle S^{\\prime} Y^{\\prime} X^{\\prime}\\). This shows triangles \\(S X Y\\) and \\(S^{\\prime} X^{\\prime} Y^{\\prime}\\) are directly similar. Then the spiral similarity with centre \\(D\\) takes points \\(S, X, Y, O_{1}\\) to \\(S^{\\prime}, X^{\\prime}, Y^{\\prime}, O_{1}^{\\prime}\\). Similarly, there is a spiral similarity with centre \\(D\\) mapping \\(S, X, Y, O_{1}\\) to \\(S^{\\prime \\prime}, X^{\\prime \\prime}, Y^{\\prime \\prime}, O_{1}^{\\prime \\prime}\\). From these, we see that there is a spiral similarity taking the corresponding points \\(S, S^{\\prime}, S^{\\prime \\prime}\\) to points \\(O_{1}, O_{1}^{\\prime}, O_{1}^{\\prime \\prime}\\). In particular, \\(O_{1}, O_{1}^{\\prime}, O_{1}^{\\prime \\prime}\\) are collinear.\n![](https://cdn.mathpix.com/cropped/2025_08_23_f2fea43c73934c4e593ag-63.jpg?height=733&width=1061&top_left_y=268&top_left_x=596)\n\nIt now suffices to show that \\(O_{1}\\) lies on the perpendicular bisector of \\(P M\\) for two special cases.\n\nFirstly, we take \\(S\\) to be the midpoint of \\(A H\\). Then \\(X\\) and \\(Y\\) are the feet of altitudes from \\(C\\) and \\(B\\) respectively. It is well-known that the circumcircle of triangle \\(X S Y\\) is the nine-point circle of triangle \\(A B C\\). Then \\(O_{1}\\) is the nine-point centre and \\(O_{1} P=O_{1} M\\). Indeed, \\(P\\) and \\(M\\) also lies on the nine-point circle.\n\nSecondly, we take \\(S^{\\prime}\\) to be the midpoint of \\(A O\\). Then \\(X^{\\prime}\\) and \\(Y^{\\prime}\\) are the midpoints of \\(A B\\) and \\(A C\\) respectively. Then \\(X^{\\prime} Y^{\\prime} / / B C\\). Clearly, \\(S^{\\prime}\\) lies on the perpendicular bisector of \\(P M\\). This shows the perpendicular bisectors of \\(X^{\\prime} Y^{\\prime}\\) and \\(P M\\) coincide. Hence, we must have \\(O_{1}^{\\prime} P=O_{1}^{\\prime} M\\).\n![](https://cdn.mathpix.com/cropped/2025_08_23_f2fea43c73934c4e593ag-63.jpg?height=540&width=1251&top_left_y=1615&top_left_x=487)", "source_pdf": "imosl_2016.pdf", "notes": "fallback-regex"}
{"id": "IMOSL-2016-G6", "contest": "IMOSL", "year": "2016", "problem_number": "G6", "problem": "Let \\(A B C D\\) be a convex quadrilateral with \\(\\angle A B C=\\angle A D C<90^{\\circ}\\). The internal angle bisectors of \\(\\angle A B C\\) and \\(\\angle A D C\\) meet \\(A C\\) at \\(E\\) and \\(F\\) respectively, and meet each other at point \\(P\\). Let \\(M\\) be the midpoint of \\(A C\\) and let \\(\\omega\\) be the circumcircle of triangle \\(B P D\\). Segments \\(B M\\) and \\(D M\\) intersect \\(\\omega\\) again at \\(X\\) and \\(Y\\) respectively. Denote by \\(Q\\) the intersection point of lines \\(X E\\) and \\(Y F\\). Prove that \\(P Q \\perp A C\\).\n\n\\section*{", "solution": "1.}\n![](https://cdn.mathpix.com/cropped/2025_08_23_f2fea43c73934c4e593ag-64.jpg?height=844&width=1476&top_left_y=617&top_left_x=284)\n\nLet \\(\\omega_{1}\\) be the circumcircle of triangle \\(A B C\\). We first prove that \\(Y\\) lies on \\(\\omega_{1}\\). Let \\(Y^{\\prime}\\) be the point on ray \\(M D\\) such that \\(M Y^{\\prime} \\cdot M D=M A^{2}\\). Then triangles \\(M A Y^{\\prime}\\) and \\(M D A\\) are oppositely similar. Since \\(M C^{2}=M A^{2}=M Y^{\\prime} \\cdot M D\\), triangles \\(M C Y^{\\prime}\\) and \\(M D C\\) are also oppositely similar. Therefore, using directed angles, we have\n\\[\n\\measuredangle A Y^{\\prime} C=\\measuredangle A Y^{\\prime} M+\\measuredangle M Y^{\\prime} C=\\measuredangle M A D+\\measuredangle D C M=\\measuredangle C D A=\\measuredangle A B C\n\\]\nso that \\(Y^{\\prime}\\) lies on \\(\\omega_{1}\\).\nLet \\(Z\\) be the intersection point of lines \\(B C\\) and \\(A D\\). Since \\(\\measuredangle P D Z=\\measuredangle P B C=\\measuredangle P B Z\\), point \\(Z\\) lies on \\(\\omega\\). In addition, from \\(\\measuredangle Y^{\\prime} B Z=\\measuredangle Y^{\\prime} B C=\\measuredangle Y^{\\prime} A C=\\measuredangle Y^{\\prime} A M=\\measuredangle Y^{\\prime} D Z\\), we also know that \\(Y^{\\prime}\\) lies on \\(\\omega\\). Note that \\(\\angle A D C\\) is acute implies \\(M A \\neq M D\\) so \\(M Y^{\\prime} \\neq M D\\). Therefore, \\(Y^{\\prime}\\) is the second intersection of \\(D M\\) and \\(\\omega\\). Then \\(Y^{\\prime}=Y\\) and hence \\(Y\\) lies on \\(\\omega_{1}\\).\n\nNext, by the Angle Bisector Theorem and the similar triangles, we have\n\\[\n\\frac{F A}{F C}=\\frac{A D}{C D}=\\frac{A D}{A M} \\cdot \\frac{C M}{C D}=\\frac{Y A}{Y M} \\cdot \\frac{Y M}{Y C}=\\frac{Y A}{Y C} .\n\\]\n\nHence, \\(F Y\\) is the internal angle bisector of \\(\\angle A Y C\\).\nLet \\(B^{\\prime}\\) be the second intersection of the internal angle bisector of \\(\\angle C B A\\) and \\(\\omega_{1}\\). Then \\(B^{\\prime}\\) is the midpoint of arc \\(A C\\) not containing \\(B\\). Therefore, \\(Y B^{\\prime}\\) is the external angle bisector of \\(\\angle A Y C\\), so that \\(B^{\\prime} Y \\perp F Y\\).\n\nDenote by \\(l\\) the line through \\(P\\) parallel to \\(A C\\). Suppose \\(l\\) meets line \\(B^{\\prime} Y\\) at \\(S\\). From\n\\[\n\\begin{aligned}\n\\measuredangle P S Y & =\\angle\\left(A C, B^{\\prime} Y\\right)=\\measuredangle A C Y+\\measuredangle C Y B^{\\prime}=\\measuredangle A C Y+\\measuredangle C A B^{\\prime}=\\measuredangle A C Y+\\measuredangle B^{\\prime} C A \\\\\n& =\\measuredangle B^{\\prime} C Y=\\measuredangle B^{\\prime} B Y=\\measuredangle P B Y,\n\\end{aligned}\n\\]\nthe point \\(S\\) lies on \\(\\omega\\). Similarly, the line through \\(X\\) perpendicular to \\(X E\\) also passes through the second intersection of \\(l\\) and \\(\\omega\\), which is the point \\(S\\). From \\(Q Y \\perp Y S\\) and \\(Q X \\perp X S\\), point \\(Q\\) lies on \\(\\omega\\) and \\(Q S\\) is a diameter of \\(\\omega\\). Therefore, \\(P Q \\perp P S\\) so that \\(P Q \\perp A C\\).\n\nSolution 2. Denote by \\(\\omega_{1}\\) and \\(\\omega_{2}\\) the circumcircles of triangles \\(A B C\\) and \\(A D C\\) respectively. Since \\(\\angle A B C=\\angle A D C\\), we know that \\(\\omega_{1}\\) and \\(\\omega_{2}\\) are symmetric with respect to the midpoint \\(M\\) of \\(A C\\).\n\nFirstly, we show that \\(X\\) lies on \\(\\omega_{2}\\). Let \\(X_{1}\\) be the second intersection of ray \\(M B\\) and \\(\\omega_{2}\\) and \\(X^{\\prime}\\) be its symmetric point with respect to \\(M\\). Then \\(X^{\\prime}\\) lies on \\(\\omega_{1}\\) and \\(X^{\\prime} A X_{1} C\\) is a parallelogram. Hence, we have\n\\[\n\\begin{aligned}\n\\measuredangle D X_{1} B & =\\measuredangle D X_{1} A+\\measuredangle A X_{1} B=\\measuredangle D C A+\\measuredangle A X_{1} X^{\\prime}=\\measuredangle D C A+\\measuredangle C X^{\\prime} X_{1} \\\\\n& =\\measuredangle D C A+\\measuredangle C A B=\\measuredangle(C D, A B) .\n\\end{aligned}\n\\]\n![](https://cdn.mathpix.com/cropped/2025_08_23_f2fea43c73934c4e593ag-65.jpg?height=907&width=1286&top_left_y=1200&top_left_x=444)\n\nAlso, we have\n\\[\n\\measuredangle D P B=\\measuredangle P D C+\\angle(C D, A B)+\\measuredangle A B P=\\angle(C D, A B) .\n\\]\n\nThese yield \\(\\measuredangle D X_{1} B=\\measuredangle D P B\\) and hence \\(X_{1}\\) lies on \\(\\omega\\). It follows that \\(X_{1}=X\\) and \\(X\\) lies on \\(\\omega_{2}\\). Similarly, \\(Y\\) lies on \\(\\omega_{1}\\).\n\nNext, we prove that \\(Q\\) lies on \\(\\omega\\). Suppose the perpendicular bisector of \\(A C\\) meet \\(\\omega_{1}\\) at \\(B^{\\prime}\\) and \\(M_{1}\\) and meet \\(\\omega_{2}\\) at \\(D^{\\prime}\\) and \\(M_{2}\\), so that \\(B, M_{1}\\) and \\(D^{\\prime}\\) lie on the same side of \\(A C\\). Note that \\(B^{\\prime}\\) lies on the angle bisector of \\(\\angle A B C\\) and similarly \\(D^{\\prime}\\) lies on \\(D P\\).\n\nIf we denote the area of \\(W_{1} W_{2} W_{3}\\) by \\(\\left[W_{1} W_{2} W_{3}\\right]\\), then\n\\[\n\\frac{B A \\cdot X^{\\prime} A}{B C \\cdot X^{\\prime} C}=\\frac{\\frac{1}{2} B A \\cdot X^{\\prime} A \\sin \\angle B A X^{\\prime}}{\\frac{1}{2} B C \\cdot X^{\\prime} C \\sin \\angle B C X^{\\prime}}=\\frac{\\left[B A X^{\\prime}\\right]}{\\left[B C X^{\\prime}\\right]}=\\frac{M A}{M C}=1 .\n\\]\n\nAs \\(B E\\) is the angle bisector of \\(\\angle A B C\\), we have\n\\[\n\\frac{E A}{E C}=\\frac{B A}{B C}=\\frac{X^{\\prime} C}{X^{\\prime} A}=\\frac{X A}{X C}\n\\]\n\nTherefore, \\(X E\\) is the angle bisector of \\(\\angle A X C\\), so that \\(M_{2}\\) lies on the line joining \\(X, E, Q\\). Analogously, \\(M_{1}, F, Q, Y\\) are collinear. Thus,\n\\[\n\\begin{aligned}\n\\measuredangle X Q Y & =\\measuredangle M_{2} Q M_{1}=\\measuredangle Q M_{2} M_{1}+\\measuredangle M_{2} M_{1} Q=\\measuredangle X M_{2} D^{\\prime}+\\measuredangle B^{\\prime} M_{1} Y \\\\\n& =\\measuredangle X D D^{\\prime}+\\measuredangle B^{\\prime} B Y=\\measuredangle X D P+\\measuredangle P B Y=\\measuredangle X B P+\\measuredangle P B Y=\\measuredangle X B Y\n\\end{aligned}\n\\]\nwhich implies \\(Q\\) lies on \\(\\omega\\).\nFinally, as \\(M_{1}\\) and \\(M_{2}\\) are symmetric with respect to \\(M\\), the quadrilateral \\(X^{\\prime} M_{2} X M_{1}\\) is a parallelogram. Consequently,\n\\[\n\\measuredangle X Q P=\\measuredangle X B P=\\measuredangle X^{\\prime} B B^{\\prime}=\\measuredangle X^{\\prime} M_{1} B^{\\prime}=\\measuredangle X M_{2} M_{1} .\n\\]\n\nThis shows \\(Q P / / M_{2} M_{1}\\). As \\(M_{2} M_{1} \\perp A C\\), we get \\(Q P \\perp A C\\).\nSolution 3. We first state two results which will be needed in our proof.\n- Claim 1. In \\(\\triangle X^{\\prime} Y^{\\prime} Z^{\\prime}\\) with \\(X^{\\prime} Y^{\\prime} \\neq X^{\\prime} Z^{\\prime}\\), let \\(N^{\\prime}\\) be the midpoint of \\(Y^{\\prime} Z^{\\prime}\\) and \\(W^{\\prime}\\) be the foot of internal angle bisector from \\(X^{\\prime}\\). Then \\(\\tan ^{2} \\measuredangle W^{\\prime} X^{\\prime} Z^{\\prime}=\\tan \\measuredangle N^{\\prime} X^{\\prime} W^{\\prime} \\tan \\measuredangle Z^{\\prime} W^{\\prime} X^{\\prime}\\).\n\nProof.\n![](https://cdn.mathpix.com/cropped/2025_08_23_f2fea43c73934c4e593ag-66.jpg?height=415&width=562&top_left_y=1683&top_left_x=731)\n\nWithout loss of generality, assume \\(X^{\\prime} Y^{\\prime}>X^{\\prime} Z^{\\prime}\\). Then \\(W^{\\prime}\\) lies between \\(N^{\\prime}\\) and \\(Z^{\\prime}\\). The signs of both sides agree so it suffices to establish the relation for ordinary angles. Let \\(\\angle W^{\\prime} X^{\\prime} Z^{\\prime}=\\alpha, \\angle N^{\\prime} X^{\\prime} W^{\\prime}=\\beta\\) and \\(\\angle Z^{\\prime} W^{\\prime} X^{\\prime}=\\gamma\\). We have\n\\[\n\\frac{\\sin (\\gamma-\\alpha)}{\\sin (\\alpha-\\beta)}=\\frac{N^{\\prime} X^{\\prime}}{N^{\\prime} Y^{\\prime}}=\\frac{N^{\\prime} X^{\\prime}}{N^{\\prime} Z^{\\prime}}=\\frac{\\sin (\\gamma+\\alpha)}{\\sin (\\alpha+\\beta)}\n\\]\n\nThis implies\n\\[\n\\frac{\\tan \\gamma-\\tan \\alpha}{\\tan \\gamma+\\tan \\alpha}=\\frac{\\sin \\gamma \\cos \\alpha-\\cos \\gamma \\sin \\alpha}{\\sin \\gamma \\cos \\alpha+\\cos \\gamma \\sin \\alpha}=\\frac{\\sin \\alpha \\cos \\beta-\\cos \\alpha \\sin \\beta}{\\sin \\alpha \\cos \\beta+\\cos \\alpha \\sin \\beta}=\\frac{\\tan \\alpha-\\tan \\beta}{\\tan \\alpha+\\tan \\beta}\n\\]\n\nExpanding and simplifying, we get the desired result \\(\\tan ^{2} \\alpha=\\tan \\beta \\tan \\gamma\\).\n- Claim 2. Let \\(A^{\\prime} B^{\\prime} C^{\\prime} D^{\\prime}\\) be a quadrilateral inscribed in circle \\(\\Gamma\\). Let diagonals \\(A^{\\prime} C^{\\prime}\\) and \\(B^{\\prime} D^{\\prime}\\) meet at \\(E^{\\prime}\\), and \\(F^{\\prime}\\) be the intersection of lines \\(A^{\\prime} B^{\\prime}\\) and \\(C^{\\prime} D^{\\prime}\\). Let \\(M^{\\prime}\\) be the midpoint of \\(E^{\\prime} F^{\\prime}\\). Then the power of \\(M^{\\prime}\\) with respect to \\(\\Gamma\\) is equal to \\(\\left(M^{\\prime} E^{\\prime}\\right)^{2}\\).\n\n\\section*{Proof.}\n![](https://cdn.mathpix.com/cropped/2025_08_23_f2fea43c73934c4e593ag-67.jpg?height=619&width=909&top_left_y=1005&top_left_x=683)\n\nLet \\(O^{\\prime}\\) be the centre of \\(\\Gamma\\) and let \\(\\Gamma^{\\prime}\\) be the circle with centre \\(M^{\\prime}\\) passing through \\(E^{\\prime}\\). Let \\(F_{1}\\) be the inversion image of \\(F^{\\prime}\\) with respect to \\(\\Gamma\\). It is well-known that \\(E^{\\prime}\\) lies on the polar of \\(F^{\\prime}\\) with respect to \\(\\Gamma\\). This shows \\(E^{\\prime} F_{1} \\perp O^{\\prime} F^{\\prime}\\) and hence \\(F_{1}\\) lies on \\(\\Gamma^{\\prime}\\). It follows that the inversion image of \\(\\Gamma^{\\prime}\\) with respect to \\(\\Gamma\\) is \\(\\Gamma^{\\prime}\\) itself. This shows \\(\\Gamma^{\\prime}\\) is orthogonal to \\(\\Gamma\\), and thus the power of \\(M^{\\prime}\\) with respect to \\(\\Gamma\\) is the square of radius of \\(\\Gamma^{\\prime}\\), which is \\(\\left(M^{\\prime} E^{\\prime}\\right)^{2}\\).\n\nWe return to the main problem. Let \\(Z\\) be the intersection of lines \\(A D\\) and \\(B C\\), and \\(W\\) be the intersection of lines \\(A B\\) and \\(C D\\). Since \\(\\measuredangle P D Z=\\measuredangle P B C=\\measuredangle P B Z\\), point \\(Z\\) lies on \\(\\omega\\). Similarly, \\(W\\) lies on \\(\\omega\\). Applying Claim 2 to the cyclic quadrilateral \\(Z B D W\\), we know that the power of \\(M\\) with respect to \\(\\omega\\) is \\(M A^{2}\\). Hence, \\(M X \\cdot M B=M A^{2}\\).\n\nSuppose the line through \\(B\\) perpendicular to \\(B E\\) meets line \\(A C\\) at \\(T\\). Then \\(B E\\) and \\(B T\\) are the angle bisectors of \\(\\angle C B A\\). This shows ( \\(T, E ; A, C\\) ) is harmonic. Thus, we have \\(M E \\cdot M T=M A^{2}=M X \\cdot M B\\). It follows that \\(E, T, B, X\\) are concyclic.\n![](https://cdn.mathpix.com/cropped/2025_08_23_f2fea43c73934c4e593ag-68.jpg?height=793&width=1416&top_left_y=265&top_left_x=292)\n\nThe result is trivial for the special case \\(A D=C D\\) since \\(P, Q\\) lie on the perpendicular bisector of \\(A C\\) in that case. Similarly, the case \\(A B=C B\\) is trivial. It remains to consider the general cases where we can apply Claim 1 in the latter part of the proof.\n\nLet the projections from \\(P\\) and \\(Q\\) to \\(A C\\) be \\(P^{\\prime}\\) and \\(Q^{\\prime}\\) respectively. Then \\(P Q \\perp A C\\) if and only if \\(P^{\\prime}=Q^{\\prime}\\) if and only if \\(\\frac{E P^{\\prime}}{F P^{\\prime}}=\\frac{E Q^{\\prime}}{F Q^{\\prime}}\\) in terms of directed lengths. Note that\n\\[\n\\frac{E P^{\\prime}}{F P^{\\prime}}=\\frac{\\tan \\measuredangle E F P}{\\tan \\measuredangle F E P}=\\frac{\\tan \\measuredangle A F D}{\\tan \\measuredangle A E B}\n\\]\n\nNext, we have \\(\\frac{E Q^{\\prime}}{F Q^{\\prime}}=\\frac{\\tan \\measuredangle E F Q}{\\tan \\measuredangle F E Q}\\) where \\(\\measuredangle F E Q=\\measuredangle T E X=\\measuredangle T B X=\\frac{\\pi}{2}+\\measuredangle E B M\\) and by symmetry \\(\\measuredangle E F Q=\\frac{\\pi}{2}+\\measuredangle F D M\\). Combining all these, it suffices to show\n\\[\n\\frac{\\tan \\measuredangle A F D}{\\tan \\measuredangle A E B}=\\frac{\\tan \\measuredangle M B E}{\\tan \\measuredangle M D F} .\n\\]\n\nWe now apply Claim 1 twice to get\n\\[\n\\tan \\measuredangle A F D \\tan \\measuredangle M D F=\\tan ^{2} \\measuredangle F D C=\\tan ^{2} \\measuredangle E B A=\\tan \\measuredangle M B E \\tan \\measuredangle A E B .\n\\]\n\nThe result then follows.", "source_pdf": "imosl_2016.pdf", "notes": "fallback-regex"}
{"id": "IMOSL-2016-G7", "contest": "IMOSL", "year": "2016", "problem_number": "G7", "problem": "Let \\(I\\) be the incentre of a non-equilateral triangle \\(A B C, I_{A}\\) be the \\(A\\)-excentre, \\(I_{A}^{\\prime}\\) be the reflection of \\(I_{A}\\) in \\(B C\\), and \\(l_{A}\\) be the reflection of line \\(A I_{A}^{\\prime}\\) in \\(A I\\). Define points \\(I_{B}, I_{B}^{\\prime}\\) and line \\(l_{B}\\) analogously. Let \\(P\\) be the intersection point of \\(l_{A}\\) and \\(l_{B}\\).\n(a) Prove that \\(P\\) lies on line \\(O I\\) where \\(O\\) is the circumcentre of triangle \\(A B C\\).\n(b) Let one of the tangents from \\(P\\) to the incircle of triangle \\(A B C\\) meet the circumcircle at points \\(X\\) and \\(Y\\). Show that \\(\\angle X I Y=120^{\\circ}\\).\n\n\\section*{", "solution": "1.}\n(a) Let \\(A^{\\prime}\\) be the reflection of \\(A\\) in \\(B C\\) and let \\(M\\) be the second intersection of line \\(A I\\) and the circumcircle \\(\\Gamma\\) of triangle \\(A B C\\). As triangles \\(A B A^{\\prime}\\) and \\(A O C\\) are isosceles with \\(\\angle A B A^{\\prime}=2 \\angle A B C=\\angle A O C\\), they are similar to each other. Also, triangles \\(A B I_{A}\\) and \\(A I C\\) are similar. Therefore we have\n\\[\n\\frac{A A^{\\prime}}{A I_{A}}=\\frac{A A^{\\prime}}{A B} \\cdot \\frac{A B}{A I_{A}}=\\frac{A C}{A O} \\cdot \\frac{A I}{A C}=\\frac{A I}{A O} .\n\\]\n\nTogether with \\(\\angle A^{\\prime} A I_{A}=\\angle I A O\\), we find that triangles \\(A A^{\\prime} I_{A}\\) and \\(A I O\\) are similar.\n![](https://cdn.mathpix.com/cropped/2025_08_23_f2fea43c73934c4e593ag-69.jpg?height=890&width=1004&top_left_y=1198&top_left_x=658)\n\nDenote by \\(P^{\\prime}\\) the intersection of line \\(A P\\) and line \\(O I\\). Using directed angles, we have\n\\[\n\\begin{aligned}\n\\measuredangle M A P^{\\prime} & =\\measuredangle I_{A}^{\\prime} A I_{A}=\\measuredangle I_{A}^{\\prime} A A^{\\prime}-\\measuredangle I_{A} A A^{\\prime}=\\measuredangle A A^{\\prime} I_{A}-\\measuredangle(A M, O M) \\\\\n& =\\measuredangle A I O-\\measuredangle A M O=\\measuredangle M O P^{\\prime}\n\\end{aligned}\n\\]\n\nThis shows \\(M, O, A, P^{\\prime}\\) are concyclic.\n\nDenote by \\(R\\) and \\(r\\) the circumradius and inradius of triangle \\(A B C\\). Then\n\\[\nI P^{\\prime}=\\frac{I A \\cdot I M}{I O}=\\frac{I O^{2}-R^{2}}{I O}\n\\]\nis independent of \\(A\\). Hence, \\(B P\\) also meets line \\(O I\\) at the same point \\(P^{\\prime}\\) so that \\(P^{\\prime}=P\\), and \\(P\\) lies on \\(O I\\).\n(b) By Poncelet's Porism, the other tangents to the incircle of triangle \\(A B C\\) from \\(X\\) and \\(Y\\) meet at a point \\(Z\\) on \\(\\Gamma\\). Let \\(T\\) be the touching point of the incircle to \\(X Y\\), and let \\(D\\) be the midpoint of \\(X Y\\). We have\n\\[\n\\begin{aligned}\nO D & =I T \\cdot \\frac{O P}{I P}=r\\left(1+\\frac{O I}{I P}\\right)=r\\left(1+\\frac{O I^{2}}{O I \\cdot I P}\\right)=r\\left(1+\\frac{R^{2}-2 R r}{R^{2}-I O^{2}}\\right) \\\\\n& =r\\left(1+\\frac{R^{2}-2 R r}{2 R r}\\right)=\\frac{R}{2}=\\frac{O X}{2}\n\\end{aligned}\n\\]\n\nThis shows \\(\\angle X Z Y=60^{\\circ}\\) and hence \\(\\angle X I Y=120^{\\circ}\\).\n\n\\section*{Solution 2.}\n(a) Note that triangles \\(A I_{B} C\\) and \\(I_{A} B C\\) are similar since their corresponding interior angles are equal. Therefore, the four triangles \\(A I_{B}^{\\prime} C, A I_{B} C, I_{A} B C\\) and \\(I_{A}^{\\prime} B C\\) are all similar. From \\(\\triangle A I_{B}^{\\prime} C \\sim \\triangle I_{A}^{\\prime} B C\\), we get \\(\\triangle A I_{A}^{\\prime} C \\sim \\triangle I_{B}^{\\prime} B C\\). From \\(\\measuredangle A B P=\\measuredangle I_{B}^{\\prime} B C=\\measuredangle A I_{A}^{\\prime} C\\) and \\(\\measuredangle B A P=\\measuredangle I_{A}^{\\prime} A C\\), the triangles \\(A B P\\) and \\(A I_{A}^{\\prime} C\\) are directly similar.\n![](https://cdn.mathpix.com/cropped/2025_08_23_f2fea43c73934c4e593ag-70.jpg?height=817&width=1145&top_left_y=1455&top_left_x=487)\n\nConsider the inversion with centre \\(A\\) and radius \\(\\sqrt{A B \\cdot A C}\\) followed by the reflection in \\(A I\\). Then \\(B\\) and \\(C\\) are mapped to each other, and \\(I\\) and \\(I_{A}\\) are mapped to each other.\n\nFrom the similar triangles obtained, we have \\(A P \\cdot A I_{A}^{\\prime}=A B \\cdot A C\\) so that \\(P\\) is mapped to \\(I_{A}^{\\prime}\\) under the transformation. In addition, line \\(A O\\) is mapped to the altitude from \\(A\\), and hence \\(O\\) is mapped to the reflection of \\(A\\) in \\(B C\\), which we call point \\(A^{\\prime}\\). Note that \\(A A^{\\prime} I_{A} I_{A}^{\\prime}\\) is an isosceles trapezoid, which shows it is inscribed in a circle. The preimage of this circle is a straight line, meaning that \\(O, I, P\\) are collinear.\n(b) Denote by \\(R\\) and \\(r\\) the circumradius and inradius of triangle \\(A B C\\). Note that by the above transformation, we have \\(\\triangle A P O \\sim \\triangle A A^{\\prime} I_{A}^{\\prime}\\) and \\(\\triangle A A^{\\prime} I_{A} \\sim \\triangle A I O\\). Therefore, we find that\n\\[\nP O=A^{\\prime} I_{A}^{\\prime} \\cdot \\frac{A O}{A I_{A}^{\\prime}}=A I_{A} \\cdot \\frac{A O}{A^{\\prime} I_{A}}=\\frac{A I_{A}}{A^{\\prime} I_{A}} \\cdot A O=\\frac{A O}{I O} \\cdot A O\n\\]\n\nThis shows \\(P O \\cdot I O=R^{2}\\), and it follows that \\(P\\) and \\(I\\) are mapped to each other under the inversion with respect to the circumcircle \\(\\Gamma\\) of triangle \\(A B C\\). Then \\(P X \\cdot P Y\\), which is the power of \\(P\\) with respect to \\(\\Gamma\\), equals \\(P I \\cdot P O\\). This yields \\(X, I, O, Y\\) are concyclic.\n\nLet \\(T\\) be the touching point of the incircle to \\(X Y\\), and let \\(D\\) be the midpoint of \\(X Y\\). Then\n\\[\nO D=I T \\cdot \\frac{P O}{P I}=r \\cdot \\frac{P O}{P O-I O}=r \\cdot \\frac{R^{2}}{R^{2}-I O^{2}}=r \\cdot \\frac{R^{2}}{2 R r}=\\frac{R}{2}\n\\]\n\nThis shows \\(\\angle D O X=60^{\\circ}\\) and hence \\(\\angle X I Y=\\angle X O Y=120^{\\circ}\\).\nComment. A simplification of this problem is to ask part (a) only. Note that the question in part (b) implicitly requires \\(P\\) to lie on \\(O I\\), or otherwise the angle is not uniquely determined as we can find another tangent from \\(P\\) to the incircle.", "source_pdf": "imosl_2016.pdf", "notes": "fallback-regex"}
{"id": "IMOSL-2016-G8", "contest": "IMOSL", "year": "2016", "problem_number": "G8", "problem": "Let \\(A_{1}, B_{1}\\) and \\(C_{1}\\) be points on sides \\(B C, C A\\) and \\(A B\\) of an acute triangle \\(A B C\\) respectively, such that \\(A A_{1}, B B_{1}\\) and \\(C C_{1}\\) are the internal angle bisectors of triangle \\(A B C\\). Let \\(I\\) be the incentre of triangle \\(A B C\\), and \\(H\\) be the orthocentre of triangle \\(A_{1} B_{1} C_{1}\\). Show that\n\\[\nA H+B H+C H \\geqslant A I+B I+C I .\n\\]", "solution": ". Without loss of generality, assume \\(\\alpha=\\angle B A C \\leqslant \\beta=\\angle C B A \\leqslant \\gamma=\\angle A C B\\). Denote by \\(a, b, c\\) the lengths of \\(B C, C A, A B\\) respectively. We first show that triangle \\(A_{1} B_{1} C_{1}\\) is acute.\n\nChoose points \\(D\\) and \\(E\\) on side \\(B C\\) such that \\(B_{1} D / / A B\\) and \\(B_{1} E\\) is the internal angle bisector of \\(\\angle B B_{1} C\\). As \\(\\angle B_{1} D B=180^{\\circ}-\\beta\\) is obtuse, we have \\(B B_{1}>B_{1} D\\). Thus,\n\\[\n\\frac{B E}{E C}=\\frac{B B_{1}}{B_{1} C}>\\frac{D B_{1}}{B_{1} C}=\\frac{B A}{A C}=\\frac{B A_{1}}{A_{1} C}\n\\]\n\nTherefore, \\(B E>B A_{1}\\) and \\(\\frac{1}{2} \\angle B B_{1} C=\\angle B B_{1} E>\\angle B B_{1} A_{1}\\). Similarly, \\(\\frac{1}{2} \\angle B B_{1} A>\\angle B B_{1} C_{1}\\). It follows that\n\\[\n\\angle A_{1} B_{1} C_{1}=\\angle B B_{1} A_{1}+\\angle B B_{1} C_{1}<\\frac{1}{2}\\left(\\angle B B_{1} C+\\angle B B_{1} A\\right)=90^{\\circ}\n\\]\nis acute. By symmetry, triangle \\(A_{1} B_{1} C_{1}\\) is acute.\nLet \\(B B_{1}\\) meet \\(A_{1} C_{1}\\) at \\(F\\). From \\(\\alpha \\leqslant \\gamma\\), we get \\(a \\leqslant c\\), which implies\n\\[\nB A_{1}=\\frac{c a}{b+c} \\leqslant \\frac{a c}{a+b}=B C_{1}\n\\]\nand hence \\(\\angle B C_{1} A_{1} \\leqslant \\angle B A_{1} C_{1}\\). As \\(B F\\) is the internal angle bisector of \\(\\angle A_{1} B C_{1}\\), this shows \\(\\angle B_{1} F C_{1}=\\angle B F A_{1} \\leqslant 90^{\\circ}\\). Hence, \\(H\\) lies on the same side of \\(B B_{1}\\) as \\(C_{1}\\). This shows \\(H\\) lies inside triangle \\(B B_{1} C_{1}\\). Similarly, from \\(\\alpha \\leqslant \\beta\\) and \\(\\beta \\leqslant \\gamma\\), we know that \\(H\\) lies inside triangles \\(C C_{1} B_{1}\\) and \\(A A_{1} C_{1}\\).\n![](https://cdn.mathpix.com/cropped/2025_08_23_f2fea43c73934c4e593ag-72.jpg?height=779&width=1001&top_left_y=1661&top_left_x=509)\n\nAs \\(\\alpha \\leqslant \\beta \\leqslant \\gamma\\), we have \\(\\alpha \\leqslant 60^{\\circ} \\leqslant \\gamma\\). Then \\(\\angle B I C \\leqslant 120^{\\circ} \\leqslant \\angle A I B\\). Firstly, suppose \\(\\angle A I C \\geqslant 120^{\\circ}\\).\n\nRotate points \\(B, I, H\\) through \\(60^{\\circ}\\) about \\(A\\) to \\(B^{\\prime}, I^{\\prime}, H^{\\prime}\\) so that \\(B^{\\prime}\\) and \\(C\\) lie on different sides of \\(A B\\). Since triangle \\(A I^{\\prime} I\\) is equilateral, we have\n\\[\nA I+B I+C I=I^{\\prime} I+B^{\\prime} I^{\\prime}+I C=B^{\\prime} I^{\\prime}+I^{\\prime} I+I C\n\\]\n\nSimilarly,\n\\[\nA H+B H+C H=H^{\\prime} H+B^{\\prime} H^{\\prime}+H C=B^{\\prime} H^{\\prime}+H^{\\prime} H+H C .\n\\]\n\nAs \\(\\angle A I I^{\\prime}=\\angle A I^{\\prime} I=60^{\\circ}, \\angle A I^{\\prime} B^{\\prime}=\\angle A I B \\geqslant 120^{\\circ}\\) and \\(\\angle A I C \\geqslant 120^{\\circ}\\), the quadrilateral \\(B^{\\prime} I^{\\prime} I C\\) is convex and lies on the same side of \\(B^{\\prime} C\\) as \\(A\\).\n\nNext, since \\(H\\) lies inside triangle \\(A C C_{1}, H\\) lies outside \\(B^{\\prime} I^{\\prime} I C\\). Also, \\(H\\) lying inside triangle \\(A B I\\) implies \\(H^{\\prime}\\) lies inside triangle \\(A B^{\\prime} I^{\\prime}\\). This shows \\(H^{\\prime}\\) lies outside \\(B^{\\prime} I^{\\prime} I C\\) and hence the convex quadrilateral \\(B^{\\prime} I^{\\prime} I C\\) is contained inside the quadrilateral \\(B^{\\prime} H^{\\prime} H C\\). It follows that the perimeter of \\(B^{\\prime} I^{\\prime} I C\\) cannot exceed the perimeter of \\(B^{\\prime} H^{\\prime} H C\\). From (1) and (2), we conclude that\n\\[\nA H+B H+C H \\geqslant A I+B I+C I .\n\\]\n\nFor the case \\(\\angle A I C<120^{\\circ}\\), we can rotate \\(B, I, H\\) through \\(60^{\\circ}\\) about \\(C\\) to \\(B^{\\prime}, I^{\\prime}, H^{\\prime}\\) so that \\(B^{\\prime}\\) and \\(A\\) lie on different sides of \\(B C\\). The proof is analogous to the previous case and we still get the desired inequality.\n\n\\section*{Number Theory}", "source_pdf": "imosl_2016.pdf", "notes": "fallback-regex"}
{"id": "IMOSL-2016-N1", "contest": "IMOSL", "year": "2016", "problem_number": "N1", "problem": "For any positive integer \\(k\\), denote the sum of digits of \\(k\\) in its decimal representation by \\(S(k)\\). Find all polynomials \\(P(x)\\) with integer coefficients such that for any positive integer \\(n \\geqslant 2016\\), the integer \\(P(n)\\) is positive and\n\\[\nS(P(n))=P(S(n))\n\\]", "solution": "Answer.\n- \\(P(x)=c\\) where \\(1 \\leqslant c \\leqslant 9\\) is an integer; or\n- \\(P(x)=x\\).\n\n1. We consider three cases according to the degree of \\(P\\).\n- Case 1. \\(P(x)\\) is a constant polynomial.\n\nLet \\(P(x)=c\\) where \\(c\\) is an integer constant. Then (1) becomes \\(S(c)=c\\). This holds if and only if \\(1 \\leqslant c \\leqslant 9\\).\n- Case 2. \\(\\operatorname{deg} P=1\\).\n\nWe have the following observation. For any positive integers \\(m, n\\), we have\n\\[\nS(m+n) \\leqslant S(m)+S(n)\n\\]\nand equality holds if and only if there is no carry in the addition \\(m+n\\).\nLet \\(P(x)=a x+b\\) for some integers \\(a, b\\) where \\(a \\neq 0\\). As \\(P(n)\\) is positive for large \\(n\\), we must have \\(a \\geqslant 1\\). The condition (1) becomes \\(S(a n+b)=a S(n)+b\\) for all \\(n \\geqslant 2016\\). Setting \\(n=2025\\) and \\(n=2020\\) respectively, we get\n\\[\nS(2025 a+b)-S(2020 a+b)=(a S(2025)+b)-(a S(2020)+b)=5 a\n\\]\n\nOn the other hand, (2) implies\n\\[\nS(2025 a+b)=S((2020 a+b)+5 a) \\leqslant S(2020 a+b)+S(5 a)\n\\]\n\nThese give \\(5 a \\leqslant S(5 a)\\). As \\(a \\geqslant 1\\), this holds only when \\(a=1\\), in which case (1) reduces to \\(S(n+b)=S(n)+b\\) for all \\(n \\geqslant 2016\\). Then we find that\n\\[\nS(n+1+b)-S(n+b)=(S(n+1)+b)-(S(n)+b)=S(n+1)-S(n)\n\\]\n\nIf \\(b>0\\), we choose \\(n\\) such that \\(n+1+b=10^{k}\\) for some sufficiently large \\(k\\). Note that all the digits of \\(n+b\\) are 9 's, so that the left-hand side of (3) equals \\(1-9 k\\). As \\(n\\) is a positive integer less than \\(10^{k}-1\\), we have \\(S(n)<9 k\\). Therefore, the right-hand side of (3) is at least \\(1-(9 k-1)=2-9 k\\), which is a contradiction.\n\nThe case \\(b<0\\) can be handled similarly by considering \\(n+1\\) to be a large power of 10 . Therefore, we conclude that \\(P(x)=x\\), in which case (1) is trivially satisfied.\n- Case 3. \\(\\operatorname{deg} P \\geqslant 2\\).\n\nSuppose the leading term of \\(P\\) is \\(a_{d} n^{d}\\) where \\(a_{d} \\neq 0\\). Clearly, we have \\(a_{d}>0\\). Consider \\(n=10^{k}-1\\) in (1). We get \\(S(P(n))=P(9 k)\\). Note that \\(P(n)\\) grows asymptotically as fast as \\(n^{d}\\), so \\(S(P(n))\\) grows asymptotically as no faster than a constant multiple of \\(k\\). On the other hand, \\(P(9 k)\\) grows asymptotically as fast as \\(k^{d}\\). This shows the two sides of the last equation cannot be equal for sufficiently large \\(k\\) since \\(d \\geqslant 2\\).\n\nTherefore, we conclude that \\(P(x)=c\\) where \\(1 \\leqslant c \\leqslant 9\\) is an integer, or \\(P(x)=x\\).\nSolution 2. Let \\(P(x)=a_{d} x^{d}+a_{d-1} x^{d-1}+\\cdots+a_{0}\\). Clearly \\(a_{d}>0\\). There exists an integer \\(m \\geqslant 1\\) such that \\(\\left|a_{i}\\right|<10^{m}\\) for all \\(0 \\leqslant i \\leqslant d\\). Consider \\(n=9 \\times 10^{k}\\) for a sufficiently large integer \\(k\\) in (1). If there exists an index \\(0 \\leqslant i \\leqslant d-1\\) such that \\(a_{i}<0\\), then all digits of \\(P(n)\\) in positions from \\(10^{i k+m+1}\\) to \\(10^{(i+1) k-1}\\) are all 9 's. Hence, we have \\(S(P(n)) \\geqslant 9(k-m-1)\\). On the other hand, \\(P(S(n))=P(9)\\) is a fixed constant. Therefore, (1) cannot hold for large \\(k\\). This shows \\(a_{i} \\geqslant 0\\) for all \\(0 \\leqslant i \\leqslant d-1\\).\n\nHence, \\(P(n)\\) is an integer formed by the nonnegative integers \\(a_{d} \\times 9^{d}, a_{d-1} \\times 9^{d-1}, \\ldots, a_{0}\\) by inserting some zeros in between. This yields\n\\[\nS(P(n))=S\\left(a_{d} \\times 9^{d}\\right)+S\\left(a_{d-1} \\times 9^{d-1}\\right)+\\cdots+S\\left(a_{0}\\right)\n\\]\n\nCombining with (1), we have\n\\[\nS\\left(a_{d} \\times 9^{d}\\right)+S\\left(a_{d-1} \\times 9^{d-1}\\right)+\\cdots+S\\left(a_{0}\\right)=P(9)=a_{d} \\times 9^{d}+a_{d-1} \\times 9^{d-1}+\\cdots+a_{0}\n\\]\n\nAs \\(S(m) \\leqslant m\\) for any positive integer \\(m\\), with equality when \\(1 \\leqslant m \\leqslant 9\\), this forces each \\(a_{i} \\times 9^{i}\\) to be a positive integer between 1 and 9 . In particular, this shows \\(a_{i}=0\\) for \\(i \\geqslant 2\\) and hence \\(d \\leqslant 1\\). Also, we have \\(a_{1} \\leqslant 1\\) and \\(a_{0} \\leqslant 9\\). If \\(a_{1}=1\\) and \\(1 \\leqslant a_{0} \\leqslant 9\\), we take \\(n=10^{k}+\\left(10-a_{0}\\right)\\) for sufficiently large \\(k\\) in (1). This yields a contradiction since\n\\[\nS(P(n))=S\\left(10^{k}+10\\right)=2 \\neq 11=P\\left(11-a_{0}\\right)=P(S(n))\n\\]\n\nThe zero polynomial is also rejected since \\(P(n)\\) is positive for large \\(n\\). The remaining candidates are \\(P(x)=x\\) or \\(P(x)=a_{0}\\) where \\(1 \\leqslant a_{0} \\leqslant 9\\), all of which satisfy (1), and hence are the only solutions.", "source_pdf": "imosl_2016.pdf", "notes": "fallback-regex"}
{"id": "IMOSL-2016-N2", "contest": "IMOSL", "year": "2016", "problem_number": "N2", "problem": "Let \\(\\tau(n)\\) be the number of positive divisors of \\(n\\). Let \\(\\tau_{1}(n)\\) be the number of positive divisors of \\(n\\) which have remainders 1 when divided by 3 . Find all possible integral values of the fraction \\(\\frac{\\tau(10 n)}{\\tau_{1}(10 n)}\\).", "solution": "Answer. All composite numbers together with 2.\n\n. In this solution, we always use \\(p_{i}\\) to denote primes congruent to \\(1 \\bmod 3\\), and use \\(q_{j}\\) to denote primes congruent to \\(2 \\bmod 3\\). When we express a positive integer \\(m\\) using its prime factorization, we also include the special case \\(m=1\\) by allowing the exponents to be zeros. We first compute \\(\\tau_{1}(m)\\) for a positive integer \\(m\\).\n- Claim. Let \\(m=3^{x} p_{1}^{a_{1}} p_{2}^{a_{2}} \\cdots p_{s}^{a_{s}} q_{1}^{b_{1}} q_{2}^{b_{2}} \\cdots q_{t}^{b_{t}}\\) be the prime factorization of \\(m\\). Then\n\\[\n\\tau_{1}(m)=\\prod_{i=1}^{s}\\left(a_{i}+1\\right)\\left\\lceil\\frac{1}{2} \\prod_{j=1}^{t}\\left(b_{j}+1\\right)\\right\\rceil\n\\]\n\nProof. To choose a divisor of \\(m\\) congruent to \\(1 \\bmod 3\\), it cannot have the prime divisor 3, while there is no restriction on choosing prime factors congruent to \\(1 \\bmod 3\\). Also, we have to choose an even number of prime factors (counted with multiplicity) congruent to \\(2 \\bmod 3\\).\n\nIf \\(\\prod_{j=1}^{t}\\left(b_{j}+1\\right)\\) is even, then we may assume without loss of generality \\(b_{1}+1\\) is even. We can choose the prime factors \\(q_{2}, q_{3}, \\ldots, q_{t}\\) freely in \\(\\prod_{j=2}^{t}\\left(b_{j}+1\\right)\\) ways. Then the parity of the number of \\(q_{1}\\) is uniquely determined, and hence there are \\(\\frac{1}{2}\\left(b_{1}+1\\right)\\) ways to choose the exponent of \\(q_{1}\\). Hence (1) is verified in this case.\n\nIf \\(\\prod_{j=1}^{t}\\left(b_{j}+1\\right)\\) is odd, we use induction on \\(t\\) to count the number of choices. When \\(t=1\\), there are \\(\\left\\lceil\\frac{b_{1}+1}{2}\\right\\rceil\\) choices for which the exponent is even and \\(\\left\\lfloor\\frac{b_{1}+1}{2}\\right\\rfloor\\) choices for which the exponent is odd. For the inductive step, we find that there are\n\\[\n\\left\\lceil\\frac{1}{2} \\prod_{j=1}^{t-1}\\left(b_{j}+1\\right)\\right\\rceil \\cdot\\left\\lceil\\frac{b_{t}+1}{2}\\right\\rceil+\\left\\lfloor\\frac{1}{2} \\prod_{j=1}^{t-1}\\left(b_{j}+1\\right)\\right\\rfloor \\cdot\\left\\lfloor\\frac{b_{t}+1}{2}\\right\\rfloor=\\left\\lceil\\frac{1}{2} \\prod_{j=1}^{t}\\left(b_{j}+1\\right)\\right\\rceil\n\\]\nchoices with an even number of prime factors and hence \\(\\left\\lfloor\\frac{1}{2} \\prod_{j=1}^{t}\\left(b_{j}+1\\right)\\right\\rfloor\\) choices with an odd number of prime factors. Hence (1) is also true in this case.\n\nLet \\(n=3^{x} 2^{y} 5^{z} p_{1}^{a_{1}} p_{2}^{a_{2}} \\cdots p_{s}^{a_{s}} q_{1}^{b_{1}} q_{2}^{b_{2}} \\cdots q_{t}^{b_{t}}\\). Using the well-known formula for computing the divisor function, we get\n\\[\n\\tau(10 n)=(x+1)(y+2)(z+2) \\prod_{i=1}^{s}\\left(a_{i}+1\\right) \\prod_{j=1}^{t}\\left(b_{j}+1\\right)\n\\]\n\nBy the Claim, we have\n\\[\n\\tau_{1}(10 n)=\\prod_{i=1}^{s}\\left(a_{i}+1\\right)\\left\\lceil\\frac{1}{2}(y+2)(z+2) \\prod_{j=1}^{t}\\left(b_{j}+1\\right)\\right\\rceil\n\\]\n\nIf \\(c=(y+2)(z+2) \\prod_{j=1}^{t}\\left(b_{j}+1\\right)\\) is even, then (2) and (3) imply\n\\[\n\\frac{\\tau(10 n)}{\\tau_{1}(10 n)}=2(x+1)\n\\]\n\nIn this case \\(\\frac{\\tau(10 n)}{\\tau_{1}(10 n)}\\) can be any even positive integer as \\(x\\) runs through all nonnegative integers.\nIf \\(c\\) is odd, which means \\(y, z\\) are odd and each \\(b_{j}\\) is even, then (2) and (3) imply\n\\[\n\\frac{\\tau(10 n)}{\\tau_{1}(10 n)}=\\frac{2(x+1) c}{c+1}\n\\]\n\nFor this to be an integer, we need \\(c+1\\) divides \\(2(x+1)\\) since \\(c\\) and \\(c+1\\) are relatively prime. Let \\(2(x+1)=k(c+1)\\). Then (4) reduces to\n\\[\n\\frac{\\tau(10 n)}{\\tau_{1}(10 n)}=k c=k(y+2)(z+2) \\prod_{j=1}^{t}\\left(b_{j}+1\\right) .\n\\]\n\nNoting that \\(y, z\\) are odd, the integers \\(y+2\\) and \\(z+2\\) are at least 3 . This shows the integer in this case must be composite. On the other hand, for any odd composite number \\(a b\\) with \\(a, b \\geqslant 3\\), we may simply take \\(n=3^{\\frac{a b-1}{2}} \\cdot 2^{a-2} \\cdot 5^{b-2}\\) so that \\(\\frac{\\tau(10 n)}{\\tau_{1}(10 n)}=a b\\) from (5).\n\nWe conclude that the fraction can be any even integer or any odd composite number. Equivalently, it can be 2 or any composite number.", "source_pdf": "imosl_2016.pdf", "notes": "fallback-regex"}
{"id": "IMOSL-2016-N4", "contest": "IMOSL", "year": "2016", "problem_number": "N4", "problem": "Let \\(n, m, k\\) and \\(l\\) be positive integers with \\(n \\neq 1\\) such that \\(n^{k}+m n^{l}+1\\) divides \\(n^{k+l}-1\\). Prove that\n- \\(m=1\\) and \\(l=2 k\\); or\n- \\(l \\mid k\\) and \\(m=\\frac{n^{k-l}-1}{n^{l}-1}\\).", "solution": "1. It is given that\n\\[\nn^{k}+m n^{l}+1 \\mid n^{k+l}-1 .\n\\]\n\nThis implies\n\\[\nn^{k}+m n^{l}+1 \\mid\\left(n^{k+l}-1\\right)+\\left(n^{k}+m n^{l}+1\\right)=n^{k+l}+n^{k}+m n^{l} .\n\\]\n\nWe have two cases to discuss.\n- Case 1. \\(l \\geqslant k\\).\n\nSince \\(\\left(n^{k}+m n^{l}+1, n\\right)=1\\), (2) yields\n\\[\nn^{k}+m n^{l}+1 \\mid n^{l}+m n^{l-k}+1 .\n\\]\n\nIn particular, we get \\(n^{k}+m n^{l}+1 \\leqslant n^{l}+m n^{l-k}+1\\). As \\(n \\geqslant 2\\) and \\(k \\geqslant 1,(m-1) n^{l}\\) is at least \\(2(m-1) n^{l-k}\\). It follows that the inequality cannot hold when \\(m \\geqslant 2\\). For \\(m=1\\), the above divisibility becomes\n\\[\nn^{k}+n^{l}+1 \\mid n^{l}+n^{l-k}+1 .\n\\]\n\nNote that \\(n^{l}+n^{l-k}+1<n^{l}+n^{l}+1<2\\left(n^{k}+n^{l}+1\\right)\\). Thus we must have \\(n^{l}+n^{l-k}+1=n^{k}+n^{l}+1\\) so that \\(l=2 k\\), which gives the first result.\n- Case 2. \\(l<k\\).\n\nThis time (2) yields\n\\[\nn^{k}+m n^{l}+1 \\mid n^{k}+n^{k-l}+m .\n\\]\n\nIn particular, we get \\(n^{k}+m n^{l}+1 \\leqslant n^{k}+n^{k-l}+m\\), which implies\n\\[\nm \\leqslant \\frac{n^{k-l}-1}{n^{l}-1}\n\\]\n\nOn the other hand, from (1) we may let \\(n^{k+l}-1=\\left(n^{k}+m n^{l}+1\\right) t\\) for some positive integer \\(t\\). Obviously, \\(t\\) is less than \\(n^{l}\\), which means \\(t \\leqslant n^{l}-1\\) as it is an integer. Then we have \\(n^{k+l}-1 \\leqslant\\left(n^{k}+m n^{l}+1\\right)\\left(n^{l}-1\\right)\\), which is the same as\n\\[\nm \\geqslant \\frac{n^{k-l}-1}{n^{l}-1}\n\\]\n\nEquations (3) and (4) combine to give \\(m=\\frac{n^{k-l}-1}{n^{l}-1}\\). As this is an integer, we have \\(l \\mid k-l\\). This means \\(l \\mid k\\) and it corresponds to the second result.\n\nSolution 2. As in Solution 1, we begin with equation (2).\n- Case 1. \\(l \\geqslant k\\).\n\nThen (2) yields\n\\[\nn^{k}+m n^{l}+1 \\mid n^{l}+m n^{l-k}+1 .\n\\]\n\nSince \\(2\\left(n^{k}+m n^{l}+1\\right)>2 m n^{l}+1>n^{l}+m n^{l-k}+1\\), it follows that \\(n^{k}+m n^{l}+1=n^{l}+m n^{l-k}+1\\), that is,\n\\[\nm\\left(n^{l}-n^{l-k}\\right)=n^{l}-n^{k}\n\\]\n\nIf \\(m \\geqslant 2\\), then \\(m\\left(n^{l}-n^{l-k}\\right) \\geqslant 2 n^{l}-2 n^{l-k} \\geqslant 2 n^{l}-n^{l}>n^{l}-n^{k}\\) gives a contradiction. Hence \\(m=1\\) and \\(l-k=k\\), which means \\(m=1\\) and \\(l=2 k\\).\n- Case 2. \\(l<k\\).\n\nThen (2) yields\n\\[\nn^{k}+m n^{l}+1 \\mid n^{k}+n^{k-l}+m .\n\\]\n\nSince \\(2\\left(n^{k}+m n^{l}+1\\right)>2 n^{k}+m>n^{k}+n^{k-l}+m\\), it follows that \\(n^{k}+m n^{l}+1=n^{k}+n^{k-l}+m\\). This gives \\(m=\\frac{n^{k-l}-1}{n^{l}-1}\\). Note that \\(n^{l}-1 \\mid n^{k-l}-1\\) implies \\(l \\mid k-l\\) and hence \\(l \\mid k\\). The proof is thus complete.\n\nComment. Another version of this problem is as follows: let \\(n, m, k\\) and \\(l\\) be positive integers with \\(n \\neq 1\\) such that \\(k\\) and \\(l\\) do not divide each other. Show that \\(n^{k}+m n^{l}+1\\) does not divide \\(n^{k+l}-1\\).", "source_pdf": "imosl_2016.pdf", "notes": "fallback-regex"}
{"id": "IMOSL-2016-N5", "contest": "IMOSL", "year": "2016", "problem_number": "N5", "problem": "Let \\(a\\) be a positive integer which is not a square number. Denote by \\(A\\) the set of all positive integers \\(k\\) such that\n\\[\nk=\\frac{x^{2}-a}{x^{2}-y^{2}}\n\\]\nfor some integers \\(x\\) and \\(y\\) with \\(x>\\sqrt{a}\\). Denote by \\(B\\) the set of all positive integers \\(k\\) such that (1) is satisfied for some integers \\(x\\) and \\(y\\) with \\(0 \\leqslant x<\\sqrt{a}\\). Prove that \\(A=B\\).", "solution": "1. We first prove the following preliminary result.\n- Claim. For fixed \\(k\\), let \\(x, y\\) be integers satisfying (1). Then the numbers \\(x_{1}, y_{1}\\) defined by\n\\[\nx_{1}=\\frac{1}{2}\\left(x-y+\\frac{(x-y)^{2}-4 a}{x+y}\\right), \\quad y_{1}=\\frac{1}{2}\\left(x-y-\\frac{(x-y)^{2}-4 a}{x+y}\\right)\n\\]\nare integers and satisfy (1) (with \\(x, y\\) replaced by \\(x_{1}, y_{1}\\) respectively).\nProof. Since \\(x_{1}+y_{1}=x-y\\) and\n\\[\nx_{1}=\\frac{x^{2}-x y-2 a}{x+y}=-x+\\frac{2\\left(x^{2}-a\\right)}{x+y}=-x+2 k(x-y)\n\\]\nboth \\(x_{1}\\) and \\(y_{1}\\) are integers. Let \\(u=x+y\\) and \\(v=x-y\\). The relation (1) can be rewritten as\n\\[\nu^{2}-(4 k-2) u v+\\left(v^{2}-4 a\\right)=0\n\\]\n\nBy Vieta's Theorem, the number \\(z=\\frac{v^{2}-4 a}{u}\\) satisfies\n\\[\nv^{2}-(4 k-2) v z+\\left(z^{2}-4 a\\right)=0\n\\]\n\nSince \\(x_{1}\\) and \\(y_{1}\\) are defined so that \\(v=x_{1}+y_{1}\\) and \\(z=x_{1}-y_{1}\\), we can reverse the process and verify (1) for \\(x_{1}, y_{1}\\).\n\nWe first show that \\(B \\subset A\\). Take any \\(k \\in B\\) so that (1) is satisfied for some integers \\(x, y\\) with \\(0 \\leqslant x<\\sqrt{a}\\). Clearly, \\(y \\neq 0\\) and we may assume \\(y\\) is positive. Since \\(a\\) is not a square, we have \\(k>1\\). Hence, we get \\(0 \\leqslant x<y<\\sqrt{a}\\). Define\n\\[\nx_{1}=\\frac{1}{2}\\left|x-y+\\frac{(x-y)^{2}-4 a}{x+y}\\right|, \\quad y_{1}=\\frac{1}{2}\\left(x-y-\\frac{(x-y)^{2}-4 a}{x+y}\\right)\n\\]\n\nBy the Claim, \\(x_{1}, y_{1}\\) are integers satisfying (1). Also, we have\n\\[\nx_{1} \\geqslant-\\frac{1}{2}\\left(x-y+\\frac{(x-y)^{2}-4 a}{x+y}\\right)=\\frac{2 a+x(y-x)}{x+y} \\geqslant \\frac{2 a}{x+y}>\\sqrt{a}\n\\]\n\nThis implies \\(k \\in A\\) and hence \\(B \\subset A\\).\n\nNext, we shall show that \\(A \\subset B\\). Take any \\(k \\in A\\) so that (1) is satisfied for some integers \\(x, y\\) with \\(x>\\sqrt{a}\\). Again, we may assume \\(y\\) is positive. Among all such representations of \\(k\\), we choose the one with smallest \\(x+y\\). Define\n\\[\nx_{1}=\\frac{1}{2}\\left|x-y+\\frac{(x-y)^{2}-4 a}{x+y}\\right|, \\quad y_{1}=\\frac{1}{2}\\left(x-y-\\frac{(x-y)^{2}-4 a}{x+y}\\right)\n\\]\n\nBy the Claim, \\(x_{1}, y_{1}\\) are integers satisfying (1). Since \\(k>1\\), we get \\(x>y>\\sqrt{a}\\). Therefore, we have \\(y_{1}>\\frac{4 a}{x+y}>0\\) and \\(\\frac{4 a}{x+y}<x+y\\). It follows that\n\\[\nx_{1}+y_{1} \\leqslant \\max \\left\\{x-y, \\frac{4 a-(x-y)^{2}}{x+y}\\right\\}<x+y\n\\]\n\nIf \\(x_{1}>\\sqrt{a}\\), we get a contradiction due to the minimality of \\(x+y\\). Therefore, we must have \\(0 \\leqslant x_{1}<\\sqrt{a}\\), which means \\(k \\in B\\) so that \\(A \\subset B\\).\n\nThe two subset relations combine to give \\(A=B\\).\nSolution 2. The relation (1) is equivalent to\n\\[\nk y^{2}-(k-1) x^{2}=a .\n\\]\n\nMotivated by Pell's Equation, we prove the following, which is essentially the same as the Claim in Solution 1.\n- Claim. If \\(\\left(x_{0}, y_{0}\\right)\\) is a solution to (2), then \\(\\left((2 k-1) x_{0} \\pm 2 k y_{0},(2 k-1) y_{0} \\pm 2(k-1) x_{0}\\right)\\) is also a solution to (2).\n\nProof. We check directly that\n\\[\n\\begin{aligned}\n& k\\left((2 k-1) y_{0} \\pm 2(k-1) x_{0}\\right)^{2}-(k-1)\\left((2 k-1) x_{0} \\pm 2 k y_{0}\\right)^{2} \\\\\n= & \\left(k(2 k-1)^{2}-(k-1)(2 k)^{2}\\right) y_{0}^{2}+\\left(k(2(k-1))^{2}-(k-1)(2 k-1)^{2}\\right) x_{0}^{2} \\\\\n= & k y_{0}^{2}-(k-1) x_{0}^{2}=a\n\\end{aligned}\n\\]\n\nIf (2) is satisfied for some \\(0 \\leqslant x<\\sqrt{a}\\) and nonnegative integer \\(y\\), then clearly (1) implies \\(y>x\\). Also, we have \\(k>1\\) since \\(a\\) is not a square number. By the Claim, consider another solution to (2) defined by\n\\[\nx_{1}=(2 k-1) x+2 k y, \\quad y_{1}=(2 k-1) y+2(k-1) x\n\\]\n\nIt satisfies \\(x_{1} \\geqslant(2 k-1) x+2 k(x+1)=(4 k-1) x+2 k>x\\). Then we can replace the old solution by a new one which has a larger value in \\(x\\). After a finite number of replacements, we must get a solution with \\(x>\\sqrt{a}\\). This shows \\(B \\subset A\\).\n\nIf (2) is satisfied for some \\(x>\\sqrt{a}\\) and nonnegative integer \\(y\\), by the Claim we consider another solution to (2) defined by\n\\[\nx_{1}=|(2 k-1) x-2 k y|, \\quad y_{1}=(2 k-1) y-2(k-1) x\n\\]\n\nFrom (2), we get \\(\\sqrt{k} y>\\sqrt{k-1} x\\). This implies \\(k y>\\sqrt{k(k-1)} x>(k-1) x\\) and hence \\((2 k-1) x-2 k y<x\\). On the other hand, the relation (1) implies \\(x>y\\). Then it is clear that \\((2 k-1) x-2 k y>-x\\). These combine to give \\(x_{1}<x\\), which means we have found a solution to (2) with \\(x\\) having a smaller absolute value. After a finite number of steps, we shall obtain a solution with \\(0 \\leqslant x<\\sqrt{a}\\). This shows \\(A \\subset B\\).\n\nThe desired result follows from \\(B \\subset A\\) and \\(A \\subset B\\).\nSolution 3. It suffices to show \\(A \\cup B\\) is a subset of \\(A \\cap B\\). We take any \\(k \\in A \\cup B\\), which means there exist integers \\(x, y\\) satisfying (1). Since \\(a\\) is not a square, it follows that \\(k \\neq 1\\). As in Solution 2, the result follows readily once we have proved the existence of a solution ( \\(x_{1}, y_{1}\\) ) to (1) with \\(\\left|x_{1}\\right|>|x|\\), and, in case of \\(x>\\sqrt{a}\\), another solution ( \\(x_{2}, y_{2}\\) ) with \\(\\left|x_{2}\\right|<|x|\\).\n\nWithout loss of generality, assume \\(x, y \\geqslant 0\\). Let \\(u=x+y\\) and \\(v=x-y\\). Then \\(u \\geqslant v\\) and (1) becomes\n\\[\nk=\\frac{(u+v)^{2}-4 a}{4 u v} .\n\\]\n\nThis is the same as\n\\[\nv^{2}+(2 u-4 k u) v+u^{2}-4 a=0 .\n\\]\n\nLet \\(v_{1}=4 k u-2 u-v\\). Then \\(u+v_{1}=4 k u-u-v \\geqslant 8 u-u-v>u+v\\). By Vieta's Theorem, \\(v_{1}\\) satisfies\n\\[\nv_{1}^{2}+(2 u-4 k u) v_{1}+u^{2}-4 a=0 .\n\\]\n\nThis gives \\(k=\\frac{\\left(u+v_{1}\\right)^{2}-4 a}{4 u v_{1}}\\). As \\(k\\) is an integer, \\(u+v_{1}\\) must be even. Therefore, \\(x_{1}=\\frac{u+v_{1}}{2}\\) and \\(y_{1}=\\frac{v_{1}-u}{2}\\) are integers. By reversing the process, we can see that ( \\(x_{1}, y_{1}\\) ) is a solution to (1), with \\(x_{1}=\\frac{u+v_{1}}{2}>\\frac{u+v}{2}=x \\geqslant 0\\). This completes the first half of the proof.\n\nSuppose \\(x>\\sqrt{a}\\). Then \\(u+v>2 \\sqrt{a}\\) and (3) can be rewritten as\n\\[\nu^{2}+(2 v-4 k v) u+v^{2}-4 a=0 .\n\\]\n\nLet \\(u_{2}=4 k v-2 v-u\\). By Vieta's Theorem, we have \\(u u_{2}=v^{2}-4 a\\) and\n\\[\nu_{2}^{2}+(2 v-4 k v) u_{2}+v^{2}-4 a=0\n\\]\n\nBy \\(u>0, u+v>2 \\sqrt{a}\\) and (3), we have \\(v>0\\). If \\(u_{2} \\geqslant 0\\), then \\(v u_{2} \\leqslant u u_{2}=v^{2}-4 a<v^{2}\\). This shows \\(u_{2}<v \\leqslant u\\) and \\(0<u_{2}+v<u+v\\). If \\(u_{2}<0\\), then \\(\\left(u_{2}+v\\right)+(u+v)=4 k v>0\\) and \\(u_{2}+v<u+v\\) imply \\(\\left|u_{2}+v\\right|<u+v\\). In any case, since \\(u_{2}+v\\) is even from (4), we can define \\(x_{2}=\\frac{u_{2}+v}{2}\\) and \\(y_{2}=\\frac{u_{2}-v}{2}\\) so that (1) is satisfied with \\(\\left|x_{2}\\right|<x\\), as desired. The proof is thus complete.", "source_pdf": "imosl_2016.pdf", "notes": "fallback-regex"}
{"id": "IMOSL-2016-N6", "contest": "IMOSL", "year": "2016", "problem_number": "N6", "problem": "Denote by \\(\\mathbb{N}\\) the set of all positive integers. Find all functions \\(f: \\mathbb{N} \\rightarrow \\mathbb{N}\\) such that for all positive integers \\(m\\) and \\(n\\), the integer \\(f(m)+f(n)-m n\\) is nonzero and divides \\(m f(m)+n f(n)\\).", "solution": "Answer. \\(f(n)=n^{2}\\) for any \\(n \\in \\mathbb{N}\\).\n\n. It is given that\n\\[\nf(m)+f(n)-m n \\mid m f(m)+n f(n) .\n\\]\n\nTaking \\(m=n=1\\) in (1), we have \\(2 f(1)-1 \\mid 2 f(1)\\). Then \\(2 f(1)-1 \\mid 2 f(1)-(2 f(1)-1)=1\\) and hence \\(f(1)=1\\).\n\nLet \\(p \\geqslant 7\\) be a prime. Taking \\(m=p\\) and \\(n=1\\) in (1), we have \\(f(p)-p+1 \\mid p f(p)+1\\) and hence\n\\[\nf(p)-p+1 \\mid p f(p)+1-p(f(p)-p+1)=p^{2}-p+1\n\\]\n\nIf \\(f(p)-p+1=p^{2}-p+1\\), then \\(f(p)=p^{2}\\). If \\(f(p)-p+1 \\neq p^{2}-p+1\\), as \\(p^{2}-p+1\\) is an odd positive integer, we have \\(p^{2}-p+1 \\geqslant 3(f(p)-p+1)\\), that is,\n\\[\nf(p) \\leqslant \\frac{1}{3}\\left(p^{2}+2 p-2\\right)\n\\]\n\nTaking \\(m=n=p\\) in (1), we have \\(2 f(p)-p^{2} \\mid 2 p f(p)\\). This implies\n\\[\n2 f(p)-p^{2} \\mid 2 p f(p)-p\\left(2 f(p)-p^{2}\\right)=p^{3}\n\\]\n\nBy (2) and \\(f(p) \\geqslant 1\\), we get\n\\[\n-p^{2}<2 f(p)-p^{2} \\leqslant \\frac{2}{3}\\left(p^{2}+2 p-2\\right)-p^{2}<-p\n\\]\nsince \\(p \\geqslant 7\\). This contradicts the fact that \\(2 f(p)-p^{2}\\) is a factor of \\(p^{3}\\). Thus we have proved that \\(f(p)=p^{2}\\) for all primes \\(p \\geqslant 7\\).\n\nLet \\(n\\) be a fixed positive integer. Choose a sufficiently large prime \\(p\\). Consider \\(m=p\\) in (1). We obtain\n\\[\nf(p)+f(n)-p n \\mid p f(p)+n f(n)-n(f(p)+f(n)-p n)=p f(p)-n f(p)+p n^{2} .\n\\]\n\nAs \\(f(p)=p^{2}\\), this implies \\(p^{2}-p n+f(n) \\mid p\\left(p^{2}-p n+n^{2}\\right)\\). As \\(p\\) is sufficiently large and \\(n\\) is fixed, \\(p\\) cannot divide \\(f(n)\\), and so \\(\\left(p, p^{2}-p n+f(n)\\right)=1\\). It follows that \\(p^{2}-p n+f(n) \\mid p^{2}-p n+n^{2}\\) and hence\n\\[\np^{2}-p n+f(n) \\mid\\left(p^{2}-p n+n^{2}\\right)-\\left(p^{2}-p n+f(n)\\right)=n^{2}-f(n) .\n\\]\n\nNote that \\(n^{2}-f(n)\\) is fixed while \\(p^{2}-p n+f(n)\\) is chosen to be sufficiently large. Therefore, we must have \\(n^{2}-f(n)=0\\) so that \\(f(n)=n^{2}\\) for any positive integer \\(n\\).\n\nFinally, we check that when \\(f(n)=n^{2}\\) for any positive integer \\(n\\), then\n\\[\nf(m)+f(n)-m n=m^{2}+n^{2}-m n\n\\]\nand\n\\[\nm f(m)+n f(n)=m^{3}+n^{3}=(m+n)\\left(m^{2}+n^{2}-m n\\right)\n\\]\n\nThe latter expression is divisible by the former for any positive integers \\(m, n\\). This shows \\(f(n)=n^{2}\\) is the only solution.", "source_pdf": "imosl_2016.pdf", "notes": "fallback-regex"}
{"id": "IMOSL-2016-N8", "contest": "IMOSL", "year": "2016", "problem_number": "N8", "problem": "Find all polynomials \\(P(x)\\) of odd degree \\(d\\) and with integer coefficients satisfying the following property: for each positive integer \\(n\\), there exist \\(n\\) positive integers \\(x_{1}, x_{2}, \\ldots, x_{n}\\) such that \\(\\frac{1}{2}<\\frac{P\\left(x_{i}\\right)}{P\\left(x_{j}\\right)}<2\\) and \\(\\frac{P\\left(x_{i}\\right)}{P\\left(x_{j}\\right)}\\) is the \\(d\\)-th power of a rational number for every pair of indices \\(i\\) and \\(j\\) with \\(1 \\leqslant i, j \\leqslant n\\).", "solution": "Answer. \\(P(x)=a(r x+s)^{d}\\) where \\(a, r, s\\) are integers with \\(a \\neq 0, r \\geqslant 1\\) and \\((r, s)=1\\).\n\n. Let \\(P(x)=a_{d} x^{d}+a_{d-1} x^{d-1}+\\cdots+a_{0}\\). Consider the substitution \\(y=d a_{d} x+a_{d-1}\\). By defining \\(Q(y)=P(x)\\), we find that \\(Q\\) is a polynomial with rational coefficients without the term \\(y^{d-1}\\). Let \\(Q(y)=b_{d} y^{d}+b_{d-2} y^{d-2}+b_{d-3} y^{d-3}+\\cdots+b_{0}\\) and \\(B=\\max _{0 \\leqslant i \\leqslant d}\\left\\{\\left|b_{i}\\right|\\right\\}\\) (where \\(b_{d-1}=0\\) ).\n\nThe condition shows that for each \\(n \\geqslant 1\\), there exist integers \\(y_{1}, y_{2}, \\ldots, y_{n}\\) such that \\(\\frac{1}{2}<\\frac{Q\\left(y_{i}\\right)}{Q\\left(y_{j}\\right)}<2\\) and \\(\\frac{Q\\left(y_{i}\\right)}{Q\\left(y_{j}\\right)}\\) is the \\(d\\)-th power of a rational number for \\(1 \\leqslant i, j \\leqslant n\\). Since \\(n\\) can be arbitrarily large, we may assume all \\(x_{i}\\) 's and hence \\(y_{i}\\) 's are integers larger than some absolute constant in the following.\n\nBy Dirichlet's Theorem, since \\(d\\) is odd, we can find a sufficiently large prime \\(p\\) such that \\(p \\equiv 2(\\bmod d)\\). In particular, we have \\((p-1, d)=1\\). For this fixed \\(p\\), we choose \\(n\\) to be sufficiently large. Then by the Pigeonhole Principle, there must be \\(d+1\\) of \\(y_{1}, y_{2}, \\ldots, y_{n}\\) which are congruent \\(\\bmod p\\). Without loss of generality, assume \\(y_{i} \\equiv y_{j}(\\bmod p)\\) for \\(1 \\leqslant i, j \\leqslant d+1\\). We shall establish the following.\n- Claim. \\(\\frac{Q\\left(y_{i}\\right)}{Q\\left(y_{1}\\right)}=\\frac{y_{i}^{d}}{y_{1}^{d}}\\) for \\(2 \\leqslant i \\leqslant d+1\\).\n\nProof. Let \\(\\frac{Q\\left(y_{i}\\right)}{Q\\left(y_{1}\\right)}=\\frac{l^{d}}{m^{d}}\\) where \\((l, m)=1\\) and \\(l, m>0\\). This can be rewritten in the expanded form\n\\[\nb_{d}\\left(m^{d} y_{i}^{d}-l^{d} y_{1}^{d}\\right)=-\\sum_{j=0}^{d-2} b_{j}\\left(m^{d} y_{i}^{j}-l^{d} y_{1}^{j}\\right)\n\\]\n\nLet \\(c\\) be the common denominator of \\(Q\\), so that \\(c Q(k)\\) is an integer for any integer \\(k\\). Note that \\(c\\) depends only on \\(P\\) and so we may assume \\((p, c)=1\\). Then \\(y_{1} \\equiv y_{i}(\\bmod p)\\) implies \\(c Q\\left(y_{1}\\right) \\equiv c Q\\left(y_{i}\\right)(\\bmod p)\\).\n- Case 1. \\(p \\mid c Q\\left(y_{1}\\right)\\).\n\nIn this case, there is a cancellation of \\(p\\) in the numerator and denominator of \\(\\frac{c Q\\left(y_{i}\\right)}{c Q\\left(y_{1}\\right)}\\), so that \\(m^{d} \\leqslant p^{-1}\\left|c Q\\left(y_{1}\\right)\\right|\\). Noting \\(\\left|Q\\left(y_{1}\\right)\\right|<2 B y_{1}^{d}\\) as \\(y_{1}\\) is large, we get\n\\[\nm \\leqslant p^{-\\frac{1}{d}}(2 c B)^{\\frac{1}{d}} y_{1} .\n\\]\n\nFor large \\(y_{1}\\) and \\(y_{i}\\), the relation \\(\\frac{1}{2}<\\frac{Q\\left(y_{i}\\right)}{Q\\left(y_{1}\\right)}<2\\) implies\n\\[\n\\frac{1}{3}<\\frac{y_{i}^{d}}{y_{1}^{d}}<3\n\\]\n\nWe also have\n\\[\n\\frac{1}{2}<\\frac{l^{d}}{m^{d}}<2\n\\]\n\nNow, the left-hand side of (1) is\n\\[\nb_{d}\\left(m y_{i}-l y_{1}\\right)\\left(m^{d-1} y_{i}^{d-1}+m^{d-2} y_{i}^{d-2} l y_{1}+\\cdots+l^{d-1} y_{1}^{d-1}\\right) .\n\\]\n\nSuppose on the contrary that \\(m y_{i}-l y_{1} \\neq 0\\). Then the absolute value of the above expression is at least \\(\\left|b_{d}\\right| m^{d-1} y_{i}^{d-1}\\). On the other hand, the absolute value of the right-hand side of (1) is at most\n\\[\n\\begin{aligned}\n\\sum_{j=0}^{d-2} B\\left(m^{d} y_{i}^{j}+l^{d} y_{1}^{j}\\right) & \\leqslant(d-1) B\\left(m^{d} y_{i}^{d-2}+l^{d} y_{1}^{d-2}\\right) \\\\\n& \\leqslant(d-1) B\\left(7 m^{d} y_{i}^{d-2}\\right) \\\\\n& \\leqslant 7(d-1) B\\left(p^{-\\frac{1}{d}}(2 c B)^{\\frac{1}{d}} y_{1}\\right) m^{d-1} y_{i}^{d-2} \\\\\n& \\leqslant 21(d-1) B p^{-\\frac{1}{d}}(2 c B)^{\\frac{1}{d}} m^{d-1} y_{i}^{d-1}\n\\end{aligned}\n\\]\nby using successively (3), (4), (2) and again (3). This shows\n\\[\n\\left|b_{d}\\right| m^{d-1} y_{i}^{d-1} \\leqslant 21(d-1) B p^{-\\frac{1}{d}}(2 c B)^{\\frac{1}{d}} m^{d-1} y_{i}^{d-1}\n\\]\nwhich is a contradiction for large \\(p\\) as \\(b_{d}, B, c, d\\) depend only on the polynomial \\(P\\). Therefore, we have \\(m y_{i}-l y_{1}=0\\) in this case.\n- Case 2. \\(\\left(p, c Q\\left(y_{1}\\right)\\right)=1\\).\n\nFrom \\(c Q\\left(y_{1}\\right) \\equiv c Q\\left(y_{i}\\right)(\\bmod p)\\), we have \\(l^{d} \\equiv m^{d}(\\bmod p)\\). Since \\((p-1, d)=1\\), we use Fermat Little Theorem to conclude \\(l \\equiv m(\\bmod p)\\). Then \\(p \\mid m y_{i}-l y_{1}\\). Suppose on the contrary that \\(m y_{i}-l y_{1} \\neq 0\\). Then the left-hand side of (1) has absolute value at least \\(\\left|b_{d}\\right| p m^{d-1} y_{i}^{d-1}\\). Similar to Case 1, the right-hand side of (1) has absolute value at most\n\\[\n21(d-1) B(2 c B)^{\\frac{1}{d}} m^{d-1} y_{i}^{d-1}\n\\]\nwhich must be smaller than \\(\\left|b_{d}\\right| p m^{d-1} y_{i}^{d-1}\\) for large \\(p\\). Again this yields a contradiction and hence \\(m y_{i}-l y_{1}=0\\).\n\nIn both cases, we find that \\(\\frac{Q\\left(y_{i}\\right)}{Q\\left(y_{1}\\right)}=\\frac{l^{d}}{m^{d}}=\\frac{y_{i}^{d}}{y_{1}^{d}}\\).\nFrom the Claim, the polynomial \\(Q\\left(y_{1}\\right) y^{d}-y_{1}^{d} Q(y)\\) has roots \\(y=y_{1}, y_{2}, \\ldots, y_{d+1}\\). Since its degree is at most \\(d\\), this must be the zero polynomial. Hence, \\(Q(y)=b_{d} y^{d}\\). This implies \\(P(x)=a_{d}\\left(x+\\frac{a_{d-1}}{d a_{d}}\\right)^{d}\\). Let \\(\\frac{a_{d-1}}{d a_{d}}=\\frac{s}{r}\\) with integers \\(r, s\\) where \\(r \\geqslant 1\\) and \\((r, s)=1\\). Since \\(P\\) has integer coefficients, we need \\(r^{d} \\mid a_{d}\\). Let \\(a_{d}=r^{d} a\\). Then \\(P(x)=a(r x+s)^{d}\\). It is obvious that such a polynomial satisfies the conditions.\n\nComment. In the proof, the use of prime and Dirichlet's Theorem can be avoided. One can easily show that each \\(P\\left(x_{i}\\right)\\) can be expressed in the form \\(u v_{i}^{d}\\) where \\(u, v_{i}\\) are integers and \\(u\\) cannot be divisible by the \\(d\\)-th power of a prime (note that \\(u\\) depends only on \\(P\\) ). By fixing a large integer \\(q\\) and by choosing a large \\(n\\), we can apply the Pigeonhole Principle and assume\n\\(x_{1} \\equiv x_{2} \\equiv \\cdots \\equiv x_{d+1}(\\bmod q)\\) and \\(v_{1} \\equiv v_{2} \\equiv \\cdots \\equiv v_{d+1}(\\bmod q)\\). Then the remaining proof is similar to Case 2 of the Solution.\n\nAlternatively, we give another modification of the proof as follows.\nWe take a sufficiently large \\(n\\) and consider the corresponding positive integers \\(y_{1}, y_{2}, \\ldots, y_{n}\\). For each \\(2 \\leqslant i \\leqslant n\\), let \\(\\frac{Q\\left(y_{i}\\right)}{Q\\left(y_{1}\\right)}=\\frac{l_{i}^{d}}{m_{i}^{d}}\\).\n\nAs in Case 1, if there are \\(d\\) indices \\(i\\) such that the integers \\(\\frac{c\\left|Q\\left(y_{1}\\right)\\right|}{m_{i}^{d}}\\) are bounded below by a constant depending only on \\(P\\), we can establish the Claim using those \\(y_{i}\\) 's and complete the proof. Similarly, as in Case 2, if there are \\(d\\) indices \\(i\\) such that the integers \\(\\left|m_{i} y_{i}-l_{i} y_{1}\\right|\\) are bounded below, then the proof goes the same. So it suffices to consider the case where \\(\\frac{c\\left|Q\\left(y_{1}\\right)\\right|}{m_{i}^{d}} \\leqslant M\\) and \\(\\left|m_{i} y_{i}-l_{i} y_{1}\\right| \\leqslant N\\) for all \\(2 \\leqslant i \\leqslant n^{\\prime}\\) where \\(M, N\\) are fixed constants and \\(n^{\\prime}\\) is large. Since there are only finitely many choices for \\(m_{i}\\) and \\(m_{i} y_{i}-l_{i} y_{1}\\), by the Pigeonhole Principle, we can assume without loss of generality \\(m_{i}=m\\) and \\(m_{i} y_{i}-l_{i} y_{1}=t\\) for \\(2 \\leqslant i \\leqslant d+2\\). Then\n\\[\n\\frac{Q\\left(y_{i}\\right)}{Q\\left(y_{1}\\right)}=\\frac{l_{i}^{d}}{m^{d}}=\\frac{\\left(m y_{i}-t\\right)^{d}}{m^{d} y_{1}^{d}}\n\\]\nso that \\(Q\\left(y_{1}\\right)(m y-t)^{d}-m^{d} y_{1}^{d} Q(y)\\) has roots \\(y=y_{2}, y_{3}, \\ldots, y_{d+2}\\). Its degree is at most \\(d\\) and hence it is the zero polynomial. Therefore, \\(Q(y)=\\frac{b_{d}}{m^{d}}(m y-t)^{d}\\). Indeed, \\(Q\\) does not have the term \\(y^{d-1}\\), which means \\(t\\) should be 0 . This gives the corresponding \\(P(x)\\) of the desired form.\n\nThe two modifications of the Solution work equally well when the degree \\(d\\) is even.", "source_pdf": "imosl_2016.pdf", "notes": "fallback-regex"}
{"id": "IMOSL-2017-A1", "contest": "IMOSL", "year": "2017", "problem_number": "A1", "problem": "Let \\(a_{1}, a_{2}, \\ldots, a_{n}, k\\), and \\(M\\) be positive integers such that\n\\[\n\\frac{1}{a_{1}}+\\frac{1}{a_{2}}+\\cdots+\\frac{1}{a_{n}}=k \\quad \\text { and } \\quad a_{1} a_{2} \\ldots a_{n}=M .\n\\]\n\nIf \\(M>1\\), prove that the polynomial\n\\[\nP(x)=M(x+1)^{k}-\\left(x+a_{1}\\right)\\left(x+a_{2}\\right) \\cdots\\left(x+a_{n}\\right)\n\\]\nhas no positive roots.\n(Trinidad and Tobago)", "solution": "1. We first prove that, for \\(x>0\\),\n\\[\na_{i}(x+1)^{1 / a_{i}} \\leqslant x+a_{i}\n\\]\nwith equality if and only if \\(a_{i}=1\\). It is clear that equality occurs if \\(a_{i}=1\\).\nIf \\(a_{i}>1\\), the AM-GM inequality applied to a single copy of \\(x+1\\) and \\(a_{i}-1\\) copies of 1 yields\n\\[\n\\frac{(x+1)+\\overbrace{1+1+\\cdots+1}^{a_{i}-1 \\text { ones }}}{a_{i}} \\geqslant \\sqrt[a_{i}]{(x+1) \\cdot 1^{a_{i}-1}} \\Longrightarrow a_{i}(x+1)^{1 / a_{i}} \\leqslant x+a_{i}\n\\]\n\nSince \\(x+1>1\\), the inequality is strict for \\(a_{i}>1\\).\nMultiplying the inequalities (1) for \\(i=1,2, \\ldots, n\\) yields\n\\[\n\\prod_{i=1}^{n} a_{i}(x+1)^{1 / a_{i}} \\leqslant \\prod_{i=1}^{n}\\left(x+a_{i}\\right) \\Longleftrightarrow M(x+1)^{\\sum_{i=1}^{n} 1 / a_{i}}-\\prod_{i=1}^{n}\\left(x+a_{i}\\right) \\leqslant 0 \\Longleftrightarrow P(x) \\leqslant 0\n\\]\nwith equality iff \\(a_{i}=1\\) for all \\(i \\in\\{1,2, \\ldots, n\\}\\). But this implies \\(M=1\\), which is not possible. Hence \\(P(x)<0\\) for all \\(x \\in \\mathbb{R}^{+}\\), and \\(P\\) has no positive roots.\n\nComment 1. Inequality (1) can be obtained in several ways. For instance, we may also use the binomial theorem: since \\(a_{i} \\geqslant 1\\),\n\\[\n\\left(1+\\frac{x}{a_{i}}\\right)^{a_{i}}=\\sum_{j=0}^{a_{i}}\\binom{a_{i}}{j}\\left(\\frac{x}{a_{i}}\\right)^{j} \\geqslant\\binom{ a_{i}}{0}+\\binom{a_{i}}{1} \\cdot \\frac{x}{a_{i}}=1+x .\n\\]\n\nBoth proofs of (1) mimic proofs to Bernoulli's inequality for a positive integer exponent \\(a_{i}\\); we can use this inequality directly:\n\\[\n\\left(1+\\frac{x}{a_{i}}\\right)^{a_{i}} \\geqslant 1+a_{i} \\cdot \\frac{x}{a_{i}}=1+x,\n\\]\nand so\n\\[\nx+a_{i}=a_{i}\\left(1+\\frac{x}{a_{i}}\\right) \\geqslant a_{i}(1+x)^{1 / a_{i}}\n\\]\nor its (reversed) formulation, with exponent \\(1 / a_{i} \\leqslant 1\\) :\n\\[\n(1+x)^{1 / a_{i}} \\leqslant 1+\\frac{1}{a_{i}} \\cdot x=\\frac{x+a_{i}}{a_{i}} \\Longrightarrow a_{i}(1+x)^{1 / a_{i}} \\leqslant x+a_{i}\n\\]\n\nSolution 2. We will prove that, in fact, all coefficients of the polynomial \\(P(x)\\) are non-positive, and at least one of them is negative, which implies that \\(P(x)<0\\) for \\(x>0\\).\n\nIndeed, since \\(a_{j} \\geqslant 1\\) for all \\(j\\) and \\(a_{j}>1\\) for some \\(j\\) (since \\(a_{1} a_{2} \\ldots a_{n}=M>1\\) ), we have \\(k=\\frac{1}{a_{1}}+\\frac{1}{a_{2}}+\\cdots+\\frac{1}{a_{n}}<n\\), so the coefficient of \\(x^{n}\\) in \\(P(x)\\) is \\(-1<0\\). Moreover, the coefficient of \\(x^{r}\\) in \\(P(x)\\) is negative for \\(k<r \\leqslant n=\\operatorname{deg}(P)\\).\n\nFor \\(0 \\leqslant r \\leqslant k\\), the coefficient of \\(x^{r}\\) in \\(P(x)\\) is\n\\[\nM \\cdot\\binom{k}{r}-\\sum_{1 \\leqslant i_{1}<i_{2}<\\cdots<i_{n-r} \\leqslant n} a_{i_{1}} a_{i_{2}} \\cdots a_{i_{n-r}}=a_{1} a_{2} \\cdots a_{n} \\cdot\\binom{k}{r}-\\sum_{1 \\leqslant i_{1}<i_{2}<\\cdots<i_{n-r} \\leqslant n} a_{i_{1}} a_{i_{2}} \\cdots a_{i_{n-r}},\n\\]\nwhich is non-positive iff\n\\[\n\\binom{k}{r} \\leqslant \\sum_{1 \\leqslant j_{1}<j_{2}<\\cdots<j_{r} \\leqslant n} \\frac{1}{a_{j_{1}} a_{j_{2}} \\cdots a_{j_{r}}} .\n\\]\n\nWe will prove (2) by induction on \\(r\\). For \\(r=0\\) it is an equality because the constant term of \\(P(x)\\) is \\(P(0)=0\\), and if \\(r=1\\), (2) becomes \\(k=\\sum_{i=1}^{n} \\frac{1}{a_{i}}\\). For \\(r>1\\), if (2) is true for a given \\(r<k\\), we have\n\\[\n\\binom{k}{r+1}=\\frac{k-r}{r+1} \\cdot\\binom{k}{r} \\leqslant \\frac{k-r}{r+1} \\cdot \\sum_{1 \\leqslant j_{1}<j_{2}<\\cdots<j_{r} \\leqslant n} \\frac{1}{a_{j_{1}} a_{j_{2}} \\cdots a_{j_{r}}},\n\\]\nand it suffices to prove that\n\\[\n\\frac{k-r}{r+1} \\cdot \\sum_{1 \\leqslant j_{1}<j_{2}<\\cdots<j_{r} \\leqslant n} \\frac{1}{a_{j_{1}} a_{j_{2}} \\cdots a_{j_{r}}} \\leqslant \\sum_{1 \\leqslant j_{1}<\\cdots<j_{r}<j_{r+1} \\leqslant n} \\frac{1}{a_{j_{1}} a_{j_{2}} \\cdots a_{j_{r}} a_{j_{r+1}}},\n\\]\nwhich is equivalent to\n\\[\n\\left(\\frac{1}{a_{1}}+\\frac{1}{a_{2}}+\\cdots+\\frac{1}{a_{n}}-r\\right) \\sum_{1 \\leqslant j_{1}<j_{2}<\\cdots<j_{r} \\leqslant n} \\frac{1}{a_{j_{1}} a_{j_{2}} \\cdots a_{j_{r}}} \\leqslant(r+1) \\sum_{1 \\leqslant j_{1}<\\cdots<j_{r}<j_{r+1} \\leqslant n} \\frac{1}{a_{j_{1}} a_{j_{2}} \\cdots a_{j_{r}} a_{j_{r+1}}} .\n\\]\n\nSince there are \\(r+1\\) ways to choose a fraction \\(\\frac{1}{a_{j_{i}}}\\) from \\(\\frac{1}{a_{j_{1}} a_{j_{2}} \\cdots a_{j_{r}} a_{j_{r}+1}}\\) to factor out, every term \\(\\frac{1}{a_{j_{1}} a_{j_{2}} \\cdots a_{j_{r}} a_{j_{r+1}}}\\) in the right hand side appears exactly \\(r+1\\) times in the product\n\\[\n\\left(\\frac{1}{a_{1}}+\\frac{1}{a_{2}}+\\cdots+\\frac{1}{a_{n}}\\right) \\sum_{1 \\leqslant j_{1}<j_{2}<\\cdots<j_{r} \\leqslant n} \\frac{1}{a_{j_{1}} a_{j_{2}} \\cdots a_{j_{r}}} .\n\\]\n\nHence all terms in the right hand side cancel out.\nThe remaining terms in the left hand side can be grouped in sums of the type\n\\[\n\\begin{aligned}\n\\frac{1}{a_{j_{1}}^{2} a_{j_{2}} \\cdots a_{j_{r}}}+\\frac{1}{a_{j_{1}} a_{j_{2}}^{2} \\cdots a_{j_{r}}}+\\cdots+\\frac{1}{a_{j_{1}} a_{j_{2}} \\cdots a_{j_{r}}^{2}} & -\\frac{r}{a_{j_{1}} a_{j_{2}} \\cdots a_{j_{r}}} \\\\\n& =\\frac{1}{a_{j_{1}} a_{j_{2}} \\cdots a_{j_{r}}}\\left(\\frac{1}{a_{j_{1}}}+\\frac{1}{a_{j_{2}}}+\\cdots+\\frac{1}{a_{j_{r}}}-r\\right)\n\\end{aligned}\n\\]\nwhich are all non-positive because \\(a_{i} \\geqslant 1 \\Longrightarrow \\frac{1}{a_{i}} \\leqslant 1, i=1,2, \\ldots, n\\).\nComment 2. The result is valid for any real numbers \\(a_{i}, i=1,2, \\ldots, n\\) with \\(a_{i} \\geqslant 1\\) and product \\(M\\) greater than 1. A variation of Solution 1, namely using weighted AM-GM (or the Bernoulli inequality for real exponents), actually proves that \\(P(x)<0\\) for \\(x>-1\\) and \\(x \\neq 0\\).", "source_pdf": "imosl_2017.pdf", "notes": "fallback-regex"}
{"id": "IMOSL-2017-A2", "contest": "IMOSL", "year": "2017", "problem_number": "A2", "problem": "Let \\(q\\) be a real number. Gugu has a napkin with ten distinct real numbers written on it, and he writes the following three lines of real numbers on the blackboard:\n- In the first line, Gugu writes down every number of the form \\(a-b\\), where \\(a\\) and \\(b\\) are two (not necessarily distinct) numbers on his napkin.\n- In the second line, Gugu writes down every number of the form \\(q a b\\), where \\(a\\) and \\(b\\) are two (not necessarily distinct) numbers from the first line.\n- In the third line, Gugu writes down every number of the form \\(a^{2}+b^{2}-c^{2}-d^{2}\\), where \\(a, b, c, d\\) are four (not necessarily distinct) numbers from the first line.\n\nDetermine all values of \\(q\\) such that, regardless of the numbers on Gugu's napkin, every number in the second line is also a number in the third line.\n(Austria)", "solution": "Answer: - \\(2,0,2\\).\n\n1. Call a number \\(q\\) good if every number in the second line appears in the third line unconditionally. We first show that the numbers 0 and \\(\\pm 2\\) are good. The third line necessarily contains 0 , so 0 is good. For any two numbers \\(a, b\\) in the first line, write \\(a=x-y\\) and \\(b=u-v\\), where \\(x, y, u, v\\) are (not necessarily distinct) numbers on the napkin. We may now write\n\\[\n2 a b=2(x-y)(u-v)=(x-v)^{2}+(y-u)^{2}-(x-u)^{2}-(y-v)^{2}\n\\]\nwhich shows that 2 is good. By negating both sides of the above equation, we also see that -2 is good.\n\nWe now show that \\(-2,0\\), and 2 are the only good numbers. Assume for sake of contradiction that \\(q\\) is a good number, where \\(q \\notin\\{-2,0,2\\}\\). We now consider some particular choices of numbers on Gugu's napkin to arrive at a contradiction.\n\nAssume that the napkin contains the integers \\(1,2, \\ldots, 10\\). Then, the first line contains the integers \\(-9,-8, \\ldots, 9\\). The second line then contains \\(q\\) and \\(81 q\\), so the third line must also contain both of them. But the third line only contains integers, so \\(q\\) must be an integer. Furthermore, the third line contains no number greater than \\(162=9^{2}+9^{2}-0^{2}-0^{2}\\) or less than -162 , so we must have \\(-162 \\leqslant 81 q \\leqslant 162\\). This shows that the only possibilities for \\(q\\) are \\(\\pm 1\\).\n\nNow assume that \\(q= \\pm 1\\). Let the napkin contain \\(0,1,4,8,12,16,20,24,28,32\\). The first line contains \\(\\pm 1\\) and \\(\\pm 4\\), so the second line contains \\(\\pm 4\\). However, for every number \\(a\\) in the first line, \\(a \\not \\equiv 2(\\bmod 4)\\), so we may conclude that \\(a^{2} \\equiv 0,1(\\bmod 8)\\). Consequently, every number in the third line must be congruent to \\(-2,-1,0,1,2(\\bmod 8)\\); in particular, \\(\\pm 4\\) cannot be in the third line, which is a contradiction.\n\nSolution 2. Let \\(q\\) be a good number, as defined in the first solution, and define the polynomial \\(P\\left(x_{1}, \\ldots, x_{10}\\right)\\) as\n\\[\n\\prod_{i<j}\\left(x_{i}-x_{j}\\right) \\prod_{a_{i} \\in S}\\left(q\\left(x_{1}-x_{2}\\right)\\left(x_{3}-x_{4}\\right)-\\left(a_{1}-a_{2}\\right)^{2}-\\left(a_{3}-a_{4}\\right)^{2}+\\left(a_{5}-a_{6}\\right)^{2}+\\left(a_{7}-a_{8}\\right)^{2}\\right),\n\\]\nwhere \\(S=\\left\\{x_{1}, \\ldots, x_{10}\\right\\}\\).\nWe claim that \\(P\\left(x_{1}, \\ldots, x_{10}\\right)=0\\) for every choice of real numbers \\(\\left(x_{1}, \\ldots, x_{10}\\right)\\). If any two of the \\(x_{i}\\) are equal, then \\(P\\left(x_{1}, \\ldots, x_{10}\\right)=0\\) trivially. If no two are equal, assume that Gugu has those ten numbers \\(x_{1}, \\ldots, x_{10}\\) on his napkin. Then, the number \\(q\\left(x_{1}-x_{2}\\right)\\left(x_{3}-x_{4}\\right)\\) is in the second line, so we must have some \\(a_{1}, \\ldots, a_{8}\\) so that\n\\[\nq\\left(x_{1}-x_{2}\\right)\\left(x_{3}-x_{4}\\right)-\\left(a_{1}-a_{2}\\right)^{2}-\\left(a_{3}-a_{4}\\right)^{2}+\\left(a_{5}-a_{6}\\right)^{2}+\\left(a_{7}-a_{8}\\right)^{2}=0\n\\]\nand hence \\(P\\left(x_{1}, \\ldots, x_{10}\\right)=0\\).\nSince every polynomial that evaluates to zero everywhere is the zero polynomial, and the product of two nonzero polynomials is necessarily nonzero, we may define \\(F\\) such that\n\\[\nF\\left(x_{1}, \\ldots, x_{10}\\right) \\equiv q\\left(x_{1}-x_{2}\\right)\\left(x_{3}-x_{4}\\right)-\\left(a_{1}-a_{2}\\right)^{2}-\\left(a_{3}-a_{4}\\right)^{2}+\\left(a_{5}-a_{6}\\right)^{2}+\\left(a_{7}-a_{8}\\right)^{2} \\equiv 0\n\\]\nfor some particular choice \\(a_{i} \\in S\\).\nEach of the sets \\(\\left\\{a_{1}, a_{2}\\right\\},\\left\\{a_{3}, a_{4}\\right\\},\\left\\{a_{5}, a_{6}\\right\\}\\), and \\(\\left\\{a_{7}, a_{8}\\right\\}\\) is equal to at most one of the four sets \\(\\left\\{x_{1}, x_{3}\\right\\},\\left\\{x_{2}, x_{3}\\right\\},\\left\\{x_{1}, x_{4}\\right\\}\\), and \\(\\left\\{x_{2}, x_{4}\\right\\}\\). Thus, without loss of generality, we may assume that at most one of the sets \\(\\left\\{a_{1}, a_{2}\\right\\},\\left\\{a_{3}, a_{4}\\right\\},\\left\\{a_{5}, a_{6}\\right\\}\\), and \\(\\left\\{a_{7}, a_{8}\\right\\}\\) is equal to \\(\\left\\{x_{1}, x_{3}\\right\\}\\). Let \\(u_{1}, u_{3}, u_{5}, u_{7}\\) be the indicator functions for this equality of sets: that is, \\(u_{i}=1\\) if and only if \\(\\left\\{a_{i}, a_{i+1}\\right\\}=\\left\\{x_{1}, x_{3}\\right\\}\\). By assumption, at least three of the \\(u_{i}\\) are equal to 0 .\n\nWe now compute the coefficient of \\(x_{1} x_{3}\\) in \\(F\\). It is equal to \\(q+2\\left(u_{1}+u_{3}-u_{5}-u_{7}\\right)=0\\), and since at least three of the \\(u_{i}\\) are zero, we must have that \\(q \\in\\{-2,0,2\\}\\), as desired.", "source_pdf": "imosl_2017.pdf", "notes": "fallback-regex"}
{"id": "IMOSL-2017-A3", "contest": "IMOSL", "year": "2017", "problem_number": "A3", "problem": "Let \\(S\\) be a finite set, and let \\(\\mathcal{A}\\) be the set of all functions from \\(S\\) to \\(S\\). Let \\(f\\) be an element of \\(\\mathcal{A}\\), and let \\(T=f(S)\\) be the image of \\(S\\) under \\(f\\). Suppose that \\(f \\circ g \\circ f \\neq g \\circ f \\circ g\\) for every \\(g\\) in \\(\\mathcal{A}\\) with \\(g \\neq f\\). Show that \\(f(T)=T\\).\n(India)", "solution": ". For \\(n \\geqslant 1\\), denote the \\(n\\)-th composition of \\(f\\) with itself by\n\\[\nf^{n} \\stackrel{\\text { def }}{=} \\underbrace{f \\circ f \\circ \\cdots \\circ f}_{n \\text { times }}\n\\]\n\nBy hypothesis, if \\(g \\in \\mathcal{A}\\) satisfies \\(f \\circ g \\circ f=g \\circ f \\circ g\\), then \\(g=f\\). A natural idea is to try to plug in \\(g=f^{n}\\) for some \\(n\\) in the expression \\(f \\circ g \\circ f=g \\circ f \\circ g\\) in order to get \\(f^{n}=f\\), which solves the problem:\nClaim. If there exists \\(n \\geqslant 3\\) such that \\(f^{n+2}=f^{2 n+1}\\), then the restriction \\(f: T \\rightarrow T\\) of \\(f\\) to \\(T\\) is a bijection.\nProof. Indeed, by hypothesis, \\(f^{n+2}=f^{2 n+1} \\Longleftrightarrow f \\circ f^{n} \\circ f=f^{n} \\circ f \\circ f^{n} \\Longrightarrow f^{n}=f\\). Since \\(n-2 \\geqslant 1\\), the image of \\(f^{n-2}\\) is contained in \\(T=f(S)\\), hence \\(f^{n-2}\\) restricts to a function \\(f^{n-2}: T \\rightarrow T\\). This is the inverse of \\(f: T \\rightarrow T\\). In fact, given \\(t \\in T\\), say \\(t=f(s)\\) with \\(s \\in S\\), we have\n\\[\nt=f(s)=f^{n}(s)=f^{n-2}(f(t))=f\\left(f^{n-2}(t)\\right), \\quad \\text { i.e., } \\quad f^{n-2} \\circ f=f \\circ f^{n-2}=\\operatorname{id} \\text { on } T\n\\]\n(here id stands for the identity function). Hence, the restriction \\(f: T \\rightarrow T\\) of \\(f\\) to \\(T\\) is bijective with inverse given by \\(f^{n-2}: T \\rightarrow T\\).\n\nIt remains to show that \\(n\\) as in the claim exists. For that, define\n\\[\nS_{m} \\stackrel{\\text { def }}{=} f^{m}(S) \\quad\\left(S_{m} \\text { is image of } f^{m}\\right)\n\\]\n\nClearly the image of \\(f^{m+1}\\) is contained in the image of \\(f^{m}\\), i.e., there is a descending chain of subsets of \\(S\\)\n\\[\nS \\supseteq S_{1} \\supseteq S_{2} \\supseteq S_{3} \\supseteq S_{4} \\supseteq \\cdots\n\\]\nwhich must eventually stabilise since \\(S\\) is finite, i.e., there is a \\(k \\geqslant 1\\) such that\n\\[\nS_{k}=S_{k+1}=S_{k+2}=S_{k+3}=\\cdots \\stackrel{\\text { def }}{=} S_{\\infty}\n\\]\n\nHence \\(f\\) restricts to a surjective function \\(f: S_{\\infty} \\rightarrow S_{\\infty}\\), which is also bijective since \\(S_{\\infty} \\subseteq S\\) is finite. To sum up, \\(f: S_{\\infty} \\rightarrow S_{\\infty}\\) is a permutation of the elements of the finite set \\(S_{\\infty}\\), hence there exists an integer \\(r \\geqslant 1\\) such that \\(f^{r}=\\mathrm{id}\\) on \\(S_{\\infty}\\) (for example, we may choose \\(r=\\left|S_{\\infty}\\right|!\\) ). In other words,\n\\[\nf^{m+r}=f^{m} \\text { on } S \\text { for all } m \\geqslant k .\n\\]\n\nClearly, (*) also implies that \\(f^{m+t r}=f^{m}\\) for all integers \\(t \\geqslant 1\\) and \\(m \\geqslant k\\). So, to find \\(n\\) as in the claim and finish the problem, it is enough to choose \\(m\\) and \\(t\\) in order to ensure that there exists \\(n \\geqslant 3\\) satisfying\n\\[\n\\left\\{\\begin{array} { l } \n{ 2 n + 1 = m + t r } \\\\\n{ n + 2 = m }\n\\end{array} \\Longleftrightarrow \\left\\{\\begin{array}{l}\nm=3+t r \\\\\nn=m-2\n\\end{array}\\right.\\right.\n\\]\n\nThis can be clearly done by choosing \\(m\\) large enough with \\(m \\equiv 3(\\bmod r)\\). For instance, we may take \\(n=2 k r+1\\), so that\n\\[\nf^{n+2}=f^{2 k r+3}=f^{4 k r+3}=f^{2 n+1}\n\\]\nwhere the middle equality follows by (*) since \\(2 k r+3 \\geqslant k\\).", "source_pdf": "imosl_2017.pdf", "notes": "fallback-regex"}
{"id": "IMOSL-2017-A4", "contest": "IMOSL", "year": "2017", "problem_number": "A4", "problem": "A sequence of real numbers \\(a_{1}, a_{2}, \\ldots\\) satisfies the relation\n\\[\na_{n}=-\\max _{i+j=n}\\left(a_{i}+a_{j}\\right) \\quad \\text { for all } n>2017 .\n\\]\n\nProve that this sequence is bounded, i.e., there is a constant \\(M\\) such that \\(\\left|a_{n}\\right| \\leqslant M\\) for all positive integers \\(n\\).\n(Russia)", "solution": "1. Set \\(D=2017\\). Denote\n\\[\nM_{n}=\\max _{k<n} a_{k} \\quad \\text { and } \\quad m_{n}=-\\min _{k<n} a_{k}=\\max _{k<n}\\left(-a_{k}\\right) .\n\\]\n\nClearly, the sequences ( \\(m_{n}\\) ) and ( \\(M_{n}\\) ) are nondecreasing. We need to prove that both are bounded.\n\nConsider an arbitrary \\(n>D\\); our first aim is to bound \\(a_{n}\\) in terms of \\(m_{n}\\) and \\(M_{n}\\).\n(i) There exist indices \\(p\\) and \\(q\\) such that \\(a_{n}=-\\left(a_{p}+a_{q}\\right)\\) and \\(p+q=n\\). Since \\(a_{p}, a_{q} \\leqslant M_{n}\\), we have \\(a_{n} \\geqslant-2 M_{n}\\).\n(ii) On the other hand, choose an index \\(k<n\\) such that \\(a_{k}=M_{n}\\). Then, we have\n\\[\na_{n}=-\\max _{\\ell<n}\\left(a_{n-\\ell}+a_{\\ell}\\right) \\leqslant-\\left(a_{n-k}+a_{k}\\right)=-a_{n-k}-M_{n} \\leqslant m_{n}-M_{n} .\n\\]\n\nSummarizing (i) and (ii), we get\n\\[\n-2 M_{n} \\leqslant a_{n} \\leqslant m_{n}-M_{n},\n\\]\nwhence\n\\[\nm_{n} \\leqslant m_{n+1} \\leqslant \\max \\left\\{m_{n}, 2 M_{n}\\right\\} \\quad \\text { and } \\quad M_{n} \\leqslant M_{n+1} \\leqslant \\max \\left\\{M_{n}, m_{n}-M_{n}\\right\\} .\n\\]\n\nNow, say that an index \\(n>D\\) is lucky if \\(m_{n} \\leqslant 2 M_{n}\\). Two cases are possible.\nCase 1. Assume that there exists a lucky index \\(n\\). In this case, (1) yields \\(m_{n+1} \\leqslant 2 M_{n}\\) and \\(M_{n} \\leqslant M_{n+1} \\leqslant M_{n}\\). Therefore, \\(M_{n+1}=M_{n}\\) and \\(m_{n+1} \\leqslant 2 M_{n}=2 M_{n+1}\\). So, the index \\(n+1\\) is also lucky, and \\(M_{n+1}=M_{n}\\). Applying the same arguments repeatedly, we obtain that all indices \\(k>n\\) are lucky (i.e., \\(m_{k} \\leqslant 2 M_{k}\\) for all these indices), and \\(M_{k}=M_{n}\\) for all such indices. Thus, all of the \\(m_{k}\\) and \\(M_{k}\\) are bounded by \\(2 M_{n}\\).\nCase 2. Assume now that there is no lucky index, i.e., \\(2 M_{n}<m_{n}\\) for all \\(n>D\\). Then (1) shows that for all \\(n>D\\) we have \\(m_{n} \\leqslant m_{n+1} \\leqslant m_{n}\\), so \\(m_{n}=m_{D+1}\\) for all \\(n>D\\). Since \\(M_{n}<m_{n} / 2\\) for all such indices, all of the \\(m_{n}\\) and \\(M_{n}\\) are bounded by \\(m_{D+1}\\).\n\nThus, in both cases the sequences ( \\(m_{n}\\) ) and ( \\(M_{n}\\) ) are bounded, as desired.\nSolution 2. As in the previous solution, let \\(D=2017\\). If the sequence is bounded above, say, by \\(Q\\), then we have that \\(a_{n} \\geqslant \\min \\left\\{a_{1}, \\ldots, a_{D},-2 Q\\right\\}\\) for all \\(n\\), so the sequence is bounded. Assume for sake of contradiction that the sequence is not bounded above. Let \\(\\ell=\\min \\left\\{a_{1}, \\ldots, a_{D}\\right\\}\\), and \\(L=\\max \\left\\{a_{1}, \\ldots, a_{D}\\right\\}\\). Call an index \\(n\\) good if the following criteria hold:\n\\[\na_{n}>a_{i} \\text { for each } i<n, \\quad a_{n}>-2 \\ell, \\quad \\text { and } \\quad n>D\n\\]\n\nWe first show that there must be some good index \\(n\\). By assumption, we may take an index \\(N\\) such that \\(a_{N}>\\max \\{L,-2 \\ell\\}\\). Choose \\(n\\) minimally such that \\(a_{n}=\\max \\left\\{a_{1}, a_{2}, \\ldots, a_{N}\\right\\}\\). Now, the first condition in (2) is satisfied because of the minimality of \\(n\\), and the second and third conditions are satisfied because \\(a_{n} \\geqslant a_{N}>L,-2 \\ell\\), and \\(L \\geqslant a_{i}\\) for every \\(i\\) such that \\(1 \\leqslant i \\leqslant D\\).\n\nLet \\(n\\) be a good index. We derive a contradiction. We have that\n\\[\na_{n}+a_{u}+a_{v} \\leqslant 0\n\\]\nwhenever \\(u+v=n\\).\nWe define the index \\(u\\) to maximize \\(a_{u}\\) over \\(1 \\leqslant u \\leqslant n-1\\), and let \\(v=n-u\\). Then, we note that \\(a_{u} \\geqslant a_{v}\\) by the maximality of \\(a_{u}\\).\n\nAssume first that \\(v \\leqslant D\\). Then, we have that\n\\[\na_{N}+2 \\ell \\leqslant 0\n\\]\nbecause \\(a_{u} \\geqslant a_{v} \\geqslant \\ell\\). But this contradicts our assumption that \\(a_{n}>-2 \\ell\\) in the second criteria of (2).\n\nNow assume that \\(v>D\\). Then, there exist some indices \\(w_{1}, w_{2}\\) summing up to \\(v\\) such that\n\\[\na_{v}+a_{w_{1}}+a_{w_{2}}=0\n\\]\n\nBut combining this with (3), we have\n\\[\na_{n}+a_{u} \\leqslant a_{w_{1}}+a_{w_{2}}\n\\]\n\nBecause \\(a_{n}>a_{u}\\), we have that \\(\\max \\left\\{a_{w_{1}}, a_{w_{2}}\\right\\}>a_{u}\\). But since each of the \\(w_{i}\\) is less than \\(v\\), this contradicts the maximality of \\(a_{u}\\).\n\nComment 1. We present two harder versions of this problem below.\nVersion 1. Let \\(a_{1}, a_{2}, \\ldots\\) be a sequence of numbers that satisfies the relation\n\\[\na_{n}=-\\max _{i+j+k=n}\\left(a_{i}+a_{j}+a_{k}\\right) \\quad \\text { for all } n>2017 .\n\\]\n\nThen, this sequence is bounded.\nProof. Set \\(D=2017\\). Denote\n\\[\nM_{n}=\\max _{k<n} a_{k} \\quad \\text { and } \\quad m_{n}=-\\min _{k<n} a_{k}=\\max _{k<n}\\left(-a_{k}\\right) .\n\\]\n\nClearly, the sequences ( \\(m_{n}\\) ) and ( \\(M_{n}\\) ) are nondecreasing. We need to prove that both are bounded.\nConsider an arbitrary \\(n>2 D\\); our first aim is to bound \\(a_{n}\\) in terms of \\(m_{i}\\) and \\(M_{i}\\). Set \\(k=\\lfloor n / 2\\rfloor\\).\n(i) Choose indices \\(p, q\\), and \\(r\\) such that \\(a_{n}=-\\left(a_{p}+a_{q}+a_{r}\\right)\\) and \\(p+q+r=n\\). Without loss of generality, \\(p \\geqslant q \\geqslant r\\).\n\nAssume that \\(p \\geqslant k+1(>D)\\); then \\(p>q+r\\). Hence\n\\[\n-a_{p}=\\max _{i_{1}+i_{2}+i_{3}=p}\\left(a_{i_{1}}+a_{i_{2}}+a_{i_{3}}\\right) \\geqslant a_{q}+a_{r}+a_{p-q-r}\n\\]\nand therefore \\(a_{n}=-\\left(a_{p}+a_{q}+a_{r}\\right) \\geqslant\\left(a_{q}+a_{r}+a_{p-q-r}\\right)-a_{q}-a_{r}=a_{p-q-r} \\geqslant-m_{n}\\).\nOtherwise, we have \\(k \\geqslant p \\geqslant q \\geqslant r\\). Since \\(n<3 k\\), we have \\(r<k\\). Then \\(a_{p}, a_{q} \\leqslant M_{k+1}\\) and \\(a_{r} \\leqslant M_{k}\\), whence \\(a_{n} \\geqslant-2 M_{k+1}-M_{k}\\).\n\nThus, in any case \\(a_{n} \\geqslant-\\max \\left\\{m_{n}, 2 M_{k+1}+M_{k}\\right\\}\\).\n(ii) On the other hand, choose \\(p \\leqslant k\\) and \\(q \\leqslant k-1\\) such that \\(a_{p}=M_{k+1}\\) and \\(a_{q}=M_{k}\\). Then \\(p+q<n\\), so \\(a_{n} \\leqslant-\\left(a_{p}+a_{q}+a_{n-p-q}\\right)=-a_{n-p-q}-M_{k+1}-M_{k} \\leqslant m_{n}-M_{k+1}-M_{k}\\).\n\nTo summarize,\n\\[\n-\\max \\left\\{m_{n}, 2 M_{k+1}+M_{k}\\right\\} \\leqslant a_{n} \\leqslant m_{n}-M_{k+1}-M_{k},\n\\]\nwhence\n\\[\nm_{n} \\leqslant m_{n+1} \\leqslant \\max \\left\\{m_{n}, 2 M_{k+1}+M_{k}\\right\\} \\quad \\text { and } \\quad M_{n} \\leqslant M_{n+1} \\leqslant \\max \\left\\{M_{n}, m_{n}-M_{k+1}-M_{k}\\right\\}\n\\]\n\nNow, say that an index \\(n>2 D\\) is lucky if \\(m_{n} \\leqslant 2 M_{\\lfloor n / 2\\rfloor+1}+M_{\\lfloor n / 2\\rfloor}\\). Two cases are possible.\nCase 1. Assume that there exists a lucky index \\(n\\); set \\(k=\\lfloor n / 2\\rfloor\\). In this case, (4) yields \\(m_{n+1} \\leqslant 2 M_{k+1}+M_{k}\\) and \\(M_{n} \\leqslant M_{n+1} \\leqslant M_{n}\\) (the last relation holds, since \\(m_{n}-M_{k+1}-M_{k} \\leqslant\\left(2 M_{k+1}+\\right. \\left.M_{k}\\right)-M_{k+1}-M_{k}=M_{k+1} \\leqslant M_{n}\\) ). Therefore, \\(M_{n+1}=M_{n}\\) and \\(m_{n+1} \\leqslant 2 M_{k+1}+M_{k}\\); the last relation shows that the index \\(n+1\\) is also lucky.\n\nThus, all indices \\(N>n\\) are lucky, and \\(M_{N}=M_{n} \\geqslant m_{N} / 3\\), whence all the \\(m_{N}\\) and \\(M_{N}\\) are bounded by \\(3 M_{n}\\).\nCase 2. Conversely, assume that there is no lucky index, i.e., \\(2 M_{\\lfloor n / 2\\rfloor+1}+M_{\\lfloor n / 2\\rfloor}<m_{n}\\) for all \\(n>2 D\\). Then (4) shows that for all \\(n>2 D\\) we have \\(m_{n} \\leqslant m_{n+1} \\leqslant m_{n}\\), i.e., \\(m_{N}=m_{2 D+1}\\) for all \\(N>2 D\\). Since \\(M_{N}<m_{2 N+1} / 3\\) for all such indices, all the \\(m_{N}\\) and \\(M_{N}\\) are bounded by \\(m_{2 D+1}\\).\n\nThus, in both cases the sequences \\(\\left(m_{n}\\right)\\) and \\(\\left(M_{n}\\right)\\) are bounded, as desired.\nVersion 2. Let \\(a_{1}, a_{2}, \\ldots\\) be a sequence of numbers that satisfies the relation\n\\[\na_{n}=-\\max _{i_{1}+\\cdots+i_{k}=n}\\left(a_{i_{1}}+\\cdots+a_{i_{k}}\\right) \\quad \\text { for all } n>2017 .\n\\]\n\nThen, this sequence is bounded.\nProof. As in the solutions above, let \\(D=2017\\). If the sequence is bounded above, say, by \\(Q\\), then we have that \\(a_{n} \\geqslant \\min \\left\\{a_{1}, \\ldots, a_{D},-k Q\\right\\}\\) for all \\(n\\), so the sequence is bounded. Assume for sake of contradiction that the sequence is not bounded above. Let \\(\\ell=\\min \\left\\{a_{1}, \\ldots, a_{D}\\right\\}\\), and \\(L=\\max \\left\\{a_{1}, \\ldots, a_{D}\\right\\}\\). Call an index \\(n\\) good if the following criteria hold:\n\\[\na_{n}>a_{i} \\text { for each } i<n, \\quad a_{n}>-k \\ell, \\quad \\text { and } \\quad n>D\n\\]\n\nWe first show that there must be some good index \\(n\\). By assumption, we may take an index \\(N\\) such that \\(a_{N}>\\max \\{L,-k \\ell\\}\\). Choose \\(n\\) minimally such that \\(a_{n}=\\max \\left\\{a_{1}, a_{2}, \\ldots, a_{N}\\right\\}\\). Now, the first condition is satisfied because of the minimality of \\(n\\), and the second and third conditions are satisfied because \\(a_{n} \\geqslant a_{N}>L,-k \\ell\\), and \\(L \\geqslant a_{i}\\) for every \\(i\\) such that \\(1 \\leqslant i \\leqslant D\\).\n\nLet \\(n\\) be a good index. We derive a contradiction. We have that\n\\[\na_{n}+a_{v_{1}}+\\cdots+a_{v_{k}} \\leqslant 0\n\\]\nwhenever \\(v_{1}+\\cdots+v_{k}=n\\).\nWe define the sequence of indices \\(v_{1}, \\ldots, v_{k-1}\\) to greedily maximize \\(a_{v_{1}}\\), then \\(a_{v_{2}}\\), and so forth, selecting only from indices such that the equation \\(v_{1}+\\cdots+v_{k}=n\\) can be satisfied by positive integers \\(v_{1}, \\ldots, v_{k}\\). More formally, we define them inductively so that the following criteria are satisfied by the \\(v_{i}\\) :\n1. \\(1 \\leqslant v_{i} \\leqslant n-(k-i)-\\left(v_{1}+\\cdots+v_{i-1}\\right)\\).\n2. \\(a_{v_{i}}\\) is maximal among all choices of \\(v_{i}\\) from the first criteria.\n\nFirst of all, we note that for each \\(i\\), the first criteria is always satisfiable by some \\(v_{i}\\), because we are guaranteed that\n\\[\nv_{i-1} \\leqslant n-(k-(i-1))-\\left(v_{1}+\\cdots+v_{i-2}\\right)\n\\]\nwhich implies\n\\[\n1 \\leqslant n-(k-i)-\\left(v_{1}+\\cdots+v_{i-1}\\right)\n\\]\n\nSecondly, the sum \\(v_{1}+\\cdots+v_{k-1}\\) is at most \\(n-1\\). Define \\(v_{k}=n-\\left(v_{1}+\\cdots+v_{k-1}\\right)\\). Then, (6) is satisfied by the \\(v_{i}\\). We also note that \\(a_{v_{i}} \\geqslant a_{v_{j}}\\) for all \\(i<j\\); otherwise, in the definition of \\(v_{i}\\), we could have selected \\(v_{j}\\) instead.\n\nAssume first that \\(v_{k} \\leqslant D\\). Then, from (6), we have that\n\\[\na_{n}+k \\ell \\leqslant 0\n\\]\nby using that \\(a_{v_{1}} \\geqslant \\cdots \\geqslant a_{v_{k}} \\geqslant \\ell\\). But this contradicts our assumption that \\(a_{n}>-k \\ell\\) in the second criteria of (5).\n\nNow assume that \\(v_{k}>D\\), and then we must have some indices \\(w_{1}, \\ldots, w_{k}\\) summing up to \\(v_{k}\\) such that\n\\[\na_{v_{k}}+a_{w_{1}}+\\cdots+a_{w_{k}}=0\n\\]\n\nBut combining this with (6), we have\n\\[\na_{n}+a_{v_{1}}+\\cdots+a_{v_{k-1}} \\leqslant a_{w_{1}}+\\cdots+a_{w_{k}}\n\\]\n\nBecause \\(a_{n}>a_{v_{1}} \\geqslant \\cdots \\geqslant a_{v_{k-1}}\\), we have that \\(\\max \\left\\{a_{w_{1}}, \\ldots, a_{w_{k}}\\right\\}>a_{v_{k-1}}\\). But since each of the \\(w_{i}\\) is less than \\(v_{k}\\), in the definition of the \\(v_{k-1}\\) we could have chosen one of the \\(w_{i}\\) instead, which is a contradiction.\n\nComment 2. It seems that each sequence satisfying the condition in Version 2 is eventually periodic, at least when its terms are integers.\n\nHowever, up to this moment, the Problem Selection Committee is not aware of a proof for this fact (even in the case \\(k=2\\) ).", "source_pdf": "imosl_2017.pdf", "notes": "fallback-regex"}
{"id": "IMOSL-2017-A5", "contest": "IMOSL", "year": "2017", "problem_number": "A5", "problem": "An integer \\(n \\geqslant 3\\) is given. We call an \\(n\\)-tuple of real numbers \\(\\left(x_{1}, x_{2}, \\ldots, x_{n}\\right)\\) Shiny if for each permutation \\(y_{1}, y_{2}, \\ldots, y_{n}\\) of these numbers we have\n\\[\n\\sum_{i=1}^{n-1} y_{i} y_{i+1}=y_{1} y_{2}+y_{2} y_{3}+y_{3} y_{4}+\\cdots+y_{n-1} y_{n} \\geqslant-1\n\\]\n\nFind the largest constant \\(K=K(n)\\) such that\n\\[\n\\sum_{1 \\leqslant i<j \\leqslant n} x_{i} x_{j} \\geqslant K\n\\]\nholds for every Shiny \\(n\\)-tuple \\(\\left(x_{1}, x_{2}, \\ldots, x_{n}\\right)\\).\n(Serbia)", "solution": "Answer: \\(K=-(n-1) / 2\\).\n\n1. First of all, we show that we may not take a larger constant \\(K\\). Let \\(t\\) be a positive number, and take \\(x_{2}=x_{3}=\\cdots=t\\) and \\(x_{1}=-1 /(2 t)\\). Then, every product \\(x_{i} x_{j}(i \\neq j)\\) is equal to either \\(t^{2}\\) or \\(-1 / 2\\). Hence, for every permutation \\(y_{i}\\) of the \\(x_{i}\\), we have\n\\[\ny_{1} y_{2}+\\cdots+y_{n-1} y_{n} \\geqslant(n-3) t^{2}-1 \\geqslant-1 .\n\\]\n\nThis justifies that the \\(n\\)-tuple \\(\\left(x_{1}, \\ldots, x_{n}\\right)\\) is Shiny. Now, we have\n\\[\n\\sum_{i<j} x_{i} x_{j}=-\\frac{n-1}{2}+\\frac{(n-1)(n-2)}{2} t^{2} .\n\\]\n\nThus, as \\(t\\) approaches 0 from above, \\(\\sum_{i<j} x_{i} x_{j}\\) gets arbitrarily close to \\(-(n-1) / 2\\). This shows that we may not take \\(K\\) any larger than \\(-(n-1) / 2\\). It remains to show that \\(\\sum_{i<j} x_{i} x_{j} \\geqslant -(n-1) / 2\\) for any Shiny choice of the \\(x_{i}\\).\n\nFrom now onward, assume that \\(\\left(x_{1}, \\ldots, x_{n}\\right)\\) is a Shiny \\(n\\)-tuple. Let the \\(z_{i}(1 \\leqslant i \\leqslant n)\\) be some permutation of the \\(x_{i}\\) to be chosen later. The indices for \\(z_{i}\\) will always be taken modulo \\(n\\). We will first split up the sum \\(\\sum_{i<j} x_{i} x_{j}=\\sum_{i<j} z_{i} z_{j}\\) into \\(\\lfloor(n-1) / 2\\rfloor\\) expressions, each of the form \\(y_{1} y_{2}+\\cdots+y_{n-1} y_{n}\\) for some permutation \\(y_{i}\\) of the \\(z_{i}\\), and some leftover terms. More specifically, write\n\\[\n\\sum_{i<j} z_{i} z_{j}=\\sum_{q=0}^{n-1} \\sum_{\\substack{i+j \\equiv q \\\\ i \\neq j}} z_{i} z_{j}=\\sum_{p=1}^{\\left\\lfloor\\frac{n-1}{2}\\right\\rfloor} \\sum_{\\substack{i+j=2 p-1,2 p(\\bmod n) \\\\ i \\neq j(\\bmod n)}} z_{i} z_{j}+L\n\\]\nwhere \\(L=z_{1} z_{-1}+z_{2} z_{-2}+\\cdots+z_{(n-1) / 2} z_{-(n-1) / 2}\\) if \\(n\\) is odd, and \\(L=z_{1} z_{-1}+z_{1} z_{-2}+z_{2} z_{-2}+ \\cdots+z_{(n-2) / 2} z_{-n / 2}\\) if \\(n\\) is even. We note that for each \\(p=1,2, \\ldots,\\lfloor(n-1) / 2\\rfloor\\), there is some permutation \\(y_{i}\\) of the \\(z_{i}\\) such that\n\\[\n\\sum_{\\substack{i+j \\equiv 2 p-1,2 p \\\\ i \\neq j(\\bmod n)}} z_{i} z_{j}=\\sum_{k=1}^{n-1} y_{k} y_{k+1}\n\\]\nbecause we may choose \\(y_{2 i-1}=z_{i+p-1}\\) for \\(1 \\leqslant i \\leqslant(n+1) / 2\\) and \\(y_{2 i}=z_{p-i}\\) for \\(1 \\leqslant i \\leqslant n / 2\\).\nWe show (1) graphically for \\(n=6,7\\) in the diagrams below. The edges of the graphs each represent a product \\(z_{i} z_{j}\\), and the dashed and dotted series of lines represents the sum of the edges, which is of the form \\(y_{1} y_{2}+\\cdots+y_{n-1} y_{n}\\) for some permutation \\(y_{i}\\) of the \\(z_{i}\\) precisely when the series of lines is a Hamiltonian path. The filled edges represent the summands of \\(L\\).\n![](https://cdn.mathpix.com/cropped/2025_08_23_4b06fd0385d65a4d803fg-24.jpg?height=783&width=1657&top_left_y=191&top_left_x=191)\n\nNow, because the \\(z_{i}\\) are Shiny, we have that (1) yields the following bound:\n\\[\n\\sum_{i<j} z_{i} z_{j} \\geqslant-\\left\\lfloor\\frac{n-1}{2}\\right\\rfloor+L\n\\]\n\nIt remains to show that, for each \\(n\\), there exists some permutation \\(z_{i}\\) of the \\(x_{i}\\) such that \\(L \\geqslant 0\\) when \\(n\\) is odd, and \\(L \\geqslant-1 / 2\\) when \\(n\\) is even. We now split into cases based on the parity of \\(n\\) and provide constructions of the permutations \\(z_{i}\\).\n\nSince we have not made any assumptions yet about the \\(x_{i}\\), we may now assume without loss of generality that\n\\[\nx_{1} \\leqslant x_{2} \\leqslant \\cdots \\leqslant x_{k} \\leqslant 0 \\leqslant x_{k+1} \\leqslant \\cdots \\leqslant x_{n}\n\\]\n\n\\section*{Case 1: \\(n\\) is odd.}\n\nWithout loss of generality, assume that \\(k\\) (from (2)) is even, because we may negate all the \\(x_{i}\\) if \\(k\\) is odd. We then have \\(x_{1} x_{2}, x_{3} x_{4}, \\ldots, x_{n-2} x_{n-1} \\geqslant 0\\) because the factors are of the same sign. Let \\(L=x_{1} x_{2}+x_{3} x_{4}+\\cdots+x_{n-2} x_{n-1} \\geqslant 0\\). We choose our \\(z_{i}\\) so that this definition of \\(L\\) agrees with the sum of the leftover terms in (1). Relabel the \\(x_{i}\\) as \\(z_{i}\\) such that\n\\[\n\\left\\{z_{1}, z_{n-1}\\right\\},\\left\\{z_{2}, z_{n-2}\\right\\}, \\ldots,\\left\\{z_{(n-1) / 2}, z_{(n+1) / 2}\\right\\}\n\\]\nare some permutation of\n\\[\n\\left\\{x_{1}, x_{2}\\right\\},\\left\\{x_{3}, x_{4}\\right\\}, \\ldots,\\left\\{x_{n-2}, x_{n-1}\\right\\}\n\\]\nand \\(z_{n}=x_{n}\\). Then, we have \\(L=z_{1} z_{n-1}+\\cdots+z_{(n-1) / 2} z_{(n+1) / 2}\\), as desired.\nCase 2: \\(n\\) is even.\nLet \\(L=x_{1} x_{2}+x_{2} x_{3}+\\cdots+x_{n-1} x_{n}\\). Assume without loss of generality \\(k \\neq 1\\). Now, we have\n\\[\n\\begin{gathered}\n2 L=\\left(x_{1} x_{2}+\\cdots+x_{n-1} x_{n}\\right)+\\left(x_{1} x_{2}+\\cdots+x_{n-1} x_{n}\\right) \\geqslant\\left(x_{2} x_{3}+\\cdots+x_{n-1} x_{n}\\right)+x_{k} x_{k+1} \\\\\n\\geqslant x_{2} x_{3}+\\cdots+x_{n-1} x_{n}+x_{n} x_{1} \\geqslant-1\n\\end{gathered}\n\\]\nwhere the first inequality holds because the only negative term in \\(L\\) is \\(x_{k} x_{k+1}\\), the second inequality holds because \\(x_{1} \\leqslant x_{k} \\leqslant 0 \\leqslant x_{k+1} \\leqslant x_{n}\\), and the third inequality holds because the \\(x_{i}\\) are assumed to be Shiny. We thus have that \\(L \\geqslant-1 / 2\\). We now choose a suitable \\(z_{i}\\) such that the definition of \\(L\\) matches the leftover terms in (1).\n\nRelabel the \\(x_{i}\\) with \\(z_{i}\\) in the following manner: \\(x_{2 i-1}=z_{-i}, x_{2 i}=z_{i}\\) (again taking indices \\(\\operatorname{modulo} n)\\). We have that\n\\[\nL=\\sum_{\\substack{i+j \\equiv 0,-1(\\bmod n) \\\\ i \\neq j(\\bmod n)}} z_{i} z_{j}\n\\]\nas desired.\nSolution 2. We present another proof that \\(\\sum_{i<j} x_{i} x_{j} \\geqslant-(n-1) / 2\\) for any Shiny \\(n\\)-tuple \\(\\left(x_{1}, \\ldots, x_{n}\\right)\\). Assume an ordering of the \\(x_{i}\\) as in (2), and let \\(\\ell=n-k\\). Assume without loss of generality that \\(k \\geqslant \\ell\\). Also assume \\(k \\neq n\\), (as otherwise, all of the \\(x_{i}\\) are nonpositive, and so the inequality is trivial). Define the sets of indices \\(S=\\{1,2, \\ldots, k\\}\\) and \\(T=\\{k+1, \\ldots, n\\}\\). Define the following sums:\n\\[\nK=\\sum_{\\substack{i<j \\\\ i, j \\in S}} x_{i} x_{j}, \\quad M=\\sum_{\\substack{i \\in S \\\\ j \\in T}} x_{i} x_{j}, \\quad \\text { and } \\quad L=\\sum_{\\substack{i<j \\\\ i, j \\in T}} x_{i} x_{j}\n\\]\n\nBy definition, \\(K, L \\geqslant 0\\) and \\(M \\leqslant 0\\). We aim to show that \\(K+L+M \\geqslant-(n-1) / 2\\).\nWe split into cases based on whether \\(k=\\ell\\) or \\(k>\\ell\\).\nCase 1: \\(k>\\ell\\).\nConsider all permutations \\(\\phi:\\{1,2, \\ldots, n\\} \\rightarrow\\{1,2, \\ldots, n\\}\\) such that \\(\\phi^{-1}(T)=\\{2,4, \\ldots, 2 \\ell\\}\\). Note that there are \\(k!\\ell!\\) such permutations \\(\\phi\\). Define\n\\[\nf(\\phi)=\\sum_{i=1}^{n-1} x_{\\phi(i)} x_{\\phi(i+1)}\n\\]\n\nWe know that \\(f(\\phi) \\geqslant-1\\) for every permutation \\(\\phi\\) with the above property. Averaging \\(f(\\phi)\\) over all \\(\\phi\\) gives\n\\[\n-1 \\leqslant \\frac{1}{k!\\ell!} \\sum_{\\phi} f(\\phi)=\\frac{2 \\ell}{k \\ell} M+\\frac{2(k-\\ell-1)}{k(k-1)} K\n\\]\nwhere the equality holds because there are \\(k \\ell\\) products in \\(M\\), of which \\(2 \\ell\\) are selected for each \\(\\phi\\), and there are \\(k(k-1) / 2\\) products in \\(K\\), of which \\(k-\\ell-1\\) are selected for each \\(\\phi\\). We now have\n\\[\nK+L+M \\geqslant K+L+\\left(-\\frac{k}{2}-\\frac{k-\\ell-1}{k-1} K\\right)=-\\frac{k}{2}+\\frac{\\ell}{k-1} K+L\n\\]\n\nSince \\(k \\leqslant n-1\\) and \\(K, L \\geqslant 0\\), we get the desired inequality.\nCase 2: \\(k=\\ell=n / 2\\).\nWe do a similar approach, considering all \\(\\phi:\\{1,2, \\ldots, n\\} \\rightarrow\\{1,2, \\ldots, n\\}\\) such that \\(\\phi^{-1}(T)= \\{2,4, \\ldots, 2 \\ell\\}\\), and defining \\(f\\) the same way. Analogously to Case 1, we have\n\\[\n-1 \\leqslant \\frac{1}{k!\\ell!} \\sum_{\\phi} f(\\phi)=\\frac{2 \\ell-1}{k \\ell} M\n\\]\nbecause there are \\(k \\ell\\) products in \\(M\\), of which \\(2 \\ell-1\\) are selected for each \\(\\phi\\). Now, we have that\n\\[\nK+L+M \\geqslant M \\geqslant-\\frac{n^{2}}{4(n-1)} \\geqslant-\\frac{n-1}{2}\n\\]\nwhere the last inequality holds because \\(n \\geqslant 4\\).", "source_pdf": "imosl_2017.pdf", "notes": "fallback-regex"}
{"id": "IMOSL-2017-A7", "contest": "IMOSL", "year": "2017", "problem_number": "A7", "problem": "Let \\(a_{0}, a_{1}, a_{2}, \\ldots\\) be a sequence of integers and \\(b_{0}, b_{1}, b_{2}, \\ldots\\) be a sequence of positive integers such that \\(a_{0}=0, a_{1}=1\\), and\n\\[\na_{n+1}=\\left\\{\\begin{array}{ll}\na_{n} b_{n}+a_{n-1}, & \\text { if } b_{n-1}=1 \\\\\na_{n} b_{n}-a_{n-1}, & \\text { if } b_{n-1}>1\n\\end{array} \\quad \\text { for } n=1,2, \\ldots\\right.\n\\]\n\nProve that at least one of the two numbers \\(a_{2017}\\) and \\(a_{2018}\\) must be greater than or equal to 2017 .\n(Australia)", "solution": "1. The value of \\(b_{0}\\) is irrelevant since \\(a_{0}=0\\), so we may assume that \\(b_{0}=1\\).\nLemma. We have \\(a_{n} \\geqslant 1\\) for all \\(n \\geqslant 1\\).\nProof. Let us suppose otherwise in order to obtain a contradiction. Let\n\\[\nn \\geqslant 1 \\text { be the smallest integer with } a_{n} \\leqslant 0 \\text {. }\n\\]\n\nNote that \\(n \\geqslant 2\\). It follows that \\(a_{n-1} \\geqslant 1\\) and \\(a_{n-2} \\geqslant 0\\). Thus we cannot have \\(a_{n}= a_{n-1} b_{n-1}+a_{n-2}\\), so we must have \\(a_{n}=a_{n-1} b_{n-1}-a_{n-2}\\). Since \\(a_{n} \\leqslant 0\\), we have \\(a_{n-1} \\leqslant a_{n-2}\\). Thus we have \\(a_{n-2} \\geqslant a_{n-1} \\geqslant a_{n}\\).\n\nLet\n\\[\nr \\text { be the smallest index with } a_{r} \\geqslant a_{r+1} \\geqslant a_{r+2} \\text {. }\n\\]\n\nThen \\(r \\leqslant n-2\\) by the above, but also \\(r \\geqslant 2\\) : if \\(b_{1}=1\\), then \\(a_{2}=a_{1}=1\\) and \\(a_{3}=a_{2} b_{2}+a_{1}>a_{2}\\); if \\(b_{1}>1\\), then \\(a_{2}=b_{1}>1=a_{1}\\).\n\nBy the minimal choice (2) of \\(r\\), it follows that \\(a_{r-1}<a_{r}\\). And since \\(2 \\leqslant r \\leqslant n-2\\), by the minimal choice (1) of \\(n\\) we have \\(a_{r-1}, a_{r}, a_{r+1}>0\\). In order to have \\(a_{r+1} \\geqslant a_{r+2}\\), we must have \\(a_{r+2}=a_{r+1} b_{r+1}-a_{r}\\) so that \\(b_{r} \\geqslant 2\\). Putting everything together, we conclude that\n\\[\na_{r+1}=a_{r} b_{r} \\pm a_{r-1} \\geqslant 2 a_{r}-a_{r-1}=a_{r}+\\left(a_{r}-a_{r-1}\\right)>a_{r}\n\\]\nwhich contradicts (2).\nTo complete the problem, we prove that \\(\\max \\left\\{a_{n}, a_{n+1}\\right\\} \\geqslant n\\) by induction. The cases \\(n=0,1\\) are given. Assume it is true for all non-negative integers strictly less than \\(n\\), where \\(n \\geqslant 2\\). There are two cases:\n\nCase 1: \\(b_{n-1}=1\\).\nThen \\(a_{n+1}=a_{n} b_{n}+a_{n-1}\\). By the inductive assumption one of \\(a_{n-1}, a_{n}\\) is at least \\(n-1\\) and the other, by the lemma, is at least 1 . Hence\n\\[\na_{n+1}=a_{n} b_{n}+a_{n-1} \\geqslant a_{n}+a_{n-1} \\geqslant(n-1)+1=n .\n\\]\n\nThus \\(\\max \\left\\{a_{n}, a_{n+1}\\right\\} \\geqslant n\\), as desired.\nCase 2: \\(b_{n-1}>1\\).\nSince we defined \\(b_{0}=1\\) there is an index \\(r\\) with \\(1 \\leqslant r \\leqslant n-1\\) such that\n\\[\nb_{n-1}, b_{n-2}, \\ldots, b_{r} \\geqslant 2 \\quad \\text { and } \\quad b_{r-1}=1 .\n\\]\n\nWe have \\(a_{r+1}=a_{r} b_{r}+a_{r-1} \\geqslant 2 a_{r}+a_{r-1}\\). Thus \\(a_{r+1}-a_{r} \\geqslant a_{r}+a_{r-1}\\).\nNow we claim that \\(a_{r}+a_{r-1} \\geqslant r\\). Indeed, this holds by inspection for \\(r=1\\); for \\(r \\geqslant 2\\), one of \\(a_{r}, a_{r-1}\\) is at least \\(r-1\\) by the inductive assumption, while the other, by the lemma, is at least 1 . Hence \\(a_{r}+a_{r-1} \\geqslant r\\), as claimed, and therefore \\(a_{r+1}-a_{r} \\geqslant r\\) by the last inequality in the previous paragraph.\n\nSince \\(r \\geqslant 1\\) and, by the lemma, \\(a_{r} \\geqslant 1\\), from \\(a_{r+1}-a_{r} \\geqslant r\\) we get the following two inequalities:\n\\[\na_{r+1} \\geqslant r+1 \\quad \\text { and } \\quad a_{r+1}>a_{r} .\n\\]\n\nNow observe that\n\\[\na_{m}>a_{m-1} \\Longrightarrow a_{m+1}>a_{m} \\text { for } m=r+1, r+2, \\ldots, n-1\n\\]\nsince \\(a_{m+1}=a_{m} b_{m}-a_{m-1} \\geqslant 2 a_{m}-a_{m-1}=a_{m}+\\left(a_{m}-a_{m-1}\\right)>a_{m}\\). Thus\n\\[\na_{n}>a_{n-1}>\\cdots>a_{r+1} \\geqslant r+1 \\Longrightarrow a_{n} \\geqslant n\n\\]\n\nSo \\(\\max \\left\\{a_{n}, a_{n+1}\\right\\} \\geqslant n\\), as desired.\nSolution 2. We say that an index \\(n>1\\) is bad if \\(b_{n-1}=1\\) and \\(b_{n-2}>1\\); otherwise \\(n\\) is good. The value of \\(b_{0}\\) is irrelevant to the definition of \\(\\left(a_{n}\\right)\\) since \\(a_{0}=0\\); so we assume that \\(b_{0}>1\\).\nLemma 1. (a) \\(a_{n} \\geqslant 1\\) for all \\(n>0\\).\n(b) If \\(n>1\\) is good, then \\(a_{n}>a_{n-1}\\).\n\nProof. Induction on \\(n\\). In the base cases \\(n=1,2\\) we have \\(a_{1}=1 \\geqslant 1, a_{2}=b_{1} a_{1} \\geqslant 1\\), and finally \\(a_{2}>a_{1}\\) if 2 is good, since in this case \\(b_{1}>1\\).\n\nNow we assume that the lemma statement is proved for \\(n=1,2, \\ldots, k\\) with \\(k \\geqslant 2\\), and prove it for \\(n=k+1\\). Recall that \\(a_{k}\\) and \\(a_{k-1}\\) are positive by the induction hypothesis.\n\nCase 1: \\(k\\) is bad.\nWe have \\(b_{k-1}=1\\), so \\(a_{k+1}=b_{k} a_{k}+a_{k-1} \\geqslant a_{k}+a_{k-1}>a_{k} \\geqslant 1\\), as required.\nCase 2: \\(k\\) is good.\nWe already have \\(a_{k}>a_{k-1} \\geqslant 1\\) by the induction hypothesis. We consider three easy subcases.\n\nSubcase 2.1: \\(b_{k}>1\\).\nThen \\(a_{k+1} \\geqslant b_{k} a_{k}-a_{k-1} \\geqslant a_{k}+\\left(a_{k}-a_{k-1}\\right)>a_{k} \\geqslant 1\\).\nSubcase 2.2: \\(b_{k}=b_{k-1}=1\\).\nThen \\(a_{k+1}=a_{k}+a_{k-1}>a_{k} \\geqslant 1\\).\nSubcase 2.3: \\(b_{k}=1\\) but \\(b_{k-1}>1\\).\nThen \\(k+1\\) is bad, and we need to prove only (a), which is trivial: \\(a_{k+1}=a_{k}-a_{k-1} \\geqslant 1\\).\nSo, in all three subcases we have verified the required relations.\nLemma 2. Assume that \\(n>1\\) is bad. Then there exists a \\(j \\in\\{1,2,3\\}\\) such that \\(a_{n+j} \\geqslant a_{n-1}+j+1\\), and \\(a_{n+i} \\geqslant a_{n-1}+i\\) for all \\(1 \\leqslant i<j\\).\nProof. Recall that \\(b_{n-1}=1\\). Set\n\\[\nm=\\inf \\left\\{i>0: b_{n+i-1}>1\\right\\}\n\\]\n(possibly \\(m=+\\infty\\) ). We claim that \\(j=\\min \\{m, 3\\}\\) works. Again, we distinguish several cases, according to the value of \\(m\\); in each of them we use Lemma 1 without reference.\n\nCase 1: \\(m=1\\), so \\(b_{n}>1\\).\nThen \\(a_{n+1} \\geqslant 2 a_{n}+a_{n-1} \\geqslant a_{n-1}+2\\), as required.\nCase 2: \\(m=2\\), so \\(b_{n}=1\\) and \\(b_{n+1}>1\\).\nThen we successively get\n\\[\n\\begin{gathered}\na_{n+1}=a_{n}+a_{n-1} \\geqslant a_{n-1}+1 \\\\\na_{n+2} \\geqslant 2 a_{n+1}+a_{n} \\geqslant 2\\left(a_{n-1}+1\\right)+a_{n}=a_{n-1}+\\left(a_{n-1}+a_{n}+2\\right) \\geqslant a_{n-1}+4\n\\end{gathered}\n\\]\nwhich is even better than we need.\n\nCase 3: \\(m>2\\), so \\(b_{n}=b_{n+1}=1\\).\nThen we successively get\n\\[\n\\begin{gathered}\na_{n+1}=a_{n}+a_{n-1} \\geqslant a_{n-1}+1, \\quad a_{n+2}=a_{n+1}+a_{n} \\geqslant a_{n-1}+1+a_{n} \\geqslant a_{n-1}+2, \\\\\na_{n+3} \\geqslant a_{n+2}+a_{n+1} \\geqslant\\left(a_{n-1}+1\\right)+\\left(a_{n-1}+2\\right) \\geqslant a_{n-1}+4,\n\\end{gathered}\n\\]\nas required.\nLemmas 1 (b) and 2 provide enough information to prove that \\(\\max \\left\\{a_{n}, a_{n+1}\\right\\} \\geqslant n\\) for all \\(n\\) and, moreover, that \\(a_{n} \\geqslant n\\) often enough. Indeed, assume that we have found some \\(n\\) with \\(a_{n-1} \\geqslant n-1\\). If \\(n\\) is good, then by Lemma 1 (b) we have \\(a_{n} \\geqslant n\\) as well. If \\(n\\) is bad, then Lemma 2 yields \\(\\max \\left\\{a_{n+i}, a_{n+i+1}\\right\\} \\geqslant a_{n-1}+i+1 \\geqslant n+i\\) for all \\(0 \\leqslant i<j\\) and \\(a_{n+j} \\geqslant a_{n-1}+j+1 \\geqslant n+j\\); so \\(n+j\\) is the next index to start with.", "source_pdf": "imosl_2017.pdf", "notes": "fallback-regex"}
{"id": "IMOSL-2017-A8", "contest": "IMOSL", "year": "2017", "problem_number": "A8", "problem": "Assume that a function \\(f: \\mathbb{R} \\rightarrow \\mathbb{R}\\) satisfies the following condition:\nFor every \\(x, y \\in \\mathbb{R}\\) such that \\((f(x)+y)(f(y)+x)>0\\), we have \\(f(x)+y=f(y)+x\\).\nProve that \\(f(x)+y \\leqslant f(y)+x\\) whenever \\(x>y\\).\n(Netherlands)", "solution": "1. Define \\(g(x)=x-f(x)\\). The condition on \\(f\\) then rewrites as follows:\nFor every \\(x, y \\in \\mathbb{R}\\) such that \\(((x+y)-g(x))((x+y)-g(y))>0\\), we have \\(g(x)=g(y)\\).\nThis condition may in turn be rewritten in the following form:\n\\[\n\\text { If } g(x) \\neq g(y), \\text { then the number } x+y \\text { lies (non-strictly) between } g(x) \\text { and } g(y) .\n\\]\n\nNotice here that the function \\(g_{1}(x)=-g(-x)\\) also satisfies (*), since\n\\[\n\\begin{aligned}\ng_{1}(x) \\neq g_{1}(y) & \\Longrightarrow \\quad g(-x) \\neq g(-y) \\quad \\Longrightarrow \\quad-(x+y) \\text { lies between } g(-x) \\text { and } g(-y) \\\\\n& \\Longrightarrow \\quad x+y \\text { lies between } g_{1}(x) \\text { and } g_{1}(y)\n\\end{aligned}\n\\]\n\nOn the other hand, the relation we need to prove reads now as\n\\[\ng(x) \\leqslant g(y) \\quad \\text { whenever } x<y \\text {. }\n\\]\n\nAgain, this condition is equivalent to the same one with \\(g\\) replaced by \\(g_{1}\\).\nIf \\(g(x)=2 x\\) for all \\(x \\in \\mathbb{R}\\), then (*) is obvious; so in what follows we consider the other case. We split the solution into a sequence of lemmas, strengthening one another. We always consider some value of \\(x\\) with \\(g(x) \\neq 2 x\\) and denote \\(X=g(x)\\).\nLemma 1. Assume that \\(X<2 x\\). Then on the interval ( \\(X-x ; x\\) ] the function \\(g\\) attains at most two values - namely, \\(X\\) and, possibly, some \\(Y>X\\). Similarly, if \\(X>2 x\\), then \\(g\\) attains at most two values on [ \\(x ; X-x\\) ) - namely, \\(X\\) and, possibly, some \\(Y<X\\).\nProof. We start with the first claim of the lemma. Notice that \\(X-x<x\\), so the considered interval is nonempty.\n\nTake any \\(a \\in(X-x ; x)\\) with \\(g(a) \\neq X\\) (if it exists). If \\(g(a)<X\\), then (*) yields \\(g(a) \\leqslant a+x \\leqslant g(x)=X\\), so \\(a \\leqslant X-x\\) which is impossible. Thus, \\(g(a)>X\\) and hence by (*) we get \\(X \\leqslant a+x \\leqslant g(a)\\).\n\nNow, for any \\(b \\in(X-x ; x)\\) with \\(g(b) \\neq X\\) we similarly get \\(b+x \\leqslant g(b)\\). Therefore, the number \\(a+b\\) (which is smaller than each of \\(a+x\\) and \\(b+x\\) ) cannot lie between \\(g(a)\\) and \\(g(b)\\), which by (*) implies that \\(g(a)=g(b)\\). Hence \\(g\\) may attain only two values on \\((X-x ; x]\\), namely \\(X\\) and \\(g(a)>X\\).\n\nTo prove the second claim, notice that \\(g_{1}(-x)=-X<2 \\cdot(-x)\\), so \\(g_{1}\\) attains at most two values on \\((-X+x,-x]\\), i.e., \\(-X\\) and, possibly, some \\(-Y>-X\\). Passing back to \\(g\\), we get what we need.\n\nLemma 2. If \\(X<2 x\\), then \\(g\\) is constant on \\((X-x ; x)\\). Similarly, if \\(X>2 x\\), then \\(g\\) is constant on ( \\(x ; X-x\\) ).\nProof. Again, it suffices to prove the first claim only. Assume, for the sake of contradiction, that there exist \\(a, b \\in(X-x ; x)\\) with \\(g(a) \\neq g(b)\\); by Lemma 1 , we may assume that \\(g(a)=X\\) and \\(Y=g(b)>X\\).\n\nNotice that \\(\\min \\{X-a, X-b\\}>X-x\\), so there exists a \\(u \\in(X-x ; x)\\) such that \\(u<\\min \\{X-a, X-b\\}\\). By Lemma 1, we have either \\(g(u)=X\\) or \\(g(u)=Y\\). In the former case, by (*) we have \\(X \\leqslant u+b \\leqslant Y\\) which contradicts \\(u<X-b\\). In the second case, by (*) we have \\(X \\leqslant u+a \\leqslant Y\\) which contradicts \\(u<X-a\\). Thus the lemma is proved.\n\nLemma 3. If \\(X<2 x\\), then \\(g(a)=X\\) for all \\(a \\in(X-x ; x)\\). Similarly, if \\(X>2 x\\), then \\(g(a)=X\\) for all \\(a \\in(x ; X-x)\\).\nProof. Again, we only prove the first claim.\nBy Lemmas 1 and 2, this claim may be violated only if \\(g\\) takes on a constant value \\(Y>X\\) on \\((X-x, x)\\). Choose any \\(a, b \\in(X-x ; x)\\) with \\(a<b\\). By (*), we have\n\\[\nY \\geqslant b+x \\geqslant X\n\\]\n\nIn particular, we have \\(Y \\geqslant b+x>2 a\\). Applying Lemma 2 to \\(a\\) in place of \\(x\\), we obtain that \\(g\\) is constant on \\((a, Y-a)\\). By (2) again, we have \\(x \\leqslant Y-b<Y-a\\); so \\(x, b \\in(a ; Y-a)\\). But \\(X=g(x) \\neq g(b)=Y\\), which is a contradiction.\n\nNow we are able to finish the solution. Assume that \\(g(x)>g(y)\\) for some \\(x<y\\). Denote \\(X=g(x)\\) and \\(Y=g(y)\\); by (*), we have \\(X \\geqslant x+y \\geqslant Y\\), so \\(Y-y \\leqslant x<y \\leqslant X-x\\), and hence \\((Y-y ; y) \\cap(x ; X-x)=(x, y) \\neq \\varnothing\\). On the other hand, since \\(Y-y<y\\) and \\(x<X-x\\), Lemma 3 shows that \\(g\\) should attain a constant value \\(X\\) on ( \\(x ; X-x\\) ) and a constant value \\(Y \\neq X\\) on \\((Y-y ; y)\\). Since these intervals overlap, we get the final contradiction.\n\nSolution 2. As in the previous solution, we pass to the function \\(g\\) satisfying (*) and notice that we need to prove the condition (1). We will also make use of the function \\(g_{1}\\).\n\nIf \\(g\\) is constant, then (1) is clearly satisfied. So, in the sequel we assume that \\(g\\) takes on at least two different values. Now we collect some information about the function \\(g\\).\nClaim 1. For any \\(c \\in \\mathbb{R}\\), all the solutions of \\(g(x)=c\\) are bounded.\nProof. Fix any \\(y \\in \\mathbb{R}\\) with \\(g(y) \\neq c\\). Assume first that \\(g(y)>c\\). Now, for any \\(x\\) with \\(g(x)=c\\), by (*) we have \\(c \\leqslant x+y \\leqslant g(y)\\), or \\(c-y \\leqslant x \\leqslant g(y)-y\\). Since \\(c\\) and \\(y\\) are constant, we get what we need.\n\nIf \\(g(y)<c\\), we may switch to the function \\(g_{1}\\) for which we have \\(g_{1}(-y)>-c\\). By the above arguments, we obtain that all the solutions of \\(g_{1}(-x)=-c\\) are bounded, which is equivalent to what we need.\n\nAs an immediate consequence, the function \\(g\\) takes on infinitely many values, which shows that the next claim is indeed widely applicable.\nClaim 2. If \\(g(x)<g(y)<g(z)\\), then \\(x<z\\).\nProof. By (*), we have \\(g(x) \\leqslant x+y \\leqslant g(y) \\leqslant z+y \\leqslant g(z)\\), so \\(x+y \\leqslant z+y\\), as required.\nClaim 3. Assume that \\(g(x)>g(y)\\) for some \\(x<y\\). Then \\(g(a) \\in\\{g(x), g(y)\\}\\) for all \\(a \\in[x ; y]\\). Proof. If \\(g(y)<g(a)<g(x)\\), then the triple \\((y, a, x)\\) violates Claim 2. If \\(g(a)<g(y)<g(x)\\), then the triple \\((a, y, x)\\) violates Claim 2. If \\(g(y)<g(x)<g(a)\\), then the triple \\((y, x, a)\\) violates Claim 2. The only possible cases left are \\(g(a) \\in\\{g(x), g(y)\\}\\).\n\nIn view of Claim 3, we say that an interval \\(I\\) (which may be open, closed, or semi-open) is a Dirichlet interval* if the function \\(g\\) takes on just two values on \\(I\\).\n\nAssume now, for the sake of contradiction, that (1) is violated by some \\(x<y\\). By Claim 3, \\([x ; y]\\) is a Dirichlet interval. Set\n\\(r=\\inf \\{a:(a ; y]\\) is a Dirichlet interval \\(\\} \\quad\\) and \\(\\quad s=\\sup \\{b:[x ; b)\\) is a Dirichlet interval \\(\\}\\).\nClearly, \\(r \\leqslant x<y \\leqslant s\\). By Claim 1, \\(r\\) and \\(s\\) are finite. Denote \\(X=g(x), Y=g(y)\\), and \\(\\Delta=(y-x) / 2\\).\n\nSuppose first that there exists a \\(t \\in(r ; r+\\Delta)\\) with \\(f(t)=Y\\). By the definition of \\(r\\), the interval ( \\(r-\\Delta ; y\\) ] is not Dirichlet, so there exists an \\(r^{\\prime} \\in(r-\\Delta ; r]\\) such that \\(g\\left(r^{\\prime}\\right) \\notin\\{X, Y\\}\\).\n*The name Dirichlet interval is chosen for the reason that \\(g\\) theoretically might act similarly to the Dirichlet function on this interval.\n\nThe function \\(g\\) attains at least three distinct values on \\(\\left[r^{\\prime} ; y\\right]\\), namely \\(g\\left(r^{\\prime}\\right), g(x)\\), and \\(g(y)\\). Claim 3 now yields \\(g\\left(r^{\\prime}\\right) \\leqslant g(y)\\); the equality is impossible by the choice of \\(r^{\\prime}\\), so in fact \\(g\\left(r^{\\prime}\\right)<Y\\). Applying (*) to the pairs ( \\(r^{\\prime}, y\\) ) and ( \\(t, x\\) ) we obtain \\(r^{\\prime}+y \\leqslant Y \\leqslant t+x\\), whence \\(r-\\Delta+y<r^{\\prime}+y \\leqslant t+x<r+\\Delta+x\\), or \\(y-x<2 \\Delta\\). This is a contradiction.\n\nThus, \\(g(t)=X\\) for all \\(t \\in(r ; r+\\Delta)\\). Applying the same argument to \\(g_{1}\\), we get \\(g(t)=Y\\) for all \\(t \\in(s-\\Delta ; s)\\).\n\nFinally, choose some \\(s_{1}, s_{2} \\in(s-\\Delta ; s)\\) with \\(s_{1}<s_{2}\\) and denote \\(\\delta=\\left(s_{2}-s_{1}\\right) / 2\\). As before, we choose \\(r^{\\prime} \\in(r-\\delta ; r)\\) with \\(g\\left(r^{\\prime}\\right) \\notin\\{X, Y\\}\\) and obtain \\(g\\left(r^{\\prime}\\right)<Y\\). Choose any \\(t \\in(r ; r+\\delta)\\); by the above arguments, we have \\(g(t)=X\\) and \\(g\\left(s_{1}\\right)=g\\left(s_{2}\\right)=Y\\). As before, we apply (*) to the pairs ( \\(r^{\\prime}, s_{2}\\) ) and ( \\(t, s_{1}\\) ) obtaining \\(r-\\delta+s_{2}<r^{\\prime}+s_{2} \\leqslant Y \\leqslant t+s_{1}<r+\\delta+s_{1}\\), or \\(s_{2}-s_{1}<2 \\delta\\). This is a final contradiction.\n\nComment 1. The original submission discussed the same functions \\(f\\), but the question was different - namely, the following one:\n\nProve that the equation \\(f(x)=2017 x\\) has at most one solution, and the equation \\(f(x)=-2017 x\\) has at least one solution.\n\nThe Problem Selection Committee decided that the question we are proposing is more natural, since it provides more natural information about the function \\(g\\) (which is indeed the main character in this story). On the other hand, the new problem statement is strong enough in order to imply the original one easily.\n\nNamely, we will deduce from the new problem statement (along with the facts used in the solutions) that (i) for every \\(N>0\\) the equation \\(g(x)=-N x\\) has at most one solution, and (ii) for every \\(N>1\\) the equation \\(g(x)=N x\\) has at least one solution.\n\nClaim ( \\(i\\) ) is now trivial. Indeed, \\(g\\) is proven to be non-decreasing, so \\(g(x)+N x\\) is strictly increasing and thus has at most one zero.\n\nWe proceed on claim \\((i i)\\). If \\(g(0)=0\\), then the required root has been already found. Otherwise, we may assume that \\(g(0)>0\\) and denote \\(c=g(0)\\). We intend to prove that \\(x=c / N\\) is the required root. Indeed, by monotonicity we have \\(g(c / N) \\geqslant g(0)=c\\); if we had \\(g(c / N)>c\\), then (*) would yield \\(c \\leqslant 0+c / N \\leqslant g(c / N)\\) which is false. Thus, \\(g(x)=c=N x\\).\n\nComment 2. There are plenty of functions \\(g\\) satisfying (*) (and hence of functions \\(f\\) satisfying the problem conditions). One simple example is \\(g_{0}(x)=2 x\\). Next, for any increasing sequence \\(A=\\left(\\ldots, a_{-1}, a_{0}, a_{1}, \\ldots\\right)\\) which is unbounded in both directions (i.e., for every \\(N\\) this sequence contains terms greater than \\(N\\), as well as terms smaller than \\(-N\\) ), the function \\(g_{A}\\) defined by\n\\[\ng_{A}(x)=a_{i}+a_{i+1} \\quad \\text { whenever } x \\in\\left[a_{i} ; a_{i+1}\\right)\n\\]\nsatisfies (*). Indeed, pick any \\(x<y\\) with \\(g(x) \\neq g(y)\\); this means that \\(x \\in\\left[a_{i} ; a_{i+1}\\right)\\) and \\(y \\in\\left[a_{j} ; a_{j+1}\\right)\\) for some \\(i<j\\). Then we have \\(g(x)=a_{i}+a_{i+1} \\leqslant x+y<a_{j}+a_{j+1}=g(y)\\), as required.\n\nThere also exist examples of the mixed behavior; e.g., for an arbitrary sequence \\(A\\) as above and an arbitrary subset \\(I \\subseteq \\mathbb{Z}\\) the function\n\\[\ng_{A, I}(x)=\\left\\{\\begin{array}{ll}\ng_{0}(x), & x \\in\\left[a_{i} ; a_{i+1}\\right) \\quad \\text { with } i \\in I ; \\\\\ng_{A}(x), & x \\in\\left[a_{i} ; a_{i+1}\\right)\n\\end{array} \\text { with } i \\notin I\\right.\n\\]\nalso satisfies (*).\nFinally, it is even possible to provide a complete description of all functions \\(g\\) satisfying ( \\(*\\) ) (and hence of all functions \\(f\\) satisfying the problem conditions); however, it seems to be far out of scope for the IMO. This description looks as follows.\n\nLet \\(A\\) be any closed subset of \\(\\mathbb{R}\\) which is unbounded in both directions. Define the functions \\(i_{A}\\), \\(s_{A}\\), and \\(g_{A}\\) as follows:\n\\[\ni_{A}(x)=\\inf \\{a \\in A: a \\geqslant x\\}, \\quad s_{A}(x)=\\sup \\{a \\in A: a \\leqslant x\\}, \\quad g_{A}(x)=i_{A}(x)+s_{A}(x)\n\\]\n\nIt is easy to see that for different sets \\(A\\) and \\(B\\) the functions \\(g_{A}\\) and \\(g_{B}\\) are also different (since, e.g., for any \\(a \\in A \\backslash B\\) the function \\(g_{B}\\) is constant in a small neighborhood of \\(a\\), but the function \\(g_{A}\\) is not). One may check, similarly to the arguments above, that each such function satisfies (*).\n\nFinally, one more modification is possible. Namely, for any \\(x \\in A\\) one may redefine \\(g_{A}(x)\\) (which is \\(2 x\\) ) to be any of the numbers\n\\[\n\\begin{gathered}\ng_{A+}(x)=i_{A+}(x)+x \\quad \\text { or } \\quad g_{A-}(x)=x+s_{A-}(x) \\\\\n\\text { where } \\quad i_{A+}(x)=\\inf \\{a \\in A: a>x\\} \\quad \\text { and } \\quad s_{A-}(x)=\\sup \\{a \\in A: a<x\\} .\n\\end{gathered}\n\\]\n\nThis really changes the value if \\(x\\) has some right (respectively, left) semi-neighborhood disjoint from \\(A\\), so there are at most countably many possible changes; all of them can be performed independently.\n\nWith some effort, one may show that the construction above provides all functions \\(g\\) satisfying (*).", "source_pdf": "imosl_2017.pdf", "notes": "fallback-regex"}
{"id": "IMOSL-2017-C1", "contest": "IMOSL", "year": "2017", "problem_number": "C1", "problem": "A rectangle \\(\\mathcal{R}\\) with odd integer side lengths is divided into small rectangles with integer side lengths. Prove that there is at least one among the small rectangles whose distances from the four sides of \\(\\mathcal{R}\\) are either all odd or all even.\n(Singapore)", "solution": ". Let the width and height of \\(\\mathcal{R}\\) be odd numbers \\(a\\) and \\(b\\). Divide \\(\\mathcal{R}\\) into \\(a b\\) unit squares and color them green and yellow in a checkered pattern. Since the side lengths of \\(a\\) and \\(b\\) are odd, the corner squares of \\(\\mathcal{R}\\) will all have the same color, say green.\n\nCall a rectangle (either \\(\\mathcal{R}\\) or a small rectangle) green if its corners are all green; call it yellow if the corners are all yellow, and call it mixed if it has both green and yellow corners. In particular, \\(\\mathcal{R}\\) is a green rectangle.\n\nWe will use the following trivial observations.\n- Every mixed rectangle contains the same number of green and yellow squares;\n- Every green rectangle contains one more green square than yellow square;\n- Every yellow rectangle contains one more yellow square than green square.\n\nThe rectangle \\(\\mathcal{R}\\) is green, so it contains more green unit squares than yellow unit squares. Therefore, among the small rectangles, at least one is green. Let \\(\\mathcal{S}\\) be such a small green rectangle, and let its distances from the sides of \\(\\mathcal{R}\\) be \\(x, y, u\\) and \\(v\\), as shown in the picture. The top-left corner of \\(\\mathcal{R}\\) and the top-left corner of \\(\\mathcal{S}\\) have the same color, which happen if and only if \\(x\\) and \\(u\\) have the same parity. Similarly, the other three green corners of \\(\\mathcal{S}\\) indicate that \\(x\\) and \\(v\\) have the same parity, \\(y\\) and \\(u\\) have the same parity, i.e. \\(x, y, u\\) and \\(v\\) are all odd or all even.\n![](https://cdn.mathpix.com/cropped/2025_08_23_4b06fd0385d65a4d803fg-36.jpg?height=358&width=535&top_left_y=1496&top_left_x=765)", "source_pdf": "imosl_2017.pdf", "notes": "fallback-regex"}
{"id": "IMOSL-2017-C2", "contest": "IMOSL", "year": "2017", "problem_number": "C2", "problem": "Let \\(n\\) be a positive integer. Define a chameleon to be any sequence of \\(3 n\\) letters, with exactly \\(n\\) occurrences of each of the letters \\(a, b\\), and \\(c\\). Define a swap to be the transposition of two adjacent letters in a chameleon. Prove that for any chameleon \\(X\\), there exists a chameleon \\(Y\\) such that \\(X\\) cannot be changed to \\(Y\\) using fewer than \\(3 n^{2} / 2\\) swaps.\n(Australia)", "solution": "1. To start, notice that the swap of two identical letters does not change a chameleon, so we may assume there are no such swaps.\n\nFor any two chameleons \\(X\\) and \\(Y\\), define their distance \\(d(X, Y)\\) to be the minimal number of swaps needed to transform \\(X\\) into \\(Y\\) (or vice versa). Clearly, \\(d(X, Y)+d(Y, Z) \\geqslant d(X, Z)\\) for any three chameleons \\(X, Y\\), and \\(Z\\).\nLemma. Consider two chameleons\n\\[\nP=\\underbrace{a a \\ldots a}_{n} \\underbrace{b b \\ldots b}_{n} \\underbrace{c c \\ldots c}_{n} \\text { and } Q=\\underbrace{c c \\ldots c}_{n} \\underbrace{b \\ldots b}_{n} \\underbrace{a a \\ldots a}_{n} \\text {. }\n\\]\n\nThen \\(d(P, Q) \\geqslant 3 n^{2}\\).\nProof. For any chameleon \\(X\\) and any pair of distinct letters \\(u, v \\in\\{a, b, c\\}\\), we define \\(f_{u, v}(X)\\) to be the number of pairs of positions in \\(X\\) such that the left one is occupied by \\(u\\), and the right one is occupied by \\(v\\). Define \\(f(X)=f_{a, b}(X)+f_{a, c}(X)+f_{b, c}(X)\\). Notice that \\(f_{a, b}(P)=f_{a, c}(P)=f_{b, c}(P)=n^{2}\\) and \\(f_{a, b}(Q)=f_{a, c}(Q)=f_{b, c}(Q)=0\\), so \\(f(P)=3 n^{2}\\) and \\(f(Q)=0\\).\n\nNow consider some swap changing a chameleon \\(X\\) to \\(X^{\\prime}\\); say, the letters \\(a\\) and \\(b\\) are swapped. Then \\(f_{a, b}(X)\\) and \\(f_{a, b}\\left(X^{\\prime}\\right)\\) differ by exactly 1 , while \\(f_{a, c}(X)=f_{a, c}\\left(X^{\\prime}\\right)\\) and \\(f_{b, c}(X)=f_{b, c}\\left(X^{\\prime}\\right)\\). This yields \\(\\left|f(X)-f\\left(X^{\\prime}\\right)\\right|=1\\), i.e., on any swap the value of \\(f\\) changes by 1 . Hence \\(d(X, Y) \\geqslant |f(X)-f(Y)|\\) for any two chameleons \\(X\\) and \\(Y\\). In particular, \\(d(P, Q) \\geqslant|f(P)-f(Q)|=3 n^{2}\\), as desired.\n\nBack to the problem, take any chameleon \\(X\\) and notice that \\(d(X, P)+d(X, Q) \\geqslant d(P, Q) \\geqslant 3 n^{2}\\) by the lemma. Consequently, \\(\\max \\{d(X, P), d(X, Q)\\} \\geqslant \\frac{3 n^{2}}{2}\\), which establishes the problem statement.\n\nComment 1. The problem may be reformulated in a graph language. Construct a graph \\(G\\) with the chameleons as vertices, two vertices being connected with an edge if and only if these chameleons differ by a single swap. Then \\(d(X, Y)\\) is the usual distance between the vertices \\(X\\) and \\(Y\\) in this graph. Recall that the radius of a connected graph \\(G\\) is defined as\n\\[\nr(G)=\\min _{v \\in V} \\max _{u \\in V} d(u, v)\n\\]\n\nSo we need to prove that the radius of the constructed graph is at least \\(3 n^{2} / 2\\).\nIt is well-known that the radius of any connected graph is at least the half of its diameter (which is simply \\(\\max _{u, v \\in V} d(u, v)\\) ). Exactly this fact has been used above in order to finish the solution.\nSolution 2. We use the notion of distance from Solution 1, but provide a different lower bound for it.\n\nIn any chameleon \\(X\\), we enumerate the positions in it from left to right by \\(1,2, \\ldots, 3 n\\). Define \\(s_{c}(X)\\) as the sum of positions occupied by \\(c\\). The value of \\(s_{c}\\) changes by at most 1 on each swap, but this fact alone does not suffice to solve the problem; so we need an improvement.\n\nFor every chameleon \\(X\\), denote by \\(X_{\\bar{c}}\\) the sequence obtained from \\(X\\) by removing all \\(n\\) letters \\(c\\). Enumerate the positions in \\(X_{\\bar{c}}\\) from left to right by \\(1,2, \\ldots, 2 n\\), and define \\(s_{\\bar{c}, b}(X)\\) as the sum of positions in \\(X_{\\bar{c}}\\) occupied by \\(b\\). (In other words, here we consider the positions of the \\(b\\) 's relatively to the \\(a\\) 's only.) Finally, denote\n\\[\nd^{\\prime}(X, Y):=\\left|s_{c}(X)-s_{c}(Y)\\right|+\\left|s_{\\bar{c}, b}(X)-s_{\\bar{c}, b}(Y)\\right| .\n\\]\n\nNow consider any swap changing a chameleon \\(X\\) to \\(X^{\\prime}\\). If no letter \\(c\\) is involved into this swap, then \\(s_{c}(X)=s_{c}\\left(X^{\\prime}\\right)\\); on the other hand, exactly one letter \\(b\\) changes its position in \\(X_{\\bar{c}}\\), so \\(\\left|s_{\\bar{c}, b}(X)-s_{\\bar{c}, b}\\left(X^{\\prime}\\right)\\right|=1\\). If a letter \\(c\\) is involved into a swap, then \\(X_{\\bar{c}}=X_{\\bar{c}}^{\\prime}\\), so \\(s_{\\bar{c}, b}(X)=s_{\\bar{c}, b}\\left(X^{\\prime}\\right)\\) and \\(\\left|s_{c}(X)-s_{c}\\left(X^{\\prime}\\right)\\right|=1\\). Thus, in all cases we have \\(d^{\\prime}\\left(X, X^{\\prime}\\right)=1\\).\n\nAs in the previous solution, this means that \\(d(X, Y) \\geqslant d^{\\prime}(X, Y)\\) for any two chameleons \\(X\\) and \\(Y\\). Now, for any chameleon \\(X\\) we will indicate a chameleon \\(Y\\) with \\(d^{\\prime}(X, Y) \\geqslant 3 n^{2} / 2\\), thus finishing the solution.\n\nThe function \\(s_{c}\\) attains all integer values from \\(1+\\cdots+n=\\frac{n(n+1)}{2}\\) to \\((2 n+1)+\\cdots+3 n= 2 n^{2}+\\frac{n(n+1)}{2}\\). If \\(s_{c}(X) \\leqslant n^{2}+\\frac{n(n+1)}{2}\\), then we put the letter \\(c\\) into the last \\(n\\) positions in \\(Y\\); otherwise we put the letter \\(c\\) into the first \\(n\\) positions in \\(Y\\). In either case we already have \\(\\left|s_{c}(X)-s_{c}(Y)\\right| \\geqslant n^{2}\\).\n\nSimilarly, \\(s_{\\bar{c}, b}\\) ranges from \\(\\frac{n(n+1)}{2}\\) to \\(n^{2}+\\frac{n(n+1)}{2}\\). So, if \\(s_{\\bar{c}, b}(X) \\leqslant \\frac{n^{2}}{2}+\\frac{n(n+1)}{2}\\), then we put the letter \\(b\\) into the last \\(n\\) positions in \\(Y\\) which are still free; otherwise, we put the letter \\(b\\) into the first \\(n\\) such positions. The remaining positions are occupied by \\(a\\). In any case, we have \\(\\left|s_{\\bar{c}, b}(X)-s_{\\bar{c}, b}(Y)\\right| \\geqslant \\frac{n^{2}}{2}\\), thus \\(d^{\\prime}(X, Y) \\geqslant n^{2}+\\frac{n^{2}}{2}=\\frac{3 n^{2}}{2}\\), as desired.\n\nComment 2. The two solutions above used two lower bounds \\(|f(X)-f(Y)|\\) and \\(d^{\\prime}(X, Y)\\) for the number \\(d(X, Y)\\). One may see that these bounds are closely related to each other, as\n\\[\nf_{a, c}(X)+f_{b, c}(X)=s_{c}(X)-\\frac{n(n+1)}{2} \\quad \\text { and } \\quad f_{a, b}(X)=s_{\\bar{c}, b}(X)-\\frac{n(n+1)}{2} .\n\\]\n\nOne can see that, e.g., the bound \\(d^{\\prime}(X, Y)\\) could as well be used in the proof of the lemma in Solution 1.\nLet us describe here an even sharper bound which also can be used in different versions of the solutions above.\n\nIn each chameleon \\(X\\), enumerate the occurrences of \\(a\\) from the left to the right as \\(a_{1}, a_{2}, \\ldots, a_{n}\\). Since we got rid of swaps of identical letters, the relative order of these letters remains the same during the swaps. Perform the same operation with the other letters, obtaining new letters \\(b_{1}, \\ldots, b_{n}\\) and \\(c_{1}, \\ldots, c_{n}\\). Denote by \\(A\\) the set of the \\(3 n\\) obtained letters.\n\nSince all \\(3 n\\) letters became different, for any chameleon \\(X\\) and any \\(s \\in A\\) we may define the position \\(N_{s}(X)\\) of \\(s\\) in \\(X\\) (thus \\(1 \\leqslant N_{s}(X) \\leqslant 3 n\\) ). Now, for any two chameleons \\(X\\) and \\(Y\\) we say that a pair of letters \\((s, t) \\in A \\times A\\) is an ( \\(X, Y\\) )-inversion if \\(N_{s}(X)<N_{t}(X)\\) but \\(N_{s}(Y)>N_{t}(Y)\\), and define \\(d^{*}(X, Y)\\) to be the number of ( \\(X, Y\\) )-inversions. Then for any two chameleons \\(Y\\) and \\(Y^{\\prime}\\) differing by a single swap, we have \\(\\left|d^{*}(X, Y)-d^{*}\\left(X, Y^{\\prime}\\right)\\right|=1\\). Since \\(d^{*}(X, X)=0\\), this yields \\(d(X, Y) \\geqslant d^{*}(X, Y)\\) for any pair of chameleons \\(X\\) and \\(Y\\). The bound \\(d^{*}\\) may also be used in both Solution 1 and Solution 2.\n\nComment 3. In fact, one may prove that the distance \\(d^{*}\\) defined in the previous comment coincides with \\(d\\). Indeed, if \\(X \\neq Y\\), then there exist an ( \\(X, Y\\) )-inversion ( \\(s, t\\) ). One can show that such \\(s\\) and \\(t\\) may be chosen to occupy consecutive positions in \\(Y\\). Clearly, \\(s\\) and \\(t\\) correspond to different letters among \\(\\{a, b, c\\}\\). So, swapping them in \\(Y\\) we get another chameleon \\(Y^{\\prime}\\) with \\(d^{*}\\left(X, Y^{\\prime}\\right)=d^{*}(X, Y)-1\\). Proceeding in this manner, we may change \\(Y\\) to \\(X\\) in \\(d^{*}(X, Y)\\) steps.\n\nUsing this fact, one can show that the estimate in the problem statement is sharp for all \\(n \\geqslant 2\\). (For \\(n=1\\) it is not sharp, since any permutation of three letters can be changed to an opposite one in no less than three swaps.) We outline the proof below.\n\nFor any \\(k \\geqslant 0\\), define\n\\[\nX_{2 k}=\\underbrace{a b c a b c \\ldots a b c}_{3 k \\text { letters }} \\underbrace{c b a c b a \\ldots c b a}_{3 k \\text { letters }} \\text { and } X_{2 k+3}=\\underbrace{a b c a b c \\ldots a b c}_{3 k \\text { letters }} a b c b c a c a b \\underbrace{c b a c b a \\ldots c b a}_{3 k \\text { letters }} .\n\\]\n\nWe claim that for every \\(n \\geqslant 2\\) and every chameleon \\(Y\\), we have \\(d^{*}\\left(X_{n}, Y\\right) \\leqslant\\left\\lceil 3 n^{2} / 2\\right\\rceil\\). This will mean that for every \\(n \\geqslant 2\\) the number \\(3 n^{2} / 2\\) in the problem statement cannot be changed by any number larger than \\(\\left\\lceil 3 n^{2} / 2\\right\\rceil\\).\n\nFor any distinct letters \\(u, v \\in\\{a, b, c\\}\\) and any two chameleons \\(X\\) and \\(Y\\), we define \\(d_{u, v}^{*}(X, Y)\\) as the number of ( \\(X, Y\\) )-inversions ( \\(s, t\\) ) such that \\(s\\) and \\(t\\) are instances of \\(u\\) and \\(v\\) (in any of the two possible orders). Then \\(d^{*}(X, Y)=d_{a, b}^{*}(X, Y)+d_{b, c}^{*}(X, Y)+d_{c, a}^{*}(X, Y)\\).\n\nWe start with the case when \\(n=2 k\\) is even; denote \\(X=X_{2 k}\\). We show that \\(d_{a, b}^{*}(X, Y) \\leqslant 2 k^{2}\\) for any chameleon \\(Y\\); this yields the required estimate. Proceed by the induction on \\(k\\) with the trivial base case \\(k=0\\). To perform the induction step, notice that \\(d_{a, b}^{*}(X, Y)\\) is indeed the minimal number of swaps needed to change \\(Y_{\\bar{c}}\\) into \\(X_{\\bar{c}}\\). One may show that moving \\(a_{1}\\) and \\(a_{2 k}\\) in \\(Y\\) onto the first and the last positions in \\(Y\\), respectively, takes at most \\(2 k\\) swaps, and that subsequent moving \\(b_{1}\\) and \\(b_{2 k}\\) onto the second and the second last positions takes at most \\(2 k-2\\) swaps. After performing that, one may delete these letters from both \\(X_{\\bar{c}}\\) and \\(Y_{\\bar{c}}\\) and apply the induction hypothesis; so \\(X_{\\bar{c}}\\) can be obtained from \\(Y_{\\bar{c}}\\) using at most \\(2(k-1)^{2}+2 k+(2 k-2)=2 k^{2}\\) swaps, as required.\n\nIf \\(n=2 k+3\\) is odd, the proof is similar but more technically involved. Namely, we claim that \\(d_{a, b}^{*}\\left(X_{2 k+3}, Y\\right) \\leqslant 2 k^{2}+6 k+5\\) for any chameleon \\(Y\\), and that the equality is achieved only if \\(Y_{\\bar{c}}= b b \\ldots b a a \\ldots a\\). The proof proceeds by a similar induction, with some care taken of the base case, as well as of extracting the equality case. Similar estimates hold for \\(d_{b, c}^{*}\\) and \\(d_{c, a}^{*}\\). Summing three such estimates, we obtain\n\\[\nd^{*}\\left(X_{2 k+3}, Y\\right) \\leqslant 3\\left(2 k^{2}+6 k+5\\right)=\\left\\lceil\\frac{3 n^{2}}{2}\\right\\rceil+1\n\\]\nwhich is by 1 more than we need. But the equality could be achieved only if \\(Y_{\\bar{c}}=b b \\ldots b a a \\ldots a\\) and, similarly, \\(Y_{\\bar{b}}=a a \\ldots a c c \\ldots c\\) and \\(Y_{\\bar{a}}=c c \\ldots c b b \\ldots b\\). Since these three equalities cannot hold simultaneously, the proof is finished.", "source_pdf": "imosl_2017.pdf", "notes": "fallback-regex"}
{"id": "IMOSL-2017-C3", "contest": "IMOSL", "year": "2017", "problem_number": "C3", "problem": "Sir Alex plays the following game on a row of 9 cells. Initially, all cells are empty. In each move, Sir Alex is allowed to perform exactly one of the following two operations:\n(1) Choose any number of the form \\(2^{j}\\), where \\(j\\) is a non-negative integer, and put it into an empty cell.\n(2) Choose two (not necessarily adjacent) cells with the same number in them; denote that number by \\(2^{j}\\). Replace the number in one of the cells with \\(2^{j+1}\\) and erase the number in the other cell.\n\nAt the end of the game, one cell contains the number \\(2^{n}\\), where \\(n\\) is a given positive integer, while the other cells are empty. Determine the maximum number of moves that Sir Alex could have made, in terms of \\(n\\).\n(Thailand)", "solution": "Answer: \\(2 \\sum_{j=0}^{8}\\binom{n}{j}-1\\).\n\n1. We will solve a more general problem, replacing the row of 9 cells with a row of \\(k\\) cells, where \\(k\\) is a positive integer. Denote by \\(m(n, k)\\) the maximum possible number of moves Sir Alex can make starting with a row of \\(k\\) empty cells, and ending with one cell containing the number \\(2^{n}\\) and all the other \\(k-1\\) cells empty. Call an operation of type (1) an insertion, and an operation of type (2) a merge.\n\nOnly one move is possible when \\(k=1\\), so we have \\(m(n, 1)=1\\). From now on we consider \\(k \\geqslant 2\\), and we may assume Sir Alex's last move was a merge. Then, just before the last move, there were exactly two cells with the number \\(2^{n-1}\\), and the other \\(k-2\\) cells were empty.\n\nPaint one of those numbers \\(2^{n-1}\\) blue, and the other one red. Now trace back Sir Alex's moves, always painting the numbers blue or red following this rule: if \\(a\\) and \\(b\\) merge into \\(c\\), paint \\(a\\) and \\(b\\) with the same color as \\(c\\). Notice that in this backward process new numbers are produced only by reversing merges, since reversing an insertion simply means deleting one of the numbers. Therefore, all numbers appearing in the whole process will receive one of the two colors.\n\nSir Alex's first move is an insertion. Without loss of generality, assume this first number inserted is blue. Then, from this point on, until the last move, there is always at least one cell with a blue number.\n\nBesides the last move, there is no move involving a blue and a red number, since all merges involves numbers with the same color, and insertions involve only one number. Call an insertion of a blue number or merge of two blue numbers a blue move, and define a red move analogously.\n\nThe whole sequence of blue moves could be repeated on another row of \\(k\\) cells to produce one cell with the number \\(2^{n-1}\\) and all the others empty, so there are at most \\(m(n-1, k)\\) blue moves.\n\nNow we look at the red moves. Since every time we perform a red move there is at least one cell occupied with a blue number, the whole sequence of red moves could be repeated on a row of \\(k-1\\) cells to produce one cell with the number \\(2^{n-1}\\) and all the others empty, so there are at most \\(m(n-1, k-1)\\) red moves. This proves that\n\\[\nm(n, k) \\leqslant m(n-1, k)+m(n-1, k-1)+1\n\\]\n\nOn the other hand, we can start with an empty row of \\(k\\) cells and perform \\(m(n-1, k)\\) moves to produce one cell with the number \\(2^{n-1}\\) and all the others empty, and after that perform \\(m(n-1, k-1)\\) moves on those \\(k-1\\) empty cells to produce the number \\(2^{n-1}\\) in one of them, leaving \\(k-2\\) empty. With one more merge we get one cell with \\(2^{n}\\) and the others empty, proving that\n\\[\nm(n, k) \\geqslant m(n-1, k)+m(n-1, k-1)+1\n\\]\n\nIt follows that\n\\[\nm(n, k)=m(n-1, k)+m(n-1, k-1)+1\n\\]\nfor \\(n \\geqslant 1\\) and \\(k \\geqslant 2\\).\nIf \\(k=1\\) or \\(n=0\\), we must insert \\(2^{n}\\) on our first move and immediately get the final configuration, so \\(m(0, k)=1\\) and \\(m(n, 1)=1\\), for \\(n \\geqslant 0\\) and \\(k \\geqslant 1\\). These initial values, together with the recurrence relation (1), determine \\(m(n, k)\\) uniquely.\n\nFinally, we show that\n\\[\nm(n, k)=2 \\sum_{j=0}^{k-1}\\binom{n}{j}-1\n\\]\nfor all integers \\(n \\geqslant 0\\) and \\(k \\geqslant 1\\).\nWe use induction on \\(n\\). Since \\(m(0, k)=1\\) for \\(k \\geqslant 1\\), (2) is true for the base case. We make the induction hypothesis that (2) is true for some fixed positive integer \\(n\\) and all \\(k \\geqslant 1\\). We have \\(m(n+1,1)=1=2\\binom{n+1}{0}-1\\), and for \\(k \\geqslant 2\\) the recurrence relation (1) and the induction hypothesis give us\n\\[\n\\begin{aligned}\n& m(n+1, k)=m(n, k)+m(n, k-1)+1=2 \\sum_{j=0}^{k-1}\\binom{n}{j}-1+2 \\sum_{j=0}^{k-2}\\binom{n}{j}-1+1 \\\\\n& \\quad=2 \\sum_{j=0}^{k-1}\\binom{n}{j}+2 \\sum_{j=0}^{k-1}\\binom{n}{j-1}-1=2 \\sum_{j=0}^{k-1}\\left(\\binom{n}{j}+\\binom{n}{j-1}\\right)-1=2 \\sum_{j=0}^{k-1}\\binom{n+1}{j}-1,\n\\end{aligned}\n\\]\nwhich completes the proof.\nComment 1. After deducing the recurrence relation (1), it may be convenient to homogenize the recurrence relation by defining \\(h(n, k)=m(n, k)+1\\). We get the new relation\n\\[\nh(n, k)=h(n-1, k)+h(n-1, k)\n\\]\nfor \\(n \\geqslant 1\\) and \\(k \\geqslant 2\\), with initial values \\(h(0, k)=h(n, 1)=2\\), for \\(n \\geqslant 0\\) and \\(k \\geqslant 1\\).\nThis may help one to guess the answer, and also with other approaches like the one we develop next.\n\nComment 2. We can use a generating function to find the answer without guessing. We work with the homogenized recurrence relation (3). Define \\(h(n, 0)=0\\) so that (3) is valid for \\(k=1\\) as well. Now we set up the generating function \\(f(x, y)=\\sum_{n, k \\geqslant 0} h(n, k) x^{n} y^{k}\\). Multiplying the recurrence relation (3) by \\(x^{n} y^{k}\\) and summing over \\(n, k \\geqslant 1\\), we get\n\\[\n\\sum_{n, k \\geqslant 1} h(n, k) x^{n} y^{k}=x \\sum_{n, k \\geqslant 1} h(n-1, k) x^{n-1} y^{k}+x y \\sum_{n, k \\geqslant 1} h(n-1, k-1) x^{n-1} y^{k-1} .\n\\]\n\nCompleting the missing terms leads to the following equation on \\(f(x, y)\\) :\n\\[\nf(x, y)-\\sum_{n \\geqslant 0} h(n, 0) x^{n}-\\sum_{k \\geqslant 1} h(0, k) y^{k}=x f(x, y)-x \\sum_{n \\geqslant 0} h(n, 0) x^{n}+x y f(x, y) .\n\\]\n\nSubstituting the initial values, we obtain\n\\[\nf(x, y)=\\frac{2 y}{1-y} \\cdot \\frac{1}{1-x(1+y)}\n\\]\n\nDeveloping as a power series, we get\n\\[\nf(x, y)=2 \\sum_{j \\geqslant 1} y^{j} \\cdot \\sum_{n \\geqslant 0}(1+y)^{n} x^{n}\n\\]\n\nThe coefficient of \\(x^{n}\\) in this power series is\n\\[\n2 \\sum_{j \\geqslant 1} y^{j} \\cdot(1+y)^{n}=2 \\sum_{j \\geqslant 1} y^{j} \\cdot \\sum_{i \\geqslant 0}\\binom{n}{i} y^{i},\n\\]\nand extracting the coefficient of \\(y^{k}\\) in this last expression we finally obtain the value for \\(h(n, k)\\),\n\\[\nh(n, k)=2 \\sum_{j=0}^{k-1}\\binom{n}{j}\n\\]\n\nThis proves that\n\\[\nm(n, k)=2 \\sum_{j=0}^{k-1}\\binom{n}{j}-1\n\\]\n\nThe generating function approach also works if applied to the non-homogeneous recurrence relation (1), but the computations are less straightforward.\n\nSolution 2. Define merges and insertions as in Solution 1. After each move made by Sir Alex we compute the number \\(N\\) of empty cells, and the sum \\(S\\) of all the numbers written in the cells. Insertions always increase \\(S\\) by some power of 2 , and increase \\(N\\) exactly by 1 . Merges do not change \\(S\\) and decrease \\(N\\) exactly by 1 . Since the initial value of \\(N\\) is 0 and its final value is 1 , the total number of insertions exceeds that of merges by exactly one. So, to maximize the number of moves, we need to maximize the number of insertions.\n\nWe will need the following lemma.\nLemma. If the binary representation of a positive integer \\(A\\) has \\(d\\) nonzero digits, then \\(A\\) cannot be represented as a sum of fewer than \\(d\\) powers of 2 . Moreover, any representation of \\(A\\) as a sum of \\(d\\) powers of 2 must coincide with its binary representation.\nProof. Let \\(s\\) be the minimum number of summands in all possible representations of \\(A\\) as sum of powers of 2. Suppose there is such a representation with \\(s\\) summands, where two of the summands are equal to each other. Then, replacing those two summands with the result of their sum, we obtain a representation with fewer than \\(s\\) summands, which is a contradiction. We deduce that in any representation with \\(s\\) summands, the summands are all distinct, so any such representation must coincide with the unique binary representation of \\(A\\), and \\(s=d\\).\n\nNow we split the solution into a sequence of claims.\nClaim 1. After every move, the number \\(S\\) is the sum of at most \\(k-1\\) distinct powers of 2.\nProof. If \\(S\\) is the sum of \\(k\\) (or more) distinct powers of 2 , the Lemma implies that the \\(k\\) cells are filled with these numbers. This is a contradiction since no more merges or insertions can be made.\n\nLet \\(A(n, k-1)\\) denote the set of all positive integers not exceeding \\(2^{n}\\) with at most \\(k-1\\) nonzero digits in its base 2 representation. Since every insertion increases the value of \\(S\\), by Claim 1, the total number of insertions is at most \\(|A(n, k-1)|\\). We proceed to prove that it is possible to achieve this number of insertions.\nClaim 2. Let \\(A(n, k-1)=\\left\\{a_{1}, a_{2}, \\ldots, a_{m}\\right\\}\\), with \\(a_{1}<a_{2}<\\cdots<a_{m}\\). If after some of Sir Alex's moves the value of \\(S\\) is \\(a_{j}\\), with \\(j \\in\\{1,2, \\ldots, m-1\\}\\), then there is a sequence of moves after which the value of \\(S\\) is exactly \\(a_{j+1}\\).\nProof. Suppose \\(S=a_{j}\\). Performing all possible merges, we eventually get different powers of 2 in all nonempty cells. After that, by Claim 1 there will be at least one empty cell, in which we want to insert \\(a_{j+1}-a_{j}\\). It remains to show that \\(a_{j+1}-a_{j}\\) is a power of 2 .\n\nFor this purpose, we notice that if \\(a_{j}\\) has less than \\(k-1\\) nonzero digits in base 2 then \\(a_{j+1}=a_{j}+1\\). Otherwise, we have \\(a_{j}=2^{b_{k-1}}+\\cdots+2^{b_{2}}+2^{b_{1}}\\) with \\(b_{1}<b_{2}<\\cdots<b_{k-1}\\). Then, adding any number less than \\(2^{b_{1}}\\) to \\(a_{j}\\) will result in a number with more than \\(k-1\\) nonzero\nbinary digits. On the other hand, \\(a_{j}+2^{b_{1}}\\) is a sum of \\(k\\) powers of 2 , not all distinct, so by the Lemma it will be a sum of less then \\(k\\) distinct powers of 2 . This means that \\(a_{j+1}-a_{j}=2^{b_{1}}\\), completing the proof.\n\nClaims 1 and 2 prove that the maximum number of insertions is \\(|A(n, k-1)|\\). We now compute this number.\nClaim 3. \\(|A(n, k-1)|=\\sum_{j=0}^{k-1}\\binom{n}{j}\\).\nProof. The number \\(2^{n}\\) is the only element of \\(A(n, k-1)\\) with \\(n+1\\) binary digits. Any other element has at most \\(n\\) binary digits, at least one and at most \\(k-1\\) of them are nonzero (so they are ones). For each \\(j \\in\\{1,2, \\ldots, k-1\\}\\), there are \\(\\binom{n}{j}\\) such elements with exactly \\(j\\) binary digits equal to one. We conclude that \\(|A(n, k-1)|=1+\\sum_{j=1}^{k-1}\\binom{n}{j}=\\sum_{j=0}^{k-1}\\binom{n}{j}\\).\n\nRecalling that the number of insertions exceeds that of merges by exactly 1 , we deduce that the maximum number of moves is \\(2 \\sum_{j=0}^{k-1}\\binom{n}{j}-1\\).", "source_pdf": "imosl_2017.pdf", "notes": "fallback-regex"}
{"id": "IMOSL-2017-C6", "contest": "IMOSL", "year": "2017", "problem_number": "C6", "problem": "Let \\(n>1\\) be an integer. An \\(n \\times n \\times n\\) cube is composed of \\(n^{3}\\) unit cubes. Each unit cube is painted with one color. For each \\(n \\times n \\times 1\\) box consisting of \\(n^{2}\\) unit cubes (of any of the three possible orientations), we consider the set of the colors present in that box (each color is listed only once). This way, we get \\(3 n\\) sets of colors, split into three groups according to the orientation. It happens that for every set in any group, the same set appears in both of the other groups. Determine, in terms of \\(n\\), the maximal possible number of colors that are present.\n(Russia)", "solution": "Answer: The maximal number is \\(\\frac{n(n+1)(2 n+1)}{6}\\).\n\n1. Call a \\(n \\times n \\times 1\\) box an \\(x\\)-box, a \\(y\\)-box, or a \\(z\\)-box, according to the direction of its short side. Let \\(C\\) be the number of colors in a valid configuration. We start with the upper bound for \\(C\\).\n\nLet \\(\\mathcal{C}_{1}, \\mathcal{C}_{2}\\), and \\(\\mathcal{C}_{3}\\) be the sets of colors which appear in the big cube exactly once, exactly twice, and at least thrice, respectively. Let \\(M_{i}\\) be the set of unit cubes whose colors are in \\(\\mathcal{C}_{i}\\), and denote \\(n_{i}=\\left|M_{i}\\right|\\).\n\nConsider any \\(x\\)-box \\(X\\), and let \\(Y\\) and \\(Z\\) be a \\(y\\) - and a \\(z\\)-box containing the same set of colors as \\(X\\) does.\nClaim. \\(4\\left|X \\cap M_{1}\\right|+\\left|X \\cap M_{2}\\right| \\leqslant 3 n+1\\).\nProof. We distinguish two cases.\nCase 1: \\(X \\cap M_{1} \\neq \\varnothing\\).\nA cube from \\(X \\cap M_{1}\\) should appear in all three boxes \\(X, Y\\), and \\(Z\\), so it should lie in \\(X \\cap Y \\cap Z\\). Thus \\(X \\cap M_{1}=X \\cap Y \\cap Z\\) and \\(\\left|X \\cap M_{1}\\right|=1\\).\n\nConsider now the cubes in \\(X \\cap M_{2}\\). There are at most 2(n-1) of them lying in \\(X \\cap Y\\) or \\(X \\cap Z\\) (because the cube from \\(X \\cap Y \\cap Z\\) is in \\(M_{1}\\) ). Let \\(a\\) be some other cube from \\(X \\cap M_{2}\\). Recall that there is just one other cube \\(a^{\\prime}\\) sharing a color with \\(a\\). But both \\(Y\\) and \\(Z\\) should contain such cube, so \\(a^{\\prime} \\in Y \\cap Z\\) (but \\(a^{\\prime} \\notin X \\cap Y \\cap Z\\) ). The map \\(a \\mapsto a^{\\prime}\\) is clearly injective, so the number of cubes \\(a\\) we are interested in does not exceed \\(|(Y \\cap Z) \\backslash X|=n-1\\). Thus \\(\\left|X \\cap M_{2}\\right| \\leqslant 2(n-1)+(n-1)=3(n-1)\\), and hence \\(4\\left|X \\cap M_{1}\\right|+\\left|X \\cap M_{2}\\right| \\leqslant 4+3(n-1)=3 n+1\\). Case 2: \\(X \\cap M_{1}=\\varnothing\\).\n\nIn this case, the same argument applies with several changes. Indeed, \\(X \\cap M_{2}\\) contains at most \\(2 n-1\\) cubes from \\(X \\cap Y\\) or \\(X \\cap Z\\). Any other cube \\(a\\) in \\(X \\cap M_{2}\\) corresponds to some \\(a^{\\prime} \\in Y \\cap Z\\) (possibly with \\(a^{\\prime} \\in X\\) ), so there are at most \\(n\\) of them. All this results in \\(\\left|X \\cap M_{2}\\right| \\leqslant(2 n-1)+n=3 n-1\\), which is even better than we need (by the assumptions of our case).\n\nSumming up the inequalities from the Claim over all \\(x\\)-boxes \\(X\\), we obtain\n\\[\n4 n_{1}+n_{2} \\leqslant n(3 n+1)\n\\]\n\nObviously, we also have \\(n_{1}+n_{2}+n_{3}=n^{3}\\).\nNow we are prepared to estimate \\(C\\). Due to the definition of the \\(M_{i}\\), we have \\(n_{i} \\geqslant i\\left|\\mathcal{C}_{i}\\right|\\), so\n\\[\nC \\leqslant n_{1}+\\frac{n_{2}}{2}+\\frac{n_{3}}{3}=\\frac{n_{1}+n_{2}+n_{3}}{3}+\\frac{4 n_{1}+n_{2}}{6} \\leqslant \\frac{n^{3}}{3}+\\frac{3 n^{2}+n}{6}=\\frac{n(n+1)(2 n+1)}{6} .\n\\]\n\nIt remains to present an example of an appropriate coloring in the above-mentioned number of colors. For each color, we present the set of all cubes of this color. These sets are:\n1. \\(n\\) singletons of the form \\(S_{i}=\\{(i, i, i)\\}\\) (with \\(1 \\leqslant i \\leqslant n\\) );\n2. \\(3\\binom{n}{2}\\) doubletons of the forms \\(D_{i, j}^{1}=\\{(i, j, j),(j, i, i)\\}, D_{i, j}^{2}=\\{(j, i, j),(i, j, i)\\}\\), and \\(D_{i, j}^{3}= \\{(j, j, i),(i, i, j)\\}(\\) with \\(1 \\leqslant i<j \\leqslant n) ;\\)\n3. \\(2\\binom{n}{3}\\) triplets of the form \\(T_{i, j, k}=\\{(i, j, k),(j, k, i),(k, i, j)\\}\\) (with \\(1 \\leqslant i<j<k \\leqslant n\\) or \\(1 \\leqslant i<k<j \\leqslant n\\) ).\n\nOne may easily see that the \\(i^{\\text {th }}\\) boxes of each orientation contain the same set of colors, and that\n\\[\nn+\\frac{3 n(n-1)}{2}+\\frac{n(n-1)(n-2)}{3}=\\frac{n(n+1)(2 n+1)}{6}\n\\]\ncolors are used, as required.\nSolution 2. We will approach a new version of the original problem. In this new version, each cube may have a color, or be invisible (not both). Now we make sets of colors for each \\(n \\times n \\times 1\\) box as before (where \"invisible\" is not considered a color) and group them by orientation, also as before. Finally, we require that, for every non-empty set in any group, the same set must appear in the other 2 groups. What is the maximum number of colors present with these new requirements?\n\nLet us call strange a big \\(n \\times n \\times n\\) cube whose painting scheme satisfies the new requirements, and let \\(D\\) be the number of colors in a strange cube. Note that any cube that satisfies the original requirements is also strange, so \\(\\max (D)\\) is an upper bound for the original answer.\nClaim. \\(D \\leqslant \\frac{n(n+1)(2 n+1)}{6}\\).\nProof. The proof is by induction on \\(n\\). If \\(n=1\\), we must paint the cube with at most 1 color.\nNow, pick a \\(n \\times n \\times n\\) strange cube \\(A\\), where \\(n \\geqslant 2\\). If \\(A\\) is completely invisible, \\(D=0\\) and we are done. Otherwise, pick a non-empty set of colors \\(\\mathcal{S}\\) which corresponds to, say, the boxes \\(X, Y\\) and \\(Z\\) of different orientations.\n\nNow find all cubes in \\(A\\) whose colors are in \\(\\mathcal{S}\\) and make them invisible. Since \\(X, Y\\) and \\(Z\\) are now completely invisible, we can throw them away and focus on the remaining \\((n-1) \\times(n-1) \\times(n-1)\\) cube \\(B\\). The sets of colors in all the groups for \\(B\\) are the same as the sets for \\(A\\), removing exactly the colors in \\(\\mathcal{S}\\), and no others! Therefore, every nonempty set that appears in one group for \\(B\\) still shows up in all possible orientations (it is possible that an empty set of colors in \\(B\\) only matched \\(X, Y\\) or \\(Z\\) before these were thrown away, but remember we do not require empty sets to match anyway). In summary, \\(B\\) is also strange.\n\nBy the induction hypothesis, we may assume that \\(B\\) has at most \\(\\frac{(n-1) n(2 n-1)}{6}\\) colors. Since there were at most \\(n^{2}\\) different colors in \\(\\mathcal{S}\\), we have that \\(A\\) has at most \\(\\frac{(n-1) n(2 n-1)}{6}+n^{2}= \\frac{n(n+1)(2 n+1)}{6}\\) colors.\n\nFinally, the construction in the previous solution shows a painting scheme (with no invisible cubes) that reaches this maximum, so we are done.", "source_pdf": "imosl_2017.pdf", "notes": "fallback-regex"}
{"id": "IMOSL-2017-C7", "contest": "IMOSL", "year": "2017", "problem_number": "C7", "problem": "For any finite sets \\(X\\) and \\(Y\\) of positive integers, denote by \\(f_{X}(k)\\) the \\(k^{\\text {th }}\\) smallest positive integer not in \\(X\\), and let\n\\[\nX * Y=X \\cup\\left\\{f_{X}(y): y \\in Y\\right\\}\n\\]\n\nLet \\(A\\) be a set of \\(a>0\\) positive integers, and let \\(B\\) be a set of \\(b>0\\) positive integers. Prove that if \\(A * B=B * A\\), then\n\\[\n\\underbrace{A *(A * \\cdots *(A *(A * A)) \\cdots)}_{A \\text { appears } b \\text { times }}=\\underbrace{B *(B * \\cdots *(B *(B * B)) \\cdots)}_{B \\text { appears } a \\text { times }} .\n\\]", "solution": "1. For any function \\(g: \\mathbb{Z}_{>0} \\rightarrow \\mathbb{Z}_{>0}\\) and any subset \\(X \\subset \\mathbb{Z}_{>0}\\), we define \\(g(X)= \\{g(x): x \\in X\\}\\). We have that the image of \\(f_{X}\\) is \\(f_{X}\\left(\\mathbb{Z}_{>0}\\right)=\\mathbb{Z}_{>0} \\backslash X\\). We now show a general lemma about the operation \\(*\\), with the goal of showing that \\(*\\) is associative.\nLemma 1. Let \\(X\\) and \\(Y\\) be finite sets of positive integers. The functions \\(f_{X * Y}\\) and \\(f_{X} \\circ f_{Y}\\) are equal.\nProof. We have\n\\(f_{X * Y}\\left(\\mathbb{Z}_{>0}\\right)=\\mathbb{Z}_{>0} \\backslash(X * Y)=\\left(\\mathbb{Z}_{>0} \\backslash X\\right) \\backslash f_{X}(Y)=f_{X}\\left(\\mathbb{Z}_{>0}\\right) \\backslash f_{X}(Y)=f_{X}\\left(\\mathbb{Z}_{>0} \\backslash Y\\right)=f_{X}\\left(f_{Y}\\left(\\mathbb{Z}_{>0}\\right)\\right)\\).\nThus, the functions \\(f_{X * Y}\\) and \\(f_{X} \\circ f_{Y}\\) are strictly increasing functions with the same range. Because a strictly function is uniquely defined by its range, we have \\(f_{X * Y}=f_{X} \\circ f_{Y}\\).\n\nLemma 1 implies that \\(*\\) is associative, in the sense that \\((A * B) * C=A *(B * C)\\) for any finite sets \\(A, B\\), and \\(C\\) of positive integers. We prove the associativity by noting\n\\[\n\\begin{gathered}\n\\mathbb{Z}_{>0} \\backslash((A * B) * C)=f_{(A * B) * C}\\left(\\mathbb{Z}_{>0}\\right)=f_{A * B}\\left(f_{C}\\left(\\mathbb{Z}_{>0}\\right)\\right)=f_{A}\\left(f_{B}\\left(f_{C}\\left(\\mathbb{Z}_{>0}\\right)\\right)\\right) \\\\\n=f_{A}\\left(f_{B * C}\\left(\\mathbb{Z}_{>0}\\right)=f_{A *(B * C)}\\left(\\mathbb{Z}_{>0}\\right)=\\mathbb{Z}_{>0} \\backslash(A *(B * C))\\right.\n\\end{gathered}\n\\]\n\nIn light of the associativity of *, we may drop the parentheses when we write expressions like \\(A *(B * C)\\). We also introduce the notation\n\\[\nX^{* k}=\\underbrace{X *(X * \\cdots *(X *(X * X)) \\cdots)}_{X \\text { appears } k \\text { times }}\n\\]\n\nOur goal is then to show that \\(A * B=B * A\\) implies \\(A^{* b}=B^{* a}\\). We will do so via the following general lemma.\nLemma 2. Suppose that \\(X\\) and \\(Y\\) are finite sets of positive integers satisfying \\(X * Y=Y * X\\) and \\(|X|=|Y|\\). Then, we must have \\(X=Y\\).\nProof. Assume that \\(X\\) and \\(Y\\) are not equal. Let \\(s\\) be the largest number in exactly one of \\(X\\) and \\(Y\\). Without loss of generality, say that \\(s \\in X \\backslash Y\\). The number \\(f_{X}(s)\\) counts the \\(s^{t h}\\) number not in \\(X\\), which implies that\n\\[\nf_{X}(s)=s+\\left|X \\cap\\left\\{1,2, \\ldots, f_{X}(s)\\right\\}\\right|\n\\]\n\nSince \\(f_{X}(s) \\geqslant s\\), we have that\n\\[\n\\left\\{f_{X}(s)+1, f_{X}(s)+2, \\ldots\\right\\} \\cap X=\\left\\{f_{X}(s)+1, f_{X}(s)+2, \\ldots\\right\\} \\cap Y\n\\]\nwhich, together with the assumption that \\(|X|=|Y|\\), gives\n\\[\n\\left|X \\cap\\left\\{1,2, \\ldots, f_{X}(s)\\right\\}\\right|=\\left|Y \\cap\\left\\{1,2, \\ldots, f_{X}(s)\\right\\}\\right|\n\\]\n\nNow consider the equation\n\\[\nt-|Y \\cap\\{1,2, \\ldots, t\\}|=s\n\\]\n\nThis equation is satisfied only when \\(t \\in\\left[f_{Y}(s), f_{Y}(s+1)\\right)\\), because the left hand side counts the number of elements up to \\(t\\) that are not in \\(Y\\). We have that the value \\(t=f_{X}(s)\\) satisfies the above equation because of (1) and (2). Furthermore, since \\(f_{X}(s) \\notin X\\) and \\(f_{X}(s) \\geqslant s\\), we have that \\(f_{X}(s) \\notin Y\\) due to the maximality of \\(s\\). Thus, by the above discussion, we must have \\(f_{X}(s)=f_{Y}(s)\\).\n\nFinally, we arrive at a contradiction. The value \\(f_{X}(s)\\) is neither in \\(X\\) nor in \\(f_{X}(Y)\\), because \\(s\\) is not in \\(Y\\) by assumption. Thus, \\(f_{X}(s) \\notin X * Y\\). However, since \\(s \\in X\\), we have \\(f_{Y}(s) \\in Y * X\\), a contradiction.\n\nWe are now ready to finish the proof. Note first of all that \\(\\left|A^{* b}\\right|=a b=\\left|B^{* a}\\right|\\). Moreover, since \\(A * B=B * A\\), and \\(*\\) is associative, it follows that \\(A^{* b} * B^{* a}=B^{* a} * A^{* b}\\). Thus, by Lemma 2, we have \\(A^{* b}=B^{* a}\\), as desired.\n\nComment 1. Taking \\(A=X^{* k}\\) and \\(B=X^{* l}\\) generates many non-trivial examples where \\(A * B=B * A\\). There are also other examples not of this form. For example, if \\(A=\\{1,2,4\\}\\) and \\(B=\\{1,3\\}\\), then \\(A * B=\\{1,2,3,4,6\\}=B * A\\).\nSolution 2. We will use Lemma 1 from Solution 1. Additionally, let \\(X^{* k}\\) be defined as in Solution 1. If \\(X\\) and \\(Y\\) are finite sets, then\n\\[\nf_{X}=f_{Y} \\Longleftrightarrow f_{X}\\left(\\mathbb{Z}_{>0}\\right)=f_{Y}\\left(\\mathbb{Z}_{>0}\\right) \\Longleftrightarrow\\left(\\mathbb{Z}_{>0} \\backslash X\\right)=\\left(\\mathbb{Z}_{>0} \\backslash Y\\right) \\Longleftrightarrow X=Y,\n\\]\nwhere the first equivalence is because \\(f_{X}\\) and \\(f_{Y}\\) are strictly increasing functions, and the second equivalence is because \\(f_{X}\\left(\\mathbb{Z}_{>0}\\right)=\\mathbb{Z}_{>0} \\backslash X\\) and \\(f_{Y}\\left(\\mathbb{Z}_{>0}\\right)=\\mathbb{Z}_{>0} \\backslash Y\\).\n\nDenote \\(g=f_{A}\\) and \\(h=f_{B}\\). The given relation \\(A * B=B * A\\) is equivalent to \\(f_{A * B}=f_{B * A}\\) because of (3), and by Lemma 1 of the first solution, this is equivalent to \\(g \\circ h=h \\circ g\\). Similarly, the required relation \\(A^{* b}=B^{* a}\\) is equivalent to \\(g^{b}=h^{a}\\). We will show that\n\\[\ng^{b}(n)=h^{a}(n)\n\\]\nfor all \\(n \\in \\mathbb{Z}_{>0}\\), which suffices to solve the problem.\nTo start, we claim that (4) holds for all sufficiently large \\(n\\). Indeed, let \\(p\\) and \\(q\\) be the maximal elements of \\(A\\) and \\(B\\), respectively; we may assume that \\(p \\geqslant q\\). Then, for every \\(n \\geqslant p\\) we have \\(g(n)=n+a\\) and \\(h(n)=n+b\\), whence \\(g^{b}(n)=n+a b=h^{a}(n)\\), as was claimed.\n\nIn view of this claim, if (4) is not identically true, then there exists a maximal \\(s\\) with \\(g^{b}(s) \\neq h^{a}(s)\\). Without loss of generality, we may assume that \\(g(s) \\neq s\\), for if we had \\(g(s)=h(s)=s\\), then \\(s\\) would satisfy (4). As \\(g\\) is increasing, we then have \\(g(s)>s\\), so (4) holds for \\(n=g(s)\\). But then we have\n\\[\ng\\left(g^{b}(s)\\right)=g^{b+1}(s)=g^{b}(n)=h^{a}(n)=h^{a}(g(s))=g\\left(h^{a}(s)\\right)\n\\]\nwhere the last equality holds in view of \\(g \\circ h=h \\circ g\\). By the injectivity of \\(g\\), the above equality yields \\(g^{b}(s)=h^{a}(s)\\), which contradicts the choice of \\(s\\). Thus, we have proved that (4) is identically true on \\(\\mathbb{Z}_{>0}\\), as desired.\n\nComment 2. We present another proof of Lemma 2 of the first solution.\nLet \\(x=|X|=|Y|\\). Say that \\(u\\) is the smallest number in \\(X\\) and \\(v\\) is the smallest number in \\(Y\\); assume without loss of generality that \\(u \\leqslant v\\).\n\nLet \\(T\\) be any finite set of positive integers, and define \\(t=|T|\\). Enumerate the elements of \\(X\\) as \\(x_{1}<x_{2}<\\cdots<x_{n}\\). Define \\(S_{m}=f_{\\left(T * X^{*(m-1)}\\right)}(X)\\), and enumerate its elements \\(s_{m, 1}<s_{m, 2}<\\cdots< s_{m, n}\\). Note that the \\(S_{m}\\) are pairwise disjoint; indeed, if we have \\(m<m^{\\prime}\\), then\n\\[\nS_{m} \\subset T * X^{* m} \\subset T * X^{*\\left(m^{\\prime}-1\\right)} \\quad \\text { and } \\quad S_{m^{\\prime}}=\\left(T * X^{* m^{\\prime}}\\right) \\backslash\\left(T * X^{*\\left(m^{\\prime}-1\\right)}\\right)\n\\]\n\nWe claim the following statement, which essentially says that the \\(S_{m}\\) are eventually linear translates of each other:\n\nClaim. For every \\(i\\), there exists some \\(m_{i}\\) and \\(c_{i}\\) such that for all \\(m>m_{i}\\), we have that \\(s_{m, i}=t+m n-c_{i}\\). Furthermore, the \\(c_{i}\\) do not depend on the choice of \\(T\\).\n\nFirst, we show that this claim implies Lemma 2. We may choose \\(T=X\\) and \\(T=Y\\). Then, there is some \\(m^{\\prime}\\) such that for all \\(m \\geqslant m^{\\prime}\\), we have\n\\[\nf_{X^{* m}}(X)=f_{\\left(Y * X^{*(m-1)}\\right)}(X)\n\\]\n\nBecause \\(u\\) is the minimum element of \\(X, v\\) is the minimum element of \\(Y\\), and \\(u \\leqslant v\\), we have that\n\\[\n\\left(\\bigcup_{m=m^{\\prime}}^{\\infty} f_{X^{* m}}(X)\\right) \\cup X^{* m^{\\prime}}=\\left(\\bigcup_{m=m^{\\prime}}^{\\infty} f_{\\left(Y * X^{*(m-1)}\\right)}(X)\\right) \\cup\\left(Y * X^{*\\left(m^{\\prime}-1\\right)}\\right)=\\{u, u+1, \\ldots\\}\n\\]\nand in both the first and second expressions, the unions are of pairwise distinct sets. By (5), we obtain \\(X^{* m^{\\prime}}=Y * X^{*\\left(m^{\\prime}-1\\right)}\\). Now, because \\(X\\) and \\(Y\\) commute, we get \\(X^{* m^{\\prime}}=X^{*\\left(m^{\\prime}-1\\right)} * Y\\), and so \\(X=Y\\).\n\nWe now prove the claim.\nProof of the claim. We induct downwards on \\(i\\), first proving the statement for \\(i=n\\), and so on.\nAssume that \\(m\\) is chosen so that all elements of \\(S_{m}\\) are greater than all elements of \\(T\\) (which is possible because \\(T\\) is finite). For \\(i=n\\), we have that \\(s_{m, n}>s_{k, n}\\) for every \\(k<m\\). Thus, all \\((m-1) n\\) numbers of the form \\(s_{k, u}\\) for \\(k<m\\) and \\(1 \\leqslant u \\leqslant n\\) are less than \\(s_{m, n}\\). We then have that \\(s_{m, n}\\) is the \\(\\left((m-1) n+x_{n}\\right)^{\\text {th }}\\) number not in \\(T\\), which is equal to \\(t+(m-1) n+x_{n}\\). So we may choose \\(c_{n}=x_{n}-n\\), which does not depend on \\(T\\), which proves the base case for the induction.\n\nFor \\(i<n\\), we have again that all elements \\(s_{m, j}\\) for \\(j<i\\) and \\(s_{p, i}\\) for \\(p<m\\) are less than \\(s_{m, i}\\), so \\(s_{m, i}\\) is the \\(\\left((m-1) i+x_{i}\\right)^{\\text {th }}\\) element not in \\(T\\) or of the form \\(s_{p, j}\\) for \\(j>i\\) and \\(p<m\\). But by the inductive hypothesis, each of the sequences \\(s_{p, j}\\) is eventually periodic with period \\(n\\), and thus the sequence \\(s_{m, i}\\) such must be as well. Since each of the sequences \\(s_{p, j}-t\\) with \\(j>i\\) eventually do not depend on \\(T\\), the sequence \\(s_{m, i}-t\\) eventually does not depend on \\(T\\) either, so the inductive step is complete. This proves the claim and thus Lemma 2.", "source_pdf": "imosl_2017.pdf", "notes": "fallback-regex"}
{"id": "IMOSL-2017-C8", "contest": "IMOSL", "year": "2017", "problem_number": "C8", "problem": "Let \\(n\\) be a given positive integer. In the Cartesian plane, each lattice point with nonnegative coordinates initially contains a butterfly, and there are no other butterflies. The neighborhood of a lattice point \\(c\\) consists of all lattice points within the axis-aligned \\((2 n+1) \\times (2 n+1)\\) square centered at \\(c\\), apart from \\(c\\) itself. We call a butterfly lonely, crowded, or comfortable, depending on whether the number of butterflies in its neighborhood \\(N\\) is respectively less than, greater than, or equal to half of the number of lattice points in \\(N\\).\n\nEvery minute, all lonely butterflies fly away simultaneously. This process goes on for as long as there are any lonely butterflies. Assuming that the process eventually stops, determine the number of comfortable butterflies at the final state.\n(Bulgaria)", "solution": "Answer: \\(n^{2}+1\\).\n\n. We always identify a butterfly with the lattice point it is situated at. For two points \\(p\\) and \\(q\\), we write \\(p \\geqslant q\\) if each coordinate of \\(p\\) is at least the corresponding coordinate of \\(q\\). Let \\(O\\) be the origin, and let \\(\\mathcal{Q}\\) be the set of initially occupied points, i.e., of all lattice points with nonnegative coordinates. Let \\(\\mathcal{R}_{\\mathrm{H}}=\\{(x, 0): x \\geqslant 0\\}\\) and \\(\\mathcal{R}_{\\mathrm{V}}=\\{(0, y): y \\geqslant 0\\}\\) be the sets of the lattice points lying on the horizontal and vertical boundary rays of \\(\\mathcal{Q}\\). Denote by \\(N(a)\\) the neighborhood of a lattice point \\(a\\).\n1. Initial observations. We call a set of lattice points up-right closed if its points stay in the set after being shifted by any lattice vector \\((i, j)\\) with \\(i, j \\geqslant 0\\). Whenever the butterflies form a up-right closed set \\(\\mathcal{S}\\), we have \\(|N(p) \\cap \\mathcal{S}| \\geqslant|N(q) \\cap \\mathcal{S}|\\) for any two points \\(p, q \\in \\mathcal{S}\\) with \\(p \\geqslant q\\). So, since \\(\\mathcal{Q}\\) is up-right closed, the set of butterflies at any moment also preserves this property. We assume all forthcoming sets of lattice points to be up-right closed.\n\nWhen speaking of some set \\(\\mathcal{S}\\) of lattice points, we call its points lonely, comfortable, or crowded with respect to this set (i.e., as if the butterflies were exactly at all points of \\(\\mathcal{S}\\) ). We call a set \\(\\mathcal{S} \\subset \\mathcal{Q}\\) stable if it contains no lonely points. In what follows, we are interested only in those stable sets whose complements in \\(\\mathcal{Q}\\) are finite, because one can easily see that only a finite number of butterflies can fly away on each minute.\n\nIf the initial set \\(\\mathcal{Q}\\) of butterflies contains some stable set \\(\\mathcal{S}\\), then, clearly no butterfly of this set will fly away. On the other hand, the set \\(\\mathcal{F}\\) of all butterflies in the end of the process is stable. This means that \\(\\mathcal{F}\\) is the largest (with respect to inclusion) stable set within \\(\\mathcal{Q}\\), and we are about to describe this set.\n2. A description of a final set. The following notion will be useful. Let \\(\\mathcal{U}=\\left\\{\\vec{u}_{1}, \\vec{u}_{2}, \\ldots, \\vec{u}_{d}\\right\\}\\) be a set of \\(d\\) pairwise non-parallel lattice vectors, each having a positive \\(x\\) - and a negative \\(y\\)-coordinate. Assume that they are numbered in increasing order according to slope. We now define a \\(\\mathcal{U}\\)-curve to be the broken line \\(p_{0} p_{1} \\ldots p_{d}\\) such that \\(p_{0} \\in \\mathcal{R}_{\\mathrm{V}}, p_{d} \\in \\mathcal{R}_{\\mathrm{H}}\\), and \\(\\overrightarrow{p_{i-1} p_{i}}=\\vec{u}_{i}\\) for all \\(i=1,2, \\ldots, m\\) (see the Figure below to the left).\n\n\\begin{figure}\n\\includegraphics[width=\\textwidth]{https://cdn.mathpix.com/cropped/2025_08_23_4b06fd0385d65a4d803fg-53.jpg?height=535&width=757&top_left_y=2198&top_left_x=197}\n\\captionsetup{labelformat=empty}\n\\caption{Construction of \\(\\mathcal{U}\\)-curve}\n\\end{figure}\n\n\\begin{figure}\n\\includegraphics[width=\\textwidth]{https://cdn.mathpix.com/cropped/2025_08_23_4b06fd0385d65a4d803fg-53.jpg?height=421&width=801&top_left_y=2312&top_left_x=1067}\n\\captionsetup{labelformat=empty}\n\\caption{Construction of \\(\\mathcal{D}\\)}\n\\end{figure}\n\nNow, let \\(\\mathcal{K}_{n}=\\{(i, j): 1 \\leqslant i \\leqslant n,-n \\leqslant j \\leqslant-1\\}\\). Consider all the rays emerging at \\(O\\) and passing through a point from \\(\\mathcal{K}_{n}\\); number them as \\(r_{1}, \\ldots, r_{m}\\) in increasing order according to slope. Let \\(A_{i}\\) be the farthest from \\(O\\) lattice point in \\(r_{i} \\cap \\mathcal{K}_{n}\\), set \\(k_{i}=\\left|r_{i} \\cap \\mathcal{K}_{n}\\right|\\), let \\(\\vec{v}_{i}=\\overrightarrow{O A_{i}}\\), and finally denote \\(\\mathcal{V}=\\left\\{\\vec{v}_{i}: 1 \\leqslant i \\leqslant m\\right\\}\\); see the Figure above to the right. We will concentrate on the \\(\\mathcal{V}\\)-curve \\(d_{0} d_{1} \\ldots d_{m}\\); let \\(\\mathcal{D}\\) be the set of all lattice points \\(p\\) such that \\(p \\geqslant p^{\\prime}\\) for some (not necessarily lattice) point \\(p^{\\prime}\\) on the \\(\\mathcal{V}\\)-curve. In fact, we will show that \\(\\mathcal{D}=\\mathcal{F}\\).\n\nClearly, the \\(\\mathcal{V}\\)-curve is symmetric in the line \\(y=x\\). Denote by \\(D\\) the convex hull of \\(\\mathcal{D}\\).\n3. We prove that the set \\(\\mathcal{D}\\) contains all stable sets. Let \\(\\mathcal{S} \\subset \\mathcal{Q}\\) be a stable set (recall that it is assumed to be up-right closed and to have a finite complement in \\(\\mathcal{Q}\\) ). Denote by \\(S\\) its convex hull; clearly, the vertices of \\(S\\) are lattice points. The boundary of \\(S\\) consists of two rays (horizontal and vertical ones) along with some \\(\\mathcal{V}_{*}\\)-curve for some set of lattice vectors \\(\\mathcal{V}_{*}\\).\nClaim 1. For every \\(\\vec{v}_{i} \\in \\mathcal{V}\\), there is a \\(\\vec{v}_{i}^{*} \\in \\mathcal{V}_{*}\\) co-directed with \\(\\vec{v}\\) with \\(\\left|\\vec{v}_{i}^{*}\\right| \\geqslant|\\vec{v}|\\).\nProof. Let \\(\\ell\\) be the supporting line of \\(S\\) parallel to \\(\\vec{v}_{i}\\) (i.e., \\(\\ell\\) contains some point of \\(S\\), and the set \\(S\\) lies on one side of \\(\\ell\\) ). Take any point \\(b \\in \\ell \\cap \\mathcal{S}\\) and consider \\(N(b)\\). The line \\(\\ell\\) splits the set \\(N(b) \\backslash \\ell\\) into two congruent parts, one having an empty intersection with \\(\\mathcal{S}\\). Hence, in order for \\(b\\) not to be lonely, at least half of the set \\(\\ell \\cap N(b)\\) (which contains \\(2 k_{i}\\) points) should lie in \\(S\\). Thus, the boundary of \\(S\\) contains a segment \\(\\ell \\cap S\\) with at least \\(k_{i}+1\\) lattice points (including b) on it; this segment corresponds to the required vector \\(\\vec{v}_{i}^{*} \\in \\mathcal{V}_{*}\\).\n![](https://cdn.mathpix.com/cropped/2025_08_23_4b06fd0385d65a4d803fg-54.jpg?height=597&width=1625&top_left_y=1202&top_left_x=217)\n\nClaim 2. Each stable set \\(\\mathcal{S} \\subseteq \\mathcal{Q}\\) lies in \\(\\mathcal{D}\\).\nProof. To show this, it suffices to prove that the \\(\\mathcal{V}_{*}\\)-curve lies in \\(D\\), i.e., that all its vertices do so. Let \\(p^{\\prime}\\) be an arbitrary vertex of the \\(\\mathcal{V}_{*}\\)-curve; \\(p^{\\prime}\\) partitions this curve into two parts, \\(\\mathcal{X}\\) (being down-right of \\(p\\) ) and \\(\\mathcal{Y}\\) (being up-left of \\(p\\) ). The set \\(\\mathcal{V}\\) is split now into two parts: \\(\\mathcal{V}_{\\mathcal{X}}\\) consisting of those \\(\\vec{v}_{i} \\in \\mathcal{V}\\) for which \\(\\vec{v}_{i}^{*}\\) corresponds to a segment in \\(\\mathcal{X}\\), and a similar part \\(\\mathcal{V}_{\\mathcal{Y}}\\). Notice that the \\(\\mathcal{V}\\)-curve consists of several segments corresponding to \\(\\mathcal{V}_{\\mathcal{X}}\\), followed by those corresponding to \\(\\mathcal{V}_{\\mathcal{Y}}\\). Hence there is a vertex \\(p\\) of the \\(\\mathcal{V}\\)-curve separating \\(\\mathcal{V}_{\\mathcal{X}}\\) from \\(\\mathcal{V}_{\\mathcal{Y}}\\). Claim 1 now yields that \\(p^{\\prime} \\geqslant p\\), so \\(p^{\\prime} \\in \\mathcal{D}\\), as required.\n\nClaim 2 implies that the final set \\(\\mathcal{F}\\) is contained in \\(\\mathcal{D}\\).\n4. \\(\\mathcal{D}\\) is stable, and its comfortable points are known. Recall the definitions of \\(r_{i}\\); let \\(r_{i}^{\\prime}\\) be the ray complementary to \\(r_{i}\\). By our definitions, the set \\(N(O)\\) contains no points between the rays \\(r_{i}\\) and \\(r_{i+1}\\), as well as between \\(r_{i}^{\\prime}\\) and \\(r_{i+1}^{\\prime}\\).\nClaim 3. In the set \\(\\mathcal{D}\\), all lattice points of the \\(\\mathcal{V}\\)-curve are comfortable.\nProof. Let \\(p\\) be any lattice point of the \\(\\mathcal{V}\\)-curve, belonging to some segment \\(d_{i} d_{i+1}\\). Draw the line \\(\\ell\\) containing this segment. Then \\(\\ell \\cap \\mathcal{D}\\) contains exactly \\(k_{i}+1\\) lattice points, all of which lie in \\(N(p)\\) except for \\(p\\). Thus, exactly half of the points in \\(N(p) \\cap \\ell\\) lie in \\(\\mathcal{D}\\). It remains to show that all points of \\(N(p)\\) above \\(\\ell\\) lie in \\(\\mathcal{D}\\) (recall that all the points below \\(\\ell\\) lack this property).\n\nNotice that each vector in \\(\\mathcal{V}\\) has one coordinate greater than \\(n / 2\\); thus the neighborhood of \\(p\\) contains parts of at most two segments of the \\(\\mathcal{V}\\)-curve succeeding \\(d_{i} d_{i+1}\\), as well as at most two of those preceding it.\n\nThe angles formed by these consecutive segments are obtained from those formed by \\(r_{j}\\) and \\(r_{j-1}^{\\prime}\\) (with \\(i-1 \\leqslant j \\leqslant i+2\\) ) by shifts; see the Figure below. All the points in \\(N(p)\\) above \\(\\ell\\) which could lie outside \\(\\mathcal{D}\\) lie in shifted angles between \\(r_{j}, r_{j+1}\\) or \\(r_{j}^{\\prime}, r_{j-1}^{\\prime}\\). But those angles, restricted to \\(N(p)\\), have no lattice points due to the above remark. The claim is proved.\n\n\\begin{figure}\n\\includegraphics[width=\\textwidth]{https://cdn.mathpix.com/cropped/2025_08_23_4b06fd0385d65a4d803fg-55.jpg?height=398&width=1049&top_left_y=599&top_left_x=508}\n\\captionsetup{labelformat=empty}\n\\caption{Proof of Claim 3}\n\\end{figure}\n\nClaim 4. All the points of \\(\\mathcal{D}\\) which are not on the boundary of \\(D\\) are crowded.\nProof. Let \\(p \\in \\mathcal{D}\\) be such a point. If it is to the up-right of some point \\(p^{\\prime}\\) on the curve, then the claim is easy: the shift of \\(N\\left(p^{\\prime}\\right) \\cap \\mathcal{D}\\) by \\(\\overrightarrow{p^{\\prime} p}\\) is still in \\(\\mathcal{D}\\), and \\(N(p)\\) contains at least one more point of \\(\\mathcal{D}\\) - either below or to the left of \\(p\\). So, we may assume that \\(p\\) lies in a right triangle constructed on some hypothenuse \\(d_{i} d_{i+1}\\). Notice here that \\(d_{i}, d_{i+1} \\in N(p)\\).\n\nDraw a line \\(\\ell \\| d_{i} d_{i+1}\\) through \\(p\\), and draw a vertical line \\(h\\) through \\(d_{i}\\); see Figure below. Let \\(\\mathcal{D}_{\\mathrm{L}}\\) and \\(\\mathcal{D}_{\\mathrm{R}}\\) be the parts of \\(\\mathcal{D}\\) lying to the left and to the right of \\(h\\), respectively (points of \\(\\mathcal{D} \\cap h\\) lie in both parts).\n![](https://cdn.mathpix.com/cropped/2025_08_23_4b06fd0385d65a4d803fg-55.jpg?height=527&width=1120&top_left_y=1561&top_left_x=468)\n\nNotice that the vectors \\(\\overrightarrow{d_{i} p}, \\overrightarrow{d_{i+1} d_{i+2}}, \\overrightarrow{d_{i} d_{i+1}}, \\overrightarrow{d_{i-1} d_{i}}\\), and \\(\\overrightarrow{p d_{i+1}}\\) are arranged in non-increasing order by slope. This means that \\(\\mathcal{D}_{\\mathrm{L}}\\) shifted by \\(\\overrightarrow{d_{i} p}\\) still lies in \\(\\mathcal{D}\\), as well as \\(\\mathcal{D}_{\\mathrm{R}}\\) shifted by \\(\\overrightarrow{d_{i+1} p}\\). As we have seen in the proof of Claim 3, these two shifts cover all points of \\(N(p)\\) above \\(\\ell\\), along with those on \\(\\ell\\) to the left of \\(p\\). Since \\(N(p)\\) contains also \\(d_{i}\\) and \\(d_{i+1}\\), the point \\(p\\) is crowded.\n\nThus, we have proved that \\(\\mathcal{D}=\\mathcal{F}\\), and have shown that the lattice points on the \\(\\mathcal{V}\\)-curve are exactly the comfortable points of \\(\\mathcal{D}\\). It remains to find their number.\n\nRecall the definition of \\(\\mathcal{K}_{n}\\) (see Figure on the first page of the solution). Each segment \\(d_{i} d_{i+1}\\) contains \\(k_{i}\\) lattice points different from \\(d_{i}\\). Taken over all \\(i\\), these points exhaust all the lattice points in the \\(\\mathcal{V}\\)-curve, except for \\(d_{1}\\), and thus the number of lattice points on the \\(\\mathcal{V}\\)-curve is \\(1+\\sum_{i=1}^{m} k_{i}\\). On the other hand, \\(\\sum_{i=1}^{m} k_{i}\\) is just the number of points in \\(\\mathcal{K}_{n}\\), so it equals \\(n^{2}\\). Hence the answer to the problem is \\(n^{2}+1\\).\n\nComment 1. The assumption that the process eventually stops is unnecessary for the problem, as one can see that, in fact, the process stops for every \\(n \\geqslant 1\\). Indeed, the proof of Claims 3 and 4 do not rely essentially on this assumption, and they together yield that the set \\(\\mathcal{D}\\) is stable. So, only butterflies that are not in \\(\\mathcal{D}\\) may fly away, and this takes only a finite time.\n\nThis assumption has been inserted into the problem statement in order to avoid several technical details regarding finiteness issues. It may also simplify several other arguments.\n\nComment 2. The description of the final set \\(\\mathcal{F}(=\\mathcal{D})\\) seems to be crucial for the solution; the Problem Selection Committee is not aware of any solution that completely avoids such a description.\n\nOn the other hand, after the set \\(\\mathcal{D}\\) has been defined, the further steps may be performed in several ways. For example, in order to prove that all butterflies outside \\(\\mathcal{D}\\) will fly away, one may argue as follows. (Here we will also make use of the assumption that the process eventually stops.)\n\nFirst of all, notice that the process can be modified in the following manner: Each minute, exactly one of the lonely butterflies flies away, until there are no more lonely butterflies. The modified process necessarily stops at the same state as the initial one. Indeed, one may observe, as in solution above, that the (unique) largest stable set is still the final set for the modified process.\n\nThus, in order to prove our claim, it suffices to indicate an order in which the butterflies should fly away in the new process; if we are able to exhaust the whole set \\(\\mathcal{Q} \\backslash \\mathcal{D}\\), we are done.\n\nLet \\(\\mathcal{C}_{0}=d_{0} d_{1} \\ldots d_{m}\\) be the \\(\\mathcal{V}\\)-curve. Take its copy \\(\\mathcal{C}\\) and shift it downwards so that \\(d_{0}\\) comes to some point below the origin \\(O\\). Now we start moving \\(\\mathcal{C}\\) upwards continuously, until it comes back to its initial position \\(\\mathcal{C}_{0}\\). At each moment when \\(\\mathcal{C}\\) meets some lattice points, we convince all the butterflies at those points to fly away in a certain order. We will now show that we always have enough arguments for butterflies to do so, which will finish our argument for the claim..\n\nLet \\(\\mathcal{C}^{\\prime}=d_{0}^{\\prime} d_{1}^{\\prime} \\ldots d_{m}^{\\prime}\\) be a position of \\(\\mathcal{C}\\) when it meets some butterflies. We assume that all butterflies under this current position of \\(\\mathcal{C}\\) were already convinced enough and flied away. Consider the lowest butterfly \\(b\\) on \\(\\mathcal{C}^{\\prime}\\). Let \\(d_{i}^{\\prime} d_{i+1}^{\\prime}\\) be the segment it lies on; we choose \\(i\\) so that \\(b \\neq d_{i+1}^{\\prime}\\) (this is possible because \\(\\mathcal{C}\\) as not yet reached \\(\\mathcal{C}_{0}\\) ).\n\nDraw a line \\(\\ell\\) containing the segment \\(d_{i}^{\\prime} d_{i+1}^{\\prime}\\). Then all the butterflies in \\(N(b)\\) are situated on or above \\(\\ell\\); moreover, those on \\(\\ell\\) all lie on the segment \\(d_{i} d_{i+1}\\). But this segment now contains at most \\(k_{i}\\) butterflies (including \\(b\\) ), since otherwise some butterfly had to occupy \\(d_{i+1}^{\\prime}\\) which is impossible by the choice of \\(b\\). Thus, \\(b\\) is lonely and hence may be convinced to fly away.\n\nAfter \\(b\\) has flied away, we switch to the lowest of the remaining butterflies on \\(\\mathcal{C}^{\\prime}\\), and so on.\nClaims 3 and 4 also allow some different proofs which are not presented here.", "source_pdf": "imosl_2017.pdf", "notes": "fallback-regex"}
{"id": "IMOSL-2017-G1", "contest": "IMOSL", "year": "2017", "problem_number": "G1", "problem": "Let \\(A B C D E\\) be a convex pentagon such that \\(A B=B C=C D, \\angle E A B=\\angle B C D\\), and \\(\\angle E D C=\\angle C B A\\). Prove that the perpendicular line from \\(E\\) to \\(B C\\) and the line segments \\(A C\\) and \\(B D\\) are concurrent.\n(Italy)", "solution": "1. Throughout the solution, we refer to \\(\\angle A, \\angle B, \\angle C, \\angle D\\), and \\(\\angle E\\) as internal angles of the pentagon \\(A B C D E\\). Let the perpendicular bisectors of \\(A C\\) and \\(B D\\), which pass respectively through \\(B\\) and \\(C\\), meet at point \\(I\\). Then \\(B D \\perp C I\\) and, similarly, \\(A C \\perp B I\\). Hence \\(A C\\) and \\(B D\\) meet at the orthocenter \\(H\\) of the triangle \\(B I C\\), and \\(I H \\perp B C\\). It remains to prove that \\(E\\) lies on the line \\(I H\\) or, equivalently, \\(E I \\perp B C\\).\n\nLines \\(I B\\) and \\(I C\\) bisect \\(\\angle B\\) and \\(\\angle C\\), respectively. Since \\(I A=I C, I B=I D\\), and \\(A B= B C=C D\\), the triangles \\(I A B, I C B\\) and \\(I C D\\) are congruent. Hence \\(\\angle I A B=\\angle I C B= \\angle C / 2=\\angle A / 2\\), so the line \\(I A\\) bisects \\(\\angle A\\). Similarly, the line \\(I D\\) bisects \\(\\angle D\\). Finally, the line \\(I E\\) bisects \\(\\angle E\\) because \\(I\\) lies on all the other four internal bisectors of the angles of the pentagon.\n\nThe sum of the internal angles in a pentagon is \\(540^{\\circ}\\), so\n\\[\n\\angle E=540^{\\circ}-2 \\angle A+2 \\angle B .\n\\]\n\nIn quadrilateral \\(A B I E\\),\n\\[\n\\begin{aligned}\n\\angle B I E & =360^{\\circ}-\\angle E A B-\\angle A B I-\\angle A E I=360^{\\circ}-\\angle A-\\frac{1}{2} \\angle B-\\frac{1}{2} \\angle E \\\\\n& =360^{\\circ}-\\angle A-\\frac{1}{2} \\angle B-\\left(270^{\\circ}-\\angle A-\\angle B\\right) \\\\\n& =90^{\\circ}+\\frac{1}{2} \\angle B=90^{\\circ}+\\angle I B C\n\\end{aligned}\n\\]\nwhich means that \\(E I \\perp B C\\), completing the proof.\n![](https://cdn.mathpix.com/cropped/2025_08_23_4b06fd0385d65a4d803fg-58.jpg?height=609&width=712&top_left_y=1804&top_left_x=673)\n\nSolution 2. We present another proof of the fact that \\(E\\) lies on line \\(I H\\). Since all five internal bisectors of \\(A B C D E\\) meet at \\(I\\), this pentagon has an inscribed circle with center \\(I\\). Let this circle touch side \\(B C\\) at \\(T\\).\n\nApplying Brianchon's theorem to the (degenerate) hexagon \\(A B T C D E\\) we conclude that \\(A C, B D\\) and \\(E T\\) are concurrent, so point \\(E\\) also lies on line \\(I H T\\), completing the proof.\n\nSolution 3. We present yet another proof that \\(E I \\perp B C\\). In pentagon \\(A B C D E, \\angle E< 180^{\\circ} \\Longleftrightarrow \\angle A+\\angle B+\\angle C+\\angle D>360^{\\circ}\\). Then \\(\\angle A+\\angle B=\\angle C+\\angle D>180^{\\circ}\\), so rays \\(E A\\) and \\(C B\\) meet at a point \\(P\\), and rays \\(B C\\) and \\(E D\\) meet at a point \\(Q\\). Now,\n\\[\n\\angle P B A=180^{\\circ}-\\angle B=180^{\\circ}-\\angle D=\\angle Q D C\n\\]\nand, similarly, \\(\\angle P A B=\\angle Q C D\\). Since \\(A B=C D\\), the triangles \\(P A B\\) and \\(Q C D\\) are congruent with the same orientation. Moreover, \\(P Q E\\) is isosceles with \\(E P=E Q\\).\n![](https://cdn.mathpix.com/cropped/2025_08_23_4b06fd0385d65a4d803fg-59.jpg?height=518&width=1543&top_left_y=619&top_left_x=256)\n\nIn Solution 1 we have proved that triangles \\(I A B\\) and \\(I C D\\) are also congruent with the same orientation. Then we conclude that quadrilaterals \\(P B I A\\) and \\(Q D I C\\) are congruent, which implies \\(I P=I Q\\). Then \\(E I\\) is the perpendicular bisector of \\(P Q\\) and, therefore, \\(E I \\perp P Q \\Longleftrightarrow E I \\perp B C\\).\n\nComment. Even though all three solutions used the point \\(I\\), there are solutions that do not need it. We present an outline of such a solution: if \\(J\\) is the incenter of \\(\\triangle Q C D\\) (with \\(P\\) and \\(Q\\) as defined in Solution 3), then a simple angle chasing shows that triangles \\(C J D\\) and \\(B H C\\) are congruent. Then if \\(S\\) is the projection of \\(J\\) onto side \\(C D\\) and \\(T\\) is the orthogonal projection of \\(H\\) onto side \\(B C\\), one can verify that\n\\[\nQ T=Q C+C T=Q C+D S=Q C+\\frac{C D+D Q-Q C}{2}=\\frac{P B+B C+Q C}{2}=\\frac{P Q}{2},\n\\]\nso \\(T\\) is the midpoint of \\(P Q\\), and \\(E, H\\) and \\(T\\) all lie on the perpendicular bisector of \\(P Q\\).", "source_pdf": "imosl_2017.pdf", "notes": "fallback-regex"}
{"id": "IMOSL-2017-G3", "contest": "IMOSL", "year": "2017", "problem_number": "G3", "problem": "Let \\(O\\) be the circumcenter of an acute scalene triangle \\(A B C\\). Line \\(O A\\) intersects the altitudes of \\(A B C\\) through \\(B\\) and \\(C\\) at \\(P\\) and \\(Q\\), respectively. The altitudes meet at \\(H\\). Prove that the circumcenter of triangle \\(P Q H\\) lies on a median of triangle \\(A B C\\).\n(Ukraine)", "solution": ". Suppose, without loss of generality, that \\(A B<A C\\). We have \\(\\angle P Q H=90^{\\circ}- \\angle Q A B=90^{\\circ}-\\angle O A B=\\frac{1}{2} \\angle A O B=\\angle A C B\\), and similarly \\(\\angle Q P H=\\angle A B C\\). Thus triangles \\(A B C\\) and \\(H P Q\\) are similar. Let \\(\\Omega\\) and \\(\\omega\\) be the circumcircles of \\(A B C\\) and \\(H P Q\\), respectively. Since \\(\\angle A H P=90^{\\circ}-\\angle H A C=\\angle A C B=\\angle H Q P\\), line \\(A H\\) is tangent to \\(\\omega\\).\n![](https://cdn.mathpix.com/cropped/2025_08_23_4b06fd0385d65a4d803fg-61.jpg?height=917&width=1371&top_left_y=668&top_left_x=348)\n\nLet \\(T\\) be the center of \\(\\omega\\) and let lines \\(A T\\) and \\(B C\\) meet at \\(M\\). We will take advantage of the similarity between \\(A B C\\) and \\(H P Q\\) and the fact that \\(A H\\) is tangent to \\(\\omega\\) at \\(H\\), with \\(A\\) on line \\(P Q\\). Consider the corresponding tangent \\(A S\\) to \\(\\Omega\\), with \\(S \\in B C\\). Then \\(S\\) and \\(A\\) correspond to each other in \\(\\triangle A B C \\sim \\triangle H P Q\\), and therefore \\(\\angle O S M=\\angle O A T=\\angle O A M\\). Hence quadrilateral \\(S A O M\\) is cyclic, and since the tangent line \\(A S\\) is perpendicular to \\(A O\\), \\(\\angle O M S=180^{\\circ}-\\angle O A S=90^{\\circ}\\). This means that \\(M\\) is the orthogonal projection of \\(O\\) onto \\(B C\\), which is its midpoint. So \\(T\\) lies on median \\(A M\\) of triangle \\(A B C\\).", "source_pdf": "imosl_2017.pdf", "notes": "fallback-regex"}
{"id": "IMOSL-2017-G4", "contest": "IMOSL", "year": "2017", "problem_number": "G4", "problem": "In triangle \\(A B C\\), let \\(\\omega\\) be the excircle opposite \\(A\\). Let \\(D, E\\), and \\(F\\) be the points where \\(\\omega\\) is tangent to lines \\(B C, C A\\), and \\(A B\\), respectively. The circle \\(A E F\\) intersects line \\(B C\\) at \\(P\\) and \\(Q\\). Let \\(M\\) be the midpoint of \\(A D\\). Prove that the circle \\(M P Q\\) is tangent to \\(\\omega\\).\n(Denmark)", "solution": "1. Denote by \\(\\Omega\\) the circle \\(A E F P Q\\), and denote by \\(\\gamma\\) the circle \\(P Q M\\). Let the line \\(A D\\) meet \\(\\omega\\) again at \\(T \\neq D\\). We will show that \\(\\gamma\\) is tangent to \\(\\omega\\) at \\(T\\).\n\nWe first prove that points \\(P, Q, M, T\\) are concyclic. Let \\(A^{\\prime}\\) be the center of \\(\\omega\\). Since \\(A^{\\prime} E \\perp A E\\) and \\(A^{\\prime} F \\perp A F, A A^{\\prime}\\) is a diameter in \\(\\Omega\\). Let \\(N\\) be the midpoint of \\(D T\\); from \\(A^{\\prime} D=A^{\\prime} T\\) we can see that \\(\\angle A^{\\prime} N A=90^{\\circ}\\) and therefore \\(N\\) also lies on the circle \\(\\Omega\\). Now, from the power of \\(D\\) with respect to the circles \\(\\gamma\\) and \\(\\Omega\\) we get\n\\[\nD P \\cdot D Q=D A \\cdot D N=2 D M \\cdot \\frac{D T}{2}=D M \\cdot D T,\n\\]\nso \\(P, Q, M, T\\) are concyclic.\nIf \\(E F \\| B C\\), then \\(A B C\\) is isosceles and the problem is now immediate by symmetry. Otherwise, let the tangent line to \\(\\omega\\) at \\(T\\) meet line \\(B C\\) at point \\(R\\). The tangent line segments \\(R D\\) and \\(R T\\) have the same length, so \\(A^{\\prime} R\\) is the perpendicular bisector of \\(D T\\); since \\(N D=N T\\), \\(N\\) lies on this perpendicular bisector.\n\nIn right triangle \\(A^{\\prime} R D, R D^{2}=R N \\cdot R A^{\\prime}=R P \\cdot R Q\\), in which the last equality was obtained from the power of \\(R\\) with respect to \\(\\Omega\\). Hence \\(R T^{2}=R P \\cdot R Q\\), which implies that \\(R T\\) is also tangent to \\(\\gamma\\). Because \\(R T\\) is a common tangent to \\(\\omega\\) and \\(\\gamma\\), these two circles are tangent at \\(T\\).\n![](https://cdn.mathpix.com/cropped/2025_08_23_4b06fd0385d65a4d803fg-62.jpg?height=823&width=866&top_left_y=1339&top_left_x=599)\n\nSolution 2. After proving that \\(P, Q, M, T\\) are concyclic, we finish the problem in a different fashion. We only consider the case in which \\(E F\\) and \\(B C\\) are not parallel. Let lines \\(P Q\\) and \\(E F\\) meet at point \\(R\\). Since \\(P Q\\) and \\(E F\\) are radical axes of \\(\\Omega, \\gamma\\) and \\(\\omega, \\gamma\\), respectively, \\(R\\) is the radical center of these three circles.\n\nWith respect to the circle \\(\\omega\\), the line \\(D R\\) is the polar of \\(D\\), and the line \\(E F\\) is the polar of \\(A\\). So the pole of line \\(A D T\\) is \\(D R \\cap E F=R\\), and therefore \\(R T\\) is tangent to \\(\\omega\\).\n\nFinally, since \\(T\\) belongs to \\(\\gamma\\) and \\(\\omega\\) and \\(R\\) is the radical center of \\(\\gamma, \\omega\\) and \\(\\Omega\\), line \\(R T\\) is the radical axis of \\(\\gamma\\) and \\(\\omega\\), and since it is tangent to \\(\\omega\\), it is also tangent to \\(\\gamma\\). Because \\(R T\\) is a common tangent to \\(\\omega\\) and \\(\\gamma\\), these two circles are tangent at \\(T\\).\n\nComment. In Solution 2 we defined the point \\(R\\) from Solution 1 in a different way.\n\nSolution 3. We give an alternative proof that the circles are tangent at the common point \\(T\\). Again, we start from the fact that \\(P, Q, M, T\\) are concyclic. Let point \\(O\\) be the midpoint of diameter \\(A A^{\\prime}\\). Then \\(M O\\) is the midline of triangle \\(A D A^{\\prime}\\), so \\(M O \\| A^{\\prime} D\\). Since \\(A^{\\prime} D \\perp P Q\\), \\(M O\\) is perpendicular to \\(P Q\\) as well.\n\nLooking at circle \\(\\Omega\\), which has center \\(O, M O \\perp P Q\\) implies that \\(M O\\) is the perpendicular bisector of the chord \\(P Q\\). Thus \\(M\\) is the midpoint of arc \\(\\widehat{P Q}\\) from \\(\\gamma\\), and the tangent line \\(m\\) to \\(\\gamma\\) at \\(M\\) is parallel to \\(P Q\\).\n![](https://cdn.mathpix.com/cropped/2025_08_23_4b06fd0385d65a4d803fg-63.jpg?height=798&width=632&top_left_y=579&top_left_x=719)\n\nConsider the homothety with center \\(T\\) and ratio \\(\\frac{T D}{T M}\\). It takes \\(D\\) to \\(M\\), and the line \\(P Q\\) to the line \\(m\\). Since the circle that is tangent to a line at a given point and that goes through another given point is unique, this homothety also takes \\(\\omega\\) (tangent to \\(P Q\\) and going through \\(T\\) ) to \\(\\gamma\\) (tangent to \\(m\\) and going through \\(T\\) ). We conclude that \\(\\omega\\) and \\(\\gamma\\) are tangent at \\(T\\).", "source_pdf": "imosl_2017.pdf", "notes": "fallback-regex"}
{"id": "IMOSL-2017-G5", "contest": "IMOSL", "year": "2017", "problem_number": "G5", "problem": "Let \\(A B C C_{1} B_{1} A_{1}\\) be a convex hexagon such that \\(A B=B C\\), and suppose that the line segments \\(A A_{1}, B B_{1}\\), and \\(C C_{1}\\) have the same perpendicular bisector. Let the diagonals \\(A C_{1}\\) and \\(A_{1} C\\) meet at \\(D\\), and denote by \\(\\omega\\) the circle \\(A B C\\). Let \\(\\omega\\) intersect the circle \\(A_{1} B C_{1}\\) again at \\(E \\neq B\\). Prove that the lines \\(B B_{1}\\) and \\(D E\\) intersect on \\(\\omega\\).\n(Ukraine)", "solution": "1. If \\(A A_{1}=C C_{1}\\), then the hexagon is symmetric about the line \\(B B_{1}\\); in particular the circles \\(A B C\\) and \\(A_{1} B C_{1}\\) are tangent to each other. So \\(A A_{1}\\) and \\(C C_{1}\\) must be different. Since the points \\(A\\) and \\(A_{1}\\) can be interchanged with \\(C\\) and \\(C_{1}\\), respectively, we may assume \\(A A_{1}<C C_{1}\\).\n\nLet \\(R\\) be the radical center of the circles \\(A E B C\\) and \\(A_{1} E B C_{1}\\), and the circumcircle of the symmetric trapezoid \\(A C C_{1} A_{1}\\); that is the common point of the pairwise radical axes \\(A C, A_{1} C_{1}\\), and \\(B E\\). By the symmetry of \\(A C\\) and \\(A_{1} C_{1}\\), the point \\(R\\) lies on the common perpendicular bisector of \\(A A_{1}\\) and \\(C C_{1}\\), which is the external bisector of \\(\\angle A D C\\).\n\nLet \\(F\\) be the second intersection of the line \\(D R\\) and the circle \\(A C D\\). From the power of \\(R\\) with respect to the circles \\(\\omega\\) and \\(A C F D\\) we have \\(R B \\cdot R E=R A \\cdot R C=R D \\cdot D F\\), so the points \\(B, E, D\\) and \\(F\\) are concyclic.\n\nThe line \\(R D F\\) is the external bisector of \\(\\angle A D C\\), so the point \\(F\\) bisects the \\(\\operatorname{arc} \\overline{C D A}\\). By \\(A B=B C\\), on circle \\(\\omega\\), the point \\(B\\) is the midpoint of arc \\(\\widehat{A E C}\\); let \\(M\\) be the point diametrically opposite to \\(B\\), that is the midpoint of the opposite \\(\\operatorname{arc} \\widetilde{C A}\\) of \\(\\omega\\). Notice that the points \\(B, F\\) and \\(M\\) lie on the perpendicular bisector of \\(A C\\), so they are collinear.\n![](https://cdn.mathpix.com/cropped/2025_08_23_4b06fd0385d65a4d803fg-64.jpg?height=1223&width=1357&top_left_y=1236&top_left_x=348)\n\nFinally, let \\(X\\) be the second intersection point of \\(\\omega\\) and the line \\(D E\\). Since \\(B M\\) is a diameter in \\(\\omega\\), we have \\(\\angle B X M=90^{\\circ}\\). Moreover,\n\\[\n\\angle E X M=180^{\\circ}-\\angle M B E=180^{\\circ}-\\angle F B E=\\angle E D F,\n\\]\nso \\(M X\\) and \\(F D\\) are parallel. Since \\(B X\\) is perpendicular to \\(M X\\) and \\(B B_{1}\\) is perpendicular to \\(F D\\), this shows that \\(X\\) lies on line \\(B B_{1}\\).\n\nSolution 2. Define point \\(M\\) as the point opposite to \\(B\\) on circle \\(\\omega\\), and point \\(R\\) as the intersection of lines \\(A C, A_{1} C_{1}\\) and \\(B E\\), and show that \\(R\\) lies on the external bisector of \\(\\angle A D C\\), like in the first solution.\n\nSince \\(B\\) is the midpoint of the arc \\(\\widehat{A E C}\\), the line \\(B E R\\) is the external bisector of \\(\\angle C E A\\). Now we show that the internal angle bisectors of \\(\\angle A D C\\) and \\(\\angle C E A\\) meet on the segment \\(A C\\). Let the angle bisector of \\(\\angle A D C\\) meet \\(A C\\) at \\(S\\), and let the angle bisector of \\(\\angle C E A\\), which is line \\(E M\\), meet \\(A C\\) at \\(S^{\\prime}\\). By applying the angle bisector theorem to both internal and external bisectors of \\(\\angle A D C\\) and \\(\\angle C E A\\),\n\\[\nA S: C S=A D: C D=A R: C R=A E: C E=A S^{\\prime}: C S^{\\prime},\n\\]\nso indeed \\(S=S^{\\prime}\\).\nBy \\(\\angle R D S=\\angle S E R=90^{\\circ}\\) the points \\(R, S, D\\) and \\(E\\) are concyclic.\n![](https://cdn.mathpix.com/cropped/2025_08_23_4b06fd0385d65a4d803fg-65.jpg?height=1017&width=1075&top_left_y=848&top_left_x=493)\n\nNow let the lines \\(B B_{1}\\) and \\(D E\\) meet at point \\(X\\). Notice that \\(\\angle E X B=\\angle E D S\\) because both \\(B B_{1}\\) and \\(D S\\) are perpendicular to the line \\(D R\\), we have that \\(\\angle E D S=\\angle E R S\\) in circle \\(S R D E\\), and \\(\\angle E R S=\\angle E M B\\) because \\(S R \\perp B M\\) and \\(E R \\perp M E\\). Therefore, \\(\\angle E X B=\\angle E M B\\), so indeed, the point \\(X\\) lies on \\(\\omega\\).", "source_pdf": "imosl_2017.pdf", "notes": "fallback-regex"}
{"id": "IMOSL-2017-G6", "contest": "IMOSL", "year": "2017", "problem_number": "G6", "problem": "Let \\(n \\geqslant 3\\) be an integer. Two regular \\(n\\)-gons \\(\\mathcal{A}\\) and \\(\\mathcal{B}\\) are given in the plane. Prove that the vertices of \\(\\mathcal{A}\\) that lie inside \\(\\mathcal{B}\\) or on its boundary are consecutive.\n(That is, prove that there exists a line separating those vertices of \\(\\mathcal{A}\\) that lie inside \\(\\mathcal{B}\\) or on its boundary from the other vertices of \\(\\mathcal{A}\\).)\n(Czech Republic)", "solution": "1. In both solutions, by a polygon we always mean its interior together with its boundary.\n\nWe start with finding a regular \\(n\\)-gon \\(\\mathcal{C}\\) which \\((i)\\) is inscribed into \\(\\mathcal{B}\\) (that is, all vertices of \\(\\mathcal{C}\\) lie on the perimeter of \\(\\mathcal{B}\\) ); and (ii) is either a translation of \\(\\mathcal{A}\\), or a homothetic image of \\(\\mathcal{A}\\) with a positive factor.\n\nSuch a polygon may be constructed as follows. Let \\(O_{A}\\) and \\(O_{B}\\) be the centers of \\(\\mathcal{A}\\) and \\(\\mathcal{B}\\), respectively, and let \\(A\\) be an arbitrary vertex of \\(\\mathcal{A}\\). Let \\(\\overrightarrow{O_{B} C}\\) be the vector co-directional to \\(\\overrightarrow{O_{A} A}\\), with \\(C\\) lying on the perimeter of \\(\\mathcal{B}\\). The rotations of \\(C\\) around \\(O_{B}\\) by multiples of \\(2 \\pi / n\\) form the required polygon. Indeed, it is regular, inscribed into \\(\\mathcal{B}\\) (due to the rotational symmetry of \\(\\mathcal{B}\\) ), and finally the translation/homothety mapping \\(\\overrightarrow{O_{A} A}\\) to \\(\\overrightarrow{O_{B} C}\\) maps \\(\\mathcal{A}\\) to \\(\\mathcal{C}\\).\n\nNow we separate two cases.\n\n\\begin{figure}\n\\includegraphics[width=\\textwidth]{https://cdn.mathpix.com/cropped/2025_08_23_4b06fd0385d65a4d803fg-66.jpg?height=500&width=561&top_left_y=1165&top_left_x=356}\n\\captionsetup{labelformat=empty}\n\\caption{Construction of \\(\\mathcal{C}\\)}\n\\end{figure}\n\n\\begin{figure}\n\\includegraphics[width=\\textwidth]{https://cdn.mathpix.com/cropped/2025_08_23_4b06fd0385d65a4d803fg-66.jpg?height=586&width=692&top_left_y=1085&top_left_x=1016}\n\\captionsetup{labelformat=empty}\n\\caption{Case 1: Translation}\n\\end{figure}\n\n\\section*{Case 1: \\(\\mathcal{C}\\) is a translation of \\(\\mathcal{A}\\) by a vector \\(\\vec{v}\\).}\n\nDenote by \\(t\\) the translation transform by vector \\(\\vec{v}\\). We need to prove that the vertices of \\(\\mathcal{C}\\) which stay in \\(\\mathcal{B}\\) under \\(t\\) are consecutive. To visualize the argument, we refer the plane to Cartesian coordinates so that the \\(x\\)-axis is co-directional with \\(\\vec{v}\\). This way, the notions of right/left and top/bottom are also introduced, according to the \\(x\\) - and \\(y\\)-coordinates, respectively.\n\nLet \\(B_{\\mathrm{T}}\\) and \\(B_{\\mathrm{B}}\\) be the top and the bottom vertices of \\(\\mathcal{B}\\) (if several vertices are extremal, we take the rightmost of them). They split the perimeter of \\(\\mathcal{B}\\) into the right part \\(\\mathcal{B}_{\\mathrm{R}}\\) and the left part \\(\\mathcal{B}_{\\mathrm{L}}\\) (the vertices \\(B_{\\mathrm{T}}\\) and \\(B_{\\mathrm{B}}\\) are assumed to lie in both parts); each part forms a connected subset of the perimeter of \\(\\mathcal{B}\\). So the vertices of \\(\\mathcal{C}\\) are also split into two parts \\(\\mathcal{C}_{\\mathrm{L}} \\subset \\mathcal{B}_{\\mathrm{L}}\\) and \\(\\mathcal{C}_{\\mathrm{R}} \\subset \\mathcal{B}_{\\mathrm{R}}\\), each of which consists of consecutive vertices.\n\nNow, all the points in \\(\\mathcal{B}_{\\mathrm{R}}\\) (and hence in \\(\\mathcal{C}_{\\mathrm{R}}\\) ) move out from \\(\\mathcal{B}\\) under \\(t\\), since they are the rightmost points of \\(\\mathcal{B}\\) on the corresponding horizontal lines. It remains to prove that the vertices of \\(\\mathcal{C}_{\\mathrm{L}}\\) which stay in \\(\\mathcal{B}\\) under \\(t\\) are consecutive.\n\nFor this purpose, let \\(C_{1}, C_{2}\\), and \\(C_{3}\\) be three vertices in \\(\\mathcal{C}_{\\mathrm{L}}\\) such that \\(C_{2}\\) is between \\(C_{1}\\) and \\(C_{3}\\), and \\(t\\left(C_{1}\\right)\\) and \\(t\\left(C_{3}\\right)\\) lie in \\(\\mathcal{B}\\); we need to prove that \\(t\\left(C_{2}\\right) \\in \\mathcal{B}\\) as well. Let \\(A_{i}=t\\left(C_{i}\\right)\\). The line through \\(C_{2}\\) parallel to \\(\\vec{v}\\) crosses the segment \\(C_{1} C_{3}\\) to the right of \\(C_{2}\\); this means that this line crosses \\(A_{1} A_{3}\\) to the right of \\(A_{2}\\), so \\(A_{2}\\) lies inside the triangle \\(A_{1} C_{2} A_{3}\\) which is contained in \\(\\mathcal{B}\\). This yields the desired result.\n\nCase 2: \\(\\mathcal{C}\\) is a homothetic image of \\(\\mathcal{A}\\) centered at \\(X\\) with factor \\(k>0\\).\n\nDenote by \\(h\\) the homothety mapping \\(\\mathcal{C}\\) to \\(\\mathcal{A}\\). We need now to prove that the vertices of \\(\\mathcal{C}\\) which stay in \\(\\mathcal{B}\\) after applying \\(h\\) are consecutive. If \\(X \\in \\mathcal{B}\\), the claim is easy. Indeed, if \\(k<1\\), then the vertices of \\(\\mathcal{A}\\) lie on the segments of the form \\(X C\\) ( \\(C\\) being a vertex of \\(\\mathcal{C}\\) ) which lie in \\(\\mathcal{B}\\). If \\(k>1\\), then the vertices of \\(\\mathcal{A}\\) lie on the extensions of such segments \\(X C\\) beyond \\(C\\), and almost all these extensions lie outside \\(\\mathcal{B}\\). The exceptions may occur only in case when \\(X\\) lies on the boundary of \\(\\mathcal{B}\\), and they may cause one or two vertices of \\(\\mathcal{A}\\) stay on the boundary of \\(\\mathcal{B}\\). But even in this case those vertices are still consecutive.\n\nSo, from now on we assume that \\(X \\notin \\mathcal{B}\\).\nNow, there are two vertices \\(B_{\\mathrm{T}}\\) and \\(\\mathcal{B}_{\\mathrm{B}}\\) of \\(\\mathcal{B}\\) such that \\(\\mathcal{B}\\) is contained in the angle \\(\\angle B_{\\mathrm{T}} X B_{\\mathrm{B}}\\); if there are several options, say, for \\(B_{\\mathrm{T}}\\), then we choose the farthest one from \\(X\\) if \\(k>1\\), and the nearest one if \\(k<1\\). For the visualization purposes, we refer the plane to Cartesian coordinates so that the \\(y\\)-axis is co-directional with \\(\\overrightarrow{B_{\\mathrm{B}} B_{\\mathrm{T}}}\\), and \\(X\\) lies to the left of the line \\(B_{\\mathrm{T}} B_{\\mathrm{B}}\\). Again, the perimeter of \\(\\mathcal{B}\\) is split by \\(B_{\\mathrm{T}}\\) and \\(B_{\\mathrm{B}}\\) into the right part \\(\\mathcal{B}_{\\mathrm{R}}\\) and the left part \\(\\mathcal{B}_{\\mathrm{L}}\\), and the set of vertices of \\(\\mathcal{C}\\) is split into two subsets \\(\\mathcal{C}_{\\mathrm{R}} \\subset \\mathcal{B}_{\\mathrm{R}}\\) and \\(\\mathcal{C}_{\\mathrm{L}} \\subset \\mathcal{B}_{\\mathrm{L}}\\).\n\n\\begin{figure}\n\\includegraphics[width=\\textwidth]{https://cdn.mathpix.com/cropped/2025_08_23_4b06fd0385d65a4d803fg-67.jpg?height=564&width=552&top_left_y=970&top_left_x=282}\n\\captionsetup{labelformat=empty}\n\\caption{Case 2, \\(X\\) inside \\(\\mathcal{B}\\)}\n\\end{figure}\n\n\\begin{figure}\n\\includegraphics[width=\\textwidth]{https://cdn.mathpix.com/cropped/2025_08_23_4b06fd0385d65a4d803fg-67.jpg?height=629&width=918&top_left_y=908&top_left_x=870}\n\\captionsetup{labelformat=empty}\n\\caption{Subcase 2.1: \\(k>1\\)}\n\\end{figure}\n\n\\section*{Subcase 2.1: \\(k>1\\).}\n\nIn this subcase, all points from \\(\\mathcal{B}_{\\mathrm{R}}\\) (and hence from \\(\\mathcal{C}_{\\mathrm{R}}\\) ) move out from \\(\\mathcal{B}\\) under \\(h\\), because they are the farthest points of \\(\\mathcal{B}\\) on the corresponding rays emanated from \\(X\\). It remains to prove that the vertices of \\(\\mathcal{C}_{\\mathrm{L}}\\) which stay in \\(\\mathcal{B}\\) under \\(h\\) are consecutive.\n\nAgain, let \\(C_{1}, C_{2}, C_{3}\\) be three vertices in \\(\\mathcal{C}_{\\mathrm{L}}\\) such that \\(C_{2}\\) is between \\(C_{1}\\) and \\(C_{3}\\), and \\(h\\left(C_{1}\\right)\\) and \\(h\\left(C_{3}\\right)\\) lie in \\(\\mathcal{B}\\). Let \\(A_{i}=h\\left(C_{i}\\right)\\). Then the ray \\(X C_{2}\\) crosses the segment \\(C_{1} C_{3}\\) beyond \\(C_{2}\\), so this ray crosses \\(A_{1} A_{3}\\) beyond \\(A_{2}\\); this implies that \\(A_{2}\\) lies in the triangle \\(A_{1} C_{2} A_{3}\\), which is contained in \\(\\mathcal{B}\\).\n\n\\begin{figure}\n\\includegraphics[width=\\textwidth]{https://cdn.mathpix.com/cropped/2025_08_23_4b06fd0385d65a4d803fg-67.jpg?height=515&width=915&top_left_y=2024&top_left_x=576}\n\\captionsetup{labelformat=empty}\n\\caption{Subcase 2.2: \\(k<1\\)}\n\\end{figure}\n\n\\section*{Subcase 2.2: \\(k<1\\).}\n\nThis case is completely similar to the previous one. All points from \\(\\mathcal{B}_{\\mathrm{L}}\\) (and hence from \\(\\mathcal{C}_{\\mathrm{L}}\\) move out from \\(\\mathcal{B}\\) under \\(h\\), because they are the nearest points of \\(\\mathcal{B}\\) on the corresponding\nrays emanated from \\(X\\). Assume that \\(C_{1}, C_{2}\\), and \\(C_{3}\\) are three vertices in \\(\\mathcal{C}_{\\mathrm{R}}\\) such that \\(C_{2}\\) lies between \\(C_{1}\\) and \\(C_{3}\\), and \\(h\\left(C_{1}\\right)\\) and \\(h\\left(C_{3}\\right)\\) lie in \\(\\mathcal{B}\\); let \\(A_{i}=h\\left(C_{i}\\right)\\). Then \\(A_{2}\\) lies on the segment \\(X C_{2}\\), and the segments \\(X A_{2}\\) and \\(A_{1} A_{3}\\) cross each other. Thus \\(A_{2}\\) lies in the triangle \\(A_{1} C_{2} A_{3}\\), which is contained in \\(\\mathcal{B}\\).\n\nComment 1. In fact, Case 1 can be reduced to Case 2 via the following argument.\nAssume that \\(\\mathcal{A}\\) and \\(\\mathcal{C}\\) are congruent. Apply to \\(\\mathcal{A}\\) a homothety centered at \\(O_{B}\\) with a factor slightly smaller than 1 to obtain a polygon \\(\\mathcal{A}^{\\prime}\\). With appropriately chosen factor, the vertices of \\(\\mathcal{A}\\) which were outside/inside \\(\\mathcal{B}\\) stay outside/inside it, so it suffices to prove our claim for \\(\\mathcal{A}^{\\prime}\\) instead of \\(\\mathcal{A}\\). And now, the polygon \\(\\mathcal{A}^{\\prime}\\) is a homothetic image of \\(\\mathcal{C}\\), so the arguments from Case 2 apply.\n\nComment 2. After the polygon \\(\\mathcal{C}\\) has been found, the rest of the solution uses only the convexity of the polygons, instead of regularity. Thus, it proves a more general statement:\n\nAssume that \\(\\mathcal{A}, \\mathcal{B}\\), and \\(\\mathcal{C}\\) are three convex polygons in the plane such that \\(\\mathcal{C}\\) is inscribed into \\(\\mathcal{B}\\), and \\(\\mathcal{A}\\) can be obtained from it via either translation or positive homothety. Then the vertices of \\(\\mathcal{A}\\) that lie inside \\(\\mathcal{B}\\) or on its boundary are consecutive.\n\nSolution 2. Let \\(O_{A}\\) and \\(O_{B}\\) be the centers of \\(\\mathcal{A}\\) and \\(\\mathcal{B}\\), respectively. Denote \\([n]=\\{1,2, \\ldots, n\\}\\).\nWe start with introducing appropriate enumerations and notations. Enumerate the sidelines of \\(\\mathcal{B}\\) clockwise as \\(\\ell_{1}, \\ell_{2}, \\ldots, \\ell_{n}\\). Denote by \\(\\mathcal{H}_{i}\\) the half-plane of \\(\\ell_{i}\\) that contains \\(\\mathcal{B}\\) ( \\(\\mathcal{H}_{i}\\) is assumed to contain \\(\\ell_{i}\\) ); by \\(B_{i}\\) the midpoint of the side belonging to \\(\\ell_{i}\\); and finally denote \\(\\overrightarrow{b_{i}}=\\overrightarrow{B_{i} O_{B}}\\). (As usual, the numbering is cyclic modulo \\(n\\), so \\(\\ell_{n+i}=\\ell_{i}\\) etc.)\n\nNow, choose a vertex \\(A_{1}\\) of \\(\\mathcal{A}\\) such that the vector \\(\\overrightarrow{O_{A} A_{1}}\\) points \"mostly outside \\(\\mathcal{H}_{1}\\) \"; strictly speaking, this means that the scalar product \\(\\left\\langle\\overrightarrow{O_{A} A_{1}}, \\overrightarrow{b_{1}}\\right\\rangle\\) is minimal. Starting from \\(A_{1}\\), enumerate the vertices of \\(\\mathcal{A}\\) clockwise as \\(A_{1}, A_{2}, \\ldots, A_{n}\\); by the rotational symmetry, the choice of \\(A_{1}\\) yields that the vector \\(\\overrightarrow{O_{A} A_{i}}\\) points \"mostly outside \\(\\mathcal{H}_{i}\\) \", i.e.,\n\\[\n\\left\\langle\\overrightarrow{O_{A} A_{i}}, \\overrightarrow{b_{i}}\\right\\rangle=\\min _{j \\in[n]}\\left\\langle\\overrightarrow{O_{A} A_{j}}, \\overrightarrow{b_{i}}\\right\\rangle .\n\\]\n![](https://cdn.mathpix.com/cropped/2025_08_23_4b06fd0385d65a4d803fg-68.jpg?height=601&width=895&top_left_y=1530&top_left_x=585)\n\nWe intend to reformulate the problem in more combinatorial terms, for which purpose we introduce the following notion. Say that a subset \\(I \\subseteq[n]\\) is connected if the elements of this set are consecutive in the cyclic order (in other words, if we join each \\(i\\) with \\(i+1 \\bmod n\\) by an edge, this subset is connected in the usual graph sense). Clearly, the union of two connected subsets sharing at least one element is connected too. Next, for any half-plane \\(\\mathcal{H}\\) the indices of vertices of, say, \\(\\mathcal{A}\\) that lie in \\(\\mathcal{H}\\) form a connected set.\n\nTo access the problem, we denote\n\\[\nM=\\left\\{j \\in[n]: A_{j} \\notin \\mathcal{B}\\right\\}, \\quad M_{i}=\\left\\{j \\in[n]: A_{j} \\notin \\mathcal{H}_{i}\\right\\} \\quad \\text { for } i \\in[n] .\n\\]\n\nWe need to prove that \\([n] \\backslash M\\) is connected, which is equivalent to \\(M\\) being connected. On the other hand, since \\(\\mathcal{B}=\\bigcap_{i \\in[n]} \\mathcal{H}_{i}\\), we have \\(M=\\bigcup_{i \\in[n]} M_{i}\\), where the sets \\(M_{i}\\) are easier to investigate. We will utilize the following properties of these sets; the first one holds by the definition of \\(M_{i}\\), along with the above remark.\n\n\\begin{figure}\n\\includegraphics[width=\\textwidth]{https://cdn.mathpix.com/cropped/2025_08_23_4b06fd0385d65a4d803fg-69.jpg?height=518&width=1175&top_left_y=185&top_left_x=445}\n\\captionsetup{labelformat=empty}\n\\caption{The sets \\(M_{i}\\)}\n\\end{figure}\n\nProperty 1: Each set \\(M_{i}\\) is connected.\nProperty 2: If \\(M_{i}\\) is nonempty, then \\(i \\in M_{i}\\).\nProof. Indeed, we have\n\\[\nj \\in M_{i} \\Longleftrightarrow A_{j} \\notin \\mathcal{H}_{i} \\Longleftrightarrow\\left\\langle\\overrightarrow{B_{i} A_{j}}, \\overrightarrow{b_{i}}\\right\\rangle<0 \\Longleftrightarrow\\left\\langle\\overrightarrow{O_{A} A_{j}}, \\overrightarrow{b_{i}}\\right\\rangle<\\left\\langle\\overrightarrow{O_{A} B_{i}}, \\overrightarrow{b_{i}}\\right\\rangle .\n\\]\n\nThe right-hand part of the last inequality does not depend on \\(j\\). Therefore, if some \\(j\\) lies in \\(M_{i}\\), then by (1) so does \\(i\\).\n\nIn view of Property 2, it is useful to define the set\n\\[\nM^{\\prime}=\\left\\{i \\in[n]: i \\in M_{i}\\right\\}=\\left\\{i \\in[n]: M_{i} \\neq \\varnothing\\right\\} .\n\\]\n\nProperty 3: The set \\(M^{\\prime}\\) is connected.\nProof. To prove this property, we proceed on with the investigation started in (2) to write\n\\[\ni \\in M^{\\prime} \\Longleftrightarrow A_{i} \\in M_{i} \\Longleftrightarrow\\left\\langle\\overrightarrow{B_{i} A_{i}}, \\overrightarrow{b_{i}}\\right\\rangle<0 \\Longleftrightarrow\\left\\langle\\overrightarrow{O_{B} O_{A}}, \\overrightarrow{b_{i}}\\right\\rangle<\\left\\langle\\overrightarrow{O_{B} B_{i}}, \\overrightarrow{b_{i}}\\right\\rangle+\\left\\langle\\overrightarrow{A_{i} O_{A}}, \\overrightarrow{b_{i}}\\right\\rangle .\n\\]\n\nThe right-hand part of the obtained inequality does not depend on \\(i\\), due to the rotational symmetry; denote its constant value by \\(\\mu\\). Thus, \\(i \\in M^{\\prime}\\) if and only if \\(\\left\\langle\\overrightarrow{O_{B} O_{A}}, \\overrightarrow{b_{i}}\\right\\rangle<\\mu\\). This condition is in turn equivalent to the fact that \\(B_{i}\\) lies in a certain (open) half-plane whose boundary line is orthogonal to \\(O_{B} O_{A}\\); thus, it defines a connected set.\n\nNow we can finish the solution. Since \\(M^{\\prime} \\subseteq M\\), we have\n\\[\nM=\\bigcup_{i \\in[n]} M_{i}=M^{\\prime} \\cup \\bigcup_{i \\in[n]} M_{i},\n\\]\nso \\(M\\) can be obtained from \\(M^{\\prime}\\) by adding all the sets \\(M_{i}\\) one by one. All these sets are connected, and each nonempty \\(M_{i}\\) contains an element of \\(M^{\\prime}\\) (namely, \\(i\\) ). Thus their union is also connected.\n\nComment 3. Here we present a way in which one can come up with a solution like the one above.\nAssume, for sake of simplicity, that \\(O_{A}\\) lies inside \\(\\mathcal{B}\\). Let us first put onto the plane a very small regular n-gon \\(\\mathcal{A}^{\\prime}\\) centered at \\(O_{A}\\) and aligned with \\(\\mathcal{A}\\); all its vertices lie inside \\(\\mathcal{B}\\). Now we start blowing it up, looking at the order in which the vertices leave \\(\\mathcal{B}\\). To go out of \\(\\mathcal{B}\\), a vertex should cross a certain side of \\(\\mathcal{B}\\) (which is hard to describe), or, equivalently, to cross at least one sideline of \\(\\mathcal{B}\\) - and this event is easier to describe. Indeed, the first vertex of \\(\\mathcal{A}^{\\prime}\\) to cross \\(\\ell_{i}\\) is the vertex \\(A_{i}^{\\prime}\\) (corresponding to \\(A_{i}\\) in \\(\\mathcal{A}\\) ); more generally, the vertices \\(A_{j}^{\\prime}\\) cross \\(\\ell_{i}\\) in such an order that the scalar product \\(\\left\\langle\\overrightarrow{O_{A} A_{j}}, \\overrightarrow{b_{i}}\\right\\rangle\\) does not increase. For different indices \\(i\\), these orders are just cyclic shifts of each other; and this provides some intuition for the notions and claims from Solution 2.", "source_pdf": "imosl_2017.pdf", "notes": "fallback-regex"}
{"id": "IMOSL-2017-G7", "contest": "IMOSL", "year": "2017", "problem_number": "G7", "problem": "A convex quadrilateral \\(A B C D\\) has an inscribed circle with center \\(I\\). Let \\(I_{a}, I_{b}, I_{c}\\), and \\(I_{d}\\) be the incenters of the triangles \\(D A B, A B C, B C D\\), and \\(C D A\\), respectively. Suppose that the common external tangents of the circles \\(A I_{b} I_{d}\\) and \\(C I_{b} I_{d}\\) meet at \\(X\\), and the common external tangents of the circles \\(B I_{a} I_{c}\\) and \\(D I_{a} I_{c}\\) meet at \\(Y\\). Prove that \\(\\angle X I Y=90^{\\circ}\\).\n(Kazakhstan)", "solution": ". Denote by \\(\\omega_{a}, \\omega_{b}, \\omega_{c}\\) and \\(\\omega_{d}\\) the circles \\(A I_{b} I_{d}, B I_{a} I_{c}, C I_{b} I_{d}\\), and \\(D I_{a} I_{c}\\), let their centers be \\(O_{a}, O_{b}, O_{c}\\) and \\(O_{d}\\), and let their radii be \\(r_{a}, r_{b}, r_{c}\\) and \\(r_{d}\\), respectively.\nClaim 1. \\(I_{b} I_{d} \\perp A C\\) and \\(I_{a} I_{c} \\perp B D\\).\nProof. Let the incircles of triangles \\(A B C\\) and \\(A C D\\) be tangent to the line \\(A C\\) at \\(T\\) and \\(T^{\\prime}\\), respectively. (See the figure to the left.) We have \\(A T=\\frac{A B+A C-B C}{2}\\) in triangle \\(A B C, A T^{\\prime}= \\frac{A D+A C-C D}{2}\\) in triangle \\(A C D\\), and \\(A B-B C=A D-C D\\) in quadrilateral \\(A B C D\\), so\n\\[\nA T=\\frac{A C+A B-B C}{2}=\\frac{A C+A D-C D}{2}=A T^{\\prime} .\n\\]\n\nThis shows \\(T=T^{\\prime}\\). As an immediate consequence, \\(I_{b} I_{d} \\perp A C\\).\nThe second statement can be shown analogously.\n![](https://cdn.mathpix.com/cropped/2025_08_23_4b06fd0385d65a4d803fg-70.jpg?height=714&width=1726&top_left_y=1085&top_left_x=168)\n\nClaim 2. The points \\(O_{a}, O_{b}, O_{c}\\) and \\(O_{d}\\) lie on the lines \\(A I, B I, C I\\) and \\(D I\\), respectively. Proof. By symmetry it suffices to prove the claim for \\(O_{a}\\). (See the figure to the right above.) Notice first that the incircles of triangles \\(A B C\\) and \\(A C D\\) can be obtained from the incircle of the quadrilateral \\(A B C D\\) with homothety centers \\(B\\) and \\(D\\), respectively, and homothety factors less than 1 , therefore the points \\(I_{b}\\) and \\(I_{d}\\) lie on the line segments \\(B I\\) and \\(D I\\), respectively.\n\nAs is well-known, in every triangle the altitude and the diameter of the circumcircle starting from the same vertex are symmetric about the angle bisector. By Claim 1, in triangle \\(A I_{d} I_{b}\\), the segment \\(A T\\) is the altitude starting from \\(A\\). Since the foot \\(T\\) lies inside the segment \\(I_{b} I_{d}\\), the circumcenter \\(O_{a}\\) of triangle \\(A I_{d} I_{b}\\) lies in the angle domain \\(I_{b} A I_{d}\\) in such a way that \\(\\angle I_{b} A T=\\angle O_{a} A I_{d}\\). The points \\(I_{b}\\) and \\(I_{d}\\) are the incenters of triangles \\(A B C\\) and \\(A C D\\), so the lines \\(A I_{b}\\) and \\(A I_{d}\\) bisect the angles \\(\\angle B A C\\) and \\(\\angle C A D\\), respectively. Then\n\\[\n\\angle O_{a} A D=\\angle O_{a} A I_{d}+\\angle I_{d} A D=\\angle I_{b} A T+\\angle I_{d} A D=\\frac{1}{2} \\angle B A C+\\frac{1}{2} \\angle C A D=\\frac{1}{2} \\angle B A D\n\\]\nso \\(O_{a}\\) lies on the angle bisector of \\(\\angle B A D\\), that is, on line \\(A I\\).\nThe point \\(X\\) is the external similitude center of \\(\\omega_{a}\\) and \\(\\omega_{c}\\); let \\(U\\) be their internal similitude center. The points \\(O_{a}\\) and \\(O_{c}\\) lie on the perpendicular bisector of the common chord \\(I_{b} I_{d}\\) of \\(\\omega_{a}\\) and \\(\\omega_{c}\\), and the two similitude centers \\(X\\) and \\(U\\) lie on the same line; by Claim 2, that line is parallel to \\(A C\\).\n![](https://cdn.mathpix.com/cropped/2025_08_23_4b06fd0385d65a4d803fg-71.jpg?height=1146&width=1535&top_left_y=185&top_left_x=262)\n\nFrom the similarity of the circles \\(\\omega_{a}\\) and \\(\\omega_{c}\\), from \\(O_{a} I_{b}=O_{a} I_{d}=O_{a} A=r_{a}\\) and \\(O_{c} I_{b}= O_{c} I_{d}=O_{c} C=r_{c}\\), and from \\(A C \\| O_{a} O_{c}\\) we can see that\n\\[\n\\frac{O_{a} X}{O_{c} X}=\\frac{O_{a} U}{O_{c} U}=\\frac{r_{a}}{r_{c}}=\\frac{O_{a} I_{b}}{O_{c} I_{b}}=\\frac{O_{a} I_{d}}{O_{c} I_{d}}=\\frac{O_{a} A}{O_{c} C}=\\frac{O_{a} I}{O_{c} I} .\n\\]\n\nSo the points \\(X, U, I_{b}, I_{d}, I\\) lie on the Apollonius circle of the points \\(O_{a}, O_{c}\\) with ratio \\(r_{a}: r_{c}\\). In this Apollonius circle \\(X U\\) is a diameter, and the lines \\(I U\\) and \\(I X\\) are respectively the internal and external bisectors of \\(\\angle O_{a} I O_{c}=\\angle A I C\\), according to the angle bisector theorem. Moreover, in the Apollonius circle the diameter \\(U X\\) is the perpendicular bisector of \\(I_{b} I_{d}\\), so the lines \\(I X\\) and \\(I U\\) are the internal and external bisectors of \\(\\angle I_{b} I I_{d}=\\angle B I D\\), respectively.\n\nRepeating the same argument for the points \\(B, D\\) instead of \\(A, C\\), we get that the line \\(I Y\\) is the internal bisector of \\(\\angle A I C\\) and the external bisector of \\(\\angle B I D\\). Therefore, the lines \\(I X\\) and \\(I Y\\) respectively are the internal and external bisectors of \\(\\angle B I D\\), so they are perpendicular.\n\nComment. In fact the points \\(O_{a}, O_{b}, O_{c}\\) and \\(O_{d}\\) lie on the line segments \\(A I, B I, C I\\) and \\(D I\\), respectively. For the point \\(O_{a}\\) this can be shown for example by \\(\\angle I_{d} O_{a} A+\\angle A O_{a} I_{b}=\\left(180^{\\circ}-\\right. \\left.2 \\angle O_{a} A I_{d}\\right)+\\left(180^{\\circ}-2 \\angle I_{b} A O_{a}\\right)=360^{\\circ}-\\angle B A D=\\angle A D I+\\angle D I A+\\angle A I B+\\angle I B A>\\angle I_{d} I A+\\angle A I I_{b}\\).\n\nThe solution also shows that the line \\(I Y\\) passes through the point \\(U\\), and analogously, \\(I X\\) passes through the internal similitude center of \\(\\omega_{b}\\) and \\(\\omega_{d}\\).", "source_pdf": "imosl_2017.pdf", "notes": "fallback-regex"}
{"id": "IMOSL-2017-G8", "contest": "IMOSL", "year": "2017", "problem_number": "G8", "problem": "There are 2017 mutually external circles drawn on a blackboard, such that no two are tangent and no three share a common tangent. A tangent segment is a line segment that is a common tangent to two circles, starting at one tangent point and ending at the other one. Luciano is drawing tangent segments on the blackboard, one at a time, so that no tangent segment intersects any other circles or previously drawn tangent segments. Luciano keeps drawing tangent segments until no more can be drawn. Find all possible numbers of tangent segments when he stops drawing.\n(Australia)", "solution": "Answer: If there were \\(n\\) circles, there would always be exactly \\(3(n-1)\\) segments; so the only possible answer is \\(3 \\cdot 2017-3=6048\\).\n\n1. First, consider a particular arrangement of circles \\(C_{1}, C_{2}, \\ldots, C_{n}\\) where all the centers are aligned and each \\(C_{i}\\) is eclipsed from the other circles by its neighbors - for example, taking \\(C_{i}\\) with center ( \\(i^{2}, 0\\) ) and radius \\(i / 2\\) works. Then the only tangent segments that can be drawn are between adjacent circles \\(C_{i}\\) and \\(C_{i+1}\\), and exactly three segments can be drawn for each pair. So Luciano will draw exactly \\(3(n-1)\\) segments in this case.\n![](https://cdn.mathpix.com/cropped/2025_08_23_4b06fd0385d65a4d803fg-72.jpg?height=232&width=1306&top_left_y=1085&top_left_x=368)\n\nFor the general case, start from a final configuration (that is, an arrangement of circles and segments in which no further segments can be drawn). The idea of the solution is to continuously resize and move the circles around the plane, one by one (in particular, making sure we never have 4 circles with a common tangent line), and show that the number of segments drawn remains constant as the picture changes. This way, we can reduce any circle/segment configuration to the particular one mentioned above, and the final number of segments must remain at \\(3 n-3\\).\n\nSome preliminary considerations: look at all possible tangent segments joining any two circles. A segment that is tangent to a circle \\(A\\) can do so in two possible orientations - it may come out of \\(A\\) in clockwise or counterclockwise orientation. Two segments touching the same circle with the same orientation will never intersect each other. Each pair \\((A, B)\\) of circles has 4 choices of tangent segments, which can be identified by their orientations - for example, ( \\(A+, B-\\) ) would be the segment which comes out of \\(A\\) in clockwise orientation and comes out of \\(B\\) in counterclockwise orientation. In total, we have \\(2 n(n-1)\\) possible segments, disregarding intersections.\n\nNow we pick a circle \\(C\\) and start to continuously move and resize it, maintaining all existing tangent segments according to their identifications, including those involving \\(C\\). We can keep our choice of tangent segments until the configuration reaches a transition. We lose nothing if we assume that \\(C\\) is kept at least \\(\\varepsilon\\) units away from any other circle, where \\(\\varepsilon\\) is a positive, fixed constant; therefore at a transition either: (1) a currently drawn tangent segment \\(t\\) suddenly becomes obstructed; or (2) a currently absent tangent segment \\(t\\) suddenly becomes unobstructed and available.\nClaim. A transition can only occur when three circles \\(C_{1}, C_{2}, C_{3}\\) are tangent to a common line \\(\\ell\\) containing \\(t\\), in a way such that the three tangent segments lying on \\(\\ell\\) (joining the three circles pairwise) are not obstructed by any other circles or tangent segments (other than \\(C_{1}, C_{2}, C_{3}\\) ).\nProof. Since (2) is effectively the reverse of (1), it suffices to prove the claim for (1). Suppose \\(t\\) has suddenly become obstructed, and let us consider two cases.\n\n\\section*{Case 1: \\(t\\) becomes obstructed by a circle}\n![](https://cdn.mathpix.com/cropped/2025_08_23_4b06fd0385d65a4d803fg-73.jpg?height=301&width=1434&top_left_y=299&top_left_x=314)\n\nThen the new circle becomes the third circle tangent to \\(\\ell\\), and no other circles or tangent segments are obstructing \\(t\\).\n\n\\section*{Case 2: \\(t\\) becomes obstructed by another tangent segment \\(t^{\\prime}\\)}\n\nWhen two segments \\(t\\) and \\(t^{\\prime}\\) first intersect each other, they must do so at a vertex of one of them. But if a vertex of \\(t^{\\prime}\\) first crossed an interior point of \\(t\\), the circle associated to this vertex was already blocking \\(t\\) (absurd), or is about to (we already took care of this in case 1). So we only have to analyze the possibility of \\(t\\) and \\(t^{\\prime}\\) suddenly having a common vertex. However, if that happens, this vertex must belong to a single circle (remember we are keeping different circles at least \\(\\varepsilon\\) units apart from each other throughout the moving/resizing process), and therefore they must have different orientations with respect to that circle.\n![](https://cdn.mathpix.com/cropped/2025_08_23_4b06fd0385d65a4d803fg-73.jpg?height=321&width=1349&top_left_y=1227&top_left_x=359)\n\nThus, at the transition moment, both \\(t\\) and \\(t^{\\prime}\\) are tangent to the same circle at a common point, that is, they must be on the same line \\(\\ell\\) and hence we again have three circles simultaneously tangent to \\(\\ell\\). Also no other circles or tangent segments are obstructing \\(t\\) or \\(t^{\\prime}\\) (otherwise, they would have disappeared before this transition).\n\nNext, we focus on the maximality of a configuration immediately before and after a transition, where three circles share a common tangent line \\(\\ell\\). Let the three circles be \\(C_{1}, C_{2}, C_{3}\\), ordered by their tangent points. The only possibly affected segments are the ones lying on \\(\\ell\\), namely \\(t_{12}, t_{23}\\) and \\(t_{13}\\). Since \\(C_{2}\\) is in the middle, \\(t_{12}\\) and \\(t_{23}\\) must have different orientations with respect to \\(C_{2}\\). For \\(C_{1}, t_{12}\\) and \\(t_{13}\\) must have the same orientation, while for \\(C_{3}, t_{13}\\) and \\(t_{23}\\) must have the same orientation. The figure below summarizes the situation, showing alternative positions for \\(C_{1}\\) (namely, \\(C_{1}\\) and \\(C_{1}^{\\prime}\\) ) and for \\(C_{3}\\) ( \\(C_{3}\\) and \\(C_{3}^{\\prime}\\) ).\n![](https://cdn.mathpix.com/cropped/2025_08_23_4b06fd0385d65a4d803fg-73.jpg?height=555&width=998&top_left_y=2218&top_left_x=536)\n\nNow perturb the diagram slightly so the three circles no longer have a common tangent, while preserving the definition of \\(t_{12}, t_{23}\\) and \\(t_{13}\\) according to their identifications. First note that no other circles or tangent segments can obstruct any of these segments. Also recall that tangent segments joining the same circle at the same orientation will never obstruct each other.\n\nThe availability of the tangent segments can now be checked using simple diagrams.\n\n\\section*{Case 1: \\(t_{13}\\) passes through \\(C_{2}\\)}\n![](https://cdn.mathpix.com/cropped/2025_08_23_4b06fd0385d65a4d803fg-74.jpg?height=544&width=1001&top_left_y=593&top_left_x=533)\n\nIn this case, \\(t_{13}\\) is not available, but both \\(t_{12}\\) and \\(t_{23}\\) are.\nCase 2: \\(t_{13}\\) does not pass through \\(C_{2}\\)\n![](https://cdn.mathpix.com/cropped/2025_08_23_4b06fd0385d65a4d803fg-74.jpg?height=523&width=1003&top_left_y=1399&top_left_x=531)\n\nNow \\(t_{13}\\) is available, but \\(t_{12}\\) and \\(t_{23}\\) obstruct each other, so only one can be drawn.\nIn any case, exactly 2 out of these 3 segments can be drawn. Thus the maximal number of segments remains constant as we move or resize the circles, and we are done.\n\nSolution 2. First note that all tangent segments lying on the boundary of the convex hull of the circles are always drawn since they do not intersect anything else. Now in the final picture, aside from the \\(n\\) circles, the blackboard is divided into regions. We can consider the picture as a plane (multi-)graph \\(G\\) in which the circles are the vertices and the tangent segments are the edges. The idea of this solution is to find a relation between the number of edges and the number of regions in \\(G\\); then, once we prove that \\(G\\) is connected, we can use Euler's formula to finish the problem.\n\nThe boundary of each region consists of 1 or more (for now) simple closed curves, each made of arcs and tangent segments. The segment and the arc might meet smoothly (as in \\(S_{i}\\), \\(i=1,2, \\ldots, 6\\) in the figure below) or not (as in \\(P_{1}, P_{2}, P_{3}, P_{4}\\); call such points sharp corners of the boundary). In other words, if a person walks along the border, her direction would suddenly turn an angle of \\(\\pi\\) at a sharp corner.\n\n\\begin{figure}\n\\includegraphics[width=\\textwidth]{https://cdn.mathpix.com/cropped/2025_08_23_4b06fd0385d65a4d803fg-75.jpg?height=618&width=572&top_left_y=188&top_left_x=748}\n\\captionsetup{labelformat=empty}\n\\caption{Claim 1. The outer boundary \\(B_{1}\\) of any internal region has at least 3 sharp corners.}\n\\end{figure}\n\nProof. Let a person walk one lap along \\(B_{1}\\) in the counterclockwise orientation. As she does so, she will turn clockwise as she moves along the circle arcs, and not turn at all when moving along the lines. On the other hand, her total rotation after one lap is \\(2 \\pi\\) in the counterclockwise direction! Where could she be turning counterclockwise? She can only do so at sharp corners, and, even then, she turns only an angle of \\(\\pi\\) there. But two sharp corners are not enough, since at least one arc must be present-so she must have gone through at least 3 sharp corners.\n\nClaim 2. Each internal region is simply connected, that is, has only one boundary curve.\nProof. Suppose, by contradiction, that some region has an outer boundary \\(B_{1}\\) and inner boundaries \\(B_{2}, B_{3}, \\ldots, B_{m}(m \\geqslant 2)\\). Let \\(P_{1}\\) be one of the sharp corners of \\(B_{1}\\).\n\nNow consider a car starting at \\(P_{1}\\) and traveling counterclockwise along \\(B_{1}\\). It starts in reverse, i.e., it is initially facing the corner \\(P_{1}\\). Due to the tangent conditions, the car may travel in a way so that its orientation only changes when it is moving along an arc. In particular, this means the car will sometimes travel forward. For example, if the car approaches a sharp corner when driving in reverse, it would continue travel forward after the corner, instead of making an immediate half-turn. This way, the orientation of the car only changes in a clockwise direction since the car always travels clockwise around each arc.\n\nNow imagine there is a laser pointer at the front of the car, pointing directly ahead. Initially, the laser endpoint hits \\(P_{1}\\), but, as soon as the car hits an arc, the endpoint moves clockwise around \\(B_{1}\\). In fact, the laser endpoint must move continuously along \\(B_{1}\\) ! Indeed, if the endpoint ever jumped (within \\(B_{1}\\), or from \\(B_{1}\\) to one of the inner boundaries), at the moment of the jump the interrupted laser would be a drawable tangent segment that Luciano missed (see figure below for an example).\n![](https://cdn.mathpix.com/cropped/2025_08_23_4b06fd0385d65a4d803fg-75.jpg?height=620&width=575&top_left_y=2153&top_left_x=745)\n\nNow, let \\(P_{2}\\) and \\(P_{3}\\) be the next two sharp corners the car goes through, after \\(P_{1}\\) (the previous lemma assures their existence). At \\(P_{2}\\) the car starts moving forward, and at \\(P_{3}\\) it will start to move in reverse again. So, at \\(P_{3}\\), the laser endpoint is at \\(P_{3}\\) itself. So while the car moved counterclockwise between \\(P_{1}\\) and \\(P_{3}\\), the laser endpoint moved clockwise between \\(P_{1}\\) and \\(P_{3}\\). That means the laser beam itself scanned the whole region within \\(B_{1}\\), and it should have crossed some of the inner boundaries.\n\n\\section*{Claim 3. Each region has exactly 3 sharp corners.}\n\nProof. Consider again the car of the previous claim, with its laser still firmly attached to its front, traveling the same way as before and going through the same consecutive sharp corners \\(P_{1}, P_{2}\\) and \\(P_{3}\\). As we have seen, as the car goes counterclockwise from \\(P_{1}\\) to \\(P_{3}\\), the laser endpoint goes clockwise from \\(P_{1}\\) to \\(P_{3}\\), so together they cover the whole boundary. If there were a fourth sharp corner \\(P_{4}\\), at some moment the laser endpoint would pass through it. But, since \\(P_{4}\\) is a sharp corner, this means the car must be on the extension of a tangent segment going through \\(P_{4}\\). Since the car is not on that segment itself (the car never goes through \\(P_{4}\\) ), we would have 3 circles with a common tangent line, which is not allowed.\n![](https://cdn.mathpix.com/cropped/2025_08_23_4b06fd0385d65a4d803fg-76.jpg?height=524&width=780&top_left_y=1016&top_left_x=651)\n\nWe are now ready to finish the solution. Let \\(r\\) be the number of internal regions, and \\(s\\) be the number of tangent segments. Since each tangent segment contributes exactly 2 sharp corners to the diagram, and each region has exactly 3 sharp corners, we must have \\(2 s=3 r\\). Since the graph corresponding to the diagram is connected, we can use Euler's formula \\(n-s+r=1\\) and find \\(s=3 n-3\\) and \\(r=2 n-2\\).*{Number Theory}", "source_pdf": "imosl_2017.pdf", "notes": "fallback-regex"}
{"id": "IMOSL-2017-N2", "contest": "IMOSL", "year": "2017", "problem_number": "N2", "problem": "Let \\(p \\geqslant 2\\) be a prime number. Eduardo and Fernando play the following game making moves alternately: in each move, the current player chooses an index \\(i\\) in the set \\(\\{0,1, \\ldots, p-1\\}\\) that was not chosen before by either of the two players and then chooses an element \\(a_{i}\\) of the set \\(\\{0,1,2,3,4,5,6,7,8,9\\}\\). Eduardo has the first move. The game ends after all the indices \\(i \\in\\{0,1, \\ldots, p-1\\}\\) have been chosen. Then the following number is computed:\n\\[\nM=a_{0}+10 \\cdot a_{1}+\\cdots+10^{p-1} \\cdot a_{p-1}=\\sum_{j=0}^{p-1} a_{j} \\cdot 10^{j}\n\\]\n\nThe goal of Eduardo is to make the number \\(M\\) divisible by \\(p\\), and the goal of Fernando is to prevent this.\n\nProve that Eduardo has a winning strategy.\n(Morocco)", "solution": ". We say that a player makes the move \\(\\left(i, a_{i}\\right)\\) if he chooses the index \\(i\\) and then the element \\(a_{i}\\) of the set \\(\\{0,1,2,3,4,5,6,7,8,9\\}\\) in this move.\n\nIf \\(p=2\\) or \\(p=5\\) then Eduardo chooses \\(i=0\\) and \\(a_{0}=0\\) in the first move, and wins, since, independently of the next moves, \\(M\\) will be a multiple of 10 .\n\nNow assume that the prime number \\(p\\) does not belong to \\(\\{2,5\\}\\). Eduardo chooses \\(i=p-1\\) and \\(a_{p-1}=0\\) in the first move. By Fermat's Little Theorem, \\(\\left(10^{(p-1) / 2}\\right)^{2}=10^{p-1} \\equiv 1(\\bmod p)\\), so \\(p \\mid\\left(10^{(p-1) / 2}\\right)^{2}-1=\\left(10^{(p-1) / 2}+1\\right)\\left(10^{(p-1) / 2}-1\\right)\\). Since \\(p\\) is prime, either \\(p \\mid 10^{(p-1) / 2}+1\\) or \\(p \\mid 10^{(p-1) / 2}-1\\). Thus we have two cases:\nCase a: \\(10^{(p-1) / 2} \\equiv-1(\\bmod p)\\)\nIn this case, for each move \\(\\left(i, a_{i}\\right)\\) of Fernando, Eduardo immediately makes the move \\(\\left(j, a_{j}\\right)= \\left(i+\\frac{p-1}{2}, a_{i}\\right)\\), if \\(0 \\leqslant i \\leqslant \\frac{p-3}{2}\\), or \\(\\left(j, a_{j}\\right)=\\left(i-\\frac{p-1}{2}, a_{i}\\right)\\), if \\(\\frac{p-1}{2} \\leqslant i \\leqslant p-2\\). We will have \\(10^{j} \\equiv-10^{i} (\\bmod p)\\), and so \\(a_{j} \\cdot 10^{j}=a_{i} \\cdot 10^{j} \\equiv-a_{i} \\cdot 10^{i}(\\bmod p)\\). Notice that this move by Eduardo is always possible. Indeed, immediately before a move by Fernando, for any set of the type \\(\\{r, r+(p-1) / 2\\}\\) with \\(0 \\leqslant r \\leqslant(p-3) / 2\\), either no element of this set was chosen as an index by the players in the previous moves or else both elements of this set were chosen as indices by the players in the previous moves. Therefore, after each of his moves, Eduardo always makes the sum of the numbers \\(a_{k} \\cdot 10^{k}\\) corresponding to the already chosen pairs ( \\(k, a_{k}\\) ) divisible by \\(p\\), and thus wins the game.\nCase b: \\(10^{(p-1) / 2} \\equiv 1(\\bmod p)\\)\nIn this case, for each move \\(\\left(i, a_{i}\\right)\\) of Fernando, Eduardo immediately makes the move \\(\\left(j, a_{j}\\right)= \\left(i+\\frac{p-1}{2}, 9-a_{i}\\right)\\), if \\(0 \\leqslant i \\leqslant \\frac{p-3}{2}\\), or \\(\\left(j, a_{j}\\right)=\\left(i-\\frac{p-1}{2}, 9-a_{i}\\right)\\), if \\(\\frac{p-1}{2} \\leqslant i \\leqslant p-2\\). The same argument as above shows that Eduardo can always make such move. We will have \\(10^{j} \\equiv 10^{i} (\\bmod p)\\), and so \\(a_{j} \\cdot 10^{j}+a_{i} \\cdot 10^{i} \\equiv\\left(a_{i}+a_{j}\\right) \\cdot 10^{i}=9 \\cdot 10^{i}(\\bmod p)\\). Therefore, at the end of the game, the sum of all terms \\(a_{k} \\cdot 10^{k}\\) will be congruent to\n\\[\n\\sum_{i=0}^{\\frac{p-3}{2}} 9 \\cdot 10^{i}=10^{(p-1) / 2}-1 \\equiv 0 \\quad(\\bmod p)\n\\]\nand Eduardo wins the game.", "source_pdf": "imosl_2017.pdf", "notes": "fallback-regex"}
{"id": "IMOSL-2017-N3", "contest": "IMOSL", "year": "2017", "problem_number": "N3", "problem": "Determine all integers \\(n \\geqslant 2\\) with the following property: for any integers \\(a_{1}, a_{2}, \\ldots, a_{n}\\) whose sum is not divisible by \\(n\\), there exists an index \\(1 \\leqslant i \\leqslant n\\) such that none of the numbers\n\\[\na_{i}, a_{i}+a_{i+1}, \\ldots, a_{i}+a_{i+1}+\\cdots+a_{i+n-1}\n\\]\nis divisible by \\(n\\). (We let \\(a_{i}=a_{i-n}\\) when \\(i>n\\).)\n(Thailand)", "solution": "Answer: These integers are exactly the prime numbers.\n\n. Let us first show that, if \\(n=a b\\), with \\(a, b \\geqslant 2\\) integers, then the property in the statement of the problem does not hold. Indeed, in this case, let \\(a_{k}=a\\) for \\(1 \\leqslant k \\leqslant n-1\\) and \\(a_{n}=0\\). The sum \\(a_{1}+a_{2}+\\cdots+a_{n}=a \\cdot(n-1)\\) is not divisible by \\(n\\). Let \\(i\\) with \\(1 \\leqslant i \\leqslant n\\) be an arbitrary index. Taking \\(j=b\\) if \\(1 \\leqslant i \\leqslant n-b\\), and \\(j=b+1\\) if \\(n-b<i \\leqslant n\\), we have\n\\[\na_{i}+a_{i+1}+\\cdots+a_{i+j-1}=a \\cdot b=n \\equiv 0 \\quad(\\bmod n) .\n\\]\n\nIt follows that the given example is indeed a counterexample to the property of the statement.\nNow let \\(n\\) be a prime number. Suppose by contradiction that the property in the statement of the problem does not hold. Then there are integers \\(a_{1}, a_{2}, \\ldots, a_{n}\\) whose sum is not divisible by \\(n\\) such that for each \\(i, 1 \\leqslant i \\leqslant n\\), there is \\(j, 1 \\leqslant j \\leqslant n\\), for which the number \\(a_{i}+a_{i+1}+ \\cdots+a_{i+j-1}\\) is divisible by \\(n\\). Notice that, in any such case, we should have \\(1 \\leqslant j \\leqslant n-1\\), since \\(a_{1}+a_{2}+\\cdots+a_{n}\\) is not divisible by \\(n\\). So we may construct recursively a finite sequence of integers \\(0=i_{0}<i_{1}<i_{2}<\\cdots<i_{n}\\) with \\(i_{s+1}-i_{s} \\leqslant n-1\\) for \\(0 \\leqslant s \\leqslant n-1\\) such that, for \\(0 \\leqslant s \\leqslant n-1\\),\n\\[\na_{i_{s}+1}+a_{i_{s}+2}+\\cdots+a_{i_{s+1}} \\equiv 0 \\quad(\\bmod n)\n\\]\n(where we take indices modulo \\(n\\) ). Indeed, for \\(0 \\leqslant s<n\\), we apply the previous observation to \\(i=i_{s}+1\\) in order to define \\(i_{s+1}=i_{s}+j\\).\n\nIn the sequence of \\(n+1\\) indices \\(i_{0}, i_{1}, i_{2}, \\ldots, i_{n}\\), by the pigeonhole principle, we have two distinct elements which are congruent modulo \\(n\\). So there are indices \\(r, s\\) with \\(0 \\leqslant r<s \\leqslant n\\) such that \\(i_{s} \\equiv i_{r}(\\bmod n)\\) and\n\\[\na_{i_{r}+1}+a_{i_{r}+2}+\\cdots+a_{i_{s}}=\\sum_{j=r}^{s-1}\\left(a_{i_{j}+1}+a_{i_{j}+2}+\\cdots+a_{i_{j+1}}\\right) \\equiv 0 \\quad(\\bmod n) .\n\\]\n\nSince \\(i_{s} \\equiv i_{r}(\\bmod n)\\), we have \\(i_{s}-i_{r}=k \\cdot n\\) for some positive integer \\(k\\), and, since \\(i_{j+1}-i_{j} \\leqslant n-1\\) for \\(0 \\leqslant j \\leqslant n-1\\), we have \\(i_{s}-i_{r} \\leqslant(n-1) \\cdot n\\), so \\(k \\leqslant n-1\\). But in this case\n\\[\na_{i_{r}+1}+a_{i_{r}+2}+\\cdots+a_{i_{s}}=k \\cdot\\left(a_{1}+a_{2}+\\cdots+a_{n}\\right)\n\\]\ncannot be a multiple of \\(n\\), since \\(n\\) is prime and neither \\(k\\) nor \\(a_{1}+a_{2}+\\cdots+a_{n}\\) is a multiple of \\(n\\). A contradiction.", "source_pdf": "imosl_2017.pdf", "notes": "fallback-regex"}
{"id": "IMOSL-2017-N4", "contest": "IMOSL", "year": "2017", "problem_number": "N4", "problem": "Call a rational number short if it has finitely many digits in its decimal expansion. For a positive integer \\(m\\), we say that a positive integer \\(t\\) is \\(m\\)-tastic if there exists a number \\(c \\in\\{1,2,3, \\ldots, 2017\\}\\) such that \\(\\frac{10^{t}-1}{c \\cdot m}\\) is short, and such that \\(\\frac{10^{k}-1}{c \\cdot m}\\) is not short for any \\(1 \\leqslant k<t\\). Let \\(S(m)\\) be the set of \\(m\\)-tastic numbers. Consider \\(S(m)\\) for \\(m=1,2, \\ldots\\). What is the maximum number of elements in \\(S(m)\\) ?\n(Turkey)", "solution": "Answer: 807.\n\n. First notice that \\(x \\in \\mathbb{Q}\\) is short if and only if there are exponents \\(a, b \\geqslant 0\\) such that \\(2^{a} \\cdot 5^{b} \\cdot x \\in \\mathbb{Z}\\). In fact, if \\(x\\) is short, then \\(x=\\frac{n}{10^{k}}\\) for some \\(k\\) and we can take \\(a=b=k\\); on the other hand, if \\(2^{a} \\cdot 5^{b} \\cdot x=q \\in \\mathbb{Z}\\) then \\(x=\\frac{2^{b} \\cdot 5^{a} q}{10^{a+b}}\\), so \\(x\\) is short.\n\nIf \\(m=2^{a} \\cdot 5^{b} \\cdot s\\), with \\(\\operatorname{gcd}(s, 10)=1\\), then \\(\\frac{10^{t}-1}{m}\\) is short if and only if \\(s\\) divides \\(10^{t}-1\\). So we may (and will) suppose without loss of generality that \\(\\operatorname{gcd}(m, 10)=1\\). Define\n\\[\nC=\\{1 \\leqslant c \\leqslant 2017: \\operatorname{gcd}(c, 10)=1\\}\n\\]\n\nThe \\(m\\)-tastic numbers are then precisely the smallest exponents \\(t>0\\) such that \\(10^{t} \\equiv 1 (\\bmod \\mathrm{cm})\\) for some integer \\(c \\in C\\), that is, the set of orders of 10 modulo cm. In other words,\n\\[\nS(m)=\\left\\{\\operatorname{ord}_{c m}(10): c \\in C\\right\\}\n\\]\n\nSince there are \\(4 \\cdot 201+3=807\\) numbers \\(c\\) with \\(1 \\leqslant c \\leqslant 2017\\) and \\(\\operatorname{gcd}(c, 10)=1\\), namely those such that \\(c \\equiv 1,3,7,9(\\bmod 10)\\),\n\\[\n|S(m)| \\leqslant|C|=807\n\\]\n\nNow we find \\(m\\) such that \\(|S(m)|=807\\). Let\n\\[\nP=\\{1<p \\leqslant 2017: p \\text { is prime, } p \\neq 2,5\\}\n\\]\nand choose a positive integer \\(\\alpha\\) such that every \\(p \\in P\\) divides \\(10^{\\alpha}-1\\) (e.g. \\(\\alpha=\\varphi(T), T\\) being the product of all primes in \\(P\\) ), and let \\(m=10^{\\alpha}-1\\).\nClaim. For every \\(c \\in C\\), we have\n\\[\n\\operatorname{ord}_{c m}(10)=c \\alpha\n\\]\n\nAs an immediate consequence, this implies \\(|S(m)|=|C|=807\\), finishing the problem. Proof. Obviously \\(\\operatorname{ord}_{m}(10)=\\alpha\\). Let \\(t=\\operatorname{ord}_{c m}(10)\\). Then\n\\[\n\\mathrm{cm}\\left|10^{t}-1 \\quad \\Longrightarrow \\quad m\\right| 10^{t}-1 \\quad \\Longrightarrow \\quad \\alpha \\mid t .\n\\]\n\nHence \\(t=k \\alpha\\) for some \\(k \\in \\mathbb{Z}_{>0}\\). We will show that \\(k=c\\).\nDenote by \\(\\nu_{p}(n)\\) the number of prime factors \\(p\\) in \\(n\\), that is, the maximum exponent \\(\\beta\\) for which \\(p^{\\beta} \\mid n\\). For every \\(\\ell \\geqslant 1\\) and \\(p \\in P\\), the Lifting the Exponent Lemma provides\n\\[\n\\nu_{p}\\left(10^{\\ell \\alpha}-1\\right)=\\nu_{p}\\left(\\left(10^{\\alpha}\\right)^{\\ell}-1\\right)=\\nu_{p}\\left(10^{\\alpha}-1\\right)+\\nu_{p}(\\ell)=\\nu_{p}(m)+\\nu_{p}(\\ell)\n\\]\n\nSo\n\\[\n\\begin{aligned}\nc m \\mid 10^{k \\alpha}-1 & \\Longleftrightarrow \\forall p \\in P ; \\nu_{p}(c m) \\leqslant \\nu_{p}\\left(10^{k \\alpha}-1\\right) \\\\\n& \\Longleftrightarrow \\forall p \\in P ; \\nu_{p}(m)+\\nu_{p}(c) \\leqslant \\nu_{p}(m)+\\nu_{p}(k) \\\\\n& \\Longleftrightarrow \\forall p \\in P ; \\nu_{p}(c) \\leqslant \\nu_{p}(k) \\\\\n& \\Longleftrightarrow c \\mid k .\n\\end{aligned}\n\\]\n\nThe first such \\(k\\) is \\(k=c\\), so \\(\\operatorname{ord}_{c m}(10)=c \\alpha\\).\n\nComment. The Lifting the Exponent Lemma states that, for any odd prime \\(p\\), any integers \\(a, b\\) coprime with \\(p\\) such that \\(p \\mid a-b\\), and any positive integer exponent \\(n\\),\n\\[\n\\nu_{p}\\left(a^{n}-b^{n}\\right)=\\nu_{p}(a-b)+\\nu_{p}(n)\n\\]\nand, for \\(p=2\\),\n\\[\n\\nu_{2}\\left(a^{n}-b^{n}\\right)=\\nu_{2}\\left(a^{2}-b^{2}\\right)+\\nu_{p}(n)-1\n\\]\n\nBoth claims can be proved by induction on \\(n\\).", "source_pdf": "imosl_2017.pdf", "notes": "fallback-regex"}
{"id": "IMOSL-2017-N5", "contest": "IMOSL", "year": "2017", "problem_number": "N5", "problem": "Find all pairs \\((p, q)\\) of prime numbers with \\(p>q\\) for which the number\n\\[\n\\frac{(p+q)^{p+q}(p-q)^{p-q}-1}{(p+q)^{p-q}(p-q)^{p+q}-1}\n\\]\nis an integer.\n(Japan)", "solution": "Answer: The only such pair is \\((3,2)\\).\n\n. Let \\(M=(p+q)^{p-q}(p-q)^{p+q}-1\\), which is relatively prime with both \\(p+q\\) and \\(p-q\\). Denote by \\((p-q)^{-1}\\) the multiplicative inverse of \\((p-q)\\) modulo \\(M\\).\n\nBy eliminating the term -1 in the numerator,\n\\[\n\\begin{aligned}\n(p+q)^{p+q}(p-q)^{p-q}-1 & \\equiv(p+q)^{p-q}(p-q)^{p+q}-1 \\quad(\\bmod M) \\\\\n(p+q)^{2 q} & \\equiv(p-q)^{2 q} \\quad(\\bmod M) \\\\\n\\left((p+q) \\cdot(p-q)^{-1}\\right)^{2 q} & \\equiv 1 \\quad(\\bmod M)\n\\end{aligned}\n\\]\n\nCase 1: \\(q \\geqslant 5\\).\nConsider an arbitrary prime divisor \\(r\\) of \\(M\\). Notice that \\(M\\) is odd, so \\(r \\geqslant 3\\). By (2), the multiplicative order of \\(\\left((p+q) \\cdot(p-q)^{-1}\\right)\\) modulo \\(r\\) is a divisor of the exponent \\(2 q\\) in (2), so it can be \\(1,2, q\\) or \\(2 q\\).\n\nBy Fermat's theorem, the order divides \\(r-1\\). So, if the order is \\(q\\) or \\(2 q\\) then \\(r \\equiv 1(\\bmod q)\\). If the order is 1 or 2 then \\(r \\mid(p+q)^{2}-(p-q)^{2}=4 p q\\), so \\(r=p\\) or \\(r=q\\). The case \\(r=p\\) is not possible, because, by applying Fermat's theorem,\n\\(M=(p+q)^{p-q}(p-q)^{p+q}-1 \\equiv q^{p-q}(-q)^{p+q}-1=\\left(q^{2}\\right)^{p}-1 \\equiv q^{2}-1=(q+1)(q-1) \\quad(\\bmod p)\\)\nand the last factors \\(q-1\\) and \\(q+1\\) are less than \\(p\\) and thus \\(p \\nmid M\\). Hence, all prime divisors of \\(M\\) are either \\(q\\) or of the form \\(k q+1\\); it follows that all positive divisors of \\(M\\) are congruent to 0 or 1 modulo \\(q\\).\n\nNow notice that\n\\[\nM=\\left((p+q)^{\\frac{p-q}{2}}(p-q)^{\\frac{p+q}{2}}-1\\right)\\left((p+q)^{\\frac{p-q}{2}}(p-q)^{\\frac{p+q}{2}}+1\\right)\n\\]\nis the product of two consecutive positive odd numbers; both should be congruent to 0 or 1 modulo \\(q\\). But this is impossible by the assumption \\(q \\geqslant 5\\). So, there is no solution in Case 1 .\n\nCase 2: \\(q=2\\).\nBy (1), we have \\(M \\mid(p+q)^{2 q}-(p-q)^{2 q}=(p+2)^{4}-(p-2)^{4}\\), so\n\\[\n\\begin{gathered}\n(p+2)^{p-2}(p-2)^{p+2}-1=M \\leqslant(p+2)^{4}-(p-2)^{4} \\leqslant(p+2)^{4}-1, \\\\\n(p+2)^{p-6}(p-2)^{p+2} \\leqslant 1 .\n\\end{gathered}\n\\]\n\nIf \\(p \\geqslant 7\\) then the left-hand side is obviously greater than 1 . For \\(p=5\\) we have \\((p+2)^{p-6}(p-2)^{p+2}=7^{-1} \\cdot 3^{7}\\) which is also too large.\n\nThere remains only one candidate, \\(p=3\\), which provides a solution:\n\\[\n\\frac{(p+q)^{p+q}(p-q)^{p-q}-1}{(p+q)^{p-q}(p-q)^{p+q}-1}=\\frac{5^{5} \\cdot 1^{1}-1}{5^{1} \\cdot 1^{5}-1}=\\frac{3124}{4}=781 .\n\\]\n\nSo in Case 2 the only solution is \\((p, q)=(3,2)\\).\n\nCase 3: \\(q=3\\).\nSimilarly to Case 2, we have\n\\[\nM \\left\\lvert\\,(p+q)^{2 q}-(p-q)^{2 q}=64 \\cdot\\left(\\left(\\frac{p+3}{2}\\right)^{6}-\\left(\\frac{p-3}{2}\\right)^{6}\\right) .\\right.\n\\]\n\nSince \\(M\\) is odd, we conclude that\n\\[\nM \\left\\lvert\\,\\left(\\frac{p+3}{2}\\right)^{6}-\\left(\\frac{p-3}{2}\\right)^{6}\\right.\n\\]\nand\n\\[\n\\begin{gathered}\n(p+3)^{p-3}(p-3)^{p+3}-1=M \\leqslant\\left(\\frac{p+3}{2}\\right)^{6}-\\left(\\frac{p-3}{2}\\right)^{6} \\leqslant\\left(\\frac{p+3}{2}\\right)^{6}-1, \\\\\n64(p+3)^{p-9}(p-3)^{p+3} \\leqslant 1 .\n\\end{gathered}\n\\]\n\nIf \\(p \\geqslant 11\\) then the left-hand side is obviously greater than 1 . If \\(p=7\\) then the left-hand side is \\(64 \\cdot 10^{-2} \\cdot 4^{10}>1\\). If \\(p=5\\) then the left-hand side is \\(64 \\cdot 8^{-4} \\cdot 2^{8}=2^{2}>1\\). Therefore, there is no solution in Case 3.", "source_pdf": "imosl_2017.pdf", "notes": "fallback-regex"}
{"id": "IMOSL-2017-N6", "contest": "IMOSL", "year": "2017", "problem_number": "N6", "problem": "Find the smallest positive integer \\(n\\), or show that no such \\(n\\) exists, with the following property: there are infinitely many distinct \\(n\\)-tuples of positive rational numbers ( \\(a_{1}, a_{2}, \\ldots, a_{n}\\) ) such that both\n\\[\na_{1}+a_{2}+\\cdots+a_{n} \\quad \\text { and } \\quad \\frac{1}{a_{1}}+\\frac{1}{a_{2}}+\\cdots+\\frac{1}{a_{n}}\n\\]\nare integers.\n(Singapore)", "solution": "Answer: \\(n=3\\).\n\n1. For \\(n=1, a_{1} \\in \\mathbb{Z}_{>0}\\) and \\(\\frac{1}{a_{1}} \\in \\mathbb{Z}_{>0}\\) if and only if \\(a_{1}=1\\). Next we show that\n(i) There are finitely many \\((x, y) \\in \\mathbb{Q}_{>0}^{2}\\) satisfying \\(x+y \\in \\mathbb{Z}\\) and \\(\\frac{1}{x}+\\frac{1}{y} \\in \\mathbb{Z}\\)\n\nWrite \\(x=\\frac{a}{b}\\) and \\(y=\\frac{c}{d}\\) with \\(a, b, c, d \\in \\mathbb{Z}_{>0}\\) and \\(\\operatorname{gcd}(a, b)=\\operatorname{gcd}(c, d)=1\\). Then \\(x+y \\in \\mathbb{Z}\\) and \\(\\frac{1}{x}+\\frac{1}{y} \\in \\mathbb{Z}\\) is equivalent to the two divisibility conditions\n\\[\nb d \\mid a d+b c \\text { (1) } \\quad \\text { and } \\quad a c \\mid a d+b c \\text { (2) }\n\\]\n\nCondition (1) implies that \\(d|a d+b c \\Longleftrightarrow d| b c \\Longleftrightarrow d \\mid b\\) since \\(\\operatorname{gcd}(c, d)=1\\). Still from (1) we get \\(b|a d+b c \\Longleftrightarrow b| a d \\Longleftrightarrow b \\mid d\\) since \\(\\operatorname{gcd}(a, b)=1\\). From \\(b \\mid d\\) and \\(d \\mid b\\) we have \\(b=d\\).\nAn analogous reasoning with condition (2) shows that \\(a=c\\). Hence \\(x=\\frac{a}{b}=\\frac{c}{d}=y\\), i.e., the problem amounts to finding all \\(x \\in \\mathbb{Q}_{>0}\\) such that \\(2 x \\in \\mathbb{Z}_{>0}\\) and \\(\\frac{2}{x} \\in \\mathbb{Z}_{>0}\\). Letting \\(n=2 x \\in \\mathbb{Z}_{>0}\\), we have that \\(\\frac{2}{x} \\in \\mathbb{Z}_{>0} \\Longleftrightarrow \\frac{4}{n} \\in \\mathbb{Z}_{>0} \\Longleftrightarrow n=1,2\\) or 4 , and there are finitely many solutions, namely \\((x, y)=\\left(\\frac{1}{2}, \\frac{1}{2}\\right),(1,1)\\) or \\((2,2)\\).\n(ii) There are infinitely many triples \\((x, y, z) \\in \\mathbb{Q}_{>0}^{2}\\) such that \\(x+y+z \\in \\mathbb{Z}\\) and \\(\\frac{1}{x}+\\frac{1}{y}+\\frac{1}{z} \\in \\mathbb{Z}\\). We will look for triples such that \\(x+y+z=1\\), so we may write them in the form\n\\[\n(x, y, z)=\\left(\\frac{a}{a+b+c}, \\frac{b}{a+b+c}, \\frac{c}{a+b+c}\\right) \\quad \\text { with } a, b, c \\in \\mathbb{Z}_{>0}\n\\]\n\nWe want these to satisfy\n\\[\n\\frac{1}{x}+\\frac{1}{y}+\\frac{1}{z}=\\frac{a+b+c}{a}+\\frac{a+b+c}{b}+\\frac{a+b+c}{c} \\in \\mathbb{Z} \\Longleftrightarrow \\frac{b+c}{a}+\\frac{a+c}{b}+\\frac{a+b}{c} \\in \\mathbb{Z}\n\\]\n\nFixing \\(a=1\\), it suffices to find infinitely many pairs \\((b, c) \\in \\mathbb{Z}_{>0}^{2}\\) such that\n\\[\n\\frac{1}{b}+\\frac{1}{c}+\\frac{c}{b}+\\frac{b}{c}=3 \\Longleftrightarrow b^{2}+c^{2}-3 b c+b+c=0\n\\]\n\nTo show that equation (*) has infinitely many solutions, we use Vieta jumping (also known as root flipping): starting with \\(b=2, c=3\\), the following algorithm generates infinitely many solutions. Let \\(c \\geqslant b\\), and view (*) as a quadratic equation in \\(b\\) for \\(c\\) fixed:\n\\[\nb^{2}-(3 c-1) \\cdot b+\\left(c^{2}+c\\right)=0\n\\]\n\nThen there exists another root \\(b_{0} \\in \\mathbb{Z}\\) of ( \\(* *\\) ) which satisfies \\(b+b_{0}=3 c-1\\) and \\(b \\cdot b_{0}=c^{2}+c\\). Since \\(c \\geqslant b\\) by assumption,\n\\[\nb_{0}=\\frac{c^{2}+c}{b} \\geqslant \\frac{c^{2}+c}{c}>c\n\\]\n\nHence from the solution ( \\(b, c\\) ) we obtain another one ( \\(c, b_{0}\\) ) with \\(b_{0}>c\\), and we can then \"jump\" again, this time with \\(c\\) as the \"variable\" in the quadratic (*). This algorithm will generate an infinite sequence of distinct solutions, whose first terms are\n\\((2,3),(3,6),(6,14),(14,35),(35,90),(90,234),(234,611),(611,1598),(1598,4182), \\ldots\\)\n\nComment. Although not needed for solving this problem, we may also explicitly solve the recursion given by the Vieta jumping. Define the sequence ( \\(x_{n}\\) ) as follows:\n\\[\nx_{0}=2, \\quad x_{1}=3 \\quad \\text { and } \\quad x_{n+2}=3 x_{n+1}-x_{n}-1 \\text { for } n \\geqslant 0\n\\]\n\nThen the triple\n\\[\n(x, y, z)=\\left(\\frac{1}{1+x_{n}+x_{n+1}}, \\frac{x_{n}}{1+x_{n}+x_{n+1}}, \\frac{x_{n+1}}{1+x_{n}+x_{n+1}}\\right)\n\\]\nsatisfies the problem conditions for all \\(n \\in \\mathbb{N}\\). It is easy to show that \\(x_{n}=F_{2 n+1}+1\\), where \\(F_{n}\\) denotes the \\(n\\)-th term of the Fibonacci sequence ( \\(F_{0}=0, F_{1}=1\\), and \\(F_{n+2}=F_{n+1}+F_{n}\\) for \\(n \\geqslant 0\\) ).\nSolution 2. Call the \\(n\\)-tuples \\(\\left(a_{1}, a_{2}, \\ldots, a_{n}\\right) \\in \\mathbb{Q}_{>0}^{n}\\) satisfying the conditions of the problem statement good, and those for which\n\\[\nf\\left(a_{1}, \\ldots, a_{n}\\right) \\stackrel{\\text { def }}{=}\\left(a_{1}+a_{2}+\\cdots+a_{n}\\right)\\left(\\frac{1}{a_{1}}+\\frac{1}{a_{2}}+\\cdots+\\frac{1}{a_{n}}\\right)\n\\]\nis an integer pretty. Then good \\(n\\)-tuples are pretty, and if ( \\(b_{1}, \\ldots, b_{n}\\) ) is pretty then\n\\[\n\\left(\\frac{b_{1}}{b_{1}+b_{2}+\\cdots+b_{n}}, \\frac{b_{2}}{b_{1}+b_{2}+\\cdots+b_{n}}, \\cdots, \\frac{b_{n}}{b_{1}+b_{2}+\\cdots+b_{n}}\\right)\n\\]\nis good since the sum of its components is 1 , and the sum of the reciprocals of its components equals \\(f\\left(b_{1}, \\ldots, b_{n}\\right)\\). We declare pretty \\(n\\)-tuples proportional to each other equivalent since they are precisely those which give rise to the same good \\(n\\)-tuple. Clearly, each such equivalence class contains exactly one \\(n\\)-tuple of positive integers having no common prime divisors. Call such \\(n\\)-tuple a primitive pretty tuple. Our task is to find infinitely many primitive pretty \\(n\\)-tuples.\n\nFor \\(n=1\\), there is clearly a single primitive 1 -tuple. For \\(n=2\\), we have \\(f(a, b)=\\frac{(a+b)^{2}}{a b}\\), which can be integral (for coprime \\(a, b \\in \\mathbb{Z}_{>0}\\) ) only if \\(a=b=1\\) (see for instance (i) in the first solution).\n\nNow we construct infinitely many primitive pretty triples for \\(n=3\\). Fix \\(b, c, k \\in \\mathbb{Z}_{>0}\\); we will try to find sufficient conditions for the existence of an \\(a \\in \\mathbb{Q}_{>0}\\) such that \\(f(a, b, c)=k\\). Write \\(\\sigma=b+c, \\tau=b c\\). From \\(f(a, b, c)=k\\), we have that \\(a\\) should satisfy the quadratic equation\n\\[\na^{2} \\cdot \\sigma+a \\cdot\\left(\\sigma^{2}-(k-1) \\tau\\right)+\\sigma \\tau=0\n\\]\nwhose discriminant is\n\\[\n\\Delta=\\left(\\sigma^{2}-(k-1) \\tau\\right)^{2}-4 \\sigma^{2} \\tau=\\left((k+1) \\tau-\\sigma^{2}\\right)^{2}-4 k \\tau^{2}\n\\]\n\nWe need it to be a square of an integer, say, \\(\\Delta=M^{2}\\) for some \\(M \\in \\mathbb{Z}\\), i.e., we want\n\\[\n\\left((k+1) \\tau-\\sigma^{2}\\right)^{2}-M^{2}=2 k \\cdot 2 \\tau^{2}\n\\]\nso that it suffices to set\n\\[\n(k+1) \\tau-\\sigma^{2}=\\tau^{2}+k, \\quad M=\\tau^{2}-k\n\\]\n\nThe first relation reads \\(\\sigma^{2}=(\\tau-1)(k-\\tau)\\), so if \\(b\\) and \\(c\\) satisfy\n\\[\n\\tau-1 \\mid \\sigma^{2} \\quad \\text { i.e. } \\quad b c-1 \\mid(b+c)^{2}\n\\]\nthen \\(k=\\frac{\\sigma^{2}}{\\tau-1}+\\tau\\) will be integral, and we find rational solutions to (1), namely\n\\[\na=\\frac{\\sigma}{\\tau-1}=\\frac{b+c}{b c-1} \\quad \\text { or } \\quad a=\\frac{\\tau^{2}-\\tau}{\\sigma}=\\frac{b c \\cdot(b c-1)}{b+c}\n\\]\n\nWe can now find infinitely many pairs ( \\(b, c\\) ) satisfying (2) by Vieta jumping. For example, if we impose\n\\[\n(b+c)^{2}=5 \\cdot(b c-1)\n\\]\nthen all pairs \\((b, c)=\\left(v_{i}, v_{i+1}\\right)\\) satisfy the above condition, where\n\\[\nv_{1}=2, \\quad v_{2}=3, \\quad v_{i+2}=3 v_{i+1}-v_{i} \\quad \\text { for } i \\geqslant 0\n\\]\n\nFor \\((b, c)=\\left(v_{i}, v_{i+1}\\right)\\), one of the solutions to (1) will be \\(a=(b+c) /(b c-1)=5 /(b+c)= 5 /\\left(v_{i}+v_{i+1}\\right)\\). Then the pretty triple ( \\(a, b, c\\) ) will be equivalent to the integral pretty triple\n\\[\n\\left(5, v_{i}\\left(v_{i}+v_{i+1}\\right), v_{i+1}\\left(v_{i}+v_{i+1}\\right)\\right)\n\\]\n\nAfter possibly dividing by 5 , we obtain infinitely many primitive pretty triples, as required.\n\nComment. There are many other infinite series of \\((b, c)=\\left(v_{i}, v_{i+1}\\right)\\) with \\(b c-1 \\mid(b+c)^{2}\\). Some of them are:\n\\[\n\\begin{array}{llll}\nv_{1}=1, & v_{2}=3, & v_{i+1}=6 v_{i}-v_{i-1}, & \\left(v_{i}+v_{i+1}\\right)^{2}=8 \\cdot\\left(v_{i} v_{i+1}-1\\right) \\\\\nv_{1}=1, & v_{2}=2, & v_{i+1}=7 v_{i}-v_{i-1}, & \\left(v_{i}+v_{i+1}\\right)^{2}=9 \\cdot\\left(v_{i} v_{i+1}-1\\right) \\\\\nv_{1}=1, & v_{2}=5, & v_{i+1}=7 v_{i}-v_{i-1}, & \\left(v_{i}+v_{i+1}\\right)^{2}=9 \\cdot\\left(v_{i} v_{i+1}-1\\right)\n\\end{array}\n\\]\n(the last two are in fact one sequence prolonged in two possible directions).", "source_pdf": "imosl_2017.pdf", "notes": "fallback-regex"}
{"id": "IMOSL-2017-N8", "contest": "IMOSL", "year": "2017", "problem_number": "N8", "problem": "Let \\(p\\) be an odd prime number and \\(\\mathbb{Z}_{>0}\\) be the set of positive integers. Suppose that a function \\(f: \\mathbb{Z}_{>0} \\times \\mathbb{Z}_{>0} \\rightarrow\\{0,1\\}\\) satisfies the following properties:\n- \\(f(1,1)=0\\);\n- \\(f(a, b)+f(b, a)=1\\) for any pair of relatively prime positive integers ( \\(a, b\\) ) not both equal to 1 ;\n- \\(f(a+b, b)=f(a, b)\\) for any pair of relatively prime positive integers \\((a, b)\\).\n\nProve that\n\\[\n\\sum_{n=1}^{p-1} f\\left(n^{2}, p\\right) \\geqslant \\sqrt{2 p}-2 .\n\\]\n(Italy)", "solution": "1. Denote by \\(\\mathbb{A}\\) the set of all pairs of coprime positive integers. Notice that for every \\((a, b) \\in \\mathbb{A}\\) there exists a pair \\((u, v) \\in \\mathbb{Z}^{2}\\) with \\(u a+v b=1\\). Moreover, if \\(\\left(u_{0}, v_{0}\\right)\\) is one such pair, then all such pairs are of the form \\((u, v)=\\left(u_{0}+k b, v_{0}-k a\\right)\\), where \\(k \\in \\mathbb{Z}\\). So there exists a unique such pair ( \\(u, v\\) ) with \\(-b / 2<u \\leqslant b / 2\\); we denote this pair by ( \\(u, v\\) ) = \\(g(a, b)\\).\nLemma. Let \\((a, b) \\in \\mathbb{A}\\) and \\((u, v)=g(a, b)\\). Then \\(f(a, b)=1 \\Longleftrightarrow u>0\\).\nProof. We induct on \\(a+b\\). The base case is \\(a+b=2\\). In this case, we have that \\(a=b=1\\), \\(g(a, b)=g(1,1)=(0,1)\\) and \\(f(1,1)=0\\), so the claim holds.\n\nAssume now that \\(a+b>2\\), and so \\(a \\neq b\\), since \\(a\\) and \\(b\\) are coprime. Two cases are possible.\nCase 1: \\(a>b\\).\nNotice that \\(g(a-b, b)=(u, v+u)\\), since \\(u(a-b)+(v+u) b=1\\) and \\(u \\in(-b / 2, b / 2]\\). Thus \\(f(a, b)=1 \\Longleftrightarrow f(a-b, b)=1 \\Longleftrightarrow u>0\\) by the induction hypothesis.\nCase 2: \\(a<b\\). (Then, clearly, \\(b \\geqslant 2\\).)\nNow we estimate \\(v\\). Since \\(v b=1-u a\\), we have\n\\[\n1+\\frac{a b}{2}>v b \\geqslant 1-\\frac{a b}{2}, \\quad \\text { so } \\quad \\frac{1+a}{2} \\geqslant \\frac{1}{b}+\\frac{a}{2}>v \\geqslant \\frac{1}{b}-\\frac{a}{2}>-\\frac{a}{2} .\n\\]\n\nThus \\(1+a>2 v>-a\\), so \\(a \\geqslant 2 v>-a\\), hence \\(a / 2 \\geqslant v>-a / 2\\), and thus \\(g(b, a)=(v, u)\\).\nObserve that \\(f(a, b)=1 \\Longleftrightarrow f(b, a)=0 \\Longleftrightarrow f(b-a, a)=0\\). We know from Case 1 that \\(g(b-a, a)=(v, u+v)\\). We have \\(f(b-a, a)=0 \\Longleftrightarrow v \\leqslant 0\\) by the inductive hypothesis. Then, since \\(b>a \\geqslant 1\\) and \\(u a+v b=1\\), we have \\(v \\leqslant 0 \\Longleftrightarrow u>0\\), and we are done.\n\nThe Lemma proves that, for all \\((a, b) \\in \\mathbb{A}, f(a, b)=1\\) if and only if the inverse of \\(a\\) modulo \\(b\\), taken in \\(\\{1,2, \\ldots, b-1\\}\\), is at most \\(b / 2\\). Then, for any odd prime \\(p\\) and integer \\(n\\) such that \\(n \\not \\equiv 0(\\bmod p), f\\left(n^{2}, p\\right)=1\\) iff the inverse of \\(n^{2} \\bmod p\\) is less than \\(p / 2\\). Since \\(\\left\\{n^{2} \\bmod p: 1 \\leqslant n \\leqslant p-1\\right\\}=\\left\\{n^{-2} \\bmod p: 1 \\leqslant n \\leqslant p-1\\right\\}\\), including multiplicities (two for each quadratic residue in each set), we conclude that the desired sum is twice the number of quadratic residues that are less than \\(p / 2\\), i.e.,\n\\[\n\\left.\\sum_{n=1}^{p-1} f\\left(n^{2}, p\\right)=2 \\left\\lvert\\,\\left\\{k: 1 \\leqslant k \\leqslant \\frac{p-1}{2} \\text { and } k^{2} \\bmod p<\\frac{p}{2}\\right\\}\\right. \\right\\rvert\\, .\n\\]\n\nSince the number of perfect squares in the interval \\([1, p / 2)\\) is \\(\\lfloor\\sqrt{p / 2}\\rfloor>\\sqrt{p / 2}-1\\), we conclude that\n\\[\n\\sum_{n=1}^{p-1} f\\left(n^{2}, p\\right)>2\\left(\\sqrt{\\frac{p}{2}}-1\\right)=\\sqrt{2 p}-2\n\\]\n\nSolution 2. We provide a different proof for the Lemma. For this purpose, we use continued fractions to find \\(g(a, b)=(u, v)\\) explicitly.\n\nThe function \\(f\\) is completely determined on \\(\\mathbb{A}\\) by the following\nClaim. Represent \\(a / b\\) as a continued fraction; that is, let \\(a_{0}\\) be an integer and \\(a_{1}, \\ldots, a_{k}\\) be positive integers such that \\(a_{k} \\geqslant 2\\) and\n\\[\n\\frac{a}{b}=a_{0}+\\frac{1}{a_{1}+\\frac{1}{a_{2}+\\frac{1}{\\cdots+\\frac{1}{a_{k}}}}}=\\left[a_{0} ; a_{1}, a_{2}, \\ldots, a_{k}\\right] .\n\\]\n\nThen \\(f(a, b)=0 \\Longleftrightarrow k\\) is even.\nProof. We induct on \\(b\\). If \\(b=1\\), then \\(a / b=[a]\\) and \\(k=0\\). Then, for \\(a \\geqslant 1\\), an easy induction shows that \\(f(a, 1)=f(1,1)=0\\).\n\nNow consider the case \\(b>1\\). Perform the Euclidean division \\(a=q b+r\\), with \\(0 \\leqslant r<b\\). We have \\(r \\neq 0\\) because \\(\\operatorname{gcd}(a, b)=1\\). Hence\n\\[\nf(a, b)=f(r, b)=1-f(b, r), \\quad \\frac{a}{b}=\\left[q ; a_{1}, \\ldots, a_{k}\\right], \\quad \\text { and } \\quad \\frac{b}{r}=\\left[a_{1} ; a_{2}, \\ldots, a_{k}\\right] .\n\\]\n\nThen the number of terms in the continued fraction representations of \\(a / b\\) and \\(b / r\\) differ by one. Since \\(r<b\\), the inductive hypothesis yields\n\\[\nf(b, r)=0 \\Longleftrightarrow k-1 \\text { is even, }\n\\]\nand thus\n\\[\nf(a, b)=0 \\Longleftrightarrow f(b, r)=1 \\Longleftrightarrow k-1 \\text { is odd } \\Longleftrightarrow k \\text { is even. }\n\\]\n\nNow we use the following well-known properties of continued fractions to prove the Lemma:\nLet \\(p_{i}\\) and \\(q_{i}\\) be coprime positive integers with \\(\\left[a_{0} ; a_{1}, a_{2}, \\ldots, a_{i}\\right]=p_{i} / q_{i}\\), with the notation borrowed from the Claim. In particular, \\(a / b=\\left[a_{0} ; a_{1}, a_{2}, \\ldots, a_{k}\\right]=p_{k} / q_{k}\\). Assume that \\(k>0\\) and define \\(q_{-1}=0\\) if necessary. Then\n- \\(q_{k}=a_{k} q_{k-1}+q_{k-2}, \\quad\\) and\n- \\(a q_{k-1}-b p_{k-1}=p_{k} q_{k-1}-q_{k} p_{k-1}=(-1)^{k-1}\\).\n\nAssume that \\(k>0\\). Then \\(a_{k} \\geqslant 2\\), and\n\\[\nb=q_{k}=a_{k} q_{k-1}+q_{k-2} \\geqslant a_{k} q_{k-1} \\geqslant 2 q_{k-1} \\Longrightarrow q_{k-1} \\leqslant \\frac{b}{2}\n\\]\nwith strict inequality for \\(k>1\\), and\n\\[\n(-1)^{k-1} q_{k-1} a+(-1)^{k} p_{k-1} b=1\n\\]\n\nNow we finish the proof of the Lemma. It is immediate for \\(k=0\\). If \\(k=1\\), then \\((-1)^{k-1}=1\\), so\n\\[\n-b / 2<0 \\leqslant(-1)^{k-1} q_{k-1} \\leqslant b / 2 .\n\\]\n\nIf \\(k>1\\), we have \\(q_{k-1}<b / 2\\), so\n\\[\n-b / 2<(-1)^{k-1} q_{k-1}<b / 2\n\\]\n\nThus, for any \\(k>0\\), we find that \\(g(a, b)=\\left((-1)^{k-1} q_{k-1},(-1)^{k} p_{k-1}\\right)\\), and so\n\\[\nf(a, b)=1 \\Longleftrightarrow k \\text { is odd } \\Longleftrightarrow u=(-1)^{k-1} q_{k-1}>0\n\\]\n\nComment 1. The Lemma can also be established by observing that \\(f\\) is uniquely defined on \\(\\mathbb{A}\\), defining \\(f_{1}(a, b)=1\\) if \\(u>0\\) in \\(g(a, b)=(u, v)\\) and \\(f_{1}(a, b)=0\\) otherwise, and verifying that \\(f_{1}\\) satisfies all the conditions from the statement.\n\nIt seems that the main difficulty of the problem is in conjecturing the Lemma.\nComment 2. The case \\(p \\equiv 1(\\bmod 4)\\) is, in fact, easier than the original problem. We have, in general, for \\(1 \\leqslant a \\leqslant p-1\\),\n\\(f(a, p)=1-f(p, a)=1-f(p-a, a)=f(a, p-a)=f(a+(p-a), p-a)=f(p, p-a)=1-f(p-a, p)\\).\nIf \\(p \\equiv 1(\\bmod 4)\\), then \\(a\\) is a quadratic residue modulo \\(p\\) if and only if \\(p-a\\) is a quadratic residue modulo \\(p\\). Therefore, denoting by \\(r_{k}\\) (with \\(1 \\leqslant r_{k} \\leqslant p-1\\) ) the remainder of the division of \\(k^{2}\\) by \\(p\\), we get\n\\[\n\\sum_{n=1}^{p-1} f\\left(n^{2}, p\\right)=\\sum_{n=1}^{p-1} f\\left(r_{n}, p\\right)=\\frac{1}{2} \\sum_{n=1}^{p-1}\\left(f\\left(r_{n}, p\\right)+f\\left(p-r_{n}, p\\right)\\right)=\\frac{p-1}{2}\n\\]\n\nComment 3. The estimate for the sum \\(\\sum_{n=1}^{p} f\\left(n^{2}, p\\right)\\) can be improved by refining the final argument in Solution 1. In fact, one can prove that\n\\[\n\\sum_{n=1}^{p-1} f\\left(n^{2}, p\\right) \\geqslant \\frac{p-1}{16}\n\\]\n\nBy counting the number of perfect squares in the intervals \\([k p,(k+1 / 2) p)\\), we find that\n\\[\n\\sum_{n=1}^{p-1} f\\left(n^{2}, p\\right)=\\sum_{k=0}^{p-1}\\left(\\left\\lfloor\\sqrt{\\left(k+\\frac{1}{2}\\right) p}\\right\\rfloor-\\lfloor\\sqrt{k p}\\rfloor\\right)\n\\]\n\nEach summand of (2) is non-negative. We now estimate the number of positive summands. Suppose that a summand is zero, i.e.,\n\\[\n\\left\\lfloor\\sqrt{\\left(k+\\frac{1}{2}\\right) p}\\right\\rfloor=\\lfloor\\sqrt{k p}\\rfloor=: q\n\\]\n\nThen both of the numbers \\(k p\\) and \\(k p+p / 2\\) lie within the interval \\(\\left[q^{2},(q+1)^{2}\\right)\\). Hence\n\\[\n\\frac{p}{2}<(q+1)^{2}-q^{2}\n\\]\nwhich implies\n\\[\nq \\geqslant \\frac{p-1}{4}\n\\]\n\nSince \\(q \\leqslant \\sqrt{k p}\\), if the \\(k^{\\text {th }}\\) summand of (2) is zero, then\n\\[\nk \\geqslant \\frac{q^{2}}{p} \\geqslant \\frac{(p-1)^{2}}{16 p}>\\frac{p-2}{16} \\Longrightarrow k \\geqslant \\frac{p-1}{16}\n\\]\n\nSo at least the first \\(\\left\\lceil\\frac{p-1}{16}\\right\\rceil\\) summands (from \\(k=0\\) to \\(k=\\left\\lceil\\frac{p-1}{16}\\right\\rceil-1\\) ) are positive, and the result follows.\n\nComment 4. The bound can be further improved by using different methods. In fact, we prove that\n\\[\n\\sum_{n=1}^{p-1} f\\left(n^{2}, p\\right) \\geqslant \\frac{p-3}{4}\n\\]\n\nTo that end, we use the Legendre symbol\n\\[\n\\left(\\frac{a}{p}\\right)= \\begin{cases}0 & \\text { if } p \\mid a \\\\ 1 & \\text { if } a \\text { is a nonzero quadratic residue } \\bmod p \\\\ -1 & \\text { otherwise. }\\end{cases}\n\\]\n\nWe start with the following Claim, which tells us that there are not too many consecutive quadratic residues or consecutive quadratic non-residues.\n\nClaim. \\(\\sum_{n=1}^{p-1}\\left(\\frac{n}{p}\\right)\\left(\\frac{n+1}{p}\\right)=-1\\).\nProof. We have \\(\\left(\\frac{n}{p}\\right)\\left(\\frac{n+1}{p}\\right)=\\left(\\frac{n(n+1)}{p}\\right)\\). For \\(1 \\leqslant n \\leqslant p-1\\), we get that \\(n(n+1) \\equiv n^{2}\\left(1+n^{-1}\\right)(\\bmod p)\\), hence \\(\\left(\\frac{n(n+1)}{p}\\right)=\\left(\\frac{1+n^{-1}}{p}\\right)\\). Since \\(\\left\\{1+n^{-1} \\bmod p: 1 \\leqslant n \\leqslant p-1\\right\\}=\\{0,2,3, \\ldots, p-1 \\bmod p\\}\\), we find\n\\[\n\\sum_{n=1}^{p-1}\\left(\\frac{n}{p}\\right)\\left(\\frac{n+1}{p}\\right)=\\sum_{n=1}^{p-1}\\left(\\frac{1+n^{-1}}{p}\\right)=\\sum_{n=1}^{p-1}\\left(\\frac{n}{p}\\right)-1=-1,\n\\]\nbecause \\(\\sum_{n=1}^{p}\\left(\\frac{n}{p}\\right)=0\\).\nObserve that (1) becomes\n\\[\n\\sum_{n=1}^{p-1} f\\left(n^{2}, p\\right)=2|S|, \\quad S=\\left\\{r: 1 \\leqslant r \\leqslant \\frac{p-1}{2} \\text { and }\\left(\\frac{r}{p}\\right)=1\\right\\}\n\\]\n\nWe connect \\(S\\) with the sum from the claim by pairing quadratic residues and quadratic non-residues. To that end, define\n\\[\n\\begin{aligned}\nS^{\\prime} & =\\left\\{r: 1 \\leqslant r \\leqslant \\frac{p-1}{2} \\text { and }\\left(\\frac{r}{p}\\right)=-1\\right\\} \\\\\nT & =\\left\\{r: \\frac{p+1}{2} \\leqslant r \\leqslant p-1 \\text { and }\\left(\\frac{r}{p}\\right)=1\\right\\} \\\\\nT^{\\prime} & =\\left\\{r: \\frac{p+1}{2} \\leqslant r \\leqslant p-1 \\text { and }\\left(\\frac{r}{p}\\right)=-1\\right\\}\n\\end{aligned}\n\\]\n\nSince there are exactly \\((p-1) / 2\\) nonzero quadratic residues modulo \\(p,|S|+|T|=(p-1) / 2\\). Also we obviously have \\(|T|+\\left|T^{\\prime}\\right|=(p-1) / 2\\). Then \\(|S|=\\left|T^{\\prime}\\right|\\).\n\nFor the sake of brevity, define \\(t=|S|=\\left|T^{\\prime}\\right|\\). If \\(\\left(\\frac{n}{p}\\right)\\left(\\frac{n+1}{p}\\right)=-1\\), then exactly of one the numbers \\(\\left(\\frac{n}{p}\\right)\\) and \\(\\left(\\frac{n+1}{p}\\right)\\) is equal to 1 , so\n\\[\n\\left\\lvert\\,\\left\\{n: 1 \\leqslant n \\leqslant \\frac{p-3}{2} \\text { and }\\left(\\frac{n}{p}\\right)\\left(\\frac{n+1}{p}\\right)=-1\\right\\}|\\leqslant|S|+|S-1|=2 t\\right.\n\\]\n\nOn the other hand, if \\(\\left(\\frac{n}{p}\\right)\\left(\\frac{n+1}{p}\\right)=-1\\), then exactly one of \\(\\left(\\frac{n}{p}\\right)\\) and \\(\\left(\\frac{n+1}{p}\\right)\\) is equal to -1 , and\n\\[\n\\left\\lvert\\,\\left\\{n: \\frac{p+1}{2} \\leqslant n \\leqslant p-2 \\text { and }\\left(\\frac{n}{p}\\right)\\left(\\frac{n+1}{p}\\right)=-1\\right\\}\\left|\\leqslant\\left|T^{\\prime}\\right|+\\left|T^{\\prime}-1\\right|=2 t\\right.\\right.\n\\]\n\nThus, taking into account that the middle term \\(\\left(\\frac{(p-1) / 2}{p}\\right)\\left(\\frac{(p+1) / 2}{p}\\right)\\) may happen to be -1 ,\n\\[\n\\left.\\left\\lvert\\,\\left\\{n: 1 \\leqslant n \\leqslant p-2 \\text { and }\\left(\\frac{n}{p}\\right)\\left(\\frac{n+1}{p}\\right)=-1\\right\\}\\right. \\right\\rvert\\, \\leqslant 4 t+1\n\\]\n\nThis implies that\n\\[\n\\left.\\left\\lvert\\,\\left\\{n: 1 \\leqslant n \\leqslant p-2 \\text { and }\\left(\\frac{n}{p}\\right)\\left(\\frac{n+1}{p}\\right)=1\\right\\}\\right. \\right\\rvert\\, \\geqslant(p-2)-(4 t+1)=p-4 t-3\n\\]\nand so\n\\[\n-1=\\sum_{n=1}^{p-1}\\left(\\frac{n}{p}\\right)\\left(\\frac{n+1}{p}\\right) \\geqslant p-4 t-3-(4 t+1)=p-8 t-4\n\\]\nwhich implies \\(8 t \\geqslant p-3\\), and thus\n\\[\n\\sum_{n=1}^{p-1} f\\left(n^{2}, p\\right)=2 t \\geqslant \\frac{p-3}{4}\n\\]\n\nComment 5. It is possible to prove that\n\\[\n\\sum_{n=1}^{p-1} f\\left(n^{2}, p\\right) \\geqslant \\frac{p-1}{2}\n\\]\n\nThe case \\(p \\equiv 1(\\bmod 4)\\) was already mentioned, and it is the equality case. If \\(p \\equiv 3(\\bmod 4)\\), then, by a theorem of Dirichlet, we have\n\\[\n\\left.\\left\\lvert\\,\\left\\{r: 1 \\leqslant r \\leqslant \\frac{p-1}{2} \\text { and }\\left(\\frac{r}{p}\\right)=1\\right\\}\\right. \\right\\rvert\\,>\\frac{p-1}{4}\n\\]\nwhich implies the result.\nSee https://en.wikipedia.org/wiki/Quadratic_residue\\#Dirichlet.27s_formulas for the full statement of the theorem. It seems that no elementary proof of it is known; a proof using complex analysis is available, for instance, in Chapter 7 of the book Quadratic Residues and Non-Residues: Selected Topics, by Steve Wright, available in https://arxiv.org/abs/1408. 0235.\n\nCient\u00edfico e Tecnol\u00f3gico", "source_pdf": "imosl_2017.pdf", "notes": "fallback-regex"}
{"id": "IMOSL-2018-A1", "contest": "IMOSL", "year": "2018", "problem_number": "A1", "problem": "Let \\(\\mathbb{Q}_{>0}\\) denote the set of all positive rational numbers. Determine all functions \\(f: \\mathbb{Q}_{>0} \\rightarrow \\mathbb{Q}_{>0}\\) satisfying\n\\[\nf\\left(x^{2} f(y)^{2}\\right)=f(x)^{2} f(y)\n\\]\nfor all \\(x, y \\in \\mathbb{Q}_{>0}\\).\n(Switzerland)\nAnswer: \\(f(x)=1\\) for all \\(x \\in \\mathbb{Q}_{>0}\\).", "solution": ". Take any \\(a, b \\in \\mathbb{Q}_{>0}\\). By substituting \\(x=f(a), y=b\\) and \\(x=f(b), y=a\\) into (*) we get\n\\[\nf(f(a))^{2} f(b)=f\\left(f(a)^{2} f(b)^{2}\\right)=f(f(b))^{2} f(a),\n\\]\nwhich yields\n\\[\n\\frac{f(f(a))^{2}}{f(a)}=\\frac{f(f(b))^{2}}{f(b)} \\quad \\text { for all } a, b \\in \\mathbb{Q}_{>0} .\n\\]\n\nIn other words, this shows that there exists a constant \\(C \\in \\mathbb{Q}_{>0}\\) such that \\(f(f(a))^{2}=C f(a)\\), or\n\\[\n\\left(\\frac{f(f(a))}{C}\\right)^{2}=\\frac{f(a)}{C} \\quad \\text { for all } a \\in \\mathbb{Q}_{>0}\n\\]\n\nDenote by \\(f^{n}(x)=\\underbrace{f(f(\\ldots(f(x)) \\ldots)) \\text { the } n^{\\text {th }} \\text { iteration of } f \\text {. Equality (1) yields }}_{n}\\)\n\\[\n\\frac{f(a)}{C}=\\left(\\frac{f^{2}(a)}{C}\\right)^{2}=\\left(\\frac{f^{3}(a)}{C}\\right)^{4}=\\cdots=\\left(\\frac{f^{n+1}(a)}{C}\\right)^{2^{n}}\n\\]\nfor all positive integer \\(n\\). So, \\(f(a) / C\\) is the \\(2^{n}\\)-th power of a rational number for all positive integer \\(n\\). This is impossible unless \\(f(a) / C=1\\), since otherwise the exponent of some prime in the prime decomposition of \\(f(a) / C\\) is not divisible by sufficiently large powers of 2 . Therefore, \\(f(a)=C\\) for all \\(a \\in \\mathbb{Q}_{>0}\\).\n\nFinally, after substituting \\(f \\equiv C\\) into (*) we get \\(C=C^{3}\\), whence \\(C=1\\). So \\(f(x) \\equiv 1\\) is the unique function satisfying (*).\n\nComment 1. There are several variations of the solution above. For instance, one may start with finding \\(f(1)=1\\). To do this, let \\(d=f(1)\\). By substituting \\(x=y=1\\) and \\(x=d^{2}, y=1\\) into (*) we get \\(f\\left(d^{2}\\right)=d^{3}\\) and \\(f\\left(d^{6}\\right)=f\\left(d^{2}\\right)^{2} \\cdot d=d^{7}\\). By substituting now \\(x=1, y=d^{2}\\) we obtain \\(f\\left(d^{6}\\right)=d^{2} \\cdot d^{3}=d^{5}\\). Therefore, \\(d^{7}=f\\left(d^{6}\\right)=d^{5}\\), whence \\(d=1\\).\n\nAfter that, the rest of the solution simplifies a bit, since we already know that \\(C=\\frac{f(f(1))^{2}}{f(1)}=1\\). Hence equation (1) becomes merely \\(f(f(a))^{2}=f(a)\\), which yields \\(f(a)=1\\) in a similar manner.\n\nComment 2. There exist nonconstant functions \\(f: \\mathbb{R}^{+} \\rightarrow \\mathbb{R}^{+}\\)satisfying (*) for all real \\(x, y>0-\\) e.g., \\(f(x)=\\sqrt{x}\\).", "source_pdf": "imosl_2018.pdf", "notes": "fallback-regex"}
{"id": "IMOSL-2018-A3", "contest": "IMOSL", "year": "2018", "problem_number": "A3", "problem": "Given any set \\(S\\) of positive integers, show that at least one of the following two assertions holds:\n(1) There exist distinct finite subsets \\(F\\) and \\(G\\) of \\(S\\) such that \\(\\sum_{x \\in F} 1 / x=\\sum_{x \\in G} 1 / x\\);\n(2) There exists a positive rational number \\(r<1\\) such that \\(\\sum_{x \\in F} 1 / x \\neq r\\) for all finite subsets \\(F\\) of \\(S\\).\n(Luxembourg)", "solution": "1. Argue indirectly. Agree, as usual, that the empty sum is 0 to consider rationals in \\([0,1)\\); adjoining 0 causes no harm, since \\(\\sum_{x \\in F} 1 / x=0\\) for no nonempty finite subset \\(F\\) of \\(S\\). For every rational \\(r\\) in \\([0,1)\\), let \\(F_{r}\\) be the unique finite subset of \\(S\\) such that \\(\\sum_{x \\in F_{r}} 1 / x=r\\). The argument hinges on the lemma below.\nLemma. If \\(x\\) is a member of \\(S\\) and \\(q\\) and \\(r\\) are rationals in \\([0,1)\\) such that \\(q-r=1 / x\\), then \\(x\\) is a member of \\(F_{q}\\) if and only if it is not one of \\(F_{r}\\).\nProof. If \\(x\\) is a member of \\(F_{q}\\), then\n\\[\n\\sum_{y \\in F_{q} \\backslash\\{x\\}} \\frac{1}{y}=\\sum_{y \\in F_{q}} \\frac{1}{y}-\\frac{1}{x}=q-\\frac{1}{x}=r=\\sum_{y \\in F_{r}} \\frac{1}{y}\n\\]\nso \\(F_{r}=F_{q} \\backslash\\{x\\}\\), and \\(x\\) is not a member of \\(F_{r}\\). Conversely, if \\(x\\) is not a member of \\(F_{r}\\), then\n\\[\n\\sum_{y \\in F_{r} \\cup\\{x\\}} \\frac{1}{y}=\\sum_{y \\in F_{r}} \\frac{1}{y}+\\frac{1}{x}=r+\\frac{1}{x}=q=\\sum_{y \\in F_{q}} \\frac{1}{y}\n\\]\nso \\(F_{q}=F_{r} \\cup\\{x\\}\\), and \\(x\\) is a member of \\(F_{q}\\).\nConsider now an element \\(x\\) of \\(S\\) and a positive rational \\(r<1\\). Let \\(n=\\lfloor r x\\rfloor\\) and consider the sets \\(F_{r-k / x}, k=0, \\ldots, n\\). Since \\(0 \\leqslant r-n / x<1 / x\\), the set \\(F_{r-n / x}\\) does not contain \\(x\\), and a repeated application of the lemma shows that the \\(F_{r-(n-2 k) / x}\\) do not contain \\(x\\), whereas the \\(F_{r-(n-2 k-1) / x}\\) do. Consequently, \\(x\\) is a member of \\(F_{r}\\) if and only if \\(n\\) is odd.\n\nFinally, consider \\(F_{2 / 3}\\). By the preceding, \\(\\lfloor 2 x / 3\\rfloor\\) is odd for each \\(x\\) in \\(F_{2 / 3}\\), so \\(2 x / 3\\) is not integral. Since \\(F_{2 / 3}\\) is finite, there exists a positive rational \\(\\varepsilon\\) such that \\(\\lfloor(2 / 3-\\varepsilon) x\\rfloor=\\lfloor 2 x / 3\\rfloor\\) for all \\(x\\) in \\(F_{2 / 3}\\). This implies that \\(F_{2 / 3}\\) is a subset of \\(F_{2 / 3-\\varepsilon}\\) which is impossible.\n\nComment. The solution above can be adapted to show that the problem statement still holds, if the condition \\(r<1\\) in (2) is replaced with \\(r<\\delta\\), for an arbitrary positive \\(\\delta\\). This yields that, if \\(S\\) does not satisfy (1), then there exist infinitely many positive rational numbers \\(r<1\\) such that \\(\\sum_{x \\in F} 1 / x \\neq r\\) for all finite subsets \\(F\\) of \\(S\\).\n\nSolution 2. A finite \\(S\\) clearly satisfies (2), so let \\(S\\) be infinite. If \\(S\\) fails both conditions, so does \\(S \\backslash\\{1\\}\\). We may and will therefore assume that \\(S\\) consists of integers greater than 1 . Label the elements of \\(S\\) increasingly \\(x_{1}<x_{2}<\\cdots\\), where \\(x_{1} \\geqslant 2\\).\n\nWe first show that \\(S\\) satisfies (2) if \\(x_{n+1} \\geqslant 2 x_{n}\\) for all \\(n\\). In this case, \\(x_{n} \\geqslant 2^{n-1} x_{1}\\) for all \\(n\\), so\n\\[\ns=\\sum_{n \\geqslant 1} \\frac{1}{x_{n}} \\leqslant \\sum_{n \\geqslant 1} \\frac{1}{2^{n-1} x_{1}}=\\frac{2}{x_{1}} .\n\\]\n\nIf \\(x_{1} \\geqslant 3\\), or \\(x_{1}=2\\) and \\(x_{n+1}>2 x_{n}\\) for some \\(n\\), then \\(\\sum_{x \\in F} 1 / x<s<1\\) for every finite subset \\(F\\) of \\(S\\), so \\(S\\) satisfies (2); and if \\(x_{1}=2\\) and \\(x_{n+1}=2 x_{n}\\) for all \\(n\\), that is, \\(x_{n}=2^{n}\\) for all \\(n\\), then every finite subset \\(F\\) of \\(S\\) consists of powers of 2 , so \\(\\sum_{x \\in F} 1 / x \\neq 1 / 3\\) and again \\(S\\) satisfies (2).\n\nFinally, we deal with the case where \\(x_{n+1}<2 x_{n}\\) for some \\(n\\). Consider the positive rational \\(r=1 / x_{n}-1 / x_{n+1}<1 / x_{n+1}\\). If \\(r=\\sum_{x \\in F} 1 / x\\) for no finite subset \\(F\\) of \\(S\\), then \\(S\\) satisfies (2).\n\nWe now assume that \\(r=\\sum_{x \\in F_{0}} 1 / x\\) for some finite subset \\(F_{0}\\) of \\(S\\), and show that \\(S\\) satisfies (1). Since \\(\\sum_{x \\in F_{0}} 1 / x=r<1 / x_{n+1}\\), it follows that \\(x_{n+1}\\) is not a member of \\(F_{0}\\), so\n\\[\n\\sum_{x \\in F_{0} \\cup\\left\\{x_{n+1}\\right\\}} \\frac{1}{x}=\\sum_{x \\in F_{0}} \\frac{1}{x}+\\frac{1}{x_{n+1}}=r+\\frac{1}{x_{n+1}}=\\frac{1}{x_{n}} .\n\\]\n\nConsequently, \\(F=F_{0} \\cup\\left\\{x_{n+1}\\right\\}\\) and \\(G=\\left\\{x_{n}\\right\\}\\) are distinct finite subsets of \\(S\\) such that \\(\\sum_{x \\in F} 1 / x=\\sum_{x \\in G} 1 / x\\), and \\(S\\) satisfies (1).", "source_pdf": "imosl_2018.pdf", "notes": "fallback-regex"}
{"id": "IMOSL-2018-A4", "contest": "IMOSL", "year": "2018", "problem_number": "A4", "problem": "Let \\(a_{0}, a_{1}, a_{2}, \\ldots\\) be a sequence of real numbers such that \\(a_{0}=0, a_{1}=1\\), and for every \\(n \\geqslant 2\\) there exists \\(1 \\leqslant k \\leqslant n\\) satisfying\n\\[\na_{n}=\\frac{a_{n-1}+\\cdots+a_{n-k}}{k} .\n\\]\n\nFind the maximal possible value of \\(a_{2018}-a_{2017}\\).\n(Belgium)", "solution": "Answer: The maximal value is \\(\\frac{2016}{2017^{2}}\\).\n\n1. The claimed maximal value is achieved at\n\\[\n\\begin{gathered}\na_{1}=a_{2}=\\cdots=a_{2016}=1, \\quad a_{2017}=\\frac{a_{2016}+\\cdots+a_{0}}{2017}=1-\\frac{1}{2017}, \\\\\na_{2018}=\\frac{a_{2017}+\\cdots+a_{1}}{2017}=1-\\frac{1}{2017^{2}} .\n\\end{gathered}\n\\]\n\nNow we need to show that this value is optimal. For brevity, we use the notation\n\\[\nS(n, k)=a_{n-1}+a_{n-2}+\\cdots+a_{n-k} \\quad \\text { for nonnegative integers } k \\leqslant n .\n\\]\n\nIn particular, \\(S(n, 0)=0\\) and \\(S(n, 1)=a_{n-1}\\). In these terms, for every integer \\(n \\geqslant 2\\) there exists a positive integer \\(k \\leqslant n\\) such that \\(a_{n}=S(n, k) / k\\).\n\nFor every integer \\(n \\geqslant 1\\) we define\n\\[\nM_{n}=\\max _{1 \\leqslant k \\leqslant n} \\frac{S(n, k)}{k}, \\quad m_{n}=\\min _{1 \\leqslant k \\leqslant n} \\frac{S(n, k)}{k}, \\quad \\text { and } \\quad \\Delta_{n}=M_{n}-m_{n} \\geqslant 0 .\n\\]\n\nBy definition, \\(a_{n} \\in\\left[m_{n}, M_{n}\\right]\\) for all \\(n \\geqslant 2\\); on the other hand, \\(a_{n-1}=S(n, 1) / 1 \\in\\left[m_{n}, M_{n}\\right]\\). Therefore,\n\\[\na_{2018}-a_{2017} \\leqslant M_{2018}-m_{2018}=\\Delta_{2018}\n\\]\nand we are interested in an upper bound for \\(\\Delta_{2018}\\).\nAlso by definition, for any \\(0<k \\leqslant n\\) we have \\(k m_{n} \\leqslant S(n, k) \\leqslant k M_{n}\\); notice that these inequalities are also valid for \\(k=0\\).\nClaim 1. For every \\(n>2\\), we have \\(\\Delta_{n} \\leqslant \\frac{n-1}{n} \\Delta_{n-1}\\).\nProof. Choose positive integers \\(k, \\ell \\leqslant n\\) such that \\(M_{n}=S(n, k) / k\\) and \\(m_{n}=S(n, \\ell) / \\ell\\). We have \\(S(n, k)=a_{n-1}+S(n-1, k-1)\\), so\n\\[\nk\\left(M_{n}-a_{n-1}\\right)=S(n, k)-k a_{n-1}=S(n-1, k-1)-(k-1) a_{n-1} \\leqslant(k-1)\\left(M_{n-1}-a_{n-1}\\right),\n\\]\nsince \\(S(n-1, k-1) \\leqslant(k-1) M_{n-1}\\). Similarly, we get\n\\[\n\\ell\\left(a_{n-1}-m_{n}\\right)=(\\ell-1) a_{n-1}-S(n-1, \\ell-1) \\leqslant(\\ell-1)\\left(a_{n-1}-m_{n-1}\\right) .\n\\]\n\nSince \\(m_{n-1} \\leqslant a_{n-1} \\leqslant M_{n-1}\\) and \\(k, \\ell \\leqslant n\\), the obtained inequalities yield\n\\[\n\\begin{aligned}\nM_{n}-a_{n-1} & \\leqslant \\frac{k-1}{k}\\left(M_{n-1}-a_{n-1}\\right) \\leqslant \\frac{n-1}{n}\\left(M_{n-1}-a_{n-1}\\right) \\quad \\text { and } \\\\\na_{n-1}-m_{n} & \\leqslant \\frac{\\ell-1}{\\ell}\\left(a_{n-1}-m_{n-1}\\right) \\leqslant \\frac{n-1}{n}\\left(a_{n-1}-m_{n-1}\\right)\n\\end{aligned}\n\\]\n\nTherefore,\n\\[\n\\Delta_{n}=\\left(M_{n}-a_{n-1}\\right)+\\left(a_{n-1}-m_{n}\\right) \\leqslant \\frac{n-1}{n}\\left(\\left(M_{n-1}-a_{n-1}\\right)+\\left(a_{n-1}-m_{n-1}\\right)\\right)=\\frac{n-1}{n} \\Delta_{n-1}\n\\]\n\nBack to the problem, if \\(a_{n}=1\\) for all \\(n \\leqslant 2017\\), then \\(a_{2018} \\leqslant 1\\) and hence \\(a_{2018}-a_{2017} \\leqslant 0\\). Otherwise, let \\(2 \\leqslant q \\leqslant 2017\\) be the minimal index with \\(a_{q}<1\\). We have \\(S(q, i)=i\\) for all \\(i=1,2, \\ldots, q-1\\), while \\(S(q, q)=q-1\\). Therefore, \\(a_{q}<1\\) yields \\(a_{q}=S(q, q) / q=1-\\frac{1}{q}\\).\n\nNow we have \\(S(q+1, i)=i-\\frac{1}{q}\\) for \\(i=1,2, \\ldots, q\\), and \\(S(q+1, q+1)=q-\\frac{1}{q}\\). This gives us\n\\[\nm_{q+1}=\\frac{S(q+1,1)}{1}=\\frac{S(q+1, q+1)}{q+1}=\\frac{q-1}{q} \\quad \\text { and } \\quad M_{q+1}=\\frac{S(q+1, q)}{q}=\\frac{q^{2}-1}{q^{2}},\n\\]\nso \\(\\Delta_{q+1}=M_{q+1}-m_{q+1}=(q-1) / q^{2}\\). Denoting \\(N=2017 \\geqslant q\\) and using Claim 1 for \\(n=q+2, q+3, \\ldots, N+1\\) we finally obtain\n\\[\n\\Delta_{N+1} \\leqslant \\frac{q-1}{q^{2}} \\cdot \\frac{q+1}{q+2} \\cdot \\frac{q+2}{q+3} \\cdots \\frac{N}{N+1}=\\frac{1}{N+1}\\left(1-\\frac{1}{q^{2}}\\right) \\leqslant \\frac{1}{N+1}\\left(1-\\frac{1}{N^{2}}\\right)=\\frac{N-1}{N^{2}}\n\\]\nas required.\nComment 1. One may check that the maximal value of \\(a_{2018}-a_{2017}\\) is attained at the unique sequence, which is presented in the solution above.\n\nComment 2. An easier question would be to determine the maximal value of \\(\\left|a_{2018}-a_{2017}\\right|\\). In this version, the answer \\(\\frac{1}{2018}\\) is achieved at\n\\[\na_{1}=a_{2}=\\cdots=a_{2017}=1, \\quad a_{2018}=\\frac{a_{2017}+\\cdots+a_{0}}{2018}=1-\\frac{1}{2018} .\n\\]\n\nTo prove that this value is optimal, it suffices to notice that \\(\\Delta_{2}=\\frac{1}{2}\\) and to apply Claim 1 obtaining\n\\[\n\\left|a_{2018}-a_{2017}\\right| \\leqslant \\Delta_{2018} \\leqslant \\frac{1}{2} \\cdot \\frac{2}{3} \\cdots \\frac{2017}{2018}=\\frac{1}{2018}\n\\]\n\nSolution 2. We present a different proof of the estimate \\(a_{2018}-a_{2017} \\leqslant \\frac{2016}{2017^{2}}\\). We keep the same notations of \\(S(n, k), m_{n}\\) and \\(M_{n}\\) from the previous solution.\n\nNotice that \\(S(n, n)=S(n, n-1)\\), as \\(a_{0}=0\\). Also notice that for \\(0 \\leqslant k \\leqslant \\ell \\leqslant n\\) we have \\(S(n, \\ell)=S(n, k)+S(n-k, \\ell-k)\\).\nClaim 2. For every positive integer \\(n\\), we have \\(m_{n} \\leqslant m_{n+1}\\) and \\(M_{n+1} \\leqslant M_{n}\\), so the segment \\(\\left[m_{n+1}, M_{n+1}\\right]\\) is contained in [ \\(m_{n}, M_{n}\\) ].\nProof. Choose a positive integer \\(k \\leqslant n+1\\) such that \\(m_{n+1}=S(n+1, k) / k\\). Then we have\n\\[\nk m_{n+1}=S(n+1, k)=a_{n}+S(n, k-1) \\geqslant m_{n}+(k-1) m_{n}=k m_{n}\n\\]\nwhich establishes the first inequality in the Claim. The proof of the second inequality is similar.\n\nClaim 3. For every positive integers \\(k \\geqslant n\\), we have \\(m_{n} \\leqslant a_{k} \\leqslant M_{n}\\).\nProof. By Claim 2, we have \\(\\left[m_{k}, M_{k}\\right] \\subseteq\\left[m_{k-1}, M_{k-1}\\right] \\subseteq \\ldots \\subseteq\\left[m_{n}, M_{n}\\right]\\). Since \\(a_{k} \\in\\left[m_{k}, M_{k}\\right]\\), the claim follows.\n\nClaim 4. For every integer \\(n \\geqslant 2\\), we have \\(M_{n}=S(n, n-1) /(n-1)\\) and \\(m_{n}=S(n, n) / n\\).\nProof. We use induction on \\(n\\). The base case \\(n=2\\) is routine. To perform the induction step, we need to prove the inequalities\n\\[\n\\frac{S(n, n)}{n} \\leqslant \\frac{S(n, k)}{k} \\quad \\text { and } \\quad \\frac{S(n, k)}{k} \\leqslant \\frac{S(n, n-1)}{n-1}\n\\]\nfor every positive integer \\(k \\leqslant n\\). Clearly, these inequalities hold for \\(k=n\\) and \\(k=n-1\\), as \\(S(n, n)=S(n, n-1)>0\\). In the sequel, we assume that \\(k<n-1\\).\n\nNow the first inequality in (1) rewrites as \\(n S(n, k) \\geqslant k S(n, n)=k(S(n, k)+S(n-k, n-k))\\), or, cancelling the terms occurring on both parts, as\n\\[\n(n-k) S(n, k) \\geqslant k S(n-k, n-k) \\Longleftrightarrow S(n, k) \\geqslant k \\cdot \\frac{S(n-k, n-k)}{n-k} .\n\\]\n\nBy the induction hypothesis, we have \\(S(n-k, n-k) /(n-k)=m_{n-k}\\). By Claim 3, we get \\(a_{n-i} \\geqslant m_{n-k}\\) for all \\(i=1,2, \\ldots, k\\). Summing these \\(k\\) inequalities we obtain\n\\[\nS(n, k) \\geqslant k m_{n-k}=k \\cdot \\frac{S(n-k, n-k)}{n-k},\n\\]\nas required.\nThe second inequality in (1) is proved similarly. Indeed, this inequality is equivalent to\n\\[\n\\begin{aligned}\n(n-1) S(n, k) \\leqslant k S(n, n-1) & \\Longleftrightarrow(n-k-1) S(n, k) \\leqslant k S(n-k, n-k-1) \\\\\n& \\Longleftrightarrow S(n, k) \\leqslant k \\cdot \\frac{S(n-k, n-k-1)}{n-k-1}=k M_{n-k}\n\\end{aligned}\n\\]\nthe last inequality follows again from Claim 3, as each term in \\(S(n, k)\\) is at most \\(M_{n-k}\\).\nNow we can prove the required estimate for \\(a_{2018}-a_{2017}\\). Set \\(N=2017\\). By Claim 4,\n\\[\n\\begin{aligned}\na_{N+1}-a_{N} \\leqslant M_{N+1}-a_{N}=\\frac{S(N+1, N)}{N}-a_{N} & =\\frac{a_{N}+S(N, N-1)}{N}-a_{N} \\\\\n& =\\frac{S(N, N-1)}{N}-\\frac{N-1}{N} \\cdot a_{N}\n\\end{aligned}\n\\]\n\nOn the other hand, the same Claim yields\n\\[\na_{N} \\geqslant m_{N}=\\frac{S(N, N)}{N}=\\frac{S(N, N-1)}{N} .\n\\]\n\nNoticing that each term in \\(S(N, N-1)\\) is at most 1 , so \\(S(N, N-1) \\leqslant N-1\\), we finally obtain\n\\[\na_{N+1}-a_{N} \\leqslant \\frac{S(N, N-1)}{N}-\\frac{N-1}{N} \\cdot \\frac{S(N, N-1)}{N}=\\frac{S(N, N-1)}{N^{2}} \\leqslant \\frac{N-1}{N^{2}} .\n\\]\n\nComment 1. Claim 1 in Solution 1 can be deduced from Claims 2 and 4 in Solution 2.\nBy Claim 4 we have \\(M_{n}=\\frac{S(n, n-1)}{n-1}\\) and \\(m_{n}=\\frac{S(n, n)}{n}=\\frac{S(n, n-1)}{n}\\). It follows that \\(\\Delta_{n}=M_{n}-m_{n}= \\frac{S(n, n-1)}{(n-1) n}\\) and so \\(M_{n}=n \\Delta_{n}\\) and \\(m_{n}=(n-1) \\Delta_{n}\\)\n\nSimilarly, \\(M_{n-1}=(n-1) \\Delta_{n-1}\\) and \\(m_{n-1}=(n-2) \\Delta_{n-1}\\). Then the inequalities \\(m_{n-1} \\leqslant m_{n}\\) and \\(M_{n} \\leqslant M_{n-1}\\) from Claim 2 write as \\((n-2) \\Delta_{n-1} \\leqslant(n-1) \\Delta_{n}\\) and \\(n \\Delta_{n} \\leqslant(n-1) \\Delta_{n-1}\\). Hence we have the double inequality\n\\[\n\\frac{n-2}{n-1} \\Delta_{n-1} \\leqslant \\Delta_{n} \\leqslant \\frac{n-1}{n} \\Delta_{n-1}\n\\]\n\nComment 2. Both solutions above discuss the properties of an arbitrary sequence satisfying the problem conditions. Instead, one may investigate only an optimal sequence which maximises the value of \\(a_{2018}-a_{2017}\\). Here we present an observation which allows to simplify such investigation - for instance, the proofs of Claim 1 in Solution 1 and Claim 4 in Solution 2.\n\nThe sequence ( \\(a_{n}\\) ) is uniquely determined by choosing, for every \\(n \\geqslant 2\\), a positive integer \\(k(n) \\leqslant n\\) such that \\(a_{n}=S(n, k(n)) / k(n)\\). Take an arbitrary \\(2 \\leqslant n_{0} \\leqslant 2018\\), and assume that all such integers \\(k(n)\\), for \\(n \\neq n_{0}\\), are fixed. Then, for every \\(n\\), the value of \\(a_{n}\\) is a linear function in \\(a_{n_{0}}\\) (whose possible values constitute some discrete subset of \\(\\left[m_{n_{0}}, M_{n_{0}}\\right]\\) containing both endpoints). Hence, \\(a_{2018}-a_{2017}\\) is also a linear function in \\(a_{n_{0}}\\), so it attains its maximal value at one of the endpoints of the segment \\(\\left[m_{n_{0}}, M_{n_{0}}\\right]\\).\n\nThis shows that, while dealing with an optimal sequence, we may assume \\(a_{n} \\in\\left\\{m_{n}, M_{n}\\right\\}\\) for all \\(2 \\leqslant n \\leqslant 2018\\). Now one can easily see that, if \\(a_{n}=m_{n}\\), then \\(m_{n+1}=m_{n}\\) and \\(M_{n+1} \\leqslant \\frac{m_{n}+n M_{n}}{n+1}\\); similar estimates hold in the case \\(a_{n}=M_{n}\\). This already establishes Claim 1, and simplifies the inductive proof of Claim 4, both applied to an optimal sequence.", "source_pdf": "imosl_2018.pdf", "notes": "fallback-regex"}
{"id": "IMOSL-2018-A5", "contest": "IMOSL", "year": "2018", "problem_number": "A5", "problem": "Determine all functions \\(f:(0, \\infty) \\rightarrow \\mathbb{R}\\) satisfying\n\\[\n\\left(x+\\frac{1}{x}\\right) f(y)=f(x y)+f\\left(\\frac{y}{x}\\right)\n\\]\nfor all \\(x, y>0\\).\n(South Korea)", "solution": "Answer: \\(f(x)=C_{1} x+\\frac{C_{2}}{x}\\) with arbitrary constants \\(C_{1}\\) and \\(C_{2}\\).\n\n1. Fix a real number \\(a>1\\), and take a new variable \\(t\\). For the values \\(f(t), f\\left(t^{2}\\right)\\), \\(f(a t)\\) and \\(f\\left(a^{2} t^{2}\\right)\\), the relation (1) provides a system of linear equations:\n\\[\n\\begin{array}{ll}\nx=y=t: & \\left(t+\\frac{1}{t}\\right) f(t)=f\\left(t^{2}\\right)+f(1) \\\\\nx=\\frac{t}{a}, y=a t: & \\left(\\frac{t}{a}+\\frac{a}{t}\\right) f(a t)=f\\left(t^{2}\\right)+f\\left(a^{2}\\right) \\\\\nx=a^{2} t, y=t: & \\left(a^{2} t+\\frac{1}{a^{2} t}\\right) f(t)=f\\left(a^{2} t^{2}\\right)+f\\left(\\frac{1}{a^{2}}\\right) \\\\\nx=y=a t: & \\left(a t+\\frac{1}{a t}\\right) f(a t)=f\\left(a^{2} t^{2}\\right)+f(1)\n\\end{array}\n\\]\n\nIn order to eliminate \\(f\\left(t^{2}\\right)\\), take the difference of (2a) and (2b); from (2c) and (2d) eliminate \\(f\\left(a^{2} t^{2}\\right)\\); then by taking a linear combination, eliminate \\(f(a t)\\) as well:\n\\[\n\\begin{aligned}\n\\left(t+\\frac{1}{t}\\right) f(t)-\\left(\\frac{t}{a}+\\frac{a}{t}\\right) f(a t) & =f(1)-f\\left(a^{2}\\right) \\quad \\text { and } \\\\\n\\left(a^{2} t+\\frac{1}{a^{2} t}\\right) & f(t)-\\left(a t+\\frac{1}{a t}\\right) f(a t)=f\\left(1 / a^{2}\\right)-f(1), \\text { so } \\\\\n\\left(\\left(a t+\\frac{1}{a t}\\right)\\left(t+\\frac{1}{t}\\right)\\right. & \\left.-\\left(\\frac{t}{a}+\\frac{a}{t}\\right)\\left(a^{2} t+\\frac{1}{a^{2} t}\\right)\\right) f(t) \\\\\n= & \\left(a t+\\frac{1}{a t}\\right)\\left(f(1)-f\\left(a^{2}\\right)\\right)-\\left(\\frac{t}{a}+\\frac{a}{t}\\right)\\left(f\\left(1 / a^{2}\\right)-f(1)\\right) .\n\\end{aligned}\n\\]\n\nNotice that on the left-hand side, the coefficient of \\(f(t)\\) is nonzero and does not depend on \\(t\\) :\n\\[\n\\left(a t+\\frac{1}{a t}\\right)\\left(t+\\frac{1}{t}\\right)-\\left(\\frac{t}{a}+\\frac{a}{t}\\right)\\left(a^{2} t+\\frac{1}{a^{2} t}\\right)=a+\\frac{1}{a}-\\left(a^{3}+\\frac{1}{a^{3}}\\right)<0\n\\]\n\nAfter dividing by this fixed number, we get\n\\[\nf(t)=C_{1} t+\\frac{C_{2}}{t}\n\\]\nwhere the numbers \\(C_{1}\\) and \\(C_{2}\\) are expressed in terms of \\(a, f(1), f\\left(a^{2}\\right)\\) and \\(f\\left(1 / a^{2}\\right)\\), and they do not depend on \\(t\\).\n\nThe functions of the form (3) satisfy the equation:\n\\[\n\\left(x+\\frac{1}{x}\\right) f(y)=\\left(x+\\frac{1}{x}\\right)\\left(C_{1} y+\\frac{C_{2}}{y}\\right)=\\left(C_{1} x y+\\frac{C_{2}}{x y}\\right)+\\left(C_{1} \\frac{y}{x}+C_{2} \\frac{x}{y}\\right)=f(x y)+f\\left(\\frac{y}{x}\\right) .\n\\]\n\nSolution 2. We start with an observation. If we substitute \\(x=a \\neq 1\\) and \\(y=a^{n}\\) in (1), we obtain\n\\[\nf\\left(a^{n+1}\\right)-\\left(a+\\frac{1}{a}\\right) f\\left(a^{n}\\right)+f\\left(a^{n-1}\\right)=0 .\n\\]\n\nFor the sequence \\(z_{n}=a^{n}\\), this is a homogeneous linear recurrence of the second order, and its characteristic polynomial is \\(t^{2}-\\left(a+\\frac{1}{a}\\right) t+1=(t-a)\\left(t-\\frac{1}{a}\\right)\\) with two distinct nonzero roots, namely \\(a\\) and \\(1 / a\\). As is well-known, the general solution is \\(z_{n}=C_{1} a^{n}+C_{2}(1 / a)^{n}\\) where the index \\(n\\) can be as well positive as negative. Of course, the numbers \\(C_{1}\\) and \\(C_{2}\\) may depend of the choice of \\(a\\), so in fact we have two functions, \\(C_{1}\\) and \\(C_{2}\\), such that\n\\[\nf\\left(a^{n}\\right)=C_{1}(a) \\cdot a^{n}+\\frac{C_{2}(a)}{a^{n}} \\quad \\text { for every } a \\neq 1 \\text { and every integer } n .\n\\]\n\nThe relation (4) can be easily extended to rational values of \\(n\\), so we may conjecture that \\(C_{1}\\) and \\(C_{2}\\) are constants, and whence \\(f(t)=C_{1} t+\\frac{C_{2}}{t}\\). As it was seen in the previous solution, such functions indeed satisfy (1).\n\nThe equation (1) is linear in \\(f\\); so if some functions \\(f_{1}\\) and \\(f_{2}\\) satisfy (1) and \\(c_{1}, c_{2}\\) are real numbers, then \\(c_{1} f_{1}(x)+c_{2} f_{2}(x)\\) is also a solution of (1). In order to make our formulas simpler, define\n\\[\nf_{0}(x)=f(x)-f(1) \\cdot x .\n\\]\n\nThis function is another one satisfying (1) and the extra constraint \\(f_{0}(1)=0\\). Repeating the same argument on linear recurrences, we can write \\(f_{0}(a)=K(a) a^{n}+\\frac{L(a)}{a^{n}}\\) with some functions \\(K\\) and \\(L\\). By substituting \\(n=0\\), we can see that \\(K(a)+L(a)=f_{0}(1)=0\\) for every \\(a\\). Hence,\n\\[\nf_{0}\\left(a^{n}\\right)=K(a)\\left(a^{n}-\\frac{1}{a^{n}}\\right) .\n\\]\n\nNow take two numbers \\(a>b>1\\) arbitrarily and substitute \\(x=(a / b)^{n}\\) and \\(y=(a b)^{n}\\) in (1):\n\\[\n\\begin{aligned}\n\\left(\\frac{a^{n}}{b^{n}}+\\frac{b^{n}}{a^{n}}\\right) f_{0}\\left((a b)^{n}\\right) & =f_{0}\\left(a^{2 n}\\right)+f_{0}\\left(b^{2 n}\\right), \\quad \\text { so } \\\\\n\\left(\\frac{a^{n}}{b^{n}}+\\frac{b^{n}}{a^{n}}\\right) K(a b)\\left((a b)^{n}-\\frac{1}{(a b)^{n}}\\right) & =K(a)\\left(a^{2 n}-\\frac{1}{a^{2 n}}\\right)+K(b)\\left(b^{2 n}-\\frac{1}{b^{2 n}}\\right), \\quad \\text { or equivalently } \\\\\nK(a b)\\left(a^{2 n}-\\frac{1}{a^{2 n}}+b^{2 n}-\\frac{1}{b^{2 n}}\\right) & =K(a)\\left(a^{2 n}-\\frac{1}{a^{2 n}}\\right)+K(b)\\left(b^{2 n}-\\frac{1}{b^{2 n}}\\right) .\n\\end{aligned}\n\\]\n\nBy dividing (5) by \\(a^{2 n}\\) and then taking limit with \\(n \\rightarrow+\\infty\\) we get \\(K(a b)=K(a)\\). Then (5) reduces to \\(K(a)=K(b)\\). Hence, \\(K(a)=K(b)\\) for all \\(a>b>1\\).\n\nFix \\(a>1\\). For every \\(x>0\\) there is some \\(b\\) and an integer \\(n\\) such that \\(1<b<a\\) and \\(x=b^{n}\\). Then\n\\[\nf_{0}(x)=f_{0}\\left(b^{n}\\right)=K(b)\\left(b^{n}-\\frac{1}{b^{n}}\\right)=K(a)\\left(x-\\frac{1}{x}\\right) .\n\\]\n\nHence, we have \\(f(x)=f_{0}(x)+f(1) x=C_{1} x+\\frac{C_{2}}{x}\\) with \\(C_{1}=K(a)+f(1)\\) and \\(C_{2}=-K(a)\\).\n\nComment. After establishing (5), there are several variants of finishing the solution. For example, instead of taking a limit, we can obtain a system of linear equations for \\(K(a), K(b)\\) and \\(K(a b)\\) by substituting two positive integers \\(n\\) in (5), say \\(n=1\\) and \\(n=2\\). This approach leads to a similar ending as in the first solution.\n\nOptionally, we define another function \\(f_{1}(x)=f_{0}(x)-C\\left(x-\\frac{1}{x}\\right)\\) and prescribe \\(K(c)=0\\) for another fixed \\(c\\). Then we can choose \\(a b=c\\) and decrease the number of terms in (5).", "source_pdf": "imosl_2018.pdf", "notes": "fallback-regex"}
{"id": "IMOSL-2018-A6", "contest": "IMOSL", "year": "2018", "problem_number": "A6", "problem": "Let \\(m, n \\geqslant 2\\) be integers. Let \\(f\\left(x_{1}, \\ldots, x_{n}\\right)\\) be a polynomial with real coefficients such that\n\\[\nf\\left(x_{1}, \\ldots, x_{n}\\right)=\\left\\lfloor\\frac{x_{1}+\\ldots+x_{n}}{m}\\right\\rfloor \\quad \\text { for every } x_{1}, \\ldots, x_{n} \\in\\{0,1, \\ldots, m-1\\}\n\\]\n\nProve that the total degree of \\(f\\) is at least \\(n\\).\n(Brazil)", "solution": ". We transform the problem to a single variable question by the following\nLemma. Let \\(a_{1}, \\ldots, a_{n}\\) be nonnegative integers and let \\(G(x)\\) be a nonzero polynomial with \\(\\operatorname{deg} G \\leqslant a_{1}+\\ldots+a_{n}\\). Suppose that some polynomial \\(F\\left(x_{1}, \\ldots, x_{n}\\right)\\) satisfies\n\\[\nF\\left(x_{1}, \\ldots, x_{n}\\right)=G\\left(x_{1}+\\ldots+x_{n}\\right) \\quad \\text { for }\\left(x_{1}, \\ldots, x_{n}\\right) \\in\\left\\{0,1, \\ldots, a_{1}\\right\\} \\times \\ldots \\times\\left\\{0,1, \\ldots, a_{n}\\right\\} .\n\\]\n\nThen \\(F\\) cannot be the zero polynomial, and \\(\\operatorname{deg} F \\geqslant \\operatorname{deg} G\\).\nFor proving the lemma, we will use forward differences of polynomials. If \\(p(x)\\) is a polynomial with a single variable, then define \\((\\Delta p)(x)=p(x+1)-p(x)\\). It is well-known that if \\(p\\) is a nonconstant polynomial then \\(\\operatorname{deg} \\Delta p=\\operatorname{deg} p-1\\).\n\nIf \\(p\\left(x_{1}, \\ldots, x_{n}\\right)\\) is a polynomial with \\(n\\) variables and \\(1 \\leqslant k \\leqslant n\\) then let\n\\[\n\\left(\\Delta_{k} p\\right)\\left(x_{1}, \\ldots, x_{n}\\right)=p\\left(x_{1}, \\ldots, x_{k-1}, x_{k}+1, x_{k+1}, \\ldots, x_{n}\\right)-p\\left(x_{1}, \\ldots, x_{n}\\right) .\n\\]\n\nIt is also well-known that either \\(\\Delta_{k} p\\) is the zero polynomial or \\(\\operatorname{deg}\\left(\\Delta_{k} p\\right) \\leqslant \\operatorname{deg} p-1\\).\nProof of the lemma. We apply induction on the degree of \\(G\\). If \\(G\\) is a constant polynomial then we have \\(F(0, \\ldots, 0)=G(0) \\neq 0\\), so \\(F\\) cannot be the zero polynomial.\n\nSuppose that \\(\\operatorname{deg} G \\geqslant 1\\) and the lemma holds true for lower degrees. Since \\(a_{1}+\\ldots+a_{n} \\geqslant \\operatorname{deg} G>0\\), at least one of \\(a_{1}, \\ldots, a_{n}\\) is positive; without loss of generality suppose \\(a_{1} \\geqslant 1\\).\n\nConsider the polynomials \\(F_{1}=\\Delta_{1} F\\) and \\(G_{1}=\\Delta G\\). On the grid \\(\\left\\{0, \\ldots, a_{1}-1\\right\\} \\times\\left\\{0, \\ldots, a_{2}\\right\\} \\times \\ldots \\times\\left\\{0, \\ldots, a_{n}\\right\\}\\) we have\n\\[\n\\begin{aligned}\nF_{1}\\left(x_{1}, \\ldots, x_{n}\\right) & =F\\left(x_{1}+1, x_{2}, \\ldots, x_{n}\\right)-F\\left(x_{1}, x_{2}, \\ldots, x_{n}\\right)= \\\\\n& =G\\left(x_{1}+\\ldots+x_{n}+1\\right)-G\\left(x_{1}+\\ldots+x_{n}\\right)=G_{1}\\left(x_{1}+\\ldots+x_{n}\\right)\n\\end{aligned}\n\\]\n\nSince \\(G\\) is nonconstant, we have \\(\\operatorname{deg} G_{1}=\\operatorname{deg} G-1 \\leqslant\\left(a_{1}-1\\right)+a_{2}+\\ldots+a_{n}\\). Therefore we can apply the induction hypothesis to \\(F_{1}\\) and \\(G_{1}\\) and conclude that \\(F_{1}\\) is not the zero polynomial and \\(\\operatorname{deg} F_{1} \\geqslant \\operatorname{deg} G_{1}\\). Hence, \\(\\operatorname{deg} F \\geqslant \\operatorname{deg} F_{1}+1 \\geqslant \\operatorname{deg} G_{1}+1=\\operatorname{deg} G\\). That finishes the proof.\n\nTo prove the problem statement, take the unique polynomial \\(g(x)\\) so that \\(g(x)=\\left\\lfloor\\frac{x}{m}\\right\\rfloor\\) for \\(x \\in\\{0,1, \\ldots, n(m-1)\\}\\) and \\(\\operatorname{deg} g \\leqslant n(m-1)\\). Notice that precisely \\(n(m-1)+1\\) values of \\(g\\) are prescribed, so \\(g(x)\\) indeed exists and is unique. Notice further that the constraints \\(g(0)=g(1)=0\\) and \\(g(m)=1\\) together enforce deg \\(g \\geqslant 2\\).\n\nBy applying the lemma to \\(a_{1}=\\ldots=a_{n}=m-1\\) and the polynomials \\(f\\) and \\(g\\), we achieve \\(\\operatorname{deg} f \\geqslant \\operatorname{deg} g\\). Hence we just need a suitable lower bound on \\(\\operatorname{deg} g\\).\n\nConsider the polynomial \\(h(x)=g(x+m)-g(x)-1\\). The degree of \\(g(x+m)-g(x)\\) is \\(\\operatorname{deg} g-1 \\geqslant 1\\), so \\(\\operatorname{deg} h=\\operatorname{deg} g-1 \\geqslant 1\\), and therefore \\(h\\) cannot be the zero polynomial. On the other hand, \\(h\\) vanishes at the points \\(0,1, \\ldots, n(m-1)-m\\), so \\(h\\) has at least \\((n-1)(m-1)\\) roots. Hence,\n\\[\n\\operatorname{deg} f \\geqslant \\operatorname{deg} g=\\operatorname{deg} h+1 \\geqslant(n-1)(m-1)+1 \\geqslant n\n\\]\n\nComment 1. In the lemma we have equality for the choice \\(F\\left(x_{1}, \\ldots, x_{n}\\right)=G\\left(x_{1}+\\ldots+x_{n}\\right)\\), so it indeed transforms the problem to an equivalent single-variable question.\n\nComment 2. If \\(m \\geqslant 3\\), the polynomial \\(h(x)\\) can be replaced by \\(\\Delta g\\). Notice that\n\\[\n(\\Delta g)(x)=\\left\\{\\begin{array}{ll}\n1 & \\text { if } x \\equiv-1 \\quad(\\bmod m) \\\\\n0 & \\text { otherwise }\n\\end{array} \\quad \\text { for } x=0,1, \\ldots, n(m-1)-1\\right.\n\\]\n\nHence, \\(\\Delta g\\) vanishes at all integers \\(x\\) with \\(0 \\leqslant x<n(m-1)\\) and \\(x \\not \\equiv-1(\\bmod m)\\). This leads to \\(\\operatorname{deg} g \\geqslant \\frac{(m-1)^{2} n}{m}+1\\).\n\nIf \\(m\\) is even then this lower bound can be improved to \\(n(m-1)\\). For \\(0 \\leqslant N<n(m-1)\\), the \\((N+1)^{\\text {st }}\\) forward difference at \\(x=0\\) is\n\\[\n\\left(\\Delta^{N+1}\\right) g(0)=\\sum_{k=0}^{N}(-1)^{N-k}\\binom{N}{k}(\\Delta g)(k)=\\sum_{\\substack{0 \\leqslant k \\leqslant N \\\\ k \\equiv-1(\\bmod m)}}(-1)^{N-k}\\binom{N}{k}\n\\]\n\nSince \\(m\\) is even, all signs in the last sum are equal; with \\(N=n(m-1)-1\\) this proves \\(\\Delta^{n(m-1)} g(0) \\neq 0\\), indicating that \\(\\operatorname{deg} g \\geqslant n(m-1)\\).\n\nHowever, there are infinitely many cases when all terms in (*) cancel out, for example if \\(m\\) is an odd divisor of \\(n+1\\). In such cases, \\(\\operatorname{deg} f\\) can be less than \\(n(m-1)\\).\n\nComment 3. The lemma is closely related to the so-called\n\n> Alon-F\u00fcredi bound. Let \\(S_{1}, \\ldots, S_{n}\\) be nonempty finite sets in a field and suppose that the polynomial \\(P\\left(x_{1}, \\ldots, x_{n}\\right)\\) vanishes at the points of the grid \\(S_{1} \\times \\ldots \\times S_{n}\\), except for a single point. Then \\(\\operatorname{deg} P \\geqslant \\sum_{i=1}^{n}\\left(\\left|S_{i}\\right|-1\\right)\\).\n> (A well-known application of the Alon-F\u00fcredi bound was the former IMO problem \\(2007 / 6\\). Since then, this result became popular among the students and is part of the IMO training for many IMO teams.)\n\nThe proof of the lemma can be replaced by an application of the Alon-F\u00fcredi bound as follows. Let \\(d=\\operatorname{deg} G\\), and let \\(G_{0}\\) be the unique polynomial such that \\(G_{0}(x)=G(x)\\) for \\(x \\in\\{0,1, \\ldots, d-1\\}\\) but \\(\\operatorname{deg} G_{0}<d\\). The polynomials \\(G_{0}\\) and \\(G\\) are different because they have different degrees, and they attain the same values at \\(0,1, \\ldots, d-1\\); that enforces \\(G_{0}(d) \\neq G(d)\\).\n\nChoose some nonnegative integers \\(b_{1}, \\ldots, b_{n}\\) so that \\(b_{1} \\leqslant a_{1}, \\ldots, b_{n} \\leqslant a_{n}\\), and \\(b_{1}+\\ldots+b_{n}=d\\), and consider the polynomial\n\\[\nH\\left(x_{1}, \\ldots, x_{n}\\right)=F\\left(x_{1}, \\ldots, x_{n}\\right)-G_{0}\\left(x_{1}+\\ldots+x_{n}\\right)\n\\]\non the grid \\(\\left\\{0,1, \\ldots, b_{1}\\right\\} \\times \\ldots \\times\\left\\{0,1, \\ldots, b_{n}\\right\\}\\).\nAt the point \\(\\left(b_{1}, \\ldots, b_{n}\\right)\\) we have \\(H\\left(b_{1}, \\ldots, b_{n}\\right)=G(d)-G_{0}(d) \\neq 0\\). At all other points of the grid we have \\(F=G\\) and therefore \\(H=G-G_{0}=0\\). So, by the Alon-F\u00fcredi bound, \\(\\operatorname{deg} H \\geqslant b_{1}+\\ldots+b_{n}=d\\). Since \\(\\operatorname{deg} G_{0}<d\\), this implies \\(\\operatorname{deg} F=\\operatorname{deg}\\left(H+G_{0}\\right)=\\operatorname{deg} H \\geqslant d=\\operatorname{deg} G\\).", "source_pdf": "imosl_2018.pdf", "notes": "fallback-regex"}
{"id": "IMOSL-2018-A7", "contest": "IMOSL", "year": "2018", "problem_number": "A7", "problem": "Find the maximal value of\n\\[\nS=\\sqrt[3]{\\frac{a}{b+7}}+\\sqrt[3]{\\frac{b}{c+7}}+\\sqrt[3]{\\frac{c}{d+7}}+\\sqrt[3]{\\frac{d}{a+7}},\n\\]\nwhere \\(a, b, c, d\\) are nonnegative real numbers which satisfy \\(a+b+c+d=100\\).\n(Taiwan)", "solution": "Answer: \\(\\frac{8}{\\sqrt[3]{7}}\\), reached when ( \\(a, b, c, d\\) ) is a cyclic permutation of ( \\(1,49,1,49\\) ).\n\n1. Since the value \\(8 / \\sqrt[3]{7}\\) is reached, it suffices to prove that \\(S \\leqslant 8 / \\sqrt[3]{7}\\).\nAssume that \\(x, y, z, t\\) is a permutation of the variables, with \\(x \\leqslant y \\leqslant z \\leqslant t\\). Then, by the rearrangement inequality,\n\\[\nS \\leqslant\\left(\\sqrt[3]{\\frac{x}{t+7}}+\\sqrt[3]{\\frac{t}{x+7}}\\right)+\\left(\\sqrt[3]{\\frac{y}{z+7}}+\\sqrt[3]{\\frac{z}{y+7}}\\right)\n\\]\n\nClaim. The first bracket above does not exceed \\(\\sqrt[3]{\\frac{x+t+14}{7}}\\).\nProof. Since\n\\[\nX^{3}+Y^{3}+3 X Y Z-Z^{3}=\\frac{1}{2}(X+Y-Z)\\left((X-Y)^{2}+(X+Z)^{2}+(Y+Z)^{2}\\right),\n\\]\nthe inequality \\(X+Y \\leqslant Z\\) is equivalent (when \\(X, Y, Z \\geqslant 0\\) ) to \\(X^{3}+Y^{3}+3 X Y Z \\leqslant Z^{3}\\). Therefore, the claim is equivalent to\n\\[\n\\frac{x}{t+7}+\\frac{t}{x+7}+3 \\sqrt[3]{\\frac{x t(x+t+14)}{7(x+7)(t+7)}} \\leqslant \\frac{x+t+14}{7} .\n\\]\n\nNotice that\n\\[\n\\begin{aligned}\n& 3 \\sqrt[3]{\\frac{x t(x+t+14)}{7(x+7)(t+7)}}=3 \\sqrt[3]{\\frac{t(x+7)}{7(t+7)} \\cdot \\frac{x(t+7)}{7(x+7)}} \\cdot \\frac{7(x+t+14)}{(t+7)(x+7)} \\\\\n& \\quad \\leqslant \\frac{t(x+7)}{7(t+7)}+\\frac{x(t+7)}{7(x+7)}+\\frac{7(x+t+14)}{(t+7)(x+7)}\n\\end{aligned}\n\\]\nby the AM-GM inequality, so it suffices to prove\n\\[\n\\frac{x}{t+7}+\\frac{t}{x+7}+\\frac{t(x+7)}{7(t+7)}+\\frac{x(t+7)}{7(x+7)}+\\frac{7(x+t+14)}{(t+7)(x+7)} \\leqslant \\frac{x+t+14}{7} .\n\\]\n\nA straightforward check verifies that the last inequality is in fact an equality.\nThe claim leads now to\n\\[\nS \\leqslant \\sqrt[3]{\\frac{x+t+14}{7}}+\\sqrt[3]{\\frac{y+z+14}{7}} \\leqslant 2 \\sqrt[3]{\\frac{x+y+z+t+28}{14}}=\\frac{8}{\\sqrt[3]{7}},\n\\]\nthe last inequality being due to the AM-CM inequality (or to the fact that \\(\\sqrt[3]{ }\\) is concave on \\([0, \\infty)\\) ).\n\nSolution 2. We present a different proof for the estimate \\(S \\leqslant 8 / \\sqrt[3]{7}\\).\nStart by using H\u00f6lder's inequality:\n\\[\nS^{3}=\\left(\\sum_{\\mathrm{cyc}} \\frac{\\sqrt[6]{a} \\cdot \\sqrt[6]{a}}{\\sqrt[3]{b+7}}\\right)^{3} \\leqslant \\sum_{\\mathrm{cyc}}(\\sqrt[6]{a})^{3} \\cdot \\sum_{\\mathrm{cyc}}(\\sqrt[6]{a})^{3} \\cdot \\sum_{\\mathrm{cyc}}\\left(\\frac{1}{\\sqrt[3]{b+7}}\\right)^{3}=\\left(\\sum_{\\mathrm{cyc}} \\sqrt{a}\\right)^{2} \\sum_{\\mathrm{cyc}} \\frac{1}{b+7}\n\\]\n\nNotice that\n\\[\n\\frac{(x-1)^{2}(x-7)^{2}}{x^{2}+7} \\geqslant 0 \\Longleftrightarrow x^{2}-16 x+71 \\geqslant \\frac{448}{x^{2}+7}\n\\]\nyields\n\\[\n\\sum \\frac{1}{b+7} \\leqslant \\frac{1}{448} \\sum(b-16 \\sqrt{b}+71)=\\frac{1}{448}\\left(384-16 \\sum \\sqrt{b}\\right)=\\frac{48-2 \\sum \\sqrt{b}}{56}\n\\]\n\nFinally,\n\\[\nS^{3} \\leqslant \\frac{1}{56}\\left(\\sum \\sqrt{a}\\right)^{2}\\left(48-2 \\sum \\sqrt{a}\\right) \\leqslant \\frac{1}{56}\\left(\\frac{\\sum \\sqrt{a}+\\sum \\sqrt{a}+\\left(48-2 \\sum \\sqrt{a}\\right)}{3}\\right)^{3}=\\frac{512}{7}\n\\]\nby the AM-GM inequality. The conclusion follows.\nComment. All the above works if we replace 7 and 100 with \\(k>0\\) and \\(2\\left(k^{2}+1\\right)\\), respectively; in this case, the answer becomes\n\\[\n2 \\sqrt[3]{\\frac{(k+1)^{2}}{k}}\n\\]\n\nEven further, a linear substitution allows to extend the solutions to a version with 7 and 100 being replaced with arbitrary positive real numbers \\(p\\) and \\(q\\) satisfying \\(q \\geqslant 4 p\\).\n\n\\section*{Combinatorics}", "source_pdf": "imosl_2018.pdf", "notes": "fallback-regex"}
{"id": "IMOSL-2018-C1", "contest": "IMOSL", "year": "2018", "problem_number": "C1", "problem": "Let \\(n \\geqslant 3\\) be an integer. Prove that there exists a set \\(S\\) of \\(2 n\\) positive integers satisfying the following property: For every \\(m=2,3, \\ldots, n\\) the set \\(S\\) can be partitioned into two subsets with equal sums of elements, with one of subsets of cardinality \\(m\\).\n(Iceland)", "solution": ". We show that one of possible examples is the set\n\\[\nS=\\left\\{1 \\cdot 3^{k}, 2 \\cdot 3^{k}: k=1,2, \\ldots, n-1\\right\\} \\cup\\left\\{1, \\frac{3^{n}+9}{2}-1\\right\\}\n\\]\n\nIt is readily verified that all the numbers listed above are distinct (notice that the last two are not divisible by 3 ).\n\nThe sum of elements in \\(S\\) is\n\\[\n\\Sigma=1+\\left(\\frac{3^{n}+9}{2}-1\\right)+\\sum_{k=1}^{n-1}\\left(1 \\cdot 3^{k}+2 \\cdot 3^{k}\\right)=\\frac{3^{n}+9}{2}+\\sum_{k=1}^{n-1} 3^{k+1}=\\frac{3^{n}+9}{2}+\\frac{3^{n+1}-9}{2}=2 \\cdot 3^{n}\n\\]\n\nHence, in order to show that this set satisfies the problem requirements, it suffices to present, for every \\(m=2,3, \\ldots, n\\), an \\(m\\)-element subset \\(A_{m} \\subset S\\) whose sum of elements equals \\(3^{n}\\).\n\nSuch a subset is\n\\[\nA_{m}=\\left\\{2 \\cdot 3^{k}: k=n-m+1, n-m+2, \\ldots, n-1\\right\\} \\cup\\left\\{1 \\cdot 3^{n-m+1}\\right\\}\n\\]\n\nClearly, \\(\\left|A_{m}\\right|=m\\). The sum of elements in \\(A_{m}\\) is\n\\[\n3^{n-m+1}+\\sum_{k=n-m+1}^{n-1} 2 \\cdot 3^{k}=3^{n-m+1}+\\frac{2 \\cdot 3^{n}-2 \\cdot 3^{n-m+1}}{2}=3^{n}\n\\]\nas required.\n\nComment. Let us present a more general construction. Let \\(s_{1}, s_{2}, \\ldots, s_{2 n-1}\\) be a sequence of pairwise distinct positive integers satisfying \\(s_{2 i+1}=s_{2 i}+s_{2 i-1}\\) for all \\(i=2,3, \\ldots, n-1\\). Set \\(s_{2 n}=s_{1}+s_{2}+ \\cdots+s_{2 n-4}\\).\n\nAssume that \\(s_{2 n}\\) is distinct from the other terms of the sequence. Then the set \\(S=\\left\\{s_{1}, s_{2}, \\ldots, s_{2 n}\\right\\}\\) satisfies the problem requirements. Indeed, the sum of its elements is\n\\[\n\\Sigma=\\sum_{i=1}^{2 n-4} s_{i}+\\left(s_{2 n-3}+s_{2 n-2}\\right)+s_{2 n-1}+s_{2 n}=s_{2 n}+s_{2 n-1}+s_{2 n-1}+s_{2 n}=2 s_{2 n}+2 s_{2 n-1}\n\\]\n\nTherefore, we have\n\\[\n\\frac{\\Sigma}{2}=s_{2 n}+s_{2 n-1}=s_{2 n}+s_{2 n-2}+s_{2 n-3}=s_{2 n}+s_{2 n-2}+s_{2 n-4}+s_{2 n-5}=\\ldots\n\\]\nwhich shows that the required sets \\(A_{m}\\) can be chosen as\n\\[\nA_{m}=\\left\\{s_{2 n}, s_{2 n-2}, \\ldots, s_{2 n-2 m+4}, s_{2 n-2 m+3}\\right\\}\n\\]\n\nSo, the only condition to be satisfied is \\(s_{2 n} \\notin\\left\\{s_{1}, s_{2}, \\ldots, s_{2 n-1}\\right\\}\\), which can be achieved in many different ways (e.g., by choosing properly the number \\(s_{1}\\) after specifying \\(s_{2}, s_{3}, \\ldots, s_{2 n-1}\\) ).\n\nThe solution above is an instance of this general construction. Another instance, for \\(n>3\\), is the set\n\\[\n\\left\\{F_{1}, F_{2}, \\ldots, F_{2 n-1}, F_{1}+\\cdots+F_{2 n-4}\\right\\}\n\\]\nwhere \\(F_{1}=1, F_{2}=2, F_{n+1}=F_{n}+F_{n-1}\\) is the usual Fibonacci sequence.", "source_pdf": "imosl_2018.pdf", "notes": "fallback-regex"}
{"id": "IMOSL-2018-C3", "contest": "IMOSL", "year": "2018", "problem_number": "C3", "problem": "Let \\(n\\) be a given positive integer. Sisyphus performs a sequence of turns on a board consisting of \\(n+1\\) squares in a row, numbered 0 to \\(n\\) from left to right. Initially, \\(n\\) stones are put into square 0 , and the other squares are empty. At every turn, Sisyphus chooses any nonempty square, say with \\(k\\) stones, takes one of those stones and moves it to the right by at most \\(k\\) squares (the stone should stay within the board). Sisyphus' aim is to move all \\(n\\) stones to square \\(n\\).\n\nProve that Sisyphus cannot reach the aim in less than\n\\[\n\\left\\lceil\\frac{n}{1}\\right\\rceil+\\left\\lceil\\frac{n}{2}\\right\\rceil+\\left\\lceil\\frac{n}{3}\\right\\rceil+\\cdots+\\left\\lceil\\frac{n}{n}\\right\\rceil\n\\]\nturns. (As usual, \\(\\lceil x\\rceil\\) stands for the least integer not smaller than \\(x\\).)\n(Netherlands)", "solution": ". The stones are indistinguishable, and all have the same origin and the same final position. So, at any turn we can prescribe which stone from the chosen square to move. We do it in the following manner. Number the stones from 1 to \\(n\\). At any turn, after choosing a square, Sisyphus moves the stone with the largest number from this square.\n\nThis way, when stone \\(k\\) is moved from some square, that square contains not more than \\(k\\) stones (since all their numbers are at most \\(k\\) ). Therefore, stone \\(k\\) is moved by at most \\(k\\) squares at each turn. Since the total shift of the stone is exactly \\(n\\), at least \\(\\lceil n / k\\rceil\\) moves of stone \\(k\\) should have been made, for every \\(k=1,2, \\ldots, n\\).\n\nBy summing up over all \\(k=1,2, \\ldots, n\\), we get the required estimate.\n\nComment. The original submission contained the second part, asking for which values of \\(n\\) the equality can be achieved. The answer is \\(n=1,2,3,4,5,7\\). The Problem Selection Committee considered this part to be less suitable for the competition, due to technicalities.", "source_pdf": "imosl_2018.pdf", "notes": "fallback-regex"}
{"id": "IMOSL-2018-C5", "contest": "IMOSL", "year": "2018", "problem_number": "C5", "problem": "Let \\(k\\) be a positive integer. The organising committee of a tennis tournament is to schedule the matches for \\(2 k\\) players so that every two players play once, each day exactly one match is played, and each player arrives to the tournament site the day of his first match, and departs the day of his last match. For every day a player is present on the tournament, the committee has to pay 1 coin to the hotel. The organisers want to design the schedule so as to minimise the total cost of all players' stays. Determine this minimum cost.\n(Russia)", "solution": "Answer: The required minimum is \\(k\\left(4 k^{2}+k-1\\right) / 2\\).\n\n1. Enumerate the days of the tournament \\(1,2, \\ldots,\\binom{2 k}{2}\\). Let \\(b_{1} \\leqslant b_{2} \\leqslant \\cdots \\leqslant b_{2 k}\\) be the days the players arrive to the tournament, arranged in nondecreasing order; similarly, let \\(e_{1} \\geqslant \\cdots \\geqslant e_{2 k}\\) be the days they depart arranged in nonincreasing order (it may happen that a player arrives on day \\(b_{i}\\) and departs on day \\(e_{j}\\), where \\(i \\neq j\\) ). If a player arrives on day \\(b\\) and departs on day \\(e\\), then his stay cost is \\(e-b+1\\). Therefore, the total stay cost is\n\\[\n\\Sigma=\\sum_{i=1}^{2 k} e_{i}-\\sum_{i=1}^{2 k} b_{i}+n=\\sum_{i=1}^{2 k}\\left(e_{i}-b_{i}+1\\right)\n\\]\n\nBounding the total cost from below. To this end, estimate \\(e_{i+1}-b_{i+1}+1\\). Before day \\(b_{i+1}\\), only \\(i\\) players were present, so at most \\(\\binom{i}{2}\\) matches could be played. Therefore, \\(b_{i+1} \\leqslant\\binom{ i}{2}+1\\). Similarly, at most \\(\\binom{i}{2}\\) matches could be played after day \\(e_{i+1}\\), so \\(e_{i} \\geqslant\\binom{ 2 k}{2}-\\binom{i}{2}\\). Thus,\n\\[\ne_{i+1}-b_{i+1}+1 \\geqslant\\binom{ 2 k}{2}-2\\binom{i}{2}=k(2 k-1)-i(i-1)\n\\]\n\nThis lower bound can be improved for \\(i>k\\) : List the \\(i\\) players who arrived first, and the \\(i\\) players who departed last; at least \\(2 i-2 k\\) players appear in both lists. The matches between these players were counted twice, though the players in each pair have played only once. Therefore, if \\(i>k\\), then\n\\[\ne_{i+1}-b_{i+1}+1 \\geqslant\\binom{ 2 k}{2}-2\\binom{i}{2}+\\binom{2 i-2 k}{2}=(2 k-i)^{2}\n\\]\n\nAn optimal tournament, We now describe a schedule in which the lower bounds above are all achieved simultaneously. Split players into two groups \\(X\\) and \\(Y\\), each of cardinality \\(k\\). Next, partition the schedule into three parts. During the first part, the players from \\(X\\) arrive one by one, and each newly arrived player immediately plays with everyone already present. During the third part (after all players from \\(X\\) have already departed) the players from \\(Y\\) depart one by one, each playing with everyone still present just before departing.\n\nIn the middle part, everyone from \\(X\\) should play with everyone from \\(Y\\). Let \\(S_{1}, S_{2}, \\ldots, S_{k}\\) be the players in \\(X\\), and let \\(T_{1}, T_{2}, \\ldots, T_{k}\\) be the players in \\(Y\\). Let \\(T_{1}, T_{2}, \\ldots, T_{k}\\) arrive in this order; after \\(T_{j}\\) arrives, he immediately plays with all the \\(S_{i}, i>j\\). Afterwards, players \\(S_{k}\\), \\(S_{k-1}, \\ldots, S_{1}\\) depart in this order; each \\(S_{i}\\) plays with all the \\(T_{j}, i \\leqslant j\\), just before his departure, and \\(S_{k}\\) departs the day \\(T_{k}\\) arrives. For \\(0 \\leqslant s \\leqslant k-1\\), the number of matches played between \\(T_{k-s}\\) 's arrival and \\(S_{k-s}\\) 's departure is\n\\[\n\\sum_{j=k-s}^{k-1}(k-j)+1+\\sum_{j=k-s}^{k-1}(k-j+1)=\\frac{1}{2} s(s+1)+1+\\frac{1}{2} s(s+3)=(s+1)^{2}\n\\]\n\nThus, if \\(i>k\\), then the number of matches that have been played between \\(T_{i-k+1}\\) 's arrival, which is \\(b_{i+1}\\), and \\(S_{i-k+1}\\) 's departure, which is \\(e_{i+1}\\), is \\((2 k-i)^{2}\\); that is, \\(e_{i+1}-b_{i+1}+1=(2 k-i)^{2}\\), showing the second lower bound achieved for all \\(i>k\\).\n\nIf \\(i \\leqslant k\\), then the matches between the \\(i\\) players present before \\(b_{i+1}\\) all fall in the first part of the schedule, so there are \\(\\binom{i}{2}\\) such, and \\(b_{i+1}=\\binom{i}{2}+1\\). Similarly, after \\(e_{i+1}\\), there are \\(i\\) players left, all \\(\\binom{i}{2}\\) matches now fall in the third part of the schedule, and \\(e_{i+1}=\\binom{2 k}{2}-\\binom{i}{2}\\). The first lower bound is therefore also achieved for all \\(i \\leqslant k\\).\n\nConsequently, all lower bounds are achieved simultaneously, and the schedule is indeed optimal.\nEvaluation. Finally, evaluate the total cost for the optimal schedule:\n\\[\n\\begin{aligned}\n\\Sigma & =\\sum_{i=0}^{k}(k(2 k-1)-i(i-1))+\\sum_{i=k+1}^{2 k-1}(2 k-i)^{2}=(k+1) k(2 k-1)-\\sum_{i=0}^{k} i(i-1)+\\sum_{j=1}^{k-1} j^{2} \\\\\n& =k(k+1)(2 k-1)-k^{2}+\\frac{1}{2} k(k+1)=\\frac{1}{2} k\\left(4 k^{2}+k-1\\right)\n\\end{aligned}\n\\]\n\nSolution 2. Consider any tournament schedule. Label players \\(P_{1}, P_{2}, \\ldots, P_{2 k}\\) in order of their arrival, and label them again \\(Q_{2 k}, Q_{2 k-1}, \\ldots, Q_{1}\\) in order of their departure, to define a permutation \\(a_{1}, a_{2}, \\ldots, a_{2 k}\\) of \\(1,2, \\ldots, 2 k\\) by \\(P_{i}=Q_{a_{i}}\\).\n\nWe first describe an optimal tournament for any given permutation \\(a_{1}, a_{2}, \\ldots, a_{2 k}\\) of the indices \\(1,2, \\ldots, 2 k\\). Next, we find an optimal permutation and an optimal tournament.\nOptimisation for a fixed \\(a_{1}, \\ldots, a_{2 k}\\). We say that the cost of the match between \\(P_{i}\\) and \\(P_{j}\\) is the number of players present at the tournament when this match is played. Clearly, the Committee pays for each day the cost of the match of that day. Hence, we are to minimise the total cost of all matches.\n\nNotice that \\(Q_{2 k}\\) 's departure does not precede \\(P_{2 k}\\) 's arrival. Hence, the number of players at the tournament monotonically increases (non-strictly) until it reaches \\(2 k\\), and then monotonically decreases (non-strictly). So, the best time to schedule the match between \\(P_{i}\\) and \\(P_{j}\\) is either when \\(P_{\\max (i, j)}\\) arrives, or when \\(Q_{\\max \\left(a_{i}, a_{j}\\right)}\\) departs, in which case the cost is \\(\\min \\left(\\max (i, j), \\max \\left(a_{i}, a_{j}\\right)\\right)\\).\n\nConversely, assuming that \\(i>j\\), if this match is scheduled between the arrivals of \\(P_{i}\\) and \\(P_{i+1}\\), then its cost will be exactly \\(i=\\max (i, j)\\). Similarly, one can make it cost \\(\\max \\left(a_{i}, a_{j}\\right)\\). Obviously, these conditions can all be simultaneously satisfied, so the minimal cost for a fixed sequence \\(a_{1}, a_{2}, \\ldots, a_{2 k}\\) is\n\\[\n\\Sigma\\left(a_{1}, \\ldots, a_{2 k}\\right)=\\sum_{1 \\leqslant i<j \\leqslant 2 k} \\min \\left(\\max (i, j), \\max \\left(a_{i}, a_{j}\\right)\\right) .\n\\]\n\nOptimising the sequence ( \\(a_{i}\\) ). Optimisation hinges on the lemma below.\nLemma. If \\(a \\leqslant b\\) and \\(c \\leqslant d\\), then\n\\[\n\\begin{aligned}\n\\min (\\max (a, x), \\max (c, y))+\\min & (\\max (b, x), \\max (d, y)) \\\\\n& \\geqslant \\min (\\max (a, x), \\max (d, y))+\\min (\\max (b, x), \\max (c, y))\n\\end{aligned}\n\\]\n\nProof. Write \\(a^{\\prime}=\\max (a, x) \\leqslant \\max (b, x)=b^{\\prime}\\) and \\(c^{\\prime}=\\max (c, y) \\leqslant \\max (d, y)=d^{\\prime}\\) and check that \\(\\min \\left(a^{\\prime}, c^{\\prime}\\right)+\\min \\left(b^{\\prime}, d^{\\prime}\\right) \\geqslant \\min \\left(a^{\\prime}, d^{\\prime}\\right)+\\min \\left(b^{\\prime}, c^{\\prime}\\right)\\).\n\nConsider a permutation \\(a_{1}, a_{2}, \\ldots, a_{2 k}\\) such that \\(a_{i}<a_{j}\\) for some \\(i<j\\). Swapping \\(a_{i}\\) and \\(a_{j}\\) does not change the ( \\(i, j\\) )th summand in ( 1 ), and for \\(\\ell \\notin\\{i, j\\}\\) the sum of the ( \\(i, \\ell\\) ) th and the ( \\(j, \\ell\\) )th summands does not increase by the Lemma. Hence the optimal value does not increase, but the number of disorders in the permutation increases. This process stops when \\(a_{i}=2 k+1-i\\) for all \\(i\\), so the required minimum is\n\\[\n\\begin{aligned}\nS(2 k, 2 k-1, \\ldots, 1) & =\\sum_{1 \\leqslant i<j \\leqslant 2 k} \\min (\\max (i, j), \\max (2 k+1-i, 2 k+1-j)) \\\\\n& =\\sum_{1 \\leqslant i<j \\leqslant 2 k} \\min (j, 2 k+1-i)\n\\end{aligned}\n\\]\n\nThe latter sum is fairly tractable and yields the stated result; we omit the details.\nComment. If the number of players is odd, say, \\(2 k-1\\), the required minimum is \\(k(k-1)(4 k-1) / 2\\). In this case, \\(|X|=k,|Y|=k-1\\), the argument goes along the same lines, but some additional technicalities are to be taken care of.", "source_pdf": "imosl_2018.pdf", "notes": "fallback-regex"}
{"id": "IMOSL-2018-C6", "contest": "IMOSL", "year": "2018", "problem_number": "C6", "problem": "Let \\(a\\) and \\(b\\) be distinct positive integers. The following infinite process takes place on an initially empty board.\n(i) If there is at least a pair of equal numbers on the board, we choose such a pair and increase one of its components by \\(a\\) and the other by \\(b\\).\n(ii) If no such pair exists, we write down two times the number 0 .\n\nProve that, no matter how we make the choices in \\((i)\\), operation \\((i i)\\) will be performed only finitely many times.\n(Serbia)", "solution": "1. We may assume \\(\\operatorname{gcd}(a, b)=1\\); otherwise we work in the same way with multiples of \\(d=\\operatorname{gcd}(a, b)\\).\n\nSuppose that after \\(N\\) moves of type (ii) and some moves of type (i) we have to add two new zeros. For each integer \\(k\\), denote by \\(f(k)\\) the number of times that the number \\(k\\) appeared on the board up to this moment. Then \\(f(0)=2 N\\) and \\(f(k)=0\\) for \\(k<0\\). Since the board contains at most one \\(k-a\\), every second occurrence of \\(k-a\\) on the board produced, at some moment, an occurrence of \\(k\\); the same stands for \\(k-b\\). Therefore,\n\\[\nf(k)=\\left\\lfloor\\frac{f(k-a)}{2}\\right\\rfloor+\\left\\lfloor\\frac{f(k-b)}{2}\\right\\rfloor\n\\]\nyielding\n\\[\nf(k) \\geqslant \\frac{f(k-a)+f(k-b)}{2}-1 .\n\\]\n\nSince \\(\\operatorname{gcd}(a, b)=1\\), every integer \\(x>a b-a-b\\) is expressible in the form \\(x=s a+t b\\), with integer \\(s, t \\geqslant 0\\).\n\nWe will prove by induction on \\(s+t\\) that if \\(x=s a+b t\\), with \\(s, t\\) nonnegative integers, then\n\\[\nf(x)>\\frac{f(0)}{2^{s+t}}-2\n\\]\n\nThe base case \\(s+t=0\\) is trivial. Assume now that (3) is true for \\(s+t=v\\). Then, if \\(s+t=v+1\\) and \\(x=s a+t b\\), at least one of the numbers \\(s\\) and \\(t\\)-say \\(s\\)-is positive, hence by (2),\n\\[\nf(x)=f(s a+t b) \\geqslant \\frac{f((s-1) a+t b)}{2}-1>\\frac{1}{2}\\left(\\frac{f(0)}{2^{s+t-1}}-2\\right)-1=\\frac{f(0)}{2^{s+t}}-2 .\n\\]\n\nAssume now that we must perform moves of type (ii) ad infinitum. Take \\(n=a b-a-b\\) and suppose \\(b>a\\). Since each of the numbers \\(n+1, n+2, \\ldots, n+b\\) can be expressed in the form \\(s a+t b\\), with \\(0 \\leqslant s \\leqslant b\\) and \\(0 \\leqslant t \\leqslant a\\), after moves of type (ii) have been performed \\(2^{a+b+1}\\) times and we have to add a new pair of zeros, each \\(f(n+k), k=1,2, \\ldots, b\\), is at least 2 . In this case (1) yields inductively \\(f(n+k) \\geqslant 2\\) for all \\(k \\geqslant 1\\). But this is absurd: after a finite number of moves, \\(f\\) cannot attain nonzero values at infinitely many points.\n\nSolution 2. We start by showing that the result of the process in the problem does not depend on the way the operations are performed. For that purpose, it is convenient to modify the process a bit.\nClaim 1. Suppose that the board initially contains a finite number of nonnegative integers, and one starts performing type (i) moves only. Assume that one had applied \\(k\\) moves which led to a final arrangement where no more type (i) moves are possible. Then, if one starts from the same initial arrangement, performing type (i) moves in an arbitrary fashion, then the process will necessarily stop at the same final arrangement\n\nProof. Throughout this proof, all moves are supposed to be of type (i).\nInduct on \\(k\\); the base case \\(k=0\\) is trivial, since no moves are possible. Assume now that \\(k \\geqslant 1\\). Fix some canonical process, consisting of \\(k\\) moves \\(M_{1}, M_{2}, \\ldots, M_{k}\\), and reaching the final arrangement \\(A\\). Consider any sample process \\(m_{1}, m_{2}, \\ldots\\) starting with the same initial arrangement and proceeding as long as possible; clearly, it contains at least one move. We need to show that this process stops at \\(A\\).\n\nLet move \\(m_{1}\\) consist in replacing two copies of \\(x\\) with \\(x+a\\) and \\(x+b\\). If move \\(M_{1}\\) does the same, we may apply the induction hypothesis to the arrangement appearing after \\(m_{1}\\). Otherwise, the canonical process should still contain at least one move consisting in replacing \\((x, x) \\mapsto(x+a, x+b)\\), because the initial arrangement contains at least two copies of \\(x\\), while the final one contains at most one such.\n\nLet \\(M_{i}\\) be the first such move. Since the copies of \\(x\\) are indistinguishable and no other copy of \\(x\\) disappeared before \\(M_{i}\\) in the canonical process, the moves in this process can be permuted as \\(M_{i}, M_{1}, \\ldots, M_{i-1}, M_{i+1}, \\ldots, M_{k}\\), without affecting the final arrangement. Now it suffices to perform the move \\(m_{1}=M_{i}\\) and apply the induction hypothesis as above.\nClaim 2. Consider any process starting from the empty board, which involved exactly \\(n\\) moves of type (ii) and led to a final arrangement where all the numbers are distinct. Assume that one starts with the board containing \\(2 n\\) zeroes (as if \\(n\\) moves of type (ii) were made in the beginning), applying type (i) moves in an arbitrary way. Then this process will reach the same final arrangement.\nProof. Starting with the board with \\(2 n\\) zeros, one may indeed model the first process mentioned in the statement of the claim, omitting the type (ii) moves. This way, one reaches the same final arrangement. Now, Claim 1 yields that this final arrangement will be obtained when type (i) moves are applied arbitrarily.\n\nClaim 2 allows now to reformulate the problem statement as follows: There exists an integer \\(n\\) such that, starting from \\(2 n\\) zeroes, one may apply type (i) moves indefinitely.\n\nIn order to prove this, we start with an obvious induction on \\(s+t=k \\geqslant 1\\) to show that if we start with \\(2^{s+t}\\) zeros, then we can get simultaneously on the board, at some point, each of the numbers \\(s a+t b\\), with \\(s+t=k\\).\n\nSuppose now that \\(a<b\\). Then, an appropriate use of separate groups of zeros allows us to get two copies of each of the numbers \\(s a+t b\\), with \\(1 \\leqslant s, t \\leqslant b\\).\n\nDefine \\(N=a b-a-b\\), and notice that after representing each of numbers \\(N+k, 1 \\leqslant k \\leqslant b\\), in the form \\(s a+t b, 1 \\leqslant s, t \\leqslant b\\) we can get, using enough zeros, the numbers \\(N+1, N+2, \\ldots, N+a\\) and the numbers \\(N+1, N+2, \\ldots, N+b\\).\n\nFrom now on we can perform only moves of type (i). Indeed, if \\(n \\geqslant N\\), the occurrence of the numbers \\(n+1, n+2, \\ldots, n+a\\) and \\(n+1, n+2, \\ldots, n+b\\) and the replacement ( \\(n+1, n+1\\) ) \\(\\mapsto (n+b+1, n+a+1)\\) leads to the occurrence of the numbers \\(n+2, n+3, \\ldots, n+a+1\\) and \\(n+2, n+3, \\ldots, n+b+1\\).\n\nComment. The proofs of Claims 1 and 2 may be extended in order to show that in fact the number of moves in the canonical process is the same as in an arbitrary sample one.", "source_pdf": "imosl_2018.pdf", "notes": "fallback-regex"}
{"id": "IMOSL-2018-C7", "contest": "IMOSL", "year": "2018", "problem_number": "C7", "problem": "Consider 2018 pairwise crossing circles no three of which are concurrent. These circles subdivide the plane into regions bounded by circular edges that meet at vertices. Notice that there are an even number of vertices on each circle. Given the circle, alternately colour the vertices on that circle red and blue. In doing so for each circle, every vertex is coloured twice once for each of the two circles that cross at that point. If the two colourings agree at a vertex, then it is assigned that colour; otherwise, it becomes yellow. Show that, if some circle contains at least 2061 yellow points, then the vertices of some region are all yellow.\n(India)", "solution": "1. Letting \\(n=2018\\), we will show that, if every region has at least one non-yellow vertex, then every circle contains at most \\(n+\\lfloor\\sqrt{n-2}\\rfloor-2\\) yellow points. In the case at hand, the latter equals \\(2018+44-2=2060\\), contradicting the hypothesis.\n\nConsider the natural geometric graph \\(G\\) associated with the configuration of \\(n\\) circles. Fix any circle \\(C\\) in the configuration, let \\(k\\) be the number of yellow points on \\(C\\), and find a suitable lower bound for the total number of yellow vertices of \\(G\\) in terms of \\(k\\) and \\(n\\). It turns out that \\(k\\) is even, and \\(G\\) has at least\n\\[\nk+2\\binom{k / 2}{2}+2\\binom{n-k / 2-1}{2}=\\frac{k^{2}}{2}-(n-2) k+(n-2)(n-1)\n\\]\nyellow vertices. The proof hinges on the two lemmata below.\nLemma 1. Let two circles in the configuration cross at \\(x\\) and \\(y\\). Then \\(x\\) and \\(y\\) are either both yellow or both non-yellow.\nProof. This is because the numbers of interior vertices on the four arcs \\(x\\) and \\(y\\) determine on the two circles have like parities.\n\nIn particular, each circle in the configuration contains an even number of yellow vertices.\nLemma 2. If \\(\\overparen{x y}, \\overparen{y z}\\), and \\(\\overparen{z x}\\) are circular arcs of three pairwise distinct circles in the configuration, then the number of yellow vertices in the set \\(\\{x, y, z\\}\\) is odd.\nProof. Let \\(C_{1}, C_{2}, C_{3}\\) be the three circles under consideration. Assume, without loss of generality, that \\(C_{2}\\) and \\(C_{3}\\) cross at \\(x, C_{3}\\) and \\(C_{1}\\) cross at \\(y\\), and \\(C_{1}\\) and \\(C_{2}\\) cross at \\(z\\). Let \\(k_{1}\\), \\(k_{2}, k_{3}\\) be the numbers of interior vertices on the three circular arcs under consideration. Since each circle in the configuration, different from the \\(C_{i}\\), crosses the cycle \\(\\overparen{x y} \\cup \\overparen{y z} \\cup \\overparen{z x}\\) at an even number of points (recall that no three circles are concurrent), and self-crossings are counted twice, the sum \\(k_{1}+k_{2}+k_{3}\\) is even.\n\nLet \\(Z_{1}\\) be the colour \\(z\\) gets from \\(C_{1}\\) and define the other colours similarly. By the preceding, the number of bichromatic pairs in the list \\(\\left(Z_{1}, Y_{1}\\right),\\left(X_{2}, Z_{2}\\right),\\left(Y_{3}, X_{3}\\right)\\) is odd. Since the total number of colour changes in a cycle \\(Z_{1}-Y_{1}-Y_{3}-X_{3}-X_{2}-Z_{2}-Z_{1}\\) is even, the number of bichromatic pairs in the list \\(\\left(X_{2}, X_{3}\\right),\\left(Y_{1}, Y_{3}\\right),\\left(Z_{1}, Z_{2}\\right)\\) is odd, and the lemma follows.\n\nWe are now in a position to prove that (*) bounds the total number of yellow vertices from below. Refer to Lemma 1 to infer that the \\(k\\) yellow vertices on \\(C\\) pair off to form the pairs of points where \\(C\\) is crossed by \\(k / 2\\) circles in the configuration. By Lemma 2, these circles cross pairwise to account for another \\(2\\binom{k / 2}{2}\\) yellow vertices. Finally, the remaining \\(n-k / 2-1\\) circles in the configuration cross \\(C\\) at non-yellow vertices, by Lemma 1, and Lemma 2 applies again to show that these circles cross pairwise to account for yet another \\(2\\binom{n-k / 2-1}{2}\\) yellow vertices. Consequently, there are at least (*) yellow vertices.\n\nNext, notice that \\(G\\) is a plane graph on \\(n(n-1)\\) degree 4 vertices, having exactly \\(2 n(n-1)\\) edges and exactly \\(n(n-1)+2\\) faces (regions), the outer face inclusive (by Euler's formula for planar graphs).\nLemma 3. Each face of \\(G\\) has equally many red and blue vertices. In particular, each face has an even number of non-yellow vertices.\n\nProof. Trace the boundary of a face once in circular order, and consider the colours each vertex is assigned in the colouring of the two circles that cross at that vertex, to infer that colours of non-yellow vertices alternate.\n\nConsequently, if each region has at least one non-yellow vertex, then it has at least two such. Since each vertex of \\(G\\) has degree 4, consideration of vertex-face incidences shows that \\(G\\) has at least \\(n(n-1) / 2+1\\) non-yellow vertices, and hence at most \\(n(n-1) / 2-1\\) yellow vertices. (In fact, Lemma 3 shows that there are at least \\(n(n-1) / 4+1 / 2\\) red, respectively blue, vertices.)\n\nFinally, recall the lower bound (*) for the total number of yellow vertices in \\(G\\), to write \\(n(n-1) / 2-1 \\geqslant k^{2} / 2-(n-2) k+(n-2)(n-1)\\), and conclude that \\(k \\leqslant n+\\lfloor\\sqrt{n-2}\\rfloor-2\\), as claimed in the first paragraph.\n\nSolution 2. The first two lemmata in Solution 1 show that the circles in the configuration split into two classes: Consider any circle \\(C\\) along with all circles that cross \\(C\\) at yellow points to form one class; the remaining circles then form the other class. Lemma 2 shows that any pair of circles in the same class cross at yellow points; otherwise, they cross at non-yellow points.\n\nCall the circles from the two classes white and black, respectively. Call a region yellow if its vertices are all yellow. Let \\(w\\) and \\(b\\) be the numbers of white and black circles, respectively; clearly, \\(w+b=n\\). Assume that \\(w \\geqslant b\\), and that there is no yellow region. Clearly, \\(b \\geqslant 1\\), otherwise each region is yellow. The white circles subdivide the plane into \\(w(w-1)+2\\) larger regions - call them white. The white regions (or rather their boundaries) subdivide each black circle into black arcs. Since there are no yellow regions, each white region contains at least one black arc.\n\nConsider any white region; let it contain \\(t \\geqslant 1\\) black arcs. We claim that the number of points at which these \\(t\\) arcs cross does not exceed \\(t-1\\). To prove this, consider a multigraph whose vertices are these black arcs, two vertices being joined by an edge for each point at which the corresponding arcs cross. If this graph had more than \\(t-1\\) edges, it would contain a cycle, since it has \\(t\\) vertices; this cycle would correspond to a closed contour formed by black sub-arcs, lying inside the region under consideration. This contour would, in turn, define at least one yellow region, which is impossible.\n\nLet \\(t_{i}\\) be the number of black arcs inside the \\(i^{\\text {th }}\\) white region. The total number of black \\(\\operatorname{arcs}\\) is \\(\\sum_{i} t_{i}=2 w b\\), and they cross at \\(2\\binom{b}{2}=b(b-1)\\) points. By the preceding,\n\\[\nb(b-1) \\leqslant \\sum_{i=1}^{w^{2}-w+2}\\left(t_{i}-1\\right)=\\sum_{i=1}^{w^{2}-w+2} t_{i}-\\left(w^{2}-w+2\\right)=2 w b-\\left(w^{2}-w+2\\right)\n\\]\nor, equivalently, \\((w-b)^{2} \\leqslant w+b-2=n-2\\), which is the case if and only if \\(w-b \\leqslant\\lfloor\\sqrt{n-2}\\rfloor\\). Consequently, \\(b \\leqslant w \\leqslant(n+\\lfloor\\sqrt{n-2}\\rfloor) / 2\\), so there are at most \\(2(w-1) \\leqslant n+\\lfloor\\sqrt{n-2}\\rfloor-2\\) yellow vertices on each circle - a contradiction.\n\n\\section*{Geometry}", "source_pdf": "imosl_2018.pdf", "notes": "fallback-regex"}
{"id": "IMOSL-2018-G2", "contest": "IMOSL", "year": "2018", "problem_number": "G2", "problem": "Let \\(A B C\\) be a triangle with \\(A B=A C\\), and let \\(M\\) be the midpoint of \\(B C\\). Let \\(P\\) be a point such that \\(P B<P C\\) and \\(P A\\) is parallel to \\(B C\\). Let \\(X\\) and \\(Y\\) be points on the lines \\(P B\\) and \\(P C\\), respectively, so that \\(B\\) lies on the segment \\(P X, C\\) lies on the segment \\(P Y\\), and \\(\\angle P X M=\\angle P Y M\\). Prove that the quadrilateral \\(A P X Y\\) is cyclic.\n(Australia)", "solution": ". Since \\(A B=A C, A M\\) is the perpendicular bisector of \\(B C\\), hence \\(\\angle P A M= \\angle A M C=90^{\\circ}\\).\n![](https://cdn.mathpix.com/cropped/2025_08_23_9fba422e6efd92ed50fcg-40.jpg?height=709&width=684&top_left_y=676&top_left_x=693)\n\nNow let \\(Z\\) be the common point of \\(A M\\) and the perpendicular through \\(Y\\) to \\(P C\\) (notice that \\(Z\\) lies on to the ray \\(A M\\) beyond \\(M\\) ). We have \\(\\angle P A Z=\\angle P Y Z=90^{\\circ}\\). Thus the points \\(P, A, Y\\), and \\(Z\\) are concyclic.\n\nSince \\(\\angle C M Z=\\angle C Y Z=90^{\\circ}\\), the quadrilateral \\(C Y Z M\\) is cyclic, hence \\(\\angle C Z M= \\angle C Y M\\). By the condition in the statement, \\(\\angle C Y M=\\angle B X M\\), and, by symmetry in \\(Z M\\), \\(\\angle C Z M=\\angle B Z M\\). Therefore, \\(\\angle B X M=\\angle B Z M\\). It follows that the points \\(B, X, Z\\), and \\(M\\) are concyclic, hence \\(\\angle B X Z=180^{\\circ}-\\angle B M Z=90^{\\circ}\\).\n\nFinally, we have \\(\\angle P X Z=\\angle P Y Z=\\angle P A Z=90^{\\circ}\\), hence the five points \\(P, A, X, Y, Z\\) are concyclic. In particular, the quadrilateral \\(A P X Y\\) is cyclic, as required.\n\nComment 1. Clearly, the key point \\(Z\\) from the solution above can be introduced in several different ways, e.g., as the second meeting point of the circle \\(C M Y\\) and the line \\(A M\\), or as the second meeting point of the circles \\(C M Y\\) and \\(B M X\\), etc.\n\nFor some of definitions of \\(Z\\) its location is not obvious. For instance, if \\(Z\\) is defined as a common point of \\(A M\\) and the perpendicular through \\(X\\) to \\(P X\\), it is not clear that \\(Z\\) lies on the ray \\(A M\\) beyond \\(M\\). To avoid such slippery details some more restrictions on the construction may be required.\n\nComment 2. Let us discuss a connection to the Miquel point of a cyclic quadrilateral. Set \\(X^{\\prime}= M X \\cap P C, Y^{\\prime}=M Y \\cap P B\\), and \\(Q=X Y \\cap X^{\\prime} Y^{\\prime}\\) (see the figure below).\n\nWe claim that \\(B C \\| P Q\\). (One way of proving this is the following. Notice that the quadruple of lines \\(P X, P M, P Y, P Q\\) is harmonic, hence the quadruple \\(B, M, C, P Q \\cap B C\\) of their intersection points with \\(B C\\) is harmonic. Since \\(M\\) is the midpoint of \\(B C, P Q \\cap B C\\) is an ideal point, i.e., \\(P Q \\| B C\\).)\n\nIt follows from the given equality \\(\\angle P X M=\\angle P Y M\\) that the quadrilateral \\(X Y X^{\\prime} Y^{\\prime}\\) is cyclic. Note that \\(A\\) is the projection of \\(M\\) onto \\(P Q\\). By a known description, \\(A\\) is the Miquel point for the sidelines \\(X Y, X Y^{\\prime}, X^{\\prime} Y, X^{\\prime} Y^{\\prime}\\). In particular, the circle \\(P X Y\\) passes through \\(A\\).\n![](https://cdn.mathpix.com/cropped/2025_08_23_9fba422e6efd92ed50fcg-41.jpg?height=572&width=1014&top_left_y=208&top_left_x=528)\n\nComment 3. An alternative approach is the following. One can note that the (oriented) lengths of the segments \\(C Y\\) and \\(B X\\) are both linear functions of a parameter \\(t=\\cot \\angle P X M\\). As \\(t\\) varies, the intersection point \\(S\\) of the perpendicular bisectors of \\(P X\\) and \\(P Y\\) traces a fixed line, thus the family of circles \\(P X Y\\) has a fixed common point (other than \\(P\\) ). By checking particular cases, one can show that this fixed point is \\(A\\).\n\nComment 4. The problem states that \\(\\angle P X M=\\angle P Y M\\) implies that \\(A P X Y\\) is cyclic. The original submission claims that these two conditions are in fact equivalent. The Problem Selection Committee omitted the converse part, since it follows easily from the direct one, by reversing arguments.", "source_pdf": "imosl_2018.pdf", "notes": "fallback-regex"}
{"id": "IMOSL-2018-G3", "contest": "IMOSL", "year": "2018", "problem_number": "G3", "problem": "A circle \\(\\omega\\) of radius 1 is given. A collection \\(T\\) of triangles is called good, if the following conditions hold:\n(i) each triangle from \\(T\\) is inscribed in \\(\\omega\\);\n(ii) no two triangles from \\(T\\) have a common interior point.\n\nDetermine all positive real numbers \\(t\\) such that, for each positive integer \\(n\\), there exists a good collection of \\(n\\) triangles, each of perimeter greater than \\(t\\).\n(South Africa)", "solution": "Answer: \\(t \\in(0,4]\\).\n\n. First, we show how to construct a good collection of \\(n\\) triangles, each of perimeter greater than 4 . This will show that all \\(t \\leqslant 4\\) satisfy the required conditions.\n\nConstruct inductively an ( \\(n+2\\) )-gon \\(B A_{1} A_{2} \\ldots A_{n} C\\) inscribed in \\(\\omega\\) such that \\(B C\\) is a diameter, and \\(B A_{1} A_{2}, B A_{2} A_{3}, \\ldots, B A_{n-1} A_{n}, B A_{n} C\\) is a good collection of \\(n\\) triangles. For \\(n=1\\), take any triangle \\(B A_{1} C\\) inscribed in \\(\\omega\\) such that \\(B C\\) is a diameter; its perimeter is greater than \\(2 B C=4\\). To perform the inductive step, assume that the \\((n+2)\\)-gon \\(B A_{1} A_{2} \\ldots A_{n} C\\) is already constructed. Since \\(A_{n} B+A_{n} C+B C>4\\), one can choose a point \\(A_{n+1}\\) on the small \\(\\operatorname{arc} \\widehat{C A_{n}}\\), close enough to \\(C\\), so that \\(A_{n} B+A_{n} A_{n+1}+B A_{n+1}\\) is still greater than 4 . Thus each of these new triangles \\(B A_{n} A_{n+1}\\) and \\(B A_{n+1} C\\) has perimeter greater than 4 , which completes the induction step.\n![](https://cdn.mathpix.com/cropped/2025_08_23_9fba422e6efd92ed50fcg-42.jpg?height=360&width=683&top_left_y=1359&top_left_x=691)\n\nWe proceed by showing that no \\(t>4\\) satisfies the conditions of the problem. To this end, we assume that there exists a good collection \\(T\\) of \\(n\\) triangles, each of perimeter greater than \\(t\\), and then bound \\(n\\) from above.\n\nTake \\(\\varepsilon>0\\) such that \\(t=4+2 \\varepsilon\\).\nClaim. There exists a positive constant \\(\\sigma=\\sigma(\\varepsilon)\\) such that any triangle \\(\\Delta\\) with perimeter \\(2 s \\geqslant 4+2 \\varepsilon\\), inscribed in \\(\\omega\\), has area \\(S(\\Delta)\\) at least \\(\\sigma\\).\nProof. Let \\(a, b, c\\) be the side lengths of \\(\\Delta\\). Since \\(\\Delta\\) is inscribed in \\(\\omega\\), each side has length at most 2. Therefore, \\(s-a \\geqslant(2+\\varepsilon)-2=\\varepsilon\\). Similarly, \\(s-b \\geqslant \\varepsilon\\) and \\(s-c \\geqslant \\varepsilon\\). By Heron's formula, \\(S(\\Delta)=\\sqrt{s(s-a)(s-b)(s-c)} \\geqslant \\sqrt{(2+\\varepsilon) \\varepsilon^{3}}\\). Thus we can set \\(\\sigma(\\varepsilon)=\\sqrt{(2+\\varepsilon) \\varepsilon^{3}}\\).\n\nNow we see that the total area \\(S\\) of all triangles from \\(T\\) is at least \\(n \\sigma(\\varepsilon)\\). On the other hand, \\(S\\) does not exceed the area of the disk bounded by \\(\\omega\\). Thus \\(n \\sigma(\\varepsilon) \\leqslant \\pi\\), which means that \\(n\\) is bounded from above.\n\nComment 1. One may prove the Claim using the formula \\(S=\\frac{a b c}{4 R}\\) instead of Heron's formula.\nComment 2. In the statement of the problem condition (i) could be replaced by a weaker one: each triangle from \\(T\\) lies within \\(\\omega\\). This does not affect the solution above, but reduces the number of ways to prove the Claim.", "source_pdf": "imosl_2018.pdf", "notes": "fallback-regex"}
{"id": "IMOSL-2018-G4", "contest": "IMOSL", "year": "2018", "problem_number": "G4", "problem": "A point \\(T\\) is chosen inside a triangle \\(A B C\\). Let \\(A_{1}, B_{1}\\), and \\(C_{1}\\) be the reflections of \\(T\\) in \\(B C, C A\\), and \\(A B\\), respectively. Let \\(\\Omega\\) be the circumcircle of the triangle \\(A_{1} B_{1} C_{1}\\). The lines \\(A_{1} T, B_{1} T\\), and \\(C_{1} T\\) meet \\(\\Omega\\) again at \\(A_{2}, B_{2}\\), and \\(C_{2}\\), respectively. Prove that the lines \\(A A_{2}, B B_{2}\\), and \\(C C_{2}\\) are concurrent on \\(\\Omega\\).\n(Mongolia)", "solution": ". By \\(\\Varangle(\\ell, n)\\) we always mean the directed angle of the lines \\(\\ell\\) and \\(n\\), taken modulo \\(180^{\\circ}\\).\nLet \\(C C_{2}\\) meet \\(\\Omega\\) again at \\(K\\) (as usual, if \\(C C_{2}\\) is tangent to \\(\\Omega\\), we set \\(T=C_{2}\\) ). We show that the line \\(B B_{2}\\) contains \\(K\\); similarly, \\(A A_{2}\\) will also pass through \\(K\\). For this purpose, it suffices to prove that\n\\[\n\\Varangle\\left(C_{2} C, C_{2} A_{1}\\right)=\\Varangle\\left(B_{2} B, B_{2} A_{1}\\right) .\n\\]\n\nBy the problem condition, \\(C B\\) and \\(C A\\) are the perpendicular bisectors of \\(T A_{1}\\) and \\(T B_{1}\\), respectively. Hence, \\(C\\) is the circumcentre of the triangle \\(A_{1} T B_{1}\\). Therefore,\n\\[\n\\Varangle\\left(C A_{1}, C B\\right)=\\Varangle(C B, C T)=\\Varangle\\left(B_{1} A_{1}, B_{1} T\\right)=\\Varangle\\left(B_{1} A_{1}, B_{1} B_{2}\\right) .\n\\]\n\nIn circle \\(\\Omega\\) we have \\(\\Varangle\\left(B_{1} A_{1}, B_{1} B_{2}\\right)=\\Varangle\\left(C_{2} A_{1}, C_{2} B_{2}\\right)\\). Thus,\n\\[\n\\Varangle\\left(C A_{1}, C B\\right)=\\Varangle\\left(B_{1} A_{1}, B_{1} B_{2}\\right)=\\Varangle\\left(C_{2} A_{1}, C_{2} B_{2}\\right) .\n\\]\n\nSimilarly, we get\n\\[\n\\Varangle\\left(B A_{1}, B C\\right)=\\Varangle\\left(C_{1} A_{1}, C_{1} C_{2}\\right)=\\Varangle\\left(B_{2} A_{1}, B_{2} C_{2}\\right) .\n\\]\n\nThe two obtained relations yield that the triangles \\(A_{1} B C\\) and \\(A_{1} B_{2} C_{2}\\) are similar and equioriented, hence\n\\[\n\\frac{A_{1} B_{2}}{A_{1} B}=\\frac{A_{1} C_{2}}{A_{1} C} \\quad \\text { and } \\quad \\Varangle\\left(A_{1} B, A_{1} C\\right)=\\Varangle\\left(A_{1} B_{2}, A_{1} C_{2}\\right) \\text {. }\n\\]\n\nThe second equality may be rewritten as \\(\\Varangle\\left(A_{1} B, A_{1} B_{2}\\right)=\\Varangle\\left(A_{1} C, A_{1} C_{2}\\right)\\), so the triangles \\(A_{1} B B_{2}\\) and \\(A_{1} C C_{2}\\) are also similar and equioriented. This establishes (1).\n![](https://cdn.mathpix.com/cropped/2025_08_23_9fba422e6efd92ed50fcg-44.jpg?height=841&width=1169&top_left_y=1781&top_left_x=448)\n\nComment 1. In fact, the triangle \\(A_{1} B C\\) is an image of \\(A_{1} B_{2} C_{2}\\) under a spiral similarity centred at \\(A_{1}\\); in this case, the triangles \\(A B B_{2}\\) and \\(A C C_{2}\\) are also spirally similar with the same centre.\n\nComment 2. After obtaining (2) and (3), one can finish the solution in different ways.\nFor instance, introducing the point \\(X=B C \\cap B_{2} C_{2}\\), one gets from these relations that the 4-tuples ( \\(A_{1}, B, B_{2}, X\\) ) and ( \\(A_{1}, C, C_{2}, X\\) ) are both cyclic. Therefore, \\(K\\) is the Miquel point of the lines \\(B B_{2}\\), \\(C C_{2}, B C\\), and \\(B_{2} C_{2}\\); this yields that the meeting point of \\(B B_{2}\\) and \\(C C_{2}\\) lies on \\(\\Omega\\).\n\nYet another way is to show that the points \\(A_{1}, B, C\\), and \\(K\\) are concyclic, as\n\\[\n\\Varangle\\left(K C, K A_{1}\\right)=\\Varangle\\left(B_{2} C_{2}, B_{2} A_{1}\\right)=\\Varangle\\left(B C, B A_{1}\\right) .\n\\]\n\nBy symmetry, the second point \\(K^{\\prime}\\) of intersection of \\(B B_{2}\\) with \\(\\Omega\\) is also concyclic to \\(A_{1}, B\\), and \\(C\\), hence \\(K^{\\prime}=K\\).\n![](https://cdn.mathpix.com/cropped/2025_08_23_9fba422e6efd92ed50fcg-45.jpg?height=880&width=1172&top_left_y=688&top_left_x=445)\n\nComment 3. The requirement that the common point of the lines \\(A A_{2}, B B_{2}\\), and \\(C C_{2}\\) should lie on \\(\\Omega\\) may seem to make the problem easier, since it suggests some approaches. On the other hand, there are also different ways of showing that the lines \\(A A_{2}, B B_{2}\\), and \\(C C_{2}\\) are just concurrent.\n\nIn particular, the problem conditions yield that the lines \\(A_{2} T, B_{2} T\\), and \\(C_{2} T\\) are perpendicular to the corresponding sides of the triangle \\(A B C\\). One may show that the lines \\(A T, B T\\), and \\(C T\\) are also perpendicular to the corresponding sides of the triangle \\(A_{2} B_{2} C_{2}\\), i.e., the triangles \\(A B C\\) and \\(A_{2} B_{2} C_{2}\\) are orthologic, and their orthology centres coincide. It is known that such triangles are also perspective, i.e. the lines \\(A A_{2}, B B_{2}\\), and \\(C C_{2}\\) are concurrent (in projective sense).\n\nTo show this mutual orthology, one may again apply angle chasing, but there are also other methods. Let \\(A^{\\prime}, B^{\\prime}\\), and \\(C^{\\prime}\\) be the projections of \\(T\\) onto the sides of the triangle \\(A B C\\). Then \\(A_{2} T \\cdot T A^{\\prime}= B_{2} T \\cdot T B^{\\prime}=C_{2} T \\cdot T C^{\\prime}\\), since all three products equal (minus) half the power of \\(T\\) with respect to \\(\\Omega\\). This means that \\(A_{2}, B_{2}\\), and \\(C_{2}\\) are the poles of the sidelines of the triangle \\(A B C\\) with respect to some circle centred at \\(T\\) and having pure imaginary radius (in other words, the reflections of \\(A_{2}, B_{2}\\), and \\(C_{2}\\) in \\(T\\) are the poles of those sidelines with respect to some regular circle centred at \\(T\\) ). Hence, dually, the vertices of the triangle \\(A B C\\) are also the poles of the sidelines of the triangle \\(A_{2} B_{2} C_{2}\\).", "source_pdf": "imosl_2018.pdf", "notes": "fallback-regex"}
{"id": "IMOSL-2018-G5", "contest": "IMOSL", "year": "2018", "problem_number": "G5", "problem": "Let \\(A B C\\) be a triangle with circumcircle \\(\\omega\\) and incentre \\(I\\). A line \\(\\ell\\) intersects the lines \\(A I, B I\\), and \\(C I\\) at points \\(D, E\\), and \\(F\\), respectively, distinct from the points \\(A, B, C\\), and \\(I\\). The perpendicular bisectors \\(x, y\\), and \\(z\\) of the segments \\(A D, B E\\), and \\(C F\\), respectively determine a triangle \\(\\Theta\\). Show that the circumcircle of the triangle \\(\\Theta\\) is tangent to \\(\\omega\\).\n(Denmark)\n\nPreamble. Let \\(X=y \\cap z, Y=x \\cap z, Z=x \\cap y\\) and let \\(\\Omega\\) denote the circumcircle of the triangle \\(X Y Z\\). Denote by \\(X_{0}, Y_{0}\\), and \\(Z_{0}\\) the second intersection points of \\(A I, B I\\) and \\(C I\\), respectively, with \\(\\omega\\). It is known that \\(Y_{0} Z_{0}\\) is the perpendicular bisector of \\(A I, Z_{0} X_{0}\\) is the perpendicular bisector of \\(B I\\), and \\(X_{0} Y_{0}\\) is the perpendicular bisector of \\(C I\\). In particular, the triangles \\(X Y Z\\) and \\(X_{0} Y_{0} Z_{0}\\) are homothetic, because their corresponding sides are parallel.\n\nThe solutions below mostly exploit the following approach. Consider the triangles XYZ and \\(X_{0} Y_{0} Z_{0}\\), or some other pair of homothetic triangles \\(\\Delta\\) and \\(\\delta\\) inscribed into \\(\\Omega\\) and \\(\\omega\\), respectively. In order to prove that \\(\\Omega\\) and \\(\\omega\\) are tangent, it suffices to show that the centre \\(T\\) of the homothety taking \\(\\Delta\\) to \\(\\delta\\) lies on \\(\\omega\\) (or \\(\\Omega\\) ), or, in other words, to show that \\(\\Delta\\) and \\(\\delta\\) are perspective (i.e., the lines joining corresponding vertices are concurrent), with their perspector lying on \\(\\omega\\) (or \\(\\Omega\\) ).\n\nWe use directed angles throughout all the solutions.", "solution": "1.}\n\nClaim 1. The reflections \\(\\ell_{a}, \\ell_{b}\\) and \\(\\ell_{c}\\) of the line \\(\\ell\\) in the lines \\(x, y\\), and \\(z\\), respectively, are concurrent at a point \\(T\\) which belongs to \\(\\omega\\).\n![](https://cdn.mathpix.com/cropped/2025_08_23_9fba422e6efd92ed50fcg-46.jpg?height=826&width=915&top_left_y=1342&top_left_x=576)\n\nProof. Notice that \\(\\Varangle\\left(\\ell_{b}, \\ell_{c}\\right)=\\Varangle\\left(\\ell_{b}, \\ell\\right)+\\Varangle\\left(\\ell, \\ell_{c}\\right)=2 \\Varangle(y, \\ell)+2 \\Varangle(\\ell, z)=2 \\Varangle(y, z)\\). But \\(y \\perp B I\\) and \\(z \\perp C I\\) implies \\(\\Varangle(y, z)=\\Varangle(B I, I C)\\), so, since \\(2 \\Varangle(B I, I C)=\\Varangle(B A, A C)\\), we obtain\n\\[\n\\Varangle\\left(\\ell_{b}, \\ell_{c}\\right)=\\Varangle(B A, A C) .\n\\]\n\nSince \\(A\\) is the reflection of \\(D\\) in \\(x, A\\) belongs to \\(\\ell_{a}\\); similarly, \\(B\\) belongs to \\(\\ell_{b}\\). Then (1) shows that the common point \\(T^{\\prime}\\) of \\(\\ell_{a}\\) and \\(\\ell_{b}\\) lies on \\(\\omega\\); similarly, the common point \\(T^{\\prime \\prime}\\) of \\(\\ell_{c}\\) and \\(\\ell_{b}\\) lies on \\(\\omega\\).\n\nIf \\(B \\notin \\ell_{a}\\) and \\(B \\notin \\ell_{c}\\), then \\(T^{\\prime}\\) and \\(T^{\\prime \\prime}\\) are the second point of intersection of \\(\\ell_{b}\\) and \\(\\omega\\), hence they coincide. Otherwise, if, say, \\(B \\in \\ell_{c}\\), then \\(\\ell_{c}=B C\\), so \\(\\Varangle(B A, A C)=\\Varangle\\left(\\ell_{b}, \\ell_{c}\\right)=\\Varangle\\left(\\ell_{b}, B C\\right)\\), which shows that \\(\\ell_{b}\\) is tangent at \\(B\\) to \\(\\omega\\) and \\(T^{\\prime}=T^{\\prime \\prime}=B\\). So \\(T^{\\prime}\\) and \\(T^{\\prime \\prime}\\) coincide in all the cases, and the conclusion of the claim follows.\n\nNow we prove that \\(X, X_{0}, T\\) are collinear. Denote by \\(D_{b}\\) and \\(D_{c}\\) the reflections of the point \\(D\\) in the lines \\(y\\) and \\(z\\), respectively. Then \\(D_{b}\\) lies on \\(\\ell_{b}, D_{c}\\) lies on \\(\\ell_{c}\\), and\n\\[\n\\begin{aligned}\n\\Varangle\\left(D_{b} X, X D_{c}\\right) & =\\Varangle\\left(D_{b} X, D X\\right)+\\Varangle\\left(D X, X D_{c}\\right)=2 \\Varangle(y, D X)+2 \\Varangle(D X, z)=2 \\Varangle(y, z) \\\\\n& =\\Varangle(B A, A C)=\\Varangle(B T, T C),\n\\end{aligned}\n\\]\nhence the quadrilateral \\(X D_{b} T D_{c}\\) is cyclic. Notice also that since \\(X D_{b}=X D=X D_{c}\\), the points \\(D, D_{b}, D_{c}\\) lie on a circle with centre \\(X\\). Using in this circle the diameter \\(D_{c} D_{c}^{\\prime}\\) yields \\(\\Varangle\\left(D_{b} D_{c}, D_{c} X\\right)=90^{\\circ}+\\Varangle\\left(D_{b} D_{c}^{\\prime}, D_{c}^{\\prime} X\\right)=90^{\\circ}+\\Varangle\\left(D_{b} D, D D_{c}\\right)\\). Therefore,\n\\[\n\\begin{gathered}\n\\Varangle\\left(\\ell_{b}, X T\\right)=\\Varangle\\left(D_{b} T, X T\\right)=\\Varangle\\left(D_{b} D_{c}, D_{c} X\\right)=90^{\\circ}+\\Varangle\\left(D_{b} D, D D_{c}\\right) \\\\\n=90^{\\circ}+\\Varangle(B I, I C)=\\Varangle(B A, A I)=\\Varangle\\left(B A, A X_{0}\\right)=\\Varangle\\left(B T, T X_{0}\\right)=\\Varangle\\left(\\ell_{b}, X_{0} T\\right),\n\\end{gathered}\n\\]\nso the points \\(X, X_{0}, T\\) are collinear. By a similar argument, \\(Y, Y_{0}, T\\) and \\(Z, Z_{0}, T\\) are collinear. As mentioned in the preamble, the statement of the problem follows.\n\nComment 1. After proving Claim 1 one may proceed in another way. As it was shown, the reflections of \\(\\ell\\) in the sidelines of \\(X Y Z\\) are concurrent at \\(T\\). Thus \\(\\ell\\) is the Steiner line of \\(T\\) with respect to \\(\\triangle X Y Z\\) (that is the line containing the reflections \\(T_{a}, T_{b}, T_{c}\\) of \\(T\\) in the sidelines of \\(X Y Z\\) ). The properties of the Steiner line imply that \\(T\\) lies on \\(\\Omega\\), and \\(\\ell\\) passes through the orthocentre \\(H\\) of the triangle \\(X Y Z\\).\n![](https://cdn.mathpix.com/cropped/2025_08_23_9fba422e6efd92ed50fcg-47.jpg?height=809&width=1303&top_left_y=1250&top_left_x=382)\n\nLet \\(H_{a}, H_{b}\\), and \\(H_{c}\\) be the reflections of the point \\(H\\) in the lines \\(x, y\\), and \\(z\\), respectively. Then the triangle \\(H_{a} H_{b} H_{c}\\) is inscribed in \\(\\Omega\\) and homothetic to \\(A B C\\) (by an easy angle chasing). Since \\(H_{a} \\in \\ell_{a}, H_{b} \\in \\ell_{b}\\), and \\(H_{c} \\in \\ell_{c}\\), the triangles \\(H_{a} H_{b} H_{c}\\) and \\(A B C\\) form a required pair of triangles \\(\\Delta\\) and \\(\\delta\\) mentioned in the preamble.\n\nComment 2. The following observation shows how one may guess the description of the tangency point \\(T\\) from Solution 1.\n\nLet us fix a direction and move the line \\(\\ell\\) parallel to this direction with constant speed.\nThen the points \\(D, E\\), and \\(F\\) are moving with constant speeds along the lines \\(A I, B I\\), and \\(C I\\), respectively. In this case \\(x, y\\), and \\(z\\) are moving with constant speeds, defining a family of homothetic triangles \\(X Y Z\\) with a common centre of homothety \\(T\\). Notice that the triangle \\(X_{0} Y_{0} Z_{0}\\) belongs to this family (for \\(\\ell\\) passing through \\(I\\) ). We may specify the location of \\(T\\) considering the degenerate case when \\(x, y\\), and \\(z\\) are concurrent. In this degenerate case all the lines \\(x, y, z, \\ell, \\ell_{a}, \\ell_{b}, \\ell_{c}\\) have a common point. Note that the lines \\(\\ell_{a}, \\ell_{b}, \\ell_{c}\\) remain constant as \\(\\ell\\) is moving (keeping its direction). Thus \\(T\\) should be the common point of \\(\\ell_{a}, \\ell_{b}\\), and \\(\\ell_{c}\\), lying on \\(\\omega\\).\n\nSolution 2. As mentioned in the preamble, it is sufficient to prove that the centre \\(T\\) of the homothety taking \\(X Y Z\\) to \\(X_{0} Y_{0} Z_{0}\\) belongs to \\(\\omega\\). Thus, it suffices to prove that \\(\\Varangle\\left(T X_{0}, T Y_{0}\\right)= \\Varangle\\left(Z_{0} X_{0}, Z_{0} Y_{0}\\right)\\), or, equivalently, \\(\\Varangle\\left(X X_{0}, Y Y_{0}\\right)=\\Varangle\\left(Z_{0} X_{0}, Z_{0} Y_{0}\\right)\\) \u3002\n\nRecall that \\(Y Z\\) and \\(Y_{0} Z_{0}\\) are the perpendicular bisectors of \\(A D\\) and \\(A I\\), respectively. Then, the vector \\(\\vec{x}\\) perpendicular to \\(Y Z\\) and shifting the line \\(Y_{0} Z_{0}\\) to \\(Y Z\\) is equal to \\(\\frac{1}{2} \\overrightarrow{I D}\\). Define the shifting vectors \\(\\vec{y}=\\frac{1}{2} \\overrightarrow{I E}, \\vec{z}=\\frac{1}{2} \\overrightarrow{I F}\\) similarly. Consider now the triangle \\(U V W\\) formed by the perpendiculars to \\(A I, B I\\), and \\(C I\\) through \\(D, E\\), and \\(F\\), respectively (see figure below). This is another triangle whose sides are parallel to the corresponding sides of \\(X Y Z\\).\nClaim 2. \\(\\overrightarrow{I U}=2 \\overrightarrow{X_{0} X}, \\overrightarrow{I V}=2 \\overrightarrow{Y_{0} Y}, \\overrightarrow{I W}=2 \\overrightarrow{Z_{0} Z}\\).\nProof. We prove one of the relations, the other proofs being similar. To prove the equality of two vectors it suffices to project them onto two non-parallel axes and check that their projections are equal.\n\nThe projection of \\(\\overrightarrow{X_{0} X}\\) onto \\(I B\\) equals \\(\\vec{y}\\), while the projection of \\(\\overrightarrow{I U}\\) onto \\(I B\\) is \\(\\overrightarrow{I E}=2 \\vec{y}\\). The projections onto the other axis \\(I C\\) are \\(\\vec{z}\\) and \\(\\overrightarrow{I F}=2 \\vec{z}\\). Then \\(\\overrightarrow{I U}=2 \\overrightarrow{X_{0} X}\\) follows.\n\nNotice that the line \\(\\ell\\) is the Simson line of the point \\(I\\) with respect to the triangle \\(U V W\\); thus \\(U, V, W\\), and \\(I\\) are concyclic. It follows from Claim 2 that \\(\\Varangle\\left(X X_{0}, Y Y_{0}\\right)=\\Varangle(I U, I V)= \\Varangle(W U, W V)=\\Varangle\\left(Z_{0} X_{0}, Z_{0} Y_{0}\\right)\\), and we are done.\n![](https://cdn.mathpix.com/cropped/2025_08_23_9fba422e6efd92ed50fcg-48.jpg?height=881&width=1095&top_left_y=1167&top_left_x=485)\n\nSolution 3. Let \\(I_{a}, I_{b}\\), and \\(I_{c}\\) be the excentres of triangle \\(A B C\\) corresponding to \\(A, B\\), and \\(C\\), respectively. Also, let \\(u, v\\), and \\(w\\) be the lines through \\(D, E\\), and \\(F\\) which are perpendicular to \\(A I, B I\\), and \\(C I\\), respectively, and let \\(U V W\\) be the triangle determined by these lines, where \\(u=V W, v=U W\\) and \\(w=U V\\) (see figure above).\n\nNotice that the line \\(u\\) is the reflection of \\(I_{b} I_{c}\\) in the line \\(x\\), because \\(u, x\\), and \\(I_{b} I_{c}\\) are perpendicular to \\(A D\\) and \\(x\\) is the perpendicular bisector of \\(A D\\). Likewise, \\(v\\) and \\(I_{a} I_{c}\\) are reflections of each other in \\(y\\), while \\(w\\) and \\(I_{a} I_{b}\\) are reflections of each other in \\(z\\). It follows that \\(X, Y\\), and \\(Z\\) are the midpoints of \\(U I_{a}, V I_{b}\\) and \\(W I_{c}\\), respectively, and that the triangles \\(U V W\\), \\(X Y Z\\) and \\(I_{a} I_{b} I_{c}\\) are either translates of each other or homothetic with a common homothety centre.\n\nConstruct the points \\(T\\) and \\(S\\) such that the quadrilaterals \\(U V I W, X Y T Z\\) and \\(I_{a} I_{b} S I_{c}\\) are homothetic. Then \\(T\\) is the midpoint of \\(I S\\). Moreover, note that \\(\\ell\\) is the Simson line of the point \\(I\\) with respect to the triangle \\(U V W\\), hence \\(I\\) belongs to the circumcircle of the triangle \\(U V W\\), therefore \\(T\\) belongs to \\(\\Omega\\).\n\nConsider now the homothety or translation \\(h_{1}\\) that maps \\(X Y Z T\\) to \\(I_{a} I_{b} I_{c} S\\) and the homothety \\(h_{2}\\) with centre \\(I\\) and factor \\(\\frac{1}{2}\\). Furthermore, let \\(h=h_{2} \\circ h_{1}\\). The transform \\(h\\) can be a homothety or a translation, and\n\\[\nh(T)=h_{2}\\left(h_{1}(T)\\right)=h_{2}(S)=T\n\\]\nhence \\(T\\) is a fixed point of \\(h\\). So, \\(h\\) is a homothety with centre \\(T\\). Note that \\(h_{2}\\) maps the excentres \\(I_{a}, I_{b}, I_{c}\\) to \\(X_{0}, Y_{0}, Z_{0}\\) defined in the preamble. Thus the centre \\(T\\) of the homothety taking \\(X Y Z\\) to \\(X_{0} Y_{0} Z_{0}\\) belongs to \\(\\Omega\\), and this completes the proof.", "source_pdf": "imosl_2018.pdf", "notes": "fallback-regex"}
{"id": "IMOSL-2018-G7", "contest": "IMOSL", "year": "2018", "problem_number": "G7", "problem": "Let \\(O\\) be the circumcentre, and \\(\\Omega\\) be the circumcircle of an acute-angled triangle \\(A B C\\). Let \\(P\\) be an arbitrary point on \\(\\Omega\\), distinct from \\(A, B, C\\), and their antipodes in \\(\\Omega\\). Denote the circumcentres of the triangles \\(A O P, B O P\\), and \\(C O P\\) by \\(O_{A}, O_{B}\\), and \\(O_{C}\\), respectively. The lines \\(\\ell_{A}, \\ell_{B}\\), and \\(\\ell_{C}\\) perpendicular to \\(B C, C A\\), and \\(A B\\) pass through \\(O_{A}, O_{B}\\), and \\(O_{C}\\), respectively. Prove that the circumcircle of the triangle formed by \\(\\ell_{A}, \\ell_{B}\\), and \\(\\ell_{C}\\) is tangent to the line \\(O P\\).\n(Russia)", "solution": ". As usual, we denote the directed angle between the lines \\(a\\) and \\(b\\) by \\(\\Varangle(a, b)\\). We frequently use the fact that \\(a_{1} \\perp a_{2}\\) and \\(b_{1} \\perp b_{2}\\) yield \\(\\Varangle\\left(a_{1}, b_{1}\\right)=\\Varangle\\left(a_{2}, b_{2}\\right)\\).\n\nLet the lines \\(\\ell_{B}\\) and \\(\\ell_{C}\\) meet at \\(L_{A}\\); define the points \\(L_{B}\\) and \\(L_{C}\\) similarly. Note that the sidelines of the triangle \\(L_{A} L_{B} L_{C}\\) are perpendicular to the corresponding sidelines of \\(A B C\\). Points \\(O_{A}, O_{B}, O_{C}\\) are located on the corresponding sidelines of \\(L_{A} L_{B} L_{C}\\); moreover, \\(O_{A}, O_{B}\\), \\(O_{C}\\) all lie on the perpendicular bisector of \\(O P\\).\n![](https://cdn.mathpix.com/cropped/2025_08_23_9fba422e6efd92ed50fcg-54.jpg?height=1012&width=1363&top_left_y=902&top_left_x=348)\n\nClaim 1. The points \\(L_{B}, P, O_{A}\\), and \\(O_{C}\\) are concyclic.\nProof. Since \\(O\\) is symmetric to \\(P\\) in \\(O_{A} O_{C}\\), we have\n\\[\n\\Varangle\\left(O_{A} P, O_{C} P\\right)=\\Varangle\\left(O_{C} O, O_{A} O\\right)=\\Varangle(C P, A P)=\\Varangle(C B, A B)=\\Varangle\\left(O_{A} L_{B}, O_{C} L_{B}\\right) .\n\\]\n\nDenote the circle through \\(L_{B}, P, O_{A}\\) and \\(O_{C}\\) by \\(\\omega_{B}\\). Define the circles \\(\\omega_{A}\\) and \\(\\omega_{C}\\) similarly. Claim 2. The circumcircle of the triangle \\(L_{A} L_{B} L_{C}\\) passes through \\(P\\).\nProof. From cyclic quadruples of points in the circles \\(\\omega_{B}\\) and \\(\\omega_{C}\\), we have\n\\[\n\\begin{aligned}\n\\Varangle\\left(L_{C} L_{A}, L_{C} P\\right) & =\\Varangle\\left(L_{C} O_{B}, L_{C} P\\right)=\\Varangle\\left(O_{A} O_{B}, O_{A} P\\right) \\\\\n& =\\Varangle\\left(O_{A} O_{C}, O_{A} P\\right)=\\Varangle\\left(L_{B} O_{C}, L_{B} P\\right)=\\Varangle\\left(L_{B} L_{A}, L_{B} P\\right) .\n\\end{aligned}\n\\]\n\nClaim 3. The points \\(P, L_{C}\\), and \\(C\\) are collinear.\nProof. We have \\(\\Varangle\\left(P L_{C}, L_{C} L_{A}\\right)=\\Varangle\\left(P L_{C}, L_{C} O_{B}\\right)=\\Varangle\\left(P O_{A}, O_{A} O_{B}\\right)\\). Further, since \\(O_{A}\\) is the centre of the circle \\(A O P\\), \\(\\Varangle\\left(P O_{A}, O_{A} O_{B}\\right)=\\Varangle(P A, A O)\\). As \\(O\\) is the circumcentre of the triangle \\(P C A\\), \\(\\Varangle(P A, A O)=\\pi / 2-\\Varangle(C A, C P)=\\Varangle\\left(C P, L_{C} L_{A}\\right)\\). We obtain \\(\\Varangle\\left(P L_{C}, L_{C} L_{A}\\right)= \\Varangle\\left(C P, L_{C} L_{A}\\right)\\), which shows that \\(P \\in C L_{C}\\).\n\nSimilarly, the points \\(P, L_{A}, A\\) are collinear, and the points \\(P, L_{B}, B\\) are also collinear.\nFinally, the computation above also shows that\n\\[\n\\Varangle\\left(O P, P L_{A}\\right)=\\Varangle(P A, A O)=\\Varangle\\left(P L_{C}, L_{C} L_{A}\\right),\n\\]\nwhich means that \\(O P\\) is tangent to the circle \\(P L_{A} L_{B} L_{C}\\).\n\nComment 1. The proof of Claim 2 may be replaced by the following remark: since \\(P\\) belongs to the circles \\(\\omega_{A}\\) and \\(\\omega_{C}, P\\) is the Miquel point of the four lines \\(\\ell_{A}, \\ell_{B}, \\ell_{C}\\), and \\(O_{A} O_{B} O_{C}\\).\n\nComment 2. Claims 2 and 3 can be proved in several different ways and, in particular, in the reverse order.\n\nClaim 3 implies that the triangles \\(A B C\\) and \\(L_{A} L_{B} L_{C}\\) are perspective with perspector \\(P\\). Claim 2 can be derived from this observation using spiral similarity. Consider the centre \\(Q\\) of the spiral similarity that maps \\(A B C\\) to \\(L_{A} L_{B} L_{C}\\). From known spiral similarity properties, the points \\(L_{A}, L_{B}, P, Q\\) are concyclic, and so are \\(L_{A}, L_{C}, P, Q\\).\n\nComment 3. The final conclusion can also be proved it terms of spiral similarity: the spiral similarity with centre \\(Q\\) located on the circle \\(A B C\\) maps the circle \\(A B C\\) to the circle \\(P L_{A} L_{B} L_{C}\\). Thus these circles are orthogonal.\n\nComment 4. Notice that the homothety with centre \\(O\\) and ratio 2 takes \\(O_{A}\\) to \\(A^{\\prime}\\) that is the common point of tangents to \\(\\Omega\\) at \\(A\\) and \\(P\\). Similarly, let this homothety take \\(O_{B}\\) to \\(B^{\\prime}\\) and \\(O_{C}\\) to \\(C^{\\prime}\\). Let the tangents to \\(\\Omega\\) at \\(B\\) and \\(C\\) meet at \\(A^{\\prime \\prime}\\), and define the points \\(B^{\\prime \\prime}\\) and \\(C^{\\prime \\prime}\\) similarly. Now, replacing labels \\(O\\) with \\(I, \\Omega\\) with \\(\\omega\\), and swapping labels \\(A \\leftrightarrow A^{\\prime \\prime}, B \\leftrightarrow B^{\\prime \\prime}, C \\leftrightarrow C^{\\prime \\prime}\\) we obtain the following\n\nReformulation. Let \\(\\omega\\) be the incircle, and let \\(I\\) be the incentre of a triangle \\(A B C\\). Let \\(P\\) be a point of \\(\\omega\\) (other than the points of contact of \\(\\omega\\) with the sides of \\(A B C\\) ). The tangent to \\(\\omega\\) at \\(P\\) meets the lines \\(A B, B C\\), and \\(C A\\) at \\(A^{\\prime}, B^{\\prime}\\), and \\(C^{\\prime}\\), respectively. Line \\(\\ell_{A}\\) parallel to the internal angle bisector of \\(\\angle B A C\\) passes through \\(A^{\\prime}\\); define lines \\(\\ell_{B}\\) and \\(\\ell_{C}\\) similarly. Prove that the line \\(I P\\) is tangent to the circumcircle of the triangle formed by \\(\\ell_{A}, \\ell_{B}\\), and \\(\\ell_{C}\\).\n\nThough this formulation is equivalent to the original one, it seems more challenging, since the point of contact is now \"hidden\".", "source_pdf": "imosl_2018.pdf", "notes": "fallback-regex"}
{"id": "IMOSL-2018-N1", "contest": "IMOSL", "year": "2018", "problem_number": "N1", "problem": "Determine all pairs \\((n, k)\\) of distinct positive integers such that there exists a positive integer \\(s\\) for which the numbers of divisors of \\(s n\\) and of \\(s k\\) are equal.\n(Ukraine)", "solution": "Answer: All pairs \\((n, k)\\) such that \\(n \\nmid k\\) and \\(k \\nmid n\\).\n\n. As usual, the number of divisors of a positive integer \\(n\\) is denoted by \\(d(n)\\). If \\(n=\\prod_{i} p_{i}^{\\alpha_{i}}\\) is the prime factorisation of \\(n\\), then \\(d(n)=\\prod_{i}\\left(\\alpha_{i}+1\\right)\\).\n\nWe start by showing that one cannot find any suitable number \\(s\\) if \\(k \\mid n\\) or \\(n \\mid k\\) (and \\(k \\neq n\\) ). Suppose that \\(n \\mid k\\), and choose any positive integer \\(s\\). Then the set of divisors of \\(s n\\) is a proper subset of that of \\(s k\\), hence \\(d(s n)<d(s k)\\). Therefore, the pair \\((n, k)\\) does not satisfy the problem requirements. The case \\(k \\mid n\\) is similar.\n\nNow assume that \\(n \\nmid k\\) and \\(k \\nmid n\\). Let \\(p_{1}, \\ldots, p_{t}\\) be all primes dividing \\(n k\\), and consider the prime factorisations\n\\[\nn=\\prod_{i=1}^{t} p_{i}^{\\alpha_{i}} \\quad \\text { and } \\quad k=\\prod_{i=1}^{t} p_{i}^{\\beta_{i}}\n\\]\n\nIt is reasonable to search for the number \\(s\\) having the form\n\\[\ns=\\prod_{i=1}^{t} p_{i}^{\\gamma_{i}}\n\\]\n\nThe (nonnegative integer) exponents \\(\\gamma_{i}\\) should be chosen so as to satisfy\n\\[\n\\frac{d(s n)}{d(s k)}=\\prod_{i=1}^{t} \\frac{\\alpha_{i}+\\gamma_{i}+1}{\\beta_{i}+\\gamma_{i}+1}=1\n\\]\n\nFirst of all, if \\(\\alpha_{i}=\\beta_{i}\\) for some \\(i\\), then, regardless of the value of \\(\\gamma_{i}\\), the corresponding factor in (1) equals 1 and does not affect the product. So we may assume that there is no such index \\(i\\). For the other factors in (1), the following lemma is useful.\nLemma. Let \\(\\alpha>\\beta\\) be nonnegative integers. Then, for every integer \\(M \\geqslant \\beta+1\\), there exists a nonnegative integer \\(\\gamma\\) such that\n\\[\n\\frac{\\alpha+\\gamma+1}{\\beta+\\gamma+1}=1+\\frac{1}{M}=\\frac{M+1}{M}\n\\]\n\nProof.\n\\[\n\\frac{\\alpha+\\gamma+1}{\\beta+\\gamma+1}=1+\\frac{1}{M} \\Longleftrightarrow \\frac{\\alpha-\\beta}{\\beta+\\gamma+1}=\\frac{1}{M} \\Longleftrightarrow \\gamma=M(\\alpha-\\beta)-(\\beta+1) \\geqslant 0 .\n\\]\n\nNow we can finish the solution. Without loss of generality, there exists an index \\(u\\) such that \\(\\alpha_{i}>\\beta_{i}\\) for \\(i=1,2, \\ldots, u\\), and \\(\\alpha_{i}<\\beta_{i}\\) for \\(i=u+1, \\ldots, t\\). The conditions \\(n \\nmid k\\) and \\(k \\nmid n\\) mean that \\(1 \\leqslant u \\leqslant t-1\\).\n\nChoose an integer \\(X\\) greater than all the \\(\\alpha_{i}\\) and \\(\\beta_{i}\\). By the lemma, we can define the numbers \\(\\gamma_{i}\\) so as to satisfy\n\\[\n\\begin{array}{ll}\n\\frac{\\alpha_{i}+\\gamma_{i}+1}{\\beta_{i}+\\gamma_{i}+1}=\\frac{u X+i}{u X+i-1} & \\text { for } i=1,2, \\ldots, u, \\text { and } \\\\\n\\frac{\\beta_{u+i}+\\gamma_{u+i}+1}{\\alpha_{u+i}+\\gamma_{u+i}+1}=\\frac{(t-u) X+i}{(t-u) X+i-1} & \\text { for } i=1,2, \\ldots, t-u\n\\end{array}\n\\]\n\nThen we will have\n\\[\n\\frac{d(s n)}{d(s k)}=\\prod_{i=1}^{u} \\frac{u X+i}{u X+i-1} \\cdot \\prod_{i=1}^{t-u} \\frac{(t-u) X+i-1}{(t-u) X+i}=\\frac{u(X+1)}{u X} \\cdot \\frac{(t-u) X}{(t-u)(X+1)}=1,\n\\]\nas required.\nComment. The lemma can be used in various ways, in order to provide a suitable value of \\(s\\). In particular, one may apply induction on the number \\(t\\) of prime factors, using identities like\n\\[\n\\frac{n}{n-1}=\\frac{n^{2}}{n^{2}-1} \\cdot \\frac{n+1}{n}\n\\]", "source_pdf": "imosl_2018.pdf", "notes": "fallback-regex"}
{"id": "IMOSL-2018-N2", "contest": "IMOSL", "year": "2018", "problem_number": "N2", "problem": "Let \\(n>1\\) be a positive integer. Each cell of an \\(n \\times n\\) table contains an integer. Suppose that the following conditions are satisfied:\n(i) Each number in the table is congruent to 1 modulo \\(n\\);\n(ii) The sum of numbers in any row, as well as the sum of numbers in any column, is congruent to \\(n\\) modulo \\(n^{2}\\).\n\nLet \\(R_{i}\\) be the product of the numbers in the \\(i^{\\text {th }}\\) row, and \\(C_{j}\\) be the product of the numbers in the \\(j^{\\text {th }}\\) column. Prove that the sums \\(R_{1}+\\cdots+R_{n}\\) and \\(C_{1}+\\cdots+C_{n}\\) are congruent modulo \\(n^{4}\\).\n(Indonesia)", "solution": "1. Let \\(A_{i, j}\\) be the entry in the \\(i^{\\text {th }}\\) row and the \\(j^{\\text {th }}\\) column; let \\(P\\) be the product of all \\(n^{2}\\) entries. For convenience, denote \\(a_{i, j}=A_{i, j}-1\\) and \\(r_{i}=R_{i}-1\\). We show that\n\\[\n\\sum_{i=1}^{n} R_{i} \\equiv(n-1)+P \\quad\\left(\\bmod n^{4}\\right)\n\\]\n\nDue to symmetry of the problem conditions, the sum of all the \\(C_{j}\\) is also congruent to \\((n-1)+P\\) modulo \\(n^{4}\\), whence the conclusion.\n\nBy condition \\((i)\\), the number \\(n\\) divides \\(a_{i, j}\\) for all \\(i\\) and \\(j\\). So, every product of at least two of the \\(a_{i, j}\\) is divisible by \\(n^{2}\\), hence\n\\(R_{i}=\\prod_{j=1}^{n}\\left(1+a_{i, j}\\right)=1+\\sum_{j=1}^{n} a_{i, j}+\\sum_{1 \\leqslant j_{1}<j_{2} \\leqslant n} a_{i, j_{1}} a_{i, j_{2}}+\\cdots \\equiv 1+\\sum_{j=1}^{n} a_{i, j} \\equiv 1-n+\\sum_{j=1}^{n} A_{i, j} \\quad\\left(\\bmod n^{2}\\right)\\)\nfor every index \\(i\\). Using condition (ii), we obtain \\(R_{i} \\equiv 1\\left(\\bmod n^{2}\\right)\\), and so \\(n^{2} \\mid r_{i}\\).\nTherefore, every product of at least two of the \\(r_{i}\\) is divisible by \\(n^{4}\\). Repeating the same argument, we obtain\n\\[\nP=\\prod_{i=1}^{n} R_{i}=\\prod_{i=1}^{n}\\left(1+r_{i}\\right) \\equiv 1+\\sum_{i=1}^{n} r_{i} \\quad\\left(\\bmod n^{4}\\right),\n\\]\nwhence\n\\[\n\\sum_{i=1}^{n} R_{i}=n+\\sum_{i=1}^{n} r_{i} \\equiv n+(P-1) \\quad\\left(\\bmod n^{4}\\right)\n\\]\nas desired.\n\nComment. The original version of the problem statement contained also the condition\n(iii) The product of all the numbers in the table is congruent to 1 modulo \\(n^{4}\\).\n\nThis condition appears to be superfluous, so it was omitted.\nSolution 2. We present a more straightforward (though lengthier) way to establish (1). We also use the notation of \\(a_{i, j}\\).\n\nBy condition \\((i)\\), all the \\(a_{i, j}\\) are divisible by \\(n\\). Therefore, we have\n\\[\n\\begin{aligned}\nP=\\prod_{i=1}^{n} \\prod_{j=1}^{n}\\left(1+a_{i, j}\\right) \\equiv 1+\\sum_{(i, j)} a_{i, j} & +\\sum_{\\left(i_{1}, j_{1}\\right),\\left(i_{2}, j_{2}\\right)} a_{i_{1}, j_{1}} a_{i_{2}, j_{2}} \\\\\n& +\\sum_{\\left(i_{1}, j_{1}\\right),\\left(i_{2}, j_{2}\\right),\\left(i_{3}, j_{3}\\right)} a_{i_{1}, j_{1}} a_{i_{2}, j_{2}} a_{i_{3}, j_{3}} \\quad\\left(\\bmod n^{4}\\right),\n\\end{aligned}\n\\]\nwhere the last two sums are taken over all unordered pairs/triples of pairwise different pairs \\((i, j)\\); such conventions are applied throughout the solution.\n\nSimilarly,\n\\[\n\\sum_{i=1}^{n} R_{i}=\\sum_{i=1}^{n} \\prod_{j=1}^{n}\\left(1+a_{i, j}\\right) \\equiv n+\\sum_{i} \\sum_{j} a_{i, j}+\\sum_{i} \\sum_{j_{1}, j_{2}} a_{i, j_{1}} a_{i, j_{2}}+\\sum_{i} \\sum_{j_{1}, j_{2}, j_{3}} a_{i, j_{1}} a_{i, j_{2}} a_{i, j_{3}} \\quad\\left(\\bmod n^{4}\\right) .\n\\]\n\nTherefore,\n\\[\n\\begin{aligned}\nP+(n-1)-\\sum_{i} R_{i} \\equiv \\sum_{\\substack{\\left(i_{1}, j_{1}\\right),\\left(i_{2}, j_{2}\\right) \\\\\ni_{1} \\neq i_{2}}} a_{i_{1}, j_{1}} a_{i_{2}, j_{2}} & +\\sum_{\\substack{\\left(i_{1}, j_{1}\\right),\\left(i_{2}, j_{2}\\right),\\left(i_{3}, j_{3}\\right) \\\\\ni_{1} \\neq i_{2} \\neq i_{3} \\neq i_{1}}} a_{i_{1}, j_{1}} a_{i_{2}, j_{2}} a_{i_{3}, j_{3}} \\\\\n& +\\sum_{\\substack{\\left(i_{1}, j_{1}\\right),\\left(i_{2}, j_{2}\\right),\\left(i_{3}, j_{3}\\right) \\\\\ni_{1} \\neq i_{2}=i_{3}}} a_{i_{1}, j_{1}} a_{i_{2}, j_{2}} a_{i_{3}, j_{3}} \\quad\\left(\\bmod n^{4}\\right) .\n\\end{aligned}\n\\]\n\nWe show that in fact each of the three sums appearing in the right-hand part of this congruence is divisible by \\(n^{4}\\); this yields (1). Denote those three sums by \\(\\Sigma_{1}, \\Sigma_{2}\\), and \\(\\Sigma_{3}\\) in order of appearance. Recall that by condition (ii) we have\n\\[\n\\sum_{j} a_{i, j} \\equiv 0 \\quad\\left(\\bmod n^{2}\\right) \\quad \\text { for all indices } i\n\\]\n\nFor every two indices \\(i_{1}<i_{2}\\) we have\n\\[\n\\sum_{j_{1}} \\sum_{j_{2}} a_{i_{1}, j_{1}} a_{i_{2}, j_{2}}=\\left(\\sum_{j_{1}} a_{i_{1}, j_{1}}\\right) \\cdot\\left(\\sum_{j_{2}} a_{i_{2}, j_{2}}\\right) \\equiv 0 \\quad\\left(\\bmod n^{4}\\right),\n\\]\nsince each of the two factors is divisible by \\(n^{2}\\). Summing over all pairs ( \\(i_{1}, i_{2}\\) ) we obtain \\(n^{4} \\mid \\Sigma_{1}\\).\nSimilarly, for every three indices \\(i_{1}<i_{2}<i_{3}\\) we have\n\\[\n\\sum_{j_{1}} \\sum_{j_{2}} \\sum_{j_{3}} a_{i_{1}, j_{1}} a_{i_{2}, j_{2}} a_{i_{3}, j_{3}}=\\left(\\sum_{j_{1}} a_{i_{1}, j_{1}}\\right) \\cdot\\left(\\sum_{j_{2}} a_{i_{2}, j_{2}}\\right) \\cdot\\left(\\sum_{j_{3}} a_{i_{3}, j_{3}}\\right)\n\\]\nwhich is divisible even by \\(n^{6}\\). Hence \\(n^{4} \\mid \\Sigma_{2}\\).\nFinally, for every indices \\(i_{1} \\neq i_{2}=i_{3}\\) and \\(j_{2}<j_{3}\\) we have\n\\[\na_{i_{2}, j_{2}} \\cdot a_{i_{2}, j_{3}} \\cdot \\sum_{j_{1}} a_{i_{1}, j_{1}} \\equiv 0 \\quad\\left(\\bmod n^{4}\\right)\n\\]\nsince the three factors are divisible by \\(n, n\\), and \\(n^{2}\\), respectively. Summing over all 4 -tuples of indices ( \\(i_{1}, i_{2}, j_{2}, j_{3}\\) ) we get \\(n^{4} \\mid \\Sigma_{3}\\).", "source_pdf": "imosl_2018.pdf", "notes": "fallback-regex"}
{"id": "IMOSL-2018-N3", "contest": "IMOSL", "year": "2018", "problem_number": "N3", "problem": "Define the sequence \\(a_{0}, a_{1}, a_{2}, \\ldots\\) by \\(a_{n}=2^{n}+2^{\\lfloor n / 2\\rfloor}\\). Prove that there are infinitely many terms of the sequence which can be expressed as a sum of (two or more) distinct terms of the sequence, as well as infinitely many of those which cannot be expressed in such a way.\n(Serbia)", "solution": "1. Call a nonnegative integer representable if it equals the sum of several (possibly 0 or 1) distinct terms of the sequence. We say that two nonnegative integers \\(b\\) and \\(c\\) are equivalent (written as \\(b \\sim c\\) ) if they are either both representable or both non-representable.\n\nOne can easily compute\n\\[\nS_{n-1}:=a_{0}+\\cdots+a_{n-1}=2^{n}+2^{[n / 2]}+2^{\\lfloor n / 2\\rfloor}-3 .\n\\]\n\nIndeed, we have \\(S_{n}-S_{n-1}=2^{n}+2^{\\lfloor n / 2\\rfloor}=a_{n}\\) so we can use the induction. In particular, \\(S_{2 k-1}=2^{2 k}+2^{k+1}-3\\).\n\nNote that, if \\(n \\geqslant 3\\), then \\(2^{[n / 2]} \\geqslant 2^{2}>3\\), so\n\\[\nS_{n-1}=2^{n}+2^{[n / 2]}+2^{\\lfloor n / 2\\rfloor}-3>2^{n}+2^{\\lfloor n / 2\\rfloor}=a_{n} .\n\\]\n\nAlso notice that \\(S_{n-1}-a_{n}=2^{[n / 2]}-3<a_{n}\\).\nThe main tool of the solution is the following claim.\nClaim 1. Assume that \\(b\\) is a positive integer such that \\(S_{n-1}-a_{n}<b<a_{n}\\) for some \\(n \\geqslant 3\\). Then \\(b \\sim S_{n-1}-b\\).\nProof. As seen above, we have \\(S_{n-1}>a_{n}\\). Denote \\(c=S_{n-1}-b\\); then \\(S_{n-1}-a_{n}<c<a_{n}\\), so the roles of \\(b\\) and \\(c\\) are symmetrical.\n\nAssume that \\(b\\) is representable. The representation cannot contain \\(a_{i}\\) with \\(i \\geqslant n\\), since \\(b<a_{n}\\). So \\(b\\) is the sum of some subset of \\(\\left\\{a_{0}, a_{1}, \\ldots, a_{n-1}\\right\\}\\); then \\(c\\) is the sum of the complement. The converse is obtained by swapping \\(b\\) and \\(c\\).\n\nWe also need the following version of this claim.\nClaim 2. For any \\(n \\geqslant 3\\), the number \\(a_{n}\\) can be represented as a sum of two or more distinct terms of the sequence if and only if \\(S_{n-1}-a_{n}=2^{[n / 2]}-3\\) is representable.\nProof. Denote \\(c=S_{n-1}-a_{n}<a_{n}\\). If \\(a_{n}\\) satisfies the required condition, then it is the sum of some subset of \\(\\left\\{a_{0}, a_{1}, \\ldots, a_{n-1}\\right\\}\\); then \\(c\\) is the sum of the complement. Conversely, if \\(c\\) is representable, then its representation consists only of the numbers from \\(\\left\\{a_{0}, \\ldots, a_{n-1}\\right\\}\\), so \\(a_{n}\\) is the sum of the complement.\n\nBy Claim 2, in order to prove the problem statement, it suffices to find infinitely many representable numbers of the form \\(2^{t}-3\\), as well as infinitely many non-representable ones.\nClaim 3. For every \\(t \\geqslant 3\\), we have \\(2^{t}-3 \\sim 2^{4 t-6}-3\\), and \\(2^{4 t-6}-3>2^{t}-3\\).\nProof. The inequality follows from \\(t \\geqslant 3\\). In order to prove the equivalence, we apply Claim 1 twice in the following manner.\n\nFirst, since \\(S_{2 t-3}-a_{2 t-2}=2^{t-1}-3<2^{t}-3<2^{2 t-2}+2^{t-1}=a_{2 t-2}\\), by Claim 1 we have \\(2^{t}-3 \\sim S_{2 t-3}-\\left(2^{t}-3\\right)=2^{2 t-2}\\).\n\nSecond, since \\(S_{4 t-7}-a_{4 t-6}=2^{2 t-3}-3<2^{2 t-2}<2^{4 t-6}+2^{2 t-3}=a_{4 t-6}\\), by Claim 1 we have \\(2^{2 t-2} \\sim S_{4 t-7}-2^{2 t-2}=2^{4 t-6}-3\\).\n\nTherefore, \\(2^{t}-3 \\sim 2^{2 t-2} \\sim 2^{4 t-6}-3\\), as required.\nNow it is easy to find the required numbers. Indeed, the number \\(2^{3}-3=5=a_{0}+a_{1}\\) is representable, so Claim 3 provides an infinite sequence of representable numbers\n\\[\n2^{3}-3 \\sim 2^{6}-3 \\sim 2^{18}-3 \\sim \\cdots \\sim 2^{t}-3 \\sim 2^{4 t-6}-3 \\sim \\cdots .\n\\]\n\nOn the other hand, the number \\(2^{7}-3=125\\) is non-representable (since by Claim 1 we have \\(125 \\sim S_{6}-125=24 \\sim S_{4}-24=17 \\sim S_{3}-17=4\\) which is clearly non-representable). So Claim 3 provides an infinite sequence of non-representable numbers\n\\[\n2^{7}-3 \\sim 2^{22}-3 \\sim 2^{82}-3 \\sim \\cdots \\sim 2^{t}-3 \\sim 2^{4 t-6}-3 \\sim \\cdots .\n\\]\n\nSolution 2. We keep the notion of representability and the notation \\(S_{n}\\) from the previous solution. We say that an index \\(n\\) is good if \\(a_{n}\\) writes as a sum of smaller terms from the sequence \\(a_{0}, a_{1}, \\ldots\\). Otherwise we say it is bad. We must prove that there are infinitely many good indices, as well as infinitely many bad ones.\nLemma 1. If \\(m \\geqslant 0\\) is an integer, then \\(4^{m}\\) is representable if and only if either of \\(2 m+1\\) and \\(2 m+2\\) is good.\n\nProof. The case \\(m=0\\) is obvious, so we may assume that \\(m \\geqslant 1\\). Let \\(n=2 m+1\\) or \\(2 m+2\\). Then \\(n \\geqslant 3\\). We notice that\n\\[\nS_{n-1}<a_{n-2}+a_{n}\n\\]\n\nThe inequality writes as \\(2^{n}+2^{\\lceil n / 2\\rceil}+2^{\\lfloor n / 2\\rfloor}-3<2^{n}+2^{\\lfloor n / 2\\rfloor}+2^{n-2}+2^{\\lfloor n / 2\\rfloor-1}\\), i.e. as \\(2^{[n / 2]}< 2^{n-2}+2^{\\lfloor n / 2\\rfloor-1}+3\\). If \\(n \\geqslant 4\\), then \\(n / 2 \\leqslant n-2\\), so \\(\\lceil n / 2\\rceil \\leqslant n-2\\) and \\(2^{\\lceil n / 2\\rceil} \\leqslant 2^{n-2}\\). For \\(n=3\\) the inequality verifies separately.\n\nIf \\(n\\) is good, then \\(a_{n}\\) writes as \\(a_{n}=a_{i_{1}}+\\cdots+a_{i_{r}}\\), where \\(r \\geqslant 2\\) and \\(i_{1}<\\cdots<i_{r}<n\\). Then \\(i_{r}=n-1\\) and \\(i_{r-1}=n-2\\), for if \\(n-1\\) or \\(n-2\\) is missing from the sequence \\(i_{1}, \\ldots, i_{r}\\), then \\(a_{i_{1}}+\\cdots+a_{i_{r}} \\leqslant a_{0}+\\cdots+a_{n-3}+a_{n-1}=S_{n-1}-a_{n-2}<a_{n}\\). Thus, if \\(n\\) is good, then both \\(a_{n}-a_{n-1}\\) and \\(a_{n}-a_{n-1}-a_{n-2}\\) are representable.\n\nWe now consider the cases \\(n=2 m+1\\) and \\(n=2 m+2\\) separately.\nIf \\(n=2 m+1\\), then \\(a_{n}-a_{n-1}=a_{2 m+1}-a_{2 m}=\\left(2^{2 m+1}+2^{m}\\right)-\\left(2^{2 m}+2^{m}\\right)=2^{2 m}\\). So we proved that, if \\(2 m+1\\) is good, then \\(2^{2 m}\\) is representable. Conversely, if \\(2^{2 m}\\) is representable, then \\(2^{2 m}<a_{2 m}\\), so \\(2^{2 m}\\) is a sum of some distinct terms \\(a_{i}\\) with \\(i<2 m\\). It follows that \\(a_{2 m+1}=a_{2 m}+2^{2 m}\\) writes as \\(a_{2 m}\\) plus a sum of some distinct terms \\(a_{i}\\) with \\(i<2 m\\). Hence \\(2 m+1\\) is good.\n\nIf \\(n=2 m+2\\), then \\(a_{n}-a_{n-1}-a_{n-2}=a_{2 m+2}-a_{2 m+1}-a_{2 m}=\\left(2^{2 m+2}+2^{m+1}\\right)-\\left(2^{2 m+1}+\\right. \\left.2^{m}\\right)-\\left(2^{2 m}+2^{m}\\right)=2^{2 m}\\). So we proved that, if \\(2 m+2\\) is good, then \\(2^{2 m}\\) is representable. Conversely, if \\(2^{2 m}\\) is representable, then, as seen in the previous case, it writes as a sum of some distinct terms \\(a_{i}\\) with \\(i<2 m\\). Hence \\(a_{2 m+2}=a_{2 m+1}+a_{2 m}+2^{2 m}\\) writes as \\(a_{2 m+1}+a_{2 m}\\) plus a sum of some distinct terms \\(a_{i}\\) with \\(i<2 m\\). Thus \\(2 m+2\\) is good.\n\nLemma 2. If \\(k \\geqslant 2\\), then \\(2^{4 k-2}\\) is representable if and only if \\(2^{k+1}\\) is representable.\nIn particular, if \\(s \\geqslant 2\\), then \\(4^{s}\\) is representable if and only if \\(4^{4 s-3}\\) is representable. Also, \\(4^{4 s-3}>4^{s}\\).\n\nProof. We have \\(2^{4 k-2}<a_{4 k-2}\\), so in a representation of \\(2^{4 k-2}\\) we can have only terms \\(a_{i}\\) with \\(i \\leqslant 4 k-3\\). Notice that\n\\[\na_{0}+\\cdots+a_{4 k-3}=2^{4 k-2}+2^{2 k}-3<2^{4 k-2}+2^{2 k}+2^{k}=2^{4 k-2}+a_{2 k} .\n\\]\n\nHence, any representation of \\(2^{4 k-2}\\) must contain all terms from \\(a_{2 k}\\) to \\(a_{4 k-3}\\). (If any of these terms is missing, then the sum of the remaining ones is \\(\\leqslant\\left(a_{0}+\\cdots+a_{4 k-3}\\right)-a_{2 k}<2^{4 k-2}\\).) Hence, if \\(2^{4 k-2}\\) is representable, then \\(2^{4 k-2}-\\sum_{i=2 k}^{4 k-3} a_{i}\\) is representable. But\n\\[\n2^{4 k-2}-\\sum_{i=2 k}^{4 k-3} a_{i}=2^{4 k-2}-\\left(S_{4 k-3}-S_{2 k-1}\\right)=2^{4 k-2}-\\left(2^{4 k-2}+2^{2 k}-3\\right)+\\left(2^{2 k}+2^{k+1}-3\\right)=2^{k+1} .\n\\]\n\nSo, if \\(2^{4 k-2}\\) is representable, then \\(2^{k+1}\\) is representable. Conversely, if \\(2^{k+1}\\) is representable, then \\(2^{k+1}<2^{2 k}+2^{k}=a_{2 k}\\), so \\(2^{k+1}\\) writes as a sum of some distinct terms \\(a_{i}\\) with \\(i<2 k\\). It follows that \\(2^{4 k-2}=\\sum_{i=2 k}^{4 k-3} a_{i}+2^{k+1}\\) writes as \\(a_{4 k-3}+a_{4 k-4}+\\cdots+a_{2 k}\\) plus the sum of some distinct terms \\(a_{i}\\) with \\(i<2 k\\). Hence \\(2^{4 k-2}\\) is representable.\n\nFor the second statement, if \\(s \\geqslant 2\\), then we just take \\(k=2 s-1\\) and we notice that \\(2^{k+1}=4^{s}\\) and \\(2^{4 k-2}=4^{4 s-3}\\). Also, \\(s \\geqslant 2\\) implies that \\(4 s-3>s\\).\n\nNow \\(4^{2}=a_{2}+a_{3}\\) is representable, whereas \\(4^{6}=4096\\) is not. Indeed, note that \\(4^{6}=2^{12}<a_{12}\\), so the only available terms for a representation are \\(a_{0}, \\ldots, a_{11}\\), i.e., \\(2,3,6,10,20,36,72\\), 136, 272, 528, 1056, 2080. Their sum is \\(S_{11}=4221\\), which exceeds 4096 by 125. Then any representation of 4096 must contain all the terms from \\(a_{0}, \\ldots, a_{11}\\) that are greater that 125 , i.e., \\(136,272,528,1056,2080\\). Their sum is 4072 . Since \\(4096-4072=24\\) and 24 is clearly not representable, 4096 is non-representable as well.\n\nStarting with these values of \\(m\\), by using Lemma 2, we can obtain infinitely many representable powers of 4 , as well as infinitely many non-representable ones. By Lemma 1, this solves our problem.", "source_pdf": "imosl_2018.pdf", "notes": "fallback-regex"}
{"id": "IMOSL-2018-N5", "contest": "IMOSL", "year": "2018", "problem_number": "N5", "problem": "Four positive integers \\(x, y, z\\), and \\(t\\) satisfy the relations\n\\[\nx y-z t=x+y=z+t .\n\\]\n\nIs it possible that both \\(x y\\) and \\(z t\\) are perfect squares?\n(Russia)", "solution": "Answer: No.\n\n1. Arguing indirectly, assume that \\(x y=a^{2}\\) and \\(z t=c^{2}\\) with \\(a, c>0\\).\nSuppose that the number \\(x+y=z+t\\) is odd. Then \\(x\\) and \\(y\\) have opposite parity, as well as \\(z\\) and \\(t\\). This means that both \\(x y\\) and \\(z t\\) are even, as well as \\(x y-z t=x+y\\); a contradiction. Thus, \\(x+y\\) is even, so the number \\(s=\\frac{x+y}{2}=\\frac{z+t}{2}\\) is a positive integer.\n\nNext, we set \\(b=\\frac{|x-y|}{2}, d=\\frac{|z-t|}{2}\\). Now the problem conditions yield\n\\[\ns^{2}=a^{2}+b^{2}=c^{2}+d^{2}\n\\]\nand\n\\[\n2 s=a^{2}-c^{2}=d^{2}-b^{2}\n\\]\n(the last equality in (2) follows from (1)). We readily get from (2) that \\(a, d>0\\).\nIn the sequel we will use only the relations (1) and (2), along with the fact that \\(a, d, s\\) are positive integers, while \\(b\\) and \\(c\\) are nonnegative integers, at most one of which may be zero. Since both relations are symmetric with respect to the simultaneous swappings \\(a \\leftrightarrow d\\) and \\(b \\leftrightarrow c\\), we assume, without loss of generality, that \\(b \\geqslant c\\) (and hence \\(b>0\\) ). Therefore, \\(d^{2}=2 s+b^{2}>c^{2}\\), whence\n\\[\nd^{2}>\\frac{c^{2}+d^{2}}{2}=\\frac{s^{2}}{2} .\n\\]\n\nOn the other hand, since \\(d^{2}-b^{2}\\) is even by (2), the numbers \\(b\\) and \\(d\\) have the same parity, so \\(0<b \\leqslant d-2\\). Therefore,\n\\[\n2 s=d^{2}-b^{2} \\geqslant d^{2}-(d-2)^{2}=4(d-1), \\quad \\text { i.e., } \\quad d \\leqslant \\frac{s}{2}+1\n\\]\n\nCombining (3) and (4) we obtain\n\\[\n2 s^{2}<4 d^{2} \\leqslant 4\\left(\\frac{s}{2}+1\\right)^{2}, \\quad \\text { or } \\quad(s-2)^{2}<8\n\\]\nwhich yields \\(s \\leqslant 4\\).\nFinally, an easy check shows that each number of the form \\(s^{2}\\) with \\(1 \\leqslant s \\leqslant 4\\) has a unique representation as a sum of two squares, namely \\(s^{2}=s^{2}+0^{2}\\). Thus, (1) along with \\(a, d>0\\) imply \\(b=c=0\\), which is impossible.\n\nSolution 2. We start with a complete description of all 4-tuples ( \\(x, y, z, t\\) ) of positive integers satisfying (*). As in the solution above, we notice that the numbers\n\\[\ns=\\frac{x+y}{2}=\\frac{z+t}{2}, \\quad p=\\frac{x-y}{2}, \\quad \\text { and } \\quad q=\\frac{z-t}{2}\n\\]\nare integers (we may, and will, assume that \\(p, q \\geqslant 0\\) ). We have\n\\[\n2 s=x y-z t=(s+p)(s-p)-(s+q)(s-q)=q^{2}-p^{2},\n\\]\nso \\(p\\) and \\(q\\) have the same parity, and \\(q>p\\).\n\nSet now \\(k=\\frac{q-p}{2}, \\ell=\\frac{q+p}{2}\\). Then we have \\(s=\\frac{q^{2}-p^{2}}{2}=2 k \\ell\\) and hence\n\\[\n\\begin{array}{ll}\nx=s+p=2 k \\ell-k+\\ell, & y=s-p=2 k \\ell+k-\\ell \\\\\nz=s+q=2 k \\ell+k+\\ell, & t=s-q=2 k \\ell-k-\\ell\n\\end{array}\n\\]\n\nRecall here that \\(\\ell \\geqslant k>0\\) and, moreover, \\((k, \\ell) \\neq(1,1)\\), since otherwise \\(t=0\\).\nAssume now that both \\(x y\\) and \\(z t\\) are squares. Then \\(x y z t\\) is also a square. On the other hand, we have\n\\[\n\\begin{aligned}\n& \\text { xyzt }=(2 k \\ell-k+\\ell)(2 k \\ell+k-\\ell)(2 k \\ell+k+\\ell)(2 k \\ell-k-\\ell) \\\\\n& \\quad=\\left(4 k^{2} \\ell^{2}-(k-\\ell)^{2}\\right)\\left(4 k^{2} \\ell^{2}-(k+\\ell)^{2}\\right)=\\left(4 k^{2} \\ell^{2}-k^{2}-\\ell^{2}\\right)^{2}-4 k^{2} \\ell^{2}\n\\end{aligned}\n\\]\n\nDenote \\(D=4 k^{2} \\ell^{2}-k^{2}-\\ell^{2}>0\\). From (6) we get \\(D^{2}>x y z t\\). On the other hand,\n\\[\n\\begin{aligned}\n(D-1)^{2}=D^{2}-2\\left(4 k^{2} \\ell^{2}-k^{2}-\\ell^{2}\\right)+1=\\left(D^{2}-4 k^{2} \\ell^{2}\\right)-\\left(2 k^{2}-1\\right)\\left(2 \\ell^{2}-1\\right)+2 & \\\\\n& =x y z t-\\left(2 k^{2}-1\\right)\\left(2 \\ell^{2}-1\\right)+2<x y z t\n\\end{aligned}\n\\]\nsince \\(\\ell \\geqslant 2\\) and \\(k \\geqslant 1\\). Thus \\((D-1)^{2}<x y z t<D^{2}\\), and xyzt cannot be a perfect square; a contradiction.\n\nComment. The first part of Solution 2 shows that all 4 -tuples of positive integers \\(x \\geqslant y, z \\geqslant t\\) satisfying (*) have the form (5), where \\(\\ell \\geqslant k>0\\) and \\(\\ell \\geqslant 2\\). The converse is also true: every pair of positive integers \\(\\ell \\geqslant k>0\\), except for the pair \\(k=\\ell=1\\), generates via (5) a 4-tuple of positive integers satisfying (*).", "source_pdf": "imosl_2018.pdf", "notes": "fallback-regex"}
{"id": "IMOSL-2018-N6", "contest": "IMOSL", "year": "2018", "problem_number": "N6", "problem": "Let \\(f:\\{1,2,3, \\ldots\\} \\rightarrow\\{2,3, \\ldots\\}\\) be a function such that \\(f(m+n) \\mid f(m)+f(n)\\) for all pairs \\(m, n\\) of positive integers. Prove that there exists a positive integer \\(c>1\\) which divides all values of \\(f\\).\n(Mexico)", "solution": "1. For every positive integer \\(m\\), define \\(S_{m}=\\{n: m \\mid f(n)\\}\\).\nLemma. If the set \\(S_{m}\\) is infinite, then \\(S_{m}=\\{d, 2 d, 3 d, \\ldots\\}=d \\cdot \\mathbb{Z}_{>0}\\) for some positive integer \\(d\\). Proof. Let \\(d=\\min S_{m}\\); the definition of \\(S_{m}\\) yields \\(m \\mid f(d)\\).\n\nWhenever \\(n \\in S_{m}\\) and \\(n>d\\), we have \\(m|f(n)| f(n-d)+f(d)\\), so \\(m \\mid f(n-d)\\) and therefore \\(n-d \\in S_{m}\\). Let \\(r \\leqslant d\\) be the least positive integer with \\(n \\equiv r(\\bmod d)\\); repeating the same step, we can see that \\(n-d, n-2 d, \\ldots, r \\in S_{m}\\). By the minimality of \\(d\\), this shows \\(r=d\\) and therefore \\(d \\mid n\\).\n\nStarting from an arbitrarily large element of \\(S_{m}\\), the process above reaches all multiples of \\(d\\); so they all are elements of \\(S_{m}\\).\n\nThe solution for the problem will be split into two cases.\n\n\\section*{Case 1: The function \\(f\\) is bounded.}\n\nCall a prime \\(p\\) frequent if the set \\(S_{p}\\) is infinite, i.e., if \\(p\\) divides \\(f(n)\\) for infinitely many positive integers \\(n\\); otherwise call \\(p\\) sporadic. Since the function \\(f\\) is bounded, there are only a finite number of primes that divide at least one \\(f(n)\\); so altogether there are finitely many numbers \\(n\\) such that \\(f(n)\\) has a sporadic prime divisor. Let \\(N\\) be a positive integer, greater than all those numbers \\(n\\).\n\nLet \\(p_{1}, \\ldots, p_{k}\\) be the frequent primes. By the lemma we have \\(S_{p_{i}}=d_{i} \\cdot \\mathbb{Z}_{>0}\\) for some \\(d_{i}\\). Consider the number\n\\[\nn=N d_{1} d_{2} \\cdots d_{k}+1\n\\]\n\nDue to \\(n>N\\), all prime divisors of \\(f(n)\\) are frequent primes. Let \\(p_{i}\\) be any frequent prime divisor of \\(f(n)\\). Then \\(n \\in S_{p_{i}}\\), and therefore \\(d_{i} \\mid n\\). But \\(n \\equiv 1\\left(\\bmod d_{i}\\right)\\), which means \\(d_{i}=1\\). Hence \\(S_{p_{i}}=1 \\cdot \\mathbb{Z}_{>0}=\\mathbb{Z}_{>0}\\) and therefore \\(p_{i}\\) is a common divisor of all values \\(f(n)\\).\n\n\\section*{Case 2: \\(f\\) is unbounded.}\n\nWe prove that \\(f(1)\\) divides all \\(f(n)\\).\nLet \\(a=f(1)\\). Since \\(1 \\in S_{a}\\), by the lemma it suffices to prove that \\(S_{a}\\) is an infinite set.\nCall a positive integer \\(p\\) a peak if \\(f(p)>\\max (f(1), \\ldots, f(p-1))\\). Since \\(f\\) is not bounded, there are infinitely many peaks. Let \\(1=p_{1}<p_{2}<\\ldots\\) be the sequence of all peaks, and let \\(h_{k}=f\\left(p_{k}\\right)\\). Notice that for any peak \\(p_{i}\\) and for any \\(k<p_{i}\\), we have \\(f\\left(p_{i}\\right) \\mid f(k)+f\\left(p_{i}-k\\right)< 2 f\\left(p_{i}\\right)\\), hence\n\\[\nf(k)+f\\left(p_{i}-k\\right)=f\\left(p_{i}\\right)=h_{i} .\n\\]\n\nBy the pigeonhole principle, among the numbers \\(h_{1}, h_{2}, \\ldots\\) there are infinitely many that are congruent modulo \\(a\\). Let \\(k_{0}<k_{1}<k_{2}<\\ldots\\) be an infinite sequence of positive integers such that \\(h_{k_{0}} \\equiv h_{k_{1}} \\equiv \\ldots(\\bmod a)\\). Notice that\n\\[\nf\\left(p_{k_{i}}-p_{k_{0}}\\right)=f\\left(p_{k_{i}}\\right)-f\\left(p_{k_{0}}\\right)=h_{k_{i}}-h_{k_{0}} \\equiv 0 \\quad(\\bmod a),\n\\]\nso \\(p_{k_{i}}-p_{k_{0}} \\in S_{a}\\) for all \\(i=1,2, \\ldots\\). This provides infinitely many elements in \\(S_{a}\\).\nHence, \\(S_{a}\\) is an infinite set, and therefore \\(f(1)=a\\) divides \\(f(n)\\) for every \\(n\\).\n\nComment. As an extension of the solution above, it can be proven that if \\(f\\) is not bounded then \\(f(n)=a n\\) with \\(a=f(1)\\).\n\nTake an arbitrary positive integer \\(n\\); we will show that \\(f(n+1)=f(n)+a\\). Then it follows by induction that \\(f(n)=a n\\).\n\nTake a peak \\(p\\) such that \\(p>n+2\\) and \\(h=f(p)>f(n)+2 a\\). By (1) we have \\(f(p-1)= f(p)-f(1)=h-a\\) and \\(f(n+1)=f(p)-f(p-n-1)=h-f(p-n-1)\\). From \\(h-a=f(p-1) \\mid f(n)+f(p-n-1)<f(n)+h<2(h-a)\\) we get \\(f(n)+f(p-n-1)=h-a\\). Then\n\\[\nf(n+1)-f(n)=(h-f(p-n-1))-(h-a-f(p-n-1))=a .\n\\]\n\nOn the other hand, there exists a wide family of bounded functions satisfying the required properties. Here we present a few examples:\n\\[\nf(n)=c ; \\quad f(n)=\\left\\{\\begin{array}{ll}\n2 c & \\text { if } n \\text { is even } \\\\\nc & \\text { if } n \\text { is odd }\n\\end{array} \\quad f(n)= \\begin{cases}2018 c & \\text { if } n \\leqslant 2018 \\\\\nc & \\text { if } n>2018\\end{cases}\\right.\n\\]\n\nSolution 2. Let \\(d_{n}=\\operatorname{gcd}(f(n), f(1))\\). From \\(d_{n+1} \\mid f(1)\\) and \\(d_{n+1}|f(n+1)| f(n)+f(1)\\), we can see that \\(d_{n+1} \\mid f(n)\\); then \\(d_{n+1} \\mid \\operatorname{gcd}(f(n), f(1))=d_{n}\\). So the sequence \\(d_{1}, d_{2}, \\ldots\\) is nonincreasing in the sense that every element is a divisor of the previous elements. Let \\(d=\\min \\left(d_{1}, d_{2}, \\ldots\\right)=\\operatorname{gcd}\\left(d_{1} . d_{2}, \\ldots\\right)=\\operatorname{gcd}(f(1), f(2), \\ldots)\\); we have to prove \\(d \\geqslant 2\\).\n\nFor the sake of contradiction, suppose that the statement is wrong, so \\(d=1\\); that means there is some index \\(n_{0}\\) such that \\(d_{n}=1\\) for every \\(n \\geqslant n_{0}\\), i.e., \\(f(n)\\) is coprime with \\(f(1)\\).\nClaim 1. If \\(2^{k} \\geqslant n_{0}\\) then \\(f\\left(2^{k}\\right) \\leqslant 2^{k}\\).\nProof. By the condition, \\(f(2 n) \\mid 2 f(n)\\); a trivial induction yields \\(f\\left(2^{k}\\right) \\mid 2^{k} f(1)\\). If \\(2^{k} \\geqslant n_{0}\\) then \\(f\\left(2^{k}\\right)\\) is coprime with \\(f(1)\\), so \\(f\\left(2^{k}\\right)\\) is a divisor of \\(2^{k}\\).\nClaim 2. There is a constant \\(C\\) such that \\(f(n)<n+C\\) for every \\(n\\).\nProof. Take the first power of 2 which is greater than or equal to \\(n_{0}\\) : let \\(K=2^{k} \\geqslant n_{0}\\). By Claim 1, we have \\(f(K) \\leqslant K\\). Notice that \\(f(n+K) \\mid f(n)+f(K)\\) implies \\(f(n+K) \\leqslant f(n)+f(K) \\leqslant f(n)+K\\). If \\(n=t K+r\\) for some \\(t \\geqslant 0\\) and \\(1 \\leqslant r \\leqslant K\\), then we conclude\n\\(f(n) \\leqslant K+f(n-K) \\leqslant 2 K+f(n-2 K) \\leqslant \\ldots \\leqslant t K+f(r)<n+\\max (f(1), f(2), \\ldots, f(K))\\), so the claim is true with \\(C=\\max (f(1), \\ldots, f(K))\\).\nClaim 3. If \\(a, b \\in \\mathbb{Z}_{>0}\\) are coprime then \\(\\operatorname{gcd}(f(a), f(b)) \\mid f(1)\\). In particular, if \\(a, b \\geqslant n_{0}\\) are coprime then \\(f(a)\\) and \\(f(b)\\) are coprime.\nProof. Let \\(d=\\operatorname{gcd}(f(a), f(b))\\). We can replicate Euclid's algorithm. Formally, apply induction on \\(a+b\\). If \\(a=1\\) or \\(b=1\\) then we already have \\(d \\mid f(1)\\).\n\nWithout loss of generality, suppose \\(1<a<b\\). Then \\(d \\mid f(a)\\) and \\(d|f(b)| f(a)+f(b-a)\\), so \\(d \\mid f(b-a)\\). Therefore \\(d\\) divides \\(\\operatorname{gcd}(f(a), f(b-a))\\) which is a divisor of \\(f(1)\\) by the induction hypothesis.\n\nLet \\(p_{1}<p_{2}<\\ldots\\) be the sequence of all prime numbers; for every \\(k\\), let \\(q_{k}\\) be the lowest power of \\(p_{k}\\) with \\(q_{k} \\geqslant n_{0}\\). (Notice that there are only finitely many positive integers with \\(q_{k} \\neq p_{k}\\).)\n\nTake a positive integer \\(N\\), and consider the numbers\n\\[\nf(1), f\\left(q_{1}\\right), f\\left(q_{2}\\right), \\ldots, f\\left(q_{N}\\right)\n\\]\n\nHere we have \\(N+1\\) numbers, each being greater than 1 , and they are pairwise coprime by Claim 3. Therefore, they have at least \\(N+1\\) different prime divisors in total, and their greatest prime divisor is at least \\(p_{N+1}\\). Hence, \\(\\max \\left(f(1), f\\left(q_{1}\\right), \\ldots, f\\left(q_{N}\\right)\\right) \\geqslant p_{N+1}\\).\n\nChoose \\(N\\) such that \\(\\max \\left(q_{1}, \\ldots, q_{N}\\right)=p_{N}\\) (this is achieved if \\(N\\) is sufficiently large), and \\(p_{N+1}-p_{N}>C\\) (that is possible, because there are arbitrarily long gaps between the primes). Then we establish a contradiction\n\\[\np_{N+1} \\leqslant \\max \\left(f(1), f\\left(q_{1}\\right), \\ldots, f\\left(q_{N}\\right)\\right)<\\max \\left(1+C, q_{1}+C, \\ldots, q_{N}+C\\right)=p_{N}+C<p_{N+1}\n\\]\nwhich proves the statement.", "source_pdf": "imosl_2018.pdf", "notes": "fallback-regex"}
{"id": "IMOSL-2018-N7", "contest": "IMOSL", "year": "2018", "problem_number": "N7", "problem": "Let \\(n \\geqslant 2018\\) be an integer, and let \\(a_{1}, a_{2}, \\ldots, a_{n}, b_{1}, b_{2}, \\ldots, b_{n}\\) be pairwise distinct positive integers not exceeding \\(5 n\\). Suppose that the sequence\n\\[\n\\frac{a_{1}}{b_{1}}, \\frac{a_{2}}{b_{2}}, \\ldots, \\frac{a_{n}}{b_{n}}\n\\]\nforms an arithmetic progression. Prove that the terms of the sequence are equal.\n(Thailand)", "solution": ". Suppose that (1) is an arithmetic progression with nonzero difference. Let the difference be \\(\\Delta=\\frac{c}{d}\\), where \\(d>0\\) and \\(c, d\\) are coprime.\n\nWe will show that too many denominators \\(b_{i}\\) should be divisible by \\(d\\). To this end, for any \\(1 \\leqslant i \\leqslant n\\) and any prime divisor \\(p\\) of \\(d\\), say that the index \\(i\\) is p-wrong, if \\(v_{p}\\left(b_{i}\\right)<v_{p}(d) .\\left(v_{p}(x)\\right.\\) stands for the exponent of \\(p\\) in the prime factorisation of \\(x\\).)\nClaim 1. For any prime \\(p\\), all \\(p\\)-wrong indices are congruent modulo \\(p\\). In other words, the \\(p\\)-wrong indices (if they exist) are included in an arithmetic progression with difference \\(p\\).\nProof. Let \\(\\alpha=v_{p}(d)\\). For the sake of contradiction, suppose that \\(i\\) and \\(j\\) are \\(p\\)-wrong indices (i.e., none of \\(b_{i}\\) and \\(b_{j}\\) is divisible by \\(p^{\\alpha}\\) ) such that \\(i \\not \\equiv j(\\bmod p)\\). Then the least common denominator of \\(\\frac{a_{i}}{b_{i}}\\) and \\(\\frac{a_{j}}{b_{j}}\\) is not divisible by \\(p^{\\alpha}\\). But this is impossible because in their difference, \\((i-j) \\Delta=\\frac{(i-j) c}{d}\\), the numerator is coprime to \\(p\\), but \\(p^{\\alpha}\\) divides the denominator \\(d\\).\n\nClaim 2. \\(d\\) has no prime divisors greater than 5.\nProof. Suppose that \\(p \\geqslant 7\\) is a prime divisor of \\(d\\). Among the indices \\(1,2, \\ldots, n\\), at most \\(\\left\\lceil\\frac{n}{p}\\right\\rceil<\\frac{n}{p}+1\\) are \\(p\\)-wrong, so \\(p\\) divides at least \\(\\frac{p-1}{p} n-1\\) of \\(b_{1}, \\ldots, b_{n}\\). Since these denominators are distinct,\n\\[\n5 n \\geqslant \\max \\left\\{b_{i}: p \\mid b_{i}\\right\\} \\geqslant\\left(\\frac{p-1}{p} n-1\\right) p=(p-1)(n-1)-1 \\geqslant 6(n-1)-1>5 n\n\\]\na contradiction.\nClaim 3. For every \\(0 \\leqslant k \\leqslant n-30\\), among the denominators \\(b_{k+1}, b_{k+2}, \\ldots, b_{k+30}\\), at least \\(\\varphi(30)=8\\) are divisible by \\(d\\).\nProof. By Claim 1, the 2 -wrong, 3 -wrong and 5 -wrong indices can be covered by three arithmetic progressions with differences 2,3 and 5 . By a simple inclusion-exclusion, \\((2-1) \\cdot(3-1) \\cdot(5-1)=8\\) indices are not covered; by Claim 2, we have \\(d \\mid b_{i}\\) for every uncovered index \\(i\\).\n\nClaim 4. \\(|\\Delta|<\\frac{20}{n-2}\\) and \\(d>\\frac{n-2}{20}\\).\nProof. From the sequence (1), remove all fractions with \\(b_{n}<\\frac{n}{2}\\), There remain at least \\(\\frac{n}{2}\\) fractions, and they cannot exceed \\(\\frac{5 n}{n / 2}=10\\). So we have at least \\(\\frac{n}{2}\\) elements of the arithmetic progression (1) in the interval ( 0,10\\(]\\), hence the difference must be below \\(\\frac{10}{n / 2-1}=\\frac{20}{n-2}\\).\n\nThe second inequality follows from \\(\\frac{1}{d} \\leqslant \\frac{|c|}{d}=|\\Delta|\\).\nNow we have everything to get the final contradiction. By Claim 3, we have \\(d \\mid b_{i}\\) for at least \\(\\left\\lfloor\\frac{n}{30}\\right\\rfloor \\cdot 8\\) indices \\(i\\). By Claim 4, we have \\(d \\geqslant \\frac{n-2}{20}\\). Therefore,\n\\[\n5 n \\geqslant \\max \\left\\{b_{i}: d \\mid b_{i}\\right\\} \\geqslant\\left(\\left\\lfloor\\frac{n}{30}\\right\\rfloor \\cdot 8\\right) \\cdot d>\\left(\\frac{n}{30}-1\\right) \\cdot 8 \\cdot \\frac{n-2}{20}>5 n\n\\]\n\nComment 1. It is possible that all terms in (1) are equal, for example with \\(a_{i}=2 i-1\\) and \\(b_{i}=4 i-2\\) we have \\(\\frac{a_{i}}{b_{i}}=\\frac{1}{2}\\).\n\nComment 2. The bound \\(5 n\\) in the statement is far from sharp; the solution above can be modified to work for \\(9 n\\). For large \\(n\\), the bound \\(5 n\\) can be replaced by \\(n^{\\frac{3}{2}-\\varepsilon}\\).", "source_pdf": "imosl_2018.pdf", "notes": "fallback-regex"}
{"id": "IMOSL-2019-A2", "contest": "IMOSL", "year": "2019", "problem_number": "A2", "problem": "Let \\(u_{1}, u_{2}, \\ldots, u_{2019}\\) be real numbers satisfying\n\\[\nu_{1}+u_{2}+\\cdots+u_{2019}=0 \\quad \\text { and } \\quad u_{1}^{2}+u_{2}^{2}+\\cdots+u_{2019}^{2}=1 .\n\\]\n\nLet \\(a=\\min \\left(u_{1}, u_{2}, \\ldots, u_{2019}\\right)\\) and \\(b=\\max \\left(u_{1}, u_{2}, \\ldots, u_{2019}\\right)\\). Prove that\n\\[\na b \\leqslant-\\frac{1}{2019}\n\\]\n(Germany)", "solution": "1. Notice first that \\(b>0\\) and \\(a<0\\). Indeed, since \\(\\sum_{i=1}^{2019} u_{i}^{2}=1\\), the variables \\(u_{i}\\) cannot be all zero, and, since \\(\\sum_{i=1}^{2019} u_{i}=0\\), the nonzero elements cannot be all positive or all negative.\n\nLet \\(P=\\left\\{i: u_{i}>0\\right\\}\\) and \\(N=\\left\\{i: u_{i} \\leqslant 0\\right\\}\\) be the indices of positive and nonpositive elements in the sequence, and let \\(p=|P|\\) and \\(n=|N|\\) be the sizes of these sets; then \\(p+n=2019\\). By the condition \\(\\sum_{i=1}^{2019} u_{i}=0\\) we have \\(0=\\sum_{i=1}^{2019} u_{i}=\\sum_{i \\in P} u_{i}-\\sum_{i \\in N}\\left|u_{i}\\right|\\), so\n\\[\n\\sum_{i \\in P} u_{i}=\\sum_{i \\in N}\\left|u_{i}\\right| .\n\\]\n\nAfter this preparation, estimate the sum of squares of the positive and nonpositive elements as follows:\n\\[\n\\begin{aligned}\n& \\sum_{i \\in P} u_{i}^{2} \\leqslant \\sum_{i \\in P} b u_{i}=b \\sum_{i \\in P} u_{i}=b \\sum_{i \\in N}\\left|u_{i}\\right| \\leqslant b \\sum_{i \\in N}|a|=-n a b \\\\\n& \\sum_{i \\in N} u_{i}^{2} \\leqslant \\sum_{i \\in N}|a| \\cdot\\left|u_{i}\\right|=|a| \\sum_{i \\in N}\\left|u_{i}\\right|=|a| \\sum_{i \\in P} u_{i} \\leqslant|a| \\sum_{i \\in P} b=-p a b .\n\\end{aligned}\n\\]\n\nThe sum of these estimates is\n\\[\n1=\\sum_{i=1}^{2019} u_{i}^{2}=\\sum_{i \\in P} u_{i}^{2}+\\sum_{i \\in N} u_{i}^{2} \\leqslant-(p+n) a b=-2019 a b\n\\]\nthat proves \\(a b \\leqslant \\frac{-1}{2019}\\).\nComment 1. After observing \\(\\sum_{i \\in P} u_{i}^{2} \\leqslant b \\sum_{i \\in P} u_{i}\\) and \\(\\sum_{i \\in N} u_{i}^{2} \\leqslant|a| \\sum_{i \\in P}\\left|u_{i}\\right|\\), instead of (2,3) an alternative continuation is\n\\[\n|a b| \\geqslant \\frac{\\sum_{i \\in P} u_{i}^{2}}{\\sum_{i \\in P} u_{i}} \\cdot \\frac{\\sum_{i \\in N} u_{i}^{2}}{\\sum_{i \\in N}\\left|u_{i}\\right|}=\\frac{\\sum_{i \\in P} u_{i}^{2}}{\\left(\\sum_{i \\in P} u_{i}\\right)^{2}} \\sum_{i \\in N} u_{i}^{2} \\geqslant \\frac{1}{p} \\sum_{i \\in N} u_{i}^{2}\n\\]\n(by the AM-QM or the Cauchy-Schwarz inequality) and similarly \\(|a b| \\geqslant \\frac{1}{n} \\sum_{i \\in P} u_{i}^{2}\\).\nSolution 2. As in the previous solution we conclude that \\(a<0\\) and \\(b>0\\).\nFor every index \\(i\\), the number \\(u_{i}\\) is a convex combination of \\(a\\) and \\(b\\), so\n\\[\nu_{i}=x_{i} a+y_{i} b \\quad \\text { with some weights } 0 \\leqslant x_{i}, y_{i} \\leqslant 1, \\text { with } x_{i}+y_{i}=1 .\n\\]\n\nLet \\(X=\\sum_{i=1}^{2019} x_{i}\\) and \\(Y=\\sum_{i=1}^{2019} y_{i}\\). From \\(0=\\sum_{i=1}^{2019} u_{i}=\\sum_{i=1}^{2019}\\left(x_{i} a+y_{i} b\\right)=-|a| X+b Y\\), we get\n\\[\n|a| X=b Y .\n\\]\n\nFrom \\(\\sum_{i=1}^{2019}\\left(x_{i}+y_{i}\\right)=2019\\) we have\n\\[\nX+Y=2019\n\\]\n\nThe system of linear equations \\((4,5)\\) has a unique solution:\n\\[\nX=\\frac{2019 b}{|a|+b}, \\quad Y=\\frac{2019|a|}{|a|+b}\n\\]\n\nNow apply the following estimate to every \\(u_{i}^{2}\\) in their sum:\n\\[\nu_{i}^{2}=x_{i}^{2} a^{2}+2 x_{i} y_{i} a b+y_{i}^{2} b^{2} \\leqslant x_{i} a^{2}+y_{i} b^{2}\n\\]\nwe obtain that\n\\[\n1=\\sum_{i=1}^{2019} u_{i}^{2} \\leqslant \\sum_{i=1}^{2019}\\left(x_{i} a^{2}+y_{i} b^{2}\\right)=X a^{2}+Y b^{2}=\\frac{2019 b}{|a|+b}|a|^{2}+\\frac{2019|a|}{|a|+b} b^{2}=2019|a| b=-2019 a b\n\\]\n\nHence, \\(a b \\leqslant \\frac{-1}{2019}\\).\nComment 2. The idea behind Solution 2 is the following thought. Suppose we fix \\(a<0\\) and \\(b>0\\), fix \\(\\sum u_{i}=0\\) and vary the \\(u_{i}\\) to achieve the maximum value of \\(\\sum u_{i}^{2}\\). Considering varying any two of the \\(u_{i}\\) while preserving their sum: the maximum value of \\(\\sum u_{i}^{2}\\) is achieved when those two are as far apart as possible, so all but at most one of the \\(u_{i}\\) are equal to \\(a\\) or \\(b\\). Considering a weighted version of the problem, we see the maximum (with fractional numbers of \\(u_{i}\\) having each value) is achieved when \\(\\frac{2019 b}{|a|+b}\\) of them are \\(a\\) and \\(\\frac{2019|a|}{|a|+b}\\) are \\(b\\).\n\nIn fact, this happens in the solution: the number \\(u_{i}\\) is replaced by \\(x_{i}\\) copies of \\(a\\) and \\(y_{i}\\) copies of \\(b\\).", "source_pdf": "imosl_2019.pdf", "notes": "fallback-regex"}
{"id": "IMOSL-2019-A3", "contest": "IMOSL", "year": "2019", "problem_number": "A3", "problem": "Let \\(n \\geqslant 3\\) be a positive integer and let \\(\\left(a_{1}, a_{2}, \\ldots, a_{n}\\right)\\) be a strictly increasing sequence of \\(n\\) positive real numbers with sum equal to 2 . Let \\(X\\) be a subset of \\(\\{1,2, \\ldots, n\\}\\) such that the value of\n\\[\n\\left|1-\\sum_{i \\in X} a_{i}\\right|\n\\]\nis minimised. Prove that there exists a strictly increasing sequence of \\(n\\) positive real numbers \\(\\left(b_{1}, b_{2}, \\ldots, b_{n}\\right)\\) with sum equal to 2 such that\n\\[\n\\sum_{i \\in X} b_{i}=1\n\\]\n(New Zealand)", "solution": "Common remarks. In all solutions, we say an index set \\(X\\) is \\(\\left(a_{i}\\right)\\)-minimising if it has the property in the problem for the given sequence \\(\\left(a_{i}\\right)\\). Write \\(X^{c}\\) for the complement of \\(X\\), and \\([a, b]\\) for the interval of integers \\(k\\) such that \\(a \\leqslant k \\leqslant b\\). Note that\n\\[\n\\left|1-\\sum_{i \\in X} a_{i}\\right|=\\left|1-\\sum_{i \\in X^{c}} a_{i}\\right|,\n\\]\nso we may exchange \\(X\\) and \\(X^{c}\\) where convenient. Let\n\\[\n\\Delta=\\sum_{i \\in X^{c}} a_{i}-\\sum_{i \\in X} a_{i}\n\\]\nand note that \\(X\\) is \\(\\left(a_{i}\\right)\\)-minimising if and only if it minimises \\(|\\Delta|\\), and that \\(\\sum_{i \\in X} a_{i}=1\\) if and only if \\(\\Delta=0\\).\n\nIn some solutions, a scaling process is used. If we have a strictly increasing sequence of positive real numbers \\(c_{i}\\) (typically obtained by perturbing the \\(a_{i}\\) in some way) such that\n\\[\n\\sum_{i \\in X} c_{i}=\\sum_{i \\in X^{c}} c_{i}\n\\]\nthen we may put \\(b_{i}=2 c_{i} / \\sum_{j=1}^{n} c_{j}\\). So it suffices to construct such a sequence without needing its sum to be 2 .\n\nThe solutions below show various possible approaches to the problem. Solutions 1 and 2 perturb a few of the \\(a_{i}\\) to form the \\(b_{i}\\) (with scaling in the case of\n\n1, without scaling in the case of Solution 2). Solutions 3 and 4 look at properties of the index set \\(X\\). Solution 3 then perturbs many of the \\(a_{i}\\) to form the \\(b_{i}\\), together with scaling. Rather than using such perturbations, Solution 4 constructs a sequence ( \\(b_{i}\\) ) directly from the set \\(X\\) with the required properties. Solution 4 can be used to give a complete description of sets \\(X\\) that are \\(\\left(a_{i}\\right)\\)-minimising for some ( \\(a_{i}\\) ).\n\nSolution 1. Without loss of generality, assume \\(\\sum_{i \\in X} a_{i} \\leqslant 1\\), and we may assume strict inequality as otherwise \\(b_{i}=a_{i}\\) works. Also, \\(X\\) clearly cannot be empty.\n\nIf \\(n \\in X\\), add \\(\\Delta\\) to \\(a_{n}\\), producing a sequence of \\(c_{i}\\) with \\(\\sum_{i \\in X} c_{i}=\\sum_{i \\in X^{c}} c_{i}\\), and then scale as described above to make the sum equal to 2 . Otherwise, there is some \\(k\\) with \\(k \\in X\\) and \\(k+1 \\in X^{c}\\). Let \\(\\delta=a_{k+1}-a_{k}\\).\n- If \\(\\delta>\\Delta\\), add \\(\\Delta\\) to \\(a_{k}\\) and then scale.\n- If \\(\\delta<\\Delta\\), then considering \\(X \\cup\\{k+1\\} \\backslash\\{k\\}\\) contradicts \\(X\\) being \\(\\left(a_{i}\\right)\\)-minimising.\n- If \\(\\delta=\\Delta\\), choose any \\(j \\neq k, k+1\\) (possible since \\(n \\geqslant 3\\) ), and any \\(\\epsilon\\) less than the least of \\(a_{1}\\) and all the differences \\(a_{i+1}-a_{i}\\). If \\(j \\in X\\) then add \\(\\Delta-\\epsilon\\) to \\(a_{k}\\) and \\(\\epsilon\\) to \\(a_{j}\\), then scale; otherwise, add \\(\\Delta\\) to \\(a_{k}\\) and \\(\\epsilon / 2\\) to \\(a_{k+1}\\), and subtract \\(\\epsilon / 2\\) from \\(a_{j}\\), then scale.\n\nSolution 2. This is similar to Solution 1, but without scaling. As in that solution, without loss of generality, assume \\(\\sum_{i \\in X} a_{i}<1\\).\n\nSuppose there exists \\(1 \\leqslant j \\leqslant n-1\\) such that \\(j \\in X\\) but \\(j+1 \\in X^{c}\\). Then \\(a_{j+1}-a_{j} \\geqslant \\Delta\\), because otherwise considering \\(X \\cup\\{j+1\\} \\backslash\\{j\\}\\) contradicts \\(X\\) being \\(\\left(a_{i}\\right)\\)-minimising.\n\nIf \\(a_{j+1}-a_{j}>\\Delta\\), put\n\\[\nb_{i}= \\begin{cases}a_{j}+\\Delta / 2, & \\text { if } i=j ; \\\\ a_{j+1}-\\Delta / 2, & \\text { if } i=j+1 ; \\\\ a_{i}, & \\text { otherwise. }\\end{cases}\n\\]\n\nIf \\(a_{j+1}-a_{j}=\\Delta\\), choose any \\(\\epsilon\\) less than the least of \\(\\Delta / 2, a_{1}\\) and all the differences \\(a_{i+1}-a_{i}\\). If \\(|X| \\geqslant 2\\), choose \\(k \\in X\\) with \\(k \\neq j\\), and put\n\\[\nb_{i}= \\begin{cases}a_{j}+\\Delta / 2-\\epsilon, & \\text { if } i=j ; \\\\ a_{j+1}-\\Delta / 2, & \\text { if } i=j+1 ; \\\\ a_{k}+\\epsilon, & \\text { if } i=k ; \\\\ a_{i}, & \\text { otherwise. }\\end{cases}\n\\]\n\nOtherwise, \\(\\left|X^{c}\\right| \\geqslant 2\\), so choose \\(k \\in X^{c}\\) with \\(k \\neq j+1\\), and put\n\\[\nb_{i}= \\begin{cases}a_{j}+\\Delta / 2, & \\text { if } i=j ; \\\\ a_{j+1}-\\Delta / 2+\\epsilon, & \\text { if } i=j+1 ; \\\\ a_{k}-\\epsilon, & \\text { if } i=k ; \\\\ a_{i}, & \\text { otherwise. }\\end{cases}\n\\]\n\nIf there is no \\(1 \\leqslant j \\leqslant n\\) such that \\(j \\in X\\) but \\(j+1 \\in X^{c}\\), there must be some \\(1<k \\leqslant n\\) such that \\(X=[k, n]\\) (certainly \\(X\\) cannot be empty). We must have \\(a_{1}>\\Delta\\), as otherwise considering \\(X \\cup\\{1\\}\\) contradicts \\(X\\) being \\(\\left(a_{i}\\right)\\)-minimising. Now put\n\\[\nb_{i}= \\begin{cases}a_{1}-\\Delta / 2, & \\text { if } i=1 ; \\\\ a_{n}+\\Delta / 2, & \\text { if } i=n ; \\\\ a_{i}, & \\text { otherwise } .\\end{cases}\n\\]\n\nSolution 3. Without loss of generality, assume \\(\\sum_{i \\in X} a_{i} \\leqslant 1\\), so \\(\\Delta \\geqslant 0\\). If \\(\\Delta=0\\) we can take \\(b_{i}=a_{i}\\), so now assume that \\(\\Delta>0\\).\n\nSuppose that there is some \\(k \\leqslant n\\) such that \\(|X \\cap[k, n]|>\\left|X^{c} \\cap[k, n]\\right|\\). If we choose the largest such \\(k\\) then \\(|X \\cap[k, n]|-\\left|X^{c} \\cap[k, n]\\right|=1\\). We can now find the required sequence ( \\(b_{i}\\) ) by starting with \\(c_{i}=a_{i}\\) for \\(i<k\\) and \\(c_{i}=a_{i}+\\Delta\\) for \\(i \\geqslant k\\), and then scaling as described above.\n\nIf no such \\(k\\) exists, we will derive a contradiction. For each \\(i \\in X\\) we can choose \\(i<j_{i} \\leqslant n\\) in such a way that \\(j_{i} \\in X^{c}\\) and all the \\(j_{i}\\) are different. (For instance, note that necessarily \\(n \\in X^{c}\\) and now just work downwards; each time an \\(i \\in X\\) is considered, let \\(j_{i}\\) be the least element of \\(X^{c}\\) greater than \\(i\\) and not yet used.) Let \\(Y\\) be the (possibly empty) subset of \\([1, n]\\) consisting of those elements in \\(X^{c}\\) that are also not one of the \\(j_{i}\\). In any case\n\\[\n\\Delta=\\sum_{i \\in X}\\left(a_{j_{i}}-a_{i}\\right)+\\sum_{j \\in Y} a_{j}\n\\]\nwhere each term in the sums is positive. Since \\(n \\geqslant 3\\) the total number of terms above is at least two. Take a least such term and its corresponding index \\(i\\) and consider the set \\(Z\\) which we form from \\(X\\) by removing \\(i\\) and adding \\(j_{i}\\) (if it is a term of the first type) or just by adding \\(j\\) if it is a term of the second type. The corresponding expression of \\(\\Delta\\) for \\(Z\\) has the sign of its least term changed, meaning that the sum is still nonnegative but strictly less than \\(\\Delta\\), which contradicts \\(X\\) being ( \\(a_{i}\\) )-minimising.\n\nSolution 4. This uses some similar ideas to Solution 3, but describes properties of the index sets \\(X\\) that are sufficient to describe a corresponding sequence ( \\(b_{i}\\) ) that is not derived from ( \\(a_{i}\\) ).\n\nNote that, for two subsets \\(X, Y\\) of \\([1, n]\\), the following are equivalent:\n- \\(|X \\cap[i, n]| \\leqslant|Y \\cap[i, n]|\\) for all \\(1 \\leqslant i \\leqslant n\\);\n- \\(Y\\) is at least as large as \\(X\\), and for all \\(1 \\leqslant j \\leqslant|Y|\\), the \\(j^{\\text {th }}\\) largest element of \\(Y\\) is at least as big as the \\(j^{\\text {th }}\\) largest element of \\(X\\);\n- there is an injective function \\(f: X \\rightarrow Y\\) such that \\(f(i) \\geqslant i\\) for all \\(i \\in X\\).\n\nIf these equivalent conditions are satisfied, we write \\(X \\leq Y\\). We write \\(X<Y\\) if \\(X \\leq Y\\) and \\(X \\neq Y\\).\n\nNote that if \\(X<Y\\), then \\(\\sum_{i \\in X} a_{i}<\\sum_{i \\in Y} a_{i}\\) (the second description above makes this clear).\nWe claim first that, if \\(n \\geqslant 3\\) and \\(X<X^{c}\\), then there exists \\(Y\\) with \\(X<Y<X^{c}\\). Indeed, as \\(|X| \\leqslant\\left|X^{c}\\right|\\), we have \\(\\left|X^{c}\\right| \\geqslant 2\\). Define \\(Y\\) to consist of the largest element of \\(X^{c}\\), together with all but the largest element of \\(X\\); it is clear both that \\(Y\\) is distinct from \\(X\\) and \\(X^{c}\\), and that \\(X \\leq Y \\leq X^{c}\\), which is what we need.\n\nBut, in this situation, we have\n\\[\n\\sum_{i \\in X} a_{i}<\\sum_{i \\in Y} a_{i}<\\sum_{i \\in X^{c}} a_{i} \\quad \\text { and } \\quad 1-\\sum_{i \\in X} a_{i}=-\\left(1-\\sum_{i \\in X^{c}} a_{i}\\right),\n\\]\nso \\(\\left|1-\\sum_{i \\in Y} a_{i}\\right|<\\left|1-\\sum_{i \\in X} a_{i}\\right|\\).\nHence if \\(X\\) is \\(\\left(a_{i}\\right)\\)-minimising, we do not have \\(X \\prec X^{c}\\), and similarly we do not have \\(X^{c}<X\\).\n\nConsidering the first description above, this immediately implies the following Claim.\nClaim. There exist \\(1 \\leqslant k, \\ell \\leqslant n\\) such that \\(|X \\cap[k, n]|>\\frac{n-k+1}{2}\\) and \\(|X \\cap[\\ell, n]|<\\frac{n-\\ell+1}{2}\\).\nWe now construct our sequence ( \\(b_{i}\\) ) using this claim. Let \\(k\\) and \\(\\ell\\) be the greatest values satisfying the claim, and without loss of generality suppose \\(k=n\\) and \\(\\ell<n\\) (otherwise replace \\(X\\) by its complement). As \\(\\ell\\) is maximal, \\(n-\\ell\\) is even and \\(|X \\cap[\\ell, n]|=\\frac{n-\\ell}{2}\\). For sufficiently small positive \\(\\epsilon\\), we take\n\\[\nb_{i}=i \\epsilon+ \\begin{cases}0, & \\text { if } i<\\ell \\\\ \\delta, & \\text { if } \\ell \\leqslant i \\leqslant n-1 \\\\ \\gamma, & \\text { if } i=n\\end{cases}\n\\]\n\nLet \\(M=\\sum_{i \\in X} i\\). So we require\n\\[\nM \\epsilon+\\left(\\frac{n-\\ell}{2}-1\\right) \\delta+\\gamma=1\n\\]\nand\n\\[\n\\frac{n(n+1)}{2} \\epsilon+(n-\\ell) \\delta+\\gamma=2\n\\]\n\nThese give\n\\[\n\\gamma=2 \\delta+\\left(\\frac{n(n+1)}{2}-2 M\\right) \\epsilon\n\\]\nand for sufficiently small positive \\(\\epsilon\\), solving for \\(\\gamma\\) and \\(\\delta\\) gives \\(0<\\delta<\\gamma\\) (since \\(\\epsilon=0\\) gives \\(\\delta=1 /\\left(\\frac{n-\\ell}{2}+1\\right)\\) and \\(\\left.\\gamma=2 \\delta\\right)\\), so the sequence is strictly increasing and has positive values.\n\nComment. This solution also shows that the claim gives a complete description of sets \\(X\\) that are \\(\\left(a_{i}\\right)\\)-minimising for some \\(\\left(a_{i}\\right)\\).\n\nAnother approach to proving the claim is as follows. We prove the existence of \\(\\ell\\) with the claimed property; the existence of \\(k\\) follows by considering the complement of \\(X\\).\n\nSuppose, for a contradiction, that for all \\(1 \\leqslant \\ell \\leqslant n\\) we have \\(|X \\cap[\\ell, n]| \\geqslant\\left\\lceil\\frac{n-\\ell+1}{2}\\right\\rceil\\). If we ever have strict inequality, consider the set \\(Y=\\{n, n-2, n-4, \\ldots\\}\\). This set may be obtained from \\(X\\) by possibly removing some elements and reducing the values of others. (To see this, consider the largest \\(k \\in X \\backslash Y\\), if any; remove it, and replace it by the greatest \\(j \\in X^{c}\\) with \\(j<k\\), if any. Such steps preserve the given inequality, and are possible until we reach the set \\(Y\\).) So if we had strict inequality, and so \\(X \\neq Y\\), we have\n\\[\n\\sum_{i \\in X} a_{i}>\\sum_{i \\in Y} a_{i}>1,\n\\]\ncontradicting \\(X\\) being \\(\\left(a_{i}\\right)\\)-minimising. Otherwise, we always have equality, meaning that \\(X=Y\\). But now consider \\(Z=Y \\cup\\{n-1\\} \\backslash\\{n\\}\\). Since \\(n \\geqslant 3\\), we have\n\\[\n\\sum_{i \\in Y} a_{i}>\\sum_{i \\in Z} a_{i}>\\sum_{i \\in Y^{c}} a_{i}=2-\\sum_{i \\in Y} a_{i},\n\\]\nand so \\(Z\\) contradicts \\(X\\) being ( \\(a_{i}\\) )-minimising.", "source_pdf": "imosl_2019.pdf", "notes": "fallback-regex"}
{"id": "IMOSL-2019-A4", "contest": "IMOSL", "year": "2019", "problem_number": "A4", "problem": "Let \\(n \\geqslant 2\\) be a positive integer and \\(a_{1}, a_{2}, \\ldots, a_{n}\\) be real numbers such that\n\\[\na_{1}+a_{2}+\\cdots+a_{n}=0\n\\]\n\nDefine the set \\(A\\) by\n\\[\nA=\\left\\{(i, j)\\left|1 \\leqslant i<j \\leqslant n,\\left|a_{i}-a_{j}\\right| \\geqslant 1\\right\\} .\\right.\n\\]\n\nProve that, if \\(A\\) is not empty, then\n\\[\n\\sum_{(i, j) \\in A} a_{i} a_{j}<0 .\n\\]\n(China)", "solution": "1. Define sets \\(B\\) and \\(C\\) by\n\\[\n\\begin{aligned}\n& B=\\left\\{(i, j)\\left|1 \\leqslant i, j \\leqslant n,\\left|a_{i}-a_{j}\\right| \\geqslant 1\\right\\}\\right. \\\\\n& C=\\left\\{(i, j)\\left|1 \\leqslant i, j \\leqslant n,\\left|a_{i}-a_{j}\\right|<1\\right\\}\\right.\n\\end{aligned}\n\\]\n\nWe have\n\\[\n\\begin{aligned}\n\\sum_{(i, j) \\in A} a_{i} a_{j} & =\\frac{1}{2} \\sum_{(i, j) \\in B} a_{i} a_{j} \\\\\n\\sum_{(i, j) \\in B} a_{i} a_{j} & =\\sum_{1 \\leqslant i, j \\leqslant n} a_{i} a_{j}-\\sum_{(i, j) \\notin B} a_{i} a_{j}=0-\\sum_{(i, j) \\in C} a_{i} a_{j}\n\\end{aligned}\n\\]\n\nSo it suffices to show that if \\(A\\) (and hence \\(B\\) ) are nonempty, then\n\\[\n\\sum_{(i, j) \\in C} a_{i} a_{j}>0\n\\]\n\nPartition the indices into sets \\(P, Q, R\\), and \\(S\\) such that\n\\[\n\\begin{array}{ll}\nP=\\left\\{i \\mid a_{i} \\leqslant-1\\right\\} & R=\\left\\{i \\mid 0<a_{i}<1\\right\\} \\\\\nQ=\\left\\{i \\mid-1<a_{i} \\leqslant 0\\right\\} & S=\\left\\{i \\mid 1 \\leqslant a_{i}\\right\\}\n\\end{array}\n\\]\n\nThen\n\\[\n\\sum_{(i, j) \\in C} a_{i} a_{j} \\geqslant \\sum_{i \\in P \\cup S} a_{i}^{2}+\\sum_{i, j \\in Q \\cup R} a_{i} a_{j}=\\sum_{i \\in P \\cup S} a_{i}^{2}+\\left(\\sum_{i \\in Q \\cup R} a_{i}\\right)^{2} \\geqslant 0 .\n\\]\n\nThe first inequality holds because all of the positive terms in the RHS are also in the LHS, and all of the negative terms in the LHS are also in the RHS. The first inequality attains equality only if both sides have the same negative terms, which implies \\(\\left|a_{i}-a_{j}\\right|<1\\) whenever \\(i, j \\in Q \\cup R\\); the second inequality attains equality only if \\(P=S=\\varnothing\\). But then we would have \\(A=\\varnothing\\). So \\(A\\) nonempty implies that the inequality holds strictly, as required.\n\nSolution 2. Consider \\(P, Q, R, S\\) as in Solution 1, set\n\\[\np=\\sum_{i \\in P} a_{i}, \\quad q=\\sum_{i \\in Q} a_{i}, \\quad r=\\sum_{i \\in R} a_{i}, \\quad s=\\sum_{i \\in S} a_{i}\n\\]\nand let\n\\[\nt_{+}=\\sum_{(i, j) \\in A, a_{i} a_{j} \\geqslant 0} a_{i} a_{j}, \\quad t_{-}=\\sum_{(i, j) \\in A, a_{i} a_{j} \\leqslant 0} a_{i} a_{j} .\n\\]\n\nWe know that \\(p+q+r+s=0\\), and we need to prove that \\(t_{+}+t_{-}<0\\).\nNotice that \\(t_{+} \\leqslant p^{2} / 2+p q+r s+s^{2} / 2\\) (with equality only if \\(p=s=0\\) ), and \\(t_{-} \\leqslant p r+p s+q s\\) (with equality only if there do not exist \\(i \\in Q\\) and \\(j \\in R\\) with \\(a_{j}-a_{i}>1\\) ). Therefore,\n\\[\nt_{+}+t_{-} \\leqslant \\frac{p^{2}+s^{2}}{2}+p q+r s+p r+p s+q s=\\frac{(p+q+r+s)^{2}}{2}-\\frac{(q+r)^{2}}{2}=-\\frac{(q+r)^{2}}{2} \\leqslant 0\n\\]\n\nIf \\(A\\) is not empty and \\(p=s=0\\), then there must exist \\(i \\in Q, j \\in R\\) with \\(\\left|a_{i}-a_{j}\\right|>1\\), and hence the earlier equality conditions cannot both occur.\n\nComment. The RHS of the original inequality cannot be replaced with any constant \\(c<0\\) (independent of \\(n\\) ). Indeed, take\n\\[\na_{1}=-\\frac{n}{n+2}, a_{2}=\\cdots=a_{n-1}=\\frac{1}{n+2}, a_{n}=\\frac{2}{n+2}\n\\]\n\nThen \\(\\sum_{(i, j) \\in A} a_{i} a_{j}=-\\frac{2 n}{(n+2)^{2}}\\), which converges to zero as \\(n \\rightarrow \\infty\\).", "source_pdf": "imosl_2019.pdf", "notes": "fallback-regex"}
{"id": "IMOSL-2019-A5", "contest": "IMOSL", "year": "2019", "problem_number": "A5", "problem": "Let \\(x_{1}, x_{2}, \\ldots, x_{n}\\) be different real numbers. Prove that\n\\[\n\\sum_{1 \\leqslant i \\leqslant n} \\prod_{j \\neq i} \\frac{1-x_{i} x_{j}}{x_{i}-x_{j}}= \\begin{cases}0, & \\text { if } n \\text { is even } \\\\ 1, & \\text { if } n \\text { is odd }\\end{cases}\n\\]\n(Kazakhstan)", "solution": "Common remarks. Let \\(G\\left(x_{1}, x_{2}, \\ldots, x_{n}\\right)\\) be the function of the \\(n\\) variables \\(x_{1}, x_{2}, \\ldots, x_{n}\\) on the LHS of the required identity.\n\n1 (Lagrange interpolation). Since both sides of the identity are rational functions, it suffices to prove it when all \\(x_{i} \\notin\\{ \\pm 1\\}\\). Define\n\\[\nf(t)=\\prod_{i=1}^{n}\\left(1-x_{i} t\\right)\n\\]\nand note that\n\\[\nf\\left(x_{i}\\right)=\\left(1-x_{i}^{2}\\right) \\prod_{j \\neq i} 1-x_{i} x_{j}\n\\]\n\nUsing the nodes \\(+1,-1, x_{1}, \\ldots, x_{n}\\), the Lagrange interpolation formula gives us the following expression for \\(f\\) :\n\\[\n\\sum_{i=1}^{n} f\\left(x_{i}\\right) \\frac{(x-1)(x+1)}{\\left(x_{i}-1\\right)\\left(x_{i}+1\\right)} \\prod_{j \\neq i} \\frac{x-x_{j}}{x_{i}-x_{j}}+f(1) \\frac{x+1}{1+1} \\prod_{1 \\leqslant i \\leqslant n} \\frac{x-x_{i}}{1-x_{i}}+f(-1) \\frac{x-1}{-1-1} \\prod_{1 \\leqslant i \\leqslant n} \\frac{x-x_{i}}{1-x_{i}} .\n\\]\n\nThe coefficient of \\(t^{n+1}\\) in \\(f(t)\\) is 0 , since \\(f\\) has degree \\(n\\). The coefficient of \\(t^{n+1}\\) in the above expression of \\(f\\) is\n\\[\n\\begin{aligned}\n0 & =\\sum_{1 \\leqslant i \\leqslant n} \\frac{f\\left(x_{i}\\right)}{\\prod_{j \\neq i}\\left(x_{i}-x_{j}\\right) \\cdot\\left(x_{i}-1\\right)\\left(x_{i}+1\\right)}+\\frac{f(1)}{\\prod_{1 \\leqslant j \\leqslant n}\\left(1-x_{j}\\right) \\cdot(1+1)}+\\frac{f(-1)}{\\prod_{1 \\leqslant j \\leqslant n}\\left(-1-x_{j}\\right) \\cdot(-1-1)} \\\\\n& =-G\\left(x_{1}, \\ldots, x_{n}\\right)+\\frac{1}{2}+\\frac{(-1)^{n+1}}{2}\n\\end{aligned}\n\\]\n\nComment. The main difficulty is to think of including the two extra nodes \\(\\pm 1\\) and evaluating the coefficient \\(t^{n+1}\\) in \\(f\\) when \\(n+1\\) is higher than the degree of \\(f\\).\n\nIt is possible to solve the problem using Lagrange interpolation on the nodes \\(x_{1}, \\ldots, x_{n}\\), but the definition of the polynomial being interpolated should depend on the parity of \\(n\\). For \\(n\\) even, consider the polynomial\n\\[\nP(x)=\\prod_{i}\\left(1-x x_{i}\\right)-\\prod_{i}\\left(x-x_{i}\\right)\n\\]\n\nLagrange interpolation shows that \\(G\\) is the coefficient of \\(x^{n-1}\\) in the polynomial \\(P(x) /\\left(1-x^{2}\\right)\\), i.e. 0 . For \\(n\\) odd, consider the polynomial\n\\[\nP(x)=\\prod_{i}\\left(1-x x_{i}\\right)-x \\prod_{i}\\left(x-x_{i}\\right) .\n\\]\n\nNow \\(G\\) is the coefficient of \\(x^{n-1}\\) in \\(P(x) /\\left(1-x^{2}\\right)\\), which is 1.\n\nSolution 2 (using symmetries). Observe that \\(G\\) is symmetric in the variables \\(x_{1}, \\ldots, x_{n}\\). Define \\(V=\\prod_{i<j}\\left(x_{j}-x_{i}\\right)\\) and let \\(F=G \\cdot V\\), which is a polynomial in \\(x_{1}, \\ldots, x_{n}\\). Since \\(V\\) is alternating, \\(F\\) is also alternating (meaning that, if we exchange any two variables, then \\(F\\) changes sign). Every alternating polynomial in \\(n\\) variables \\(x_{1}, \\ldots, x_{n}\\) vanishes when any two variables \\(x_{i}, x_{j}(i \\neq j)\\) are equal, and is therefore divisible by \\(x_{i}-x_{j}\\) for each pair \\(i \\neq j\\). Since these linear factors are pairwise coprime, \\(V\\) divides \\(F\\) exactly as a polynomial. Thus \\(G\\) is in fact a symmetric polynomial in \\(x_{1}, \\ldots, x_{n}\\).\n\nNow observe that if all \\(x_{i}\\) are nonzero and we set \\(y_{i}=1 / x_{i}\\) for \\(i=1, \\ldots, n\\), then we have\n\\[\n\\frac{1-y_{i} y_{j}}{y_{i}-y_{j}}=\\frac{1-x_{i} x_{j}}{x_{i}-x_{j}},\n\\]\nso that\n\\[\nG\\left(\\frac{1}{x_{1}}, \\ldots, \\frac{1}{x_{n}}\\right)=G\\left(x_{1}, \\ldots, x_{n}\\right) .\n\\]\n\nBy continuity this is an identity of rational functions. Since \\(G\\) is a polynomial, it implies that \\(G\\) is constant. (If \\(G\\) were not constant, we could choose a point ( \\(c_{1}, \\ldots, c_{n}\\) ) with all \\(c_{i} \\neq 0\\), such that \\(G\\left(c_{1}, \\ldots, c_{n}\\right) \\neq G(0, \\ldots, 0)\\); then \\(g(x):=G\\left(c_{1} x, \\ldots, c_{n} x\\right)\\) would be a nonconstant polynomial in the variable \\(x\\), so \\(|g(x)| \\rightarrow \\infty\\) as \\(x \\rightarrow \\infty\\), hence \\(\\left|G\\left(\\frac{y}{c_{1}}, \\ldots, \\frac{y}{c_{n}}\\right)\\right| \\rightarrow \\infty\\) as \\(y \\rightarrow 0\\), which is impossible since \\(G\\) is a polynomial.)\n\nWe may identify the constant by substituting \\(x_{i}=\\zeta^{i}\\), where \\(\\zeta\\) is a primitive \\(n^{\\text {th }}\\) root of unity in \\(\\mathbb{C}\\). In the \\(i^{\\text {th }}\\) term in the sum in the original expression we have a factor \\(1-\\zeta^{i} \\zeta^{n-i}=0\\), unless \\(i=n\\) or \\(2 i=n\\). In the case where \\(n\\) is odd, the only exceptional term is \\(i=n\\), which gives the value \\(\\prod_{j \\neq n} \\frac{1-\\zeta^{j}}{1-\\zeta^{j}}=1\\). When \\(n\\) is even, we also have the term \\(\\prod_{j \\neq \\frac{n}{2}} \\frac{1+\\zeta^{j}}{-1-\\zeta^{j}}=(-1)^{n-1}=-1\\), so the sum is 0 .\n\nComment. If we write out an explicit expression for \\(F\\),\n\\[\nF=\\sum_{1 \\leqslant i \\leqslant n}(-1)^{n-i} \\prod_{\\substack{j<k \\\\ j, k \\neq i}}\\left(x_{k}-x_{j}\\right) \\prod_{j \\neq i}\\left(1-x_{i} x_{j}\\right)\n\\]\nthen to prove directly that \\(F\\) vanishes when \\(x_{i}=x_{j}\\) for some \\(i \\neq j\\), but no other pair of variables coincide, we have to check carefully that the two nonzero terms in this sum cancel.\n\nA different and slightly less convenient way to identify the constant is to substitute \\(x_{i}=1+\\epsilon \\zeta^{i}\\), and throw away terms that are \\(O(\\epsilon)\\) as \\(\\epsilon \\rightarrow 0\\).\n\nSolution 3 (breaking symmetry). Consider \\(G\\) as a rational function in \\(x_{n}\\) with coefficients that are rational functions in the other variables. We can write\n\\[\nG\\left(x_{1}, \\ldots, x_{n}\\right)=\\frac{P\\left(x_{n}\\right)}{\\prod_{j \\neq n}\\left(x_{n}-x_{j}\\right)}\n\\]\nwhere \\(P\\left(x_{n}\\right)\\) is a polynomial in \\(x_{n}\\) whose coefficients are rational functions in the other variables. We then have\n\\[\nP\\left(x_{n}\\right)=\\left(\\prod_{j \\neq n}\\left(1-x_{n} x_{j}\\right)\\right)+\\sum_{1 \\leqslant i \\leqslant n-1}\\left(x_{i} x_{n}-1\\right)\\left(\\prod_{j \\neq i, n}\\left(x_{n}-x_{j}\\right)\\right)\\left(\\prod_{j \\neq i, n} \\frac{1-x_{i} x_{j}}{x_{i}-x_{j}}\\right) .\n\\]\n\nFor any \\(k \\neq n\\), substituting \\(x_{n}=x_{k}\\) (which is valid when manipulating the numerator \\(P\\left(x_{n}\\right)\\)\non its own), we have (noting that \\(x_{n}-x_{j}\\) vanishes when \\(j=k\\) )\n\\[\n\\begin{aligned}\nP\\left(x_{k}\\right) & =\\left(\\prod_{j \\neq n}\\left(1-x_{k} x_{j}\\right)\\right)+\\sum_{1 \\leqslant i \\leqslant n-1}\\left(x_{i} x_{k}-1\\right)\\left(\\prod_{j \\neq i, n}\\left(x_{k}-x_{j}\\right)\\right)\\left(\\prod_{j \\neq i, n} \\frac{1-x_{i} x_{j}}{x_{i}-x_{j}}\\right) \\\\\n& =\\left(\\prod_{j \\neq n}\\left(1-x_{k} x_{j}\\right)\\right)+\\left(x_{k}^{2}-1\\right)\\left(\\prod_{j \\neq k, n}\\left(x_{k}-x_{j}\\right)\\right)\\left(\\prod_{j \\neq k, n} \\frac{1-x_{k} x_{j}}{x_{k}-x_{j}}\\right) \\\\\n& =\\left(\\prod_{j \\neq n}\\left(1-x_{k} x_{j}\\right)\\right)+\\left(x_{k}^{2}-1\\right)\\left(\\prod_{j \\neq k, n}\\left(1-x_{k} x_{j}\\right)\\right) \\\\\n& =0\n\\end{aligned}\n\\]\n\nNote that \\(P\\) is a polynomial in \\(x_{n}\\) of degree \\(n-1\\). For any choice of distinct real numbers \\(x_{1}, \\ldots, x_{n-1}, P\\) has those real numbers as its roots, and the denominator has the same degree and the same roots. This shows that \\(G\\) is constant in \\(x_{n}\\), for any fixed choice of distinct \\(x_{1}, \\ldots, x_{n-1}\\). Now, \\(G\\) is symmetric in all \\(n\\) variables, so it must be also be constant in each of the other variables. \\(G\\) is therefore a constant that depends only on \\(n\\). The constant may be identified as in the previous solution.\n\nComment. There is also a solution in which we recognise the expression for \\(F\\) in the comment after Solution 2 as the final column expansion of a certain matrix obtained by modifying the final column of the Vandermonde matrix. The task is then to show that the matrix can be modified by column operations either to make the final column identically zero (in the case where \\(n\\) even) or to recover the Vandermonde matrix (in the case where \\(n\\) odd). The polynomial \\(P /\\left(1-x^{2}\\right)\\) is helpful for this task, where \\(P\\) is the parity-dependent polynomial defined in the comment after Solution 1.", "source_pdf": "imosl_2019.pdf", "notes": "fallback-regex"}
{"id": "IMOSL-2019-A6", "contest": "IMOSL", "year": "2019", "problem_number": "A6", "problem": "A polynomial \\(P(x, y, z)\\) in three variables with real coefficients satisfies the identities\n\\[\nP(x, y, z)=P(x, y, x y-z)=P(x, z x-y, z)=P(y z-x, y, z) .\n\\]\n\nProve that there exists a polynomial \\(F(t)\\) in one variable such that\n\\[\nP(x, y, z)=F\\left(x^{2}+y^{2}+z^{2}-x y z\\right) .\n\\]\n(Russia)", "solution": "Common remarks. The polynomial \\(x^{2}+y^{2}+z^{2}-x y z\\) satisfies the condition (*), so every polynomial of the form \\(F\\left(x^{2}+y^{2}+z^{2}-x y z\\right)\\) does satisfy \\((*)\\). We will use without comment the fact that two polynomials have the same coefficients if and only if they are equal as functions.\n\n1. In the first two steps, we deal with any polynomial \\(P(x, y, z)\\) satisfying \\(P(x, y, z)= P(x, y, x y-z)\\). Call such a polynomial weakly symmetric, and call a polynomial satisfying the full conditions in the problem symmetric.\n\nStep 1. We start with the description of weakly symmetric polynomials. We claim that they are exactly the polynomials in \\(x, y\\), and \\(z(x y-z)\\). Clearly, all such polynomials are weakly symmetric. For the converse statement, consider \\(P_{1}(x, y, z):=P\\left(x, y, z+\\frac{1}{2} x y\\right)\\), which satisfies \\(P_{1}(x, y, z)=P_{1}(x, y,-z)\\) and is therefore a polynomial in \\(x, y\\), and \\(z^{2}\\). This means that \\(P\\) is a polynomial in \\(x, y\\), and \\(\\left(z-\\frac{1}{2} x y\\right)^{2}=-z(x y-z)+\\frac{1}{4} x^{2} y^{2}\\), and therefore a polynomial in \\(x, y\\), and \\(z(x y-z)\\).\nStep 2. Suppose that \\(P\\) is weakly symmetric. Consider the monomials in \\(P(x, y, z)\\) of highest total degree. Our aim is to show that in each such monomial \\(\\mu x^{a} y^{b} z^{c}\\) we have \\(a, b \\geqslant c\\). Consider the expansion\n\\[\nP(x, y, z)=\\sum_{i, j, k} \\mu_{i j k} x^{i} y^{j}(z(x y-z))^{k} .\n\\]\n\nThe maximal total degree of a summand in (1.1) is \\(m=\\max _{i, j, k: \\mu_{i j k} \\neq 0}(i+j+3 k)\\). Now, for any \\(i, j, k\\) satisfying \\(i+j+3 k=m\\) the summand \\(\\mu_{i, j, k} x^{i} y^{j}(z(x y-z))^{k}\\) has leading term of the form \\(\\mu x^{i+k} y^{j+k} z^{k}\\). No other nonzero summand in (1.1) may have a term of this form in its expansion, hence this term does not cancel in the whole sum. Therefore, \\(\\operatorname{deg} P=m\\), and the leading component of \\(P\\) is exactly\n\\[\n\\sum_{i+j+3 k=m} \\mu_{i, j, k} x^{i+k} y^{j+k} z^{k}\n\\]\nand each summand in this sum satisfies the condition claimed above.\nStep 3. We now prove the problem statement by induction on \\(m=\\operatorname{deg} P\\). For \\(m=0\\) the claim is trivial. Consider now a symmetric polynomial \\(P\\) with \\(\\operatorname{deg} P>0\\). By Step 2, each of its monomials \\(\\mu x^{a} y^{b} z^{c}\\) of the highest total degree satisfies \\(a, b \\geqslant c\\). Applying other weak symmetries, we obtain \\(a, c \\geqslant b\\) and \\(b, c \\geqslant a\\); therefore, \\(P\\) has a unique leading monomial of the form \\(\\mu(x y z)^{c}\\). The polynomial \\(P_{0}(x, y, z)=P(x, y, z)-\\mu\\left(x y z-x^{2}-y^{2}-z^{2}\\right)^{c}\\) has smaller total degree. Since \\(P_{0}\\) is symmetric, it is representable as a polynomial function of \\(x y z-x^{2}-y^{2}-z^{2}\\). Then \\(P\\) is also of this form, completing the inductive step.\n\nComment. We could alternatively carry out Step 1 by an induction on \\(n=\\operatorname{deg}_{z} P\\), in a manner similar to Step 3. If \\(n=0\\), the statement holds. Assume that \\(n>0\\) and check the leading component of \\(P\\) with respect to \\(z\\) :\n\\[\nP(x, y, z)=Q_{n}(x, y) z^{n}+R(x, y, z),\n\\]\nwhere \\(\\operatorname{deg}_{z} R<n\\). After the change \\(z \\mapsto x y-z\\), the leading component becomes \\(Q_{n}(x, y)(-z)^{n}\\); on the other hand, it should remain the same. Hence \\(n\\) is even. Now consider the polynomial\n\\[\nP_{0}(x, y, z)=P(x, y, z)-Q_{n}(x, y) \\cdot(z(z-x y))^{n / 2} .\n\\]\n\nIt is also weakly symmetric, and \\(\\operatorname{deg}_{z} P_{0}<n\\). By the inductive hypothesis, it has the form \\(P_{0}(x, y, z)= S(x, y, z(z-x y))\\). Hence the polynomial\n\\[\nP(x, y, z)=S(x, y, z(x y-z))+Q_{n}(x, y)(z(z-x y))^{n / 2}\n\\]\nalso has this form. This completes the inductive step.\nSolution 2. We will rely on the well-known identity\n\\[\n\\cos ^{2} u+\\cos ^{2} v+\\cos ^{2} w-2 \\cos u \\cos v \\cos w-1=0 \\quad \\text { whenever } u+v+w=0 .\n\\]\n\nClaim 1. The polynomial \\(P(x, y, z)\\) is constant on the surface\n\\[\n\\mathfrak{S}=\\{(2 \\cos u, 2 \\cos v, 2 \\cos w): u+v+w=0\\} .\n\\]\n\nProof. Notice that for \\(x=2 \\cos u, y=2 \\cos v, z=2 \\cos w\\), the Vieta jumps \\(x \\mapsto y z-x\\), \\(y \\mapsto z x-y, z \\mapsto x y-z\\) in (*) replace ( \\(u, v, w\\) ) by ( \\(v-w,-v, w\\) ), ( \\(u, w-u,-w\\) ) and ( \\(-u, v, u-v\\) ), respectively. For example, for the first type of jump we have\n\\[\ny z-x=4 \\cos v \\cos w-2 \\cos u=2 \\cos (v+w)+2 \\cos (v-w)-2 \\cos u=2 \\cos (v-w) .\n\\]\n\nDefine \\(G(u, v, w)=P(2 \\cos u, 2 \\cos v, 2 \\cos w)\\). For \\(u+v+w=0\\), the jumps give\n\\[\n\\begin{aligned}\nG(u, v, w) & =G(v-w,-v, w)=G(w-v,-v,(v-w)-(-v))=G(-u-2 v,-v, 2 v-w) \\\\\n& =G(u+2 v, v, w-2 v)\n\\end{aligned}\n\\]\n\nBy induction,\n\\[\nG(u, v, w)=G(u+2 k v, v, w-2 k v) \\quad(k \\in \\mathbb{Z}) .\n\\]\n\nSimilarly,\n\\[\nG(u, v, w)=G(u, v-2 \\ell u, w+2 \\ell u) \\quad(\\ell \\in \\mathbb{Z}) .\n\\]\n\nAnd, of course, we have\n\\[\nG(u, v, w)=G(u+2 p \\pi, v+2 q \\pi, w-2(p+q) \\pi) \\quad(p, q \\in \\mathbb{Z}) .\n\\]\n\nTake two nonzero real numbers \\(u, v\\) such that \\(u, v\\) and \\(\\pi\\) are linearly independent over \\(\\mathbb{Q}\\). By combining (2.2-2.4), we can see that \\(G\\) is constant on a dense subset of the plane \\(u+v+w=0\\). By continuity, \\(G\\) is constant on the entire plane and therefore \\(P\\) is constant on \\(\\mathfrak{S}\\).\nClaim 2. The polynomial \\(T(x, y, z)=x^{2}+y^{2}+z^{2}-x y z-4\\) divides \\(P(x, y, z)-P(2,2,2)\\).\nProof. By dividing \\(P\\) by \\(T\\) with remainders, there exist some polynomials \\(R(x, y, z), A(y, z)\\) and \\(B(y, z)\\) such that\n\\[\nP(x, y, z)-P(2,2,2)=T(x, y, z) \\cdot R(x, y, z)+A(y, z) x+B(y, z) .\n\\]\n\nOn the surface \\(\\mathfrak{S}\\) the LHS of (2.5) is zero by Claim 1 (since \\((2,2,2) \\in \\mathfrak{S}\\) ) and \\(T=0\\) by (2.1). Hence, \\(A(y, z) x+B(y, z)\\) vanishes on \\(\\mathfrak{S}\\).\n\nNotice that for every \\(y=2 \\cos v\\) and \\(z=2 \\cos w\\) with \\(\\frac{\\pi}{3}<v, w<\\frac{2 \\pi}{3}\\), there are two distinct values of \\(x\\) such that \\((x, y, z) \\in \\mathfrak{S}\\), namely \\(x_{1}=2 \\cos (v+w)\\) (which is negative), and \\(x_{2}=2 \\cos (v-w)\\) (which is positive). This can happen only if \\(A(y, z)=B(y, z)=0\\). Hence, \\(A(y, z)=B(y, z)=0\\) for \\(|y|<1,|z|<1\\). The polynomials \\(A\\) and \\(B\\) vanish on an open set, so \\(A\\) and \\(B\\) are both the zero polynomial.\n\nThe quotient \\((P(x, y, z)-P(2,2,2)) / T(x, y, z)\\) is a polynomial of lower degree than \\(P\\) and it also satisfies (*). The problem statement can now be proven by induction on the degree of \\(P\\).\n\nComment. In the proof of (2.2) and (2.3) we used two consecutive Vieta jumps; in fact from (*) we used only \\(P(x, y, x y-z)=P(x, z x-y, z)=P(y z-x, y, z)\\).\n\nSolution 3 (using algebraic geometry, just for interest). Let \\(Q=x^{2}+y^{2}+z^{2}-x y z\\) and let \\(t \\in \\mathbb{C}\\). Checking where \\(Q-t, \\frac{\\partial Q}{\\partial x}, \\frac{\\partial Q}{\\partial y}\\) and \\(\\frac{\\partial Q}{\\partial z}\\) vanish simultaneously, we find that the surface \\(Q=t\\) is smooth except for the cases \\(t=0\\), when the only singular point is \\((0,0,0)\\), and \\(t=4\\), when the four points \\(( \\pm 2, \\pm 2, \\pm 2)\\) that satisfy \\(x y z=8\\) are the only singular points. The singular points are the fixed points of the group \\(\\Gamma\\) of polynomial automorphisms of \\(\\mathbb{C}^{3}\\) generated by the three Vieta involutions\n\\[\n\\iota_{1}:(x, y, z) \\mapsto(x, y, x y-z), \\quad \\iota_{2}:(x, y, z) \\mapsto(x, x z-y, z), \\quad \\iota_{3}:(x, y, z) \\mapsto(y z-x, y, z) .\n\\]\n\\(\\Gamma\\) acts on each surface \\(\\mathcal{V}_{t}: Q-t=0\\). If \\(Q-t\\) were reducible then the surface \\(Q=t\\) would contain a curve of singular points. Therefore \\(Q-t\\) is irreducible in \\(\\mathbb{C}[x, y, z]\\). (One can also prove algebraically that \\(Q-t\\) is irreducible, for example by checking that its discriminant as a quadratic polynomial in \\(x\\) is not a square in \\(\\mathbb{C}[y, z]\\), and likewise for the other two variables.) In the following solution we will only use the algebraic surface \\(\\mathcal{V}_{0}\\).\n\nLet \\(U\\) be the \\(\\Gamma\\)-orbit of ( \\(3,3,3\\) ). Consider \\(\\iota_{3} \\circ \\iota_{2}\\), which leaves \\(z\\) invariant. For each fixed value of \\(z, \\iota_{3} \\circ \\iota_{2}\\) acts linearly on ( \\(x, y\\) ) by the matrix\n\\[\nM_{z}:=\\left(\\begin{array}{cc}\nz^{2}-1 & -z \\\\\nz & -1\n\\end{array}\\right) .\n\\]\n\nThe reverse composition \\(\\iota_{2} \\circ \\iota_{3}\\) acts by \\(M_{z}^{-1}=M_{z}^{\\text {adj }}\\). Note \\(\\operatorname{det} M_{z}=1\\) and \\(\\operatorname{tr} M_{z}=z^{2}-2\\). When \\(z\\) does not lie in the real interval [-2,2], the eigenvalues of \\(M_{z}\\) do not have absolute value 1 , so every orbit of the group generated by \\(M_{z}\\) on \\(\\mathbb{C}^{2} \\backslash\\{(0,0)\\}\\) is unbounded. For example, fixing \\(z=3\\) we find \\(\\left(3 F_{2 k+1}, 3 F_{2 k-1}, 3\\right) \\in U\\) for every \\(k \\in \\mathbb{Z}\\), where \\(\\left(F_{n}\\right)_{n \\in \\mathbb{Z}}\\) is the Fibonacci sequence with \\(F_{0}=0, F_{1}=1\\).\n\nNow we may start at any point ( \\(3 F_{2 k+1}, 3 F_{2 k-1}, 3\\) ) and iteratively apply \\(\\iota_{1} \\circ \\iota_{2}\\) to generate another infinite sequence of distinct points of \\(U\\), Zariski dense in the hyperbola cut out of \\(\\mathcal{V}_{0}\\) by the plane \\(x-3 F_{2 k+1}=0\\). (The plane \\(x=a\\) cuts out an irreducible conic when \\(a \\notin\\{-2,0,2\\}\\).) Thus the Zariski closure \\(\\bar{U}\\) of \\(U\\) contains infinitely many distinct algebraic curves in \\(\\mathcal{V}_{0}\\). Since \\(\\mathcal{V}_{0}\\) is an irreducible surface this implies that \\(\\bar{U}=\\mathcal{V}_{0}\\).\n\nFor any polynomial \\(P\\) satisfying (*), we have \\(P-P(3,3,3)=0\\) at each point of \\(U\\). Since \\(\\bar{U}=\\mathcal{V}_{0}, P-P(3,3,3)\\) vanishes on \\(\\mathcal{V}_{0}\\). Then Hilbert's Nullstellensatz and the irreducibility of \\(Q\\) imply that \\(P-P(3,3,3)\\) is divisible by \\(Q\\). Now \\((P-P(3,3,3)) / Q\\) is a polynomial also satisfying (*), so we may complete the proof by an induction on the total degree, as in the other solutions.\n\nComment. We remark that Solution 2 used a trigonometric parametrisation of a real component of \\(\\mathcal{V}_{4}\\); in contrast \\(\\mathcal{V}_{0}\\) is birationally equivalent to the projective space \\(\\mathbb{P}^{2}\\) under the maps\n\\[\n(x, y, z) \\rightarrow(x: y: z), \\quad(a: b: c) \\rightarrow\\left(\\frac{a^{2}+b^{2}+c^{2}}{b c}, \\frac{a^{2}+b^{2}+c^{2}}{a c}, \\frac{a^{2}+b^{2}+c^{2}}{a b}\\right) .\n\\]\n\nThe set \\(U\\) in Solution 3 is contained in \\(\\mathbb{Z}^{3}\\) so it is nowhere dense in \\(\\mathcal{V}_{0}\\) in the classical topology.\nComment (background to the problem). A triple \\((a, b, c) \\in \\mathbb{Z}^{3}\\) is called a Markov triple if \\(a^{2}+b^{2}+c^{2}=3 a b c\\), and an integer that occurs as a coordinate of some Markov triple is called a Markov number. (The spelling Markoff is also frequent.) Markov triples arose in A. Markov's work in the 1870s on the reduction theory of indefinite binary quadratic forms. For every Markov triple,\n( \\(3 a, 3 b, 3 c\\) ) lies on \\(Q=0\\). It is well known that all nonzero Markov triples can be generated from ( \\(1,1,1\\) ) by sequences of Vieta involutions, which are the substitutions described in equation ( \\(*\\) ) in the problem statement. There has been recent work by number theorists about the properties of Markov numbers (see for example Jean Bourgain, Alex Gamburd and Peter Sarnak, Markoff triples and strong approximation, Comptes Rendus Math. 345, no. 2, 131-135 (2016), arXiv:1505.06411). Each Markov number occurs in infinitely many triples, but a famous old open problem is the unicity conjecture, which asserts that each Markov number occurs in only one Markov triple (up to permutations and sign changes) as the largest coordinate in absolute value in that triple. It is a standard fact in the modern literature on Markov numbers that the Markov triples are Zariski dense in the Markov surface. Proving this is the main work of Solution 3. Algebraic geometry is definitely off-syllabus for the IMO, and one still has to work a bit to prove the Zariski density. On the other hand the approaches of Solutions 1 and 2 are elementary and only use tools expected to be known by IMO contestants. Therefore we do not think that the existence of a solution using algebraic geometry necessarily makes this problem unsuitable for the IMO.", "source_pdf": "imosl_2019.pdf", "notes": "fallback-regex"}
{"id": "IMOSL-2019-A7", "contest": "IMOSL", "year": "2019", "problem_number": "A7", "problem": "Let \\(\\mathbb{Z}\\) be the set of integers. We consider functions \\(f: \\mathbb{Z} \\rightarrow \\mathbb{Z}\\) satisfying\n\\[\nf(f(x+y)+y)=f(f(x)+y)\n\\]\nfor all integers \\(x\\) and \\(y\\). For such a function, we say that an integer \\(v\\) is \\(f\\)-rare if the set\n\\[\nX_{v}=\\{x \\in \\mathbb{Z}: f(x)=v\\}\n\\]\nis finite and nonempty.\n(a) Prove that there exists such a function \\(f\\) for which there is an \\(f\\)-rare integer.\n(b) Prove that no such function \\(f\\) can have more than one \\(f\\)-rare integer.\n(Netherlands)", "solution": "1. a) Let \\(f\\) be the function where \\(f(0)=0\\) and \\(f(x)\\) is the largest power of 2 dividing \\(2 x\\) for \\(x \\neq 0\\). The integer 0 is evidently \\(f\\)-rare, so it remains to verify the functional equation.\n\nSince \\(f(2 x)=2 f(x)\\) for all \\(x\\), it suffices to verify the functional equation when at least one of \\(x\\) and \\(y\\) is odd (the case \\(x=y=0\\) being trivial). If \\(y\\) is odd, then we have\n\\[\nf(f(x+y)+y)=2=f(f(x)+y)\n\\]\nsince all the values attained by \\(f\\) are even. If, on the other hand, \\(x\\) is odd and \\(y\\) is even, then we already have\n\\[\nf(x+y)=2=f(x)\n\\]\nfrom which the functional equation follows immediately.\nb) An easy inductive argument (substituting \\(x+k y\\) for \\(x\\) ) shows that\n\\[\nf(f(x+k y)+y)=f(f(x)+y)\n\\]\nfor all integers \\(x, y\\) and \\(k\\). If \\(v\\) is an \\(f\\)-rare integer and \\(a\\) is the least element of \\(X_{v}\\), then by substituting \\(y=a-f(x)\\) in the above, we see that\n\\[\nf(x+k \\cdot(a-f(x)))-f(x)+a \\in X_{v}\n\\]\nfor all integers \\(x\\) and \\(k\\), so that in particular\n\\[\nf(x+k \\cdot(a-f(x))) \\geqslant f(x)\n\\]\nfor all integers \\(x\\) and \\(k\\), by assumption on \\(a\\). This says that on the (possibly degenerate) arithmetic progression through \\(x\\) with common difference \\(a-f(x)\\), the function \\(f\\) attains its minimal value at \\(x\\).\n\nRepeating the same argument with \\(a\\) replaced by the greatest element \\(b\\) of \\(X_{v}\\) shows that\n\\[\nf(x+k \\cdot(b-f(x)) \\leqslant f(x)\n\\]\nfor all integers \\(x\\) and \\(k\\). Combined with the above inequality, we therefore have\n\\[\nf(x+k \\cdot(a-f(x)) \\cdot(b-f(x)))=f(x)\n\\]\nfor all integers \\(x\\) and \\(k\\).\nThus if \\(f(x) \\neq a, b\\), then the set \\(X_{f(x)}\\) contains a nondegenerate arithmetic progression, so is infinite. So the only possible \\(f\\)-rare integers are \\(a\\) and \\(b\\).\n\nIn particular, the \\(f\\)-rare integer \\(v\\) we started with must be one of \\(a\\) or \\(b\\), so that \\(f(v)= f(a)=f(b)=v\\). This means that there cannot be any other \\(f\\)-rare integers \\(v^{\\prime}\\), as they would on the one hand have to be either \\(a\\) or \\(b\\), and on the other would have to satisfy \\(f\\left(v^{\\prime}\\right)=v^{\\prime}\\). Thus \\(v\\) is the unique \\(f\\)-rare integer.\n\nComment 1. If \\(f\\) is a solution to the functional equation, then so too is any conjugate of \\(f\\) by a translation, i.e. any function \\(x \\mapsto f(x+n)-n\\) for an integer \\(n\\). Thus in proving part (b), one is free to consider only functions \\(f\\) for which 0 is \\(f\\)-rare, as in the following solution.\n\nSolution 2, part (b) only. Suppose \\(v\\) is \\(f\\)-rare, and let \\(a\\) and \\(b\\) be the least and greatest elements of \\(X_{v}\\), respectively. Substituting \\(x=v\\) and \\(y=a-v\\) into the equation shows that\n\\[\nf(v)-v+a \\in X_{v}\n\\]\nand in particular \\(f(v) \\geqslant v\\). Repeating the same argument with \\(x=v\\) and \\(y=b-v\\) shows that \\(f(v) \\leqslant v\\), and hence \\(f(v)=v\\).\n\nSuppose now that \\(v^{\\prime}\\) is a second \\(f\\)-rare integer. We may assume that \\(v=0\\) (see Comment 1 ). We've seen that \\(f\\left(v^{\\prime}\\right)=v^{\\prime}\\); we claim that in fact \\(f\\left(k v^{\\prime}\\right)=v^{\\prime}\\) for all positive integers \\(k\\). This gives a contradiction unless \\(v^{\\prime}=v=0\\).\n\nThis claim is proved by induction on \\(k\\). Supposing it to be true for \\(k\\), we substitute \\(y=k v^{\\prime}\\) and \\(x=0\\) into the functional equation to yield\n\\[\nf\\left((k+1) v^{\\prime}\\right)=f\\left(f(0)+k v^{\\prime}\\right)=f\\left(k v^{\\prime}\\right)=v^{\\prime}\n\\]\nusing that \\(f(0)=0\\). This completes the induction, and hence the proof.\nComment 2. There are many functions \\(f\\) satisfying the functional equation for which there is an \\(f\\)-rare integer. For instance, one may generalise the construction in part (a) of Solution 1 by taking a sequence \\(1=a_{0}, a_{1}, a_{2}, \\ldots\\) of positive integers with each \\(a_{i}\\) a proper divisor of \\(a_{i+1}\\) and choosing arbitrary functions \\(f_{i}:\\left(\\mathbb{Z} / a_{i} \\mathbb{Z}\\right) \\backslash\\{0\\} \\rightarrow a_{i} \\mathbb{Z} \\backslash\\{0\\}\\) from the nonzero residue classes modulo \\(a_{i}\\) to the nonzero multiples of \\(a_{i}\\). One then defines a function \\(f: \\mathbb{Z} \\rightarrow \\mathbb{Z}\\) by\n\\[\nf(x):= \\begin{cases}f_{i+1}\\left(x \\bmod a_{i+1}\\right), & \\text { if } a_{i} \\mid x \\text { but } a_{i+1} \\nmid x \\\\ 0, & \\text { if } x=0\\end{cases}\n\\]\n\nIf one writes \\(v(x)\\) for the largest \\(i\\) such that \\(a_{i} \\mid x\\) (with \\(v(0)=\\infty\\) ), then it is easy to verify the functional equation for \\(f\\) separately in the two cases \\(v(y)>v(x)\\) and \\(v(x) \\geqslant v(y)\\). Hence this \\(f\\) satisfies the functional equation and 0 is an \\(f\\)-rare integer.\n\nComment 3. In fact, if \\(v\\) is an \\(f\\)-rare integer for an \\(f\\) satisfying the functional equation, then its fibre \\(X_{v}=\\{v\\}\\) must be a singleton. We may assume without loss of generality that \\(v=0\\). We've already seen in Solution 1 that 0 is either the greatest or least element of \\(X_{0}\\); replacing \\(f\\) with the function \\(x \\mapsto-f(-x)\\) if necessary, we may assume that 0 is the least element of \\(X_{0}\\). We write \\(b\\) for the largest element of \\(X_{0}\\), supposing for contradiction that \\(b>0\\), and write \\(N=(2 b)\\) !.\n\nIt now follows from (*) that we have\n\\[\nf(f(N b)+b)=f(f(0)+b)=f(b)=0\n\\]\nfrom which we see that \\(f(N b)+b \\in X_{0} \\subseteq[0, b]\\). It follows that \\(f(N b) \\in[-b, 0)\\), since by construction \\(N b \\notin X_{v}\\). Now it follows that \\((f(N b)-0) \\cdot(f(N b)-b)\\) is a divisor of \\(N\\), so from \\((\\dagger)\\) we see that \\(f(N b)=f(0)=0\\). This yields the desired contradiction.\n\n\\section*{Combinatorics}", "source_pdf": "imosl_2019.pdf", "notes": "fallback-regex"}
{"id": "IMOSL-2019-C1", "contest": "IMOSL", "year": "2019", "problem_number": "C1", "problem": "The infinite sequence \\(a_{0}, a_{1}, a_{2}, \\ldots\\) of (not necessarily different) integers has the following properties: \\(0 \\leqslant a_{i} \\leqslant i\\) for all integers \\(i \\geqslant 0\\), and\n\\[\n\\binom{k}{a_{0}}+\\binom{k}{a_{1}}+\\cdots+\\binom{k}{a_{k}}=2^{k}\n\\]\nfor all integers \\(k \\geqslant 0\\).\nProve that all integers \\(N \\geqslant 0\\) occur in the sequence (that is, for all \\(N \\geqslant 0\\), there exists \\(i \\geqslant 0\\) with \\(\\left.a_{i}=N\\right)\\).\n(Netherlands)", "solution": ". We prove by induction on \\(k\\) that every initial segment of the sequence, \\(a_{0}, a_{1}, \\ldots, a_{k}\\), consists of the following elements (counted with multiplicity, and not necessarily in order), for some \\(\\ell \\geqslant 0\\) with \\(2 \\ell \\leqslant k+1\\) :\n\\[\n0,1, \\ldots, \\ell-1, \\quad 0,1, \\ldots, k-\\ell .\n\\]\n\nFor \\(k=0\\) we have \\(a_{0}=0\\), which is of this form. Now suppose that for \\(k=m\\) the elements \\(a_{0}, a_{1}, \\ldots, a_{m}\\) are \\(0,0,1,1,2,2, \\ldots, \\ell-1, \\ell-1, \\ell, \\ell+1, \\ldots, m-\\ell-1, m-\\ell\\) for some \\(\\ell\\) with \\(0 \\leqslant 2 \\ell \\leqslant m+1\\). It is given that\n\\[\n\\binom{m+1}{a_{0}}+\\binom{m+1}{a_{1}}+\\cdots+\\binom{m+1}{a_{m}}+\\binom{m+1}{a_{m+1}}=2^{m+1}\n\\]\nwhich becomes\n\\[\n\\begin{aligned}\n\\left(\\binom{m+1}{0}+\\binom{m+1}{1}\\right. & \\left.+\\cdots+\\binom{m+1}{\\ell-1}\\right) \\\\\n& +\\left(\\binom{m+1}{0}+\\binom{m+1}{1}+\\cdots+\\binom{m+1}{m-\\ell}\\right)+\\binom{m+1}{a_{m+1}}=2^{m+1}\n\\end{aligned}\n\\]\nor, using \\(\\binom{m+1}{i}=\\binom{m+1}{m+1-i}\\), that\n\\[\n\\begin{aligned}\n\\left(\\binom{m+1}{0}+\\binom{m+1}{1}\\right. & \\left.+\\cdots+\\binom{m+1}{\\ell-1}\\right) \\\\\n& +\\left(\\binom{m+1}{m+1}+\\binom{m+1}{m}+\\cdots+\\binom{m+1}{\\ell+1}\\right)+\\binom{m+1}{a_{m+1}}=2^{m+1}\n\\end{aligned}\n\\]\n\nOn the other hand, it is well known that\n\\[\n\\binom{m+1}{0}+\\binom{m+1}{1}+\\cdots+\\binom{m+1}{m+1}=2^{m+1}\n\\]\nand so, by subtracting, we get\n\\[\n\\binom{m+1}{a_{m+1}}=\\binom{m+1}{\\ell} .\n\\]\n\nFrom this, using the fact that the binomial coefficients \\(\\binom{m+1}{i}\\) are increasing for \\(i \\leqslant \\frac{m+1}{2}\\) and decreasing for \\(i \\geqslant \\frac{m+1}{2}\\), we conclude that either \\(a_{m+1}=\\ell\\) or \\(a_{m+1}=m+1-\\ell\\). In either case, \\(a_{0}, a_{1}, \\ldots, a_{m+1}\\) is again of the claimed form, which concludes the induction.\n\nAs a result of this description, any integer \\(N \\geqslant 0\\) appears as a term of the sequence \\(a_{i}\\) for some \\(0 \\leqslant i \\leqslant 2 N\\).", "source_pdf": "imosl_2019.pdf", "notes": "fallback-regex"}
{"id": "IMOSL-2019-C2", "contest": "IMOSL", "year": "2019", "problem_number": "C2", "problem": "You are given a set of \\(n\\) blocks, each weighing at least 1 ; their total weight is \\(2 n\\). Prove that for every real number \\(r\\) with \\(0 \\leqslant r \\leqslant 2 n-2\\) you can choose a subset of the blocks whose total weight is at least \\(r\\) but at most \\(r+2\\).\n(Thailand)", "solution": "1. We prove the following more general statement by induction on \\(n\\).\nClaim. Suppose that you have \\(n\\) blocks, each of weight at least 1 , and of total weight \\(s \\leqslant 2 n\\). Then for every \\(r\\) with \\(-2 \\leqslant r \\leqslant s\\), you can choose some of the blocks whose total weight is at least \\(r\\) but at most \\(r+2\\).\nProof. The base case \\(n=1\\) is trivial. To prove the inductive step, let \\(x\\) be the largest block weight. Clearly, \\(x \\geqslant s / n\\), so \\(s-x \\leqslant \\frac{n-1}{n} s \\leqslant 2(n-1)\\). Hence, if we exclude a block of weight \\(x\\), we can apply the inductive hypothesis to show the claim holds (for this smaller set) for any \\(-2 \\leqslant r \\leqslant s-x\\). Adding the excluded block to each of those combinations, we see that the claim also holds when \\(x-2 \\leqslant r \\leqslant s\\). So if \\(x-2 \\leqslant s-x\\), then we have covered the whole interval \\([-2, s]\\). But each block weight is at least 1 , so we have \\(x-2 \\leqslant(s-(n-1))-2=s-(2 n-(n-1)) \\leqslant s-(s-(n-1)) \\leqslant s-x\\), as desired.\n\nComment. Instead of inducting on sets of blocks with total weight \\(s \\leqslant 2 n\\), we could instead prove the result only for \\(s=2 n\\). We would then need to modify the inductive step to scale up the block weights before applying the induction hypothesis.\n\nSolution 2. Let \\(x_{1}, \\ldots, x_{n}\\) be the weights of the blocks in weakly increasing order. Consider the set \\(S\\) of sums of the form \\(\\sum_{j \\in J} x_{j}\\) for a subset \\(J \\subseteq\\{1,2, \\ldots, n\\}\\). We want to prove that the mesh of \\(S\\)-i.e. the largest distance between two adjacent elements - is at most 2 .\n\nFor \\(0 \\leqslant k \\leqslant n\\), let \\(S_{k}\\) denote the set of sums of the form \\(\\sum_{i \\in J} x_{i}\\) for a subset \\(J \\subseteq\\{1,2, \\ldots, k\\}\\). We will show by induction on \\(k\\) that the mesh of \\(S_{k}\\) is at most 2 .\n\nThe base case \\(k=0\\) is trivial (as \\(S_{0}=\\{0\\}\\) ). For \\(k>0\\) we have\n\\[\nS_{k}=S_{k-1} \\cup\\left(x_{k}+S_{k-1}\\right)\n\\]\n(where \\(\\left(x_{k}+S_{k-1}\\right)\\) denotes \\(\\left\\{x_{k}+s: s \\in S_{k-1}\\right\\}\\) ), so it suffices to prove that \\(x_{k} \\leqslant \\sum_{j<k} x_{j}+2\\). But if this were not the case, we would have \\(x_{l}>\\sum_{j<k} x_{j}+2 \\geqslant k+1\\) for all \\(l \\geqslant k\\), and hence\n\\[\n2 n=\\sum_{j=1}^{n} x_{j}>(n+1-k)(k+1)+k-1\n\\]\n\nThis rearranges to \\(n>k(n+1-k)\\), which is false for \\(1 \\leqslant k \\leqslant n\\), giving the desired contradiction.", "source_pdf": "imosl_2019.pdf", "notes": "fallback-regex"}
{"id": "IMOSL-2019-C4", "contest": "IMOSL", "year": "2019", "problem_number": "C4", "problem": "On a flat plane in Camelot, King Arthur builds a labyrinth \\(\\mathfrak{L}\\) consisting of \\(n\\) walls, each of which is an infinite straight line. No two walls are parallel, and no three walls have a common point. Merlin then paints one side of each wall entirely red and the other side entirely blue.\n\nAt the intersection of two walls there are four corners: two diagonally opposite corners where a red side and a blue side meet, one corner where two red sides meet, and one corner where two blue sides meet. At each such intersection, there is a two-way door connecting the two diagonally opposite corners at which sides of different colours meet.\n\nAfter Merlin paints the walls, Morgana then places some knights in the labyrinth. The knights can walk through doors, but cannot walk through walls.\n\nLet \\(k(\\mathfrak{L})\\) be the largest number \\(k\\) such that, no matter how Merlin paints the labyrinth \\(\\mathfrak{L}\\), Morgana can always place at least \\(k\\) knights such that no two of them can ever meet. For each \\(n\\), what are all possible values for \\(k(\\mathfrak{L})\\), where \\(\\mathfrak{L}\\) is a labyrinth with \\(n\\) walls?\n(Canada)", "solution": "Answer: The only possible value of \\(k\\) is \\(k=n+1\\), no matter what shape the labyrinth is.\n\n1. First we show by induction that the \\(n\\) walls divide the plane into \\(\\binom{n+1}{2}+1\\) regions. The claim is true for \\(n=0\\) as, when there are no walls, the plane forms a single region. When placing the \\(n^{\\text {th }}\\) wall, it intersects each of the \\(n-1\\) other walls exactly once and hence splits each of \\(n\\) of the regions formed by those other walls into two regions. By the induction hypothesis, this yields \\(\\left.\\binom{n}{2}+1\\right)+n=\\binom{n+1}{2}+1\\) regions, proving the claim.\n\nNow let \\(G\\) be the graph with vertices given by the \\(\\binom{n+1}{2}+1\\) regions, and with two regions connected by an edge if there is a door between them.\n\nWe now show that no matter how Merlin paints the \\(n\\) walls, Morgana can place at least \\(n+1\\) knights. No matter how the walls are painted, there are exactly \\(\\binom{n}{2}\\) intersection points, each of which corresponds to a single edge in \\(G\\). Consider adding the edges of \\(G\\) sequentially and note that each edge reduces the number of connected components by at most one. Therefore the number of connected components of G is at least \\(\\binom{n+1}{2}+1-\\binom{n}{2}=n+1\\). If Morgana places a knight in regions corresponding to different connected components of \\(G\\), then no two knights can ever meet.\n\nNow we give a construction showing that, no matter what shape the labyrinth is, Merlin can colour it such that there are exactly \\(n+1\\) connected components, allowing Morgana to place at most \\(n+1\\) knights.\n\nFirst, we choose a coordinate system on the labyrinth so that none of the walls run due north-south, or due east-west. We then have Merlin paint the west face of each wall red, and the east face of each wall blue. We label the regions according to how many walls the region is on the east side of: the labels are integers between 0 and \\(n\\).\n\nWe claim that, for each \\(i\\), the regions labelled \\(i\\) are connected by doors. First, we note that for each \\(i\\) with \\(0 \\leqslant i \\leqslant n\\) there is a unique region labelled \\(i\\) which is unbounded to the north.\n\nNow, consider a knight placed in some region with label \\(i\\), and ask them to walk north (moving east or west by following the walls on the northern sides of regions, as needed). This knight will never get stuck: each region is convex, and so, if it is bounded to the north, it has a single northernmost vertex with a door northwards to another region with label \\(i\\).\n\nEventually it will reach a region which is unbounded to the north, which will be the unique such region with label \\(i\\). Hence every region with label \\(i\\) is connected to this particular region, and so all regions with label \\(i\\) are connected to each other.\n\nAs a result, there are exactly \\(n+1\\) connected components, and Morgana can place at most \\(n+1\\) knights.\n\nComment. Variations on this argument exist: some of them capture more information, and some of them capture less information, about the connected components according to this system of numbering.\n\nFor example, it can be shown that the unbounded regions are numbered \\(0,1, \\ldots, n-1, n, n-1, \\ldots, 1\\) as one cycles around them, that the regions labelled 0 and \\(n\\) are the only regions in their connected components, and that each other connected component forms a single chain running between the two unbounded ones. It is also possible to argue that the regions are acyclic without revealing much about their structure.\n\nSolution 2. We give another description of a strategy for Merlin to paint the walls so that Morgana can place no more than \\(n+1\\) knights.\n\nMerlin starts by building a labyrinth of \\(n\\) walls of his own design. He places walls in turn with increasing positive gradients, placing each so far to the right that all intersection points of previously-placed lines lie to the left of it. He paints each in such a way that blue is on the left and red is on the right.\n\nFor example, here is a possible sequence of four such lines \\(\\ell_{1}, \\ell_{2}, \\ell_{3}, \\ell_{4}\\) :\n![](https://cdn.mathpix.com/cropped/2025_08_23_54ae86499e5425f8b31eg-039.jpg?height=433&width=557&top_left_y=987&top_left_x=748)\n\nWe say that a region is \"on the right\" if it has \\(x\\)-coordinate unbounded above (note that if we only have one wall, then both regions are on the right). We claim inductively that, after placing \\(n\\) lines, there are \\(n+1\\) connected components in the resulting labyrinth, each of which contains exactly one region on the right. This is certainly true after placing 0 lines, as then there is only one region (and hence one connected component) and it is on the right.\n\nWhen placing the \\(n^{\\text {th }}\\) line, it then cuts every one of the \\(n-1\\) previously placed lines, and since it is to the right of all intersection points, the regions it cuts are exactly the \\(n\\) regions on the right.\n![](https://cdn.mathpix.com/cropped/2025_08_23_54ae86499e5425f8b31eg-039.jpg?height=495&width=515&top_left_y=1907&top_left_x=776)\n\nThe addition of this line leaves all previous connected components with exactly one region on the right, and creates a new connected component containing exactly one region, and that region is also on the right. As a result, by induction, this particular labyrinth will have \\(n+1\\) connected components.\n\nHaving built this labyrinth, Merlin then moves the walls one-by-one (by a sequence of continuous translations and rotations of lines) into the proper position of the given labyrinth, in such a way that no two lines ever become parallel.\n\nThe only time the configuration is changed is when one wall is moved through an intersection point of two others:\n![](https://cdn.mathpix.com/cropped/2025_08_23_54ae86499e5425f8b31eg-040.jpg?height=475&width=1457&top_left_y=365&top_left_x=305)\n\nNote that all moves really do switch between two configurations like this: all sets of three lines have this colour configuration initially, and the rules on rotations mean they are preserved (in particular, we cannot create three lines creating a triangle with three red edges inwards, or three blue edges inwards).\n\nHowever, as can be seen, such a move preserves the number of connected components, so in the painting this provides for Arthur's actual labyrinth, Morgana can still only place at most \\(n+1\\) knights.\n\nComment. While these constructions are superficially distinct, they in fact result in the same colourings for any particular labyrinth. In fact, using the methods of Solution 2, it is possible to show that these are the only colourings that result in exactly \\(n+1\\) connected components.", "source_pdf": "imosl_2019.pdf", "notes": "fallback-regex"}
{"id": "IMOSL-2019-C6", "contest": "IMOSL", "year": "2019", "problem_number": "C6", "problem": "Let \\(n>1\\) be an integer. Suppose we are given \\(2 n\\) points in a plane such that no three of them are collinear. The points are to be labelled \\(A_{1}, A_{2}, \\ldots, A_{2 n}\\) in some order. We then consider the \\(2 n\\) angles \\(\\angle A_{1} A_{2} A_{3}, \\angle A_{2} A_{3} A_{4}, \\ldots, \\angle A_{2 n-2} A_{2 n-1} A_{2 n}, \\angle A_{2 n-1} A_{2 n} A_{1}\\), \\(\\angle A_{2 n} A_{1} A_{2}\\). We measure each angle in the way that gives the smallest positive value (i.e. between \\(0^{\\circ}\\) and \\(180^{\\circ}\\) ). Prove that there exists an ordering of the given points such that the resulting \\(2 n\\) angles can be separated into two groups with the sum of one group of angles equal to the sum of the other group.\n(USA)", "solution": "Comment. The first three solutions all use the same construction involving a line separating the points into groups of \\(n\\) points each, but give different proofs that this construction works. Although\n\n1 is very short, the Problem Selection Committee does not believe any of the solutions is easy to find and thus rates this as a problem of medium difficulty.\n\nSolution 1. Let \\(\\ell\\) be a line separating the points into two groups ( \\(L\\) and \\(R\\) ) with \\(n\\) points in each. Label the points \\(A_{1}, A_{2}, \\ldots, A_{2 n}\\) so that \\(L=\\left\\{A_{1}, A_{3}, \\ldots, A_{2 n-1}\\right\\}\\). We claim that this labelling works.\n\nTake a line \\(s=A_{2 n} A_{1}\\).\n(a) Rotate \\(s\\) around \\(A_{1}\\) until it passes through \\(A_{2}\\); the rotation is performed in a direction such that \\(s\\) is never parallel to \\(\\ell\\).\n(b) Then rotate the new \\(s\\) around \\(A_{2}\\) until it passes through \\(A_{3}\\) in a similar manner.\n(c) Perform \\(2 n-2\\) more such steps, after which \\(s\\) returns to its initial position.\n\nThe total (directed) rotation angle \\(\\Theta\\) of \\(s\\) is clearly a multiple of \\(180^{\\circ}\\). On the other hand, \\(s\\) was never parallel to \\(\\ell\\), which is possible only if \\(\\Theta=0\\). Now it remains to partition all the \\(2 n\\) angles into those where \\(s\\) is rotated anticlockwise, and the others.\n\nSolution 2. When tracing a cyclic path through the \\(A_{i}\\) in order, with straight line segments between consecutive points, let \\(\\theta_{i}\\) be the exterior angle at \\(A_{i}\\), with a sign convention that it is positive if the path turns left and negative if the path turns right. Then \\(\\sum_{i=1}^{2 n} \\theta_{i}=360 k^{\\circ}\\) for some integer \\(k\\). Let \\(\\phi_{i}=\\angle A_{i-1} A_{i} A_{i+1}\\) (indices mod 2n), defined as in the problem; thus \\(\\phi_{i}=180^{\\circ}-\\left|\\theta_{i}\\right|\\).\n\nLet \\(L\\) be the set of \\(i\\) for which the path turns left at \\(A_{i}\\) and let \\(R\\) be the set for which it turns right. Then \\(S=\\sum_{i \\in L} \\phi_{i}-\\sum_{i \\in R} \\phi_{i}=(180(|L|-|R|)-360 k)^{\\circ}\\), which is a multiple of \\(360^{\\circ}\\) since the number of points is even. We will show that the points can be labelled such that \\(S=0\\), in which case \\(L\\) and \\(R\\) satisfy the required condition of the problem.\n\nNote that the value of \\(S\\) is defined for a slightly larger class of configurations: it is OK for two points to coincide, as long as they are not consecutive, and OK for three points to be collinear, as long as \\(A_{i}, A_{i+1}\\) and \\(A_{i+2}\\) do not appear on a line in that order. In what follows it will be convenient, although not strictly necessary, to consider such configurations.\n\nConsider how \\(S\\) changes if a single one of the \\(A_{i}\\) is moved along some straight-line path (not passing through any \\(A_{j}\\) and not lying on any line \\(A_{j} A_{k}\\), but possibly crossing such lines). Because \\(S\\) is a multiple of \\(360^{\\circ}\\), and the angles change continuously, \\(S\\) can only change when a point moves between \\(R\\) and \\(L\\). Furthermore, if \\(\\phi_{j}=0\\) when \\(A_{j}\\) moves between \\(R\\) and \\(L, S\\) is unchanged; it only changes if \\(\\phi_{j}=180^{\\circ}\\) when \\(A_{j}\\) moves between those sets.\n\nFor any starting choice of points, we will now construct a new configuration, with labels such that \\(S=0\\), that can be perturbed into the original one without any \\(\\phi_{i}\\) passing through \\(180^{\\circ}\\), so that \\(S=0\\) for the original configuration with those labels as well.\n\nTake some line such that there are \\(n\\) points on each side of that line. The new configuration has \\(n\\) copies of a single point on each side of the line, and a path that alternates between\nsides of the line; all angles are 0 , so this configuration has \\(S=0\\). Perturbing the points into their original positions, while keeping each point on its side of the line, no angle \\(\\phi_{i}\\) can pass through \\(180^{\\circ}\\), because no straight line can go from one side of the line to the other and back. So the perturbation process leaves \\(S=0\\).\n\nComment. More complicated variants of this solution are also possible; for example, a path defined using four quadrants of the plane rather than just two half-planes.\n\nSolution 3. First, let \\(\\ell\\) be a line in the plane such that there are \\(n\\) points on one side and the other \\(n\\) points on the other side. For convenience, assume \\(\\ell\\) is horizontal (otherwise, we can rotate the plane). Then we can use the terms \"above\", \"below\", \"left\" and \"right\" in the usual way. We denote the \\(n\\) points above the line in an arbitrary order as \\(P_{1}, P_{2}, \\ldots, P_{n}\\), and the \\(n\\) points below the line as \\(Q_{1}, Q_{2}, \\ldots, Q_{n}\\).\n\nIf we connect \\(P_{i}\\) and \\(Q_{j}\\) with a line segment, the line segment will intersect with the line \\(\\ell\\). Denote the intersection as \\(I_{i j}\\). If \\(P_{i}\\) is connected to \\(Q_{j}\\) and \\(Q_{k}\\), where \\(j<k\\), then \\(I_{i j}\\) and \\(I_{i k}\\) are two different points, because \\(P_{i}, Q_{j}\\) and \\(Q_{k}\\) are not collinear.\n\nNow we define a \"sign\" for each angle \\(\\angle Q_{j} P_{i} Q_{k}\\). Assume \\(j<k\\). We specify that the sign is positive for the following two cases:\n- if \\(i\\) is odd and \\(I_{i j}\\) is to the left of \\(I_{i k}\\),\n- if \\(i\\) is even and \\(I_{i j}\\) is to the right of \\(I_{i k}\\).\n\nOtherwise the sign of the angle is negative. If \\(j>k\\), then the sign of \\(\\angle Q_{j} P_{i} Q_{k}\\) is taken to be the same as for \\(\\angle Q_{k} P_{i} Q_{j}\\).\n\nSimilarly, we can define the sign of \\(\\angle P_{j} Q_{i} P_{k}\\) with \\(j<k\\) (or equivalently \\(\\angle P_{k} Q_{i} P_{j}\\) ). For example, it is positive when \\(i\\) is odd and \\(I_{j i}\\) is to the left of \\(I_{k i}\\).\n\nHenceforth, whenever we use the notation \\(\\angle Q_{j} P_{i} Q_{k}\\) or \\(\\angle P_{j} Q_{i} P_{k}\\) for a numerical quantity, it is understood to denote either the (geometric) measure of the angle or the negative of this measure, depending on the sign as specified above.\n\nWe now have the following important fact for signed angle measures:\n\\[\n\\angle Q_{i_{1}} P_{k} Q_{i_{3}}=\\angle Q_{i_{1}} P_{k} Q_{i_{2}}+\\angle Q_{i_{2}} P_{k} Q_{i_{3}}\n\\]\nfor all points \\(P_{k}, Q_{i_{1}}, Q_{i_{2}}\\) and \\(Q_{i_{3}}\\) with \\(i_{1}<i_{2}<i_{3}\\). The following figure shows a \"natural\" arrangement of the points. Equation (1) still holds for any other arrangement, as can be easily verified.\n![](https://cdn.mathpix.com/cropped/2025_08_23_54ae86499e5425f8b31eg-045.jpg?height=346&width=801&top_left_y=2170&top_left_x=633)\n\nSimilarly, we have\n\\[\n\\angle P_{i_{1}} Q_{k} P_{i_{3}}=\\angle P_{i_{1}} Q_{k} P_{i_{2}}+\\angle P_{i_{2}} Q_{k} P_{i_{3}},\n\\]\nfor all points \\(Q_{k}, P_{i_{1}}, P_{i_{2}}\\) and \\(P_{i_{3}}\\), with \\(i_{1}<i_{2}<i_{3}\\).\n\nWe are now ready to specify the desired ordering \\(A_{1}, \\ldots, A_{2 n}\\) of the points:\n- if \\(i \\leqslant n\\) is odd, put \\(A_{i}=P_{i}\\) and \\(A_{2 n+1-i}=Q_{i}\\);\n- if \\(i \\leqslant n\\) is even, put \\(A_{i}=Q_{i}\\) and \\(A_{2 n+1-i}=P_{i}\\).\n\nFor example, for \\(n=3\\) this ordering is \\(P_{1}, Q_{2}, P_{3}, Q_{3}, P_{2}, Q_{1}\\). This sequence alternates between \\(P\\) 's and \\(Q\\) 's, so the above conventions specify a sign for each of the angles \\(A_{i-1} A_{i} A_{i+1}\\). We claim that the sum of these \\(2 n\\) signed angles equals 0 . If we can show this, it would complete the proof.\n\nWe prove the claim by induction. For brevity, we use the notation \\(\\angle P_{i}\\) to denote whichever of the \\(2 n\\) angles has its vertex at \\(P_{i}\\), and \\(\\angle Q_{i}\\) similarly.\n\nFirst let \\(n=2\\). If the four points can be arranged to form a convex quadrilateral, then the four line segments \\(P_{1} Q_{1}, P_{1} Q_{2}, P_{2} Q_{1}\\) and \\(P_{2} Q_{2}\\) constitute a self-intersecting quadrilateral. We use several figures to illustrate the possible cases.\n\nThe following figure is one possible arrangement of the points.\n![](https://cdn.mathpix.com/cropped/2025_08_23_54ae86499e5425f8b31eg-046.jpg?height=427&width=803&top_left_y=1053&top_left_x=631)\n\nThen \\(\\angle P_{1}\\) and \\(\\angle Q_{1}\\) are positive, \\(\\angle P_{2}\\) and \\(\\angle Q_{2}\\) are negative, and we have\n\\[\n\\left|\\angle P_{1}\\right|+\\left|\\angle Q_{1}\\right|=\\left|\\angle P_{2}\\right|+\\left|\\angle Q_{2}\\right| .\n\\]\n\nWith signed measures, we have\n\\[\n\\angle P_{1}+\\angle Q_{1}+\\angle P_{2}+\\angle Q_{2}=0 .\n\\]\n\nIf we switch the labels of \\(P_{1}\\) and \\(P_{2}\\), we have the following picture:\n![](https://cdn.mathpix.com/cropped/2025_08_23_54ae86499e5425f8b31eg-046.jpg?height=429&width=801&top_left_y=2041&top_left_x=633)\n\nSwitching labels \\(P_{1}\\) and \\(P_{2}\\) has the effect of flipping the sign of all four angles (as well as swapping the magnitudes on the relabelled points); that is, the new values of ( \\(\\angle P_{1}, \\angle P_{2}, \\angle Q_{1}, \\angle Q_{2}\\) ) equal the old values of ( \\(-\\angle P_{2},-\\angle P_{1},-\\angle Q_{1},-\\angle Q_{2}\\) ). Consequently, equation (3) still holds. Similarly, when switching the labels of \\(Q_{1}\\) and \\(Q_{2}\\), or both the \\(P\\) 's and the \\(Q\\) 's, equation (3) still holds.\n\nThe remaining subcase of \\(n=2\\) is that one point lies inside the triangle formed by the other three. We have the following picture.\n![](https://cdn.mathpix.com/cropped/2025_08_23_54ae86499e5425f8b31eg-047.jpg?height=480&width=803&top_left_y=374&top_left_x=631)\n\nWe have\n\\[\n\\left|\\angle P_{1}\\right|+\\left|\\angle Q_{1}\\right|+\\left|\\angle Q_{2}\\right|=\\left|\\angle P_{2}\\right| .\n\\]\nand equation (3) holds.\nAgain, switching the labels for \\(P\\) 's or the \\(Q\\) 's will not affect the validity of equation (3). Also, if the point lying inside the triangle of the other three is one of the \\(Q\\) 's rather than the \\(P\\) 's, the result still holds, since our sign convention is preserved when we relabel \\(Q\\) 's as \\(P\\) 's and vice-versa and reflect across \\(\\ell\\).\n\nWe have completed the proof of the claim for \\(n=2\\).\nAssume the claim holds for \\(n=k\\), and we wish to prove it for \\(n=k+1\\). Suppose we are given our \\(2(k+1)\\) points. First ignore \\(P_{k+1}\\) and \\(Q_{k+1}\\), and form \\(2 k\\) angles from \\(P_{1}, \\ldots, P_{k}\\), \\(Q_{1}, \\ldots, Q_{k}\\) as in the \\(n=k\\) case. By the induction hypothesis we have\n\\[\n\\sum_{i=1}^{k}\\left(\\angle P_{i}+\\angle Q_{i}\\right)=0 .\n\\]\n\nWhen we add in the two points \\(P_{k+1}\\) and \\(Q_{k+1}\\), this changes our angles as follows:\n- the angle at \\(P_{k}\\) changes from \\(\\angle Q_{k-1} P_{k} Q_{k}\\) to \\(\\angle Q_{k-1} P_{k} Q_{k+1}\\);\n- the angle at \\(Q_{k}\\) changes from \\(\\angle P_{k-1} Q_{k} P_{k}\\) to \\(\\angle P_{k-1} Q_{k} P_{k+1}\\);\n- two new angles \\(\\angle Q_{k} P_{k+1} Q_{k+1}\\) and \\(\\angle P_{k} Q_{k+1} P_{k+1}\\) are added.\n\nWe need to prove the changes have no impact on the total sum. In other words, we need to prove\n\\[\n\\left(\\angle Q_{k-1} P_{k} Q_{k+1}-\\angle Q_{k-1} P_{k} Q_{k}\\right)+\\left(\\angle P_{k-1} Q_{k} P_{k+1}-\\angle P_{k-1} Q_{k} P_{k}\\right)+\\left(\\angle P_{k+1}+\\angle Q_{k+1}\\right)=0 .\n\\]\n\nIn fact, from equations (1) and (2), we have\n\\[\n\\angle Q_{k-1} P_{k} Q_{k+1}-\\angle Q_{k-1} P_{k} Q_{k}=\\angle Q_{k} P_{k} Q_{k+1},\n\\]\nand\n\\[\n\\angle P_{k-1} Q_{k} P_{k+1}-\\angle P_{k-1} Q_{k} P_{k}=\\angle P_{k} Q_{k} P_{k+1} .\n\\]\n\nTherefore, the left hand side of equation (4) becomes \\(\\angle Q_{k} P_{k} Q_{k+1}+\\angle P_{k} Q_{k} P_{k+1}+\\angle Q_{k} P_{k+1} Q_{k+1}+ \\angle P_{k} Q_{k+1} P_{k+1}\\), which equals 0 , simply by applying the \\(n=2\\) case of the claim. This completes the induction.\n\nSolution 4. We shall think instead of the problem as asking us to assign a weight \\(\\pm 1\\) to each angle, such that the weighted sum of all the angles is zero.\n\nGiven an ordering \\(A_{1}, \\ldots, A_{2 n}\\) of the points, we shall assign weights according to the following recipe: walk in order from point to point, and assign the left turns +1 and the right turns -1 . This is the same weighting as in Solution 3, and as in that solution, the weighted sum is a multiple of \\(360^{\\circ}\\).\n\nWe now aim to show the following:\nLemma. Transposing any two consecutive points in the ordering changes the weighted sum by \\(\\pm 360^{\\circ}\\) or 0 .\n\nKnowing that, we can conclude quickly: if the ordering \\(A_{1}, \\ldots, A_{2 n}\\) has weighted angle sum \\(360 k^{\\circ}\\), then the ordering \\(A_{2 n}, \\ldots, A_{1}\\) has weighted angle sum \\(-360 k^{\\circ}\\) (since the angles are the same, but left turns and right turns are exchanged). We can reverse the ordering of \\(A_{1}\\), \\(\\ldots, A_{2 n}\\) by a sequence of transpositions of consecutive points, and in doing so the weighted angle sum must become zero somewhere along the way.\n\nWe now prove that lemma:\nProof. Transposing two points amounts to taking a section \\(A_{k} A_{k+1} A_{k+2} A_{k+3}\\) as depicted, reversing the central line segment \\(A_{k+1} A_{k+2}\\), and replacing its two neighbours with the dotted lines.\n\n\\begin{figure}\n\\includegraphics[width=\\textwidth]{https://cdn.mathpix.com/cropped/2025_08_23_54ae86499e5425f8b31eg-048.jpg?height=417&width=1354&top_left_y=1165&top_left_x=354}\n\\captionsetup{labelformat=empty}\n\\caption{Figure 1: Transposing two consecutive vertices: before (left) and afterwards (right)}\n\\end{figure}\n\nIn each triangle, we alter the sum by \\(\\pm 180^{\\circ}\\). Indeed, using (anticlockwise) directed angles modulo \\(360^{\\circ}\\), we either add or subtract all three angles of each triangle.\n\nHence both triangles together alter the sum by \\(\\pm 180 \\pm 180^{\\circ}\\), which is \\(\\pm 360^{\\circ}\\) or 0 .", "source_pdf": "imosl_2019.pdf", "notes": "fallback-regex"}
{"id": "IMOSL-2019-C7", "contest": "IMOSL", "year": "2019", "problem_number": "C7", "problem": "There are 60 empty boxes \\(B_{1}, \\ldots, B_{60}\\) in a row on a table and an unlimited supply of pebbles. Given a positive integer \\(n\\), Alice and Bob play the following game.\n\nIn the first round, Alice takes \\(n\\) pebbles and distributes them into the 60 boxes as she wishes. Each subsequent round consists of two steps:\n(a) Bob chooses an integer \\(k\\) with \\(1 \\leqslant k \\leqslant 59\\) and splits the boxes into the two groups \\(B_{1}, \\ldots, B_{k}\\) and \\(B_{k+1}, \\ldots, B_{60}\\).\n(b) Alice picks one of these two groups, adds one pebble to each box in that group, and removes one pebble from each box in the other group.\n\nBob wins if, at the end of any round, some box contains no pebbles. Find the smallest \\(n\\) such that Alice can prevent Bob from winning.\n(Czech Republic)", "solution": "Answer: \\(n=960\\). In general, if there are \\(N>1\\) boxes, the answer is \\(n=\\left\\lfloor\\frac{N}{2}+1\\right\\rfloor\\left\\lceil\\frac{N}{2}+1\\right\\rceil-1\\).\nCommon remarks. We present solutions for the general case of \\(N>1\\) boxes, and write \\(M=\\left\\lfloor\\frac{N}{2}+1\\right\\rfloor\\left\\lceil\\frac{N}{2}+1\\right\\rceil-1\\) for the claimed answer. For \\(1 \\leqslant k<N\\), say that Bob makes a \\(k\\)-move if he splits the boxes into a left group \\(\\left\\{B_{1}, \\ldots, B_{k}\\right\\}\\) and a right group \\(\\left\\{B_{k+1}, \\ldots, B_{N}\\right\\}\\). Say that one configuration dominates another if it has at least as many pebbles in each box, and say that it strictly dominates the other configuration if it also has more pebbles in at least one box. (Thus, if Bob wins in some configuration, he also wins in every configuration that it dominates.)\n\nIt is often convenient to consider 'V-shaped' configurations; for \\(1 \\leqslant i \\leqslant N\\), let \\(V_{i}\\) be the configuration where \\(B_{j}\\) contains \\(1+|j-i|\\) pebbles (i.e. where the \\(i^{\\text {th }}\\) box has a single pebble and the numbers increase by one in both directions, so the first box has \\(i\\) pebbles and the last box has \\(N+1-i\\) pebbles). Note that \\(V_{i}\\) contains \\(\\frac{1}{2} i(i+1)+\\frac{1}{2}(N+1-i)(N+2-i)-1\\) pebbles. If \\(i=\\left\\lceil\\frac{N}{2}\\right\\rceil\\), this number equals \\(M\\).\n\nSolutions split naturally into a strategy for Alice (starting with \\(M\\) pebbles and showing she can prevent Bob from winning) and a strategy for Bob (showing he can win for any starting configuration with at most \\(M-1\\) pebbles). The following observation is also useful to simplify the analysis of strategies for Bob.\nObservation A. Consider two consecutive rounds. Suppose that in the first round Bob made a \\(k\\)-move and Alice picked the left group, and then in the second round Bob makes an \\(\\ell\\)-move, with \\(\\ell>k\\). We may then assume, without loss of generality, that Alice again picks the left group.\n\nProof. Suppose Alice picks the right group in the second round. Then the combined effect of the two rounds is that each of the boxes \\(B_{k+1}, \\ldots, B_{\\ell}\\) lost two pebbles (and the other boxes are unchanged). Hence this configuration is strictly dominated by that before the first round, and it suffices to consider only Alice's other response.\n\n1 (Alice). Alice initially distributes pebbles according to \\(V_{\\left\\lceil\\frac{N}{2}\\right\\rceil}\\). Suppose the current configuration of pebbles dominates \\(V_{i}\\). If Bob makes a \\(k\\)-move with \\(k \\geqslant i\\) then Alice picks the left group, which results in a configuration that dominates \\(V_{i+1}\\). Likewise, if Bob makes a \\(k\\)-move with \\(k<i\\) then Alice picks the right group, which results in a configuration that dominates \\(V_{i-1}\\). Since none of \\(V_{1}, \\ldots, V_{N}\\) contains an empty box, Alice can prevent Bob from ever winning.\n\nSolution 1 (Bob). The key idea in this solution is the following claim.\nClaim. If there exist a positive integer \\(k\\) such that there are at least \\(2 k\\) boxes that have at most \\(k\\) pebbles each then Bob can force a win.\nProof. We ignore the other boxes. First, Bob makes a \\(k\\)-move (splits the \\(2 k\\) boxes into two groups of \\(k\\) boxes each). Without loss of generality, Alice picks the left group. Then Bob makes a \\((k+1)\\)-move, \\(\\ldots\\), a ( \\(2 k-1\\) )-move. By Observation A, we may suppose Alice always picks the left group. After Bob's \\((2 k-1)\\)-move, the rightmost box becomes empty and Bob wins.\n\nNow, we claim that if \\(n<M\\) then either there already exists an empty box, or there exist a positive integer \\(k\\) and \\(2 k\\) boxes with at most \\(k\\) pebbles each (and thus Bob can force a win). Otherwise, assume each box contains at least 1 pebble, and for each \\(1 \\leqslant k \\leqslant\\left\\lfloor\\frac{N}{2}\\right\\rfloor\\), at least \\(N-(2 k-1)=N+1-2 k\\) boxes contain at least \\(k+1\\) pebbles. Summing, there are at least as many pebbles in total as in \\(V_{\\left\\lceil\\frac{N}{2}\\right\\rceil}\\); that is, at least \\(M\\) pebbles, as desired.\n\nSolution 2 (Alice). Let \\(K=\\left\\lfloor\\frac{N}{2}+1\\right\\rfloor\\). Alice starts with the boxes in the configuration \\(V_{K}\\). For each of Bob's \\(N-1\\) possible choices, consider the subset of rounds in which he makes that choice. In that subset of rounds, Alice alternates between picking the left group and picking the right group; the first time Bob makes that choice, Alice picks the group containing the \\(K^{\\text {th }}\\) box. Thus, at any time during the game, the number of pebbles in each box depends only on which choices Bob has made an odd number of times. This means that the number of pebbles in a box could decrease by at most the number of choices for which Alice would have started by removing a pebble from the group containing that box. These numbers are, for each box,\n\\[\n\\left\\lfloor\\frac{N}{2}\\right\\rfloor,\\left\\lfloor\\frac{N}{2}-1\\right\\rfloor, \\ldots, 1,0,1, \\ldots,\\left\\lceil\\frac{N}{2}-1\\right\\rceil .\n\\]\n\nThese are pointwise less than the numbers of pebbles the boxes started with, meaning that no box ever becomes empty with this strategy.\n\nSolution 2 (Bob). Let \\(K=\\left\\lfloor\\frac{N}{2}+1\\right\\rfloor\\). For Bob's strategy, we consider a configuration \\(X\\) with at most \\(M-1\\) pebbles, and we make use of Observation A. Consider two configurations with \\(M\\) pebbles: \\(V_{K}\\) and \\(V_{N+1-K}\\) (if \\(n\\) is odd, they are the same configuration; if \\(n\\) is even, one is the reverse of the other). The configuration \\(X\\) has fewer pebbles than \\(V_{K}\\) in at least one box, and fewer pebbles than \\(V_{N+1-K}\\) in at least one box.\n\nSuppose first that, with respect to one of those configurations (without loss of generality \\(V_{K}\\) ), \\(X\\) has fewer pebbles in one of the boxes in the half where they have \\(1,2, \\ldots,\\left\\lceil\\frac{N}{2}\\right\\rceil\\) pebbles (the right half in \\(V_{K}\\) if \\(N\\) is even; if \\(N\\) is odd, we can take it to be the right half, without loss of generality, as the configuration is symmetric). Note that the number cannot be fewer in the box with 1 pebble in \\(V_{K}\\), because then it would have 0 pebbles. Bob then does a \\(K\\)-move. If Alice picks the right group, the total number of pebbles goes down and we restart Bob's strategy with a smaller number of pebbles. If Alice picks the left group, Bob follows with a ( \\(K+1\\) )-move, a ( \\(K+2\\) )-move, and so on; by Observation A we may assume Alice always picks the left group. But whichever box in the right half had fewer pebbles in \\(X\\) than in \\(V_{K}\\) ends up with 0 pebbles at some point in this sequence of moves.\n\nOtherwise, \\(N\\) is even, and for both of those configurations, there are fewer pebbles in \\(X\\) only on the \\(2,3, \\ldots, \\frac{N}{2}+1\\) side. That is, the numbers of pebbles in \\(X\\) are at least\n\\[\n\\frac{N}{2}, \\frac{N}{2}-1, \\ldots, 1,1, \\ldots, \\frac{N}{2}\n\\]\nwith equality occurring at least once on each side. Bob does an \\(\\frac{N}{2}\\)-move. Whichever group Alice chooses, the total number of pebbles is unchanged, and the side from which pebbles are removed now has a box with fewer pebbles than in ( \\(C\\) ), so the previous case of Bob's strategy can now be applied.\n\nSolution 3 (Bob). For any configuration \\(C\\), define \\(L(C)\\) to be the greatest integer such that, for all \\(0 \\leqslant i \\leqslant N-1\\), the box \\(B_{i+1}\\) contains at least \\(L(C)-i\\) pebbles. Similarly, define \\(R(C)\\) to be greatest integer such that, for all \\(0 \\leqslant i \\leqslant N-1\\), the box \\(B_{N-i}\\) contains at least \\(R(C)-i\\) pebbles. (Thus, \\(C\\) dominates the 'left half' of \\(V_{L(C)}\\) and the 'right half' of \\(V_{N+1-R(C)}\\).) Then \\(C\\) dominates a ' \\(V\\)-shaped' configuration if and only if \\(L(C)+R(C) \\geqslant N+1\\). Note that if \\(C\\) dominates a V-shaped configuration, it has at least \\(M\\) pebbles.\n\nNow suppose that there are fewer than \\(M\\) pebbles, so we have \\(L(C)+R(C) \\leqslant N\\). Then Bob makes an \\(L(C)\\)-move (or more generally any move with at least \\(L(C)\\) boxes on the left and \\(R(C)\\) boxes on the right). Let \\(C^{\\prime}\\) be the new configuration, and suppose that no box becomes empty (otherwise Bob has won). If Alice picks the left group, we have \\(L\\left(C^{\\prime}\\right)=L(C)+1\\) and \\(R\\left(C^{\\prime}\\right)=R(C)-1\\). Otherwise, we have \\(L\\left(C^{\\prime}\\right)=L(C)-1\\) and \\(R\\left(C^{\\prime}\\right)=R(C)+1\\). In either case, we have \\(L\\left(C^{\\prime}\\right)+R\\left(C^{\\prime}\\right) \\leqslant N\\).\n\nBob then repeats this strategy, until one of the boxes becomes empty. Since the condition in Observation A holds, we may assume that Alice picks a group on the same side each time. Then one of \\(L\\) and \\(R\\) is strictly decreasing; without loss of generality assume that \\(L\\) strictly decreases. At some point we reach \\(L=1\\). If \\(B_{2}\\) is still nonempty, then \\(B_{1}\\) must contain a single pebble. Bob makes a 1 -move, and by Observation A, Alice must (eventually) pick the right group, making this box empty.", "source_pdf": "imosl_2019.pdf", "notes": "fallback-regex"}
{"id": "IMOSL-2019-C8", "contest": "IMOSL", "year": "2019", "problem_number": "C8", "problem": "Alice has a map of Wonderland, a country consisting of \\(n \\geqslant 2\\) towns. For every pair of towns, there is a narrow road going from one town to the other. One day, all the roads are declared to be \"one way\" only. Alice has no information on the direction of the roads, but the King of Hearts has offered to help her. She is allowed to ask him a number of questions. For each question in turn, Alice chooses a pair of towns and the King of Hearts tells her the direction of the road connecting those two towns.\n\nAlice wants to know whether there is at least one town in Wonderland with at most one outgoing road. Prove that she can always find out by asking at most \\(4 n\\) questions.\n\nComment. This problem could be posed with an explicit statement about points being awarded for weaker bounds \\(c n\\) for some \\(c>4\\), in the style of IMO 2014 Problem 6.\n(Thailand)", "solution": ". We will show Alice needs to ask at most \\(4 n-7\\) questions. Her strategy has the following phases. In what follows, \\(S\\) is the set of towns that Alice, so far, does not know to have more than one outgoing road (so initially \\(|S|=n\\) ).\n\nPhase 1. Alice chooses any two towns, say \\(A\\) and \\(B\\). Without loss of generality, suppose that the King of Hearts' answer is that the road goes from \\(A\\) to \\(B\\).\n\nAt the end of this phase, Alice has asked 1 question.\nPhase 2. During this phase there is a single (variable) town \\(T\\) that is known to have at least one incoming road but not yet known to have any outgoing roads. Initially, \\(T\\) is \\(B\\). Alice does the following \\(n-2\\) times: she picks a town \\(X\\) she has not asked about before, and asks the direction of the road between \\(T\\) and \\(X\\). If it is from \\(X\\) to \\(T, T\\) is unchanged; if it is from \\(T\\) to \\(X, X\\) becomes the new choice of town \\(T\\), as the previous \\(T\\) is now known to have an outgoing road.\n\nAt the end of this phase, Alice has asked a total of \\(n-1\\) questions. The final town \\(T\\) is not yet known to have any outgoing roads, while every other town has exactly one outgoing road known. The undirected graph of roads whose directions are known is a tree.\n\nPhase 3. During this phase, Alice asks about the directions of all roads between \\(T\\) and another town she has not previously asked about, stopping if she finds two outgoing roads from \\(T\\). This phase involves at most \\(n-2\\) questions. If she does not find two outgoing roads from \\(T\\), she has answered her original question with at most \\(2 n-3 \\leqslant 4 n-7\\) questions, so in what follows we suppose that she does find two outgoing roads, asking a total of \\(k\\) questions in this phase, where \\(2 \\leqslant k \\leqslant n-2\\) (and thus \\(n \\geqslant 4\\) for what follows).\n\nFor every question where the road goes towards \\(T\\), the town at the other end is removed from \\(S\\) (as it already had one outgoing road known), while the last question resulted in \\(T\\) being removed from \\(S\\). So at the end of this phase, \\(|S|=n-k+1\\), while a total of \\(n+k-1\\) questions have been asked. Furthermore, the undirected graph of roads within \\(S\\) whose directions are known contains no cycles (as \\(T\\) is no longer a member of \\(S\\), all questions asked in this phase involved \\(T\\) and the graph was a tree before this phase started). Every town in \\(S\\) has exactly one outgoing road known (not necessarily to another town in \\(S\\) ).\n\nPhase 4. During this phase, Alice repeatedly picks any pair of towns in \\(S\\) for which she does not know the direction of the road between them. Because every town in \\(S\\) has exactly one outgoing road known, this always results in the removal of one of those two towns from \\(S\\). Because there are no cycles in the graph of roads of known direction within \\(S\\), this can continue until there are at most 2 towns left in \\(S\\).\n\nIf it ends with \\(t\\) towns left, \\(n-k+1-t\\) questions were asked in this phase, so a total of \\(2 n-t\\) questions have been asked.\n\nPhase 5. During this phase, Alice asks about all the roads from the remaining towns in \\(S\\) that she has not previously asked about. She has definitely already asked about any road between those towns (if \\(t=2\\) ). She must also have asked in one of the first two phases about\nat least one other road involving one of those towns (as those phases resulted in a tree with \\(n>2\\) vertices). So she asks at most \\(t(n-t)-1\\) questions in this phase.\n\nAt the end of this phase, Alice knows whether any town has at most one outgoing road. If \\(t=1\\), at most \\(3 n-3 \\leqslant 4 n-7\\) questions were needed in total, while if \\(t=2\\), at most \\(4 n-7\\) questions were needed in total.\n\nComment 1. The version of this problem originally submitted asked only for an upper bound of \\(5 n\\), which is much simpler to prove. The Problem Selection Committee preferred a version with an asymptotically optimal constant. In the following comment, we will show that the constant is optimal.\n\nComment 2. We will show that Alice cannot always find out by asking at most \\(4 n-3\\left(\\log _{2} n\\right)-\\) 15 questions, if \\(n \\geqslant 8\\).\n\nTo show this, we suppose the King of Hearts is choosing the directions as he goes along, only picking the direction of a road when Alice asks about it for the first time. We provide a strategy for the King of Hearts that ensures that, after the given number of questions, the map is still consistent both with the existence of a town with at most one outgoing road, and with the nonexistence of such a town. His strategy has the following phases. When describing how the King of Hearts' answer to a question is determined below, we always assume he is being asked about a road for the first time (otherwise, he just repeats his previous answer for that road). This strategy is described throughout in graph-theoretic terms (vertices and edges rather than towns and roads).\n\nPhase 1. In this phase, we consider the undirected graph formed by edges whose directions are known. The phase terminates when there are exactly 8 connected components whose undirected graphs are trees. The following invariant is maintained: in a component with \\(k\\) vertices whose undirected graph is a tree, every vertex has at most \\(\\left\\lfloor\\log _{2} k\\right\\rfloor\\) edges into it.\n- If the King of Hearts is asked about an edge between two vertices in the same component, or about an edge between two components at least one of which is not a tree, he chooses any direction for that edge arbitrarily.\n- If he is asked about an edge between a vertex in component \\(A\\) that has \\(a\\) vertices and is a tree and a vertex in component \\(B\\) that has \\(b\\) vertices and is a tree, suppose without loss of generality that \\(a \\geqslant b\\). He then chooses the edge to go from \\(A\\) to \\(B\\). In this case, the new number of edges into any vertex is at most \\(\\max \\left\\{\\left\\lfloor\\log _{2} a\\right\\rfloor,\\left\\lfloor\\log _{2} b\\right\\rfloor+1\\right\\} \\leqslant\\left\\lfloor\\log _{2}(a+b)\\right\\rfloor\\).\n\nIn all cases, the invariant is preserved, and the number of tree components either remains unchanged or goes down by 1. Assuming Alice does not repeat questions, the process must eventually terminate with 8 tree components, and at least \\(n-8\\) questions having been asked.\n\nNote that each tree component contains at least one vertex with no outgoing edges. Colour one such vertex in each tree component red.\n\nPhase 2. Let \\(V_{1}, V_{2}\\) and \\(V_{3}\\) be the three of the red vertices whose components are smallest (so their components together have at most \\(\\left\\lfloor\\frac{3}{8} n\\right\\rfloor\\) vertices, with each component having at most \\(\\left\\lfloor\\frac{3}{8} n-2\\right\\rfloor\\) vertices). Let sets \\(C_{1}, C_{2}, \\ldots\\) be the connected components after removing the \\(V_{j}\\). By construction, there are no edges with known direction between \\(C_{i}\\) and \\(C_{j}\\) for \\(i \\neq j\\), and there are at least five such components.\n\nIf at any point during this phase, the King of Hearts is asked about an edge within one of the \\(C_{i}\\), he chooses an arbitrary direction. If he is asked about an edge between \\(C_{i}\\) and \\(C_{j}\\) for \\(i \\neq j\\), he answers so that all edges go from \\(C_{i}\\) to \\(C_{i+1}\\) and \\(C_{i+2}\\), with indices taken modulo the number of components, and chooses arbitrarily for other pairs. This ensures that all vertices other than the \\(V_{j}\\) will have more than one outgoing edge.\n\nFor edges involving one of the \\(V_{j}\\) he answers as follows, so as to remain consistent for as long as possible with both possibilities for whether one of those vertices has at most one outgoing edge. Note that as they were red vertices, they have no outgoing edges at the start of this phase. For edges between two of the \\(V_{j}\\), he answers that the edges go from \\(V_{1}\\) to \\(V_{2}\\), from \\(V_{2}\\) to \\(V_{3}\\) and from \\(V_{3}\\) to \\(V_{1}\\). For edges between \\(V_{j}\\) and some other vertex, he always answers that the edge goes into \\(V_{j}\\), except for the last such edge for which he is asked the question for any given \\(V_{j}\\), for which he answers that the\nedge goes out of \\(V_{j}\\). Thus, as long as at least one of the \\(V_{j}\\) has not had the question answered for all the vertices that are not among the \\(V_{j}\\), his answers are still compatible both with all vertices having more than one outgoing edge, and with that \\(V_{j}\\) having only one outgoing edge.\n\nAt the start of this phase, each of the \\(V_{j}\\) has at most \\(\\left\\lfloor\\log _{2}\\left\\lfloor\\frac{3}{8} n-2\\right\\rfloor\\right\\rfloor<\\left(\\log _{2} n\\right)-1\\) incoming edges. Thus, Alice cannot determine whether some vertex has only one outgoing edge within \\(3(n- \\left.3-\\left(\\left(\\log _{2} n\\right)-1\\right)\\right)-1\\) questions in this phase; that is, \\(4 n-3\\left(\\log _{2} n\\right)-15\\) questions total.\n\nComment 3. We can also improve the upper bound slightly, to \\(4 n-2\\left(\\log _{2} n\\right)+1\\). (We do not know where the precise minimum number of questions lies between \\(4 n-3\\left(\\log _{2} n\\right)+O(1)\\) and \\(4 n-2\\left(\\log _{2} n\\right)+ O(1)\\).) Suppose \\(n \\geqslant 5\\) (otherwise no questions are required at all).\n\nTo do this, we replace Phases 1 and 2 of the given solution with a different strategy that also results in a spanning tree where one vertex \\(V\\) is not known to have any outgoing edges, and all other vertices have exactly one outgoing edge known, but where there is more control over the numbers of incoming edges. In Phases 3 and 4 we then take more care about the order in which pairs of towns are chosen, to ensure that each of the remaining towns has already had a question asked about at least \\(\\log _{2} n+O(1)\\) edges.\n\nDefine trees \\(T_{m}\\) with \\(2^{m}\\) vertices, exactly one of which (the root) has no outgoing edges and the rest of which have exactly one outgoing edge, as follows: \\(T_{0}\\) is a single vertex, while \\(T_{m}\\) is constructed by joining the roots of two copies of \\(T_{m-1}\\) with an edge in either direction. If \\(n=2^{m}\\) we can readily ask \\(n-1\\) questions, resulting in a tree \\(T_{m}\\) for the edges with known direction: first ask about \\(2^{m-1}\\) disjoint pairs of vertices, then about \\(2^{m-2}\\) disjoint pairs of the roots of the resulting \\(T_{1}\\) trees, and so on. For the general case, where \\(n\\) is not a power of 2 , after \\(k\\) stages of this process we have \\(\\left\\lfloor n / 2^{k}\\right\\rfloor\\) trees, each of which is like \\(T_{k}\\) but may have some extra vertices (but, however, a unique root). If there are an even number of trees, then ask about pairs of their roots. If there are an odd number (greater than 1) of trees, when a single \\(T_{k}\\) is left over, ask about its root together with that of one of the \\(T_{k+1}\\) trees.\n\nSay \\(m=\\left\\lfloor\\log _{2} n\\right\\rfloor\\). The result of that process is a single \\(T_{m}\\) tree, possibly with some extra vertices but still a unique root \\(V\\). That root has at least \\(m\\) incoming edges, and we may list vertices \\(V_{0}\\), \\(\\ldots, V_{m-1}\\) with edges to \\(V\\), such that, for all \\(0 \\leqslant i<m\\), vertex \\(V_{i}\\) itself has at least \\(i\\) incoming edges.\n\nNow divide the vertices other than \\(V\\) into two parts: \\(A\\) has all vertices at an odd distance from \\(V\\) and \\(B\\) has all the vertices at an even distance from \\(B\\). Both \\(A\\) and \\(B\\) are nonempty; \\(A\\) contains the \\(V_{i}\\), while \\(B\\) contains a sequence of vertices with at least \\(0,1, \\ldots, m-2\\) incoming edges respectively, similar to the \\(V_{i}\\). There are no edges with known direction within \\(A\\) or within \\(B\\).\n\nIn Phase 3, then ask about edges between \\(V\\) and other vertices: first those in \\(B\\), in order of increasing number of incoming edges to the other vertex, then those in \\(A\\), again in order of increasing number of incoming edges, which involves asking at most \\(n-1-m\\) questions in this phase. If two outgoing edges are not found from \\(V\\), at most \\(2 n-2-m \\leqslant 4 n-2\\left(\\log _{2} n\\right)+1\\) questions needed to be asked in total, so we suppose that two outgoing edges were found, with \\(k\\) questions asked in this phase, where \\(2 \\leqslant k \\leqslant n-1-m\\). The state of \\(S\\) is as described in the solution above, with the additional property that, since \\(S\\) must still contain all vertices with edges to \\(V\\), it contains the vertices \\(V_{i}\\) described above.\n\nIn Phase 4, consider the vertices left in \\(B\\), in increasing order of number of edges incoming to a vertex. If \\(s\\) is the least number of incoming edges to such a vertex, then, for any \\(s \\leqslant t \\leqslant m-2\\), there are at least \\(m-t-2\\) vertices with more than \\(t\\) incoming edges. Repeatedly asking about the pair of vertices left in \\(B\\) with the least numbers of incoming edges results in a single vertex left over (if any were in \\(B\\) at all at the start of this phase) with at least \\(m-2\\) incoming edges. Doing the same with \\(A\\) (which must be nonempty) leaves a vertex with at least \\(m-1\\) incoming edges.\n\nThus if only \\(A\\) is nonempty we ask at most \\(n-m\\) questions in Phase 5, so in total at most \\(3 n-m-1\\) questions, while if both are nonempty we ask at most \\(2 n-2 m+1\\) questions in Phase 5, so in total at most \\(4 n-2 m-1<4 n-2\\left(\\log _{2} n\\right)+1\\) questions.", "source_pdf": "imosl_2019.pdf", "notes": "fallback-regex"}
{"id": "IMOSL-2019-C9", "contest": "IMOSL", "year": "2019", "problem_number": "C9", "problem": "For any two different real numbers \\(x\\) and \\(y\\), we define \\(D(x, y)\\) to be the unique integer \\(d\\) satisfying \\(2^{d} \\leqslant|x-y|<2^{d+1}\\). Given a set of reals \\(\\mathcal{F}\\), and an element \\(x \\in \\mathcal{F}\\), we say that the scales of \\(x\\) in \\(\\mathcal{F}\\) are the values of \\(D(x, y)\\) for \\(y \\in \\mathcal{F}\\) with \\(x \\neq y\\).\n\nLet \\(k\\) be a given positive integer. Suppose that each member \\(x\\) of \\(\\mathcal{F}\\) has at most \\(k\\) different scales in \\(\\mathcal{F}\\) (note that these scales may depend on \\(x\\) ). What is the maximum possible size of \\(\\mathcal{F}\\) ?\n(Italy)", "solution": "Answer: The maximum possible size of \\(\\mathcal{F}\\) is \\(2^{k}\\).\nCommon remarks. For convenience, we extend the use of the word scale: we say that the scale between two reals \\(x\\) and \\(y\\) is \\(D(x, y)\\).\n\n. We first construct a set \\(\\mathcal{F}\\) with \\(2^{k}\\) members, each member having at most \\(k\\) different scales in \\(\\mathcal{F}\\). Take \\(\\mathcal{F}=\\left\\{0,1,2, \\ldots, 2^{k}-1\\right\\}\\). The scale between any two members of \\(\\mathcal{F}\\) is in the set \\(\\{0,1, \\ldots, k-1\\}\\).\n\nWe now show that \\(2^{k}\\) is an upper bound on the size of \\(\\mathcal{F}\\). For every finite set \\(\\mathcal{S}\\) of real numbers, and every real \\(x\\), let \\(r_{\\mathcal{S}}(x)\\) denote the number of different scales of \\(x\\) in \\(\\mathcal{S}\\). That is, \\(r_{\\mathcal{S}}(x)=|\\{D(x, y): x \\neq y \\in \\mathcal{S}\\}|\\). Thus, for every element \\(x\\) of the set \\(\\mathcal{F}\\) in the problem statement, we have \\(r_{\\mathcal{F}}(x) \\leqslant k\\). The condition \\(|\\mathcal{F}| \\leqslant 2^{k}\\) is an immediate consequence of the following lemma.\nLemma. Let \\(\\mathcal{S}\\) be a finite set of real numbers, and define\n\\[\nw(\\mathcal{S})=\\sum_{x \\in \\mathcal{S}} 2^{-r_{\\mathcal{S}}(x)}\n\\]\n\nThen \\(w(\\mathcal{S}) \\leqslant 1\\).\nProof. Induction on \\(n=|\\mathcal{S}|\\). If \\(\\mathcal{S}=\\{x\\}\\), then \\(r_{\\mathcal{S}}(x)=0\\), so \\(w(\\mathcal{S})=1\\).\nAssume now \\(n \\geqslant 2\\), and let \\(x_{1}<\\cdots<x_{n}\\) list the members of \\(\\mathcal{S}\\). Let \\(d\\) be the minimal scale between two distinct elements of \\(\\mathcal{S}\\); then there exist neighbours \\(x_{t}\\) and \\(x_{t+1}\\) with \\(D\\left(x_{t}, x_{t+1}\\right)=d\\). Notice that for any two indices \\(i\\) and \\(j\\) with \\(j-i>1\\) we have \\(D\\left(x_{i}, x_{j}\\right)>d\\), since\n\\[\n\\left|x_{i}-x_{j}\\right|=\\left|x_{i+1}-x_{i}\\right|+\\left|x_{j}-x_{i+1}\\right| \\geqslant 2^{d}+2^{d}=2^{d+1}\n\\]\n\nNow choose the minimal \\(i \\leqslant t\\) and the maximal \\(j \\geqslant t+1\\) such that \\(D\\left(x_{i}, x_{i+1}\\right)= D\\left(x_{i+1}, x_{i+2}\\right)=\\cdots=D\\left(x_{j-1}, x_{j}\\right)=d\\).\n\nLet \\(E\\) be the set of all the \\(x_{s}\\) with even indices \\(i \\leqslant s \\leqslant j, O\\) be the set of those with odd indices \\(i \\leqslant s \\leqslant j\\), and \\(R\\) be the rest of the elements (so that \\(\\mathcal{S}\\) is the disjoint union of \\(E, O\\) and \\(R\\) ). Set \\(\\mathcal{S}_{O}=R \\cup O\\) and \\(\\mathcal{S}_{E}=R \\cup E\\); we have \\(\\left|\\mathcal{S}_{O}\\right|<|\\mathcal{S}|\\) and \\(\\left|\\mathcal{S}_{E}\\right|<|\\mathcal{S}|\\), so \\(w\\left(\\mathcal{S}_{O}\\right), w\\left(\\mathcal{S}_{E}\\right) \\leqslant 1\\) by the inductive hypothesis.\n\nClearly, \\(r_{\\mathcal{S}_{O}}(x) \\leqslant r_{\\mathcal{S}}(x)\\) and \\(r_{\\mathcal{S}_{E}}(x) \\leqslant r_{\\mathcal{S}}(x)\\) for any \\(x \\in R\\), and thus\n\\[\n\\begin{aligned}\n\\sum_{x \\in R} 2^{-r_{\\mathcal{S}}(x)} & =\\frac{1}{2} \\sum_{x \\in R}\\left(2^{-r_{\\mathcal{S}}(x)}+2^{-r_{\\mathcal{S}}(x)}\\right) \\\\\n& \\leqslant \\frac{1}{2} \\sum_{x \\in R}\\left(2^{-r_{\\mathcal{S}_{O}}(x)}+2^{-r_{\\mathcal{S}_{E}}(x)}\\right)\n\\end{aligned}\n\\]\n\nOn the other hand, for every \\(x \\in O\\), there is no \\(y \\in \\mathcal{S}_{O}\\) such that \\(D_{\\mathcal{S}_{O}}(x, y)=d\\) (as all candidates from \\(\\mathcal{S}\\) were in \\(E)\\). Hence, we have \\(r_{\\mathcal{S}_{O}}(x) \\leqslant r_{\\mathcal{S}}(x)-1\\), and thus\n\\[\n\\sum_{x \\in O} 2^{-r_{\\mathcal{S}}(x)} \\leqslant \\frac{1}{2} \\sum_{x \\in O} 2^{-r_{\\mathcal{S}_{O}}(x)}\n\\]\n\nSimilarly, for every \\(x \\in E\\), we have\n\\[\n\\sum_{x \\in E} 2^{-r_{\\mathcal{S}}(x)} \\leqslant \\frac{1}{2} \\sum_{x \\in E} 2^{-r_{\\mathcal{S}_{E}}(x)}\n\\]\n\nWe can then combine these to give\n\\[\n\\begin{aligned}\nw(S) & =\\sum_{x \\in R} 2^{-r_{\\mathcal{S}}(x)}+\\sum_{x \\in O} 2^{-r_{\\mathcal{S}}(x)}+\\sum_{x \\in E} 2^{-r_{\\mathcal{S}}(x)} \\\\\n& \\leqslant \\frac{1}{2} \\sum_{x \\in R}\\left(2^{-r_{\\mathcal{S}_{O}}(x)}+2^{-r_{\\mathcal{S}_{E}}(x)}\\right)+\\frac{1}{2} \\sum_{x \\in O} 2^{-r_{\\mathcal{S}_{O}}(x)}+\\frac{1}{2} \\sum_{x \\in E} 2^{-r_{\\mathcal{S}_{E}}(x)} \\\\\n& =\\frac{1}{2}\\left(\\sum_{x \\in \\mathcal{S}_{O}} 2^{-r_{\\mathcal{S}_{O}}(x)}+\\sum_{x \\in \\mathcal{S}_{E}} 2^{-r_{\\mathcal{S}_{E}}(x)}\\right) \\quad\\left(\\text { since } \\mathcal{S}_{O}=O \\cup R \\text { and } \\mathcal{S}_{E}=E \\cup R\\right) \\\\\n& \\left.=\\frac{1}{2}\\left(w\\left(\\mathcal{S}_{O}\\right)+w\\left(\\mathcal{S}_{E}\\right)\\right)\\right) \\quad(\\text { by definition of } w(\\cdot)) \\\\\n& \\leqslant 1 \\quad(\\text { by the inductive hypothesis })\n\\end{aligned}\n\\]\nwhich completes the induction.\nComment 1. The sets \\(O\\) and \\(E\\) above are not the only ones we could have chosen. Indeed, we could instead have used the following definitions:\n\nLet \\(d\\) be the maximal scale between two distinct elements of \\(\\mathcal{S}\\); that is, \\(d=D\\left(x_{1}, x_{n}\\right)\\). Let \\(O=\\left\\{x \\in \\mathcal{S}: D\\left(x, x_{n}\\right)=d\\right\\}\\) (a 'left' part of the set) and let \\(E=\\left\\{x \\in \\mathcal{S}: D\\left(x_{1}, x\\right)=d\\right\\}\\) (a 'right' part of the set). Note that these two sets are disjoint, and nonempty (since they contain \\(x_{1}\\) and \\(x_{n}\\) respectively). The rest of the proof is then the same as in Solution 1.\n\nComment 2. Another possible set \\(\\mathcal{F}\\) containing \\(2^{k}\\) members could arise from considering a binary tree of height \\(k\\), allocating a real number to each leaf, and trying to make the scale between the values of two leaves dependent only on the (graph) distance between them. The following construction makes this more precise.\n\nWe build up sets \\(\\mathcal{F}_{k}\\) recursively. Let \\(\\mathcal{F}_{0}=\\{0\\}\\), and then let \\(\\mathcal{F}_{k+1}=\\mathcal{F}_{k} \\cup\\left\\{x+3 \\cdot 4^{k}: x \\in \\mathcal{F}_{k}\\right\\}\\) (i.e. each half of \\(\\mathcal{F}_{k+1}\\) is a copy of \\(F_{k}\\) ). We have that \\(\\mathcal{F}_{k}\\) is contained in the interval \\(\\left[0,4^{k+1}\\right)\\), and so it follows by induction on \\(k\\) that every member of \\(F_{k+1}\\) has \\(k\\) different scales in its own half of \\(F_{k+1}\\) (by the inductive hypothesis), and only the single scale \\(2 k+1\\) in the other half of \\(F_{k+1}\\).\n\nBoth of the constructions presented here have the property that every member of \\(\\mathcal{F}\\) has exactly \\(k\\) different scales in \\(\\mathcal{F}\\). Indeed, it can be seen that this must hold (up to a slight perturbation) for any such maximal set. Suppose there were some element \\(x\\) with only \\(k-1\\) different scales in \\(\\mathcal{F}\\) (and every other element had at most \\(k\\) different scales). Then we take some positive real \\(\\epsilon\\), and construct a new set \\(\\mathcal{F}^{\\prime}=\\{y: y \\in \\mathcal{F}, y \\leqslant x\\} \\cup\\{y+\\epsilon: y \\in \\mathcal{F}, y \\geqslant x\\}\\). We have \\(\\left|\\mathcal{F}^{\\prime}\\right|=|\\mathcal{F}|+1\\), and if \\(\\epsilon\\) is sufficiently small then \\(\\mathcal{F}^{\\prime}\\) will also satisfy the property that no member has more than \\(k\\) different scales in \\(\\mathcal{F}^{\\prime}\\).\n\nThis observation might be used to motivate the idea of weighting members of an arbitrary set \\(\\mathcal{S}\\) of reals according to how many different scales they have in \\(\\mathcal{S}\\).\n\n\\section*{Geometry}", "source_pdf": "imosl_2019.pdf", "notes": "fallback-regex"}
{"id": "IMOSL-2019-G1", "contest": "IMOSL", "year": "2019", "problem_number": "G1", "problem": "Let \\(A B C\\) be a triangle. Circle \\(\\Gamma\\) passes through \\(A\\), meets segments \\(A B\\) and \\(A C\\) again at points \\(D\\) and \\(E\\) respectively, and intersects segment \\(B C\\) at \\(F\\) and \\(G\\) such that \\(F\\) lies between \\(B\\) and \\(G\\). The tangent to circle \\(B D F\\) at \\(F\\) and the tangent to circle \\(C E G\\) at \\(G\\) meet at point \\(T\\). Suppose that points \\(A\\) and \\(T\\) are distinct. Prove that line \\(A T\\) is parallel to \\(B C\\).\n(Nigeria)", "solution": ". Notice that \\(\\angle T F B=\\angle F D A\\) because \\(F T\\) is tangent to circle \\(B D F\\), and moreover \\(\\angle F D A=\\angle C G A\\) because quadrilateral \\(A D F G\\) is cyclic. Similarly, \\(\\angle T G B=\\angle G E C\\) because \\(G T\\) is tangent to circle \\(C E G\\), and \\(\\angle G E C=\\angle C F A\\). Hence,\n\\[\n\\angle T F B=\\angle C G A \\quad \\text { and } \\quad \\angle T G B=\\angle C F A .\n\\]\n![](https://cdn.mathpix.com/cropped/2025_08_23_54ae86499e5425f8b31eg-058.jpg?height=618&width=1309&top_left_y=939&top_left_x=376)\n\nTriangles \\(F G A\\) and \\(G F T\\) have a common side \\(F G\\), and by (1) their angles at \\(F, G\\) are the same. So, these triangles are congruent. So, their altitudes starting from \\(A\\) and \\(T\\), respectively, are equal and hence \\(A T\\) is parallel to line \\(B F G C\\).\n\nComment. Alternatively, we can prove first that \\(T\\) lies on \\(\\Gamma\\). For example, this can be done by showing that \\(\\angle A F T=\\angle A G T\\) using (1). Then the statement follows as \\(\\angle T A F=\\angle T G F=\\angle G F A\\).", "source_pdf": "imosl_2019.pdf", "notes": "fallback-regex"}
{"id": "IMOSL-2019-G2", "contest": "IMOSL", "year": "2019", "problem_number": "G2", "problem": "Let \\(A B C\\) be an acute-angled triangle and let \\(D, E\\), and \\(F\\) be the feet of altitudes from \\(A, B\\), and \\(C\\) to sides \\(B C, C A\\), and \\(A B\\), respectively. Denote by \\(\\omega_{B}\\) and \\(\\omega_{C}\\) the incircles of triangles \\(B D F\\) and \\(C D E\\), and let these circles be tangent to segments \\(D F\\) and \\(D E\\) at \\(M\\) and \\(N\\), respectively. Let line \\(M N\\) meet circles \\(\\omega_{B}\\) and \\(\\omega_{C}\\) again at \\(P \\neq M\\) and \\(Q \\neq N\\), respectively. Prove that \\(M P=N Q\\).\n(Vietnam)", "solution": ". Denote the centres of \\(\\omega_{B}\\) and \\(\\omega_{C}\\) by \\(O_{B}\\) and \\(O_{C}\\), let their radii be \\(r_{B}\\) and \\(r_{C}\\), and let \\(B C\\) be tangent to the two circles at \\(T\\) and \\(U\\), respectively.\n![](https://cdn.mathpix.com/cropped/2025_08_23_54ae86499e5425f8b31eg-059.jpg?height=784&width=1009&top_left_y=673&top_left_x=528)\n\nFrom the cyclic quadrilaterals \\(A F D C\\) and \\(A B D E\\) we have\n\\[\n\\angle M D O_{B}=\\frac{1}{2} \\angle F D B=\\frac{1}{2} \\angle B A C=\\frac{1}{2} \\angle C D E=\\angle O_{C} D N,\n\\]\nso the right-angled triangles \\(D M O_{B}\\) and \\(D N O_{C}\\) are similar. The ratio of similarity between the two triangles is\n\\[\n\\frac{D N}{D M}=\\frac{O_{C} N}{O_{B} M}=\\frac{r_{C}}{r_{B}} .\n\\]\n\nLet \\(\\varphi=\\angle D M N\\) and \\(\\psi=\\angle M N D\\). The lines \\(F M\\) and \\(E N\\) are tangent to \\(\\omega_{B}\\) and \\(\\omega_{C}\\), respectively, so\n\\[\n\\angle M T P=\\angle F M P=\\angle D M N=\\varphi \\quad \\text { and } \\quad \\angle Q U N=\\angle Q N E=\\angle M N D=\\psi .\n\\]\n(It is possible that \\(P\\) or \\(Q\\) coincides with \\(T\\) or \\(U\\), or lie inside triangles \\(D M T\\) or \\(D U N\\), respectively. To reduce case-sensitivity, we may use directed angles or simply ignore angles \\(M T P\\) and \\(Q U N\\).)\n\nIn the circles \\(\\omega_{B}\\) and \\(\\omega_{C}\\) the lengths of chords \\(M P\\) and \\(N Q\\) are\n\\[\nM P=2 r_{B} \\cdot \\sin \\angle M T P=2 r_{B} \\cdot \\sin \\varphi \\quad \\text { and } \\quad N Q=2 r_{C} \\cdot \\sin \\angle Q U N=2 r_{C} \\cdot \\sin \\psi .\n\\]\n\nBy applying the sine rule to triangle \\(D N M\\) we get\n\\[\n\\frac{D N}{D M}=\\frac{\\sin \\angle D M N}{\\sin \\angle M N D}=\\frac{\\sin \\varphi}{\\sin \\psi} .\n\\]\n\nFinally, putting the above observations together, we get\n\\[\n\\frac{M P}{N Q}=\\frac{2 r_{B} \\sin \\varphi}{2 r_{C} \\sin \\psi}=\\frac{r_{B}}{r_{C}} \\cdot \\frac{\\sin \\varphi}{\\sin \\psi}=\\frac{D M}{D N} \\cdot \\frac{\\sin \\varphi}{\\sin \\psi}=\\frac{\\sin \\psi}{\\sin \\varphi} \\cdot \\frac{\\sin \\varphi}{\\sin \\psi}=1,\n\\]\nso \\(M P=N Q\\) as required.", "source_pdf": "imosl_2019.pdf", "notes": "fallback-regex"}
{"id": "IMOSL-2019-G5", "contest": "IMOSL", "year": "2019", "problem_number": "G5", "problem": "Let \\(A B C D E\\) be a convex pentagon with \\(C D=D E\\) and \\(\\angle E D C \\neq 2 \\cdot \\angle A D B\\). Suppose that a point \\(P\\) is located in the interior of the pentagon such that \\(A P=A E\\) and \\(B P=B C\\). Prove that \\(P\\) lies on the diagonal \\(C E\\) if and only if area \\((B C D)+\\operatorname{area}(A D E)= \\operatorname{area}(A B D)+\\operatorname{area}(A B P)\\).\n(Hungary)", "solution": "1. Let \\(P^{\\prime}\\) be the reflection of \\(P\\) across line \\(A B\\), and let \\(M\\) and \\(N\\) be the midpoints of \\(P^{\\prime} E\\) and \\(P^{\\prime} C\\) respectively. Convexity ensures that \\(P^{\\prime}\\) is distinct from both \\(E\\) and \\(C\\), and hence from both \\(M\\) and \\(N\\). We claim that both the area condition and the collinearity condition in the problem are equivalent to the condition that the (possibly degenerate) right-angled triangles \\(A P^{\\prime} M\\) and \\(B P^{\\prime} N\\) are directly similar (equivalently, \\(A P^{\\prime} E\\) and \\(B P^{\\prime} C\\) are directly similar).\n![](https://cdn.mathpix.com/cropped/2025_08_23_54ae86499e5425f8b31eg-066.jpg?height=518&width=535&top_left_y=816&top_left_x=765)\n\nFor the equivalence with the collinearity condition, let \\(F\\) denote the foot of the perpendicular from \\(P^{\\prime}\\) to \\(A B\\), so that \\(F\\) is the midpoint of \\(P P^{\\prime}\\). We have that \\(P\\) lies on \\(C E\\) if and only if \\(F\\) lies on \\(M N\\), which occurs if and only if we have the equality \\(\\angle A F M=\\angle B F N\\) of signed angles modulo \\(\\pi\\). By concyclicity of \\(A P^{\\prime} F M\\) and \\(B F P^{\\prime} N\\), this is equivalent to \\(\\angle A P^{\\prime} M=\\angle B P^{\\prime} N\\), which occurs if and only if \\(A P^{\\prime} M\\) and \\(B P^{\\prime} N\\) are directly similar.\n![](https://cdn.mathpix.com/cropped/2025_08_23_54ae86499e5425f8b31eg-066.jpg?height=295&width=435&top_left_y=1673&top_left_x=816)\n\nFor the other equivalence with the area condition, we have the equality of signed areas \\(\\operatorname{area}(A B D)+\\operatorname{area}(A B P)=\\operatorname{area}\\left(A P^{\\prime} B D\\right)=\\operatorname{area}\\left(A P^{\\prime} D\\right)+\\operatorname{area}\\left(B D P^{\\prime}\\right)\\). Using the identity \\(\\operatorname{area}(A D E)-\\operatorname{area}\\left(A P^{\\prime} D\\right)=\\operatorname{area}(A D E)+\\operatorname{area}\\left(A D P^{\\prime}\\right)=2 \\operatorname{area}(A D M)\\), and similarly for \\(B\\), we find that the area condition is equivalent to the equality\n\\[\n\\operatorname{area}(D A M)=\\operatorname{area}(D B N) .\n\\]\n\nNow note that \\(A\\) and \\(B\\) lie on the perpendicular bisectors of \\(P^{\\prime} E\\) and \\(P^{\\prime} C\\), respectively. If we write \\(G\\) and \\(H\\) for the feet of the perpendiculars from \\(D\\) to these perpendicular bisectors respectively, then this area condition can be rewritten as\n\\[\nM A \\cdot G D=N B \\cdot H D .\n\\]\n(In this condition, we interpret all lengths as signed lengths according to suitable conventions: for instance, we orient \\(P^{\\prime} E\\) from \\(P^{\\prime}\\) to \\(E\\), orient the parallel line \\(D H\\) in the same direction, and orient the perpendicular bisector of \\(P^{\\prime} E\\) at an angle \\(\\pi / 2\\) clockwise from the oriented segment \\(P^{\\prime} E\\) - we adopt the analogous conventions at \\(B\\).)\n![](https://cdn.mathpix.com/cropped/2025_08_23_54ae86499e5425f8b31eg-067.jpg?height=517&width=558&top_left_y=217&top_left_x=765)\n\nTo relate the signed lengths \\(G D\\) and \\(H D\\) to the triangles \\(A P^{\\prime} M\\) and \\(B P^{\\prime} N\\), we use the following calculation.\nClaim. Let \\(\\Gamma\\) denote the circle centred on \\(D\\) with both \\(E\\) and \\(C\\) on the circumference, and \\(h\\) the power of \\(P^{\\prime}\\) with respect to \\(\\Gamma\\). Then we have the equality\n\\[\nG D \\cdot P^{\\prime} M=H D \\cdot P^{\\prime} N=\\frac{1}{4} h \\neq 0 .\n\\]\n\nProof. Firstly, we have \\(h \\neq 0\\), since otherwise \\(P^{\\prime}\\) would lie on \\(\\Gamma\\), and hence the internal angle bisectors of \\(\\angle E D P^{\\prime}\\) and \\(\\angle P^{\\prime} D C\\) would pass through \\(A\\) and \\(B\\) respectively. This would violate the angle inequality \\(\\angle E D C \\neq 2 \\cdot \\angle A D B\\) given in the question.\n\nNext, let \\(E^{\\prime}\\) denote the second point of intersection of \\(P^{\\prime} E\\) with \\(\\Gamma\\), and let \\(E^{\\prime \\prime}\\) denote the point on \\(\\Gamma\\) diametrically opposite \\(E^{\\prime}\\), so that \\(E^{\\prime \\prime} E\\) is perpendicular to \\(P^{\\prime} E\\). The point \\(G\\) lies on the perpendicular bisectors of the sides \\(P^{\\prime} E\\) and \\(E E^{\\prime \\prime}\\) of the right-angled triangle \\(P^{\\prime} E E^{\\prime \\prime}\\); it follows that \\(G\\) is the midpoint of \\(P^{\\prime} E^{\\prime \\prime}\\). Since \\(D\\) is the midpoint of \\(E^{\\prime} E^{\\prime \\prime}\\), we have that \\(G D=\\frac{1}{2} P^{\\prime} E^{\\prime}\\). Since \\(P^{\\prime} M=\\frac{1}{2} P^{\\prime} E\\), we have \\(G D \\cdot P^{\\prime} M=\\frac{1}{4} P^{\\prime} E^{\\prime} \\cdot P^{\\prime} E=\\frac{1}{4} h\\). The other equality \\(H D \\cdot P^{\\prime} N\\) follows by exactly the same argument.\n![](https://cdn.mathpix.com/cropped/2025_08_23_54ae86499e5425f8b31eg-067.jpg?height=718&width=666&top_left_y=1667&top_left_x=731)\n\nFrom this claim, we see that the area condition is equivalent to the equality\n\\[\n\\left(M A: P^{\\prime} M\\right)=\\left(N B: P^{\\prime} N\\right)\n\\]\nof ratios of signed lengths, which is equivalent to direct similarity of \\(A P^{\\prime} M\\) and \\(B P^{\\prime} N\\), as desired.\n\nSolution 2. Along the perpendicular bisector of \\(C E\\), define the linear function\n\\[\nf(X)=\\operatorname{area}(B C X)+\\operatorname{area}(A X E)-\\operatorname{area}(A B X)-\\operatorname{area}(A B P),\n\\]\nwhere, from now on, we always use signed areas. Thus, we want to show that \\(C, P, E\\) are collinear if and only if \\(f(D)=0\\).\n![](https://cdn.mathpix.com/cropped/2025_08_23_54ae86499e5425f8b31eg-068.jpg?height=429&width=512&top_left_y=505&top_left_x=776)\n\nLet \\(P^{\\prime}\\) be the reflection of \\(P\\) across line \\(A B\\). The point \\(P^{\\prime}\\) does not lie on the line \\(C E\\). To see this, we let \\(A^{\\prime \\prime}\\) and \\(B^{\\prime \\prime}\\) be the points obtained from \\(A\\) and \\(B\\) by dilating with scale factor 2 about \\(P^{\\prime}\\), so that \\(P\\) is the orthogonal projection of \\(P^{\\prime}\\) onto \\(A^{\\prime \\prime} B^{\\prime \\prime}\\). Since \\(A\\) lies on the perpendicular bisector of \\(P^{\\prime} E\\), the triangle \\(A^{\\prime \\prime} E P^{\\prime}\\) is right-angled at \\(E\\) (and \\(B^{\\prime \\prime} C P^{\\prime}\\) similarly). If \\(P^{\\prime}\\) were to lie on \\(C E\\), then the lines \\(A^{\\prime \\prime} E\\) and \\(B^{\\prime \\prime} C\\) would be perpendicular to \\(C E\\) and \\(A^{\\prime \\prime}\\) and \\(B^{\\prime \\prime}\\) would lie on the opposite side of \\(C E\\) to \\(D\\). It follows that the line \\(A^{\\prime \\prime} B^{\\prime \\prime}\\) does not meet triangle \\(C D E\\), and hence point \\(P\\) does not lie inside \\(C D E\\). But then \\(P\\) must lie inside \\(A B C E\\), and it is clear that such a point cannot reflect to a point \\(P^{\\prime}\\) on \\(C E\\).\n\nWe thus let \\(O\\) be the centre of the circle \\(C E P^{\\prime}\\). The lines \\(A O\\) and \\(B O\\) are the perpendicular bisectors of \\(E P^{\\prime}\\) and \\(C P^{\\prime}\\), respectively, so\n\\[\n\\begin{aligned}\n\\operatorname{area}(B C O)+\\operatorname{area}(A O E) & =\\operatorname{area}\\left(O P^{\\prime} B\\right)+\\operatorname{area}\\left(P^{\\prime} O A\\right)=\\operatorname{area}\\left(P^{\\prime} B O A\\right) \\\\\n& =\\operatorname{area}(A B O)+\\operatorname{area}\\left(B A P^{\\prime}\\right)=\\operatorname{area}(A B O)+\\operatorname{area}(A B P),\n\\end{aligned}\n\\]\nand hence \\(f(O)=0\\).\nNotice that if point \\(O\\) coincides with \\(D\\) then points \\(A, B\\) lie in angle domain \\(C D E\\) and \\(\\angle E O C=2 \\cdot \\angle A O B\\), which is not allowed. So, \\(O\\) and \\(D\\) must be distinct. Since \\(f\\) is linear and vanishes at \\(O\\), it follows that \\(f(D)=0\\) if and only if \\(f\\) is constant zero - we want to show this occurs if and only if \\(C, P, E\\) are collinear.\n![](https://cdn.mathpix.com/cropped/2025_08_23_54ae86499e5425f8b31eg-068.jpg?height=552&width=1257&top_left_y=1907&top_left_x=405)\n\nIn the one direction, suppose firstly that \\(C, P, E\\) are not collinear, and let \\(T\\) be the centre of the circle \\(C E P\\). The same calculation as above provides\n\\[\n\\operatorname{area}(B C T)+\\operatorname{area}(A T E)=\\operatorname{area}(P B T A)=\\operatorname{area}(A B T)-\\operatorname{area}(A B P)\n\\]\n\nSO\n\\[\nf(T)=-2 \\operatorname{area}(A B P) \\neq 0 .\n\\]\n\nHence, the linear function \\(f\\) is nonconstant with its zero is at \\(O\\), so that \\(f(D) \\neq 0\\).\nIn the other direction, suppose that the points \\(C, P, E\\) are collinear. We will show that \\(f\\) is constant zero by finding a second point (other than \\(O\\) ) at which it vanishes.\n![](https://cdn.mathpix.com/cropped/2025_08_23_54ae86499e5425f8b31eg-069.jpg?height=395&width=1095&top_left_y=376&top_left_x=485)\n\nLet \\(Q\\) be the reflection of \\(P\\) across the midpoint of \\(A B\\), so \\(P A Q B\\) is a parallelogram. It is easy to see that \\(Q\\) is on the perpendicular bisector of \\(C E\\); for instance if \\(A^{\\prime}\\) and \\(B^{\\prime}\\) are the points produced from \\(A\\) and \\(B\\) by dilating about \\(P\\) with scale factor 2, then the projection of \\(Q\\) to \\(C E\\) is the midpoint of the projections of \\(A^{\\prime}\\) and \\(B^{\\prime}\\), which are \\(E\\) and \\(C\\) respectively. The triangles \\(B C Q\\) and \\(A Q E\\) are indirectly congruent, so\n\\[\nf(Q)=(\\operatorname{area}(B C Q)+\\operatorname{area}(A Q E))-(\\operatorname{area}(A B Q)-\\operatorname{area}(B A P))=0-0=0 .\n\\]\n\nThe points \\(O\\) and \\(Q\\) are distinct. To see this, consider the circle \\(\\omega\\) centred on \\(Q\\) with \\(P^{\\prime}\\) on the circumference; since triangle \\(P P^{\\prime} Q\\) is right-angled at \\(P^{\\prime}\\), it follows that \\(P\\) lies outside \\(\\omega\\). On the other hand, \\(P\\) lies between \\(C\\) and \\(E\\) on the line \\(C P E\\). It follows that \\(C\\) and \\(E\\) cannot both lie on \\(\\omega\\), so that \\(\\omega\\) is not the circle \\(C E P^{\\prime}\\) and \\(Q \\neq O\\).\n\nSince \\(O\\) and \\(Q\\) are distinct zeroes of the linear function \\(f\\), we have \\(f(D)=0\\) as desired.\nComment 1. The condition \\(\\angle E D C \\neq 2 \\cdot \\angle A D B\\) cannot be omitted. If \\(D\\) is the centre of circle \\(C E P^{\\prime}\\), then the condition on triangle areas is satisfied automatically, without having \\(P\\) on line \\(C E\\).\n\nComment 2. The \"only if\" part of this problem is easier than the \"if\" part. For example, in the second part of Solution 2, the triangles \\(E A Q\\) and \\(Q B C\\) are indirectly congruent, so the sum of their areas is 0 , and \\(D C Q E\\) is a kite. Now one can easily see that \\(\\angle(A Q, D E)=\\angle(C D, C B)\\) and \\(\\angle(B Q, D C)=\\angle(E D, E A)\\), whence \\(\\operatorname{area}(B C D)=\\operatorname{area}(A Q D)+\\operatorname{area}(E Q A)\\) and area \\((A D E)= \\operatorname{area}(B D Q)+\\operatorname{area}(B Q C)\\), which yields the result.\n\nComment 3. The origin of the problem is the following observation. Let \\(A B D H\\) be a tetrahedron and consider the sphere \\(\\mathcal{S}\\) that is tangent to the four face planes, internally to planes \\(A D H\\) and \\(B D H\\) and externally to \\(A B D\\) and \\(A B H\\) (or vice versa). It is known that the sphere \\(\\mathcal{S}\\) exists if and only if \\(\\operatorname{area}(A D H)+\\operatorname{area}(B D H) \\neq \\operatorname{area}(A B H)+\\operatorname{area}(A B D)\\); this relation comes from the usual formula for the volume of the tetrahedron.\n\nLet \\(T, T_{a}, T_{b}, T_{d}\\) be the points of tangency between the sphere and the four planes, as shown in the picture. Rotate the triangle \\(A B H\\) inward, the triangles \\(B D H\\) and \\(A D H\\) outward, into the triangles \\(A B P, B D C\\) and \\(A D E\\), respectively, in the plane \\(A B D\\). Notice that the points \\(T_{d}, T_{a}, T_{b}\\) are rotated to \\(T\\), so we have \\(H T_{a}=H T_{b}=H T_{d}=P T=C T=E T\\). Therefore, the point \\(T\\) is the centre of the circle \\(C E P\\). Hence, if the sphere exists then \\(C, E, P\\) cannot be collinear.\n\nIf the condition \\(\\angle E D C \\neq 2 \\cdot \\angle A D B\\) is replaced by the constraint that the angles \\(\\angle E D A, \\angle A D B\\) and \\(\\angle B D C\\) satisfy the triangle inequality, it enables reconstructing the argument with the tetrahedron and the tangent sphere.\n![](https://cdn.mathpix.com/cropped/2025_08_23_54ae86499e5425f8b31eg-070.jpg?height=1043&width=1289&top_left_y=839&top_left_x=391)", "source_pdf": "imosl_2019.pdf", "notes": "fallback-regex"}
{"id": "IMOSL-2019-G6", "contest": "IMOSL", "year": "2019", "problem_number": "G6", "problem": "Let \\(I\\) be the incentre of acute-angled triangle \\(A B C\\). Let the incircle meet \\(B C, C A\\), and \\(A B\\) at \\(D, E\\), and \\(F\\), respectively. Let line \\(E F\\) intersect the circumcircle of the triangle at \\(P\\) and \\(Q\\), such that \\(F\\) lies between \\(E\\) and \\(P\\). Prove that \\(\\angle D P A+\\angle A Q D=\\angle Q I P\\).\n(Slovakia)", "solution": "1. Let \\(N\\) and \\(M\\) be the midpoints of the arcs \\(\\widehat{B C}\\) of the circumcircle, containing and opposite vertex \\(A\\), respectively. By \\(\\angle F A E=\\angle B A C=\\angle B N C\\), the right-angled kites \\(A F I E\\) and \\(N B M C\\) are similar. Consider the spiral similarity \\(\\varphi\\) (dilation in case of \\(A B=A C\\) ) that moves \\(A F I E\\) to \\(N B M C\\). The directed angle in which \\(\\varphi\\) changes directions is \\(\\angle(A F, N B)\\), same as \\(\\angle(A P, N P)\\) and \\(\\angle(A Q, N Q)\\); so lines \\(A P\\) and \\(A Q\\) are mapped to lines \\(N P\\) and \\(N Q\\), respectively. Line \\(E F\\) is mapped to \\(B C\\); we can see that the intersection points \\(P=E F \\cap A P\\) and \\(Q=E F \\cap A Q\\) are mapped to points \\(B C \\cap N P\\) and \\(B C \\cap N Q\\), respectively. Denote these points by \\(P^{\\prime}\\) and \\(Q^{\\prime}\\), respectively.\n![](https://cdn.mathpix.com/cropped/2025_08_23_54ae86499e5425f8b31eg-071.jpg?height=689&width=1492&top_left_y=879&top_left_x=285)\n\nLet \\(L\\) be the midpoint of \\(B C\\). We claim that points \\(P, Q, D, L\\) are concyclic (if \\(D=L\\) then line \\(B C\\) is tangent to circle \\(P Q D\\) ). Let \\(P Q\\) and \\(B C\\) meet at \\(Z\\). By applying Menelaus' theorem to triangle \\(A B C\\) and line \\(E F Z\\), we have\n\\[\n\\frac{B D}{D C}=\\frac{B F}{F A} \\cdot \\frac{A E}{E C}=-\\frac{B Z}{Z C},\n\\]\nso the pairs \\(B, C\\) and \\(D, Z\\) are harmonic. It is well-known that this implies \\(Z B \\cdot Z C=Z D \\cdot Z L\\). (The inversion with pole \\(Z\\) that swaps \\(B\\) and \\(C\\) sends \\(Z\\) to infinity and \\(D\\) to the midpoint of \\(B C\\), because the cross-ratio is preserved.) Hence, \\(Z D \\cdot Z L=Z B \\cdot Z C=Z P \\cdot Z Q\\) by the power of \\(Z\\) with respect to the circumcircle; this proves our claim.\n\nBy \\(\\angle M P P^{\\prime}=\\angle M Q Q^{\\prime}=\\angle M L P^{\\prime}=\\angle M L Q^{\\prime}=90^{\\circ}\\), the quadrilaterals \\(M L P P^{\\prime}\\) and \\(M L Q Q^{\\prime}\\) are cyclic. Then the problem statement follows by\n\\[\n\\begin{aligned}\n\\angle D P A+\\angle A Q D & =360^{\\circ}-\\angle P A Q-\\angle Q D P=360^{\\circ}-\\angle P N Q-\\angle Q L P \\\\\n& =\\angle L P N+\\angle N Q L=\\angle P^{\\prime} M L+\\angle L M Q^{\\prime}=\\angle P^{\\prime} M Q^{\\prime}=\\angle P I Q .\n\\end{aligned}\n\\]\n\nSolution 2. Define the point \\(M\\) and the same spiral similarity \\(\\varphi\\) as in the previous solution. (The point \\(N\\) is not necessary.) It is well-known that the centre of the spiral similarity that maps \\(F, E\\) to \\(B, C\\) is the Miquel point of the lines \\(F E, B C, B F\\) and \\(C E\\); that is, the second intersection of circles \\(A B C\\) and \\(A E F\\). Denote that point by \\(S\\).\n\nBy \\(\\varphi(F)=B\\) and \\(\\varphi(E)=C\\) the triangles \\(S B F\\) and \\(S C E\\) are similar, so we have\n\\[\n\\frac{S B}{S C}=\\frac{B F}{C E}=\\frac{B D}{C D} .\n\\]\n\nBy the converse of the angle bisector theorem, that indicates that line \\(S D\\) bisects \\(\\angle B S C\\) and hence passes through \\(M\\).\n\nLet \\(K\\) be the intersection point of lines \\(E F\\) and \\(S I\\). Notice that \\(\\varphi\\) sends points \\(S, F, E, I\\) to \\(S, B, C, M\\), so \\(\\varphi(K)=\\varphi(F E \\cap S I)=B C \\cap S M=D\\). By \\(\\varphi(I)=M\\), we have \\(K D \\| I M\\).\n![](https://cdn.mathpix.com/cropped/2025_08_23_54ae86499e5425f8b31eg-072.jpg?height=657&width=686&top_left_y=848&top_left_x=688)\n\nWe claim that triangles \\(S P I\\) and \\(S D Q\\) are similar, and so are triangles \\(S P D\\) and \\(S I Q\\). Let ray \\(S I\\) meet the circumcircle again at \\(L\\). Note that the segment \\(E F\\) is perpendicular to the angle bisector \\(A M\\). Then by \\(\\angle A M L=\\angle A S L=\\angle A S I=90^{\\circ}\\), we have \\(M L \\| P Q\\). Hence, \\(\\overparen{P L}=\\overparen{M Q}\\) and therefore \\(\\angle P S L=\\angle M S Q=\\angle D S Q\\). By \\(\\angle Q P S=\\angle Q M S\\), the triangles \\(S P K\\) and \\(S M Q\\) are similar. Finally,\n\\[\n\\frac{S P}{S I}=\\frac{S P}{S K} \\cdot \\frac{S K}{S I}=\\frac{S M}{S Q} \\cdot \\frac{S D}{S M}=\\frac{S D}{S Q}\n\\]\nshows that triangles \\(S P I\\) and \\(S D Q\\) are similar. The second part of the claim can be proved analogously.\n\nNow the problem statement can be proved by\n\\[\n\\angle D P A+\\angle A Q D=\\angle D P S+\\angle S Q D=\\angle Q I S+\\angle S I P=\\angle Q I P .\n\\]\n\nSolution 3. Denote the circumcircle of triangle \\(A B C\\) by \\(\\Gamma\\), and let rays \\(P D\\) and \\(Q D\\) meet \\(\\Gamma\\) again at \\(V\\) and \\(U\\), respectively. We will show that \\(A U \\perp I P\\) and \\(A V \\perp I Q\\). Then the problem statement will follow as\n\\[\n\\angle D P A+\\angle A Q D=\\angle V U A+\\angle A V U=180^{\\circ}-\\angle U A V=\\angle Q I P .\n\\]\n\nLet \\(M\\) be the midpoint of \\(\\operatorname{arc} \\widehat{B U V C}\\) and let \\(N\\) be the midpoint of \\(\\operatorname{arc} \\widehat{C A B}\\); the lines \\(A I M\\) and \\(A N\\) being the internal and external bisectors of angle \\(B A C\\), respectively, are perpendicular. Let the tangents drawn to \\(\\Gamma\\) at \\(B\\) and \\(C\\) meet at \\(R\\); let line \\(P Q\\) meet \\(A U, A I, A V\\) and \\(B C\\) at \\(X, T, Y\\) and \\(Z\\), respectively.\n\nAs in Solution 1, we observe that the pairs \\(B, C\\) and \\(D, Z\\) are harmonic. Projecting these points from \\(Q\\) onto the circumcircle, we can see that \\(B, C\\) and \\(U, P\\) are also harmonic. Analogously, the pair \\(V, Q\\) is harmonic with \\(B, C\\). Consider the inversion about the circle with centre \\(R\\), passing through \\(B\\) and \\(C\\). Points \\(B\\) and \\(C\\) are fixed points, so this inversion exchanges every point of \\(\\Gamma\\) by its harmonic pair with respect to \\(B, C\\). In particular, the inversion maps points \\(B, C, N, U, V\\) to points \\(B, C, M, P, Q\\), respectively.\n\nCombine the inversion with projecting \\(\\Gamma\\) from \\(A\\) to line \\(P Q\\); the points \\(B, C, M, P, Q\\) are projected to \\(F, E, T, P, Q\\), respectively.\n![](https://cdn.mathpix.com/cropped/2025_08_23_54ae86499e5425f8b31eg-073.jpg?height=986&width=1360&top_left_y=1096&top_left_x=351)\n\nThe combination of these two transformations is projective map from the lines \\(A B, A C\\), \\(A N, A U, A V\\) to \\(I F, I E, I T, I P, I Q\\), respectively. On the other hand, we have \\(A B \\perp I F\\), \\(A C \\perp I E\\) and \\(A N \\perp A T\\), so the corresponding lines in these two pencils are perpendicular. This proves \\(A U \\perp I P\\) and \\(A V \\perp I Q\\), and hence completes the solution.", "source_pdf": "imosl_2019.pdf", "notes": "fallback-regex"}
{"id": "IMOSL-2019-G8", "contest": "IMOSL", "year": "2019", "problem_number": "G8", "problem": "Let \\(\\mathcal{L}\\) be the set of all lines in the plane and let \\(f\\) be a function that assigns to each line \\(\\ell \\in \\mathcal{L}\\) a point \\(f(\\ell)\\) on \\(\\ell\\). Suppose that for any point \\(X\\), and for any three lines \\(\\ell_{1}, \\ell_{2}, \\ell_{3}\\) passing through \\(X\\), the points \\(f\\left(\\ell_{1}\\right), f\\left(\\ell_{2}\\right), f\\left(\\ell_{3}\\right)\\) and \\(X\\) lie on a circle.\n\nProve that there is a unique point \\(P\\) such that \\(f(\\ell)=P\\) for any line \\(\\ell\\) passing through \\(P\\).\n(Australia)", "solution": "Common remarks. The condition on \\(f\\) is equivalent to the following: There is some function \\(g\\) that assigns to each point \\(X\\) a circle \\(g(X)\\) passing through \\(X\\) such that for any line \\(\\ell\\) passing through \\(X\\), the point \\(f(\\ell)\\) lies on \\(g(X)\\). (The function \\(g\\) may not be uniquely defined for all points, if some points \\(X\\) have at most one value of \\(f(\\ell)\\) other than \\(X\\); for such points, an arbitrary choice is made.)\n\nIf there were two points \\(P\\) and \\(Q\\) with the given property, \\(f(P Q)\\) would have to be both \\(P\\) and \\(Q\\), so there is at most one such point, and it will suffice to show that such a point exists.\n\n1. We provide a complete characterisation of the functions satisfying the given condition.\n\nWrite \\(\\angle\\left(\\ell_{1}, \\ell_{2}\\right)\\) for the directed angle modulo \\(180^{\\circ}\\) between the lines \\(\\ell_{1}\\) and \\(\\ell_{2}\\). Given a point \\(P\\) and an angle \\(\\alpha \\in\\left(0,180^{\\circ}\\right)\\), for each line \\(\\ell\\), let \\(\\ell^{\\prime}\\) be the line through \\(P\\) satisfying \\(\\angle\\left(\\ell^{\\prime}, \\ell\\right)=\\alpha\\), and let \\(h_{P, \\alpha}(\\ell)\\) be the intersection point of \\(\\ell\\) and \\(\\ell^{\\prime}\\). We will prove that there is some pair ( \\(P, \\alpha\\) ) such that \\(f\\) and \\(h_{P, \\alpha}\\) are the same function. Then \\(P\\) is the unique point in the problem statement.\n\nGiven an angle \\(\\alpha\\) and a point \\(P\\), let a line \\(\\ell\\) be called ( \\(P, \\alpha\\) )-good if \\(f(\\ell)=h_{P, \\alpha}(\\ell)\\). Let a point \\(X \\neq P\\) be called ( \\(P, \\alpha\\) )-good if the circle \\(g(X)\\) passes through \\(P\\) and some point \\(Y \\neq P, X\\) on \\(g(X)\\) satisfies \\(\\angle(P Y, Y X)=\\alpha\\). It follows from this definition that if \\(X\\) is \\((P, \\alpha)\\) good then every point \\(Y \\neq P, X\\) of \\(g(X)\\) satisfies this angle condition, so \\(h_{P, \\alpha}(X Y)=Y\\) for every \\(Y \\in g(X)\\). Equivalently, \\(f(\\ell) \\in\\left\\{X, h_{P, \\alpha}(\\ell)\\right\\}\\) for each line \\(\\ell\\) passing through \\(X\\). This shows the following lemma.\nLemma 1. If \\(X\\) is ( \\(P, \\alpha\\) )-good and \\(\\ell\\) is a line passing through \\(X\\) then either \\(f(\\ell)=X\\) or \\(\\ell\\) is ( \\(P, \\alpha\\) )-good.\nLemma 2. If \\(X\\) and \\(Y\\) are different ( \\(P, \\alpha\\) )-good points, then line \\(X Y\\) is ( \\(P, \\alpha\\) )-good.\nProof. If \\(X Y\\) is not ( \\(P, \\alpha\\) )-good then by the previous Lemma, \\(f(X Y)=X\\) and similarly \\(f(X Y)=Y\\), but clearly this is impossible as \\(X \\neq Y\\).\n\nLemma 3. If \\(\\ell_{1}\\) and \\(\\ell_{2}\\) are different ( \\(P, \\alpha\\) )-good lines which intersect at \\(X \\neq P\\), then either \\(f\\left(\\ell_{1}\\right)=X\\) or \\(f\\left(\\ell_{2}\\right)=X\\) or \\(X\\) is \\((P, \\alpha)\\)-good.\nProof. If \\(f\\left(\\ell_{1}\\right), f\\left(\\ell_{2}\\right) \\neq X\\), then \\(g(X)\\) is the circumcircle of \\(X, f\\left(\\ell_{1}\\right)\\) and \\(f\\left(\\ell_{2}\\right)\\). Since \\(\\ell_{1}\\) and \\(\\ell_{2}\\) are ( \\(P, \\alpha\\) )-good lines, the angles\n\\[\n\\angle\\left(P f\\left(\\ell_{1}\\right), f\\left(\\ell_{1}\\right) X\\right)=\\angle\\left(P f\\left(\\ell_{2}\\right), f\\left(\\ell_{2}\\right) X\\right)=\\alpha\n\\]\nso \\(P\\) lies on \\(g(X)\\). Hence, \\(X\\) is \\((P, \\alpha)\\)-good.\nLemma 4. If \\(\\ell_{1}, \\ell_{2}\\) and \\(\\ell_{3}\\) are different ( \\(P, \\alpha\\) )-good lines which intersect at \\(X \\neq P\\), then \\(X\\) is ( \\(P, \\alpha\\) )-good.\nProof. This follows from the previous Lemma since at most one of the three lines \\(\\ell_{i}\\) can satisfy \\(f\\left(\\ell_{i}\\right)=X\\) as the three lines are all ( \\(P, \\alpha\\) )-good.\n\nLemma 5. If \\(A B C\\) is a triangle such that \\(A, B, C, f(A B), f(A C)\\) and \\(f(B C)\\) are all different points, then there is some point \\(P\\) and some angle \\(\\alpha\\) such that \\(A, B\\) and \\(C\\) are ( \\(P, \\alpha\\) )-good points and \\(A B, B C\\) and \\(C A\\) are ( \\(P, \\alpha\\) )-good lines.\n![](https://cdn.mathpix.com/cropped/2025_08_23_54ae86499e5425f8b31eg-079.jpg?height=409&width=601&top_left_y=217&top_left_x=733)\n\nProof. Let \\(D, E, F\\) denote the points \\(f(B C), f(A C), f(A B)\\), respectively. Then \\(g(A)\\), \\(g(B)\\) and \\(g(C)\\) are the circumcircles of \\(A E F, B D F\\) and \\(C D E\\), respectively. Let \\(P \\neq F\\) be the second intersection of circles \\(g(A)\\) and \\(g(B)\\) (or, if these circles are tangent at \\(F\\), then \\(P=F\\) ). By Miquel's theorem (or an easy angle chase), \\(g(C)\\) also passes through \\(P\\). Then by the cyclic quadrilaterals, the directed angles\n\\[\n\\angle(P D, D C)=\\angle(P F, F B)=\\angle(P E, E A)=\\alpha,\n\\]\nfor some angle \\(\\alpha\\). Hence, lines \\(A B, B C\\) and \\(C A\\) are all ( \\(P, \\alpha\\) )-good, so by Lemma 3, \\(A, B\\) and \\(C\\) are ( \\(P, \\alpha\\) )-good. (In the case where \\(P=D\\), the line \\(P D\\) in the equation above denotes the line which is tangent to \\(g(B)\\) at \\(P=D\\). Similar definitions are used for \\(P E\\) and \\(P F\\) in the cases where \\(P=E\\) or \\(P=F\\).)\n\nConsider the set \\(\\Omega\\) of all points ( \\(x, y\\) ) with integer coordinates \\(1 \\leqslant x, y \\leqslant 1000\\), and consider the set \\(L_{\\Omega}\\) of all horizontal, vertical and diagonal lines passing through at least one point in \\(\\Omega\\). A simple counting argument shows that there are 5998 lines in \\(L_{\\Omega}\\). For each line \\(\\ell\\) in \\(L_{\\Omega}\\) we colour the point \\(f(\\ell)\\) red. Then there are at most 5998 red points. Now we partition the points in \\(\\Omega\\) into 10000 ten by ten squares. Since there are at most 5998 red points, at least one of these squares \\(\\Omega_{10}\\) contains no red points. Let ( \\(m, n\\) ) be the bottom left point in \\(\\Omega_{10}\\). Then the triangle with vertices \\((m, n),(m+1, n)\\) and \\((m, n+1)\\) satisfies the condition of Lemma 5 , so these three vertices are all ( \\(P, \\alpha\\) )-good for some point \\(P\\) and angle \\(\\alpha\\), as are the lines joining them. From this point on, we will simply call a point or line good if it is ( \\(P, \\alpha\\) )-good for this particular pair ( \\(P, \\alpha\\) ). Now by Lemma 1 , the line \\(x=m+1\\) is good, as is the line \\(y=n+1\\). Then Lemma 3 implies that ( \\(m+1, n+1\\) ) is good. By applying these two lemmas repeatedly, we can prove that the line \\(x+y=m+n+2\\) is good, then the points ( \\(m, n+2\\) ) and ( \\(m+2, n\\) ) then the lines \\(x=m+2\\) and \\(y=n+2\\), then the points ( \\(m+2, n+1\\) ), ( \\(m+1, n+2\\) ) and ( \\(m+2, n+2\\) ) and so on until we have prove that all points in \\(\\Omega_{10}\\) are good.\n\nNow we will use this to prove that every point \\(S \\neq P\\) is good. Since \\(g(S)\\) is a circle, it passes through at most two points of \\(\\Omega_{10}\\) on any vertical line, so at most 20 points in total. Moreover, any line \\(\\ell\\) through \\(S\\) intersects at most 10 points in \\(\\Omega_{10}\\). Hence, there are at least eight lines \\(\\ell\\) through \\(S\\) which contain a point \\(Q\\) in \\(\\Omega_{10}\\) which is not on \\(g(S)\\). Since \\(Q\\) is not on \\(g(S)\\), the point \\(f(\\ell) \\neq Q\\). Hence, by Lemma 1, the line \\(\\ell\\) is good. Hence, at least eight good lines pass through \\(S\\), so by Lemma 4, the point \\(S\\) is good. Hence, every point \\(S \\neq P\\) is good, so by Lemma 2, every line is good. In particular, every line \\(\\ell\\) passing through \\(P\\) is good, and therefore satisfies \\(f(\\ell)=P\\), as required.\n\nSolution 2. Note that for any distinct points \\(X, Y\\), the circles \\(g(X)\\) and \\(g(Y)\\) meet on \\(X Y\\) at the point \\(f(X Y) \\in g(X) \\cap g(Y) \\cap(X Y)\\). We write \\(s(X, Y)\\) for the second intersection point of circles \\(g(X)\\) and \\(g(Y)\\).\nLemma 1. Suppose that \\(X, Y\\) and \\(Z\\) are not collinear, and that \\(f(X Y) \\notin\\{X, Y\\}\\) and similarly for \\(Y Z\\) and \\(Z X\\). Then \\(s(X, Y)=s(Y, Z)=s(Z, X)\\).\nProof. The circles \\(g(X), g(Y)\\) and \\(g(Z)\\) through the vertices of triangle \\(X Y Z\\) meet pairwise on the corresponding edges (produced). By Miquel's theorem, the second points of intersection of any two of the circles coincide. (See the diagram for Lemma 5 of Solution 1.)\n\nNow pick any line \\(\\ell\\) and any six different points \\(Y_{1}, \\ldots, Y_{6}\\) on \\(\\ell \\backslash\\{f(\\ell)\\}\\). Pick a point \\(X\\) not on \\(\\ell\\) or any of the circles \\(g\\left(Y_{i}\\right)\\). Reordering the indices if necessary, we may suppose that \\(Y_{1}, \\ldots, Y_{4}\\) do not lie on \\(g(X)\\), so that \\(f\\left(X Y_{i}\\right) \\notin\\left\\{X, Y_{i}\\right\\}\\) for \\(1 \\leqslant i \\leqslant 4\\). By applying the above lemma to triangles \\(X Y_{i} Y_{j}\\) for \\(1 \\leqslant i<j \\leqslant 4\\), we find that the points \\(s\\left(Y_{i}, Y_{j}\\right)\\) and \\(s\\left(X, Y_{i}\\right)\\) are all equal, to point \\(O\\) say. Note that either \\(O\\) does not lie on \\(\\ell\\), or \\(O=f(\\ell)\\), since \\(O \\in g\\left(Y_{i}\\right)\\).\n\nNow consider an arbitrary point \\(X^{\\prime}\\) not on \\(\\ell\\) or any of the circles \\(g\\left(Y_{i}\\right)\\) for \\(1 \\leqslant i \\leqslant 4\\). As above, we see that there are two indices \\(1 \\leqslant i<j \\leqslant 4\\) such that \\(Y_{i}\\) and \\(Y_{j}\\) do not lie on \\(g\\left(X^{\\prime}\\right)\\). By applying the above lemma to triangle \\(X^{\\prime} Y_{i} Y_{j}\\) we see that \\(s\\left(X^{\\prime}, Y_{i}\\right)=O\\), and in particular \\(g\\left(X^{\\prime}\\right)\\) passes through \\(O\\).\n\nWe will now show that \\(f\\left(\\ell^{\\prime}\\right)=O\\) for all lines \\(\\ell^{\\prime}\\) through \\(O\\). By the above note, we may assume that \\(\\ell^{\\prime} \\neq \\ell\\). Consider a variable point \\(X^{\\prime} \\in \\ell^{\\prime} \\backslash\\{O\\}\\) not on \\(\\ell\\) or any of the circles \\(g\\left(Y_{i}\\right)\\) for \\(1 \\leqslant i \\leqslant 4\\). We know that \\(f\\left(\\ell^{\\prime}\\right) \\in g\\left(X^{\\prime}\\right) \\cap \\ell^{\\prime}=\\left\\{X^{\\prime}, O\\right\\}\\). Since \\(X^{\\prime}\\) was suitably arbitrary, we have \\(f\\left(\\ell^{\\prime}\\right)=O\\) as desired.\n\nSolution 3. Notice that, for any two different points \\(X\\) and \\(Y\\), the point \\(f(X Y)\\) lies on both \\(g(X)\\) and \\(g(Y)\\), so any two such circles meet in at least one point. We refer to two circles as cutting only in the case where they cross, and so meet at exactly two points, thus excluding the cases where they are tangent or are the same circle.\nLemma 1. Suppose there is a point \\(P\\) such that all circles \\(g(X)\\) pass through \\(P\\). Then \\(P\\) has the given property.\nProof. Consider some line \\(\\ell\\) passing through \\(P\\), and suppose that \\(f(\\ell) \\neq P\\). Consider some \\(X \\in \\ell\\) with \\(X \\neq P\\) and \\(X \\neq f(\\ell)\\). Then \\(g(X)\\) passes through all of \\(P, f(\\ell)\\) and \\(X\\), but those three points are collinear, a contradiction.\n\nLemma 2. Suppose that, for all \\(\\epsilon>0\\), there is a point \\(P_{\\epsilon}\\) with \\(g\\left(P_{\\epsilon}\\right)\\) of radius at most \\(\\epsilon\\). Then there is a point \\(P\\) with the given property.\nProof. Consider a sequence \\(\\epsilon_{i}=2^{-i}\\) and corresponding points \\(P_{\\epsilon_{i}}\\). Because the two circles \\(g\\left(P_{\\epsilon_{i}}\\right)\\) and \\(g\\left(P_{\\epsilon_{j}}\\right)\\) meet, the distance between \\(P_{\\epsilon_{i}}\\) and \\(P_{\\epsilon_{j}}\\) is at most \\(2^{1-i}+2^{1-j}\\). As \\(\\sum_{i} \\epsilon_{i}\\) converges, these points converge to some point \\(P\\). For all \\(\\epsilon>0\\), the point \\(P\\) has distance at most \\(2 \\epsilon\\) from \\(P_{\\epsilon}\\), and all circles \\(g(X)\\) pass through a point with distance at most \\(2 \\epsilon\\) from \\(P_{\\epsilon}\\), so distance at most \\(4 \\epsilon\\) from \\(P\\). A circle that passes distance at most \\(4 \\epsilon\\) from \\(P\\) for all \\(\\epsilon>0\\) must pass through \\(P\\), so by Lemma 1 the point \\(P\\) has the given property.\n\nLemma 3. Suppose no two of the circles \\(g(X)\\) cut. Then there is a point \\(P\\) with the given property.\nProof. Consider a circle \\(g(X)\\) with centre \\(Y\\). The circle \\(g(Y)\\) must meet \\(g(X)\\) without cutting it, so has half the radius of \\(g(X)\\). Repeating this argument, there are circles with arbitrarily small radius and the result follows by Lemma 2.\n\nLemma 4. Suppose there are six different points \\(A, B_{1}, B_{2}, B_{3}, B_{4}, B_{5}\\) such that no three are collinear, no four are concyclic, and all the circles \\(g\\left(B_{i}\\right)\\) cut pairwise at \\(A\\). Then there is a point \\(P\\) with the given property.\nProof. Consider some line \\(\\ell\\) through \\(A\\) that does not pass through any of the \\(B_{i}\\) and is not tangent to any of the \\(g\\left(B_{i}\\right)\\). Fix some direction along that line, and let \\(X_{\\epsilon}\\) be the point on \\(\\ell\\) that has distance \\(\\epsilon\\) from \\(A\\) in that direction. In what follows we consider only those \\(\\epsilon\\) for which \\(X_{\\epsilon}\\) does not lie on any \\(g\\left(B_{i}\\right)\\) (this restriction excludes only finitely many possible values of \\(\\epsilon\\) ).\n\nConsider the circle \\(g\\left(X_{\\epsilon}\\right)\\). Because no four of the \\(B_{i}\\) are concyclic, at most three of them lie on this circle, so at least two of them do not. There must be some sequence of \\(\\epsilon \\rightarrow 0\\) such that it is the same two of the \\(B_{i}\\) for all \\(\\epsilon\\) in that sequence, so now restrict attention to that sequence, and suppose without loss of generality that \\(B_{1}\\) and \\(B_{2}\\) do not lie on \\(g\\left(X_{\\epsilon}\\right)\\) for any \\(\\epsilon\\) in that sequence.\n\nThen \\(f\\left(X_{\\epsilon} B_{1}\\right)\\) is not \\(B_{1}\\), so must be the other point of intersection of \\(X_{\\epsilon} B_{1}\\) with \\(g\\left(B_{1}\\right)\\), and the same applies with \\(B_{2}\\). Now consider the three points \\(X_{\\epsilon}, f\\left(X_{\\epsilon} B_{1}\\right)\\) and \\(f\\left(X_{\\epsilon} B_{2}\\right)\\). As \\(\\epsilon \\rightarrow 0\\), the angle at \\(X_{\\epsilon}\\) tends to \\(\\angle B_{1} A B_{2}\\) or \\(180^{\\circ}-\\angle B_{1} A B_{2}\\), which is not 0 or \\(180^{\\circ}\\) because no three of the points were collinear. All three distances between those points are bounded above by constant multiples of \\(\\epsilon\\) (in fact, if the triangle is scaled by a factor of \\(1 / \\epsilon\\), it tends to a fixed triangle). Thus the circumradius of those three points, which is the radius of \\(g\\left(X_{\\epsilon}\\right)\\), is also bounded above by a constant multiple of \\(\\epsilon\\), and so the result follows by Lemma 2 .\n\nLemma 5. Suppose there are two points \\(A\\) and \\(B\\) such that \\(g(A)\\) and \\(g(B)\\) cut. Then there is a point \\(P\\) with the given property.\n\nProof. Suppose that \\(g(A)\\) and \\(g(B)\\) cut at \\(C\\) and \\(D\\). One of those points, without loss of generality \\(C\\), must be \\(f(A B)\\), and so lie on the line \\(A B\\). We now consider two cases, according to whether \\(D\\) also lies on that line.\n\n\\section*{Case 1: \\(D\\) does not lie on that line.}\n\nIn this case, consider a sequence of \\(X_{\\epsilon}\\) at distance \\(\\epsilon\\) from \\(D\\), tending to \\(D\\) along some line that is not a tangent to either circle, but perturbed slightly (by at most \\(\\epsilon^{2}\\) ) to ensure that no three of the points \\(A, B\\) and \\(X_{\\epsilon}\\) are collinear and no four are concyclic.\n\nConsider the points \\(f\\left(X_{\\epsilon} A\\right)\\) and \\(f\\left(X_{\\epsilon} B\\right)\\), and the circles \\(g\\left(X_{\\epsilon}\\right)\\) on which they lie. The point \\(f\\left(X_{\\epsilon} A\\right)\\) might be either \\(A\\) or the other intersection of \\(X_{\\epsilon} A\\) with the circle \\(g(A)\\), and the same applies for \\(B\\). If, for some sequence of \\(\\epsilon \\rightarrow 0\\), both those points are the other point of intersection, the same argument as in the proof of Lemma 4 applies to find arbitrarily small circles. Otherwise, we have either infinitely many of those circles passing through \\(A\\), or infinitely many passing through \\(B\\); without loss of generality, suppose infinitely many through \\(A\\).\n\nWe now show we can find five points \\(B_{i}\\) satisfying the conditions of Lemma 4 (together with \\(A\\) ). Let \\(B_{1}\\) be any of the \\(X_{\\epsilon}\\) for which \\(g\\left(X_{\\epsilon}\\right)\\) passes through \\(A\\). Then repeat the following four times, for \\(2 \\leqslant i \\leqslant 5\\).\n\nConsider some line \\(\\ell=X_{\\epsilon} A\\) (different from those considered for previous \\(i\\) ) that is not tangent to any of the \\(g\\left(B_{j}\\right)\\) for \\(j<i\\), and is such that \\(f(\\ell)=A\\), so \\(g(Y)\\) passes through \\(A\\) for all \\(Y\\) on that line. If there are arbitrarily small circles \\(g(Y)\\) we are done by Lemma 2, so the radii of such circles must be bounded below. But as \\(Y \\rightarrow A\\), along any line not tangent to \\(g\\left(B_{j}\\right)\\), the radius of a circle through \\(Y\\) and tangent to \\(g\\left(B_{j}\\right)\\) at \\(A\\) tends to 0 . So there must be some \\(Y\\) such that \\(g(Y)\\) cuts \\(g\\left(B_{j}\\right)\\) at \\(A\\) rather than being tangent to it there, for all of the previous \\(B_{j}\\), and we may also pick it such that no three of the \\(B_{i}\\) and \\(A\\) are collinear and no four are concyclic. Let \\(B_{i}\\) be this \\(Y\\). Now the result follows by Lemma 4.\n\n\\section*{Case 2: \\(D\\) does lie on that line.}\n\nIn this case, we follow a similar argument, but the sequence of \\(X_{\\epsilon}\\) needs to be slightly different. \\(C\\) and \\(D\\) both lie on the line \\(A B\\), so one must be \\(A\\) and the other must be \\(B\\). Consider a sequence of \\(X_{\\epsilon}\\) tending to \\(B\\). Rather than tending to \\(B\\) along a straight line (with small perturbations), let the sequence be such that all the points are inside the two circles, with the angle between \\(X_{\\epsilon} B\\) and the tangent to \\(g(B)\\) at \\(B\\) tending to 0 .\n\nAgain consider the points \\(f\\left(X_{\\epsilon} A\\right)\\) and \\(f\\left(X_{\\epsilon} B\\right)\\). If, for some sequence of \\(\\epsilon \\rightarrow 0\\), both those points are the other point of intersection with the respective circles, we see that the angle at \\(X_{\\epsilon}\\) tends to the angle between \\(A B\\) and the tangent to \\(g(B)\\) at \\(B\\), which is not 0 or \\(180^{\\circ}\\), while the distances tend to 0 (although possibly slower than any multiple of \\(\\epsilon\\) ), so we have arbitrarily small circumradii and the result follows by Lemma 2. Otherwise, we have either infinitely many of the circles \\(g\\left(X_{\\epsilon}\\right)\\) passing through \\(A\\), or infinitely many passing through \\(B\\), and the same argument as in the previous case enables us to reduce to Lemma 4.\n\nLemmas 3 and 5 together cover all cases, and so the required result is proved.\n\nComment. From the property that all circles \\(g(X)\\) pass through the same point \\(P\\), it is possible to deduce that the function \\(f\\) has the form given in Solution 1. For any line \\(\\ell\\) not passing through \\(P\\) we may define a corresponding angle \\(\\alpha(\\ell)\\), which we must show is the same for all such lines. For any point \\(X \\neq P\\), with at least one line \\(\\ell\\) through \\(X\\) and not through \\(P\\), such that \\(f(\\ell) \\neq X\\), this angle must be equal for all such lines through \\(X\\) (by (directed) angles in the same segment of \\(g(X)\\) ).\n\nNow consider all horizontal and all vertical lines not through \\(P\\). For any pair consisting of a horizontal line \\(\\ell_{1}\\) and a vertical line \\(\\ell_{2}\\), we have \\(\\alpha\\left(\\ell_{1}\\right)=\\alpha\\left(\\ell_{2}\\right)\\) unless \\(f\\left(\\ell_{1}\\right)\\) or \\(f\\left(\\ell_{2}\\right)\\) is the point of intersection of those lines. Consider the bipartite graph whose vertices are those lines and where an edge joins a horizontal and a vertical line with the same value of \\(\\alpha\\). Considering a subgraph induced by \\(n\\) horizontal and \\(n\\) vertical lines, it must have at least \\(n^{2}-2 n\\) edges, so some horizontal line has edges to at least \\(n-2\\) of the vertical lines. Thus, in the original graph, all but at most two of the vertical lines have the same value of \\(\\alpha\\), and likewise all but at most two of the horizontal lines have the same value of \\(\\alpha\\), and, restricting attention to suitable subsets of those lines, we see that this value must be the same for the vertical lines and for the horizontal lines.\n\nBut now we can extend this to all vertical and horizontal lines not through \\(P\\) (and thus to lines in other directions as well, since the only requirement for 'vertical' and 'horizontal' above is that they are any two nonparallel directions). Consider any horizontal line \\(\\ell_{1}\\) not passing through \\(P\\), and we wish to show that \\(\\alpha\\left(\\ell_{1}\\right)\\) has the same value \\(\\alpha\\) it has for all but at most two lines not through \\(P\\) in any direction. Indeed, we can deduce this by considering the intersection with any but at most five of the vertical lines: the only ones to exclude are the one passing through \\(P\\), the one passing through \\(f\\left(\\ell_{1}\\right)\\), at most two such that \\(\\alpha(\\ell) \\neq \\alpha\\), and the one passing through \\(h_{P, \\alpha}\\left(\\ell_{1}\\right)\\) (defined as in Solution 1). So all lines \\(\\ell\\) not passing through \\(P\\) have the same value of \\(\\alpha(\\ell)\\).\n\nSolution 4. For any point \\(X\\), denote by \\(t(X)\\) the line tangent to \\(g(X)\\) at \\(X\\); notice that \\(f(t(X))=X\\), so \\(f\\) is surjective.\n\nStep 1: We find a point \\(P\\) for which there are at least two different lines \\(p_{1}\\) and \\(p_{2}\\) such that \\(f\\left(p_{i}\\right)=P\\) \u3002\n\nChoose any point \\(X\\). If \\(X\\) does not have this property, take any \\(Y \\in g(X) \\backslash\\{X\\}\\); then \\(f(X Y)=Y\\). If \\(Y\\) does not have the property, \\(t(Y)=X Y\\), and the circles \\(g(X)\\) and \\(g(Y)\\) meet again at some point \\(Z\\). Then \\(f(X Z)=Z=f(Y Z)\\), so \\(Z\\) has the required property.\n\nWe will show that \\(P\\) is the desired point. From now on, we fix two different lines \\(p_{1}\\) and \\(p_{2}\\) with \\(f\\left(p_{1}\\right)=f\\left(p_{2}\\right)=P\\). Assume for contradiction that \\(f(\\ell)=Q \\neq P\\) for some line \\(\\ell\\) through \\(P\\). We fix \\(\\ell\\), and note that \\(Q \\in g(P)\\).\n\nStep 2: We prove that \\(P \\in g(Q)\\).\nTake an arbitrary point \\(X \\in \\ell \\backslash\\{P, Q\\}\\). Two cases are possible for the position of \\(t(X)\\) in relation to the \\(p_{i}\\); we will show that each case (and subcase) occurs for only finitely many positions of \\(X\\), yielding a contradiction.\n\nCase 2.1: \\(t(X)\\) is parallel to one of the \\(p_{i}\\); say, to \\(p_{1}\\).\nLet \\(t(X)\\) cross \\(p_{2}\\) at \\(R\\). Then \\(g(R)\\) is the circle \\((P R X)\\), as \\(f(R P)=P\\) and \\(f(R X)=X\\). Let \\(R Q\\) cross \\(g(R)\\) again at \\(S\\). Then \\(f(R Q) \\in\\{R, S\\} \\cap g(Q)\\), so \\(g(Q)\\) contains one of the points \\(R\\) and \\(S\\).\n\nIf \\(R \\in g(Q)\\), then \\(R\\) is one of finitely many points in the intersection \\(g(Q) \\cap p_{2}\\), and each of them corresponds to a unique position of \\(X\\), since \\(R X\\) is parallel to \\(p_{1}\\).\n\nIf \\(S \\in g(Q)\\), then \\(\\angle(Q S, S P)=\\angle(R S, S P)=\\angle(R X, X P)=\\angle\\left(p_{1}, \\ell\\right)\\), so \\(\\angle(Q S, S P)\\) is constant for all such points \\(X\\), and all points \\(S\\) obtained in such a way lie on one circle \\(\\gamma\\) passing through \\(P\\) and \\(Q\\). Since \\(g(Q)\\) does not contain \\(P\\), it is different from \\(\\gamma\\), so there are only finitely many points \\(S\\). Each of them uniquely determines \\(R\\) and thus \\(X\\).\n![](https://cdn.mathpix.com/cropped/2025_08_23_54ae86499e5425f8b31eg-083.jpg?height=829&width=895&top_left_y=217&top_left_x=576)\n\nSo, Case 2.1 can occur for only finitely many points \\(X\\).\nCase 2.2: \\(t(X)\\) crosses \\(p_{1}\\) and \\(p_{2}\\) at \\(R_{1}\\) and \\(R_{2}\\), respectively.\nClearly, \\(R_{1} \\neq R_{2}\\) as \\(t(X)\\) is the tangent to \\(g(X)\\) at \\(X\\), and \\(g(X)\\) meets \\(\\ell\\) only at \\(X\\) and \\(Q\\). Notice that \\(g\\left(R_{i}\\right)\\) is the circle \\(\\left(P X R_{i}\\right)\\). Let \\(R_{i} Q\\) meet \\(g\\left(R_{i}\\right)\\) again at \\(S_{i}\\); then \\(S_{i} \\neq Q\\), as \\(g\\left(R_{i}\\right)\\) meets \\(\\ell\\) only at \\(P\\) and \\(X\\). Then \\(f\\left(R_{i} Q\\right) \\in\\left\\{R_{i}, S_{i}\\right\\}\\), and we distinguish several subcases.\n![](https://cdn.mathpix.com/cropped/2025_08_23_54ae86499e5425f8b31eg-083.jpg?height=809&width=849&top_left_y=1513&top_left_x=602)\n\nSubcase 2.2.1: \\(f\\left(R_{1} Q\\right)=S_{1}, f\\left(R_{2} Q\\right)=S_{2}\\); so \\(S_{1}, S_{2} \\in g(Q)\\).\nIn this case we have \\(0=\\angle\\left(R_{1} X, X P\\right)+\\angle\\left(X P, R_{2} X\\right)=\\angle\\left(R_{1} S_{1}, S_{1} P\\right)+\\angle\\left(S_{2} P, S_{2} R_{2}\\right)= \\angle\\left(Q S_{1}, S_{1} P\\right)+\\angle\\left(S_{2} P, S_{2} Q\\right)\\), which shows \\(P \\in g(Q)\\).\n\nSubcase 2.2.2: \\(f\\left(R_{1} Q\\right)=R_{1}, f\\left(R_{2} Q\\right)=R_{2}\\); so \\(R_{1}, R_{2} \\in g(Q)\\).\nThis can happen for at most four positions of \\(X\\) - namely, at the intersections of \\(\\ell\\) with a line of the form \\(K_{1} K_{2}\\), where \\(K_{i} \\in g(Q) \\cap p_{i}\\).\n\nSubcase 2.2.3: \\(f\\left(R_{1} Q\\right)=S_{1}, f\\left(R_{2} Q\\right)=R_{2}\\) (the case \\(f\\left(R_{1} Q\\right)=R_{1}, f\\left(R_{2} Q\\right)=S_{2}\\) is similar).\nIn this case, there are at most two possible positions for \\(R_{2}\\) - namely, the meeting points of \\(g(Q)\\) with \\(p_{2}\\). Consider one of them. Let \\(X\\) vary on \\(\\ell\\). Then \\(R_{1}\\) is the projection of \\(X\\) to \\(p_{1}\\) via \\(R_{2}, S_{1}\\) is the projection of \\(R_{1}\\) to \\(g(Q)\\) via \\(Q\\). Finally, \\(\\angle\\left(Q S_{1}, S_{1} X\\right)=\\angle\\left(R_{1} S_{1}, S_{1} X\\right)= \\angle\\left(R_{1} P, P X\\right)=\\angle\\left(p_{1}, \\ell\\right) \\neq 0\\), so \\(X\\) is obtained by a fixed projective transform \\(g(Q) \\rightarrow \\ell\\) from \\(S_{1}\\). So, if there were three points \\(X\\) satisfying the conditions of this subcase, the composition of the three projective transforms would be the identity. But, if we apply it to \\(X=Q\\), we successively get some point \\(R_{1}^{\\prime}\\), then \\(R_{2}\\), and then some point different from \\(Q\\), a contradiction.\n\nThus Case 2.2 also occurs for only finitely many points \\(X\\), as desired.\nStep 3: We show that \\(f(P Q)=P\\), as desired.\nThe argument is similar to that in Step 2, with the roles of \\(Q\\) and \\(X\\) swapped. Again, we show that there are only finitely many possible positions for a point \\(X \\in \\ell \\backslash\\{P, Q\\}\\), which is absurd.\n\nCase 3.1: \\(t(Q)\\) is parallel to one of the \\(p_{i}\\); say, to \\(p_{1}\\).\nLet \\(t(Q)\\) cross \\(p_{2}\\) at \\(R\\); then \\(g(R)\\) is the circle ( \\(P R Q\\) ). Let \\(R X\\) cross \\(g(R)\\) again at \\(S\\). Then \\(f(R X) \\in\\{R, S\\} \\cap g(X)\\), so \\(g(X)\\) contains one of the points \\(R\\) and \\(S\\).\n![](https://cdn.mathpix.com/cropped/2025_08_23_54ae86499e5425f8b31eg-084.jpg?height=724&width=898&top_left_y=1130&top_left_x=576)\n\nSubcase 3.1.1: \\(S=f(R X) \\in g(X)\\).\nWe have \\(\\angle(t(X), Q X)=\\angle(S X, S Q)=\\angle(S R, S Q)=\\angle(P R, P Q)=\\angle\\left(p_{2}, \\ell\\right)\\). Hence \\(t(X) \\| p_{2}\\). Now we recall Case 2.1: we let \\(t(X)\\) cross \\(p_{1}\\) at \\(R^{\\prime}\\), so \\(g\\left(R^{\\prime}\\right)=\\left(P R^{\\prime} X\\right)\\), and let \\(R^{\\prime} Q\\) meet \\(g\\left(R^{\\prime}\\right)\\) again at \\(S^{\\prime}\\); notice that \\(S^{\\prime} \\neq Q\\). Excluding one position of \\(X\\), we may assume that \\(R^{\\prime} \\notin g(Q)\\), so \\(R^{\\prime} \\neq f\\left(R^{\\prime} Q\\right)\\). Therefore, \\(S^{\\prime}=f\\left(R^{\\prime} Q\\right) \\in g(Q)\\). But then, as in Case 2.1, we get \\(\\angle(t(Q), P Q)=\\angle\\left(Q S^{\\prime}, S^{\\prime} P\\right)=\\angle\\left(R^{\\prime} X, X P\\right)=\\angle\\left(p_{2}, \\ell\\right)\\). This means that \\(t(Q)\\) is parallel to \\(p_{2}\\), which is impossible.\nSubcase 3.1.2: \\(R=f(R X) \\in g(X)\\).\nIn this case, we have \\(\\angle(t(X), \\ell)=\\angle(R X, R Q)=\\angle\\left(R X, p_{1}\\right)\\). Again, let \\(R^{\\prime}=t(X) \\cap p_{1}\\); this point exists for all but at most one position of \\(X\\). Then \\(g\\left(R^{\\prime}\\right)=\\left(R^{\\prime} X P\\right)\\); let \\(R^{\\prime} Q\\) meet \\(g\\left(R^{\\prime}\\right)\\) again at \\(S^{\\prime}\\). Due to \\(\\angle\\left(R^{\\prime} X, X R\\right)=\\angle(Q X, Q R)=\\angle\\left(\\ell, p_{1}\\right), R^{\\prime}\\) determines \\(X\\) in at most two ways, so for all but finitely many positions of \\(X\\) we have \\(R^{\\prime} \\notin g(Q)\\). Therefore, for those positions we have \\(S^{\\prime}=f\\left(R^{\\prime} Q\\right) \\in g(Q)\\). But then \\(\\angle\\left(R X, p_{1}\\right)=\\angle\\left(R^{\\prime} X, X P\\right)=\\angle\\left(R^{\\prime} S^{\\prime}, S^{\\prime} P\\right)= \\angle\\left(Q S^{\\prime}, S^{\\prime} P\\right)=\\angle(t(Q), Q P)\\) is fixed, so this case can hold only for one specific position of \\(X\\) as well.\n\nThus, in Case 3.1, there are only finitely many possible positions of \\(X\\), yielding a contradiction.\n\nCase 3.2: \\(t(Q)\\) crosses \\(p_{1}\\) and \\(p_{2}\\) at \\(R_{1}\\) and \\(R_{2}\\), respectively.\nBy Step 2, \\(R_{1} \\neq R_{2}\\). Notice that \\(g\\left(R_{i}\\right)\\) is the circle \\(\\left(P Q R_{i}\\right)\\). Let \\(R_{i} X\\) meet \\(g\\left(R_{i}\\right)\\) at \\(S_{i}\\); then \\(S_{i} \\neq X\\). Then \\(f\\left(R_{i} X\\right) \\in\\left\\{R_{i}, S_{i}\\right\\}\\), and we distinguish several subcases.\n![](https://cdn.mathpix.com/cropped/2025_08_23_54ae86499e5425f8b31eg-085.jpg?height=846&width=852&top_left_y=428&top_left_x=599)\n\nSubcase 3.2.1: \\(f\\left(R_{1} X\\right)=S_{1}\\) and \\(f\\left(R_{2} X\\right)=S_{2}\\), so \\(S_{1}, S_{2} \\in g(X)\\).\nAs in Subcase 2.2.1, we have \\(0=\\angle\\left(R_{1} Q, Q P\\right)+\\angle\\left(Q P, R_{2} Q\\right)=\\angle\\left(X S_{1}, S_{1} P\\right)+\\angle\\left(S_{2} P, S_{2} X\\right)\\), which shows \\(P \\in g(X)\\). But \\(X, Q \\in g(X)\\) as well, so \\(g(X)\\) meets \\(\\ell\\) at three distinct points, which is absurd.\n\nSubcase 3.2.2: \\(f\\left(R_{1} X\\right)=R_{1}, f\\left(R_{2} X\\right)=R_{2}\\), so \\(R_{1}, R_{2} \\in g(X)\\).\nNow three distinct collinear points \\(R_{1}, R_{2}\\), and \\(Q\\) belong to \\(g(X)\\), which is impossible.\nSubcase 3.2.3: \\(f\\left(R_{1} X\\right)=S_{1}, f\\left(R_{2} X\\right)=R_{2}\\) (the case \\(f\\left(R_{1} X\\right)=R_{1}, f\\left(R_{2} X\\right)=S_{2}\\) is similar).\nWe have \\(\\angle\\left(X R_{2}, R_{2} Q\\right)=\\angle\\left(X S_{1}, S_{1} Q\\right)=\\angle\\left(R_{1} S_{1}, S_{1} Q\\right)=\\angle\\left(R_{1} P, P Q\\right)=\\angle\\left(p_{1}, \\ell\\right)\\), so this case can occur for a unique position of \\(X\\).\n\nThus, in Case 3.2, there is only a unique position of \\(X\\), again yielding the required contradiction.\n\n\\section*{Number Theory}", "source_pdf": "imosl_2019.pdf", "notes": "fallback-regex"}
{"id": "IMOSL-2019-N2", "contest": "IMOSL", "year": "2019", "problem_number": "N2", "problem": "Find all triples \\((a, b, c)\\) of positive integers such that \\(a^{3}+b^{3}+c^{3}=(a b c)^{2}\\).\n(Nigeria)", "solution": "Answer: The solutions are ( \\(1,2,3\\) ) and its permutations.\nCommon remarks. Note that the equation is symmetric. In all solutions, we will assume without loss of generality that \\(a \\geqslant b \\geqslant c\\), and prove that the only\n\nis \\((a, b, c)=(3,2,1)\\).\n\nThe first two solutions all start by proving that \\(c=1\\).\nSolution 1. We will start by proving that \\(c=1\\). Note that\n\\[\n3 a^{3} \\geqslant a^{3}+b^{3}+c^{3}>a^{3}\n\\]\n\nSo \\(3 a^{3} \\geqslant(a b c)^{2}>a^{3}\\) and hence \\(3 a \\geqslant b^{2} c^{2}>a\\). Now \\(b^{3}+c^{3}=a^{2}\\left(b^{2} c^{2}-a\\right) \\geqslant a^{2}\\), and so\n\\[\n18 b^{3} \\geqslant 9\\left(b^{3}+c^{3}\\right) \\geqslant 9 a^{2} \\geqslant b^{4} c^{4} \\geqslant b^{3} c^{5}\n\\]\nso \\(18 \\geqslant c^{5}\\) which yields \\(c=1\\).\nNow, note that we must have \\(a>b\\), as otherwise we would have \\(2 b^{3}+1=b^{4}\\) which has no positive integer solutions. So\n\\[\na^{3}-b^{3} \\geqslant(b+1)^{3}-b^{3}>1\n\\]\nand\n\\[\n2 a^{3}>1+a^{3}+b^{3}>a^{3}\n\\]\nwhich implies \\(2 a^{3}>a^{2} b^{2}>a^{3}\\) and so \\(2 a>b^{2}>a\\). Therefore\n\\[\n4\\left(1+b^{3}\\right)=4 a^{2}\\left(b^{2}-a\\right) \\geqslant 4 a^{2}>b^{4}\n\\]\nso \\(4>b^{3}(b-4)\\); that is, \\(b \\leqslant 4\\).\nNow, for each possible value of \\(b\\) with \\(2 \\leqslant b \\leqslant 4\\) we obtain a cubic equation for \\(a\\) with constant coefficients. These are as follows:\n\\[\n\\begin{array}{ll}\nb=2: & a^{3}-4 a^{2}+9=0 \\\\\nb=3: & a^{3}-9 a^{2}+28=0 \\\\\nb=4: & a^{3}-16 a^{2}+65=0 .\n\\end{array}\n\\]\n\nThe only case with an integer solution for \\(a\\) with \\(b \\leqslant a\\) is \\(b=2\\), leading to \\((a, b, c)=(3,2,1)\\).\nComment 1.1. Instead of writing down each cubic equation explicitly, we could have just observed that \\(a^{2} \\mid b^{3}+1\\), and for each choice of \\(b\\) checked each square factor of \\(b^{3}+1\\) for \\(a^{2}\\).\n\nWe could also have observed that, with \\(c=1\\), the relation \\(18 b^{3} \\geqslant b^{4} c^{4}\\) becomes \\(b \\leqslant 18\\), and we can simply check all possibilities for \\(b\\) (instead of working to prove that \\(b \\leqslant 4\\) ). This check becomes easier after using the factorisation \\(b^{3}+1=(b+1)\\left(b^{2}-b+1\\right)\\) and observing that no prime besides 3 can divide both of the factors.\n\nComment 1.2. Another approach to finish the problem after establishing that \\(c \\leqslant 1\\) is to set \\(k=b^{2} c^{2}-a\\), which is clearly an integer and must be positive as it is equal to \\(\\left(b^{3}+c^{3}\\right) / a^{2}\\). Then we divide into cases based on whether \\(k=1\\) or \\(k \\geqslant 2\\); in the first case, we have \\(b^{3}+1=a^{2}=\\left(b^{2}-1\\right)^{2}\\) whose only positive root is \\(b=2\\), and in the second case we have \\(b^{2} \\leqslant 3 a\\), and so\n\\[\nb^{4} \\leqslant(3 a)^{2} \\leqslant \\frac{9}{2}\\left(k a^{2}\\right)=\\frac{9}{2}\\left(b^{3}+1\\right),\n\\]\nwhich implies that \\(b \\leqslant 4\\).\n\nSolution 2. Again, we will start by proving that \\(c=1\\). Suppose otherwise that \\(c \\geqslant 2\\). We have \\(a^{3}+b^{3}+c^{3} \\leqslant 3 a^{3}\\), so \\(b^{2} c^{2} \\leqslant 3 a\\). Since \\(c \\geqslant 2\\), this tells us that \\(b \\leqslant \\sqrt{3 a / 4}\\). As the right-hand side of the original equation is a multiple of \\(a^{2}\\), we have \\(a^{2} \\leqslant 2 b^{3} \\leqslant 2(3 a / 4)^{3 / 2}\\). In other words, \\(a \\leqslant \\frac{27}{16}<2\\), which contradicts the assertion that \\(a \\geqslant c \\geqslant 2\\). So there are no solutions in this case, and so we must have \\(c=1\\).\n\nNow, the original equation becomes \\(a^{3}+b^{3}+1=a^{2} b^{2}\\). Observe that \\(a \\geqslant 2\\), since otherwise \\(a=b=1\\) as \\(a \\geqslant b\\).\n\nThe right-hand side is a multiple of \\(a^{2}\\), so the left-hand side must be as well. Thus, \\(b^{3}+1 \\geqslant a^{2}\\). Since \\(a \\geqslant b\\), we also have\n\\[\nb^{2}=a+\\frac{b^{3}+1}{a^{2}} \\leqslant 2 a+\\frac{1}{a^{2}}\n\\]\nand so \\(b^{2} \\leqslant 2 a\\) since \\(b^{2}\\) is an integer. Thus \\((2 a)^{3 / 2}+1 \\geqslant b^{3}+1 \\geqslant a^{2}\\), from which we deduce \\(a \\leqslant 8\\).\n\nNow, for each possible value of \\(a\\) with \\(2 \\leqslant a \\leqslant 8\\) we obtain a cubic equation for \\(b\\) with constant coefficients. These are as follows:\n\\[\n\\begin{array}{ll}\na=2: & b^{3}-4 b^{2}+9=0 \\\\\na=3: & b^{3}-9 b^{2}+28=0 \\\\\na=4: & b^{3}-16 b^{2}+65=0 \\\\\na=5: & b^{3}-25 b^{2}+126=0 \\\\\na=6: & b^{3}-36 b^{2}+217=0 \\\\\na=7: & b^{3}-49 b^{2}+344=0 \\\\\na=8: & b^{3}-64 b^{2}+513=0 .\n\\end{array}\n\\]\n\nThe only case with an integer solution for \\(b\\) with \\(a \\geqslant b\\) is \\(a=3\\), leading to \\((a, b, c)=(3,2,1)\\).\nComment 2.1. As in Solution 1, instead of writing down each cubic equation explicitly, we could have just observed that \\(b^{2} \\mid a^{3}+1\\), and for each choice of \\(a\\) checked each square factor of \\(a^{3}+1\\) for \\(b^{2}\\).\n\nComment 2.2. This solution does not require initially proving that \\(c=1\\), in which case the bound would become \\(a \\leqslant 108\\). The resulting cases could, in principle, be checked by a particularly industrious student.\n\nSolution 3. Set \\(k=\\left(b^{3}+c^{3}\\right) / a^{2} \\leqslant 2 a\\), and rewrite the original equation as \\(a+k=(b c)^{2}\\). Since \\(b^{3}\\) and \\(c^{3}\\) are positive integers, we have \\((b c)^{3} \\geqslant b^{3}+c^{3}-1=k a^{2}-1\\), so\n\\[\na+k \\geqslant\\left(k a^{2}-1\\right)^{2 / 3}\n\\]\n\nAs in Comment 1.2, \\(k\\) is a positive integer; for each value of \\(k \\geqslant 1\\), this gives us a polynomial inequality satisfied by \\(a\\) :\n\\[\nk^{2} a^{4}-a^{3}-5 k a^{2}-3 k^{2} a-\\left(k^{3}-1\\right) \\leqslant 0 .\n\\]\n\nWe now prove that \\(a \\leqslant 3\\). Indeed,\n\\[\n0 \\geqslant \\frac{k^{2} a^{4}-a^{3}-5 k a^{2}-3 k^{2} a-\\left(k^{3}-1\\right)}{k^{2}} \\geqslant a^{4}-a^{3}-5 a^{2}-3 a-k \\geqslant a^{4}-a^{3}-5 a^{2}-5 a,\n\\]\nwhich fails when \\(a \\geqslant 4\\).\nThis leaves ten triples with \\(3 \\geqslant a \\geqslant b \\geqslant c \\geqslant 1\\), which may be checked manually to give \\((a, b, c)=(3,2,1)\\).\n\nSolution 4. Again, observe that \\(b^{3}+c^{3}=a^{2}\\left(b^{2} c^{2}-a\\right)\\), so \\(b \\leqslant a \\leqslant b^{2} c^{2}-1\\).\nWe consider the function \\(f(x)=x^{2}\\left(b^{2} c^{2}-x\\right)\\). It can be seen that that on the interval \\(\\left[0, b^{2} c^{2}-1\\right]\\) the function \\(f\\) is increasing if \\(x<\\frac{2}{3} b^{2} c^{2}\\) and decreasing if \\(x>\\frac{2}{3} b^{2} c^{2}\\). Consequently, it must be the case that\n\\[\nb^{3}+c^{3}=f(a) \\geqslant \\min \\left(f(b), f\\left(b^{2} c^{2}-1\\right)\\right) .\n\\]\n\nFirst, suppose that \\(b^{3}+c^{3} \\geqslant f\\left(b^{2} c^{2}-1\\right)\\). This may be written \\(b^{3}+c^{3} \\geqslant\\left(b^{2} c^{2}-1\\right)^{2}\\), and so\n\\[\n2 b^{3} \\geqslant b^{3}+c^{3} \\geqslant\\left(b^{2} c^{2}-1\\right)^{2}>b^{4} c^{4}-2 b^{2} c^{2} \\geqslant b^{4} c^{4}-2 b^{3} c^{4} .\n\\]\n\nThus, \\((b-2) c^{4}<2\\), and the only solutions to this inequality have \\((b, c)=(2,2)\\) or \\(b \\leqslant 3\\) and \\(c=1\\). It is easy to verify that the only case giving a solution for \\(a \\geqslant b\\) is \\((a, b, c)=(3,2,1)\\).\n\nOtherwise, suppose that \\(b^{3}+c^{3}=f(a) \\geqslant f(b)\\). Then, we have\n\\[\n2 b^{3} \\geqslant b^{3}+c^{3}=a^{2}\\left(b^{2} c^{2}-a\\right) \\geqslant b^{2}\\left(b^{2} c^{2}-b\\right) .\n\\]\n\nConsequently \\(b c^{2} \\leqslant 3\\), with strict inequality in the case that \\(b \\neq c\\). Hence \\(c=1\\) and \\(b \\leqslant 2\\). Both of these cases have been considered already, so we are done.\n\nComment 4.1. Instead of considering which of \\(f(b)\\) and \\(f\\left(b^{2} c^{2}-1\\right)\\) is less than \\(f(a)\\), we may also proceed by explicitly dividing into cases based on whether \\(a \\geqslant \\frac{2}{3} b^{2} c^{2}\\) or \\(a<\\frac{2}{3} b^{2} c^{2}\\). The first case may now be dealt with as follows. We have \\(b^{3} c^{3}+1 \\geqslant b^{3}+c^{3}\\) as \\(b^{3}\\) and \\(c^{3}\\) are positive integers, so we have\n\\[\nb^{3} c^{3}+1 \\geqslant b^{3}+c^{3} \\geqslant a^{2} \\geqslant \\frac{4}{9} b^{4} c^{4} .\n\\]\n\nThis implies \\(b c \\leqslant 2\\), and hence \\(c=1\\) and \\(b \\leqslant 2\\).", "source_pdf": "imosl_2019.pdf", "notes": "fallback-regex"}
{"id": "IMOSL-2019-N3", "contest": "IMOSL", "year": "2019", "problem_number": "N3", "problem": "We say that a set \\(S\\) of integers is rootiful if, for any positive integer \\(n\\) and any \\(a_{0}, a_{1}, \\ldots, a_{n} \\in S\\), all integer roots of the polynomial \\(a_{0}+a_{1} x+\\cdots+a_{n} x^{n}\\) are also in \\(S\\). Find all rootiful sets of integers that contain all numbers of the form \\(2^{a}-2^{b}\\) for positive integers \\(a\\) and \\(b\\).\n(Czech Republic)", "solution": "Answer: The set \\(\\mathbb{Z}\\) of all integers is the only such rootiful set.\n\n1. The set \\(\\mathbb{Z}\\) of all integers is clearly rootiful. We shall prove that any rootiful set \\(S\\) containing all the numbers of the form \\(2^{a}-2^{b}\\) for \\(a, b \\in \\mathbb{Z}_{>0}\\) must be all of \\(\\mathbb{Z}\\).\n\nFirst, note that \\(0=2^{1}-2^{1} \\in S\\) and \\(2=2^{2}-2^{1} \\in S\\). Now, \\(-1 \\in S\\), since it is a root of \\(2 x+2\\), and \\(1 \\in S\\), since it is a root of \\(2 x^{2}-x-1\\). Also, if \\(n \\in S\\) then \\(-n\\) is a root of \\(x+n\\), so it suffices to prove that all positive integers must be in \\(S\\).\n\nNow, we claim that any positive integer \\(n\\) has a multiple in \\(S\\). Indeed, suppose that \\(n=2^{\\alpha} \\cdot t\\) for \\(\\alpha \\in \\mathbb{Z}_{\\geqslant 0}\\) and \\(t\\) odd. Then \\(t \\mid 2^{\\phi(t)}-1\\), so \\(n \\mid 2^{\\alpha+\\phi(t)+1}-2^{\\alpha+1}\\). Moreover, \\(2^{\\alpha+\\phi(t)+1}-2^{\\alpha+1} \\in S\\), and so \\(S\\) contains a multiple of every positive integer \\(n\\).\n\nWe will now prove by induction that all positive integers are in \\(S\\). Suppose that \\(0,1, \\ldots, n- 1 \\in S\\); furthermore, let \\(N\\) be a multiple of \\(n\\) in \\(S\\). Consider the base- \\(n\\) expansion of \\(N\\), say \\(N=a_{k} n^{k}+a_{k-1} n^{k-1}+\\cdots+a_{1} n+a_{0}\\). Since \\(0 \\leqslant a_{i}<n\\) for each \\(a_{i}\\), we have that all the \\(a_{i}\\) are in \\(S\\). Furthermore, \\(a_{0}=0\\) since \\(N\\) is a multiple of \\(n\\). Therefore, \\(a_{k} n^{k}+a_{k-1} n^{k-1}+\\cdots+a_{1} n-N=0\\), so \\(n\\) is a root of a polynomial with coefficients in \\(S\\). This tells us that \\(n \\in S\\), completing the induction.\n\nSolution 2. As in the previous solution, we can prove that 0,1 and -1 must all be in any rootiful set \\(S\\) containing all numbers of the form \\(2^{a}-2^{b}\\) for \\(a, b \\in \\mathbb{Z}_{>0}\\).\n\nWe show that, in fact, every integer \\(k\\) with \\(|k|>2\\) can be expressed as a root of a polynomial whose coefficients are of the form \\(2^{a}-2^{b}\\). Observe that it suffices to consider the case where \\(k\\) is positive, as if \\(k\\) is a root of \\(a_{n} x^{n}+\\cdots+a_{1} x+a_{0}=0\\), then \\(-k\\) is a root of \\((-1)^{n} a_{n} x^{n}+\\cdots- a_{1} x+a_{0}=0\\).\n\nNote that\n\\[\n\\left(2^{a_{n}}-2^{b_{n}}\\right) k^{n}+\\cdots+\\left(2^{a_{0}}-2^{b_{0}}\\right)=0\n\\]\nis equivalent to\n\\[\n2^{a_{n}} k^{n}+\\cdots+2^{a_{0}}=2^{b_{n}} k^{n}+\\cdots+2^{b_{0}} .\n\\]\n\nHence our aim is to show that two numbers of the form \\(2^{a_{n}} k^{n}+\\cdots+2^{a_{0}}\\) are equal, for a fixed value of \\(n\\). We consider such polynomials where every term \\(2^{a_{i}} k^{i}\\) is at most \\(2 k^{n}\\); in other words, where \\(2 \\leqslant 2^{a_{i}} \\leqslant 2 k^{n-i}\\), or, equivalently, \\(1 \\leqslant a_{i} \\leqslant 1+(n-i) \\log _{2} k\\). Therefore, there must be \\(1+\\left\\lfloor(n-i) \\log _{2} k\\right\\rfloor\\) possible choices for \\(a_{i}\\) satisfying these constraints.\n\nThe number of possible polynomials is then\n\\[\n\\prod_{i=0}^{n}\\left(1+\\left\\lfloor(n-i) \\log _{2} k\\right\\rfloor\\right) \\geqslant \\prod_{i=0}^{n-1}(n-i) \\log _{2} k=n!\\left(\\log _{2} k\\right)^{n}\n\\]\nwhere the inequality holds as \\(1+\\lfloor x\\rfloor \\geqslant x\\).\nAs there are ( \\(n+1\\) ) such terms in the polynomial, each at most \\(2 k^{n}\\), such a polynomial must have value at most \\(2 k^{n}(n+1)\\). However, for large \\(n\\), we have \\(n!\\left(\\log _{2} k\\right)^{n}>2 k^{n}(n+1)\\). Therefore there are more polynomials than possible values, so some two must be equal, as required.", "source_pdf": "imosl_2019.pdf", "notes": "fallback-regex"}
{"id": "IMOSL-2019-N4", "contest": "IMOSL", "year": "2019", "problem_number": "N4", "problem": "Let \\(\\mathbb{Z}_{>0}\\) be the set of positive integers. A positive integer constant \\(C\\) is given. Find all functions \\(f: \\mathbb{Z}_{>0} \\rightarrow \\mathbb{Z}_{>0}\\) such that, for all positive integers \\(a\\) and \\(b\\) satisfying \\(a+b>C\\),\n\\[\na+f(b) \\mid a^{2}+b f(a)\n\\]\n(Croatia)", "solution": "Answer: The functions satisfying (*) are exactly the functions \\(f(a)=k a\\) for some constant \\(k \\in \\mathbb{Z}_{>0}\\) (irrespective of the value of \\(C\\) ).\n\nCommon remarks. It is easy to verify that the functions \\(f(a)=k a\\) satisfy ( \\(*\\) ). Thus, in the proofs below, we will only focus on the converse implication: that condition (*) implies that \\(f=k a\\).\n\nA common minor part of these solutions is the derivation of some relatively easy bounds on the function \\(f\\). An upper bound is easily obtained by setting \\(a=1\\) in (*), giving the inequality\n\\[\nf(b) \\leqslant b \\cdot f(1)\n\\]\nfor all sufficiently large \\(b\\). The corresponding lower bound is only marginally more difficult to obtain: substituting \\(b=1\\) in the original equation shows that\n\\[\na+f(1) \\mid\\left(a^{2}+f(a)\\right)-(a-f(1)) \\cdot(a+f(1))=f(1)^{2}+f(a)\n\\]\nfor all sufficiently large \\(a\\). It follows from this that one has the lower bound\n\\[\nf(a) \\geqslant a+f(1) \\cdot(1-f(1)),\n\\]\nagain for all sufficiently large \\(a\\).\nEach of the following proofs makes use of at least one of these bounds.\n\n1. First, we show that \\(b \\mid f(b)^{2}\\) for all \\(b\\). To do this, we choose a large positive integer \\(n\\) so that \\(n b-f(b) \\geqslant C\\). Setting \\(a=n b-f(b)\\) in (*) then shows that\n\\[\nn b \\mid(n b-f(b))^{2}+b f(n b-f(b))\n\\]\nso that \\(b \\mid f(b)^{2}\\) as claimed.\nNow in particular we have that \\(p \\mid f(p)\\) for every prime \\(p\\). If we write \\(f(p)=k(p) \\cdot p\\), then the bound \\(f(p) \\leqslant f(1) \\cdot p\\) (valid for \\(p\\) sufficiently large) shows that some value \\(k\\) of \\(k(p)\\) must be attained for infinitely many \\(p\\). We will show that \\(f(a)=k a\\) for all positive integers \\(a\\). To do this, we substitute \\(b=p\\) in (*), where \\(p\\) is any sufficiently large prime for which \\(k(p)=k\\), obtaining\n\\[\na+k p \\mid\\left(a^{2}+p f(a)\\right)-a(a+k p)=p f(a)-p k a .\n\\]\n\nFor suitably large \\(p\\) we have \\(\\operatorname{gcd}(a+k p, p)=1\\), and hence we have\n\\[\na+k p \\mid f(a)-k a .\n\\]\n\nBut the only way this can hold for arbitrarily large \\(p\\) is if \\(f(a)-k a=0\\). This concludes the proof.\n\nComment. There are other ways to obtain the divisibility \\(p \\mid f(p)\\) for primes \\(p\\), which is all that is needed in this proof. For instance, if \\(f(p)\\) were not divisible by \\(p\\) then the arithmetic progression \\(p^{2}+b f(p)\\) would attain prime values for infinitely many \\(b\\) by Dirichlet's Theorem: hence, for these pairs \\(\\mathrm{p}, \\mathrm{b}\\), we would have \\(p+f(b)=p^{2}+b f(p)\\). Substituting \\(a \\mapsto b\\) and \\(b \\mapsto p\\) in (*) then shows that \\(\\left(f(p)^{2}-p^{2}\\right)(p-1)\\) is divisible by \\(b+f(p)\\) and hence vanishes, which is impossible since \\(p \\nmid f(p)\\) by assumption.\n\nSolution 2. First, we substitute \\(b=1\\) in (*) and rearrange to find that\n\\[\n\\frac{f(a)+f(1)^{2}}{a+f(1)}=f(1)-a+\\frac{a^{2}+f(a)}{a+f(1)}\n\\]\nis a positive integer for sufficiently large \\(a\\). Since \\(f(a) \\leqslant a f(1)\\), for all sufficiently large \\(a\\), it follows that \\(\\frac{f(a)+f(1)^{2}}{a+f(1)} \\leqslant f(1)\\) also and hence there is a positive integer \\(k\\) such that \\(\\frac{f(a)+f(1)^{2}}{a+f(1)}=k\\) for infinitely many values of \\(a\\). In other words,\n\\[\nf(a)=k a+f(1) \\cdot(k-f(1))\n\\]\nfor infinitely many \\(a\\).\nFixing an arbitrary choice of \\(a\\) in (*), we have that\n\\[\n\\frac{a^{2}+b f(a)}{a+k b+f(1) \\cdot(k-f(1))}\n\\]\nis an integer for infinitely many \\(b\\) (the same \\(b\\) as above, maybe with finitely many exceptions). On the other hand, for \\(b\\) taken sufficiently large, this quantity becomes arbitrarily close to \\(\\frac{f(a)}{k}\\); this is only possible if \\(\\frac{f(a)}{k}\\) is an integer and\n\\[\n\\frac{a^{2}+b f(a)}{a+k b+f(1) \\cdot(k-f(1))}=\\frac{f(a)}{k}\n\\]\nfor infinitely many \\(b\\). This rearranges to\n\\[\n\\frac{f(a)}{k} \\cdot(a+f(1) \\cdot(k-f(1)))=a^{2} .\n\\]\n\nHence \\(a^{2}\\) is divisible by \\(a+f(1) \\cdot(k-f(1))\\), and hence so is \\(f(1)^{2}(k-f(1))^{2}\\). The only way this can occur for all \\(a\\) is if \\(k=f(1)\\), in which case ( \\(* *\\) ) provides that \\(f(a)=k a\\) for all \\(a\\), as desired.\n\nSolution 3. Fix any two distinct positive integers \\(a\\) and \\(b\\). From (*) it follows that the two integers\n\\[\n\\left(a^{2}+c f(a)\\right) \\cdot(b+f(c)) \\text { and }\\left(b^{2}+c f(b)\\right) \\cdot(a+f(c))\n\\]\nare both multiples of \\((a+f(c)) \\cdot(b+f(c))\\) for all sufficiently large \\(c\\). Taking an appropriate linear combination to eliminate the \\(c f(c)\\) term, we find after expanding out that the integer\n\\[\n\\left[a^{2} f(b)-b^{2} f(a)\\right] \\cdot f(c)+[(b-a) f(a) f(b)] \\cdot c+[a b(a f(b)-b f(a))]\n\\]\nis also a multiple of \\((a+f(c)) \\cdot(b+f(c))\\).\nBut as \\(c\\) varies, \\((\\dagger)\\) is bounded above by a positive multiple of \\(c\\) while \\((a+f(c)) \\cdot(b+f(c))\\) is bounded below by a positive multiple of \\(c^{2}\\). The only way that such a divisibility can hold is if in fact\n\\[\n\\left[a^{2} f(b)-b^{2} f(a)\\right] \\cdot f(c)+[(b-a) f(a) f(b)] \\cdot c+[a b(a f(b)-b f(a))]=0\n\\]\nfor sufficiently large \\(c\\). Since the coefficient of \\(c\\) in this linear relation is nonzero, it follows that there are constants \\(k, \\ell\\) such that \\(f(c)=k c+\\ell\\) for all sufficiently large \\(c\\); the constants \\(k\\) and \\(\\ell\\) are necessarily integers.\n\nThe value of \\(\\ell\\) satisfies\n\\[\n\\left[a^{2} f(b)-b^{2} f(a)\\right] \\cdot \\ell+[a b(a f(b)-b f(a))]=0\n\\]\nand hence \\(b \\mid \\ell a^{2} f(b)\\) for all \\(a\\) and \\(b\\). Taking \\(b\\) sufficiently large so that \\(f(b)=k b+\\ell\\), we thus have that \\(b \\mid \\ell^{2} a^{2}\\) for all sufficiently large \\(b\\); this implies that \\(\\ell=0\\). From ( \\(\\dagger \\dagger \\dagger\\) ) it then follows that \\(\\frac{f(a)}{a}=\\frac{f(b)}{b}\\) for all \\(a \\neq b\\), so that there is a constant \\(k\\) such that \\(f(a)=k a\\) for all \\(a\\) ( \\(k\\) is equal to the constant defined earlier).\n\nSolution 4. Let \\(\\Gamma\\) denote the set of all points \\((a, f(a))\\), so that \\(\\Gamma\\) is an infinite subset of the upper-right quadrant of the plane. For a point \\(A=(a, f(a))\\) in \\(\\Gamma\\), we define a point \\(A^{\\prime}=\\left(-f(a),-f(a)^{2} / a\\right)\\) in the lower-left quadrant of the plane, and let \\(\\Gamma^{\\prime}\\) denote the set of all such points \\(A^{\\prime}\\).\n![](https://cdn.mathpix.com/cropped/2025_08_23_54ae86499e5425f8b31eg-095.jpg?height=541&width=634&top_left_y=456&top_left_x=711)\n\nClaim. For any point \\(A \\in \\Gamma\\), the set \\(\\Gamma\\) is contained in finitely many lines through the point \\(A^{\\prime}\\). Proof. Let \\(A=(a, f(a))\\). The functional equation (with \\(a\\) and \\(b\\) interchanged) can be rewritten as \\(b+f(a) \\mid a f(b)-b f(a)\\), so that all but finitely many points in \\(\\Gamma\\) are contained in one of the lines with equation\n\\[\na y-f(a) x=m(x+f(a))\n\\]\nfor \\(m\\) an integer. Geometrically, these are the lines through \\(A^{\\prime}=\\left(-f(a),-f(a)^{2} / a\\right)\\) with gradient \\(\\frac{f(a)+m}{a}\\). Since \\(\\Gamma\\) is contained, with finitely many exceptions, in the region \\(0 \\leqslant y \\leqslant f(1) \\cdot x\\) and the point \\(A^{\\prime}\\) lies strictly in the lower-left quadrant of the plane, there are only finitely many values of \\(m\\) for which this line meets \\(\\Gamma\\). This concludes the proof of the claim.\n\nNow consider any distinct points \\(A, B \\in \\Gamma\\). It is clear that \\(A^{\\prime}\\) and \\(B^{\\prime}\\) are distinct. A line through \\(A^{\\prime}\\) and a line through \\(B^{\\prime}\\) only meet in more than one point if these two lines are equal to the line \\(A^{\\prime} B^{\\prime}\\). It then follows from the above claim that the line \\(A^{\\prime} B^{\\prime}\\) must contain all but finitely many points of \\(\\Gamma\\). If \\(C\\) is another point of \\(\\Gamma\\), then the line \\(A^{\\prime} C^{\\prime}\\) also passes through all but finitely many points of \\(\\Gamma\\), which is only possible if \\(A^{\\prime} C^{\\prime}=A^{\\prime} B^{\\prime}\\).\n\nWe have thus seen that there is a line \\(\\ell\\) passing through all points of \\(\\Gamma^{\\prime}\\) and through all but finitely many points of \\(\\Gamma\\). We claim that this line passes through the origin \\(O\\) and passes through every point of \\(\\Gamma\\). To see this, note that by construction \\(A, O, A^{\\prime}\\) are collinear for every point \\(A \\in \\Gamma\\). Since \\(\\ell=A A^{\\prime}\\) for all but finitely many points \\(A \\in \\Gamma\\), it thus follows that \\(O \\in \\ell\\). Thus any \\(A \\in \\Gamma\\) lies on the line \\(\\ell=A^{\\prime} O\\).\n\nSince \\(\\Gamma\\) is contained in a line through \\(O\\), it follows that there is a real constant \\(k\\) (the gradient of \\(\\ell\\) ) such that \\(f(a)=k a\\) for all \\(a\\). The number \\(k\\) is, of course, a positive integer.\n\nComment. Without the \\(a+b>C\\) condition, this problem is approachable by much more naive methods. For instance, using the given divisibility for \\(a, b \\in\\{1,2,3\\}\\) one can prove by a somewhat tedious case-check that \\(f(2)=2 f(1)\\) and \\(f(3)=3 f(1)\\); this then forms the basis of an induction establishing that \\(f(n)=n f(1)\\) for all \\(n\\).", "source_pdf": "imosl_2019.pdf", "notes": "fallback-regex"}
{"id": "IMOSL-2019-N5", "contest": "IMOSL", "year": "2019", "problem_number": "N5", "problem": "Let \\(a\\) be a positive integer. We say that a positive integer \\(b\\) is a-good if \\(\\binom{a n}{b}-1\\) is divisible by \\(a n+1\\) for all positive integers \\(n\\) with \\(a n \\geqslant b\\). Suppose \\(b\\) is a positive integer such that \\(b\\) is \\(a\\)-good, but \\(b+2\\) is not \\(a\\)-good. Prove that \\(b+1\\) is prime.\n(Netherlands)", "solution": "1. For \\(p\\) a prime and \\(n\\) a nonzero integer, we write \\(v_{p}(n)\\) for the \\(p\\)-adic valuation of \\(n\\) : the largest integer \\(t\\) such that \\(p^{t} \\mid n\\).\n\nWe first show that \\(b\\) is \\(a\\)-good if and only if \\(b\\) is even, and \\(p \\mid a\\) for all primes \\(p \\leqslant b\\).\nTo start with, the condition that \\(a n+1 \\left\\lvert\\,\\binom{ a n}{b}-1\\right.\\) can be rewritten as saying that\n\\[\n\\frac{a n(a n-1) \\cdots(a n-b+1)}{b!} \\equiv 1 \\quad(\\bmod a n+1) .\n\\]\n\nSuppose, on the one hand, there is a prime \\(p \\leqslant b\\) with \\(p \\nmid a\\). Take \\(t=v_{p}(b!)\\). Then there exist positive integers \\(c\\) such that \\(a c \\equiv 1\\left(\\bmod p^{t+1}\\right)\\). If we take \\(c\\) big enough, and then take \\(n=(p-1) c\\), then \\(a n=a(p-1) c \\equiv p-1\\left(\\bmod p^{t+1}\\right)\\) and \\(a n \\geqslant b\\). Since \\(p \\leqslant b\\), one of the terms of the numerator \\(\\operatorname{an}(a n-1) \\cdots(a n-b+1)\\) is \\(a n-p+1\\), which is divisible by \\(p^{t+1}\\). Hence the \\(p\\)-adic valuation of the numerator is at least \\(t+1\\), but that of the denominator is exactly \\(t\\). This means that \\(p \\left\\lvert\\,\\binom{ a n}{b}\\right.\\), so \\(p \\nmid\\binom{a n}{b}-1\\). As \\(p \\mid a n+1\\), we get that \\(a n+1 \\nmid\\binom{a n}{b}\\), so \\(b\\) is not \\(a\\)-good.\n\nOn the other hand, if for all primes \\(p \\leqslant b\\) we have \\(p \\mid a\\), then every factor of \\(b!\\) is coprime to \\(a n+1\\), and hence invertible modulo \\(a n+1\\) : hence \\(b\\) ! is also invertible modulo \\(a n+1\\). Then equation (1) reduces to:\n\\[\na n(a n-1) \\cdots(a n-b+1) \\equiv b!\\quad(\\bmod a n+1) .\n\\]\n\nHowever, we can rewrite the left-hand side as follows:\n\\[\na n(a n-1) \\cdots(a n-b+1) \\equiv(-1)(-2) \\cdots(-b) \\equiv(-1)^{b} b!\\quad(\\bmod a n+1) .\n\\]\n\nProvided that \\(a n>1\\), if \\(b\\) is even we deduce \\((-1)^{b} b!\\equiv b!\\) as needed. On the other hand, if \\(b\\) is odd, and we take \\(a n+1>2(b!)\\), then we will not have \\((-1)^{b} b!\\equiv b!\\), so \\(b\\) is not \\(a\\)-good. This completes the claim.\n\nTo conclude from here, suppose that \\(b\\) is \\(a\\)-good, but \\(b+2\\) is not. Then \\(b\\) is even, and \\(p \\mid a\\) for all primes \\(p \\leqslant b\\), but there is a prime \\(q \\leqslant b+2\\) for which \\(q \\nmid a\\) : so \\(q=b+1\\) or \\(q=b+2\\). We cannot have \\(q=b+2\\), as that is even too, so we have \\(q=b+1\\) : in other words, \\(b+1\\) is prime.\n\nSolution 2. We show only half of the claim of the previous solution: we show that if \\(b\\) is \\(a\\)-good, then \\(p \\mid a\\) for all primes \\(p \\leqslant b\\). We do this with Lucas' theorem.\n\nSuppose that we have \\(p \\leqslant b\\) with \\(p \\nmid a\\). Then consider the expansion of \\(b\\) in base \\(p\\); there will be some digit (not the final digit) which is nonzero, because \\(p \\leqslant b\\). Suppose it is the \\(p^{t}\\) digit for \\(t \\geqslant 1\\).\n\nNow, as \\(n\\) varies over the integers, an +1 runs over all residue classes modulo \\(p^{t+1}\\); in particular, there is a choice of \\(n\\) (with \\(a n>b\\) ) such that the \\(p^{0}\\) digit of \\(a n\\) is \\(p-1\\) (so \\(p \\mid a n+1)\\) and the \\(p^{t}\\) digit of an is 0 . Consequently, \\(p \\mid\\) an +1 but \\(p \\left\\lvert\\,\\binom{ a n}{b}\\right.\\) (by Lucas' theorem) so \\(p \\nmid\\binom{a n}{b}-1\\). Thus \\(b\\) is not \\(a\\)-good.\n\nNow we show directly that if \\(b\\) is \\(a\\)-good but \\(b+2\\) fails to be so, then there must be a prime dividing \\(a n+1\\) for some \\(n\\), which also divides \\((b+1)(b+2)\\). Indeed, the ratio between \\(\\binom{a n}{b+2}\\) and \\(\\binom{a n}{b}\\) is \\((b+1)(b+2) /(a n-b)(a n-b-1)\\). We know that there must be a choice of \\(a n+1\\) such that the former binomial coefficient is 1 modulo an +1 but the latter is not, which means that the given ratio must not be \\(1 \\bmod a n+1\\). If \\(b+1\\) and \\(b+2\\) are both coprime to \\(a n+1\\) then\nthe ratio is 1 , so that must not be the case. In particular, as any prime less than \\(b\\) divides \\(a\\), it must be the case that either \\(b+1\\) or \\(b+2\\) is prime.\n\nHowever, we can observe that \\(b\\) must be even by insisting that \\(a n+1\\) is prime (which is possible by Dirichlet's theorem) and hence \\(\\binom{a n}{b} \\equiv(-1)^{b}=1\\). Thus \\(b+2\\) cannot be prime, so \\(b+1\\) must be prime.", "source_pdf": "imosl_2019.pdf", "notes": "fallback-regex"}
{"id": "IMOSL-2019-N6", "contest": "IMOSL", "year": "2019", "problem_number": "N6", "problem": "Let \\(H=\\left\\{\\lfloor i \\sqrt{2}\\rfloor: i \\in \\mathbb{Z}_{>0}\\right\\}=\\{1,2,4,5,7, \\ldots\\}\\), and let \\(n\\) be a positive integer. Prove that there exists a constant \\(C\\) such that, if \\(A \\subset\\{1,2, \\ldots, n\\}\\) satisfies \\(|A| \\geqslant C \\sqrt{n}\\), then there exist \\(a, b \\in A\\) such that \\(a-b \\in H\\). (Here \\(\\mathbb{Z}_{>0}\\) is the set of positive integers, and \\(\\lfloor z\\rfloor\\) denotes the greatest integer less than or equal to \\(z\\).)\n(Brazil)\nCommon remarks. In all solutions, we will assume that \\(A\\) is a set such that \\(\\{a-b: a, b \\in A\\}\\) is disjoint from \\(H\\), and prove that \\(|A|<C \\sqrt{n}\\).", "solution": "1. First, observe that if \\(n\\) is a positive integer, then \\(n \\in H\\) exactly when\n\\[\n\\left\\{\\frac{n}{\\sqrt{2}}\\right\\}>1-\\frac{1}{\\sqrt{2}} .\n\\]\n\nTo see why, observe that \\(n \\in H\\) if and only if \\(0<i \\sqrt{2}-n<1\\) for some \\(i \\in \\mathbb{Z}_{>0}\\). In other words, \\(0<i-n / \\sqrt{2}<1 / \\sqrt{2}\\), which is equivalent to (1).\n\nNow, write \\(A=\\left\\{a_{1}<a_{2}<\\cdots<a_{k}\\right\\}\\), where \\(k=|A|\\). Observe that the set of differences is not altered by shifting \\(A\\), so we may assume that \\(A \\subseteq\\{0,1, \\ldots, n-1\\}\\) with \\(a_{1}=0\\).\n\nFrom (1), we learn that \\(\\left\\{a_{i} / \\sqrt{2}\\right\\}<1-1 / \\sqrt{2}\\) for each \\(i>1\\) since \\(a_{i}-a_{1} \\notin H\\). Furthermore, we must have \\(\\left\\{a_{i} / \\sqrt{2}\\right\\}<\\left\\{a_{j} / \\sqrt{2}\\right\\}\\) whenever \\(i<j\\); otherwise, we would have\n\\[\n-\\left(1-\\frac{1}{\\sqrt{2}}\\right)<\\left\\{\\frac{a_{j}}{\\sqrt{2}}\\right\\}-\\left\\{\\frac{a_{i}}{\\sqrt{2}}\\right\\}<0 .\n\\]\n\nSince \\(\\left\\{\\left(a_{j}-a_{i}\\right) / \\sqrt{2}\\right\\}=\\left\\{a_{j} / \\sqrt{2}\\right\\}-\\left\\{a_{i} / \\sqrt{2}\\right\\}+1\\), this implies that \\(\\left\\{\\left(a_{j}-a_{i}\\right) / \\sqrt{2}\\right\\}>1 / \\sqrt{2}> 1-1 / \\sqrt{2}\\), contradicting (1).\n\nNow, we have a sequence \\(0=a_{1}<a_{2}<\\cdots<a_{k}<n\\), with\n\\[\n0=\\left\\{\\frac{a_{1}}{\\sqrt{2}}\\right\\}<\\left\\{\\frac{a_{2}}{\\sqrt{2}}\\right\\}<\\cdots<\\left\\{\\frac{a_{k}}{\\sqrt{2}}\\right\\}<1-\\frac{1}{\\sqrt{2}} .\n\\]\n\nWe use the following fact: for any \\(d \\in \\mathbb{Z}\\), we have\n\\[\n\\left\\{\\frac{d}{\\sqrt{2}}\\right\\}>\\frac{1}{2 d \\sqrt{2}} .\n\\]\n\nTo see why this is the case, let \\(h=\\lfloor d / \\sqrt{2}\\rfloor\\), so \\(\\{d / \\sqrt{2}\\}=d / \\sqrt{2}-h\\). Then\n\\[\n\\left\\{\\frac{d}{\\sqrt{2}}\\right\\}\\left(\\frac{d}{\\sqrt{2}}+h\\right)=\\frac{d^{2}-2 h^{2}}{2} \\geqslant \\frac{1}{2},\n\\]\nsince the numerator is a positive integer. Because \\(d / \\sqrt{2}+h<2 d / \\sqrt{2}\\), inequality (2) follows.\nLet \\(d_{i}=a_{i+1}-a_{i}\\), for \\(1 \\leqslant i<k\\). Then \\(\\left\\{a_{i+1} / \\sqrt{2}\\right\\}-\\left\\{a_{i} / \\sqrt{2}\\right\\}=\\left\\{d_{i} / \\sqrt{2}\\right\\}\\), and we have\n\\[\n1-\\frac{1}{\\sqrt{2}}>\\sum_{i}\\left\\{\\frac{d_{i}}{\\sqrt{2}}\\right\\}>\\frac{1}{2 \\sqrt{2}} \\sum_{i} \\frac{1}{d_{i}} \\geqslant \\frac{(k-1)^{2}}{2 \\sqrt{2}} \\frac{1}{\\sum_{i} d_{i}}>\\frac{(k-1)^{2}}{2 \\sqrt{2}} \\cdot \\frac{1}{n} .\n\\]\n\nHere, the first inequality holds because \\(\\left\\{a_{k} / \\sqrt{2}\\right\\}<1-1 / \\sqrt{2}\\), the second follows from (2), the third follows from an easy application of the AM-HM inequality (or Cauchy-Schwarz), and the fourth follows from the fact that \\(\\sum_{i} d_{i}=a_{k}<n\\).\n\nRearranging this, we obtain\n\\[\n\\sqrt{2 \\sqrt{2}-2} \\cdot \\sqrt{n}>k-1,\n\\]\nwhich provides the required bound on \\(k\\).\n\nSolution 2. Let \\(\\alpha=2+\\sqrt{2}\\), so \\((1 / \\alpha)+(1 / \\sqrt{2})=1\\). Thus, \\(J=\\left\\{\\lfloor i \\alpha\\rfloor: i \\in \\mathbb{Z}_{>0}\\right\\}\\) is the complementary Beatty sequence to \\(H\\) (in other words, \\(H\\) and \\(J\\) are disjoint with \\(H \\cup J=\\mathbb{Z}_{>0}\\) ). Write \\(A=\\left\\{a_{1}<a_{2}<\\cdots<a_{k}\\right\\}\\). Suppose that \\(A\\) has no differences in \\(H\\), so all its differences are in \\(J\\) and we can set \\(a_{i}-a_{1}=\\left\\lfloor\\alpha b_{i}\\right\\rfloor\\) for \\(b_{i} \\in \\mathbb{Z}_{>0}\\).\n\nFor any \\(j>i\\), we have \\(a_{j}-a_{i}=\\left\\lfloor\\alpha b_{j}\\right\\rfloor-\\left\\lfloor\\alpha b_{i}\\right\\rfloor\\). Because \\(a_{j}-a_{i} \\in J\\), we also have \\(a_{j}-a_{i}=\\lfloor\\alpha t\\rfloor\\) for some positive integer \\(t\\). Thus, \\(\\lfloor\\alpha t\\rfloor=\\left\\lfloor\\alpha b_{j}\\right\\rfloor-\\left\\lfloor\\alpha b_{i}\\right\\rfloor\\). The right hand side must equal either \\(\\left\\lfloor\\alpha\\left(b_{j}-b_{i}\\right)\\right\\rfloor\\) or \\(\\left\\lfloor\\alpha\\left(b_{j}-b_{i}\\right)\\right\\rfloor-1\\), the latter of which is not a member of \\(J\\) as \\(\\alpha>2\\). Therefore, \\(t=b_{j}-b_{i}\\) and so we have \\(\\left\\lfloor\\alpha b_{j}\\right\\rfloor-\\left\\lfloor\\alpha b_{i}\\right\\rfloor=\\left\\lfloor\\alpha\\left(b_{j}-b_{i}\\right)\\right\\rfloor\\).\n\nFor \\(1 \\leqslant i<k\\) we now put \\(d_{i}=b_{i+1}-b_{i}\\), and we have\n\\[\n\\left\\lfloor\\alpha \\sum_{i} d_{i}\\right\\rfloor=\\left\\lfloor\\alpha b_{k}\\right\\rfloor=\\sum_{i}\\left\\lfloor\\alpha d_{i}\\right\\rfloor ;\n\\]\nthat is, \\(\\sum_{i}\\left\\{\\alpha d_{i}\\right\\}<1\\). We also have\n\\[\n1+\\left\\lfloor\\alpha \\sum_{i} d_{i}\\right\\rfloor=1+a_{k}-a_{1} \\leqslant a_{k} \\leqslant n\n\\]\nso \\(\\sum_{i} d_{i} \\leqslant n / \\alpha\\).\nWith the above inequalities, an argument similar to (3) (which uses the fact that \\(\\{\\alpha d\\}= \\{d \\sqrt{2}\\}>1 /(2 d \\sqrt{2})\\) for positive integers \\(d)\\) proves that \\(1>\\left((k-1)^{2} /(2 \\sqrt{2})\\right)(\\alpha / n)\\), which again rearranges to give\n\\[\n\\sqrt{2 \\sqrt{2}-2} \\cdot \\sqrt{n}>k-1\n\\]\n\nComment. The use of Beatty sequences in Solution 2 is essentially a way to bypass (1). Both Solutions 1 and 2 use the fact that \\(\\sqrt{2}<2\\); the statement in the question would still be true if \\(\\sqrt{2}\\) did not have this property (for instance, if it were replaced with \\(\\alpha\\) ), but any argument along the lines of Solutions 1 or 2 would be more complicated.\n\nSolution 3. Again, define \\(J=\\mathbb{Z}_{>0} \\backslash H\\), so all differences between elements of \\(A\\) are in \\(J\\). We start by making the following observation. Suppose we have a set \\(B \\subseteq\\{1,2, \\ldots, n\\}\\) such that all of the differences between elements of \\(B\\) are in \\(H\\). Then \\(|A| \\cdot|B| \\leqslant 2 n\\).\n\nTo see why, observe that any two sums of the form \\(a+b\\) with \\(a \\in A, b \\in B\\) are different; otherwise, we would have \\(a_{1}+b_{1}=a_{2}+b_{2}\\), and so \\(\\left|a_{1}-a_{2}\\right|=\\left|b_{2}-b_{1}\\right|\\). However, then the left hand side is in \\(J\\) whereas the right hand side is in \\(H\\). Thus, \\(\\{a+b: a \\in A, b \\in B\\}\\) is a set of size \\(|A| \\cdot|B|\\) all of whose elements are no greater than \\(2 n\\), yielding the claimed inequality.\n\nWith this in mind, it suffices to construct a set \\(B\\), all of whose differences are in \\(H\\) and whose size is at least \\(C^{\\prime} \\sqrt{n}\\) for some constant \\(C^{\\prime}>0\\).\n\nTo do so, we will use well-known facts about the negative Pell equation \\(X^{2}-2 Y^{2}=-1\\); in particular, that there are infinitely many solutions and the values of \\(X\\) are given by the recurrence \\(X_{1}=1, X_{2}=7\\) and \\(X_{m}=6 X_{m-1}-X_{m-2}\\). Therefore, we may choose \\(X\\) to be a solution with \\(\\sqrt{n} / 6<X \\leqslant \\sqrt{n}\\).\n\nNow, we claim that we may choose \\(B=\\{X, 2 X, \\ldots,\\lfloor(1 / 3) \\sqrt{n}\\rfloor X\\}\\). Indeed, we have\n\\[\n\\left(\\frac{X}{\\sqrt{2}}-Y\\right)\\left(\\frac{X}{\\sqrt{2}}+Y\\right)=\\frac{-1}{2}\n\\]\nand so\n\\[\n0>\\left(\\frac{X}{\\sqrt{2}}-Y\\right) \\geqslant \\frac{-3}{\\sqrt{2 n}}\n\\]\nfrom which it follows that \\(\\{X / \\sqrt{2}\\}>1-(3 / \\sqrt{2 n})\\). Combined with (1), this shows that all differences between elements of \\(B\\) are in \\(H\\).\n\nComment. Some of the ideas behind Solution 3 may be used to prove that the constant \\(C=\\sqrt{2 \\sqrt{2}-2}\\) (from Solutions 1 and 2) is optimal, in the sense that there are arbitrarily large values of \\(n\\) and sets \\(A_{n} \\subseteq\\{1,2, \\ldots, n\\}\\) of size roughly \\(C \\sqrt{n}\\), all of whose differences are contained in \\(J\\).\n\nTo see why, choose \\(X\\) to come from a sufficiently large solution to the Pell equation \\(X^{2}-2 Y^{2}=1\\), so \\(\\{X / \\sqrt{2}\\} \\approx 1 /(2 X \\sqrt{2})\\). In particular, \\(\\{X\\},\\{2 X\\}, \\ldots,\\{\\lfloor 2 X \\sqrt{2}(1-1 / \\sqrt{2})\\rfloor X\\}\\) are all less than \\(1-1 / \\sqrt{2}\\). Thus, by (1) any positive integer of the form \\(i X\\) for \\(1 \\leqslant i \\leqslant\\lfloor 2 X \\sqrt{2}(1-1 / \\sqrt{2})\\rfloor\\) lies in \\(J\\).\n\nSet \\(n \\approx 2 X^{2} \\sqrt{2}(1-1 / \\sqrt{2})\\). We now have a set \\(A=\\{i X: i \\leqslant\\lfloor 2 X \\sqrt{2}(1-1 / \\sqrt{2})\\rfloor\\}\\) containing roughly \\(2 X \\sqrt{2}(1-1 / \\sqrt{2})\\) elements less than or equal to \\(n\\) such that all of the differences lie in \\(J\\), and we can see that \\(|A| \\approx C \\sqrt{n}\\) with \\(C=\\sqrt{2 \\sqrt{2}-2}\\).\n\nSolution 4. As in Solution 3, we will provide a construction of a large set \\(B \\subseteq\\{1,2, \\ldots, n\\}\\), all of whose differences are in \\(H\\).\n\nChoose \\(Y\\) to be a solution to the Pell-like equation \\(X^{2}-2 Y^{2}= \\pm 1\\); such solutions are given by the recurrence \\(Y_{1}=1, Y_{2}=2\\) and \\(Y_{m}=2 Y_{m-1}+Y_{m-2}\\), and so we can choose \\(Y\\) such that \\(n /(3 \\sqrt{2})<Y \\leqslant n / \\sqrt{2}\\). Furthermore, it is known that for such a \\(Y\\) and for \\(1 \\leqslant x<Y\\),\n\\[\n\\{x \\sqrt{2}\\}+\\{(Y-x) \\sqrt{2}\\}=\\{Y / \\sqrt{2}\\}\n\\]\nif \\(X^{2}-2 Y^{2}=1\\), and\n\\[\n\\{x \\sqrt{2}\\}+\\{(Y-x) \\sqrt{2}\\}=1+\\{Y / \\sqrt{2}\\}\n\\]\nif \\(X^{2}-2 Y^{2}=-1\\). Indeed, this is a statement of the fact that \\(X / Y\\) is a best rational approximation to \\(\\sqrt{2}\\), from below in the first case and from above in the second.\n\nNow, consider the sequence \\(\\{\\sqrt{2}\\},\\{2 \\sqrt{2}\\}, \\ldots,\\{(Y-1) \\sqrt{2}\\}\\). The Erd\u0151s-Szekeres theorem tells us that this sequence has a monotone subsequence with at least \\(\\sqrt{Y-2}+1>\\sqrt{Y}\\) elements; if that subsequence is decreasing, we may reflect (using (4) or (5)) to ensure that it is increasing. Call the subsequence \\(\\left\\{y_{1} \\sqrt{2}\\right\\},\\left\\{y_{2} \\sqrt{2}\\right\\}, \\ldots,\\left\\{y_{t} \\sqrt{2}\\right\\}\\) for \\(t>\\sqrt{Y}\\).\n\nNow, set \\(B=\\left\\{\\left\\lfloor y_{i} \\sqrt{2}\\right\\rfloor: 1 \\leqslant i \\leqslant t\\right\\}\\). We have \\(\\left\\lfloor y_{j} \\sqrt{2}\\right\\rfloor-\\left\\lfloor y_{i} \\sqrt{2}\\right\\rfloor=\\left\\lfloor\\left(y_{j}-y_{i}\\right) \\sqrt{2}\\right\\rfloor\\) for \\(i<j\\) (because the corresponding inequality for the fractional parts holds by the ordering assumption on the \\(\\left\\{y_{i} \\sqrt{2}\\right\\}\\) ), which means that all differences between elements of \\(B\\) are indeed in \\(H\\). Since \\(|B|>\\sqrt{Y}>\\sqrt{n} / \\sqrt{3 \\sqrt{2}}\\), this is the required set.\n\nComment. Any solution to this problem will need to use the fact that \\(\\sqrt{2}\\) cannot be approximated well by rationals, either directly or implicitly (for example, by using facts about solutions to Pelllike equations). If \\(\\sqrt{2}\\) were replaced by a value of \\(\\theta\\) with very good rational approximations (from below), then an argument along the lines of Solution 3 would give long arithmetic progressions in \\(\\{\\lfloor i \\theta\\rfloor: 0 \\leqslant i<n\\}\\) (with initial term 0 ) for certain values of \\(n\\).", "source_pdf": "imosl_2019.pdf", "notes": "fallback-regex"}
{"id": "IMOSL-2019-N7", "contest": "IMOSL", "year": "2019", "problem_number": "N7", "problem": "Prove that there is a constant \\(c>0\\) and infinitely many positive integers \\(n\\) with the following property: there are infinitely many positive integers that cannot be expressed as the sum of fewer than \\(c n \\log (n)\\) pairwise coprime \\(n^{\\text {th }}\\) powers.\n(Canada)", "solution": "1. Suppose, for an integer \\(n\\), that we can find another integer \\(N\\) satisfying the following property:\n\\[\nn \\text { is divisible by } \\varphi\\left(p^{e}\\right) \\text { for every prime power } p^{e} \\text { exactly dividing } N \\text {. }\n\\]\n\nThis property ensures that all \\(n^{\\text {th }}\\) powers are congruent to 0 or 1 modulo each such prime power \\(p^{e}\\), and hence that any sum of \\(m\\) pairwise coprime \\(n^{\\text {th }}\\) powers is congruent to \\(m\\) or \\(m-1\\) modulo \\(p^{e}\\), since at most one of the \\(n^{\\text {th }}\\) powers is divisible by \\(p\\). Thus, if \\(k\\) denotes the number of distinct prime factors of \\(N\\), we find by the Chinese Remainder Theorem at most \\(2^{k} m\\) residue classes modulo \\(N\\) which are sums of at most \\(m\\) pairwise coprime \\(n^{\\text {th }}\\) powers. In particular, if \\(N>2^{k} m\\) then there are infinitely many positive integers not expressible as a sum of at most \\(m\\) pairwise coprime \\(n^{\\text {th }}\\) powers.\n\nIt thus suffices to prove that there are arbitrarily large pairs ( \\(n, N\\) ) of integers satisfying ( \\(\\dagger\\) ) such that\n\\[\nN>c \\cdot 2^{k} n \\log (n)\n\\]\nfor some positive constant \\(c\\).\nWe construct such pairs as follows. Fix a positive integer \\(t\\) and choose (distinct) prime numbers \\(p \\mid 2^{2^{t-1}}+1\\) and \\(q \\mid 2^{2^{t}}+1\\); we set \\(N=p q\\). It is well-known that \\(2^{t} \\mid p-1\\) and \\(2^{t+1} \\mid q-1\\), hence\n\\[\nn=\\frac{(p-1)(q-1)}{2^{t}}\n\\]\nis an integer and the pair ( \\(n, N\\) ) satisfies ( \\(\\dagger\\) ).\nEstimating the size of \\(N\\) and \\(n\\) is now straightforward. We have\n\\[\n\\log _{2}(n) \\leqslant 2^{t-1}+2^{t}-t<2^{t+1}<2 \\cdot \\frac{N}{n},\n\\]\nwhich rearranges to\n\\[\nN>\\frac{1}{8} \\cdot 2^{2} n \\log _{2}(n)\n\\]\nand so we are done if we choose \\(c<\\frac{1}{8 \\log (2)} \\approx 0.18\\).\nComment 1. The trick in the above solution was to find prime numbers \\(p\\) and \\(q\\) congruent to 1 modulo some \\(d=2^{t}\\) and which are not too large. An alternative way to do this is via Linnik's Theorem, which says that there are absolute constants \\(b\\) and \\(L>1\\) such that for any coprime integers \\(a\\) and \\(d\\), there is a prime congruent to \\(a\\) modulo \\(d\\) and of size \\(\\leqslant b d^{L}\\). If we choose some \\(d\\) not divisible by 3 and choose two distinct primes \\(p, q \\leqslant b \\cdot(3 d)^{L}\\) congruent to 1 modulo \\(d\\) (and, say, distinct modulo 3 ), then we obtain a pair ( \\(n, N\\) ) satisfying ( \\(\\dagger\\) ) with \\(N=p q\\) and \\(n=\\frac{(p-1)(q-1)}{d}\\). A straightforward computation shows that\n\\[\nN>C n^{1+\\frac{1}{2 L-1}}\n\\]\nfor some constant \\(C\\), which is in particular larger than any \\(c \\cdot 2^{2} n \\log (n)\\) for \\(p\\) large. Thus, the statement of the problem is true for any constant \\(c\\). More strongly, the statement of the problem is still true when \\(c n \\log (n)\\) is replaced by \\(n^{1+\\delta}\\) for a sufficiently small \\(\\delta>0\\).\n\nSolution 2, obtaining better bounds. As in the preceding solution, we seek arbitrarily large pairs of integers \\(n\\) and \\(N\\) satisfying ( \\(\\dagger\\) ) such that \\(N>c 2^{k} n \\log (n)\\).\n\nThis time, to construct such pairs, we fix an integer \\(x \\geqslant 4\\), set \\(N\\) to be the lowest common multiple of \\(1,2, \\ldots, 2 x\\), and set \\(n\\) to be twice the lowest common multiple of \\(1,2, \\ldots, x\\). The pair ( \\(n, N\\) ) does indeed satisfy the condition, since if \\(p^{e}\\) is a prime power divisor of \\(N\\) then \\(\\frac{\\varphi\\left(p^{e}\\right)}{2} \\leqslant x\\) is a factor of \\(\\frac{n}{2}=\\operatorname{lcm}_{r \\leqslant x}(r)\\).\n\nNow \\(2 N / n\\) is the product of all primes having a power lying in the interval ( \\(x, 2 x\\) ], and hence \\(2 N / n>x^{\\pi(2 x)-\\pi(x)}\\). Thus for sufficiently large \\(x\\) we have\n\\[\n\\log \\left(\\frac{2 N}{2^{\\pi(2 x)} n}\\right)>(\\pi(2 x)-\\pi(x)) \\log (x)-\\log (2) \\pi(2 x) \\sim x,\n\\]\nusing the Prime Number Theorem \\(\\pi(t) \\sim t / \\log (t)\\).\nOn the other hand, \\(n\\) is a product of at most \\(\\pi(x)\\) prime powers less than or equal to \\(x\\), and so we have the upper bound\n\\[\n\\log (n) \\leqslant \\pi(x) \\log (x) \\sim x,\n\\]\nagain by the Prime Number Theorem. Combined with the above inequality, we find that for any \\(\\epsilon>0\\), the inequality\n\\[\n\\log \\left(\\frac{N}{2^{\\pi(2 x)} n}\\right)>(1-\\epsilon) \\log (n)\n\\]\nholds for sufficiently large \\(x\\). Rearranging this shows that\n\\[\nN>2^{\\pi(2 x)} n^{2-\\epsilon}>2^{\\pi(2 x)} n \\log (n)\n\\]\nfor all sufficiently large \\(x\\) and we are done.\nComment 2. The stronger bound \\(N>2^{\\pi(2 x)} n^{2-\\epsilon}\\) obtained in the above proof of course shows that infinitely many positive integers cannot be written as a sum of at most \\(n^{2-\\epsilon}\\) pairwise coprime \\(n^{\\text {th }}\\) powers.\n\nBy refining the method in Solution 2, these bounds can be improved further to show that infinitely many positive integers cannot be written as a sum of at most \\(n^{\\alpha}\\) pairwise coprime \\(n^{\\text {th }}\\) powers for any positive \\(\\alpha>0\\). To do this, one fixes a positive integer \\(d\\), sets \\(N\\) equal to the product of the primes at most \\(d x\\) which are congruent to 1 modulo \\(d\\), and \\(n=d \\operatorname{lcm}_{r \\leqslant x}(r)\\). It follows as in Solution 2 that \\((n, N)\\) satisfies \\((\\dagger)\\).\n\nNow the Prime Number Theorem in arithmetic progressions provides the estimates \\(\\log (N) \\sim \\frac{d}{\\varphi(d)} x\\), \\(\\log (n) \\sim x\\) and \\(\\pi(d x) \\sim \\frac{d x}{\\log (x)}\\) for any fixed \\(d\\). Combining these provides a bound\n\\[\nN>2^{\\pi(d x)} n^{d / \\varphi(d)-\\epsilon}\n\\]\nfor any positive \\(\\epsilon\\), valid for \\(x\\) sufficiently large. Since the ratio \\(\\frac{d}{\\varphi(d)}\\) can be made arbitrarily large by a judicious choice of \\(d\\), we obtain the \\(n^{\\alpha}\\) bound claimed.\n\nComment 3. While big results from analytic number theory such as the Prime Number Theorem or Linnik's Theorem certainly can be used in this problem, they do not seem to substantially simplify matters: all known solutions involve first reducing to condition ( \\(\\dagger\\) ), and even then analytic results do not make it clear how to proceed. For this reason, we regard this problem as suitable for the IMO.\n\nRather than simplifying the problem, what nonelementary results from analytic number theory allow one to achieve is a strengthening of the main bound, typically replacing the \\(n \\log (n)\\) growth with a power \\(n^{1+\\delta}\\). However, we believe that such stronger bounds are unlikely to be found by students in the exam.\n\nThe strongest bound we know how to achieve using purely elementary methods is a bound of the form \\(N>2^{k} n \\log (n)^{M}\\) for any positive integer \\(M\\). This is achieved by a variant of the argument in Solution 1, choosing primes \\(p_{0}, \\ldots, p_{M}\\) with \\(p_{i} \\mid 2^{2^{t+i-1}}+1\\) and setting \\(N=\\prod_{i} p_{i}\\) and \\(n= 2^{-t M} \\prod_{i}\\left(p_{i}-1\\right)\\).", "source_pdf": "imosl_2019.pdf", "notes": "fallback-regex"}
{"id": "IMOSL-2019-N8", "contest": "IMOSL", "year": "2019", "problem_number": "N8", "problem": "Let \\(a\\) and \\(b\\) be two positive integers. Prove that the integer\n\\[\na^{2}+\\left\\lceil\\frac{4 a^{2}}{b}\\right\\rceil\n\\]\nis not a square. (Here \\(\\lceil z\\rceil\\) denotes the least integer greater than or equal to \\(z\\).)\n(Russia)", "solution": "1. Arguing indirectly, assume that\n\\[\na^{2}+\\left\\lceil\\frac{4 a^{2}}{b}\\right\\rceil=(a+k)^{2}, \\quad \\text { or } \\quad\\left\\lceil\\frac{(2 a)^{2}}{b}\\right\\rceil=(2 a+k) k .\n\\]\n\nClearly, \\(k \\geqslant 1\\). In other words, the equation\n\\[\n\\left\\lceil\\frac{c^{2}}{b}\\right\\rceil=(c+k) k\n\\]\nhas a positive integer solution ( \\(c, k\\) ), with an even value of \\(c\\).\nChoose a positive integer solution of (1) with minimal possible value of \\(k\\), without regard to the parity of \\(c\\). From\n\\[\n\\frac{c^{2}}{b}>\\left\\lceil\\frac{c^{2}}{b}\\right\\rceil-1=c k+k^{2}-1 \\geqslant c k\n\\]\nand\n\\[\n\\frac{(c-k)(c+k)}{b}<\\frac{c^{2}}{b} \\leqslant\\left\\lceil\\frac{c^{2}}{b}\\right\\rceil=(c+k) k\n\\]\nit can be seen that \\(c>b k>c-k\\), so\n\\[\nc=k b+r \\quad \\text { with some } 0<r<k .\n\\]\n\nBy substituting this in (1) we get\n\\[\n\\left\\lceil\\frac{c^{2}}{b}\\right\\rceil=\\left\\lceil\\frac{(b k+r)^{2}}{b}\\right\\rceil=k^{2} b+2 k r+\\left\\lceil\\frac{r^{2}}{b}\\right\\rceil\n\\]\nand\n\\[\n(c+k) k=(k b+r+k) k=k^{2} b+2 k r+k(k-r),\n\\]\nso\n\\[\n\\left\\lceil\\frac{r^{2}}{b}\\right\\rceil=k(k-r) .\n\\]\n\nNotice that relation (2) provides another positive integer solution of (1), namely \\(c^{\\prime}=r\\) and \\(k^{\\prime}=k-r\\), with \\(c^{\\prime}>0\\) and \\(0<k^{\\prime}<k\\). That contradicts the minimality of \\(k\\), and hence finishes the solution.\n\nSolution 2. Suppose that\n\\[\na^{2}+\\left\\lceil\\frac{4 a^{2}}{b}\\right\\rceil=c^{2}\n\\]\nwith some positive integer \\(c>a\\), so\n\\[\n\\begin{aligned}\n& c^{2}-1<a^{2}+\\frac{4 a^{2}}{b} \\leqslant c^{2} \\\\\n& 0 \\leqslant c^{2} b-a^{2}(b+4)<b\n\\end{aligned}\n\\]\n\nLet \\(d=c^{2} b-a^{2}(b+4), x=c+a\\) and \\(y=c-a\\); then we have \\(c=\\frac{x+y}{2}\\) and \\(a=\\frac{x-y}{2}\\), and (3) can be re-written as follows:\n\\[\n\\begin{aligned}\n\\left(\\frac{x+y}{2}\\right)^{2} b-\\left(\\frac{x-y}{2}\\right)^{2}(b+4) & =d \\\\\nx^{2}-(b+2) x y+y^{2}+d=0 ; \\quad 0 & \\leqslant d<b\n\\end{aligned}\n\\]\n\nSo, by the indirect assumption, the equation (4) has some positive integer solution \\((x, y)\\).\nFix \\(b\\) and \\(d\\), and take a pair ( \\(x, y\\) ) of positive integers, satisfying (4), such that \\(x+y\\) is minimal. By the symmetry in (4) we may assume that \\(x \\geqslant y \\geqslant 1\\).\n\nNow we perform a usual \"Vieta jump\". Consider (4) as a quadratic equation in variable \\(x\\), and let \\(z\\) be its second root. By the Vieta formulas,\n\\[\nx+z=(b+2) y, \\quad \\text { and } \\quad z x=y^{2}+d\n\\]\nso\n\\[\nz=(b+2) y-x=\\frac{y^{2}+d}{x}\n\\]\n\nThe first formula shows that \\(z\\) is an integer, and by the second formula \\(z\\) is positive. Hence \\((z, y)\\) is another positive integer solution of (4). From\n\\[\n\\begin{aligned}\n(x-1)(z-1) & =x z-(x+z)+1=\\left(y^{2}+d\\right)-(b+2) y+1 \\\\\n& <\\left(y^{2}+b\\right)-(b+2) y+1=(y-1)^{2}-b(y-1) \\leqslant(y-1)^{2} \\leqslant(x-1)^{2}\n\\end{aligned}\n\\]\nwe can see that \\(z<x\\) and therefore \\(z+y<x+y\\). But this contradicts the minimality of \\(x+y\\) among the positive integer solutions of (4).\n\nThe activities of the Problem Selection Committee were supported by\nTrinity College, Cambridge\nUniversity of Cambridge", "source_pdf": "imosl_2019.pdf", "notes": "fallback-regex"}
{"id": "IMOSL-2020-A1", "contest": "IMOSL", "year": "2020", "problem_number": "A1", "problem": "Version 1. Let \\(n\\) be a positive integer, and set \\(N=2^{n}\\). Determine the smallest real number \\(a_{n}\\) such that, for all real \\(x\\),\n\\[\n\\sqrt[N]{\\frac{x^{2 N}+1}{2}} \\leqslant a_{n}(x-1)^{2}+x .\n\\]\n\nVersion 2. For every positive integer \\(N\\), determine the smallest real number \\(b_{N}\\) such that, for all real \\(x\\),\n\\[\n\\sqrt[N]{\\frac{x^{2 N}+1}{2}} \\leqslant b_{N}(x-1)^{2}+x .\n\\]\n(Ireland)", "solution": "Answer for both versions : \\(a_{n}=b_{N}=N / 2\\).\n\nSolution 1 (for Version 1). First of all, assume that \\(a_{n}<N / 2\\) satisfies the condition. Take \\(x=1+t\\) for \\(t>0\\), we should have\n\\[\n\\frac{(1+t)^{2 N}+1}{2} \\leqslant\\left(1+t+a_{n} t^{2}\\right)^{N} .\n\\]\n\nExpanding the brackets we get\n\\[\n\\left(1+t+a_{n} t^{2}\\right)^{N}-\\frac{(1+t)^{2 N}+1}{2}=\\left(N a_{n}-\\frac{N^{2}}{2}\\right) t^{2}+c_{3} t^{3}+\\ldots+c_{2 N} t^{2 N}\n\\]\nwith some coefficients \\(c_{3}, \\ldots, c_{2 N}\\). Since \\(a_{n}<N / 2\\), the right hand side of (1) is negative for sufficiently small \\(t\\). A contradiction.\n\nIt remains to prove the following inequality\n\\[\n\\sqrt[N]{\\frac{1+x^{2 N}}{2}} \\leqslant x+\\frac{N}{2}(x-1)^{2}, \\quad \\mathcal{I}(N, x)\n\\]\nwhere \\(N=2^{n}\\).\n\nUse induction in \\(n\\). The base case \\(n=0\\) is trivial: \\(N=1\\) and both sides of \\(\\mathcal{I}(N, x)\\) are equal to \\(\\left(1+x^{2}\\right) / 2\\). For completing the induction we prove \\(\\mathcal{I}(2 N, x)\\) assuming that \\(\\mathcal{I}(N, y)\\) is established for all real \\(y\\). We have\n\\[\n\\begin{aligned}\n\\left(x+N(x-1)^{2}\\right)^{2} & =x^{2}+N^{2}(x-1)^{4}+N(x-1)^{2} \\frac{(x+1)^{2}-(x-1)^{2}}{2} \\\\\n& =x^{2}+\\frac{N}{2}\\left(x^{2}-1\\right)^{2}+\\left(N^{2}-\\frac{N}{2}\\right)(x-1)^{4} \\geqslant x^{2}+\\frac{N}{2}\\left(x^{2}-1\\right)^{2} \\geqslant \\sqrt[N]{\\frac{1+x^{4 N}}{2}},\n\\end{aligned}\n\\]\nwhere the last inequality is \\(\\mathcal{I}\\left(N, x^{2}\\right)\\). Since\n\\[\nx+N(x-1)^{2} \\geqslant x+\\frac{(x-1)^{2}}{2}=\\frac{x^{2}+1}{2} \\geqslant 0,\n\\]\ntaking square root we get \\(\\mathcal{I}(2 N, x)\\). The inductive step is complete.\n\nSolution 2.1 (for Version 2). Like in Solution 1 of Version 1, we conclude that \\(b_{N} \\geqslant N / 2\\). It remains to prove the inequality \\(\\mathcal{I}(N, x)\\) for an arbitrary positive integer \\(N\\).\n\nFirst of all, \\(\\mathcal{I}(N, 0)\\) is obvious. Further, if \\(x>0\\), then the left hand sides of \\(\\mathcal{I}(N,-x)\\) and \\(\\mathcal{I}(N, x)\\) coincide, while the right hand side of \\(\\mathcal{I}(N,-x)\\) is larger than that of \\(\\mathcal{I}(N,-x)\\) (their difference equals \\(2(N-1) x \\geqslant 0)\\). Therefore, \\(\\mathcal{I}(N,-x)\\) follows from \\(\\mathcal{I}(N, x)\\). So, hereafter we suppose that \\(x>0\\).\n\nDivide \\(\\mathcal{I}(N, x)\\) by \\(x\\) and let \\(t=(x-1)^{2} / x=x-2+1 / x\\); then \\(\\mathcal{I}(n, x)\\) reads as\n\\[\nf_{N}:=\\frac{x^{N}+x^{-N}}{2} \\leqslant\\left(1+\\frac{N}{2} t\\right)^{N} .\n\\]\n\nThe key identity is the expansion of \\(f_{N}\\) as a polynomial in \\(t\\) :\nLemma.\n\\[\nf_{N}=N \\sum_{k=0}^{N} \\frac{1}{N+k}\\binom{N+k}{2 k} t^{k} .\n\\]\n\nProof. Apply induction on \\(N\\). We will make use of the straightforward recurrence relation\n\\[\nf_{N+1}+f_{N-1}=(x+1 / x) f_{N}=(2+t) f_{N} .\n\\]\n\nThe base cases \\(N=1,2\\) are straightforward:\n\\[\nf_{1}=1+\\frac{t}{2}, \\quad f_{2}=\\frac{1}{2} t^{2}+2 t+1 .\n\\]\n\nFor the induction step from \\(N-1\\) and \\(N\\) to \\(N+1\\), we compute the coefficient of \\(t^{k}\\) in \\(f_{N+1}\\) using the formula \\(f_{N+1}=(2+t) f_{N}-f_{N-1}\\). For \\(k=0\\) that coefficient equals 1 , for \\(k>0\\) it equals\n\\[\n\\begin{aligned}\n& 2 \\frac{N}{N+k}\\binom{N+k}{2 k}+\\frac{N}{N+k-1}\\binom{N+k-1}{2 k-2}-\\frac{N-1}{N+k-1}\\binom{N+k-1}{2 k} \\\\\n& =\\frac{(N+k-1)!}{(2 k)!(N-k)!}\\left(2 N+\\frac{2 k(2 k-1) N}{(N+k-1)(N-k+1)}-\\frac{(N-1)(N-k)}{N+k-1}\\right) \\\\\n& =\\frac{(N+k-1)!}{(2 k)!(N-k+1)!}\\left(2 N(N-k+1)+3 k N+k-N^{2}-N\\right)=\\frac{\\binom{N+k+1}{2 k}}{(N+k+1)}(N+1),\n\\end{aligned}\n\\]\nthat completes the induction.\nTurning back to the problem, in order to prove (2) we write\n\\[\n\\left(1+\\frac{N}{2} t\\right)^{N}-f_{N}=\\left(1+\\frac{N}{2} t\\right)^{N}-N \\sum_{k=0}^{N} \\frac{1}{N+k}\\binom{N+k}{2 k} t^{k}=\\sum_{k=0}^{N} \\alpha_{k} t^{k},\n\\]\nwhere\n\\[\n\\begin{aligned}\n\\alpha_{k} & =\\left(\\frac{N}{2}\\right)^{k}\\binom{N}{k}-\\frac{N}{N+k}\\binom{N+k}{2 k} \\\\\n& =\\left(\\frac{N}{2}\\right)^{k}\\binom{N}{k}\\left(1-2^{k} \\frac{(1+1 / N)(1+2 / N) \\cdot \\ldots \\cdot(1+(k-1) / N)}{(k+1) \\cdot \\ldots \\cdot(2 k)}\\right) \\\\\n& \\geqslant\\left(\\frac{N}{2}\\right)^{k}\\binom{N}{k}\\left(1-2^{k} \\frac{2 \\cdot 3 \\cdot \\ldots \\cdot k}{(k+1) \\cdot \\ldots \\cdot(2 k)}\\right)=\\left(\\frac{N}{2}\\right)^{k}\\binom{N}{k}\\left(1-\\prod_{j=1}^{k} \\frac{2 j}{k+j}\\right) \\geqslant 0,\n\\end{aligned}\n\\]\nand (2) follows.\n\nSolution 2.2 (for Version 2). Here we present another proof of the inequality (2) for \\(x>0\\), or, equivalently, for \\(t=(x-1)^{2} / x \\geqslant 0\\). Instead of finding the coefficients of the polynomial \\(f_{N}=f_{N}(t)\\) we may find its roots, which is in a sense more straightforward. Note that the recurrence (4) and the initial conditions \\(f_{0}=1, f_{1}=1+t / 2\\) imply that \\(f_{N}\\) is a polynomial in \\(t\\) of degree \\(N\\). It also follows by induction that \\(f_{N}(0)=1, f_{N}^{\\prime}(0)=N^{2} / 2\\) : the recurrence relations read as \\(f_{N+1}(0)+f_{N-1}(0)=2 f_{N}(0)\\) and \\(f_{N+1}^{\\prime}(0)+f_{N-1}^{\\prime}(0)=2 f_{N}^{\\prime}(0)+f_{N}(0)\\), respectively.\n\nNext, if \\(x_{k}=\\exp \\left(\\frac{i \\pi(2 k-1)}{2 N}\\right)\\) for \\(k \\in\\{1,2, \\ldots, N\\}\\), then\n\\[\n-t_{k}:=2-x_{k}-\\frac{1}{x_{k}}=2-2 \\cos \\frac{\\pi(2 k-1)}{2 N}=4 \\sin ^{2} \\frac{\\pi(2 k-1)}{4 N}>0\n\\]\nand\n\\[\nf_{N}\\left(t_{k}\\right)=\\frac{x_{k}^{N}+x_{k}^{-N}}{2}=\\frac{\\exp \\left(\\frac{i \\pi(2 k-1)}{2}\\right)+\\exp \\left(-\\frac{i \\pi(2 k-1)}{2}\\right)}{2}=0 .\n\\]\n\nSo the roots of \\(f_{N}\\) are \\(t_{1}, \\ldots, t_{N}\\) and by the AM-GM inequality we have\n\\[\n\\begin{aligned}\nf_{N}(t)=\\left(1-\\frac{t}{t_{1}}\\right)\\left(1-\\frac{t}{t_{2}}\\right) \\ldots\\left(1-\\frac{t}{t_{N}}\\right) & \\leqslant\\left(1-\\frac{t}{N}\\left(\\frac{1}{t_{1}}+\\ldots+\\frac{1}{t_{n}}\\right)\\right)^{N}= \\\\\n\\left(1+\\frac{t f_{N}^{\\prime}(0)}{N}\\right)^{N} & =\\left(1+\\frac{N}{2} t\\right)^{N} .\n\\end{aligned}\n\\]\n\nComment. The polynomial \\(f_{N}(t)\\) equals to \\(\\frac{1}{2} T_{N}(t+2)\\), where \\(T_{n}\\) is the \\(n^{\\text {th }}\\) Chebyshev polynomial of the first kind: \\(T_{n}(2 \\cos s)=2 \\cos n s, T_{n}(x+1 / x)=x^{n}+1 / x^{n}\\).\n\nSolution 2.3 (for Version 2). Here we solve the problem when \\(N \\geqslant 1\\) is an arbitrary real number. For a real number \\(a\\) let\n\\[\nf(x)=\\left(\\frac{x^{2 N}+1}{2}\\right)^{\\frac{1}{N}}-a(x-1)^{2}-x .\n\\]\n\nThen \\(f(1)=0\\),\n\\[\n\\begin{gathered}\nf^{\\prime}(x)=\\left(\\frac{x^{2 N}+1}{2}\\right)^{\\frac{1}{N}-1} x^{2 N-1}-2 a(x-1)-1 \\quad \\text { and } \\quad f^{\\prime}(1)=0 ; \\\\\nf^{\\prime \\prime}(x)=(1-N)\\left(\\frac{x^{2 N}+1}{2}\\right)^{\\frac{1}{N}-2} x^{4 N-2}+(2 N-1)\\left(\\frac{x^{2 N}+1}{2}\\right)^{\\frac{1}{N}-1} x^{2 N-2}-2 a \\quad \\text { and } \\quad f^{\\prime \\prime}(1)=N-2 a .\n\\end{gathered}\n\\]\n\nSo if \\(a<\\frac{N}{2}\\), the function \\(f\\) has a strict local minimum at point 1 , and the inequality \\(f(x) \\leqslant 0=f(1)\\) does not hold. This proves \\(b_{N} \\geqslant N / 2\\).\n\nFor \\(a=\\frac{N}{2}\\) we have \\(f^{\\prime \\prime}(1)=0\\) and\n\\[\nf^{\\prime \\prime \\prime}(x)=\\frac{1}{2}(1-N)(1-2 N)\\left(\\frac{x^{2 N}+1}{2}\\right)^{\\frac{1}{N}-3} x^{2 N-3}\\left(1-x^{2 N}\\right) \\quad \\begin{cases}>0 & \\text { if } 0<x<1 \\text { and } \\\\ <0 & \\text { if } x>1 .\\end{cases}\n\\]\n\nHence, \\(f^{\\prime \\prime}(x)<0\\) for \\(x \\neq 1\\) ; \\(f^{\\prime}(x)>0\\) for \\(x<1\\) and \\(f^{\\prime}(x)<0\\) for \\(x>1\\), finally \\(f(x)<0\\) for \\(x \\neq 1\\).\n\nComment. Version 2 is much more difficult, of rather A5 or A6 difficulty. The induction in Version 1 is rather straightforward, while all three above solutions of Version 2 require some creativity.", "source_pdf": "imosl_2020.pdf", "notes": "fallback-regex"}
{"id": "IMOSL-2020-A2", "contest": "IMOSL", "year": "2020", "problem_number": "A2", "problem": "Let \\(\\mathcal{A}\\) denote the set of all polynomials in three variables \\(x, y, z\\) with integer coefficients. Let \\(\\mathcal{B}\\) denote the subset of \\(\\mathcal{A}\\) formed by all polynomials which can be expressed as\n\\[\n(x+y+z) P(x, y, z)+(x y+y z+z x) Q(x, y, z)+x y z R(x, y, z)\n\\]\nwith \\(P, Q, R \\in \\mathcal{A}\\). Find the smallest non-negative integer \\(n\\) such that \\(x^{i} y^{j} z^{k} \\in \\mathcal{B}\\) for all nonnegative integers \\(i, j, k\\) satisfying \\(i+j+k \\geqslant n\\).\n(Venezuela)", "solution": "Answer: \\(n=4\\).\n\n. We start by showing that \\(n \\leqslant 4\\), i.e., any monomial \\(f=x^{i} y^{j} z^{k}\\) with \\(i+j+k \\geqslant 4\\) belongs to \\(\\mathcal{B}\\). Assume that \\(i \\geqslant j \\geqslant k\\), the other cases are analogous.\n\nLet \\(x+y+z=p, x y+y z+z x=q\\) and \\(x y z=r\\). Then\n\\[\n0=(x-x)(x-y)(x-z)=x^{3}-p x^{2}+q x-r\n\\]\ntherefore \\(x^{3} \\in \\mathcal{B}\\). Next, \\(x^{2} y^{2}=x y q-(x+y) r \\in \\mathcal{B}\\).\nIf \\(k \\geqslant 1\\), then \\(r\\) divides \\(f\\), thus \\(f \\in \\mathcal{B}\\). If \\(k=0\\) and \\(j \\geqslant 2\\), then \\(x^{2} y^{2}\\) divides \\(f\\), thus we have \\(f \\in \\mathcal{B}\\) again. Finally, if \\(k=0, j \\leqslant 1\\), then \\(x^{3}\\) divides \\(f\\) and \\(f \\in \\mathcal{B}\\) in this case also.\n\nIn order to prove that \\(n \\geqslant 4\\), we show that the monomial \\(x^{2} y\\) does not belong to \\(\\mathcal{B}\\). Assume the contrary:\n\\[\nx^{2} y=p P+q Q+r R\n\\]\nfor some polynomials \\(P, Q, R\\). If polynomial \\(P\\) contains the monomial \\(x^{2}\\) (with nonzero coefficient), then \\(p P+q Q+r R\\) contains the monomial \\(x^{3}\\) with the same nonzero coefficient. So \\(P\\) does not contain \\(x^{2}, y^{2}, z^{2}\\) and we may write\n\\[\nx^{2} y=(x+y+z)(a x y+b y z+c z x)+(x y+y z+z x)(d x+e y+f z)+g x y z\n\\]\nwhere \\(a, b, c ; d, e, f ; g\\) are the coefficients of \\(x y, y z, z x ; x, y, z ; x y z\\) in the polynomials \\(P\\); \\(Q ; R\\), respectively (the remaining coefficients do not affect the monomials of degree 3 in \\(p P+q Q+r R\\) ). By considering the coefficients of \\(x y^{2}\\) we get \\(e=-a\\), analogously \\(e=-b\\), \\(f=-b, f=-c, d=-c\\), thus \\(a=b=c\\) and \\(f=e=d=-a\\), but then the coefficient of \\(x^{2} y\\) in the right hand side equals \\(a+d=0 \\neq 1\\).\n\nComment 1. The general question is the following. Call a polynomial \\(f\\left(x_{1}, \\ldots, x_{n}\\right)\\) with integer coefficients nice, if \\(f(0,0, \\ldots, 0)=0\\) and \\(f\\left(x_{\\pi_{1}}, \\ldots, x_{\\pi_{n}}\\right)=f\\left(x_{1}, \\ldots, x_{n}\\right)\\) for any permutation \\(\\pi\\) of \\(1, \\ldots, n\\) (in other words, \\(f\\) is symmetric and its constant term is zero.) Denote by \\(\\mathcal{I}\\) the set of polynomials of the form\n\\[\np_{1} q_{1}+p_{2} q_{2}+\\ldots+p_{m} q_{m}\n\\]\nwhere \\(m\\) is an integer, \\(q_{1}, \\ldots, q_{m}\\) are polynomials with integer coefficients, and \\(p_{1}, \\ldots, p_{m}\\) are nice polynomials. Find the least \\(N\\) for which any monomial of degree at least \\(N\\) belongs to \\(\\mathcal{I}\\).\n\nThe answer is \\(n(n-1) / 2+1\\). The lower bound follows from the following claim: the polynomial\n\\[\nF\\left(x_{1}, \\ldots, x_{n}\\right)=x_{2} x_{3}^{2} x_{4}^{3} \\cdot \\ldots \\cdot x_{n}^{n-1}\n\\]\ndoes not belong to \\(\\mathcal{I}\\).\nAssume that \\(F=\\sum p_{i} q_{i}\\), according to (2). By taking only the monomials of degree \\(n(n-1) / 2\\), we can additionally assume that every \\(p_{i}\\) and every \\(q_{i}\\) is homogeneous, \\(\\operatorname{deg} p_{i}>0\\), and \\(\\operatorname{deg} p_{i}+\\operatorname{deg} q_{i}= \\operatorname{deg} F=n(n-1) / 2\\) for all \\(i\\).\n\nConsider the alternating sum\n\\[\n\\sum_{\\pi} \\operatorname{sign}(\\pi) F\\left(x_{\\pi_{1}}, \\ldots, x_{\\pi_{n}}\\right)=\\sum_{i=1}^{m} p_{i} \\sum_{\\pi} \\operatorname{sign}(\\pi) q_{i}\\left(x_{\\pi_{1}}, \\ldots, x_{\\pi_{n}}\\right):=S\n\\]\nwhere the summation is done over all permutations \\(\\pi\\) of \\(1, \\ldots n\\), and \\(\\operatorname{sign}(\\pi)\\) denotes the sign of the permutation \\(\\pi\\). Since \\(\\operatorname{deg} q_{i}=n(n-1) / 2-\\operatorname{deg} p_{i}<n(n-1) / 2\\), in any monomial \\(Q\\) of \\(q_{i}\\), there are at least two variables, say \\(x_{\\alpha}\\) and \\(x_{\\beta}\\), with equal exponents. Therefore \\(\\sum_{\\pi} \\operatorname{sign}(\\pi) Q\\left(x_{\\pi_{1}}, \\ldots, x_{\\pi_{n}}\\right)=0\\), because each pair of terms that corresponds to permutations which differ by the transposition of \\(\\alpha\\) and \\(\\beta\\), cancels out. This holds for any \\(i=1, \\ldots, m\\) and any monomial of \\(q_{i}\\), so \\(S=0\\). But the left hand side of (3) is a non-zero polynomial. This is a contradiction.\n\nLet us now prove, using induction on \\(n\\), that any monomial \\(h=x_{1}^{c_{1}} \\ldots x_{n}^{c_{n}}\\) of degree \\(n(n-1) / 2+1\\) belongs to \\(\\mathcal{I}\\), and additionally all \\(p_{i}, q_{i}\\) in the representation (2) can be chosen homogeneous with sum of degrees equal to \\(n(n-1) / 2+1\\). (Obviously, any monomial of degree at least \\(n(n-1) / 2+1\\) is divisible by a monomial of degree exactly \\(n(n-1) / 2+1\\), thus this suffices.) The proposition is true for \\(n=1\\), so assume that \\(n>1\\) and that the proposition is proved for smaller values of \\(n\\).\n\nWe proceed by an internal induction on \\(S:=\\left|\\left\\{i: c_{i}=0\\right\\}\\right|\\). In the base case \\(S=0\\) the monomial \\(h\\) is divisible by the nice polynomial \\(x_{1} \\cdot \\ldots \\cdot x_{n}\\), therefore \\(h \\in \\mathcal{I}\\). Now assume that \\(S>0\\) and that the claim holds for smaller values of \\(S\\). Let \\(T=n-S\\). We may assume that \\(c_{T+1}=\\ldots=c_{n}=0\\) and \\(h=x_{1} \\cdot \\ldots \\cdot x_{T} g\\left(x_{1}, \\ldots, x_{n-1}\\right)\\), where \\(\\operatorname{deg} g=n(n-1) / 2-T+1 \\geqslant(n-1)(n-2) / 2+1\\). Using the outer induction hypothesis we represent \\(g\\) as \\(p_{1} q_{1}+\\ldots+p_{m} q_{m}\\), where \\(p_{i}\\left(x_{1}, \\ldots, x_{n-1}\\right)\\) are nice polynomials in \\(n-1\\) variables. There exist nice homogeneous polynomials \\(P_{i}\\left(x_{1}, \\ldots, x_{n}\\right)\\) such that \\(P_{i}\\left(x_{1}, \\ldots, x_{n-1}, 0\\right)=p_{i}\\left(x_{1}, \\ldots, x_{n-1}\\right)\\). In other words, \\(\\Delta_{i}:=p_{i}\\left(x_{1}, \\ldots, x_{n-1}\\right)-P_{i}\\left(x_{1}, \\ldots, x_{n-1}, x_{n}\\right)\\) is divisible by \\(x_{n}\\), let \\(\\Delta_{i}=x_{n} g_{i}\\). We get\n\\[\nh=x_{1} \\cdot \\ldots \\cdot x_{T} \\sum p_{i} q_{i}=x_{1} \\cdot \\ldots \\cdot x_{T} \\sum\\left(P_{i}+x_{n} g_{i}\\right) q_{i}=\\left(x_{1} \\cdot \\ldots \\cdot x_{T} x_{n}\\right) \\sum g_{i} q_{i}+\\sum P_{i} q_{i} \\in \\mathcal{I} .\n\\]\n\nThe first term belongs to \\(\\mathcal{I}\\) by the inner induction hypothesis. This completes both inductions.\nComment 2. The solutions above work smoothly for the versions of the original problem and its extensions to the case of \\(n\\) variables, where all polynomials are assumed to have real coefficients. In the version with integer coefficients, the argument showing that \\(x^{2} y \\notin \\mathcal{B}\\) can be simplified: it is not hard to show that in every polynomial \\(f \\in \\mathcal{B}\\), the sum of the coefficients of \\(x^{2} y, x^{2} z, y^{2} x, y^{2} z, z^{2} x\\) and \\(z^{2} y\\) is even. A similar fact holds for any number of variables and also implies that \\(N \\geqslant n(n-1) / 2+1\\) in terms of the previous comment.", "source_pdf": "imosl_2020.pdf", "notes": "fallback-regex"}
{"id": "IMOSL-2020-A3", "contest": "IMOSL", "year": "2020", "problem_number": "A3", "problem": "Suppose that \\(a, b, c, d\\) are positive real numbers satisfying \\((a+c)(b+d)=a c+b d\\). Find the smallest possible value of\n\\[\nS=\\frac{a}{b}+\\frac{b}{c}+\\frac{c}{d}+\\frac{d}{a}\n\\]\n(Israel)", "solution": "Answer: The smallest possible value is 8 .\n\n1. To show that \\(S \\geqslant 8\\), apply the AM-GM inequality twice as follows:\n\\(\\left(\\frac{a}{b}+\\frac{c}{d}\\right)+\\left(\\frac{b}{c}+\\frac{d}{a}\\right) \\geqslant 2 \\sqrt{\\frac{a c}{b d}}+2 \\sqrt{\\frac{b d}{a c}}=\\frac{2(a c+b d)}{\\sqrt{a b c d}}=\\frac{2(a+c)(b+d)}{\\sqrt{a b c d}} \\geqslant 2 \\cdot \\frac{2 \\sqrt{a c} \\cdot 2 \\sqrt{b d}}{\\sqrt{a b c d}}=8\\).\nThe above inequalities turn into equalities when \\(a=c\\) and \\(b=d\\). Then the condition \\((a+c)(b+d)=a c+b d\\) can be rewritten as \\(4 a b=a^{2}+b^{2}\\). So it is satisfied when \\(a / b=2 \\pm \\sqrt{3}\\). Hence, \\(S\\) attains value 8, e.g., when \\(a=c=1\\) and \\(b=d=2+\\sqrt{3}\\).\n\nSolution 2. By homogeneity we may suppose that \\(a b c d=1\\). Let \\(a b=C, b c=A\\) and \\(c a=B\\). Then \\(a, b, c\\) can be reconstructed from \\(A, B\\) and \\(C\\) as \\(a=\\sqrt{B C / A}, b=\\sqrt{A C / B}\\) and \\(c=\\sqrt{A B / C}\\). Moreover, the condition \\((a+c)(b+d)=a c+b d\\) can be written in terms of \\(A, B, C\\) as\n\\[\nA+\\frac{1}{A}+C+\\frac{1}{C}=b c+a d+a b+c d=(a+c)(b+d)=a c+b d=B+\\frac{1}{B} .\n\\]\n\nWe then need to minimize the expression\n\\[\n\\begin{aligned}\nS & :=\\frac{a d+b c}{b d}+\\frac{a b+c d}{a c}=\\left(A+\\frac{1}{A}\\right) B+\\left(C+\\frac{1}{C}\\right) \\frac{1}{B} \\\\\n& =\\left(A+\\frac{1}{A}\\right)\\left(B-\\frac{1}{B}\\right)+\\left(A+\\frac{1}{A}+C+\\frac{1}{C}\\right) \\frac{1}{B} \\\\\n& =\\left(A+\\frac{1}{A}\\right)\\left(B-\\frac{1}{B}\\right)+\\left(B+\\frac{1}{B}\\right) \\frac{1}{B}\n\\end{aligned}\n\\]\n\nWithout loss of generality assume that \\(B \\geqslant 1\\) (otherwise, we may replace \\(B\\) by \\(1 / B\\) and swap \\(A\\) and \\(C\\), this changes neither the relation nor the function to be maximized). Therefore, we can write\n\\[\nS \\geqslant 2\\left(B-\\frac{1}{B}\\right)+\\left(B+\\frac{1}{B}\\right) \\frac{1}{B}=2 B+\\left(1-\\frac{1}{B}\\right)^{2}=: f(B)\n\\]\n\nClearly, \\(f\\) increases on \\([1, \\infty)\\). Since\n\\[\nB+\\frac{1}{B}=A+\\frac{1}{A}+C+\\frac{1}{C} \\geqslant 4\n\\]\nwe have \\(B \\geqslant B^{\\prime}\\), where \\(B^{\\prime}=2+\\sqrt{3}\\) is the unique root greater than 1 of the equation \\(B^{\\prime}+1 / B^{\\prime}=4\\). Hence,\n\\[\nS \\geqslant f(B) \\geqslant f\\left(B^{\\prime}\\right)=2\\left(B^{\\prime}-\\frac{1}{B^{\\prime}}\\right)+\\left(B^{\\prime}+\\frac{1}{B^{\\prime}}\\right) \\frac{1}{B^{\\prime}}=2 B^{\\prime}-\\frac{2}{B^{\\prime}}+\\frac{4}{B^{\\prime}}=8\n\\]\n\nIt remains to note that when \\(A=C=1\\) and \\(B=B^{\\prime}\\) we have the equality \\(S=8\\).\n\nSolution 3. We present another proof of the inequality \\(S \\geqslant 8\\). We start with the estimate\n\\[\n\\left(\\frac{a}{b}+\\frac{c}{d}\\right)+\\left(\\frac{b}{c}+\\frac{d}{a}\\right) \\geqslant 2 \\sqrt{\\frac{a c}{b d}}+2 \\sqrt{\\frac{b d}{a c}}\n\\]\n\nLet \\(y=\\sqrt{a c}\\) and \\(z=\\sqrt{b d}\\), and assume, without loss of generality, that \\(a c \\geqslant b d\\). By the AM-GM inequality, we have\n\\[\ny^{2}+z^{2}=a c+b d=(a+c)(b+d) \\geqslant 2 \\sqrt{a c} \\cdot 2 \\sqrt{b d}=4 y z .\n\\]\n\nSubstituting \\(x=y / z\\), we get \\(4 x \\leqslant x^{2}+1\\). For \\(x \\geqslant 1\\), this holds if and only if \\(x \\geqslant 2+\\sqrt{3}\\).\nNow we have\n\\[\n2 \\sqrt{\\frac{a c}{b d}}+2 \\sqrt{\\frac{b d}{a c}}=2\\left(x+\\frac{1}{x}\\right)\n\\]\n\nClearly, this is minimized by setting \\(x(\\geqslant 1)\\) as close to 1 as possible, i.e., by taking \\(x=2+\\sqrt{3}\\). Then \\(2(x+1 / x)=2((2+\\sqrt{3})+(2-\\sqrt{3}))=8\\), as required.", "source_pdf": "imosl_2020.pdf", "notes": "fallback-regex"}
{"id": "IMOSL-2020-A5", "contest": "IMOSL", "year": "2020", "problem_number": "A5", "problem": "A magician intends to perform the following trick. She announces a positive integer \\(n\\), along with \\(2 n\\) real numbers \\(x_{1}<\\ldots<x_{2 n}\\), to the audience. A member of the audience then secretly chooses a polynomial \\(P(x)\\) of degree \\(n\\) with real coefficients, computes the \\(2 n\\) values \\(P\\left(x_{1}\\right), \\ldots, P\\left(x_{2 n}\\right)\\), and writes down these \\(2 n\\) values on the blackboard in non-decreasing order. After that the magician announces the secret polynomial to the audience.\n\nCan the magician find a strategy to perform such a trick?\n(Luxembourg)", "solution": "Answer: No, she cannot.\n\n. Let \\(x_{1}<x_{2}<\\ldots<x_{2 n}\\) be real numbers chosen by the magician. We will construct two distinct polynomials \\(P(x)\\) and \\(Q(x)\\), each of degree \\(n\\), such that the member of audience will write down the same sequence for both polynomials. This will mean that the magician cannot distinguish \\(P\\) from \\(Q\\).\nClaim. There exists a polynomial \\(P(x)\\) of degree \\(n\\) such that \\(P\\left(x_{2 i-1}\\right)+P\\left(x_{2 i}\\right)=0\\) for \\(i= 1,2, \\ldots, n\\).\nProof. We want to find a polynomial \\(a_{n} x^{n}+\\ldots+a_{1} x+a_{0}\\) satisfying the following system of equations:\n\\[\n\\left\\{\\begin{array}{l}\n\\left(x_{1}^{n}+x_{2}^{n}\\right) a_{n}+\\left(x_{1}^{n-1}+x_{2}^{n-1}\\right) a_{n-1}+\\ldots+2 a_{0}=0 \\\\\n\\left(x_{3}^{n}+x_{4}^{n}\\right) a_{n}+\\left(x_{3}^{n-1}+x_{4}^{n-1}\\right) a_{n-1}+\\ldots+2 a_{0}=0 \\\\\n\\ldots \\\\\n\\left(x_{2 n-1}^{n}+x_{2 n}^{n}\\right) a_{n}+\\left(x_{2 n-1}^{n-1}+x_{2 n}^{n-1}\\right) a_{n-1}+\\ldots+2 a_{0}=0\n\\end{array}\\right.\n\\]\n\nWe use the well known fact that a homogeneous system of \\(n\\) linear equations in \\(n+1\\) variables has a nonzero solution. (This fact can be proved using induction on \\(n\\), via elimination of variables.) Applying this fact to the above system, we find a nonzero polynomial \\(P(x)\\) of degree not exceeding \\(n\\) such that its coefficients \\(a_{0}, \\ldots, a_{n}\\) satisfy this system. Therefore \\(P\\left(x_{2 i-1}\\right)+P\\left(x_{2 i}\\right)=0\\) for all \\(i=1,2, \\ldots, n\\). Notice that \\(P\\) has a root on each segment \\(\\left[x_{2 i-1}, x_{2 i}\\right]\\) by the Intermediate Value theorem, so \\(n\\) roots in total. Since \\(P\\) is nonzero, we get \\(\\operatorname{deg} P=n\\).\n\nNow consider a polynomial \\(P(x)\\) provided by the Claim, and take \\(Q(x)=-P(x)\\). The properties of \\(P(x)\\) yield that \\(P\\left(x_{2 i-1}\\right)=Q\\left(x_{2 i}\\right)\\) and \\(Q\\left(x_{2 i-1}\\right)=P\\left(x_{2 i}\\right)\\) for all \\(i=1,2, \\ldots, n\\). It is also clear that \\(P \\neq-P=Q\\) and \\(\\operatorname{deg} Q=\\operatorname{deg} P=n\\).\n\nComment. It can be shown that for any positive integer \\(n\\) the magician can choose \\(2 n+1\\) distinct real numbers so as to perform such a trick. Moreover, she can perform such a trick with almost all (in a proper sense) ( \\(2 n+1\\) )-tuples of numbers.", "source_pdf": "imosl_2020.pdf", "notes": "fallback-regex"}
{"id": "IMOSL-2020-A6", "contest": "IMOSL", "year": "2020", "problem_number": "A6", "problem": "Determine all functions \\(f: \\mathbb{Z} \\rightarrow \\mathbb{Z}\\) such that\n\\[\nf^{a^{2}+b^{2}}(a+b)=a f(a)+b f(b) \\quad \\text { for every } a, b \\in \\mathbb{Z}\n\\]\n\nHere, \\(f^{n}\\) denotes the \\(n^{\\text {th }}\\) iteration of \\(f\\), i.e., \\(f^{0}(x)=x\\) and \\(f^{n+1}(x)=f\\left(f^{n}(x)\\right)\\) for all \\(n \\geqslant 0\\).\n(Slovakia)", "solution": "Answer: Either \\(f(x)=0\\) for all \\(x \\in \\mathbb{Z}\\), or \\(f(x)=x+1\\) for all \\(x \\in \\mathbb{Z}\\).\n\n. Refer to the main equation as \\(E(a, b)\\).\n\\(E(0, b)\\) reads as \\(f^{b^{2}}(b)=b f(b)\\). For \\(b=-1\\) this gives \\(f(-1)=0\\).\nNow \\(E(a,-1)\\) reads as\n\\[\nf^{a^{2}+1}(a-1)=a f(a)=f^{a^{2}}(a)\n\\]\n\nFor \\(x \\in \\mathbb{Z}\\) define the orbit of \\(x\\) by \\(\\mathcal{O}(x)=\\{x, f(x), f(f(x)), \\ldots\\} \\subseteq \\mathbb{Z}\\). We see that the orbits \\(\\mathcal{O}(a-1)\\) and \\(\\mathcal{O}(a)\\) differ by finitely many terms. Hence, any two orbits differ by finitely many terms. In particular, this implies that either all orbits are finite or all orbits are infinite.\nCase 1: All orbits are finite.\nThen \\(\\mathcal{O}(0)\\) is finite. Using \\(E(a,-a)\\) we get\n\\[\na(f(a)-f(-a))=a f(a)-a f(-a)=f^{2 a^{2}}(0) \\in \\mathcal{O}(0)\n\\]\n\nFor \\(|a|>\\max _{z \\in \\mathcal{O}(0)}|z|\\), this yields \\(f(a)=f(-a)\\) and \\(f^{2 a^{2}}(0)=0\\). Therefore, the sequence \\(\\left(f^{k}(0): k=0,1, \\ldots\\right)\\) is purely periodic with a minimal period \\(T\\) which divides \\(2 a^{2}\\). Analogously, \\(T\\) divides \\(2(a+1)^{2}\\), therefore, \\(T \\mid \\operatorname{gcd}\\left(2 a^{2}, 2(a+1)^{2}\\right)=2\\), i.e., \\(f(f(0))=0\\) and \\(a(f(a)-f(-a))=f^{2 a^{2}}(0)=0\\) for all \\(a\\). Thus,\n\\[\n\\begin{aligned}\n& f(a)=f(-a) \\quad \\text { for all } a \\neq 0 ; \\\\\n& \\text { in particular, } \\quad f(1)=f(-1)=0 .\n\\end{aligned}\n\\]\n\nNext, for each \\(n \\in \\mathbb{Z}\\), by \\(E(n, 1-n)\\) we get\n\\[\nn f(n)+(1-n) f(1-n)=f^{n^{2}+(1-n)^{2}}(1)=f^{2 n^{2}-2 n}(0)=0\n\\]\n\nAssume that there exists some \\(m \\neq 0\\) such that \\(f(m) \\neq 0\\). Choose such an \\(m\\) for which \\(|m|\\) is minimal possible. Then \\(|m|>1\\) due to ( \\(\\mathbf{1}\\) ); \\(f(|m|) \\neq 0\\) due to ( \\(\\mathbf{\\phi}\\) ); and \\(f(1-|m|) \\neq 0\\) due to ( \\(\\bigcirc\\) ) for \\(n=|m|\\). This contradicts to the minimality assumption.\n\nSo, \\(f(n)=0\\) for \\(n \\neq 0\\). Finally, \\(f(0)=f^{3}(0)=f^{4}(2)=2 f(2)=0\\). Clearly, the function \\(f(x) \\equiv 0\\) satisfies the problem condition, which provides the first of the two answers.\nCase 2: All orbits are infinite.\nSince the orbits \\(\\mathcal{O}(a)\\) and \\(\\mathcal{O}(a-1)\\) differ by finitely many terms for all \\(a \\in \\mathbb{Z}\\), each two orbits \\(\\mathcal{O}(a)\\) and \\(\\mathcal{O}(b)\\) have infinitely many common terms for arbitrary \\(a, b \\in \\mathbb{Z}\\).\n\nFor a minute, fix any \\(a, b \\in \\mathbb{Z}\\). We claim that all pairs \\((n, m)\\) of nonnegative integers such that \\(f^{n}(a)=f^{m}(b)\\) have the same difference \\(n-m\\). Arguing indirectly, we have \\(f^{n}(a)=f^{m}(b)\\) and \\(f^{p}(a)=f^{q}(b)\\) with, say, \\(n-m>p-q\\), then \\(f^{p+m+k}(b)=f^{p+n+k}(a)=f^{q+n+k}(b)\\), for all nonnegative integers \\(k\\). This means that \\(f^{\\ell+(n-m)-(p-q)}(b)=f^{\\ell}(b)\\) for all sufficiently large \\(\\ell\\), i.e., that the sequence ( \\(f^{n}(b)\\) ) is eventually periodic, so \\(\\mathcal{O}(b)\\) is finite, which is impossible.\n\nNow, for every \\(a, b \\in \\mathbb{Z}\\), denote the common difference \\(n-m\\) defined above by \\(X(a, b)\\). We have \\(X(a-1, a)=1\\) by (1). Trivially, \\(X(a, b)+X(b, c)=X(a, c)\\), as if \\(f^{n}(a)=f^{m}(b)\\) and \\(f^{p}(b)=f^{q}(c)\\), then \\(f^{p+n}(a)=f^{p+m}(b)=f^{q+m}(c)\\). These two properties imply that \\(X(a, b)=b-a\\) for all \\(a, b \\in \\mathbb{Z}\\).\n\nBut (1) yields \\(f^{a^{2}+1}(f(a-1))=f^{a^{2}}(f(a))\\), so\n\\[\n1=X(f(a-1), f(a))=f(a)-f(a-1) \\quad \\text { for all } a \\in \\mathbb{Z} .\n\\]\n\nRecalling that \\(f(-1)=0\\), we conclude by (two-sided) induction on \\(x\\) that \\(f(x)=x+1\\) for all \\(x \\in \\mathbb{Z}\\).\n\nFinally, the obtained function also satisfies the assumption. Indeed, \\(f^{n}(x)=x+n\\) for all \\(n \\geqslant 0\\), so\n\\[\nf^{a^{2}+b^{2}}(a+b)=a+b+a^{2}+b^{2}=a f(a)+b f(b)\n\\]\n\nComment. There are many possible variations of the solution above, but it seems that finiteness of orbits seems to be a crucial distinction in all solutions. However, the case distinction could be made in different ways; in particular, there exist some versions of Case 1 which work whenever there is at least one finite orbit.\n\nWe believe that Case 2 is conceptually harder than Case 1.", "source_pdf": "imosl_2020.pdf", "notes": "fallback-regex"}
{"id": "IMOSL-2020-A7", "contest": "IMOSL", "year": "2020", "problem_number": "A7", "problem": "Let \\(n\\) and \\(k\\) be positive integers. Prove that for \\(a_{1}, \\ldots, a_{n} \\in\\left[1,2^{k}\\right]\\) one has\n\\[\n\\sum_{i=1}^{n} \\frac{a_{i}}{\\sqrt{a_{1}^{2}+\\ldots+a_{i}^{2}}} \\leqslant 4 \\sqrt{k n} .\n\\]\n(Iran)", "solution": "1. Partition the set of indices \\(\\{1,2, \\ldots, n\\}\\) into disjoint subsets \\(M_{1}, M_{2}, \\ldots, M_{k}\\) so that \\(a_{\\ell} \\in\\left[2^{j-1}, 2^{j}\\right]\\) for \\(\\ell \\in M_{j}\\). Then, if \\(\\left|M_{j}\\right|=: p_{j}\\), we have\n\\[\n\\sum_{\\ell \\in M_{j}} \\frac{a_{\\ell}}{\\sqrt{a_{1}^{2}+\\ldots+a_{\\ell}^{2}}} \\leqslant \\sum_{i=1}^{p_{j}} \\frac{2^{j}}{2^{j-1} \\sqrt{i}}=2 \\sum_{i=1}^{p_{j}} \\frac{1}{\\sqrt{i}},\n\\]\nwhere we used that \\(a_{\\ell} \\leqslant 2^{j}\\) and in the denominator every index from \\(M_{j}\\) contributes at least \\(\\left(2^{j-1}\\right)^{2}\\). Now, using \\(\\sqrt{i}-\\sqrt{i-1}=\\frac{1}{\\sqrt{i}+\\sqrt{i-1}} \\geqslant \\frac{1}{2 \\sqrt{i}}\\), we deduce that\n\\[\n\\sum_{\\ell \\in M_{j}} \\frac{a_{\\ell}}{\\sqrt{a_{1}^{2}+\\ldots+a_{\\ell}^{2}}} \\leqslant 2 \\sum_{i=1}^{p_{j}} \\frac{1}{\\sqrt{i}} \\leqslant 2 \\sum_{i=1}^{p_{j}} 2(\\sqrt{i}-\\sqrt{i-1})=4 \\sqrt{p_{j}} .\n\\]\n\nTherefore, summing over \\(j=1, \\ldots, k\\) and using the QM-AM inequality, we obtain\n\\[\n\\sum_{\\ell=1}^{n} \\frac{a_{\\ell}}{\\sqrt{a_{1}^{2}+\\ldots+a_{\\ell}^{2}}} \\leqslant 4 \\sum_{j=1}^{k} \\sqrt{\\left|M_{j}\\right|} \\leqslant 4 \\sqrt{k \\sum_{j=1}^{k}\\left|M_{j}\\right|}=4 \\sqrt{k n} .\n\\]\n\nComment. Consider the function \\(f\\left(a_{1}, \\ldots, a_{n}\\right)=\\sum_{i=1}^{n} \\frac{a_{i}}{\\sqrt{a_{1}^{2}+\\ldots+a_{i}^{2}}}\\). One can see that rearranging the variables in increasing order can only increase the value of \\(f\\left(a_{1}, \\ldots, a_{n}\\right)\\). Indeed, if \\(a_{j}>a_{j+1}\\) for some index \\(j\\) then we have\n\\[\nf\\left(a_{1}, \\ldots, a_{j-1}, a_{j+1}, a_{j}, a_{j+2}, \\ldots, a_{n}\\right)-f\\left(a_{1}, \\ldots, a_{n}\\right)=\\frac{a}{S}+\\frac{b}{\\sqrt{S^{2}-a^{2}}}-\\frac{b}{S}-\\frac{a}{\\sqrt{S^{2}-b^{2}}}\n\\]\nwhere \\(a=a_{j}, b=a_{j+1}\\), and \\(S=\\sqrt{a_{1}^{2}+\\ldots+a_{j+1}^{2}}\\). The positivity of the last expression above follows from\n\\[\n\\frac{b}{\\sqrt{S^{2}-a^{2}}}-\\frac{b}{S}=\\frac{a^{2} b}{S \\sqrt{S^{2}-a^{2}} \\cdot\\left(S+\\sqrt{S^{2}-a^{2}}\\right)}>\\frac{a b^{2}}{S \\sqrt{S^{2}-b^{2}} \\cdot\\left(S+\\sqrt{S^{2}-b^{2}}\\right)}=\\frac{a}{\\sqrt{S^{2}-b^{2}}}-\\frac{a}{S} .\n\\]\n\nComment. If \\(k<n\\), the example \\(a_{m}:=2^{k(m-1) / n}\\) shows that the problem statement is sharp up to a multiplicative constant. For \\(k \\geqslant n\\) the trivial upper bound \\(n\\) becomes sharp up to a multiplicative constant.\n\nSolution 2. Apply induction on \\(n\\). The base \\(n \\leqslant 16\\) is clear: our sum does not exceed \\(n \\leqslant 4 \\sqrt{n k}\\). For the inductive step from \\(1, \\ldots, n-1\\) to \\(n \\geqslant 17\\) consider two similar cases.\nCase 1: \\(n=2 t\\).\nLet \\(x_{\\ell}=\\frac{a_{\\ell}}{\\sqrt{a_{1}^{2}+\\ldots+a_{\\ell}^{2}}}\\). We have\n\\[\n\\exp \\left(-x_{t+1}^{2}-\\ldots-x_{2 t}^{2}\\right) \\geqslant\\left(1-x_{t+1}^{2}\\right) \\ldots\\left(1-x_{2 t}^{2}\\right)=\\frac{a_{1}^{2}+\\ldots+a_{t}^{2}}{a_{1}^{2}+\\ldots+a_{2 t}^{2}} \\geqslant \\frac{1}{1+4^{k}},\n\\]\nwhere we used that the product is telescopic and then an estimate \\(a_{t+i} \\leqslant 2^{k} a_{i}\\) for \\(i=1, \\ldots, t\\). Therefore, \\(x_{t+1}^{2}+\\ldots+x_{2 t}^{2} \\leqslant \\log \\left(4^{k}+1\\right) \\leqslant 2 k\\), where log denotes the natural logarithm. This implies \\(x_{t+1}+\\ldots+x_{2 t} \\leqslant \\sqrt{2 k t}\\). Hence, using the inductive hypothesis for \\(n=t\\) we get\n\\[\n\\sum_{\\ell=1}^{2 t} x_{\\ell} \\leqslant 4 \\sqrt{k t}+\\sqrt{2 k t} \\leqslant 4 \\sqrt{2 k t} .\n\\]\n\nCase 2: \\(n=2 t+1\\).\nAnalogously, we get \\(x_{t+2}^{2}+\\ldots+x_{2 t+1}^{2} \\leqslant \\log \\left(4^{k}+1\\right) \\leqslant 2 k\\) and\n\\[\n\\sum_{\\ell=1}^{2 t+1} x_{\\ell} \\leqslant 4 \\sqrt{k(t+1)}+\\sqrt{2 k t} \\leqslant 4 \\sqrt{k(2 t+1)} .\n\\]\n\nThe last inequality is true for all \\(t \\geqslant 8\\) since\n\\[\n4 \\sqrt{2 t+1}-\\sqrt{2 t} \\geqslant 3 \\sqrt{2 t}=\\sqrt{18 t} \\geqslant \\sqrt{16 t+16}=4 \\sqrt{t+1} .\n\\]", "source_pdf": "imosl_2020.pdf", "notes": "fallback-regex"}
{"id": "IMOSL-2020-A8", "contest": "IMOSL", "year": "2020", "problem_number": "A8", "problem": "Let \\(\\mathbb{R}^{+}\\)be the set of positive real numbers. Determine all functions \\(f: \\mathbb{R}^{+} \\rightarrow \\mathbb{R}^{+}\\) such that, for all positive real numbers \\(x\\) and \\(y\\),\n\\[\nf(x+f(x y))+y=f(x) f(y)+1 .\n\\]\n(Ukraine)", "solution": "Answer: \\(f(x)=x+1\\).\n\n1. A straightforward check shows that \\(f(x)=x+1\\) satisfies (*). We divide the proof of the converse statement into a sequence of steps.\nStep 1: \\(f\\) is injective.\nPut \\(x=1\\) in (*) and rearrange the terms to get\n\\[\ny=f(1) f(y)+1-f(1+f(y))\n\\]\n\nTherefore, if \\(f\\left(y_{1}\\right)=f\\left(y_{2}\\right)\\), then \\(y_{1}=y_{2}\\).\nStep 2: \\(f\\) is (strictly) monotone increasing.\nFor any fixed \\(y \\in \\mathbb{R}^{+}\\), the function\n\\[\ng(x):=f(x+f(x y))=f(x) f(y)+1-y\n\\]\nis injective by Step 1. Therefore, \\(x_{1}+f\\left(x_{1} y\\right) \\neq x_{2}+f\\left(x_{2} y\\right)\\) for all \\(y, x_{1}, x_{2} \\in \\mathbb{R}^{+}\\)with \\(x_{1} \\neq x_{2}\\). Plugging in \\(z_{i}=x_{i} y\\), we arrive at\n\\[\n\\frac{z_{1}-z_{2}}{y} \\neq f\\left(z_{2}\\right)-f\\left(z_{1}\\right), \\quad \\text { or } \\quad \\frac{1}{y} \\neq \\frac{f\\left(z_{2}\\right)-f\\left(z_{1}\\right)}{z_{1}-z_{2}}\n\\]\nfor all \\(y, z_{1}, z_{2} \\in \\mathbb{R}^{+}\\)with \\(z_{1} \\neq z_{2}\\). This means that the right-hand side of the rightmost relation is always non-positive, i.e., \\(f\\) is monotone non-decreasing. Since \\(f\\) is injective, it is strictly monotone.\n\nStep 3: There exist constants \\(a\\) and \\(b\\) such that \\(f(y)=a y+b\\) for all \\(y \\in \\mathbb{R}^{+}\\).\nSince \\(f\\) is monotone and bounded from below by 0 , for each \\(x_{0} \\geqslant 0\\), there exists a right limit \\(\\lim _{x \\searrow x_{0}} f(x) \\geqslant 0\\). Put \\(p=\\lim _{x \\searrow 0} f(x)\\) and \\(q=\\lim _{x \\backslash p} f(x)\\).\n\nFix an arbitrary \\(y\\) and take the limit of (*) as \\(x \\searrow 0\\). We have \\(f(x y) \\searrow p\\) and hence \\(f(x+f(x y)) \\searrow q\\); therefore, we obtain\n\\[\nq+y=p f(y)+1, \\quad \\text { or } \\quad f(y)=\\frac{q+y-1}{p} .\n\\]\n(Notice that \\(p \\neq 0\\), otherwise \\(q+y=1\\) for all \\(y\\), which is absurd.) The claim is proved.\nStep 4: \\(f(x)=x+1\\) for all \\(x \\in \\mathbb{R}^{+}\\).\nBased on the previous step, write \\(f(x)=a x+b\\). Putting this relation into (*) we get\n\\[\na(x+a x y+b)+b+y=(a x+b)(a y+b)+1\n\\]\nwhich can be rewritten as\n\\[\n(a-a b) x+(1-a b) y+a b+b-b^{2}-1=0 \\quad \\text { for all } x, y \\in \\mathbb{R}^{+}\n\\]\n\nThis identity may hold only if all the coefficients are 0 , i.e.,\n\\[\na-a b=1-a b=a b+b-b^{2}-1=0\n\\]\n\nHence, \\(a=b=1\\).\n\nSolution 2. We provide another proof that \\(f(x)=x+1\\) is the only function satisfying (*).\nPut \\(a=f(1)\\). Define the function \\(\\phi: \\mathbb{R}^{+} \\rightarrow \\mathbb{R}\\) by\n\\[\n\\phi(x)=f(x)-x-1 .\n\\]\n\nThen equation (*) reads as\n\\[\n\\phi(x+f(x y))=f(x) f(y)-f(x y)-x-y .\n\\]\n\nSince the right-hand side of (1) is symmetric under swapping \\(x\\) and \\(y\\), we obtain\n\\[\n\\phi(x+f(x y))=\\phi(y+f(x y)) .\n\\]\n\nIn particular, substituting \\((x, y)=(t, 1 / t)\\) we get\n\\[\n\\phi(a+t)=\\phi\\left(a+\\frac{1}{t}\\right), \\quad t \\in \\mathbb{R}^{+} .\n\\]\n\nNotice that the function \\(f\\) is bounded from below by a positive constant. Indeed, for each \\(y \\in \\mathbb{R}^{+}\\), the relation (*) yields \\(f(x) f(y)>y-1\\), hence\n\\[\nf(x)>\\frac{y-1}{f(y)} \\quad \\text { for all } x \\in \\mathbb{R}^{+} .\n\\]\n\nIf \\(y>1\\), this provides a desired positive lower bound for \\(f(x)\\).\nNow, let \\(M=\\inf _{x \\in \\mathbb{R}^{+}} f(x)>0\\). Then, for all \\(y \\in \\mathbb{R}^{+}\\),\n\\[\nM \\geqslant \\frac{y-1}{f(y)}, \\quad \\text { or } \\quad f(y) \\geqslant \\frac{y-1}{M} .\n\\]\n\nLemma 1. The function \\(f(x)\\) (and hence \\(\\phi(x)\\) ) is bounded on any segment \\([p, q]\\), where \\(0<p<q<+\\infty\\).\nProof. \\(f\\) is bounded from below by \\(M\\). It remains to show that \\(f\\) is bounded from above on \\([p, q]\\). Substituting \\(y=1\\) into (*), we get\n\\[\nf(x+f(x))=a f(x) .\n\\]\n\nTake \\(z \\in[p, q]\\) and put \\(s=f(z)\\). By (4), we have\n\\[\nf(z+s)=a s \\quad \\text { and } \\quad f(z+s+a s)=f(z+s+f(z+s))=a^{2} s .\n\\]\n\nPlugging in \\((x, y)=\\left(z, 1+\\frac{s}{z}\\right)\\) to \\((*)\\) and using (3), we obtain\n\\[\nf(z+a s)=f(z+f(z+s))=s f\\left(1+\\frac{s}{z}\\right)-\\frac{s}{z} \\geqslant \\frac{s^{2}}{M z}-\\frac{s}{z} .\n\\]\n\nNow, substituting \\((x, y)=\\left(z+a s, \\frac{z}{z+a s}\\right)\\) to \\((*)\\) and applying the above estimate and the estimate \\(f(y) \\geqslant M\\), we obtain\n\\[\n\\begin{aligned}\na^{2} s=f(z+s+a s)=f(z+a s+f(z))=f(z+a s) & f\\left(\\frac{z}{z+a s}\\right)+1-\\frac{z}{z+a s} \\\\\n& \\geqslant M f(z+a s) \\geqslant \\frac{s^{2}}{z}-\\frac{M s}{z} \\geqslant \\frac{s^{2}}{q}-\\frac{M s}{p} .\n\\end{aligned}\n\\]\n\nThis yields \\(s \\leqslant q\\left(\\frac{M}{p}+a^{2}\\right)=: L\\), and \\(f\\) is bounded from above by \\(L\\) on \\([p, q]\\).\n\nApplying Lemma 1 to the segment \\([a, a+1]\\), we see that \\(\\phi\\) is bounded on it. By (2) we get that \\(\\phi\\) is also bounded on \\([a+1,+\\infty)\\), and hence on \\([a,+\\infty)\\). Put \\(C=\\max \\{a, 3\\}\\).\nLemma 2. For all \\(x \\geqslant C\\), we have \\(\\phi(x)=0\\) (and hence \\(f(x)=x+1\\) ).\nProof. Substituting \\(y=x\\) to (1), we obtain\n\\[\n\\phi\\left(x+f\\left(x^{2}\\right)\\right)=f(x)^{2}-f\\left(x^{2}\\right)-2 x\n\\]\nhence,\n\\[\n\\phi\\left(x+f\\left(x^{2}\\right)\\right)+\\phi\\left(x^{2}\\right)=f(x)^{2}-(x+1)^{2}=\\phi(x)(f(x)+x+1) .\n\\]\n\nSince \\(f(x)+x+1 \\geqslant C+1 \\geqslant 4\\), we obtain that\n\\[\n|\\phi(x)| \\leqslant \\frac{1}{4}\\left(\\left|\\phi\\left(x+f\\left(x^{2}\\right)\\right)\\right|+\\left|\\phi\\left(x^{2}\\right)\\right|\\right) .\n\\]\n\nSince \\(C \\geqslant a\\), there exists a finite supremum \\(S=\\sup _{x \\geqslant C}|\\phi(x)|\\). For each \\(x \\in[C,+\\infty)\\), both \\(x+f\\left(x^{2}\\right)\\) and \\(x^{2}\\) are greater than \\(x\\); hence they also lie in \\([C,+\\infty)\\). Therefore, taking the supremum of the left-hand side of (6) over \\(x \\in[C,+\\infty)\\), we obtain \\(S \\leqslant S / 2\\) and hence \\(S=0\\). Thus, \\(\\phi(x)=0\\) for all \\(x \\geqslant C\\).\n\nIt remains to show that \\(f(y)=y+1\\) when \\(0<y<C\\). For each \\(y\\), choose \\(x>\\max \\left\\{C, \\frac{C}{y}\\right\\}\\). Then all three numbers \\(x, x y\\), and \\(x+f(x y)\\) are greater than \\(C\\), so (*) reads as\n\\[\n(x+x y+1)+1+y=(x+1) f(y)+1, \\quad \\text { hence } \\quad f(y)=y+1\n\\]\n\nComment 1. It may be useful to rewrite (*) in the form\n\\[\n\\phi(x+f(x y))+\\phi(x y)=\\phi(x) \\phi(y)+x \\phi(y)+y \\phi(x)+\\phi(x)+\\phi(y) .\n\\]\n\nThis general identity easily implies both (1) and (5).\nComment 2. There are other ways to prove that \\(f(x) \\geqslant x+1\\). Once one has proved this, they can use this stronger estimate instead of (3) in the proof of Lemma 1. Nevertheless, this does not make this proof simpler. So proving that \\(f(x) \\geqslant x+1\\) does not seem to be a serious progress towards the solution of the problem. In what follows, we outline one possible proof of this inequality.\n\nFirst of all, we improve inequality (3) by noticing that, in fact, \\(f(x) f(y) \\geqslant y-1+M\\), and hence\n\\[\nf(y) \\geqslant \\frac{y-1}{M}+1\n\\]\n\nNow we divide the argument into two steps.\nStep 1: We show that \\(M \\leqslant 1\\).\nSuppose that \\(M>1\\); recall the notation \\(a=f(1)\\). Substituting \\(y=1 / x\\) in (*), we get\n\\[\nf(x+a)=f(x) f\\left(\\frac{1}{x}\\right)+1-\\frac{1}{x} \\geqslant M f(x)\n\\]\nprovided that \\(x \\geqslant 1\\). By a straightforward induction on \\(\\lceil(x-1) / a\\rceil\\), this yields\n\\[\nf(x) \\geqslant M^{(x-1) / a}\n\\]\n\nNow choose an arbitrary \\(x_{0} \\in \\mathbb{R}^{+}\\)and define a sequence \\(x_{0}, x_{1}, \\ldots\\) by \\(x_{n+1}=x_{n}+f\\left(x_{n}\\right) \\geqslant x_{n}+M\\) for all \\(n \\geqslant 0\\); notice that the sequence is unbounded. On the other hand, by (4) we get\n\\[\na x_{n+1}>a f\\left(x_{n}\\right)=f\\left(x_{n+1}\\right) \\geqslant M^{\\left(x_{n+1}-1\\right) / a},\n\\]\nwhich cannot hold when \\(x_{n+1}\\) is large enough.\n\nStep 2: We prove that \\(f(y) \\geqslant y+1\\) for all \\(y \\in \\mathbb{R}^{+}\\).\nArguing indirectly, choose \\(y \\in \\mathbb{R}^{+}\\)such that \\(f(y)<y+1\\), and choose \\(\\mu\\) with \\(f(y)<\\mu<y+1\\). Define a sequence \\(x_{0}, x_{1}, \\ldots\\) by choosing a large \\(x_{0} \\geqslant 1\\) and setting \\(x_{n+1}=x_{n}+f\\left(x_{n} y\\right) \\geqslant x_{n}+M\\) for all \\(n \\geqslant 0\\) (this sequence is also unbounded). If \\(x_{0}\\) is large enough, then (7) implies that \\((\\mu-f(y)) f\\left(x_{n}\\right) \\geqslant 1-y\\) for all \\(n\\). Therefore,\n\\[\nf\\left(x_{n+1}\\right)=f(y) f\\left(x_{n}\\right)+1-y \\leqslant \\mu f\\left(x_{n}\\right) .\n\\]\n\nOn the other hand, since \\(M \\leqslant 1\\), inequality ( 7 ) implies that \\(f(z) \\geqslant z\\), provided that \\(z \\geqslant 1\\). Hence, if \\(x_{0}\\) is large enough, we have \\(x_{n+1} \\geqslant x_{n}(1+y)\\) for all \\(n\\). Therefore,\n\\[\nx_{0}(1+y)^{n} \\leqslant x_{n} \\leqslant f\\left(x_{n}\\right) \\leqslant \\mu^{n} f\\left(x_{0}\\right),\n\\]\nwhich cannot hold when \\(n\\) is large enough.\n\n\\section*{Combinatorics}", "source_pdf": "imosl_2020.pdf", "notes": "fallback-regex"}
{"id": "IMOSL-2020-C1", "contest": "IMOSL", "year": "2020", "problem_number": "C1", "problem": "Let \\(n\\) be a positive integer. Find the number of permutations \\(a_{1}, a_{2}, \\ldots, a_{n}\\) of the sequence \\(1,2, \\ldots, n\\) satisfying\n\\[\na_{1} \\leqslant 2 a_{2} \\leqslant 3 a_{3} \\leqslant \\ldots \\leqslant n a_{n}\n\\]\n(United Kingdom)", "solution": "Answer: The number of such permutations is \\(F_{n+1}\\), where \\(F_{k}\\) is the \\(k^{\\text {th }}\\) Fibonacci number: \\(F_{1}=F_{2}=1, F_{n+1}=F_{n}+F_{n-1}\\).\n\n1. Denote by \\(P_{n}\\) the number of permutations that satisfy (*). It is easy to see that \\(P_{1}=1\\) and \\(P_{2}=2\\).\nLemma 1. Let \\(n \\geqslant 3\\). If a permutation \\(a_{1}, \\ldots, a_{n}\\) satisfies ( \\(*\\) ) then either \\(a_{n}=n\\), or \\(a_{n-1}=n\\) and \\(a_{n}=n-1\\).\nProof. Let \\(k\\) be the index for which \\(a_{k}=n\\). If \\(k=n\\) then we are done.\nIf \\(k=n-1\\) then, by \\((*)\\), we have \\(n(n-1)=(n-1) a_{n-1} \\leqslant n a_{n}\\), so \\(a_{n} \\geqslant n-1\\). Since \\(a_{n} \\neq a_{n-1}=n\\), the only choice for \\(a_{n}\\) is \\(a_{n}=n-1\\).\n\nNow suppose that \\(k \\leqslant n-2\\). For every \\(k<i<n\\) we have \\(k n=k a_{k} \\leqslant i a_{i}<n a_{i}\\), so \\(a_{i} \\geqslant k+1\\). Moreover, \\(n a_{n} \\geqslant(n-1) a_{n-1} \\geqslant(n-1)(k+1)=n k+(n-1-k)>n k\\), so \\(a_{n} \\geqslant k+1\\). Now the \\(n-k+1\\) numbers \\(a_{k}, a_{k+1}, \\ldots, a_{n}\\) are all greater than \\(k\\); but there are only \\(n-k\\) such values; this is not possible.\n\nIf \\(a_{n}=n\\) then \\(a_{1}, a_{2}, \\ldots, a_{n-1}\\) must be a permutation of the numbers \\(1, \\ldots, n-1\\) satisfying \\(a_{1} \\leqslant 2 a_{2} \\leqslant \\ldots \\leqslant(n-1) a_{n-1}\\); there are \\(P_{n-1}\\) such permutations. The last inequality in (*), ( \\(n-1) a_{n-1} \\leqslant n a_{n}=n^{2}\\), holds true automatically.\n\nIf \\(\\left(a_{n-1}, a_{n}\\right)=(n, n-1)\\), then \\(a_{1}, \\ldots, a_{n-2}\\) must be a permutation of \\(1, \\ldots, n-2\\) satisfying \\(a_{1} \\leqslant \\ldots \\leqslant(n-2) a_{n-2}\\); there are \\(P_{n-2}\\) such permutations. The last two inequalities in (*) hold true automatically by \\((n-2) a_{n-2} \\leqslant(n-2)^{2}<n(n-1)=(n-1) a_{n-1}=n a_{n}\\).\n\nHence, the sequence ( \\(P_{1}, P_{2}, \\ldots\\) ) satisfies the recurrence relation \\(P_{n}=P_{n-1}+P_{n-2}\\) for \\(n \\geqslant 3\\). The first two elements are \\(P_{1}=F_{2}\\) and \\(P_{2}=F_{3}\\), so by a trivial induction we have \\(P_{n}=F_{n+1}\\).\n\nSolution 2. We claim that all sought permutations are of the following kind. Split \\(\\{1,2, \\ldots, n\\}\\) into singletons and pairs of adjacent numbers. In each pair, swap the two numbers and keep the singletons unchanged.\n\nSuch permutations correspond to tilings of a \\(1 \\times n\\) chessboard using dominoes and unit squares; it is well-known that the number of such tilings is the Fibonacci number \\(F_{n+1}\\).\n\nThe claim follows by induction from\nLemma 2. Assume that \\(a_{1}, \\ldots, a_{n}\\) is a permutation satisfying (*), and \\(k\\) is an integer such that \\(1 \\leqslant k \\leqslant n\\) and \\(\\left\\{a_{1}, a_{2}, \\ldots, a_{k-1}\\right\\}=\\{1,2, \\ldots, k-1\\}\\). (If \\(k=1\\), the condition is empty.) Then either \\(a_{k}=k\\), or \\(a_{k}=k+1\\) and \\(a_{k+1}=k\\).\nProof. Choose \\(t\\) with \\(a_{t}=k\\). Since \\(k \\notin\\left\\{a_{1}, \\ldots, a_{k-1}\\right\\}\\), we have either \\(t=k\\) or \\(t>k\\). If \\(t=k\\) then we are done, so assume \\(t>k\\).\n\nNotice that one of the numbers among the \\(t-k\\) numbers \\(a_{k}, a_{k+1}, \\ldots, a_{t-1}\\) is at least \\(t\\), because there are only \\(t-k-1\\) values between \\(k\\) and \\(t\\). Let \\(i\\) be an index with \\(k \\leqslant i<t\\) and \\(a_{i} \\geqslant t\\); then \\(k t=t a_{t} \\geqslant i a_{i} \\geqslant i t \\geqslant k t\\), so that all the inequalities turn into equalities, hence \\(i=k\\) and \\(a_{k}=t\\). If \\(t=k+1\\), we are done.\n\nSuppose that \\(t>k+1\\). Then the chain of inequalities \\(k t=k a_{k} \\leqslant \\ldots \\leqslant t a_{t}=k t\\) should also turn into a chain of equalities. From this point we can find contradictions in several ways; for example by pointing to \\(a_{t-1}=\\frac{k t}{t-1}=k+\\frac{k}{t-1}\\) which cannot be an integer, or considering\nthe product of the numbers \\((k+1) a_{k+1}, \\ldots,(t-1) a_{t-1}\\); the numbers \\(a_{k+1}, \\ldots, a_{t-1}\\) are distinct and greater than \\(k\\), so\n\\[\n(k t)^{t-k-1}=(k+1) a_{k+1} \\cdot(k+2) a_{k+2} \\cdot \\ldots \\cdot(t-1) a_{t-1} \\geqslant((k+1)(k+2) \\cdot \\ldots \\cdot(t-1))^{2} .\n\\]\n\nNotice that \\((k+i)(t-i)=k t+i(t-k-i)>k t\\) for \\(1 \\leqslant i<t-k\\). This leads to the contradiction\n\\[\n(k t)^{t-k-1} \\geqslant((k+1)(k+2) \\cdot \\ldots \\cdot(t-1))^{2}=\\prod_{i=1}^{t-k-1}(k+i)(t-i)>(k t)^{t-k-1} .\n\\]\n\nTherefore, the case \\(t>k+1\\) is not possible.", "source_pdf": "imosl_2020.pdf", "notes": "fallback-regex"}
{"id": "IMOSL-2020-C2", "contest": "IMOSL", "year": "2020", "problem_number": "C2", "problem": "In a regular 100-gon, 41 vertices are colored black and the remaining 59 vertices are colored white. Prove that there exist 24 convex quadrilaterals \\(Q_{1}, \\ldots, Q_{24}\\) whose corners are vertices of the 100-gon, so that\n- the quadrilaterals \\(Q_{1}, \\ldots, Q_{24}\\) are pairwise disjoint, and\n- every quadrilateral \\(Q_{i}\\) has three corners of one color and one corner of the other color.\n(Austria)", "solution": ". Call a quadrilateral skew-colored, if it has three corners of one color and one corner of the other color. We will prove the following\nClaim. If the vertices of a convex ( \\(4 k+1\\) )-gon \\(P\\) are colored black and white such that each color is used at least \\(k\\) times, then there exist \\(k\\) pairwise disjoint skew-colored quadrilaterals whose vertices are vertices of \\(P\\). (One vertex of \\(P\\) remains unused.)\n\nThe problem statement follows by removing 3 arbitrary vertices of the 100-gon and applying the Claim to the remaining 97 vertices with \\(k=24\\).\nProof of the Claim. We prove by induction. For \\(k=1\\) we have a pentagon with at least one black and at least one white vertex. If the number of black vertices is even then remove a black vertex; otherwise remove a white vertex. In the remaining quadrilateral, there are an odd number of black and an odd number of white vertices, so the quadrilateral is skew-colored.\n\nFor the induction step, assume \\(k \\geqslant 2\\). Let \\(b\\) and \\(w\\) be the numbers of black and white vertices, respectively; then \\(b, w \\geqslant k\\) and \\(b+w=4 k+1\\). Without loss of generality we may assume \\(w \\geqslant b\\), so \\(k \\leqslant b \\leqslant 2 k\\) and \\(2 k+1 \\leqslant w \\leqslant 3 k+1\\).\n\nWe want to find four consecutive vertices such that three of them are white, the fourth one is black. Denote the vertices by \\(V_{1}, V_{2}, \\ldots, V_{4 k+1}\\) in counterclockwise order, such that \\(V_{4 k+1}\\) is black, and consider the following \\(k\\) groups of vertices:\n\\[\n\\left(V_{1}, V_{2}, V_{3}, V_{4}\\right),\\left(V_{5}, V_{6}, V_{7}, V_{8}\\right), \\ldots,\\left(V_{4 k-3}, V_{4 k-2}, V_{4 k-1}, V_{4 k}\\right)\n\\]\n\nIn these groups there are \\(w\\) white and \\(b-1\\) black vertices. Since \\(w>b-1\\), there is a group, \\(\\left(V_{i}, V_{i+1}, V_{i+2}, V_{i+3}\\right)\\) that contains more white than black vertices. If three are white and one is black in that group, we are done. Otherwise, if \\(V_{i}, V_{i+1}, V_{i+2}, V_{i+3}\\) are all white then let \\(V_{j}\\) be the first black vertex among \\(V_{i+4}, \\ldots, V_{4 k+1}\\) (recall that \\(V_{4 k+1}\\) is black); then \\(V_{j-3}, V_{j-2}\\) and \\(V_{j-1}\\) are white and \\(V_{j}\\) is black.\n\nNow we have four consecutive vertices \\(V_{i}, V_{i+1}, V_{i+2}, V_{i+3}\\) that form a skew-colored quadrilateral. The remaining vertices form a convex ( \\(4 k-3\\) )-gon; \\(w-3\\) of them are white and \\(b-1\\) are black. Since \\(b-1 \\geqslant k-1\\) and \\(w-3 \\geqslant(2 k+1)-3>k-1\\), we can apply the Claim with \\(k-1\\).\n\nComment. It is not true that the vertices of the 100 -gon can be split into 25 skew-colored quadrilaterals. A possible counter-example is when the vertices \\(V_{1}, V_{3}, V_{5}, \\ldots, V_{81}\\) are black and the other vertices, \\(V_{2}, V_{4}, \\ldots, V_{80}\\) and \\(V_{82}, V_{83}, \\ldots, V_{100}\\) are white. For having 25 skew-colored quadrilaterals, there should be 8 containing three black vertices. But such a quadrilateral splits the other 96 vertices into four sets in such a way that at least two sets contain odd numbers of vertices and therefore they cannot be grouped into disjoint quadrilaterals.\n![](https://cdn.mathpix.com/cropped/2025_08_23_b01e523c913a1e72c2d0g-34.jpg?height=304&width=543&top_left_y=2478&top_left_x=762)", "source_pdf": "imosl_2020.pdf", "notes": "fallback-regex"}
{"id": "IMOSL-2020-C4", "contest": "IMOSL", "year": "2020", "problem_number": "C4", "problem": "The Fibonacci numbers \\(F_{0}, F_{1}, F_{2}, \\ldots\\) are defined inductively by \\(F_{0}=0, F_{1}=1\\), and \\(F_{n+1}=F_{n}+F_{n-1}\\) for \\(n \\geqslant 1\\). Given an integer \\(n \\geqslant 2\\), determine the smallest size of a set \\(S\\) of integers such that for every \\(k=2,3, \\ldots, n\\) there exist some \\(x, y \\in S\\) such that \\(x-y=F_{k}\\).\n(Croatia)", "solution": "Answer: \\(\\lceil n / 2\\rceil+1\\).\n\n. First we show that if a set \\(S \\subset \\mathbb{Z}\\) satisfies the conditions then \\(|S| \\geqslant \\frac{n}{2}+1\\).\nLet \\(d=\\lceil n / 2\\rceil\\), so \\(n \\leqslant 2 d \\leqslant n+1\\). In order to prove that \\(|S| \\geqslant d+1\\), construct a graph as follows. Let the vertices of the graph be the elements of \\(S\\). For each \\(1 \\leqslant k \\leqslant d\\), choose two elements \\(x, y \\in S\\) such that \\(x-y=F_{2 k-1}\\), and add the pair ( \\(x, y\\) ) to the graph as edge. (Note that by the problem's constraints, there must be a pair ( \\(x, y\\) ) with \\(x-y=F_{2 k-1}\\) for every \\(3 \\leqslant 2 k-1 \\leqslant 2 d-1 \\leqslant n\\); moreover, due to \\(F_{1}=F_{2}\\) we have a pair with \\(x-y=F_{1}\\) as well.) We will say that the length of the edge \\((x, y)\\) is \\(|x-y|\\).\n\nWe claim that the graph contains no cycle. For the sake of contradiction, suppose that the graph contains a cycle ( \\(x_{1}, \\ldots, x_{\\ell}\\) ), and let the longest edge in the cycle be ( \\(x_{1}, x_{\\ell}\\) ) with length \\(F_{2 m+1}\\). The other edges \\(\\left(x_{1}, x_{2}\\right), \\ldots,\\left(x_{\\ell-1}, x_{\\ell}\\right)\\) in the cycle are shorter than \\(F_{2 m+1}\\) and distinct, their lengths form a subset of \\(\\left\\{F_{1}, F_{3}, \\ldots, F_{2 m-1}\\right\\}\\). But this is not possible because\n\\[\n\\begin{aligned}\nF_{2 m+1} & =\\left|x_{\\ell}-x_{1}\\right| \\leqslant \\sum_{i=1}^{\\ell-1}\\left|x_{i+1}-x_{i}\\right| \\leqslant F_{1}+F_{3}+F_{5}+\\ldots+F_{2 m-1} \\\\\n& =F_{2}+\\left(F_{4}-F_{2}\\right)+\\left(F_{6}-F_{4}\\right)+\\ldots+\\left(F_{2 m}-F_{2 m-2}\\right)=F_{2 m}<F_{2 m+1}\n\\end{aligned}\n\\]\n\nHence, the graph has \\(d\\) edges and cannot contain a cycle, therefore it must contain at least \\(d+1\\) vertices, so \\(|S| \\geqslant d+1\\).\n\nNow we show a suitable set with \\(d+1\\) elements. Let\n\\[\nS=\\left\\{F_{0}, F_{2}, F_{4}, F_{5}, \\ldots, F_{2 d}\\right\\}\n\\]\n\nFor \\(1 \\leqslant k \\leqslant d\\) we have \\(F_{0}, F_{2 k-2}, F_{2 k} \\in S\\) with differences \\(F_{2 k}-F_{2 k-2}=F_{2 k-1}\\) and \\(F_{2 k}-F_{0}=F_{2 k}\\), so each of \\(F_{1}, F_{2}, \\ldots, F_{2 d}\\) occurs as difference between two elements in \\(S\\). So this set containing \\(d+1\\) numbers is suitable.", "source_pdf": "imosl_2020.pdf", "notes": "fallback-regex"}
{"id": "IMOSL-2020-C5", "contest": "IMOSL", "year": "2020", "problem_number": "C5", "problem": "Let \\(p\\) be an odd prime, and put \\(N=\\frac{1}{4}\\left(p^{3}-p\\right)-1\\). The numbers \\(1,2, \\ldots, N\\) are painted arbitrarily in two colors, red and blue. For any positive integer \\(n \\leqslant N\\), denote by \\(r(n)\\) the fraction of integers in \\(\\{1,2, \\ldots, n\\}\\) that are red.\n\nProve that there exists a positive integer \\(a \\in\\{1,2, \\ldots, p-1\\}\\) such that \\(r(n) \\neq a / p\\) for all \\(n=1,2, \\ldots, N\\).\n(Netherlands)", "solution": ". Denote by \\(R(n)\\) the number of red numbers in \\(\\{1,2, \\ldots, n\\}\\), i.e., \\(R(n)=n r(n)\\). Similarly, denote by \\(B(n)\\) and \\(b(n)=B(n) / n\\) the number and proportion of blue numbers in \\(\\{1,2, \\ldots, n\\}\\), respectively. Notice that \\(B(n)+R(n)=n\\) and \\(b(n)+r(n)=1\\). Therefore, the statement of the problem does not change after swapping the colors.\n\nArguing indirectly, for every \\(a \\in\\{1,2, \\ldots, p-1\\}\\) choose some positive integer \\(n_{a}\\) such that \\(r\\left(n_{a}\\right)=a / p\\) and, hence, \\(R\\left(n_{a}\\right)=a n_{a} / p\\). Clearly, \\(p \\mid n_{a}\\), so that \\(n_{a}=p m_{a}\\) for some positive integer \\(m_{a}\\), and \\(R\\left(n_{a}\\right)=a m_{a}\\). Without loss of generality, we assume that \\(m_{1}<m_{p-1}\\), as otherwise one may swap the colors. Notice that\n\\[\nm_{a} \\leqslant \\frac{N}{p}<\\frac{p^{2}-1}{4} \\quad \\text { for all } a=1,2, \\ldots, p-1\n\\]\n\nThe solution is based on a repeated application of the following simple observation. Claim. Assume that \\(m_{a}<m_{b}\\) for some \\(a, b \\in\\{1,2, \\ldots, p-1\\}\\). Then\n\\[\nm_{b} \\geqslant \\frac{a}{b} m_{a} \\quad \\text { and } \\quad m_{b} \\geqslant \\frac{p-a}{p-b} m_{a}\n\\]\n\nProof. The first inequality follows from \\(b m_{b}=R\\left(n_{b}\\right) \\geqslant R\\left(n_{a}\\right)=a m_{a}\\). The second inequality is obtained by swapping colors .\n\nLet \\(q=(p-1) / 2\\). We distinguish two cases.\nCase 1: All \\(q\\) numbers \\(m_{1}, m_{2}, \\ldots, m_{q}\\) are smaller than \\(m_{p-1}\\).\nLet \\(m_{a}\\) be the maximal number among \\(m_{1}, m_{2}, \\ldots, m_{q}\\); then \\(m_{a} \\geqslant q \\geqslant a\\). Applying the Claim, we get\n\\[\nm_{p-1} \\geqslant \\frac{p-a}{p-(p-1)} m_{a} \\geqslant(p-q) q=\\frac{p^{2}-1}{4}\n\\]\nwhich contradicts (1).\nCase 2: There exists \\(k \\leqslant q\\) such that \\(m_{k}>m_{p-1}\\).\nChoose \\(k\\) to be the smallest index satisfying \\(m_{k}>m_{p-1}\\); by our assumptions, we have \\(1<k \\leqslant q<p-1\\).\n\nLet \\(m_{a}\\) be the maximal number among \\(m_{1}, m_{2}, \\ldots, m_{k-1}\\); then \\(a \\leqslant k-1 \\leqslant m_{a}<m_{p-1}\\). Applying the Claim, we get\n\\[\n\\begin{aligned}\nm_{k} \\geqslant \\frac{p-1}{k} m_{p-1} \\geqslant \\frac{p-1}{k} & \\cdot \\frac{p-a}{p-(p-1)} m_{a} \\\\\n& \\geqslant \\frac{p-1}{k} \\cdot(p-k+1)(k-1) \\geqslant \\frac{k-1}{k} \\cdot(p-1)(p-q) \\geqslant \\frac{1}{2} \\cdot \\frac{p^{2}-1}{2}\n\\end{aligned}\n\\]\nwhich contradicts (1) again.\nComment 1. The argument in Case 2, after a slight modification of estimates at the end, applies as soon as there exists \\(k<\\frac{3(p+1)}{4}\\) with \\(a_{k}<a_{p-1}\\). However, this argument does not seem to work if there is no such \\(k\\).\n\nComment 2. If \\(p\\) is small enough, then one can color \\(\\{1,2, \\ldots, N+1\\}\\) so that there exist numbers \\(m_{1}\\), \\(m_{2}, \\ldots, m_{p-1}\\) satisfying \\(r\\left(p m_{a}\\right)=a / p\\). For \\(p=3,5,7\\), one can find colorings providing the following sequences:\n\\[\n\\left(m_{1}, m_{2}\\right)=(1,2), \\quad\\left(m_{1}, m_{2}, m_{3}, m_{4}\\right)=(1,2,3,6), \\quad \\text { and } \\quad\\left(m_{1}, \\ldots, m_{6}\\right)=(1,2,3,4,6,12),\n\\]\nrespectively.\nThus, for small values of \\(p\\), the number \\(N\\) in the problem statement cannot be increased. However, a careful analysis of the estimates shows that this number can be slightly increased for \\(p \\geqslant 11\\).", "source_pdf": "imosl_2020.pdf", "notes": "fallback-regex"}
{"id": "IMOSL-2020-C7", "contest": "IMOSL", "year": "2020", "problem_number": "C7", "problem": "Consider any rectangular table having finitely many rows and columns, with a real number \\(a(r, c)\\) in the cell in row \\(r\\) and column \\(c\\). A pair ( \\(R, C\\) ), where \\(R\\) is a set of rows and \\(C\\) a set of columns, is called a saddle pair if the following two conditions are satisfied:\n(i) For each row \\(r^{\\prime}\\), there is \\(r \\in R\\) such that \\(a(r, c) \\geqslant a\\left(r^{\\prime}, c\\right)\\) for all \\(c \\in C\\);\n(ii) For each column \\(c^{\\prime}\\), there is \\(c \\in C\\) such that \\(a(r, c) \\leqslant a\\left(r, c^{\\prime}\\right)\\) for all \\(r \\in R\\).\n\nA saddle pair ( \\(R, C\\) ) is called a minimal pair if for each saddle pair ( \\(R^{\\prime}, C^{\\prime}\\) ) with \\(R^{\\prime} \\subseteq R\\) and \\(C^{\\prime} \\subseteq C\\), we have \\(R^{\\prime}=R\\) and \\(C^{\\prime}=C\\).\n\nProve that any two minimal pairs contain the same number of rows.\n(Thailand)", "solution": "1. We say that a pair ( \\(R^{\\prime}, C^{\\prime}\\) ) of nonempty sets is a subpair of a pair ( \\(R, C\\) ) if \\(R^{\\prime} \\subseteq R\\) and \\(C^{\\prime} \\subseteq C\\). The subpair is proper if at least one of the inclusions is strict.\n\nLet ( \\(R_{1}, C_{1}\\) ) and ( \\(R_{2}, C_{2}\\) ) be two saddle pairs with \\(\\left|R_{1}\\right|>\\left|R_{2}\\right|\\). We will find a saddle subpair ( \\(R^{\\prime}, C^{\\prime}\\) ) of ( \\(R_{1}, C_{1}\\) ) with \\(\\left|R^{\\prime}\\right| \\leqslant\\left|R_{2}\\right|\\); clearly, this implies the desired statement.\nStep 1: We construct maps \\(\\rho: R_{1} \\rightarrow R_{1}\\) and \\(\\sigma: C_{1} \\rightarrow C_{1}\\) such that \\(\\left|\\rho\\left(R_{1}\\right)\\right| \\leqslant\\left|R_{2}\\right|\\), and \\(a\\left(\\rho\\left(r_{1}\\right), c_{1}\\right) \\geqslant a\\left(r_{1}, \\sigma\\left(c_{1}\\right)\\right)\\) for all \\(r_{1} \\in R_{1}\\) and \\(c_{1} \\in C_{1}\\).\n\nSince ( \\(R_{1}, C_{1}\\) ) is a saddle pair, for each \\(r_{2} \\in R_{2}\\) there is \\(r_{1} \\in R_{1}\\) such that \\(a\\left(r_{1}, c_{1}\\right) \\geqslant a\\left(r_{2}, c_{1}\\right)\\) for all \\(c_{1} \\in C_{1}\\); denote one such an \\(r_{1}\\) by \\(\\rho_{1}\\left(r_{2}\\right)\\). Similarly, we define four functions\n\\[\n\\begin{array}{llllll}\n\\rho_{1}: R_{2} \\rightarrow R_{1} & \\text { such that } & a\\left(\\rho_{1}\\left(r_{2}\\right), c_{1}\\right) \\geqslant a\\left(r_{2}, c_{1}\\right) & \\text { for all } & r_{2} \\in R_{2}, & c_{1} \\in C_{1} ; \\\\\n\\rho_{2}: R_{1} \\rightarrow R_{2} & \\text { such that } & a\\left(\\rho_{2}\\left(r_{1}\\right), c_{2}\\right) \\geqslant a\\left(r_{1}, c_{2}\\right) & \\text { for all } & r_{1} \\in R_{1}, & c_{2} \\in C_{2} ; \\\\\n\\sigma_{1}: C_{2} \\rightarrow C_{1} & \\text { such that } & a\\left(r_{1}, \\sigma_{1}\\left(c_{2}\\right)\\right) \\leqslant a\\left(r_{1}, c_{2}\\right) & \\text { for all } & r_{1} \\in R_{1}, & c_{2} \\in C_{2} ; \\\\\n\\sigma_{2}: C_{1} \\rightarrow C_{2} & \\text { such that } & a\\left(r_{2}, \\sigma_{2}\\left(c_{1}\\right)\\right) \\leqslant a\\left(r_{2}, c_{1}\\right) & \\text { for all } & r_{2} \\in R_{2}, & c_{1} \\in C_{1} .\n\\end{array}\n\\]\n\nSet now \\(\\rho=\\rho_{1} \\circ \\rho_{2}: R_{1} \\rightarrow R_{1}\\) and \\(\\sigma=\\sigma_{1} \\circ \\sigma_{2}: C_{1} \\rightarrow C_{1}\\). We have\n\\[\n\\left|\\rho\\left(R_{1}\\right)\\right|=\\left|\\rho_{1}\\left(\\rho_{2}\\left(R_{1}\\right)\\right)\\right| \\leqslant\\left|\\rho_{1}\\left(R_{2}\\right)\\right| \\leqslant\\left|R_{2}\\right| .\n\\]\n\nMoreover, for all \\(r_{1} \\in R_{1}\\) and \\(c_{1} \\in C_{1}\\), we get\n\\[\n\\begin{aligned}\na\\left(\\rho\\left(r_{1}\\right), c_{1}\\right)=a\\left(\\rho_{1}\\left(\\rho_{2}\\left(r_{1}\\right)\\right), c_{1}\\right) \\geqslant a\\left(\\rho_{2}\\left(r_{1}\\right), c_{1}\\right) & \\geqslant a\\left(\\rho_{2}\\left(r_{1}\\right), \\sigma_{2}\\left(c_{1}\\right)\\right) \\\\\n& \\geqslant a\\left(r_{1}, \\sigma_{2}\\left(c_{1}\\right)\\right) \\geqslant a\\left(r_{1}, \\sigma_{1}\\left(\\sigma_{2}\\left(c_{1}\\right)\\right)\\right)=a\\left(r_{1}, \\sigma\\left(c_{1}\\right)\\right),\n\\end{aligned}\n\\]\nas desired.\nStep 2: Given maps \\(\\rho\\) and \\(\\sigma\\), we construct a proper saddle subpair ( \\(R^{\\prime}, C^{\\prime}\\) ) of ( \\(R_{1}, C_{1}\\) ).\nThe properties of \\(\\rho\\) and \\(\\sigma\\) yield that\n\\[\na\\left(\\rho^{i}\\left(r_{1}\\right), c_{1}\\right) \\geqslant a\\left(\\rho^{i-1}\\left(r_{1}\\right), \\sigma\\left(c_{1}\\right)\\right) \\geqslant \\ldots \\geqslant a\\left(r_{1}, \\sigma^{i}\\left(c_{1}\\right)\\right),\n\\]\nfor each positive integer \\(i\\) and all \\(r_{1} \\in R_{1}, c_{1} \\in C_{1}\\).\nConsider the images \\(R^{i}=\\rho^{i}\\left(R_{1}\\right)\\) and \\(C^{i}=\\sigma^{i}\\left(C_{1}\\right)\\). Clearly, \\(R_{1}=R^{0} \\supseteq R^{1} \\supseteq R^{2} \\supseteq \\ldots\\) and \\(C_{1}=C^{0} \\supseteq C^{1} \\supseteq C^{2} \\supseteq \\ldots\\). Since both chains consist of finite sets, there is an index \\(n\\) such that \\(R^{n}=R^{n+1}=\\ldots\\) and \\(C^{n}=C^{n+1}=\\ldots\\). Then \\(\\rho^{n}\\left(R^{n}\\right)=R^{2 n}=R^{n}\\), so \\(\\rho^{n}\\) restricted to \\(R^{n}\\) is a bijection. Similarly, \\(\\sigma^{n}\\) restricted to \\(C^{n}\\) is a bijection from \\(C^{n}\\) to itself. Therefore, there exists a positive integer \\(k\\) such that \\(\\rho^{n k}\\) acts identically on \\(R^{n}\\), and \\(\\sigma^{n k}\\) acts identically on \\(C^{n}\\).\n\nWe claim now that ( \\(R^{n}, C^{n}\\) ) is a saddle subpair of ( \\(R_{1}, C_{1}\\) ), with \\(\\left|R^{n}\\right| \\leqslant\\left|R^{1}\\right|=\\left|\\rho\\left(R_{1}\\right)\\right| \\leqslant \\left|R_{2}\\right|\\), which is what we needed. To check that this is a saddle pair, take any row \\(r^{\\prime}\\); since ( \\(R_{1}, C_{1}\\) ) is a saddle pair, there exists \\(r_{1} \\in R_{1}\\) such that \\(a\\left(r_{1}, c_{1}\\right) \\geqslant a\\left(r^{\\prime}, c_{1}\\right)\\) for all \\(c_{1} \\in C_{1}\\). Set now \\(r_{*}=\\rho^{n k}\\left(r_{1}\\right) \\in R^{n}\\). Then, for each \\(c \\in C^{n}\\) we have \\(c=\\sigma^{n k}(c)\\) and hence\n\\[\na\\left(r_{*}, c\\right)=a\\left(\\rho^{n k}\\left(r_{1}\\right), c\\right) \\geqslant a\\left(r_{1}, \\sigma^{n k}(c)\\right)=a\\left(r_{1}, c\\right) \\geqslant a\\left(r^{\\prime}, c\\right),\n\\]\nwhich establishes condition (i). Condition (ii) is checked similarly.\n\nSolution 2. Denote by \\(\\mathcal{R}\\) and \\(\\mathcal{C}\\) the set of all rows and the set of all columns of the table, respectively. Let \\(\\mathcal{T}\\) denote the given table; for a set \\(R\\) of rows and a set \\(C\\) of columns, let \\(\\mathcal{T}[R, C]\\) denote the subtable obtained by intersecting rows from \\(R\\) and columns from \\(C\\).\n\nWe say that row \\(r_{1}\\) exceeds row \\(r_{2}\\) in range of columns \\(C\\) (where \\(C \\subseteq \\mathcal{C}\\) ) and write \\(r_{1} \\geq_{C} r_{2}\\) or \\(r_{2} \\leq_{C} r_{1}\\), if \\(a\\left(r_{1}, c\\right) \\geqslant a\\left(r_{2}, c\\right)\\) for all \\(c \\in C\\). We say that a row \\(r_{1}\\) is equal to a row \\(r_{2}\\) in range of columns \\(C\\) and write \\(r_{1} \\equiv_{C} r_{2}\\), if \\(a\\left(r_{1}, c\\right)=a\\left(r_{2}, c\\right)\\) for all \\(c \\in C\\). We introduce similar notions, and use the same notation, for columns. Then conditions (i) and (ii) in the definition of a saddle pair can be written as (i) for each \\(r^{\\prime} \\in \\mathcal{R}\\) there exists \\(r \\in R\\) such that \\(r \\geq_{C} r^{\\prime}\\); and (ii) for each \\(c^{\\prime} \\in \\mathcal{C}\\) there exists \\(c \\in C\\) such that \\(c \\leq_{R} c^{\\prime}\\).\n\nLemma. Suppose that ( \\(R, C\\) ) is a minimal pair. Remove from the table several rows outside of \\(R\\) and/or several columns outside of \\(C\\). Then ( \\(R, C\\) ) remains a minimal pair in the new table.\nProof. Obviously, ( \\(R, C\\) ) remains a saddle pair. Suppose ( \\(R^{\\prime}, C^{\\prime}\\) ) is a proper subpair of ( \\(R, C\\) ). Since ( \\(R, C\\) ) is a saddle pair, for each row \\(r^{*}\\) of the initial table, there is a row \\(r \\in R\\) such that \\(r \\geq_{C} r^{*}\\). If ( \\(R^{\\prime}, C^{\\prime}\\) ) became saddle after deleting rows not in \\(R\\) and/or columns not in \\(C\\), there would be a row \\(r^{\\prime} \\in R^{\\prime}\\) satisfying \\(r^{\\prime} \\geq_{C^{\\prime}} r\\). Therefore, we would obtain that \\(r^{\\prime} \\geq_{C^{\\prime}} r^{*}\\), which is exactly condition (i) for the pair ( \\(R^{\\prime}, C^{\\prime}\\) ) in the initial table; condition (ii) is checked similarly. Thus, ( \\(R^{\\prime}, C^{\\prime}\\) ) was saddle in the initial table, which contradicts the hypothesis that ( \\(R, C\\) ) was minimal. Hence, ( \\(R, C\\) ) remains minimal after deleting rows and/or columns.\n\nBy the Lemma, it suffices to prove the statement of the problem in the case \\(\\mathcal{R}=R_{1} \\cup R_{2}\\) and \\(\\mathcal{C}=C_{1} \\cup C_{2}\\). Further, suppose that there exist rows that belong both to \\(R_{1}\\) and \\(R_{2}\\). Duplicate every such row, and refer one copy of it to the set \\(R_{1}\\), and the other copy to the set \\(R_{2}\\). Then ( \\(R_{1}, C_{1}\\) ) and ( \\(R_{2}, C_{2}\\) ) will remain minimal pairs in the new table, with the same numbers of rows and columns, but the sets \\(R_{1}\\) and \\(R_{2}\\) will become disjoint. Similarly duplicating columns in \\(C_{1} \\cap C_{2}\\), we make \\(C_{1}\\) and \\(C_{2}\\) disjoint. Thus it is sufficient to prove the required statement in the case \\(R_{1} \\cap R_{2}=\\varnothing\\) and \\(C_{1} \\cap C_{2}=\\varnothing\\).\n\nThe rest of the solution is devoted to the proof of the following claim including the statement of the problem.\nClaim. Suppose that ( \\(R_{1}, C_{1}\\) ) and ( \\(R_{2}, C_{2}\\) ) are minimal pairs in table \\(\\mathcal{T}\\) such that \\(R_{2}=\\mathcal{R} \\backslash R_{1}\\) and \\(C_{2}=\\mathcal{C} \\backslash C_{1}\\). Then \\(\\left|R_{1}\\right|=\\left|R_{2}\\right|,\\left|C_{1}\\right|=\\left|C_{2}\\right|\\); moreover, there are four bijections\n\\[\n\\begin{array}{lllll}\n\\rho_{1}: R_{2} \\rightarrow R_{1} & \\text { such that } & \\rho_{1}\\left(r_{2}\\right) \\equiv_{C_{1}} r_{2} & \\text { for all } & r_{2} \\in R_{2} ; \\\\\n\\rho_{2}: R_{1} \\rightarrow R_{2} & \\text { such that } & \\rho_{2}\\left(r_{1}\\right) \\equiv_{C_{2}} r_{1} & \\text { for all } & r_{1} \\in R_{1} ; \\\\\n\\sigma_{1}: C_{2} \\rightarrow C_{1} & \\text { such that } & \\sigma_{1}\\left(c_{2}\\right) \\equiv_{R_{1}} c_{2} & \\text { for all } & c_{2} \\in C_{2} ; \\\\\n\\sigma_{2}: C_{1} \\rightarrow C_{2} & \\text { such that } & \\sigma_{2}\\left(c_{1}\\right) \\equiv_{R_{2}} c_{1} & \\text { for all } & c_{1} \\in C_{1} .\n\\end{array}\n\\]\n\nWe prove the Claim by induction on \\(|\\mathcal{R}|+|\\mathcal{C}|\\). In the base case we have \\(\\left|R_{1}\\right|=\\left|R_{2}\\right|= \\left|C_{1}\\right|=\\left|C_{2}\\right|=1\\); let \\(R_{i}=\\left\\{r_{i}\\right\\}\\) and \\(C_{i}=\\left\\{c_{i}\\right\\}\\). Since ( \\(R_{1}, C_{1}\\) ) and ( \\(R_{2}, C_{2}\\) ) are saddle pairs, we have \\(a\\left(r_{1}, c_{1}\\right) \\geqslant a\\left(r_{2}, c_{1}\\right) \\geqslant a\\left(r_{2}, c_{2}\\right) \\geqslant a\\left(r_{1}, c_{2}\\right) \\geqslant a\\left(r_{1}, c_{1}\\right)\\), hence, the table consists of four equal numbers, and the statement follows.\n\nTo prove the inductive step, introduce the maps \\(\\rho_{1}, \\rho_{2}, \\sigma_{1}\\), and \\(\\sigma_{2}\\) as in Solution 1, see (1). Suppose first that all four maps are surjective. Then, in fact, we have \\(\\left|R_{1}\\right|=\\left|R_{2}\\right|,\\left|C_{1}\\right|=\\left|C_{2}\\right|\\), and all maps are bijective. Moreover, for all \\(r_{2} \\in R_{2}\\) and \\(c_{2} \\in C_{2}\\) we have\n\\[\n\\begin{aligned}\na\\left(r_{2}, c_{2}\\right) \\leqslant a\\left(r_{2}, \\sigma_{2}^{-1}\\left(c_{2}\\right)\\right) \\leqslant a\\left(\\rho_{1}\\left(r_{2}\\right), \\sigma_{2}^{-1}\\left(c_{2}\\right)\\right) \\leqslant a\\left(\\rho_{1}\\left(r_{2}\\right)\\right. & \\left., \\sigma_{1}^{-1} \\circ \\sigma_{2}^{-1}\\left(c_{2}\\right)\\right) \\\\\n& \\leqslant a\\left(\\rho_{2} \\circ \\rho_{1}\\left(r_{2}\\right), \\sigma_{1}^{-1} \\circ \\sigma_{2}^{-1}\\left(c_{2}\\right)\\right)\n\\end{aligned}\n\\]\n\nSumming up, we get\n\\[\n\\sum_{\\substack{r_{2} \\in R_{2} \\\\ c_{2} \\in C_{2}}} a\\left(r_{2}, c_{2}\\right) \\leqslant \\sum_{\\substack{r_{2} \\in R_{2} \\\\ c_{2} \\in C_{2}}} a\\left(\\rho_{2} \\circ \\rho_{1}\\left(r_{2}\\right), \\sigma_{1}^{-1} \\circ \\sigma_{2}^{-1}\\left(c_{2}\\right)\\right) .\n\\]\n\nSince \\(\\rho_{1} \\circ \\rho_{2}\\) and \\(\\sigma_{1}^{-1} \\circ \\sigma_{2}^{-1}\\) are permutations of \\(R_{2}\\) and \\(C_{2}\\), respectively, this inequality is in fact equality. Therefore, all inequalities in (4) turn into equalities, which establishes the inductive step in this case.\n\nIt remains to show that all four maps are surjective. For the sake of contradiction, we assume that \\(\\rho_{1}\\) is not surjective. Now let \\(R_{1}^{\\prime}=\\rho_{1}\\left(R_{2}\\right)\\) and \\(C_{1}^{\\prime}=\\sigma_{1}\\left(C_{2}\\right)\\), and set \\(R^{*}=R_{1} \\backslash R_{1}^{\\prime}\\) and \\(C^{*}=C_{1} \\backslash C_{1}^{\\prime}\\). By our assumption, \\(R^{*} \\neq \\varnothing\\).\n\nLet \\(\\mathcal{Q}\\) be the table obtained from \\(\\mathcal{T}\\) by removing the rows in \\(R^{*}\\) and the columns in \\(C^{*}\\); in other words, \\(\\mathcal{Q}=\\mathcal{T}\\left[R_{1}^{\\prime} \\cup R_{2}, C_{1}^{\\prime} \\cup C_{2}\\right]\\). By the definition of \\(\\rho_{1}\\), for each \\(r_{2} \\in R_{2}\\) we have \\(\\rho_{1}\\left(r_{2}\\right) \\geq_{C_{1}} r_{2}\\), so a fortiori \\(\\rho_{1}\\left(r_{2}\\right) \\geq_{C_{1}^{\\prime}} r_{2}\\); moreover, \\(\\rho_{1}\\left(r_{2}\\right) \\in R_{1}^{\\prime}\\). Similarly, \\(C_{1}^{\\prime} \\ni \\sigma_{1}\\left(c_{2}\\right) \\leq_{R_{1}^{\\prime}} c_{2}\\) for each \\(c_{2} \\in C_{2}\\). This means that ( \\(R_{1}^{\\prime}, C_{1}^{\\prime}\\) ) is a saddle pair in \\(\\mathcal{Q}\\). Recall that ( \\(R_{2}, C_{2}\\) ) remains a minimal pair in \\(\\mathcal{Q}\\), due to the Lemma.\n\nTherefore, \\(\\mathcal{Q}\\) admits a minimal pair ( \\(\\bar{R}_{1}, \\bar{C}_{1}\\) ) such that \\(\\bar{R}_{1} \\subseteq R_{1}^{\\prime}\\) and \\(\\bar{C}_{1} \\subseteq C_{1}^{\\prime}\\). For a minute, confine ourselves to the subtable \\(\\overline{\\mathcal{Q}}=\\mathcal{Q}\\left[\\bar{R}_{1} \\cup R_{2}, \\bar{C}_{1} \\cup C_{2}\\right]\\). By the Lemma, the pairs ( \\(\\bar{R}_{1}, \\bar{C}_{1}\\) ) and ( \\(R_{2}, C_{2}\\) ) are also minimal in \\(\\overline{\\mathcal{Q}}\\). By the inductive hypothesis, we have \\(\\left|R_{2}\\right|=\\left|\\bar{R}_{1}\\right| \\leqslant\\left|R_{1}^{\\prime}\\right|=\\left|\\rho_{1}\\left(R_{2}\\right)\\right| \\leqslant\\left|R_{2}\\right|\\), so all these inequalities are in fact equalities. This implies that \\(\\bar{R}_{2}=R_{2}^{\\prime}\\) and that \\(\\rho_{1}\\) is a bijection \\(R_{2} \\rightarrow R_{1}^{\\prime}\\). Similarly, \\(\\bar{C}_{1}=C_{1}^{\\prime}\\), and \\(\\sigma_{1}\\) is a bijection \\(C_{2} \\rightarrow C_{1}^{\\prime}\\). In particular, ( \\(R_{1}^{\\prime}, C_{1}^{\\prime}\\) ) is a minimal pair in \\(\\mathcal{Q}\\).\n\nNow, by inductive hypothesis again, we have \\(\\left|R_{1}^{\\prime}\\right|=\\left|R_{2}\\right|,\\left|C_{1}^{\\prime}\\right|=\\left|C_{2}\\right|\\), and there exist four bijections\n\\[\n\\begin{array}{lllll}\n\\rho_{1}^{\\prime}: R_{2} \\rightarrow R_{1}^{\\prime} & \\text { such that } & \\rho_{1}^{\\prime}\\left(r_{2}\\right) \\equiv_{C_{1}^{\\prime}} r_{2} & \\text { for all } & r_{2} \\in R_{2} ; \\\\\n\\rho_{2}^{\\prime}: R_{1}^{\\prime} \\rightarrow R_{2} & \\text { such that } & \\rho_{2}^{\\prime}\\left(r_{1}\\right) \\equiv_{C_{2}} r_{1} & \\text { for all } & r_{1} \\in R_{1}^{\\prime} ; \\\\\n\\sigma_{1}^{\\prime}: C_{2} \\rightarrow C_{1}^{\\prime} & \\text { such that } & \\sigma_{1}^{\\prime}\\left(c_{2}\\right) \\equiv_{R_{1}^{\\prime}} c_{2} & \\text { for all } & c_{2} \\in C_{2} ; \\\\\n\\sigma_{2}^{\\prime}: C_{1}^{\\prime} \\rightarrow C_{2} & \\text { such that } & \\sigma_{2}^{\\prime}\\left(c_{1}\\right) \\equiv_{R_{2}} c_{1} & \\text { for all } & c_{1} \\in C_{1}^{\\prime} .\n\\end{array}\n\\]\n\nNotice here that \\(\\sigma_{1}\\) and \\(\\sigma_{1}^{\\prime}\\) are two bijections \\(C_{2} \\rightarrow C_{1}^{\\prime}\\) satisfying \\(\\sigma_{1}^{\\prime}\\left(c_{2}\\right) \\equiv R_{1}^{\\prime} c_{2} \\geq_{R_{1}} \\sigma_{1}\\left(c_{2}\\right)\\) for all \\(c_{2} \\in C_{2}\\). Now, if \\(\\sigma_{1}^{\\prime}\\left(c_{2}\\right) \\neq \\sigma_{1}\\left(c_{2}\\right)\\) for some \\(c_{2} \\in C_{2}\\), then we could remove column \\(\\sigma_{1}^{\\prime}\\left(c_{2}\\right)\\) from \\(C_{1}^{\\prime}\\) obtaining another saddle pair \\(\\left(R_{1}^{\\prime}, C_{1}^{\\prime} \\backslash\\left\\{\\sigma_{1}^{\\prime}\\left(c_{2}\\right)\\right\\}\\right)\\) in \\(\\mathcal{Q}\\). This is impossible for a minimal pair ( \\(R_{1}^{\\prime}, C_{1}^{\\prime}\\) ); hence the maps \\(\\sigma_{1}\\) and \\(\\sigma_{1}^{\\prime}\\) coincide.\n\nNow we are prepared to show that ( \\(R_{1}^{\\prime}, C_{1}^{\\prime}\\) ) is a saddle pair in \\(\\mathcal{T}\\), which yields a desired contradiction (since ( \\(R_{1}, C_{1}\\) ) is not minimal). By symmetry, it suffices to find, for each \\(r^{\\prime} \\in \\mathcal{R}\\), a row \\(r_{1} \\in R_{1}^{\\prime}\\) such that \\(r_{1} \\geq_{C_{1}^{\\prime}} r^{\\prime}\\). If \\(r^{\\prime} \\in R_{2}\\), then we may put \\(r_{1}=\\rho_{1}\\left(r^{\\prime}\\right)\\); so, in the sequel we assume \\(r^{\\prime} \\in R_{1}\\).\n\nThere exists \\(r_{2} \\in R_{2}\\) such that \\(r^{\\prime} \\leq_{C_{2}} r_{2}\\); set \\(r_{1}=\\left(\\rho_{2}^{\\prime}\\right)^{-1}\\left(r_{2}\\right) \\in R_{1}^{\\prime}\\) and recall that \\(r_{1} \\equiv_{C_{2}} r_{2} \\geq_{C_{2}} r^{\\prime}\\). Therefore, implementing the bijection \\(\\sigma_{1}=\\sigma_{1}^{\\prime}\\), for each \\(c_{1} \\in C_{1}^{\\prime}\\) we get\n\\[\na\\left(r^{\\prime}, c_{1}\\right) \\leqslant a\\left(r^{\\prime}, \\sigma_{1}^{-1}\\left(c_{1}\\right)\\right) \\leqslant a\\left(r_{1}, \\sigma_{1}^{-1}\\left(c_{1}\\right)\\right)=a\\left(r_{1}, \\sigma_{1}^{\\prime} \\circ \\sigma_{1}^{-1}\\left(c_{1}\\right)\\right)=a\\left(r_{1}, c_{1}\\right)\n\\]\nwhich shows \\(r^{\\prime} \\leq_{C_{1}^{\\prime}} r_{1}\\), as desired. The inductive step is completed.\nComment 1. For two minimal pairs ( \\(R_{1}, C_{1}\\) ) and ( \\(R_{2}, C_{2}\\) ), Solution 2 not only proves the required equalities \\(\\left|R_{1}\\right|=\\left|R_{2}\\right|\\) and \\(\\left|C_{1}\\right|=\\left|C_{2}\\right|\\), but also shows the existence of bijections (3). In simple words, this means that the four subtables \\(\\mathcal{T}\\left[R_{1}, C_{1}\\right], \\mathcal{T}\\left[R_{1}, C_{2}\\right], \\mathcal{T}\\left[R_{2}, C_{1}\\right]\\), and \\(\\mathcal{T}\\left[R_{2}, C_{2}\\right]\\) differ only by permuting rows/columns. Notice that the existence of such bijections immediately implies that ( \\(R_{1}, C_{2}\\) ) and ( \\(R_{2}, C_{1}\\) ) are also minimal pairs.\n\nThis stronger claim may also be derived directly from the arguments in Solution 1, even without the assumptions \\(R_{1} \\cap R_{2}=\\varnothing\\) and \\(C_{1} \\cap C_{2}=\\varnothing\\). Indeed, if \\(\\left|R_{1}\\right|=\\left|R_{2}\\right|\\) and \\(\\left|C_{1}\\right|=\\left|C_{2}\\right|\\), then similar arguments show that \\(R^{n}=R_{1}, C^{n}=C_{1}\\), and for any \\(r \\in R^{n}\\) and \\(c \\in C^{n}\\) we have\n\\[\na(r, c)=a\\left(\\rho^{n k}(r), c\\right) \\geqslant a\\left(\\rho^{n k-1}(r), \\sigma(c)\\right) \\geqslant \\ldots \\geqslant a\\left(r, \\sigma^{n k}(c)\\right)=a(r, c) .\n\\]\n\nThis yields that all above inequalities turn into equalities. Moreover, this yields that all inequalities in (2) turn into equalities. Hence \\(\\rho_{1}, \\rho_{2}, \\sigma_{1}\\), and \\(\\sigma_{2}\\) satisfy (3).\n\nIt is perhaps worth mentioning that one cannot necessarily find the maps in (3) so as to satisfy \\(\\rho_{1}=\\rho_{2}^{-1}\\) and \\(\\sigma_{1}=\\sigma_{2}^{-1}\\), as shown by the table below.\n\n\\begin{tabular}{|l|l||l|l|}\n\\hline 1 & 0 & 0 & 1 \\\\\n\\hline 0 & 1 & 1 & 0 \\\\\n\\hline \\hline 1 & 0 & 1 & 0 \\\\\n\\hline 0 & 1 & 0 & 1 \\\\\n\\hline\n\\end{tabular}\n\nComment 2. One may use the following, a bit more entertaining formulation of the same problem.\nOn a specialized market, a finite number of products are being sold, and there are finitely many retailers each selling all the products by some prices. Say that retailer \\(r_{1}\\) dominates retailer \\(r_{2}\\) with respect to a set of products \\(P\\) if \\(r_{1}\\) 's price of each \\(p \\in P\\) does not exceed \\(r_{2}\\) 's price of \\(p\\). Similarly, product \\(p_{1}\\) exceeds product \\(p_{2}\\) with respect to a set of retailers \\(R\\), if \\(r\\) 's price of \\(p_{1}\\) is not less than \\(r\\) 's price of \\(p_{2}\\), for each \\(r \\in R\\).\n\nSay that a set \\(R\\) of retailers and a set \\(P\\) of products form a saddle pair if for each retailer \\(r^{\\prime}\\) there is \\(r \\in R\\) dominating \\(r^{\\prime}\\) with respect to \\(P\\), and for each product \\(p^{\\prime}\\) there is \\(p \\in P\\) exceeding \\(p^{\\prime}\\) with respect to \\(R\\). A saddle pair ( \\(R, P\\) ) is called a minimal pair if for each saddle pair ( \\(R^{\\prime}, P^{\\prime}\\) ) with \\(R^{\\prime} \\subseteq R\\) and \\(P^{\\prime} \\subseteq P\\), we have \\(R^{\\prime}=R\\) and \\(P^{\\prime}=P\\).\n\nProve that any two minimal pairs contain the same number of retailers.", "source_pdf": "imosl_2020.pdf", "notes": "fallback-regex"}
{"id": "IMOSL-2020-C8", "contest": "IMOSL", "year": "2020", "problem_number": "C8", "problem": "Players \\(A\\) and \\(B\\) play a game on a blackboard that initially contains 2020 copies of the number 1. In every round, player \\(A\\) erases two numbers \\(x\\) and \\(y\\) from the blackboard, and then player \\(B\\) writes one of the numbers \\(x+y\\) and \\(|x-y|\\) on the blackboard. The game terminates as soon as, at the end of some round, one of the following holds:\n(1) one of the numbers on the blackboard is larger than the sum of all other numbers;\n(2) there are only zeros on the blackboard.\n\nPlayer \\(B\\) must then give as many cookies to player \\(A\\) as there are numbers on the blackboard. Player \\(A\\) wants to get as many cookies as possible, whereas player \\(B\\) wants to give as few as possible. Determine the number of cookies that \\(A\\) receives if both players play optimally.\n(Austria)\n\n\\section*{", "solution": "Answer: 7.}\n\n. For a positive integer \\(n\\), we denote by \\(S_{2}(n)\\) the sum of digits in its binary representation. We prove that, in fact, if a board initially contains an even number \\(n>1\\) of ones, then \\(A\\) can guarantee to obtain \\(S_{2}(n)\\), but not more, cookies. The binary representation of 2020 is \\(2020=\\overline{11111100100}_{2}\\), so \\(S_{2}(2020)=7\\), and the answer follows.\n\nA strategy for \\(A\\). At any round, while possible, \\(A\\) chooses two equal nonzero numbers on the board. Clearly, while \\(A\\) can make such choice, the game does not terminate. On the other hand, \\(A\\) can follow this strategy unless the game has already terminated. Indeed, if \\(A\\) always chooses two equal numbers, then each number appearing on the board is either 0 or a power of 2 with non-negative integer exponent, this can be easily proved using induction on the number of rounds. At the moment when \\(A\\) is unable to follow the strategy all nonzero numbers on the board are distinct powers of 2 . If the board contains at least one such power, then the largest of those powers is greater than the sum of the others. Otherwise there are only zeros on the blackboard, in both cases the game terminates.\n\nFor every number on the board, define its range to be the number of ones it is obtained from. We can prove by induction on the number of rounds that for any nonzero number \\(k\\) written by \\(B\\) its range is \\(k\\), and for any zero written by \\(B\\) its range is a power of 2 . Thus at the end of each round all the ranges are powers of two, and their sum is \\(n\\). Since \\(S_{2}(a+b) \\leqslant S_{2}(a)+S_{2}(b)\\) for any positive integers \\(a\\) and \\(b\\), the number \\(n\\) cannot be represented as a sum of less than \\(S_{2}(n)\\) powers of 2 . Thus at the end of each round the board contains at least \\(S_{2}(n)\\) numbers, while \\(A\\) follows the above strategy. So \\(A\\) can guarantee at least \\(S_{2}(n)\\) cookies for himself.\n\nComment. There are different proofs of the fact that the presented strategy guarantees at least \\(S_{2}(n)\\) cookies for \\(A\\). For instance, one may denote by \\(\\Sigma\\) the sum of numbers on the board, and by \\(z\\) the number of zeros. Then the board contains at least \\(S_{2}(\\Sigma)+z\\) numbers; on the other hand, during the game, the number \\(S_{2}(\\Sigma)+z\\) does not decrease, and its initial value is \\(S_{2}(n)\\). The claim follows.\n\nA strategy for \\(B\\). Denote \\(s=S_{2}(n)\\).\nLet \\(x_{1}, \\ldots, x_{k}\\) be the numbers on the board at some moment of the game after \\(B\\) 's turn or at the beginning of the game. Say that a collection of \\(k \\operatorname{signs} \\varepsilon_{1}, \\ldots, \\varepsilon_{k} \\in\\{+1,-1\\}\\) is balanced if\n\\[\n\\sum_{i=1}^{k} \\varepsilon_{i} x_{i}=0 .\n\\]\n\nWe say that a situation on the board is good if \\(2^{s+1}\\) does not divide the number of balanced collections. An appropriate strategy for \\(B\\) can be explained as follows: Perform a move so that the situation remains good, while it is possible. We intend to show that in this case \\(B\\) will not lose more than \\(S_{2}(n)\\) cookies. For this purpose, we prove several lemmas.\n\nFor a positive integer \\(k\\), denote by \\(\\nu_{2}(k)\\) the exponent of the largest power of 2 that divides \\(k\\). Recall that, by Legendre's formula, \\(\\nu_{2}(n!)=n-S_{2}(n)\\) for every positive integer \\(n\\).\n\nLemma 1. The initial situation is good.\nProof. In the initial configuration, the number of balanced collections is equal to \\(\\binom{n}{n / 2}\\). We have\n\\[\n\\nu_{2}\\left(\\binom{n}{n / 2}\\right)=\\nu_{2}(n!)-2 \\nu_{2}((n / 2)!)=\\left(n-S_{2}(n)\\right)-2\\left(\\frac{n}{2}-S_{2}(n / 2)\\right)=S_{2}(n)=s .\n\\]\n\nHence \\(2^{s+1}\\) does not divide the number of balanced collections, as desired.\nLemma 2. \\(B\\) may play so that after each round the situation remains good.\nProof. Assume that the situation \\(\\left(x_{1}, \\ldots, x_{k}\\right)\\) before a round is good, and that \\(A\\) erases two numbers, \\(x_{p}\\) and \\(x_{q}\\).\n\nLet \\(N\\) be the number of all balanced collections, \\(N_{+}\\)be the number of those having \\(\\varepsilon_{p}=\\varepsilon_{q}\\), and \\(N_{-}\\)be the number of other balanced collections. Then \\(N=N_{+}+N_{-}\\). Now, if \\(B\\) replaces \\(x_{p}\\) and \\(x_{q}\\) by \\(x_{p}+x_{q}\\), then the number of balanced collections will become \\(N_{+}\\). If \\(B\\) replaces \\(x_{p}\\) and \\(x_{q}\\) by \\(\\left|x_{p}-x_{q}\\right|\\), then this number will become \\(N_{-}\\). Since \\(2^{s+1}\\) does not divide \\(N\\), it does not divide one of the summands \\(N_{+}\\)and \\(N_{-}\\), hence \\(B\\) can reach a good situation after the round.\n\nLemma 3. Assume that the game terminates at a good situation. Then the board contains at most \\(s\\) numbers.\nProof. Suppose, one of the numbers is greater than the sum of the other numbers. Then the number of balanced collections is 0 and hence divisible by \\(2^{s+1}\\). Therefore, the situation is not good.\n\nThen we have only zeros on the blackboard at the moment when the game terminates. If there are \\(k\\) of them, then the number of balanced collections is \\(2^{k}\\). Since the situation is good, we have \\(k \\leqslant s\\).\n\nBy Lemmas 1 and 2, \\(B\\) may act in such way that they keep the situation good. By Lemma 3, when the game terminates, the board contains at most \\(s\\) numbers. This is what we aimed to prove.\n\nComment 1. If the initial situation had some odd number \\(n>1\\) of ones on the blackboard, player \\(A\\) would still get \\(S_{2}(n)\\) cookies, provided that both players act optimally. The proof of this fact is similar to the solution above, after one makes some changes in the definitions. Such changes are listed below.\n\nSay that a collection of \\(k\\) signs \\(\\varepsilon_{1}, \\ldots, \\varepsilon_{k} \\in\\{+1,-1\\}\\) is positive if\n\\[\n\\sum_{i=1}^{k} \\varepsilon_{i} x_{i}>0\n\\]\n\nFor every index \\(i=1,2, \\ldots, k\\), we denote by \\(N_{i}\\) the number of positive collections such that \\(\\varepsilon_{i}=1\\). Finally, say that a situation on the board is good if \\(2^{s-1}\\) does not divide at least one of the numbers \\(N_{i}\\). Now, a strategy for \\(B\\) again consists in preserving the situation good, after each round.\n\nComment 2. There is an easier strategy for \\(B\\), allowing, in the game starting with an even number \\(n\\) of ones, to lose no more than \\(d=\\left\\lfloor\\log _{2}(n+2)\\right\\rfloor-1\\) cookies. If the binary representation of \\(n\\) contains at most two zeros, then \\(d=S_{2}(n)\\), and hence the strategy is optimal in that case. We outline this approach below.\n\nFirst of all, we can assume that \\(A\\) never erases zeros from the blackboard. Indeed, \\(A\\) may skip such moves harmlessly, ignoring the zeros in the further process; this way, \\(A\\) 's win will just increase.\n\nWe say that a situation on the blackboard is pretty if the numbers on the board can be partitioned into two groups with equal sums. Clearly, if the situation before some round is pretty, then \\(B\\) may play so as to preserve this property after the round. The strategy for \\(B\\) is as follows:\n- \\(B\\) always chooses a move that leads to a pretty situation.\n- If both possible moves of \\(B\\) lead to pretty situations, then \\(B\\) writes the sum of the two numbers erased by \\(A\\).\nSince the situation always remains pretty, the game terminates when all numbers on the board are zeros.\n\nSuppose that, at the end of the game, there are \\(m \\geqslant d+1=\\left\\lfloor\\log _{2}(n+2)\\right\\rfloor\\) zeros on the board; then \\(2^{m}-1>n / 2\\).\n\nNow we analyze the whole process of the play. Let us number the zeros on the board in order of appearance. During the play, each zero had appeared after subtracting two equal numbers. Let \\(n_{1}, \\ldots, n_{m}\\) be positive integers such that the first zero appeared after subtracting \\(n_{1}\\) from \\(n_{1}\\), the second zero appeared after subtracting \\(n_{2}\\) from \\(n_{2}\\), and so on. Since the sum of the numbers on the blackboard never increases, we have \\(2 n_{1}+\\ldots+2 n_{m} \\leqslant n\\), hence\n\\[\nn_{1}+\\ldots+n_{m} \\leqslant n / 2<2^{m}-1 .\n\\]\n\nThere are \\(2^{m}\\) subsets of the set \\(\\{1,2, \\ldots, m\\}\\). For \\(I \\subseteq\\{1,2, \\ldots, m\\}\\), denote by \\(f(I)\\) the sum \\(\\sum_{i \\in I} n_{i}\\). There are less than \\(2^{m}\\) possible values for \\(f(I)\\), so there are two distinct subsets \\(I\\) and \\(J\\) with \\(f(I)=f(J)\\). Replacing \\(I\\) and \\(J\\) with \\(I \\backslash J\\) and \\(J \\backslash I\\), we assume that \\(I\\) and \\(J\\) are disjoint.\n\nLet \\(i_{0}\\) be the smallest number in \\(I \\cup J\\); without loss of generality, \\(i_{0} \\in I\\). Consider the round when \\(A\\) had erased two numbers equal to \\(n_{i_{0}}\\), and \\(B\\) had put the \\(i_{0}{ }^{\\text {th }}\\) zero instead, and the situation before that round.\n\nFor each nonzero number \\(z\\) which is on the blackboard at this moment, we can keep track of it during the further play until it enters one of the numbers \\(n_{i}, i \\geqslant i_{0}\\), which then turn into zeros. For every \\(i=i_{0}, i_{0}+1, \\ldots, m\\), we denote by \\(X_{i}\\) the collection of all numbers on the blackboard that finally enter the first copy of \\(n_{i}\\), and by \\(Y_{i}\\) the collection of those finally entering the second copy of \\(n_{i}\\). Thus, each of \\(X_{i_{0}}\\) and \\(Y_{i_{0}}\\) consists of a single number. Since \\(A\\) never erases zeros, the \\(2\\left(m-i_{0}+1\\right)\\) defined sets are pairwise disjoint.\n\nClearly, for either of the collections \\(X_{i}\\) and \\(Y_{i}\\), a signed sum of its elements equals \\(n_{i}\\), for a proper choice of the signs. Therefore, for every \\(i=i_{0}, i_{0}+1, \\ldots, m\\) one can endow numbers in \\(X_{i} \\cup Y_{i}\\) with signs so that their sum becomes any of the numbers \\(-2 n_{i}, 0\\), or \\(2 n_{i}\\). Perform such endowment so as to get \\(2 n_{i}\\) from each collection \\(X_{i} \\cup Y_{i}\\) with \\(i \\in I,-2 n_{j}\\) from each collection \\(X_{j} \\cup Y_{j}\\) with \\(j \\in J\\), and 0 from each remaining collection. The obtained signed sum of all numbers on the blackboard equals\n\\[\n\\sum_{i \\in I} 2 n_{i}-\\sum_{i \\in J} 2 n_{i}=0\n\\]\nand the numbers in \\(X_{i_{0}}\\) and \\(Y_{i_{0}}\\) have the same (positive) sign.\nThis means that, at this round, \\(B\\) could add up the two numbers \\(n_{i_{0}}\\) to get a pretty situation. According to the strategy, \\(B\\) should have performed that, instead of subtracting the numbers. This contradiction shows that \\(m \\leqslant d\\), as desired.\n\n\\section*{Geometry}", "source_pdf": "imosl_2020.pdf", "notes": "fallback-regex"}
{"id": "IMOSL-2020-G1", "contest": "IMOSL", "year": "2020", "problem_number": "G1", "problem": "Let \\(A B C\\) be an isosceles triangle with \\(B C=C A\\), and let \\(D\\) be a point inside side \\(A B\\) such that \\(A D<D B\\). Let \\(P\\) and \\(Q\\) be two points inside sides \\(B C\\) and \\(C A\\), respectively, such that \\(\\angle D P B=\\angle D Q A=90^{\\circ}\\). Let the perpendicular bisector of \\(P Q\\) meet line segment \\(C Q\\) at \\(E\\), and let the circumcircles of triangles \\(A B C\\) and \\(C P Q\\) meet again at point \\(F\\), different from \\(C\\).\n\nSuppose that \\(P, E, F\\) are collinear. Prove that \\(\\angle A C B=90^{\\circ}\\).\n(Luxembourg)", "solution": "1. Let \\(\\ell\\) be the perpendicular bisector of \\(P Q\\), and denote by \\(\\omega\\) the circle \\(C F P Q\\). By \\(D P \\perp B C\\) and \\(D Q \\perp A C\\), the circle \\(\\omega\\) passes through \\(D\\); moreover, \\(C D\\) is a diameter of \\(\\omega\\).\n\nThe lines \\(Q E\\) and \\(P E\\) are symmetric about \\(\\ell\\), and \\(\\ell\\) is a symmetry axis of \\(\\omega\\) as well; it follows that the chords \\(C Q\\) and \\(F P\\) are symmetric about \\(\\ell\\), hence \\(C\\) and \\(F\\) are symmetric about \\(\\ell\\). Therefore, the perpendicular bisector of \\(C F\\) coincides with \\(\\ell\\). Thus \\(\\ell\\) passes through the circumcenter \\(O\\) of \\(A B C\\).\n\nLet \\(M\\) be the midpoint of \\(A B\\). Since \\(C M \\perp D M, M\\) also lies on \\(\\omega\\). By \\(\\angle A C M=\\angle B C M\\), the chords \\(M P\\) and \\(M Q\\) of \\(\\omega\\) are equal. Then, from \\(M P=M Q\\) it follows that \\(\\ell\\) passes through \\(M\\).\n![](https://cdn.mathpix.com/cropped/2025_08_23_b01e523c913a1e72c2d0g-50.jpg?height=655&width=1203&top_left_y=1227&top_left_x=428)\n\nFinally, both \\(O\\) and \\(M\\) lie on lines \\(\\ell\\) and \\(C M\\), therefore \\(O=M\\), and \\(\\angle A C B=90^{\\circ}\\) follows.\nSolution 2. Like in the first solution, we conclude that points \\(C, P, Q, D, F\\) and the midpoint \\(M\\) of \\(A B\\) lie on one circle \\(\\omega\\) with diameter \\(C D\\), and \\(M\\) lies on \\(\\ell\\), the perpendicular bisector of \\(P Q\\).\n\nLet \\(B F\\) and \\(C M\\) meet at \\(G\\) and let \\(\\alpha=\\angle A B F\\). Then, since \\(E\\) lies on \\(\\ell\\), and the quadrilaterals \\(F C B A\\) and \\(F C P Q\\) are cyclic, we have\n\\[\n\\angle C Q P=\\angle F P Q=\\angle F C Q=\\angle F C A=\\angle F B A=\\alpha .\n\\]\n\nSince points \\(P, E, F\\) are collinear, we have\n\\[\n\\angle F E M=\\angle F E Q+\\angle Q E M=2 \\alpha+\\left(90^{\\circ}-\\alpha\\right)=90^{\\circ}+\\alpha .\n\\]\n\nBut \\(\\angle F G M=90^{\\circ}+\\alpha\\), so \\(F E G M\\) is cyclic. Hence\n\\[\n\\angle E G C=\\angle E F M=\\angle P F M=\\angle P C M .\n\\]\n\nThus \\(G E \\| B C\\). It follows that \\(\\angle F A C=\\angle C B F=\\angle E G F\\), so \\(F E G A\\) is cyclic, too. Hence \\(\\angle A C B=\\angle A F B=\\angle A F G=180^{\\circ}-\\angle A M G=90^{\\circ}\\), that completes the proof.\n![](https://cdn.mathpix.com/cropped/2025_08_23_b01e523c913a1e72c2d0g-51.jpg?height=646&width=1203&top_left_y=211&top_left_x=428)\n\nComment 1. The converse statement is true: if \\(\\angle A C B=90^{\\circ}\\) then points \\(P, E\\) and \\(F\\) are collinear. This direction is easier to prove.\n\nComment 2. The statement of the problem remains true if the projection \\(P\\) of \\(D\\) onto \\(B C\\) lies outside line segment \\(B C\\). The restriction that \\(P\\) lies inside line segment \\(B C\\) is given to reduce case-sensitivity.", "source_pdf": "imosl_2020.pdf", "notes": "fallback-regex"}
{"id": "IMOSL-2020-G3", "contest": "IMOSL", "year": "2020", "problem_number": "G3", "problem": "Let \\(A B C D\\) be a convex quadrilateral with \\(\\angle A B C>90^{\\circ}, \\angle C D A>90^{\\circ}\\), and \\(\\angle D A B=\\angle B C D\\). Denote by \\(E\\) and \\(F\\) the reflections of \\(A\\) in lines \\(B C\\) and \\(C D\\), respectively. Suppose that the segments \\(A E\\) and \\(A F\\) meet the line \\(B D\\) at \\(K\\) and \\(L\\), respectively. Prove that the circumcircles of triangles \\(B E K\\) and \\(D F L\\) are tangent to each other.\n(Slovakia)", "solution": "1. Denote by \\(A^{\\prime}\\) the reflection of \\(A\\) in \\(B D\\). We will show that that the quadrilaterals \\(A^{\\prime} B K E\\) and \\(A^{\\prime} D L F\\) are cyclic, and their circumcircles are tangent to each other at point \\(A^{\\prime}\\).\n\nFrom the symmetry about line \\(B C\\) we have \\(\\angle B E K=\\angle B A K\\), while from the symmetry in \\(B D\\) we have \\(\\angle B A K=\\angle B A^{\\prime} K\\). Hence \\(\\angle B E K=\\angle B A^{\\prime} K\\), which implies that the quadrilateral \\(A^{\\prime} B K E\\) is cyclic. Similarly, the quadrilateral \\(A^{\\prime} D L F\\) is also cyclic.\n![](https://cdn.mathpix.com/cropped/2025_08_23_b01e523c913a1e72c2d0g-54.jpg?height=626&width=1220&top_left_y=822&top_left_x=422)\n\nFor showing that circles \\(A^{\\prime} B K E\\) and \\(A^{\\prime} D L F\\) are tangent it suffices to prove that\n\\[\n\\angle A^{\\prime} K B+\\angle A^{\\prime} L D=\\angle B A^{\\prime} D .\n\\]\n\nIndeed, by \\(A K \\perp B C, A L \\perp C D\\), and again the symmetry in \\(B D\\) we have\n\\[\n\\angle A^{\\prime} K B+\\angle A^{\\prime} L D=180^{\\circ}-\\angle K A^{\\prime} L=180^{\\circ}-\\angle K A L=\\angle B C D=\\angle B A D=\\angle B A^{\\prime} D,\n\\]\nas required.\nComment 1. The key to the solution above is introducing the point \\(A^{\\prime}\\); then the angle calculations can be done in many different ways.\n\nSolution 2. Note that \\(\\angle K A L=180^{\\circ}-\\angle B C D\\), since \\(A K\\) and \\(A L\\) are perpendicular to \\(B C\\) and \\(C D\\), respectively. Reflect both circles ( \\(B E K\\) ) and ( \\(D F L\\) ) in \\(B D\\). Since \\(\\angle K E B=\\angle K A B\\) and \\(\\angle D F L=\\angle D A L\\), the images are the circles ( \\(K A B\\) ) and ( \\(L A D\\) ), respectively; so they meet at \\(A\\). We need to prove that those two reflections are tangent at \\(A\\).\n\nFor this purpose, we observe that\n\\[\n\\angle A K B+\\angle A L D=180^{\\circ}-\\angle K A L=\\angle B C D=\\angle B A D .\n\\]\n\nThus, there exists a ray \\(A P\\) inside angle \\(\\angle B A D\\) such that \\(\\angle B A P=\\angle A K B\\) and \\(\\angle D A P= \\angle D L A\\). Hence the line \\(A P\\) is a common tangent to the circles ( \\(K A B\\) ) and ( \\(L A D\\) ), as desired.\n\nComment 2. The statement of the problem remains true for a more general configuration, e.g., if line \\(B D\\) intersect the extension of segment \\(A E\\) instead of the segment itself, etc. The corresponding restrictions in the statement are given to reduce case sensitivity.", "source_pdf": "imosl_2020.pdf", "notes": "fallback-regex"}
{"id": "IMOSL-2020-G4", "contest": "IMOSL", "year": "2020", "problem_number": "G4", "problem": "In the plane, there are \\(n \\geqslant 6\\) pairwise disjoint disks \\(D_{1}, D_{2}, \\ldots, D_{n}\\) with radii \\(R_{1} \\geqslant R_{2} \\geqslant \\ldots \\geqslant R_{n}\\). For every \\(i=1,2, \\ldots, n\\), a point \\(P_{i}\\) is chosen in disk \\(D_{i}\\). Let \\(O\\) be an arbitrary point in the plane. Prove that\n\\[\nO P_{1}+O P_{2}+\\ldots+O P_{n} \\geqslant R_{6}+R_{7}+\\ldots+R_{n} .\n\\]\n(A disk is assumed to contain its boundary.)\n(Iran)", "solution": ". We will make use of the following lemma.\nLemma. Let \\(D_{1}, \\ldots, D_{6}\\) be disjoint disks in the plane with radii \\(R_{1}, \\ldots, R_{6}\\). Let \\(P_{i}\\) be a point in \\(D_{i}\\), and let \\(O\\) be an arbitrary point. Then there exist indices \\(i\\) and \\(j\\) such that \\(O P_{i} \\geqslant R_{j}\\).\nProof. Let \\(O_{i}\\) be the center of \\(D_{i}\\). Consider six rays \\(O O_{1}, \\ldots, O O_{6}\\) (if \\(O=O_{i}\\), then the ray \\(O O_{i}\\) may be assumed to have an arbitrary direction). These rays partition the plane into six angles (one of which may be non-convex) whose measures sum up to \\(360^{\\circ}\\); hence one of the angles, say \\(\\angle O_{i} O O_{j}\\), has measure at most \\(60^{\\circ}\\). Then \\(O_{i} O_{j}\\) cannot be the unique largest side in (possibly degenerate) triangle \\(O O_{i} O_{j}\\), so, without loss of generality, \\(O O_{i} \\geqslant O_{i} O_{j} \\geqslant R_{i}+R_{j}\\). Therefore, \\(O P_{i} \\geqslant O O_{i}-R_{i} \\geqslant\\left(R_{i}+R_{j}\\right)-R_{i}=R_{j}\\), as desired.\n\nNow we prove the required inequality by induction on \\(n \\geqslant 5\\). The base case \\(n=5\\) is trivial. For the inductive step, apply the Lemma to the six largest disks, in order to find indices \\(i\\) and \\(j\\) such that \\(1 \\leqslant i, j \\leqslant 6\\) and \\(O P_{i} \\geqslant R_{j} \\geqslant R_{6}\\). Removing \\(D_{i}\\) from the configuration and applying the inductive hypothesis, we get\n\\[\n\\sum_{k \\neq i} O P_{k} \\geqslant \\sum_{\\ell \\geqslant 7} R_{\\ell} .\n\\]\n\nAdding up this inequality with \\(O P_{i} \\geqslant R_{6}\\) we establish the inductive step.\nComment 1. It is irrelevant to the problem whether the disks contain their boundaries or not. This condition is included for clarity reasons only. The problem statement remains true, and the solution works verbatim, if the disks are assumed to have disjoint interiors.\n\nComment 2. There are several variations of the above solution. In particular, while performing the inductive step, one may remove the disk with the largest value of \\(O P_{i}\\) and apply the inductive hypothesis to the remaining disks (the Lemma should still be applied to the six largest disks).\n\nComment 3. While proving the Lemma, one may reduce it to a particular case when the disks are congruent, as follows: Choose the smallest radius \\(r\\) of the disks in the Lemma statement, and then replace, for each \\(i\\), the \\(i^{\\text {th }}\\) disk with its homothetic copy, using the homothety centered at \\(P_{i}\\) with ratio \\(r / R_{i}\\).\n\nThis argument shows that the Lemma is tightly connected to a circle packing problem, see, e.g., https://en.wikipedia.org/wiki/Circle_packing_in_a_circle. The known results on that problem provide versions of the Lemma for different numbers of disks, which lead to different inequalities of the same kind. E.g., for 4 disks the best possible estimate in the Lemma is \\(O P_{i} \\geqslant(\\sqrt{2}-1) R_{j}\\), while for 13 disks it has the form \\(O P_{i} \\geqslant \\sqrt{5} R_{j}\\). Arguing as in the above solution, one obtains the inequalities\n\\[\n\\sum_{i=1}^{n} O P_{i} \\geqslant(\\sqrt{2}-1) \\sum_{j=4}^{n} R_{j} \\quad \\text { and } \\quad \\sum_{i=1}^{n} O P_{i} \\geqslant \\sqrt{5} \\sum_{j=13}^{n} R_{j} .\n\\]\n\nHowever, there are some harder arguments which allow to improve these inequalities, meaning that the \\(R_{j}\\) with large indices may be taken with much greater factors.", "source_pdf": "imosl_2020.pdf", "notes": "fallback-regex"}
{"id": "IMOSL-2020-G5", "contest": "IMOSL", "year": "2020", "problem_number": "G5", "problem": "Let \\(A B C D\\) be a cyclic quadrilateral with no two sides parallel. Let \\(K, L, M\\), and \\(N\\) be points lying on sides \\(A B, B C, C D\\), and \\(D A\\), respectively, such that \\(K L M N\\) is a rhombus with \\(K L \\| A C\\) and \\(L M \\| B D\\). Let \\(\\omega_{1}, \\omega_{2}, \\omega_{3}\\), and \\(\\omega_{4}\\) be the incircles of triangles \\(A N K\\), \\(B K L, C L M\\), and \\(D M N\\), respectively. Prove that the internal common tangents to \\(\\omega_{1}\\) and \\(\\omega_{3}\\) and the internal common tangents to \\(\\omega_{2}\\) and \\(\\omega_{4}\\) are concurrent.\n(Poland)", "solution": "1. Let \\(I_{i}\\) be the center of \\(\\omega_{i}\\), and let \\(r_{i}\\) be its radius for \\(i=1,2,3,4\\). Denote by \\(T_{1}\\) and \\(T_{3}\\) the points of tangency of \\(\\omega_{1}\\) and \\(\\omega_{3}\\) with \\(N K\\) and \\(L M\\), respectively. Suppose that the internal common tangents to \\(\\omega_{1}\\) and \\(\\omega_{3}\\) meet at point \\(S\\), which is the center of homothety \\(h\\) with negative ratio (namely, with ratio \\(-\\frac{r_{3}}{r_{1}}\\) ) mapping \\(\\omega_{1}\\) to \\(\\omega_{3}\\). This homothety takes \\(T_{1}\\) to \\(T_{3}\\) (since the tangents to \\(\\omega_{1}\\) and \\(\\omega_{3}\\) at \\(T_{1}\\) to \\(T_{3}\\) are parallel), hence \\(S\\) is a point on the segment \\(T_{1} T_{3}\\) with \\(T_{1} S: S T_{3}=r_{1}: r_{3}\\).\n\nConstruct segments \\(S_{1} S_{3} \\| K L\\) and \\(S_{2} S_{4} \\| L M\\) through \\(S\\) with \\(S_{1} \\in N K, S_{2} \\in K L\\), \\(S_{3} \\in L M\\), and \\(S_{4} \\in M N\\). Note that \\(h\\) takes \\(S_{1}\\) to \\(S_{3}\\), hence \\(I_{1} S_{1} \\| I_{3} S_{3}\\), and \\(S_{1} S: S S_{3}=r_{1}: r_{3}\\). We will prove that \\(S_{2} S: S S_{4}=r_{2}: r_{4}\\) or, equivalently, \\(K S_{1}: S_{1} N=r_{2}: r_{4}\\). This will yield the problem statement; indeed, applying similar arguments to the intersection point \\(S^{\\prime}\\) of the internal common tangents to \\(\\omega_{2}\\) and \\(\\omega_{4}\\), we see that \\(S^{\\prime}\\) satisfies similar relations, and there is a unique point inside \\(K L M N\\) satisfying them. Therefore, \\(S^{\\prime}=S\\).\n![](https://cdn.mathpix.com/cropped/2025_08_23_b01e523c913a1e72c2d0g-56.jpg?height=666&width=1392&top_left_y=1216&top_left_x=336)\n\nFurther, denote by \\(I_{A}, I_{B}, I_{C}, I_{D}\\) and \\(r_{A}, r_{B}, r_{C}, r_{D}\\) the incenters and inradii of triangles \\(D A B, A B C, B C D\\), and \\(C D A\\), respectively. One can shift triangle \\(C L M\\) by \\(\\overrightarrow{L K}\\) to glue it with triangle \\(A K N\\) into a quadrilateral \\(A K C^{\\prime} N\\) similar to \\(A B C D\\). In particular, this shows that \\(r_{1}: r_{3}=r_{A}: r_{C}\\); similarly, \\(r_{2}: r_{4}=r_{B}: r_{D}\\). Moreover, the same shift takes \\(S_{3}\\) to \\(S_{1}\\), and it also takes \\(I_{3}\\) to the incenter \\(I_{3}^{\\prime}\\) of triangle \\(K C^{\\prime} N\\). Since \\(I_{1} S_{1} \\| I_{3} S_{3}\\), the points \\(I_{1}, S_{1}, I_{3}^{\\prime}\\) are collinear. Thus, in order to complete the solution, it suffices to apply the following Lemma to quadrilateral \\(A K C^{\\prime} N\\).\nLemma 1. Let \\(A B C D\\) be a cyclic quadrilateral, and define \\(I_{A}, I_{C}, r_{B}\\), and \\(r_{D}\\) as above. Let \\(I_{A} I_{C}\\) meet \\(B D\\) at \\(X\\); then \\(B X: X D=r_{B}: r_{D}\\).\nProof. Consider an inversion centered at \\(X\\); the images under that inversion will be denoted by primes, e.g., \\(A^{\\prime}\\) is the image of \\(A\\).\n\nBy properties of inversion, we have\n\\[\n\\angle I_{C}^{\\prime} I_{A}^{\\prime} D^{\\prime}=\\angle X I_{A}^{\\prime} D^{\\prime}=\\angle X D I_{A}=\\angle B D A / 2=\\angle B C A / 2=\\angle A C I_{B} .\n\\]\n\nWe obtain \\(\\angle I_{A}^{\\prime} I_{C}^{\\prime} D^{\\prime}=\\angle C A I_{B}\\) likewise; therefore, \\(\\triangle I_{C}^{\\prime} I_{A}^{\\prime} D^{\\prime} \\sim \\triangle A C I_{B}\\). In the same manner, we get \\(\\triangle I_{C}^{\\prime} I_{A}^{\\prime} B^{\\prime} \\sim \\triangle A C I_{D}\\), hence the quadrilaterals \\(I_{C}^{\\prime} B^{\\prime} I_{A}^{\\prime} D^{\\prime}\\) and \\(A I_{D} C I_{B}\\) are also similar. But the diagonals \\(A C\\) and \\(I_{B} I_{D}\\) of quadrilateral \\(A I_{D} C I_{B}\\) meet at a point \\(Y\\) such that \\(I_{B} Y\\) :\n\\(Y I_{D}=r_{B}: r_{D}\\). By similarity, we get \\(D^{\\prime} X: B^{\\prime} X=r_{B}: r_{D}\\) and hence \\(B X: X D=D^{\\prime} X\\) : \\(B^{\\prime} X=r_{B}: r_{D}\\).\n\nComment 1. The solution above shows that the problem statement holds also for any parallelogram \\(K L M N\\) whose sides are parallel to the diagonals of \\(A B C D\\), as no property specific for a rhombus has been used. This solution works equally well when two sides of quadrilateral \\(A B C D\\) are parallel.\n\nComment 2. The problem may be reduced to Lemma 1 by using different tools, e.g., by using mass point geometry, linear motion of \\(K, L, M\\), and \\(N\\), etc.\n\nLemma 1 itself also can be proved in different ways. We present below one alternative proof.\nProof. In the circumcircle of \\(A B C D\\), let \\(K^{\\prime}, L^{\\prime} . M^{\\prime}\\), and \\(N^{\\prime}\\) be the midpoints of arcs \\(A B, B C\\), \\(C D\\), and \\(D A\\) containing no other vertices of \\(A B C D\\), respectively. Thus, \\(K^{\\prime}=C I_{B} \\cap D I_{A}\\), etc. In the computations below, we denote by \\([P]\\) the area of a polygon \\(P\\). We use similarities \\(\\triangle I_{A} B K^{\\prime} \\sim \\triangle I_{A} D N^{\\prime}, \\triangle I_{B} K^{\\prime} L^{\\prime} \\sim \\triangle I_{B} A C\\), etc., as well as congruences \\(\\triangle I_{B} K^{\\prime} L^{\\prime}=\\triangle B K^{\\prime} L^{\\prime}\\) and \\(\\triangle I_{D} M^{\\prime} N^{\\prime}= \\triangle D M^{\\prime} N^{\\prime}\\) (e.g., the first congruence holds because \\(K^{\\prime} L^{\\prime}\\) is a common internal bisector of angles \\(B K^{\\prime} I_{B}\\) and \\(B L^{\\prime} I_{B}\\) ).\n\nWe have\n\\[\n\\begin{aligned}\n& \\frac{B X}{D X}=\\frac{\\left[I_{A} B I_{C}\\right]}{\\left[I_{A} D I_{C}\\right]}=\\frac{B I_{A} \\cdot B I_{C} \\cdot \\sin I_{A} B I_{C}}{D I_{A} \\cdot D I_{C} \\cdot \\sin I_{A} D I_{C}}=\\frac{B I_{A}}{D I_{A}} \\cdot \\frac{B I_{C}}{D I_{C}} \\cdot \\frac{\\sin N^{\\prime} B M^{\\prime}}{\\sin K^{\\prime} D L^{\\prime}} \\\\\n&=\\frac{B K^{\\prime}}{D N^{\\prime}} \\cdot \\frac{B L^{\\prime}}{D M^{\\prime}} \\cdot \\frac{\\sin N^{\\prime} D M^{\\prime}}{\\sin K^{\\prime} B L^{\\prime}}=\\frac{B K^{\\prime} \\cdot B L^{\\prime} \\cdot \\sin K^{\\prime} B L^{\\prime}}{D N^{\\prime} \\cdot D M^{\\prime} \\cdot \\sin N^{\\prime} D M^{\\prime}} \\cdot \\frac{\\sin ^{2} N^{\\prime} D M^{\\prime}}{\\sin ^{2} K^{\\prime} B L^{\\prime}} \\\\\n&=\\frac{\\left[K^{\\prime} B L^{\\prime}\\right]}{\\left[M^{\\prime} D N^{\\prime}\\right]} \\cdot \\frac{N^{\\prime} M^{\\prime 2}}{K^{\\prime} L^{\\prime 2}}=\\frac{\\left[K^{\\prime} I_{B} L^{\\prime}\\right] \\cdot \\frac{A^{\\prime} C^{\\prime 2}}{K^{\\prime} L^{\\prime 2}}}{\\left[M^{\\prime} I_{D} N^{\\prime}\\right] \\cdot \\frac{A^{\\prime} C^{\\prime 2}}{N^{\\prime} M^{\\prime 2}}}=\\frac{\\left[A I_{B} C\\right]}{\\left[A I_{D} C\\right]}=\\frac{r_{B}}{r_{D}},\n\\end{aligned}\n\\]\nas required.\n\nSolution 2. This solution is based on the following general Lemma.\nLemma 2. Let \\(E\\) and \\(F\\) be distinct points, and let \\(\\omega_{i}, i=1,2,3,4\\), be circles lying in the same halfplane with respect to \\(E F\\). For distinct indices \\(i, j \\in\\{1,2,3,4\\}\\), denote by \\(O_{i j}^{+}\\) (respectively, \\(O_{i j}^{-}\\)) the center of homothety with positive (respectively, negative) ratio taking \\(\\omega_{i}\\) to \\(\\omega_{j}\\). Suppose that \\(E=O_{12}^{+}=O_{34}^{+}\\)and \\(F=O_{23}^{+}=O_{41}^{+}\\). Then \\(O_{13}^{-}=O_{24}^{-}\\).\nProof. Applying Monge's theorem to triples of circles \\(\\omega_{1}, \\omega_{2}, \\omega_{4}\\) and \\(\\omega_{1}, \\omega_{3}, \\omega_{4}\\), we get that both points \\(O_{24}^{-}\\)and \\(O_{13}^{-}\\)lie on line \\(E O_{14}^{-}\\). Notice that this line is distinct from \\(E F\\). Similarly we obtain that both points \\(O_{24}^{-}\\)and \\(O_{13}^{-}\\)lie on \\(F O_{34}^{-}\\). Since the lines \\(E O_{14}^{-}\\)and \\(F O_{34}^{-}\\)are distinct, both points coincide with the meeting point of those lines.\n![](https://cdn.mathpix.com/cropped/2025_08_23_b01e523c913a1e72c2d0g-57.jpg?height=712&width=1829&top_left_y=2078&top_left_x=119)\n\nTurning back to the problem, let \\(A B\\) intersect \\(C D\\) at \\(E\\) and let \\(B C\\) intersect \\(D A\\) at \\(F\\). Assume, without loss of generality, that \\(B\\) lies on segments \\(A E\\) and \\(C F\\). We will show that the points \\(E\\) and \\(F\\), and the circles \\(\\omega_{i}\\) satisfy the conditions of Lemma 2 , so the problem statement follows. In the sequel, we use the notation of \\(O_{i j}^{ \\pm}\\)from the statement of Lemma 2, applied to circles \\(\\omega_{1}, \\omega_{2}, \\omega_{3}\\), and \\(\\omega_{4}\\).\n\nUsing the relations \\(\\triangle E C A \\sim \\triangle E B D, K N \\| B D\\), and \\(M N \\| A C\\). we get\n\\[\n\\frac{A N}{N D}=\\frac{A N}{A D} \\cdot \\frac{A D}{N D}=\\frac{K N}{B D} \\cdot \\frac{A C}{N M}=\\frac{A C}{B D}=\\frac{A E}{E D} .\n\\]\n\nTherefore, by the angle bisector theorem, point \\(N\\) lies on the internal angle bisector of \\(\\angle A E D\\). We prove similarly that \\(L\\) also lies on that bisector, and that the points \\(K\\) and \\(M\\) lie on the internal angle bisector of \\(\\angle A F B\\).\n\nSince \\(K L M N\\) is a rhombus, points \\(K\\) and \\(M\\) are symmetric in line \\(E L N\\). Hence, the convex quadrilateral determined by the lines \\(E K, E M, K L\\), and \\(M L\\) is a kite, and therefore it has an incircle \\(\\omega_{0}\\). Applying Monge's theorem to \\(\\omega_{0}, \\omega_{2}\\), and \\(\\omega_{3}\\), we get that \\(O_{23}^{+}\\)lies on \\(K M\\). On the other hand, \\(O_{23}^{+}\\)lies on \\(B C\\), as \\(B C\\) is an external common tangent to \\(\\omega_{2}\\) and \\(\\omega_{3}\\). It follows that \\(F=O_{23}^{+}\\). Similarly, \\(E=O_{12}^{+}=O_{34}^{+}\\), and \\(F=O_{41}^{+}\\).\n\nComment 3. The reduction to Lemma 2 and the proof of Lemma 2 can be performed with the use of different tools, e.g., by means of Menelaus theorem, by projecting harmonic quadruples, by applying Monge's theorem in some other ways, etc.", "source_pdf": "imosl_2020.pdf", "notes": "fallback-regex"}
{"id": "IMOSL-2020-G6", "contest": "IMOSL", "year": "2020", "problem_number": "G6", "problem": "Let \\(I\\) and \\(I_{A}\\) be the incenter and the \\(A\\)-excenter of an acute-angled triangle \\(A B C\\) with \\(A B<A C\\). Let the incircle meet \\(B C\\) at \\(D\\). The line \\(A D\\) meets \\(B I_{A}\\) and \\(C I_{A}\\) at \\(E\\) and \\(F\\), respectively. Prove that the circumcircles of triangles \\(A I D\\) and \\(I_{A} E F\\) are tangent to each other.\n(Slovakia)", "solution": "1. Let \\(\\Varangle(p, q)\\) denote the directed angle between lines \\(p\\) and \\(q\\).\nThe points \\(B, C, I\\), and \\(I_{A}\\) lie on the circle \\(\\Gamma\\) with diameter \\(I I_{A}\\). Let \\(\\omega\\) and \\(\\Omega\\) denote the circles ( \\(I_{A} E F\\) ) and ( \\(A I D\\) ), respectively. Let \\(T\\) be the second intersection point of \\(\\omega\\) and \\(\\Gamma\\). Then \\(T\\) is the Miquel point of the complete quadrilateral formed by the lines \\(B C, B I_{A}, C I_{A}\\), and \\(D E F\\), so \\(T\\) also lies on circle ( \\(B D E\\) ) (as well as on circle ( \\(C D F\\) )). We claim that \\(T\\) is a desired tangency point of \\(\\omega\\) and \\(\\Omega\\).\n\nIn order to show that \\(T\\) lies on \\(\\Omega\\), use cyclic quadrilaterals \\(B D E T\\) and \\(B I I_{A} T\\) to write\n\\[\n\\Varangle(D T, D A)=\\Varangle(D T, D E)=\\Varangle(B T, B E)=\\Varangle\\left(B T, B I_{A}\\right)=\\Varangle\\left(I T, I I_{A}\\right)=\\Varangle(I T, I A) .\n\\]\n![](https://cdn.mathpix.com/cropped/2025_08_23_b01e523c913a1e72c2d0g-60.jpg?height=1129&width=812&top_left_y=1045&top_left_x=625)\n\nTo show that \\(\\omega\\) and \\(\\Omega\\) are tangent at \\(T\\), let \\(\\ell\\) be the tangent to \\(\\omega\\) at \\(T\\), so that \\(\\Varangle\\left(T I_{A}, \\ell\\right)= \\Varangle\\left(E I_{A}, E T\\right)\\). Using circles ( \\(B D E T\\) ) and ( \\(B I C I_{A}\\) ), we get\n\\[\n\\Varangle\\left(E I_{A}, E T\\right)=\\Varangle(E B, E T)=\\Varangle(D B, D T) .\n\\]\n\nTherefore,\n\\[\n\\Varangle(T I, \\ell)=90^{\\circ}+\\Varangle\\left(T I_{A}, \\ell\\right)=90^{\\circ}+\\Varangle(D B, D T)=\\Varangle(D I, D T),\n\\]\nwhich shows that \\(\\ell\\) is tangent to \\(\\Omega\\) at \\(T\\).\nSolution 2. We use the notation of circles \\(\\Gamma, \\omega\\), and \\(\\Omega\\) as in the previous solution.\nLet \\(L\\) be the point opposite to \\(I\\) in circle \\(\\Omega\\). Then \\(\\angle I A L=\\angle I D L=90^{\\circ}\\), which means that \\(L\\) is the foot of the external bisector of \\(\\angle A\\) in triangle \\(A B C\\). Let \\(L I\\) cross \\(\\Gamma\\) again at \\(M\\).\n\nLet \\(T\\) be the foot of the perpendicular from \\(I\\) onto \\(I_{A} L\\). Then \\(T\\) is the second intersection point of \\(\\Gamma\\) and \\(\\Gamma\\). We will show that \\(T\\) is the desired tangency point.\n\nFirst, we show that \\(T\\) lies on circle \\(\\omega\\). Notice that\n\\[\n\\Varangle(L T, L M)=\\Varangle(A T, A I) \\quad \\text { and } \\quad \\Varangle(M T, M L)=\\Varangle(M T, M I)=\\Varangle\\left(I_{A} T, I_{A} I\\right),\n\\]\nwhich shows that triangles \\(T M L\\) and \\(T I_{A} A\\) are similar and equioriented. So there exists a rotational homothety \\(\\tau\\) mapping \\(T M L\\) to \\(T I_{A} A\\).\n\nSince \\(\\Varangle(M L, L D)=\\Varangle(A I, A D)\\), we get \\(\\tau(B C)=A D\\). Next, since\n\\[\n\\Varangle(M B, M L)=\\Varangle(M B, M I)=\\Varangle\\left(I_{A} B, I_{A} I\\right)=\\Varangle\\left(I_{A} E, I_{A} A\\right),\n\\]\nwe get \\(\\tau(B)=E\\). Similarly, \\(\\tau(C)=F\\). Since the points \\(M, B, C\\), and \\(T\\) are concyclic, so are their \\(\\tau\\)-images, which means that \\(T\\) lies on \\(\\omega=\\tau(\\Gamma)\\).\n![](https://cdn.mathpix.com/cropped/2025_08_23_b01e523c913a1e72c2d0g-61.jpg?height=1049&width=1397&top_left_y=922&top_left_x=334)\n\nFinally, since \\(\\tau(L)=A\\) and \\(\\tau(B)=E\\), triangles \\(A T L\\) and \\(E T B\\) are similar so that\n\\[\n\\Varangle(A T, A L)=\\Varangle(E T, E B)=\\Varangle\\left(E I_{A}, E T\\right) .\n\\]\n\nThis means that the tangents to \\(\\Omega\\) and \\(\\omega\\) at \\(T\\) make the same angle with the line \\(I_{A} T L\\), so the circles are indeed tangent at \\(T\\).\n\nComment. In both solutions above, a crucial step is a guess that the desired tangency point lies on \\(\\Gamma\\). There are several ways to recognize this helpful property.\nE.g. one may perform some angle chasing to see that the tangents to \\(\\Omega\\) at \\(L\\) and to \\(\\omega\\) at \\(I_{A}\\) are parallel (and the circles lie on different sides of the tangents). This yields that, under the assumption that the circles are tangent externally, the tangency point must lie on \\(I_{A} L\\). Since \\(I L\\) is a diameter in \\(\\Omega\\), this, in turn, implies that \\(T\\) is the projection of \\(I\\) onto \\(I_{A} L\\).\n\nAnother way to see the same fact is to perform a homothety centered at \\(A\\) and mapping \\(I\\) to \\(I_{A}\\) (and \\(D\\) to some point \\(D^{\\prime}\\) ). The image \\(\\Omega^{\\prime}\\) of \\(\\Omega\\) is tangent to \\(\\omega\\) at \\(I_{A}\\), because \\(\\angle B I_{A} A+\\angle C I_{A} D^{\\prime}=180^{\\circ}\\). This yields that the tangents to \\(\\Omega\\) at \\(I\\) and to \\(\\omega\\) at \\(I_{A}\\) are parallel.\n\nThere are other ways to describe the tangency point. The next solution presents one of them.\n\nSolution 3. We also use the notation of circles \\(\\omega\\), and \\(\\Omega\\) from the previous solutions.\nPerform an inversion centered at \\(D\\). The images of the points will be denoted by primes, e.g., \\(A^{\\prime}\\) is the image of \\(A\\).\n\nFor convenience, we use the notation \\(\\angle B I D=\\beta, \\angle C I D=\\gamma\\), and \\(\\alpha=180^{\\circ}-\\beta-\\gamma= 90^{\\circ}-\\angle B A I\\). We start with computing angles appearing after inversion. We get\n\\[\n\\begin{gathered}\n\\angle D B^{\\prime} I^{\\prime}=\\beta, \\quad \\angle D C^{\\prime} I^{\\prime}=\\gamma, \\quad \\text { and hence } \\angle B^{\\prime} I^{\\prime} C^{\\prime}=\\alpha ; \\\\\n\\angle E^{\\prime} I_{A}^{\\prime} F^{\\prime}=\\angle E^{\\prime} I_{A}^{\\prime} D-\\angle F^{\\prime} I_{A}^{\\prime} D=\\angle I_{A} E D-\\angle I_{A} F D=\\angle E I_{A} F=180^{\\circ}-\\alpha .\n\\end{gathered}\n\\]\n\nNext, we have\n\\[\n\\angle A^{\\prime} E^{\\prime} B^{\\prime}=\\angle D E^{\\prime} B^{\\prime}=\\angle D B E=\\beta=90^{\\circ}-\\frac{\\angle D B A}{2}=90^{\\circ}-\\frac{\\angle E^{\\prime} A^{\\prime} B^{\\prime}}{2},\n\\]\nwhich yields that triangle \\(A^{\\prime} B^{\\prime} E^{\\prime}\\) is isosceles with \\(A^{\\prime} B^{\\prime}=A^{\\prime} E^{\\prime}\\). Similarly, \\(A^{\\prime} F^{\\prime}=A^{\\prime} C^{\\prime}\\).\nFinally, we get\n\\[\n\\begin{aligned}\n\\angle A^{\\prime} B^{\\prime} I^{\\prime}=\\angle I^{\\prime} B^{\\prime} D-\\angle A^{\\prime} B^{\\prime} D=\\beta- & \\angle B A D=\\beta-\\left(90^{\\circ}-\\alpha\\right)+\\angle I A D \\\\\n& =\\angle I C D+\\angle I A D=\\angle C^{\\prime} I^{\\prime} D+\\angle A^{\\prime} I^{\\prime} D=\\angle C^{\\prime} I^{\\prime} A^{\\prime} ;\n\\end{aligned}\n\\]\nsimilarly, \\(\\angle A^{\\prime} C^{\\prime} I^{\\prime}=\\angle A^{\\prime} I^{\\prime} B^{\\prime}\\), so that triangles \\(A^{\\prime} B^{\\prime} I^{\\prime}\\) and \\(A^{\\prime} I^{\\prime} C^{\\prime}\\) are similar. Therefore, \\(A^{\\prime} I^{2}=A^{\\prime} B^{\\prime} \\cdot A^{\\prime} C^{\\prime}\\).\n\nRecall that we need to prove the tangency of line \\(A^{\\prime} I^{\\prime}=\\Omega^{\\prime}\\) with circle \\(\\left(E^{\\prime} F^{\\prime} I_{A}^{\\prime}\\right)=\\omega^{\\prime}\\). A desired tangency point \\(T^{\\prime}\\) must satisfy \\(A^{\\prime} T^{2}=A^{\\prime} E^{\\prime} \\cdot A^{\\prime} F^{\\prime}\\); the relations obtained above yield\n\\[\nA^{\\prime} E^{\\prime} \\cdot A^{\\prime} F^{\\prime}=A^{\\prime} B^{\\prime} \\cdot A^{\\prime} C^{\\prime}=A^{\\prime} I^{\\prime 2},\n\\]\nso that \\(T^{\\prime}\\) should be symmetric to \\(I^{\\prime}\\) with respect to \\(A^{\\prime}\\).\nThus, let us define a point \\(T^{\\prime}\\) as the reflection of \\(I^{\\prime}\\) in \\(A^{\\prime}\\), and show that \\(T^{\\prime}\\) lies on circle \\(\\Omega^{\\prime}\\); the equalities above will then imply that \\(A^{\\prime} T^{\\prime}\\) is tangent to \\(\\Omega^{\\prime}\\), as desired.\n![](https://cdn.mathpix.com/cropped/2025_08_23_b01e523c913a1e72c2d0g-62.jpg?height=729&width=1143&top_left_y=1570&top_left_x=459)\n\nThe property that triangles \\(B^{\\prime} A^{\\prime} I^{\\prime}\\) and \\(I^{\\prime} A^{\\prime} C^{\\prime}\\) are similar means that quadrilateral \\(B^{\\prime} I^{\\prime} C^{\\prime} T^{\\prime}\\) is harmonic. Indeed, let \\(C^{*}\\) be the reflection of \\(C^{\\prime}\\) in the perpendicular bisector of \\(I^{\\prime} T^{\\prime}\\); then \\(C^{*}\\) lies on \\(B^{\\prime} A^{\\prime}\\) by \\(\\angle B^{\\prime} A^{\\prime} I^{\\prime}=\\angle A^{\\prime} I^{\\prime} C^{\\prime}=\\angle T^{\\prime} I^{\\prime} C^{*}\\), and then \\(C^{*}\\) lies on circle ( \\(I^{\\prime} B^{\\prime} T^{\\prime}\\) ) since \\(A^{\\prime} B^{\\prime} \\cdot A^{\\prime} C^{*}=A^{\\prime} B^{\\prime} \\cdot A^{\\prime} C^{\\prime}=A^{\\prime} I^{2}=A^{\\prime} I^{\\prime} \\cdot A^{\\prime} T^{\\prime}\\). Therefore, \\(C^{\\prime}\\) also lies on that circle (and the circle is \\(\\left(B^{\\prime} I^{\\prime} C^{\\prime}\\right)=\\Gamma^{\\prime}\\) ). Moreover, \\(B^{\\prime} C^{*}\\) is a median in triangle \\(B^{\\prime} I^{\\prime} T^{\\prime}\\), so \\(B^{\\prime} C^{\\prime}\\) is its symmedian, which establishes harmonicity.\n\nNow we have \\(\\angle A^{\\prime} B^{\\prime} T^{\\prime}=\\angle I^{\\prime} B^{\\prime} C^{\\prime}=\\beta=\\angle A^{\\prime} B^{\\prime} E^{\\prime}\\); which shows that \\(E^{\\prime}\\) lies on \\(B^{\\prime} T^{\\prime}\\). Similarly, \\(F^{\\prime}\\) lies on \\(C^{\\prime} T^{\\prime}\\). Hence, \\(\\angle E^{\\prime} T^{\\prime} F^{\\prime}=\\angle B^{\\prime} I^{\\prime} C^{\\prime}=180^{\\circ}-\\angle E^{\\prime} I_{A}^{\\prime} F^{\\prime}\\), which establishes \\(T^{\\prime} \\in \\omega^{\\prime}\\).\n\nComment 2. The solution above could be finished without use of harmonicity. E.g., one may notice that both triangles \\(A^{\\prime} T^{\\prime} F^{\\prime}\\) and \\(A^{\\prime} E^{\\prime} T^{\\prime}\\) are similar to triangle \\(B^{\\prime} I^{\\prime} J\\), where \\(J\\) is the point symmetric to \\(I^{\\prime}\\) in the perpendicular bisector of \\(B^{\\prime} C^{\\prime}\\); indeed, we have \\(\\angle T^{\\prime} A^{\\prime} E^{\\prime}=\\gamma-\\beta=\\angle I^{\\prime} B^{\\prime} J^{\\prime}\\) and \\(\\frac{B^{\\prime} I^{\\prime}}{B^{\\prime} J^{\\prime}}=\\frac{B^{\\prime} I^{\\prime}}{C^{\\prime} I^{\\prime}}= \\frac{B^{\\prime} A^{\\prime}}{A^{\\prime} I^{\\prime}}=\\frac{A^{\\prime} E^{\\prime}}{A^{\\prime} T^{\\prime}}\\). This also allows to compute \\(\\angle E^{\\prime} T^{\\prime} F^{\\prime}=\\angle E^{\\prime} T^{\\prime} A^{\\prime}-\\angle F^{\\prime} T^{\\prime} A^{\\prime}=\\angle I^{\\prime} J B^{\\prime}-\\angle J I^{\\prime} B^{\\prime}=\\alpha\\).\n\nComment 3. Here we list several properties of the configuration in the problem, which can be derived from the solutions above.\n\nThe quadrilateral \\(I B T C\\) (as well as \\(I^{\\prime} B^{\\prime} T^{\\prime} C^{\\prime}\\) ) is harmonic. Hence, line \\(I T\\) contains the meeting point of tangents to \\(\\Gamma\\) at \\(B\\) and \\(C\\), i.e., the midpoint \\(N\\) of arc \\(B A C\\) in the circumcircle of \\(\\triangle A B C\\).", "source_pdf": "imosl_2020.pdf", "notes": "fallback-regex"}
{"id": "IMOSL-2020-G7", "contest": "IMOSL", "year": "2020", "problem_number": "G7", "problem": "Let \\(P\\) be a point on the circumcircle of an acute-angled triangle \\(A B C\\). Let \\(D\\), \\(E\\), and \\(F\\) be the reflections of \\(P\\) in the midlines of triangle \\(A B C\\) parallel to \\(B C, C A\\), and \\(A B\\), respectively. Denote by \\(\\omega_{A}, \\omega_{B}\\), and \\(\\omega_{C}\\) the circumcircles of triangles \\(A D P, B E P\\), and \\(C F P\\), respectively. Denote by \\(\\omega\\) the circumcircle of the triangle formed by the perpendicular bisectors of segments \\(A D, B E\\) and \\(C F\\).\n\nShow that \\(\\omega_{A}, \\omega_{B}, \\omega_{C}\\), and \\(\\omega\\) have a common point.\n(Denmark)", "solution": ". Let \\(A A_{1}, B B_{1}\\), and \\(C C_{1}\\) be the altitudes in triangle \\(A B C\\), and let \\(m_{A}, m_{B}\\), and \\(m_{C}\\) be the midlines parallel to \\(B C, C A\\), and \\(A B\\), respectively. We always denote by \\(\\Varangle(p, q)\\) the directed angle from a line \\(p\\) to a line \\(q\\), taken modulo \\(180^{\\circ}\\).\n\nStep 1: Circles \\(\\omega_{A}, \\omega_{B}\\), and \\(\\omega_{C}\\) share a common point \\(Q\\) different from \\(P\\).\nNotice that \\(m_{A}\\) is the perpendicular bisector of \\(P D\\), so \\(\\omega_{A}\\) is symmetric with respect to \\(m_{A}\\). Since \\(A\\) and \\(A_{1}\\) are also symmetric to each other in \\(m_{A}\\), the point \\(A_{1}\\) lies on \\(\\omega_{A}\\). Similarly, \\(B_{1}\\) and \\(C_{1}\\) lie on \\(\\omega_{B}\\) and \\(\\omega_{C}\\), respectively.\n\nLet \\(H\\) be the orthocenter of \\(\\triangle A B C\\). Quadrilaterals \\(A B A_{1} B_{1}\\) and \\(B C B_{1} C_{1}\\) are cyclic, so \\(A H \\cdot H A_{1}=B H \\cdot H B_{1}=C H \\cdot H C_{1}\\). This means that \\(H\\) lies on pairwise radical axes of \\(\\omega_{A}\\), \\(\\omega_{B}\\), and \\(\\omega_{C}\\). Point \\(P\\) also lies on those radical axes; hence the three circles have a common radical axis \\(\\ell=P H\\), and the second meeting point \\(Q\\) of \\(\\ell\\) with \\(\\omega_{A}\\) is the second common point of the three circles. Notice here that \\(H\\) lies inside all three circles, hence \\(Q \\neq P\\).\n![](https://cdn.mathpix.com/cropped/2025_08_23_b01e523c913a1e72c2d0g-64.jpg?height=924&width=1637&top_left_y=1284&top_left_x=217)\n\n\\section*{Step 2: Point \\(Q\\) lies on \\(\\omega\\).}\n\nLet \\(p_{A}, p_{B}\\), and \\(p_{C}\\) denote the perpendicular bisectors of \\(A D, B E\\), and \\(C F\\), respectively; denote by \\(\\Delta\\) the triangle formed by those perpendicular bisectors. By Simson's theorem, in order to show that \\(Q\\) lies on the circumcircle \\(\\omega\\) of \\(\\Delta\\), it suffices to prove that the projections of \\(Q\\) onto the sidelines \\(p_{A}, p_{B}\\), and \\(p_{C}\\) are collinear. Alternatively, but equivalently, it suffices to prove that the reflections \\(Q_{A}, Q_{B}\\), and \\(Q_{C}\\) of \\(Q\\) in those lines, respectively, are collinear. In fact, we will show that four points \\(P, Q_{A}, Q_{B}\\), and \\(Q_{C}\\) are collinear.\n\nSince \\(p_{A}\\) is the common perpendicular bisector of \\(A D\\) and \\(Q Q_{A}\\), the point \\(Q_{A}\\) lies on \\(\\omega_{A}\\), and, moreover, \\(\\Varangle\\left(D A, D Q_{A}\\right)=\\Varangle(A Q, A D)\\). Therefore,\n\\[\n\\Varangle\\left(P A, P Q_{A}\\right)=\\Varangle\\left(D A, D Q_{A}\\right)=\\Varangle(A Q, A D)=\\Varangle(P Q, P D)=\\Varangle(P Q, B C)+90^{\\circ} .\n\\]\n\nSimilarly, we get \\(\\Varangle\\left(P B, P Q_{B}\\right)=\\Varangle(P Q, C A)+90^{\\circ}\\). Therefore,\n\\[\n\\begin{aligned}\n\\Varangle\\left(P Q_{A}, P Q_{B}\\right)=\\Varangle\\left(P Q_{A}, P A\\right)+ & \\Varangle(P A, P B)+\\Varangle\\left(P B, P Q_{B}\\right) \\\\\n= & \\Varangle(B C, P Q)+90^{\\circ}+\\Varangle(C A, C B)+\\Varangle(P Q, C A)+90^{\\circ}=0,\n\\end{aligned}\n\\]\nwhich shows that \\(P, Q_{A}\\), and \\(Q_{B}\\) are collinear. Similarly, \\(Q_{C}\\) also lies on \\(P Q_{A}\\).\nComment 1. There are several variations of Step 2. In particular, let \\(O_{A}, O_{B}\\), and \\(O_{C}\\) denote the centers of \\(\\omega_{A}, \\omega_{B}\\), and \\(\\omega_{C}\\), respectively; they lie on \\(p_{A}, p_{B}\\), and \\(p_{C}\\), respectively. Moreover, all those centers lie on the perpendicular bisector \\(p\\) of \\(P Q\\). Now one can show that \\(\\Varangle\\left(Q O_{A}, p_{A}\\right)= \\Varangle\\left(Q O_{B}, p_{B}\\right)=\\Varangle\\left(Q O_{C}, p_{C}\\right)\\), and then finish by applying generalized Simson\u2019s theorem, Alternatively, but equivalently, those relations show that \\(Q\\) is the Miquel point of the lines \\(p_{A}, p_{B}, p_{C}\\), and \\(p\\).\n\nTo establish \\(\\Varangle\\left(Q O_{A}, p_{A}\\right)=\\Varangle\\left(Q O_{C}, p_{C}\\right)\\), notice that it is equivalent to \\(\\Varangle\\left(Q O_{A}, Q O_{C}\\right)=\\Varangle\\left(p_{A}, p_{C}\\right)\\) which may be obtained, e.g., as follows:\n\\[\n\\begin{aligned}\n& \\Varangle\\left(Q O_{A}, Q O_{C}\\right)=\\Varangle\\left(Q O_{A}, p\\right)+\\Varangle\\left(p, Q O_{C}\\right)=\\Varangle(A Q, A P)+\\Varangle(C P, C Q) \\\\\n& =\\Varangle(A Q, C Q)+\\Varangle(C P, A P)=\\Varangle(A Q, P Q)+\\Varangle(P Q, C Q)+\\Varangle(C B, A B) \\\\\n& \\quad=\\Varangle\\left(A D, A A_{1}\\right)+\\Varangle\\left(C C_{1}, C F\\right)+\\Varangle\\left(A A_{1}, C C_{1}\\right)=\\Varangle(A D, C F)=\\Varangle\\left(p_{A}, p_{C}\\right) .\n\\end{aligned}\n\\]\n![](https://cdn.mathpix.com/cropped/2025_08_23_b01e523c913a1e72c2d0g-65.jpg?height=929&width=838&top_left_y=1159&top_left_x=616)\n\nComment 2. The inversion at \\(H\\) with (negative) power \\(-A H \\cdot H A_{1}\\) maps \\(P\\) to \\(Q\\), and the circumcircle of \\(\\triangle A B C\\) to its Euler circle. Therefore, \\(Q\\) lies on that Euler circle.", "source_pdf": "imosl_2020.pdf", "notes": "fallback-regex"}
{"id": "IMOSL-2020-G8", "contest": "IMOSL", "year": "2020", "problem_number": "G8", "problem": "Let \\(\\Gamma\\) and \\(I\\) be the circumcircle and the incenter of an acute-angled triangle \\(A B C\\). Two circles \\(\\omega_{B}\\) and \\(\\omega_{C}\\) passing through \\(B\\) and \\(C\\), respectively, are tangent at \\(I\\). Let \\(\\omega_{B}\\) meet the shorter arc \\(A B\\) of \\(\\Gamma\\) and segment \\(A B\\) again at \\(P\\) and \\(M\\), respectively. Similarly, let \\(\\omega_{C}\\) meet the shorter arc \\(A C\\) of \\(\\Gamma\\) and segment \\(A C\\) again at \\(Q\\) and \\(N\\), respectively. The rays \\(P M\\) and \\(Q N\\) meet at \\(X\\), and the tangents to \\(\\omega_{B}\\) and \\(\\omega_{C}\\) at \\(B\\) and \\(C\\), respectively, meet at \\(Y\\).\n\nProve that the points \\(A, X\\), and \\(Y\\) are collinear.\n(Netherlands)", "solution": "1. Let \\(A I, B I\\), and \\(C I\\) meet \\(\\Gamma\\) again at \\(D, E\\), and \\(F\\), respectively. Let \\(\\ell\\) be the common tangent to \\(\\omega_{B}\\) and \\(\\omega_{C}\\) at \\(I\\). We always denote by \\(\\Varangle(p, q)\\) the directed angle from a line \\(p\\) to a line \\(q\\), taken modulo \\(180^{\\circ}\\).\n\nStep 1: We show that \\(Y\\) lies on \\(\\Gamma\\).\nRecall that any chord of a circle makes complementary directed angles with the tangents to the circle at its endpoints. Hence,\n\\[\n\\Varangle(B Y, B I)+\\Varangle(C I, C Y)=\\Varangle(I B, \\ell)+\\Varangle(\\ell, I C)=\\Varangle(I B, I C) .\n\\]\n\nTherefore,\n\\[\n\\begin{aligned}\n\\Varangle(B Y, B A)+\\Varangle(C A, C Y)=\\Varangle(B I, B A)+ & \\Varangle(B Y, B I)+\\Varangle(C I, C Y)+\\Varangle(C A, C I) \\\\\n& =\\Varangle(B C, B I)+\\Varangle(I B, I C)+\\Varangle(C I, C B)=0,\n\\end{aligned}\n\\]\nwhich yields \\(Y \\in \\Gamma\\).\n![](https://cdn.mathpix.com/cropped/2025_08_23_b01e523c913a1e72c2d0g-66.jpg?height=924&width=1023&top_left_y=1484&top_left_x=519)\n\nStep 2: We show that \\(X=\\ell \\cap E F\\).\nLet \\(X_{*}=\\ell \\cap E F\\). To prove our claim, it suffices to show that \\(X_{*}\\) lies on both \\(P M\\) and \\(Q N\\); this will yield \\(X_{*}=X\\). Due to symmetry, it suffices to show \\(X_{*} \\in Q N\\).\n\nNotice that\n\\[\n\\Varangle\\left(I X_{*}, I Q\\right)=\\Varangle(C I, C Q)=\\Varangle(C F, C Q)=\\Varangle(E F, E Q)=\\Varangle\\left(E X_{*}, E Q\\right) ;\n\\]\ntherefore, the points \\(X_{*}, I, Q\\), and \\(E\\) are concyclic (if \\(Q=E\\), then the direction of \\(E Q\\) is supposed to be the direction of a tangent to \\(\\Gamma\\) at \\(Q\\); in this case, the equality means that the circle ( \\(X_{*} I Q\\) ) is tangent to \\(\\Gamma\\) at \\(Q\\) ). Then we have\n\\[\n\\Varangle\\left(Q X_{*}, Q I\\right)=\\Varangle\\left(E X_{*}, E I\\right)=\\Varangle(E F, E B)=\\Varangle(C A, C F)=\\Varangle(C N, C I)=\\Varangle(Q N, Q I) \\text {, }\n\\]\nwhich shows that \\(X_{*} \\in Q N\\).\nStep 3: We finally show that \\(A, X\\), and \\(Y\\) are collinear.\nRecall that \\(I\\) is the orthocenter of triangle \\(D E F\\), and \\(A\\) is symmetric to \\(I\\) with respect to \\(E F\\). Therefore,\n\\[\n\\Varangle(A X, A E)=\\Varangle(I E, I X)=\\Varangle(B I, \\ell)=\\Varangle(B Y, B I)=\\Varangle(B Y, B E)=\\Varangle(A Y, A E),\n\\]\nwhich yields the desired collinearity.\nComment 1. Step 2 in the above solution seems to be crucial. After it has been performed (even without Step 1), there are different ways of finishing the solution.\nE.g., one may involve the notion of isogonal conjugacy. Let \\(X_{1}\\) and \\(Y_{1}\\) be isogonal conjugates of \\(X\\) and \\(Y\\), respectively, with respect to triangle \\(A B C\\). Since \\(X A=X I\\), triangle \\(A I X\\) is isosceles, and hence the lines \\(A X\\) and \\(X I\\) form equal angles with the internal bisector \\(A I\\) of \\(\\angle B A C\\). This means that \\(A X_{1} \\| X I\\), or \\(A X_{1} \\| \\ell\\).\n\nOn the other hand, the lines \\(B Y\\) and \\(\\ell\\) form equal angles with \\(B I\\), so that \\(B Y_{1} \\| \\ell\\). Similarly, \\(C Y_{1} \\| \\ell\\). This means that \\(Y_{1}\\) is an ideal point, and \\(A Y_{1} \\| \\ell\\) as well. Therefore, points \\(A, X_{1}\\), and \\(Y_{1}\\) are collinear, and hence \\(A, X\\), and \\(Y\\) are such.\n\nSolution 2. Perform an inversion centered at \\(I\\); the images of the points are denoted by primes, e.g., \\(A^{\\prime}\\) is the image of \\(A\\).\n\nOn the inverted figure, \\(I\\) and \\(\\Gamma^{\\prime}\\) are the orthocenter and the circumcircle of triangle \\(A^{\\prime} B^{\\prime} C^{\\prime}\\), respectively. The points \\(P^{\\prime}\\) and \\(Q^{\\prime}\\) lie on \\(\\Gamma^{\\prime}\\) such that \\(B^{\\prime} P^{\\prime} \\| C^{\\prime} Q^{\\prime}\\) (since \\(B^{\\prime} P^{\\prime}=\\omega_{B}^{\\prime}\\) and \\(C^{\\prime} Q^{\\prime}=\\omega_{C}^{\\prime}\\) ). The points \\(M^{\\prime}\\) and \\(N^{\\prime}\\) are the second intersections of lines \\(B^{\\prime} P^{\\prime}\\) and \\(C^{\\prime} Q^{\\prime}\\) with the circumcircles \\(\\gamma_{B}\\) and \\(\\gamma_{C}\\) of triangles \\(A^{\\prime} I B^{\\prime}\\) and \\(A^{\\prime} I C^{\\prime}\\), respectively. Notice here that \\(\\gamma_{C}\\) is obtained from \\(\\gamma_{B}\\) by the translation at \\(\\overrightarrow{B^{\\prime} C^{\\prime}}\\); the same translation maps line \\(B^{\\prime} P^{\\prime}\\) to \\(C^{\\prime} Q^{\\prime}\\), and hence \\(M^{\\prime}\\) to \\(N^{\\prime}\\). In other words, \\(B^{\\prime} M^{\\prime} N^{\\prime} C^{\\prime}\\) is a parallelogram, and \\(P^{\\prime} Q^{\\prime}\\) partitions it into two isosceles trapezoids.\n\nPoint \\(X^{\\prime}\\) is the second intersection point of circles ( \\(I P^{\\prime} M^{\\prime}\\) ) and ( \\(I Q^{\\prime} N^{\\prime}\\) ) that is - the reflection of \\(I\\) in their line of centers. But the centers lie on the common perpendicular bisector \\(p\\) of \\(P^{\\prime} M^{\\prime}\\) and \\(Q^{\\prime} N^{\\prime}\\), so \\(p\\) is that line of centers. Hence, \\(I X^{\\prime} \\| B^{\\prime} P^{\\prime}\\), as both lines are perpendicular to \\(p\\).\n\nFinally, the point \\(Y\\) satisfies \\(\\Varangle(B Y, B I)=\\Varangle(P B, P I)\\) and \\(\\Varangle(C Y, C I)=\\Varangle(Q C, Q I)\\), which yields \\(\\Varangle\\left(Y^{\\prime} B^{\\prime}, Y^{\\prime} I\\right)=\\Varangle\\left(B^{\\prime} P^{\\prime}, B^{\\prime} I\\right)\\) and \\(\\Varangle\\left(Y^{\\prime} C^{\\prime}, Y^{\\prime} I\\right)=\\Varangle\\left(C^{\\prime} Q^{\\prime}, C^{\\prime} I\\right)\\). Therefore,\n\\[\n\\Varangle\\left(Y^{\\prime} B^{\\prime}, Y^{\\prime} C^{\\prime}\\right)=\\Varangle\\left(B^{\\prime} P^{\\prime}, B^{\\prime} I\\right)+\\Varangle\\left(C^{\\prime} I, C^{\\prime} Q^{\\prime}\\right)=\\Varangle\\left(C^{\\prime} I, B^{\\prime} I\\right)=\\Varangle\\left(A^{\\prime} B^{\\prime}, A^{\\prime} C^{\\prime}\\right),\n\\]\nwhich shows that \\(Y^{\\prime} \\in \\Gamma^{\\prime}\\).\nIn congruent circles \\(\\Gamma^{\\prime}\\) and \\(\\gamma_{B}\\), the chords \\(A^{\\prime} P^{\\prime}\\) and \\(A^{\\prime} M^{\\prime}\\) subtend the same angle \\(\\angle A^{\\prime} B^{\\prime} P^{\\prime}\\); therefore, \\(A^{\\prime} P^{\\prime}=A^{\\prime} M^{\\prime}\\), and hence \\(A^{\\prime} \\in p\\). This yields \\(A^{\\prime} X^{\\prime}=A^{\\prime} I\\), and hence \\(\\Varangle\\left(I A^{\\prime}, I X^{\\prime}\\right)= \\Varangle\\left(X^{\\prime} I, X^{\\prime} A^{\\prime}\\right)\\).\n\nFinally, we have\n\\[\n\\begin{aligned}\n\\Varangle\\left(Y^{\\prime} I, Y^{\\prime} A^{\\prime}\\right)= & \\Varangle\\left(Y^{\\prime} I, Y^{\\prime} B^{\\prime}\\right)+\\Varangle\\left(Y^{\\prime} B^{\\prime}, Y^{\\prime} A^{\\prime}\\right) \\\\\n= & \\Varangle\\left(B^{\\prime} I, B^{\\prime} P^{\\prime}\\right)+\\Varangle\\left(I A^{\\prime}, I B^{\\prime}\\right)=\\Varangle\\left(I A^{\\prime}, B^{\\prime} P^{\\prime}\\right)=\\Varangle\\left(I A^{\\prime}, I X^{\\prime}\\right)=\\Varangle\\left(X^{\\prime} I, X^{\\prime} A^{\\prime}\\right),\n\\end{aligned}\n\\]\nwhich yields that the points \\(A^{\\prime}, X^{\\prime}, Y^{\\prime}\\), and \\(I\\) are concyclic. This means exactly that \\(A, X\\), and \\(Y\\) are collinear.\n![](https://cdn.mathpix.com/cropped/2025_08_23_b01e523c913a1e72c2d0g-68.jpg?height=952&width=1532&top_left_y=208&top_left_x=265)\n\nComment 2. An inversion at \\(I\\) may also help in establishing Step 2 in Solution 1. Indeed, relation \\(A^{\\prime} X^{\\prime}=A^{\\prime} I\\) yields \\(X A=X I\\), so that \\(X \\in E F\\). On the other hand, \\(I X^{\\prime} \\| B^{\\prime} P^{\\prime}\\) yields \\(I X \\| \\ell\\), i.e., \\(X \\in \\ell\\).", "source_pdf": "imosl_2020.pdf", "notes": "fallback-regex"}
{"id": "IMOSL-2020-N1", "contest": "IMOSL", "year": "2020", "problem_number": "N1", "problem": "Given a positive integer \\(k\\), show that there exists a prime \\(p\\) such that one can choose distinct integers \\(a_{1}, a_{2}, \\ldots, a_{k+3} \\in\\{1,2, \\ldots, p-1\\}\\) such that \\(p\\) divides \\(a_{i} a_{i+1} a_{i+2} a_{i+3}-i\\) for all \\(i=1,2, \\ldots, k\\).\n(South Africa)", "solution": ". First we choose distinct positive rational numbers \\(r_{1}, \\ldots, r_{k+3}\\) such that\n\\[\nr_{i} r_{i+1} r_{i+2} r_{i+3}=i \\quad \\text { for } 1 \\leqslant i \\leqslant k .\n\\]\n\nLet \\(r_{1}=x, r_{2}=y, r_{3}=z\\) be some distinct primes greater than \\(k\\); the remaining terms satisfy \\(r_{4}=\\frac{1}{r_{1} r_{2} r_{3}}\\) and \\(r_{i+4}=\\frac{i+1}{i} r_{i}\\). It follows that if \\(r_{i}\\) are represented as irreducible fractions, the numerators are divisible by \\(x\\) for \\(i \\equiv 1(\\bmod 4)\\), by \\(y\\) for \\(i \\equiv 2(\\bmod 4)\\), by \\(z\\) for \\(i \\equiv 3(\\bmod 4)\\) and by none for \\(i \\equiv 0(\\bmod 4)\\). Notice that \\(r_{i}<r_{i+4}\\); thus the sequences \\(r_{1}<r_{5}<r_{9}<\\ldots\\), \\(r_{2}<r_{6}<r_{10}<\\ldots, r_{3}<r_{7}<r_{11}<\\ldots, r_{4}<r_{8}<r_{12}<\\ldots\\) are increasing and have no common terms, that is, all \\(r_{i}\\) are distinct.\n\nIf each \\(r_{i}\\) is represented by an irreducible fraction \\(\\frac{u_{i}}{v_{i}}\\), choose a prime \\(p\\) which divides neither \\(v_{i}, 1 \\leqslant i \\leqslant k+1\\), nor \\(v_{i} v_{j}\\left(r_{i}-r_{j}\\right)=v_{j} u_{i}-v_{i} u_{j}\\) for \\(i<j\\), and define \\(a_{i}\\) by the congruence \\(a_{i} v_{i} \\equiv u_{i}(\\bmod p)\\). Since \\(r_{i} r_{i+1} r_{i+2} r_{i+3}=i\\), we have\n\\[\n\\begin{aligned}\ni v_{i} v_{i+1} v_{i+2} v_{i+3}=r_{i} v_{i} r_{i+1} v_{i+1} r_{i+2} v_{i+2} r_{i+3} v_{i+3} & \\\\\n& =u_{i} u_{i+1} u_{i+2} u_{i+3} \\equiv a_{i} v_{i} a_{i+1} v_{i+1} a_{i+2} v_{i+2} a_{i+3} v_{i+3} \\quad(\\bmod p)\n\\end{aligned}\n\\]\nand therefore \\(a_{i} a_{i+1} a_{i+2} a_{i+3} \\equiv i(\\bmod p)\\) for \\(1 \\leqslant i \\leqslant k\\).\nIf \\(a_{i} \\equiv a_{j}(\\bmod p)\\), then \\(u_{i} v_{j} \\equiv a_{i} v_{i} v_{j} \\equiv u_{j} v_{i}(\\bmod p)\\), a contradiction.\nComment. One can explicitly express residues \\(b_{i} \\equiv a_{1} a_{2} \\cdot \\ldots \\cdot a_{i}(\\bmod p)\\) in terms of \\(b_{1}, b_{2}, b_{3}\\) and \\(b_{0}=1\\) :\n\\[\nb_{i+3}=i(i-4)(i-8) \\cdot \\ldots \\cdot(i-4 k+4) b_{r},\n\\]\nwhere \\(i+3=4 k+r, 0 \\leqslant r<4\\). Then the numbers \\(a_{i}\\) are found from the congruences \\(b_{i-1} a_{i} \\equiv b_{i} (\\bmod p)\\), and choosing \\(p\\) so that \\(a_{i}\\) are not congruent modulo \\(p\\) is done in a way very similar to the above solution.", "source_pdf": "imosl_2020.pdf", "notes": "fallback-regex"}
{"id": "IMOSL-2020-N2", "contest": "IMOSL", "year": "2020", "problem_number": "N2", "problem": "For each prime \\(p\\), there is a kingdom of \\(p\\)-Landia consisting of \\(p\\) islands numbered \\(1,2, \\ldots, p\\). Two distinct islands numbered \\(n\\) and \\(m\\) are connected by a bridge if and only if \\(p\\) divides \\(\\left(n^{2}-m+1\\right)\\left(m^{2}-n+1\\right)\\). The bridges may pass over each other, but cannot cross. Prove that for infinitely many \\(p\\) there are two islands in \\(p\\)-Landia not connected by a chain of bridges.\n(Denmark)", "solution": "1. We prove that for each prime \\(p>3\\) dividing a number of the form \\(x^{2}-x+1\\) with integer \\(x\\) there are two unconnected islands in \\(p\\)-Landia.\n\nFor brevity's sake, when a bridge connects the islands numbered \\(m\\) and \\(n\\), we shall speak simply that it connects \\(m\\) and \\(n\\).\n\nA bridge connects \\(m\\) and \\(n\\) if \\(n \\equiv m^{2}+1(\\bmod p)\\) or \\(m \\equiv n^{2}+1(\\bmod p)\\). If \\(m^{2}+1 \\equiv n (\\bmod p)\\), we draw an arrow starting at \\(m\\) on the bridge connecting \\(m\\) and \\(n\\). Clearly only one arrow starts at \\(m\\) if \\(m^{2}+1 \\not \\equiv m(\\bmod p)\\), and no arrows otherwise. The total number of bridges does not exceed the total number of arrows.\n\nSuppose \\(x^{2}-x+1 \\equiv 0(\\bmod p)\\). We may assume that \\(1 \\leqslant x \\leqslant p\\); then there is no arrow starting at \\(x\\). Since \\((1-x)^{2}-(1-x)+1=x^{2}-x+1,(p+1-x)^{2}+1 \\equiv(p+1-x)(\\bmod p)\\), and there is also no arrow starting at \\(p+1-x\\). If \\(x=p+1-x\\), that is, \\(x=\\frac{p+1}{2}\\), then \\(4\\left(x^{2}-x+1\\right)=p^{2}+3\\) and therefore \\(x^{2}-x+1\\) is not divisible by \\(p\\). Thus the islands \\(x\\) and \\(p+1-x\\) are different, and no arrows start at either of them. It follows that the total number of bridges in \\(p\\)-Landia does not exceed \\(p-2\\).\n\nLet \\(1,2, \\ldots, p\\) be the vertices of a graph \\(G_{p}\\), where an edge connects \\(m\\) and \\(n\\) if and only if there is a bridge between \\(m\\) and \\(n\\). The number of vertices of \\(G_{p}\\) is \\(p\\) and the number of edges is less than \\(p-1\\). This means that the graph is not connected, which means that there are two islands not connected by a chain of bridges.\n\nIt remains to prove that there are infinitely many primes \\(p\\) dividing \\(x^{2}-x+1\\) for some integer \\(x\\). Let \\(p_{1}, p_{2}, \\ldots, p_{k}\\) be any finite set of such primes. The number \\(\\left(p_{1} p_{2} \\cdot \\ldots \\cdot p_{k}\\right)^{2}-p_{1} p_{2} \\cdot \\ldots \\cdot p_{k}+1\\) is greater than 1 and not divisible by any \\(p_{i}\\); therefore it has another prime divisor with the required property.\n\nSolution 2. One can show, by using only arithmetical methods, that for infinitely many \\(p\\), the kingdom of \\(p\\)-Ladia contains two islands connected to no other island, except for each other.\n\nLet arrows between islands have the same meaning as in the previous solution. Suppose that positive \\(a<p\\) satisfies the congruence \\(x^{2}-x+1 \\equiv 0(\\bmod p)\\). We have seen in the first solution that \\(b=p+1-a\\) satisfies it too, and \\(b \\neq a\\) when \\(p>3\\). It follows that \\(a b \\equiv a(1-a) \\equiv 1 (\\bmod p)\\). If an arrow goes from \\(t\\) to \\(a\\), then \\(t\\) must satisfy the congruence \\(t^{2}+1 \\equiv a \\equiv a^{2}+1 (\\bmod p)\\); the only such \\(t \\neq a\\) is \\(p-a\\). Similarly, the only arrow going to \\(b\\) goes from \\(p-b\\). If one of the numbers \\(p-a\\) and \\(p-b\\), say, \\(p-a\\), is not at the end of any arrow, the pair \\(a, p-a\\) is not connected with the rest of the islands. This is true if at least one of the congruences \\(x^{2}+1 \\equiv-a, x^{2}+1 \\equiv-b\\) has no solutions, that is, either \\(-a-1\\) or \\(-b-1\\) is a quadratic non-residue modulo \\(p\\).\n\nNote that \\(x^{2}-x+1 \\equiv x^{2}-(a+b) x+a b \\equiv(x-a)(x-b)(\\bmod p)\\). Substituting \\(x=-1\\) we get \\((-1-a)(-1-b) \\equiv 3(\\bmod p)\\). If 3 is a quadratic non-residue modulo \\(p\\), so is one of the numbers \\(-1-a\\) and \\(-1-b\\).\n\nThus it is enough to find infinitely many primes \\(p>3\\) dividing \\(x^{2}-x+1\\) for some integer \\(x\\) and such that 3 is a quadratic non-residue modulo \\(p\\).\n\nIf \\(x^{2}-x+1 \\equiv 0(\\bmod p)\\) then \\((2 x-1)^{2} \\equiv-3(\\bmod p)\\), that is, -3 is a quadratic residue modulo \\(p\\), so 3 is a quadratic non-residue if and only if -1 is also a non-residue, in other words, \\(p \\equiv-1(\\bmod 4)\\).\n\nSimilarly to the first solution, let \\(p_{1}, \\ldots, p_{k}\\) be primes congruent to -1 modulo 4 and dividing numbers of the form \\(x^{2}-x+1\\). The number \\(\\left(2 p_{1} \\cdot \\ldots \\cdot p_{k}\\right)^{2}-2 p_{1} \\cdot \\ldots \\cdot p_{k}+1\\) is\nnot divisible by any \\(p_{i}\\) and is congruent to -1 modulo 4 , therefore, it has some prime divisor \\(p \\equiv-1(\\bmod 4)\\) which has the required properties.", "source_pdf": "imosl_2020.pdf", "notes": "fallback-regex"}
{"id": "IMOSL-2020-N4", "contest": "IMOSL", "year": "2020", "problem_number": "N4", "problem": "For any odd prime \\(p\\) and any integer \\(n\\), let \\(d_{p}(n) \\in\\{0,1, \\ldots, p-1\\}\\) denote the remainder when \\(n\\) is divided by \\(p\\). We say that \\(\\left(a_{0}, a_{1}, a_{2}, \\ldots\\right)\\) is a \\(p\\)-sequence, if \\(a_{0}\\) is a positive integer coprime to \\(p\\), and \\(a_{n+1}=a_{n}+d_{p}\\left(a_{n}\\right)\\) for \\(n \\geqslant 0\\).\n(a) Do there exist infinitely many primes \\(p\\) for which there exist \\(p\\)-sequences ( \\(a_{0}, a_{1}, a_{2}, \\ldots\\) ) and ( \\(b_{0}, b_{1}, b_{2}, \\ldots\\) ) such that \\(a_{n}>b_{n}\\) for infinitely many \\(n\\), and \\(b_{n}>a_{n}\\) for infinitely many \\(n\\) ?\n(b) Do there exist infinitely many primes \\(p\\) for which there exist \\(p\\)-sequences ( \\(a_{0}, a_{1}, a_{2}, \\ldots\\) ) and ( \\(b_{0}, b_{1}, b_{2}, \\ldots\\) ) such that \\(a_{0}<b_{0}\\), but \\(a_{n}>b_{n}\\) for all \\(n \\geqslant 1\\) ?\n(United Kingdom)", "solution": "Answer: Yes, for both parts.\n\n. Fix some odd prime \\(p\\), and let \\(T\\) be the smallest positive integer such that \\(p \\mid 2^{T}-1\\); in other words, \\(T\\) is the multiplicative order of 2 modulo \\(p\\).\n\nConsider any \\(p\\)-sequence \\(\\left(x_{n}\\right)=\\left(x_{0}, x_{1}, x_{2}, \\ldots\\right)\\). Obviously, \\(x_{n+1} \\equiv 2 x_{n}(\\bmod p)\\) and therefore \\(x_{n} \\equiv 2^{n} x_{0}(\\bmod p)\\). This yields \\(x_{n+T} \\equiv x_{n}(\\bmod p)\\) and therefore \\(d\\left(x_{n+T}\\right)=d\\left(x_{n}\\right)\\) for all \\(n \\geqslant 0\\). It follows that the sum \\(d\\left(x_{n}\\right)+d\\left(x_{n+1}\\right)+\\ldots+d\\left(x_{n+T-1}\\right)\\) does not depend on \\(n\\) and is thus a function of \\(x_{0}\\) (and \\(p\\) ) only; we shall denote this sum by \\(S_{p}\\left(x_{0}\\right)\\), and extend the function \\(S_{p}(\\cdot)\\) to all (not necessarily positive) integers. Therefore, we have \\(x_{n+k T}=x_{n}+k S_{p}\\left(x_{0}\\right)\\) for all positive integers \\(n\\) and \\(k\\). Clearly, \\(S_{p}\\left(x_{0}\\right)=S_{p}\\left(2^{t} x_{0}\\right)\\) for every integer \\(t \\geqslant 0\\).\n\nIn both parts, we use the notation\n\\[\nS_{p}^{+}=S_{p}(1)=\\sum_{i=0}^{T-1} d_{p}\\left(2^{i}\\right) \\quad \\text { and } \\quad S_{p}^{-}=S_{p}(-1)=\\sum_{i=0}^{T-1} d_{p}\\left(p-2^{i}\\right) .\n\\]\n(a) Let \\(q>3\\) be a prime and \\(p\\) a prime divisor of \\(2^{q}+1\\) that is greater than 3 . We will show that \\(p\\) is suitable for part (a). Notice that \\(9 \\nmid 2^{q}+1\\), so that such a \\(p\\) exists. Moreover, for any two odd primes \\(q<r\\) we have \\(\\operatorname{gcd}\\left(2^{q}+1,2^{r}+1\\right)=2^{\\operatorname{gcd}(q, r)}+1=3\\), thus there exist infinitely many such primes \\(p\\).\n\nFor the chosen \\(p\\), we have \\(T=2 q\\). Since \\(2^{q} \\equiv-1(\\bmod p)\\), we have \\(S_{p}^{+}=S_{p}^{-}\\). Now consider the \\(p\\)-sequences ( \\(a_{n}\\) ) and ( \\(b_{n}\\) ) with \\(a_{0}=p+1\\) and \\(b_{0}=p-1\\); we claim that these sequences satisfy the required conditions. We have \\(a_{0}>b_{0}\\) and \\(a_{1}=p+2<b_{1}=2 p-2\\). It follows then that\n\\[\na_{k \\cdot 2 q}=a_{0}+k S_{p}^{+}>b_{0}+k S_{p}^{+}=b_{k \\cdot 2 q} \\quad \\text { and } \\quad a_{k \\cdot 2 q+1}=a_{1}+k S_{p}^{+}<b_{1}+k S_{p}^{+}=b_{k \\cdot 2 q+1}\n\\]\nfor all \\(k=0,1, \\ldots\\), as desired.\n(b) Let \\(q\\) be an odd prime and \\(p\\) a prime divisor of \\(2^{q}-1\\); thus we have \\(T=q\\). We will show that \\(p\\) is suitable for part (b). Notice that the numbers of the form \\(2^{q}-1\\) are pairwise coprime (since \\(\\operatorname{gcd}\\left(2^{q}-1,2^{r}-1\\right)=2^{\\operatorname{gcd}(q, r)}-1=1\\) for any two distinct primes \\(q\\) and \\(r\\) ), thus there exist infinitely many such primes \\(p\\). Notice that \\(d_{p}(x)+d_{p}(p-x)=p\\) for all \\(x\\) with \\(p \\nmid x\\), so that the sum \\(S_{p}^{+}+S_{p}^{-}=p q\\) is odd, which yields \\(S_{p}^{+}=S_{p}(1) \\neq S_{p}(-1)=S_{p}^{-}\\).\n\nAssume that \\(\\left(x_{n}\\right)\\) and \\(\\left(y_{n}\\right)\\) are two \\(p\\)-sequences with \\(S_{p}\\left(x_{0}\\right)>S_{p}\\left(y_{0}\\right)\\) but \\(x_{0}<y_{0}\\). The first condition yields that\n\\[\nx_{M q+r}-y_{M q+r}=\\left(x_{r}-y_{r}\\right)+M\\left(S_{p}\\left(x_{0}\\right)-S_{p}\\left(y_{0}\\right)\\right) \\geqslant\\left(x_{r}-y_{r}\\right)+M\n\\]\nfor all nonnegative integers \\(M\\) and every \\(r=0,1, \\ldots, q-1\\). Thus, we have \\(x_{n}>y_{n}\\) for every \\(n \\geqslant q+q \\cdot \\max \\left\\{y_{r}-x_{r}: r=0,1, \\ldots, q-1\\right\\}\\). Now, since \\(x_{0}<y_{0}\\), there exists the largest \\(n_{0}\\) with \\(x_{n_{0}}<y_{n_{0}}\\). In this case the \\(p\\)-sequences \\(a_{n}=x_{n-n_{0}}\\) and \\(b_{n}=y_{n-n_{0}}\\) possess the desired property (notice here that \\(x_{n} \\neq y_{n}\\) for all \\(n \\geqslant 0\\), as otherwise we would have \\(S_{p}\\left(x_{0}\\right)=S_{p}\\left(x_{n}\\right)=S_{p}\\left(y_{n}\\right)=S_{p}\\left(y_{0}\\right)\\) ).\n\nIt remains to find \\(p\\)-sequences ( \\(x_{n}\\) ) and ( \\(y_{n}\\) ) satisfying the two conditions. Recall that \\(S_{p}^{+} \\neq S_{p}^{-}\\). Now, if \\(S_{p}^{+}>S_{p}^{-}\\), then we can put \\(x_{0}=1\\) and \\(y_{0}=p-1\\). Otherwise, if \\(S_{p}^{+}<S_{p}^{-}\\), then we put \\(x_{0}=p-1\\) and \\(y_{0}=p+1\\).", "source_pdf": "imosl_2020.pdf", "notes": "fallback-regex"}
{"id": "IMOSL-2020-N5", "contest": "IMOSL", "year": "2020", "problem_number": "N5", "problem": "Determine all functions \\(f\\) defined on the set of all positive integers and taking non-negative integer values, satisfying the three conditions:\n(i) \\(f(n) \\neq 0\\) for at least one \\(n\\);\n(ii) \\(f(x y)=f(x)+f(y)\\) for every positive integers \\(x\\) and \\(y\\);\n(iii) there are infinitely many positive integers \\(n\\) such that \\(f(k)=f(n-k)\\) for all \\(k<n\\).\n(Croatia)", "solution": "Answer: The sought functions are those of the form \\(f(n)=c \\cdot \\nu_{p}(n)\\), where \\(p\\) is some prime, \\(c\\) is a nonnegative integer, and \\(\\nu_{p}(n)\\) denotes the exponent of \\(p\\) in the prime decomposition of \\(n\\).\n\n1. If a number \\(n\\) is a product of primes, \\(n=p_{1} p_{2} \\cdot \\ldots \\cdot p_{k}\\), then\n\\[\nf(n)=f\\left(p_{1}\\right)+\\ldots+f\\left(p_{k}\\right),\n\\]\nin particular, \\(f(1)=0(\\) since \\(f(1)=f(1)+f(1))\\).\nIt is also clear that \\(f(n)=0\\) implies \\(f(p)=0\\) for all primes \\(p\\) dividing \\(n\\).\nLet us call positive integer \\(n\\) good if \\(f(k)=f(n-k)\\) for \\(0<k<n\\). If \\(n\\) is good then each its divisor \\(d\\) is also good; indeed, if \\(n=d m\\) then\n\\[\nf(k)=f(m k)-f(m)=f(n-m k)-f(m)=f(m(d-k))-f(m)=f(d-k)\n\\]\nfor \\(0<k<d\\). Thus, good numbers are products of good primes.\nIt follows immediately from (i) that there exists a prime \\(p\\) such that \\(f(p) \\neq 0\\); let \\(p\\) be the smallest such prime. Then \\(f(r)=0\\) for all \\(r<p\\) (since all prime divisors of \\(r<p\\) are less than \\(p\\) ). Now every good number \\(n>p\\) must be divisible by \\(p\\). Indeed, if \\(n=p k+r\\) is a good number, \\(k>0,0<r<p\\), then \\(f(p) \\leqslant f(p k)=f(n-p k)=f(r)=0\\), a contradiction. Since any divisor of a good number is also good, this means that if a divisor \\(r\\) of a good number is not divisible by \\(p\\), it is less than \\(p\\). Thus all good numbers have the form \\(r \\cdot p^{k}\\) with \\(r<p\\). The condition (iii) implies that \\(k\\) can be arbitrarily large, consequently all powers of \\(p\\) are good.\n\nIf \\(q \\neq p\\) is a prime, \\(p^{q-1}-1\\) is divisible by \\(q\\) and \\(p^{q-1}\\) is good. Then \\(f(q) \\leqslant f\\left(p^{q-1}-1\\right)= f(1)=0\\), that is, \\(f(q)=0\\).\n\nNow we see that \\(f(n)=\\nu_{p}(n) \\cdot c\\), where \\(c=f(p)\\). The conditions (i) and (ii) for all such functions with \\(c \\neq 0\\) are obvious; the condition (iii) holds for all \\(n=p^{m}\\), since \\(\\nu_{p}\\left(p^{m}-k\\right)=\\nu_{p}(k)\\) when \\(0<k<p^{m}\\).\n\nSolution 2. We use the notion of a good number from the previous solution. As above, we also denote by \\(\\nu_{p}(n)\\) the exponent of a prime \\(p\\) in the prime decomposition of \\(n\\).\n\nSay that a positive integer \\(k\\) is big if \\(f(k)>0\\). Let \\(\\mathcal{B}\\) be the set of big primes, and let \\(p_{1}<p_{2}<\\ldots\\) list the elements of \\(\\mathcal{B}\\) (this set might be either finite or infinite). By the problem conditions, we have\n\\[\nf(n)=\\sum_{i} \\nu_{p_{i}}(n) f\\left(p_{i}\\right) ;\n\\]\nthus, the big numbers are those divisible by at least one big prime.\nFor a positive integer \\(k\\), define its essence \\(e(k)\\) to be the largest product \\(e\\) of (not necessarily different) big primes such that \\(e \\mid k\\). In other words,\n\\[\ne(n)=\\prod_{p_{i} \\in \\mathcal{B}} p_{i}^{\\nu_{p_{i}}(n)}\n\\]\n\nThis yields that \\(k / e(k)\\) is not big, so \\(f(k)=f(e(k))+f(k / e(k))=f(e(k))\\).\nLemma. Assume that \\(n\\) is a good number. Then \\(e(k)=e(n-k)\\) for all \\(k<n\\).\n\nProof. Arguing indirectly, choose a minimal \\(k\\) for which the claim of the lemma is violated. Clearly, \\(k\\) is big, as otherwise \\(f(k)=f(n-k)=0\\) and hence \\(e(k)=e(n-k)=1\\).\n\nThere are \\(t=k / e(k)\\) multiples of \\(e(k)\\) in each of the segments \\([1, k]\\) and \\([n-k, n-1]\\). On the other hand, there are \\(t-1\\) such multiples on \\([1, k-1]\\) - and, by minimality of \\(k\\), on \\([n-k+1, n-1]\\) as well. This yields that \\(n-k\\) is a multiple of \\(e(k)\\). Therefore,\n\\[\nf(e(k))=f(k)=f(n-k)=f(e(k))+f\\left(\\frac{n-k}{e(k)}\\right),\n\\]\nso the last summand vanishes, hence \\(\\frac{n-k}{e(k)}\\) has no big prime divisors, that is, \\(e(n-k)=e(k)\\). This contradicts our choice.\n\nBack to the problem, assume that \\(|\\mathcal{B}| \\geqslant 2\\). Take any good number \\(n>p_{1} p_{2}\\), and let \\(p_{1}^{\\alpha}\\) be the largest power of \\(p_{1}\\) smaller than \\(n\\), so that \\(n \\leqslant p_{1}^{\\alpha+1}<p_{1}^{\\alpha} p_{2}\\). By the lemma, \\(e\\left(n-p_{1}^{\\alpha}\\right)=e\\left(p_{1}^{\\alpha}\\right)=p_{1}^{\\alpha}\\), which yields \\(p_{1}^{\\alpha} \\mid n\\). Similarly, \\(p_{2} \\mid n\\), so that \\(n \\geqslant p_{1}^{\\alpha} p_{2}\\). This contradiction shows that \\(|\\mathcal{B}| \\leqslant 1\\), which by (1) yields that \\(f\\) is listed in the answer.\n\nSolution 3. We have \\(f\\left(\\prod p_{i}^{\\alpha_{i}}\\right)=\\sum \\alpha_{i} f\\left(p_{i}\\right)\\). Note that\n\\[\nf(n-1)+f(n-2)+\\ldots+\\ldots f(n-k) \\geqslant f(1)+\\ldots+f(k)\n\\]\nfor all \\(k=1,2, \\ldots, n-1\\), since the difference LHS-RHS is just \\(f\\left(\\binom{n-1}{k}\\right)\\). Assume that \\(f(p)>0\\). If \\(f(k)=f(n-k)\\) for all \\(k\\), it implies that \\(\\binom{n-1}{k}\\) is not divisible by \\(p\\) for all \\(k=1,2, \\ldots, n-2\\). It is well known that it implies \\(n=a \\cdot p^{s}, a<p\\). If there are two primes \\(p, q\\) such that \\(f(p)>0, f(q)>0\\), there exist only finitely many \\(n\\) which are equal both to \\(a \\cdot p^{s}, a<p\\), and \\(b \\cdot q^{t}, b<q\\). So there exists at most one such \\(p\\), and therefore \\(f(n)=C \\cdot \\nu_{p}(n)\\) for some constant \\(C\\).\n\nSolution 4. We call a function \\(f: \\mathbb{N} \\rightarrow \\mathbb{N}_{0}\\) satisfying (ii) additive. We call a pair ( \\(f, n\\) ), where \\(f\\) is an additive function and \\(n \\in \\mathbb{N}\\), good, if for all \\(k<n\\) it holds \\(f(k)=f(n-k)\\). For an additive function \\(f\\) and a prime number \\(p\\) the number \\(\\frac{f(p)}{\\ln p}\\) is denoted by \\(g(f, p)\\).\n\nLet \\((f, n)\\) be a good pair such that \\(f(p)>0\\) for at least two primes less than \\(n\\). Let \\(p_{0}\\) be the prime with maximal \\(g(f, p)\\) among all primes \\(p<n\\). Let \\(a_{0}\\) be the maximal exponent such that \\(p_{0}^{a_{0}}<n\\). Then \\(f(k)<f\\left(p_{0}^{a_{0}}\\right)\\) for all \\(k<p_{0}^{a_{0}}\\). Indeed, if \\(k=p_{1}^{a_{1}} \\ldots p_{m}^{a_{m}}<p_{0}^{a_{0}}\\), then\n\\[\n\\begin{aligned}\nf(k) & =a_{1} f\\left(p_{1}\\right)+\\ldots+a_{m} f\\left(p_{m}\\right)=g\\left(f, p_{1}\\right) a_{1} \\ln p_{1}+\\ldots+g\\left(f, p_{m}\\right) a_{m} \\ln a_{m} \\\\\n& <g\\left(f, p_{0}\\right) a_{0} \\ln p_{0}=f\\left(p_{0}^{a_{0}}\\right)\n\\end{aligned}\n\\]\n\nLet \\(n=b p_{0}^{a_{0}}+r\\), where \\(0<r<p_{0}^{a_{0}}\\). Then \\(f(r)=f\\left(b p_{0}^{a_{0}}\\right) \\geqslant f\\left(p_{0}^{a_{0}}\\right)\\). This contradiction shows that \\(p_{0}^{a_{0}} \\mid n\\). Then \\(n=p_{0}^{\\nu_{p_{0}}(n)} n^{\\prime}\\), where \\(n^{\\prime} \\leqslant p_{0}\\).\n\nThe functions \\(f_{1}(m):=f\\left(p_{0}\\right) \\nu_{p_{0}}(m)\\) and \\(f_{2}:=f-f_{1}\\) are additive (obviously \\(f(m) \\geqslant f\\left(p_{0}^{\\nu_{p_{0}}(m)}\\right)=f_{1}(m)\\), since \\(p_{0}^{\\nu_{p_{0}}(m)}\\) divides \\(m\\) ). For \\(k<n, \\nu_{p}(k)=\\nu_{p}(n-k)\\). Hence the pair \\(\\left(f_{2}, n\\right)\\) is also good. Note that \\(f_{2}\\left(p_{0}\\right)=0\\).\n\nChoose among all primes \\(p<n\\) the prime \\(q_{0}\\) with maximal \\(g\\left(f_{2}, p\\right)\\). As above we can prove that \\(n=q_{0}^{\\nu_{q_{0}}(n)} n^{\\prime \\prime}\\) with \\(n^{\\prime \\prime}<q_{0}\\). Since \\(p_{0} \\neq q_{0}\\), we get a contradiction. Thus \\(f(n)=f(p) \\cdot \\nu_{p}(n)\\).", "source_pdf": "imosl_2020.pdf", "notes": "fallback-regex"}
{"id": "IMOSL-2020-N6", "contest": "IMOSL", "year": "2020", "problem_number": "N6", "problem": "For a positive integer \\(n\\), let \\(d(n)\\) be the number of positive divisors of \\(n\\), and let \\(\\varphi(n)\\) be the number of positive integers not exceeding \\(n\\) which are coprime to \\(n\\). Does there exist a constant \\(C\\) such that\n\\[\n\\frac{\\varphi(d(n))}{d(\\varphi(n))} \\leqslant C\n\\]\nfor all \\(n \\geqslant 1\\) ?\n(Cyprus)", "solution": "Answer: No, such constant does not exist.\n\n1. Fix \\(N>1\\), let \\(p_{1}, \\ldots, p_{k}\\) be all primes between 1 and \\(N\\) and \\(p_{k+1}, \\ldots, p_{k+s}\\) be all primes between \\(N+1\\) and \\(2 N\\). Since for \\(j \\leqslant k+s\\) all prime divisors of \\(p_{j}-1\\) do not exceed \\(N\\), we have\n\\[\n\\prod_{j=1}^{k+s}\\left(p_{j}-1\\right)=\\prod_{i=1}^{k} p_{i}^{c_{i}}\n\\]\nwith some fixed exponents \\(c_{1}, \\ldots, c_{k}\\). Choose a huge prime number \\(q\\) and consider a number\n\\[\nn=\\left(p_{1} \\cdot \\ldots \\cdot p_{k}\\right)^{q-1} \\cdot\\left(p_{k+1} \\cdot \\ldots \\cdot p_{k+s}\\right) .\n\\]\n\nThen\n\\[\n\\varphi(d(n))=\\varphi\\left(q^{k} \\cdot 2^{s}\\right)=q^{k-1}(q-1) 2^{s-1}\n\\]\nand\n\\[\nd(\\varphi(n))=d\\left(\\left(p_{1} \\cdot \\ldots \\cdot p_{k}\\right)^{q-2} \\prod_{i=1}^{k+s}\\left(p_{i}-1\\right)\\right)=d\\left(\\prod_{i=1}^{k} p_{i}^{q-2+c_{i}}\\right)=\\prod_{i=1}^{k}\\left(q-1+c_{i}\\right),\n\\]\n\nSO\n\\[\n\\frac{\\varphi(d(n))}{d(\\varphi(n))}=\\frac{q^{k-1}(q-1) 2^{s-1}}{\\prod_{i=1}^{k}\\left(q-1+c_{i}\\right)}=2^{s-1} \\cdot \\frac{q-1}{q} \\cdot \\prod_{i=1}^{k} \\frac{q}{q-1+c_{i}},\n\\]\nwhich can be made arbitrarily close to \\(2^{s-1}\\) by choosing \\(q\\) large enough. It remains to show that \\(s\\) can be arbitrarily large, i.e. that there can be arbitrarily many primes between \\(N\\) and \\(2 N\\).\n\nThis follows, for instance, from the well-known fact that \\(\\sum \\frac{1}{p}=\\infty\\), where the sum is taken over the set \\(\\mathbb{P}\\) of prime numbers. Indeed, if, for some constant \\(C\\), there were always at most \\(C\\) primes between \\(2^{\\ell}\\) and \\(2^{\\ell+1}\\), we would have\n\\[\n\\sum_{p \\in \\mathbb{P}} \\frac{1}{p}=\\sum_{\\ell=0}^{\\infty} \\sum_{\\substack{p \\in \\mathbb{P} \\\\ p \\in\\left[2^{\\ell}, 2^{\\ell+1}\\right)}} \\frac{1}{p} \\leqslant \\sum_{\\ell=0}^{\\infty} \\frac{C}{2^{\\ell}}<\\infty,\n\\]\nwhich is a contradiction.\nComment 1. Here we sketch several alternative elementary self-contained ways to perform the last step of the solution above. In particular, they avoid using divergence of \\(\\sum \\frac{1}{p}\\).\n\nSuppose that for some constant \\(C\\) and for every \\(k=1,2, \\ldots\\) there exist at most \\(C\\) prime numbers between \\(2^{k}\\) and \\(2^{k+1}\\). Consider the prime factorization of the factorial \\(\\left(2^{n}\\right)!=\\prod p^{\\alpha_{p}}\\). We have \\(\\alpha_{p}=\\left\\lfloor 2^{n} / p\\right\\rfloor+\\left\\lfloor 2^{n} / p^{2}\\right\\rfloor+\\ldots\\). Thus, for \\(p \\in\\left[2^{k}, 2^{k+1}\\right)\\), we get \\(\\alpha_{p} \\leqslant 2^{n} / 2^{k}+2^{n} / 2^{k+1}+\\ldots=2^{n-k+1}\\), therefore \\(p^{\\alpha_{p}} \\leqslant 2^{(k+1) 2^{n-k+1}}\\). Combining this with the bound \\((2 m)!\\geqslant m(m+1) \\cdot \\ldots \\cdot(2 m-1) \\geqslant m^{m}\\) for \\(m=2^{n-1}\\) we get\n\\[\n2^{(n-1) \\cdot 2^{n-1}} \\leqslant\\left(2^{n}\\right)!\\leqslant \\prod_{k=1}^{n-1} 2^{C(k+1) 2^{n-k+1}}\n\\]\nor\n\\[\n\\sum_{k=1}^{n-1} C(k+1) 2^{1-k} \\geqslant \\frac{n-1}{2}\n\\]\nthat fails for large \\(n\\) since \\(C(k+1) 2^{1-k}<1 / 3\\) for all but finitely many \\(k\\).\nIn fact, a much stronger inequality can be obtained in an elementary way: Note that the formula for \\(\\nu_{p}(n!)\\) implies that if \\(p^{\\alpha}\\) is the largest power of \\(p\\) dividing \\(\\binom{n}{n / 2}\\), then \\(p^{\\alpha} \\leqslant n\\). By looking at prime factorization of \\(\\binom{n}{n / 2}\\) we instantaneously infer that\n\\[\n\\pi(n) \\geqslant \\log _{n}\\binom{n}{n / 2} \\geqslant \\frac{\\log \\left(2^{n} / n\\right)}{\\log n} \\geqslant \\frac{n}{2 \\log n} .\n\\]\n\nThis, in particular, implies that for infinitely many \\(n\\) there are at least \\(\\frac{n}{3 \\log n}\\) primes between \\(n\\) and \\(2 n\\).\nSolution 2. In this solution we will use the Prime Number Theorem which states that\n\\[\n\\pi(m)=\\frac{m}{\\log m} \\cdot(1+o(1)),\n\\]\nas \\(m\\) tends to infinity. Here and below \\(\\pi(m)\\) denotes the number of primes not exceeding \\(m\\), and log the natural logarithm.\n\nLet \\(m>5\\) be a large positive integer and let \\(n:=p_{1} p_{2} \\cdot \\ldots \\cdot p_{\\pi(m)}\\) be the product of all primes not exceeding \\(m\\). Then \\(\\varphi(d(n))=\\varphi\\left(2^{\\pi(m)}\\right)=2^{\\pi(m)-1}\\). Consider the number\n\\[\n\\varphi(n)=\\prod_{k=1}^{\\pi(m)}\\left(p_{k}-1\\right)=\\prod_{s=1}^{\\pi(m / 2)} q_{s}^{\\alpha_{s}},\n\\]\nwhere \\(q_{1}, \\ldots, q_{\\pi(m / 2)}\\) are primes not exceeding \\(m / 2\\). Note that every term \\(p_{k}-1\\) contributes at most one prime \\(q_{s}>\\sqrt{m}\\) into the product \\(\\prod_{s} q_{s}^{\\alpha_{s}}\\), so we have\n\\[\n\\sum_{s: q_{s}>\\sqrt{m}} \\alpha_{s} \\leqslant \\pi(m) \\quad \\Longrightarrow \\quad \\sum_{s: q_{s}>\\sqrt{m}}\\left(1+\\alpha_{s}\\right) \\leqslant \\pi(m)+\\pi(m / 2) .\n\\]\n\nHence, applying the AM-GM inequality and the inequality \\((A / x)^{x} \\leqslant e^{A / e}\\), we obtain\n\\[\n\\prod_{s: q_{s}>\\sqrt{m}}\\left(\\alpha_{s}+1\\right) \\leqslant\\left(\\frac{\\pi(m)+\\pi(m / 2)}{\\ell}\\right)^{\\ell} \\leqslant \\exp \\left(\\frac{\\pi(m)+\\pi(m / 2)}{e}\\right),\n\\]\nwhere \\(\\ell\\) is the number of primes in the interval \\((\\sqrt{m}, m]\\).\nWe then use a trivial bound \\(\\alpha_{i} \\leqslant \\log _{2}(\\varphi(n)) \\leqslant \\log _{2} n<\\log _{2}\\left(m^{m}\\right)<m^{2}\\) for each \\(i\\) with \\(q_{i}<\\sqrt{m}\\) to obtain\n\\[\n\\prod_{s=1}^{\\pi(\\sqrt{m})}\\left(\\alpha_{s}+1\\right) \\leqslant\\left(m^{2}\\right)^{\\sqrt{m}}=m^{2 \\sqrt{m}} .\n\\]\n\nPutting this together we obtain\n\\[\nd(\\varphi(n))=\\prod_{s=1}^{\\pi(m / 2)}\\left(\\alpha_{s}+1\\right) \\leqslant \\exp \\left(2 \\sqrt{m} \\cdot \\log m+\\frac{\\pi(m)+\\pi(m / 2)}{e}\\right) .\n\\]\n\nThe prime number theorem then implies that\n\\[\n\\limsup _{m \\rightarrow \\infty} \\frac{\\log (d(\\varphi(n)))}{m / \\log m} \\leqslant \\limsup _{m \\rightarrow \\infty} \\frac{2 \\sqrt{m} \\cdot \\log m}{m / \\log m}+\\limsup _{m \\rightarrow \\infty} \\frac{\\pi(m)+\\pi(m / 2)}{e \\cdot m / \\log m}=\\frac{3}{2 e} .\n\\]\n\nWhereas, again by prime number theorem, we have\n\\[\n\\liminf _{m \\rightarrow \\infty} \\frac{\\log (\\varphi(d(n)))}{m / \\log m}=\\liminf _{m \\rightarrow \\infty} \\frac{\\log \\left(2^{\\pi(m)-1}\\right)}{m / \\log m}=\\log 2 .\n\\]\n\nSince \\(\\frac{3}{2 e}<\\frac{3}{5}<\\log 2\\), this implies that \\(\\varphi(d(n)) / d(\\varphi(n))\\) can be arbitrarily large.\n\nComment 2. The original formulation of the problem was asking whether \\(d(\\varphi(n)) \\geqslant \\varphi(d(n))\\) for all but finitely many values of \\(n\\). The Problem Selection Committee decided that the presented version is better suited for the Shortlist.", "source_pdf": "imosl_2020.pdf", "notes": "fallback-regex"}
{"id": "IMOSL-2020-N7", "contest": "IMOSL", "year": "2020", "problem_number": "N7", "problem": "Let \\(\\mathcal{S}\\) be a set consisting of \\(n \\geqslant 3\\) positive integers, none of which is a sum of two other distinct members of \\(\\mathcal{S}\\). Prove that the elements of \\(\\mathcal{S}\\) may be ordered as \\(a_{1}, a_{2}, \\ldots, a_{n}\\) so that \\(a_{i}\\) does not divide \\(a_{i-1}+a_{i+1}\\) for all \\(i=2,3 \\ldots, n-1\\).\n(Ukraine)", "solution": "Common remarks. In all solutions, we call a set \\(\\mathcal{S}\\) of positive integers good if no its element is a sum of two other distinct members of \\(\\mathcal{S}\\). We will use the following simple observation.\nObservation A. If \\(a, b\\), and \\(c\\) are three distinct elements of a good set \\(\\mathcal{S}\\) with \\(b>a, c\\), then \\(b \\nmid a+c\\). Otherwise, since \\(b \\neq a+c\\), we would have \\(b \\leqslant(a+c) / 2<\\max \\{a, c\\}\\).\n\n1. We prove the following stronger statement.\nClaim. Let \\(\\mathcal{S}\\) be a good set consisting of \\(n \\geqslant 2\\) positive integers. Then the elements of \\(\\mathcal{S}\\) may be ordered as \\(a_{1}, a_{2}, \\ldots, a_{n}\\) so that \\(a_{i} \\nmid a_{i-1}+a_{i+1}\\) and \\(a_{i} \\nmid a_{i-1}-a_{i+1}\\), for all \\(i=2,3, \\ldots, n-1\\). Proof. Say that the ordering \\(a_{1}, \\ldots, a_{n}\\) of \\(\\mathcal{S}\\) is nice if it satisfies the required property.\n\nWe proceed by induction on \\(n\\). The base case \\(n=2\\) is trivial, as there are no restrictions on the ordering.\n\nTo perform the step of induction, suppose that \\(n \\geqslant 3\\). Let \\(a=\\max \\mathcal{S}\\), and set \\(\\mathcal{T}=\\mathcal{S} \\backslash\\{a\\}\\). Use the inductive hypothesis to find a nice ordering \\(b_{1}, \\ldots, b_{n-1}\\) of \\(\\mathcal{T}\\). We will show that \\(a\\) may be inserted into this sequence so as to reach a nice ordering of \\(\\mathcal{S}\\). In other words, we will show that there exists a \\(j \\in\\{1,2, \\ldots, n\\}\\) such that the ordering\n\\[\nN_{j}=\\left(b_{1}, \\ldots, b_{j-1}, a, b_{j}, b_{j+1}, \\ldots, b_{n-1}\\right)\n\\]\nis nice.\nAssume that, for some \\(j\\), the ordering \\(N_{j}\\) is not nice, so that some element \\(x\\) in it divides either the sum or the difference of two adjacent ones. This did not happen in the ordering of \\(\\mathcal{T}\\), hence \\(x \\in\\left\\{b_{j-1}, a, b_{j}\\right\\}\\) (if, say, \\(b_{j-1}\\) does not exist, then \\(x \\in\\left\\{a, b_{j}\\right\\}\\); a similar agreement is applied hereafter). But the case \\(x=a\\) is impossible: \\(a\\) cannot divide \\(b_{j-1}-b_{j}\\), since \\(0<\\left|b_{j-1}-b_{j}\\right|<a\\), while \\(a \\nmid b_{j-1}+b_{j}\\) by Observation A. Therefore \\(x \\in\\left\\{b_{j-1}, b_{j}\\right\\}\\). In this case, assign the number \\(x\\) to the index \\(j\\).\n\nSuppose now that none of the \\(N_{j}\\) is nice. Since there are \\(n\\) possible indices \\(j\\), and only \\(n-1\\) elements in \\(\\mathcal{T}\\), one of those elements (say, \\(b_{k}\\) ) is assigned to two different indices, which then should equal \\(k\\) and \\(k+1\\). This means that \\(b_{k}\\) divides the numbers \\(b_{k-1}+\\varepsilon_{1} a\\) and \\(a+\\varepsilon_{2} b_{k+1}\\), for some signs \\(\\varepsilon_{1}, \\varepsilon_{2} \\in\\{-1,1\\}\\). But then\n\\[\nb_{k-1} \\equiv-\\varepsilon_{1} a \\equiv \\varepsilon_{1} \\varepsilon_{2} b_{k+1} \\quad\\left(\\bmod b_{k}\\right)\n\\]\nand therefore \\(b_{k} \\mid b_{k-1}-\\varepsilon_{1} \\varepsilon_{2} b_{k+1}\\), which means that the ordering of \\(\\mathcal{T}\\) was not nice. This contradiction proves the step of induction.\n\nSolution 2. We again prove a stronger statement.\nClaim. Let \\(\\mathcal{S}\\) be an arbitrary set of \\(n \\geqslant 3\\) positive integers. Then its elements can be ordered as \\(a_{1}, \\ldots, a_{n}\\) so that, if \\(a_{i} \\mid a_{i-1}+a_{i+1}\\), then \\(a_{i}=\\max \\mathcal{S}\\).\n\nThe claim easily implies what we need to prove, due to Observation A.\nTo prove the Claim, introduce the function \\(f\\) which assigns to any two elements \\(a, b \\in \\mathcal{S}\\) with \\(a<b\\) the unique integer \\(f(a, b) \\in\\{1,2, \\ldots, a\\}\\) such that \\(a \\mid b+f(a, b)\\). Hence, if \\(b \\mid a+c\\) for some \\(a, b, c \\in \\mathcal{S}\\) with \\(a<b<c\\), then \\(a=f(b, c)\\). Therefore, the Claim is a consequence of the following combinatorial lemma.\n\nLemma. Let \\(\\mathcal{S}\\) be a set of \\(n \\geqslant 3\\) positive integers, and let \\(f\\) be a function which assigns to any \\(a, b \\in \\mathcal{S}\\) with \\(a<b\\) some integer from the range \\(\\{1, \\ldots, a\\}\\). Then the elements of \\(\\mathcal{S}\\) may be ordered as \\(a_{1}, a_{2}, \\ldots, a_{n}\\) so as to satisfy the following two conditions simultaneously:\n(i) Unimodality: There exists a \\(j \\in\\{1,2, \\ldots, n\\}\\) such that \\(a_{1}<a_{2}<\\ldots<a_{j}>a_{j+1}>\\ldots> a_{n}\\); and\n(ii) \\(f\\)-avoidance: If \\(a<b\\) are two elements of \\(\\mathcal{S}\\), which are adjacent in the ordering, then \\(f(a, b)\\) is not adjacent to \\(a\\).\nProof. We call an ordering of \\(\\mathcal{S}\\) satisfying (i) and (ii) \\(f\\)-nice. We agree that \\(f(x, y)=x\\) for \\(x \\geqslant y\\); this agreement puts no extra restriction.\n\nWe proceed by induction; for the base case \\(n=3\\), it suffices to put the maximal element in \\(\\mathcal{S}\\) onto the middle position.\n\nTo perform the step of induction, let \\(p<q\\) be the two minimal elements of \\(\\mathcal{S}\\), and set \\(\\mathcal{T}=\\mathcal{S} \\backslash\\{p\\}\\). Define a function \\(g\\) by assigning to any elements \\(a<b\\) of \\(\\mathcal{T}\\) the value\n\\[\ng(a, b)= \\begin{cases}q, & \\text { if } f(a, b)=p \\\\ f(a, b), & \\text { otherwise }\\end{cases}\n\\]\n\nNotice that \\(g(a, b) \\leqslant a\\) for all \\(a, b \\in \\mathcal{T}\\).\nUse the inductive hypothesis to get a \\(g\\)-nice ordering \\(b_{1}, b_{2}, \\ldots, b_{n-1}\\) of \\(\\mathcal{T}\\). By unimodality, either \\(b_{1}\\) or \\(b_{n-1}\\) equals \\(q\\); these cases differ only by reverting the order, so we assume \\(b_{1}=q\\).\n\nNotice that, according to (1), the number \\(f\\left(b_{2}, b_{3}\\right)\\) differs from both \\(p\\) and \\(q\\). On the other hand, the number \\(f\\left(b_{n-1}, b_{n-2}\\right)\\) differs from at least one of them - say, from \\(r\\); set \\(s=p+q-r\\), so that \\(\\{r, s\\}=\\{p, q\\}\\). Now, order \\(\\mathcal{S}\\) as\n\\[\ns, b_{2}, b_{3}, \\ldots, b_{n-1}, r\n\\]\n\nBy the induction hypothesis and the above choice, this ordering is nice.\nComment. In the original proposal, the numbers in the set were assumed to be odd (which implies that none is a sum of two others); moreover, the proposal requested to arrange in a row all numbers but one.\n\nOn the other hand, Solution 2 shows that the condition of \\(\\mathcal{S}\\) being good may be relaxed to the condition that the maximal element of \\(\\mathcal{S}\\) is not a sum of two other elements in \\(\\mathcal{S}\\). On the other hand, the set \\(\\{1,2,3\\}\\) shows that the condition cannot be merely omitted.", "source_pdf": "imosl_2020.pdf", "notes": "fallback-regex"}
{"id": "IMOSL-2021-A1", "contest": "IMOSL", "year": "2021", "problem_number": "A1", "problem": "Let \\(n\\) be an integer, and let \\(A\\) be a subset of \\(\\left\\{0,1,2,3, \\ldots, 5^{n}\\right\\}\\) consisting of \\(4 n+2\\) numbers. Prove that there exist \\(a, b, c \\in A\\) such that \\(a<b<c\\) and \\(c+2 a>3 b\\).", "solution": "1. (By contradiction) Suppose that there exist \\(4 n+2\\) non-negative integers \\(x_{0}< x_{1}<\\cdots<x_{4 n+1}\\) that violate the problem statement. Then in particular \\(x_{4 n+1}+2 x_{i} \\leqslant 3 x_{i+1}\\) for all \\(i=0, \\ldots, 4 n-1\\), which gives\n\\[\nx_{4 n+1}-x_{i} \\geqslant \\frac{3}{2}\\left(x_{4 n+1}-x_{i+1}\\right) .\n\\]\n\nBy a trivial induction we then get\n\\[\nx_{4 n+1}-x_{i} \\geqslant\\left(\\frac{3}{2}\\right)^{4 n-i}\\left(x_{4 n+1}-x_{4 n}\\right)\n\\]\nwhich for \\(i=0\\) yields the contradiction\n\\[\nx_{4 n+1}-x_{0} \\geqslant\\left(\\frac{3}{2}\\right)^{4 n}\\left(x_{4 n+1}-x_{4 n}\\right)=\\left(\\frac{81}{16}\\right)^{n}\\left(x_{4 n+1}-x_{4 n}\\right)>5^{n} \\cdot 1 .\n\\]\n\nSolution 2. Denote the maximum element of \\(A\\) by \\(c\\). For \\(k=0, \\ldots, 4 n-1\\) let\n\\[\nA_{k}=\\left\\{x \\in A:\\left(1-(2 / 3)^{k}\\right) c \\leqslant x<\\left(1-(2 / 3)^{k+1}\\right) c\\right\\}\n\\]\n\nNote that\n\\[\n\\left(1-(2 / 3)^{4 n}\\right) c=c-(16 / 81)^{n} c>c-(1 / 5)^{n} c \\geqslant c-1\n\\]\nwhich shows that the sets \\(A_{0}, A_{1}, \\ldots, A_{4 n-1}\\) form a partition of \\(A \\backslash\\{c\\}\\). Since \\(A \\backslash\\{c\\}\\) has \\(4 n+1\\) elements, by the pigeonhole principle some set \\(A_{k}\\) does contain at least two elements of \\(A \\backslash\\{c\\}\\). Denote these two elements \\(a\\) and \\(b\\) and assume \\(a<b\\), so that \\(a<b<c\\). Then\n\\[\nc+2 a \\geqslant c+2\\left(1-(2 / 3)^{k}\\right) c=\\left(3-2(2 / 3)^{k}\\right) c=3\\left(1-(2 / 3)^{k+1}\\right) c>3 b\n\\]\nas desired.", "source_pdf": "imosl_2021.pdf", "notes": "fallback-regex"}
{"id": "IMOSL-2021-A2", "contest": "IMOSL", "year": "2021", "problem_number": "A2", "problem": "For every integer \\(n \\geqslant 1\\) consider the \\(n \\times n\\) table with entry \\(\\left\\lfloor\\frac{i j}{n+1}\\right\\rfloor\\) at the intersection of row \\(i\\) and column \\(j\\), for every \\(i=1, \\ldots, n\\) and \\(j=1, \\ldots, n\\). Determine all integers \\(n \\geqslant 1\\) for which the sum of the \\(n^{2}\\) entries in the table is equal to \\(\\frac{1}{4} n^{2}(n-1)\\).", "solution": "Answer: All integers \\(n\\) for which \\(n+1\\) is a prime.\n\n1. First, observe that every pair \\(x, y\\) of real numbers for which the sum \\(x+y\\) is integer satisfies\n\\[\n\\lfloor x\\rfloor+\\lfloor y\\rfloor \\geqslant x+y-1 .\n\\]\n\nThe inequality is strict if \\(x\\) and \\(y\\) are integers, and it holds with equality otherwise.\nWe estimate the sum \\(S\\) as follows.\n\\[\n\\begin{aligned}\n2 S=\\sum_{1 \\leqslant i, j \\leqslant n}\\left(\\left\\lfloor\\frac{i j}{n+1}\\right\\rfloor+\\left\\lfloor\\frac{i j}{n+1}\\right\\rfloor\\right)=\\sum_{1 \\leqslant i, j \\leqslant n}\\left(\\left\\lfloor\\frac{i j}{n+1}\\right\\rfloor+\\left\\lfloor\\frac{(n+1-i) j}{n+1}\\right\\rfloor\\right) & \\\\\n& \\geqslant \\sum_{1 \\leqslant i, j \\leqslant n}(j-1)=\\frac{(n-1) n^{2}}{2} .\n\\end{aligned}\n\\]\n\nThe inequality in the last line follows from (1) by setting \\(x=i j /(n+1)\\) and \\(y=(n+1-\\) i) \\(j /(n+1)\\), so that \\(x+y=j\\) is integral.\n\nNow \\(S=\\frac{1}{4} n^{2}(n-1)\\) if and only if the inequality in the last line holds with equality, which means that none of the values \\(i j /(n+1)\\) with \\(1 \\leqslant i, j \\leqslant n\\) may be integral.\n\nHence, if \\(n+1\\) is composite with factorisation \\(n+1=a b\\) for \\(2 \\leqslant a, b \\leqslant n\\), one gets a strict inequality for \\(i=a\\) and \\(j=b\\). If \\(n+1\\) is a prime, then \\(i j /(n+1)\\) is never integral and \\(S=\\frac{1}{4} n^{2}(n-1)\\).\n\nSolution 2. To simplify the calculation with indices, extend the table by adding a phantom column of index 0 with zero entries (which will not change the sum of the table). Fix a row \\(i\\) with \\(1 \\leqslant i \\leqslant n\\), and let \\(d:=\\operatorname{gcd}(i, n+1)\\) and \\(k:=(n+1) / d\\). For columns \\(j=0, \\ldots, n\\), define the remainder \\(r_{j}:=i j \\bmod (n+1)\\). We first prove the following\nClaim. For every integer \\(g\\) with \\(1 \\leqslant g \\leqslant d\\), the remainders \\(r_{j}\\) with indices \\(j\\) in the range\n\\[\n(g-1) k \\leqslant j \\leqslant g k-1\n\\]\nform a permutation of the \\(k\\) numbers \\(0 \\cdot d, 1 \\cdot d, 2 \\cdot d, \\ldots,(k-1) \\cdot d\\).\nProof. If \\(r_{j^{\\prime}}=r_{j}\\) holds for two indices \\(j^{\\prime}\\) and \\(j\\) in (2), then \\(i\\left(j^{\\prime}-j\\right) \\equiv 0 \\bmod (n+1)\\), so that \\(j^{\\prime}-j\\) is a multiple of \\(k\\); since \\(\\left|j^{\\prime}-j\\right| \\leqslant k-1\\), this implies \\(j^{\\prime}=j\\). Hence, the \\(k\\) remainders are pairwise distinct. Moreover, each remainder \\(r_{j}=i j \\bmod (n+1)\\) is a multiple of \\(d=\\operatorname{gcd}(i, n+1)\\). This proves the claim.\n\nWe then have\n\\[\n\\sum_{j=0}^{n} r_{j}=\\sum_{g=1}^{d} \\sum_{\\ell=0}^{(n+1) / d-1} \\ell d=d^{2} \\cdot \\frac{1}{2}\\left(\\frac{n+1}{d}-1\\right) \\frac{n+1}{d}=\\frac{(n+1-d)(n+1)}{2} .\n\\]\n\nBy using (3), compute the sum \\(S_{i}\\) of row \\(i\\) as follows:\n\\[\n\\begin{aligned}\nS_{i}=\\sum_{j=0}^{n}\\left\\lfloor\\frac{i j}{n+1}\\right\\rfloor= & \\sum_{j=0}^{n} \\frac{i j-r_{j}}{n+1}=\\frac{i}{n+1} \\sum_{j=0}^{n} j-\\frac{1}{n+1} \\sum_{j=0}^{n} r_{j} \\\\\n& =\\frac{i}{n+1} \\cdot \\frac{n(n+1)}{2}-\\frac{1}{n+1} \\cdot \\frac{(n+1-d)(n+1)}{2}=\\frac{(i n-n-1+d)}{2} .\n\\end{aligned}\n\\]\n\nEquation (4) yields the following lower bound on the row sum \\(S_{i}\\), which holds with equality if and only if \\(d=\\operatorname{gcd}(i, n+1)=1\\) :\n\\[\nS_{i} \\geqslant \\frac{(i n-n-1+1)}{2}=\\frac{n(i-1)}{2} .\n\\]\n\nBy summing up the bounds (5) for the rows \\(i=1, \\ldots, n\\), we get the following lower bound for the sum of all entries in the table\n\\[\n\\sum_{i=1}^{n} S_{i} \\geqslant \\sum_{i=1}^{n} \\frac{n}{2}(i-1)=\\frac{n^{2}(n-1)}{4}\n\\]\n\nIn (6) we have equality if and only if equality holds in (5) for each \\(i=1, \\ldots, n\\), which happens if and only if \\(\\operatorname{gcd}(i, n+1)=1\\) for each \\(i=1, \\ldots, n\\), which is equivalent to the fact that \\(n+1\\) is a prime. Thus the sum of the table entries is \\(\\frac{1}{4} n^{2}(n-1)\\) if and only if \\(n+1\\) is a prime.\n\nComment. To simplify the answer, in the problem statement one can make a change of variables by introducing \\(m:=n+1\\) and writing everything in terms of \\(m\\). The drawback is that the expression for the sum will then be \\(\\frac{1}{4}(m-1)^{2}(m-2)\\) which seems more artificial.", "source_pdf": "imosl_2021.pdf", "notes": "fallback-regex"}
{"id": "IMOSL-2021-A3", "contest": "IMOSL", "year": "2021", "problem_number": "A3", "problem": "Given a positive integer \\(n\\), find the smallest value of \\(\\left\\lfloor\\frac{a_{1}}{1}\\right\\rfloor+\\left\\lfloor\\frac{a_{2}}{2}\\right\\rfloor+\\cdots+\\left\\lfloor\\frac{a_{n}}{n}\\right\\rfloor\\) over all permutations \\(\\left(a_{1}, a_{2}, \\ldots, a_{n}\\right)\\) of \\((1,2, \\ldots, n)\\).", "solution": "Answer: The minimum of such sums is \\(\\left\\lfloor\\log _{2} n\\right\\rfloor+1\\); so if \\(2^{k} \\leqslant n<2^{k+1}\\), the minimum is \\(k+1\\).\n\n1. Suppose that \\(2^{k} \\leqslant n<2^{k+1}\\) with some nonnegative integer \\(k\\). First we show a permutation \\(\\left(a_{1}, a_{2}, \\ldots, a_{n}\\right)\\) such that \\(\\left\\lfloor\\frac{a_{1}}{1}\\right\\rfloor+\\left\\lfloor\\frac{a_{2}}{2}\\right\\rfloor+\\cdots+\\left\\lfloor\\frac{a_{n}}{n}\\right\\rfloor=k+1\\); then we will prove that \\(\\left\\lfloor\\frac{a_{1}}{1}\\right\\rfloor+\\left\\lfloor\\frac{a_{2}}{2}\\right\\rfloor+\\cdots+\\left\\lfloor\\frac{a_{n}}{n}\\right\\rfloor \\geqslant k+1\\) for every permutation. Hence, the minimal possible value will be \\(k+1\\).\nI. Consider the permutation\n\\[\n\\begin{gathered}\n\\left(a_{1}\\right)=(1), \\quad\\left(a_{2}, a_{3}\\right)=(3,2), \\quad\\left(a_{4}, a_{5}, a_{6}, a_{7}\\right)=(7,4,5,6), \\quad \\cdots \\\\\n\\left(a_{2^{k-1}}, \\ldots, a_{2^{k}-1}\\right)=\\left(2^{k}-1,2^{k-1}, 2^{k-1}+1, \\ldots, 2^{k}-2\\right), \\\\\n\\left(a_{2^{k}}, \\ldots, a_{n}\\right)=\\left(n, 2^{k}, 2^{k}+1, \\ldots, n-1\\right) .\n\\end{gathered}\n\\]\n\nThis permutation consists of \\(k+1\\) cycles. In every cycle ( \\(a_{p}, \\ldots, a_{q}\\) ) = ( \\(q, p, p+1, \\ldots, q-1\\) ) we have \\(q<2 p\\), so\n\\[\n\\sum_{i=p}^{q}\\left\\lfloor\\frac{a_{i}}{i}\\right\\rfloor=\\left\\lfloor\\frac{q}{p}\\right\\rfloor+\\sum_{i=p+1}^{q}\\left\\lfloor\\frac{i-1}{i}\\right\\rfloor=1 ;\n\\]\n\nThe total sum over all cycles is precisely \\(k+1\\).\nII. In order to establish the lower bound, we prove a more general statement.\n\nClaim. If \\(b_{1}, \\ldots, b_{2^{k}}\\) are distinct positive integers then\n\\[\n\\sum_{i=1}^{2^{k}}\\left\\lfloor\\frac{b_{i}}{i}\\right\\rfloor \\geqslant k+1\n\\]\n\nFrom the Claim it follows immediately that \\(\\sum_{i=1}^{n}\\left\\lfloor\\frac{a_{i}}{i}\\right\\rfloor \\geqslant \\sum_{i=1}^{2^{k}}\\left\\lfloor\\frac{a_{i}}{i}\\right\\rfloor \\geqslant k+1\\).\nProof of the Claim. Apply induction on \\(k\\). For \\(k=1\\) the claim is trivial, \\(\\left\\lfloor\\frac{b_{1}}{1}\\right\\rfloor \\geqslant 1\\). Suppose the Claim holds true for some positive integer \\(k\\), and consider \\(k+1\\).\n\nIf there exists an index \\(j\\) such that \\(2^{k}<j \\leqslant 2^{k+1}\\) and \\(b_{j} \\geqslant j\\) then\n\\[\n\\sum_{i=1}^{2^{k+1}}\\left\\lfloor\\frac{b_{i}}{i}\\right\\rfloor \\geqslant \\sum_{i=1}^{2^{k}}\\left\\lfloor\\frac{b_{i}}{i}\\right\\rfloor+\\left\\lfloor\\frac{b_{j}}{j}\\right\\rfloor \\geqslant(k+1)+1\n\\]\nby the induction hypothesis, so the Claim is satisfied.\nOtherwise we have \\(b_{j}<j \\leqslant 2^{k+1}\\) for every \\(2^{k}<j \\leqslant 2^{k+1}\\). Among the \\(2^{k+1}\\) distinct numbers \\(b_{1}, \\ldots, b_{2^{k+1}}\\) there is some \\(b_{m}\\) which is at least \\(2^{k+1}\\); that number must be among \\(b_{1} \\ldots, b_{2^{k}}\\). Hence, \\(1 \\leqslant m \\leqslant 2^{k}\\) and \\(b_{m} \\geqslant 2^{k+1}\\).\n\nWe will apply the induction hypothesis to the numbers\n\\[\nc_{1}=b_{1}, \\ldots, c_{m-1}=b_{m-1}, \\quad c_{m}=b_{2^{k}+1}, \\quad c_{m+1}=b_{m+1}, \\ldots, c_{2^{k}}=b_{2^{k}}\n\\]\nso take the first \\(2^{k}\\) numbers but replace \\(b_{m}\\) with \\(b_{2^{k}+1}\\). Notice that\n\\[\n\\left\\lfloor\\frac{b_{m}}{m}\\right\\rfloor \\geqslant\\left\\lfloor\\frac{2^{k+1}}{m}\\right\\rfloor=\\left\\lfloor\\frac{2^{k}+2^{k}}{m}\\right\\rfloor \\geqslant\\left\\lfloor\\frac{b_{2^{k}+1}+m}{m}\\right\\rfloor=\\left\\lfloor\\frac{c_{m}}{m}\\right\\rfloor+1\n\\]\n\nFor the other indices \\(i\\) with \\(1 \\leqslant i \\leqslant 2^{k}, i \\neq m\\) we have \\(\\left\\lfloor\\frac{b_{i}}{i}\\right\\rfloor=\\left\\lfloor\\frac{c_{i}}{i}\\right\\rfloor\\), so\n\\[\n\\sum_{i=1}^{2^{k+1}}\\left\\lfloor\\frac{b_{i}}{i}\\right\\rfloor=\\sum_{i=1}^{2^{k}}\\left\\lfloor\\frac{b_{i}}{i}\\right\\rfloor \\geqslant \\sum_{i=1}^{2^{k}}\\left\\lfloor\\frac{c_{i}}{i}\\right\\rfloor+1 \\geqslant(k+1)+1 .\n\\]\n\nThat proves the Claim and hence completes the solution.\nSolution 2. We present a different proof for the lower bound.\nAssume again \\(2^{k} \\leqslant n<2^{k+1}\\), and let \\(P=\\left\\{2^{0}, 2^{1}, \\ldots, 2^{k}\\right\\}\\) be the set of powers of 2 among \\(1,2, \\ldots, n\\). Call an integer \\(i \\in\\{1,2, \\ldots, n\\}\\) and the interval \\(\\left[i, a_{i}\\right] \\operatorname{good}\\) if \\(a_{i} \\geqslant i\\).\n\nLemma 1. The good intervals cover the integers \\(1,2, \\ldots, n\\).\nProof. Consider an arbitrary \\(x \\in\\{1,2 \\ldots, n\\}\\); we want to find a good interval \\(\\left[i, a_{i}\\right]\\) that covers \\(x\\); i.e., \\(i \\leqslant x \\leqslant a_{i}\\). Take the cycle of the permutation that contains \\(x\\), that is ( \\(x, a_{x}, a_{a_{x}}, \\ldots\\) ). In this cycle, let \\(i\\) be the first element with \\(a_{i} \\geqslant x\\); then \\(i \\leqslant x \\leqslant a_{i}\\).\n\nLemma 2. If a good interval \\(\\left[i, a_{i}\\right]\\) covers \\(p\\) distinct powers of 2 then \\(\\left\\lfloor\\frac{a_{i}}{i}\\right\\rfloor \\geqslant p\\); more formally, \\(\\left\\lfloor\\frac{a_{i}}{i}\\right\\rfloor \\geqslant\\left|\\left[i, a_{i}\\right] \\cap P\\right|\\).\nProof. The ratio of the smallest and largest powers of 2 in the interval is at least \\(2^{p-1}\\). By Bernoulli's inequality, \\(\\frac{a_{i}}{i} \\geqslant 2^{p-1} \\geqslant p\\); that proves the lemma.\n\nNow, by Lemma 1, the good intervals cover \\(P\\). By applying Lemma 2 as well, we obtain that\n\\[\n\\sum_{i=1}^{n}\\left\\lfloor\\frac{a_{i}}{i}\\right\\rfloor=\\sum_{i \\text { is good }}^{n}\\left\\lfloor\\frac{a_{i}}{i}\\right\\rfloor \\geqslant \\sum_{i \\text { is good }}^{n}\\left\\lfloor\\left[i, a_{i}\\right] \\cap P|\\geqslant|P|=k+1 .\\right.\n\\]\n\nSolution 3. We show yet another proof for the lower bound, based on the following inequality.\n\n\\section*{Lemma 3.}\n\\[\n\\left\\lfloor\\frac{a}{b}\\right\\rfloor \\geqslant \\log _{2} \\frac{a+1}{b}\n\\]\nfor every pair \\(a, b\\) of positive integers.\nProof. Let \\(t=\\left\\lfloor\\frac{a}{b}\\right\\rfloor\\), so \\(t \\leqslant \\frac{a}{b}\\) and \\(\\frac{a+1}{b} \\leqslant t+1\\). By applying the inequality \\(2^{t} \\geqslant t+1\\), we obtain\n\\[\n\\left\\lfloor\\frac{a}{b}\\right\\rfloor=t \\geqslant \\log _{2}(t+1) \\geqslant \\log _{2} \\frac{a+1}{b} .\n\\]\n\nBy applying the lemma to each term, we get\n\\[\n\\sum_{i=1}^{n}\\left\\lfloor\\frac{a_{i}}{i}\\right\\rfloor \\geqslant \\sum_{i=1}^{n} \\log _{2} \\frac{a_{i}+1}{i}=\\sum_{i=1}^{n} \\log _{2}\\left(a_{i}+1\\right)-\\sum_{i=1}^{n} \\log _{2} i .\n\\]\n\nNotice that the numbers \\(a_{1}+1, a_{2}+1, \\ldots, a_{n}+1\\) form a permutation of \\(2,3, \\ldots, n+1\\). Hence, in the last two sums all terms cancel out, except for \\(\\log _{2}(n+1)\\) in the first sum and \\(\\log _{2} 1=0\\) in the second sum. Therefore,\n\\[\n\\sum_{i=1}^{n}\\left\\lfloor\\frac{a_{i}}{i}\\right\\rfloor \\geqslant \\log _{2}(n+1)>k .\n\\]\n\nAs the left-hand side is an integer, it must be at least \\(k+1\\).", "source_pdf": "imosl_2021.pdf", "notes": "fallback-regex"}
{"id": "IMOSL-2021-A5", "contest": "IMOSL", "year": "2021", "problem_number": "A5", "problem": "Let \\(n \\geqslant 2\\) be an integer, and let \\(a_{1}, a_{2}, \\ldots, a_{n}\\) be positive real numbers such that \\(a_{1}+a_{2}+\\cdots+a_{n}=1\\). Prove that\n\\[\n\\sum_{k=1}^{n} \\frac{a_{k}}{1-a_{k}}\\left(a_{1}+a_{2}+\\cdots+a_{k-1}\\right)^{2}<\\frac{1}{3} .\n\\]", "solution": "1. For all \\(k \\leqslant n\\), let\n\\[\ns_{k}=a_{1}+a_{2}+\\cdots+a_{k} \\quad \\text { and } \\quad b_{k}=\\frac{a_{k} s_{k-1}^{2}}{1-a_{k}},\n\\]\nwith the convention that \\(s_{0}=0\\). Note that \\(b_{k}\\) is exactly a summand in the sum we need to estimate. We shall prove the inequality\n\\[\nb_{k}<\\frac{s_{k}^{3}-s_{k-1}^{3}}{3}\n\\]\n\nIndeed, it suffices to check that\n\\[\n\\begin{aligned}\n(1) & \\Longleftrightarrow 0<\\left(1-a_{k}\\right)\\left(\\left(s_{k-1}+a_{k}\\right)^{3}-s_{k-1}^{3}\\right)-3 a_{k} s_{k-1}^{2} \\\\\n& \\Longleftrightarrow 0<\\left(1-a_{k}\\right)\\left(3 s_{k-1}^{2}+3 s_{k-1} a_{k}+a_{k}^{2}\\right)-3 s_{k-1}^{2} \\\\\n& \\Longleftrightarrow 0<-3 a_{k} s_{k-1}^{2}+3\\left(1-a_{k}\\right) s_{k-1} a_{k}+\\left(1-a_{k}\\right) a_{k}^{2} \\\\\n& \\Longleftrightarrow 0<3\\left(1-a_{k}-s_{k-1}\\right) s_{k-1} a_{k}+\\left(1-a_{k}\\right) a_{k}^{2}\n\\end{aligned}\n\\]\nwhich holds since \\(a_{k}+s_{k-1}=s_{k} \\leqslant 1\\) and \\(a_{k} \\in(0,1)\\).\nThus, adding inequalities (1) for \\(k=1, \\ldots, n\\), we conclude that\n\\[\nb_{1}+b_{2}+\\cdots+b_{n}<\\frac{s_{n}^{3}-s_{0}^{3}}{3}=\\frac{1}{3},\n\\]\nas desired.\n\nComment 1. There are many ways of proving (1) which can be written as\n\\[\n\\frac{a s^{2}}{1-a}-\\frac{(a+s)^{3}-s^{3}}{3}<0,\n\\]\nfor non-negative \\(a\\) and \\(s\\) satisfying \\(a+s \\leqslant 1\\) and \\(a>0\\).\nE.g., note that for any fixed \\(a\\) the expression in (2) is quadratic in \\(s\\) with the leading coefficient \\(a /(1-a)-a>0\\). Hence, it is convex as a function in \\(s\\), so it suffices to check the inequality at \\(s=0\\) and \\(s=1-a\\). The former case is trivial and in the latter case the inequality can be rewritten as\n\\[\na s-\\frac{3 a s(a+s)+a^{3}}{3}<0,\n\\]\nwhich is trivial since \\(a+s=1\\).\n\nSolution 2. First, let us define\n\\[\nS\\left(a_{1}, \\ldots, a_{n}\\right):=\\sum_{k=1}^{n} \\frac{a_{k}}{1-a_{k}}\\left(a_{1}+a_{2}+\\cdots+a_{k-1}\\right)^{2} .\n\\]\n\nFor some index \\(i\\), denote \\(a_{1}+\\cdots+a_{i-1}\\) by \\(s\\). If we replace \\(a_{i}\\) with two numbers \\(a_{i} / 2\\) and \\(a_{i} / 2\\), i.e. replace the tuple \\(\\left(a_{1}, \\ldots, a_{n}\\right)\\) with \\(\\left(a_{1}, \\ldots, a_{i-1}, a_{i} / 2, a_{i} / 2, a_{i+1}, \\ldots, a_{n}\\right)\\), the sum will increase by\n\\[\n\\begin{aligned}\nS\\left(a_{1}, \\ldots, a_{i} / 2, a_{i} / 2, \\ldots, a_{n}\\right)-S\\left(a_{1}, \\ldots, a_{n}\\right) & =\\frac{a_{i} / 2}{1-a_{i} / 2}\\left(s^{2}+\\left(s+a_{i} / 2\\right)^{2}\\right)-\\frac{a_{i}}{1-a_{i}} s^{2} \\\\\n& =a_{i} \\frac{\\left(1-a_{i}\\right)\\left(2 s^{2}+s a_{i}+a_{i}^{2} / 4\\right)-\\left(2-a_{i}\\right) s^{2}}{\\left(2-a_{i}\\right)\\left(1-a_{i}\\right)} \\\\\n& =a_{i} \\frac{\\left(1-a_{i}-s\\right) s a_{i}+\\left(1-a_{i}\\right) a_{i}^{2} / 4}{\\left(2-a_{i}\\right)\\left(1-a_{i}\\right)}\n\\end{aligned}\n\\]\nwhich is strictly positive. So every such replacement strictly increases the sum. By repeating this process and making maximal number in the tuple tend to zero, we keep increasing the sum which will converge to\n\\[\n\\int_{0}^{1} x^{2} d x=\\frac{1}{3}\n\\]\n\nThis completes the proof.\nSolution 3. We sketch a probabilistic version of the first solution. Let \\(x_{1}, x_{2}, x_{3}\\) be drawn uniformly and independently at random from the segment [ 0,1 ]. Let \\(I_{1} \\cup I_{2} \\cup \\cdots \\cup I_{n}\\) be a partition of \\([0,1]\\) into segments of length \\(a_{1}, a_{2}, \\ldots, a_{n}\\) in this order. Let \\(J_{k}:=I_{1} \\cup \\cdots \\cup I_{k-1}\\) for \\(k \\geqslant 2\\) and \\(J_{1}:=\\varnothing\\). Then\n\\[\n\\begin{aligned}\n\\frac{1}{3}= & \\sum_{k=1}^{n} \\mathbb{P}\\left\\{x_{1} \\geqslant x_{2}, x_{3} ; x_{1} \\in I_{k}\\right\\} \\\\\n= & \\sum_{k=1}^{n}\\left(\\mathbb{P}\\left\\{x_{1} \\in I_{k} ; x_{2}, x_{3} \\in J_{k}\\right\\}+2 \\cdot \\mathbb{P}\\left\\{x_{1} \\geqslant x_{2} ; x_{1}, x_{2} \\in I_{k} ; x_{3} \\in J_{k}\\right\\}\\right. \\\\\n& \\left.\\quad+\\mathbb{P}\\left\\{x_{1} \\geqslant x_{2}, x_{3} ; x_{1}, x_{2}, x_{3} \\in I_{k}\\right\\}\\right) \\\\\n= & \\sum_{k=1}^{n}\\left(a_{k}\\left(a_{1}+\\cdots+a_{k-1}\\right)^{2}+2 \\cdot \\frac{a_{k}^{2}}{2} \\cdot\\left(a_{1}+\\cdots+a_{k-1}\\right)+\\frac{a_{k}^{3}}{3}\\right) \\\\\n> & \\sum_{k=1}^{n}\\left(a_{k}\\left(a_{1}+\\cdots+a_{k-1}\\right)^{2}+a_{k}^{2}\\left(a_{1}+\\cdots+a_{k-1}\\right) \\cdot \\frac{a_{1}+\\cdots+a_{k-1}}{1-a_{k}}\\right),\n\\end{aligned}\n\\]\nwhere for the last inequality we used that \\(1-a_{k} \\geqslant a_{1}+\\cdots+a_{k-1}\\). This completes the proof since\n\\[\na_{k}+\\frac{a_{k}^{2}}{1-a_{k}}=\\frac{a_{k}}{1-a_{k}}\n\\]", "source_pdf": "imosl_2021.pdf", "notes": "fallback-regex"}
{"id": "IMOSL-2021-A7", "contest": "IMOSL", "year": "2021", "problem_number": "A7", "problem": "Let \\(n \\geqslant 1\\) be an integer, and let \\(x_{0}, x_{1}, \\ldots, x_{n+1}\\) be \\(n+2\\) non-negative real numbers that satisfy \\(x_{i} x_{i+1}-x_{i-1}^{2} \\geqslant 1\\) for all \\(i=1,2, \\ldots, n\\). Show that\n\\[\nx_{0}+x_{1}+\\cdots+x_{n}+x_{n+1}>\\left(\\frac{2 n}{3}\\right)^{3 / 2}\n\\]\n\n\\section*{", "solution": "1.}\n\nLemma 1.1. If \\(a, b, c\\) are non-negative numbers such that \\(a b-c^{2} \\geqslant 1\\), then\n\\[\n(a+2 b)^{2} \\geqslant(b+2 c)^{2}+6\n\\]\n\nProof. \\((a+2 b)^{2}-(b+2 c)^{2}=(a-b)^{2}+2(b-c)^{2}+6\\left(a b-c^{2}\\right) \\geqslant 6\\).\nLemma 1.2. \\(\\sqrt{1}+\\cdots+\\sqrt{n}>\\frac{2}{3} n^{3 / 2}\\).\nProof. Bernoulli's inequality \\((1+t)^{3 / 2}>1+\\frac{3}{2} t\\) for \\(0>t \\geqslant-1\\) (or, alternatively, a straightforward check) gives\n\\[\n(k-1)^{3 / 2}=k^{3 / 2}\\left(1-\\frac{1}{k}\\right)^{3 / 2}>k^{3 / 2}\\left(1-\\frac{3}{2 k}\\right)=k^{3 / 2}-\\frac{3}{2} \\sqrt{k}\n\\]\n\nSumming up ( \\(*\\) ) over \\(k=1,2, \\ldots, n\\) yields\n\\[\n0>n^{3 / 2}-\\frac{3}{2}(\\sqrt{1}+\\cdots+\\sqrt{n}) .\n\\]\n\nNow put \\(y_{i}:=2 x_{i}+x_{i+1}\\) for \\(i=0,1, \\ldots, n\\). We get \\(y_{0} \\geqslant 0\\) and \\(y_{i}^{2} \\geqslant y_{i-1}^{2}+6\\) for \\(i=1,2, \\ldots, n\\) by Lemma 1.1. Thus, an easy induction on \\(i\\) gives \\(y_{i} \\geqslant \\sqrt{6 i}\\). Using this estimate and Lemma 1.2 we get\n\\[\n3\\left(x_{0}+\\ldots+x_{n+1}\\right) \\geqslant y_{1}+\\ldots+y_{n} \\geqslant \\sqrt{6}(\\sqrt{1}+\\sqrt{2}+\\ldots+\\sqrt{n})>\\sqrt{6} \\cdot \\frac{2}{3} n^{3 / 2}=3\\left(\\frac{2 n}{3}\\right)^{3 / 2}\n\\]\n\nSolution 2. Say that an index \\(i \\in\\{0,1, \\ldots, n+1\\}\\) is good, if \\(x_{i} \\geqslant \\sqrt{\\frac{2}{3}} i\\), otherwise call the index \\(i\\) bad.\nLemma 2.1. There are no two consecutive bad indices.\nProof. Assume the contrary and consider two bad indices \\(j, j+1\\) with minimal possible \\(j\\). Since 0 is good, we get \\(j>0\\), thus by minimality \\(j-1\\) is a good index and we have\n\\[\n\\frac{2}{3} \\sqrt{j(j+1)}>x_{j} x_{j+1} \\geqslant x_{j-1}^{2}+1 \\geqslant \\frac{2}{3}(j-1)+1=\\frac{2}{3} \\cdot \\frac{j+(j+1)}{2}\n\\]\nthat contradicts the AM-GM inequality for numbers \\(j\\) and \\(j+1\\).\nLemma 2.2. If an index \\(j \\leqslant n-1\\) is good, then\n\\[\nx_{j+1}+x_{j+2} \\geqslant \\sqrt{\\frac{2}{3}}(\\sqrt{j+1}+\\sqrt{j+2})\n\\]\n\nProof. We have\n\\[\nx_{j+1}+x_{j+2} \\geqslant 2 \\sqrt{x_{j+1} x_{j+2}} \\geqslant 2 \\sqrt{x_{j}^{2}+1} \\geqslant 2 \\sqrt{\\frac{2}{3} j+1} \\geqslant \\sqrt{\\frac{2}{3} j+\\frac{2}{3}}+\\sqrt{\\frac{2}{3} j+\\frac{4}{3}},\n\\]\nthe last inequality follows from concavity of the square root function, or, alternatively, from the AM-QM inequality for the numbers \\(\\sqrt{\\frac{2}{3} j+\\frac{2}{3}}\\) and \\(\\sqrt{\\frac{2}{3} j+\\frac{4}{3}}\\).\n\nLet \\(S_{i}=x_{1}+\\ldots+x_{i}\\) and \\(T_{i}=\\sqrt{\\frac{2}{3}}(\\sqrt{1}+\\ldots+\\sqrt{i})\\).\nLemma 2.3. If an index \\(i\\) is good, then \\(S_{i} \\geqslant T_{i}\\).\nProof. Induction on \\(i\\). The base case \\(i=0\\) is clear. Assume that the claim holds for good indices less than \\(i\\) and prove it for a good index \\(i>0\\).\n\nIf \\(i-1\\) is good, then by the inductive hypothesis we get \\(S_{i}=S_{i-1}+x_{i} \\geqslant T_{i-1}+\\sqrt{\\frac{2}{3} i}=T_{i}\\).\nIf \\(i-1\\) is bad, then \\(i>1\\), and \\(i-2\\) is good by Lemma 2.1. Then using Lemma 2.2 and the inductive hypothesis we get\n\\[\nS_{i}=S_{i-2}+x_{i-1}+x_{i} \\geqslant T_{i-2}+\\sqrt{\\frac{2}{3}}(\\sqrt{i-1}+\\sqrt{i})=T_{i}\n\\]\n\nSince either \\(n\\) or \\(n+1\\) is good by Lemma 2.1, Lemma 2.3 yields in both cases \\(S_{n+1} \\geqslant T_{n}\\), and it remains to apply Lemma 1.2 from Solution 1.\n\nComment 1. Another way to get (*) is the integral bound\n\\[\nk^{3 / 2}-(k-1)^{3 / 2}=\\int_{k-1}^{k} \\frac{3}{2} \\sqrt{x} d x<\\frac{3}{2} \\sqrt{k}\n\\]\n\nComment 2. If \\(x_{i}=\\sqrt{2 / 3} \\cdot(\\sqrt{i}+1)\\), the conditions of the problem hold. Indeed, the inequality to check is\n\\[\n(\\sqrt{i}+1)(\\sqrt{i+1}+1)-(\\sqrt{i-1}+1)^{2} \\geqslant 3 / 2\n\\]\nthat rewrites as\n\\[\n\\sqrt{i}+\\sqrt{i+1}-2 \\sqrt{i-1} \\geqslant(i+1 / 2)-\\sqrt{i(i+1)}=\\frac{1 / 4}{i+1 / 2+\\sqrt{i(i+1)}}\n\\]\nwhich follows from\n\\[\n\\sqrt{i}-\\sqrt{i-1}=\\frac{1}{\\sqrt{i}+\\sqrt{i-1}}>\\frac{1}{2 i}\n\\]\n\nFor these numbers we have \\(x_{0}+\\ldots+x_{n+1}=\\left(\\frac{2 n}{3}\\right)^{3 / 2}+O(n)\\), thus the multiplicative constant \\((2 / 3)^{3 / 2}\\) in the problem statement is sharp.", "source_pdf": "imosl_2021.pdf", "notes": "fallback-regex"}
{"id": "IMOSL-2021-A8", "contest": "IMOSL", "year": "2021", "problem_number": "A8", "problem": "Determine all functions \\(f: \\mathbb{R} \\rightarrow \\mathbb{R}\\) that satisfy\n\\[\n(f(a)-f(b))(f(b)-f(c))(f(c)-f(a))=f\\left(a b^{2}+b c^{2}+c a^{2}\\right)-f\\left(a^{2} b+b^{2} c+c^{2} a\\right)\n\\]\nfor all real numbers \\(a, b, c\\).", "solution": "Answer: \\(f(x)=\\alpha x+\\beta\\) or \\(f(x)=\\alpha x^{3}+\\beta\\) where \\(\\alpha \\in\\{-1,0,1\\}\\) and \\(\\beta \\in \\mathbb{R}\\).\n\n. It is straightforward to check that above functions satisfy the equation. Now let \\(f(x)\\) satisfy the equation, which we denote \\(E(a, b, c)\\). Then clearly \\(f(x)+C\\) also does; therefore, we may suppose without loss of generality that \\(f(0)=0\\). We start with proving\nLemma. Either \\(f(x) \\equiv 0\\) or \\(f\\) is injective.\nProof. Denote by \\(\\Theta \\subseteq \\mathbb{R}^{2}\\) the set of points ( \\(a, b\\) ) for which \\(f(a)=f(b)\\). Let \\(\\Theta^{*}=\\{(x, y) \\in \\Theta\\) : \\(x \\neq y\\}\\). The idea is that if \\((a, b) \\in \\Theta\\), then by \\(E(a, b, x)\\) we get\n\\[\nH_{a, b}(x):=\\left(a b^{2}+b x^{2}+x a^{2}, a^{2} b+b^{2} x+x^{2} a\\right) \\in \\Theta\n\\]\nfor all real \\(x\\). Reproducing this argument starting with \\((a, b) \\in \\Theta^{*}\\), we get more and more points in \\(\\Theta\\). There are many ways to fill in the details, we give below only one of them.\n\nAssume that \\((a, b) \\in \\Theta^{*}\\). Note that\n\\[\ng_{-}(x):=\\left(a b^{2}+b x^{2}+x a^{2}\\right)-\\left(a^{2} b+b^{2} x+x^{2} a\\right)=(a-b)(b-x)(x-a)\n\\]\nand\n\\[\ng_{+}(x):=\\left(a b^{2}+b x^{2}+x a^{2}\\right)+\\left(a^{2} b+b^{2} x+x^{2} a\\right)=\\left(x^{2}+a b\\right)(a+b)+x\\left(a^{2}+b^{2}\\right) .\n\\]\n\nHence, there exists \\(x\\) for which both \\(g_{-}(x) \\neq 0\\) and \\(g_{+}(x) \\neq 0\\). This gives a point \\((\\alpha, \\beta)= H_{a, b}(x) \\in \\Theta^{*}\\) for which \\(\\alpha \\neq-\\beta\\). Now compare \\(E(\\alpha, 1,0)\\) and \\(E(\\beta, 1,0)\\). The left-hand side expressions coincide, on right-hand side we get \\(f(\\alpha)-f\\left(\\alpha^{2}\\right)=f(\\beta)-f\\left(\\beta^{2}\\right)\\), respectively. Hence, \\(f\\left(\\alpha^{2}\\right)=f\\left(\\beta^{2}\\right)\\) and we get a point \\(\\left(\\alpha_{1}, \\beta_{1}\\right):=\\left(\\alpha^{2}, \\beta^{2}\\right) \\in \\Theta^{*}\\) with both coordinates \\(\\alpha_{1}, \\beta_{1}\\) non-negative. Continuing squaring the coordinates, we get a point \\((\\gamma, \\delta) \\in \\Theta^{*}\\) for which \\(\\delta>5 \\gamma \\geqslant 0\\). Our nearest goal is to get a point \\((0, r) \\in \\Theta^{*}\\). If \\(\\gamma=0\\), this is already done. If \\(\\gamma>0\\), denote by \\(x\\) a real root of the quadratic equation \\(\\delta \\gamma^{2}+\\gamma x^{2}+x \\delta^{2}=0\\), which exists since the discriminant \\(\\delta^{4}-4 \\delta \\gamma^{3}\\) is positive. Also \\(x<0\\) since this equation cannot have non-negative root. For the point \\(H_{\\delta, \\gamma}(x)=:(0, r) \\in \\Theta\\) the first coordinate is 0 . The difference of coordinates equals \\(-r=(\\delta-\\gamma)(\\gamma-x)(x-\\delta)<0\\), so \\(r \\neq 0\\) as desired.\n\nNow, let \\((0, r) \\in \\Theta^{*}\\). We get \\(H_{0, r}(x)=\\left(r x^{2}, r^{2} x\\right) \\in \\Theta\\). Thus \\(f\\left(r x^{2}\\right)=f\\left(r^{2} x\\right)\\) for all \\(x \\in \\mathbb{R}\\). Replacing \\(x\\) to \\(-x\\) we get \\(f\\left(r x^{2}\\right)=f\\left(r^{2} x\\right)=f\\left(-r^{2} x\\right)\\), so \\(f\\) is even: \\((a,-a) \\in \\Theta\\) for all \\(a\\). Then \\(H_{a,-a}(x)=\\left(a^{3}-a x^{2}+x a^{2},-a^{3}+a^{2} x+x^{2} a\\right) \\in \\Theta\\) for all real \\(a, x\\). Putting \\(x=\\frac{1+\\sqrt{5}}{2} a\\) we obtain \\(\\left(0,(1+\\sqrt{5}) a^{3}\\right) \\in \\Theta\\) which means that \\(f(y)=f(0)=0\\) for every real \\(y\\).\n\nHereafter we assume that \\(f\\) is injective and \\(f(0)=0\\). By \\(E(a, b, 0)\\) we get\n\\[\nf(a) f(b)(f(a)-f(b))=f\\left(a^{2} b\\right)-f\\left(a b^{2}\\right) .\n\\]\n\nLet \\(\\kappa:=f(1)\\) and note that \\(\\kappa=f(1) \\neq f(0)=0\\) by injectivity. Putting \\(b=1\\) in ( \\(\\odot\\) ) we get\n\\[\n\\kappa f(a)(f(a)-\\kappa)=f\\left(a^{2}\\right)-f(a) .\n\\]\n\nSubtracting the same equality for \\(-a\\) we get\n\\[\n\\kappa(f(a)-f(-a))(f(a)+f(-a)-\\kappa)=f(-a)-f(a) .\n\\]\n\nNow, if \\(a \\neq 0\\), by injectivity we get \\(f(a)-f(-a) \\neq 0\\) and thus\n\\[\nf(a)+f(-a)=\\kappa-\\kappa^{-1}=: \\lambda .\n\\]\n\nIt follows that\n\\[\nf(a)-f(b)=f(-b)-f(-a)\n\\]\nfor all non-zero \\(a, b\\). Replace non-zero numbers \\(a, b\\) in ( \\(\\bigcirc\\) ) with \\(-a,-b\\), respectively, and add the two equalities. Due to ( \\(\\mathbf{0}\\) ) we get\n\\[\n(f(a)-f(b))(f(a) f(b)-f(-a) f(-b))=0\n\\]\nthus \\(f(a) f(b)=f(-a) f(-b)=(\\lambda-f(a))(\\lambda-f(b))\\) for all non-zero \\(a \\neq b\\). If \\(\\lambda \\neq 0\\), this implies \\(f(a)+f(b)=\\lambda\\) that contradicts injectivity when we vary \\(b\\) with fixed \\(a\\). Therefore, \\(\\lambda=0\\) and \\(\\kappa= \\pm 1\\). Thus \\(f\\) is odd. Replacing \\(f\\) with \\(-f\\) if necessary (this preserves the original equation) we may suppose that \\(f(1)=1\\).\n\nNow, (\\$) yields \\(f\\left(a^{2}\\right)=f^{2}(a)\\). Summing relations ( \\(\\varnothing\\) ) for pairs ( \\(a, b\\) ) and ( \\(a,-b\\) ), we get \\(-2 f(a) f^{2}(b)=-2 f\\left(a b^{2}\\right)\\), i.e. \\(f(a) f\\left(b^{2}\\right)=f\\left(a b^{2}\\right)\\). Putting \\(b=\\sqrt{x}\\) for each non-negative \\(x\\) we get \\(f(a x)=f(a) f(x)\\) for all real \\(a\\) and non-negative \\(x\\). Since \\(f\\) is odd, this multiplicativity relation is true for all \\(a, x\\). Also, from \\(f\\left(a^{2}\\right)=f^{2}(a)\\) we see that \\(f(x) \\geqslant 0\\) for \\(x \\geqslant 0\\). Next, \\(f(x)>0\\) for \\(x>0\\) by injectivity.\n\nAssume that \\(f(x)\\) for \\(x>0\\) does not have the form \\(f(x)=x^{\\tau}\\) for a constant \\(\\tau\\). The known property of multiplicative functions yields that the graph of \\(f\\) is dense on \\((0, \\infty)^{2}\\). In particular, we may find positive \\(b<1 / 10\\) for which \\(f(b)>1\\). Also, such \\(b\\) can be found if \\(f(x)=x^{\\tau}\\) for some \\(\\tau<0\\). Then for all \\(x\\) we have \\(x^{2}+x b^{2}+b \\geqslant 0\\) and so \\(E(1, b, x)\\) implies that\n\\[\nf\\left(b^{2}+b x^{2}+x\\right)=f\\left(x^{2}+x b^{2}+b\\right)+(f(b)-1)(f(x)-f(b))(f(x)-1) \\geqslant 0-\\left((f(b)-1)^{3} / 4\\right.\n\\]\nis bounded from below (the quadratic trinomial bound \\((t-f(1))(t-f(b)) \\geqslant-(f(b)-1)^{2} / 4\\) for \\(t=f(x)\\) is used). Hence, \\(f\\) is bounded from below on ( \\(b^{2}-\\frac{1}{4 b},+\\infty\\) ), and since \\(f\\) is odd it is bounded from above on ( \\(0, \\frac{1}{4 b}-b^{2}\\) ). This is absurd if \\(f(x)=x^{\\tau}\\) for \\(\\tau<0\\), and contradicts to the above dense graph condition otherwise.\n\nTherefore, \\(f(x)=x^{\\tau}\\) for \\(x>0\\) and some constant \\(\\tau>0\\). Dividing \\(E(a, b, c)\\) by \\((a-b)(b- c)(c-a)=\\left(a b^{2}+b c^{2}+c a^{2}\\right)-\\left(a^{2} b+b^{2} c+c^{2} a\\right)\\) and taking a limit when \\(a, b, c\\) all go to 1 (the divided ratios tend to the corresponding derivatives, say, \\(\\frac{a^{\\tau}-b^{\\tau}}{a-b} \\rightarrow\\left(x^{\\tau}\\right)_{x=1}^{\\prime}=\\tau\\) ), we get \\(\\tau^{3}=\\tau \\cdot 3^{\\tau-1}, \\tau^{2}=3^{\\tau-1}, F(\\tau):=3^{\\tau / 2-1 / 2}-\\tau=0\\). Since function \\(F\\) is strictly convex, it has at most two roots, and we get \\(\\tau \\in\\{1,3\\}\\).\n\n\\section*{Combinatorics}", "source_pdf": "imosl_2021.pdf", "notes": "fallback-regex"}
{"id": "IMOSL-2021-C1", "contest": "IMOSL", "year": "2021", "problem_number": "C1", "problem": "Let \\(S\\) be an infinite set of positive integers, such that there exist four pairwise distinct \\(a, b, c, d \\in S\\) with \\(\\operatorname{gcd}(a, b) \\neq \\operatorname{gcd}(c, d)\\). Prove that there exist three pairwise distinct \\(x, y, z \\in S\\) such that \\(\\operatorname{gcd}(x, y)=\\operatorname{gcd}(y, z) \\neq \\operatorname{gcd}(z, x)\\).", "solution": ". There exists \\(\\alpha \\in S\\) so that \\(\\{\\operatorname{gcd}(\\alpha, s) \\mid s \\in S, s \\neq \\alpha\\}\\) contains at least two elements. Since \\(\\alpha\\) has only finitely many divisors, there is a \\(d \\mid \\alpha\\) such that the set \\(B=\\{\\beta \\in S \\mid \\operatorname{gcd}(\\alpha, \\beta)=d\\}\\) is infinite. Pick \\(\\gamma \\in S\\) so that \\(\\operatorname{gcd}(\\alpha, \\gamma) \\neq d\\). Pick \\(\\beta_{1}, \\beta_{2} \\in B\\) so that \\(\\operatorname{gcd}\\left(\\beta_{1}, \\gamma\\right)=\\operatorname{gcd}\\left(\\beta_{2}, \\gamma\\right)=: d^{\\prime}\\). If \\(d=d^{\\prime}\\), then \\(\\operatorname{gcd}\\left(\\alpha, \\beta_{1}\\right)=\\operatorname{gcd}\\left(\\gamma, \\beta_{1}\\right) \\neq \\operatorname{gcd}(\\alpha, \\gamma)\\). If \\(d \\neq d^{\\prime}\\), then either \\(\\operatorname{gcd}\\left(\\alpha, \\beta_{1}\\right)=\\operatorname{gcd}\\left(\\alpha, \\beta_{2}\\right)=d\\) and \\(\\operatorname{gcd}\\left(\\beta_{1}, \\beta_{2}\\right) \\neq d\\) or \\(\\operatorname{gcd}\\left(\\gamma, \\beta_{1}\\right)=\\operatorname{gcd}\\left(\\gamma, \\beta_{2}\\right)=d^{\\prime}\\) and \\(\\operatorname{gcd}\\left(\\beta_{1}, \\beta_{2}\\right) \\neq d^{\\prime}\\).\n\nComment. The situation can be modelled as a complete graph on the infinite vertex set \\(S\\), where every edge \\(\\{s, t\\}\\) is colored by \\(c(s, t):=\\operatorname{gcd}(s, t)\\). For every vertex the incident edges carry only finitely many different colors, and by the problem statement at least two different colors show up on the edge set. The goal is to show that there exists a bi-colored triangle (a triangle, whose edges carry exactly two different colors).\n\nFor the proof, consider a vertex \\(v\\) whose incident edges carry at least two different colors. Let \\(X \\subset S\\) be an infinite subset so that \\(c(v, x) \\equiv c_{1}\\) for all \\(x \\in X\\). Let \\(y \\in S\\) be a vertex so that \\(c(v, y) \\neq c_{1}\\). Let \\(x_{1}, x_{2} \\in X\\) be two vertices with \\(c\\left(y, x_{1}\\right)=c\\left(y, x_{2}\\right)=c_{2}\\). If \\(c_{1}=c_{2}\\), then the triangle \\(v, y, x_{1}\\) is bi-colored. If \\(c_{1} \\neq c_{2}\\), then one of \\(v, x_{1}, x_{2}\\) and \\(y, x_{1}, x_{2}\\) is bi-colored.", "source_pdf": "imosl_2021.pdf", "notes": "fallback-regex"}
{"id": "IMOSL-2021-C2", "contest": "IMOSL", "year": "2021", "problem_number": "C2", "problem": "Let \\(n \\geqslant 3\\) be an integer. An integer \\(m \\geqslant n+1\\) is called \\(n\\)-colourful if, given infinitely many marbles in each of \\(n\\) colours \\(C_{1}, C_{2}, \\ldots, C_{n}\\), it is possible to place \\(m\\) of them around a circle so that in any group of \\(n+1\\) consecutive marbles there is at least one marble of colour \\(C_{i}\\) for each \\(i=1, \\ldots, n\\).\n\nProve that there are only finitely many positive integers which are not \\(n\\)-colourful. Find the largest among them.", "solution": "Answer: \\(m_{\\text {max }}=n^{2}-n-1\\).\n\n. First suppose that there are \\(n(n-1)-1\\) marbles. Then for one of the colours, say blue, there are at most \\(n-2\\) marbles, which partition the non-blue marbles into at most \\(n-2\\) groups with at least \\((n-1)^{2}>n(n-2)\\) marbles in total. Thus one of these groups contains at least \\(n+1\\) marbles and this group does not contain any blue marble.\n\nNow suppose that the total number of marbles is at least \\(n(n-1)\\). Then we may write this total number as \\(n k+j\\) with some \\(k \\geqslant n-1\\) and with \\(0 \\leqslant j \\leqslant n-1\\). We place around a circle \\(k-j\\) copies of the colour sequence \\([1,2,3, \\ldots, n]\\) followed by \\(j\\) copies of the colour sequence \\([1,1,2,3, \\ldots, n]\\).", "source_pdf": "imosl_2021.pdf", "notes": "fallback-regex"}
{"id": "IMOSL-2021-C4", "contest": "IMOSL", "year": "2021", "problem_number": "C4", "problem": "The kingdom of Anisotropy consists of \\(n\\) cities. For every two cities there exists exactly one direct one-way road between them. We say that a path from \\(X\\) to \\(Y\\) is a sequence of roads such that one can move from \\(X\\) to \\(Y\\) along this sequence without returning to an already visited city. A collection of paths is called diverse if no road belongs to two or more paths in the collection.\n\nLet \\(A\\) and \\(B\\) be two distinct cities in Anisotropy. Let \\(N_{A B}\\) denote the maximal number of paths in a diverse collection of paths from \\(A\\) to \\(B\\). Similarly, let \\(N_{B A}\\) denote the maximal number of paths in a diverse collection of paths from \\(B\\) to \\(A\\). Prove that the equality \\(N_{A B}=N_{B A}\\) holds if and only if the number of roads going out from \\(A\\) is the same as the number of roads going out from \\(B\\).", "solution": "1. We write \\(X \\rightarrow Y\\) (or \\(Y \\leftarrow X\\) ) if the road between \\(X\\) and \\(Y\\) goes from \\(X\\) to \\(Y\\). Notice that, if there is any route moving from \\(X\\) to \\(Y\\) (possibly passing through some cities more than once), then there is a path from \\(X\\) to \\(Y\\) consisting of some roads in the route. Indeed, any cycle in the route may be removed harmlessly; after some removals one obtains a path.\n\nSay that a path is short if it consists of one or two roads.\nPartition all cities different from \\(A\\) and \\(B\\) into four groups, \\(\\mathcal{I}, \\mathcal{O}, \\mathcal{A}\\), and \\(\\mathcal{B}\\) according to the following rules: for each city \\(C\\),\n\\[\n\\begin{array}{ll}\nC \\in \\mathcal{I} \\Longleftrightarrow A \\rightarrow C \\leftarrow B ; & C \\in \\mathcal{O} \\Longleftrightarrow A \\leftarrow C \\rightarrow B ; \\\\\nC \\in \\mathcal{A} \\Longleftrightarrow A \\rightarrow C \\rightarrow B ; & C \\in \\mathcal{B} \\Longleftrightarrow A \\leftarrow C \\leftarrow B .\n\\end{array}\n\\]\n\nLemma. Let \\(\\mathcal{P}\\) be a diverse collection consisting of \\(p\\) paths from \\(A\\) to \\(B\\). Then there exists a diverse collection consisting of at least \\(p\\) paths from \\(A\\) to \\(B\\) and containing all short paths from \\(A\\) to \\(B\\).\nProof. In order to obtain the desired collection, modify \\(\\mathcal{P}\\) as follows.\nIf there is a direct road \\(A \\rightarrow B\\) and the path consisting of this single road is not in \\(\\mathcal{P}\\), merely add it to \\(\\mathcal{P}\\).\n\nNow consider any city \\(C \\in \\mathcal{A}\\) such that the path \\(A \\rightarrow C \\rightarrow B\\) is not in \\(\\mathcal{P}\\). If \\(\\mathcal{P}\\) contains at most one path containing a road \\(A \\rightarrow C\\) or \\(C \\rightarrow B\\), remove that path (if it exists), and add the path \\(A \\rightarrow C \\rightarrow B\\) to \\(\\mathcal{P}\\) instead. Otherwise, \\(\\mathcal{P}\\) contains two paths of the forms \\(A \\rightarrow C \\rightarrow B\\) and \\(A \\rightarrow C \\rightarrow B\\), where \\(C \\rightarrow B\\) and \\(A \\rightarrow C\\) are some paths. In this case, we recombine the edges to form two new paths \\(A \\rightarrow C \\rightarrow B\\) and \\(A \\rightarrow C \\rightarrow B\\) (removing cycles from the latter if needed). Now we replace the old two paths in \\(\\mathcal{P}\\) with the two new ones.\n\nAfter any operation described above, the number of paths in the collection does not decrease, and the collection remains diverse. Applying such operation to each \\(C \\in \\mathcal{A}\\), we obtain the desired collection.\n\nBack to the problem, assume, without loss of generality, that there is a road \\(A \\rightarrow B\\), and let \\(a\\) and \\(b\\) denote the numbers of roads going out from \\(A\\) and \\(B\\), respectively. Choose a diverse collection \\(\\mathcal{P}\\) consisting of \\(N_{A B}\\) paths from \\(A\\) to \\(B\\). We will transform it into a diverse collection \\(\\mathcal{Q}\\) consisting of at least \\(N_{A B}+(b-a)\\) paths from \\(B\\) to \\(A\\). This construction yields\n\\[\nN_{B A} \\geqslant N_{A B}+(b-a) ; \\quad \\text { similarly, we get } \\quad N_{A B} \\geqslant N_{B A}+(a-b),\n\\]\nwhence \\(N_{B A}-N_{A B}=b-a\\). This yields the desired equivalence.\nApply the lemma to get a diverse collection \\(\\mathcal{P}^{\\prime}\\) of at least \\(N_{A B}\\) paths containing all \\(|\\mathcal{A}|+1\\) short paths from \\(A\\) to \\(B\\). Notice that the paths in \\(\\mathcal{P}^{\\prime}\\) contain no edge of a short path from \\(B\\) to \\(A\\). Each non-short path in \\(\\mathcal{P}^{\\prime}\\) has the form \\(A \\rightarrow C \\rightarrow D \\rightarrow B\\), where \\(C \\rightarrow D\\) is a path from some city \\(C \\in \\mathcal{I}\\) to some city \\(D \\in \\mathcal{O}\\). For each such path, put into \\(\\mathcal{Q}\\) the\npath \\(B \\rightarrow C \\rightarrow D \\rightarrow A\\); also put into \\(\\mathcal{Q}\\) all short paths from \\(B\\) to \\(A\\). Clearly, the collection \\(\\mathcal{Q}\\) is diverse.\n\nNow, all roads going out from \\(A\\) end in the cities from \\(\\mathcal{I} \\cup \\mathcal{A} \\cup\\{B\\}\\), while all roads going out from \\(B\\) end in the cities from \\(\\mathcal{I} \\cup \\mathcal{B}\\). Therefore,\n\\[\na=|\\mathcal{I}|+|\\mathcal{A}|+1, \\quad b=|\\mathcal{I}|+|\\mathcal{B}|, \\quad \\text { and hence } \\quad a-b=|\\mathcal{A}|-|\\mathcal{B}|+1 .\n\\]\n\nOn the other hand, since there are \\(|\\mathcal{A}|+1\\) short paths from \\(A\\) to \\(B\\) (including \\(A \\rightarrow B\\) ) and \\(|\\mathcal{B}|\\) short paths from \\(B\\) to \\(A\\), we infer\n\\[\n|\\mathcal{Q}|=\\left|\\mathcal{P}^{\\prime}\\right|-(|\\mathcal{A}|+1)+|\\mathcal{B}| \\geqslant N_{A B}+(b-a),\n\\]\nas desired.\nSolution 2. We recall some graph-theoretical notions. Let \\(G\\) be a finite graph, and let \\(V\\) be the set of its vertices; fix two distinct vertices \\(s, t \\in V\\). An \\((s, t)\\)-cut is a partition of \\(V\\) into two parts \\(V=S \\sqcup T\\) such that \\(s \\in S\\) and \\(t \\in T\\). The cut-edges in the cut ( \\(S, T\\) ) are the edges going from \\(S\\) to \\(T\\), and the size \\(e(S, T)\\) of the cut is the number of cut-edges.\n\nWe will make use of the following theorem (which is a partial case of the Ford-Fulkerson \"min-cut max-flow\" theorem).\nTheorem (Menger). Let \\(G\\) be a directed graph, and let \\(s\\) and \\(t\\) be its distinct vertices. Then the maximal number of edge-disjoint paths from \\(s\\) to \\(t\\) is equal to the minimal size of an \\((s, t)\\)-cut.\n\nBack to the problem. Consider a directed graph \\(G\\) whose vertices are the cities, and edges correspond to the roads. Then \\(N_{A B}\\) is the maximal number of edge-disjoint paths from \\(A\\) to \\(B\\) in this graph; the number \\(N_{B A}\\) is interpreted similarly.\n\nAs in the previous solution, denote by \\(a\\) and \\(b\\) the out-degrees of vertices \\(A\\) and \\(B\\), respectively. To solve the problem, we show that for any ( \\(A, B\\) )-cut ( \\(S_{A}, T_{A}\\) ) in our graph there exists a ( \\(B, A\\) )-cut ( \\(S_{B}, T_{B}\\) ) satisfying\n\\[\ne\\left(S_{B}, T_{B}\\right)=e\\left(S_{A}, T_{A}\\right)+(b-a)\n\\]\n\nThis yields\n\\[\nN_{B A} \\leqslant N_{A B}+(b-a) ; \\quad \\text { similarly, we get } \\quad N_{A B} \\leqslant N_{B A}+(a-b),\n\\]\nwhence again \\(N_{B A}-N_{A B}=b-a\\).\nThe construction is simple: we put \\(S_{B}=S_{A} \\cup\\{B\\} \\backslash\\{A\\}\\) and hence \\(T_{B}=T_{A} \\cup\\{A\\} \\backslash\\{B\\}\\). To show that it works, let A and B denote the sets of cut-edges in ( \\(S_{A}, T_{A}\\) ) and ( \\(S_{B}, T_{B}\\) ), respectively. Let \\(a_{s}\\) and \\(a_{t}=a-a_{s}\\) denote the numbers of edges going from \\(A\\) to \\(S_{A}\\) and \\(T_{A}\\), respectively. Similarly, denote by \\(b_{s}\\) and \\(b_{t}=b-b_{s}\\) the numbers of edges going from \\(B\\) to \\(S_{B}\\) and \\(T_{B}\\), respectively.\n\nNotice that any edge incident to none of \\(A\\) and \\(B\\) either belongs to both A and B , or belongs to none of them. Denote the number of such edges belonging to A by \\(c\\). The edges in A which are not yet accounted for split into two categories: those going out from \\(A\\) to \\(T_{A}\\) (including \\(A \\rightarrow B\\) if it exists), and those going from \\(S_{A} \\backslash\\{A\\}\\) to \\(B-\\) in other words, going from \\(S_{B}\\) to \\(B\\). The numbers of edges in the two categories are \\(a_{t}\\) and \\(\\left|S_{B}\\right|-1-b_{s}\\), respectively. Therefore,\n\\[\n|\\mathrm{A}|=c+a_{t}+\\left(\\left|S_{B}\\right|-b_{s}-1\\right) . \\quad \\text { Similarly, we get } \\quad|\\mathrm{B}|=c+b_{t}+\\left(\\left|S_{A}\\right|-a_{s}-1\\right),\n\\]\nand hence\n\\[\n|\\mathrm{B}|-|\\mathrm{A}|=\\left(b_{t}+b_{s}\\right)-\\left(a_{t}+a_{s}\\right)=b-a,\n\\]\nsince \\(\\left|S_{A}\\right|=\\left|S_{B}\\right|\\). This finishes the solution.", "source_pdf": "imosl_2021.pdf", "notes": "fallback-regex"}
{"id": "IMOSL-2021-C5", "contest": "IMOSL", "year": "2021", "problem_number": "C5", "problem": "Let \\(n\\) and \\(k\\) be two integers with \\(n>k \\geqslant 1\\). There are \\(2 n+1\\) students standing in a circle. Each student \\(S\\) has \\(2 k\\) neighbours - namely, the \\(k\\) students closest to \\(S\\) on the right, and the \\(k\\) students closest to \\(S\\) on the left.\n\nSuppose that \\(n+1\\) of the students are girls, and the other \\(n\\) are boys. Prove that there is a girl with at least \\(k\\) girls among her neighbours.", "solution": ". We replace the girls by 1 's, and the boys by 0 's, getting the numbers \\(a_{1}, a_{2}, \\ldots, a_{2 n+1}\\) arranged in a circle. We extend this sequence periodically by letting \\(a_{2 n+1+k}=a_{k}\\) for all \\(k \\in \\mathbb{Z}\\). We get an infinite periodic sequence\n\\[\n\\ldots, a_{1}, a_{2}, \\ldots, a_{2 n+1}, a_{1}, a_{2}, \\ldots, a_{2 n+1}, \\ldots\n\\]\n\nConsider the numbers \\(b_{i}=a_{i}+a_{i-k-1}-1 \\in\\{-1,0,1\\}\\) for all \\(i \\in \\mathbb{Z}\\). We know that\n\\[\nb_{m+1}+b_{m+2}+\\cdots+b_{m+2 n+1}=1 \\quad(m \\in \\mathbb{Z})\n\\]\nin particular, this yields that there exists some \\(i_{0}\\) with \\(b_{i_{0}}=1\\). Now we want to find an index \\(i\\) such that\n\\[\nb_{i}=1 \\quad \\text { and } \\quad b_{i+1}+b_{i+2}+\\cdots+b_{i+k} \\geqslant 0 .\n\\]\n\nThis will imply that \\(a_{i}=1\\) and\n\\[\n\\left(a_{i-k}+a_{i-k+1}+\\cdots+a_{i-1}\\right)+\\left(a_{i+1}+a_{i+2}+\\cdots+a_{i+k}\\right) \\geqslant k\n\\]\nas desired.\nSuppose, to the contrary, that for every index \\(i\\) with \\(b_{i}=1\\) the sum \\(b_{i+1}+b_{i+2}+\\cdots+b_{i+k}\\) is negative. We start from some index \\(i_{0}\\) with \\(b_{i_{0}}=1\\) and construct a sequence \\(i_{0}, i_{1}, i_{2}, \\ldots\\), where \\(i_{j}(j>0)\\) is the smallest possible index such that \\(i_{j}>i_{j-1}+k\\) and \\(b_{i_{j}}=1\\). We can choose two numbers among \\(i_{0}, i_{1}, \\ldots, i_{2 n+1}\\) which are congruent modulo \\(2 n+1\\) (without loss of generality, we may assume that these numbers are \\(i_{0}\\) and \\(i_{T}\\) ).\n\nOn the one hand, for every \\(j\\) with \\(0 \\leqslant j \\leqslant T-1\\) we have\n\\[\nS_{j}:=b_{i_{j}}+b_{i_{j}+1}+b_{i_{j}+2}+\\cdots+b_{i_{j+1}-1} \\leqslant b_{i_{j}}+b_{i_{j}+1}+b_{i_{j}+2}+\\cdots+b_{i_{j}+k} \\leqslant 0\n\\]\nsince \\(b_{i_{j}+k+1}, \\ldots, b_{i_{j+1}-1} \\leqslant 0\\). On the other hand, since \\(\\left(i_{T}-i_{0}\\right) \\mid(2 n+1)\\), from (1) we deduce\n\\[\nS_{0}+\\cdots+S_{T-1}=\\sum_{i=i_{0}}^{i_{T}-1} b_{i}=\\frac{i_{T}-i_{0}}{2 n+1}>0\n\\]\n\nThis contradiction finishes the solution.\n\nComment 1. After the problem is reduced to finding an index \\(i\\) satisfying (2), one can finish the solution by applying the (existence part of) following statement.\nLemma (Raney). If \\(\\left\\langle x_{1}, x_{2}, \\ldots, x_{m}\\right\\rangle\\) is any sequence of integers whose sum is +1 , exactly one of the cyclic shifts \\(\\left\\langle x_{1}, x_{2}, \\ldots, x_{m}\\right\\rangle,\\left\\langle x_{2}, \\ldots, x_{m}, x_{1}\\right\\rangle, \\ldots,\\left\\langle x_{m}, x_{1}, \\ldots, x_{m-1}\\right\\rangle\\) has all of its partial sums positive.\n\nA (possibly wider known) version of this lemma, which also can be used in order to solve the problem, is the following\nClaim (Gas stations problem). Assume that there are several fuel stations located on a circular route which together contain just enough gas to make one trip around. Then one can make it all the way around, starting at the right station with an empty tank.\n\nBoth Raney's theorem and the Gas stations problem admit many different (parallel) proofs. Their ideas can be disguised in direct solutions of the problem at hand (as it, in fact, happens in the above solution); such solutions may avoid the introduction of the \\(b_{i}\\). Below, in Comment 2 we present a variant of such solution, while in Comment 3 we present an alternative proof of Raney's theorem.\n\nComment 2. Here is a version of the solution which avoids the use of the \\(b_{i}\\).\nSuppose the contrary. Introduce the numbers \\(a_{i}\\) as above. Starting from any index \\(s_{0}\\) with \\(a_{s_{0}}=1\\), we construct a sequence \\(s_{0}, s_{1}, s_{2}, \\ldots\\) by letting \\(s_{i}\\) to be the smallest index larger than \\(s_{i-1}+k\\) such that \\(a_{s_{i}}=1\\), for \\(i=1,2, \\ldots\\). Choose two indices among \\(s_{1}, \\ldots, s_{2 n+1}\\) which are congruent modulo \\(2 n+1\\); we assume those two are \\(s_{0}\\) and \\(s_{T}\\), with \\(s_{T}-s_{0}=t(2 n+1)\\). Notice here that \\(s_{T+1}-s_{T}=s_{1}-s_{0}\\).\n\nFor every \\(i=0,1,2, \\ldots, T\\), put\n\\[\nL_{i}=s_{i+1}-s_{i} \\quad \\text { and } \\quad S_{i}=a_{s_{i}}+a_{s_{i}+1}+\\cdots+a_{s_{i+1}-1} .\n\\]\n\nNow, by the indirect assumption, for every \\(i=1,2, \\ldots, T\\), we have\n\\[\na_{s_{i}-k}+a_{s_{i}-k+1}+\\cdots+a_{s_{i}+k} \\leqslant a_{s_{i}}+(k-1)=k .\n\\]\n\nRecall that \\(a_{j}=0\\) for all \\(j\\) with \\(s_{i}+k<j<a_{s_{i+1}}\\). Therefore,\n\\[\nS_{i-1}+S_{i}=\\sum_{j=s_{i-1}}^{s_{i}+k} a_{j}=\\sum_{j=s_{i-1}}^{s_{i}-k-1} a_{j}+\\sum_{j=s_{i}-k}^{s_{i}+k} a_{j} \\leqslant\\left(s_{i}-s_{i-1}-k\\right)+k=L_{i-1} .\n\\]\n\nSumming up these equalities over \\(i=1,2, \\ldots, T\\) we get\n\\[\n2 t(n+1)=\\sum_{i=1}^{T}\\left(S_{i-1}+S_{i}\\right) \\leqslant \\sum_{i=1}^{T} L_{i-1}=(2 n+1) t,\n\\]\nwhich is a contradiction.\nComment 3. Here we present a proof of Raney's lemma different from the one used above.\nIf we plot the partial sums \\(s_{n}=x_{1}+\\cdots+x_{n}\\) as a function of \\(n\\), the graph of \\(s_{n}\\) has an average slope of \\(1 / m\\), because \\(s_{m+n}=s_{n}+1\\).\n![](https://cdn.mathpix.com/cropped/2025_08_23_53f86fa89253df1f58beg-33.jpg?height=344&width=1380&top_left_y=1744&top_left_x=345)\n\nThe entire graph can be contained between two lines of slope \\(1 / m\\). In general these bounding lines touch the graph just once in each cycle of \\(m\\) points, since lines of slope \\(1 / m\\) hit points with integer coordinates only once per \\(m\\) units. The unique (in one cycle) lower point of intersection is the only place in the cycle from which all partial sums will be positive.\n\nComment 4. The following example shows that for different values of \\(k\\) the required girl may have different positions: 011001101.", "source_pdf": "imosl_2021.pdf", "notes": "fallback-regex"}
{"id": "IMOSL-2021-C6", "contest": "IMOSL", "year": "2021", "problem_number": "C6", "problem": "A hunter and an invisible rabbit play a game on an infinite square grid. First the hunter fixes a colouring of the cells with finitely many colours. The rabbit then secretly chooses a cell to start in. Every minute, the rabbit reports the colour of its current cell to the hunter, and then secretly moves to an adjacent cell that it has not visited before (two cells are adjacent if they share a side). The hunter wins if after some finite time either\n- the rabbit cannot move; or\n- the hunter can determine the cell in which the rabbit started.\n\nDecide whether there exists a winning strategy for the hunter.", "solution": "Answer: Yes, there exists a colouring that yields a winning strategy for the hunter.\n\n. A central idea is that several colourings \\(C_{1}, C_{2}, \\ldots, C_{k}\\) can be merged together into a single product colouring \\(C_{1} \\times C_{2} \\times \\cdots \\times C_{k}\\) as follows: the colours in the product colouring are ordered tuples ( \\(c_{1}, \\ldots, c_{n}\\) ) of colours, where \\(c_{i}\\) is a colour used in \\(C_{i}\\), so that each cell gets a tuple consisting of its colours in the individual colourings \\(C_{i}\\). This way, any information which can be determined from one of the individual colourings can also be determined from the product colouring.\n\nNow let the hunter merge the following colourings:\n- The first two colourings \\(C_{1}\\) and \\(C_{2}\\) allow the tracking of the horizontal and vertical movements of the rabbit.\n\nThe colouring \\(C_{1}\\) colours the cells according to the residue of their \\(x\\)-coordinates modulo 3 , which allows to determine whether the rabbit moves left, moves right, or moves vertically. Similarly, the colouring \\(C_{2}\\) uses the residues of the \\(y\\)-coordinates modulo 3 , which allows to determine whether the rabbit moves up, moves down, or moves horizontally.\n- Under the condition that the rabbit's \\(x\\)-coordinate is unbounded, colouring \\(C_{3}\\) allows to determine the exact value of the \\(x\\)-coordinate:\n\nIn \\(C_{3}\\), the columns are coloured white and black so that the gaps between neighboring black columns are pairwise distinct. As the rabbit's \\(x\\)-coordinate is unbounded, it will eventually visit two black cells in distinct columns. With the help of colouring \\(C_{1}\\) the hunter can catch that moment, and determine the difference of \\(x\\)-coordinates of those two black cells, hence deducing the precise column.\n\nSymmetrically, under the condition that the rabbit's \\(y\\)-coordinate is unbounded, there is a colouring \\(C_{4}\\) that allows the hunter to determine the exact value of the \\(y\\)-coordinate.\n- Finally, under the condition that the sum \\(x+y\\) of the rabbit's coordinates is unbounded, colouring \\(C_{5}\\) allows to determine the exact value of this sum: The diagonal lines \\(x+y=\\) const are coloured black and white, so that the gaps between neighboring black diagonals are pairwise distinct.\n\nUnless the rabbit gets stuck, at least two of the three values \\(x, y\\) and \\(x+y\\) must be unbounded as the rabbit keeps moving. Hence the hunter can eventually determine two of these three values; thus he does know all three. Finally the hunter works backwards with help of the colourings \\(C_{1}\\) and \\(C_{2}\\) and computes the starting cell of the rabbit.\n\nComment. There are some variations of the solution above: e.g., the colourings \\(C_{3}, C_{4}\\) and \\(C_{5}\\) can be replaced with different ones. However, such alternatives are more technically involved, and we do not present them here.", "source_pdf": "imosl_2021.pdf", "notes": "fallback-regex"}
{"id": "IMOSL-2021-C7", "contest": "IMOSL", "year": "2021", "problem_number": "C7", "problem": "Consider a checkered \\(3 m \\times 3 m\\) square, where \\(m\\) is an integer greater than 1. A frog sits on the lower left corner cell \\(S\\) and wants to get to the upper right corner cell \\(F\\). The frog can hop from any cell to either the next cell to the right or the next cell upwards.\n\nSome cells can be sticky, and the frog gets trapped once it hops on such a cell. A set \\(X\\) of cells is called blocking if the frog cannot reach \\(F\\) from \\(S\\) when all the cells of \\(X\\) are sticky. A blocking set is minimal if it does not contain a smaller blocking set.\n(a) Prove that there exists a minimal blocking set containing at least \\(3 m^{2}-3 m\\) cells.\n(b) Prove that every minimal blocking set contains at most \\(3 m^{2}\\) cells.\n\nNote. An example of a minimal blocking set for \\(m=2\\) is shown below. Cells of the set \\(X\\) are marked by letters \\(x\\).\n\n\\begin{tabular}{|l|l|l|l|l|l|}\n\\hline & & & & & \\(F\\) \\\\\n\\hline\\(x\\) & \\(x\\) & & & & \\\\\n\\hline & & \\(x\\) & & & \\\\\n\\hline & & & \\(x\\) & & \\\\\n\\hline & & & & \\(x\\) & \\\\\n\\hline\\(S\\) & & \\(x\\) & & & \\\\\n\\hline\n\\end{tabular}", "solution": "for part (a). In the following example the square is divided into \\(m\\) stripes of size \\(3 \\times 3 \\mathrm{~m}\\). It is easy to see that \\(X\\) is a minimal blocking set. The first and the last stripe each contains \\(3 m-1\\) cells from the set \\(X\\); every other stripe contains \\(3 m-2\\) cells, see Figure 1. The total number of cells in the set \\(X\\) is \\(3 m^{2}-2 m+2\\).\n\n\\begin{table}\n\\begin{tabular}{|l|l|l|l|l|l|l|l|l|l|l|l|l|l|l|l|}\n\\hline x & & & \\multicolumn{6}{|c|}{} & \\multicolumn{4}{|c|}{} & \\multicolumn{3}{|r|}{\\(F\\)} \\\\\n\\hline & \\(x\\) & & \\(x\\) & & & \\(x\\) & & & . & \\(x\\) & & & \\(x\\) & & \\\\\n\\hline & \\(x\\) & & & \\(x\\) & & & \\(x\\) & & & & \\(x\\) & & & \\(x\\) & \\\\\n\\hline & \\(x\\) & & & \\(x\\) & & & \\(x\\) & & & & \\(x\\) & & & \\(x\\) & \\\\\n\\hline & - & & & - & & & - & & ... & & - & & & - & \\\\\n\\hline & \\(x\\) & & & \\(x\\) & & & \\(x\\) & & & & \\(x\\) & & & \\(x\\) & \\\\\n\\hline & \\(x\\) & & & \\(x\\) & & & \\(x\\) & & & & \\(x\\) & & & \\(x\\) & \\\\\n\\hline & & \\(x\\) & & & \\(x\\) & & & \\(x\\) & \\multirow{2}{*}{\\(\\qquad\\)} & & & \\(x\\) & & \\(x\\) & \\\\\n\\hline \\(S\\) & & & & & & & & & & & & & & & \\(x\\) \\\\\n\\hline\n\\end{tabular}\n\\captionsetup{labelformat=empty}\n\\caption{Figure 1}\n\\end{table}\n\nSolution 1 for part (b). For a given blocking set \\(X\\), say that a non-sticky cell is red if the frog can reach it from \\(S\\) via some hops without entering set \\(X\\). We call a non-sticky cell blue if the frog can reach \\(F\\) from that cell via hops without entering set \\(X\\). One can regard the blue cells as those reachable from \\(F\\) by anti-hops, i.e. moves downwards and to the left. We also colour all cells in \\(X\\) green. It follows from the definition of the blocking set that no cell will be coloured twice. In Figure 2 we show a sample of a blocking set and the corresponding colouring.\n\nNow assume that \\(X\\) is a minimal blocking set. We denote by \\(R\\) (resp., \\(B\\) and \\(G\\) ) be the total number of red (resp., blue and green) cells.\n\nWe claim that \\(G \\leqslant R+1\\) and \\(G \\leqslant B+1\\). Indeed, there are at most \\(2 R\\) possible frog hops from red cells. Every green or red cell (except for \\(S\\) ) is accessible by such hops. Hence \\(2 R \\geqslant G+(R-1)\\), or equivalently \\(G \\leqslant R+1\\). In order to prove the inequality \\(G \\leqslant B+1\\), we turn over the board and apply the similar arguments.\n\nTherefore we get \\(9 m^{2} \\geqslant B+R+G \\geqslant 3 G-2\\), so \\(G \\leqslant 3 m^{2}\\).\n\n\\begin{table}\n\\begin{tabular}{|l|l|l|l|l|l|l|l|l|}\n\\hline\\(x\\) & & & & & & & & \\(F\\) \\\\\n\\hline & \\(x\\) & & \\(x\\) & & & \\(x\\) & & \\\\\n\\hline & \\(x\\) & & & \\(x\\) & & & \\(x\\) & \\\\\n\\hline & \\(x\\) & & & \\(x\\) & & & \\(x\\) & \\\\\n\\hline & \\(x\\) & & & \\(x\\) & & & \\(x\\) & \\\\\n\\hline & \\(x\\) & & & \\(x\\) & & & \\(x\\) & \\\\\n\\hline & \\(x\\) & & & \\(x\\) & & & \\(x\\) & \\\\\n\\hline & & \\(x\\) & & & \\(x\\) & & \\(x\\) & \\\\\n\\hline\\(S\\) & & & & & & & & \\(x\\) \\\\\n\\hline\n\\end{tabular}\n\\captionsetup{labelformat=empty}\n\\caption{Figure 2 (a)}\n\\end{table}\n\n\\begin{figure}\n\\includegraphics[width=\\textwidth]{https://cdn.mathpix.com/cropped/2025_08_23_53f86fa89253df1f58beg-36.jpg?height=386&width=389&top_left_y=211&top_left_x=1099}\n\\captionsetup{labelformat=empty}\n\\caption{Figure 2 (b)}\n\\end{figure}\n\nSolution 2 for part (b). We shall use the same colouring as in the above solution. Again, assume that \\(X\\) is a minimal blocking set.\n\nNote that any \\(2 \\times 2\\) square cannot contain more than 2 green cells. Indeed, on Figure 3(a) the cell marked with \"?\" does not block any path, while on Figure 3(b) the cell marked with \"?\" should be coloured red and blue simultaneously. So we can split all green cells into chains consisting of three types of links shown on Figure 4 (diagonal link in the other direction is not allowed, corresponding green cells must belong to different chains). For example, there are 3 chains in Figure 2(b).\n\n\\begin{figure}\n\\includegraphics[width=\\textwidth]{https://cdn.mathpix.com/cropped/2025_08_23_53f86fa89253df1f58beg-36.jpg?height=173&width=252&top_left_y=1130&top_left_x=354}\n\\captionsetup{labelformat=empty}\n\\caption{Figure 3}\n\\end{figure}\n\n\\begin{figure}\n\\includegraphics[width=\\textwidth]{https://cdn.mathpix.com/cropped/2025_08_23_53f86fa89253df1f58beg-36.jpg?height=147&width=435&top_left_y=1147&top_left_x=1282}\n\\captionsetup{labelformat=empty}\n\\caption{Figure 5}\n\\end{figure}\n\nWe will inscribe green chains in disjoint axis-aligned rectangles so that the number of green cells in each rectangle will not exceed \\(1 / 3\\) of the area of the rectangle. This will give us the bound \\(G \\leqslant 3 m^{2}\\). Sometimes the rectangle will be the minimal bounding rectangle of the chain, sometimes minimal bounding rectangles will be expanded in one or two directions in order to have sufficiently large area.\n\nNote that for any two consecutive cells in the chain the colouring of some neighbouring cells is uniquely defined (see Figure 5). In particular, this observation gives a corresponding rectangle for the chains of height (or width) 1 (see Figure 6(a)). A separate green cell can be inscribed in \\(1 \\times 3\\) or \\(3 \\times 1\\) rectangle with one red and one blue cell, see Figure 6(b)-(c), otherwise we get one of impossible configurations shown in Figure 3.\n\n\\begin{figure}\n\\includegraphics[width=\\textwidth]{https://cdn.mathpix.com/cropped/2025_08_23_53f86fa89253df1f58beg-36.jpg?height=225&width=999&top_left_y=1874&top_left_x=536}\n\\captionsetup{labelformat=empty}\n\\caption{Figure 6}\n\\end{figure}\n![](https://cdn.mathpix.com/cropped/2025_08_23_53f86fa89253df1f58beg-36.jpg?height=106&width=95&top_left_y=1182&top_left_x=731)\n\n\\begin{figure}\n\\captionsetup{labelformat=empty}\n\\caption{4}\n\\includegraphics[width=\\textwidth]{https://cdn.mathpix.com/cropped/2025_08_23_53f86fa89253df1f58beg-36.jpg?height=135&width=289&top_left_y=1153&top_left_x=868}\n\\end{figure}\n\nFigure 7\n\nAny diagonal chain of length 2 is always inscribed in a \\(2 \\times 3\\) or \\(3 \\times 2\\) rectangle without another green cells. Indeed, one of the squares marked with \"?\" in Figure 7(a) must be red. If it is the bottom question mark, then the remaining cell in the corresponding \\(2 \\times 3\\) rectangle must have the same colour, see Figure 7(b).\n\nA longer chain of height (or width) 2 always has a horizontal (resp., vertical) link and can be inscribed into a \\(3 \\times a\\) rectangle. In this case we expand the minimal bounding rectangle across the long side which touches the mentioned link. On Figure 8(a) the corresponding expansion of the minimal bounding rectangle is coloured in light blue. The upper right corner cell must be also blue. Indeed it cannot be red or green. If it is not coloured in blue, see Figure 8(b), then all anti-hop paths from \\(F\\) to \"?\" are blocked with green cells. And these green cells are surrounded by blue ones, what is impossible. In this case the green chain contains \\(a\\) cells, which is exactly \\(1 / 3\\) of the area of the rectangle.\n![](https://cdn.mathpix.com/cropped/2025_08_23_53f86fa89253df1f58beg-37.jpg?height=341&width=792&top_left_y=199&top_left_x=639)\n\nIn the remaining case the minimal bounding rectangle of the chain is of size \\(a \\times b\\) where \\(a, b \\geqslant 3\\). Denote by \\(\\ell\\) the length of the chain (i.e. the number of cells in the chain).\n\nIf the chain has at least two diagonal links (see Figure 9), then \\(\\ell \\leqslant a+b-3 \\leqslant a b / 3\\).\nIf the chain has only one diagonal link then \\(\\ell=a+b-2\\). In this case the chain has horizontal and vertical end-links, and we expand the minimal bounding rectangle in two directions to get an \\((a+1) \\times(b+1)\\) rectangle. On Figure 10 a corresponding expansion of the minimal bounding rectangle is coloured in light red. Again the length of the chain does not exceed \\(1 / 3\\) of the rectangle's area: \\(\\ell \\leqslant a+b-2 \\leqslant(a+1)(b+1) / 3\\).\n\nOn the next step we will use the following statement: all cells in constructed rectangles are coloured red, green or blue (the cells upwards and to the right of green cells are blue; the cells downwards and to the left of green cells are red). The proof repeats the same arguments as before (see Figure 8(b).)\n\n\\begin{figure}\n\\includegraphics[width=\\textwidth]{https://cdn.mathpix.com/cropped/2025_08_23_53f86fa89253df1f58beg-37.jpg?height=141&width=261&top_left_y=1364&top_left_x=291}\n\\captionsetup{labelformat=empty}\n\\caption{Figure 9}\n\\end{figure}\n\n\\begin{figure}\n\\includegraphics[width=\\textwidth]{https://cdn.mathpix.com/cropped/2025_08_23_53f86fa89253df1f58beg-37.jpg?height=178&width=301&top_left_y=1327&top_left_x=685}\n\\captionsetup{labelformat=empty}\n\\caption{Figure 10}\n\\end{figure}\n\n\\begin{figure}\n\\includegraphics[width=\\textwidth]{https://cdn.mathpix.com/cropped/2025_08_23_53f86fa89253df1f58beg-37.jpg?height=298&width=675&top_left_y=1213&top_left_x=1110}\n\\captionsetup{labelformat=empty}\n\\caption{Figure 11}\n\\end{figure}\n\nNote that all constructed rectangles are disjoint. Indeed, assume that two rectangles have a common cell. Using the above statement, one can see that the only such cell can be a common corner cell, as shown in Figure 11. Moreover, in this case both rectangles should be expanded, otherwise they would share a green corner cell.\n\nIf they were expanded along the same axis (see Figure 11(a)), then again the common corner cannot be coloured correctly. If they were expanded along different axes (see Figure 11(b)) then the two chains have a common point and must be connected in one chain. (These arguments work for \\(2 \\times 3\\) and \\(1 \\times 3\\) rectangles in a similar manner.)\n\nComment 1. We do not a priori know whether all points are either red, or blue, or green. One might colour the remaining cells in black. The arguments from Solution 2 allow to prove that black cells do not exist. (One can start with a black cell which is nearest to \\(S\\). Its left and downward neighbours must be coloured green or blue. In all cases one gets a configuration similar to Figure 8(b).)\n\nComment 2. The maximal possible size of a minimal blocking set in \\(3 m \\times 3 m\\) rectangle seems to be \\(3 m^{2}-2 m+2\\).\n\nOne can prove a more precise upper bound on the cardinality of the minimal blocking set: \\(G \\leqslant 3 m^{2}-m+2\\). Denote by \\(D_{R}\\) the number of red branching cells (i.e. such cells which have 2 red subsequent neighbours). And let \\(D_{B}\\) be the number of similar blue cells. Then a double counting argument allows to prove that \\(G \\leqslant R-D_{R}+1\\) and \\(G \\leqslant B-D_{B}+1\\). Thus, we can bound \\(G\\) in terms of \\(D_{B}\\) and \\(D_{R}\\) as\n\\[\n9 m^{2} \\geqslant R+B+G \\geqslant 3 G+D_{R}+D_{B}-2 .\n\\]\n\nNow one can estimate the number of branching cells in order to obtain that \\(G \\leqslant 3 m^{2}-m+2\\).\n\nComment 3. An example with \\(3 m^{2}-2 m+2\\) green cells may look differently; see, e.g., Figure 12.\n\n\\begin{figure}\n\\includegraphics[width=\\textwidth]{https://cdn.mathpix.com/cropped/2025_08_23_53f86fa89253df1f58beg-38.jpg?height=540&width=549&top_left_y=291&top_left_x=759}\n\\captionsetup{labelformat=empty}\n\\caption{Figure 12}\n\\end{figure}", "source_pdf": "imosl_2021.pdf", "notes": "fallback-regex"}
{"id": "IMOSL-2021-C8", "contest": "IMOSL", "year": "2021", "problem_number": "C8", "problem": "Determine the largest \\(N\\) for which there exists a table \\(T\\) of integers with \\(N\\) rows and 100 columns that has the following properties:\n(i) Every row contains the numbers \\(1,2, \\ldots, 100\\) in some order.\n(ii) For any two distinct rows \\(r\\) and \\(s\\), there is a column \\(c\\) such that \\(|T(r, c)-T(s, c)| \\geqslant 2\\).\n\nHere \\(T(r, c)\\) means the number at the intersection of the row \\(r\\) and the column \\(c\\).", "solution": "Answer: The largest such integer is \\(N=100!/ 2^{50}\\).\n\n\\section*{\n\n1.}\n\nNon-existence of a larger table. Let us consider some fixed row in the table, and let us replace (for \\(k=1,2, \\ldots, 50\\) ) each of two numbers \\(2 k-1\\) and \\(2 k\\) respectively by the symbol \\(x_{k}\\). The resulting pattern is an arrangement of 50 symbols \\(x_{1}, x_{2}, \\ldots, x_{50}\\), where every symbol occurs exactly twice. Note that there are \\(N=100!/ 2^{50}\\) distinct patterns \\(P_{1}, \\ldots, P_{N}\\).\n\nIf two rows \\(r \\neq s\\) in the table have the same pattern \\(P_{i}\\), then \\(|T(r, c)-T(s, c)| \\leqslant 1\\) holds for all columns \\(c\\). As this violates property (ii) in the problem statement, different rows have different patterns. Hence there are at most \\(N=100!/ 2^{50}\\) rows.\n\nExistence of a table with \\(N\\) rows. We construct the table by translating every pattern \\(P_{i}\\) into a corresponding row with the numbers \\(1,2, \\ldots, 100\\). We present a procedure that inductively replaces the symbols by numbers. The translation goes through steps \\(k=1,2, \\ldots, 50\\) in increasing order and at step \\(k\\) replaces the two occurrences of symbol \\(x_{k}\\) by \\(2 k-1\\) and \\(2 k\\).\n- The left occurrence of \\(x_{1}\\) is replaced by 1 , and its right occurrence is replaced by 2 .\n- For \\(k \\geqslant 2\\), we already have the number \\(2 k-2\\) somewhere in the row, and now we are looking for the places for \\(2 k-1\\) and \\(2 k\\). We make the three numbers \\(2 k-2,2 k-1,2 k\\) show up (ordered from left to right) either in the order \\(2 k-2,2 k-1,2 k\\), or as \\(2 k, 2 k-2,2 k-1\\), or as \\(2 k-1,2 k, 2 k-2\\). This is possible, since the number \\(2 k-2\\) has been placed in the preceding step, and shows up before / between / after the two occurrences of the symbol \\(x_{k}\\).\n\nWe claim that the \\(N\\) rows that result from the \\(N\\) patterns yield a table with the desired property (ii). Indeed, consider the \\(r\\)-th and the \\(s\\)-th row ( \\(r \\neq s\\) ), which by construction result from patterns \\(P_{r}\\) and \\(P_{s}\\). Call a symbol \\(x_{i}\\) aligned, if it occurs in the same two columns in \\(P_{r}\\) and in \\(P_{s}\\). Let \\(k\\) be the largest index, for which symbol \\(x_{k}\\) is not aligned. Note that \\(k \\geqslant 2\\). Consider the column \\(c^{\\prime}\\) with \\(T\\left(r, c^{\\prime}\\right)=2 k\\) and the column \\(c^{\\prime \\prime}\\) with \\(T\\left(s, c^{\\prime \\prime}\\right)=2 k\\). Then \\(T\\left(r, c^{\\prime \\prime}\\right) \\leqslant 2 k\\) and \\(T\\left(s, c^{\\prime}\\right) \\leqslant 2 k\\), as all symbols \\(x_{i}\\) with \\(i \\geqslant k+1\\) are aligned.\n- If \\(T\\left(r, c^{\\prime \\prime}\\right) \\leqslant 2 k-2\\), then \\(\\left|T\\left(r, c^{\\prime \\prime}\\right)-T\\left(s, c^{\\prime \\prime}\\right)\\right| \\geqslant 2\\) as desired.\n- If \\(T\\left(s, c^{\\prime}\\right) \\leqslant 2 k-2\\), then \\(\\left|T\\left(r, c^{\\prime}\\right)-T\\left(s, c^{\\prime}\\right)\\right| \\geqslant 2\\) as desired.\n- If \\(T\\left(r, c^{\\prime \\prime}\\right)=2 k-1\\) and \\(T\\left(s, c^{\\prime}\\right)=2 k-1\\), then the symbol \\(x_{k}\\) is aligned; contradiction.\n\nIn the only remaining case we have \\(c^{\\prime}=c^{\\prime \\prime}\\), so that \\(T\\left(r, c^{\\prime}\\right)=T\\left(s, c^{\\prime}\\right)=2 k\\) holds. Now let us consider the columns \\(d^{\\prime}\\) and \\(d^{\\prime \\prime}\\) with \\(T\\left(r, d^{\\prime}\\right)=2 k-1\\) and \\(T\\left(s, d^{\\prime \\prime}\\right)=2 k-1\\). Then \\(d \\neq d^{\\prime \\prime}\\) (as the symbol \\(x_{k}\\) is not aligned), and \\(T\\left(r, d^{\\prime \\prime}\\right) \\leqslant 2 k-2\\) and \\(T\\left(s, d^{\\prime}\\right) \\leqslant 2 k-2\\) (as all symbols \\(x_{i}\\) with \\(i \\geqslant k+1\\) are aligned).\n- If \\(T\\left(r, d^{\\prime \\prime}\\right) \\leqslant 2 k-3\\), then \\(\\left|T\\left(r, d^{\\prime \\prime}\\right)-T\\left(s, d^{\\prime \\prime}\\right)\\right| \\geqslant 2\\) as desired.\n- If \\(T\\left(s, c^{\\prime}\\right) \\leqslant 2 k-3\\), then \\(\\left|T\\left(r, d^{\\prime}\\right)-T\\left(s, d^{\\prime}\\right)\\right| \\geqslant 2\\) as desired.\n\nIn the only remaining case we have \\(T\\left(r, d^{\\prime \\prime}\\right)=2 k-2\\) and \\(T\\left(s, d^{\\prime}\\right)=2 k-2\\). Now the row \\(r\\) has the numbers \\(2 k-2,2 k-1,2 k\\) in the three columns \\(d^{\\prime}, d^{\\prime \\prime}, c^{\\prime}\\). As one of these triples violates the ordering property of \\(2 k-2,2 k-1,2 k\\), we have the final contradiction.\n\nComment 1. We can identify rows of the table \\(T\\) with permutations of \\(\\mathcal{M}:=\\{1, \\ldots, 100\\}\\); also for every set \\(S \\subset \\mathcal{M}\\) each row induces a subpermutation of \\(S\\) obtained by ignoring all entries not from \\(S\\).\n\nThe example from Solution 1 consists of all permutations for which all subpermutations of the 50 sets \\(\\{1,2\\},\\{2,3,4\\},\\{4,5,6\\}, \\ldots,\\{98,99,100\\}\\) are even.\n\nSolution 2. We provide a bit different proof why the example from Solution 1 (see also Comment 1) works.\nLemma. Let \\(\\pi_{1}\\) and \\(\\pi_{2}\\) be two permutations of the set \\(\\{1,2, \\ldots, n\\}\\) such that \\(\\left|\\pi_{1}(i)-\\pi_{2}(i)\\right| \\leqslant 1\\) for every \\(i\\). Then there exists a set of disjoint pairs ( \\(i, i+1\\) ) such that \\(\\pi_{2}\\) is obtained from \\(\\pi_{1}\\) by swapping elements in each pair from the set.\nProof. We may assume that \\(\\pi_{1}(i)=i\\) for every \\(i\\) and proceed by induction on \\(n\\). The case \\(n=1\\) is trivial. If \\(\\pi_{2}(n)=n\\), we simply apply the induction hypothesis. If \\(\\pi_{2}(n)=n-1\\), then \\(\\pi_{2}(i)=n\\) for some \\(i<n\\). It is clear that \\(i=n-1\\), and we can also use the induction hypothesis.\n\nNow let \\(\\pi_{1}\\) and \\(\\pi_{2}\\) be two rows (which we identify with permutations of \\(\\{1,2, \\ldots, 100\\}\\) ) of the table constructed in Solution 1. Assume that \\(\\left|\\pi_{1}(i)-\\pi_{2}(i)\\right| \\leqslant 1\\) for any \\(i\\). From the Lemma it follows that there exists a set \\(S \\subset\\{1, \\ldots, 99\\}\\) such that any two numbers from \\(S\\) differ by at least 2 and \\(\\pi_{2}\\) is obtained from \\(\\pi_{1}\\) by applying the permutations ( \\(j, j+1\\) ), \\(j \\in S\\). Let \\(r=\\min (S)\\). If \\(r=2 k-1\\) is odd, then \\(\\pi_{1}\\) and \\(\\pi_{2}\\) induce two subpermutations of \\(\\{2 k-2,2 k-1,2 k\\}\\) (or of \\(\\{1,2\\}\\) for \\(k=1\\) ) of opposite parities. Thus \\(r=2 k\\) is even. Since \\(\\pi_{1}\\) and \\(\\pi_{2}\\) induce subpermutations of the same (even) parity of \\(\\{2 k, 2 k+1,2 k+2\\}\\), we must have \\(2 k+2 \\in S\\). Next, \\(2 k+4 \\in S\\) and so on, we get \\(98 \\in S\\), but then the parities of the subpermutations of \\(\\{98,99,100\\}\\) in \\(\\pi_{1}, \\pi_{2}\\) are opposite. A contradiction.\n\nComment 2. In Solution 2 we only used that for each set from \\(\\{1,2\\},\\{2,3,4\\},\\{4,5,6\\}, \\ldots,\\{98,99,100\\}\\) any two rows of \\(T\\) induce a subpermutation of the same parity, not necessarily even.\n\n\\section*{Geometry}", "source_pdf": "imosl_2021.pdf", "notes": "fallback-regex"}
{"id": "IMOSL-2021-G1", "contest": "IMOSL", "year": "2021", "problem_number": "G1", "problem": "Let \\(A B C D\\) be a parallelogram such that \\(A C=B C\\). A point \\(P\\) is chosen on the extension of the segment \\(A B\\) beyond \\(B\\). The circumcircle of the triangle \\(A C D\\) meets the segment \\(P D\\) again at \\(Q\\), and the circumcircle of the triangle \\(A P Q\\) meets the segment \\(P C\\) again at \\(R\\). Prove that the lines \\(C D, A Q\\), and \\(B R\\) are concurrent.", "solution": "Common remarks. The introductory steps presented here are used in all solutions below.\nSince \\(A C=B C=A D\\), we have \\(\\angle A B C=\\angle B A C=\\angle A C D=\\angle A D C\\). Since the quadrilaterals \\(A P R Q\\) and \\(A Q C D\\) are cyclic, we obtain\n\\[\n\\angle C R A=180^{\\circ}-\\angle A R P=180^{\\circ}-\\angle A Q P=\\angle D Q A=\\angle D C A=\\angle C B A,\n\\]\nso the points \\(A, B, C\\) and \\(R\\) lie on some circle \\(\\gamma\\).\n\n1. Introduce the point \\(X=A Q \\cap C D\\); we need to prove that \\(B, R\\) and \\(X\\) are collinear.\n\nBy means of the circle ( \\(A P R Q\\) ) we have\n\\[\n\\angle R Q X=180^{\\circ}-\\angle A Q R=\\angle R P A=\\angle R C X\n\\]\n(the last equality holds in view of \\(A B \\| C D\\) ), which means that the points \\(C, Q, R\\), and \\(X\\) also lie on some circle \\(\\delta\\).\n\nUsing the circles \\(\\delta\\) and \\(\\gamma\\) we finally obtain\n\\[\n\\angle X R C=\\angle X Q C=180^{\\circ}-\\angle C Q A=\\angle A D C=\\angle B A C=180^{\\circ}-\\angle C R B,\n\\]\nthat proves the desired collinearity.\n![](https://cdn.mathpix.com/cropped/2025_08_23_53f86fa89253df1f58beg-42.jpg?height=678&width=1163&top_left_y=1464&top_left_x=451)\n\nSolution 2. Let \\(\\alpha\\) denote the circle ( \\(A P R Q\\) ). Since\n\\[\n\\angle C A P=\\angle A C D=\\angle A Q D=180^{\\circ}-\\angle A Q P,\n\\]\nthe line \\(A C\\) is tangent to \\(\\alpha\\).\nNow, let \\(A D\\) meet \\(\\alpha\\) again at a point \\(Y\\) (which necessarily lies on the extension of \\(D A\\) beyond \\(A\\) ). Using the circle \\(\\gamma\\), along with the fact that \\(A C\\) is tangent to \\(\\alpha\\), we have\n\\[\n\\angle A R Y=\\angle C A D=\\angle A C B=\\angle A R B,\n\\]\nso the points \\(Y, B\\), and \\(R\\) are collinear.\nApplying Pascal's theorem to the hexagon \\(A A Y R P Q\\) (where \\(A A\\) is regarded as the tangent to \\(\\alpha\\) at \\(A\\) ), we see that the points \\(A A \\cap R P=C, A Y \\cap P Q=D\\), and \\(Y R \\cap Q A\\) are collinear. Hence the lines \\(C D, A Q\\), and \\(B R\\) are concurrent.\n\nComment 1. Solution 2 consists of two parts: (1) showing that \\(B R\\) and \\(D A\\) meet on \\(\\alpha\\); and (2) showing that this yields the desired concurrency. Solution 3 also splits into those parts, but the proofs are different.\n![](https://cdn.mathpix.com/cropped/2025_08_23_53f86fa89253df1f58beg-43.jpg?height=1060&width=1163&top_left_y=348&top_left_x=448)\n\nSolution 3. As in Solution 1, we introduce the point \\(X=A Q \\cap C D\\) and aim at proving that the points \\(B, R\\), and \\(X\\) are collinear. As in Solution 2, we denote \\(\\alpha=(A P Q R)\\); but now we define \\(Y\\) to be the second meeting point of \\(R B\\) with \\(\\alpha\\).\n\nUsing the circle \\(\\alpha\\) and noticing that \\(C D\\) is tangent to \\(\\gamma\\), we obtain\n\\[\n\\angle R Y A=\\angle R P A=\\angle R C X=\\angle R B C .\n\\]\n\nSo \\(A Y \\| B C\\), and hence \\(Y\\) lies on \\(D A\\).\nNow the chain of equalities (1) shows also that \\(\\angle R Y D=\\angle R C X\\), which implies that the points \\(C, D, Y\\), and \\(R\\) lie on some circle \\(\\beta\\). Hence, the lines \\(C D, A Q\\), and \\(Y B R\\) are the pairwise radical axes of the circles ( \\(A Q C D\\) ), \\(\\alpha\\), and \\(\\beta\\), so those lines are concurrent.\n\nComment 2. The original problem submission contained an additional assumption that \\(B P=A B\\). The Problem Selection Committee removed this assumption as superfluous.", "source_pdf": "imosl_2021.pdf", "notes": "fallback-regex"}
{"id": "IMOSL-2021-G4", "contest": "IMOSL", "year": "2021", "problem_number": "G4", "problem": "Let \\(A B C D\\) be a quadrilateral inscribed in a circle \\(\\Omega\\). Let the tangent to \\(\\Omega\\) at \\(D\\) intersect the rays \\(B A\\) and \\(B C\\) at points \\(E\\) and \\(F\\), respectively. A point \\(T\\) is chosen inside the triangle \\(A B C\\) so that \\(T E \\| C D\\) and \\(T F \\| A D\\). Let \\(K \\neq D\\) be a point on the segment \\(D F\\) such that \\(T D=T K\\). Prove that the lines \\(A C, D T\\) and \\(B K\\) intersect at one point.", "solution": "1. Let the segments \\(T E\\) and \\(T F\\) cross \\(A C\\) at \\(P\\) and \\(Q\\), respectively. Since \\(P E \\| C D\\) and \\(E D\\) is tangent to the circumcircle of \\(A B C D\\), we have\n\\[\n\\angle E P A=\\angle D C A=\\angle E D A,\n\\]\nand so the points \\(A, P, D\\), and \\(E\\) lie on some circle \\(\\alpha\\). Similarly, the points \\(C, Q, D\\), and \\(F\\) lie on some circle \\(\\gamma\\).\n\nWe now want to prove that the line \\(D T\\) is tangent to both \\(\\alpha\\) and \\(\\gamma\\) at \\(D\\). Indeed, since \\(\\angle F C D+\\angle E A D=180^{\\circ}\\), the circles \\(\\alpha\\) and \\(\\gamma\\) are tangent to each other at \\(D\\). To prove that \\(T\\) lies on their common tangent line at \\(D\\) (i.e., on their radical axis), it suffices to check that \\(T P \\cdot T E=T Q \\cdot T F\\), or that the quadrilateral \\(P E F Q\\) is cyclic. This fact follows from\n\\[\n\\angle Q F E=\\angle A D E=\\angle A P E .\n\\]\n\nSince \\(T D=T K\\), we have \\(\\angle T K D=\\angle T D K\\). Next, as \\(T D\\) and \\(D E\\) are tangent to \\(\\alpha\\) and \\(\\Omega\\), respectively, we obtain\n\\[\n\\angle T K D=\\angle T D K=\\angle E A D=\\angle B D E,\n\\]\nwhich implies \\(T K \\| B D\\).\nNext we prove that the five points \\(T, P, Q, D\\), and \\(K\\) lie on some circle \\(\\tau\\). Indeed, since \\(T D\\) is tangent to the circle \\(\\alpha\\) we have\n\\[\n\\angle E P D=\\angle T D F=\\angle T K D,\n\\]\nwhich means that the point \\(P\\) lies on the circle (TDK). Similarly, we have \\(Q \\in(T D K)\\).\nFinally, we prove that \\(P K \\| B C\\). Indeed, using the circles \\(\\tau\\) and \\(\\gamma\\) we conclude that\n\\[\n\\angle P K D=\\angle P Q D=\\angle D F C,\n\\]\nwhich means that \\(P K \\| B C\\).\nTriangles \\(T P K\\) and \\(D C B\\) have pairwise parallel sides, which implies the fact that \\(T D, P C\\) and \\(K B\\) are concurrent, as desired.\n![](https://cdn.mathpix.com/cropped/2025_08_23_53f86fa89253df1f58beg-49.jpg?height=855&width=1248&top_left_y=1901&top_left_x=414)\n\nComment 1. There are several variations of the above solution.\nE.g., after finding circles \\(\\alpha\\) and \\(\\gamma\\), one can notice that there exists a homothety \\(h\\) mapping the triangle \\(T P Q\\) to the triangle \\(D C A\\); the centre of that homothety is \\(Y=A C \\cap T D\\). Since\n\\[\n\\angle D P E=\\angle D A E=\\angle D C B=\\angle D Q T,\n\\]\nthe quadrilateral \\(T P D Q\\) is inscribed in some circle \\(\\tau\\). We have \\(h(\\tau)=\\Omega\\), so the point \\(D^{*}=h(D)\\) lies on \\(\\Omega\\).\n\nFinally, by\n\\[\n\\angle D C D^{*}=\\angle T P D=\\angle B A D,\n\\]\nthe points \\(B\\) and \\(D^{*}\\) are symmetric with respect to the diameter of \\(\\Omega\\) passing through \\(D\\). This yields \\(D B=D D^{*}\\) and \\(B D^{*} \\| E F\\), so \\(h(K)=B\\), and \\(B K\\) passes through \\(Y\\).\n\nSolution 2. Consider the spiral similarity \\(\\phi\\) centred at \\(D\\) which maps \\(B\\) to \\(F\\). Recall that for any two points \\(X\\) and \\(Y\\), the triangles \\(D X \\phi(X)\\) and \\(D Y \\phi(Y)\\) are similar.\n\nDefine \\(T^{\\prime}=\\phi(E)\\). Then\n\\[\n\\angle C D F=\\angle F B D=\\angle \\phi(B) B D=\\angle \\phi(E) E D=\\angle T^{\\prime} E D,\n\\]\nso \\(C D \\| T^{\\prime} E\\). Using the fact that \\(D E\\) is tangent to ( \\(A B D\\) ) and then applying \\(\\phi\\) we infer\n\\[\n\\angle A D E=\\angle A B D=\\angle T^{\\prime} F D,\n\\]\nso \\(A D \\| T^{\\prime} F\\); hence \\(T^{\\prime}\\) coincides with \\(T\\). Therefore,\n\\[\n\\angle B D E=\\angle F D T=\\angle D K T,\n\\]\nwhence \\(T K \\| B D\\).\nLet \\(B K \\cap T D=X, A C \\cap T D=Y\\), and \\(A C \\cap T F=Q\\). Notice that \\(T K \\| B D\\) implies\n\\[\n\\frac{T X}{X D}=\\frac{T K}{B D}=\\frac{T D}{B D} .\n\\]\n\nSo we wish to prove that \\(\\frac{T Y}{Y D}\\) is equal to the same ratio.\nWe first show that \\(\\phi(A)=Q\\). Indeed,\n\\[\n\\angle D A \\phi(A)=\\angle D B F=\\angle D A C,\n\\]\nand so \\(\\phi(A) \\in A C\\). Together with \\(\\phi(A) \\in \\phi(E B)=T F\\) this yields \\(\\phi(A)=Q\\). It follows that\n\\[\n\\frac{T Q}{A E}=\\frac{T D}{E D} .\n\\]\n![](https://cdn.mathpix.com/cropped/2025_08_23_53f86fa89253df1f58beg-50.jpg?height=849&width=1232&top_left_y=1907&top_left_x=416)\n\nNow, since \\(T F \\| A D\\) and \\(\\triangle E A D \\sim \\triangle E D B\\), we have\n\\[\n\\frac{T Y}{Y D}=\\frac{T Q}{A D}=\\frac{T Q}{A E} \\cdot \\frac{A E}{A D}=\\frac{T D}{E D} \\cdot \\frac{E D}{B D}=\\frac{T D}{B D},\n\\]\nwhich completes the proof.\nComment 2. The point \\(D\\) is the Miquel point for any 4 of the 5 lines \\(B A, B C, T E, T F\\) and \\(A C\\). Essentially, this is proved in both solutions by different methods.", "source_pdf": "imosl_2021.pdf", "notes": "fallback-regex"}
{"id": "IMOSL-2021-G5", "contest": "IMOSL", "year": "2021", "problem_number": "G5", "problem": "Let \\(A B C D\\) be a cyclic quadrilateral whose sides have pairwise different lengths. Let \\(O\\) be the circumcentre of \\(A B C D\\). The internal angle bisectors of \\(\\angle A B C\\) and \\(\\angle A D C\\) meet \\(A C\\) at \\(B_{1}\\) and \\(D_{1}\\), respectively. Let \\(O_{B}\\) be the centre of the circle which passes through \\(B\\) and is tangent to \\(A C\\) at \\(D_{1}\\). Similarly, let \\(O_{D}\\) be the centre of the circle which passes through \\(D\\) and is tangent to \\(A C\\) at \\(B_{1}\\).\n\nAssume that \\(B D_{1} \\| D B_{1}\\). Prove that \\(O\\) lies on the line \\(O_{B} O_{D}\\).", "solution": "Common remarks. We introduce some objects and establish some preliminary facts common for all solutions below.\n\nLet \\(\\Omega\\) denote the circle ( \\(A B C D\\) ), and let \\(\\gamma_{B}\\) and \\(\\gamma_{D}\\) denote the two circles from the problem statement (their centres are \\(O_{B}\\) and \\(O_{D}\\), respectively). Clearly, all three centres \\(O, O_{B}\\), and \\(O_{D}\\) are distinct.\n\nAssume, without loss of generality, that \\(A B>B C\\). Suppose that \\(A D>D C\\), and let \\(H=A C \\cap B D\\). Then the rays \\(B B_{1}\\) and \\(D D_{1}\\) lie on one side of \\(B D\\), as they contain the midpoints of the arcs \\(A D C\\) and \\(A B C\\), respectively. However, if \\(B D_{1} \\| D B_{1}\\), then \\(B_{1}\\) and \\(D_{1}\\) should be separated by \\(H\\). This contradiction shows that \\(A D<C D\\).\n\nLet \\(\\gamma_{B}\\) and \\(\\gamma_{D}\\) meet \\(\\Omega\\) again at \\(T_{B}\\) and \\(T_{D}\\), respectively. The common chord \\(B T_{B}\\) of \\(\\Omega\\) and \\(\\gamma_{B}\\) is perpendicular to their line of\n\n\\begin{figure}\n\\includegraphics[width=\\textwidth]{https://cdn.mathpix.com/cropped/2025_08_23_53f86fa89253df1f58beg-52.jpg?height=420&width=492&top_left_y=825&top_left_x=1387}\n\\captionsetup{labelformat=empty}\n\\caption{\\(O_{B} O\\left\\|O_{D} O \\Longleftrightarrow B T_{B}\\right\\|\\)}\n\\end{figure}\ncentres \\(O_{B} O\\); likewise, \\(D T_{D} \\perp O_{D} O\\). Therefore, \\(O \\in O_{B} O_{D} \\Longleftrightarrow O_{B} O\\left\\|O_{D} O \\Longleftrightarrow B T_{B}\\right\\| D T_{D}\\), and the problem reduces to showing that\n\\[\nB T_{B} \\| D T_{D} .\n\\]\n\nComment 1. It seems that the discussion of the positions of points is necessary for both Solutions below. However, this part automatically follows from the angle chasing in Comment 2.\n\n1. Let the diagonals \\(A C\\) and \\(B D\\) cross at \\(H\\). Consider the homothety \\(h\\) centred at \\(H\\) and mapping \\(B\\) to \\(D\\). Since \\(B D_{1} \\| D B_{1}\\), we have \\(h\\left(D_{1}\\right)=B_{1}\\).\n\nLet the tangents to \\(\\Omega\\) at \\(B\\) and \\(D\\) meet \\(A C\\) at \\(L_{B}\\) and \\(L_{D}\\), respectively. We have\n\\[\n\\angle L_{B} B B_{1}=\\angle L_{B} B C+\\angle C B B_{1}=\\angle B A L_{B}+\\angle B_{1} B A=\\angle B B_{1} L_{B},\n\\]\nwhich means that the triangle \\(L_{B} B B_{1}\\) is isosceles, \\(L_{B} B=L_{B} B_{1}\\). The powers of \\(L_{B}\\) with respect to \\(\\Omega\\) and \\(\\gamma_{D}\\) are \\(L_{B} B^{2}\\) and \\(L_{B} B_{1}^{2}\\), respectively; so they are equal, whence \\(L_{B}\\) lies on the radical axis \\(T_{D} D\\) of those two circles. Similarly, \\(L_{D}\\) lies on the radical axis \\(T_{B} B\\) of \\(\\Omega\\) and \\(\\gamma_{B}\\).\n\nBy the sine rule in the triangle \\(B H L_{B}\\), we obtain\n\\[\n\\frac{H L_{B}}{\\sin \\angle H B L_{B}}=\\frac{B L_{B}}{\\sin \\angle B H L_{B}}=\\frac{B_{1} L_{B}}{\\sin \\angle B H L_{B}} ;\n\\]\nsimilarly,\n\\[\n\\frac{H L_{D}}{\\sin \\angle H D L_{D}}=\\frac{D L_{D}}{\\sin \\angle D H L_{D}}=\\frac{D_{1} L_{D}}{\\sin \\angle D H L_{D}} .\n\\]\n\nClearly, \\(\\angle B H L_{B}=\\angle D H L_{D}\\). In the circle \\(\\Omega\\), tangent lines \\(B L_{B}\\) and \\(D L_{D}\\) form equal angles with the chord \\(B D\\), so \\(\\sin \\angle H B L_{B}=\\sin \\angle H D L_{D}\\) (this equality does not depend on the picture). Thus, dividing (2) by (3) we get\n\\[\n\\frac{H L_{B}}{H L_{D}}=\\frac{B_{1} L_{B}}{D_{1} L_{D}}, \\quad \\text { and hence } \\quad \\frac{H L_{B}}{H L_{D}}=\\frac{H L_{B}-B_{1} L_{B}}{H L_{D}-D_{1} L_{D}}=\\frac{H B_{1}}{H D_{1}} .\n\\]\n\nSince \\(h\\left(D_{1}\\right)=B_{1}\\), the obtained relation yields \\(h\\left(L_{D}\\right)=L_{B}\\), so \\(h\\) maps the line \\(L_{D} B\\) to \\(L_{B} D\\), and these lines are parallel, as desired.\n![](https://cdn.mathpix.com/cropped/2025_08_23_53f86fa89253df1f58beg-53.jpg?height=835&width=1475&top_left_y=211&top_left_x=296)\n\nComment 2. In the solution above, the key relation \\(h\\left(L_{D}\\right)=L_{B}\\) was obtained via a short computation in sines. Here we present an alternative, pure synthetical way of establishing that.\n\nLet the external bisectors of \\(\\angle A B C\\) and \\(\\angle A D C\\) cross \\(A C\\) at \\(B_{2}\\) and \\(D_{2}\\), respectively; assume that \\(\\widetilde{A B}>\\widetilde{C B}\\). In the right-angled triangle \\(B B_{1} B_{2}\\), the point \\(L_{B}\\) is a point on the hypothenuse such that \\(L_{B} B_{1}=L_{B} B\\), so \\(L_{B}\\) is the midpoint of \\(B_{1} B_{2}\\).\n\nSince \\(D D_{1}\\) is the internal angle bisector of \\(\\angle A D C\\), we have\n\\[\n\\angle B D D_{1}=\\frac{\\angle B D A-\\angle C D B}{2}=\\frac{\\angle B C A-\\angle C A B}{2}=\\angle B B_{2} D_{1},\n\\]\nso the points \\(B, B_{2}, D\\), and \\(D_{1}\\) lie on some circle \\(\\omega_{B}\\). Similarly, \\(L_{D}\\) is the midpoint of \\(D_{1} D_{2}\\), and the points \\(D, D_{2}, B\\), and \\(B_{1}\\) lie on some circle \\(\\omega_{D}\\).\n\nNow we have\n\\[\n\\angle B_{2} D B_{1}=\\angle B_{2} D B-\\angle B_{1} D B=\\angle B_{2} D_{1} B-\\angle B_{1} D_{2} B=\\angle D_{2} B D_{1} .\n\\]\n\nTherefore, the corresponding sides of the triangles \\(D B_{1} B_{2}\\) and \\(B D_{1} D_{2}\\) are parallel, and the triangles are homothetical (in \\(H\\) ). So their corresponding medians \\(D L_{B}\\) and \\(B L_{D}\\) are also parallel.\n![](https://cdn.mathpix.com/cropped/2025_08_23_53f86fa89253df1f58beg-53.jpg?height=527&width=1488&top_left_y=1921&top_left_x=291)\n\nYet alternatively, after obtaining the circles \\(\\omega_{B}\\) and \\(\\omega_{D}\\), one may notice that \\(H\\) lies on their radical axis \\(B D\\), whence \\(H B_{1} \\cdot H D_{2}=H D_{1} \\cdot H B_{2}\\), or\n\\[\n\\frac{H B_{1}}{H D_{1}}=\\frac{H B_{2}}{H D_{1}} .\n\\]\n\nSince \\(h\\left(D_{1}\\right)=B_{1}\\), this yields \\(h\\left(D_{2}\\right)=B_{2}\\) and hence \\(h\\left(L_{D}\\right)=L_{B}\\).\n\nComment 3. Since \\(h\\) preserves the line \\(A C\\) and maps \\(B \\mapsto D\\) and \\(D_{1} \\mapsto B_{1}\\), we have \\(h\\left(\\gamma_{B}\\right)=\\gamma_{D}\\). Therefore, \\(h\\left(O_{B}\\right)=O_{D}\\); in particular, \\(H\\) also lies on \\(O_{B} O_{D}\\).\n\nSolution 2. Let \\(B D_{1}\\) and \\(T_{B} D_{1}\\) meet \\(\\Omega\\) again at \\(X_{B}\\) and \\(Y_{B}\\), respectively. Then\n\\[\n\\angle B D_{1} C=\\angle B T_{B} D_{1}=\\angle B T_{B} Y_{B}=\\angle B X_{B} Y_{B},\n\\]\nwhich shows that \\(X_{B} Y_{B} \\| A C\\). Similarly, let \\(D B_{1}\\) and \\(T_{D} B_{1}\\) meet \\(\\Omega\\) again at \\(X_{D}\\) and \\(Y_{D}\\), respectively; then \\(X_{D} Y_{D} \\| A C\\).\n\nLet \\(M_{D}\\) and \\(M_{B}\\) be the midpoints of the arcs \\(A B C\\) and \\(A D C\\), respectively; then the points \\(D_{1}\\) and \\(B_{1}\\) lie on \\(D M_{D}\\) and \\(B M_{B}\\), respectively. Let \\(K\\) be the midpoint of \\(A C\\) (which lies on \\(M_{B} M_{D}\\) ). Applying Pascal's theorem to \\(M_{D} D X_{D} X_{B} B M_{B}\\), we obtain that the points \\(D_{1}=M_{D} D \\cap X_{B} B, B_{1}=D X_{D} \\cap B M_{B}\\), and \\(X_{D} X_{B} \\cap M_{B} M_{D}\\) are collinear, which means that \\(X_{B} X_{D}\\) passes through \\(K\\). Due to symmetry, the diagonals of an isosceles trapezoid \\(X_{B} Y_{B} X_{D} Y_{D}\\) cross at \\(K\\).\n![](https://cdn.mathpix.com/cropped/2025_08_23_53f86fa89253df1f58beg-54.jpg?height=1129&width=1146&top_left_y=899&top_left_x=459)\n\nLet \\(b\\) and \\(d\\) denote the distances from the lines \\(X_{B} Y_{B}\\) and \\(X_{D} Y_{D}\\), respectively, to \\(A C\\). Then we get\n\\[\n\\frac{X_{B} Y_{B}}{X_{D} Y_{D}}=\\frac{b}{d}=\\frac{D_{1} X_{B}}{B_{1} X_{D}},\n\\]\nwhere the second equation holds in view of \\(D_{1} X_{B} \\| B_{1} X_{D}\\). Therefore, the triangles \\(D_{1} X_{B} Y_{B}\\) and \\(B_{1} X_{D} Y_{D}\\) are similar. The triangles \\(D_{1} T_{B} B\\) and \\(B_{1} T_{D} D\\) are similar to them and hence to each other. Since \\(B D_{1} \\| D B_{1}\\), these triangles are also homothetical. This yields \\(B T_{B} \\| D T_{D}\\), as desired.\n\nComment 4. The original problem proposal asked to prove that the relations \\(B D_{1} \\| D B_{1}\\) and \\(O \\in O_{1} O_{2}\\) are equivalent. After obtaining \\(B D_{1} \\| D B_{1} \\Rightarrow O \\in O_{1} O_{2}\\), the converse proof is either repeated backwards mutatis mutandis, or can be obtained by the usual procedure of varying some points in the construction.\n\nThe Problem Selection Committee chose the current version, because it is less technical, yet keeps most of the ideas.", "source_pdf": "imosl_2021.pdf", "notes": "fallback-regex"}
{"id": "IMOSL-2021-G6", "contest": "IMOSL", "year": "2021", "problem_number": "G6", "problem": "Determine all integers \\(n \\geqslant 3\\) satisfying the following property: every convex \\(n\\)-gon whose sides all have length 1 contains an equilateral triangle of side length 1 .\n(Every polygon is assumed to contain its boundary.)", "solution": "Answer: All odd \\(n \\geqslant 3\\).\n\n. First we show that for every even \\(n \\geqslant 4\\) there exists a polygon violating the required statement. Consider a regular \\(k\\)-gon \\(A_{0} A_{1}, \\ldots A_{k-1}\\) with side length 1 . Let \\(B_{1}, B_{2}, \\ldots, B_{n / 2-1}\\) be the points symmetric to \\(A_{1}, A_{2}, \\ldots, A_{n / 2-1}\\) with respect to the line \\(A_{0} A_{n / 2}\\). Then \\(P= A_{0} A_{1} A_{2} \\ldots A_{n / 2-1} A_{n / 2} B_{n / 2-1} B_{n / 2-2} \\ldots B_{2} B_{1}\\) is a convex \\(n\\)-gon whose sides all have length 1. If \\(k\\) is big enough, \\(P\\) is contained in a strip of width \\(1 / 2\\), which clearly does not contain any equilateral triangle of side length 1 .\n![](https://cdn.mathpix.com/cropped/2025_08_23_53f86fa89253df1f58beg-56.jpg?height=161&width=1349&top_left_y=839&top_left_x=359)\n\nAssume now that \\(n=2 k+1\\). As the case \\(k=1\\) is trivially true, we assume \\(k \\geqslant 2\\) henceforth. Consider a convex ( \\(2 k+1\\) )-gon \\(P\\) whose sides all have length 1 . Let \\(d\\) be its longest diagonal. The endpoints of \\(d\\) split the perimeter of \\(P\\) into two polylines, one of which has length at least \\(k+1\\). Hence we can label the vertices of \\(P\\) so that \\(P=A_{0} A_{1} \\ldots A_{2 k}\\) and \\(d=A_{0} A_{\\ell}\\) with \\(\\ell \\geqslant k+1\\). We will show that, in fact, the polygon \\(A_{0} A_{1} \\ldots A_{\\ell}\\) contains an equilateral triangle of side length 1 .\n\nSuppose that \\(\\angle A_{\\ell} A_{0} A_{1} \\geqslant 60^{\\circ}\\). Since \\(d\\) is the longest diagonal, we have \\(A_{1} A_{\\ell} \\leqslant A_{0} A_{\\ell}\\), so \\(\\angle A_{0} A_{1} A_{\\ell} \\geqslant \\angle A_{\\ell} A_{0} A_{1} \\geqslant 60^{\\circ}\\). It follows that there exists a point \\(X\\) inside the triangle \\(A_{0} A_{1} A_{\\ell}\\) such that the triangle \\(A_{0} A_{1} X\\) is equilateral, and this triangle is contained in \\(P\\). Similar arguments apply if \\(\\angle A_{\\ell-1} A_{\\ell} A_{0} \\geqslant 60^{\\circ}\\).\n![](https://cdn.mathpix.com/cropped/2025_08_23_53f86fa89253df1f58beg-56.jpg?height=215&width=724&top_left_y=1530&top_left_x=673)\n\nFrom now on, assume \\(\\angle A_{\\ell} A_{0} A_{1}<60^{\\circ}\\) and \\(A_{\\ell-1} A_{\\ell} A_{0}<60^{\\circ}\\).\nConsider an isosceles trapezoid \\(A_{0} Y Z A_{\\ell}\\) such that \\(A_{0} A_{\\ell} \\| Y Z, A_{0} Y=Z A_{\\ell}=1\\), and \\(\\angle A_{\\ell} A_{0} Y=\\angle Z A_{\\ell} A_{0}=60^{\\circ}\\). Suppose that \\(A_{0} A_{1} \\ldots A_{\\ell}\\) is contained in \\(A_{0} Y Z A_{\\ell}\\). Note that the perimeter of \\(A_{0} A_{1} \\ldots A_{\\ell}\\) equals \\(\\ell+A_{0} A_{\\ell}\\) and the perimeter of \\(A_{0} Y Z A_{\\ell}\\) equals \\(2 A_{0} A_{\\ell}+1\\).\n![](https://cdn.mathpix.com/cropped/2025_08_23_53f86fa89253df1f58beg-56.jpg?height=204&width=1312&top_left_y=1958&top_left_x=376)\n\nRecall a well-known fact stating that if a convex polygon \\(P_{1}\\) is contained in a convex polygon \\(P_{2}\\), then the perimeter of \\(P_{1}\\) is at most the perimeter of \\(P_{2}\\). Hence we obtain\n\\[\n\\ell+A_{0} A_{\\ell} \\leqslant 2 A_{0} A_{\\ell}+1, \\quad \\text { i.e. } \\quad \\ell-1 \\leqslant A_{0} A_{\\ell} .\n\\]\n\nOn the other hand, the triangle inequality yields\n\\[\nA_{0} A_{\\ell}<A_{\\ell} A_{\\ell+1}+A_{\\ell+1} A_{\\ell+2}+\\ldots+A_{2 k} A_{0}=2 k+1-\\ell \\leqslant \\ell-1,\n\\]\nwhich gives a contradiction.\nTherefore, there exists a vertex \\(A_{m}\\) of \\(A_{0} A_{1} \\ldots A_{\\ell}\\) which lies outside \\(A_{0} Y Z A_{\\ell}\\). Since\n\\[\n\\angle A_{\\ell} A_{0} A_{1}<60^{\\circ}=\\angle A_{\\ell} A_{0} Y \\quad \\text { and } \\quad A_{\\ell-1} A_{\\ell} A_{0}<60^{\\circ}=\\angle Z A_{\\ell} A_{0},\n\\]\nthe distance between \\(A_{m}\\) and \\(A_{0} A_{\\ell}\\) is at least \\(\\sqrt{3} / 2\\).\nLet \\(P\\) be the projection of \\(A_{m}\\) to \\(A_{0} A_{\\ell}\\). Then \\(P A_{m} \\geqslant \\sqrt{3} / 2\\), and by (1) we have \\(A_{0} P>1 / 2\\) and \\(P A_{\\ell}>1 / 2\\). Choose points \\(Q \\in A_{0} P, R \\in P A_{\\ell}\\), and \\(S \\in P A_{m}\\) such that \\(P Q=P R=1 / 2\\) and \\(P S=\\sqrt{3} / 2\\). Then \\(Q R S\\) is an equilateral triangle of side length 1 contained in \\(A_{0} A_{1} \\ldots A_{\\ell}\\).\n![](https://cdn.mathpix.com/cropped/2025_08_23_53f86fa89253df1f58beg-57.jpg?height=327&width=1318&top_left_y=416&top_left_x=376)\n\nComment. In fact, for every odd \\(n\\) a stronger statement holds, which is formulated in terms defined in the solution above: there exists an equilateral triangle \\(A_{i} A_{i+1} B\\) contained in \\(A_{0} A_{1} \\ldots A_{\\ell}\\) for some \\(0 \\leqslant i<\\ell\\). We sketch an indirect proof below.\n\nAs above, we get \\(\\angle A_{\\ell} A_{0} A_{1}<60^{\\circ}\\) and \\(A_{\\ell-1} A_{\\ell} A_{0}<60^{\\circ}\\). Choose an index \\(m \\in[1, \\ell-1]\\) maximising the distance between \\(A_{m}\\) and \\(A_{0} A_{\\ell}\\). Arguments from the above solution yield \\(1<m<\\ell-1\\). Then \\(\\angle A_{0} A_{m-1} A_{m}>120^{\\circ}\\) and \\(\\angle A_{m-1} A_{m} A_{\\ell}>\\angle A_{0} A_{m} A_{\\ell} \\geqslant 60^{\\circ}\\). We construct an equilateral triangle \\(A_{m-1} A_{m} B\\) as in the figure below. If \\(B\\) lies in \\(A_{0} A_{m-1} A_{m} A_{\\ell}\\), then we are done. Otherwise \\(B\\) and \\(A_{m}\\) lie on different sides of \\(A_{0} A_{\\ell}\\). As before, let \\(P\\) be the projection of \\(A_{m}\\) to \\(A_{0} A_{\\ell}\\). We will show that\n\\[\nA_{0} A_{1}+A_{1} A_{2}+\\ldots+A_{m-1} A_{m}<A_{0} P+1 / 2 .\n\\]\n![](https://cdn.mathpix.com/cropped/2025_08_23_53f86fa89253df1f58beg-57.jpg?height=338&width=1537&top_left_y=1244&top_left_x=262)\n\nThere exists a point \\(C\\) on the segment \\(A_{0} P\\) such that \\(\\angle A_{m-1} C P=60^{\\circ}\\). Construct a parallelogram \\(A_{0} C A_{m-1} K\\). Then the polyline \\(A_{0} A_{1} \\ldots A_{m-1}\\) is contained in the triangle \\(A_{m-1} K A_{0}\\), so\n\\[\nA_{0} A_{1}+A_{1} A_{2}+\\ldots+A_{m-2} A_{m-1}+A_{m-1} A_{m} \\leqslant A_{0} K+K A_{m-1}+A_{m-1} A_{m}=A_{0} C+C A_{m-1}+1 .\n\\]\n\nTo prove (2), it suffices to show that \\(C A_{m-1}<C P-1 / 2\\). Let the line through \\(B\\) parallel to \\(C P\\) intersect the rays \\(A_{m-1} C\\) and \\(A_{m} P\\) at \\(D\\) and \\(T\\), respectively. It is easy to see that the desired inequality will follow from \\(D A_{m-1} \\leqslant D T-1 / 2\\).\n\nTwo possible arrangements of points are shown in the figures below.\nObserve that \\(\\angle D A_{m-1} B \\geqslant 60^{\\circ}\\), so there is a point \\(M\\) on the segment \\(D B\\) such that the triangle \\(D M A_{m-1}\\) is equilateral. Then \\(\\angle A_{m-1} M D=60^{\\circ}=\\angle A_{m-1} A_{m} B\\), so \\(A_{m-1} M B A_{m}\\) is a cyclic quadrilateral. Therefore, \\(\\angle A_{m} M B=60^{\\circ}\\). Thus, \\(T\\) lies on the ray \\(M B\\) and we have to show that \\(M T \\geqslant 1 / 2\\). Indeed, \\(M T=A_{m} M / 2\\) and \\(A_{m} M \\geqslant A_{m} B=1\\). This completes the proof of the inequality (2).\n![](https://cdn.mathpix.com/cropped/2025_08_23_53f86fa89253df1f58beg-57.jpg?height=595&width=1472&top_left_y=2164&top_left_x=302)\n\nSimilarly, either there exists an equilateral triangle \\(A_{m} A_{m+1} B^{\\prime}\\) contained in \\(A_{0} A_{1} \\ldots A_{\\ell}\\), or\n\\[\nA_{m} A_{m+1}+A_{m+1} A_{m+2}+\\ldots+A_{\\ell-1} A_{\\ell}<A_{\\ell} P+1 / 2\n\\]\n\nAdding (2) and (3) yields \\(A_{0} A_{1}+A_{1} A_{2}+\\ldots+A_{\\ell-1} A_{\\ell}<A_{0} A_{\\ell}+1\\), which gives a contradiction.", "source_pdf": "imosl_2021.pdf", "notes": "fallback-regex"}
{"id": "IMOSL-2021-G8", "contest": "IMOSL", "year": "2021", "problem_number": "G8", "problem": "Let \\(\\omega\\) be the circumcircle of a triangle \\(A B C\\), and let \\(\\Omega_{A}\\) be its excircle which is tangent to the segment \\(B C\\). Let \\(X\\) and \\(Y\\) be the intersection points of \\(\\omega\\) and \\(\\Omega_{A}\\). Let \\(P\\) and \\(Q\\) be the projections of \\(A\\) onto the tangent lines to \\(\\Omega_{A}\\) at \\(X\\) and \\(Y\\), respectively. The tangent line at \\(P\\) to the circumcircle of the triangle \\(A P X\\) intersects the tangent line at \\(Q\\) to the circumcircle of the triangle \\(A Q Y\\) at a point \\(R\\). Prove that \\(A R \\perp B C\\).", "solution": "1. Let \\(D\\) be the point of tangency of \\(B C\\) and \\(\\Omega_{A}\\). Let \\(D^{\\prime}\\) be the point such that \\(D D^{\\prime}\\) is a diameter of \\(\\Omega_{A}\\). Let \\(R^{\\prime}\\) be (the unique) point such that \\(A R^{\\prime} \\perp B C\\) and \\(R^{\\prime} D^{\\prime} \\| B C\\). We shall prove that \\(R^{\\prime}\\) coincides with \\(R\\).\n\nLet \\(P X\\) intersect \\(A B\\) and \\(D^{\\prime} R^{\\prime}\\) at \\(S\\) and \\(T\\), respectively. Let \\(U\\) be the ideal common point of the parallel lines \\(B C\\) and \\(D^{\\prime} R^{\\prime}\\). Note that the (degenerate) hexagon \\(A S X T U C\\) is circumscribed around \\(\\Omega_{A}\\), hence by the Brianchon theorem \\(A T, S U\\), and \\(X C\\) concur at a point which we denote by \\(V\\). Then \\(V S \\| B C\\). It follows that \\(\\Varangle(S V, V X)=\\Varangle(B C, C X)= \\Varangle(B A, A X)\\), hence \\(A X S V\\) is cyclic. Therefore, \\(\\Varangle(P X, X A)=\\Varangle(S V, V A)=\\Varangle\\left(R^{\\prime} T, T A\\right)\\). Since \\(\\angle A P T=\\angle A R^{\\prime} T=90^{\\circ}\\), the quadrilateral \\(A P R^{\\prime} T\\) is cyclic. Hence,\n\\[\n\\Varangle(X A, A P)=90^{\\circ}-\\Varangle(P X, X A)=90^{\\circ}-\\Varangle\\left(R^{\\prime} T, T A\\right)=\\Varangle\\left(T A, A R^{\\prime}\\right)=\\Varangle\\left(T P, P R^{\\prime}\\right) .\n\\]\n\nIt follows that \\(P R^{\\prime}\\) is tangent to the circle ( \\(A P X\\) ).\nAnalogous argument shows that \\(Q R^{\\prime}\\) is tangent to the circle \\((A Q Y)\\). Therefore, \\(R=R^{\\prime}\\) and \\(A R \\perp B C\\).\n![](https://cdn.mathpix.com/cropped/2025_08_23_53f86fa89253df1f58beg-65.jpg?height=989&width=1371&top_left_y=1336&top_left_x=354)\n\nComment 1. After showing \\(\\Varangle(P X, X A)=\\Varangle\\left(R^{\\prime} T, T A\\right)\\) one can finish the solution as follows. There exists a spiral similarity mapping the triangle \\(A T R^{\\prime}\\) to the triangle \\(A X P\\). So the triangles \\(A T X\\) and \\(A R^{\\prime} P\\) are similar and equioriented. Thus, \\(\\Varangle(T X, X A)=\\Varangle\\left(R^{\\prime} P, P A\\right)\\), which implies that \\(P R^{\\prime}\\) is tangent to the circle ( \\(A P X\\) ).\n\nSolution 2. Let \\(J\\) and \\(r\\) be the center and the radius of \\(\\Omega_{A}\\). Denote the diameter of \\(\\omega\\) by \\(d\\) and its center by \\(O\\). By Euler's formula, \\(O J^{2}=(d / 2)^{2}+d r\\), so the power of \\(J\\) with respect to \\(\\omega\\) equals \\(d r\\).\n\nLet \\(J X\\) intersect \\(\\omega\\) again at \\(L\\). Then \\(J L=d\\). Let \\(L K\\) be a diameter of \\(\\omega\\) and let \\(M\\) be the midpoint of \\(J K\\). Since \\(J L=L K\\), we have \\(\\angle L M K=90^{\\circ}\\), so \\(M\\) lies on \\(\\omega\\). Let \\(R^{\\prime}\\) be the point such that \\(R^{\\prime} P\\) is tangent to the circle ( \\(A P X\\) ) and \\(A R^{\\prime} \\perp B C\\). Note that the line \\(A R^{\\prime}\\) is symmetric to the line \\(A O\\) with respect to \\(A J\\).\n![](https://cdn.mathpix.com/cropped/2025_08_23_53f86fa89253df1f58beg-66.jpg?height=674&width=1426&top_left_y=414&top_left_x=319)\n\nLemma. Let \\(M\\) be the midpoint of the side \\(J K\\) in a triangle \\(A J K\\). Let \\(X\\) be a point on the circle ( \\(A M K\\) ) such that \\(\\angle J X K=90^{\\circ}\\). Then there exists a point \\(T\\) on the line \\(K X\\) such that the triangles \\(A K J\\) and \\(A J T\\) are similar and equioriented.\nProof. Note that \\(M X=M K\\). We construct a parallelogram \\(A J N K\\). Let \\(T\\) be a point on \\(K X\\) such that \\(\\Varangle(N J, J A)=\\Varangle(K J, J T)\\). Then\n\\[\n\\Varangle(J N, N A)=\\Varangle(K A, A M)=\\Varangle(K X, X M)=\\Varangle(M K, K X)=\\Varangle(J K, K T) .\n\\]\n\nSo there exists a spiral similarity with center \\(J\\) mapping the triangle \\(A J N\\) to the triangle \\(T J K\\). Therefore, the triangles \\(N J K\\) and \\(A J T\\) are similar and equioriented. It follows that the triangles \\(A K J\\) and \\(A J T\\) are similar and equioriented.\n![](https://cdn.mathpix.com/cropped/2025_08_23_53f86fa89253df1f58beg-66.jpg?height=1146&width=1072&top_left_y=1613&top_left_x=496)\n\nBack to the problem, we construct a point \\(T\\) as in the lemma. We perform the composition \\(\\phi\\) of inversion with centre \\(A\\) and radius \\(A J\\) and reflection in \\(A J\\). It is known that every triangle \\(A E F\\) is similar and equioriented to \\(A \\phi(F) \\phi(E)\\).\n\nSo \\(\\phi(K)=T\\) and \\(\\phi(T)=K\\). Let \\(P^{*}=\\phi(P)\\) and \\(R^{*}=\\phi\\left(R^{\\prime}\\right)\\). Observe that \\(\\phi(T K)\\) is a circle with diameter \\(A P^{*}\\). Let \\(A A^{\\prime}\\) be a diameter of \\(\\omega\\). Then \\(P^{*} K \\perp A K \\perp A^{\\prime} K\\), so \\(A^{\\prime}\\) lies on \\(P^{*} K\\). The triangles \\(A R^{\\prime} P\\) and \\(A P^{*} R^{*}\\) are similar and equioriented, hence\n\\(\\Varangle\\left(A A^{\\prime}, A^{\\prime} P^{*}\\right)=\\Varangle\\left(A A^{\\prime}, A^{\\prime} K\\right)=\\Varangle(A X, X P)=\\Varangle(A X, X P)=\\Varangle\\left(A P, P R^{\\prime}\\right)=\\Varangle\\left(A R^{*}, R^{*} P^{*}\\right)\\),\nso \\(A, A^{\\prime}, R^{*}\\), and \\(P^{*}\\) are concyclic. Since \\(A^{\\prime}\\) and \\(R^{*}\\) lie on \\(A O\\), we obtain \\(R^{*}=A^{\\prime}\\). So \\(R^{\\prime}=\\phi\\left(A^{\\prime}\\right)\\), and \\(\\phi\\left(A^{\\prime}\\right) P\\) is tangent to the circle ( \\(A P X\\) ).\n\nAn identical argument shows that \\(\\phi\\left(A^{\\prime}\\right) Q\\) is tangent to the circle \\((A Q Y)\\). Therefore, \\(R= \\phi\\left(A^{\\prime}\\right)\\) and \\(A R \\perp B C\\).\n\nComment 2. One of the main ideas of Solution 2 is to get rid of the excircle, along with points \\(B\\) and \\(C\\). After doing so we obtain the following fact, which is, essentially, proved in Solution 2.\n\nLet \\(\\omega\\) be the circumcircle of a triangle \\(A K_{1} K_{2}\\). Let \\(J\\) be a point such that the midpoints of \\(J K_{1}\\) and \\(J K_{2}\\) lie on \\(\\omega\\). Points \\(X\\) and \\(Y\\) are chosen on \\(\\omega\\) so that \\(\\angle J X K_{1}=\\angle J Y K_{2}=90^{\\circ}\\). Let \\(P\\) and \\(Q\\) be the projections of \\(A\\) onto \\(X K_{1}\\) and \\(Y K_{2}\\), respectively. The tangent line at \\(P\\) to the circumcircle of the triangle \\(A P X\\) intersects the tangent line at \\(Q\\) to the circumcircle of the triangle \\(A Q Y\\) at a point \\(R\\). Then the reflection of the line \\(A R\\) in \\(A J\\) passes through the centre \\(O\\) of \\(\\omega\\).\n\n\\section*{Number Theory}", "source_pdf": "imosl_2021.pdf", "notes": "fallback-regex"}
{"id": "IMOSL-2021-N1", "contest": "IMOSL", "year": "2021", "problem_number": "N1", "problem": "Determine all integers \\(n \\geqslant 1\\) for which there exists a pair of positive integers \\((a, b)\\) such that no cube of a prime divides \\(a^{2}+b+3\\) and\n\\[\n\\frac{a b+3 b+8}{a^{2}+b+3}=n\n\\]", "solution": "Answer: The only integer with that property is \\(n=2\\).\n\n. As \\(b \\equiv-a^{2}-3\\left(\\bmod a^{2}+b+3\\right)\\), the numerator of the given fraction satisfies\n\\[\na b+3 b+8 \\equiv a\\left(-a^{2}-3\\right)+3\\left(-a^{2}-3\\right)+8 \\equiv-(a+1)^{3} \\quad\\left(\\bmod a^{2}+b+3\\right)\n\\]\n\nAs \\(a^{2}+b+3\\) is not divisible by \\(p^{3}\\) for any prime \\(p\\), if \\(a^{2}+b+3\\) divides \\((a+1)^{3}\\) then it does also divide \\((a+1)^{2}\\). Since\n\\[\n0<(a+1)^{2}<2\\left(a^{2}+b+3\\right)\n\\]\nwe conclude \\((a+1)^{2}=a^{2}+b+3\\). This yields \\(b=2(a-1)\\) and \\(n=2\\). The choice \\((a, b)=(2,2)\\) with \\(a^{2}+b+3=9\\) shows that \\(n=2\\) indeed is a solution.", "source_pdf": "imosl_2021.pdf", "notes": "fallback-regex"}
{"id": "IMOSL-2021-N3", "contest": "IMOSL", "year": "2021", "problem_number": "N3", "problem": "Find all positive integers \\(n\\) with the following property: the \\(k\\) positive divisors of \\(n\\) have a permutation ( \\(d_{1}, d_{2}, \\ldots, d_{k}\\) ) such that for every \\(i=1,2, \\ldots, k\\), the number \\(d_{1}+\\cdots+d_{i}\\) is a perfect square.", "solution": "Answer: \\(n=1\\) and \\(n=3\\).\n\n. For \\(i=1,2, \\ldots, k\\) let \\(d_{1}+\\ldots+d_{i}=s_{i}^{2}\\), and define \\(s_{0}=0\\) as well. Obviously \\(0=s_{0}<s_{1}<s_{2}<\\ldots<s_{k}\\), so\n\\[\ns_{i} \\geqslant i \\quad \\text { and } \\quad d_{i}=s_{i}^{2}-s_{i-1}^{2}=\\left(s_{i}+s_{i-1}\\right)\\left(s_{i}-s_{i-1}\\right) \\geqslant s_{i}+s_{i-1} \\geqslant 2 i-1 .\n\\]\n\nThe number 1 is one of the divisors \\(d_{1}, \\ldots, d_{k}\\) but, due to \\(d_{i} \\geqslant 2 i-1\\), the only possibility is \\(d_{1}=1\\).\n\nNow consider \\(d_{2}\\) and \\(s_{2} \\geqslant 2\\). By definition, \\(d_{2}=s_{2}^{2}-1=\\left(s_{2}-1\\right)\\left(s_{2}+1\\right)\\), so the numbers \\(s_{2}-1\\) and \\(s_{2}+1\\) are divisors of \\(n\\). In particular, there is some index \\(j\\) such that \\(d_{j}=s_{2}+1\\).\n\nNotice that\n\\[\ns_{2}+s_{1}=s_{2}+1=d_{j} \\geqslant s_{j}+s_{j-1}\n\\]\nsince the sequence \\(s_{0}<s_{1}<\\ldots<s_{k}\\) increases, the index \\(j\\) cannot be greater than 2 . Hence, the divisors \\(s_{2}-1\\) and \\(s_{2}+1\\) are listed among \\(d_{1}\\) and \\(d_{2}\\). That means \\(s_{2}-1=d_{1}=1\\) and \\(s_{2}+1=d_{2}\\); therefore \\(s_{2}=2\\) and \\(d_{2}=3\\).\n\nWe can repeat the above process in general.\nClaim. \\(d_{i}=2 i-1\\) and \\(s_{i}=i\\) for \\(i=1,2, \\ldots, k\\).\nProof. Apply induction on \\(i\\). The Claim has been proved for \\(i=1,2\\). Suppose that we have already proved \\(d=1, d_{2}=3, \\ldots, d_{i}=2 i-1\\), and consider the next divisor \\(d_{i+1}\\) :\n\\[\nd_{i+1}=s_{i+1}^{2}-s_{i}^{2}=s_{i+1}^{2}-i^{2}=\\left(s_{i+1}-i\\right)\\left(s_{i+1}+i\\right)\n\\]\n\nThe number \\(s_{i+1}+i\\) is a divisor of \\(n\\), so there is some index \\(j\\) such that \\(d_{j}=s_{i+1}+i\\).\nSimilarly to (2), by (1) we have\n\\[\ns_{i+1}+s_{i}=s_{i+1}+i=d_{j} \\geqslant s_{j}+s_{j-1}\n\\]\nsince the sequence \\(s_{0}<s_{1}<\\ldots<s_{k}\\) increases, (3) forces \\(j \\leqslant i+1\\). On the other hand, \\(d_{j}=s_{i+1}+i>2 i>d_{i}>d_{i-1}>\\ldots>d_{1}\\), so \\(j \\leqslant i\\) is not possible. The only possibility is \\(j=i+1\\).\n\nHence,\n\\[\n\\begin{gathered}\ns_{i+1}+i=d_{i+1}=s_{i+1}^{2}-s_{i}^{2}=s_{i+1}^{2}-i^{2} \\\\\ns_{i+1}^{2}-s_{i+1}=i(i+1)\n\\end{gathered}\n\\]\n\nBy solving this equation we get \\(s_{i+1}=i+1\\) and \\(d_{i+1}=2 i+1\\), that finishes the proof.\nNow we know that the positive divisors of the number \\(n\\) are \\(1,3,5, \\ldots, n-2, n\\). The greatest divisor is \\(d_{k}=2 k-1=n\\) itself, so \\(n\\) must be odd. The second greatest divisor is \\(d_{k-1}=n-2\\); then \\(n-2\\) divides \\(n=(n-2)+2\\), so \\(n-2\\) divides 2 . Therefore, \\(n\\) must be 1 or 3 .\n\nThe numbers \\(n=1\\) and \\(n=3\\) obviously satisfy the requirements: for \\(n=1\\) we have \\(k=1\\) and \\(d_{1}=1^{2}\\); for \\(n=3\\) we have \\(k=2, d_{1}=1^{2}\\) and \\(d_{1}+d_{2}=1+3=2^{2}\\).", "source_pdf": "imosl_2021.pdf", "notes": "fallback-regex"}
{"id": "IMOSL-2021-N4", "contest": "IMOSL", "year": "2021", "problem_number": "N4", "problem": "Alice is given a rational number \\(r>1\\) and a line with two points \\(B \\neq R\\), where point \\(R\\) contains a red bead and point \\(B\\) contains a blue bead. Alice plays a solitaire game by performing a sequence of moves. In every move, she chooses a (not necessarily positive) integer \\(k\\), and a bead to move. If that bead is placed at point \\(X\\), and the other bead is placed at \\(Y\\), then Alice moves the chosen bead to point \\(X^{\\prime}\\) with \\(\\overrightarrow{Y X^{\\prime}}=r^{k} \\overrightarrow{Y X}\\).\n\nAlice's goal is to move the red bead to the point \\(B\\). Find all rational numbers \\(r>1\\) such that Alice can reach her goal in at most 2021 moves.", "solution": "Answer: All \\(r=(b+1) / b\\) with \\(b=1, \\ldots, 1010\\).\n\n. Denote the red and blue beads by \\(\\mathcal{R}\\) and \\(\\mathcal{B}\\), respectively. Introduce coordinates on the line and identify the points with their coordinates so that \\(R=0\\) and \\(B=1\\). Then, during the game, the coordinate of \\(\\mathcal{R}\\) is always smaller than the coordinate of \\(\\mathcal{B}\\). Moreover, the distance between the beads always has the form \\(r^{\\ell}\\) with \\(\\ell \\in \\mathbb{Z}\\), since it only multiplies by numbers of this form. Denote the value of the distance after the \\(m^{\\text {th }}\\) move by \\(d_{m}=r^{\\alpha_{m}}\\), \\(m=0,1,2, \\ldots\\) (after the \\(0^{\\text {th }}\\) move we have just the initial position, so \\(\\alpha_{0}=0\\) ).\n\nIf some bead is moved in two consecutive moves, then Alice could instead perform a single move (and change the distance from \\(d_{i}\\) directly to \\(d_{i+2}\\) ) which has the same effect as these two moves. So, if Alice can achieve her goal, then she may as well achieve it in fewer (or the same) number of moves by alternating the moves of \\(\\mathcal{B}\\) and \\(\\mathcal{R}\\). In the sequel, we assume that Alice alternates the moves, and that \\(\\mathcal{R}\\) is shifted altogether \\(t\\) times.\n\nIf \\(\\mathcal{R}\\) is shifted in the \\(m^{\\text {th }}\\) move, then its coordinate increases by \\(d_{m}-d_{m+1}\\). Therefore, the total increment of \\(\\mathcal{R}\\) 's coordinate, which should be 1 , equals\n\\[\n\\begin{aligned}\n\\text { either } & \\left(d_{0}-d_{1}\\right)+\\left(d_{2}-d_{3}\\right)+\\cdots+\\left(d_{2 t-2}-d_{2 t-1}\\right)=1+\\sum_{i=1}^{t-1} r^{\\alpha_{2 i}}-\\sum_{i=1}^{t} r^{\\alpha_{2 i-1}} \\\\\n\\text { or } & \\left(d_{1}-d_{2}\\right)+\\left(d_{3}-d_{4}\\right)+\\cdots+\\left(d_{2 t-1}-d_{2 t}\\right)=\\sum_{i=1}^{t} r^{\\alpha_{2 i-1}}-\\sum_{i=1}^{t} r^{\\alpha_{2 i}}\n\\end{aligned}\n\\]\ndepending on whether \\(\\mathcal{R}\\) or \\(\\mathcal{B}\\) is shifted in the first move. Moreover, in the former case we should have \\(t \\leqslant 1011\\), while in the latter one we need \\(t \\leqslant 1010\\). So both cases reduce to an equation\n\\[\n\\sum_{i=1}^{n} r^{\\beta_{i}}=\\sum_{i=1}^{n-1} r^{\\gamma_{i}}, \\quad \\beta_{i}, \\gamma_{i} \\in \\mathbb{Z}\n\\]\nfor some \\(n \\leqslant 1011\\). Thus, if Alice can reach her goal, then this equation has a solution for \\(n=1011\\) (we can add equal terms to both sums in order to increase \\(n\\) ).\n\nConversely, if (1) has a solution for \\(n=1011\\), then Alice can compose a corresponding sequence of distances \\(d_{0}, d_{1}, d_{2}, \\ldots, d_{2021}\\) and then realise it by a sequence of moves. So the problem reduces to the solvability of (1) for \\(n=1011\\).\n\nAssume that, for some rational \\(r\\), there is a solution of (1). Write \\(r\\) in lowest terms as \\(r=a / b\\). Substitute this into (1), multiply by the common denominator, and collect all terms on the left hand side to get\n\\[\n\\sum_{i=1}^{2 n-1}(-1)^{i} a^{\\mu_{i}} b^{N-\\mu_{i}}=0, \\quad \\mu_{i} \\in\\{0,1, \\ldots, N\\},\n\\]\nfor some \\(N \\geqslant 0\\). We assume that there exist indices \\(j_{-}\\)and \\(j_{+}\\)such that \\(\\mu_{j_{-}}=0\\) and \\(\\mu_{j_{+}}=N\\).\n\nReducing (2) modulo \\(a-b\\) (so that \\(a \\equiv b\\) ), we get\n\\[\n0=\\sum_{i=1}^{2 n-1}(-1)^{i} a^{\\mu_{i}} b^{N-\\mu_{i}} \\equiv \\sum_{i=1}^{2 n-1}(-1)^{i} b^{\\mu_{i}} b^{N-\\mu_{i}}=-b^{N} \\quad \\bmod (a-b) .\n\\]\n\nSince \\(\\operatorname{gcd}(a-b, b)=1\\), this is possible only if \\(a-b=1\\).\nReducing (2) modulo \\(a+b\\) (so that \\(a \\equiv-b\\) ), we get\n\\[\n0=\\sum_{i=1}^{2 n-1}(-1)^{i} a^{\\mu_{i}} b^{N-\\mu_{i}} \\equiv \\sum_{i=1}^{2 n-1}(-1)^{i}(-1)^{\\mu_{i}} b^{\\mu_{i}} b^{N-\\mu_{i}}=S b^{N} \\quad \\bmod (a+b)\n\\]\nfor some odd (thus nonzero) \\(S\\) with \\(|S| \\leqslant 2 n-1\\). Since \\(\\operatorname{gcd}(a+b, b)=1\\), this is possible only if \\(a+b \\mid S\\). So \\(a+b \\leqslant 2 n-1\\), and hence \\(b=a-1 \\leqslant n-1=1010\\).\n\nThus we have shown that any sought \\(r\\) has the form indicated in the answer. It remains to show that for any \\(b=1,2, \\ldots, 1010\\) and \\(a=b+1\\), Alice can reach the goal. For this purpose, in (1) we put \\(n=a, \\beta_{1}=\\beta_{2}=\\cdots=\\beta_{a}=0\\), and \\(\\gamma_{1}=\\gamma_{2}=\\cdots=\\gamma_{b}=1\\).\n\nComment 1. Instead of reducing modulo \\(a+b\\), one can reduce modulo \\(a\\) and modulo \\(b\\). The first reduction shows that the number of terms in (2) with \\(\\mu_{i}=0\\) is divisible by \\(a\\), while the second shows that the number of terms with \\(\\mu_{i}=N\\) is divisible by \\(b\\).\n\nNotice that, in fact, \\(N>0\\), as otherwise (2) contains an alternating sum of an odd number of equal terms, which is nonzero. Therefore, all terms listed above have different indices, and there are at least \\(a+b\\) of them.\n\nComment 2. Another way to investigate the solutions of equation (1) is to consider the Laurent polynomial\n\\[\nL(x)=\\sum_{i=1}^{n} x^{\\beta_{i}}-\\sum_{i=1}^{n-1} x^{\\gamma_{i}} .\n\\]\n\nWe can pick a sufficiently large integer \\(d\\) so that \\(P(x)=x^{d} L(x)\\) is a polynomial in \\(\\mathbb{Z}[x]\\). Then\n\\[\nP(1)=1,\n\\]\nand\n\\[\n1 \\leqslant|P(-1)| \\leqslant 2021\n\\]\n\nIf \\(r=p / q\\) with integers \\(p>q \\geqslant 1\\) is a rational number with the properties listed in the problem statement, then \\(P(p / q)=L(p / q)=0\\). As \\(P(x)\\) has integer coefficients,\n\\[\n(p-q x) \\mid P(x)\n\\]\n\nPlugging \\(x=1\\) into (5) gives \\((p-q) \\mid P(1)=1\\), which implies \\(p=q+1\\). Moreover, plugging \\(x=-1\\) into (5) gives \\((p+q) \\mid P(-1)\\), which, along with (4), implies \\(p+q \\leqslant 2021\\) and \\(q \\leqslant 1010\\). Hence \\(x=(q+1) / q\\) for some integer \\(q\\) with \\(1 \\leqslant q \\leqslant 1010\\).", "source_pdf": "imosl_2021.pdf", "notes": "fallback-regex"}
{"id": "IMOSL-2021-N5", "contest": "IMOSL", "year": "2021", "problem_number": "N5", "problem": "Prove that there are only finitely many quadruples ( \\(a, b, c, n\\) ) of positive integers such that\n\\[\nn!=a^{n-1}+b^{n-1}+c^{n-1}\n\\]", "solution": ". For fixed \\(n\\) there are clearly finitely many solutions; we will show that there is no solution with \\(n>100\\). So, assume \\(n>100\\). By the AM-GM inequality,\n\\[\n\\begin{aligned}\nn! & =2 n(n-1)(n-2)(n-3) \\cdot(3 \\cdot 4 \\cdots(n-4)) \\\\\n& \\leqslant 2(n-1)^{4}\\left(\\frac{3+\\cdots+(n-4)}{n-6}\\right)^{n-6}=2(n-1)^{4}\\left(\\frac{n-1}{2}\\right)^{n-6}<\\left(\\frac{n-1}{2}\\right)^{n-1},\n\\end{aligned}\n\\]\nthus \\(a, b, c<(n-1) / 2\\).\nFor every prime \\(p\\) and integer \\(m \\neq 0\\), let \\(\\nu_{p}(m)\\) denote the \\(p\\)-adic valuation of \\(m\\); that is, the greatest non-negative integer \\(k\\) for which \\(p^{k}\\) divides \\(m\\). Legendre's formula states that\n\\[\n\\nu_{p}(n!)=\\sum_{s=1}^{\\infty}\\left\\lfloor\\frac{n}{p^{s}}\\right\\rfloor,\n\\]\nand a well-know corollary of this formula is that\n\\[\n\\nu_{p}(n!)<\\sum_{s=1}^{\\infty} \\frac{n}{p^{s}}=\\frac{n}{p-1}\n\\]\n\nIf \\(n\\) is odd then \\(a^{n-1}, b^{n-1}, c^{n-1}\\) are squares, and by considering them modulo 4 we conclude that \\(a, b\\) and \\(c\\) must be even. Hence, \\(2^{n-1} \\mid n!\\) but that is impossible for odd \\(n\\) because \\(\\nu_{2}(n!)=\\nu_{2}((n-1)!)<n-1\\) by \\((\\odot)\\).\n\nFrom now on we assume that \\(n\\) is even. If all three numbers \\(a+b, b+c, c+a\\) are powers of 2 then \\(a, b, c\\) have the same parity. If they all are odd, then \\(n!=a^{n-1}+b^{n-1}+c^{n-1}\\) is also odd which is absurd. If all \\(a, b, c\\) are divisible by 4 , this contradicts \\(\\nu_{2}(n!) \\leqslant n-1\\). If, say, \\(a\\) is not divisible by 4 , then \\(2 a=(a+b)+(a+c)-(b+c)\\) is not divisible by 8 , and since all \\(a+b, b+c\\), \\(c+a\\) are powers of 2 , we get that one of these sums equals 4 , so two of the numbers of \\(a, b, c\\) are equal to 2 . Say, \\(a=b=2\\), then \\(c=2^{r}-2\\) and, since \\(c \\mid n!\\), we must have \\(c \\mid a^{n-1}+b^{n-1}=2^{n}\\) implying \\(r=2\\), and so \\(c=2\\), which is impossible because \\(n!\\equiv 0 \\not \\equiv 3 \\cdot 2^{n-1}(\\bmod 5)\\).\n\nSo now we assume that the sum of two numbers among \\(a, b, c\\), say \\(a+b\\), is not a power of 2 , so it is divisible by some odd prime \\(p\\). Then \\(p \\leqslant a+b<n\\) and so \\(c^{n-1}=n!-\\left(a^{n-1}+b^{n-1}\\right)\\) is divisible by \\(p\\). If \\(p\\) divides \\(a\\) and \\(b\\), we get \\(p^{n-1} \\mid n!\\), contradicting ( \\(\\bigcirc\\) ). Next, using ( \\(\\bigcirc\\) ) and the Lifting the Exponent Lemma we get\n\\[\n\\nu_{p}(1)+\\nu_{p}(2)+\\cdots+\\nu_{p}(n)=\\nu_{p}(n!)=\\nu_{p}\\left(n!-c^{n-1}\\right)=\\nu_{p}\\left(a^{n-1}+b^{n-1}\\right)=\\nu_{p}(a+b)+\\nu_{p}(n-1) .(\\diamond)\n\\]\n\nIn view of ( \\(\\diamond\\) ), no number of \\(1,2, \\ldots, n\\) can be divisible by \\(p\\), except \\(a+b\\) and \\(n-1>a+b\\). On the other hand, \\(p \\mid c\\) implies that \\(p<n / 2\\) and so there must be at least two such numbers. Hence, there are two multiples of \\(p\\) among \\(1,2, \\ldots, n\\), namely \\(a+b=p\\) and \\(n-1=2 p\\). But this is another contradiction because \\(n-1\\) is odd. This final contradiction shows that there is no solution of the equation for \\(n>100\\).\n\nComment 1. The original version of the problem asked to find all solutions to the equation. The solution to that version is not much different but is more technical.\n\nComment 2. To find all solutions we can replace the bound \\(a, b, c<(n-1) / 2\\) for all \\(n\\) with a weaker bound \\(a, b, c \\leqslant n / 2\\) only for even \\(n\\), which is a trivial application of AM-GM to the tuple \\((2,3, \\ldots, n)\\). Then we may use the same argument for odd \\(n\\) (it works for \\(n \\geqslant 5\\) and does not require any bound on \\(a, b, c\\) ), and for even \\(n\\) the same solution works for \\(n \\geqslant 6\\) unless we have \\(a+b=n-1\\) and \\(2 \\nu_{p}(n-1)=\\nu_{p}(n!)\\). This is only possible for \\(p=3\\) and \\(n=10\\) in which case we can consider the original equation modulo 7 to deduce that \\(7 \\mid a b c\\) which contradicts the fact that \\(7^{9}>10\\) !. Looking at \\(n \\leqslant 4\\) we find four solutions, namely,\n\\[\n(a, b, c, n)=(1,1,2,3),(1,2,1,3),(2,1,1,3),(2,2,2,4)\n\\]\n\nComment 3. For sufficiently large \\(n\\), the inequality \\(a, b, c<(n-1) / 2\\) also follows from Stirling's formula.", "source_pdf": "imosl_2021.pdf", "notes": "fallback-regex"}
{"id": "IMOSL-2021-N6", "contest": "IMOSL", "year": "2021", "problem_number": "N6", "problem": "Determine all integers \\(n \\geqslant 2\\) with the following property: every \\(n\\) pairwise distinct integers whose sum is not divisible by \\(n\\) can be arranged in some order \\(a_{1}, a_{2}, \\ldots, a_{n}\\) so that \\(n\\) divides \\(1 \\cdot a_{1}+2 \\cdot a_{2}+\\cdots+n \\cdot a_{n}\\).", "solution": "Answer: All odd integers and all powers of 2.\n\n. If \\(n=2^{k} a\\), where \\(a \\geqslant 3\\) is odd and \\(k\\) is a positive integer, we can consider a set containing the number \\(2^{k}+1\\) and \\(n-1\\) numbers congruent to 1 modulo \\(n\\). The sum of these numbers is congruent to \\(2^{k}\\) modulo \\(n\\) and therefore is not divisible by \\(n\\); for any permutation \\(\\left(a_{1}, a_{2}, \\ldots, a_{n}\\right)\\) of these numbers\n\\[\n1 \\cdot a_{1}+2 \\cdot a_{2}+\\cdots+n \\cdot a_{n} \\equiv 1+\\cdots+n \\equiv 2^{k-1} a\\left(2^{k} a+1\\right) \\not \\equiv 0 \\quad\\left(\\bmod 2^{k}\\right)\n\\]\nand a fortiori \\(1 \\cdot a_{1}+2 \\cdot a_{2}+\\cdots+n \\cdot a_{n}\\) is not divisible by \\(n\\).\nFrom now on, we suppose that \\(n\\) is either odd or a power of 2 . Let \\(S\\) be the given set of integers, and \\(s\\) be the sum of elements of \\(S\\).\nLemma 1. If there is a permutation ( \\(a_{i}\\) ) of \\(S\\) such that ( \\(n, s\\) ) divides \\(\\sum_{i=1}^{n} i a_{i}\\), then there is a permutation ( \\(b_{i}\\) ) of \\(S\\) such that \\(n\\) divides \\(\\sum_{i=1}^{n} i b_{i}\\).\nProof. Let \\(r=\\sum_{i=1}^{n} i a_{i}\\). Consider the permutation ( \\(b_{i}\\) ) defined by \\(b_{i}=a_{i+x}\\), where \\(a_{j+n}=a_{j}\\). For this permutation, we have\n\\[\n\\sum_{i=1}^{n} i b_{i}=\\sum_{i=1}^{n} i a_{i+x} \\equiv \\sum_{i=1}^{n}(i-x) a_{i} \\equiv r-s x \\quad(\\bmod n)\n\\]\n\nSince \\((n, s)\\) divides \\(r\\), the congruence \\(r-s x \\equiv 0(\\bmod n)\\) admits a solution.\nLemma 2. Every set \\(T\\) of \\(k m\\) integers, \\(m>1\\), can be partitioned into \\(m\\) sets of \\(k\\) integers so that in every set either the sum of elements is not divisible by \\(k\\) or all the elements leave the same remainder upon division by \\(k\\).\n\nProof. The base case, \\(m=2\\). If \\(T\\) contains \\(k\\) elements leaving the same remainder upon division by \\(k\\), we form one subset \\(A\\) of these elements; the remaining elements form a subset \\(B\\). If \\(k\\) does not divide the sum of all elements of \\(B\\), we are done. Otherwise it is enough to exchange any element of \\(A\\) with any element of \\(B\\) not congruent to it modulo \\(k\\), thus making sums of both \\(A\\) and \\(B\\) not divisible by \\(k\\). This cannot be done only when all the elements of \\(T\\) are congruent modulo \\(k\\); in this case any partition will do.\n\nIf no \\(k\\) elements of \\(T\\) have the same residue modulo \\(k\\), there are three elements \\(a, b, c \\in T\\) leaving pairwise distinct remainders upon division by \\(k\\). Let \\(t\\) be the sum of elements of \\(T\\). It suffices to find \\(A \\subset T\\) such that \\(|A|=k\\) and \\(\\sum_{x \\in A} x \\not \\equiv 0, t(\\bmod k)\\) : then neither the sum of elements of \\(A\\) nor the sum of elements of \\(B=T \\backslash A\\) is divisible by \\(k\\). Consider \\(U^{\\prime} \\subset T \\backslash\\{a, b, c\\}\\) with \\(\\left|U^{\\prime}\\right|=k-1\\). The sums of elements of three sets \\(U^{\\prime} \\cup\\{a\\}, U^{\\prime} \\cup\\{b\\}, U^{\\prime} \\cup\\{c\\}\\) leave three different remainders upon division by \\(k\\), and at least one of them is not congruent either to 0 or to \\(t\\).\n\nNow let \\(m>2\\). If \\(T\\) contains \\(k\\) elements leaving the same remainder upon division by \\(k\\), we form one subset \\(A\\) of these elements and apply the inductive hypothesis to the remaining \\(k(m-1)\\) elements. Otherwise, we choose any \\(U \\subset T,|U|=k-1\\). Since all the remaining elements cannot be congruent modulo \\(k\\), there is \\(a \\in T \\backslash U\\) such that \\(a \\not \\equiv-\\sum_{x \\in U} x(\\bmod k)\\). Now we can take \\(A=U \\cup\\{a\\}\\) and apply the inductive hypothesis to \\(T \\backslash A\\).\n\nNow we are ready to prove the statement of the problem for all odd \\(n\\) and \\(n=2^{k}\\). The proof is by induction.\n\nIf \\(n\\) is prime, the statement follows immediately from Lemma 1 , since in this case ( \\(n, s\\) ) \\(=1\\). Turning to the general case, we can find prime \\(p\\) and an integer \\(t\\) such that \\(p^{t} \\mid n\\) and \\(p^{t} \\nmid s\\). By Lemma 2, we can partition \\(S\\) into \\(p\\) sets of \\(\\frac{n}{p}=k\\) elements so that in every set either the sum of numbers is not divisible by \\(k\\) or all numbers have the same residue modulo \\(k\\).\n\nFor sets in the first category, by the inductive hypothesis there is a permutation ( \\(a_{i}\\) ) such that \\(k \\mid \\sum_{i=1}^{k} i a_{i}\\).\n\nIf \\(n\\) (and therefore \\(k\\) ) is odd, then for each permutation ( \\(b_{i}\\) ) of a set in the second category we have\n\\[\n\\sum_{i=1}^{k} i b_{i} \\equiv b_{1} \\frac{k(k+1)}{2} \\equiv 0 \\quad(\\bmod k) .\n\\]\n\nBy combining such permutation for all sets of the partition, we get a permutation ( \\(c_{i}\\) ) of \\(S\\) such that \\(k \\mid \\sum_{i=1}^{n} i c_{i}\\). Since this sum is divisible by \\(k\\), and \\(k\\) is divisible by ( \\(n, s\\) ), we are done by Lemma 1.\n\nIf \\(n=2^{s}\\), we have \\(p=2\\) and \\(k=2^{s-1}\\). Then for each of the subsets there is a permutation \\(\\left(a_{1}, \\ldots, a_{k}\\right)\\) such that \\(\\sum_{i=1}^{k} i a_{i}\\) is divisible by \\(2^{s-2}=\\frac{k}{2}\\) : if the subset belongs to the first category, the expression is divisible even by \\(k\\), and if it belongs to the second one,\n\\[\n\\sum_{i=1}^{k} i a_{i} \\equiv a_{1} \\frac{k(k+1)}{2} \\equiv 0\\left(\\bmod \\frac{k}{2}\\right) .\n\\]\n\nNow the numbers of each permutation should be multiplied by all the odd or all the even numbers not exceeding \\(n\\) in increasing order so that the resulting sums are divisible by \\(k\\) :\n\\[\n\\sum_{i=1}^{k}(2 i-1) a_{i} \\equiv \\sum_{i=1}^{k} 2 i a_{i} \\equiv 2 \\sum_{i=1}^{k} i a_{i} \\equiv 0 \\quad(\\bmod k) .\n\\]\n\nCombining these two sums, we again get a permutation ( \\(c_{i}\\) ) of \\(S\\) such that \\(k \\mid \\sum_{i=1}^{n} i c_{i}\\), and finish the case by applying Lemma 1.\n\nComment. We cannot dispense with the condition that \\(n\\) does not divide the sum of all elements. Indeed, for each \\(n>1\\) and the set consisting of \\(1,-1\\), and \\(n-2\\) elements divisible by \\(n\\) the required permutation does not exist.", "source_pdf": "imosl_2021.pdf", "notes": "fallback-regex"}
{"id": "IMOSL-2021-N7", "contest": "IMOSL", "year": "2021", "problem_number": "N7", "problem": "Let \\(a_{1}, a_{2}, a_{3}, \\ldots\\) be an infinite sequence of positive integers such that \\(a_{n+2 m}\\) divides \\(a_{n}+a_{n+m}\\) for all positive integers \\(n\\) and \\(m\\). Prove that this sequence is eventually periodic, i.e. there exist positive integers \\(N\\) and \\(d\\) such that \\(a_{n}=a_{n+d}\\) for all \\(n>N\\).", "solution": ". We will make repeated use of the following simple observation:\nLemma 1. If a positive integer \\(d\\) divides \\(a_{n}\\) and \\(a_{n-m}\\) for some \\(m\\) and \\(n>2 m\\), it also divides \\(a_{n-2 m}\\). If \\(d\\) divides \\(a_{n}\\) and \\(a_{n-2 m}\\), it also divides \\(a_{n-m}\\).\nProof. Both parts are obvious since \\(a_{n}\\) divides \\(a_{n-2 m}+a_{n-m}\\).\nClaim. The sequence ( \\(a_{n}\\) ) is bounded.\nProof. Suppose the contrary. Then there exist infinitely many indices \\(n\\) such that \\(a_{n}\\) is greater than each of the previous terms \\(a_{1}, a_{2}, \\ldots, a_{n-1}\\). Let \\(a_{n}=k\\) be such a term, \\(n>10\\). For each \\(s<\\frac{n}{2}\\) the number \\(a_{n}=k\\) divides \\(a_{n-s}+a_{n-2 s}<2 k\\), therefore\n\\[\na_{n-s}+a_{n-2 s}=k .\n\\]\n\nIn particular,\n\\[\na_{n}=a_{n-1}+a_{n-2}=a_{n-2}+a_{n-4}=a_{n-4}+a_{n-8},\n\\]\nthat is, \\(a_{n-1}=a_{n-4}\\) and \\(a_{n-2}=a_{n-8}\\). It follows from Lemma 1 that \\(a_{n-1}\\) divides \\(a_{n-1-3 s}\\) for \\(3 s<n-1\\) and \\(a_{n-2}\\) divides \\(a_{n-2-6 s}\\) for \\(6 s<n-2\\). Since at least one of the numbers \\(a_{n-1}\\) and \\(a_{n-2}\\) is at least \\(a_{n} / 2\\), so is some \\(a_{i}\\) with \\(i \\leqslant 6\\). However, \\(a_{n}\\) can be arbitrarily large, a contradiction.\n\nSince ( \\(a_{n}\\) ) is bounded, there exist only finitely many \\(i\\) for which \\(a_{i}\\) appears in the sequence finitely many times. In other words, there exists \\(N\\) such that if \\(a_{i}=t\\) and \\(i>N\\), then \\(a_{j}=t\\) for infinitely many \\(j\\).\n\nClearly the sequence \\(\\left(a_{n+N}\\right)_{n>0}\\) satisfies the divisibility condition, and it is enough to prove that this sequence is eventually periodic. Thus truncating the sequence if necessary, we can assume that each number appears infinitely many times in the sequence. Let \\(k\\) be the maximum number appearing in the sequence.\nLemma 2. If a positive integer \\(d\\) divides \\(a_{n}\\) for some \\(n\\), then the numbers \\(i\\) such that \\(d\\) divides \\(a_{i}\\) form an arithmetical progression with an odd difference.\nProof. Let \\(i_{1}<i_{2}<i_{3}<\\ldots\\) be all the indices \\(i\\) such that \\(d\\) divides \\(a_{i}\\). If \\(i_{s}+i_{s+1}\\) is even, it follows from Lemma 1 that \\(d\\) also divides \\(\\frac{a_{\\frac{i_{s}+i_{s+1}}{2}}}{2}\\), impossible since \\(i_{s}<\\frac{i_{s}+i_{s+1}}{2}<i_{s+1}\\). Thus \\(i_{s}\\) and \\(i_{s+1}\\) are always of different parity, and therefore \\(i_{s}+i_{s+2}\\) is even. Applying Lemma 1 again, we see that \\(d\\) divides \\(\\frac{a_{\\frac{i_{s}+i_{s+2}}{2}}}{2}\\), hence \\(\\frac{i_{s}+i_{s+2}}{2}=i_{s+1}\\),\n\nWe are ready now to solve the problem.\nThe number of positive divisors of all terms of the progression is finite. Let \\(d_{s}\\) be the difference of the progression corresponding to \\(s\\), that is, \\(s\\) divides \\(a_{n}\\) if and only if it divides \\(a_{n+t d_{s}}\\) for any positive integer \\(t\\). Let \\(D\\) be the product of all \\(d_{s}\\). Then each \\(s\\) dividing a term of the progression divides \\(a_{n}\\) if and only if it divides \\(a_{n+D}\\). This means that the sets of divisors of \\(a_{n}\\) and \\(a_{n+D}\\) coincide, and \\(a_{n+D}=a_{n}\\). Thus \\(D\\) is a period of the sequence.\n\nComment. In the above solution we did not try to find the exact structure of the periodic part of \\(\\left(a_{n}\\right)\\). A little addition to the argument above shows that the period of the sequence has one of the following three forms:\n(i) \\(t\\) (in this case the sequence is eventually constant);\n(ii) \\(t, 2 t, 3 t\\) or \\(2 t, t, 3 t\\) (so the period is 3 );\n(iii) \\(t, t, \\ldots, 2 t\\) (the period can be any odd number).\n\nIn these three cases \\(t\\) can be any positive integer. It is easy to see that all three cases satisfy the original condition.\n\nWe again denote by \\(k\\) be the maximum number appearing in the sequence. All the indices \\(i\\) such that \\(a_{i}=k\\) form an arithmetical progression. If the difference of this progression is 1 , the sequence \\(\\left(a_{n}\\right)\\) is constant, and we get the case (i). Assume that the difference \\(T\\) is at least 3.\n\nTake an index \\(n\\) such that \\(a_{n}=k\\) and let \\(a=a_{n-2}, b=a_{n-1}\\). We have \\(a, b<k\\) and therefore \\(k=a_{n}=a_{n-1}+a_{n-2}=a+b\\). If \\(a=b=\\frac{k}{2}\\), then all the terms \\(a_{1}, a_{2}, \\ldots, a_{n}\\) are divisible by \\(k / 2\\), that is, are equal to \\(k\\) or \\(k / 2\\). Since the indices \\(i\\) such that \\(a_{i}=k\\) form an arithmetical progression with odd diference, we get the case (iii).\n\nSuppose now that \\(a \\neq b\\).\nClaim. For \\(\\frac{n}{2}<m<n\\) we have \\(a_{m}=a\\) if \\(m \\equiv n-2(\\bmod 3)\\) and \\(a_{m}=b\\) if \\(m \\equiv n-1(\\bmod 3)\\).\nProof. The number \\(k=a_{n}\\) divides \\(a_{n-2}+a_{n-1}=a+b\\) and \\(a_{n-4}+a_{n-2}=a_{n-4}+a\\) and is therefore equal to these sums (since \\(a, b<k\\) and \\(a_{i} \\leqslant k\\) for all \\(i\\) ). Therefore \\(a_{n-1}=a_{n-4}=b\\), that is, \\(a_{n-4}<k\\), \\(a_{n-4}+a_{n-8}=k\\) and \\(a_{n-8}=a_{n-2}=a\\). One of the numbers \\(a\\) and \\(b\\) is greater than \\(k / 2\\).\n\nIf \\(b=a_{n-1}=a_{n-4}>\\frac{k}{2}\\), it follows from Lemma 1 that \\(a_{n-1}\\) divides \\(a_{n-1-3 s}\\) when \\(3 s<n-1\\), and therefore \\(a_{n-1-3 s}=b\\) when \\(3 s<n-1\\). When \\(6 s<n-4, k\\) also divides \\(a_{n-4-6 s}+a_{n-2-3 s}=b+a_{n-2-3 s}\\), thus, \\(a_{n-2-3 s}=k-b=a\\).\n\nIf \\(a=a_{n-2}=a_{n-8}>\\frac{k}{2}\\), all the terms \\(a_{n-2-6 s}\\) with \\(6 s<n-2\\) are divisible by \\(a\\), that is, the indices \\(i\\) for which \\(a\\) divides \\(a_{i}\\) form a progression with difference dividing 6 . Since this difference is odd and greater than 1 , it must be 3 , that is, \\(a_{n-2-3 s}=a\\) when \\(3 s<n-2\\). Similarly to the previous case, we have \\(a_{n-1-3 s}=a_{n}-a_{n-2-6 s}=k-a=b\\) when \\(6 s<n-2\\).\n\nLet \\(a_{n}\\) and \\(a_{n+T}\\) be two consecutive terms of the sequence equal to \\(k\\). If \\(n\\) is large enough, \\(\\frac{n+T}{2}<n-2\\), and applying the claim to \\(n+T\\) instead of \\(n\\) we see that the three consecutive terms \\(a_{n-2}=a, a_{n-1}=b, a_{n}=k\\) must be equal to \\(a_{n+T-2}, a_{n+T-1}\\) and \\(a_{n+T}\\) respectively. Thus, for some \\(i\\) we have \\(a_{i+3 s}=a\\) and \\(a_{i+1+3 s}=b\\) for all \\(s\\). Truncating the sequence again if necessary, we may assume that \\(a_{3 s+1}=a\\) and \\(a_{3 s+2}=b\\) for all \\(s\\). We know also that \\(a_{n}=k\\) if and only if \\(n\\) is divisible by \\(T\\) (incidentally, this proves that \\(T\\) is divisible by 3 ).\n\nIf \\(a_{3 s}=c\\) for some integer \\(s\\), each of the numbers \\(a, b, c\\) divides the sum of the other two. It is easy to see that these numbers are proportional to one of the triplets \\((1,1,1),(1,1,2)\\) and \\((1,2,3)\\) in some order. It follows that the greater of the two numbers \\(a\\) and \\(b\\) is the smaller multiplied by 2,3 or \\(3 / 2\\). The last two cases are impossible because then \\(c\\) cannot be the maximum element in the triplet ( \\(a, b, c\\) ), while \\(c=k=a+b\\) for infinitely many \\(s\\). Thus the only possible case is 2 , the numbers \\(a\\) and \\(b\\) are \\(k / 3\\) and \\(2 k / 3\\) in some order, and the only possible values of \\(c\\) are \\(k\\) and \\(k / 3\\). Suppose that \\(a_{3 s}=k / 3\\) for some \\(s>1\\). We can choose \\(s\\) so that \\(a_{3 s+3}=k\\). Therefore \\(T\\), which we already know to be odd and divisible by 3 , is greater than 3 , that is, at least 9 . Then \\(a_{3 s-3} \\neq k\\), and the only other possibility is \\(a_{3 s-3}=k / 3\\). However, \\(a_{3 s+3}=k\\) must divide \\(a_{3 s}+a_{3 s-3}=2 k / 3\\), which is impossible. We have proved then that \\(a_{3 s}=k\\) for all \\(s>1\\), which is the case (ii).", "source_pdf": "imosl_2021.pdf", "notes": "fallback-regex"}
{"id": "IMOSL-2021-N8", "contest": "IMOSL", "year": "2021", "problem_number": "N8", "problem": "For a polynomial \\(P(x)\\) with integer coefficients let \\(P^{1}(x)=P(x)\\) and \\(P^{k+1}(x)= P\\left(P^{k}(x)\\right)\\) for \\(k \\geqslant 1\\). Find all positive integers \\(n\\) for which there exists a polynomial \\(P(x)\\) with integer coefficients such that for every integer \\(m \\geqslant 1\\), the numbers \\(P^{m}(1), \\ldots, P^{m}(n)\\) leave exactly \\(\\left\\lceil n / 2^{m}\\right\\rceil\\) distinct remainders when divided by \\(n\\).", "solution": "Answer: All powers of 2 and all primes.\n\n. Denote the set of residues modulo \\(\\ell\\) by \\(\\mathbb{Z}_{\\ell}\\). Observe that \\(P\\) can be regarded as a function \\(\\mathbb{Z}_{\\ell} \\rightarrow \\mathbb{Z}_{\\ell}\\) for any positive integer \\(\\ell\\). Denote the cardinality of the set \\(P^{m}\\left(\\mathbb{Z}_{\\ell}\\right)\\) by \\(f_{m, \\ell}\\). Note that \\(f_{m, n}=\\left\\lceil n / 2^{m}\\right\\rceil\\) for all \\(m \\geqslant 1\\) if and only if \\(f_{m+1, n}=\\left\\lceil f_{m, n} / 2\\right\\rceil\\) for all \\(m \\geqslant 0\\).\n\nPart 1. The required polynomial exists when \\(n\\) is a power of 2 or a prime.\nIf \\(n\\) is a power of 2 , set \\(P(x)=2 x\\).\nIf \\(n=p\\) is an odd prime, every function \\(f: \\mathbb{Z}_{p} \\rightarrow \\mathbb{Z}_{p}\\) coincides with some polynomial with integer coefficients. So we can pick the function that sends \\(x \\in\\{0,1, \\ldots, p-1\\}\\) to \\(\\lfloor x / 2\\rfloor\\).\n\nPart 2. The required polynomial does not exist when \\(n\\) is not a prime power.\nLet \\(n=a b\\) where \\(a, b>1\\) and \\(\\operatorname{gcd}(a, b)=1\\). Note that, since \\(\\operatorname{gcd}(a, b)=1\\),\n\\[\nf_{m, a b}=f_{m, a} f_{m, b}\n\\]\nby the Chinese remainder theorem. Also, note that, if \\(f_{m, \\ell}=f_{m+1, \\ell}\\), then \\(P\\) permutes the image of \\(P^{m}\\) on \\(\\mathbb{Z}_{\\ell}\\), and therefore \\(f_{s, \\ell}=f_{m, \\ell}\\) for all \\(s>m\\). So, as \\(f_{m, a b}=1\\) for sufficiently large \\(m\\), we have for each \\(m\\)\n\\[\nf_{m, a}>f_{m+1, a} \\quad \\text { or } \\quad f_{m, a}=1, \\quad f_{m, b}>f_{m+1, b} \\quad \\text { or } \\quad f_{m, b}=1 .\n\\]\n\nChoose the smallest \\(m\\) such that \\(f_{m+1, a}=1\\) or \\(f_{m+1, b}=1\\). Without loss of generality assume that \\(f_{m+1, a}=1\\). Then \\(f_{m+1, a b}=f_{m+1, b}<f_{m, b} \\leqslant f_{m, a b} / 2 \\leqslant f_{m+1, a b}\\), a contradiction.\n\nPart 3. The required polynomial does not exist when \\(n\\) is an odd prime power that is not a prime.\n\nLet \\(n=p^{k}\\), where \\(p \\geqslant 3\\) is prime and \\(k \\geqslant 2\\). For \\(r \\in \\mathbb{Z}_{p}\\) let \\(S_{r}\\) denote the subset of \\(\\mathbb{Z}_{p^{k}}\\) consisting of numbers congruent to \\(r\\) modulo \\(p\\). We denote the cardinality of a set \\(S\\) by \\(|S|\\).\nClaim. For any residue \\(r\\) modulo \\(p\\), either \\(\\left|P\\left(S_{r}\\right)\\right|=p^{k-1}\\) or \\(\\left|P\\left(S_{r}\\right)\\right| \\leqslant p^{k-2}\\).\nProof. Recall that \\(P(r+h)=P(r)+h P^{\\prime}(r)+h^{2} Q(r, h)\\), where \\(Q\\) is an integer polynomial.\nIf \\(p \\mid P^{\\prime}(r)\\), then \\(P(r+p s) \\equiv P(r)\\left(\\bmod p^{2}\\right)\\), hence all elements of \\(P\\left(S_{r}\\right)\\) are congruent modulo \\(p^{2}\\). So in this case \\(\\left|P\\left(S_{r}\\right)\\right| \\leqslant p^{k-2}\\).\n\nNow we show that \\(p \\nmid P^{\\prime}(r)\\) implies \\(\\left|P\\left(S_{r}\\right)\\right|=p^{k-1}\\) for all \\(k\\).\nSuppose the contrary: \\(\\left|P\\left(S_{r}\\right)\\right|<p^{k-1}\\) for some \\(k>1\\). Let us choose the smallest \\(k\\) for which this is so. To each residue in \\(P\\left(S_{r}\\right)\\) we assign its residue modulo \\(p^{k-1}\\); denote the resulting set by \\(\\bar{P}(S, r)\\). We have \\(|\\bar{P}(S, r)|=p^{k-2}\\) by virtue of minimality of \\(k\\). Then \\(\\left|P\\left(S_{r}\\right)\\right|<p^{k-1}=p \\cdot|\\bar{P}(S, r)|\\), that is, there is \\(u=P(x) \\in P\\left(S_{r}\\right)(x \\equiv r(\\bmod p))\\) and \\(t \\not \\equiv 0 (\\bmod p)\\) such that \\(u+p^{k-1} t \\notin P\\left(S_{r}\\right)\\).\n\nNote that \\(P\\left(x+p^{k-1} s\\right) \\equiv u+p^{k-1} s P^{\\prime}(x)\\left(\\bmod p^{k}\\right)\\). Since \\(P\\left(x+p^{k-1} s\\right) \\not \\equiv u+p^{k-1} t \\left(\\bmod p^{k}\\right)\\), the congruence \\(p^{k-1} s P^{\\prime}(x) \\equiv p^{k-1} t\\left(\\bmod p^{k}\\right)\\) has no solutions. So the congruence \\(s P^{\\prime}(x) \\equiv t(\\bmod p)\\) has no solutions, which contradicts \\(p \\nmid P^{\\prime}(r)\\).\n\nSince the image of \\(P^{m}\\) consists of one element for sufficiently large \\(m\\), we can take the smallest \\(m\\) such that \\(\\left|P^{m-1}\\left(S_{r}\\right)\\right|=p^{k-1}\\) for some \\(r \\in \\mathbb{Z}_{p}\\), but \\(\\left|P^{m}\\left(S_{q}\\right)\\right| \\leqslant p^{k-2}\\) for all \\(q \\in \\mathbb{Z}_{p}\\).\n\nFrom now on, we fix \\(m\\) and \\(r\\).\nSince the image of \\(P^{m-1}\\left(\\mathbb{Z}_{p^{k}}\\right) \\backslash P^{m-1}\\left(S_{r}\\right)\\) under \\(P\\) contains \\(P^{m}\\left(\\mathbb{Z}_{p^{k}}\\right) \\backslash P^{m}\\left(S_{r}\\right)\\), we have\n\\[\na:=\\left|P^{m}\\left(\\mathbb{Z}_{p^{k}}\\right) \\backslash P^{m}\\left(S_{r}\\right)\\right| \\leqslant\\left|P^{m-1}\\left(\\mathbb{Z}_{p^{k}}\\right) \\backslash P^{m-1}\\left(S_{r}\\right)\\right|,\n\\]\nthus\n\\[\na+p^{k-1} \\leqslant f_{m-1, p^{k}} \\leqslant 2 f_{m, p^{k}} \\leqslant 2 p^{k-2}+2 a,\n\\]\nso\n\\[\n(p-2) p^{k-2} \\leqslant a .\n\\]\n\nSince \\(f_{i, p}=1\\) for sufficiently large \\(i\\), there is exactly one \\(t \\in \\mathbb{Z}_{p}\\) such that \\(P(t) \\equiv t(\\bmod p)\\). Moreover, as \\(i\\) increases, the cardinality of the set \\(\\left\\{s \\in \\mathbb{Z}_{p} \\mid P^{i}(s) \\equiv t(\\bmod p)\\right\\}\\) increases (strictly), until it reaches the value \\(p\\). So either\n\\[\n\\left|\\left\\{s \\in \\mathbb{Z}_{p} \\mid P^{m-1}(s) \\equiv t \\quad(\\bmod p)\\right\\}\\right|=p \\quad \\text { or } \\quad\\left|\\left\\{s \\in \\mathbb{Z}_{p} \\mid P^{m-1}(s) \\equiv t \\quad(\\bmod p)\\right\\}\\right| \\geqslant m .\n\\]\n\nTherefore, either \\(f_{m-1, p}=1\\) or there exists a subset \\(X \\subset \\mathbb{Z}_{p}\\) of cardinality at least \\(m\\) such that \\(P^{m-1}(x) \\equiv t(\\bmod p)\\) for all \\(x \\in X\\).\n\nIn the first case \\(\\left|P^{m-1}\\left(\\mathbb{Z}_{p^{k}}\\right)\\right| \\leqslant p^{k-1}=\\left|P^{m-1}\\left(S_{r}\\right)\\right|\\), so \\(a=0\\), a contradiction.\nIn the second case let \\(Y\\) be the set of all elements of \\(\\mathbb{Z}_{p^{k}}\\) congruent to some element of \\(X\\) modulo \\(p\\). Let \\(Z=\\mathbb{Z}_{p^{k}} \\backslash Y\\). Then \\(P^{m-1}(Y) \\subset S_{t}, P\\left(S_{t}\\right) \\subsetneq S_{t}\\), and \\(Z=\\bigcup_{i \\in \\mathbb{Z}_{p} \\backslash X} S_{i}\\), so\n\\[\n\\left|P^{m}(Y)\\right| \\leqslant\\left|P\\left(S_{t}\\right)\\right| \\leqslant p^{k-2} \\quad \\text { and } \\quad\\left|P^{m}(Z)\\right| \\leqslant\\left|\\mathbb{Z}_{p} \\backslash X\\right| \\cdot p^{k-2} \\leqslant(p-m) p^{k-2} .\n\\]\n\nHence,\n\\[\n(p-2) p^{k-2} \\leqslant a<\\left|P^{m}\\left(\\mathbb{Z}_{p^{k}}\\right)\\right| \\leqslant\\left|P^{m}(Y)\\right|+\\left|P^{m}(Z)\\right| \\leqslant(p-m+1) p^{k-2}\n\\]\nand \\(m<3\\). Then \\(\\left|P^{2}\\left(S_{q}\\right)\\right| \\leqslant p^{k-2}\\) for all \\(q \\in \\mathbb{Z}_{p}\\), so\n\\[\np^{k} / 4 \\leqslant\\left|P^{2}\\left(\\mathbb{Z}_{p^{k}}\\right)\\right| \\leqslant p^{k-1},\n\\]\nwhich is impossible for \\(p \\geqslant 5\\). It remains to consider the case \\(p=3\\).\nAs before, let \\(t\\) be the only residue modulo 3 such that \\(P(t) \\equiv t(\\bmod 3)\\).\nIf \\(3 \\nmid P^{\\prime}(t)\\), then \\(P\\left(S_{t}\\right)=S_{t}\\) by the proof of the Claim above, which is impossible.\nSo \\(3 \\mid P^{\\prime}(t)\\). By substituting \\(h=3^{i} s\\) into the formula \\(P(t+h)=P(t)+h P^{\\prime}(t)+h^{2} Q(t, h)\\), we obtain \\(P\\left(t+3^{i} s\\right) \\equiv P(t)\\left(\\bmod 3^{i+1}\\right)\\). Using induction on \\(i\\) we see that all elements of \\(P^{i}\\left(S_{t}\\right)\\) are congruent modulo \\(3^{i+1}\\). Thus, \\(\\left|P^{k-1}\\left(S_{t}\\right)\\right|=1\\).\n\nNote that \\(f_{1,3} \\leqslant 2\\) and \\(f_{2,3} \\leqslant 1\\), so \\(P^{2}\\left(\\mathbb{Z}_{3^{k}}\\right) \\subset S_{t}\\). Therefore, \\(\\left|P^{k+1}\\left(\\mathbb{Z}_{3^{k}}\\right)\\right| \\leqslant\\left|P^{k-1}\\left(S_{t}\\right)\\right|=1\\). It follows that \\(3^{k} \\leqslant 2^{k+1}\\), which is impossible for \\(k \\geqslant 2\\).\n\nComment. Here is an alternative version of the problem.\nA function \\(f: \\mathbb{Z} \\rightarrow \\mathbb{Z}\\) is chosen so that \\(a-b \\mid f(a)-f(b)\\) for all \\(a, b \\in \\mathbb{Z}\\) with \\(a \\neq b\\). Let \\(S_{0}=\\mathbb{Z}\\), and for each positive integer \\(m\\), let \\(S_{m}\\) denote the image of \\(f\\) on the set \\(S_{m-1}\\). It is given that, for each nonnegative integer \\(m\\), there are exactly \\(\\left\\lceil n / 2^{m}\\right\\rceil\\) distinct residues modulo \\(n\\) in the set \\(S_{m}\\). Find all possible values of \\(n\\).\n\nAnswer: All powers of primes.\nSolution. Observe that \\(f\\) can be regarded as a function \\(\\mathbb{Z}_{\\ell} \\rightarrow \\mathbb{Z}_{\\ell}\\) for any positive integer \\(\\ell\\). We use notations \\(f^{m}\\) and \\(f_{m, \\ell}\\) as in the above solution.\n\n\\section*{Part 1. There exists a function \\(f: \\mathbb{Z}_{p^{k}} \\rightarrow \\mathbb{Z}_{p^{k}}\\) satisfying the desired properties.}\n\nFor \\(x \\in \\mathbb{Z}_{p^{k}}\\), let \\(\\operatorname{rev}(x)\\) denote the reversal of the base- \\(p\\) digits of \\(x\\) (we write every \\(x \\in \\mathbb{Z}_{p^{k}}\\) with exactly \\(k\\) digits, adding zeroes at the beginning if necessary). Choose\n\\[\nf(x)=\\operatorname{rev}\\left(\\left\\lfloor\\frac{\\operatorname{rev}(x)}{2}\\right\\rfloor\\right)\n\\]\nwhere, for dividing by \\(2, \\operatorname{rev}(x)\\) is interpreted as an integer in the range \\(\\left[0, p^{k}\\right)\\). It is easy to see that \\(f_{m+1, k}=\\left\\lceil f_{m, k} / 2\\right\\rceil\\).\n\nWe claim that if \\(a, b \\in \\mathbb{Z}_{p^{k}}\\) so that \\(p^{m} \\mid a-b\\), then \\(p^{m} \\mid f(a)-f(b)\\). Let \\(x=\\operatorname{rev}(a), y=\\operatorname{rev}(b)\\). The first \\(m\\) digits of \\(x\\) and \\(y\\) are the same, i.e \\(\\left\\lfloor x / p^{m-k}\\right\\rfloor=\\left\\lfloor y / p^{m-k}\\right\\rfloor\\). For every positive integers \\(c, d\\) and \\(z\\) we have \\(\\lfloor\\lfloor z / c\\rfloor / d\\rfloor=\\lfloor z /(c d)\\rfloor=\\lfloor\\lfloor z / d\\rfloor / c\\rfloor\\), so\n\\[\n\\left\\lfloor\\lfloor x / 2\\rfloor / p^{m-k}\\right\\rfloor=\\left\\lfloor\\left\\lfloor x / p^{m-k}\\right\\rfloor / 2\\right\\rfloor=\\left\\lfloor\\left\\lfloor y / p^{m-k}\\right\\rfloor / 2\\right\\rfloor=\\left\\lfloor\\lfloor y / 2\\rfloor / p^{m-k}\\right\\rfloor .\n\\]\n\nThus, the first \\(m\\) digits of \\(\\lfloor x / 2\\rfloor\\) and \\(\\lfloor y / 2\\rfloor\\) are the same. So the last \\(m\\) digits of \\(f(a)\\) and \\(f(b)\\) are the same, i.e. \\(p^{m} \\mid f(a)-f(b)\\).\n\nPart 2. Lifting the function \\(f: \\mathbb{Z}_{p^{k}} \\rightarrow \\mathbb{Z}_{p^{k}}\\) to a function on all of \\(\\mathbb{Z}\\).\nWe show that, for any function \\(f: \\mathbb{Z}_{p^{k}} \\rightarrow \\mathbb{Z}_{p^{k}}\\) for which \\(\\operatorname{gcd}\\left(p^{k}, a-b\\right) \\mid f(a)-f(b)\\), there is a corresponding function \\(g: \\mathbb{Z} \\rightarrow \\mathbb{Z}\\) for which \\(a-b \\mid g(a)-g(b)\\) for all distinct integers \\(a, b\\) and \\(g(x) \\equiv f(x)\\left(\\bmod p^{k}\\right)\\) for all \\(x \\in \\mathbb{Z}\\), whence the proof will be completed. We will construct the values of such a function inductively; assume that we have constructed it for some interval \\([a, b)\\) and wish to define \\(g(b)\\). (We will define \\(g(a-1)\\) similarly.)\n\nFor every prime \\(q \\leqslant|a-b|\\), we choose the maximal \\(\\alpha_{q}\\) for which there exists \\(c_{q} \\in[a, b)\\), such that \\(b-c_{q} \\vdots q^{\\alpha_{q}}\\), and choose one such \\(c_{q}\\).\n\nWe apply Chinese remainder theorem to find \\(g(b)\\) satisfying the following conditions:\n\\[\n\\begin{gathered}\ng(b) \\equiv g\\left(c_{q}\\right) \\quad\\left(\\bmod q^{\\alpha_{q}}\\right) \\quad \\text { for } \\quad q \\neq p, \\quad \\text { and } \\\\\ng(b) \\equiv g\\left(c_{p}\\right) \\quad\\left(\\bmod q^{\\alpha_{p}}\\right) \\quad \\text { if } \\quad \\alpha_{p} \\geqslant k, \\quad g(b) \\equiv f(b) \\quad\\left(\\bmod p^{k}\\right) \\quad \\text { if } \\quad \\alpha_{p}<k .\n\\end{gathered}\n\\]\n\nIt is not hard to verify that \\(b-c \\mid g(b)-g(c)\\) for every \\(c \\in[a, b)\\) and \\(g(b) \\equiv f(b)\\left(\\bmod p^{k}\\right)\\).\nPart 3. The required function does not exist if \\(n\\) has at least two different prime divisors.\nThe proof is identical to the polynomial version.", "source_pdf": "imosl_2021.pdf", "notes": "fallback-regex"}
{"id": "IMOSL-2022-A1", "contest": "IMOSL", "year": "2022", "problem_number": "A1", "problem": "Let \\(\\left(a_{n}\\right)_{n \\geqslant 1}\\) be a sequence of positive real numbers with the property that\n\\[\n\\left(a_{n+1}\\right)^{2}+a_{n} a_{n+2} \\leqslant a_{n}+a_{n+2}\n\\]\nfor all positive integers \\(n\\). Show that \\(a_{2022} \\leqslant 1\\).", "solution": ". We begin by observing that \\(\\left(a_{n+1}\\right)^{2}-1 \\leqslant a_{n}+a_{n+2}-a_{n} a_{n+2}-1\\), which is equivalent to\n\\[\n\\left(a_{n+1}\\right)^{2}-1 \\leqslant\\left(1-a_{n}\\right)\\left(a_{n+2}-1\\right) .\n\\]\n\nSuppose now that there exists a positive integer \\(n\\) such that \\(a_{n+1}>1\\) and \\(a_{n+2}>1\\). Since \\(\\left(a_{n+1}\\right)^{2}-1 \\leqslant\\left(1-a_{n}\\right)\\left(a_{n+2}-1\\right)\\), we deduce that \\(0<1-a_{n}<1<1+a_{n+2}\\), thus \\(\\left(a_{n+1}\\right)^{2}-1<\\left(a_{n+2}+1\\right)\\left(a_{n+2}-1\\right)=\\left(a_{n+2}\\right)^{2}-1\\).\n\nOn the other hand, \\(\\left(a_{n+2}\\right)^{2}-1 \\leqslant\\left(1-a_{n+3}\\right)\\left(a_{n+1}-1\\right)<\\left(1+a_{n+1}\\right)\\left(a_{n+1}-1\\right)=\\left(a_{n+1}\\right)^{2}-1\\), a contradiction. We have shown that we cannot have two consecutive terms, except maybe \\(a_{1}\\) and \\(a_{2}\\), strictly greater than 1 .\n\nFinally, suppose \\(a_{2022}>1\\). This implies that \\(a_{2021} \\leqslant 1\\) and \\(a_{2023} \\leqslant 1\\). Therefore \\(0< \\left(a_{2022}\\right)^{2}-1 \\leqslant\\left(1-a_{2021}\\right)\\left(a_{2023}-1\\right) \\leqslant 0\\), a contradiction. We conclude that \\(a_{2022} \\leqslant 1\\).", "source_pdf": "imosl_2022.pdf", "notes": "fallback-regex"}
{"id": "IMOSL-2022-A2", "contest": "IMOSL", "year": "2022", "problem_number": "A2", "problem": "Let \\(k \\geqslant 2\\) be an integer. Find the smallest integer \\(n \\geqslant k+1\\) with the property that there exists a set of \\(n\\) distinct real numbers such that each of its elements can be written as a sum of \\(k\\) other distinct elements of the set.\n(Slovakia)", "solution": "Answer: \\(n=k+4\\).\n\n. First we show that \\(n \\geqslant k+4\\). Suppose that there exists such a set with \\(n\\) numbers and denote them by \\(a_{1}<a_{2}<\\cdots<a_{n}\\).\n\nNote that in order to express \\(a_{1}\\) as a sum of \\(k\\) distinct elements of the set, we must have \\(a_{1} \\geqslant a_{2}+\\cdots+a_{k+1}\\) and, similarly for \\(a_{n}\\), we must have \\(a_{n-k}+\\cdots+a_{n-1} \\geqslant a_{n}\\). We also know that \\(n \\geqslant k+1\\).\n\nIf \\(n=k+1\\) then we have \\(a_{1} \\geqslant a_{2}+\\cdots+a_{k+1}>a_{1}+\\cdots+a_{k} \\geqslant a_{k+1}\\), which gives a contradiction.\n\nIf \\(n=k+2\\) then we have \\(a_{1} \\geqslant a_{2}+\\cdots+a_{k+1} \\geqslant a_{k+2}\\), that again gives a contradiction.\nIf \\(n=k+3\\) then we have \\(a_{1} \\geqslant a_{2}+\\cdots+a_{k+1}\\) and \\(a_{3}+\\cdots+a_{k+2} \\geqslant a_{k+3}\\). Adding the two inequalities we get \\(a_{1}+a_{k+2} \\geqslant a_{2}+a_{k+3}\\), again a contradiction.\n\nIt remains to give an example of a set with \\(k+4\\) elements satisfying the condition of the problem. We start with the case when \\(k=2 l\\) and \\(l \\geqslant 1\\). In that case, denote by \\(A_{i}=\\{-i, i\\}\\) and take the set \\(A_{1} \\cup \\cdots \\cup A_{l+2}\\), which has exactly \\(k+4=2 l+4\\) elements. We are left to show that this set satisfies the required condition.\n\nNote that if a number \\(i\\) can be expressed in the desired way, then so can \\(-i\\) by negating the expression. Therefore, we consider only \\(1 \\leqslant i \\leqslant l+2\\).\n\nIf \\(i<l+2\\), we sum the numbers from some \\(l-1\\) sets \\(A_{j}\\) with \\(j \\neq 1, i+1\\), and the numbers \\(i+1\\) and -1 .\n\nFor \\(i=l+2\\), we sum the numbers from some \\(l-1\\) sets \\(A_{j}\\) with \\(j \\neq 1, l+1\\), and the numbers \\(l+1\\) and 1 .\n\nIt remains to a give a construction for odd \\(k=2 l+1\\) with \\(l \\geqslant 1\\) (since \\(k \\geqslant 2\\) ). To that end, we modify the construction for \\(k=2 l\\) by adding 0 to the previous set.\n\nThis is a valid set as 0 can be added to each constructed expression, and 0 can be expressed as follows: take the numbers \\(1,2,-3\\) and all the numbers from the remaining \\(l-1\\) sets \\(A_{4}, A_{5}, \\cdots, A_{l+2}\\).", "source_pdf": "imosl_2022.pdf", "notes": "fallback-regex"}
{"id": "IMOSL-2022-A4", "contest": "IMOSL", "year": "2022", "problem_number": "A4", "problem": "Let \\(n \\geqslant 3\\) be an integer, and let \\(x_{1}, x_{2}, \\ldots, x_{n}\\) be real numbers in the interval \\([0,1]\\). Let \\(s=x_{1}+x_{2}+\\ldots+x_{n}\\), and assume that \\(s \\geqslant 3\\). Prove that there exist integers \\(i\\) and \\(j\\) with \\(1 \\leqslant i<j \\leqslant n\\) such that\n\\[\n2^{j-i} x_{i} x_{j}>2^{s-3}\n\\]\n(Trinidad and Tobago)\n\n\\section*{", "solution": ".}\n\nLet \\(1 \\leqslant a<b \\leqslant n\\) be such that \\(2^{b-a} x_{a} x_{b}\\) is maximal. This choice of \\(a\\) and \\(b\\) implies that \\(x_{a+t} \\leqslant 2^{t} x_{a}\\) for all \\(1-a \\leqslant t \\leqslant b-a-1\\), and similarly \\(x_{b-t} \\leqslant 2^{t} x_{b}\\) for all \\(b-n \\leqslant t \\leqslant b-a+1\\). Now, suppose that \\(x_{a} \\in\\left(\\frac{1}{2^{u+1}}, \\frac{1}{2^{u}}\\right]\\) and \\(x_{b} \\in\\left(\\frac{1}{2^{v+1}}, \\frac{1}{2^{v}}\\right]\\), and write \\(x_{a}=2^{-\\alpha}, x_{b}=2^{-\\beta}\\). Then\n\\[\n\\sum_{i=1}^{a+u-1} x_{i} \\leqslant 2^{u} x_{a}\\left(\\frac{1}{2}+\\frac{1}{4}+\\ldots+\\frac{1}{2^{a+u-1}}\\right)<2^{u} x_{a} \\leqslant 1\n\\]\nand similarly,\n\\[\n\\sum_{i=b-v+1}^{n} x_{i} \\leqslant 2^{v} x_{b}\\left(\\frac{1}{2}+\\frac{1}{4}+\\ldots+\\frac{1}{2^{n-b+v}}\\right)<2^{v} x_{b} \\leqslant 1,\n\\]\n\nIn other words, the sum of the \\(x_{i}\\) 's for \\(i\\) outside of the interval \\([a+u, b-v]\\) is strictly less than 2. Since the total sum is at least 3 , and each term is at most 1 , it follows that this interval must have at least two integers. i.e., \\(a+u<b-v\\). Thus, by bounding the sum of the \\(x_{i}\\) for \\(i \\in[1, a+u] \\cup[b-v, n]\\) like above, and trivially bounding each \\(x_{i} \\in(a+u, b-v)\\) by 1 , we obtain\n\\[\ns<2^{u+1} x_{a}+2^{v+1} x_{b}+((b-v)-(a+u)-1)=b-a+\\left(2^{u+1-\\alpha}+2^{v+1-\\beta}-(u+v+1)\\right) .\n\\]\n\nNow recall \\(\\alpha \\in(u, u+1]\\) and \\(\\beta \\in(v, v+1]\\), so applying Bernoulli's inequality yields\n\\(\\left.2^{u+1-\\alpha}+2^{v+1-\\beta}-u-v-1 \\leqslant(1+(u+1-\\alpha))\\right)+(1+(v+1-\\beta))-u-v-1=3-\\alpha-\\beta\\).\nIt follows that \\(s-3<b-a-\\alpha-\\beta\\), and so\n\\[\n2^{s-3}<2^{b-a-\\alpha-\\beta}=2^{b-a} x_{a} x_{b}\n\\]\n\nComment 1. It is not hard to see that the inequality is tight. Suppose that \\(n=2 k+1\\), and we set \\(x_{k+1}=1, x_{k}=x_{k+2}=\\frac{1}{2}+\\frac{1}{2^{k}}\\), and \\(x_{k+1-t}=x_{k+1+t}=\\frac{1}{2^{t}}\\). Then \\(s=3\\) (so the right hand side is 1 ), and\n\\[\n\\max _{i<j} 2^{j-i} x_{i} x_{j}=2^{2}\\left(\\frac{1}{2}+\\frac{1}{2^{k}}\\right)^{2},\n\\]\nwhich can be made arbitrarily close to 1 . Note that \\(s\\) can be made larger by putting in more 1 -s in the middle (and this accommodates even \\(n\\) as well).\n\nComment 2. An alternative formulation of the problem is to show that there exists a positive constant \\(c\\) (or find the best such \\(c\\) ) such that\n\\[\n\\max _{i<j} 2^{j-i} x_{i} x_{j}>c 2^{s}\n\\]\n\nThe above shows that \\(c=1 / 8\\) is the best possible. A somewhat simpler ending to the proof can be given for \\(c=1 / 32\\).\nEnd of solution for \\(c=1 / 32\\).\nAs in the original solution, we arrive at\n\\[\ns<2^{u+1} x_{a}+2^{v+1} x_{b}+((b-v)-(a+u)-1)=b-a+\\left(2^{u+1-\\alpha}+2^{v+1-\\beta}-(u+v+1)\\right) .\n\\]\n\nNow \\(2^{b-a} x_{a} x_{b} \\geqslant 2^{b-a} 2^{-u-1} 2^{-v-1}\\), so it is enough to show \\(s-5<b-a-u-v-2\\), or \\(s<b-a- u-v+3\\). The fact that \\(u+1-\\alpha<1\\) and \\(v+1-\\beta<1\\) implies \\(2^{u+1-\\alpha}+2^{v+1-\\beta}<4\\), and so \\(s<b-a+(2+2-u-v-1)=b-a-u-v-3\\).", "source_pdf": "imosl_2022.pdf", "notes": "fallback-regex"}
{"id": "IMOSL-2022-A5", "contest": "IMOSL", "year": "2022", "problem_number": "A5", "problem": "Find all positive integers \\(n \\geqslant 2\\) for which there exist \\(n\\) real numbers \\(a_{1}<\\cdots<a_{n}\\) and a real number \\(r>0\\) such that the \\(\\frac{1}{2} n(n-1)\\) differences \\(a_{j}-a_{i}\\) for \\(1 \\leqslant i<j \\leqslant n\\) are equal, in some order, to the numbers \\(r^{1}, r^{2}, \\ldots, r^{\\frac{1}{2} n(n-1)}\\).\n(Czech Republic)", "solution": "Answer: \\(n \\in\\{2,3,4\\}\\).\n\n. We first show a solution for each \\(n \\in\\{2,3,4\\}\\). We will later show the impossibility of finding such a solution for \\(n \\geqslant 5\\).\n\nFor \\(n=2\\), take for example \\(\\left(a_{1}, a_{2}\\right)=(1,3)\\) and \\(r=2\\).\nFor \\(n=3\\), take the root \\(r>1\\) of \\(x^{2}-x-1=0\\) (the golden ratio) and set \\(\\left(a_{1}, a_{2}, a_{3}\\right)= \\left(0, r, r+r^{2}\\right)\\). Then\n\\[\n\\left(a_{2}-a_{1}, a_{3}-a_{2}, a_{3}-a_{1}\\right)=\\left(r, r^{2}, r+r^{2}=r^{3}\\right)\n\\]\n\nFor \\(n=4\\), take the root \\(r \\in(1,2)\\) of \\(x^{3}-x-1=0\\) (such a root exists because \\(1^{3}-1-1<0\\) and \\(\\left.2^{3}-2-1>0\\right)\\) and set \\(\\left(a_{1}, a_{2}, a_{3}, a_{4}\\right)=\\left(0, r, r+r^{2}, r+r^{2}+r^{3}\\right)\\). Then\n\\[\n\\left(a_{2}-a_{1}, a_{3}-a_{2}, a_{4}-a_{3}, a_{3}-a_{1}, a_{4}-a_{2}, a_{4}-a_{1}\\right)=\\left(r, r^{2}, r^{3}, r^{4}, r^{5}, r^{6}\\right) .\n\\]\n\nFor \\(n \\geqslant 5\\), we will proceed by contradiction. Suppose there exist numbers \\(a_{1}<\\cdots<a_{n}\\) and \\(r>1\\) satisfying the conditions of the problem. We start with a lemma:\nLemma. We have \\(r^{n-1}>2\\).\nProof. There are only \\(n-1\\) differences \\(a_{j}-a_{i}\\) with \\(j=i+1\\), so there exists an exponent \\(e \\leqslant n\\) and a difference \\(a_{j}-a_{i}\\) with \\(j \\geqslant i+2\\) such that \\(a_{j}-a_{i}=r^{e}\\). This implies\n\\[\nr^{n} \\geqslant r^{e}=a_{j}-a_{i}=\\left(a_{j}-a_{j-1}\\right)+\\left(a_{j-1}-a_{i}\\right)>r+r=2 r\n\\]\nthus \\(r^{n-1}>2\\) as desired.\nTo illustrate the general approach, we first briefly sketch the idea behind the argument in the special case \\(n=5\\). In this case, we clearly have \\(a_{5}-a_{1}=r^{10}\\). Note that there are 3 ways to rewrite \\(a_{5}-a_{1}\\) as a sum of two differences, namely\n\\[\n\\left(a_{5}-a_{4}\\right)+\\left(a_{4}-a_{1}\\right),\\left(a_{5}-a_{3}\\right)+\\left(a_{3}-a_{1}\\right),\\left(a_{5}-a_{2}\\right)+\\left(a_{2}-a_{1}\\right) .\n\\]\n\nUsing the lemma above and convexity of the function \\(f(n)=r^{n}\\), we argue that those three ways must be \\(r^{10}=r^{9}+r^{1}=r^{8}+r^{4}=r^{7}+r^{6}\\). That is, the \"large\" exponents keep dropping by 1 , while the \"small\" exponents keep increasing by \\(n-2, n-3, \\ldots, 2\\). Comparing any two such equations, we then get a contradiction unless \\(n \\leqslant 4\\).\n\nNow we go back to the full proof for any \\(n \\geqslant 5\\). Denote \\(b=\\frac{1}{2} n(n-1)\\). Clearly, we have \\(a_{n}-a_{1}=r^{b}\\). Consider the \\(n-2\\) equations of the form:\n\\[\na_{n}-a_{1}=\\left(a_{n}-a_{i}\\right)+\\left(a_{i}-a_{1}\\right) \\text { for } i \\in\\{2, \\ldots, n-1\\} .\n\\]\n\nIn each equation, one of the two terms on the right-hand side must be at least \\(\\frac{1}{2}\\left(a_{n}-a_{1}\\right)\\). But from the lemma we have \\(r^{b-(n-1)}=r^{b} / r^{n-1}<\\frac{1}{2}\\left(a_{n}-a_{1}\\right)\\), so there are at most \\(n-2\\) sufficiently large elements in \\(\\left\\{r^{k} \\mid 1 \\leqslant k<b\\right\\}\\), namely \\(r^{b-1}, \\ldots, r^{b-(n-2)}\\) (note that \\(r^{b}\\) is already used for \\(a_{n}-a_{1}\\) ). Thus, the \"large\" terms must be, in some order, precisely equal to elements in\n\\[\nL=\\left\\{r^{b-1}, \\ldots, r^{b-(n-2)}\\right\\}\n\\]\n\nNext we claim that the \"small\" terms in the \\(n-2\\) equations must be equal to the elements in\n\\[\nS=\\left\\{\\left.r^{b-(n-2)-\\frac{1}{2} i(i+1)} \\right\\rvert\\, 1 \\leqslant i \\leqslant n-2\\right\\},\n\\]\nin the corresponding order (the largest \"large\" term with the smallest \"small\" term, etc.). Indeed, suppose that\n\\[\nr^{b}=a_{n}-a_{1}=r^{b-i}+r^{\\alpha_{i}} \\text { for } i \\in\\{1, \\ldots, n-2\\},\n\\]\nwhere \\(1 \\leqslant \\alpha_{1}<\\cdots<\\alpha_{n-2} \\leqslant b-(n-1)\\). Since \\(r>1\\) and \\(f(r)=r^{n}\\) is convex, we have\n\\[\nr^{b-1}-r^{b-2}>r^{b-2}-r^{b-3}>\\ldots>r^{b-(n-3)}-r^{b-(n-2)}\n\\]\nimplying\n\\[\nr^{\\alpha_{2}}-r^{\\alpha_{1}}>r^{\\alpha_{3}}-r^{\\alpha_{2}}>\\ldots>r^{\\alpha_{n-2}}-r^{\\alpha_{n-3}}\n\\]\n\nConvexity of \\(f(r)=r^{n}\\) further implies\n\\[\n\\alpha_{2}-\\alpha_{1}>\\alpha_{3}-\\alpha_{2}>\\ldots>\\alpha_{n-2}-\\alpha_{n-3} .\n\\]\n\nNote that \\(\\alpha_{n-2}-\\alpha_{n-3} \\geqslant 2\\) : Otherwise we would have \\(\\alpha_{n-2}-\\alpha_{n-3}=1\\) and thus\n\\[\nr^{\\alpha_{n-3}} \\cdot(r-1)=r^{\\alpha_{n-2}}-r^{\\alpha_{n-3}}=r^{b-(n-3)}-r^{b-(n-2)}=r^{b-(n-2)} \\cdot(r-1),\n\\]\nimplying that \\(\\alpha_{n-3}=b-(n-2)\\), a contradiction. Therefore, we have\n\\[\n\\begin{aligned}\n\\alpha_{n-2}-\\alpha_{1} & =\\left(\\alpha_{n-2}-\\alpha_{n-3}\\right)+\\cdots+\\left(\\alpha_{2}-\\alpha_{1}\\right) \\\\\n& \\geqslant 2+3+\\cdots+(n-2) \\\\\n& =\\frac{1}{2}(n-2)(n-1)-1=\\frac{1}{2} n(n-3) .\n\\end{aligned}\n\\]\n\nOn the other hand, from \\(\\alpha_{n-2} \\leqslant b-(n-1)\\) and \\(\\alpha_{1} \\geqslant 1\\) we get\n\\[\n\\alpha_{n-2}-\\alpha_{1} \\leqslant b-n=\\frac{1}{2} n(n-1)-n=\\frac{1}{2} n(n-3),\n\\]\nimplying that equalities must occur everywhere and the claim about the small terms follows.\nNow, assuming \\(n-2 \\geqslant 2\\), we have the two different equations:\n\\[\nr^{b}=r^{b-(n-2)}+r^{b-(n-2)-1} \\text { and } r^{b}=r^{b-(n-3)}+r^{b-(n-2)-3},\n\\]\nwhich can be rewritten as\n\\[\nr^{n-1}=r+1 \\quad \\text { and } \\quad r^{n+1}=r^{4}+1\n\\]\n\nSimple algebra now gives\n\\[\nr^{4}+1=r^{n+1}=r^{n-1} \\cdot r^{2}=r^{3}+r^{2} \\Longrightarrow(r-1)\\left(r^{3}-r-1\\right)=0 .\n\\]\n\nSince \\(r \\neq 1\\), using Equation (1) we conclude \\(r^{3}=r+1=r^{n-1}\\), thus \\(n=4\\), which gives a contradiction.", "source_pdf": "imosl_2022.pdf", "notes": "fallback-regex"}
{"id": "IMOSL-2022-A6", "contest": "IMOSL", "year": "2022", "problem_number": "A6", "problem": "Let \\(\\mathbb{R}\\) be the set of real numbers. We denote by \\(\\mathcal{F}\\) the set of all functions \\(f: \\mathbb{R} \\rightarrow \\mathbb{R}\\) such that\n\\[\nf(x+f(y))=f(x)+f(y)\n\\]\nfor every \\(x, y \\in \\mathbb{R}\\). Find all rational numbers \\(q\\) such that for every function \\(f \\in \\mathcal{F}\\), there exists some \\(z \\in \\mathbb{R}\\) satisfying \\(f(z)=q z\\).\n(Indonesia)", "solution": "Answer: The desired set of rational numbers is \\(\\left\\{\\frac{n+1}{n}: n \\in \\mathbb{Z}, n \\neq 0\\right\\}\\).\n\n. Let \\(Z\\) be the set of all rational numbers \\(q\\) such that for every function \\(f \\in \\mathcal{F}\\), there exists some \\(z \\in \\mathbb{R}\\) satisfying \\(f(z)=q z\\). Let further\n\\[\nS=\\left\\{\\frac{n+1}{n}: n \\in \\mathbb{Z}, n \\neq 0\\right\\}\n\\]\n\nWe prove that \\(Z=S\\) by showing the two inclusions: \\(S \\subseteq Z\\) and \\(Z \\subseteq S\\).\nWe first prove that \\(S \\subseteq Z\\). Let \\(f \\in \\mathcal{F}\\) and let \\(P(x, y)\\) be the relation \\(f(x+f(y))=f(x)+ f(y)\\). First note that \\(P(0,0)\\) gives \\(f(f(0))=2 f(0)\\). Then, \\(P(0, f(0))\\) gives \\(f(2 f(0))=3 f(0)\\). We claim that\n\\[\nf(k f(0))=(k+1) f(0)\n\\]\nfor every integer \\(k \\geqslant 1\\). The claim can be proved by induction. The cases \\(k=1\\) and \\(k=2\\) have already been established. Assume that \\(f(k f(0))=(k+1) f(0)\\) and consider \\(P(0, k f(0))\\) which gives\n\\[\nf((k+1) f(0))=f(0)+f(k f(0))=(k+2) f(0) .\n\\]\n\nThis proves the claim. We conclude that \\(\\frac{k+1}{k} \\in Z\\) for every integer \\(k \\geqslant 1\\). Note that \\(P(-f(0), 0)\\) gives \\(f(-f(0))=0\\). We now claim that\n\\[\nf(-k f(0))=(-k+1) f(0)\n\\]\nfor every integer \\(k \\geqslant 1\\). The proof by induction is similar to the one above. We conclude that \\(\\frac{-k+1}{-k} \\in Z\\) for every integer \\(k \\geqslant 1\\). This shows that \\(S \\subseteq Z\\).\n\nWe now prove that \\(Z \\subseteq S\\). Let \\(p\\) be a rational number outside the set \\(S\\). We want to prove that \\(p\\) does not belong to \\(Z\\). To that end, we construct a function \\(f \\in \\mathcal{F}\\) such that \\(f(z) \\neq p z\\) for every \\(z \\in \\mathbb{R}\\). The strategy is to first construct a function\n\\[\ng:[0,1) \\rightarrow \\mathbb{Z}\n\\]\nand then define \\(f\\) as \\(f(x)=g(\\{x\\})+\\lfloor x\\rfloor\\). This function \\(f\\) belongs to \\(\\mathcal{F}\\). Indeed,\n\\[\n\\begin{aligned}\nf(x+f(y)) & =g(\\{x+f(y)\\})+\\lfloor x+f(y)\\rfloor \\\\\n& =g(\\{x+g(\\{y\\})+\\lfloor y\\rfloor\\})+\\lfloor x+g(\\{y\\})+\\lfloor y\\rfloor\\rfloor \\\\\n& =g(\\{x\\})+\\lfloor x\\rfloor+g(\\{y\\})+\\lfloor y\\rfloor \\\\\n& =f(x)+f(y)\n\\end{aligned}\n\\]\nwhere we used that \\(g\\) only takes integer values.\nLemma 1. For every \\(\\alpha \\in[0,1)\\), there exists \\(m \\in \\mathbb{Z}\\) such that\n\\[\nm+n \\neq p(\\alpha+n)\n\\]\nfor every \\(n \\in \\mathbb{Z}\\).\n\nProof. Note that if \\(p=1\\) the claim is trivial. If \\(p \\neq 1\\), then the claim is equivalent to the existence of an integer \\(m\\) such that\n\\[\n\\frac{m-p \\alpha}{p-1}\n\\]\nis never an integer. Assume the contrary. That would mean that both\n\\[\n\\frac{m-p \\alpha}{p-1} \\text { and } \\frac{(m+1)-p \\alpha}{p-1}\n\\]\nare integers, and so is their difference. The latter is equal to\n\\[\n\\frac{1}{p-1}\n\\]\n\nSince we assumed \\(p \\notin S, 1 /(p-1)\\) is never an integer. This is a contradiction.\nDefine \\(g:[0,1) \\rightarrow \\mathbb{Z}\\) by \\(g(\\alpha)=m\\) for any integer \\(m\\) that satisfies the conclusion of Lemma 1. Note that \\(f(z) \\neq p z\\) if and and only if\n\\[\ng(\\{z\\})+\\lfloor z\\rfloor \\neq p(\\{z\\}+\\lfloor z\\rfloor)\n\\]\n\nThe latter is guaranteed by the construction of the function \\(g\\). We conclude that \\(p \\notin Z\\) as desired. This shows that \\(Z \\subset S\\).", "source_pdf": "imosl_2022.pdf", "notes": "fallback-regex"}
{"id": "IMOSL-2022-A7", "contest": "IMOSL", "year": "2022", "problem_number": "A7", "problem": "For a positive integer \\(n\\) we denote by \\(s(n)\\) the sum of the digits of \\(n\\). Let \\(P(x)= x^{n}+a_{n-1} x^{n-1}+\\cdots+a_{1} x+a_{0}\\) be a polynomial, where \\(n \\geqslant 2\\) and \\(a_{i}\\) is a positive integer for all \\(0 \\leqslant i \\leqslant n-1\\). Could it be the case that, for all positive integers \\(k, s(k)\\) and \\(s(P(k))\\) have the same parity?\n(Belarus)", "solution": "Answer: No. For any such polynomial there exists a positive integer \\(k\\) such that \\(s(k)\\) and \\(s(P(k))\\) have different parities.\n\n. With the notation above, we begin by choosing a positive integer \\(t\\) such that\n\\[\n10^{t}>\\max \\left\\{\\frac{100^{n-1} a_{n-1}}{\\left(10^{\\frac{1}{n-1}}-9^{\\frac{1}{n-1}}\\right)^{n-1}}, \\frac{a_{n-1}}{9} 10^{n-1}, \\frac{a_{n-1}}{9}\\left(10 a_{n-1}\\right)^{n-1}, \\ldots, \\frac{a_{n-1}}{9}\\left(10 a_{0}\\right)^{n-1}\\right\\}\n\\]\n\nAs a direct consequence of \\(10^{t}\\) being bigger than the first quantity listed in the above set, we get that the interval\n\\[\nI=\\left[\\left(\\frac{9}{a_{n-1}} 10^{t}\\right)^{\\frac{1}{n-1}},\\left(\\frac{1}{a_{n-1}} 10^{t+1}\\right)^{\\frac{1}{n-1}}\\right)\n\\]\ncontains at least 100 consecutive positive integers.\nLet \\(X\\) be a positive integer in \\(I\\) such that \\(X\\) is congruent to \\(1 \\bmod 100\\). Since \\(X \\in I\\) we have\n\\[\n9 \\cdot 10^{t} \\leqslant a_{n-1} X^{n-1}<10^{t+1}\n\\]\nthus the first digit (from the left) of \\(a_{n-1} X^{n-1}\\) must be 9 .\nNext, we observe that \\(a_{n-1}\\left(10 a_{i}\\right)^{n-1}<9 \\cdot 10^{t} \\leqslant a_{n-1} X^{n-1}\\), thus \\(10 a_{i}<X\\) for all \\(i\\), which immediately implies that \\(a_{0}<a_{1} X<\\cdots<a_{n} X^{n}\\), and the number of digits of this strictly increasing sequence forms a strictly increasing sequence too. In other words, if \\(i<j\\), the number of digits of \\(a_{i} X^{i}\\) is less than the number of digits of \\(a_{j} X^{j}\\).\n\nLet \\(\\alpha\\) be the number of digits of \\(a_{n-1} X^{n-1}\\), thus \\(10^{\\alpha-1} \\leqslant a_{n-1} X^{n-1}<10^{\\alpha}\\). We are now going to look at \\(P\\left(10^{\\alpha} X\\right)\\) and \\(P\\left(10^{\\alpha-1} X\\right)\\) and prove that the sum of their digits has different parities. This will finish the proof since \\(s\\left(10^{\\alpha} X\\right)=s\\left(10^{\\alpha-1} X\\right)=s(X)\\).\n\nWe have \\(P\\left(10^{\\alpha} X\\right)=10^{\\alpha n} X^{n}+a_{n-1} 10^{\\alpha(n-1)} X^{n-1}+\\cdots+a_{0}\\), and since \\(10^{\\alpha(i+1)}>10^{\\alpha i} a_{n-1} X^{n-1}> 10^{\\alpha i} a_{i} X^{i}\\), the terms \\(a_{i} 10^{\\alpha i} X^{i}\\) do not interact when added; in particular, there is no carryover caused by addition. Thus we have \\(s\\left(P\\left(10^{\\alpha} X\\right)\\right)=s\\left(X^{n}\\right)+s\\left(a_{n-1} X^{n-1}\\right)+\\cdots+s\\left(a_{0}\\right)\\).\n\nWe now look at \\(P\\left(10^{\\alpha-1} X\\right)=10^{(\\alpha-1) n} X^{n}+a_{n-1} 10^{(\\alpha-1)(n-1)} X^{n-1}+\\cdots+a_{0}\\). Firstly, if \\(i<n-1\\), then \\(a_{n-1} X^{n-1}\\) has more digits than \\(a_{i} X^{i}\\) and \\(a_{n-1} X^{n-1} \\geqslant 10 a_{i} X^{i}\\). It now follows that \\(10^{(\\alpha-1)(i+1)+1}>10^{(\\alpha-1) i} a_{n-1} X^{n-1} \\geqslant 10^{(\\alpha-1) i+1} a_{i} X^{i}\\), thus all terms \\(10^{(\\alpha-1) i} a_{i} X^{i}\\) for \\(0 \\leqslant i \\leqslant n-1\\) come in 'blocks', exactly as in the previous case.\n\nFinally, \\(10^{(\\alpha-1) n+1}>10^{(\\alpha-1)(n-1)} a_{n-1} X^{n-1} \\geqslant 10^{(\\alpha-1) n}\\), thus \\(10^{(\\alpha-1)(n-1)} a_{n-1} X^{n-1}\\) has exactly \\((\\alpha-1) n+1\\) digits, and its first digit is 9 , as established above. On the other hand, \\(10^{(\\alpha-1) n} X^{n}\\) has exactly \\((\\alpha-1) n\\) zeros, followed by 01 (as \\(X\\) is \\(1 \\bmod 100\\) ). Therefore, when we add the terms, the 9 and 1 turn into 0 , the 0 turns into 1 , and nothing else is affected.\n\nPutting everything together, we obtain\n\\[\ns\\left(P\\left(10^{\\alpha-1} X\\right)\\right)=s\\left(X^{n}\\right)+s\\left(a_{n-1} X^{n-1}\\right)+\\cdots+s\\left(a_{0}\\right)-9=s\\left(P\\left(10^{\\alpha} X\\right)\\right)-9\n\\]\nthus \\(s\\left(P\\left(10^{\\alpha} X\\right)\\right)\\) and \\(s\\left(P\\left(10^{\\alpha-1} X\\right)\\right)\\) have different parities, as claimed.", "source_pdf": "imosl_2022.pdf", "notes": "fallback-regex"}
{"id": "IMOSL-2022-A8", "contest": "IMOSL", "year": "2022", "problem_number": "A8", "problem": "For a positive integer \\(n\\), an \\(n\\)-sequence is a sequence ( \\(a_{0}, \\ldots, a_{n}\\) ) of non-negative integers satisfying the following condition: if \\(i\\) and \\(j\\) are non-negative integers with \\(i+j \\leqslant n\\), then \\(a_{i}+a_{j} \\leqslant n\\) and \\(a_{a_{i}+a_{j}}=a_{i+j}\\).\n\nLet \\(f(n)\\) be the number of \\(n\\)-sequences. Prove that there exist positive real numbers \\(c_{1}, c_{2}\\) and \\(\\lambda\\) such that\n\\[\nc_{1} \\lambda^{n}<f(n)<c_{2} \\lambda^{n}\n\\]\nfor all positive integers \\(n\\).\n(Canada)", "solution": "Answer: Such constants exist with \\(\\lambda=3^{1 / 6}\\); we will discuss appropriate values of \\(c_{1}\\) and \\(c_{2}\\) in the\n\nbelow.\n\nSolution. In order to solve this, we will give a complete classification of \\(n\\)-sequences.\nLet \\(k=\\lfloor n / 2\\rfloor\\). We will say that an \\(n\\)-sequence is large if \\(a_{i}>k\\) for some \\(i\\), and small if no such \\(i\\) exists. For now we will assume that ( \\(a_{i}\\) ) is not the identity sequence (in other words, that \\(a_{i} \\neq i\\) for some \\(i\\) ).\nLemma 1. If \\(a_{r}=a_{s}\\) and \\(r, s<n\\), then \\(a_{r+1}=a_{s+1}\\).\nProof. We have \\(a_{r+1}=a_{a_{r}+a_{1}}=a_{a_{s}+a_{1}}=a_{s+1}\\).\nLemma 2. If \\(i \\leqslant k\\), then \\(a_{i} \\leqslant k\\).\nProof. We have \\(i+i \\leqslant n\\), so \\(a_{i}+a_{i} \\leqslant n\\) whence \\(a_{i} \\leqslant k\\).\nLemma 3. There exist \\(r, s\\) such that \\(a_{r}=a_{s}\\) and \\(r \\neq s\\).\nProof. If \\(a_{0} \\neq 0\\) then \\(a_{2 a_{0}}=a_{0}\\). Otherwise, \\(a_{a_{i}}=a_{i}\\) for all \\(i\\), so take \\(i\\) such that \\(a_{i} \\neq i\\) (which we can do by our earlier assumption).\n\nLemma 4. Let \\(r\\) be the smallest index such that \\(a_{s}=a_{r}\\) for some \\(s>r\\), and let \\(d\\) be the minimum positive integer such that \\(a_{r+d}=a_{r}\\). Then\n1. The subsequence ( \\(a_{r}, a_{r+1}, \\ldots, a_{n}\\) ) is periodic with minimal period \\(d\\). That is, for \\(u<v\\), we have \\(a_{u}=a_{v}\\) if and only if \\(u, v \\geqslant r\\) and \\(d \\mid v-u\\).\n2. \\(a_{i}=i\\) for \\(i<r\\) and \\(a_{i} \\geqslant r\\) for \\(i \\geqslant r\\).\n\nIn this case we say ( \\(a_{i}\\) ) has period \\(d\\) and offset \\(r\\).\nProof. We prove each in turn:\n1. The \"if\" implication is clear from Lemma 1. For the reverse direction, suppose \\(a_{u}=a_{v}\\). Then there are integers \\(r \\leqslant u_{0}, v_{0}<r+d\\) such that \\(d \\mid u-u_{0}, v-v_{0}\\), so \\(a_{u_{0}}=a_{u}=a_{v}= a_{v_{0}}\\). If \\(u_{0}<v_{0}\\) then \\(a_{r+d+u_{0}-v_{0}}=a_{r+d}=a_{r}\\), contradicting the minimality of \\(d\\). There is a similar contradiction when \\(u_{0}>v_{0}\\). Thus \\(u_{0}=v_{0}\\), so \\(d \\mid u-v\\).\n2. If \\(r=0\\) there is nothing to prove. Otherwise \\(a_{0}=a_{2 a_{0}}\\) so \\(2 a_{0}=0\\). Then we have \\(a_{a_{i}}=a_{i}\\) for all \\(i\\), so \\(a_{i}=i\\) for \\(i<r\\).\n\nLemma 5. Either\n1. \\(d \\mid a_{i}-i\\) for all \\(i\\), or\n2. \\(r=0\\) and \\(d \\mid a_{i}-i-d / 2\\) for all \\(i\\).\n\nProof. Note that Lemma 4 tells us that if \\(a_{u}=a_{v}\\) then \\(d \\mid u-v\\). Since \\(a_{a_{i}+a_{0}}=a_{i}\\) for all \\(i\\), we have \\(d \\mid a_{i}-i+a_{0}\\). For \\(i=0\\), this means that \\(d \\mid 2 a_{0}\\). If \\(d \\mid a_{0}\\) then that means that \\(d \\mid a_{i}-i\\) for all \\(i\\). Otherwise, if \\(d \\nmid a_{0}\\), then \\(d \\mid a_{0}-d / 2\\) and thus \\(d \\mid a_{i}-i-d / 2\\) for all \\(i\\). In addition, part 2 of Lemma 4 says that we must have \\(r=0\\) in this case.\n\nLemma 6. If \\(d\\) is even and \\(d \\mid a_{0}-d / 2\\), then \\(\\left(a_{i}\\right)\\) is small. (Note that we must have \\(r=0\\) in this case.)\nProof. Note that if \\(d \\leqslant k+1\\), then by Lemma \\(2,\\left(a_{0}, \\ldots, a_{d-1}\\right)\\) is a period for the sequence consisting of elements at most \\(k\\), so ( \\(a_{i}\\) ) must be small. Now suppose \\(d>k+1\\). We show that \\(a_{i} \\leqslant k\\) for all \\(i\\) by induction. Note that Lemma 2 already establishes this for \\(i \\leqslant k\\). We must have \\(d \\mid a_{d / 2}\\) and \\(a_{d / 2} \\leqslant k<d\\) so \\(a_{d / 2}=0\\). Thus, for \\(i>k\\), if \\(a_{j} \\leqslant k\\) for \\(j<i\\), then \\(a_{i-d / 2} \\leqslant k\\), so \\(a_{i}=a_{(i-d / 2)+d / 2}=a_{a_{i-d / 2}} \\leqslant k\\).\nLemma 7. If ( \\(a_{i}\\) ) is small, then \\(r+d \\leqslant k+1\\).\nProof. Since ( \\(a_{i}\\) ) is small, there exists \\(u, v \\leqslant k+1\\) such that \\(u<v\\) and \\(a_{u}=a_{v}\\). Thus \\(u \\leqslant r\\) and \\(d \\mid v-u\\), so \\(r+d \\leqslant v \\leqslant k+1\\).\n\nLemma 8. If ( \\(a_{i}\\) ) is large, then \\(r+d>k+1\\) and \\(a_{i}=i\\) for all \\(0 \\leqslant i<r+d\\).\nProof. Since ( \\(a_{i}\\) ) is large and has period \\(d\\) and offset \\(r\\), the period ( \\(a_{r}, \\ldots, a_{r+d-1}\\) ) must have an element that is larger than \\(k\\), so by Lemma 2 we must have \\(r+d-1>k\\).\n\nWe already have \\(a_{i}=i\\) for \\(i<r\\). Now we show that \\(a_{i}=i\\) for \\(r \\leqslant i \\leqslant k\\). By Lemma 6 we have \\(d \\mid a_{i}-i\\) but \\(r \\leqslant i \\leqslant k\\). Since \\(k-r+1>d\\), this means that \\(a_{i}=i\\) for \\(i \\leqslant k\\).\n\nFinally, one can show inductively that \\(a_{i}=i\\) for \\(k<i<r+d\\). Indeed, if \\(a_{j}=j\\) for all \\(j<i\\), then \\(a_{i} \\geqslant i\\) (otherwise \\(a_{i}=a_{j}\\) for some \\(j<i\\), but then \\(r \\leqslant j\\) and \\(i<r+d\\) means that \\(d \\nmid j-i\\).) However, \\(a_{i}+(n-i)=a_{i}+a_{n-i} \\leqslant n\\), so \\(a_{i}=i\\).\n\nThus large sequences are determined by \\(r\\) and \\(d\\). It is not hard to check that all sequences of the form \\(a_{i}=i\\) for \\(i<r+d\\) and with period \\(d\\) and offset \\(r\\) are \\(n\\)-sequences. There are \\((n-k-1)(n+k+2) / 2\\) possible choices of \\((r, d)\\) where \\(0 \\leqslant r<n, d \\geqslant 1\\), and \\(k+1<r+d \\leqslant n\\).\n\nFor small sequences, for a given period \\(d\\) and offset \\(r\\), we need to choose the period \\(\\left(a_{r}, \\ldots, a_{r+d-1}\\right)\\) satisfying \\(r \\leqslant a j \\leqslant k\\) and \\(d \\mid a_{j}-j\\) for \\(r \\leqslant j<r+d\\). There are \\(g(k+1-r, d)\\) such choices, where we define \\(g(x, d)\\) to be \\((p+1)^{q} p^{d-q}\\) with \\(p=\\lfloor x / d\\rfloor\\) and \\(q=x-d p\\).\n\nFurthermore, if \\(d\\) is even then there are \\(g(k+1, d)\\) choices for the period \\(\\left(a_{0}, \\ldots, a_{d-1}\\right)\\) satisfying \\(d \\mid a_{j}-j-d / 2\\) for \\(j<d\\). Again it is not hard to check that, once these choices are made, then the resulting sequence is an \\(n\\)-sequence.\n\nThus the total number of \\(n\\)-sequences is\n\\[\nf(n)=1+\\frac{(n-k-1)(n+k+2)}{2}+\\sum_{d^{\\prime}=1}^{\\lfloor(k+1) / 2\\rfloor} g\\left(k+1,2 d^{\\prime}\\right)+\\sum_{r=0}^{k} \\sum_{d=1}^{k+1-r} g(k+1-r, d) .\n\\]\n\nNow, to show that \\(f(n)>c_{1} \\lambda^{n}\\) for some \\(c_{1}\\), we note that\n\\[\nf(n)>g\\left(k+1,\\left\\lfloor\\frac{k+1}{3}\\right\\rfloor\\right) \\geqslant 3^{\\lfloor(k+1) / 3\\rfloor}>3^{n / 6}-1\n\\]\n\nTo show that \\(f(n)<c_{2} \\lambda^{n}\\) for some \\(c_{2}\\), it actually suffices to show that there is a positive real number \\(c_{3}\\) such that for all positive integers \\(x\\),\n\\[\n\\sum_{d=1}^{x} g(x, d) \\leqslant c_{3} 3^{x / 3}\n\\]\n\nIn fact, the following lemma suffices, as it bounds the left hand side of the above inequality by a pair of geometric series with initial term \\(3^{x / 3}\\) :\n\nLemma. For positive \\(d, x\\), we have:\n\\[\ng(x, d) \\leqslant \\begin{cases}3^{x / 3}\\left(\\frac{64}{81}\\right)^{x / 3-d}, & \\text { if } d \\leqslant x / 3 \\\\ 3^{x / 3}\\left(\\frac{8}{9}\\right)^{d-x / 3}, & \\text { if } d \\geqslant x / 3\\end{cases}\n\\]\n\nProof. There are a few key observations needed, all of which are immediate from the definition:\n- ( \\(x, d\\) ) is the maximum product of a sequence of \\(d\\) integers that sums to \\(x\\).\n- For any positive integer \\(k\\), we have \\(g(k x, k d)=g(x, d)^{k}\\).\n- If \\(2 d \\leqslant x \\leqslant 3 d\\), then \\(g(x, d)=2^{3 d-x} 3^{x-2 d}\\). Likewise, if \\(3 d \\leqslant x \\leqslant 4 d\\) then \\(g(x, d)= 3^{4 d-x} 4^{x-3 d}\\).\n\nWith these observations, if \\(d \\leqslant x / 3\\), then\n\\[\n3^{4(x-3 d)} g(3 x, 3 d) \\leqslant g(3 x+12(x-3 d), 3 d+4(x-3 d))=g(15 x-36 d, 4 x-9 d)\n\\]\n\nTo calculate \\(g(15 x-36 d, 4 x-9 d)\\), note that\n\\[\n\\begin{aligned}\n& 3(4 x-9 d)=12 x-27 d \\leqslant 15 x-36 d, \\\\\n& 4(4 x-9 d)=16 x-36 d \\geqslant 15 x-36 d,\n\\end{aligned}\n\\]\nso\n\\[\ng(15 x-36 d, 4 x-9 d)=3^{4(4 x-9 d)-(15 x-36 d)} 4^{(15 x-36 d)-3(4 x-9 d)}=3^{x} 4^{3(x-3 d)}\n\\]\n\nThus\n\\[\ng(x, d)^{3}=g(3 x, 3 d)=\\frac{3^{4(x-3 d)} g(3 x, 3 d)}{3^{4(x-3 d)}} \\leqslant \\frac{3^{x} 4^{3(x-3 d)}}{3^{4(x-3 d)}}=3^{x}\\left(\\frac{64}{81}\\right)^{x-3 d},\n\\]\nwhich completes the proof of the first claim. Likewise, if \\(d \\geqslant x / 3\\),\n\\[\n3^{2(3 d-x)} g(3 x, 3 d) 3 \\leqslant g(3 x+6(3 d-x), 3 d+2(3 d-x))=g(18 d-3 x, 9 d-2 x) .\n\\]\n\nAgain we have\n\\[\n2(9 d-2 x) \\leqslant 18-3 x \\leqslant 18-3 x+3(3 d-x)=3(9 d-2 x)\n\\]\nso\n\\[\ng(18 d-3 x, 9 d-2 x)=2^{3(9 d-2 x)-(18 d-3 x)} 3^{(18 d-3 x)-2(9 d-2 x)}=2^{3(3 d-x)} 3^{x}\n\\]\n\nThus\n\\[\ng(x, d)^{3}=g(3 x, 3 d)=\\frac{2^{3(3 d-x)} g(3 x, 3 d)}{3^{2(3 d-x)}} \\leqslant \\frac{2^{3(3 d-x) 3^{x}}}{3^{2(3 d-x)}}=3^{x}\\left(\\frac{8}{9}\\right)^{3 d-x}\n\\]\nfrom which the second claim follows.\nCommon remarks. The best possible value of \\(c_{1}\\) is constrained by \\(n=1\\) : in this case, \\(f(1)=2\\), which means that \\(c_{1}>2 \\cdot 3^{-1 / 6} \\approx 1.66537\\).\n\nWith a careful analysis one can show that the best possible value of \\(c_{2}\\) is \\(\\frac{236567}{4930} 3^{1 / 3} \\approx\\) 69.20662.\n\n\\section*{Combinatorics}", "source_pdf": "imosl_2022.pdf", "notes": "fallback-regex"}
{"id": "IMOSL-2022-C1", "contest": "IMOSL", "year": "2022", "problem_number": "C1", "problem": "A \\(\\pm 1\\)-sequence is a sequence of 2022 numbers \\(a_{1}, \\ldots, a_{2022}\\), each equal to either +1 or -1 . Determine the largest \\(C\\) so that, for any \\(\\pm 1\\)-sequence, there exists an integer \\(k\\) and indices \\(1 \\leqslant t_{1}<\\ldots<t_{k} \\leqslant 2022\\) so that \\(t_{i+1}-t_{i} \\leqslant 2\\) for all \\(i\\), and\n\\[\n\\left|\\sum_{i=1}^{k} a_{t_{i}}\\right| \\geqslant C .\n\\]\n(Czech Republic)", "solution": "Answer: The answer is \\(C=506\\).\n\n. First, we prove that this can always be achieved. Without loss of generality, suppose at least \\(\\frac{2022}{2}=1011\\) terms of the \\(\\pm 1\\)-sequence are +1 . Define a subsequence as follows: starting at \\(t=0\\), if \\(a_{t}=+1\\) we always include \\(a_{t}\\) in the subsequence. Otherwise, we skip \\(a_{t}\\) if we can (i.e. if we included \\(a_{t-1}\\) in the subsequence), otherwise we include it out of necessity, and go to the next \\(t\\). Clearly, this subsequence will include all +1 s . Also, for each -1 included in the sequence, a -1 must have been skipped, so at most \\(\\left\\lfloor\\frac{1011}{2}\\right\\rfloor=505\\) can be included. Hence the sum is at least \\(1011-505=506\\), as desired.\n\nNext, we prove that, for the \\(\\pm 1\\)-sequence\n\\[\n(\\{-1\\},\\{+1,+1\\},\\{-1,-1\\},\\{+1,+1\\}, \\ldots,\\{+1,+1\\},\\{-1,-1\\},\\{+1\\}),\n\\]\neach admissible subsequence \\(a_{t_{i}}\\) has \\(-506 \\leqslant \\sum_{i} a_{t_{i}} \\leqslant 506\\). We say that the terms inside each curly bracket is a block. In total, there are 1012 blocks - 506 of them hold +1 -s, and 506 of them hold -1 s . (The two blocks at each end hold 1 number each, each other block holds 2.)\n\nSuppose an admissible subsequence includes terms from \\(k\\) blocks holding +1 -s. Then, in each -1 -pair in between the +1 -pairs, the subsequence must also include at least one -1 . There can be at most two +1 s included from each +1 -block, and at least one -1 must be included from each -1 -block, so the sum is at most \\(2 k-(k-1)=k+1\\).\n\nFor \\(k<506\\), this is at most 506 . If \\(k=506\\), one of the +1 -blocks must be the one at the end, meaning it can only include one +1 , so that the maximum in this case is only \\(k\\), not \\(k+1\\), so in this case the sum is also at most 506 .\n\nHence we have shown that for any admissible subsequence, \\(\\sum_{i} a_{t_{i}} \\leqslant 506\\). Analogously we can show that \\(-506 \\leqslant \\sum_{i} a_{t_{i}}\\), meaning that \\(C \\leqslant 506\\) as desired.\n\nComment. A possible reformulation of the problem is the following.\n2022 buckets of water are arranged in a row, each coloured either red or blue. Sally the salmon plays a game in the following way: first, she chooses any bucket she likes to start in. Then, any number of times she may jump either to the next bucket in the row, or across it to land in the bucket after that. (She may not jump across more than one bucket.) At any point, she may finish the game. At that time, her score is the absolute value of the difference between the number of red and blue buckets she visited during the game. Determine the largest \\(C\\) so that no matter how the buckets are coloured, Sally can achieve a score of at least \\(C\\).", "source_pdf": "imosl_2022.pdf", "notes": "fallback-regex"}
{"id": "IMOSL-2022-C3", "contest": "IMOSL", "year": "2022", "problem_number": "C3", "problem": "In each square of a garden shaped like a \\(2022 \\times 2022\\) board, there is initially a tree of height 0 . A gardener and a lumberjack alternate turns playing the following game, with the gardener taking the first turn:\n- The gardener chooses a square in the garden. Each tree on that square and all the surrounding squares (of which there are at most eight) then becomes one unit taller.\n- The lumberjack then chooses four different squares on the board. Each tree of positive height on those squares then becomes one unit shorter.\n\nWe say that a tree is majestic if its height is at least \\(10^{6}\\). Determine the largest number \\(K\\) such that the gardener can ensure there are eventually \\(K\\) majestic trees on the board, no matter how the lumberjack plays.\n(Colombia)", "solution": "Answer: \\(K=5 \\cdot \\frac{2022^{2}}{9}=2271380\\). In general, for a \\(3 N \\times 3 N\\) board, \\(K=5 N^{2}\\).\n\n. We solve the problem for a general \\(3 N \\times 3 N\\) board. First, we prove that the lumberjack has a strategy to ensure there are never more than \\(5 N^{2}\\) majestic trees. Giving the squares of the board coordinates in the natural manner, colour each square where at least one of its coordinates are divisible by 3 , shown below for a \\(9 \\times 9\\) board:\n\n\\begin{tabular}{|l|l|l|l|l|l|l|l|l|}\n\\hline & & & & & & & & \\\\\n\\hline & & & & & & & & \\\\\n\\hline & & & & & & & & \\\\\n\\hline & & & & & & & & \\\\\n\\hline & & & & & & & & \\\\\n\\hline & & & & & & & & \\\\\n\\hline & & & & & & & & \\\\\n\\hline & & & & & & & & \\\\\n\\hline & & & & & & & & \\\\\n\\hline\n\\end{tabular}\n\nThen, as each \\(3 \\times 3\\) square on the board contains exactly 5 coloured squares, each move of the gardener will cause at most 4 trees on non-coloured squares to grow. The lumberjack may therefore cut those trees, ensuring no tree on a non-coloured square has positive height after his turn. Hence there cannot ever be more majestic trees than coloured squares, which is \\(5 N^{2}\\).\n\nNext, we prove the gardener may ensure there are \\(5 N^{2}\\) majestic trees. In fact, we prove this statement in a modified game which is more difficult for the gardener: on the lumberjack's turn in the modified game, he may decrement the height of all trees on the board except those the gardener did not just grow, in addition to four of the trees the gardener just grew. Clearly, a sequence of moves for the gardener which ensures that there are \\(K\\) majestic trees in the modified game also ensures this in the original game.\n\nLet \\(M=\\binom{9}{5}\\); we say that a map is one of the \\(M\\) possible ways to mark 5 squares on a \\(3 \\times 3\\) board. In the modified game, after the gardener chooses a \\(3 \\times 3\\) subboard on the board, the lumberjack chooses a map in this subboard, and the total result of the two moves is that each tree marked on the map increases its height by 1 , each tree in the subboard which is not in the map remains unchanged, and each tree outside the subboard decreases its height by 1 . Also note that if the gardener chooses a \\(3 \\times 3\\) subboard \\(M l\\) times, the lumberjack will have to choose some map at least \\(l\\) times, so there will be at least 5 trees which each have height \\(\\geqslant l\\).\n\nThe strategy for the gardener will be to divide the board into \\(N^{2}\\) disjoint \\(3 \\times 3\\) subboards, number them \\(0, \\ldots, N^{2}-1\\) in some order. Then, for \\(b=N^{2}-1, \\ldots, 0\\) in order, he plays \\(10^{6} M(M+1)^{b}\\) times on subboard number \\(b\\). Hence, on subboard number \\(b\\), the moves on that subboard will first ensure 5 of its trees grows by at least \\(10^{6}(M+1)^{b}\\), and then each move after that will decrease their heights by 1 . (As the trees on subboard \\(b\\) had height 0 before the gardener started playing there, no move made on subboards \\(\\geqslant b\\) decreased their heights.) As the gardener makes \\(10^{6} M(M+1)^{b-1}+\\ldots=10^{6}\\left((M+1)^{b}-1\\right)\\) moves after he finishes playing on subboard \\(b\\), this means that on subboard \\(b\\), there will be 5 trees of height at least \\(10^{6}(M+1)^{b}-10^{6}\\left((M+1)^{b}-1\\right)=10^{6}\\), hence each of the subboard has 5 majestic trees, which was what we wanted.\n\n\\section*{C4.}\n\nLet \\(n>3\\) be a positive integer. Suppose that \\(n\\) children are arranged in a circle, and \\(n\\) coins are distributed between them (some children may have no coins). At every step, a child with at least 2 coins may give 1 coin to each of their immediate neighbours on the right and left. Determine all initial distributions of coins from which it is possible that, after a finite number of steps, each child has exactly one coin.\n(Israel)\nAnswer: All distributions where \\(\\sum_{i=1}^{n} i c_{i}=\\frac{n(n+1)}{2}(\\bmod n)\\), where \\(c_{i}\\) denotes the number of coins the \\(i\\)-th child starts with.\n\n\\section*{Solution 1.}\n\nNumber the children \\(1, \\ldots, n\\), and denote the number of coins the \\(i\\)-th child has by \\(c_{i}\\). A step of this process consists of reducing some \\(c_{i}\\) by 2 , and increasing \\(c_{i-1}, c_{i+1}\\) by 1 . (Indices are considered \\((\\bmod n)\\).\\() Because (i-1)-2 i+(i+1)=0\\), the quantity \\(\\sum_{i=1}^{n} i c_{i}(\\bmod n)\\) will be invariant under this process. Hence a necessary condition for the children to end up with an uniform distribution of coins is that\n\\[\n\\sum_{i=1}^{n} i c_{i}=\\frac{n(n+1)}{2} \\quad(\\bmod n) .\n\\]\n\nWe will show that this condition is also sufficient. Consider an arbitrary initial distribution of coins. First, whenever child \\(i\\) has more than one coin and \\(i \\neq n\\), have child \\(i\\) pass coins to its neighbors. (Child \\(i\\) does nothing.) Then, after some amount of such steps, it must eventually become impossible to do any more steps because no child except perhaps child \\(i\\) has more than 1 coin. (To see this, consider e.g. the quantity \\(\\sum_{i=1}^{n-1} i^{2} c_{i}\\), which (as \\((i-1)^{2}+(i+1)^{2}>2 i^{2}\\) ) increases at each step.)\n\nHence we can reach a state of the form \\(\\left(z_{1}, \\ldots, z_{n-1}, M\\right)\\), where \\(z_{i}=0\\) or 1 . Call such states semi-uniform states of irregularity \\(M\\).\nLemma. If there is a string of children having coins \\(a, \\overbrace{1, \\ldots, 1}^{k \\text { ones }}, b, \\overbrace{1, \\ldots, 1}^{k \\text { ones }}, c\\), with \\(b \\geqslant 2\\), after some sequence of steps we may reach the state \\(a+1, \\overbrace{1, \\ldots, 1}^{k \\text { ones }}, b-2, \\overbrace{1, \\ldots, 1}^{k \\text { ones }}, c+1\\). We call performing this sequence of steps long-passing coins.\nProof. This is simply repeated application of the operation. We prove the lemma by induction on \\(k\\). For \\(k=0\\), this is just the operation of the problem. If \\(k=1\\), have the child with \\(b\\) coins pass coins, then both of their neighbors pass coins, then the child with \\(b\\) coins pass coins again. For \\(k \\geqslant 2\\), first, have the child with \\(b\\) coins pass coins, then have both their neigbors send coins, giving the state\n\\[\na, \\overbrace{1, \\ldots, 1}^{k-2 \\text { ones }}, 2,0, b, 0,2, \\overbrace{1, \\ldots, 1}^{k-2 \\text { ones }}, c .\n\\]\n\nNow set aside the children with \\(a, b\\) and \\(c\\) coins, and have each child with 2 coins give them to their neighbors until there are no such children remaining. This results in the state\n\\[\na+1,0, \\overbrace{1, \\ldots, 1}^{k-2 \\text { ones }}, b, \\overbrace{1, \\ldots, 1}^{k-2 \\text { ones }}, 0, c+1 .\n\\]\n\nBy the induction hypothesis, we can have the child with \\(b\\) coins may pass a coin to each of the children with 0 coins, proving the lemma.\n\nClaim. We can reach a semi-uniform state of irregularity \\(M \\leqslant 2\\).\nProof. If \\(M>3\\), because there are only \\(n\\) coins in total, there must be at least two children with 0 coins. Consider the arc of the circle spanned by the two such children closest to the child with \\(M\\) coins. It has the form\n\\[\n0, \\overbrace{1, \\ldots, 1}^{a \\text { ones }}, M, \\overbrace{1, \\ldots, 1}^{b \\text { ones }}, 0\n\\]\n\nIf \\(a=b\\), applying the previous lemma we can have the child with \\(M\\) coins long-pass a coin to each of the children with 0 coins, which yields a semi-uniform state with lower \\(M\\). Otherwise, WLOG \\(a>b\\), so we can have the child with \\(M\\) coins long-pass a coin to each of the children at distance \\(b\\) from it, reaching a state of the form ( \\(\\alpha:=a-b-1, \\beta:=b\\) )\n\\[\n0, \\overbrace{1, \\ldots, 1}^{\\alpha \\text { ones }}, 2, \\overbrace{1, \\ldots, 1}^{\\beta \\text { ones }}, M-2, \\overbrace{1, \\ldots, 1}^{c \\text { ones }}\n\\]\n\nThe children in the rightmost string of ones need make no further moves, so consider only the leftmost string. If \\(\\alpha<\\beta\\), have the child with 2 coins long-pass coins to the child with 0 coins to its left and some child with 1 coin to its right, reaching a new state of the form \\(0, \\overbrace{1, \\ldots, 1}^{\\alpha \\text { ones }}, 2, \\overbrace{1, \\ldots, 1}^{\\beta \\text { ones }}, M-2\\) with a smaller \\(\\beta\\). As \\(\\beta\\) cannot decrease indefinitely, eventually \\(\\alpha \\geqslant \\beta\\). If \\(\\alpha=\\beta\\), have the child with 2 coins long-pass to the child with \\(M\\) coins and the child with 0 coins, reaching a semi-uniform state of irregularity \\(M-1\\) as desired. Otherwise, \\(\\alpha<\\beta\\), so have the child with 2 coins long-pass to the child with \\(M\\) coins and a child with 1 coin, reaching a state of the form\n\\[\n0, \\overbrace{1, \\ldots, 1}^{x \\text { ones }}, 2, \\overbrace{1, \\ldots, 1}^{y \\text { ones }}, 0, \\overbrace{1, \\ldots, 1}^{z \\text { ones }}, M-1\n\\]\n\nNow, consider only the substring between the two children with 0 coins, which has the form \\(0, \\overbrace{1, \\ldots, 1}^{x \\text { ones }}, 2, \\overbrace{1, \\ldots, 1}^{y \\text { ones }}, 0\\). Repeatedly have the child in this substring with 2 coins long-pass to the closest child with 0 coins and some other child. If the other child has 1 coin, we have a new strictly shorter substring of the form \\(0, \\overbrace{1, \\ldots, 1}^{x \\text { ones }}, 2, \\overbrace{1, \\ldots, 1}^{y \\text { ones }}, 0\\). Hence eventually it must happen that the other child also has 0 coins, at which point we reach a semi-uniform state of irregularity \\(M-1\\), proving the claim.\n\nWe have now shown that we can reach a semi-regular state of irregularity \\(M \\leqslant 2\\), If \\(M=1\\), each child must have one coin, as desired. Otherwise, we must have \\(M=2\\), so there is one child with 0 coins, one child with 2 coins, and the remaining children all have 1 coin. Recall that the state we started with satisfied the invariant\n\\[\n\\sum_{i=1}^{n} i c_{i}=\\frac{n(n+1)}{2} \\quad(\\bmod n)\n\\]\n\nBecause each step preserves this invariant, this must also be true of the current state. Number the children so that the child with \\(M\\) coins is child number \\(n\\), and suppose the child with 0 coins is child \\(k\\). Then \\(\\frac{n(n+1)}{2}=\\sum_{i=1}^{n} i c_{i}=\\left(\\sum_{i=1}^{n} 1 \\cdot c_{i}\\right)-k=\\frac{n(n+1)}{2}-k(\\bmod n)\\), so \\(k=0 (\\bmod n)\\). But this is impossible, as no child except the child with \\(M\\) coins has an index divisible by \\(n\\). Hence we cannot end up in a semi-regular state of irregularity 2 , so we are done.\n\nSolution 2. Encode the sequence \\(c_{i}\\) as a polynomial \\(p(x)=\\sum_{i} a_{i} x_{i}\\). The cyclic nature of the problem makes it natural to work modulo \\(x^{n}-1\\). Child \\(i\\) performing a step is equivalent to adding \\(x^{i}(x-1)^{2}\\) to the polynomial, and we want to reach the polynomial \\(q(x)=1+x+\\ldots+ x^{n-1}\\). Since we only add multiples of \\((x-1)^{2}\\), this is only possible if \\(p(x)=q(x)\\) modulo the ideal generated by \\(x^{n}-1\\) and \\((x-1)^{2}\\), i.e.\n\\[\n\\left(x^{n}-1,(x-1)^{2}\\right)=(x-1)\\left(\\frac{x^{n}-1}{x-1}, x-1\\right)=(x-1) \\cdot(n,(x-1))\n\\]\n\nThis is equivalent to \\(p(1)=q(1)\\) (which simply translates to the condition that there are \\(n\\) coins) and \\(p^{\\prime}(1)=q^{\\prime}(1)(\\bmod n)\\), which translates to the invariant described in solution 1 .", "source_pdf": "imosl_2022.pdf", "notes": "fallback-regex"}
{"id": "IMOSL-2022-C5", "contest": "IMOSL", "year": "2022", "problem_number": "C5", "problem": "Let \\(m, n \\geqslant 2\\) be integers, let \\(X\\) be a set with \\(n\\) elements, and let \\(X_{1}, X_{2}, \\ldots, X_{m}\\) be pairwise distinct non-empty, not necessary disjoint subsets of \\(X\\). A function \\(f: X \\rightarrow \\{1,2, \\ldots, n+1\\}\\) is called nice if there exists an index \\(k\\) such that\n\\[\n\\sum_{x \\in X_{k}} f(x)>\\sum_{x \\in X_{i}} f(x) \\text { for all } i \\neq k\n\\]\n\nProve that the number of nice functions is at least \\(n^{n}\\).\n(Germany)", "solution": ". For a subset \\(Y \\subseteq X\\), we write \\(f(Y)\\) for \\(\\sum_{y \\in Y} f(y)\\). Note that a function \\(f: X \\rightarrow \\{1, \\ldots, n+1\\}\\) is nice, if and only if \\(f\\left(X_{i}\\right)\\) is maximized by a unique index \\(i \\in\\{1, \\ldots, m\\}\\).\n\nWe will first investigate the set \\(\\mathcal{F}\\) of functions \\(f: X \\rightarrow\\{1, \\ldots, n\\}\\); note that \\(|\\mathcal{F}|=n^{n}\\). For every function \\(f \\in \\mathcal{F}\\), define a corresponding function \\(f^{+}: X \\rightarrow\\{1,2, \\ldots, n+1\\}\\) in the following way: Pick some set \\(X_{l}\\) that maximizes the value \\(f\\left(X_{l}\\right)\\).\n- For all \\(x \\in X_{l}\\), define \\(f^{+}(x)=f(x)+1\\).\n- For all \\(x \\in X \\backslash X_{l}\\), define \\(f^{+}(x)=f(x)\\).\n\nClaim. The resulting function \\(f^{+}\\)is nice.\nProof. Note that \\(f^{+}\\left(X_{i}\\right)=f\\left(X_{i}\\right)+\\left|X_{i} \\cap X_{l}\\right|\\) holds for all \\(X_{i}\\). We show that \\(f^{+}\\left(X_{i}\\right)\\) is maximized at the unique index \\(i=l\\). Hence consider some arbitrary index \\(j \\neq l\\). Then \\(X_{l} \\subset X_{j}\\) is impossible, as this would imply \\(f\\left(X_{j}\\right)>f\\left(X_{l}\\right)\\) and thereby contradict the choice of set \\(X_{l}\\); this in particular yields \\(\\left|X_{l}\\right|>\\left|X_{j} \\cap X_{l}\\right|\\).\n\\[\nf^{+}\\left(X_{l}\\right)=f\\left(X_{l}\\right)+\\left|X_{l}\\right| \\geqslant f\\left(X_{j}\\right)+\\left|X_{l}\\right|>f\\left(X_{j}\\right)+\\left|X_{j} \\cap X_{l}\\right|=f^{+}\\left(X_{j}\\right)\n\\]\n\nThe first inequality follows since \\(X_{l}\\) was chosen to maximize the value \\(f\\left(X_{l}\\right)\\). The second (strict) inequality follows from \\(\\left|X_{l}\\right|>\\left|X_{j} \\cap X_{l}\\right|\\) as observed above. This completes the proof of the claim.\n\nNext observe that function \\(f\\) can be uniquely reconstructed from \\(f^{+}\\): the claim yields that \\(f^{+}\\)has a unique maximizer \\(X_{l}\\), and by decreasing the value of \\(f^{+}\\)on \\(X_{l}\\) by 1 , we get we can fully determine the values of \\(f\\). As each of the \\(n^{n}\\) functions \\(f \\in \\mathcal{F}\\) yields a (unique) corresponding nice function \\(f^{+}: X \\rightarrow\\{1,2, \\ldots, n+1\\}\\), the proof is complete.", "source_pdf": "imosl_2022.pdf", "notes": "fallback-regex"}
{"id": "IMOSL-2022-C6", "contest": "IMOSL", "year": "2022", "problem_number": "C6", "problem": "Let \\(n\\) be a positive integer. We start with \\(n\\) piles of pebbles, each initially containing a single pebble. One can perform moves of the following form: choose two piles, take an equal number of pebbles from each pile and form a new pile out of these pebbles. For each positive integer \\(n\\), find the smallest number of non-empty piles that one can obtain by performing a finite sequence of moves of this form.\n(Croatia)", "solution": "Answer: 1 if \\(n\\) is a power of two, and 2 otherwise.\n\n1. The solution we describe is simple, but not the most effective one.\nWe can combine two piles of \\(2^{k-1}\\) pebbles to make one pile of \\(2^{k}\\) pebbles. In particular, given \\(2^{k}\\) piles of one pebble, we may combine them as follows:\n\\[\n\\begin{array}{lll}\n2^{k} \\text { piles of } 1 \\text { pebble } & \\rightarrow & 2^{k-1} \\text { piles of } 2 \\text { pebbles } \\\\\n2^{k-1} \\text { piles of } 2 \\text { pebbles } & \\rightarrow & 2^{k-2} \\text { piles of } 4 \\text { pebbles } \\\\\n2^{k-2} \\text { piles of } 4 \\text { pebbles } & \\rightarrow & 2^{k-3} \\text { piles of } 8 \\text { pebbles } \\\\\n& \\vdots & \\\\\n2 \\text { piles of } 2^{k-1} \\text { pebbles } & \\rightarrow & 1 \\text { pile of } 2^{k} \\text { pebbles }\n\\end{array}\n\\]\n\nThis proves the desired result in the case when \\(n\\) is a power of 2 .\nIf \\(n\\) is not a power of 2 , choose \\(N\\) such that \\(2^{N}<n<2^{N+1}\\). Let \\(m=n-2^{N}\\). Then \\(0<m<2^{N}\\). Make a pile of \\(2^{N}\\) pebbles and call it the large pile. (Alternatively, one can be more efficient and make a pile of \\(2^{M}\\) pebbles where \\(m \\leqslant 2^{M}\\).) Since \\(n\\) is not a power of two, there is at least one other pile with pebbles. All other piles have a single pebble (initial condition).\n\nChoose one single pebble pile and remove the pebble and one pebble from the large pile and form a pile of 2 pebbles. If \\(m<2^{N}-1\\), remove another pebble from the large pile and one pebble from the 2 -pile and form a new pile of 2 pebbles. Repeat until the large pile contains exactly \\(m\\) pebbles.\n\nAt this point we have one pile of \\(m\\) pebbles, one pile of 2 pebbles, and the rest are single pebble piles. There must be \\(n-m-2=2^{N}-2\\) single piles. Combine two and two into piles of two pebbles. Then there are \\(2^{N-1}\\) piles of two pebbles, which we can make into one pile of \\(2^{N}\\) pebbles. We are left with exactly two piles of pebbles.\n\nLastly we will prove that it is not possible to form a single pile with all pebbles when \\(n\\) is not a power of two. A move consists of choosing two piles of say \\(a\\) and \\(b\\) pebbles, then removing \\(c \\leqslant \\min (a, b)\\) pebbles from both piles, and forming a new pile with \\(2 c\\) pebbles. If we include piles of zero pebbles, then this move changes the number of pebbles in three piles as follows (and leaves all other piles unchanged):\n\\[\n\\begin{array}{ccc}\na & \\rightarrow & a-c \\\\\nb & \\rightarrow & b-c \\\\\n0 & \\rightarrow & 2 c\n\\end{array}\n\\]\n\nAssume that after the move the number of pebbles in each pile is divisible by an odd integer \\(m\\). In particular, \\(m|2 c, m| a-c\\) and \\(m \\mid b-c\\). Since \\(m\\) is odd, it follows that \\(m \\mid c\\), and then that \\(m \\mid a\\) and \\(m \\mid b\\). Hence also before the move the number of pebbles in each pile is divisible by the integer \\(m\\).\n\nIf \\(n\\) is not a power of 2 , then \\(n\\) is divisible by an odd integer \\(m>1\\). In order to make a single pile of \\(n\\) pebbles, we would have to start with a distribution in which the number of pebbles in each pile is divisible by the integer \\(m\\). This is impossible when we start with all piles containing a single pebble.\n\nRemarks on starting configurations From any starting configuration that is not a single pile, if there are at least two piles with at least two pebbles, we can remove one pebble from two such piles, and form a new pile with 2 pebbles. We can repeat this until we have one pile of 2 pebbles and the rest are single pebble piles, and then proceed as in the solution. Hence, if \\(n\\) is a power of two, we can make a single pile from any starting configuration.\n\nIf \\(n\\) is of the form \\(n=2^{k} m\\) where \\(m>1\\) is odd, then we can make a single pile from any starting configuration in which the number of pebbles in each pile is divisible by the integer \\(m\\), otherwise two piles is the best we can do. Half of this is proven already. For the other half, assume we start with a configuration in which the number of pebbles in each pile is divisible by the integer \\(m\\). Replace each pile of \\(t m\\) pebbles with a pile of \\(t\\) boulders. We now have a total of \\(2^{k}\\) boulders, hence we can make them into one pile of \\(2^{k}\\) boulders. Replacing the boulders with pebbles again, we are done.\n\nSolution 2. We show an alternative strategy if \\(n\\) is not a power of 2 . Write \\(n\\) in binary form: \\(n=2^{i_{1}}+2^{i_{2}}+\\cdots+2^{i_{k}}\\), where \\(i_{1}>i_{2}>\\cdots>i_{k}\\). Now we make piles of sizes \\(2^{i_{1}}, 2^{i_{2}}, \\ldots, 2^{i_{k}}\\). We call the pile with \\(2^{i_{1}}\\) the large pile, all the others are the small piles.\n\nThe strategy is the following: take the two smallest small pile. If they have the same size of \\(2^{a}\\), we make a pile of size \\(2^{a+1}\\). If they have different sizes, we double the smaller pile using the large pile (we allow the large pile to have a negative number of pebbles: later we prove that it is not possible). We call all the new piles small. When we have only one small pile, we terminate the process: we have at most 2 piles.\n\nAfter each move we have one less number of piles, and all the piles have cardinality power of 2. The number of pebbles is decreasing, and at the end of the process, it has a size of \\(n-2^{i_{2}+1} \\geqslant n-2^{i_{1}}>0\\), thus we can manage to have two piles.\n\nSolution 3. Throughout the solution, we will consider the moves in reverse order. Namely, imagine we have some piles of pebbles, and we are allowed to perform moves as follows: take a pile with an even number of pebbles, split it into two equal halves and add the pebbles from each half to a different pile, possibly forming new piles (we may assume for convenience that there are infinitely many empty piles at any given moment). Given a configuration of piles \\(\\mathcal{C}\\), we will use \\(|\\mathcal{C}|\\) to denote the number of non-empty piles in \\(\\mathcal{C}\\). Given two configurations \\(\\mathcal{C}_{1}, \\mathcal{C}_{2}\\), we will say that \\(\\mathcal{C}_{2}\\) is reachable from \\(\\mathcal{C}_{1}\\) if \\(\\mathcal{C}_{2}\\) can be obtained by performing a finite sequence of moves starting from \\(\\mathcal{C}_{1}\\). Call a configuration of piles \\(\\mathcal{C}\\)\n- simple if each (non-empty) pile in \\(\\mathcal{C}\\) consists of a single pebble;\n- good if at least one (non-empty) pile in \\(\\mathcal{C}\\) has an even number of pebbles and the numbers of pebbles on the piles in \\(\\mathcal{C}\\) have no non-trivial odd common divisor ( \\(\\mathcal{C}\\) has the odd divisor property);\n- solvable if there exists a simple configuration which is reachable from \\(\\mathcal{C}\\).\n\nThe problem asks to find the smallest number of non-empty piles in a solvable configuration consisting of \\(n\\) pebbles. We begin the process of answering this question by making the following observation:\nLemma 1. Let \\(\\mathcal{C}\\) be a configuration of piles. Let \\(\\mathcal{C}^{\\prime}\\) be a configuration obtained by applying a single move to \\(\\mathcal{C}\\). Then\n(i) if \\(\\mathcal{C}^{\\prime}\\) has the odd divisor property, then so does \\(\\mathcal{C}\\);\n(ii) the converse to (i) holds if \\(\\left|\\mathcal{C}^{\\prime}\\right| \\geqslant|\\mathcal{C}|\\).\n\nProof. Suppose that the move consists of splitting a pile of size \\(2 a\\) and adding \\(a\\) pebbles to each of two piles of sizes \\(b\\) and \\(c\\). Here, \\(a\\) is a positive integer and \\(b, c\\) are non-negative integers. Thus, \\(\\mathcal{C}^{\\prime}\\) can be obtained from \\(\\mathcal{C}\\) by replacing the piles of sizes \\(2 a, b, c\\) by two piles of sizes \\(a+b\\) and \\(a+c\\). Note that the extra assumption \\(\\left|\\mathcal{C}^{\\prime}\\right| \\geqslant|\\mathcal{C}|\\) of part (ii) holds if and only if at least one of \\(b, c\\) is zero.\n(i) Suppose \\(\\mathcal{C}\\) doesn't have the odd divisor property, i.e. there exists an odd integer \\(d>1\\) such that the size of each pile in \\(\\mathcal{C}\\) is divisible by \\(d\\). In particular, \\(2 a, b, c\\) are multiples of \\(d\\), so since \\(d\\) is odd, it follows that \\(a, b, c\\) are all divisible by \\(d\\). Thus, \\(a+b\\) and \\(a+c\\) are also divisible by \\(d\\), so \\(d\\) divides the size of each pile in \\(\\mathcal{C}^{\\prime}\\). In conclusion, \\(\\mathcal{C}^{\\prime}\\) doesn't have the odd divisor property.\n(ii) If \\(\\mathcal{C}^{\\prime}\\) doesn't have the odd divisor property and at least one of \\(b, c\\) is zero, then there exists an odd integer \\(d>1\\) such that the size of each pile in \\(\\mathcal{C}^{\\prime}\\) is divisible by \\(d\\). In particular, \\(d\\) divides \\(a+b\\) and \\(a+c\\), so since at least one of these numbers is equal to \\(a\\), it follows that \\(d\\) divides \\(a\\). But then \\(d\\) must divide all three of \\(a, b\\) and \\(c\\), and hence it certainly divides \\(2 a, b\\) and \\(c\\). Thus, \\(\\mathcal{C}\\) doesn't have the odd divisor property, as desired.\nLemma 2. If \\(\\mathcal{C}_{2}\\) is reachable from \\(\\mathcal{C}_{1}\\) and \\(\\mathcal{C}_{2}\\) has the odd divisor property, then so does \\(\\mathcal{C}_{1}\\). In particular, any solvable configuration has the odd divisor property.\nProof. The first statement follows by inductively applying part (i) of Lemma 1. The second statement follows from the first because every simple configuration has the odd divisor property.\n\nThe main claim is the following:\nLemma 3. Let \\(\\mathcal{C}\\) be a good configuration. Then there exists a configuration \\(\\mathcal{C}^{\\prime}\\) with the following properties:\n- \\(\\mathcal{C}^{\\prime}\\) is reachable from \\(\\mathcal{C}\\) and \\(\\left|\\mathcal{C}^{\\prime}\\right|>|\\mathcal{C}| ;\\)\n- \\(\\mathcal{C}^{\\prime}\\) is either simple or good.\n\nProof. Call a configuration terminal if it is a counterexample to the claim. The following claim is at the heart of the proof:\nClaim. Let \\(a_{1}, \\ldots, a_{k}\\) be the numbers of pebbles on the non-empty piles of a terminal configuration \\(\\mathcal{C}\\). Then there exists a unique \\(i \\in[k]\\) such that \\(a_{i}\\) is even. Moreover, for all \\(t \\geqslant 1\\) we have \\(a_{j} \\equiv \\frac{a_{i}}{2}\\left(\\bmod 2^{t}\\right)\\) for all \\(j \\neq i\\).\nProof of Claim. Since the configuration is good, there must exist \\(i \\in[k]\\) such that \\(a_{i}\\) is even. Moreover, by assumption, if we split the pile with \\(a_{i}\\) pebbles into two equal halves, the resulting configuration will not be good. By part (ii) of Lemma 2 ,the only way this can happen is that \\(\\frac{a_{i}}{2}\\) and \\(a_{j}\\) for all \\(j \\neq i\\) are odd. To prove the second assertion, we proceed by induction on \\(t\\), with the case \\(t=1\\) already being established. If \\(t \\geqslant 2\\), then split the pile with \\(a_{i}\\) pebbles into two equal halves and move one half to the pile with \\(a_{j}\\) pebbles. Since \\(\\frac{a_{i}}{2}\\) and \\(a_{j}\\) are both odd, \\(a_{j}+\\frac{a_{i}}{2}\\) is even, so by part (ii) of Lemma 2, the resulting configuration \\(\\mathcal{C}^{\\prime}\\) is good. Thus, \\(\\mathcal{C}^{\\prime}\\) is terminal, so by the induction hypothesis, we have \\(\\frac{a_{i}}{2} \\equiv \\frac{1}{2}\\left(a_{j}+\\frac{a_{i}}{2}\\right)\\left(\\bmod 2^{t-1}\\right)\\), whence \\(a_{j} \\equiv \\frac{a_{i}}{2}( \\bmod 2^{t}\\) ), as desired.\n\nSuppose for contradiction that there exists a configuration as in the Claim. It follows that there exists \\(i \\in[k]\\) and an odd integer \\(x\\) such that \\(a_{i}=2 x\\) and \\(a_{j}=x\\) for all \\(j \\neq i\\). Thus, \\(x\\) is an odd common divisor of \\(a_{1}, \\ldots, a_{k}\\), so by the odd divisor property, we must have \\(x=1\\). But then we can obtain a simple configuration by splitting the only pile with two pebbles into two piles each consisting of a single pebble, which is a contradiction.\n\nWith the aid of Lemmas 2 and 3, it is not hard to characterise all solvable configurations: Lemma 4. A configuration of piles \\(\\mathcal{C}\\) is solvable if and only if it is simple or good.\n\nProof. ( \\(\\Longrightarrow\\) ) Suppose \\(\\mathcal{C}\\) is not simple. Then since we have to be able to perform at least one move, there must be at least one non-empty pile in \\(\\mathcal{C}\\) with an even number of pebbles. Moreover, by Lemma \\(2, \\mathcal{C}\\) has the odd divisor property, so it must be good.\n\\((\\Longleftarrow)\\) This follows by repeatedly applying Lemma 3 until we reach a simple configuration. Note that the process must stop eventually since the number of non-empty piles is bounded from above.\n\nFinally, the answer to the problem is implied by the following corollary of Lemma 4: Lemma 5. Let \\(n\\) be a positive integer. Then\n(i) a configuration consisting of a single pile of \\(n\\) pebbles is solvable if and only if \\(n\\) is a power of two;\n(ii) if \\(n \\geqslant 2\\), then the configuration consisting of piles of sizes 2 and \\(n-2\\) is good.\n\nProof. (i) By Lemma 4, this configuration is solvable if and only if either \\(n=1\\) or \\(n\\) is even and has no non-trivial odd divisor, so the conclusion follows.\n(ii) Since 2 is even and has no non-trivial odd divisor, this configuration is certainly good, so the conclusion follows by Lemma 4.\n\nCommon remarks. Instead of choosing pebbles from two piles, one could allow choosing an equal number of pebbles from each of \\(k\\) piles, where \\(k \\geqslant 2\\) is a fixed (prime) integer. However, this seems to yield a much harder problem - if \\(k=3\\), numerical evidence suggests the same answer as in the case \\(k=2\\) (with powers of two replaced by powers of three), but the case \\(k=5\\) is already unclear.", "source_pdf": "imosl_2022.pdf", "notes": "fallback-regex"}
{"id": "IMOSL-2022-C7", "contest": "IMOSL", "year": "2022", "problem_number": "C7", "problem": "Lucy starts by writing \\(s\\) integer-valued 2022-tuples on a blackboard. After doing that, she can take any two (not necessarily distinct) tuples \\(\\mathbf{v}=\\left(v_{1}, \\ldots, v_{2022}\\right)\\) and \\(\\mathbf{w}=\\left(w_{1}, \\ldots, w_{2022}\\right)\\) that she has already written, and apply one of the following operations to obtain a new tuple:\n\\[\n\\begin{aligned}\n& \\mathbf{v}+\\mathbf{w}=\\left(v_{1}+w_{1}, \\ldots, v_{2022}+w_{2022}\\right) \\\\\n& \\mathbf{v} \\vee \\mathbf{w}=\\left(\\max \\left(v_{1}, w_{1}\\right), \\ldots, \\max \\left(v_{2022}, w_{2022}\\right)\\right)\n\\end{aligned}\n\\]\nand then write this tuple on the blackboard.\nIt turns out that, in this way, Lucy can write any integer-valued 2022-tuple on the blackboard after finitely many steps. What is the smallest possible number \\(s\\) of tuples that she initially wrote?\n(Czech Republic)", "solution": "Answer: The smallest possible number is \\(s=3\\).\n\n. We solve the problem for \\(n\\)-tuples for any \\(n \\geqslant 3\\) : we will show that the answer is \\(s=3\\), regardless of the value of \\(n\\).\n\nFirst, let us briefly introduce some notation. For an \\(n\\)-tuple \\(\\mathbf{v}\\), we will write \\(\\mathbf{v}_{i}\\) for its \\(i\\)-th coordinate (where \\(1 \\leqslant i \\leqslant n\\) ). For a positive integer \\(n\\) and a tuple \\(\\mathbf{v}\\) we will denote by \\(n \\cdot \\mathbf{v}\\) the tuple obtained by applying addition on \\(\\mathbf{v}\\) with itself \\(n\\) times. Furthermore, we denote by \\(\\mathbf{e}(i)\\) the tuple which has \\(i\\)-th coordinate equal to one and all the other coordinates equal to zero. We say that a tuple is positive if all its coordinates are positive, and negative if all its coordinates are negative.\n\nWe will show that three tuples suffice, and then that two tuples do not suffice.\n\nThree tuples suffice. Write \\(\\mathbf{c}\\) for the constant-valued tuple \\(\\mathbf{c}=(-1, \\ldots,-1)\\).\nWe note that it is enough for Lucy to be able to make the tuples \\(\\mathbf{e}(1), \\ldots, \\mathbf{e}(n), \\mathbf{c}\\); from those any other tuple \\(\\mathbf{v}\\) can be made as follows. First we choose some positive integer \\(k\\) such that \\(k+\\mathbf{v}_{i}>0\\) for all \\(i\\). Then, by adding a positive number of copies of \\(\\mathbf{c}, \\mathbf{e}(1), \\ldots, \\mathbf{e}(n)\\), she can make\n\\[\nk \\mathbf{c}+\\left(k+\\mathbf{v}_{1}\\right) \\cdot \\mathbf{e}(1)+\\cdots+\\left(k+\\mathbf{v}_{n}\\right) \\cdot \\mathbf{e}(n)\n\\]\nwhich we claim is equal to \\(\\mathbf{v}\\). Indeed, this can be checked by comparing coordinates: the \\(i\\)-th coordinate of the right-hand side is \\(-k+\\left(k+\\mathbf{v}_{i}\\right)=\\mathbf{v}_{i}\\) as needed.\n\nLucy can take her three starting tuples to be \\(\\mathbf{a}, \\mathbf{b}\\) and \\(\\mathbf{c}\\), such that \\(\\mathbf{a}_{i}=-i^{2}, \\mathbf{b}_{i}=i\\) and \\(\\mathbf{c}=-1\\) (as above).\n\nFor any \\(1 \\leqslant j \\leqslant n\\), write \\(\\mathbf{d}(j)\\) for the tuple \\(2 \\cdot \\mathbf{a}+4 j \\cdot \\mathbf{b}+\\left(2 j^{2}-1\\right) \\cdot \\mathbf{c}\\), which Lucy can make by adding together \\(\\mathbf{a}, \\mathbf{b}\\) and \\(\\mathbf{c}\\) repeatedly. This has \\(i\\) th term\n\\[\n\\begin{aligned}\n\\mathbf{d}(j)_{i} & =2 \\mathbf{a}_{i}+4 j \\mathbf{b}_{i}+\\left(2 j^{2}-1\\right) \\mathbf{c}_{i} \\\\\n& =-2 i^{2}+4 i j-\\left(2 j^{2}-1\\right) \\\\\n& =1-2(i-j)^{2}\n\\end{aligned}\n\\]\n\nThis is 1 if \\(j=i\\), and at most -1 otherwise. Hence Lucy can produce the tuple \\(\\mathbf{1}=(1, \\ldots, 1)\\) as \\(\\mathbf{d}(1) \\vee \\cdots \\vee \\mathbf{d}(n)\\).\n\nShe can then produce the constant tuple \\(\\mathbf{0}=(0, \\ldots, 0)\\) as \\(\\mathbf{1}+\\mathbf{c}\\), and for any \\(1 \\leqslant j \\leqslant n\\) she can then produce the tuple \\(\\mathbf{e}(j)\\) as \\(\\mathbf{d}(j) \\vee \\mathbf{0}\\). Since she can now produce \\(\\mathbf{e}(1), \\ldots, \\mathbf{e}(n)\\) and already had \\(\\mathbf{c}\\), she can (as we argued earlier) produce any integer-valued tuple.\n\nTwo tuples do not suffice. We start with an observation: Let \\(a\\) be a non-negative real number and suppose that two tuples \\(\\mathbf{v}\\) and \\(\\mathbf{w}\\) satisfy \\(\\mathbf{v}_{j} \\geqslant a \\mathbf{v}_{k}\\) and \\(\\mathbf{w}_{j} \\geqslant a \\mathbf{w}_{k}\\) for some \\(1 \\leqslant j, k \\leqslant n\\). Then we claim that the same inequality holds for \\(\\mathbf{v}+\\mathbf{w}\\) and \\(\\mathbf{v} \\vee \\mathbf{w}\\) : Indeed, the property for the sum is verified by an easy computation:\n\\[\n(\\mathbf{v}+\\mathbf{w})_{j}=\\mathbf{v}_{j}+\\mathbf{w}_{j} \\geqslant a \\mathbf{v}_{k}+a \\mathbf{w}_{k}=a(\\mathbf{v}+\\mathbf{w})_{k}\n\\]\n\nFor the second operation, we denote by \\(\\mathbf{m}\\) the tuple \\(\\mathbf{v} \\vee \\mathbf{w}\\). Then \\(\\mathbf{m}_{j} \\geqslant \\mathbf{v}_{j} \\geqslant a \\mathbf{v}_{k}\\) and \\(\\mathbf{m}_{j} \\geqslant \\mathbf{w}_{j} \\geqslant a \\mathbf{w}_{k}\\). Since \\(\\mathbf{m}_{k}=\\mathbf{v}_{k}\\) or \\(\\mathbf{m}_{k}=\\mathbf{w}_{k}\\), the observation follows.\n\nAs a consequence of this observation we have that if all starting tuples satisfy such an inequality, then all generated tuples will also satisfy it, and so we would not be able to obtain every integer-valued tuple.\n\nLet us now prove that Lucy needs at least three starting tuples. For contradiction, let us suppose that Lucy started with only two tuples \\(\\mathbf{v}\\) and \\(\\mathbf{w}\\). We are going to distinguish two cases. In the first case, suppose we can find a coordinate \\(i\\) such that \\(\\mathbf{v}_{i}, \\mathbf{w}_{i} \\geqslant 0\\). Both operations preserve the sign, thus we can not generate any tuple that has negative \\(i\\)-th coordinate. Similarly for \\(\\mathbf{v}_{i}, \\mathbf{w}_{i} \\leqslant 0\\).\n\nSuppose the opposite, i.e., for every \\(i\\) we have either \\(\\mathbf{v}_{i}>0>\\mathbf{w}_{i}\\), or \\(\\mathbf{v}_{i}<0<\\mathbf{w}_{i}\\). Since we assumed that our tuples have at least three coordinates, by pigeonhole principle there exist two coordinates \\(j \\neq k\\) such that \\(\\mathbf{v}_{j}\\) has the same sign as \\(\\mathbf{v}_{k}\\) and \\(\\mathbf{w}_{j}\\) has the same sign as \\(\\mathbf{w}_{k}\\) (because there are only two possible combinations of signs).\n\nWithout loss of generality assume that \\(\\mathbf{v}_{j}, \\mathbf{v}_{k}>0\\) and \\(\\mathbf{w}_{j}, \\mathbf{w}_{k}<0\\). Let us denote the positive real number \\(\\mathbf{v}_{j} / \\mathbf{v}_{k}\\) by \\(a\\). If \\(\\mathbf{w}_{j} / \\mathbf{w}_{k} \\leqslant a\\), then both inequalities \\(\\mathbf{v}_{j} \\geqslant a \\mathbf{v}_{k}\\) and \\(\\mathbf{w}_{j} \\geqslant a \\mathbf{w}_{k}\\) are satisfied. On the other hand, if \\(\\mathbf{w}_{j} / \\mathbf{w}_{k} \\leqslant a\\), then both \\(\\mathbf{v}_{k} \\geqslant(1 / a) \\mathbf{v}_{j}\\) and \\(\\mathbf{w}_{k} \\geqslant(1 / a) \\mathbf{w}_{j}\\) are satisfied. In either case, we have found the desired inequality satisfied by both starting tuples, a contradiction with the observation above.\n\n\\section*{Common remarks.}\n1. For \\(n \\in\\{1,2\\}\\), two starting \\(n\\)-tuples are necessary and sufficient.\n2. The operations,\\(+ \\vee\\) used in this problem are studied in the area of tropical geometry. However, as far as we know, familiarity with tropical geometry does not help when solving the problem.\n\n\\section*{C8.}\n\nAlice fills the fields of an \\(n \\times n\\) board with numbers from 1 to \\(n^{2}\\), each number being used exactly once. She then counts the total number of good paths on the board. \\(A\\) good path is a sequence of fields of arbitrary length (including 1) such that:\n(i) The first field in the sequence is one that is only adjacent to fields with larger numbers,\n(ii) Each subsequent field in the sequence is adjacent to the previous field,\n(iii) The numbers written on the fields in the sequence are in increasing order.\n\nTwo fields are considered adjacent if they share a common side. Find the smallest possible number of good paths Alice can obtain, as a function of \\(n\\).\n(Serbia)\nAnswer: \\(2 n^{2}-2 n+1\\).\n\n\\section*{Solution.}\n\nWe will call any field that is only adjacent to fields with larger numbers a well. Other fields will be called non-wells. Let us make a second \\(n \\times n\\) board \\(B\\) where in each field we will write the number of good sequences which end on the corresponding field in the original board \\(A\\). We will thus look for the minimal possible value of the sum of all entries in \\(B\\).\n\nWe note that any well has just one good path ending in it, consisting of just the well, and that any other field has the number of good paths ending in it equal to the sum of this quantity for all the adjacent fields with smaller values, since a good path can only come into the field from a field of lower value. Therefore, if we fill in the fields in \\(B\\) in increasing order with respect to their values in \\(A\\), it follows that each field not adjacent to any already filled field will receive a 1, while each field adjacent to already filled fields will receive the sum of the numbers already written on these adjacent fields.\n\nWe note that there is at least one well in \\(A\\), that corresponding with the field with the entry 1 in \\(A\\). Hence, the sum of values of fields in \\(B\\) corresponding to wells in \\(A\\) is at least 1 . We will now try to minimize the sum of the non-well entries, i.e. of the entries in \\(B\\) corresponding to the non-wells in \\(A\\). We note that we can ascribe to each pair of adjacent fields the value of the lower assigned number and that the sum of non-well entries will then equal to the sum of the ascribed numbers. Since the lower number is still at least 1 , the sum of non-well entries will at least equal the number of pairs of adjacent fields, which is \\(2 n(n-1)\\). Hence, the total minimum sum of entries in \\(B\\) is at least \\(2 n(n-1)+1=2 n^{2}-2 n+1\\). The necessary conditions for the minimum to be achieved is for there to be only one well and for no two entries in \\(B\\) larger than 1 to be adjacent to each other.\n\nWe will now prove that the lower limit of \\(2 n^{2}-2 n+1\\) entries can be achieved. This amounts to finding a way of marking a certain set of squares, those that have a value of 1 in \\(B\\), such that no two unmarked squares are adjacent and that the marked squares form a connected tree with respect to adjacency.\n\nFor \\(n=1\\) and \\(n=2\\) the markings are respectively the lone field and the L-trimino. Now, for \\(n>2\\), let \\(s=2\\) for \\(n \\equiv 0,2 \\bmod 3\\) and \\(s=1\\) for \\(n \\equiv 1 \\bmod 3\\). We will take indices \\(k\\) and \\(l\\) to be arbitrary non-negative integers. For \\(n \\geqslant 3\\) we will construct a path of marked squares in the first two columns consisting of all squares of the form \\((1, i)\\) where \\(i\\) is not of the form \\(6 k+s\\) and \\((2, j)\\) where \\(j\\) is of the form \\(6 k+s-1,6 k+s\\) or \\(6+s+1\\). Obviously, this path is connected. Now, let us consider the fields \\((2,6 k+s)\\) and \\((1,6 k+s+3)\\). For each considered field \\((i, j)\\) we will mark all squares of the form \\((l, j)\\) for \\(l>i\\) and \\((i+2 k, j \\pm 1)\\). One can easily see that no set of marked fields will produce a cycle, that the only fields of the unmarked form \\((1,6 k+s),(2+2 l+1,6 k+s \\pm 1)\\) and \\((2+2 l, 6 k+s+3 \\pm 1)\\) and that no two are adjacent, since\nthe consecutive considered fields are in columns of opposite parity. Examples of markings are given for \\(n=3,4,5,6,7\\), and the corresponding constructions for \\(A\\) and \\(B\\) are given for \\(n=5\\).\n![](https://cdn.mathpix.com/cropped/2025_08_23_bba1c16f961fdd6f4eb4g-41.jpg?height=335&width=1160&top_left_y=388&top_left_x=217)\n\\(n=5:\\)\n\n\\(A: ~\\)\n\\begin{tabular}{|c|c|c|c|c|}\n\\hline 12 & 13 & 14 & 15 & 16 \\\\\n\\hline 11 & 24 & 17 & 25 & 18 \\\\\n\\hline 10 & 9 & 22 & 8 & 23 \\\\\n\\hline 21 & 3 & 4 & 5 & 6 \\\\\n\\hline 1 & 2 & 19 & 7 & 20 \\\\\n\\hline\n\\end{tabular}\n\n\\(B: ~\\)\n\\begin{tabular}{|l|l|l|l|l|}\n\\hline 1 & 1 & 1 & 1 & 1 \\\\\n\\hline 1 & 4 & 1 & 4 & 1 \\\\\n\\hline 1 & 1 & 4 & 1 & 3 \\\\\n\\hline 3 & 1 & 1 & 1 & 1 \\\\\n\\hline 1 & 1 & 3 & 1 & 2 \\\\\n\\hline\n\\end{tabular}\n\n\\section*{Common remarks.}\n- The construction can be achieved in different ways. For example, it can also be done recursively; we can complete any construction for \\(n\\) to a construction for \\(n+1\\).\n- It is a natural idea to change the direction of the path: that way it can start anywhere, but only can end in a well, which exactly means that we cannot extend the path. This is just a reformulation of the problem, but can give some intuitions.", "source_pdf": "imosl_2022.pdf", "notes": "fallback-regex"}
{"id": "IMOSL-2022-C9", "contest": "IMOSL", "year": "2022", "problem_number": "C9", "problem": "Let \\(\\mathbb{Z}_{\\geqslant 0}\\) be the set of non-negative integers, and let \\(f: \\mathbb{Z}_{\\geqslant 0} \\times \\mathbb{Z}_{\\geqslant 0} \\rightarrow \\mathbb{Z}_{\\geqslant 0}\\) be a bijection such that whenever \\(f\\left(x_{1}, y_{1}\\right)>f\\left(x_{2}, y_{2}\\right)\\), we have \\(f\\left(x_{1}+1, y_{1}\\right)>f\\left(x_{2}+1, y_{2}\\right)\\) and \\(f\\left(x_{1}, y_{1}+1\\right)>f\\left(x_{2}, y_{2}+1\\right)\\).\n\nLet \\(N\\) be the number of pairs of integers ( \\(x, y\\) ), with \\(0 \\leqslant x, y<100\\), such that \\(f(x, y)\\) is odd. Find the smallest and largest possible value of \\(N\\).", "solution": "Answer: The optimal bounds are \\(2500 \\leqslant N \\leqslant 7500\\).\n\n. We defer the constructions to the end of the solution. Instead, we begin by characterizing all such functions \\(f\\), prove a formula and key property for such functions, and then solve the problem, providing constructions.\n\nCharacterization Suppose \\(f\\) satisfies the given relation. The condition can be written more strongly as\n\\[\n\\begin{aligned}\nf\\left(x_{1}, y_{1}\\right)>f\\left(x_{2}, y_{2}\\right) & \\Longleftrightarrow f\\left(x_{1}+1, y_{1}\\right)>f\\left(x_{2}+1, y_{2}\\right) \\\\\n& \\Longleftrightarrow f\\left(x_{1}, y_{1}+1\\right)>f\\left(x_{2}, y_{2}+1\\right) .\n\\end{aligned}\n\\]\n\nIn particular, this means for any \\((k, l) \\in \\mathbb{Z}^{2}, f(x+k, y+l)-f(x, y)\\) has the same sign for all \\(x\\) and \\(y\\).\n\nCall a non-zero vector \\((k, l) \\in \\mathbb{Z}_{\\geqslant 0} \\times \\mathbb{Z}_{\\geqslant 0}\\) a needle if \\(f(x+k, y)-f(x, y+l)>0\\) for all \\(x\\) and \\(y\\). It is not hard to see that needles and non-needles are both closed under addition, and thus under scalar division (whenever the quotient lives in \\(\\mathbb{Z}^{2}\\) ).\n\nIn addition, call a positive rational number \\(\\frac{k}{l}\\) a grade if the vector \\((k, l)\\) is a needle. (Since needles are closed under scalar multiples and quotients, this is well-defined.)\nClaim. Grades are closed upwards.\nProof. Consider positive rationals \\(k_{1} / l_{1}<k_{2} / l_{2}\\) with \\(k_{1} / l_{1}\\) a grade. Then:\n- \\(\\left(k_{1}, l_{1}\\right)\\) is a needle\n- so \\(\\left(k_{1} l_{2}, l_{1} l_{2}\\right)\\) is a needle,\n- so \\(\\left(k_{2} l_{1}, l_{1} l_{2}\\right)\\) is a needle (as \\(k_{2} l_{1}-k_{1} l_{2}>0\\) and \\((1,0)\\) is a needle).\n\nThus ( \\(k_{2}, l_{2}\\) ) is a needle, as wanted.\nClaim. A grade exists.\nProof. If no positive integer \\(n\\) is a grade, then \\(f(1,0)>f(0, n)\\) for all \\(n\\) which is impossible.\n\nSimilarly, there is an \\(n\\) such that \\(f(0,1)<f(n, 0)\\), thus \\(1 / n\\) is not a grade for some large \\(n\\). That means that small positive rational values are not grades, then there is a switch, and after that all values are grades. Call the place of that switch \\(\\alpha\\). Here \\(\\alpha\\) is the infimum of the grades.\nClaim (Key property). If \\(x_{1}+y_{1} \\alpha>x_{2}+y_{2} \\alpha\\) then \\(f\\left(x_{1}, y_{1}\\right)>f\\left(x_{2}, y_{2}\\right)\\).\nProof. If both \\(x_{1} \\geqslant x_{2}\\) and \\(y_{1} \\geqslant y_{2}\\) this is clear.\nSuppose \\(x_{1} \\geqslant x_{2}\\) and \\(y_{1}<y_{2}\\). Then \\(\\frac{x_{1}-x_{2}}{y_{2}-y_{1}}>\\alpha\\) is a grade. This gives \\(f\\left(x_{1}, y_{1}\\right)>f\\left(x_{2}, y_{2}\\right)\\). Suppose \\(x_{1}<x_{2}\\) and \\(y_{1} \\geqslant y_{2}\\). Then \\(\\frac{x_{2}-x_{1}}{u_{1}-u_{2}}<\\alpha\\) is not a grade. This gives \\(f\\left(x_{2}, y_{2}\\right)<f\\left(x_{1}, y_{1}\\right)\\).\n\nFrom those observations we get the following claim.\nClaim. The function \\(f\\) orders pairs ( \\(x, y\\) ) based on the value of \\(x+y \\alpha\\). If \\(\\alpha\\) is rational, tiebreaking is done by larger \\(x\\) - or \\(y\\)-coordinate (depending on whether \\(\\alpha\\) is a grade).\n\nWe can imagine this the following way: take a line with slope \\(-\\frac{1}{\\alpha}\\) under the first quadrant of the plane. And we start to move this line upward (but it stays parallel to the original line). First it hits \\((0,0)\\), so \\(f(0,0)=0\\). And each time the line hits a point \\(p, f(p)\\) is the number of points hit before. If \\(\\alpha \\in \\mathbb{Q}\\), it is possible that the line hits multiple points. Then those points are ordered the same way as their \\(x\\) or \\(y\\) coordinates, depending on whether \\(\\alpha\\) is a grade.\n\nWe understood the behaviour of \\(f\\), now we need to focus on the region of \\(A=\\{(x, y) \\in \\left.\\mathbb{Z}_{\\geqslant 0} \\times \\mathbb{Z}_{\\geqslant 0} \\mid x<100, y<100\\right\\}\\). First, we can assume that \\(\\alpha\\) is irrational. If we change it a little bit in the right direction, the behaviour and values of the \\(f\\) function does not change in \\(A\\). Claim.\n\\[\nf(x, y)+f(x+1, y+1)=f(x+1, y)+f(x, y+1)+1 .\n\\]\n\nProof.\n\\[\n\\begin{gathered}\nf(x+1, y+1)-f(x, y+1)= \\\\\n\\#\\left\\{(a, b) \\in \\mathbb{Z}_{\\geqslant 0} \\times \\mathbb{Z}_{\\geqslant 0} \\mid x+(y+1) \\alpha \\leqslant a+b \\alpha<(x+1)+(y+1) \\alpha\\right\\}= \\\\\n\\#\\left\\{(a, b) \\in \\mathbb{Z}_{\\geqslant 0} \\times \\mathbb{Z}_{>0} \\mid x+(y+1) \\alpha \\leqslant a+b \\alpha<(x+1)+(y+1) \\alpha\\right\\}+ \\\\\n\\#\\left\\{(a, 0) \\in \\mathbb{Z}_{\\geqslant 0} \\times \\mathbb{Z}_{\\geqslant 0} \\mid(x+1)+y \\alpha \\leqslant a<(x+1)+(y+1) \\alpha\\right\\}= \\\\\n\\#\\left\\{(a, b) \\in \\mathbb{Z}_{\\geqslant 0} \\times \\mathbb{Z}_{\\geqslant 0} \\mid x+y \\alpha \\leqslant a+b \\alpha<(x+1)+y \\alpha\\right\\}+1=f(x+1, y)-f(x, y) .\n\\end{gathered}\n\\]\n\nFrom this claim we immediately get that \\(2500 \\leqslant N \\leqslant 7500\\); now we show that those bounds are indeed sharp.\n\nRemember that if \\(\\alpha\\) is irrational then\n\\[\nf(a, b)=\\#\\left\\{(x, y) \\in \\mathbb{Z}_{\\geqslant 0} \\times \\mathbb{Z}_{\\geqslant 0} \\mid x+y \\alpha<a+b \\alpha\\right\\} .\n\\]\n\nConstruction for 7500 Select \\(\\alpha \\approx 199.999\\).\nClaim.\n1. \\(f(n, 0)=n\\) for \\(0 \\leqslant n \\leqslant 100\\).\n2. \\(f(0, k) \\equiv k \\bmod 2\\) for \\(0 \\leqslant k \\leqslant 100\\).\n\nProof.\n1. \\(f(n, 0)=\\#\\{(x, y) \\mid x+y \\alpha<n\\}=\\#\\{(x, y) \\mid x+199 y<n\\}=n\\).\n2.\n\\[\n\\begin{aligned}\n& f(0, k)=\\#\\{(x, y) \\mid x+y \\alpha<k \\alpha\\}=\\sum_{l=0}^{k-1} \\#\\{(x, l) \\mid x+l \\alpha<k \\alpha\\} \\\\\n& \\quad=\\sum_{l=0}^{k-1} \\#\\{x \\mid x<(k-l) \\alpha\\}=\\sum_{l=0}^{k-1} 200(k-l)-1=200 A-k\n\\end{aligned}\n\\]\nfor some integer \\(A\\).\nFrom this claim, using the equality \\(f(x, y)+f(x+1, y+1)=f(x+1, y)+f(x, y+1)+1\\), we can prove that mod 2 the region \\(A\\) looks like the following: in the rows (,\\(- 2 y\\) ) the remainders modulo 2 alternate, while the rows \\((-, 2 y+1)\\) contain only odd numbers.\n\\[\n\\left\\{\\right.\n\\]\n\nThe numbers mod 2 in the construction for 7500 .\n\nConstruction for 2500 Select \\(\\alpha \\approx 200.001\\).\nClaim.\n1. \\(f(n, 0)=n\\) for \\(0 \\leqslant n \\leqslant 100\\).\n2. \\(f(0, k) \\equiv 0 \\bmod 2\\) for \\(0 \\leqslant k \\leqslant 100\\).\n\nProof.\n1. As above.\n2. Similarly to the above:\n\\[\n\\begin{aligned}\nf(0, k) & =\\#\\{(x, y) \\mid x+y \\alpha<k \\alpha\\}=\\sum_{l=0}^{k-1} \\#\\{(x, l) \\mid x+l \\alpha<k \\alpha\\} \\\\\n& =\\sum_{l=0}^{k-1} \\#\\{x \\mid x<(k-l) \\alpha\\}=\\sum_{l=0}^{k-1} 200(k-l)=200 A\n\\end{aligned}\n\\]\nfor some integer \\(A\\).\nSimilarly to the above, we can prove that mod 2 the region \\(A\\) looks like the following: in the rows \\((-, 2 y)\\) the remainder modulo 2 alternate, while the rows \\((-, 2 y+1)\\) contain only even numbers.\n\\[\n\\left\\{\\right.\n\\]\n\nThe numbers mod 2 in the construction for 7500 .\n\n\\section*{Common remarks.}\n- In the proposer's solution, an exact formula is proved in the case where \\(\\alpha\\) is irrational. Let \\(\\mu=\\frac{1}{\\alpha}\\) and \\(\\nu=\\alpha\\). Then\n\\[\nf(a, b)=a b+(\\lceil 1 \\mu\\rceil+\\cdots+\\lceil\\mu\\rceil)+(\\lceil 1 \\nu\\rceil+\\cdots+\\lceil\\nu\\rceil) .\n\\]\n\nThey even suggested that this could be the source of a fun olympiad problem: it is not easy to see that \\(f\\) is a bijection.\n- (On the choice of statement, by the proposer). As seen in the solution, such functions have various properties, and it was not clear what statement to choose.\nI decided to go with the present statement since I believe it requires a good understanding of the setup and the functions involved. The key property is used in order to establish the bounds, and the formula is used to develop constructions and easily verify they work.\nWhile choosing a different statement (e.g. just prove the key property) may make the problem less bulky, I believe that doing so runs the risk of introducing unintended solutions which don't \"see the full picture.\" In fact, the present statement probably runs admits such solutions as well, likely through proving the key property via simply examining valid locations for \\(n+1\\) given the locations of \\(0, \\ldots, n\\), and using induction.\nUnfortunately, I'm not sure how else to improve the statement.\nOne person I've shown this problem to suggests removing one half of the problem, by only asking for the smallest or only the largest possible value of \\(N\\). Their rationale is that the two parts are mostly the same. I sympathize with them, but am reluctant to break the symmetry.\n- (PSC) The real difficulty of this problem is that one should understand the whole picture, and in particular how the function \\(f\\) works, and how that quadrant can behave. In this solution we characterised all such functions \\(f\\), before even talking about parity, while the problem only asks the number of odd numbers.\n\n\\section*{Geometry}", "source_pdf": "imosl_2022.pdf", "notes": "fallback-regex"}
{"id": "IMOSL-2022-G2", "contest": "IMOSL", "year": "2022", "problem_number": "G2", "problem": "In the acute-angled triangle \\(A B C\\), the point \\(F\\) is the foot of the altitude from \\(A\\), and \\(P\\) is a point on the segment \\(A F\\). The lines through \\(P\\) parallel to \\(A C\\) and \\(A B\\) meet \\(B C\\) at \\(D\\) and \\(E\\), respectively. Points \\(X \\neq A\\) and \\(Y \\neq A\\) lie on the circles \\(A B D\\) and \\(A C E\\), respectively, such that \\(D A=D X\\) and \\(E A=E Y\\).\n\nProve that \\(B, C, X\\) and \\(Y\\) are concyclic.\n(Netherlands)", "solution": "1. Let \\(A^{\\prime}\\) be the intersection of lines \\(B X\\) and \\(C Y\\). By power of a point, it suffices to prove that \\(A^{\\prime} B \\cdot A^{\\prime} X=A^{\\prime} C \\cdot A^{\\prime} Y\\), or, equivalently, that \\(A^{\\prime}\\) lies on the radical axis of the circles \\(A B D X\\) and \\(A C E Y\\).\n\nFrom \\(D A=D X\\) it follows that in circle \\(A B D X\\), point \\(D\\) bisects of one of the arcs \\(A X\\). Therefore, depending on the order of points, the line \\(B C\\) is either the internal or external bisector of \\(\\angle A B X\\). In both cases, line \\(B X\\) is the reflection of \\(B A\\) in line \\(B D C\\). Analogously, line \\(C Y\\) is the reflection of \\(C A\\) in line \\(B C\\); we can see that \\(A^{\\prime}\\) is the reflection of \\(A\\) in line \\(B C\\), so \\(A, F\\) and \\(A^{\\prime}\\) are collinear.\n\nBy \\(P D \\| A C\\) and \\(P E \\| A B\\) we have \\(\\frac{F D}{F C}=\\frac{F P}{F A}=\\frac{F E}{F B}\\), hence \\(F D \\cdot F B=F E \\cdot F C\\). So, point \\(F\\) has equal powers with respect to circles \\(A B D X\\) and \\(A C E Y\\).\n\nPoint \\(A\\), being a common point of the two circles, is another point with equal powers, so the radical axis of circles \\(A B D X\\) and \\(A C E Y\\) is the altitude \\(A F\\) that passes through \\(A^{\\prime}\\).\n![](https://cdn.mathpix.com/cropped/2025_08_23_bba1c16f961fdd6f4eb4g-48.jpg?height=1144&width=935&top_left_y=1267&top_left_x=562)\n\nSolution 2. We present another way to prove that line \\(A P A^{\\prime}\\) is the radical axis of the circles \\(A B D\\) and \\(A C E\\). It suffices to show that the second intersection point of \\(A B D\\) and \\(A C E\\) lies on \\(A P\\).\n\nDefine \\(N\\) to be the second intersection of circle \\(P D E\\) and \\(A P\\). From \\(\\angle D N A=\\angle D N P= \\angle D E P=\\angle D B A\\) it follows that \\(N\\) lies on circle \\(A B D\\); analogously, we can show that \\(N\\) lies on circle \\(A C E\\).", "source_pdf": "imosl_2022.pdf", "notes": "fallback-regex"}
{"id": "IMOSL-2022-G3", "contest": "IMOSL", "year": "2022", "problem_number": "G3", "problem": "Let \\(A B C D\\) be a cyclic quadrilateral. Assume that the points \\(Q, A, B, P\\) are collinear in this order, in such a way that the line \\(A C\\) is tangent to the circle \\(A D Q\\), and the line \\(B D\\) is tangent to the circle \\(B C P\\). Let \\(M\\) and \\(N\\) be the midpoints of \\(B C\\) and \\(A D\\), respectively. Prove that the following three lines are concurrent: line \\(C D\\), the tangent of circle \\(A N Q\\) at point \\(A\\), and the tangent to circle \\(B M P\\) at point \\(B\\).\n(Slovakia)", "solution": "1. We first prove that triangles \\(A D Q\\) and \\(C D B\\) are similar. Since \\(A B C D\\) is cyclic, we have \\(\\angle D A Q=\\angle D C B\\). By the tangency of \\(A C\\) to the circle \\(A Q D\\) we also have \\(\\angle C B D=\\angle C A D=\\angle A Q D\\). The claimed similarity is proven.\n\nLet \\(R\\) be the midpoint of \\(C D\\). Points \\(N\\) and \\(R\\) correspond in the proven similarity, and so \\(\\angle Q N A=\\angle B R C\\).\n![](https://cdn.mathpix.com/cropped/2025_08_23_bba1c16f961fdd6f4eb4g-49.jpg?height=712&width=1555&top_left_y=899&top_left_x=256)\n\nLet \\(K\\) be the second common point of line \\(C D\\) with circle \\(A B R\\) (i.e., if \\(C D\\) intersects circle \\(A B R\\), then \\(K \\neq R\\) is the other intersection; otherwise, if \\(C D\\) is tangent to \\(C D\\), then \\(K=R\\) ). In both cases, we have \\(\\angle B A K=\\angle B R C=\\angle Q N A\\); that indicates that \\(A K\\) is tangent to circle \\(A N Q\\). It can be showed analogously that \\(B K\\) is tangent to circle \\(B M P\\).\n\nComment. Note that \\(M\\) and \\(N\\) can be any points on lines \\(B C\\) and \\(A D\\) such that \\(B M: M C= D N: N A\\), as we then simply choose \\(R\\) to be such that \\(D R: R C\\) is that same ratio, and the rest of the proof remains unchanged.\n\nSolution 2. We present a second solution, without using the condition that \\(A B C D\\) is cyclic. Again, \\(M\\) and \\(N\\) can be any points on lines \\(B C\\) and \\(A D\\) such that \\(B M: M C=D N: N A\\).\n\nLet \\(A B\\) and \\(C D\\) meet at \\(T\\) (if \\(A B \\| C D\\) then \\(T\\) is their common ideal point). Let \\(C D\\) meet the tangent to the circle \\(A N Q\\) at \\(A\\), and the tangent to the circle \\(B M P\\) at \\(B\\) at points \\(K_{1}\\) and \\(K_{2}\\), respectively.\n![](https://cdn.mathpix.com/cropped/2025_08_23_bba1c16f961fdd6f4eb4g-50.jpg?height=760&width=1557&top_left_y=531&top_left_x=254)\n\nLet \\(I\\) and \\(J\\) be the ideal points of \\(A D\\) and \\(B C\\), respectively. Notice that the pencils ( \\(A D, A C, A T, A K_{1}\\) ) and ( \\(Q A, Q D, Q I, Q N\\) ) of lines are congruent, because \\(\\angle K_{1} A D=\\angle A Q N\\), \\(\\angle C A D=\\angle A Q D\\) and \\(\\angle I A T=\\angle I Q T\\). Hence,\n\\[\n\\left(D, C ; T, K_{1}\\right)=\\left(A D, A C ; A T, A K_{1}\\right)=(Q A, Q D ; Q I, Q N)=(A, D ; I, N)=\\frac{D N}{N A}\n\\]\n\nIt can be obtained analogously that\n\\[\n\\left(D, C ; T, K_{2}\\right)=\\left(B D, B C ; B T, B K_{2}\\right)=(P C, P B ; P J, P M)=(C, B ; I, N)=\\frac{B M}{M C}\n\\]\n\nFrom \\(B M: M C=D N: D A\\) we get \\(\\left(D, C ; T, K_{1}\\right)=\\left(D, C ; T, K_{2}\\right)\\) and hence \\(K_{1}=K_{2}\\).", "source_pdf": "imosl_2022.pdf", "notes": "fallback-regex"}
{"id": "IMOSL-2022-G4", "contest": "IMOSL", "year": "2022", "problem_number": "G4", "problem": "Let \\(A B C\\) be an acute-angled triangle with \\(A C>A B\\), let \\(O\\) be its circumcentre, and let \\(D\\) be a point on the segment \\(B C\\). The line through \\(D\\) perpendicular to \\(B C\\) intersects the lines \\(A O, A C\\) and \\(A B\\) at \\(W, X\\) and \\(Y\\), respectively. The circumcircles of triangles \\(A X Y\\) and \\(A B C\\) intersect again at \\(Z \\neq A\\).\n\nProve that if \\(O W=O D\\), then \\(D Z\\) is tangent to the circle \\(A X Y\\).\n(United Kingdom)", "solution": "1. Let \\(A O\\) intersect \\(B C\\) at \\(E\\). As \\(E D W\\) is a right-angled triangle and \\(O\\) is on \\(W E\\), the condition \\(O W=O D\\) means \\(O\\) is the circumcentre of this triangle. So \\(O D=O E\\) which establishes that \\(D, E\\) are reflections in the perpendicular bisector of \\(B C\\).\n\nNow observe:\n\\[\n180^{\\circ}-\\angle D X Z=\\angle Z X Y=\\angle Z A Y=\\angle Z C D,\n\\]\nwhich shows \\(C D X Z\\) is cyclic.\n![](https://cdn.mathpix.com/cropped/2025_08_23_bba1c16f961fdd6f4eb4g-51.jpg?height=946&width=707&top_left_y=1082&top_left_x=673)\n\nWe next show that \\(A Z \\| B C\\). To do this, introduce point \\(Z^{\\prime}\\) on circle \\(A B C\\) such that \\(A Z^{\\prime} \\| B C\\). By the previous result, it suffices to prove that \\(C D X Z^{\\prime}\\) is cyclic. Notice that triangles \\(B A E\\) and \\(C Z^{\\prime} D\\) are reflections in the perpendicular bisector of \\(B C\\). Using this and that \\(A, O, E\\) are collinear:\n\\[\n\\angle D Z^{\\prime} C=\\angle B A E=\\angle B A O=90^{\\circ}-\\frac{1}{2} \\angle A O B=90^{\\circ}-\\angle C=\\angle D X C,\n\\]\nso \\(D X Z^{\\prime} C\\) is cyclic, giving \\(Z \\equiv Z^{\\prime}\\) as desired.\nUsing \\(A Z \\| B C\\) and \\(C D X Z\\) cyclic we get:\n\\[\n\\angle A Z D=\\angle C D Z=\\angle C X Z=\\angle A Y Z,\n\\]\nwhich by the converse of alternate segment theorem shows \\(D Z\\) is tangent to circle \\(A X Y\\).\n\nSolution 2. Notice that point \\(Z\\) is the Miquel-point of lines \\(A C, B C, B A\\) and \\(D Y\\); then \\(B, D, Z, Y\\) and \\(C, D, X, Y\\) are concyclic. Moreover, \\(Z\\) is the centre of the spiral similarity that maps \\(B C\\) to \\(Y X\\).\n\nBy \\(B C \\perp Y X\\), the angle of that similarity is \\(90^{\\circ}\\); hence the circles \\(A B C Z\\) and \\(A X Y Z\\) are perpendicular, therefore the radius \\(O Z\\) in circle \\(A B C Z\\) is tangent to circle \\(A X Y Z\\).\n![](https://cdn.mathpix.com/cropped/2025_08_23_bba1c16f961fdd6f4eb4g-52.jpg?height=947&width=941&top_left_y=533&top_left_x=556)\n\nBy \\(O W=O D\\), the triangle \\(O W D\\) is isosceles, and\n\\[\n\\angle Z O A=2 \\angle Z B A=2 \\angle Z B Y=2 \\angle Z D Y=\\angle O D W+\\angle D W O,\n\\]\nso \\(D\\) lies on line \\(Z O\\) that is tangent to circle \\(A X Y\\).", "source_pdf": "imosl_2022.pdf", "notes": "fallback-regex"}
{"id": "IMOSL-2022-G5", "contest": "IMOSL", "year": "2022", "problem_number": "G5", "problem": "Let \\(A B C\\) be a triangle, and let \\(\\ell_{1}\\) and \\(\\ell_{2}\\) be two parallel lines. For \\(i=1,2\\), let \\(\\ell_{i}\\) meet the lines \\(B C, C A\\), and \\(A B\\) at \\(X_{i}, Y_{i}\\), and \\(Z_{i}\\), respectively. Suppose that the line through \\(X_{i}\\) perpendicular to \\(B C\\), the line through \\(Y_{i}\\) perpendicular to \\(C A\\), and finally the line through \\(Z_{i}\\) perpendicular to \\(A B\\), determine a non-degenerate triangle \\(\\Delta_{i}\\).\n\nShow that the circumcircles of \\(\\Delta_{1}\\) and \\(\\Delta_{2}\\) are tangent to each other.\n(Vietnam)", "solution": "1. Throughout the solutions, \\(\\Varangle(p, q)\\) will denote the directed angle between lines \\(p\\) and \\(q\\), taken modulo \\(180^{\\circ}\\).\n\nLet the vertices of \\(\\Delta_{i}\\) be \\(D_{i}, E_{i}, F_{i}\\), such that lines \\(E_{i} F_{i}, F_{i} D_{i}\\) and \\(D_{i} E_{i}\\) are the perpendiculars through \\(X, Y\\) and \\(Z\\), respectively, and denote the circumcircle of \\(\\Delta_{i}\\) by \\(\\omega_{i}\\).\n\nIn triangles \\(D_{1} Y_{1} Z_{1}\\) and \\(D_{2} Y_{2} Z_{2}\\) we have \\(Y_{1} Z_{1} \\| Y_{2} Z_{2}\\) because they are parts of \\(\\ell_{1}\\) and \\(\\ell_{2}\\). Moreover, \\(D_{1} Y_{1} \\| D_{2} Y_{2}\\) are perpendicular to \\(A C\\) and \\(D_{1} Z_{1} \\| D_{2} Z_{2}\\) are perpendicular to \\(A B\\), so the two triangles are homothetic and their homothetic centre is \\(Y_{1} Y_{2} \\cap Z_{1} Z_{2}=A\\). Hence, line \\(D_{1} D_{2}\\) passes through \\(A\\). Analogously, line \\(E_{1} E_{2}\\) passes through \\(B\\) and \\(F_{1} F_{2}\\) passes through \\(C\\).\n![](https://cdn.mathpix.com/cropped/2025_08_23_bba1c16f961fdd6f4eb4g-53.jpg?height=866&width=1289&top_left_y=1056&top_left_x=388)\n\nThe corresponding sides of \\(\\Delta_{1}\\) and \\(\\Delta_{2}\\) are parallel, because they are perpendicular to the respective sides of triangle \\(A B C\\). Hence, \\(\\Delta_{1}\\) and \\(\\Delta_{2}\\) are either homothetic, or they can be translated to each other. Using that \\(B, X_{2}, Z_{2}\\) and \\(E_{2}\\) are concyclic, \\(C, X_{2}, Y_{2}\\) and \\(F_{2}\\) are concyclic, \\(Z_{2} E_{2} \\perp A B\\) and \\(Y_{2}, F_{2} \\perp A C\\) we can calculate\n\\[\n\\begin{aligned}\n\\Varangle\\left(E_{1} E_{2}, F_{1} F_{2}\\right) & =\\Varangle\\left(E_{1} E_{2}, X_{1} X_{2}\\right)+\\Varangle\\left(X_{1} X_{2}, F_{1} F_{2}\\right)=\\Varangle\\left(B E_{2}, B X_{2}\\right)+\\Varangle\\left(C X_{2}, C F_{2}\\right) \\\\\n& =\\Varangle\\left(Z_{2} E_{2}, Z_{2} X_{2}\\right)+\\Varangle\\left(Y_{2} X_{2}, Y_{2} F_{2}\\right)=\\Varangle\\left(Z_{2} E_{2}, \\ell_{2}\\right)+\\Varangle\\left(\\ell_{2}, Y_{2} F_{2}\\right) \\\\\n& =\\Varangle\\left(Z_{2} E_{2}, Y_{2} F_{2}\\right)=\\Varangle(A B, A C) \\not \\equiv 0,\n\\end{aligned}\n\\]\nand conclude that lines \\(E_{1} E_{2}\\) and \\(F_{1} F_{2}\\) are not parallel. Hence, \\(\\Delta_{1}\\) and \\(\\Delta_{2}\\) are homothetic; the lines \\(D_{1} D_{2}, E_{1} E_{2}\\), and \\(F_{1} F_{2}\\) are concurrent at the homothetic centre of the two triangles. Denote this homothetic centre by \\(H\\).\n\nFor \\(i=1,2\\), using (1), and that \\(A, Y_{i}, Z_{i}\\) and \\(D_{i}\\) are concyclic,\n\\[\n\\begin{aligned}\n\\Varangle\\left(H E_{i}, H F_{i}\\right) & =\\Varangle\\left(E_{1} E_{2}, F_{1} F_{2}\\right)=\\Varangle(A B, A C) \\\\\n& =\\Varangle\\left(A Z_{i}, A Y_{i}\\right)=\\Varangle\\left(D_{i} Z_{i}, D_{i} Y_{i}\\right)=\\Varangle\\left(D_{i} E_{i}, D_{i} F_{i}\\right),\n\\end{aligned}\n\\]\nso \\(H\\) lies on circle \\(\\omega_{i}\\).\nThe same homothety that maps \\(\\Delta_{1}\\) to \\(\\Delta_{2}\\), sends \\(\\omega_{1}\\) to \\(\\omega_{2}\\) as well. Point \\(H\\), that is the centre of the homothety, is a common point of the two circles, That finishes proving that \\(\\omega_{1}\\) and \\(\\omega_{2}\\) are tangent to each other.\n\nSolution 2. As in the first solution, let the vertices of \\(\\Delta_{i}\\) be \\(D_{i}, E_{i}, F_{i}\\), such that \\(E_{i} F_{i}, F_{i} D_{i}\\) and \\(D_{i} E_{i}\\) are the perpendiculars through \\(X_{i}, Y_{i}\\) and \\(Z_{i}\\), respectively. In the same way we conclude that \\(\\left(A, D_{1}, D_{2}\\right)\\), ( \\(B, E_{1}, E_{2}\\) ) and ( \\(C, F_{1}, F_{2}\\) ) are collinear.\n\nThe corresponding sides of triangles \\(A B C\\) and \\(D_{i} E_{i} F_{i}\\) are perpendicular to each other. Hence, there is a spiral similarity with rotation \\(\\pm 90^{\\circ}\\) that maps \\(A B C\\) to \\(D_{i} E_{i} F_{i}\\); let \\(M_{i}\\) be the centre of that similarity. Hence, \\(\\Varangle\\left(M_{i} A, M_{i} D_{i}\\right)=\\Varangle\\left(M_{i} B, M_{i} E_{i}\\right)=\\Varangle\\left(M_{i} C, M_{i} F_{i}\\right)=90^{\\circ}\\). The circle with diameter \\(A D_{i}\\) passes through \\(M_{i}, Y_{i}, Z_{i}\\), so \\(M_{i}, A, Y_{i}, Z_{i}, D_{i}\\) are concyclic; analogously ( \\(M_{i}, B, X_{i}, Z_{i}, E_{i}\\) ) and ( \\(M_{i}, C, X_{i}, Y_{i}, F_{i}\\) ) are concyclic.\n\nBy applying Desargues' theorem to triangles \\(A B C\\) and \\(D_{i} E_{i} F_{i}\\) we conclude that the lines \\(A D_{i}, B E_{i}\\) and \\(B F_{i}\\) are concurrent; let their intersection be \\(H\\). Since \\(\\left(A, D_{1} . D_{2}\\right),\\left(B, E_{1} . E_{2}\\right)\\) and ( \\(C, F_{1} . F_{2}\\) ) are collinear, we obtain the same point \\(H\\) for \\(i=1\\) and \\(i=2\\).\n![](https://cdn.mathpix.com/cropped/2025_08_23_bba1c16f961fdd6f4eb4g-54.jpg?height=844&width=849&top_left_y=1107&top_left_x=605)\n\nBy \\(\\Varangle(C B, C H)=\\Varangle\\left(C X_{i}, C F_{i}\\right)=\\Varangle\\left(Y_{i} X_{i}, Y_{i} F_{i}\\right)=\\Varangle\\left(Y_{i} Z_{i}, Y_{i} D_{i}\\right)=\\Varangle\\left(A Z_{i}, A D_{i}\\right)= \\Varangle(A B, A H)\\), point \\(H\\) lies on circle \\(A B C\\).\n\nAnalogously, from \\(\\Varangle\\left(F_{i} D_{i}, F_{i} H\\right)=\\Varangle\\left(F_{i} Y_{i}, F_{i} C\\right)=\\Varangle\\left(X_{i} Y_{i}, X_{i} C\\right)=\\Varangle\\left(X_{i} Z_{i}, X_{i} B\\right)= \\Varangle\\left(E_{i} Z_{i}, E_{i} B\\right)=\\Varangle\\left(E_{i} D_{i}, E_{i} H\\right)\\), we can see that point \\(H\\) lies on circle \\(D_{i} E_{i} F_{i}\\) as well. Therefore, circles \\(A B C\\) and \\(D_{i} E_{i} F_{i}\\) intersect at point \\(H\\).\n\nThe spiral similarity moves the circle \\(A B C\\) to circle \\(D_{i} E_{i} F_{i}\\), so the two circles are perpendicular. Hence, both circles \\(D_{1} E_{1} F_{1}\\) and \\(D_{2} E_{2} F_{2}\\) are tangent to the radius of circle \\(A B C\\) at \\(H\\).\n\nComment 1. As the last picture suggests, the circles \\(A B C\\) and \\(D_{i} E_{i} F_{i}\\) pass through \\(M_{i}\\). In fact, point \\(M_{i}\\), being the second intersection of circles \\(D_{i} E_{i} F_{i}\\) and \\(D_{i} Y_{i} Z_{i}\\), the Miquel point of the lines \\(A Y_{i}, A Z_{i}, C X_{i}\\) and \\(X_{i} Y_{i}\\), so it is concyclic with \\(A, B, C\\). Similarly, \\(M_{i}\\) the Miquel point of lines \\(D_{i} E_{i}\\), \\(E_{i} F_{i}, F_{i} Y_{i}\\) and \\(X_{i} Y_{i}\\), so it is concyclic with \\(D_{i}, E_{i}, D_{i}\\).\n\nComment 2. Instead of two lines \\(\\ell_{1}\\) and \\(\\ell_{2}\\), it is possible to reformulate the problem with a single, varying line \\(\\ell\\) :\n\nLet \\(A B C\\) be a triangle, and let \\(\\ell\\) be a varying line whose direction is fixed. Let \\(\\ell\\) intersect lines \\(B C\\), \\(C A\\), and \\(A B\\) at \\(X, Y\\), and \\(Z\\), respectively. Suppose that the line through \\(X\\), perpendicular to \\(B C\\), the line through \\(Y\\), perpendicular to \\(C A\\), and the line through \\(Z\\), perpendicular to \\(A B\\), determine a non-degenerate triangle \\(\\Delta\\).\n\nShow that as \\(\\ell\\) varies, the circumcircles of the obtained triangles \\(\\Delta\\) pass through a fixed point, and these circles are tangent to each other.\n\nA reasonable approach is finding the position of line \\(\\ell\\) when the triangle \\(D E F\\) degenerates to a single point. That happens when the line \\(X Y Z\\) is the Simson line respect to point \\(D=E=F\\) on the circumcircle \\(A B C\\). Based on this observation a possible variant of the solution is as follows.\n\nLet \\(H\\) be the second intersection of circles \\(A B C\\) and line \\(A D\\). Like in the solutions above, we can find that the line \\(A D\\) is fixed, so \\(H\\) is independent of the position of line \\(\\ell\\).\n![](https://cdn.mathpix.com/cropped/2025_08_23_bba1c16f961fdd6f4eb4g-55.jpg?height=834&width=800&top_left_y=828&top_left_x=631)\n\nFrom \\(\\Varangle(H F, H D)=\\Varangle(H C, H A)=\\Varangle(B C, B A)=\\Varangle(B X, B Z)=\\Varangle(E X, E Z)=\\Varangle(E F, E D)\\) we can see that circle \\(\\Delta\\) passes through \\(H\\). Hence, all circles \\(D E F\\) passes through a fixed point.\n\nThe corresponding sides of triangles \\(A B C\\) and \\(D E F\\) are perpendicular, so their circumcircle are perpendicular; that proves that circle \\(D E F\\) is tangent to the radius of circle \\(A B C\\) at \\(H\\).", "source_pdf": "imosl_2022.pdf", "notes": "fallback-regex"}
{"id": "IMOSL-2022-G6", "contest": "IMOSL", "year": "2022", "problem_number": "G6", "problem": "In an acute-angled triangle \\(A B C\\), point \\(H\\) is the foot of the altitude from \\(A\\). Let \\(P\\) be a moving point such that the bisectors \\(k\\) and \\(\\ell\\) of angles \\(P B C\\) and \\(P C B\\), respectively, intersect each other on the line segment \\(A H\\). Let \\(k\\) and \\(A C\\) meet at \\(E\\), let \\(\\ell\\) and \\(A B\\) meet at \\(F\\), and let \\(E F\\) and \\(A H\\) meet at \\(Q\\). Prove that, as \\(P\\) varies, the line \\(P Q\\) passes through a fixed point.\n(Iran)", "solution": "1. Let the reflections of the line \\(B C\\) with respect to the lines \\(A B\\) and \\(A C\\) intersect at point \\(K\\). We will prove that \\(P, Q\\) and \\(K\\) are collinear, so \\(K\\) is the common point of the varying line \\(P Q\\).\n\nLet lines \\(B E\\) and \\(C F\\) intersect at \\(I\\). For every point \\(O\\) and \\(d>0\\), denote by ( \\(O, d\\) ) the circle centred at \\(O\\) with radius \\(d\\), and define \\(\\omega_{I}=(I, I H)\\) and \\(\\omega_{A}=(A, A H)\\). Let \\(\\omega_{K}\\) and \\(\\omega_{P}\\) be the incircle of triangle \\(K B C\\) and the \\(P\\)-excircle of triangle \\(P B C\\), respectively.\n\nSince \\(I H \\perp B C\\) and \\(A H \\perp B C\\), the circles \\(\\omega_{A}\\) and \\(\\omega_{I}\\) are tangent to each other at \\(H\\). So, \\(H\\) is the external homothetic centre of \\(\\omega_{A}\\) and \\(\\omega_{I}\\). From the complete quadrangle \\(B C E F\\) we have \\((A, I ; Q, H)=-1\\), therefore \\(Q\\) is the internal homothetic centre of \\(\\omega_{A}\\) and \\(\\omega_{I}\\). Since \\(B A\\) and \\(C A\\) are the external bisectors of angles \\(\\angle K B C\\) and \\(\\angle K C B\\), circle \\(\\omega_{A}\\) is the \\(K\\)-excircle in triangle \\(B K C\\). Hence, \\(K\\) is the external homothetic centre of \\(\\omega_{A}\\) and \\(\\omega_{K}\\). Also it is clear that \\(P\\) is the external homothetic centre of \\(\\omega_{I}\\) and \\(\\omega_{P}\\). Let point \\(T\\) be the tangency point of \\(\\omega_{P}\\) and \\(B C\\), and let \\(T^{\\prime}\\) be the tangency point of \\(\\omega_{K}\\) and \\(B C\\). Since \\(\\omega_{I}\\) is the incircle and \\(\\omega_{P}\\) is the \\(P\\)-excircle of \\(P B C, T C=B H\\) and since \\(\\omega_{K}\\) is the incircle and \\(\\omega_{A}\\) is the \\(K\\)-excircle of \\(K B C, T^{\\prime} C=B H\\). Therefore \\(T C=T^{\\prime} C\\) and \\(T \\equiv T^{\\prime}\\). It yields that \\(\\omega_{K}\\) and \\(\\omega_{P}\\) are tangent to each other at \\(T\\).\n![](https://cdn.mathpix.com/cropped/2025_08_23_bba1c16f961fdd6f4eb4g-56.jpg?height=929&width=1172&top_left_y=1496&top_left_x=445)\n\nLet point \\(S\\) be the internal homothetic centre of \\(\\omega_{A}\\) and \\(\\omega_{P}\\), and let \\(S^{\\prime}\\) be the internal homothetic centre of \\(\\omega_{I}\\) and \\(\\omega_{K}\\). It's obvious that \\(S\\) and \\(S^{\\prime}\\) lie on \\(B C\\). We claim that \\(S \\equiv S^{\\prime}\\). To prove our claim, let \\(r_{A}, r_{I}, r_{P}\\), and \\(r_{K}\\) be the radii of \\(\\omega_{A}, \\omega_{I}, \\omega_{P}\\) and \\(\\omega_{k}\\), respectively.\n\nIt is well known that if the sides of a triangle are \\(a, b, c\\), its semiperimeter is \\(s=(a+b+c) / 2\\), and the radii of the incircle and the \\(a\\)-excircle are \\(r\\) and \\(r_{a}\\), respectively, then \\(r \\cdot r_{a}=(s-b)(s-c)\\). Applying this fact to triangle \\(P B C\\) we get \\(r_{I} \\cdot r_{P}=B H \\cdot C H\\). The same fact in triangle \\(K C B\\)\nyields \\(r_{K} \\cdot r_{A}=C T \\cdot B T\\). Since \\(B H=C T\\) and \\(B T=C H\\), from these two we get\n\\[\n\\frac{H S}{S T}=\\frac{r_{A}}{r_{P}}=\\frac{r_{I}}{r_{K}}=\\frac{H S^{\\prime}}{S^{\\prime} T},\n\\]\nso \\(S=S^{\\prime}\\) indeed.\nFinally, by applying the generalised Monge's theorem to the circles \\(\\omega_{A}, \\omega_{I}\\), and \\(\\omega_{K}\\) (with two pairs of internal and one pair of external common tangents), we can see that points \\(Q\\), \\(S\\), and \\(K\\) are collinear. Similarly one can show that \\(Q, S\\) and \\(P\\) are collinear, and the result follows.\n\nSolution 2. Again, let \\(B E\\) and \\(C F\\) meet at \\(I\\), that is the incentre in triangle \\(B C P\\); then \\(P I\\) is the third angle bisector. From the tangent segments of the incircle we have \\(B P-C P= B H-C H\\); hence, the possible points \\(P\\) lie on a branch of a hyperbola \\(\\mathcal{H}\\) with foci \\(B, C\\), and \\(H\\) is a vertex of \\(\\mathcal{H}\\). Since \\(P I\\) bisects the angle between the radii \\(B P\\) and \\(C P\\) of the hyperbola, line \\(P I\\) is tangent to \\(\\mathcal{H}\\).\n![](https://cdn.mathpix.com/cropped/2025_08_23_bba1c16f961fdd6f4eb4g-57.jpg?height=1041&width=1292&top_left_y=1073&top_left_x=388)\n\nLet \\(K\\) be the second intersection of \\(P Q\\) and \\(\\mathcal{H}\\), we will show that \\(A K\\) is tangent to \\(\\mathcal{H}\\) at \\(K\\); this property determines \\(K\\).\n\nLet \\(G=K I \\cap A P\\) and \\(M=P I \\cap A K\\). From the complete quadrangle \\(B C E F\\) we can see that ( \\(H, Q ; I, A\\) ) is harmonic, so in the complete quadrangle \\(A P I K\\), point \\(H\\) lies on line \\(G M\\).\n\nConsider triangle \\(A I M\\). Its side \\(A I\\) is tangent to \\(\\mathcal{H}\\) at \\(H\\), the side \\(I M\\) is tangent to \\(\\mathcal{H}\\) at \\(P\\), and \\(K\\) is a common point of the third side \\(A M\\) and the hyperbola such that the lines \\(A P\\), \\(I K\\) and \\(M H\\) are concurrent at the generalised Gergonne-point \\(G\\). It follows that the third side, \\(A M\\) is also tangent to \\(\\mathcal{H}\\) at \\(K\\).\n(Alternatively, in the last step we can apply the converse of Brianchon's theorem to the degenerate hexagon AHIPMK. By the theorem there is a conic section \\(\\mathcal{H}^{\\prime}\\) such that lines \\(A I, I M\\) and \\(M A\\) are tangent to \\(\\mathcal{H}^{\\prime}\\) at \\(H, P\\) and \\(K\\), respectively. But the three points \\(H, K\\) and \\(P\\), together with the tangents at \\(H\\) and \\(P\\) uniquely determine \\(\\mathcal{H}^{\\prime}\\), so indeed \\(\\mathcal{H}^{\\prime}=\\mathcal{H}\\).)", "source_pdf": "imosl_2022.pdf", "notes": "fallback-regex"}
{"id": "IMOSL-2022-G7", "contest": "IMOSL", "year": "2022", "problem_number": "G7", "problem": "Let \\(A B C\\) and \\(A^{\\prime} B^{\\prime} C^{\\prime}\\) be two triangles having the same circumcircle \\(\\omega\\), and the same orthocentre \\(H\\). Let \\(\\Omega\\) be the circumcircle of the triangle determined by the lines \\(A A^{\\prime}, B B^{\\prime}\\) and \\(C C^{\\prime}\\). Prove that \\(H\\), the centre of \\(\\omega\\), and the centre of \\(\\Omega\\) are collinear.\n(Denmark)", "solution": ". In what follows, \\(\\Varangle(p, q)\\) will denote the directed angle between lines \\(p\\) and \\(q\\), taken modulo \\(180^{\\circ}\\). Denote by \\(O\\) the centre of \\(\\omega\\). In any triangle, the homothety with ratio \\(-\\frac{1}{2}\\) centred at the centroid of the triangle takes the vertices to the midpoints of the opposite sides and it takes the orthocentre to the circumcentre. Therefore the triangles \\(A B C\\) and \\(A^{\\prime} B^{\\prime} C^{\\prime}\\) share the same centroid \\(G\\) and the midpoints of their sides lie on a circle \\(\\rho\\) with centre on \\(O H\\). We will prove that \\(\\omega, \\Omega\\), and \\(\\rho\\) are coaxial, so in particular it follows that their centres are collinear on \\(O H\\).\n\nLet \\(D=B B^{\\prime} \\cap C C^{\\prime}, E=C C^{\\prime} \\cap A A^{\\prime}, F=A A^{\\prime} \\cap B B^{\\prime}, S=B C^{\\prime} \\cap B^{\\prime} C\\), and \\(T=B C \\cap B^{\\prime} C^{\\prime}\\). Since \\(D, S\\), and \\(T\\) are the intersections of opposite sides and of the diagonals in the quadrilateral \\(B B^{\\prime} C C^{\\prime}\\) inscribed in \\(\\omega\\), by Brocard's theorem triangle \\(D S T\\) is self-polar with respect to \\(\\omega\\), i.e. each vertex is the pole of the opposite side. We apply this in two ways.\n![](https://cdn.mathpix.com/cropped/2025_08_23_bba1c16f961fdd6f4eb4g-58.jpg?height=829&width=1572&top_left_y=1059&top_left_x=245)\n\nFirst, from \\(D\\) being the pole of \\(S T\\) it follows that the inverse \\(D^{*}\\) of \\(D\\) with respect to \\(\\omega\\) is the projection of \\(D\\) onto \\(S T\\). In particular, \\(D^{*}\\) lies on the circle with diameter \\(S D\\). If \\(N\\) denotes the midpoint of \\(S D\\) and \\(R\\) the radius of \\(\\omega\\), then the power of \\(O\\) with respect to this circle is \\(O N^{2}-N D^{2}=O D \\cdot O D^{*}=R^{2}\\). By rearranging, we see that \\(N D^{2}\\) is the power of \\(N\\) with respect to \\(\\omega\\).\n\nSecond, from \\(T\\) being the pole of \\(S D\\) it follows that \\(O T\\) is perpendicular to \\(S D\\). Let \\(M\\) and \\(M^{\\prime}\\) denote the midpoints of \\(B C\\) and \\(B^{\\prime} C^{\\prime}\\). Then since \\(O M \\perp B C\\) and \\(O M^{\\prime} \\perp B^{\\prime} C^{\\prime}\\) it follows that \\(O M M^{\\prime} T\\) is cyclic and\n\\[\n\\Varangle(S D, B C)=\\Varangle(O T, O M)=\\Varangle\\left(B^{\\prime} C^{\\prime}, M M^{\\prime}\\right) .\n\\]\n\nFrom \\(B B^{\\prime} C C^{\\prime}\\) being cyclic we also have \\(\\Varangle\\left(B C, B B^{\\prime}\\right)=\\Varangle\\left(C C^{\\prime}, B^{\\prime} C^{\\prime}\\right)\\), hence we obtain\n\\[\n\\begin{aligned}\n\\Varangle\\left(S D, B B^{\\prime}\\right) & =\\Varangle(S D, B C)+\\Varangle\\left(B C, B B^{\\prime}\\right) \\\\\n& =\\Varangle\\left(B^{\\prime} C^{\\prime}, M M^{\\prime}\\right)+\\Varangle\\left(C C^{\\prime}, B^{\\prime} C^{\\prime}\\right)=\\Varangle\\left(C C^{\\prime}, M M^{\\prime}\\right) .\n\\end{aligned}\n\\]\n\nNow from the homothety mentioned in the beginning, we know that \\(M M^{\\prime}\\) is parallel to \\(A A^{\\prime}\\), hence the above implies that \\(\\Varangle\\left(S D, B B^{\\prime}\\right)=\\Varangle\\left(C C^{\\prime}, A A^{\\prime}\\right)\\), which shows that \\(\\Omega\\) is tangent to \\(S D\\) at \\(D\\). In particular, \\(N D^{2}\\) is also the power of \\(N\\) with respect to \\(\\Omega\\).\n\nAdditionally, from \\(B B^{\\prime} C C^{\\prime}\\) being cyclic it follows that triangles \\(D B C\\) and \\(D C^{\\prime} B^{\\prime}\\) are inversely similar, so \\(\\Varangle\\left(B B^{\\prime}, D M^{\\prime}\\right)=\\Varangle\\left(D M, C C^{\\prime}\\right)\\). This yields\n\\[\n\\begin{aligned}\n\\Varangle\\left(S D, D M^{\\prime}\\right) & =\\Varangle\\left(S D, B B^{\\prime}\\right)+\\Varangle\\left(B B^{\\prime}, D M^{\\prime}\\right) \\\\\n& =\\Varangle\\left(C C^{\\prime}, M M^{\\prime}\\right)+\\Varangle\\left(D M, C C^{\\prime}\\right)=\\Varangle\\left(D M, M M^{\\prime}\\right),\n\\end{aligned}\n\\]\nwhich shows that the circle \\(D M M^{\\prime}\\) is also tangent to \\(S D\\). Since \\(N, M\\), and \\(M^{\\prime}\\) are collinear on the Newton-Gauss line of the complete quadrilateral determined by the lines \\(B B^{\\prime}, C C^{\\prime}, B C^{\\prime}\\), and \\(B^{\\prime} C\\), it follows that \\(N D^{2}=N M \\cdot N M^{\\prime}\\). Hence \\(N\\) has the same power with respect to \\(\\omega\\), \\(\\Omega\\), and \\(\\rho\\).\n\nBy the same arguments there exist points on the tangents to \\(\\Omega\\) at \\(E\\) and \\(F\\) which have the same power with respect to \\(\\omega, \\Omega\\), and \\(\\rho\\). The tangents to a given circle at three distinct points cannot be concurrent, hence we obtain at least two distinct points with the same power with respect to \\(\\omega, \\Omega\\), and \\(\\rho\\). Hence the three circles are coaxial, as desired.\n\nComment 1. Instead of invoking the Newton-Gauss line, one can also use a nice symmetry argument: If from the beginning we swapped the labels of \\(B^{\\prime}\\) and \\(C^{\\prime}\\), then in the proof above the labels of \\(D\\) and \\(S\\) would be swapped while the labels of \\(M\\) and \\(M^{\\prime}\\) do not change. The consequence is that the circle \\(S M M^{\\prime}\\) is also tangent to \\(S D\\). Since \\(N\\) is the midpoint of \\(S D\\) it then has the same power with respect to circles \\(D M M^{\\prime}\\) and \\(S M M^{\\prime}\\), so it lies on their radical axis \\(M M^{\\prime}\\).\n\nComment 2. There exists another triple of points on the common radical axis of \\(\\omega, \\Omega\\), and \\(\\rho\\) which can be used to solve the problem. We outline one such solution.\n![](https://cdn.mathpix.com/cropped/2025_08_23_bba1c16f961fdd6f4eb4g-59.jpg?height=763&width=1017&top_left_y=1296&top_left_x=525)\n\nLet \\(L\\) and \\(L^{\\prime}\\) denote the feet of the altitudes from \\(A\\) and \\(A^{\\prime}\\) in triangle \\(A B C\\) and \\(A^{\\prime} B^{\\prime} C^{\\prime}\\), respectively. Since \\(\\rho\\) is the nine-point circle of the two triangles it contains both \\(L\\) and \\(L^{\\prime}\\). Furthermore, \\(H A \\cdot H L\\) and \\(H A^{\\prime} \\cdot H L^{\\prime}\\) both equal twice the power of \\(H\\) with respect to \\(\\rho\\), so \\(A, A^{\\prime}, L, L^{\\prime}\\) are concyclic as well.\n\nNow let \\(\\ell=A A^{\\prime}\\) and denote \\(P=L L^{\\prime} \\cap \\ell, K=B C \\cap \\ell\\), and \\(K^{\\prime}=B^{\\prime} C^{\\prime} \\cap \\ell\\). As \\(M M^{\\prime} \\| \\ell\\) (shown in the previous solution) and \\(L L^{\\prime} M M^{\\prime}\\) is cyclic\n\\[\n\\Varangle(B C, \\ell)=\\Varangle\\left(B C, M M^{\\prime}\\right)=\\Varangle\\left(L L^{\\prime}, B^{\\prime} C^{\\prime}\\right)\n\\]\nso \\(K, K^{\\prime}, L\\), and \\(L^{\\prime}\\) are also concyclic. From the cyclic quadrilaterals \\(A A^{\\prime} L L^{\\prime}\\) and \\(K K^{\\prime} L L^{\\prime}\\) we get \\(P A \\cdot P A^{\\prime}=P L \\cdot P L^{\\prime}=P K \\cdot P K^{\\prime}\\). This implies that \\(P\\) is the centre of the (unique) involution \\(\\sigma\\) on \\(\\ell\\) that swaps \\(A, A^{\\prime}\\) and \\(K, K^{\\prime}\\). On the other hand, by Desargues' involution theorem applied to the line \\(\\ell\\), the quadrilateral \\(B B^{\\prime} C C^{\\prime}\\), and its circumcircle \\(\\omega\\), the involution \\(\\sigma\\) also swaps \\(E\\) and \\(F\\). Hence\n\\[\nP A \\cdot P A^{\\prime}=P L \\cdot P L^{\\prime}=P E \\cdot P F .\n\\]\n\nHowever, this means that \\(P\\) has the same power with respect to \\(\\omega, \\Omega\\), and \\(\\rho\\), and by the same arguments there exist points on \\(B B^{\\prime}\\) and \\(C C^{\\prime}\\) with this property.", "source_pdf": "imosl_2022.pdf", "notes": "fallback-regex"}
{"id": "IMOSL-2022-G8", "contest": "IMOSL", "year": "2022", "problem_number": "G8", "problem": "Let \\(A A^{\\prime} B C C^{\\prime} B^{\\prime}\\) be a convex cyclic hexagon such that \\(A C\\) is tangent to the incircle of the triangle \\(A^{\\prime} B^{\\prime} C^{\\prime}\\), and \\(A^{\\prime} C^{\\prime}\\) is tangent to the incircle of the triangle \\(A B C\\). Let the lines \\(A B\\) and \\(A^{\\prime} B^{\\prime}\\) meet at \\(X\\) and let the lines \\(B C\\) and \\(B^{\\prime} C^{\\prime}\\) meet at \\(Y\\).\n\nProve that if \\(X B Y B^{\\prime}\\) is a convex quadrilateral, then it has an incircle.\n(Australia)", "solution": ". Denote by \\(\\omega\\) and \\(\\omega^{\\prime}\\) the incircles of \\(\\triangle A B C\\) and \\(\\triangle A^{\\prime} B^{\\prime} C^{\\prime}\\) and let \\(I\\) and \\(I^{\\prime}\\) be the centres of these circles. Let \\(N\\) and \\(N^{\\prime}\\) be the second intersections of \\(B I\\) and \\(B^{\\prime} I^{\\prime}\\) with \\(\\Omega\\), the circumcircle of \\(A^{\\prime} B C C^{\\prime} B^{\\prime} A\\), and let \\(O\\) be the centre of \\(\\Omega\\). Note that \\(O N \\perp A C, O N^{\\prime} \\perp A^{\\prime} C^{\\prime}\\) and \\(O N=O N^{\\prime}\\) so \\(N N^{\\prime}\\) is parallel to the angle bisector \\(I I^{\\prime}\\) of \\(A C\\) and \\(A^{\\prime} C^{\\prime}\\). Thus \\(I I^{\\prime} \\| N N^{\\prime}\\) which is antiparallel to \\(B B^{\\prime}\\) with respect to \\(B I\\) and \\(B^{\\prime} I^{\\prime}\\). Therefore \\(B, I, I^{\\prime}, B^{\\prime}\\) are concyclic.\n![](https://cdn.mathpix.com/cropped/2025_08_23_bba1c16f961fdd6f4eb4g-60.jpg?height=954&width=1063&top_left_y=928&top_left_x=502)\n\nFurther define \\(P\\) as the intersection of \\(A C\\) and \\(A^{\\prime} C^{\\prime}\\) and \\(M\\) as the antipode of \\(N^{\\prime}\\) in \\(\\Omega\\). Consider the circle \\(\\Gamma_{1}\\) with centre \\(N\\) and radius \\(N A=N C\\) and the circle \\(\\Gamma_{2}\\) with centre \\(M\\) and radius \\(M A^{\\prime}=M C^{\\prime}\\). Their radical axis passes through \\(P\\) and is perpendicular to \\(M N \\perp N N^{\\prime} \\| I P\\), so \\(I\\) lies on their radical axis. Therefore, since \\(I\\) lies on \\(\\Gamma_{1}\\), it must also lie on \\(\\Gamma_{2}\\). Thus, if we define \\(Z\\) as the second intersection of \\(M I\\) with \\(\\Omega\\), we have that \\(I\\) is the incentre of triangle \\(Z A^{\\prime} C^{\\prime}\\). (Note that the point \\(Z\\) can also be constructed directly via Poncelet's porism.)\n\nConsider the incircle \\(\\omega_{c}\\) with centre \\(I_{c}\\) of triangle \\(C^{\\prime} B^{\\prime} Z\\). Note that \\(\\angle Z I C^{\\prime}=90^{\\circ}+ \\frac{1}{2} \\angle Z A^{\\prime} C^{\\prime}=90^{\\circ}+\\frac{1}{2} \\angle Z B^{\\prime} C^{\\prime}=\\angle Z I_{c} C^{\\prime}\\), so \\(Z, I, I_{c}, C^{\\prime}\\) are concyclic. Similarly \\(B^{\\prime}, I^{\\prime}, I_{c}, C^{\\prime}\\) are concyclic.\n\nThe external centre of dilation from \\(\\omega\\) to \\(\\omega_{c}\\) is the intersection of \\(I I_{c}\\) and \\(C^{\\prime} Z\\) ( \\(D\\) in the picture), that is the radical centre of circles \\(\\Omega, C^{\\prime} I_{c} I Z\\) and \\(I I^{\\prime} I_{c}\\). Similarly, the external centre of dilation from \\(\\omega^{\\prime}\\) to \\(\\omega_{c}\\) is the intersection of \\(I^{\\prime} I_{c}\\) and \\(B^{\\prime} C^{\\prime}\\) ( \\(D^{\\prime}\\) in the picture), that is the radical centre of circles \\(\\Omega, B^{\\prime} I^{\\prime} I_{c} C^{\\prime}\\) and \\(I I^{\\prime} I_{c}\\). Therefore the Monge line of \\(\\omega, \\omega^{\\prime}\\) and \\(\\omega_{c}\\) is line \\(D D^{\\prime}\\), and the radical axis of \\(\\Omega\\) and circle \\(I I^{\\prime} I_{c}\\) coincide. Hence the external centre \\(T\\) of dilation from \\(\\omega\\) to \\(\\omega^{\\prime}\\) is also on the radical axis of \\(\\Omega\\) and circle \\(I I^{\\prime} I_{c}\\).\n![](https://cdn.mathpix.com/cropped/2025_08_23_bba1c16f961fdd6f4eb4g-61.jpg?height=1014&width=952&top_left_y=237&top_left_x=559)\n\nNow since \\(B, I, I^{\\prime}, B^{\\prime}\\) are concyclic, the intersection \\(T^{\\prime}\\) of \\(B B^{\\prime}\\) and \\(I I^{\\prime}\\) is on the radical axis of \\(\\Omega\\) and circle \\(I I^{\\prime} I_{c}\\). Thus \\(T^{\\prime}=T\\) and \\(T\\) lies on line \\(B B^{\\prime}\\). Finally, construct a circle \\(\\Omega_{0}\\) tangent to \\(A^{\\prime} B^{\\prime}, B^{\\prime} C^{\\prime}, A B\\) on the same side of these lines as \\(\\omega^{\\prime}\\). The centre of dilation from \\(\\omega^{\\prime}\\) to \\(\\Omega_{0}\\) is \\(B^{\\prime}\\), so by Monge's theorem the external centre of dilation from \\(\\Omega_{0}\\) to \\(\\omega\\) must be on the line \\(T B B^{\\prime}\\). However, it is on line \\(A B\\), so it must be \\(B\\) and \\(B C\\) must be tangent to \\(\\Omega_{0}\\) as desired.\n![](https://cdn.mathpix.com/cropped/2025_08_23_bba1c16f961fdd6f4eb4g-61.jpg?height=906&width=1349&top_left_y=1647&top_left_x=359)\n\n\\section*{Number Theory}", "source_pdf": "imosl_2022.pdf", "notes": "fallback-regex"}
{"id": "IMOSL-2022-N1", "contest": "IMOSL", "year": "2022", "problem_number": "N1", "problem": "A number is called Norwegian if it has three distinct positive divisors whose sum is equal to 2022. Determine the smallest Norwegian number.\n(Note: The total number of positive divisors of a Norwegian number is allowed to be larger than 3.)\n(Cyprus)", "solution": "Answer: 1344\n\n. Observe that 1344 is a Norwegian number as 6, 672 and 1344 are three distinct divisors of 1344 and \\(6+672+1344=2022\\). It remains to show that this is the smallest such number.\n\nAssume for contradiction that \\(N<1344\\) is Norwegian and let \\(N / a, N / b\\) and \\(N / c\\) be the three distinct divisors of \\(N\\), with \\(a<b<c\\). Then\n\\[\n2022=N\\left(\\frac{1}{a}+\\frac{1}{b}+\\frac{1}{c}\\right)<1344\\left(\\frac{1}{a}+\\frac{1}{b}+\\frac{1}{c}\\right)\n\\]\nand so\n\\[\n\\left(\\frac{1}{a}+\\frac{1}{b}+\\frac{1}{c}\\right)>\\frac{2022}{1344}=\\frac{337}{224}=\\frac{3}{2}+\\frac{1}{224} .\n\\]\n\nIf \\(a>1\\) then\n\\[\n\\frac{1}{a}+\\frac{1}{b}+\\frac{1}{c} \\leqslant \\frac{1}{2}+\\frac{1}{3}+\\frac{1}{4}=\\frac{13}{12}<\\frac{3}{2}\n\\]\nso it must be the case that \\(a=1\\). Similarly, it must hold that \\(b<4\\) since otherwise\n\\[\n1+\\frac{1}{b}+\\frac{1}{c} \\leqslant 1+\\frac{1}{4}+\\frac{1}{5}<\\frac{3}{2}\n\\]\n\nThis leaves two cases to check, \\(b=2\\) and \\(b=3\\).\nCase \\(b=3\\). Then\n\\[\n\\frac{1}{c}>\\frac{3}{2}+\\frac{1}{224}-1-\\frac{1}{3}>\\frac{1}{6}\n\\]\nso \\(c=4\\) or \\(c=5\\). If \\(c=4\\) then\n\\[\n2022=N\\left(1+\\frac{1}{3}+\\frac{1}{4}\\right)=\\frac{19}{12} N,\n\\]\nbut this is impossible as \\(19 \\nmid 2022\\). If \\(c=5\\) then\n\\[\n2022=N\\left(1+\\frac{1}{3}+\\frac{1}{5}\\right)=\\frac{23}{15} N\n\\]\nwhich again is impossible, as \\(23 \\nmid 2022\\).\nCase \\(b=2\\). Note that \\(c<224\\) since\n\\[\n\\frac{1}{c}>\\frac{3}{2}+\\frac{1}{224}-1-\\frac{1}{2}=\\frac{1}{224}\n\\]\n\nIt holds that\n\\[\n2022=N\\left(1+\\frac{1}{2}+\\frac{1}{c}\\right)=\\frac{3 c+2}{2 c} N \\Rightarrow(3 c+2) N=4044 c\n\\]\n\nSince \\((c, 3 c-2)=(c, 2) \\in\\{1,2\\}\\), then \\(3 c+2 \\mid 8088=2^{3} \\cdot 3 \\cdot 337\\) which implies that \\(3 c+2 \\mid 2^{3} \\cdot 337\\). But since \\(3 c+2 \\geqslant 3 \\cdot 3+2>8=2^{3}\\) and \\(3 c+2 \\neq 337\\), then it must hold that \\(3 c+2 \\geqslant 2 \\cdot 337\\), contradicting \\(c<224\\).", "source_pdf": "imosl_2022.pdf", "notes": "fallback-regex"}
{"id": "IMOSL-2022-N2", "contest": "IMOSL", "year": "2022", "problem_number": "N2", "problem": "Find all positive integers \\(n>2\\) such that\n\\[\nn!\\mid \\prod_{\\substack{p<q \\leqslant n, p, q \\text { primes }}}(p+q) .\n\\]\n(Nigeria)", "solution": "Answer: This only holds for \\(n=7\\).\n\n. Assume that \\(n\\) satisfies \\(n!\\mid \\prod_{p<q \\leqslant n}(p+q)\\) and let \\(2=p_{1}<p_{2}<\\cdots<p_{m} \\leqslant n\\) be the primes in \\(\\{1,2, \\ldots, n\\}\\). Each such prime divides \\(n!\\). In particular, \\(p_{m} \\mid p_{i}+p_{j}\\) for some \\(p_{i}<p_{j} \\leqslant n\\). But\n\\[\n0<\\frac{p_{i}+p_{j}}{p_{m}}<\\frac{p_{m}+p_{m}}{p_{m}}=2\n\\]\nso \\(p_{m}=p_{i}+p_{j}\\) which implies \\(m \\geqslant 3, p_{i}=2\\) and \\(p_{m}=2+p_{j}=2+p_{m-1}\\).\nSimilarly, \\(p_{m-1} \\mid p_{k}+p_{l}\\) for some \\(p_{k}<p_{l} \\leqslant n\\). But\n\\[\n0<\\frac{p_{l}+p_{k}}{p_{m-1}} \\leqslant \\frac{p_{m}+p_{m-1}}{p_{m-1}}=\\frac{2 p_{m-1}+2}{p_{m-1}}<3\n\\]\nso either \\(p_{m-1}=p_{l}+p_{k}\\) or \\(2 p_{m-1}=p_{l}+p_{k}\\). As above, the former case gives \\(p_{m-1}=2+p_{m-2}\\). If \\(2 p_{m-1}=p_{l}+p_{k}\\), then \\(p_{m-1}<p_{k}\\), so \\(k=m\\) and\n\\[\n2 p_{m-1}=p_{l}+p_{m-1}+2 \\Rightarrow p_{m-1}=p_{l}+2=p_{m-2}+2\n\\]\n\nEither way, \\(p_{m-2}>2\\) and 3 divides one of \\(p_{m-2}, p_{m-1}=p_{m-2}+2\\) and \\(p_{m}=p_{m-2}+4\\). This implies \\(p_{m-2}=3\\) and thus \\(p_{m}=7\\), giving \\(7 \\leqslant n<11\\).\n\nFinally, a quick computation shows that \\(7!\\mid \\prod_{p<q \\leqslant 7}(p+q)\\) but \\(8!\\nmid \\prod_{p<q \\leqslant 7}(p+q)\\), so neither does \\(9!\\) and \\(10!\\).", "source_pdf": "imosl_2022.pdf", "notes": "fallback-regex"}
{"id": "IMOSL-2022-N3", "contest": "IMOSL", "year": "2022", "problem_number": "N3", "problem": "Let \\(a>1\\) be a positive integer, and let \\(d>1\\) be a positive integer coprime to \\(a\\). Let \\(x_{1}=1\\) and, for \\(k \\geqslant 1\\), define\n\\[\nx_{k+1}= \\begin{cases}x_{k}+d & \\text { if } a \\text { doesn't divide } x_{k} \\\\ x_{k} / a & \\text { if } a \\text { divides } x_{k}\\end{cases}\n\\]\n\nFind the greatest positive integer \\(n\\) for which there exists an index \\(k\\) such that \\(x_{k}\\) is divisible by \\(a^{n}\\).\n(Croatia)", "solution": "Answer: \\(n\\) is the exponent with \\(d<a^{n}<a d\\).\n\n1. By trivial induction, \\(x_{k}\\) is coprime to \\(d\\).\nBy induction and the fact that there can be at most \\(a-1\\) consecutive increasing terms in the sequence, it also holds that \\(x_{k}<d a\\) if \\(x_{k}=x_{k-1}+d\\) and that \\(x_{k}<d\\) if \\(x_{k}=\\frac{x_{k-1}}{a}\\) or \\(k=1\\). This gives the upper bound on the exponent.\n\nThis implies that the sequence is (eventually) periodic, and that both increasing and decreasing steps happen infinitely many times. Let \\(a^{-k}\\) be the multiplicative inverse of \\(a^{k}\\) modulo \\(d\\). The sequence contains elements congruent to \\(1, a^{-1}, a^{-2}, \\ldots\\) modulo \\(d\\).\n\nLet \\(x_{k_{0}}\\) the first element such that \\(x_{k_{0}} \\equiv a^{-n}(\\bmod d)\\). We have either \\(k_{0}=1\\) or \\(x_{k_{0}}= x_{k_{0}-1} / a\\); in both cases \\(x_{k_{0}}<d<a^{n}<d a\\) and therefore\n\\[\nx_{k_{0}} \\in\\left\\{a^{n}-d, a^{n}-2 d, \\ldots, a^{n}-(a-1) d\\right\\} .\n\\]\n\nIn this set no element is divisible by \\(a\\), so therefore the sequence will visit the value \\(a^{n}\\) in the next \\(a-1\\) steps.\n\nSolution 2. Like in the first solution, \\(x_{k}\\) is relatively prime to \\(d\\) and \\(x_{k}<a d\\) for all \\(k\\).\nLet\n\\[\nS=\\left\\{x \\in \\mathbb{Z}_{>0}: 0<x<a d, \\operatorname{gcd}(x, d)=1\\right\\} \\quad \\text { and } \\quad f: S \\rightarrow S, f(x)= \\begin{cases}x+d & \\text { if } a \\nmid x \\\\ x / a & \\text { if } a \\mid x\\end{cases}\n\\]\n\nSo, we have \\(x_{1}=1\\) and \\(x_{k+1}=f\\left(x_{k}\\right)\\).\nNotice that the recurrence formula is invertible. Suppose that \\(f(x)=y\\) for some \\(x, y \\in S\\). If \\(y>d\\) then \\(y-d \\in S\\) but \\(a \\cdot y \\notin S\\); otherwise, if \\(y<d\\) then \\(a \\cdot y \\in S\\) but \\(y-d \\notin S\\). So, the function \\(f\\) is a permutation on \\(S\\), and its inverse is\n\\[\nf^{-1}(y)=\\left\\{\\begin{array}{ll}\ny-d & \\text { if } y>d, \\\\\na \\cdot y & \\text { if } y<d\n\\end{array} \\quad \\text { for all } y \\in S\\right.\n\\]\n\nIt follows that the sequence is periodic, and therefore attains the initial value 1 infinitely many times. Let \\(k_{1}>1\\) be an index such that \\(x_{k_{1}}=1\\). Then\n\\[\nx_{k_{1}}=1, \\quad x_{k_{1}-1}=f^{-1}(1)=a, x_{k_{1}-2}=f^{-1}(a)=a^{2}, \\ldots, \\quad x_{k_{1}-n}=a^{n}\n\\]\n\nSolution 3. Like in the first solution, \\(x_{k}\\) is relatively prime to \\(d\\) and \\(x_{k}<a d\\) for all \\(k\\).\nWe wish to prove that there are \\(n\\) consecutive decreasing indices. Let \\(m_{0}=0\\) and \\(m_{k}\\) be the \\(k\\)-th smallest decreasing index (an index \\(k\\) is decreasing if \\(x_{k}=x_{k-1} / a\\) ) and define a sequence \\(\\left(y_{k}\\right)_{k}=\\left(x_{m_{k}}\\right)_{k}\\), i.e. the subsequence consisting only of elements with decreasing indices. For each \\(k \\geqslant 1\\) we can write\n\\[\ny_{k+1}=\\frac{y_{k}+z_{k} d}{a}\n\\]\nfor some \\(z_{k} \\in\\{0,1, \\ldots, a-1\\}\\), where \\(z_{k}=0\\) if and only if \\(y_{k}\\) and \\(y_{k+1}\\) are consecutive elements in the original sequence. Then\n\\[\ny_{k}=\\frac{1+\\left(z_{0}+z_{1} a+\\cdots+z_{k-1} a^{k-1}\\right) d}{a^{k}},\n\\]\nbecause \\(y_{k}\\) is bounded the sequence is (eventually) periodic. Consider some \\(y_{u}=y_{u+v}\\) where \\(v \\geqslant 1\\). We can write\n\\[\ny_{u}=\\frac{1+\\left(z_{0}+z_{1} a+\\cdots+z_{u-1} a^{u-1}\\right) d}{a^{u}}\n\\]\nand\n\\[\ny_{u+v}=\\frac{1+\\left(z_{0}+z_{1} a+\\cdots+z_{u+v-1} a^{u+v-1}\\right) d}{a^{u+v}}\n\\]\nand so\n\\[\n\\frac{1+\\left(z_{0}+z_{1} a+\\cdots+z_{u+v-1} a^{u+v-1}\\right) d}{a^{u+v}}=\\frac{1+\\left(z_{0}+z_{1} a+\\cdots+z_{u-1} a^{u-1}\\right) d}{a^{u}} .\n\\]\n\nRearranging gives\n\\[\n\\frac{a^{v}-1}{d}=z_{0}+z_{1} a+\\cdots+z_{v-1} a^{v-1}+\\left(z_{v}-z_{0}\\right) a^{v}+\\cdots+\\left(z_{u+v-1}-z_{u-1}\\right) a^{u+v-1} .\n\\]\n\nSince \\(d>a^{n} / a=a^{n-1}\\) the LHS is strictly less than \\(a^{v-n}\\). This implies that on the RHS, the coefficients of \\(a^{v-n}, a^{v-n+1}, \\ldots\\) must all be zero, i.e. \\(z_{v-n}=z_{v-n+1}=\\cdots=z_{v-1}=0\\). This implies that there are \\(n\\) consecutive decreasing indices in the original sequence.", "source_pdf": "imosl_2022.pdf", "notes": "fallback-regex"}
{"id": "IMOSL-2022-N5", "contest": "IMOSL", "year": "2022", "problem_number": "N5", "problem": "For each \\(1 \\leqslant i \\leqslant 9\\) and \\(T \\in \\mathbb{N}\\), define \\(d_{i}(T)\\) to be the total number of times the digit \\(i\\) appears when all the multiples of 1829 between 1 and \\(T\\) inclusive are written out in base 10 .\n\nShow that there are infinitely many \\(T \\in \\mathbb{N}\\) such that there are precisely two distinct values among \\(d_{1}(T), d_{2}(T), \\ldots, d_{9}(T)\\).\n(United Kingdom)", "solution": ". Let \\(n:=1829\\). First, we choose some \\(k\\) such that \\(n \\mid 10^{k}-1\\). For instance, any multiple of \\(\\varphi(n)\\) would work since \\(n\\) is coprime to 10 . We will show that either \\(T=10^{k}-1\\) or \\(T=10^{k}-2\\) has the desired property, which completes the proof since \\(k\\) can be taken to be arbitrary large.\n\nFor this it suffices to show that \\(\\#\\left\\{d_{i}\\left(10^{k}-1\\right): 1 \\leqslant i \\leqslant 9\\right\\} \\leqslant 2\\). Indeed, if\n\\[\n\\#\\left\\{d_{i}\\left(10^{k}-1\\right): 1 \\leqslant i \\leqslant 9\\right\\}=1\n\\]\nthen, since \\(10^{k}-1\\) which consists of all nines is a multiple of \\(n\\), we have\n\\[\nd_{i}\\left(10^{k}-2\\right)=d_{i}\\left(10^{k}-1\\right) \\text { for } i \\in\\{1, \\ldots, 8\\}, \\text { and } d_{9}\\left(10^{k}-2\\right)<d_{9}\\left(10^{k}-1\\right)\n\\]\n\nThis means that \\(\\#\\left\\{d_{i}\\left(10^{k}-2\\right): 1 \\leqslant i \\leqslant 9\\right\\}=2\\).\nTo prove that \\(\\#\\left\\{d_{i}\\left(10^{k}-1\\right)\\right\\} \\leqslant 2\\) we need an observation. Let \\(\\overline{a_{k-1} a_{k-2} \\ldots a_{0}} \\in\\left\\{1, \\ldots, 10^{k}-1\\right\\}\\) be the decimal expansion of an arbitrary number, possibly with leading zeroes. Then \\(\\overline{a_{k-1} a_{k-2} \\ldots a_{0}}\\) is divisible by \\(n\\) if and only if \\(\\overline{a_{k-2} \\ldots a_{0} a_{k-1}}\\) is divisible by \\(n\\). Indeed, this follows from the fact that\n\\[\n10 \\cdot \\overline{a_{k-1} a_{k-2} \\ldots a_{0}}-\\overline{a_{k-2} \\ldots a_{0} a_{k-1}}=\\left(10^{k}-1\\right) \\cdot a_{k-1}\n\\]\nis divisible by \\(n\\).\nThis observation shows that the set of multiples of \\(n\\) between 1 and \\(10^{k}-1\\) is invariant under simultaneous cyclic permutation of digits when numbers are written with leading zeroes. Hence, for each \\(i \\in\\{1, \\ldots, 9\\}\\) the number \\(d_{i}\\left(10^{k}-1\\right)\\) is \\(k\\) times larger than the number of \\(k\\) digit numbers which start from the digit \\(i\\) and are divisible by \\(n\\). Since the latter number is either \\(\\left\\lfloor 10^{k-1} / n\\right\\rfloor\\) or \\(1+\\left\\lfloor 10^{k-1} / n\\right\\rfloor\\), we conclude that \\(\\#\\left\\{d_{i}\\left(10^{k}-1\\right)\\right\\} \\leqslant 2\\).\n\nComment. More careful analysis shows that \\(\\#\\left\\{d_{i}\\left(10^{k}-1\\right): 1 \\leqslant i \\leqslant 9\\right\\}=1\\) if and only if \\(n \\equiv 1 (\\bmod 10)\\), which is not the case for \\(n=1829\\).", "source_pdf": "imosl_2022.pdf", "notes": "fallback-regex"}
{"id": "IMOSL-2022-N6", "contest": "IMOSL", "year": "2022", "problem_number": "N6", "problem": "Let \\(Q\\) be a set of prime numbers, not necessarily finite. For a positive integer \\(n\\) consider its prime factorisation; define \\(p(n)\\) to be the sum of all the exponents and \\(q(n)\\) to be the sum of the exponents corresponding only to primes in \\(Q\\). A positive integer \\(n\\) is called special if \\(p(n)+p(n+1)\\) and \\(q(n)+q(n+1)\\) are both even integers. Prove that there is a constant \\(c>0\\) independent of the set \\(Q\\) such that for any positive integer \\(N>100\\), the number of special integers in \\([1, N]\\) is at least \\(c N\\).\n(For example, if \\(Q=\\{3,7\\}\\), then \\(p(42)=3, q(42)=2, p(63)=3, q(63)=3, p(2022)=3\\), \\(q(2022)=1\\).)\n(Costa Rica)", "solution": ". Let us call two positive integers \\(m, n\\) friends if \\(p(m)+p(n)\\) and \\(q(m)+q(n)\\) are both even integers. We start by noting that the pairs ( \\(p(k), q(k)\\) ) modulo 2 can take at most 4 different values; thus, among any five different positive integers there are two which are friends.\n\nIn addition, both functions \\(p\\) and \\(q\\) satisfy \\(f(a b)=f(a)+f(b)\\) for any \\(a, b\\). Therefore, if \\(m\\) and \\(n\\) are divisible by \\(d\\), then both \\(p\\) and \\(q\\) satisfy the equality \\(f(m)+f(n)=f(m / d)+ f(n / d)+2 f(d)\\). This implies that \\(m, n\\) are friends if and only if \\(m / d, n / d\\) are friends.\n\nLet us call a set of integers \\(\\left\\{n_{1}, n_{2}, \\ldots, n_{5}\\right\\}\\) an interesting set if for any indexes \\(i, j\\), the difference \\(d_{i j}=\\left|n_{i}-n_{j}\\right|\\) divides both \\(n_{i}\\) and \\(n_{j}\\). We claim that if elements of an interesting set are all positive, then we can obtain a special integer. Indeed, if we were able to construct such a set, then there would be a pair of integers \\(\\left\\{n_{i}, n_{j}\\right\\}\\) which are friends, according to the first observation. Additionally, the second observation yields that the quotients \\(n_{i} / d_{i j}, n_{j} / d_{i j}\\) form a pair of friends, which happen to be consecutive integers, thus giving a special integer as desired.\n\nIn order to construct a family of interesting sets, we can start by observing that the set \\(\\{0,6,8,9,12\\}\\) is an interesting set. Using that \\(72=2^{3} \\cdot 3^{2}\\) is the least common multiple of all pairwise differences in this set, we obtain a family of interesting sets by considering\n\\[\n\\{72 k, 72 k+6,72 k+8,72 k+9,72 k+12\\},\n\\]\nfor any \\(k \\geqslant 1\\). If we consider the quotients (of these numbers by the appropriate differences), then we obtain that the set\n\\[\nS_{k}=\\{6 k, 8 k, 9 k, 12 k, 12 k+1,18 k+2,24 k+2,24 k+3,36 k+3,72 k+8\\},\n\\]\nhas at least one special integer. In particular, the interval [ \\(1,100 k\\) ] contains the sets \\(S_{1}, S_{2}, \\ldots, S_{k}\\), each of which has a special number. Any special number can be contained in at most ten sets \\(S_{k}\\), from where we conclude that the number of special integers in \\([1,100 k]\\) is at least \\(k / 10\\).\n\nFinally, let \\(N=100 k+r\\), with \\(k \\geqslant 1\\) and \\(0 \\leqslant r<100\\), so that we have \\(N<100(k+1) \\leqslant 200 k\\). Then the number of special integers in \\([1, N]\\) is at least \\(k / 10>N / 2000\\), as we wanted to prove.\n\nComment 1. The statement is also true for \\(N \\geqslant 15\\) as at least one of the numbers \\(7,14,15\\) is special.\nComment 2. Another approach would be to note that if \\(p(2 n), p(2 n+1), p(2 n+2)\\) all have the same parity then one of the numbers \\(n, 2 n, 2 n+1\\) is special. Indeed, if \\(q(n)+q(n+1)\\) is even then \\(n\\) is special since \\(p(n)+p(n+1) \\equiv p(2 n)+p(2 n+2) \\equiv 0(\\bmod 2)\\). Otherwise, if \\(q(n)+q(n+1)\\) is odd, so is \\(q(2 n)+q(2 n+2)\\) which implies that exactly one of the numbers \\(2 n, 2 n+1\\) is special.\n\nUnfortunately, it seems hard to show that the set of such \\(n\\) has positive density: see a recent paper https://arxiv.org/abs/1509.01545 for the proof that all eight patterns of the parities of \\(p(n), p(n+1), p(n+2)\\) appear for a positive proportion of positive integers.", "source_pdf": "imosl_2022.pdf", "notes": "fallback-regex"}
{"id": "IMOSL-2022-N8", "contest": "IMOSL", "year": "2022", "problem_number": "N8", "problem": "Prove that \\(5^{n}-3^{n}\\) is not divisible by \\(2^{n}+65\\) for any positive integer \\(n\\).\n(Belgium)", "solution": "1. Let \\(n\\) be a positive integer, and let \\(m=2^{n}+65\\). For the sake of contradiction, suppose that \\(m \\mid 5^{n}-3^{n}\\), so \\(5^{n} \\equiv 3^{n}(\\bmod m)\\).\n\nNotice that if \\(n\\) is even, then \\(3 \\mid m\\), but \\(3 \\nmid 5^{n}-3^{n}\\), contradiction. So, from now on we assume that \\(n\\) is odd, \\(n=2 k+1\\). Obviously \\(n=1\\) is not possible, so \\(n \\geqslant 3\\). Notice that \\(m\\) is coprime to 2,3 and 5 .\n\nLet \\(m_{1}\\) be the smallest positive multiple of \\(m\\) that can be written in the form of either \\(\\left|5 a^{2}-3 b^{2}\\right|\\) or \\(\\left|a^{2}-15 b^{2}\\right|\\) with some integers \\(a\\) and \\(b\\).\n\nNote that \\(5^{n}-3^{n}=5\\left(5^{k}\\right)^{2}-3\\left(3^{k}\\right)^{2}\\) is a multiple of \\(m\\), so the set of such multiples is non-empty, and therefore \\(m_{1}\\) is well-defined.\nI. First we show that \\(m_{1} \\leqslant 5 m\\). Consider the numbers\n\\[\n5^{k+1} x+3^{k+1} y, \\quad 0 \\leqslant x, y \\leqslant \\sqrt{m}\n\\]\n\nThere are \\(\\lfloor\\sqrt{m}\\rfloor+1>\\sqrt{m}\\) choices for \\(x\\) and \\(y\\), so there are more than \\(m\\) possible pairs ( \\(x, y\\) ). Hence, two of these sums are congruent modulo \\(m: 5^{k+1} x_{1}+3^{k+1} y_{1} \\equiv 5^{k+1} x_{2}+3^{k+1} y_{2}(\\bmod m)\\).\n\nNow choose \\(a=x_{1}-x_{2}\\) and \\(b=y_{1}-y_{2}\\); at least one of \\(a, b\\) is nonzero, and\n\\[\n5^{k+1} a+3^{k+1} b \\equiv 0 \\quad(\\bmod m), \\quad|a|,|b| \\leqslant \\sqrt{m}\n\\]\n\nFrom\n\\[\n0 \\equiv\\left(5^{k+1} a\\right)^{2}-\\left(3^{k+1} b\\right)^{2}=5^{n+1} a^{2}-3^{n+1} b^{2} \\equiv 5 \\cdot 3^{n} a^{2}-3^{n+1} b^{2}=3^{n}\\left(5 a^{2}-3 b^{2}\\right) \\quad(\\bmod m)\n\\]\nwe can see that \\(\\left|5 a^{2}-3 b^{2}\\right|\\) is a multiple of \\(m\\). Since at least one of \\(a\\) and \\(b\\) is nonzero, \\(5 a^{2} \\neq 3 b^{2}\\). Hence, by the choice of \\(a, b\\), we have \\(0<\\left|5 a^{2}-3 b^{2}\\right| \\leqslant \\max \\left(5 a^{2}, 3 b^{2}\\right) \\leqslant 5 m\\). That shows that \\(m_{1} \\leqslant 5 m\\).\nII. Next, we show that \\(m_{1}\\) cannot be divisible by 2,3 and 5 . Since \\(m_{1}\\) equals either \\(\\left|5 a^{2}-3 b^{2}\\right|\\) or \\(\\left|a^{2}-15 b^{2}\\right|\\) with some integers \\(a, b\\), we have six cases to check. In all six cases, we will get a contradiction by presenting another multiple of \\(m\\), smaller than \\(m_{1}\\).\n- If \\(5 \\mid m_{1}\\) and \\(m_{1}=\\left|5 a^{2}-3 b^{2}\\right|\\), then \\(5 \\mid b\\) and \\(\\left|a^{2}-15\\left(\\frac{b}{5}\\right)^{2}\\right|=\\frac{m_{1}}{5}<m_{1}\\).\n- If \\(5 \\mid m_{1}\\) and \\(m_{1}=\\left|a^{2}-15 b^{2}\\right|\\), then \\(5 \\mid a\\) and \\(\\left|5\\left(\\frac{a}{5}\\right)^{2}-3 b^{2}\\right|=\\frac{m_{1}}{5}<m_{1}\\).\n- If \\(3 \\mid m_{1}\\) and \\(m_{1}=\\left|5 a^{2}-3 b^{2}\\right|\\), then \\(3 \\mid a\\) and \\(\\left|b^{2}-15\\left(\\frac{a}{3}\\right)^{2}\\right|=\\frac{m_{1}}{3}<m_{1}\\).\n- If \\(3 \\mid m_{1}\\) and \\(m_{1}=\\left|a^{2}-15 b^{2}\\right|\\), then \\(3 \\mid a\\) and \\(\\left|5 b^{2}-3\\left(\\frac{a}{3}\\right)^{2}\\right|=\\frac{m_{1}}{3}<m_{1}\\).\n- If \\(2 \\mid m_{1}\\) and \\(m_{1}=\\left|5 a^{2}-3 b^{2}\\right|\\), then \\(\\left|\\left(\\frac{5 a-3 b}{2}\\right)^{2}-15\\left(\\frac{a-b}{2}\\right)^{2}\\right|=\\frac{m_{1}}{2}<m_{1}\\).\n- If \\(2 \\mid m_{1}\\) and \\(m_{1}=\\left|a^{2}-15 b^{2}\\right|\\), then \\(\\left|5\\left(\\frac{a-3 b}{2}\\right)^{2}-3\\left(\\frac{a-5 b}{2}\\right)^{2}\\right|=\\frac{m_{1}}{2}<m_{1}\\).\n(The last two expressions can be obtained from \\((\\sqrt{5} a+\\sqrt{3} b)(\\sqrt{5}-\\sqrt{3})=(5 a-3 b)+\\sqrt{15}(b-a)\\) and \\((a+\\sqrt{15} b)(\\sqrt{5}-\\sqrt{3})=\\sqrt{5}(a-3 b)+\\sqrt{3}(5 b-a)\\).)\n\nIn all six cases, we found that either \\(\\frac{m_{1}}{2}, \\frac{m_{1}}{3}\\) or \\(\\frac{m_{1}}{5}\\) is of the form \\(\\left|5 x^{2}-3 y^{2}\\right|\\) or \\(\\left|x^{2}-15 y^{2}\\right|\\). Since \\(m\\) is coprime to 2,3 and 5 , the presented number is a multiple of \\(m\\), but this contradicts the minimality of \\(m_{1}\\).\nIII. The last remaining case is \\(m_{1}=m\\), so either \\(m=\\left|5 a^{2}-3 b^{2}\\right|\\) or \\(m=\\left|a^{2}-15 b^{2}\\right|\\). We will get a contradiction by considering the two sides modulo 3,4 and 5 .\n- \\(2^{n}+65=5 a^{2}-3 b^{2}\\) is not possible, because \\(2^{n}+65 \\equiv 1(\\bmod 3)\\), but \\(5 a^{2}-3 b^{2} \\not \\equiv 1 (\\bmod 3)\\).\n- \\(2^{n}+65=3 b^{2}-5 a^{2}\\) is not possible, because \\(2^{n}+65 \\equiv 1(\\bmod 4)\\), but \\(3 b^{2}-5 a^{2} \\not \\equiv 1 (\\bmod 4)\\).\n- \\(2^{n}+65=a^{2}-15 b^{2}\\) is not possible, because \\(2^{n}+65 \\equiv \\pm 2(\\bmod 5)\\), but \\(a^{2}-15 b^{2} \\not \\equiv \\pm 2 (\\bmod 5)\\).\n- \\(2^{n}+65=15 b^{2}-a^{2}\\) is not possible, because \\(2^{n}+65 \\equiv 1(\\bmod 4)\\), but \\(15 b^{2}-a^{2} \\not \\equiv 1 (\\bmod 4)\\).\n\nWe found a contradiction in all cases, that completes the solution.\nComment 1. Part I is a standard application of Thue's lemma:\nLemma (Thue). Suppose that \\(m>1\\) and \\(c\\) are integers, and \\(X, Y\\) are positive integers such that \\(X \\leqslant m<X Y\\). Then there exist some integers \\(x, y\\) with \\(|x|<X\\) and \\(0<y<Y\\), such that \\(x \\equiv c y(\\bmod m)\\).\n\nIt is a well-known corollary that if \\(c, d\\) are coprime to \\(m\\), the congruence \\(c x^{2} \\equiv d y^{2}(\\bmod m)\\) has a solution such that \\(x, y\\) are coprime to \\(m\\), and \\(X, Y\\) are positive integers such that \\(X Y>m\\), then \\(c x^{2} \\equiv d y^{2}(\\bmod m)\\) has a solution such that at least one of \\(x, y\\) is nonzero, \\(|x|<X\\) and \\(|y|<Y\\).\n\nIn the solution we applied this corollary with \\(c=5, d=3, X=Y=\\lfloor\\sqrt{m}\\rfloor+1\\).\nComment 2. In fact, we proved that a positive integer \\(m\\) with \\(m \\equiv 13\\) or \\(37(\\bmod 60)\\) cannot divide any nonzero integer of the form \\(5 a^{2}-3 b^{2}\\) or \\(a^{2}-15 b^{2}\\) with coprime integers \\(a, b\\). In other words, if \\(m \\equiv 13\\) or \\(37(\\bmod 60)\\), then 15 is not a quadratic residue modulo \\(m\\). Using the tools of quadratic reciprocity, the solution can be significantly shortened.\n\nSuppose that \\(a\\) and \\(b\\) are coprime. For every prime divisor \\(p>5\\) of \\(5 a^{2}-3 b^{2}\\) or \\(a^{2}-15 b^{2}\\), we have\n\\[\n1=\\left(\\frac{15}{p}\\right)=\\left(\\frac{3}{p}\\right)\\left(\\frac{5}{p}\\right)=(-1)^{\\frac{p-1}{2}}\\left(\\frac{p}{3}\\right)\\left(\\frac{p}{5}\\right)\n\\]\nwhere \\(\\left(\\frac{a}{p}\\right)\\) stands for the Legendre symbol. Considering the remainders of \\(p\\) when divided by 4,3 and 5, (1) leads to\n\\[\np \\equiv \\pm 1, \\pm 7, \\pm 11 \\text { or } \\pm 17 \\bmod 60\n\\]\n\nThese remainders form a subgroup of the reduced remainders modulo 60. Since 13 and 37 are not elements in this subgroup, the number \\(m=2^{n}+65\\) cannot be a product of such primes.\n\nInstead of handling the prime divisors of \\(m\\) separately, we can use Jacobi symbols for further simplification, as shown in the next solution.\n\nSolution 2. Suppose again that \\(5^{n} \\equiv 3^{n}\\left(\\bmod m=2^{n}+65\\right)\\). Like in the first solution, we conclude that \\(n\\) must be odd, and \\(n \\geqslant 3\\), so \\(8 \\mid 2^{n}\\).\n\nUsing Jacobi symbols,\n\\(-1=\\left(\\frac{2^{n}+65}{5}\\right)=\\left(\\frac{5}{2^{n}+65}\\right)=\\left(\\frac{5^{n}}{2^{n}+65}\\right)=\\left(\\frac{3^{n}}{2^{n}+65}\\right)=\\left(\\frac{3}{2^{n}+65}\\right)=\\left(\\frac{2^{n}+65}{3}\\right)=1\\), contradiction.", "source_pdf": "imosl_2022.pdf", "notes": "fallback-regex"}
{"id": "IMOSL-2023-A1", "contest": "IMOSL", "year": "2023", "problem_number": "A1", "problem": "Professor Oak is feeding his 100 Pok\u00e9mon. Each Pok\u00e9mon has a bowl whose capacity is a positive real number of kilograms. These capacities are known to Professor Oak. The total capacity of all the bowls is 100 kilograms. Professor Oak distributes 100 kilograms of food in such a way that each Pok\u00e9mon receives a non-negative integer number of kilograms of food (which may be larger than the capacity of their bowl). The dissatisfaction level of a Pok\u00e9mon who received \\(N\\) kilograms of food and whose bowl has a capacity of \\(C\\) kilograms is equal to \\(|N-C|\\).\n\nFind the smallest real number \\(D\\) such that, regardless of the capacities of the bowls, Professor Oak can distribute the food in a way that the sum of the dissatisfaction levels over all the 100 Pok\u00e9mon is at most \\(D\\).\n(Ukraine)", "solution": "Answer: The answer is \\(D=50\\).\n\n1. First, consider the situation where 99 bowls have a capacity of 0.5 kilograms and the last bowl has a capacity of 50.5 kilograms. No matter how Professor Oak distributes the food, the dissatisfaction level of every Pok\u00e9mon will be at least 0.5 . This amounts to a total dissatisfaction level of at least 50 , proving that \\(D \\geqslant 50\\).\n\nNow we prove that no matter what the capacities of the bowls are, Professor Oak can always distribute food in a way that the total dissatisfaction level is at most 50 . We start by fixing some notation. We number the Pok\u00e9mon from 1 to 100 . Let \\(C_{i}>0\\) be the capacity of the bowl of the \\(i^{\\text {th }}\\) Pok\u00e9mon. By assumption, we have \\(C_{1}+C_{2}+\\cdots+C_{100}=100\\). We write \\(F_{i}:=C_{i}-\\left\\lfloor C_{i}\\right\\rfloor\\) for the fractional part of \\(C_{i}\\). Without loss of generality, we may assume that \\(F_{1} \\leqslant F_{2} \\leqslant \\cdots \\leqslant F_{100}\\).\n\nHere is a strategy: Professor Oak starts by giving \\(\\left\\lfloor C_{i}\\right\\rfloor\\) kilograms of food to the \\(i^{\\text {th }}\\) Pok\u00e9mon. Let\n\\[\nR:=100-\\left\\lfloor C_{1}\\right\\rfloor-\\left\\lfloor C_{2}\\right\\rfloor-\\cdots-\\left\\lfloor C_{100}\\right\\rfloor=F_{1}+F_{2}+\\cdots+F_{100} \\geqslant 0\n\\]\nbe the amount of food left. He continues by giving an extra kilogram of food to the \\(R\\) Pok\u00e9mon numbered \\(100-R+1,100-R+2, \\ldots, 100\\), i.e. the Pok\u00e9mon with the \\(R\\) largest values of \\(F_{i}\\). By doing so, Professor Oak distributed 100 kilograms of food. The total dissatisfaction level with this strategy is\n\\[\nd:=F_{1}+\\cdots+F_{100-R}+\\left(1-F_{100-R+1}\\right)+\\cdots+\\left(1-F_{100}\\right) .\n\\]\n\nWe can rewrite\n\\[\n\\begin{aligned}\nd & =2\\left(F_{1}+\\cdots+F_{100-R}\\right)+R-\\left(F_{1}+\\cdots+F_{100}\\right) \\\\\n& =2\\left(F_{1}+\\cdots+F_{100-R}\\right)\n\\end{aligned}\n\\]\n\nNow, observe that the arithmetic mean of \\(F_{1}, F_{2}, \\ldots, F_{100-R}\\) is not greater than the arithmetic mean of \\(F_{1}, F_{2}, \\ldots, F_{100}\\), because we assumed \\(F_{1} \\leqslant F_{2} \\leqslant \\cdots \\leqslant F_{100}\\). Therefore\n\\[\nd \\leqslant 2(100-R) \\cdot \\frac{F_{1}+\\cdots+F_{100}}{100}=2 \\cdot \\frac{R(100-R)}{100} .\n\\]\n\nFinally, we use the AM-GM inequality to see that \\(R(100-R) \\leqslant \\frac{100^{2}}{2^{2}}\\) which implies \\(d \\leqslant 50\\). We conclude that there is always a distribution for which the total dissatisfaction level is at most 50 , proving that \\(D \\leqslant 50\\).\n\nSolution 2. We adopt the same notation as in Solution 1. Let \\(C_{i}>0\\) be the capacity of the bowl of the \\(i^{\\text {th }}\\) Pok\u00e9mon. By assumption, we have \\(C_{1}+C_{2}+\\cdots+C_{100}=100\\). We write \\(F_{i}:=C_{i}-\\left\\lfloor C_{i}\\right\\rfloor\\) for the fractional part of \\(C_{i}\\), and \\(R=F_{1}+F_{2}+\\cdots+F_{100}\\). Note that \\(R=100-\\left\\lfloor C_{1}\\right\\rfloor-\\cdots-\\left\\lfloor C_{100}\\right\\rfloor\\) is an integer.\n\nThis solution uses the probabilistic method. We consider all distributions in which each Pok\u00e9mon receives \\(\\left\\lfloor C_{i}\\right\\rfloor+\\varepsilon_{i}\\) kilograms of food, where \\(\\varepsilon_{i} \\in\\{0,1\\}\\) and \\(\\varepsilon_{1}+\\varepsilon_{2}+\\cdots+\\varepsilon_{100}=R\\). There are \\(\\binom{100}{R}\\) such distributions. Suppose each of them occurs in an equal probability. In other words,\n\\[\n\\varepsilon_{i}= \\begin{cases}0 & \\text { with probability } \\frac{100-R}{100} \\\\ 1 & \\text { with probability } \\frac{R}{100}\\end{cases}\n\\]\n\nThe expected value of the dissatisfaction level of the \\(i^{\\text {th }}\\) Pok\u00e9mon is\n\\[\n\\frac{100-R}{100}\\left(C_{i}-\\left\\lfloor C_{i}\\right\\rfloor\\right)+\\frac{R}{100}\\left(\\left\\lfloor C_{i}\\right\\rfloor+1-C_{i}\\right)=\\frac{100-R}{100} F_{i}+\\frac{R}{100}\\left(1-F_{i}\\right) .\n\\]\n\nHence, the expected value of the total dissatisfaction level is\n\\[\n\\begin{aligned}\n\\sum_{i=1}^{100}\\left(\\frac{100-R}{100} F_{i}+\\frac{R}{100}\\left(1-F_{i}\\right)\\right) & =\\frac{100-R}{100} \\sum_{i=1}^{100} F_{i}+\\frac{R}{100} \\sum_{i=1}^{100}\\left(1-F_{i}\\right) \\\\\n& =\\frac{100-R}{100} \\cdot R+\\frac{R}{100} \\cdot(100-R) \\\\\n& =2 \\cdot \\frac{R(100-R)}{100}\n\\end{aligned}\n\\]\n\nAs in Solution 1, this is at most 50. We conclude that there is at least one distribution for which the total dissatisfaction level is at most 50 .", "source_pdf": "imosl_2023.pdf", "notes": "fallback-regex"}
{"id": "IMOSL-2023-A2", "contest": "IMOSL", "year": "2023", "problem_number": "A2", "problem": "Let \\(\\mathbb{R}\\) be the set of real numbers. Let \\(f: \\mathbb{R} \\rightarrow \\mathbb{R}\\) be a function such that\n\\[\nf(x+y) f(x-y) \\geqslant f(x)^{2}-f(y)^{2}\n\\]\nfor every \\(x, y \\in \\mathbb{R}\\). Assume that the inequality is strict for some \\(x_{0}, y_{0} \\in \\mathbb{R}\\).\nProve that \\(f(x) \\geqslant 0\\) for every \\(x \\in \\mathbb{R}\\) or \\(f(x) \\leqslant 0\\) for every \\(x \\in \\mathbb{R}\\).\n(Malaysia)", "solution": "Common remarks. We will say that \\(f\\) has constant sign, if \\(f\\) satisfies the conclusion of the problem.\n\n1. We introduce the new variables \\(s:=x+y\\) and \\(t:=x-y\\). Equivalently, \\(x=\\frac{s+t}{2}\\) and \\(y=\\frac{s-t}{2}\\). The inequality becomes\n\\[\nf(s) f(t) \\geqslant f\\left(\\frac{s+t}{2}\\right)^{2}-f\\left(\\frac{s-t}{2}\\right)^{2}\n\\]\nfor every \\(s, t \\in \\mathbb{R}\\). We replace \\(t\\) by \\(-t\\) to obtain\n\\[\nf(s) f(-t) \\geqslant f\\left(\\frac{s-t}{2}\\right)^{2}-f\\left(\\frac{s+t}{2}\\right)^{2}\n\\]\n\nSumming the previous two inequalities gives\n\\[\nf(s)(f(t)+f(-t)) \\geqslant 0\n\\]\nfor every \\(s, t \\in \\mathbb{R}\\). This inequality is strict for \\(s=x_{0}+y_{0}\\) and \\(t=x_{0}-y_{0}\\) by assumption. In particular, there exists some \\(t_{0}=x_{0}-y_{0}\\) for which \\(f\\left(t_{0}\\right)+f\\left(-t_{0}\\right) \\neq 0\\). Since \\(f(s)\\left(f\\left(t_{0}\\right)+\\right. \\left.f\\left(-t_{0}\\right)\\right) \\geqslant 0\\) for every \\(s \\in \\mathbb{R}\\), we conclude that \\(f(s)\\) must have constant sign.\n\nSolution 2. We do the same change of variables as in Solution 1 to obtain\n\\[\nf(s) f(t) \\geqslant f\\left(\\frac{s+t}{2}\\right)^{2}-f\\left(\\frac{s-t}{2}\\right)^{2}\n\\]\n\nIn this solution, we replace \\(s\\) by \\(-s\\) (instead of \\(t\\) by \\(-t\\) ). This gives\n\\[\nf(-s) f(t) \\geqslant f\\left(\\frac{-s+t}{2}\\right)^{2}-f\\left(\\frac{-s-t}{2}\\right)^{2}\n\\]\n\nWe now go back to the original inequality. Substituting \\(x=y\\) gives \\(f(2 x) f(0) \\geqslant 0\\) for every \\(x \\in \\mathbb{R}\\). If \\(f(0) \\neq 0\\), then we conclude that \\(f\\) indeed has constant sign. From now on, we will assume that\n\\[\nf(0)=0\n\\]\n\nSubstituting \\(x=-y\\) gives \\(f(-x)^{2} \\geqslant f(x)^{2}\\). By permuting \\(x\\) and \\(-x\\), we conclude that\n\\[\nf(-x)^{2}=f(x)^{2}\n\\]\nfor every \\(x \\in \\mathbb{R}\\).\nUsing the relation \\(f(x)^{2}=f(-x)^{2}\\), we can rewrite (2) as\n\\[\nf(-s) f(t) \\geqslant f\\left(\\frac{s-t}{2}\\right)^{2}-f\\left(\\frac{s+t}{2}\\right)^{2}\n\\]\n\nSumming this inequality with (1), we obtain\n\\[\n(f(s)+f(-s)) f(t) \\geqslant 0\n\\]\nfor every \\(s, t \\in \\mathbb{R}\\) and we can conclude as in Solution 1.\n\nSolution 3. We prove the contrapositive of the problem statement. Assume that there exist \\(a, b \\in \\mathbb{R}\\) such that \\(f(a)<0\\) and \\(f(b)>0\\). We want to prove that the inequality is actually an equality, i.e. it is never strict.\nLemma 1. The function \\(f\\) is odd, i.e. \\(f(x)+f(-x)=0\\) for every \\(x \\in \\mathbb{R}\\).\nProof. We plug in \\(x=\\frac{a+u}{2}\\) and \\(y=\\frac{a-u}{2}\\) in the original inequality, where \\(u\\) is a free variable. We obtain\n\\[\nf(a) f(u) \\geqslant f\\left(\\frac{a+u}{2}\\right)^{2}-f\\left(\\frac{a-u}{2}\\right)^{2}\n\\]\n\nReplacing \\(u\\) with \\(-u\\) and summing the two inequalities as in the previous solutions, we get\n\\[\nf(a)(f(u)+f(-u)) \\geqslant 0\n\\]\nfor every \\(u \\in \\mathbb{R}\\). Since \\(f(a)<0\\) by assumption, we conclude that \\(f(u)+f(-u) \\leqslant 0\\) for every \\(u \\in \\mathbb{R}\\).\n\nWe can repeat the above argument with \\(b\\) instead of \\(a\\). Since \\(f(b)>0\\) by assumption, we conclude that \\(f(u)+f(-u) \\geqslant 0\\) for every \\(u \\in \\mathbb{R}\\). This implies that \\(f(u)+f(-u)=0\\) for every \\(u \\in \\mathbb{R}\\).\n\nNow, using that \\(f\\) is odd, we can write the following chain of inequalities\n\\[\n\\begin{aligned}\nf(x)^{2}-f(y)^{2} & \\leqslant f(x+y) f(x-y) \\\\\n& =-f(y+x) f(y-x) \\\\\n& \\leqslant-\\left(f(y)^{2}-f(x)^{2}\\right) \\\\\n& =f(x)^{2}-f(y)^{2}\n\\end{aligned}\n\\]\n\nWe conclude that every inequality above is actually an inequality, so\n\\[\nf(x+y) f(x-y)=f(x)^{2}-f(y)^{2}\n\\]\nfor every \\(x, y \\in \\mathbb{R}\\).\nSolution 4. As in Solution 3, we prove the contrapositive of the statement. Assume that there exist \\(a, b \\in \\mathbb{R}\\) such that \\(f(a) f(b)<0\\). We want to prove that the inequality is actually an equality, i.e. it is never strict.\n\nIn this solution, we construct an argument by multiplying inequalities, rather than adding them as in Solutions 1-3.\nLemma 2. \\(f(b) f(-b)<0\\).\nProof. Let \\(x_{1}:=\\frac{a+b}{2}\\) and \\(y_{1}:=\\frac{a-b}{2}\\) so that \\(a=x_{1}+y_{1}\\) and \\(b=x_{1}-y_{1}\\). Plugging in \\(x=x_{1}\\) and \\(y=y_{1}\\), we obtain\n\\[\n0>f(a) f(b)=f\\left(x_{1}+y_{1}\\right) f\\left(x_{1}-y_{1}\\right) \\geqslant f\\left(x_{1}\\right)^{2}-f\\left(y_{1}\\right)^{2}\n\\]\nwhich implies \\(f\\left(x_{1}\\right)^{2}-f\\left(y_{1}\\right)^{2}<0\\). Similarly, by plugging in \\(x=y_{1}\\) and \\(y=x_{1}\\), we get\n\\[\nf(a) f(-b)=f\\left(y_{1}+x_{1}\\right) f\\left(y_{1}-x_{1}\\right) \\geqslant f\\left(y_{1}\\right)^{2}-f\\left(x_{1}\\right)^{2} .\n\\]\n\nUsing \\(f\\left(x_{1}\\right)^{2}-f\\left(y_{1}\\right)^{2}<0\\), we conclude \\(f(a) f(-b)>0\\). If we multiply the two inequalities \\(f(a) f(b)<0\\) and \\(f(a) f(-b)>0\\), we get \\(f(a)^{2} f(b) f(-b)<0\\) and hence\n\\[\nf(b) f(-b)<0\n\\]\n\nLemma 3. \\(f(x) f(-x) \\leqslant 0\\) for every \\(x \\in \\mathbb{R}\\).\n\nProof. As in Solution 2, we prove that \\(f(x)^{2}=f(-x)^{2}\\) for every \\(x \\in \\mathbb{R}\\) and we rewrite the original inequality as\n\\[\nf(s) f(t) \\geqslant f\\left(\\frac{s+t}{2}\\right)^{2}-f\\left(\\frac{s-t}{2}\\right)^{2}\n\\]\n\nWe replace \\(s\\) by \\(-s\\) and \\(t\\) by \\(-t\\), and use the relation \\(f(x)^{2}=f(-x)^{2}\\), to get\n\\[\n\\begin{aligned}\nf(-s) f(-t) & \\geqslant f\\left(\\frac{-s-t}{2}\\right)^{2}-f\\left(\\frac{-s+t}{2}\\right)^{2} \\\\\n& =f\\left(\\frac{s+t}{2}\\right)^{2}-f\\left(\\frac{s-t}{2}\\right)^{2}\n\\end{aligned}\n\\]\n\nUp to replacing \\(t\\) by \\(-t\\), we can assume that \\(f\\left(\\frac{s+t}{2}\\right)^{2}-f\\left(\\frac{s-t}{2}\\right)^{2} \\geqslant 0\\). Multiplying the two previous inequalities leads to\n\\[\nf(s) f(-s) f(t) f(-t) \\geqslant 0\n\\]\nfor every \\(s, t \\in \\mathbb{R}\\). This shows that \\(f(s) f(-s)\\) (as a function of \\(s\\) ) has constant sign. Since \\(f(b) f(-b)<0\\), we conclude that\n\\[\nf(x) f(-x) \\leqslant 0\n\\]\nfor every \\(x \\in \\mathbb{R}\\).\nLemma 3, combined with the relation \\(f(x)^{2}=f(-x)^{2}\\), implies \\(f(x)+f(-x)=0\\) for every \\(x \\in \\mathbb{R}\\), i.e. \\(f\\) is odd. We conclude with the same argument as in Solution 3.\n\nComment. The presence of squares on the right-hand side of the inequality is not crucial as Solution 1 illustrates very well. However, it allows non-constant functions such as \\(f(x)=|x|\\) to satisfy the conditions of the problem statement.", "source_pdf": "imosl_2023.pdf", "notes": "fallback-regex"}
{"id": "IMOSL-2023-A4", "contest": "IMOSL", "year": "2023", "problem_number": "A4", "problem": "Let \\(\\mathbb{R}_{>0}\\) be the set of positive real numbers. Determine all functions \\(f: \\mathbb{R}_{>0} \\rightarrow \\mathbb{R}_{>0}\\) such that\n\\[\nx(f(x)+f(y)) \\geqslant(f(f(x))+y) f(y)\n\\]\nfor every \\(x, y \\in \\mathbb{R}_{>0}\\).\n(Belgium)", "solution": "Answer: All functions \\(f(x)=\\frac{c}{x}\\) for some \\(c>0\\).\n\n1. Let \\(f: \\mathbb{R}_{>0} \\rightarrow \\mathbb{R}_{>0}\\) be a function that satisfies the inequality of the problem statement. We will write \\(f^{k}(x)=f(f(\\cdots f(x) \\cdots))\\) for the composition of \\(f\\) with itself \\(k\\) times, with the convention that \\(f^{0}(x)=x\\). Substituting \\(y=x\\) gives\n\\[\nx \\geqslant f^{2}(x)\n\\]\n\nSubstituting \\(x=f(y)\\) instead leads to \\(f(y)+f^{2}(y) \\geqslant y+f^{3}(y)\\), or equivalently\n\\[\nf(y)-f^{3}(y) \\geqslant y-f^{2}(y)\n\\]\n\nWe can generalise this inequality. If we replace \\(y\\) by \\(f^{n-1}(y)\\) in the above inequality, we get\n\\[\nf^{n}(y)-f^{n+2}(y) \\geqslant f^{n-1}(y)-f^{n+1}(y)\n\\]\nfor every \\(y \\in \\mathbb{R}_{>0}\\) and for every integer \\(n \\geqslant 1\\). In particular, \\(f^{n}(y)-f^{n+2}(y) \\geqslant y-f^{2}(y) \\geqslant 0\\) for every \\(n \\geqslant 1\\). Hereafter consider even integers \\(n=2 m\\). Observe that\n\\[\ny-f^{2 m}(y)=\\sum_{i=0}^{m-1}\\left(f^{2 i}(y)-f^{2 i+2}(y)\\right) \\geqslant m\\left(y-f^{2}(y)\\right)\n\\]\n\nSince \\(f\\) takes positive values, it holds that \\(y-f^{2 m}(y)<y\\) for every \\(m \\geqslant 1\\). So, we have proved that \\(y>m\\left(y-f^{2}(y)\\right)\\) for every \\(y \\in \\mathbb{R}_{>0}\\) and every \\(m \\geqslant 1\\). Since \\(y-f^{2}(y) \\geqslant 0\\), this holds if only if\n\\[\nf^{2}(y)=y\n\\]\nfor every \\(y \\in \\mathbb{R}_{>0}\\). The original inequality becomes\n\\[\nx f(x) \\geqslant y f(y)\n\\]\nfor every \\(x, y \\in \\mathbb{R}_{>0}\\). Hence, \\(x f(x)\\) is constant. We conclude that \\(f(x)=c / x\\) for some \\(c>0\\).\nWe now check that all the functions of the form \\(f(x)=c / x\\) are indeed solutions of the original problem. First, note that all these functions satisfy \\(f(f(x))=c /(c / x)=x\\). So it's sufficient to check that \\(x f(x) \\geqslant y f(y)\\), which is true since \\(c \\geqslant c\\).\n\nSolution 2. Let \\(f: \\mathbb{R}_{>0} \\rightarrow \\mathbb{R}_{>0}\\) be a function that satisfies the inequality of the problem statement. As in Solution 1, we prove that\n\\[\nf^{n}(y) \\geqslant f^{n+2}(y)\n\\]\nfor every \\(y \\in \\mathbb{R}_{>0}\\) and every \\(n \\geqslant 0\\). Since \\(f\\) takes positive values, this implies that\n\\[\ny f(y) \\geqslant f(y) f^{2}(y) \\geqslant f^{2}(y) f^{3}(y) \\geqslant \\cdots\n\\]\n\nIn other words, \\(y f(y) \\geqslant f^{n}(y) f^{n+1}(y)\\) for every \\(y \\in \\mathbb{R}_{>0}\\) and every \\(n \\geqslant 1\\).\n\nWe replace \\(x\\) by \\(f^{n}(x)\\) in the original inequality and get\n\\[\nf^{n}(x)-f^{n+2}(x) \\geqslant \\frac{y f(y)-f^{n}(x) f^{n+1}(x)}{f(y)} .\n\\]\n\nUsing that \\(x f(x) \\geqslant f^{n}(x) f^{n+1}(x)\\), we obtain\n\\[\nf^{n}(x)-f^{n+2}(x) \\geqslant \\frac{y f(y)-x f(x)}{f(y)}\n\\]\nfor every \\(n \\geqslant 0\\). The same trick as in Solution 1 gives\n\\[\nx>x-f^{2 m}(x)=\\sum_{i=0}^{m-1}\\left(f^{2 i}(x)-f^{2 i+2}(x)\\right) \\geqslant m \\cdot \\frac{y f(y)-x f(x)}{f(y)}\n\\]\nfor every \\(x, y \\in \\mathbb{R}_{>0}\\) and every \\(m \\geqslant 1\\). Possibly permuting \\(x\\) and \\(y\\), we may assume that \\(y f(y)-x f(x) \\geqslant 0\\) then the above inequality implies \\(x f(x)=y f(y)\\). We conclude as in Solution 1.", "source_pdf": "imosl_2023.pdf", "notes": "fallback-regex"}
{"id": "IMOSL-2023-A5", "contest": "IMOSL", "year": "2023", "problem_number": "A5", "problem": "Let \\(a_{1}, a_{2}, \\ldots, a_{2023}\\) be positive integers such that\n- \\(a_{1}, a_{2}, \\ldots, a_{2023}\\) is a permutation of \\(1,2, \\ldots, 2023\\), and\n- \\(\\left|a_{1}-a_{2}\\right|,\\left|a_{2}-a_{3}\\right|, \\ldots,\\left|a_{2022}-a_{2023}\\right|\\) is a permutation of \\(1,2, \\ldots, 2022\\).\n\nProve that \\(\\max \\left(a_{1}, a_{2023}\\right) \\geqslant 507\\).\n(Australia)", "solution": ". For the sake of clarity, we consider and prove the following generalisation of the original problem (which is the case \\(N=1012\\) ):\n\nLet \\(N\\) be a positive integer and \\(a_{1}, a_{2}, \\ldots, a_{2 N-1}\\) be positive integers such that\n- \\(a_{1}, a_{2}, \\ldots, a_{2 N-1}\\) is a permutation of \\(1,2, \\ldots, 2 N-1\\), and\n- \\(\\left|a_{1}-a_{2}\\right|,\\left|a_{2}-a_{3}\\right|, \\ldots,\\left|a_{2 N-2}-a_{2 N-1}\\right|\\) is a permutation of \\(1,2, \\ldots, 2 N-2\\).\n\nThen \\(a_{1}+a_{2 N-1} \\geqslant N+1\\) and hence \\(\\max \\left(a_{1}, a_{2 N-1}\\right) \\geqslant\\left\\lceil\\frac{N+1}{2}\\right\\rceil\\).\nNow we proceed to the proof of the generalised statement. We introduce the notion of score of a number \\(a \\in\\{1,2, \\ldots, 2 N-1\\}\\). The score of \\(a\\) is defined to be\n\\[\ns(a):=|a-N| .\n\\]\n\nNote that, by the triangle inequality,\n\\[\n|a-b| \\leqslant|a-N|+|N-b|=s(a)+s(b)\n\\]\n\nConsidering the sum \\(\\left|a_{1}-a_{2}\\right|+\\left|a_{2}-a_{3}\\right|+\\cdots+\\left|a_{2 N-2}-a_{2 N-1}\\right|\\), we find that\n\\[\n\\begin{aligned}\n(N-1)(2 N-1) & =\\left|a_{1}-a_{2}\\right|+\\left|a_{2}-a_{3}\\right|+\\cdots+\\left|a_{2 N-2}-a_{2 N-1}\\right| \\\\\n& \\leqslant 2\\left(s\\left(a_{1}\\right)+s\\left(a_{2}\\right)+\\cdots+s\\left(a_{2 N-1}\\right)\\right)-\\left(s\\left(a_{1}\\right)+s\\left(a_{2 N-1}\\right)\\right) \\\\\n& =2 N(N-1)-\\left(s\\left(a_{1}\\right)+s\\left(a_{2 N-1}\\right)\\right)\n\\end{aligned}\n\\]\n\nFor the last equality we used that the numbers \\(s\\left(a_{1}\\right), s\\left(a_{2}\\right), \\ldots, s\\left(a_{2 N-1}\\right)\\) are a permutation of \\(0,1,1,2,2, \\ldots, N-1, N-1\\).\n\nHence, \\(s\\left(a_{1}\\right)+s\\left(a_{2 N-1}\\right) \\leqslant 2 N(N-1)-(N-1)(2 N-1)=N-1\\). We conclude that\n\\[\n\\left(N-a_{1}\\right)+\\left(N-a_{2 N-1}\\right) \\leqslant s\\left(a_{1}\\right)+s\\left(a_{2 N-1}\\right) \\leqslant N-1,\n\\]\nwhich implies \\(a_{1}+a_{2 N-1} \\geqslant N+1\\).\nComment 1. In the case \\(N=1012\\), such a sequence with \\(\\max \\left(a_{1}, a_{2023}\\right)=507\\) indeed exists:\n\\[\n507,1517,508,1516, \\ldots, 1011,1013,1012,2023,1,2022,2, \\ldots, 1518,506 .\n\\]\n\nFor a general even number \\(N\\), a sequence with \\(\\max \\left(a_{1}, a_{2 N-1}\\right)=\\left\\lceil\\frac{N+1}{2}\\right\\rceil\\) can be obtained similarly. If \\(N \\geqslant 3\\) is odd, the inequality is not sharp, because \\(\\max \\left(a_{1}, a_{2 N-1}\\right)=\\frac{N+1}{2}\\) and \\(a_{1}+a_{2 N-1} \\geqslant N+1\\) together imply \\(a_{1}=a_{2 N-1}=\\frac{N+1}{2}\\), a contradiction.\n\nComment 2. The formulation of the author's submission was slightly different:\nAuthor's formulation. Consider a sequence of positive integers \\(a_{1}, a_{2}, a_{3}, \\ldots\\) such that the following conditions hold for all positive integers \\(m\\) and \\(n\\) :\n- \\(a_{n+2023}=a_{n}+2023\\),\n- If \\(\\left|a_{n+1}-a_{n}\\right|=\\left|a_{m+1}-a_{m}\\right|\\), then \\(2023 \\mid(n-m)\\), and\n- The sequence contains every positive integer.\n\nProve that \\(a_{1} \\geqslant 507\\).\nThe two formulations are equivalent up to relatively trivial arguments. Suppose ( \\(a_{n}\\) ) is a sequence satisfying the author's formulation. From the first and third conditions, we see that \\(a_{1}, \\ldots, a_{2023}\\) is a permutation of \\(1, \\ldots, 2023\\). Moreover, the sequence \\(\\left|a_{i}-a_{i+1}\\right|\\) for \\(i=1,2, \\ldots, 2022\\) consists of positive integers \\(\\leqslant 2022\\) and has pairwise distinct elements by the second condition. Hence, it is a permutation of \\(1, \\ldots, 2022\\). It also holds that \\(a_{1}>a_{2023}\\), since if \\(a_{1}<a_{2023}\\) then \\(\\left|a_{2024}-a_{2023}\\right|= \\left|2023+a_{1}-a_{2023}\\right| \\leqslant 2022\\), which should be equal to \\(\\left|a_{i}-a_{i+1}\\right|\\) for some \\(1 \\leqslant i \\leqslant 2022\\), contradicting the second condition. This reduces the problem to the Shortlist formulation.\n\nConversely, if the numbers \\(a_{1}, \\ldots, a_{2023}\\) satisfy the conditions of the Shortlist formulation, then, after possibly reversing the sequence to ensure \\(a_{1}>a_{2023}\\), the sequence can be extended to an infinite sequence satisfying the conditions of the author's formulation.", "source_pdf": "imosl_2023.pdf", "notes": "fallback-regex"}
{"id": "IMOSL-2023-A7", "contest": "IMOSL", "year": "2023", "problem_number": "A7", "problem": "Let \\(N\\) be a positive integer. Prove that there exist three permutations \\(a_{1}, a_{2}, \\ldots, a_{N}\\); \\(b_{1}, b_{2}, \\ldots, b_{N}\\); and \\(c_{1}, c_{2}, \\ldots, c_{N}\\) of \\(1,2, \\ldots, N\\) such that\n\\[\n\\left|\\sqrt{a_{k}}+\\sqrt{b_{k}}+\\sqrt{c_{k}}-2 \\sqrt{N}\\right|<2023\n\\]\nfor every \\(k=1,2, \\ldots, N\\).\n(China)", "solution": "1. The idea is to approximate the numbers \\(\\sqrt{1}, \\sqrt{2}, \\ldots, \\sqrt{N}\\) by the nearest integer with errors \\(<0.5\\). This gives the following sequence\n\\[\n1,1,2,2,2,2,3,3,3,3,3,3,4, \\ldots\n\\]\n\nMore precisely, for each \\(k \\geqslant 1\\), we round \\(\\sqrt{k^{2}-k+1}, \\ldots, \\sqrt{k^{2}+k}\\) to \\(k\\), so that there are \\(2 k\\) copies of \\(k\\).\n\nStep 1. We first consider the easier case when \\(N\\) has the form\n\\[\nN=m(m+1) .\n\\]\n\nIn this case, the numbers \\(\\sqrt{1}, \\sqrt{2}, \\ldots, \\sqrt{N}\\) are approximated by the elements of the multiset \\(\\left\\{1_{\\times 2}, 2_{\\times 4}, 3_{\\times 6}, \\ldots, m_{\\times 2 m}\\right\\}\\). Let \\(T_{m}\\) denote \"half of\" the multiset, i.e.\n\\[\nT_{m}:=\\left\\{1_{\\times 1}, 2_{\\times 2}, 3_{\\times 3}, \\ldots, m_{\\times m}\\right\\} .\n\\]\n\nWe will prove by induction that there exists three permutations \\(\\left(u_{k}\\right),\\left(v_{k}\\right)\\), and \\(\\left(w_{k}\\right)\\) of the elements in the multiset \\(T_{m}\\) such that \\(u_{k}+v_{k}+w_{k}=2 m+1\\) is constant for \\(k=1,2, \\ldots, \\frac{m(m+1)}{2}\\).\n\nWhen \\(m=1\\), take \\(1+1+1=3\\). When \\(m=2\\), take \\((1,2,2)+(2,1,2)+(2,2,1)=(5,5,5)\\). Suppose that we have constructed three permutations \\(\\left(u_{k}\\right),\\left(v_{k}\\right)\\), and \\(\\left(w_{k}\\right)\\) of \\(T_{m-1}\\) satisfying \\(u_{k}+v_{k}+w_{k}=2 m-1\\) for every \\(k=1,2, \\ldots, \\frac{m(m-1)}{2}\\). For \\(T_{m}\\), we note that\n\\[\nT_{m}=T_{m-1} \\sqcup\\left\\{m_{\\times m}\\right\\},\n\\]\nand also\n\\[\nT_{m}=\\left(T_{m-1}+1\\right) \\sqcup\\{1,2, \\ldots, m\\} .\n\\]\n\nHere \\(T_{m-1}+1\\) means to add 1 to all elements in \\(T_{m-1}\\). We construct the permutations ( \\(u_{k}^{\\prime}\\) ), ( \\(v_{k}^{\\prime}\\) ), and ( \\(w_{k}^{\\prime}\\) ) of \\(T_{m}\\) as follows:\n- For \\(k=1,2, \\ldots, \\frac{m(m-1)}{2}\\), we set \\(u_{k}^{\\prime}=u_{k}, v_{k}^{\\prime}=v_{k}+1, w_{k}^{\\prime}=w_{k}+1\\).\n- For \\(k=\\frac{m(m-1)}{2}+r\\) with \\(r=1,2, \\ldots, m\\), we set \\(u_{k}^{\\prime}=m, v_{k}^{\\prime}=r, w_{k}^{\\prime}=m+1-r\\).\n\nIt is clear from (1) that ( \\(u_{k}^{\\prime}\\) ), ( \\(v_{k}^{\\prime}\\) ), and ( \\(w_{k}^{\\prime}\\) ) give three permutations of \\(T_{m}\\), and that they satisfy \\(u_{k}^{\\prime}+v_{k}^{\\prime}+w_{k}^{\\prime}=2 m+1\\) for every \\(k=1,2, \\ldots, \\frac{m(m+1)}{2}\\).\n\nThe inductive construction can be visualised by the \\(3 \\times \\frac{m(m+1)}{2}\\) matrix\n\\[\n\\left[\\begin{array}{cccccc}\nu_{1} & \\ldots & u_{m(m-1) / 2} & m & \\ldots & m \\\\\nv_{1}+1 & \\ldots & v_{m(m-1) / 2}+1 & 1 & \\ldots & m \\\\\nw_{1}+1 & \\ldots & w_{m(m-1) / 2}+1 & m & \\ldots & 1\n\\end{array}\\right]\n\\]\nin which the three rows represent the permutations \\(\\left(u_{k}^{\\prime}\\right),\\left(v_{k}^{\\prime}\\right),\\left(w_{k}^{\\prime}\\right)\\), and the sum of the three entries of each column is \\(2 m+1\\).\n\nThus, when \\(N=m^{2}+m\\), we can construct permutations ( \\(a_{k}\\) ), ( \\(b_{k}\\) ), and ( \\(c_{k}\\) ) of \\(1,2, \\ldots, N\\) such that\n\\[\n2 m+1-1.5<\\sqrt{a_{k}}+\\sqrt{b_{k}}+\\sqrt{c_{k}}<2 m+1+1.5\n\\]\n\nThis gives\n\\[\n\\left|\\sqrt{a_{k}}+\\sqrt{b_{k}}+\\sqrt{c_{k}}-2 \\sqrt{N}\\right|<2.5<2023\n\\]\nwhere we used that \\(-1<2 m-2 \\sqrt{m^{2}+m}<0\\) for positive \\(m\\).\nStep 2. We now proceed to the general case. Let \\(m\\) be such that\n\\[\nm(m+1) \\leqslant N<(m+1)(m+2)\n\\]\n\nWrite \\(N=m(m+1)+t\\) for some \\(t \\in\\{0,1, \\ldots, 2 m+1\\}\\) and let\n\\[\nL:=\\left\\lfloor\\frac{4}{9} N\\right\\rfloor\n\\]\n\nWe will make use of the following inequalities below:\n\\[\nN>m^{2}, \\quad N<(m+2)^{2}, \\quad t \\leqslant 2 m+1, \\quad L+1>4 N / 9, \\quad L \\leqslant 4 N / 9\n\\]\n\nAs above, we construct three permutations \\(\\left(a_{k}\\right),\\left(b_{k}\\right)\\), and \\(\\left(c_{k}\\right)\\) of \\(1,2, \\ldots, m(m+1)\\) satisfying (2). Now we construct the three required permutations \\(\\left(A_{k}\\right),\\left(B_{k}\\right)\\), and \\(\\left(C_{k}\\right)\\) of \\(1,2, \\ldots, N\\) as follows:\n\nFor \\(k=1,2, \\ldots, m(m+1)\\), if \\(a_{k} \\leqslant L\\), take \\(A_{k}=a_{k}\\), and if \\(a_{k}>L\\), take \\(A_{k}=a_{k}+t\\). For \\(k=m(m+1)+r\\) with \\(r=1,2, \\ldots, t\\), set \\(A_{k}=L+r\\). Define the permutations ( \\(B_{k}\\) ) and ( \\(C_{k}\\) ) similarly. Now for \\(k=1,2, \\ldots, m(m+1)\\), we show \\(0 \\leqslant \\sqrt{A_{k}}-\\sqrt{a_{k}} \\leqslant 2\\). The lower bound is obvious. If \\(m \\leqslant 1\\), then \\(N \\leqslant 5\\) and hence \\(\\sqrt{A_{k}}-\\sqrt{a_{k}} \\leqslant \\sqrt{5}-\\sqrt{1} \\leqslant 2\\). If \\(m \\geqslant 2\\), then\n\\[\n\\sqrt{A_{k}}-\\sqrt{a_{k}}=\\frac{A_{k}-a_{k}}{\\sqrt{A_{k}}+\\sqrt{a_{k}}} \\leqslant \\frac{t}{2 \\sqrt{L+1}} \\leqslant \\frac{2 m+1}{\\frac{4}{3} m} \\leqslant 2\n\\]\n\nWe have similar inequalities for \\(\\left(B_{k}\\right)\\) and \\(\\left(C_{k}\\right)\\). Thus\n\\[\n2 \\sqrt{N}-4.5<2 m+1-1.5 \\leqslant \\sqrt{A_{k}}+\\sqrt{B_{k}}+\\sqrt{C_{k}} \\leqslant 2 m+1+1.5+6<2 \\sqrt{N}+8.5\n\\]\n\nFor \\(k=m^{2}+m+1, \\ldots, m^{2}+m+t\\), we have\n\\[\n2 \\sqrt{N}<3 \\sqrt{L+1} \\leqslant \\sqrt{A_{k}}+\\sqrt{B_{k}}+\\sqrt{C_{k}} \\leqslant 3 \\sqrt{L+t} \\leqslant \\sqrt{4 N+9 t}<2 \\sqrt{N}+8.5\n\\]\n\nTo sum up, we have defined three permutations \\(\\left(A_{k}\\right),\\left(B_{k}\\right)\\), and \\(\\left(C_{k}\\right)\\) of \\(1,2, \\ldots, N\\), such that\n\\[\n\\left|\\sqrt{A_{k}}+\\sqrt{B_{k}}+\\sqrt{C_{k}}-2 \\sqrt{N}\\right|<8.5<2023\n\\]\nholds for every \\(k=1,2, \\ldots, N\\).\nSolution 2. This is a variation of Solution 1 that uses induction for Step 2.\nLet \\(n\\) be an integer satisfying \\(0 \\leqslant n \\leqslant m+1\\) and define the multiset \\(T_{m, n}\\) by\n\\[\nT_{m, n}:=\\left\\{1_{\\times 1}, 2_{\\times 2}, 3_{\\times 3}, \\ldots, m_{\\times m},(m+1)_{\\times n}\\right\\}\n\\]\n\nIn other words, \\(T_{m, 0}=T_{m}, T_{m, n}=T_{m} \\sqcup\\left\\{(m+1)_{\\times n}\\right\\}\\) and \\(T_{m, m+1}=T_{m+1}\\), where \\(T_{m}\\) is the set defined in Solution 1.\n\nClaim. There exist three permutations \\(\\left(u_{k}\\right),\\left(v_{k}\\right),\\left(w_{k}\\right)\\) of \\(T_{m, n}\\) such that\n\\[\n\\begin{cases}u_{k}+v_{k}+w_{k}=2 m+1 & (n=0), \\\\ u_{k}+v_{k}+w_{k} \\in\\{2 m+1,2 m+2,2 m+3\\} & (1 \\leqslant n \\leqslant m), \\\\ u_{k}+v_{k}+w_{k}=2 m+3 & (n=m+1) .\\end{cases}\n\\]\n\nProof. We proceed by induction on \\(m\\). If \\(n=0\\) or \\(n=m+1\\), the assertion can be proved as in Solution 1. If \\(1 \\leqslant n \\leqslant m\\), we note that\n\\[\nT_{m, n}=T_{m-1, n} \\sqcup\\left\\{m_{\\times(m-n)},(m+1)_{\\times n}\\right\\}=\\left(T_{m-1, n}+1\\right) \\sqcup\\{1,2, \\ldots, m\\} .\n\\]\n\nFrom the hypothesis of induction, it follows that we have three permutations \\(\\left(u_{k}\\right),\\left(v_{k}\\right),\\left(w_{k}\\right)\\) of \\(T_{m-1, n}\\) satisfying \\(u_{k}+v_{k}+w_{k} \\in\\{2 m-1,2 m, 2 m+1\\}\\) for every \\(k\\). We construct the permutations \\(\\left(u_{k}^{\\prime}\\right),\\left(v_{k}^{\\prime}\\right)\\), and \\(\\left(w_{k}^{\\prime}\\right)\\) of \\(T_{m, n}\\) as follows:\n- For \\(k=1,2, \\ldots, \\frac{m(m-1)}{2}+n\\), we set \\(u_{k}^{\\prime}=u_{k}, v_{k}^{\\prime}=v_{k}+1\\), and \\(w_{k}^{\\prime}=w_{k}+1\\).\n- For \\(k=\\frac{m(m-1)}{2}+n+r\\) with \\(r=1,2, \\ldots, m\\), we set \\(u_{k}^{\\prime}=m\\) if \\(1 \\leqslant r \\leqslant m-n\\) while \\(u_{k}^{\\prime}=m+1\\) if \\(m-n+1 \\leqslant r \\leqslant m, v_{k}^{\\prime}=r\\), and \\(w_{k}^{\\prime}=m+1-r\\).\n\nIt is clear from the construction that \\(\\left(u_{k}^{\\prime}\\right),\\left(v_{k}^{\\prime}\\right)\\), and \\(\\left(w_{k}^{\\prime}\\right)\\) give three permutations of \\(T_{m, n}\\), and they satisfy \\(u_{k}^{\\prime}+v_{k}^{\\prime}+w_{k}^{\\prime} \\in\\{2 m+1,2 m+2,2 m+3\\}\\) for every \\(k=1,2, \\ldots, \\frac{m(m+1)}{2}+n\\).\n\nAgain, we can visualise the construction using the matrix\n\\[\n\\left[\\begin{array}{ccccccccc}\nu_{1} & \\ldots & u_{m(m-1) / 2+n} & m & \\ldots & m & m+1 & \\ldots & m+1 \\\\\nv_{1}+1 & \\ldots & v_{m(m-1) / 2+n}+1 & 1 & \\ldots & \\ldots & \\ldots & \\ldots & m \\\\\nw_{1}+1 & \\ldots & w_{m(m-1) / 2+n}+1 & m & \\ldots & \\ldots & \\ldots & \\ldots & 1\n\\end{array}\\right] .\n\\]\n\nIn general, we have \\(m(m+1) \\leqslant N<(m+1)(m+2)\\) for some \\(m \\geqslant 0\\). Set \\(N=m(m+1)+t\\) for some \\(t \\in\\{0,1, \\ldots, 2 m+1\\}\\). Then the approximation of \\(\\{\\sqrt{1}, \\sqrt{2}, \\ldots, \\sqrt{N}\\}\\) by the nearest integer with errors \\(<0.5\\) is a multiset\n\\[\n\\left\\{1_{\\times 2}, 2_{\\times 4}, \\ldots, m_{\\times 2 m},(m+1)_{\\times t}\\right\\}=T_{m, n_{1}} \\sqcup T_{m, n_{2}}\n\\]\nwith \\(n_{1}=\\lfloor t / 2\\rfloor\\) and \\(n_{2}=\\lceil t / 2\\rceil\\).\nSince \\(0 \\leqslant n_{1} \\leqslant n_{2} \\leqslant m+1\\), by using the Claim we can construct permutations ( \\(a_{k}\\) ), ( \\(b_{k}\\) ), and ( \\(c_{k}\\) ) to satisfy the following inequality:\n\\[\n2 m+1-1.5<\\sqrt{a_{k}}+\\sqrt{b_{k}}+\\sqrt{c_{k}}<2 m+3+1.5\n\\]\n\nSince \\(m<\\sqrt{N}<m+2\\), it follows that\n\\[\n2 \\sqrt{N}-4.5<2 m+1-1.5<\\sqrt{a_{k}}+\\sqrt{b_{k}}+\\sqrt{c_{k}}<2 m+3+1.5<2 \\sqrt{N}+4.5\n\\]\nand so\n\\[\n\\left|\\sqrt{A_{k}}+\\sqrt{B_{k}}+\\sqrt{C_{k}}-2 \\sqrt{N}\\right|<4.5<2023\n\\]\n![](https://cdn.mathpix.com/cropped/2025_08_23_2cb0be1b73ef2aa9a4e9g-32.jpg?height=472&width=595&top_left_y=245&top_left_x=736)\n\nSolution 3. This solution is based on the geometrical insight of equilateral triangles.\nStep 1. We first consider the easier case of triangle numbers\n\\[\nN=\\frac{m(m+1)}{2} .\n\\]\n\nAs shown in the following picture, consider the triangular shaped lattice points inside an equilateral triangle \\(A B C\\) with a total of \\(N\\) points. The lattice is built in a way that the \\(\\ell^{\\text {th }}\\) row has exactly \\(\\ell\\) points for each \\(\\ell=1,2, \\ldots, m\\). Rows are numbered in three different ways, one for each vertex.\n\nEach point \\(P_{k}\\) in the triangular lattice is labelled with a triple of integers ( \\(a_{k}, b_{k}, c_{k}\\) ) as follows. The first coordinate is called the \\(A\\)-coordinate, and so on for \\(B, C\\). To define the \\(A\\)-coordinate, denoted \\(W_{a}(\\bullet)\\), first label the lattice points by \\(1,2,3 \\ldots\\) starting with the point closest to \\(A\\) and then going down the rows with the rule that within a row, the labelling is from left to right (see right picture). The \\(B\\)-coordinate, denoted \\(W_{b}(\\bullet)\\), is defined by rotating the \\(A\\)-coordinate counterclockwise by \\(120^{\\circ}\\). The \\(C\\)-coordinate, denoted \\(W_{c}(\\bullet)\\), similarly, by rotating the \\(A\\)-coordinate counterclockwise by \\(240^{\\circ}\\).\n\nAssume that a point \\(P\\) lies in the \\(\\ell_{a}{ }^{\\text {th }}\\) row from the vertex \\(A\\), in the \\(\\ell_{b}{ }^{\\text {th }}\\) row from the vertex \\(B\\), and in the \\(\\ell_{c}{ }^{\\text {th }}\\) row from the vertex \\(C\\). Note that \\(\\ell_{a}\\) is proportional to the height of \\(A\\) in the triangle, minus the height of \\(P\\). Since inside an equilateral triangle, the sum of the lengths of the heights from a point to the three sides is independent of the point, we must have\n\\[\n\\ell_{a}+\\ell_{b}+\\ell_{c}=2 m+1=\\sqrt{8 N+1} .\n\\]\n\nSince there are exactly \\(1+2+\\cdots+\\ell=\\frac{\\ell(\\ell+1)}{2}\\) points in the first \\(\\ell\\) rows, the \\(A\\)-labeling \\(W_{a}(P)\\) of the point \\(P\\) satisfies\n\\[\n\\frac{\\ell_{a}\\left(\\ell_{a}-1\\right)}{2}+1 \\leqslant W_{a}(P) \\leqslant \\frac{\\ell_{a}\\left(\\ell_{a}+1\\right)}{2} .\n\\]\n\nIn paticular,\n\\[\n\\left(\\ell_{a}-\\frac{1}{2}\\right)^{2}<2 W_{a}(P)<\\left(\\ell_{a}+\\frac{1}{2}\\right)^{2} .\n\\]\n\nTaking the cyclic sum gives\n\\[\n\\left|\\sqrt{2 W_{a}(P)}+\\sqrt{2 W_{b}(P)}+\\sqrt{2 W_{c}(P)}-\\left(\\ell_{a}+\\ell_{b}+\\ell_{c}\\right)\\right|<\\frac{3}{2}\n\\]\nand thus\n\\[\n\\left|\\sqrt{W_{a}(P)}+\\sqrt{W_{b}(P)}+\\sqrt{W_{c}(P)}-2 \\sqrt{N+\\frac{1}{8}}\\right|<\\frac{3}{2} \\cdot \\frac{1}{\\sqrt{2}}=\\frac{3 \\sqrt{2}}{4} .\n\\]\n\nStep 2. Now, for a general positive integer \\(N\\), there exists a positive integer \\(m\\) such that\n\\[\n\\frac{m(m-1)}{2}+1 \\leqslant N \\leqslant \\frac{m(m+1)}{2} .\n\\]\n\nWrite \\(N=\\frac{m(m+1)}{2}-t\\) with \\(t \\in\\{0,1, \\ldots, m-1\\}\\). We modify the above construction for \\(\\frac{m(m+1)}{2}\\) points into a construction for \\(N\\) points as follows. We remove \\(t\\) arbitrary points from the \\(m^{\\text {th }}\\) row (namely the bottom row) of the triangular lattice. The remaining triangular lattice has \\(\\frac{m(m+1)}{2}-t=N\\) points, and we assign their \\(A-, B-\\), and \\(C\\)-coordinates as before (in the same order, yet skipping over the points that are removed so that the coordinates exactly form permutations of \\(1,2, \\ldots, N)\\).\n\nFor each point \\(P\\) in the triangular lattice (that was not removed earlier), suppose that it is in the \\(\\ell_{a}{ }^{\\text {th }}, \\ell_{b}{ }^{\\text {th }}\\), and \\(\\ell_{c}{ }^{\\text {th }}\\) row when viewed from \\(A, B\\), and \\(C\\), respectively. Now the \\(A\\)-coordinates \\(W_{a}(P)\\) still satisfies\n\\[\n\\frac{\\ell_{a}\\left(\\ell_{a}-1\\right)}{2}+1 \\leqslant W_{a}(P) \\leqslant \\frac{\\ell_{a}\\left(\\ell_{a}+1\\right)}{2} .\n\\]\n\nThe \\(B\\)-coordinate \\(W_{b}(P)\\) satisfies\n\\[\n\\frac{\\left(\\ell_{b}-1\\right)\\left(\\ell_{b}-2\\right)}{2}+1 \\leqslant W_{b}(P) \\leqslant \\frac{\\ell_{b}\\left(\\ell_{b}+1\\right)}{2},\n\\]\nbecause, viewing from point \\(B\\), we have removed either 0 or 1 point from each row, and the first \\(\\ell_{b}-1\\) rows have at least \\(0+1+\\cdots+\\left(\\ell_{b}-2\\right)=\\frac{\\left(\\ell_{b}-1\\right)\\left(\\ell_{b}-2\\right)}{2}\\) points left. For the same reason, the \\(C\\)-labeling \\(W_{c}(P)\\) satisfies\n\\[\n\\frac{\\left(\\ell_{c}-1\\right)\\left(\\ell_{c}-2\\right)}{2}+1 \\leqslant W_{c}(P) \\leqslant \\frac{\\ell_{c}\\left(\\ell_{c}+1\\right)}{2} .\n\\]\n\nFrom this, we deduce that\n\\[\n\\begin{aligned}\n\\ell_{a}-\\frac{1}{2} & <\\sqrt{2 W_{a}(P)}<\\ell_{a}+\\frac{1}{2}, \\\\\n\\ell_{b}-\\frac{3}{2} & <\\sqrt{2 W_{b}(P)}<\\ell_{b}+\\frac{1}{2}, \\\\\n\\ell_{c}-\\frac{3}{2} & <\\sqrt{2 W_{c}(P)}<\\ell_{c}+\\frac{1}{2} .\n\\end{aligned}\n\\]\n\nCombining all above with the inequalities \\(2 m-1<2 \\sqrt{2 N}<2 m+1\\) and \\(\\ell_{a}+\\ell_{b}+\\ell_{c}=2 m+1\\), we deduce that\n\\[\n\\begin{aligned}\n2 \\sqrt{2 N}-\\frac{7}{2}<(2 m+1)-\\frac{7}{2}<\\sqrt{2 W_{a}(P)} & +\\sqrt{2 W_{b}(P)}+\\sqrt{2 W_{c}(P)} \\\\\n& <(2 m+1)+\\frac{3}{2}<2 \\sqrt{2 N}+\\frac{7}{2}\n\\end{aligned}\n\\]\n\nTherefore, for each point \\(P\\), we have\n\\[\n\\left|\\sqrt{W_{a}(P)}+\\sqrt{W_{b}(P)}+\\sqrt{W_{c}(P)}-2 \\sqrt{N}\\right|<\\frac{7}{2} \\cdot \\frac{1}{\\sqrt{2}}<2.5<2013 .\n\\]\n\nWe may finally order of the \\(N\\) points in an arbitrary way. Then the \\(A\\)-labelings \\(W_{a}(\\bullet)\\) give the permutation \\(a_{1}, \\ldots, a_{N}\\), the \\(B\\)-labelings \\(W_{b}(\\bullet)\\) give \\(b_{1}, \\ldots, b_{N}\\), and the \\(C\\)-labelings \\(W_{c}(\\bullet)\\) give \\(c_{1}, \\ldots, c_{N}\\).\n\nFor each \\(k=1,2, \\ldots, N\\), we have\n\\[\n\\left|\\sqrt{a_{k}}+\\sqrt{b_{k}}+\\sqrt{c_{k}}-2 \\sqrt{N}\\right|<2.5<2023 .\n\\]\n\nComment. We can make the same argument as in Solution 3 without using geometry or diagram instead using barycentric coordinates in integers and lexicographic order.\n\nFor \\(N=\\frac{m(m+1)}{2}\\), consider a set\n\\[\nX=\\left\\{(x, y, z) \\in \\mathbb{Z}^{3} \\mid 0 \\leqslant x, y, z \\leqslant m-1, x+y+z=m-1\\right\\}\n\\]\nand the lexicographic order of \\(X\\), i.e.\n\\[\n(x, y, z)>\\left(x^{\\prime}, y^{\\prime}, z^{\\prime}\\right) \\Longleftrightarrow\\left\\{\\begin{array}{l}\nx>x^{\\prime} \\text { or } \\\\\nx=x^{\\prime} \\text { and } y>y^{\\prime} \\text { or } \\\\\nx=x^{\\prime} \\text { and } y=y^{\\prime} \\text { and } z>z^{\\prime}\n\\end{array}\\right.\n\\]\n\nThen for an element \\(Q_{k}=\\left(x_{k}, y_{k}, z_{k}\\right)\\)\n- Define \\(W_{a}\\left(Q_{k}\\right)\\) so that \\(\\left(x_{k}, y_{k}, z_{k}\\right)\\) is the \\(W_{a}\\left(Q_{k}\\right)^{\\text {th }}\\) biggest element in \\(X\\).\n- Define \\(W_{b}\\left(Q_{k}\\right)\\) so that \\(\\left(y_{k}, z_{k}, x_{k}\\right)\\) is the \\(W_{b}\\left(Q_{k}\\right)^{\\text {th }}\\) biggest element in \\(X^{\\prime}=\\{(y, z, x) \\mid(x, y, z) \\in X\\}\\).\n- Define \\(W_{c}\\left(Q_{k}\\right)\\) so that \\(\\left(z_{k}, x_{k}, y_{k}\\right)\\) is the \\(W_{c}\\left(Q_{k}\\right)^{\\text {th }}\\) biggest element in \\(X^{\\prime \\prime}=\\{(z, x, y) \\mid(x, y, z) \\in X\\}\\).\n\nThe same argument as in Solution 2 then holds.\nObserve that for an element \\(Q_{k}=\\left(x_{k}, y_{k}, z_{k}\\right)\\), it holds that \\(\\ell_{a}=m-x_{k}, \\ell_{b}=m-y_{k}\\), and \\(\\ell_{c}=m-z_{k}\\).\n\n\\section*{Combinatorics}", "source_pdf": "imosl_2023.pdf", "notes": "fallback-regex"}
{"id": "IMOSL-2023-C1", "contest": "IMOSL", "year": "2023", "problem_number": "C1", "problem": "Let \\(m\\) and \\(n\\) be positive integers greater than 1 . In each unit square of an \\(m \\times n\\) grid lies a coin with its tail-side up. A move consists of the following steps:\n1. select a \\(2 \\times 2\\) square in the grid;\n2. flip the coins in the top-left and bottom-right unit squares;\n3. flip the coin in either the top-right or bottom-left unit square.\n\nDetermine all pairs ( \\(m, n\\) ) for which it is possible that every coin shows head-side up after a finite number of moves.\n(Thailand)", "solution": "Answer: The answer is all pairs ( \\(m, n\\) ) satisfying \\(3 \\mid m n\\).\n\n1. Let us denote by \\((i, j)\\)-square the unit square in the \\(i^{\\text {th }}\\) row and the \\(j^{\\text {th }}\\) column.\nWe first prove that when \\(3 \\mid m n\\), it is possible to make all the coins show head-side up. For integers \\(1 \\leqslant i \\leqslant m-1\\) and \\(1 \\leqslant j \\leqslant n-1\\), denote by \\(A(i, j)\\) the move that flips the coin in the \\((i, j)\\)-square, the \\((i+1, j+1)\\)-square and the \\((i, j+1)\\)-square. Similarly, denote by \\(B(i, j)\\) the move that flips the coin in the \\((i, j)\\)-square, \\((i+1, j+1)\\)-square, and the \\((i+1, j)\\)-square. Without loss of generality, we may assume that \\(3 \\mid m\\).\nCase 1: \\(n\\) is even.\nWe apply the moves\n- \\(A(3 k-2,2 l-1)\\) for all \\(1 \\leqslant k \\leqslant \\frac{m}{3}\\) and \\(1 \\leqslant l \\leqslant \\frac{n}{2}\\),\n- \\(B(3 k-1,2 l-1)\\) for all \\(1 \\leqslant k \\leqslant \\frac{m}{3}\\) and \\(1 \\leqslant l \\leqslant \\frac{n}{2}\\).\n\nThis process will flip each coin exactly once, hence all the coins will face head-side up afterwards.\n![](https://cdn.mathpix.com/cropped/2025_08_23_2cb0be1b73ef2aa9a4e9g-35.jpg?height=318&width=415&top_left_y=1890&top_left_x=825)\n\nCase 2: \\(n\\) is odd.\nWe start by applying\n- \\(A(3 k-2,2 l-1)\\) for all \\(1 \\leqslant k \\leqslant \\frac{m}{3}\\) and \\(1 \\leqslant l \\leqslant \\frac{n-1}{2}\\),\n- \\(B(3 k-1,2 l-1)\\) for all \\(1 \\leqslant k \\leqslant \\frac{m}{3}\\) and \\(1 \\leqslant l \\leqslant \\frac{n-1}{2}\\)\nas in the previous case. At this point, the coins on the rightmost column have tail-side up and the rest of the coins have head-side up. We now apply the moves\n- \\(A(3 k-2, n-1), A(3 k-1, n-1)\\) and \\(B(3 k-2, n-1)\\) for every \\(1 \\leqslant k \\leqslant \\frac{m}{3}\\).\n\nFor each \\(k\\), the three moves flip precisely the coins in the \\((3 k-2, n)\\)-square, the \\((3 k-1, n)\\) square, and the \\((3 k, n)\\)-square. Hence after this process, every coin will face head-side up.\n\nWe next prove that \\(m n\\) being divisible by 3 is a necessary condition. We first label the \\((i, j)\\)-square by the remainder of \\(i+j-2\\) when divided by 3 , as shown in the figure.\n\n\\begin{tabular}{|c|c|c|c|c|}\n\\hline 0 & 1 & 2 & 0 & \\(\\cdots\\) \\\\\n\\hline 1 & 2 & 0 & 1 & \\(\\cdots\\) \\\\\n\\hline 2 & 0 & 1 & 2 & \\(\\cdots\\) \\\\\n\\hline 0 & 1 & 2 & 0 & \\(\\cdots\\) \\\\\n\\hline\\(\\vdots\\) & \\(\\vdots\\) & \\(\\vdots\\) & \\(\\vdots\\) & \\(\\ddots\\) \\\\\n\\hline\n\\end{tabular}\n\nLet \\(T(c)\\) be the number of coins facing head-side up in those squares whose label is \\(c\\). The main observation is that each move does not change the parity of both \\(T(0)-T(1)\\) and \\(T(1)-T(2)\\), since a move flips exactly one coin in a square with each label. Initially, all coins face tail-side up at the beginning, thus all of \\(T(0), T(1), T(2)\\) are equal to 0 . Hence it follows that any configuration that can be achieved from the initial state must satisfy the parity condition of\n\\[\nT(0) \\equiv T(1) \\equiv T(2) \\quad(\\bmod 2)\n\\]\n\nWe now calculate the values of \\(T\\) for the configuration in which all coins are facing head-side up.\n- When \\(m \\equiv n \\equiv 1(\\bmod 3)\\), we have \\(T(0)-1=T(1)=T(2)=\\frac{m n-1}{3}\\).\n- When \\(m \\equiv 1(\\bmod 3)\\) and \\(n \\equiv 2(\\bmod 3)\\), or \\(m \\equiv 2(\\bmod 3)\\) and \\(n \\equiv 1(\\bmod 3)\\), we have \\(T(0)-1=T(1)-1=T(2)=\\frac{m n-2}{3}\\).\n- When \\(m \\equiv n \\equiv 2(\\bmod 3)\\), we have \\(T(0)=T(1)-1=T(2)=\\frac{m n-1}{3}\\).\n- When \\(m \\equiv 0(\\bmod 3)\\) or \\(n \\equiv 0(\\bmod 3)\\), we have \\(T(0)=T(1)=T(2)=\\frac{m n}{3}\\).\n\nFrom this calculation, we see that \\(T(0), T(1)\\) and \\(T(2)\\) has the same parity only when \\(m n\\) is divisible by 3.\n\nComment 1. The original proposal of the problem also included the following question as part (b):\nFor each pair ( \\(m, n\\) ) of integers greater than 1 , how many configurations can be obtained by applying a finite number of moves?\nAn explicit construction of a sequence of moves shows that \\(T(0), T(1)\\), and \\(T(2)\\) having the same parity is a necessary and sufficient condition for a configuration to obtainable after a finite sequence of moves, and this shows that the answer is \\(2^{m n-2}\\).\n\nComment 2. A significantly more difficult problem is to ask the following question: for pairs ( \\(m, n\\) ) such that the task is possible (i.e. \\(3 \\mid m n\\) ), what is the smallest number of moves required to complete this task? The answer is:\n- \\(\\frac{m n}{3}\\) if \\(m n\\) is even;\n- \\(\\frac{m n}{3}+2\\) if \\(m n\\) is odd.\n\nTo show this, we observe that we can flip all coins in any \\(2 \\times 3\\) (or \\(3 \\times 2\\) ) by using a minimum of two moves. Furthermore, when \\(m n\\) is odd with \\(3 \\mid m n\\), it is impossible to tile an \\(m \\times n\\) table with one type of L-tromino and its \\(180^{\\circ}\\)-rotated L-tromino (disallowing rotations and reflections). The only known proof of the latter claim is lengthy and difficult, and it requires some group-theoretic arguments by studying the title homotopy group given by these two L-tromino tiles. This technique was developed by J. H. Conway and J. C. Lagarias in Tiling with Polyominoes and Combinatorial Group Theory, Journal of Combinatorial Group Theory, Series A 53, 183-208 (1990).\n\nComment 3. Here is neat way of defining the invariant. Consider a finite field \\(\\mathbb{F}_{4}=\\{0,1, \\omega, \\omega+1\\}\\), where \\(1+1=\\omega^{2}+\\omega+1=0\\) in \\(\\mathbb{F}_{4}\\). Consider the set\n\\[\nH=\\{(i, j) \\mid 1 \\leqslant i \\leqslant m, 1 \\leqslant j \\leqslant n, \\text { the coin in the }(i, j) \\text {-square is head-side up }\\} .\n\\]\nand the invariant\n\\[\nI(H)=\\sum_{(i, j) \\in H} \\omega^{i+j} \\in \\mathbb{F}_{4}\n\\]\n\nThen the value of \\(I(H)\\) does not change under applying moves, and when all coins are tail-side up, it holds that \\(I(H)=0\\). On the other hand, its value when all coins are head-side up can be computed as\n\\[\nI(H)=\\sum_{i=1}^{m} \\sum_{j=1}^{n} \\omega^{i+j}=\\left(\\sum_{i=1}^{m} \\omega^{i}\\right)\\left(\\sum_{j=1}^{n} \\omega^{j}\\right)\n\\]\n\nThis is equal to \\(0 \\in \\mathbb{F}_{4}\\) if and only if \\(3 \\mid m n\\).", "source_pdf": "imosl_2023.pdf", "notes": "fallback-regex"}
{"id": "IMOSL-2023-C2", "contest": "IMOSL", "year": "2023", "problem_number": "C2", "problem": "Determine the maximal length \\(L\\) of a sequence \\(a_{1}, \\ldots, a_{L}\\) of positive integers satisfying both the following properties:\n- every term in the sequence is less than or equal to \\(2^{2023}\\), and\n- there does not exist a consecutive subsequence \\(a_{i}, a_{i+1}, \\ldots, a_{j}\\) (where \\(\\left.1 \\leqslant i \\leqslant j \\leqslant L\\right)\\) with a choice of signs \\(s_{i}, s_{i+1}, \\ldots, s_{j} \\in\\{1,-1\\}\\) for which\n\\[\ns_{i} a_{i}+s_{i+1} a_{i+1}+\\cdots+s_{j} a_{j}=0\n\\]\n(Czech Republic)", "solution": "Answer: The answer is \\(L=2^{2024}-1\\).\n\n. We prove more generally that the answer is \\(2^{k+1}-1\\) when \\(2^{2023}\\) is replaced by \\(2^{k}\\) for an arbitrary positive integer \\(k\\). Write \\(n=2^{k}\\).\n\nWe first show that there exists a sequence of length \\(L=2 n-1\\) satisfying the properties. For a positive integer \\(x\\), denote by \\(v_{2}(x)\\) the maximal nonnegative integer \\(v\\) such that \\(2^{v}\\) divides \\(x\\). Consider the sequence \\(a_{1}, \\ldots, a_{2 n-1}\\) defined as\n\\[\na_{i}=2^{k-v_{2}(i)}\n\\]\n\nFor example, when \\(k=2\\) and \\(n=4\\), the sequence is\n\\[\n4,2,4,1,4,2,4 .\n\\]\n\nThis indeed consists of positive integers less than or equal to \\(n=2^{k}\\), because \\(0 \\leqslant v_{2}(i) \\leqslant k\\) for \\(1 \\leqslant i \\leqslant 2^{k+1}-1\\).\nClaim 1. This sequence \\(a_{1}, \\ldots, a_{2 n-1}\\) does not have a consecutive subsequence with a choice of signs such that the signed sum equals zero.\nProof. Let \\(1 \\leqslant i \\leqslant j \\leqslant 2 n-1\\) be integers. The main observation is that amongst the integers\n\\[\ni, i+1, \\ldots, j-1, j\n\\]\nthere exists a unique integer \\(x\\) with the maximal value of \\(v_{2}(x)\\). To see this, write \\(v= \\max \\left(v_{2}(i), \\ldots, v_{2}(j)\\right)\\). If there exist at least two multiples of \\(2^{v}\\) amongst \\(i, i+1, \\ldots, j\\), then one of them must be a multiple of \\(2^{v+1}\\), which is a contradiction.\n\nTherefore there is exactly one \\(i \\leqslant x \\leqslant j\\) with \\(v_{2}(x)=v\\), which implies that all terms except for \\(a_{x}=2^{k-v}\\) in the sequence\n\\[\na_{i}, a_{i+1}, \\ldots, a_{j}\n\\]\nare a multiple of \\(2^{k-v+1}\\). The same holds for the terms \\(s_{i} a_{i}, s_{i+1} a_{i+1}, \\ldots, s_{j} a_{j}\\), hence the sum cannot be equal to zero.\n\nWe now prove that there does not exist a sequence of length \\(L \\geqslant 2 n\\) satisfying the conditions of the problem. Let \\(a_{1}, \\ldots, a_{L}\\) be an arbitrary sequence consisting of positive integers less than or equal to \\(n\\). Define a sequence \\(s_{1}, \\ldots, s_{L}\\) of signs recursively as follows:\n- when \\(s_{1} a_{1}+\\cdots+s_{i-1} a_{i-1} \\leqslant 0\\), set \\(s_{i}=+1\\),\n- when \\(s_{1} a_{1}+\\cdots+s_{i-1} a_{i-1} \\geqslant 1\\), set \\(s_{i}=-1\\).\n\nWrite\n\\[\nb_{i}=\\sum_{j=1}^{i} s_{i} a_{i}=s_{1} a_{1}+\\cdots+s_{i} a_{i},\n\\]\nand consider the sequence\n\\[\n0=b_{0}, b_{1}, b_{2}, \\ldots, b_{L}\n\\]\n\nClaim 2. All terms \\(b_{i}\\) of the sequence satisfy \\(-n+1 \\leqslant b_{i} \\leqslant n\\).\nProof. We prove this by induction on \\(i\\). It is clear that \\(b_{0}=0\\) satisfies \\(-n+1 \\leqslant 0 \\leqslant n\\). We now assume \\(-n+1 \\leqslant b_{i-1} \\leqslant n\\) and show that \\(-n+1 \\leqslant b_{i} \\leqslant n\\).\nCase 1: \\(-n+1 \\leqslant b_{i-1} \\leqslant 0\\).\nThen \\(b_{i}=b_{i-1}+a_{i}\\) from the definition of \\(s_{i}\\), and hence\n\\[\n-n+1 \\leqslant b_{i-1}<b_{i-1}+a_{i} \\leqslant b_{i-1}+n \\leqslant n .\n\\]\n\nCase 2: \\(1 \\leqslant b_{i-1} \\leqslant n\\).\nThen \\(b_{i}=b_{i-1}-a_{i}\\) from the definition of \\(s_{i}\\), and hence\n\\[\n-n+1 \\leqslant b_{i-1}-n \\leqslant b_{i-1}-a_{i}<b_{i-1} \\leqslant n .\n\\]\n\nThis finishes the proof.\nBecause there are \\(2 n\\) integers in the closed interval \\([-n+1, n]\\) and at least \\(2 n+1\\) terms in the sequence \\(b_{0}, b_{1}, \\ldots, b_{L}\\) (as \\(L+1 \\geqslant 2 n+1\\) by assumption), the pigeonhole principle implies that two distinct terms \\(b_{i-1}, b_{j}\\) (where \\(1 \\leqslant i \\leqslant j \\leqslant L\\) ) must be equal. Subtracting one from another, we obtain\n\\[\ns_{i} a_{i}+\\cdots+s_{j} a_{j}=b_{j}-b_{i-1}=0\n\\]\nas desired.\nComment. The same argument gives a bound \\(L \\leqslant 2 n-1\\) that works for all \\(n\\), but this bound is not necessarily sharp when \\(n\\) is not a power of 2 . For instance, when \\(n=3\\), the longest sequence has length \\(L=3\\).", "source_pdf": "imosl_2023.pdf", "notes": "fallback-regex"}
{"id": "IMOSL-2023-C4", "contest": "IMOSL", "year": "2023", "problem_number": "C4", "problem": "Let \\(n \\geqslant 2\\) be a positive integer. Paul has a \\(1 \\times n^{2}\\) rectangular strip consisting of \\(n^{2}\\) unit squares, where the \\(i^{\\text {th }}\\) square is labelled with \\(i\\) for all \\(1 \\leqslant i \\leqslant n^{2}\\). He wishes to cut the strip into several pieces, where each piece consists of a number of consecutive unit squares, and then translate (without rotating or flipping) the pieces to obtain an \\(n \\times n\\) square satisfying the following property: if the unit square in the \\(i^{\\text {th }}\\) row and \\(j^{\\text {th }}\\) column is labelled with \\(a_{i j}\\), then \\(a_{i j}-(i+j-1)\\) is divisible by \\(n\\).\n\nDetermine the smallest number of pieces Paul needs to make in order to accomplish this.\n(U.S.A.)", "solution": "Answer: The minimum number of pieces is \\(2 n-1\\).\n\n1. For the entirety of the solution, we shall view the labels as taking values in \\(\\mathbb{Z} / n \\mathbb{Z}\\), as only their values modulo \\(n\\) play a role.\n\nHere are two possible constructions consisting of \\(2 n-1\\) pieces.\n1. Cut into pieces of sizes \\(n, 1, n, 1, \\ldots, n, 1,1\\), and glue the pieces of size 1 to obtain the last row.\n2. Cut into pieces of sizes \\(n, 1, n-1,2, n-2, \\ldots, n-1,1\\), and switch the pairs of consecutive strips that add up to size \\(n\\).\n\nWe now prove that using \\(2 n-1\\) pieces is optimal. It will be more helpful to think of the reverse process: start with \\(n\\) pieces of size \\(1 \\times n\\), where the \\(k^{\\text {th }}\\) piece has squares labelled \\(k, k+1, \\ldots, k+n-1\\). The goal is to restore the original \\(1 \\times n^{2}\\) strip.\n\nNote that each piece, after cutting at appropriate places, is of the form \\(a, a+1, \\ldots, b-1\\). Construct an (undirected but not necessarily simple) graph \\(\\Gamma\\) with vertices labelled by \\(1, \\ldots, n\\), where a piece of the form \\(a, a+1, \\ldots, b-1\\) corresponds to an edge from \\(a\\) to \\(b\\). We make the following observations.\n- The cut pieces came from the \\(k^{\\text {th }}\\) initial piece \\(k, k+1, \\ldots, k+n-1\\) corresponds to a cycle \\(\\gamma_{k}\\) (possibly of length 1 ) containing the vertex \\(k\\).\n- Since it is possible to rearrange the pieces into one single \\(1 \\times n^{2}\\) strip, the graph \\(\\Gamma\\) has an Eulerian cycle.\n- The number of edges of \\(\\Gamma\\) is equal to the total number of cut pieces.\n\nThe goal is to prove that \\(\\Gamma\\) has at least \\(2 n-1\\) edges. Since \\(\\Gamma\\) has an Eulerian cycle, it is connected. For every \\(1 \\leqslant k \\leqslant n\\), pick one edge from \\(\\gamma_{k}\\), delete it from \\(\\Gamma\\) to obtain a new graph \\(\\Gamma^{\\prime}\\). Since no two cycles \\(\\gamma_{i}\\) and \\(\\gamma_{j}\\) share a common edge, removing one edge from each cycle does not affect the connectivity of the graph. This shows that the new graph \\(\\Gamma^{\\prime}\\) must also be connected. Therefore \\(\\Gamma^{\\prime}\\) has at least \\(n-1\\) edges, which means that \\(\\Gamma\\) has at least \\(2 n-1\\) edges.\n\nSolution 2. We provide an alternative proof that at least \\(2 n-1\\) pieces are needed. Instead of having a linear strip, we work with a number of circular strips, each having length a multiple of \\(n\\) and labelled as\n\\[\n1,2, \\ldots, n, 1,2, \\ldots, n, \\ldots, 1,2, \\ldots, n,\n\\]\nwhere there are \\(n^{2}\\) cells in total across all circular strips. The goal is still to create the \\(n \\times n\\) square by cutting and translating. Here, when we say \"translating\" the strips, we imagine that each cell has a number written on it and the final \\(n \\times n\\) square is required to have every number written in the same upright, non-mirrored orientation.\n\nNote that the number of cuts will be equal to the number of pieces, because performing \\(l \\geqslant 1\\) cuts on a single circular strip results in \\(l\\) pieces.\n\nConsider any \"seam\" in the interior of the final square, between two squares \\(S\\) and \\(T\\), so that \\(S\\) and \\(T\\) belongs to two separate pieces. We are interested in the positions of these two squares in the original circular strips, with the aim of removing the seam.\n- If the two squares \\(S\\) and \\(T\\) come from the same circular strip and are adjacent, then the cut was unnecessary and we can simply remove the seam and reduce the number of required cuts by 1 . The circular strips are not affected.\n- If these two squares \\(S\\) and \\(T\\) were not adjacent, then they are next to two different cuts (either from the same circular strip or two different circular strips). Denote the two cuts by ( \\(S \\mid Y\\) ) and ( \\(X \\mid T\\) ). We perform these two cuts and then glue the pieces back according to \\((S \\mid T)\\) and \\((X \\mid Y)\\). Performing this move would either split one circular strip into two or merge two circular strips into one, changing the number of circular strips by at most one. Afterwards, we may eliminate cut \\((S \\mid T)\\) since it is no longer needed, which also removes the corresponding seam from the final square.\n\nBy iterating this process, eventually we reach a state where there are some number of circular strips, but the final \\(n \\times n\\) square no longer has any interior seams.\n\nSince no two rows of the square can be glued together while maintaining the consecutive numbering, the only possibility is to have exactly \\(n\\) circular strips, each with length \\(n\\). In this state at least \\(n\\) cuts are required to reassemble the square. Recall that each seam removal operation changed the number of circular strips by at most one. So if we started with only one initial circular strip, then at least \\(n-1\\) seams were removed. Hence in total, at least \\(n+(n-1)=2 n-1\\) cuts are required to transform one initial circular strip into the final square. Hence at least \\(2 n-1\\) pieces are required to achieve the desired outcome.\n\nSolution 3. As with the previous solution, we again work with circular strips. In particular, we start out with \\(k\\) circular strips, each having length a multiple of \\(n\\) and labelled as\n\\[\n1,2, \\ldots, n, 1,2, \\ldots, n, \\ldots, 1,2, \\ldots, n,\n\\]\nwhere there are \\(n^{2}\\) cells in total across all \\(k\\) circular strips. The goal is still to create the \\(n \\times n\\) square by cutting and translating the circular strips.\nClaim. Constructing the \\(n \\times n\\) square requires at least \\(2 n-k\\) cuts (or alternatively, \\(2 n-k\\) pieces).\nProof. We prove by induction on \\(n\\). The base case \\(n=1\\) is clear, because we can only have \\(k=1\\) and the only way of producing a \\(1 \\times 1\\) square from a \\(1 \\times 1\\) circular strip is by making a single cut. We now assume that \\(n \\geqslant 2\\) and the statement is true for \\(n-1\\).\n\nEach cut is a cut between a cell of label \\(i\\) on the left and a cell of label \\(i+1\\) on the right side, for a unique \\(1 \\leqslant i \\leqslant n\\). Let \\(a_{i}\\) be the number of such cuts, so that \\(a_{1}+a_{2}+\\cdots+a_{n}\\) is the total number of cuts. Since all the left and right edges of the \\(n \\times n\\) square at the end must be cut, we have \\(a_{i} \\geqslant 1\\) for all \\(1 \\leqslant i \\leqslant n\\).\n\nIf \\(a_{i} \\geqslant 2\\) for all \\(i\\), then\n\\[\na_{1}+a_{2}+\\cdots+a_{n} \\geqslant 2 n>2 n-k\n\\]\nand hence there is nothing to prove. We therefore assume that there exist some \\(1 \\leqslant m \\leqslant n\\) for which \\(a_{m}=1\\). This unique cut must form the two ends of the linear strip\n\\[\nm+1, m+2, \\ldots, m-1+n, m+n\n\\]\nfrom the final product. There are two cases.\nCase 1: The strip is a single connected piece.\n\nIn this case, the strip must have come from a single circular strip of length exactly \\(n\\). We now remove this circular strip from of the cutting and pasting process. By definition of \\(m\\), none of the edges between \\(m\\) and \\(m+1\\) are cut. Therefore we may pretend that all the adjacent pairs of cells labelled \\(m\\) and \\(m+1\\) are single cells. The induction hypothesis then implies that\n\\[\na_{1}+\\cdots+a_{m-1}+a_{m+1}+\\cdots+a_{n} \\geqslant 2(n-1)-(k-1) .\n\\]\n\nAdding back in \\(a_{m}\\), we obtain\n\\[\na_{1}+\\cdots+a_{n} \\geqslant 2(n-1)-(k-1)+1=2 n-k .\n\\]\n\nCase 2: The strip is not a single connected piece.\nSay the linear strip \\(m+1, \\ldots, m+n\\) is composed of \\(l \\geqslant 2\\) pieces \\(C_{1}, \\ldots, C_{l}\\). We claim that if we cut the initial circular strips along both the left and right end points of the pieces \\(C_{1}, \\ldots, C_{l}\\), and then remove them, the remaining part consists of at most \\(k+l-2\\) connected pieces (where some of them may be circular and some of them may be linear). This is because \\(C_{l}, C_{1}\\) form a consecutive block of cells on the circular strip, and removing \\(l-1\\) consecutive blocks from \\(k\\) circular strips results in at most \\(k+(l-1)-1\\) connected pieces.\n\nOnce we have the connected pieces that form the complement of \\(C_{1}, \\ldots, C_{l}\\), we may glue them back at appropriate endpoints to form circular strips. Say we get \\(k^{\\prime}\\) circular strips after this procedure. As we are gluing back from at most \\(k+l-2\\) connected pieces, we see that\n\\[\nk^{\\prime} \\leqslant k+l-2 \\text {. }\n\\]\n\nWe again observe that to get from the new circular strips to the \\(n-1\\) strips of size \\(1 \\times n\\), we never have to cut along the cell boundary between labels \\(m\\) and \\(m+1\\). Therefore the induction hypothesis applies, and we conclude that the total number of pieces is bounded below by\n\\[\nl+\\left(2(n-1)-k^{\\prime}\\right) \\geqslant l+2(n-1)-(k+l-2)=2 n-k .\n\\]\n\nThis finishes the induction step, and therefore the statement holds for all \\(n\\).\nTaking \\(k=1\\) in the claim, we see that to obtain a \\(n \\times n\\) square from a circular \\(1 \\times n^{2}\\) strip, we need at least \\(2 n-1\\) connected pieces. This shows that constructing the \\(n \\times n\\) square out of a linear \\(1 \\times n^{2}\\) strip also requires at least \\(2 n-1\\) pieces.", "source_pdf": "imosl_2023.pdf", "notes": "fallback-regex"}
{"id": "IMOSL-2023-C5", "contest": "IMOSL", "year": "2023", "problem_number": "C5", "problem": "Elisa has 2023 treasure chests, all of which are unlocked and empty at first. Each day, Elisa adds a new gem to one of the unlocked chests of her choice, and afterwards, a fairy acts according to the following rules:\n- if more than one chests are unlocked, it locks one of them, or\n- if there is only one unlocked chest, it unlocks all the chests.\n\nGiven that this process goes on forever, prove that there is a constant \\(C\\) with the following property: Elisa can ensure that the difference between the numbers of gems in any two chests never exceeds \\(C\\), regardless of how the fairy chooses the chests to lock.\n(Israel)", "solution": "1. We will prove that such a constant \\(C\\) exists when there are \\(n\\) chests for \\(n\\) an odd positive integer. In fact we can take \\(C=n-1\\). Elisa's strategy is simple: place a gem in the chest with the fewest gems (in case there are more than one such chests, pick one arbitrarily).\n\nFor each integer \\(t \\geqslant 0\\), let \\(a_{1}^{t} \\leqslant a_{2}^{t} \\leqslant \\cdots \\leqslant a_{n}^{t}\\) be the numbers of gems in the \\(n\\) chests at the end of the \\(t^{\\text {th }}\\) day. In particular, \\(a_{1}^{0}=\\cdots=a_{n}^{0}=0\\) and\n\\[\na_{1}^{t}+a_{2}^{t}+\\cdots+a_{n}^{t}=t .\n\\]\n\nFor each \\(t \\geqslant 0\\), there is a unique index \\(m=m(t)\\) for which \\(a_{m}^{t+1}=a_{m}^{t}+1\\). We know that \\(a_{j}^{t}>a_{m(t)}^{t}\\) for all \\(j>m(t)\\), since \\(a_{m(t)}^{t}<a_{m(t)}^{t+1} \\leqslant a_{j}^{t+1}=a_{j}^{t}\\). Elisa's strategy also guarantees that if an index \\(j\\) is greater than the remainder of \\(t\\) when divided by \\(n\\) (i.e. the number of locked chests at the end of the \\(t^{\\text {th }}\\) day), then \\(a_{j}^{t} \\geqslant a_{m(t)}^{t}\\), because some chest with at most \\(a_{j}^{t}\\) gems must still be unlocked at the end of the \\(t^{\\text {th }}\\) day.\n\nRecall that a sequence \\(x_{1} \\leqslant x_{2} \\leqslant \\cdots \\leqslant x_{n}\\) of real numbers is said to majorise another sequence \\(y_{1} \\leqslant y_{2} \\leqslant \\cdots \\leqslant y_{n}\\) of real numbers when for all \\(1 \\leqslant k \\leqslant n\\) we have\n\\[\nx_{1}+x_{2}+\\cdots+x_{k} \\leqslant y_{1}+y_{2}+\\cdots+y_{k}\n\\]\nand\n\\[\nx_{1}+x_{2}+\\cdots+x_{n}=y_{1}+y_{2}+\\cdots+y_{n} .\n\\]\n\nOur strategy for proving \\(a_{n}^{t}-a_{1}^{t} \\leqslant n-1\\) is to inductively show that the sequence ( \\(a_{i}^{t}\\) ) is majorised by some other sequence ( \\(b_{i}^{t}\\) ).\n\nWe define this other sequence ( \\(b_{i}^{t}\\) ) as follows. Let \\(b_{k}^{0}=k-\\frac{n+1}{2}\\) for \\(1 \\leqslant k \\leqslant n\\). As \\(n\\) is odd, this is a strictly increasing sequence of integers, and the sum of its terms is 0 . Now define \\(b_{i}^{t}=b_{i}^{0}+\\left\\lfloor\\frac{t-i}{n}\\right\\rfloor+1\\) for \\(t \\geqslant 1\\) and \\(1 \\leqslant i \\leqslant n\\). Thus for \\(t \\geqslant 0\\),\n\\[\nb_{i}^{t+1}= \\begin{cases}b_{i}^{t} & \\text { if } t+1 \\not \\equiv i \\quad(\\bmod n) \\\\ b_{i}^{t}+1 & \\text { if } t+1 \\equiv i \\quad(\\bmod n)\\end{cases}\n\\]\n\nFrom these properties it is easy to see that\n- \\(b_{1}^{t}+b_{2}^{t}+\\cdots+b_{n}^{t}=t\\) for all \\(t \\geqslant 0\\), and\n- \\(b_{i}^{t} \\leqslant b_{i+1}^{t}\\) for all \\(t \\geqslant 0\\) and \\(1 \\leqslant i \\leqslant n-1\\), with the inequality being strict if \\(t \\not \\equiv i(\\bmod n)\\).\n\nClaim 1. For each \\(t \\geqslant 0\\), the sequence of integers \\(b_{1}^{t}, b_{2}^{t}, \\ldots, b_{n}^{t}\\) majorises the sequence of integers \\(a_{1}^{t}, a_{2}^{t}, \\ldots, a_{n}^{t}\\).\n\nProof. We use induction on \\(t\\). The base case \\(t=0\\) is trivial. Assume \\(t \\geqslant 0\\) and that \\(\\left(b_{i}^{t}\\right)\\) majorises \\(\\left(a_{i}^{t}\\right)\\). We want to prove the same holds for \\(t+1\\).\n\nFirst note that the two sequences ( \\(b_{i}^{t+1}\\) ) and ( \\(a_{i}^{t+1}\\) ) both sum up to \\(t+1\\). Next, we wish to show that for \\(1 \\leqslant k<n\\), we have\n\\[\nb_{1}^{t+1}+b_{2}^{t+1}+\\cdots+b_{k}^{t+1} \\leqslant a_{1}^{t+1}+a_{2}^{t+1}+\\cdots+a_{k}^{t+1}\n\\]\n\nWhen \\(t+1\\) is replaced by \\(t\\), the above inequality holds by the induction hypothesis. For the sake of contradiction, suppose \\(k\\) is the smallest index such that the inequality for \\(t+1\\) fails. Since the left hand side increases by at most 1 during the transition from \\(t\\) to \\(t+1\\), the inequality for \\(t+1\\) can fail only if all of the following occur:\n- \\(b_{1}^{t}+b_{2}^{t}+\\cdots+b_{k}^{t}=a_{1}^{t}+a_{2}^{t}+\\cdots+a_{k}^{t}\\),\n- \\(t+1 \\equiv j(\\bmod n)\\) for some \\(1 \\leqslant j \\leqslant k\\) (so that \\(b_{j}^{t+1}=b_{j}^{t}+1\\) ),\n- \\(m(t)>k\\) (so that \\(a_{i}^{t+1}=a_{i}^{t}\\) for \\(1 \\leqslant i \\leqslant k\\) ).\n\nThe first point and the minimality of \\(k\\) tell us that \\(b_{1}^{t}, \\ldots, b_{k}^{t}\\) majorises \\(a_{1}^{t}, \\ldots, a_{k}^{t}\\) as well (again using the induction hypothesis), and in particular \\(b_{k}^{t} \\geqslant a_{k}^{t}\\).\n\nThe second point tells us that the remainder of \\(t\\) when divided by \\(n\\) is at most \\(k-1\\), so \\(a_{k}^{t} \\geqslant a_{m(t)}^{t}\\) (by Elisa's strategy). But by the third point \\((m(t) \\geqslant k+1)\\) and the nondecreasing property of \\(a_{i}^{t}\\), we must have the equalities \\(a_{k}^{t}=a_{k+1}^{t}=a_{m(t)}^{t}\\). On the other hand, \\(a_{k}^{t} \\leqslant b_{k}^{t}<b_{k+1}^{t}\\), with the second inequality being strict because \\(t \\not \\equiv k(\\bmod n)\\). We conclude that\n\\[\nb_{1}^{t}+b_{2}^{t}+\\cdots+b_{k+1}^{t}>a_{1}^{t}+a_{2}^{t}+\\cdots+a_{k+1}^{t}\n\\]\na contradiction to the induction hypothesis.\nThis completes the proof as it implies\n\\[\na_{n}^{t}-a_{1}^{t} \\leqslant b_{n}^{t}-b_{1}^{t} \\leqslant b_{n}^{0}-b_{1}^{0}=n-1\n\\]\n\nComment 1. The statement is true even when \\(n\\) is even. In this case, we instead use the initial state\n\\[\nb_{k}^{0}= \\begin{cases}k-\\frac{n}{2}-1 & k \\leqslant \\frac{n}{2} \\\\ k-\\frac{n}{2} & k>\\frac{n}{2}\\end{cases}\n\\]\n\nThe same argument shows that \\(C=n\\) works.\nComment 2. The constants \\(C=n-1\\) for odd \\(n\\) and \\(C=n\\) for even \\(n\\) are in fact optimal. To see this, we will assume that the fairy always locks a chest with the minimal number of gems. Then at every point, if a chest is locked, any other chest with fewer gems will also be locked. Thus \\(m(t)\\) is always greater than the remainder of \\(t\\) when divided by \\(n\\). This implies that the quantities\n\\[\nI_{k}=a_{1}^{t}+\\cdots+a_{k}^{t}-b_{1}^{t}-\\cdots-b_{k}^{t}\n\\]\nfor each \\(0 \\leqslant k \\leqslant n\\), do not increase regardless of how Elisa acts. If Elisa succeeds in keeping \\(a_{n}^{t}-a_{1}^{t}\\) bounded, then these quantities must also be bounded; thus they are eventually constant, say for \\(t \\geqslant t_{0}\\). This implies that for all \\(t \\geqslant t_{0}\\), the number \\(m(t)\\) is equal to 1 plus the remainder of \\(t\\) when divided by \\(n\\).\nClaim 2. For \\(T \\geqslant t_{0}\\) divisible by \\(n\\), we have\n\\[\na_{1}^{T}<a_{2}^{T}<\\cdots<a_{n}^{T}\n\\]\n\nProof. Suppose otherwise, and let \\(j\\) be an index for which \\(a_{j}^{T}=a_{j+1}^{T}\\). We have \\(m(T+k-1)=k\\) for all \\(1 \\leqslant k \\leqslant n\\). Then \\(a_{j}^{T+j}>a_{j+1}^{T+j}\\), which gives a contradiction.\n\nThis implies \\(a_{n}^{T}-a_{1}^{T} \\geqslant n-1\\), which already proves optimality of \\(C=n-1\\) for odd \\(n\\). For even \\(n\\), note that the sequence ( \\(a_{i}^{T}\\) ) has sum divisible by \\(n\\), so it cannot consist of \\(n\\) consecutive integers. Thus \\(a_{n}^{T}-a_{1}^{T} \\geqslant n\\) for \\(n\\) even.\n\nSolution 2. We solve the problem when 2023 is replaced with an arbitrary integer \\(n\\). We assume that Elisa uses the following strategy:\n\nAt the beginning of the \\((n t+1)^{\\text {th }}\\) day, Elisa first labels her chests as \\(C_{1}^{t}, \\ldots, C_{n}^{t}\\) so that before she adds in the gem, the number of gems in \\(C_{i}^{t}\\) is less than or equal \\(C_{j}^{t}\\) for all \\(1 \\leqslant i<j \\leqslant n\\). Then for days \\(n t+1, n t+2, \\ldots, n t+n\\), she adds a gem to chest \\(C_{i}^{t}\\), where \\(i\\) is chosen to be minimal such that \\(C_{i}^{t}\\) is unlocked.\n\nDenote by \\(c_{i}^{t}\\) the number of gems in chest \\(C_{i}^{t}\\) at the beginning of the \\((n t+1)^{\\text {th }}\\) day, so that\n\\[\nc_{1}^{t} \\leqslant c_{2}^{t} \\leqslant \\cdots \\leqslant c_{n}^{t}\n\\]\nby construction. Also, denote by \\(\\delta_{i}^{t}\\) the total number of gems added to chest \\(C_{i}^{t}\\) during days \\(n t+1, \\ldots, n t+n\\). We make the following observations.\n- We have \\(c_{1}^{0}=c_{2}^{0}=\\cdots=c_{n}^{0}=0\\).\n- We have \\(c_{1}^{t}+\\cdots+c_{n}^{t}=n t\\), since \\(n\\) gems are added every \\(n\\) days.\n- The sequence \\(\\left(c_{i}^{t+1}\\right)\\) is a permutation of the sequence \\(\\left(c_{i}^{t}+\\delta_{i}^{t}\\right)\\) for all \\(t \\geqslant 0\\).\n- We have \\(\\delta_{1}^{t}+\\cdots+\\delta_{n}^{t}=n\\) for all \\(t \\geqslant 0\\).\n- Since Elisa adds a gem to an unlocked chest \\(C_{i}^{t}\\) with \\(i\\) minimal, we have\n\\[\n\\delta_{1}^{t}+\\delta_{2}^{t}+\\cdots+\\delta_{k}^{t} \\geqslant k\n\\]\nfor every \\(1 \\leqslant k \\leqslant n\\) and \\(t \\geqslant 0\\).\nWe now define another sequence of sequences of integers as follows.\n\\[\nd_{i}^{0}=3 n\\left(i-\\frac{n+1}{2}\\right), \\quad d_{i}^{t}=d_{i}^{0}+t\n\\]\n\nWe observe that\n\\[\nd_{1}^{t}+\\cdots+d_{n}^{t}=c_{1}^{t}+\\cdots+c_{n}^{t}=n t\n\\]\n\nClaim 3. For each \\(t \\geqslant 0\\), the sequence ( \\(d_{i}^{t}\\) ) majorises the sequence ( \\(c_{i}^{t}\\) ).\nProof. We induct on \\(t\\). For \\(t=0\\), this is clear as all the terms in the sequence ( \\(c_{i}^{t}\\) ) are equal. For the induction step, we assume that ( \\(d_{i}^{t}\\) ) majorises ( \\(c_{i}^{t}\\) ). Given \\(1 \\leqslant k \\leqslant n-1\\), we wish to show that\n\\[\nd_{1}^{t+1}+\\cdots+d_{k}^{t+1} \\leqslant c_{1}^{t+1}+\\cdots+c_{k}^{t+1}\n\\]\n\nCase 1: \\(c_{1}^{t+1}, \\ldots, c_{k}^{t+1}\\) is a permutation of \\(c_{1}^{t}+\\delta_{1}^{t}, \\ldots, c_{k}^{t}+\\delta_{k}^{t}\\).\nSince \\(d_{1}^{t}+\\cdots+d_{k}^{t} \\leqslant c_{1}^{t}+\\cdots+c_{k}^{t}\\) by the induction hypothesis, we have\n\\[\n\\sum_{i=1}^{k} d_{i}^{t+1}=k+\\sum_{i=1}^{k} d_{i}^{t} \\leqslant k+\\sum_{i=1}^{k} c_{i}^{t} \\leqslant \\sum_{i=1}^{k}\\left(c_{i}^{t}+\\delta_{i}^{t}\\right)=\\sum_{i=1}^{k} c_{i}^{t+1}\n\\]\n\nCase 2: \\(c_{1}^{t+1}, \\ldots, c_{k}^{t+1}\\) is not a permutation of \\(c_{1}^{t}+\\delta_{1}^{t}, \\ldots, c_{k}^{t}+\\delta_{k}^{t}\\).\nIn this case, we have \\(c_{i}^{t}+\\delta_{i}^{t}>c_{j}^{t}+\\delta_{j}^{t}\\) for some \\(i \\leqslant k<j\\). It follows that\n\\[\nc_{k}^{t}+n \\geqslant c_{i}^{t}+n \\geqslant c_{i}^{t}+\\delta_{i}^{t}>c_{j}^{t}+\\delta_{j}^{t} \\geqslant c_{j}^{t} \\geqslant c_{k+1}^{t}\n\\]\n\nUsing \\(d_{k}^{t}+3 n=d_{k+1}^{t}\\) and the induction hypothesis, we obtain\n\\[\n\\begin{aligned}\n\\sum_{i=1}^{k} c_{i}^{t+1} & \\geqslant \\sum_{i=1}^{k} c_{i}^{t}>c_{1}^{t}+\\cdots+c_{k-1}^{t}+\\frac{1}{2} c_{k}^{t}+\\frac{1}{2} c_{k+1}^{t}-\\frac{n}{2}=\\frac{1}{2} \\sum_{i=1}^{k-1} c_{i}^{t}+\\frac{1}{2} \\sum_{i=1}^{k+1} c_{i}^{t}-\\frac{n}{2} \\\\\n& \\geqslant \\frac{1}{2} \\sum_{i=1}^{k-1} d_{i}^{t}+\\frac{1}{2} \\sum_{i=1}^{k+1} d_{i}^{t}-\\frac{n}{2}=n+\\sum_{i=1}^{k} d_{i}^{t} \\geqslant k+\\sum_{i=1}^{k} d_{i}^{t}=\\sum_{i=1}^{k} d_{i}^{t+1}\n\\end{aligned}\n\\]\n\nThis finishes the induction step.\nIt follows that\n\\[\nc_{n}^{t}-c_{1}^{t} \\leqslant d_{n}^{t}-d_{1}^{t}=3 n(n-1)\n\\]\n\nFrom day \\(n t+1\\) to day \\(n(t+1)+1\\), Elisa adds \\(n\\) gems, and therefore the difference may increase by at most \\(n\\). This shows that the difference of the number of gems in two chests never exceeds \\(C=3 n(n-1)+n\\).", "source_pdf": "imosl_2023.pdf", "notes": "fallback-regex"}
{"id": "IMOSL-2023-C7", "contest": "IMOSL", "year": "2023", "problem_number": "C7", "problem": "The Imomi archipelago consists of \\(n \\geqslant 2\\) islands. Between each pair of distinct islands is a unique ferry line that runs in both directions, and each ferry line is operated by one of \\(k\\) companies. It is known that if any one of the \\(k\\) companies closes all its ferry lines, then it becomes impossible for a traveller, no matter where the traveller starts at, to visit all the islands exactly once (in particular, not returning to the island the traveller started at).\n\nDetermine the maximal possible value of \\(k\\) in terms of \\(n\\).\n(Ukraine)", "solution": "Answer: The largest \\(k\\) is \\(k=\\left\\lfloor\\log _{2} n\\right\\rfloor\\).\n\n. We reformulate the problem using graph theory. We have a complete graph \\(K_{n}\\) on \\(n\\) nodes (corresponding to islands), and we want to colour the edges (corresponding to ferry lines) with \\(k\\) colours (corresponding to companies), so that every Hamiltonian path contains all \\(k\\) different colours. For a fixed set of \\(k\\) colours, we say that an edge colouring of \\(K_{n}\\) is good if every Hamiltonian path contains an edge of each one of these \\(k\\) colours.\n\nWe first construct a good colouring of \\(K_{n}\\) using \\(k=\\left\\lfloor\\log _{2} n\\right\\rfloor\\) colours.\nClaim 1. Take \\(k=\\left\\lfloor\\log _{2} n\\right\\rfloor\\). Consider the complete graph \\(K_{n}\\) in which the nodes are labelled by \\(1,2, \\ldots, n\\). Colour node \\(i\\) with colour \\(\\min \\left(\\left\\lfloor\\log _{2} i\\right\\rfloor+1, k\\right)\\) (so the colours of the first nodes are \\(1,2,2,3,3,3,3,4, \\ldots\\) and the last \\(n-2^{k-1}+1\\) nodes have colour \\(k\\) ), and for \\(1 \\leqslant i<j \\leqslant n\\), colour the edge \\(i j\\) with the colour of the node \\(i\\). Then the resulting edge colouring of \\(K_{n}\\) is good.\nProof. We need to check that every Hamiltonian path contains edges of every single colour. We first observe that the number of nodes assigned colour \\(k\\) is \\(n-2^{k-1}+1\\). Since \\(n \\geqslant 2^{k}\\), we have\n\\[\nn-2^{k-1}+1 \\geqslant \\frac{n}{2}+1 .\n\\]\n\nThis implies that in any Hamiltonian path, there exists an edge between two nodes with colour \\(k\\). Then that edge must have colour \\(k\\).\n\nWe next show that for each \\(1 \\leqslant i<k\\), every Hamiltonian path contains an edge of colour \\(i\\). Suppose the contrary, that some Hamiltonian path does not contain an edge of colour \\(i\\). Then nodes with colour \\(i\\) can only be adjacent to nodes with colour less than \\(i\\) inside the Hamiltonian path. Since there are \\(2^{i-1}\\) nodes with colour \\(i\\) and \\(2^{i-1}-1\\) nodes with colour less than \\(i\\), the Hamiltonian path must take the form\n\\[\n(i) \\leftrightarrow(<i) \\leftrightarrow(i) \\leftrightarrow(<i) \\leftrightarrow \\cdots \\leftrightarrow(<i) \\leftrightarrow(i),\n\\]\nwhere ( \\(i\\) ) denotes a node with colour \\(i,(<i)\\) denotes a node with colour less than \\(i\\), and \\(\\leftrightarrow\\) denotes an edge. But this is impossible, as the Hamiltonian path would not have any nodes with colours greater than \\(i\\).\n\nFix a set of \\(k\\) colours, we now prove that if there exists a good colouring of \\(K_{n}\\), then \\(k \\leqslant\\left\\lfloor\\log _{2} n\\right\\rfloor\\). For \\(n=2\\), this is trivial, so we assume \\(n \\geqslant 3\\). For any node \\(v\\) of \\(K_{n}\\) and \\(1 \\leqslant i \\leqslant k\\), we denote by \\(d_{i}(v)\\) the number of edges with colour \\(i\\) incident with the node \\(v\\).\nLemma 1. Consider a good colouring of \\(K_{n}\\), and let \\(A B\\) be an arbitrary edge with colour \\(i\\). If \\(d_{i}(A)+d_{i}(B) \\leqslant n-1\\), then the colouring will remain good after recolouring edge \\(A B\\) with any other colour.\nProof. Suppose there exists a good colouring together with an edge \\(A B\\) of colour \\(i\\), such that if \\(A B\\) is recoloured with another colour, the colouring will no longer be good. The failure of the new colouring being good will come from colour \\(i\\), and thus there exists a Hamiltonian path containing edge \\(A B\\) such that initially (i.e. before recolouring) \\(A B\\) is the only edge of colour \\(i\\) in this path. Writing \\(A=A_{0}\\) and \\(B=B_{0}\\), denote this Hamiltonian path by\n\\[\nA_{s} \\leftrightarrow A_{s-1} \\leftrightarrow \\cdots \\leftrightarrow A_{1} \\leftrightarrow A_{0} \\leftrightarrow B_{0} \\leftrightarrow B_{1} \\leftrightarrow \\cdots \\leftrightarrow B_{t-1} \\leftrightarrow B_{t},\n\\]\nwhere \\(s, t \\geqslant 0\\) and \\(s+t+2=n\\).\nIn the initial colouring, we observe the following.\n- The edge \\(B_{0} A_{s}\\) must have colour \\(i\\), since otherwise the path\n\\[\nA_{0} \\leftrightarrow A_{1} \\leftrightarrow \\cdots \\leftrightarrow A_{s-1} \\leftrightarrow A_{s} \\leftrightarrow B_{0} \\leftrightarrow B_{1} \\leftrightarrow \\cdots \\leftrightarrow B_{t-1} \\leftrightarrow B_{t}\n\\]\nhas no edges of colour \\(i\\).\n- Similarly, the edge \\(A_{0} B_{t}\\) must have colour \\(i\\).\n- For each \\(0 \\leqslant p<s\\), at least one of the edges \\(B_{0} A_{p}\\) and \\(A_{0} A_{p+1}\\) must have colour \\(i\\), since otherwise the path\n\\[\nA_{s} \\leftrightarrow \\cdots \\leftrightarrow A_{p+2} \\leftrightarrow A_{p+1} \\leftrightarrow A_{0} \\leftrightarrow A_{1} \\leftrightarrow \\cdots \\leftrightarrow A_{p-1} \\leftrightarrow A_{p} \\leftrightarrow B_{0} \\leftrightarrow B_{1} \\leftrightarrow \\cdots \\leftrightarrow B_{t}\n\\]\nhas no edges of colour \\(i\\).\n- Similarly, for each \\(0 \\leqslant q<t\\), at least one of the edges \\(A_{0} B_{q}\\) and \\(B_{0} B_{q+1}\\) must have colour \\(i\\).\n\nIn the above list, each edge \\(A_{0} X\\) appears exactly once and also each edge \\(B_{0} X\\) appears exactly once (where \\(A_{0} B_{0}\\) and \\(B_{0} A_{0}\\) are counted separately). Adding up the contributions to \\(d_{i}(A)+ d_{i}(B)\\), we obtain\n\\[\nd_{i}(A)+d_{i}(B) \\geqslant(s+1)+(t+1)=n\n\\]\n\nThis contradicts our assumption that \\(d_{i}(A)+d_{i}(B) \\leqslant n-1\\).\nOur strategy now is to repeatedly recolour the edges using Lemma 1 until the colouring has a simple structure. For a node \\(v\\), we define \\(m(v)\\) to be the largest value of \\(d_{i}(v)\\) over all colours \\(i\\).\nLemma 2. Assume we have a good colouring of \\(K_{n}\\). Let \\(A, B\\) be two distinct nodes, and let \\(j\\) be the colour of edge \\(A B\\) where \\(1 \\leqslant j \\leqslant k\\). If\n- \\(m(A) \\geqslant m(B)\\) and\n- \\(m(A)=d_{i}(A)\\) for some \\(i \\neq j\\),\nthen after recolouring edge \\(A B\\) with colour \\(i\\), the colouring remains good.\nProof. Note that\n\\[\nd_{j}(A)+d_{j}(B) \\leqslant(n-1-m(A))+m(B) \\leqslant n-1,\n\\]\nand so we may apply Lemma 1.\nLemma 3. Assume we have a good colouring of \\(K_{n}\\). Let \\(S\\) be a nonempty set of nodes. Let \\(A \\in S\\) be a node such that \\(m(A) \\geqslant m(B)\\) for all \\(B \\in S\\), and choose \\(1 \\leqslant i \\leqslant k\\) for which \\(d_{i}(A)=m(A)\\). Then after recolouring the edge \\(A B\\) with colour \\(i\\) for all \\(B \\in S\\) distinct from \\(A\\), the colouring remains good.\nProof. We repeatedly perform the following operation until all edges \\(A B\\) with \\(B \\in S\\) have colour \\(i\\) :\nchoose an edge \\(A B\\) with \\(B \\in S\\) that does not have colour \\(i\\), and recolour it with colour \\(i\\).\n\nBy Lemma 2, the colouring remains good after one operation. Moreover, \\(m(A)\\) increase by 1 during an operation, and all other \\(m(B)\\) may increase by at most 1 . This shows that \\(m(A)\\) will remain maximal amongst \\(m(B)\\) for \\(B \\in S\\). We will also have \\(d_{i}(A)=m(A)\\) after the operation, since both sides increase by 1 . Therefore the operation can be performed repeatedly, and the colouring remains good.\n\nWe first apply Lemma 3 to the set of all \\(n\\) nodes in \\(K_{n}\\). After recolouring, there exists a node \\(A_{1}\\) such that every edge incident with \\(A_{1}\\) has colour \\(c_{1}\\). We then apply Lemma 3 to the set of nodes excluding \\(A_{1}\\), and we obtain a colouring where\n- every edge incident with \\(A_{1}\\) has colour \\(c_{1}\\),\n- every edge incident with \\(A_{2}\\) except for \\(A_{1} A_{2}\\) has colour \\(c_{2}\\).\n\nRepeating this process, we arrive at the following configuration:\n- the \\(n\\) nodes of \\(K_{n}\\) are labelled \\(A_{1}, A_{2}, \\ldots, A_{n}\\),\n- the node \\(A_{i}\\) has a corresponding colour \\(c_{i}\\) (as a convention, we also colour \\(A_{i}\\) with \\(c_{i}\\) ),\n- for all \\(1 \\leqslant u<v \\leqslant n\\), the edge between \\(A_{u}\\) and \\(A_{v}\\) has colour \\(c_{u}\\),\n- this colouring is good.\n\nClaim 2. For every colour \\(i\\), there exists a \\(1 \\leqslant p \\leqslant n\\) such that the number of nodes of colour \\(i\\) amongst \\(A_{1}, \\ldots, A_{p}\\) is greater than \\(p / 2\\).\nProof. Suppose the contrary, that for every \\(1 \\leqslant p \\leqslant n\\), there are at most \\(\\lfloor p / 2\\rfloor\\) nodes of colour \\(i\\). We then construct a Hamiltonian path not containing any edge of colour \\(i\\). Let \\(A_{x_{1}}, \\ldots, A_{x_{t}}\\) be the nodes with colour \\(i\\), where \\(x_{1}<x_{2}<\\cdots<x_{t}\\), and let \\(A_{y_{1}}, A_{y_{2}}, \\ldots, A_{y_{s}}\\) be the nodes with colour different from \\(i\\), where \\(y_{1}<y_{2}<\\cdots<y_{s}\\). We have \\(s+t=n\\) and \\(t \\leqslant\\lfloor n / 2\\rfloor\\), so \\(t \\leqslant s\\). We also see that \\(y_{j}<x_{j}\\) for all \\(1 \\leqslant j \\leqslant t\\), because otherwise, \\(A_{1}, A_{2}, \\ldots, A_{x_{j}}\\) will have \\(j\\) nodes of colour \\(i\\) and less than \\(j\\) nodes of colour different from \\(i\\). Then we can construct a Hamiltonian path\n\\[\nA_{x_{1}} \\leftrightarrow A_{y_{1}} \\leftrightarrow A_{x_{2}} \\leftrightarrow A_{y_{2}} \\leftrightarrow A_{x_{3}} \\leftrightarrow \\cdots \\leftrightarrow A_{x_{t}} \\leftrightarrow A_{y_{t}} \\leftrightarrow A_{y_{t+1}} \\leftrightarrow \\cdots \\leftrightarrow A_{y_{s}}\n\\]\nthat does not contain an edge with colour \\(i\\). This contradicts that the colouring is good.\nSo for every colour \\(i\\), there has to be an integer \\(p_{i}\\) with \\(1 \\leqslant p_{i} \\leqslant n\\) such that there are more than \\(p_{i} / 2\\) nodes assigned colour \\(i\\) amongst \\(A_{1}, \\ldots, A_{p_{i}}\\). Choose the smallest such \\(p_{i}\\) for every \\(i\\), and without loss of generality assume\n\\[\np_{1}<p_{2}<\\cdots<p_{k} .\n\\]\n\nNote that the inequalities are strict by the definition of \\(p_{i}\\).\nThen amongst the nodes \\(A_{1}, \\ldots, A_{p_{i}}\\), there are at least \\(\\left\\lceil\\left(p_{j}+1\\right) / 2\\right\\rceil\\) nodes of colour \\(j\\) for all \\(1 \\leqslant j \\leqslant i\\). Then\n\\[\np_{i} \\geqslant\\left\\lceil\\frac{p_{1}+1}{2}\\right\\rceil+\\left\\lceil\\frac{p_{2}+1}{2}\\right\\rceil+\\cdots+\\left\\lceil\\frac{p_{i}+1}{2}\\right\\rceil .\n\\]\n\nThis inductively shows that\n\\[\np_{i} \\geqslant 2^{i}-1\n\\]\nfor all \\(1 \\leqslant i \\leqslant k\\), and this already proves \\(n \\geqslant 2^{k}-1\\).\nIt remains to show that \\(n=2^{k}-1\\) is not possible. If \\(n=2^{k}-1\\), then all inequalities have to be equalities, so \\(p_{i}=2^{i}-1\\) and there must be exactly \\(2^{i-1}\\) nodes of colour \\(i\\). Moreover, there cannot be a node of colour \\(i\\) amongst \\(A_{1}, A_{2}, \\ldots, A_{p_{i-1}}\\), and so the set of nodes of colour \\(i\\) must precisely be\n\\[\nA_{2^{i-1}}, A_{2^{i-1}+1}, \\ldots, A_{2^{i}-1}\n\\]\n\nThen we can form a Hamiltonian path\n\\[\nA_{2^{k-1}} \\leftrightarrow A_{1} \\leftrightarrow A_{2^{k-1}+1} \\leftrightarrow A_{2} \\leftrightarrow A_{2^{k-1}+2} \\leftrightarrow A_{3} \\leftrightarrow \\ldots \\leftrightarrow A_{n}\n\\]\nwhich does not contain an edge of colour \\(k\\). This is a contradiction, and therefore \\(n \\geqslant 2^{k}\\).\n\n\\section*{Geometry}", "source_pdf": "imosl_2023.pdf", "notes": "fallback-regex"}
{"id": "IMOSL-2023-G1", "contest": "IMOSL", "year": "2023", "problem_number": "G1", "problem": "Let \\(A B C D E\\) be a convex pentagon such that \\(\\angle A B C=\\angle A E D=90^{\\circ}\\). Suppose that the midpoint of \\(C D\\) is the circumcentre of triangle \\(A B E\\). Let \\(O\\) be the circumcentre of triangle \\(A C D\\).\n\nProve that line \\(A O\\) passes through the midpoint of segment \\(B E\\).\n(Slovakia)\n\n\\section*{", "solution": "1 (Area Ratio).}\n![](https://cdn.mathpix.com/cropped/2025_08_23_2cb0be1b73ef2aa9a4e9g-57.jpg?height=1217&width=1161&top_left_y=808&top_left_x=459)\n\nLet \\(M\\) be the midpoint of \\(C D\\) and \\(X=B C \\cap E D\\). Since \\(\\angle A B X=\\angle A E X=90^{\\circ}, A X\\) is a diameter of the circumcircle of \\(\\triangle A B E\\) so the midpoint of \\(A X\\) is the circumcentre of \\(\\triangle A B E\\). Therefore, the midpoint of \\(A X\\) coincides with \\(M\\). This means \\(A C X D\\) is a parallelogram and in particular, \\(A D \\| B C\\) and \\(A C \\| E D\\).\n\nWe denote the area of \\(\\triangle P_{1} P_{2} P_{3}\\) by \\(\\left[P_{1} P_{2} P_{3}\\right]\\). To prove that line \\(A O\\) bisects \\(B E\\), it suffices to show \\([O A B]=[O A E]\\).\n\nLet \\(C^{\\prime}, D^{\\prime}\\) be the midpoints of \\(A C, A D\\) respectively. Since \\(O D^{\\prime} \\perp A D, A D \\| B C\\), and \\(B C \\perp A B\\), we have \\(A B \\| O D^{\\prime}\\), so \\([O A B]=\\left[D^{\\prime} A B\\right]\\). Using \\(A D \\| B C\\) again, we have \\(\\left[D^{\\prime} A B\\right]=\\left[D^{\\prime} A C\\right]\\). Therefore\n\\[\n[O A B]=\\left[D^{\\prime} A B\\right]=\\left[D^{\\prime} A C\\right]=\\frac{1}{2}[A C D] .\n\\]\n\nSimilarly\n\\[\n[O A E]=\\left[C^{\\prime} A E\\right]=\\left[C^{\\prime} A D\\right]=\\frac{1}{2}[A C D] .\n\\]\n\nCombining these gives \\([O A B]=[O A E]\\).\nComment 1. The following is another way to prove \\(A D \\| B C\\) and \\(A C \\| E D\\).\nLet \\(\\ell\\) be the perpendicular bisector of \\(A B\\). Since the midpoint of \\(C D\\) is the circumcentre of \\(\\triangle A B E\\), it must lie on \\(\\ell\\). Also, since \\(\\angle A B C=90^{\\circ}\\), the midpoint of \\(A C\\) is on \\(\\ell\\). Therefore, we get \\(A D\\|\\ell\\| B C\\) and similarly \\(A C \\| E D\\).\n\n\\section*{Solution 2 (Similar Triangles).}\n![](https://cdn.mathpix.com/cropped/2025_08_23_2cb0be1b73ef2aa9a4e9g-58.jpg?height=1241&width=1183&top_left_y=673&top_left_x=448)\n\nLet \\(M\\) be the midpoint of \\(C D\\) and \\(X=B C \\cap E D\\). As in Solution \\(1, M\\) is the midpoint of \\(A X\\) and \\(A C X D\\) is a parallelogram. Since \\(A D \\| B C\\) and \\(\\angle A B C=90^{\\circ}\\), we have \\(\\angle D A B=90^{\\circ}\\).\n\nLet \\(N\\) be the midpoint of \\(B E\\). It is enough to show that \\(\\angle N A B=\\angle O A B\\). Since \\(A B X E\\) is cyclic, we have\n\\[\n\\angle A B E=\\angle A X E=\\angle X A C \\quad \\text { and } \\quad \\angle B E A=\\angle C X A .\n\\]\n\nTherefore, \\(\\triangle A B E \\sim \\triangle C A X\\), and \\(N\\) corresponds to \\(M\\) under this similarity. In particular, \\(\\angle N A B=\\angle A C M\\).\n\nAlso, we have\n\\[\n\\angle O A B=90^{\\circ}-\\angle D A O=\\angle A C M=\\angle N A B .\n\\]\n\n\\section*{Solution 3 (Reflection).}\n![](https://cdn.mathpix.com/cropped/2025_08_23_2cb0be1b73ef2aa9a4e9g-59.jpg?height=998&width=1454&top_left_y=342&top_left_x=308)\n\nLet \\(N\\) be the midpoint of \\(B E\\), and let \\(F, G\\) be the projections of \\(C, D\\) onto \\(A D, A C\\) respectively. \\(C G F D\\) is cyclic so\n\\[\n\\angle A G F=\\angle C D F=\\angle C D A=90^{\\circ}-\\angle O A C\n\\]\ngiving \\(A O \\perp F G\\). Therefore it's enough to show that \\(A N \\perp F G\\).\nAs in Solution 1, \\(A D \\| B C\\) and \\(A C \\| E D\\) so \\(\\angle E A G=\\angle F A B=90^{\\circ}\\) and in fact \\(A E D G\\) and \\(A F C B\\) are rectangles. From this we get\n\\[\n\\angle A G E=\\angle D A G=\\angle F A C=\\angle B F A\n\\]\nso\n\\(\\triangle G A E \\sim \\triangle F A B\\).\nLet \\(F^{\\prime}\\) be the reflection of \\(F\\) in \\(A\\), then \\(\\triangle F^{\\prime} A B \\sim \\triangle F A B \\sim \\triangle G A E\\). Thus \\(A\\) is the centre of the spiral symmetry taking \\(F^{\\prime} B \\rightarrow G E\\).\n\nLet \\(P\\) be the midpoint of \\(F^{\\prime} G\\) then by the spiral similarity, we have \\(\\triangle A P N \\sim \\triangle A G E\\) which implies \\(\\angle N A P=90^{\\circ}\\). From \\(A\\) being the midpoint of \\(F F^{\\prime}\\) we have \\(A P \\| F G\\). Combining the results gives \\(A N \\perp F G\\).", "source_pdf": "imosl_2023.pdf", "notes": "fallback-regex"}
{"id": "IMOSL-2023-G2", "contest": "IMOSL", "year": "2023", "problem_number": "G2", "problem": "Let \\(A B C\\) be a triangle with \\(A C>B C\\). Let \\(\\omega\\) be the circumcircle of triangle \\(A B C\\) and let \\(r\\) be the radius of \\(\\omega\\). Point \\(P\\) lies on segment \\(A C\\) such that \\(B C=C P\\) and point \\(S\\) is the foot of the perpendicular from \\(P\\) to line \\(A B\\). Let ray \\(B P\\) intersect \\(\\omega\\) again at \\(D\\) and let \\(Q\\) lie on line \\(S P\\) such that \\(P Q=r\\) and \\(S, P, Q\\) lie on the line in that order. Finally, let the line perpendicular to \\(C Q\\) from \\(A\\) intersect the line perpendicular to \\(D Q\\) from \\(B\\) at \\(E\\).\n\nProve that \\(E\\) lies on \\(\\omega\\).\n(Iran)\n\n\\section*{", "solution": "1 (Similar Triangles).}\n![](https://cdn.mathpix.com/cropped/2025_08_23_2cb0be1b73ef2aa9a4e9g-60.jpg?height=1169&width=1209&top_left_y=745&top_left_x=419)\n\nFirst observe that\n\\[\n\\angle D P A=\\angle B P C^{C P=C B} \\angle C B P=\\angle C B D=\\angle C A D=\\angle P A D\n\\]\nso \\(D P=D A\\). Thus there is a symmetry in the problem statement swapping \\((A, D) \\leftrightarrow(B, C)\\).\nLet \\(O\\) be the centre of \\(\\omega\\) and let \\(E\\) be the reflection of \\(P\\) in \\(C D\\) which, by\n\\[\n\\angle C E D=\\angle D P C=180^{\\circ}-\\angle C P B \\stackrel{C P=C B}{=} 180^{\\circ}-\\angle P B C=180^{\\circ}-\\angle D B C\n\\]\nlies on \\(\\omega\\). We claim the two lines concur at \\(E\\). By the symmetry noted above, it suffices to prove that \\(B E \\perp D Q\\) and then \\(A E \\perp C Q\\) will follow by symmetry.\n\nWe have \\(A O=P Q, A D=D P\\) and\n\\[\n\\angle D A O=90^{\\circ}-\\angle A B D \\stackrel{P Q \\perp A B}{=} \\angle D P Q .\n\\]\n\nHence \\(\\triangle A O D \\cong \\triangle P Q D\\). Thus\n\\(\\angle Q D B+\\angle D B E=\\angle O D A+\\angle D A E \\stackrel{D E=D A}{=} \\angle O D A+\\angle A E D=\\left(90^{\\circ}-\\angle A E D\\right)+\\angle A E D=90^{\\circ}\\) giving \\(B E \\perp D Q\\) as required.\n\n\\section*{Solution 2 (Second Circle).}\n![](https://cdn.mathpix.com/cropped/2025_08_23_2cb0be1b73ef2aa9a4e9g-61.jpg?height=1166&width=1135&top_left_y=359&top_left_x=456)\n\nAs in Solution 1, we prove that \\(D A=D P\\) and note the symmetry in the problem statement swapping \\((A, D) \\leftrightarrow(B, C)\\).\n\nLet \\(\\Gamma\\) be the circumcircle of \\(\\triangle P C D\\). Since \\(D P=D A\\) and \\(\\angle A C D=\\angle P C D\\), the radius of \\(\\Gamma\\) is equal to that of \\(\\omega\\). We have that\n\\[\n\\angle D P Q=\\angle B P S=90^{\\circ}-\\angle A B D=90^{\\circ}-\\angle P C D .\n\\]\n\nThis, combined with \\(P Q\\) being equal to the common circumradius of \\(\\Gamma\\) and \\(\\omega\\), means that \\(Q\\) is the circumcentre of \\(\\Gamma\\).\n\nLet the perpendiculars to \\(C Q, D Q\\) from \\(A, B\\) intersect at \\(E\\) then we have\n\\[\n\\begin{aligned}\n& \\angle E A C=90^{\\circ}-\\angle A C Q^{Q C=Q P} 90^{\\circ}-\\angle Q P C=90^{\\circ}-\\angle S P A=\\angle C A B \\Longrightarrow \\angle E A B=2 \\angle P A B \\\\\n& \\angle D B E=90^{\\circ}-\\angle Q D P \\stackrel{Q D=Q P}{=} 90^{\\circ}-\\angle D P Q=90^{\\circ}-\\angle B P S=\\angle A B D \\Longrightarrow \\angle A B E=2 \\angle A B P .\n\\end{aligned}\n\\]\n\nCombining these\n\\[\n\\angle B E A=180^{\\circ}-2(\\angle P A B+\\angle A B P)=180^{\\circ}-2 \\angle A P D \\stackrel{D A=D P}{=} \\angle B D A\n\\]\nwhich gives that \\(E\\) lies on \\(\\omega\\).\nComment 1. An alternative final angle chase is\n\\[\n\\angle B E A=180^{\\circ}-\\angle C Q D \\stackrel{\\Gamma}{=} 180^{\\circ}-2\\left(180^{\\circ}-\\angle D P C\\right)=180^{\\circ}-2 \\angle A P D^{D A=D P} \\angle P D A=\\angle B D A \\text {. }\n\\]\n\nComment 2. An alternative formulation of the problem in terms of a cyclic quadrilateral is given below:\n\nLet \\(A B C D\\) be a cyclic quadrilateral with circumcircle \\(\\omega\\) and circumradius \\(r\\). The diagonals \\(A C\\) and \\(B D\\) intersect at \\(P\\). Suppose that \\(A D=D P\\). Let \\(S\\) be the foot of the perpendicular from \\(P\\) to the line \\(A B\\). Point \\(Q\\) lies on line \\(S P\\) such that \\(P Q=r\\) and \\(S, P, Q\\) lie on the line in that order. Let the line perpendicular to \\(C Q\\) from \\(A\\) intersect the line perpendicular to \\(D Q\\) from \\(B\\) at \\(E\\).\n\nProve that \\(E\\) lies on \\(\\omega\\).", "source_pdf": "imosl_2023.pdf", "notes": "fallback-regex"}
{"id": "IMOSL-2023-G3", "contest": "IMOSL", "year": "2023", "problem_number": "G3", "problem": "Let \\(A B C D\\) be a cyclic quadrilateral with \\(\\angle B A D<\\angle A D C\\). Let \\(M\\) be the midpoint of the \\(\\operatorname{arc} C D\\) not containing \\(A\\). Suppose there is a point \\(P\\) inside \\(A B C D\\) such that \\(\\angle A D B= \\angle C P D\\) and \\(\\angle A D P=\\angle P C B\\).\n\nProve that lines \\(A D, P M, B C\\) are concurrent.\n(Slovakia)", "solution": "1. Let \\(X\\) and \\(Y\\) be the intersection points of \\(A M\\) and \\(B M\\) with \\(P D\\) and \\(P C\\) respectively. Since \\(A B C M D\\) is cyclic and \\(C M=M D\\), we have\n\\[\n\\angle X A D=\\angle M A D=\\angle C B M=\\angle C B Y .\n\\]\n\nCombining this with \\(\\angle A D X=\\angle Y C B\\), we get \\(\\angle D X A=\\angle B Y C\\), and so \\(\\angle P X M=\\angle M Y P\\). Moreover, \\(\\angle Y P X=\\angle C P D=\\angle A D B=\\angle A M B\\). The quadrilateral \\(M X P Y\\) therefore has equal opposite angles and so is a parallelogram.\n![](https://cdn.mathpix.com/cropped/2025_08_23_2cb0be1b73ef2aa9a4e9g-63.jpg?height=1283&width=1120&top_left_y=1016&top_left_x=471)\n\nLet \\(R\\) and \\(S\\) be the intersection points of \\(A M\\) and \\(B M\\) with \\(B C\\) and \\(A D\\) respectively. Due to \\(A M \\| P C\\) and \\(B M \\| P D\\), we have \\(\\angle A S B=\\angle A D P=\\angle P C B=\\angle A R B\\) and so the quadrilateral \\(A B R S\\) is cyclic. We then have \\(\\angle S R B=180^{\\circ}-\\angle B A S=\\angle D C B\\) and so \\(S R \\| C D\\). In triangles \\(P C D\\) and \\(M R S\\), the corresponding sides are parallel so they are homothetic meaning lines \\(D S, P M, C R\\) concur at the centre of this homothety.\n\nSolution 2. Let \\(A D\\) and \\(B C\\) meet at \\(T\\). Denote by \\(p_{a}, p_{b}, m_{a}\\) and \\(m_{b}\\) the distances between line \\(T A\\) and \\(P, T B\\) and \\(P, T A\\) and \\(M\\) and between \\(T B\\) and \\(M\\) respectively. Our goal is to prove \\(p_{a}: p_{b}=m_{a}: m_{b}\\) which is equivalent to the collinearity of \\(T, P\\) and \\(M\\).\n![](https://cdn.mathpix.com/cropped/2025_08_23_2cb0be1b73ef2aa9a4e9g-64.jpg?height=969&width=1172&top_left_y=445&top_left_x=445)\n\nLet \\(\\angle B A C=\\angle B D C=\\alpha, \\angle D B A=\\angle D C A=\\beta, \\angle A D B=\\angle A M B=\\angle A C B= \\angle C P D=\\mu, \\angle A D P=\\angle P C B=\\nu\\) and \\(\\angle M A D=\\angle C A M=\\angle M B D=\\angle C B M=\\chi\\).\n\nFrom \\(\\angle A D P=\\angle P C B=\\nu\\) and \\(\\angle M A D=\\angle C B M=\\chi\\) we get\n\\[\n\\frac{p_{a}}{p_{b}}=\\frac{P D \\cdot \\sin \\nu}{P C \\cdot \\sin \\nu}=\\frac{P D}{P C} \\quad \\text { and } \\quad \\frac{m_{a}}{m_{b}}=\\frac{M A \\cdot \\sin \\chi}{M B \\cdot \\sin \\chi}=\\frac{M A}{M B} .\n\\]\n\nHence \\(p_{a}: p_{b}=m_{a}: m_{b}\\) is equivalent to \\(P D: P C=M A: M B\\), and since \\(\\angle C P D=\\angle A M B= \\mu\\), this means we have to show that triangles \\(P D C\\) and \\(M A B\\) are similar.\n\nIn triangle \\(P D C\\) we have\n\\[\n\\begin{aligned}\n& \\angle P D C+\\angle D C P=180^{\\circ}-\\angle C P D=180^{\\circ}-\\mu, \\\\\n& \\angle P D C-\\angle D C P=(\\alpha+\\mu-\\nu)-(\\beta+\\mu-\\nu)=\\alpha-\\beta .\n\\end{aligned}\n\\]\n\nSimilarly, in triangle \\(M A B\\) we have\n\\[\n\\begin{aligned}\n& \\angle B A M+\\angle M B A=180^{\\circ}-\\angle A M B=180^{\\circ}-\\mu, \\\\\n& \\angle B A M-\\angle M B A=(\\alpha+\\chi)-(\\beta+\\chi)=\\alpha-\\beta .\n\\end{aligned}\n\\]\n\nTherefore, ( \\(\\angle B A M, \\angle M B A\\) ) and ( \\(\\angle P D C, \\angle D C P\\) ) satisfy the same system of linear equations. The common solution is\n\\[\n\\angle B A M=\\angle P D C=\\frac{180^{\\circ}-\\mu+\\alpha-\\beta}{2} \\quad \\text { and } \\quad \\angle M B A=\\angle D C P=\\frac{180^{\\circ}-\\mu-\\alpha+\\beta}{2} .\n\\]\n\nHence triangles \\(P D C\\) and \\(M A B\\) have equal angles and so are similar. This completes the proof.", "source_pdf": "imosl_2023.pdf", "notes": "fallback-regex"}
{"id": "IMOSL-2023-G5", "contest": "IMOSL", "year": "2023", "problem_number": "G5", "problem": "Let \\(A B C\\) be an acute-angled triangle with circumcircle \\(\\omega\\) and circumcentre \\(O\\). Points \\(D \\neq B\\) and \\(E \\neq C\\) lie on \\(\\omega\\) such that \\(B D \\perp A C\\) and \\(C E \\perp A B\\). Let \\(C O\\) meet \\(A B\\) at \\(X\\), and \\(B O\\) meet \\(A C\\) at \\(Y\\).\n\nProve that the circumcircles of triangles \\(B X D\\) and \\(C Y E\\) have an intersection on line \\(A O\\).\n(Malaysia)\n\n\\section*{", "solution": "1 (Reflections).}\n\nNote that \\(A O=O C\\) implies the lines \\(A O, X O\\) are reflections of each other about the line parallel to \\(A C\\) through \\(O\\), which is the perpendicular bisector of \\(B D\\). Call this line \\(\\ell\\).\n\nLet \\(P \\neq X\\) be the second intersection of circle \\(\\odot B X D\\) with line \\(X O\\), and let \\(Z\\) be the intersection of circle \\(\\odot B X D\\) with line \\(A O\\) furthest from \\(A\\).\n\nConsider a reflection across \\(\\ell\\). This maps \\(B\\) to \\(D, A O\\) to \\(X O\\), and circle \\(\\odot B X D\\) to itself so the transformation must map \\(P\\), the intersection of \\(X O\\) and circle \\(\\odot B X D\\), to the intersection of \\(A O\\) and \\(\\odot B X D\\) furthest from \\(A\\) i.e. \\(Z\\). Thus we have\n\\[\n\\angle O Z B=\\angle D P O=\\angle D P X=\\angle D B X=90^{\\circ}-\\angle B A C=\\angle O C B\n\\]\nwhich implies \\(B O C Z\\) is cyclic.\nTherefore the second intersection of circle \\(\\odot B O C\\) with line \\(A O\\) lies on circle \\(\\odot B X D\\). Similarly, \\(Z\\) lies on circle \\(\\odot C Y E\\) so the two circles have common point \\(Z\\) on \\(A O\\).\n![](https://cdn.mathpix.com/cropped/2025_08_23_2cb0be1b73ef2aa9a4e9g-69.jpg?height=1055&width=991&top_left_y=1376&top_left_x=531)\n\n\\section*{Solution 2 (Similar Triangles).}\n![](https://cdn.mathpix.com/cropped/2025_08_23_2cb0be1b73ef2aa9a4e9g-70.jpg?height=1272&width=786&top_left_y=342&top_left_x=639)\n\nLet \\(B^{\\prime}\\) be the reflection of \\(B\\) in \\(A C\\) and let \\(A O\\) intersect circle \\(\\odot O B C\\) again at \\(Z \\neq O\\). Observe that\n\\(\\angle B^{\\prime} C A+\\angle A C Z=2 \\angle A C B+\\angle B C Z=2 \\angle A C B+\\angle B O Z=2 \\angle A C B+\\left(180^{\\circ}-\\angle A O B\\right)=180^{\\circ}\\) so \\(Z, C, B^{\\prime}\\) are collinear.\n\nClaim. Triangles \\(Z X A\\) and \\(Z D B^{\\prime}\\) are similar.\nProof. We have\n\\[\n\\angle X A Z=\\angle B A O=90^{\\circ}-\\angle A C B=\\angle C B B^{\\prime}=\\angle B B^{\\prime} C=\\angle D B^{\\prime} Z .\n\\]\n\nSo it suffices to prove that \\(\\frac{B^{\\prime} Z}{B^{\\prime} D}=\\frac{A Z}{A X}\\). To do this, first observe\n\\[\n\\angle B^{\\prime} Z A=\\angle C Z O=\\angle C B O=\\angle X C B \\quad \\text { and } \\quad \\angle A B^{\\prime} Z=\\angle A B^{\\prime} C=\\angle C B A=\\angle C B X .\n\\]\n\nHence triangles \\(Z A B^{\\prime}\\) and \\(C X B\\) are similar so\n\\[\n\\frac{B^{\\prime} Z}{A Z}=\\frac{B C}{C X} .\n\\]\n\nNote that the orthocentre \\(H\\) of triangle \\(A B C\\) is the reflection of \\(D\\) in \\(A C\\). Applying sine rule to triangles \\(A C X\\) and \\(B H C\\) gives\n\\[\n\\frac{A X}{C X}=\\frac{\\sin \\angle A C X}{\\sin \\angle X A C}=\\frac{\\sin \\left(90^{\\circ}-\\angle C B A\\right)}{\\sin \\angle B A C}=\\frac{\\sin \\left(90^{\\circ}-\\angle C B A\\right)}{\\sin \\left(180^{\\circ}-\\angle B A C\\right)}=\\frac{\\sin \\angle H C B}{\\sin \\angle B H C}=\\frac{B H}{B C}=\\frac{B^{\\prime} D}{B C} .\n\\]\n\nMultiplying the two results gives\n\\[\n\\frac{B^{\\prime} Z}{A Z} \\cdot \\frac{A X}{C X}=\\frac{B C}{C X} \\cdot \\frac{B^{\\prime} D}{B C}=\\frac{B^{\\prime} D}{C X}\n\\]\nwhich implies \\(\\frac{B^{\\prime} Z}{B^{\\prime} D}=\\frac{A Z}{A X}\\), as required.\nFrom the claim\n\\[\n\\angle B D Z=180^{\\circ}-\\angle Z D B^{\\prime}=180^{\\circ}-\\angle Z X A=\\angle B X Z\n\\]\nwhich means \\(Z\\) lies on circle \\(\\odot B X D\\). Similarly, \\(Z\\) lies on circle \\(\\odot C Y E\\) completing the proof.\n\n\\section*{Solution 3 (Inversion at \\(A\\) ).}\n![](https://cdn.mathpix.com/cropped/2025_08_23_2cb0be1b73ef2aa9a4e9g-71.jpg?height=1146&width=1332&top_left_y=916&top_left_x=368)\n\nConsider the composition of the inversion at \\(A\\) with radius \\(\\sqrt{A B \\times A C}\\) and reflection in the angle bisector of \\(\\angle B A C\\), and use \\(P^{*}\\) to denote the image of a point \\(P\\) under this transformation. Let \\(H\\) be the orthocentre of triangle \\(A B C\\) and let \\(K, L\\) be the feet of the perpendicular from \\(A, B\\) to \\(B C, C A\\) respectively. Denote \\(A=\\angle B A C, B=\\angle C B A\\) and \\(C=\\angle A C B\\).\n\nWe have\n\\[\n\\angle D^{*} A K=\\angle O A D=90^{\\circ}-\\angle D B A=90^{\\circ}-\\left(90^{\\circ}-A\\right)=A .\n\\]\n\nHence, using right-angled \\(\\triangle A K D^{*}\\)\n\\[\n\\left\\{\\begin{array}{l}\nD^{*} K=A K \\tan A=2 R \\sin B \\sin C \\tan A \\\\\nH K=2 R \\cos B \\cos C\n\\end{array} \\Longrightarrow \\frac{D^{*} K}{H K}=\\tan A \\tan B \\tan C\\right.\n\\]\n\nWe also have\n\\[\n\\angle A X^{*} B=\\angle A C X=\\angle A C O=90^{\\circ}-B .\n\\]\n\nHence, using right-angled \\(\\triangle B L X^{*}\\)\n\\[\n\\left\\{\\begin{array}{l}\nX^{*} L=B L \\tan B=2 R \\sin A \\sin C \\tan B \\\\\nH L=2 R \\cos A \\cos C\n\\end{array} \\quad \\Longrightarrow \\frac{X^{*} L}{H L}=\\tan A \\tan B \\tan C .\\right.\n\\]\n\nThus \\(\\frac{D^{*} K}{H K}=\\frac{X^{*} L}{H L}\\) and as \\(\\angle H L X^{*}=\\angle H K D^{*}=90^{\\circ}\\), this means that triangle \\(D^{*} H K\\) and \\(X^{*} H L\\) are similar and in particular\n\\[\n\\angle C D^{*} H=\\angle K D^{*} H=\\angle L X^{*} H=\\angle C X^{*} H\n\\]\nso \\(D^{*} H C X^{*}\\) is cyclic.\nInverting back, this gives \\(D H^{*} B X\\) cyclic so \\(H^{*}\\) lies on circle \\(\\odot B X D\\). Similarly, \\(H^{*}\\) lies on circle \\(\\odot C Y E\\).\n\nSince \\(A O\\) and \\(A H\\) are isogonal in \\(\\angle B A C, H^{*}\\) lies on line \\(A O\\) completing the proof.\nSolution 4 (Inversion at \\(O\\) ). Let \\(F\\) be the point on \\(\\omega\\) such that \\(A F\\) is a diameter of \\(\\omega\\), and \\(J\\) be the intersection of \\(D F\\) with \\(C O\\).\n\nConsider the inversion with respect to \\(\\omega\\) and use \\(P^{\\prime}\\) to denote the image of a point \\(P\\).\n![](https://cdn.mathpix.com/cropped/2025_08_23_2cb0be1b73ef2aa9a4e9g-72.jpg?height=998&width=1060&top_left_y=1073&top_left_x=505)\n\\(X^{\\prime}\\) lies on line \\(C O\\) and we have\n\\[\n\\angle B X^{\\prime} J=\\angle B X^{\\prime} O=\\angle O B X=\\angle O B A=\\angle B A O=\\angle B A F=\\angle B D F=\\angle B D J\n\\]\nso \\(B X^{\\prime} D J\\) is cyclic.\nLet \\(K\\) be the intersection of \\(A F\\) with \\(B C\\). Then we have \\(O B=O D\\) and\n\\[\n\\begin{aligned}\n& \\angle K B O=90^{\\circ}-A=\\angle D B A=\\angle D F A=\\angle D F O=\\angle O D J \\\\\n& \\angle B O K=2 \\angle O B A=2 \\angle C B D=\\angle C O D=\\angle J O D\n\\end{aligned}\n\\]\n\nHence triangle \\(B O K\\) and \\(D O J\\) are congruent. In particular \\(B K=D J\\) and\n\\[\n\\angle K B D=\\angle K B O+\\angle O B D=\\angle O D J+\\angle B D O=\\angle B D J .\n\\]\n\nThus \\(B D J K\\) is an isosceles trapezoid and \\(B X^{\\prime} D J K\\) is cyclic.\nInverting back this gives that \\(B X D K^{\\prime}\\) is cyclic. Similarly \\(C Y E K^{\\prime}\\) is cyclic. Since \\(K\\) lies on \\(A O, K^{\\prime}\\) also lies on \\(A O\\) completing the proof.", "source_pdf": "imosl_2023.pdf", "notes": "fallback-regex"}
{"id": "IMOSL-2023-G6", "contest": "IMOSL", "year": "2023", "problem_number": "G6", "problem": "Let \\(A B C\\) be an acute-angled triangle with circumcircle \\(\\omega\\). A circle \\(\\Gamma\\) is internally tangent to \\(\\omega\\) at \\(A\\) and also tangent to \\(B C\\) at \\(D\\). Let \\(A B\\) and \\(A C\\) intersect \\(\\Gamma\\) at \\(P\\) and \\(Q\\) respectively. Let \\(M\\) and \\(N\\) be points on line \\(B C\\) such that \\(B\\) is the midpoint of \\(D M\\) and \\(C\\) is the midpoint of \\(D N\\). Lines \\(M P\\) and \\(N Q\\) meet at \\(K\\) and intersect \\(\\Gamma\\) again at \\(I\\) and \\(J\\) respectively. The ray \\(K A\\) meets the circumcircle of triangle \\(I J K\\) at \\(X \\neq K\\).\n\nProve that \\(\\angle B X P=\\angle C X Q\\).\n(United Kingdom)\n\n\\section*{", "solution": "1 (Similar Triangles).}\n![](https://cdn.mathpix.com/cropped/2025_08_23_2cb0be1b73ef2aa9a4e9g-73.jpg?height=1123&width=1349&top_left_y=762&top_left_x=351)\n\nLet \\(M P\\) and \\(N Q\\) intersect \\(A D\\) at \\(K_{1}\\) and \\(K_{2}\\) respectively. By applying Menelaus' theorem to triangle \\(A B D\\) and line \\(M P K_{1}\\), we have\n\\[\n\\frac{A K_{1}}{K_{1} D}=\\frac{A P}{P B} \\cdot \\frac{B M}{M D}=\\frac{A P}{2 P B}\n\\]\nand similarly \\(\\frac{A K_{2}}{K_{2} D}=\\frac{A Q}{2 Q C}\\). A homothety at \\(A\\) takes \\(\\Gamma \\rightarrow \\omega\\) and \\(D\\) to the midpoint of arc \\(B C\\) not containing \\(A\\), so \\(P Q \\| B C\\) and \\(A D\\) bisects \\(\\angle B A C\\). Thus\n\\[\n\\frac{A K_{1}}{K_{1} D}=\\frac{A P}{2 P B}=\\frac{A Q}{2 Q C}=\\frac{A K_{2}}{K_{2} D}\n\\]\nwhich implies \\(K_{1} \\equiv K_{2}\\), and \\(K\\) lies on \\(A D\\).\nThen we obtain\n\\[\n\\angle J X D=\\angle J X K=\\angle J I K=\\angle J I P=\\angle J Q P=\\angle J N D\n\\]\nwhere the last equality follows from \\(P Q \\| B C\\). This shows \\(J X N D\\) is cyclic and hence\n\\[\n\\angle D X N=\\angle D J N=\\angle D J Q=\\angle D A Q=\\angle D A C\n\\]\nwhich shows \\(A C \\| X N\\). As \\(C\\) is the midpoint of \\(D N, A\\) is the midpoint of \\(X D\\).\nNow observe that \\(\\angle A D P=\\angle A Q P=\\angle A C B\\) and \\(\\angle P A D=\\angle D A C=\\frac{\\angle A}{2}\\) so triangle \\(A P D\\) and \\(A D C\\) are similar. Therefore we have\n\\[\n\\frac{C D}{D P}=\\frac{A D}{A P}=\\frac{X A}{A P}\n\\]\nand also have\n\\[\n\\angle C D P=180^{\\circ}-\\angle P D B=180^{\\circ}-\\angle P A D=\\angle X A P .\n\\]\n\nCombining the two results gives triangles \\(P D C\\) and \\(P A X\\) are similar, which shows \\(P\\) is the centre of spiral similarity taking \\(C D \\rightarrow X A\\). Hence also triangles \\(P X C\\) and \\(P A D\\) are similar which shows \\(\\angle P X C=\\angle P A D=\\frac{\\angle A}{2}\\). This gives\n\\[\n\\angle B X P=\\angle B X C-\\angle P X C=\\angle B X C-\\frac{\\angle A}{2}\n\\]\nwhich is symmetric in \\(B, C\\) giving the result.\nSolution 2 (Inversion). As in the first solution we show that \\(K\\) lies on \\(A D\\). From \\(C\\) being the midpoint of \\(D N\\) and \\(B C \\| P Q\\) we get\n\\[\n-1=\\left(C, \\infty_{B C} ; N, D\\right) \\stackrel{\\underline{Q}}{=}(A, P Q \\cap A D ; K, D) \\stackrel{\\underline{Q}}{=}(A, P ; J, D) .\n\\]\n\nSimilarly we get \\((A, Q ; I, D)=-1\\).\n![](https://cdn.mathpix.com/cropped/2025_08_23_2cb0be1b73ef2aa9a4e9g-74.jpg?height=920&width=980&top_left_y=1396&top_left_x=542)\n\nNow invert about \\(D\\) with radius \\(D P=D Q\\) denoting the inverse of a point \\(Z\\) by \\(Z^{*}\\). Since \\(\\odot A P Q\\) and line \\(P Q\\) swap we have \\(A^{*}=P Q \\cap A D\\). Thus we have:\n\\[\n-1=\\left(A, A^{*} ; K, D\\right)=(A, P ; J, D)=(A, Q ; I, D)\n\\]\n\nAs inversion preserves cross ratio and \\(D\\) inverts to the point at infinity, it follows \\(I^{*}, J^{*}, K^{*}\\) are the midpoints of \\(A^{*} Q, A^{*} P, A^{*} A\\) respectively. We know \\(X I K J\\) cyclic so \\(X\\) is the second intersection of circle ( \\(I^{*} J^{*} K^{*}\\) ) with \\(A D\\). Homothety of factor 2 at \\(A^{*}\\) takes circle ( \\(I^{*} J^{*} K^{*}\\) ) to circle \\(\\odot A P Q \\equiv \\Gamma\\) hence in fact \\(X^{*}\\) is the midpoint of \\(A^{*} D\\).\n\nThen we have\n\\[\n\\angle P D B=\\angle B A D=\\angle D A C=\\angle D C^{*} A^{*}\n\\]\nso \\(D P \\| C^{*} A^{*}\\). Also \\(A^{*}\\) lies on \\(P Q\\) so as \\(P Q \\| B C\\) we get \\(A^{*} P \\| D C^{*}\\), which gives \\(P A^{*} C^{*} D\\) is a parallelogram. Similarly \\(Q A^{*} B^{*} D\\) is also a parallelogram. As \\(X^{*}\\) is the midpoint of \\(A^{*} D\\) this shows that \\(X^{*}\\) lies on lines \\(B^{*} Q\\) and \\(C^{*} P\\).\n\nBy applying standard properties of angles under inversion, we have\n\\[\n\\begin{aligned}\n\\angle B X P-\\angle C X Q & =(\\angle B X D-\\angle P X D)-(\\angle D X C-\\angle D X Q) \\\\\n& =\\left(\\angle D B^{*} X^{*}-\\angle D P X^{*}\\right)-\\left(\\angle X^{*} C^{*} D-\\angle X^{*} Q D\\right) \\\\\n& =\\left(\\angle D B^{*} X^{*}+\\angle X^{*} P Q\\right)-\\left(\\angle X^{*} C^{*} D+\\angle P Q X^{*}\\right) \\\\\n& =\\underbrace{\\left(\\angle D B^{*} Q-\\angle P Q B^{*}\\right)}_{=0}-\\underbrace{\\left(\\angle P C^{*} D-\\angle C^{*} P Q\\right)}_{=0} \\\\\n& =0\n\\end{aligned} \\quad(\\text { as } P Q \\| B C)\n\\]\nwhich gives the result.", "source_pdf": "imosl_2023.pdf", "notes": "fallback-regex"}
{"id": "IMOSL-2023-G7", "contest": "IMOSL", "year": "2023", "problem_number": "G7", "problem": "Let \\(A B C\\) be an acute, scalene triangle with orthocentre \\(H\\). Let \\(\\ell_{a}\\) be the line through the reflection of \\(B\\) with respect to \\(C H\\) and the reflection of \\(C\\) with respect to \\(B H\\). Lines \\(\\ell_{b}\\) and \\(\\ell_{c}\\) are defined similarly. Suppose lines \\(\\ell_{a}, \\ell_{b}\\), and \\(\\ell_{c}\\) determine a triangle \\(\\mathcal{T}\\).\n\nProve that the orthocentre of \\(\\mathcal{T}\\), the circumcentre of \\(\\mathcal{T}\\) and \\(H\\) are collinear.\n(Ukraine)\n\n\\section*{", "solution": "1.}\n![](https://cdn.mathpix.com/cropped/2025_08_23_2cb0be1b73ef2aa9a4e9g-76.jpg?height=1329&width=1328&top_left_y=756&top_left_x=391)\n\nWe write \\(\\triangle P_{1} P_{2} P_{3} \\stackrel{+}{\\sim} \\triangle Q_{1} Q_{2} Q_{3}\\) (resp. \\(\\triangle P_{1} P_{2} P_{3} \\approx \\triangle Q_{1} Q_{2} Q_{3}\\) ) to indicate that two triangles are directly (resp. oppositely) similar. We use directed angles throughout denoted with \\(\\npreceq\\).\n\nDenote by \\(A_{b}, A_{c}\\) the reflections of \\(A\\) in \\(B H\\) and \\(C H\\) respectively. \\(B_{c}, B_{a}\\) and \\(C_{a}, C_{b}\\) are defined similarly. By definition, \\(\\ell_{a}=B_{c} C_{b}, \\ell_{b}=C_{a} A_{c}, \\ell_{c}=A_{b} B_{a}\\). Let \\(A_{1}=\\ell_{b} \\cap \\ell_{c}\\), \\(B_{1}=\\ell_{c} \\cap \\ell_{a}, C_{1}=\\ell_{a} \\cap \\ell_{b}\\) and let \\(O_{1}, H_{1}\\) be the orthocentre and circumcentre of \\(\\mathcal{T} \\equiv \\triangle A_{1} B_{1} C_{1}\\) respectively.\n\nClaim 1. \\(\\triangle A A_{b} A_{c} \\sim \\triangle A B C\\).\nProof. Let \\(P=B H \\cap A C, Q=C H \\cap A B\\), then it is well known that \\(\\triangle A P Q \\sim \\triangle A B C\\). By the dilation with factor 2 centred at \\(A, \\triangle A P Q\\) is sent to \\(\\triangle A A_{b} A_{c}\\), so we have \\(\\triangle A A_{b} A_{c} \\sim \\triangle A B C\\).\n\nClaim 2. \\(\\triangle A A_{b} A_{c} \\stackrel{+}{\\sim} \\triangle A B_{a} C_{a}\\) and \\(A_{1}\\) lies on the circumcircle of \\(\\triangle A A_{b} A_{c}\\) which is centred at \\(H\\).\nProof. Since \\(B_{a}, C_{a}\\) are reflections of \\(B, C\\) in \\(A H\\), we have \\(\\triangle A B_{a} C_{a} \\approx \\triangle A B C\\). Combining this with Claim 1, we have \\(\\triangle A A_{b} A_{c} \\stackrel{+}{\\sim} \\triangle A B_{a} C_{a}\\), where \\(A\\) is the centre of this similarity. Therefore, \\(\\Varangle A_{c} A_{1} A_{b}=\\measuredangle A_{c} A A_{b}\\) meaning \\(A_{1}\\) lies on \\(\\odot A A_{b} A_{c}\\). By symmetry, \\(H A_{b}=H A=H A_{c}\\), so \\(H\\) is centre of this circle.\n\nClaim 3. \\(\\triangle A_{1} B_{1} C_{1} \\approx \\triangle A B C\\).\nProof. From Claim 2 we have\n\\[\n\\npreceq C_{1} A_{1} B_{1}=\\Varangle A_{c} A_{1} A_{b} \\stackrel{\\text { Claim }^{2}}{=}{ }^{2} \\npreceq A_{c} A A_{b}=-\\npreceq C A B\n\\]\nand similarly \\(\\Varangle A_{1} B_{1} C_{1}=-\\Varangle A B C, \\npreceq B_{1} C_{1} A_{1}=-\\npreceq B C A\\), which imply \\(\\triangle A_{1} B_{1} C_{1} \\approx \\triangle A B C\\).\n\nDenote the ratio of similitude of \\(\\triangle A_{1} B_{1} C_{1}\\) and \\(\\triangle A B C\\) by \\(\\lambda\\left(=\\frac{B_{1} C_{1}}{B C}\\right)\\), then\n\\[\n\\lambda=\\frac{H_{1} A_{1}}{H A}=\\frac{H_{1} B_{1}}{H B}=\\frac{H_{1} C_{1}}{H C}\n\\]\n\nSince \\(H A=H A_{1}\\) and similarly \\(H B=H B_{1}, H C=H C_{1}\\) from Claim 2, we get\n\\[\n\\lambda=\\frac{H_{1} A_{1}}{H A_{1}}=\\frac{H_{1} B_{1}}{H B_{1}}=\\frac{H_{1} C_{1}}{H C_{1}}\n\\]\n\nTherefore, the circle \\(A_{1} B_{1} C_{1}\\) is the Apollonian circle of the segment \\(H H_{1}\\) with ratio \\(\\lambda\\) so the line \\(H H_{1}\\) passes through \\(O_{1}\\).\n\nSolution 2. We use the same notation \\(A_{b}, A_{c}, B_{c}, B_{a}, C_{a}, C_{b}\\) and \\(A_{1}, B_{1}, C_{1}, O_{1}, H_{1}\\) as in Solution 1, and also show Claim 1, Claim 2 and Claim 3 in the same way.\n\nLet \\(O\\) be the circumcentre of \\(\\triangle A B C\\) and \\(A_{2}\\) be the reflection of \\(A_{1}\\) in \\(A H\\). As \\(\\odot A A_{b} A_{c}\\) is centred at \\(H, A_{2}\\) also lies on this circle.\n\nBy Claim 2, \\(\\Varangle B_{a} A_{1} C_{a}=\\Varangle A_{b} A A_{c}=\\Varangle B_{a} A C_{a}\\), so \\(A_{1}\\) lies on \\(\\odot A B_{a} C_{a}\\). Reflecting this in \\(A H\\) gives that \\(A_{2}\\) lies on \\(\\odot A B C\\). We now have circles centred at \\(O\\) and \\(H\\) passing through \\(A\\) and \\(A_{2}\\) so these points are symmetric with respect to \\(O H\\). Define \\(B_{2}\\) and \\(C_{2}\\) similarly then \\(\\triangle A B C\\) and \\(\\triangle A_{2} B_{2} C_{2}\\) are symmetric with respect to \\(O H\\) and also \\(\\odot A B C=\\odot A_{2} B_{2} C_{2}\\).\n![](https://cdn.mathpix.com/cropped/2025_08_23_2cb0be1b73ef2aa9a4e9g-78.jpg?height=1508&width=1469&top_left_y=725&top_left_x=299)\n\nClaim 4. \\(A_{1} A_{2}, B_{1} B_{2}\\) and \\(C_{1} C_{2}\\) have an intersection on \\(\\odot A B C\\) which we denote by \\(T\\).\nProof. Let \\(T=A_{1} A_{2} \\cap B_{1} B_{2}\\). Since \\(A_{1} A_{2} \\| B C\\) and \\(B_{1} B_{2} \\| A C\\), we have\n\\[\n\\Varangle A_{2} T B_{2}=\\Varangle B C A=-\\npreceq B_{2} C_{2} A_{2}=\\Varangle A_{2} C_{2} B_{2} .\n\\]\n\nSo \\(T\\) lies on \\(\\odot A_{2} B_{2} C_{2}=\\odot A B C\\). Similarly the intersection of \\(A_{1} A_{2}\\) and \\(C_{1} C_{2}\\) lies on \\(\\odot A B C\\), so \\(C_{1} C_{2}\\) also passes through \\(T\\).\n\nClaim 5. \\(T\\) also lies on \\(\\odot A_{1} B_{1} C_{1}\\) and \\(T\\) corresponds to \\(T\\) itself under the similarity \\(\\triangle A_{1} B_{1} C_{1}= \\triangle A B C\\).\n\nProof. We know \\(\\triangle A_{1} B_{1} C_{1} \\approx \\triangle A B C\\) by Claim 3. We also have\n\\[\n\\npreceq B_{1} T C_{1}=\\Varangle B_{2} T C_{2}=\\Varangle B_{2} A_{2} C_{2}=-\\npreceq B A C \\stackrel{\\text { Claim }}{=}{ }^{3} \\npreceq B_{1} A_{1} C_{1},\n\\]\nso \\(T\\) lies on \\(\\odot A_{1} B_{1} C_{1}\\). The remaining part is concluded by the following angle chase:\n\\[\n\\not A_{1} B_{1} T=\\Varangle A_{1} B_{1} B_{2} \\stackrel{B_{1} B_{2} \\| A C}{=} \\nsubseteq A_{1} A_{b} A=\\Varangle A_{1} A_{2} A=-\\not A_{2} T=-\\not \\mathrm{A} B T \\text {. }\n\\]\n\nClaim 6. The circumradius of \\(\\triangle A_{1} B_{1} C_{1}\\) is equal to \\(H O\\).\nProof. Two circles centred at \\(H\\) intersect \\(\\ell_{c}\\) at \\(A_{1}, A_{b}\\) and \\(B_{1}, B_{a}\\), so \\(A_{1} A_{b}\\) and \\(B_{1} B_{a}\\) have the same midpoint and thus \\(A_{1} B_{1}=A_{b} B_{a}\\). Consider the spiral symmetry \\(\\triangle A A_{b} A_{c} \\stackrel{+}{\\sim} \\triangle A B_{a} C_{a}\\). This takes \\(H\\), the circumcentre of \\(\\triangle A A_{b} A_{c}\\), to the circumcentre of \\(\\triangle A B_{a} C_{a}\\), denoted by \\(O_{a}\\), which is symmetric to \\(O\\) in \\(A H\\). Hence \\(\\triangle A A_{b} B_{a} \\stackrel{+}{\\sim} \\triangle A H O_{a}\\), so\n\\[\n\\frac{A A_{b}}{B_{a} A_{b}}=\\frac{A H}{H O_{a}}=\\frac{A H}{H O} \\Longrightarrow \\frac{A H}{A A_{b}}=\\frac{H O}{A_{b} B_{a}}\n\\]\n\nAlso since \\(\\triangle A_{1} O_{1} B_{1} \\stackrel{+}{\\sim} \\triangle A H A_{b}\\) (both of them are \\(=\\triangle A O B\\) ), we have\n\\[\n\\frac{A_{1} O_{1}}{A_{1} B_{1}}=\\frac{A H}{A A_{b}}=\\frac{H O}{A_{b} B_{a}}=\\frac{H O}{A_{1} B_{1}} \\Longrightarrow A_{1} O_{1}=H O\n\\]\nas desired.\nSince\n\\[\n\\Varangle\\left(T A_{1}, T O_{1}\\right) \\stackrel{C l a i m}{=} 5 \\npreceq(T O, T A)=90^{\\circ}+\\npreceq\\left(T A_{1}, A A_{2}\\right) \\stackrel{O H \\perp A A_{2}}{=} \\npreceq\\left(T A_{1}, O H\\right),\n\\]\nwe have \\(O_{1} T \\| H O\\). Combined with \\(O_{1} T=H O, O_{1} T O H\\) is a parallelogram. Therefore, using this and Claim 5, we have \\(\\Varangle H_{1} O_{1} T=\\Varangle T O H=\\Varangle H O_{1} T\\), which imply that \\(O_{1}, H_{1}\\) and \\(H\\) are collinear as desired.", "source_pdf": "imosl_2023.pdf", "notes": "fallback-regex"}
{"id": "IMOSL-2023-N2", "contest": "IMOSL", "year": "2023", "problem_number": "N2", "problem": "Determine all pairs \\((a, p)\\) of positive integers with \\(p\\) prime such that \\(p^{a}+a^{4}\\) is a perfect square.\n(Bangladesh)", "solution": "Answer: \\((a, p)=(1,3),(2,3),(6,3),(9,3)\\) are all the possible solutions.\n\n. Let \\(p^{a}+a^{4}=b^{2}\\) for some positive integer \\(b\\). Then we have\n\\[\np^{a}=b^{2}-a^{4}=\\left(b+a^{2}\\right)\\left(b-a^{2}\\right) .\n\\]\n\nHence both \\(b+a^{2}\\) and \\(b-a^{2}\\) are powers of \\(p\\).\nLet \\(b-a^{2}=p^{x}\\) for some integer \\(x\\). Then \\(b+a^{2}=p^{a-x}\\) and \\(a-x>x\\). Therefore, we have\n\\[\n2 a^{2}=\\left(b+a^{2}\\right)-\\left(b-a^{2}\\right)=p^{a-x}-p^{x}=p^{x}\\left(p^{a-2 x}-1\\right)\n\\]\n\nWe shall consider two cases according to whether \\(p=2\\) or \\(p \\neq 2\\). We let \\(v_{p}(m)\\) denote the \\(p\\)-adic valuation of \\(m\\).\n\nCase \\(1(p=2)\\) : In this case,\n\\[\na^{2}=2^{x-1}\\left(2^{a-2 x}-1\\right)=2^{2 v_{2}(a)}\\left(2^{a-2 x}-1\\right)\n\\]\nwhere the first equality comes from (1) and the second one from \\(\\operatorname{gcd}\\left(2,2^{a-2 x}-1\\right)=1\\). So, \\(2^{a-2 x}-1\\) is a square.\n\nIf \\(v_{2}(a)>0\\), then \\(2^{a-2 x}\\) is also a square. So, \\(2^{a-2 x}-1=0\\), and \\(a=0\\) which is a contradiction.\nIf \\(v_{2}(a)=0\\), then \\(x=1\\), and \\(a^{2}=2^{a-2}-1\\). If \\(a \\geqslant 4\\), the right hand side is congruent to 3 modulo 4 , thus cannot be a square. It is easy to see that \\(a=1,2,3\\) do not satisfy this condition.\n\nTherefore, we do not get any solutions in this case.\nCase \\(2(p \\neq 2)\\) : In this case, we have \\(2 v_{p}(a)=x\\). Let \\(m=v_{p}(a)\\). Then we have \\(a^{2}=p^{2 m} \\cdot n^{2}\\) for some integer \\(n \\geqslant 1\\). So, \\(2 n^{2}=p^{a-2 x}-1=p^{p^{m} \\cdot n-4 m}-1\\).\n\nWe consider two subcases.\nSubcase 2-1 ( \\(p \\geqslant 5\\) ): By induction, one can easily prove that \\(p^{m} \\geqslant 5^{m}>4 m\\) for all \\(m\\). Then we have\n\\[\n2 n^{2}+1=p^{p^{m} \\cdot n-4 m}>p^{p^{m} \\cdot n-p^{m}} \\geqslant 5^{5^{m} \\cdot(n-1)} \\geqslant 5^{n-1}\n\\]\n\nBut, by induction, one can easily prove that \\(5^{n-1}>2 n^{2}+1\\) for all \\(n \\geqslant 3\\). Therefore, we conclude that \\(n=1\\) or 2 . If \\(n=1\\) or 2 , then \\(p=3\\), which is a contradiction. So there are no solutions in this subcase.\n\nSubcase 2-2 \\((p=3)\\) : Then we have \\(2 n^{2}+1=3^{3^{m} \\cdot n-4 m}\\). If \\(m \\geqslant 2\\), one can easily prove by induction that \\(3^{m}>4 m\\). Then we have\n\\[\n2 n^{2}+1=3^{3^{m} \\cdot n-4 m}>3^{3^{m} \\cdot n-3^{m}}=3^{3^{m} \\cdot(n-1)} \\geqslant 3^{9(n-1)}\n\\]\n\nAgain, by induction, one can easily prove that \\(3^{9(n-1)}>2 n^{2}+1\\) for all \\(n \\geqslant 2\\). Therefore, we conclude that \\(n=1\\). Then we have \\(2 \\cdot 1^{2}+1=3^{3^{m}-4 m}\\) hence \\(3=3^{3^{m}-4 m}\\). Consequently, we have \\(3^{m}-4 m=1\\). The only solution of this equation is \\(m=2\\) in which case we have \\(a=3^{m} \\cdot n=3^{2} \\cdot 1=9\\).\n\nIf \\(m \\leqslant 1\\), then there are two possible cases: \\(m=0\\) or \\(m=1\\).\n- If \\(m=1\\), then we have \\(2 n^{2}+1=3^{3 n-4}\\). Again, by induction, one can easily prove that \\(3^{3 n-4}>2 n^{2}+1\\) for all \\(n \\geqslant 3\\). By checking \\(n=1,2\\), we only get \\(n=2\\) as a solution. This gives \\(a=3^{m} \\cdot n=3^{1} \\cdot 2=6\\).\n- If \\(m=0\\), then we have \\(2 n^{2}+1=3^{n}\\). By induction, one can easily prove that \\(3^{n}>2 n^{2}+1\\) for all \\(n \\geqslant 3\\). By checking \\(n=1,2\\), we find the solutions \\(a=3^{0} \\cdot 1=1\\) and \\(a=3^{0} \\cdot 2=2\\).\n\nTherefore, \\((a, p)=(1,3),(2,3),(6,3),(9,3)\\) are all the possible solutions.", "source_pdf": "imosl_2023.pdf", "notes": "fallback-regex"}
{"id": "IMOSL-2023-N3", "contest": "IMOSL", "year": "2023", "problem_number": "N3", "problem": "For positive integers \\(n\\) and \\(k \\geqslant 2\\) define \\(E_{k}(n)\\) as the greatest exponent \\(r\\) such that \\(k^{r}\\) divides \\(n!\\). Prove that there are infinitely many \\(n\\) such that \\(E_{10}(n)>E_{9}(n)\\) and infinitely many \\(m\\) such that \\(E_{10}(m)<E_{9}(m)\\).\n(Brazil)", "solution": "1. We let \\(v_{p}(m)\\) denote the \\(p\\)-adic valuation of \\(m\\). By Legendre's Formula we know, for \\(p\\) prime, that \\(v_{p}(n!)=\\lfloor n / p\\rfloor+\\left\\lfloor n / p^{2}\\right\\rfloor+\\cdots\\). We can see that \\(E_{9}(n)=\\left\\lfloor\\frac{v_{3}(n!)}{2}\\right\\rfloor\\). Since \\(v_{5}(n!) \\leqslant v_{2}(n!)\\) and \\(E_{10}(n)=\\min \\left(v_{5}(n!), v_{2}(n!)\\right)\\), we have \\(E_{10}(n)=v_{5}(n!)\\).\n\nLet \\(l\\) be a positive integer. Set \\(n=5^{2 l-1}\\). Then we have\n\\[\nE_{10}(n)=v_{5}(n!)=5^{2 l-2}+5^{2 l-3}+\\cdots+5+1=\\frac{5^{2 l-1}-1}{4}=\\frac{n-1}{4} .\n\\]\n\nSince \\(n=5^{2 l-1} \\equiv 2(\\bmod 3)\\), we have \\(\\left\\lfloor\\frac{n}{3}\\right\\rfloor=\\frac{n-2}{3}\\) and it implying\n\\[\nv_{3}(n!)=\\left\\lfloor\\frac{n}{3}\\right\\rfloor+\\left\\lfloor\\frac{n}{3^{2}}\\right\\rfloor+\\left\\lfloor\\frac{n}{3^{3}}\\right\\rfloor+\\cdots<\\frac{n-2}{3}+\\frac{n}{3^{2}}+\\frac{n}{3^{3}}+\\cdots=\\frac{n}{2}-\\frac{2}{3} .\n\\]\n\nFrom this we obtain\n\\[\nE_{9}(n)=\\left\\lfloor\\frac{v_{3}(n!)}{2}\\right\\rfloor \\leqslant \\frac{v_{3}(n!)}{2} \\leqslant \\frac{n}{4}-\\frac{1}{3}<\\frac{n}{4}-\\frac{1}{4}=E_{10}(n) .\n\\]\n\nIn a similar way, we set now \\(m=3^{4 l-2}\\). Then we have\n\\[\nv_{3}(m!)=3^{4 l-3}+3^{4 l-4}+\\cdots+3+1=\\frac{3^{4 l-2}-1}{2}=\\frac{m-1}{2} .\n\\]\n\nNote that \\(m=3^{4 l-2} \\equiv 1(\\bmod 4)\\) and hence \\(E_{9}(m)=\\left\\lfloor\\frac{v_{3}(m!)}{2}\\right\\rfloor=\\left\\lfloor\\frac{m-1}{4}\\right\\rfloor=\\frac{m-1}{4}\\). We also have \\(m=3^{4 l-2} \\equiv 4(\\bmod 5)\\) implying \\(\\left\\lfloor\\frac{m}{5}\\right\\rfloor=\\frac{m-4}{5}\\). Therefore we obtain\n\\[\nE_{10}(m)=v_{5}(m!)=\\left\\lfloor\\frac{m}{5}\\right\\rfloor+\\left\\lfloor\\frac{m}{5^{2}}\\right\\rfloor+\\cdots<\\frac{m-4}{5}+\\frac{m}{5^{2}}+\\cdots=\\frac{m}{4}-\\frac{4}{5}<\\frac{m}{4}-\\frac{1}{4}=E_{9}(m) .\n\\]\n\nWe can take infinitely many \\(n=5^{2 l-1}\\) and \\(m=3^{4 l-2}\\) completing the proof.\nSolution 2. In the setting of Solution 1, we consider two subsequences:\nFirst, we take \\(n=5^{3^{b-1}}\\) with \\(b \\geqslant 2\\). Because 5 is not a square modulo 3 and \\(\\varphi\\left(3^{b}\\right)=2 \\cdot 3^{b-1}\\), we have \\(n \\equiv-1\\left(\\bmod 3^{b}\\right)\\). Hence,\n\\[\nv_{3}(n!)=\\left\\lfloor\\frac{n}{3}\\right\\rfloor+\\left\\lfloor\\frac{n}{3^{2}}\\right\\rfloor+\\cdots<\\frac{n-2}{3}+\\frac{n-8}{9}+\\cdots+\\frac{n-\\left(3^{b}-1\\right)}{3^{b}}+\\frac{n}{3^{b+1}}+\\cdots<\\frac{n}{2}-b+\\frac{1}{2},\n\\]\nand \\(E_{10}(n)=\\frac{n-1}{4}>\\frac{n+1-2 b}{4}>E_{9}(n)\\).\nIn the same way, for \\(m=3^{2 \\cdot 5^{b-1}} \\equiv-1\\left(\\bmod 5^{b}\\right)\\) with \\(b \\geqslant 2\\),\n\\(E_{10}(m)=\\left\\lfloor\\frac{m}{5}\\right\\rfloor+\\left\\lfloor\\frac{m}{5^{2}}\\right\\rfloor+\\cdots<\\frac{m-4}{5}+\\frac{m-24}{25}+\\cdots+\\frac{m-\\left(5^{b}-1\\right)}{5^{b}}+\\frac{m}{5^{b+1}}+\\cdots<\\frac{m}{4}-b+\\frac{1}{4}\\), and \\(E_{9}(m)=\\frac{m-1}{4}>E_{10}(m)\\) holds.\n\nComment. From Solution 2 we can see that for any positive real \\(B\\), there exist infinitely many positive integers \\(m\\) and \\(n\\) such that \\(E_{10}(n)-E_{9}(n)>B\\) and \\(E_{10}(m)-E_{9}(m)<-B\\).", "source_pdf": "imosl_2023.pdf", "notes": "fallback-regex"}
{"id": "IMOSL-2023-N4", "contest": "IMOSL", "year": "2023", "problem_number": "N4", "problem": "Let \\(a_{1}, a_{2}, \\ldots, a_{n}, b_{1}, b_{2}, \\ldots, b_{n}\\) be \\(2 n\\) positive integers such that the \\(n+1\\) products\n\\[\n\\begin{gathered}\na_{1} a_{2} a_{3} \\cdots a_{n}, \\\\\nb_{1} a_{2} a_{3} \\cdots a_{n}, \\\\\nb_{1} b_{2} a_{3} \\cdots a_{n}, \\\\\n\\vdots \\\\\nb_{1} b_{2} b_{3} \\cdots b_{n}\n\\end{gathered}\n\\]\nform a strictly increasing arithmetic progression in that order. Determine the smallest positive integer that could be the common difference of such an arithmetic progression.\n(Canada)", "solution": "Answer: The smallest common difference is \\(n!\\).\n\n1. The condition in the problem is equivalent to\n\\[\nD=\\left(b_{1}-a_{1}\\right) a_{2} a_{3} \\cdots a_{n}=b_{1}\\left(b_{2}-a_{2}\\right) a_{3} a_{4} \\cdots a_{n}=\\cdots=b_{1} b_{2} \\cdots b_{n-1}\\left(b_{n}-a_{n}\\right),\n\\]\nwhere \\(D\\) is the common difference. Since the progression is strictly increasing, \\(D>0\\), hence \\(b_{i}>a_{i}\\) for every \\(1 \\leqslant i \\leqslant n\\). Individually, these equalities simplify to\n\\[\n\\left(b_{i}-a_{i}\\right) a_{i+1}=b_{i}\\left(b_{i+1}-a_{i+1}\\right) \\text { for every } 1 \\leqslant i \\leqslant n-1 .\n\\]\n\nIf \\(g_{i}:=\\operatorname{gcd}\\left(a_{i}, b_{i}\\right)>1\\) for some \\(1 \\leqslant i \\leqslant n\\), then we can replace \\(a_{i}\\) with \\(\\frac{a_{i}}{g_{i}}\\) and \\(b_{i}\\) with \\(\\frac{b_{i}}{g_{i}}\\) to get a smaller common difference. Hence we may assume \\(\\operatorname{gcd}\\left(a_{i}, b_{i}\\right)=1\\) for every \\(1 \\leqslant i \\leqslant n\\).\n\nThen, we have \\(\\operatorname{gcd}\\left(b_{i}-a_{i}, b_{i}\\right)=\\operatorname{gcd}\\left(a_{i}, b_{i}\\right)=1\\) and \\(\\operatorname{gcd}\\left(a_{i+1}, b_{i+1}-a_{i+1}\\right)=\\operatorname{gcd}\\left(a_{i+1}, b_{i+1}\\right)=1\\) for every \\(1 \\leqslant i \\leqslant n-1\\). The equality (1) implies \\(a_{i+1}=b_{i}\\) and \\(b_{i}-a_{i}=b_{i+1}-a_{i+1}\\). Thus,\n\\[\na_{1}, \\quad b_{1}=a_{2}, \\quad b_{2}=a_{3}, \\quad \\ldots, \\quad b_{n-1}=a_{n}, \\quad b_{n}\n\\]\nis an arithmetic progression with positive common difference. Since \\(a_{1} \\geqslant 1\\), we have \\(a_{i} \\geqslant i\\) for every \\(1 \\leqslant i \\leqslant n\\), so\n\\[\nD=\\left(b_{1}-a_{1}\\right) a_{2} a_{3} \\cdots a_{n} \\geqslant 1 \\cdot 2 \\cdot 3 \\cdots n=n!\n\\]\n\nEquality is achieved when \\(b_{i}-a_{i}=1\\) for \\(1 \\leqslant i \\leqslant n\\) and \\(a_{1}=1\\), i.e. \\(a_{i}=i\\) and \\(b_{i}=i+1\\) for every \\(1 \\leqslant i \\leqslant n\\). Indeed, it is straightforward to check that these integers produce an arithmetic progression with common difference \\(n!\\).\n\nSolution 2 (Variant of Solution 1). Similarly to Solution 1, we may assume \\(\\operatorname{gcd}\\left(a_{i}, b_{i}\\right)=1\\) for every \\(1 \\leqslant i \\leqslant n\\).\n\nDenote by \\(p_{1}, p_{2}, \\ldots, p_{n+1}\\) the sequence obtained as the product in the problem statement. Then we have \\(\\frac{p_{i+1}}{p_{i}}=\\frac{b_{i}}{a_{i}}>1\\), so \\(b_{i}>a_{i}\\). Since \\(p_{1}, p_{2}, \\ldots, p_{n+1}\\) is an arithmetic progression, we have \\(p_{i+2}=2 p_{i+1}-p_{i}\\) hence\n\\[\n2-\\frac{a_{i}}{b_{i}}=\\frac{2 b_{i}-a_{i}}{b_{i}}=\\frac{2 p_{i+1}-p_{i}}{p_{i+1}}=\\frac{p_{i+2}}{p_{i+1}}=\\frac{b_{i+1}}{a_{i+1}} .\n\\]\n\nBut since the fractions on the left-hand side and the right-hand side are both irreducible, we conclude that \\(b_{i}=a_{i+1}\\), so \\(2-\\frac{a_{i}}{a_{i+1}}=\\frac{a_{i+2}}{a_{i+1}}\\). Then we have \\(a_{i}+a_{i+2}=2 a_{i+1}\\), which means that \\(a_{1}, a_{2}, \\ldots, a_{n}\\) is an arithmetic progression with positive common difference.\n\nWe conclude as in Solution 1.\n\nSolution 3. (The following solution is purely algebraic: it does not involve considerations on greatest common divisors.)\n\nWe retake Solution 1 from (1). Then we have\n\\[\n\\frac{a_{i+1}}{b_{i+1}-a_{i+1}}=\\frac{b_{i}}{b_{i}-a_{i}}=1+\\frac{a_{i}}{b_{i}-a_{i}} .\n\\]\n\nSo, for \\(1 \\leqslant i \\leqslant n\\),\n\\[\n\\frac{a_{i}}{b_{i}-a_{i}}=\\frac{a_{1}}{b_{1}-a_{1}}+(i-1)\n\\]\n\nThen\n\\[\na_{i} \\geqslant \\frac{a_{i}}{b_{i}-a_{i}}=\\frac{a_{1}}{b_{1}-a_{1}}+(i-1)>i-1\n\\]\nsince \\(b_{i}-a_{i} \\geqslant 1\\) and \\(b_{1}-a_{1}>0\\). As \\(a_{i}\\) is an integer, we have \\(a_{i} \\geqslant i\\).\nWe again conclude as in Solution 1.", "source_pdf": "imosl_2023.pdf", "notes": "fallback-regex"}
{"id": "IMOSL-2023-N5", "contest": "IMOSL", "year": "2023", "problem_number": "N5", "problem": "Let \\(a_{1}<a_{2}<a_{3}<\\cdots\\) be positive integers such that \\(a_{k+1}\\) divides \\(2\\left(a_{1}+a_{2}+\\cdots+a_{k}\\right)\\) for every \\(k \\geqslant 1\\). Suppose that for infinitely many primes \\(p\\), there exists \\(k\\) such that \\(p\\) divides \\(a_{k}\\). Prove that for every positive integer \\(n\\), there exists \\(k\\) such that \\(n\\) divides \\(a_{k}\\).\n(Netherlands)", "solution": ". For every \\(k \\geqslant 2\\) define the quotient \\(b_{k}=2\\left(a_{1}+\\cdots+a_{k-1}\\right) / a_{k}\\), which must be a positive integer. We first prove the following properties of the sequence \\(\\left(b_{k}\\right)\\) :\nClaim 1. We have \\(b_{k+1} \\leqslant b_{k}+1\\) for all \\(k \\geqslant 2\\).\nProof. By subtracting \\(b_{k} a_{k}=2\\left(a_{1}+\\cdots+a_{k-1}\\right)\\) from \\(b_{k+1} a_{k+1}=2\\left(a_{1}+\\cdots+a_{k}\\right)\\), we find that \\(b_{k+1} a_{k+1}=b_{k} a_{k}+2 a_{k}=\\left(b_{k}+2\\right) a_{k}\\). From \\(a_{k}<a_{k+1}\\) it follows that \\(b_{k}+2>b_{k+1}\\).\nClaim 2. The sequence ( \\(b_{k}\\) ) is unbounded.\nProof. We start by rewriting \\(b_{k+1} a_{k+1}=\\left(b_{k}+2\\right) a_{k}\\) as\n\\[\n\\left.a_{k+1}=a_{k} \\cdot \\frac{b_{k}+2}{b_{k+1}} \\Longrightarrow a_{k+1} \\right\\rvert\\, a_{k}\\left(b_{k}+2\\right)\n\\]\n\nIf the sequence ( \\(b_{k}\\) ) were bounded, say by some positive integer \\(B\\), then the prime factors of the terms of the sequence ( \\(a_{k}\\) ) could only be primes less than or equal to \\(B+2\\) or those dividing \\(a_{1}\\) or \\(a_{2}\\), which contradicts the property in the statement of the problem.\n\nConsider now an arbitrary positive integer \\(n\\). We assume \\(n>b_{2}\\), otherwise we replace \\(n\\) by an arbitrary multiple of \\(n\\) that is bigger than \\(b_{2}\\). By Claim 2, there exists \\(k\\) such that \\(b_{k+1} \\geqslant n\\). Consider the smallest such \\(k\\). From Claim 1, it follows that we must have \\(b_{k}=n-1\\) and \\(b_{k+1}=n\\) (we assumed \\(n>b_{2}\\) to ensure that \\(k \\geqslant 2\\) ). We now find that\n\\[\na_{k+1}=a_{k} \\cdot \\frac{b_{k}+2}{b_{k+1}}=a_{k} \\cdot \\frac{n+1}{n} .\n\\]\n\nBecause \\(n\\) and \\(n+1\\) are coprime, this immediately implies that \\(a_{k}\\) is divisible by \\(n\\).\nComment. For \\(c\\) a positive integer, the sequence \\(a_{k}=c k\\) satisfies the conditions of the problem. Another example is\n\\[\na_{1}=1, \\quad a_{2}=2, \\quad a_{k}=3(k-1) \\text { for } k \\geqslant 3 .\n\\]", "source_pdf": "imosl_2023.pdf", "notes": "fallback-regex"}
{"id": "IMOSL-2023-N6", "contest": "IMOSL", "year": "2023", "problem_number": "N6", "problem": "A sequence of integers \\(a_{0}, a_{1}, a_{2}, \\ldots\\) is called kawaii, if \\(a_{0}=0, a_{1}=1\\), and, for any positive integer \\(n\\), we have\n\\[\n\\left(a_{n+1}-3 a_{n}+2 a_{n-1}\\right)\\left(a_{n+1}-4 a_{n}+3 a_{n-1}\\right)=0 .\n\\]\n\nAn integer is called kawaii if it belongs to a kawaii sequence.\nSuppose that two consecutive positive integers \\(m\\) and \\(m+1\\) are both kawaii (not necessarily belonging to the same kawaii sequence). Prove that 3 divides \\(m\\), and that \\(m / 3\\) is kawaii.\n(China)", "solution": "1. We start by rewriting the condition in the problem as:\n\\[\na_{n+1}=3 a_{n}-2 a_{n-1}, \\text { or } a_{n+1}=4 a_{n}-3 a_{n-1}\n\\]\n\nWe have \\(a_{n+1} \\equiv a_{n}\\) or \\(a_{n-1}(\\bmod 2)\\) and \\(a_{n+1} \\equiv a_{n-1}\\) or \\(a_{n}(\\bmod 3)\\) for all \\(n \\geqslant 1\\). Now, since \\(a_{0}=0\\) and \\(a_{1}=1\\), we have that \\(a_{n} \\equiv 0,1 \\bmod 3\\) for all \\(n \\geqslant 0\\). Since \\(m\\) and \\(m+1\\) are kawaii integers, then necessarily \\(m \\equiv 0 \\bmod 3\\).\n\nWe also observe that \\(a_{2}=3\\) or \\(a_{2}=4\\). Moreover,\n(1) If \\(a_{2}=3\\), then \\(a_{n} \\equiv 1(\\bmod 2)\\) for all \\(n \\geqslant 1\\) since \\(a_{1} \\equiv a_{2} \\equiv 1(\\bmod 2)\\).\n(2) If \\(a_{2}=4\\), then \\(a_{n} \\equiv 1(\\bmod 3)\\) for all \\(n \\geqslant 1\\) since \\(a_{1} \\equiv a_{2} \\equiv 1(\\bmod 3)\\).\n\nSince \\(m \\equiv 0(\\bmod 3)\\), any kawaii sequence containing \\(m\\) does not satisfy (2), so it must satisfy (1). Hence, \\(m\\) is odd and \\(m+1\\) is even.\n\nTake a kawaii sequence \\(\\left(a_{n}\\right)\\) containing \\(m+1\\). Let \\(t \\geqslant 2\\) be such that \\(a_{t}=m+1\\). As \\(\\left(a_{n}\\right)\\) does not satisfy ( 1 ), it must satisfy ( 2 ). Then \\(a_{n} \\equiv 1(\\bmod 3)\\) for all \\(n \\geqslant 1\\). We define the sequence \\(a_{n}^{\\prime}=\\left(a_{n+1}-1\\right) / 3\\). This is a kawaii sequence: \\(a_{0}^{\\prime}=0, a_{1}^{\\prime}=1\\) and for all \\(n \\geqslant 1\\), \\(\\left(a_{n+1}^{\\prime}-3 a_{n}^{\\prime}+2 a_{n-1}^{\\prime}\\right)\\left(a_{n+1}^{\\prime}-4 a_{n}^{\\prime}+3 a_{n-1}^{\\prime}\\right)=\\left(a_{n+2}-3 a_{n+1}+2 a_{n}\\right)\\left(a_{n+2}-4 a_{n+1}+3 a_{n}\\right) / 9=0\\).\n\nFinally, we notice that the term \\(a_{t-1}^{\\prime}=m / 3\\) which implies that \\(m / 3\\) is kawaii.\nSolution 2. We start by proving the following:\nClaim 1. We have \\(a_{n} \\equiv 0,1 \\bmod 3\\) for all \\(n \\geqslant 0\\).\nProof. We have \\(a_{n+1}=3 a_{n}-2 a_{n-1}=3\\left(a_{n}-a_{n-1}\\right)+a_{n-1}\\) or \\(a_{n+1}=4 a_{n}-3 a_{n-1}=3\\left(a_{n}-\\right. \\left.a_{n-1}\\right)+a_{n}\\), so \\(a_{n+1} \\equiv a_{n}\\) or \\(a_{n-1} \\bmod 3\\), and since \\(a_{0}=0\\) and \\(a_{1}=1\\) the result follows.\n\nHence if \\(m\\) and \\(m+1\\) are kawaii, then necessarily \\(m \\equiv 0 \\bmod 3\\).\nClaim 2. An integer \\(\\geqslant 2\\) is kawaii if and only if it can be written as \\(1+b_{2}+\\cdots+b_{n}\\) for some \\(n \\geqslant 2\\) with \\(b_{i}=2^{r_{i}} 3^{s_{i}}\\) satisfying \\(r_{i}+s_{i}=i-1\\) for \\(i=2, \\ldots, n\\) and \\(b_{i} \\mid b_{i+1}\\) for all \\(i=2, \\ldots, n-1\\).\nProof. For a kawaii sequence ( \\(a_{n}\\) ), we can write \\(a_{n+1}=3 a_{n}-2 a_{n-1}=a_{n}+2\\left(a_{n}-a_{n-1}\\right)\\) or \\(a_{n+1}=4 a_{n}-3 a_{n-1}=a_{n}+3\\left(a_{n}-a_{n-1}\\right)\\), so \\(a_{n+1}-a_{n}=2\\left(a_{n}-a_{n-1}\\right)\\) or \\(3\\left(a_{n}-a_{n-1}\\right)\\). Hence, \\(a_{n}=1+b_{2}+\\cdots+b_{n}\\) where \\(b_{2}=2\\) or 3 and \\(b_{i+1}=2 b_{i}\\) or \\(3 b_{i}\\).\n\nConversely, given a number that can be written in that way, we consider any sequence given by \\(a_{0}=0, a_{1}=1\\) and \\(a_{i}=1+b_{2}+\\cdots+b_{i}\\) for \\(2 \\leqslant i \\leqslant n\\) and \\(a_{i}\\) given by the kawaii condition for \\(i \\geqslant n+1\\). This defines a kawaii sequence containing the given number as \\(a_{n}\\).\n\nLet us suppose that \\(m\\) and \\(m+1\\) are kawaii, then they belong to some kawaii sequences and we can write them as in Claim 2 as \\(m=1+2+\\cdots+2^{\\ell}+2^{\\ell} \\cdot 3 \\cdot A\\) and \\(m+1=1+2+\\cdots+2^{\\ell^{\\prime}}+2^{\\ell^{\\prime}} \\cdot 3 \\cdot A^{\\prime}\\) where \\(\\ell\\) is odd and \\(\\ell^{\\prime}\\) is even because of modulo 3 reasons. Since \\(m+1 \\equiv m\\left(\\bmod 2^{\\min \\left(\\ell, \\ell^{\\prime}\\right)}\\right)\\), we have \\(\\min \\left(\\ell, \\ell^{\\prime}\\right)=0\\), so \\(\\ell^{\\prime}=0\\).\n\nThen \\(m+1=1+b_{2}+\\cdots+b_{j}\\) for some \\(b_{i}\\) 's as in Claim 2 with \\(b_{2}=3\\) and \\(b_{i} \\mid b_{i+1}\\) : so with \\(3 \\mid b_{i}\\) for all \\(i=2, \\ldots, j\\). Then \\(\\frac{m}{3}=1+b_{1}^{\\prime}+\\cdots+b_{j-1}^{\\prime}\\) with \\(b_{i}^{\\prime}=\\frac{b_{i+1}}{3}\\) as in Claim 2 and \\(\\frac{m}{3}\\) is a kawaii integer.\n\nSolution 3. (This solution is just a different combination of the ideas in Solutions 1 and 2) We first prove that, in a kawaii sequence \\(a_{0}, a_{1}, a_{2}, \\ldots\\), every term \\(a_{t}\\) with \\(t \\geqslant 0\\) is congruent to 0 or 1 modulo 3.\n\nFor \\(n \\geqslant 1\\), put \\(b_{n}=a_{n}-a_{n-1}\\). We have\n\\[\na_{t}=a_{0}+\\sum_{k=1}^{t}\\left(a_{k}-a_{k-1}\\right)=\\sum_{k=1}^{t} b_{k}\n\\]\n\nNote that\n\\[\na_{n+1}-3 a_{n}+2 a_{n-1}=b_{n+1}-2 b_{n} \\quad \\text { and } \\quad a_{n+1}-4 a_{n}+3 a_{n-1}=b_{n+1}-3 b_{n}\n\\]\n\nThe conditions on the \\(b_{i}\\) 's for defining a kawaii sequence are\n\\[\nb_{1}=a_{1}-a_{0}=1, \\quad \\text { and } \\quad \\frac{b_{n+1}}{b_{n}} \\in\\{2,3\\} \\quad \\text { for } \\quad n \\geqslant 1\n\\]\n1. If we have \\(\\frac{b_{n+1}}{b_{n}}=2\\) for any \\(n\\) with \\(1 \\leqslant n \\leqslant t-1\\), then (*) implies that\n\\[\na_{t}=\\sum_{k=1}^{t} 2^{k-1}=2^{t}-1 \\equiv 0,1(\\bmod 3)\n\\]\n2. If there exists some integer \\(s\\) with \\(2 \\leqslant s \\leqslant t-1\\) such that\n\\[\n\\frac{b_{2}}{b_{1}}=\\frac{b_{3}}{b_{2}}=\\cdots=\\frac{b_{s}}{b_{s-1}}=2, \\quad \\frac{b_{s+1}}{b_{s}}=3\n\\]\nit implies that \\(3 \\mid b_{n}\\) for any \\(n \\geqslant s+1\\). Similarly to the argument in (1), we obtain \\(a_{t} \\equiv \\sum_{k=1}^{s} b_{k} \\equiv 0,1(\\bmod 3)\\).\n3. If \\(\\frac{b_{2}}{b_{1}}=b_{2}=3\\), we have \\(3 \\mid b_{n}\\) for any \\(n \\geqslant 2\\), and hence \\(a_{t} \\equiv 1(\\bmod 3)\\).\n\nCombining these, we have proved that \\(a_{t} \\equiv 0,1(\\bmod 3)\\).\nWe next prove that no positive kawaii integer is divisible by both 2 and 3 . If \\(b_{2}=2\\) for some kawaii sequence, then \\(2 \\mid b_{n}\\) and \\(a_{n} \\equiv 1(\\bmod 2)\\) for all \\(n \\geqslant 2\\) in it. If \\(b_{2}=3\\) in some kawaii sequence, then \\(3 \\mid b_{n}\\) and \\(a_{n} \\equiv 1(\\bmod 3)\\) for all \\(n \\geqslant 2\\) in it.\n\nNow, consider the original problem. Since \\(m\\) and \\(m+1\\) are both kawaii integer, it means\n\\[\nm \\equiv 0,1(\\bmod 3), \\quad \\text { and } \\quad m+1 \\equiv 0,1(\\bmod 3)\n\\]\nand hence we easily obtain \\(3 \\mid m\\). Since a kawaii integer \\(m\\) is divisible by \\(3, m\\) must be odd, and hence \\(m+1\\) is even. Take a kawaii sequence \\(a_{0}, a_{1}, a_{2}, \\ldots\\) containing \\(m+1\\) as \\(a_{t}\\). The fact that \\(m+1\\) is even implies that \\(b_{2}=3\\) and so \\(3 \\mid b_{n}\\) for all \\(n \\geqslant 2\\) in this sequence. Set \\(b_{n}^{\\prime}=\\frac{b_{n+1}}{3}\\) for \\(n \\geqslant 1\\). Thus \\(b_{1}^{\\prime}=\\frac{b_{2}}{3}=1\\), and \\(\\frac{b_{n+1}^{\\prime}}{b_{n}^{\\prime}}=\\frac{b_{n+2}}{b_{n+1}} \\in\\{2,3\\}\\) for all \\(n \\geqslant 1\\). Define \\(a_{0}^{\\prime}=0\\) and \\(a_{n}^{\\prime}=\\sum_{k=1}^{n} b_{k}^{\\prime}\\) for \\(n \\geqslant 1\\), then \\(a_{0}^{\\prime}, a_{1}^{\\prime}, a_{2}^{\\prime}, \\ldots\\) is a kawaii sequence. Now,\n\\[\na_{t-1}^{\\prime}=\\sum_{k=1}^{t-1} b_{k}^{\\prime}=\\frac{1}{3} \\sum_{k=2}^{t} b_{k}=\\frac{1}{3}\\left(-b_{1}+\\sum_{k=1}^{t} b_{k}\\right)=\\frac{1}{3}\\left(-1+a_{t}\\right)=\\frac{m}{3} .\n\\]\n\nThis means that \\(\\frac{m}{3}\\) is a kawaii integer.\nComment. There are infinitely many positive integers \\(m\\) such that \\(m, m+1, m / 3\\) are kawaii. To see this, let \\(k \\geqslant 1\\) be a kawaii integer. Then \\(2 k+1\\) and \\(3 k+1\\) are kawaii by Claim 2 in Solution 2, and \\(3(2 k+1)+1=6 k+4\\) and \\(2(3 k+1)+1=6 k+3\\) are also kawaii.", "source_pdf": "imosl_2023.pdf", "notes": "fallback-regex"}
{"id": "IMOSL-2023-N7", "contest": "IMOSL", "year": "2023", "problem_number": "N7", "problem": "Let \\(a, b, c, d\\) be positive integers satisfying\n\\[\n\\frac{a b}{a+b}+\\frac{c d}{c+d}=\\frac{(a+b)(c+d)}{a+b+c+d}\n\\]\n\nDetermine all possible values of \\(a+b+c+d\\).\n(Netherlands)", "solution": "Answer: The possible values are the positive integers that are not square-free.\n\n\\section*{\n\n.}\n\nFirst, note that if we take \\(a=\\ell, b=k \\ell, c=k \\ell, d=k^{2} \\ell\\) for some positive integers \\(k\\) and \\(\\ell\\), then we have\n\\[\n\\frac{a b}{a+b}+\\frac{c d}{c+d}=\\frac{k \\ell^{2}}{\\ell+k \\ell}+\\frac{k^{3} \\ell^{2}}{k \\ell+k^{2} \\ell}=\\frac{k \\ell}{k+1}+\\frac{k^{2} \\ell}{k+1}=k \\ell\n\\]\nand\n\\[\n\\frac{(a+b)(c+d)}{a+b+c+d}=\\frac{(\\ell+k \\ell)\\left(k \\ell+k^{2} \\ell\\right)}{\\ell+k \\ell+k \\ell+k^{2} \\ell}=\\frac{k(k+1)^{2} \\ell^{2}}{\\ell(k+1)^{2}}=k \\ell,\n\\]\nso that\n\\[\n\\frac{a b}{a+b}+\\frac{c d}{c+d}=k \\ell=\\frac{(a+b)(c+d)}{a+b+c+d} .\n\\]\n\nThis means that \\(a+b+c+d=\\ell\\left(1+2 k+k^{2}\\right)=\\ell(k+1)^{2}\\) can be attained. We conclude that all non-square-free positive integers can be attained.\n\nNow, we will show that if\n\\[\n\\frac{a b}{a+b}+\\frac{c d}{c+d}=\\frac{(a+b)(c+d)}{a+b+c+d}\n\\]\nthen \\(a+b+c+d\\) is not square-free. We argue by contradiction. Suppose that \\(a+b+c+d\\) is square-free, and note that after multiplying by \\((a+b)(c+d)(a+b+c+d)\\), we obtain\n\\[\n(a b(c+d)+c d(a+b))(a+b+c+d)=(a+b)^{2}(c+d)^{2} .\n\\]\n\nA prime factor of \\(a+b+c+d\\) must divide \\(a+b\\) or \\(c+d\\), and therefore divides both \\(a+b\\) and \\(c+d\\). Because \\(a+b+c+d\\) is square-free, the fact that every prime factor of \\(a+b+c+d\\) divides \\(a+b\\) implies that \\(a+b+c+d\\) itself divides \\(a+b\\). Because \\(a+b<a+b+c+d\\), this is impossible. So \\(a+b+c+d\\) cannot be square-free.\n\nComment 1. Another way to conclude after obtaining (1) is by observing that\n\\[\n(a+b)^{2}(c+d)^{2} \\equiv(a+b)^{4} \\quad(\\bmod a+b+c+d)\n\\]\n\nHence \\(a+b+c+d \\mid(a+b)^{4}\\). But if \\(a+b+c+d\\) is square-free, this forces \\(a+b+c+d \\mid a+b\\), which is clearly a contradiction.\n\nComment 2. It seems difficult to characterise all quadruples ( \\(a, b, c, d\\) ) that satisfy the equality in the problem. Many of them, including those used in the solution, are of the general form \\((a, b, c, d)=\\) ( \\(x y^{2}, x y z, x y z, x z^{2}\\) ) for some positive integers \\(x, y\\), and \\(z\\), but there are more solutions than that, such as \\((a, b, c, d)=(2,7,8,10)\\) or \\((a, b, c, d)=(13,14,16,38)\\).", "source_pdf": "imosl_2023.pdf", "notes": "fallback-regex"}
{"id": "IMOSL-2023-N8", "contest": "IMOSL", "year": "2023", "problem_number": "N8", "problem": "Let \\(\\mathbb{Z}_{>0}\\) be the set of positive integers. Determine all functions \\(f: \\mathbb{Z}_{>0} \\rightarrow \\mathbb{Z}_{>0}\\) such that\n\\[\nf^{b f(a)}(a+1)=(a+1) f(b)\n\\]\nholds for all \\(a, b \\in \\mathbb{Z}_{>0}\\), where \\(f^{k}(n)=f(f(\\cdots f(n) \\cdots))\\) denotes the composition of \\(f\\) with itself \\(k\\) times.\n(Taiwan)", "solution": "Answer: The only function satisfying the condition is \\(f(n)=n+1\\) for all \\(n \\in \\mathbb{Z}_{>0}\\).\nLet \\(P(a, b)\\) be the equality in the statement.\n\n1. We divide the solution into 5 steps.\nStep 1. ( \\(f\\) is injective)\nClaim 1. For any \\(a \\geqslant 2\\), the set \\(\\left\\{f^{n}(a) \\mid n \\in \\mathbb{Z}_{>0}\\right\\}\\) is infinite.\nProof. First, we have \\(f^{f(a)}(a+1) \\stackrel{P(a, 1)}{=}(a+1) f(1)\\). Varying \\(a\\), we see that \\(f\\left(\\mathbb{Z}_{>0}\\right)\\) is infinite. Next, we have \\(f^{b f(a-1)}(a) \\stackrel{P(a-1, b)}{=} a f(b)\\). So, varying \\(b, f^{b f(a-1)}(a)\\) takes infinitely many values.\n\nClaim 2. For any \\(a \\geqslant 2\\) and \\(n \\in \\mathbb{Z}_{>0}\\), we have \\(f^{n}(a) \\neq a\\).\nProof. Otherwise we would get a contradiction with Claim 1.\nAssume \\(f(b)=f(c)\\) for some \\(b<c\\). Then we have\n\\[\n\\begin{aligned}\n(a+1) f(c) & \\stackrel{P(a, c)}{=} f^{c f(a)}(a+1) \\\\\n& =f^{(c-b) f(a)}\\left(f^{b f(a)}(a+1)\\right) \\\\\n& \\stackrel{P(a, b)}{=} f^{(c-b) f(a)}((a+1) f(b)) \\\\\n& =f^{(c-b) f(a)}((a+1) f(c))\n\\end{aligned}\n\\]\nwhich contradicts Claim 2. So, \\(f\\) is injective.\nStep 2. \\(\\left(f\\left(\\mathbb{Z}_{>0}\\right)=\\mathbb{Z}_{\\geqslant 2}\\right)\\)\nClaim 3. 1 is not in the range of \\(f\\).\nProof. If \\(f(b)=1\\), then \\(f^{f(a)}(a+1)=a+1\\) by \\(P(a, 1)\\), which contradicts Claim 2 .\nWe say that \\(a\\) is a descendant of \\(b\\) if \\(f^{n}(b)=a\\) for some \\(n \\in \\mathbb{Z}_{>0}\\).\nClaim 4. For any \\(a, b \\geqslant 1\\), both of the following cannot happen at the same time:\n- \\(a\\) is a descendant of \\(b\\);\n- \\(b\\) is a descendant of \\(a\\).\n\nProof. If both of the above hold, then \\(a=f^{m}(b)\\) and \\(b=f^{n}(a)\\) for some \\(m, n \\in \\mathbb{Z}_{>0}\\). Then \\(a=f^{m+n}(a)\\), which contradicts Claim 2.\nClaim 5. For any \\(a, b \\geqslant 2\\), exactly one of the following holds:\n- \\(a\\) is a descendant of \\(b\\);\n- \\(b\\) is a descendant of \\(a\\);\n- \\(a=b\\).\n\nProof. For any \\(c \\geqslant 2\\), taking \\(m=f^{c f(a-1)-1}(a)\\) and \\(n=f^{c f(b-1)-1}(b)\\), we have\n\\[\nf(m)=f^{c f(a-1)}(a) \\stackrel{P(a-1, c)}{=} a f(c) \\text { and } f(n)=f^{c f(b-1)}(b) \\stackrel{P(b-1, c)}{=} b f(c) .\n\\]\n\nHence\n\\[\nf^{n f(a-1)}(a) \\stackrel{P(a-1, n)}{=} a f(n)=a b f(c)=b f(m) \\stackrel{P(a-1, m)}{=} f^{m f(b-1)}(b)\n\\]\n\nThe assertion then follows from the injectivity of \\(f\\) and Claim 2.\nNow, we show that any \\(a \\geqslant 2\\) is in the range of \\(f\\). Let \\(b=f(1)\\). If \\(a=b\\), then \\(a\\) is in the range of \\(f\\). If \\(a \\neq b\\), either \\(a\\) is a descendant of \\(b\\), or \\(b\\) is a descendant of \\(a\\) by Claim 5. If \\(b\\) is a descendant of \\(a\\), then \\(b=f^{n}(a)\\) for some \\(n \\in \\mathbb{Z}_{>0}\\), so \\(1=f^{n-1}(a)\\). Then, by Claim 3, we have \\(n=1\\), so \\(1=a\\), which is absurd. So, \\(a\\) is a descendant of \\(b\\). In particular, \\(a\\) is in the range of \\(f\\). Thus, \\(f\\left(\\mathbb{Z}_{>0}\\right)=\\mathbb{Z}_{\\geqslant 2}\\).\n\nStep 3. \\((f(1)=2)\\)\nClaim 6. Let \\(a, n \\geqslant 2\\), then \\(n a\\) is a descendant of \\(a\\).\nProof. We write \\(n=f(m)\\) by Step 2. We have \\(n a=f(m) a \\stackrel{P(a-1, m)}{=} f^{m f(a-1)}(a)\\), which shows \\(n a\\) is a descendant of \\(a\\).\n\nBy Claim 6, all even integers \\(\\geqslant 4\\) are descendants of 2 . Hence \\(2=f(2 k+1)\\) for some \\(k \\geqslant 0\\).\nNext, we show \\(f(2 k+1) \\geqslant f(1)\\), which implies \\(f(1)=2\\). It trivially holds if \\(k=0\\). If \\(k \\geqslant 1\\), let \\(n\\) be the integer such that \\(f^{n}(2)=2 k+2\\). For any \\(b>n / f(1)\\), we have\n\\[\nf^{b f(1)-n}(2 k+2)=f^{b f(1)}(2) \\stackrel{P(1, b)}{=} 2 f(b) \\text { and } f^{b f(2 k+1)}(2 k+2) \\stackrel{P(2 k+1, b)}{=}(2 k+2) f(b)\n\\]\n\nBy Claim 6, \\((2 k+2) f(b)\\) is a descendant of \\(2 f(b)\\). By Claim 2, we have \\(b f(2 k+1)>b f(1)-n\\). By taking \\(b\\) large enough, we conclude \\(f(2 k+1) \\geqslant f(1)\\).\n\nStep 4. \\((f(2)=3\\) and \\(f(3)=4)\\) From \\(f(1)=2\\) and \\(P(1, b)\\), we have \\(f^{2 b}(2)=2 f(b)\\). So taking \\(b=1\\), we obtain \\(f^{2}(2)=2 f(1)=4\\); and taking \\(b=f(2)\\), we have \\(f^{2 f(2)}(2)=2 f^{2}(2)=8\\). Hence, \\(f^{2 f(2)-2}(4)=f^{2 f(2)}(2)=8\\) and \\(f^{f(3)}(4) \\stackrel{P(3,1)}{=} 8\\) give \\(f(3)=2 f(2)-2\\).\n\nClaim 7. For any \\(m, n \\in \\mathbb{Z}_{>0}\\), if \\(f(m)\\) divides \\(f(n)\\), then \\(m \\leqslant n\\).\nProof. If \\(f(m)=f(n)\\), the assertion follows from the injectivity of \\(f\\). If \\(f(m)<f(n)\\), by \\(P(a, m), P(a, n)\\) and Claim 6, we have that \\(f^{n f(a)}(a+1)\\) is a descendant of \\(f^{m f(a)}(a+1)\\) for any \\(a \\in \\mathbb{Z}_{>0}\\). So \\(m f(a)<n f(a)\\), and \\(m<n\\).\n\nBy Claim 7, every possible divisor of \\(f(2)\\) is in \\(\\{1, f(1)=2, f(2)\\}\\). Thus \\(f(2)\\) is an odd prime or \\(f(2)=4\\). Since \\(f^{2}(2)=4\\), we have \\(f(2) \\neq 4\\), and hence \\(f(2)\\) is an odd prime. We set \\(p=f(2)\\).\n\nNow, \\(f(3)=2 f(2)-2=2(p-1)\\). Since \\(p-1\\) divides \\(f(3)\\), we have \\(p-1 \\in\\{1, f(1)=\\) 2 , \\(f(2)=p\\}\\) by Claim 7, so \\(p-1=2\\). Thus, \\(f(2)=p=3\\) and \\(f(3)=2(p-1)=4\\).\n\nStep 5. \\((f(n)=n+1)\\)\nClaim 8. For any \\(b \\geqslant 1, f(2 f(b)-1)=2 b+2\\).\nProof. Since \\(f^{2}(2)=4\\), we have \\(f^{2 b-2}(4)=f^{2 b}(2)=2 f(b)\\), so\n\\[\nf^{f(2 f(b)-1)+2 b-2}(4)=f^{f(2 f(b)-1)}(2 f(b))^{P(2 f \\stackrel{(b)-1,1)}{=}} 4 f(b) \\stackrel{P(3, b)}{=} f^{4 b}(4)\n\\]\nwhich gives us \\(f(2 f(b)-1)=2 b+2\\).\n\nFinally, we prove \\(f(n)=n+1\\) by induction on \\(n\\). Suppose \\(f(n)=n+1\\) for all \\(1 \\leqslant n \\leqslant 2 b+1\\). Replace \\(b\\) by \\(b+1\\) in \\(f(2 f(b)-1)=2 b+2\\) to get\n\\[\nf(2 b+3)=f(2 f(b+1)-1)=2(b+1)+2=2 b+4 .\n\\]\n\nBy induction hypothesis, we have \\(f^{b}(b+2)=2 b+2\\). Hence\n\\[\nf(f(2 b+2))=f^{b+2}(b+2)=f^{f(b+1)}(b+2) \\stackrel{P(b+1,1)}{=} 2(b+2)=f(2 b+3)\n\\]\n\nBy injectivity, \\(f(2 b+2)=2 b+3\\). Then \\(f(n)=n+1\\) for all \\(n \\in \\mathbb{Z}_{>0}\\), which is indeed a solution.\nSolution 2. In the same way as Steps 1-2 of Solution 1, we have that \\(f\\) is injective and \\(f\\left(\\mathbb{Z}_{>0}\\right)=\\mathbb{Z}_{\\geqslant 2}\\).\n\nWe first note that Claim 2 in Solution 1 is also true for \\(a=1\\).\nClaim 2'. For any \\(a, n \\in \\mathbb{Z}_{>0}\\), we have \\(f^{n}(a) \\neq a\\).\nProof. If \\(a \\geqslant 2\\), the assertion was proved in Claim 2 in Solution 1. If \\(a=1\\), we have that 1 is not in the range of \\(f\\) by Claim 3 in Solution 1. So, \\(f^{n}(1) \\neq 1\\) for every \\(n \\in \\mathbb{Z}_{>0}\\).\n\nFor any \\(a, b \\in \\mathbb{Z}_{>0}\\), we have\n\\[\nf^{b f(f(a)-1)+1}(a)=f^{b f(f(a)-1)}(f(a)) \\stackrel{P(f(a)-1, b)}{=} f(a) f(b)\n\\]\n\nSince the right-hand side is symmetric in \\(a, b\\), we have\n\\[\nf^{b f(f(a)-1)+1}(a)=f(a) f(b)=f^{a f(f(b)-1)+1}(b) .\n\\]\n\nSince \\(f\\) is injective, we have \\(f^{b f(f(a)-1)}(a)=f^{a f(f(b)-1)}(b)\\). We set \\(g(n)=f(f(n)-1)\\). Then we have \\(f^{b g(a)}(a)=f^{a g(b)}(b)\\) for any \\(a, b \\in \\mathbb{Z}_{>0}\\). We set \\(n_{a, b}=b g(a)-a g(b)\\). Then, for sufficiently large \\(n\\), we have \\(f^{n+n_{a, b}}(a)=f^{n}(b)\\). For any \\(a, b, c \\in \\mathbb{Z}_{>0}\\) and sufficiently large \\(n\\), we have\n\\[\nf^{n+n_{a, b}+n_{b, c}+n_{c, a}}(a)=f^{n}(a)\n\\]\n\nBy Claim 2' above, we have \\(n_{a, b}+n_{b, c}+n_{c, a}=0\\), so\n\\[\n(a-b) g(c)+(b-c) g(a)+(c-a) g(b)=0\n\\]\n\nTaking \\((a, b, c)=(n, n+1, n+2)\\), we have \\(g(n+1)-g(n)=g(n+2)-g(n+1)\\). So, \\(\\{g(n)\\}_{n \\geqslant 1}\\) is an arithmetic progression.\n\nThere exist \\(C, D \\in \\mathbb{Z}\\) such that \\(g(n)=f(f(n)-1)=C n+D\\) for all \\(n \\in \\mathbb{Z}_{>0}\\). By Step 2 of Solution 1, we have \\(f\\left(\\mathbb{Z}_{>0}\\right)=\\mathbb{Z}_{\\geqslant 2}\\), so \\(C=1\\). Since \\(2=\\min _{n \\in \\mathbb{Z}_{>0}}\\{f(f(n)-1)\\}\\), we have \\(D=1\\).\n\nThus, \\(g(n)=f(f(n)-1)=n+1\\) for all \\(n \\geqslant 1\\). For any \\(a, b \\in \\mathbb{Z}_{>0}\\), we have \\(f^{b(a+1)}(a)= f^{a(b+1)}(b)\\). By the injectivity of \\(f\\), we have \\(f^{b}(a)=f^{a}(b)\\). For any \\(n \\in \\mathbb{Z}_{>0}\\), taking \\((a, b)=(1, n)\\), we have \\(f^{n}(1)=f(n)\\), so \\(f^{n-1}(1)=n\\) again by the injectivity of \\(f\\). For any \\(n \\geqslant 1\\), we have \\(f(n)=f\\left(f^{n-1}(1)\\right)=f^{n}(1)=n+1\\).\n\nSolution 3. The following is another way of finishing Solution 2 after Claim 2' and having introduced \\(g(n)=f(f(n)-1)\\). For \\(a, b \\in \\mathbb{Z}_{>0}\\) satisfying \\(b=f^{k}(a)\\), we have\n\\[\n\\begin{aligned}\nf^{b g(a)}(f(a)) & =f^{b f(f(a)-1)}(f(a)) \\stackrel{P(f(a)-1, b)}{=} f(a) f(b) \\stackrel{P(f(b)-1, a)}{=} f^{a f(f(b)-1)}(f(b)) \\\\\n& =f^{a g(b)+k}(f(a))\n\\end{aligned}\n\\]\n\nBy Claim 2' in Solution 2, we have \\(b g(a)=a g(b)+k\\), so \\(f^{k}(a) \\cdot g(a)=a \\cdot g\\left(f^{k}(a)\\right)+k\\). Therefore, for any \\(n \\geqslant 0\\), we put \\(a_{n}=f^{n}(1)\\). We have\n\\[\n\\left\\{\\begin{array}{l}\na_{n+1} \\cdot g\\left(a_{n}\\right)=a_{n} \\cdot g\\left(a_{n+1}\\right)+1 \\\\\na_{n+2} \\cdot g\\left(a_{n+1}\\right)=a_{n+1} \\cdot g\\left(a_{n+2}\\right)+1 \\\\\na_{n+2} \\cdot g\\left(a_{n}\\right)=a_{n} \\cdot g\\left(a_{n+2}\\right)+2\n\\end{array}\\right.\n\\]\n\nThen we have\n\\[\n\\begin{aligned}\na_{n} \\cdot a_{n+1} \\cdot g\\left(a_{n+2}\\right)+2 a_{n+1} & =a_{n+1} \\cdot a_{n+2} \\cdot g\\left(a_{n}\\right) \\\\\n& =a_{n+2}\\left(a_{n} \\cdot g\\left(a_{n+1}\\right)+1\\right) \\\\\n& =a_{n} \\cdot a_{n+2} \\cdot g\\left(a_{n+1}\\right)+a_{n+2} \\\\\n& =a_{n}\\left(a_{n+1} \\cdot g\\left(a_{n+2}\\right)+1\\right)+a_{n+2} \\\\\n& =a_{n} \\cdot a_{n+1} \\cdot g\\left(a_{n+2}\\right)+a_{n}+a_{n+2}\n\\end{aligned}\n\\]\n\nFrom these, we have \\(2 a_{n+1}=a_{n}+a_{n+2}\\). Thus ( \\(a_{n}\\) ) is an arithmetic progression, and we have \\(a_{n}=f^{n}(1)=C n+D\\) for some \\(C, D \\in \\mathbb{Z}\\).\n\nBy Step 2 in Solution 1, any \\(a \\in \\mathbb{Z}_{>0}\\) is a descendant of 1 , and \\(f\\left(\\mathbb{Z}_{>0}\\right)=\\mathbb{Z}_{\\geqslant 2}\\). Hence \\(D=1\\) and \\(C=1\\), and so \\(f^{n}(1)=n+1\\). For any \\(n \\geqslant 1\\), we have \\(f^{n-1}(1)=n\\), so \\(f(n)=f\\left(f^{n-1}(1)\\right)= f^{n}(1)=n+1\\).\n\n\\section*{Solution 4.}\n\nWe provide yet another (more technical) solution assuming Step 1 and Step 2 of Solution 1.\nBy Claim 5 in Solution 1, every \\(a \\geqslant 2\\) is a descendant of 1 . Let \\(g\\) and \\(h\\) be the functions on \\(\\mathbb{Z}_{\\geqslant 2}\\) such that \\(f^{g(a)}(1)=a\\) and \\(h(a)=f(a-1)\\). Then, \\(g: \\mathbb{Z}_{\\geqslant 2} \\rightarrow \\mathbb{Z}_{\\geqslant 1}\\) and \\(h: \\mathbb{Z}_{\\geqslant 2} \\rightarrow \\mathbb{Z}_{\\geqslant 2}\\) are bijections. The equation \\(P(a, b)\\) can be rewritten as\n\\[\ng(a h(b))=g(a)+(b-1) h(a) .\n\\]\n\nConsider the set \\(S_{a}=g\\left(a \\cdot \\mathbb{Z}_{>0}\\right)\\). Since \\(h\\) is a bijection onto \\(\\mathbb{Z}_{\\geqslant 2}\\), we have\n\\[\nS_{a}=g(a)+h(a) \\cdot \\mathbb{Z}_{\\geqslant 0} .\n\\]\n\nConsider the intersection \\(S_{a} \\cap S_{b}=S_{\\operatorname{lcm}(a, b)}\\). If we put \\(c=\\operatorname{lcm}(a, b)\\), this gives\n\\[\n\\left(g(a)+h(a) \\cdot \\mathbb{Z}_{\\geqslant 0}\\right) \\cap\\left(g(b)+h(b) \\cdot \\mathbb{Z}_{\\geqslant 0}\\right)=g(c)+h(c) \\cdot \\mathbb{Z}_{\\geqslant 0} .\n\\]\n\nThen we have \\(h(c)=\\operatorname{lcm}(h(a), h(b))\\) since the left hand side must be of the form \\(m+ \\operatorname{lcm}(h(a), h(b)) \\cdot \\mathbb{Z}_{\\geqslant 0}\\) for some \\(m\\).\n\nIf \\(b\\) is a multiple of \\(a\\), then \\(\\operatorname{lcm}(a, b)=b\\), so \\(h(b)=\\operatorname{lcm}(h(a), h(b))\\), and hence \\(h(b)\\) is a multiple of \\(h(a)\\). Conversely, if \\(h(b)\\) is a multiple of \\(h(a)\\), then \\(h(b)=\\operatorname{lcm}(h(a), h(b))\\). On the other hand, we have \\(h(c)=\\operatorname{lcm}(h(a), h(b))\\). Since \\(h\\) is injective, we have \\(c=b\\), so \\(b\\) is a multiple of \\(a\\).\n\nWe apply the following claim for \\(H=h\\).\nClaim. Suppose \\(H: \\mathbb{Z}_{\\geqslant 2} \\rightarrow \\mathbb{Z}_{\\geqslant 2}\\) is a bijection such that \\(a\\) divides \\(b\\) if and only if \\(H(a)\\) divides \\(H(b)\\). Then:\n1. \\(H(p)\\) is prime if and only if \\(p\\) is prime;\n2. \\(H\\left(\\prod_{i=1}^{m} p_{i}^{e_{i}}\\right)=\\prod_{i=1}^{m} H\\left(p_{i}\\right)^{e_{i}}\\) i.e. \\(H\\) is completely multiplicative;\n3. \\(H\\) preserves gcd and lcm.\n\nProof. We define \\(H(1)=1\\), and consider the bijection \\(H: \\mathbb{Z}_{>0} \\rightarrow \\mathbb{Z}_{>0}\\). By the conditions on \\(H\\), for any \\(n \\in \\mathbb{Z}_{\\geqslant 2}, n\\) and \\(H(n)\\) have the same number of divisors. Hence \\(H(p)\\) is prime if and only if \\(p\\) is prime.\n\nSince the only prime dividing \\(H\\left(p^{r}\\right)\\) is \\(H(p)\\), we have \\(H\\left(p^{r}\\right)=H(p)^{s}\\) for some \\(s \\geqslant 1\\). Counting the number of divisors, we have \\(s=r\\), so \\(H\\left(p^{r}\\right)=H(p)^{r}\\) for any prime \\(p\\) and \\(r \\geqslant 1\\).\n\nFor \\(a, b \\in \\mathbb{Z}_{>0}\\), recall that \\(\\operatorname{gcd}(a, b)\\) is a unique positive integer satisfying the following condition: for any \\(c \\in \\mathbb{Z}_{>0}, c\\) divides \\(\\operatorname{gcd}(a, b)\\) if and only if \\(c\\) divides both \\(a\\) and \\(b\\). By the condition on \\(H\\), for any \\(c \\in \\mathbb{Z}_{>0}, H(c)\\) divides \\(H(\\operatorname{gcd}(a, b))\\) if and only if \\(H(c)\\) divides both \\(H(a)\\) and \\(H(b)\\). Hence we have \\(H(\\operatorname{gcd}(a, b))=\\operatorname{gcd}(H(a), H(b))\\).\n\nSimilarly, we have \\(H(\\operatorname{lcm}(a, b))=\\operatorname{lcm}(H(a), H(b))\\). Hence we have\n\\[\n\\begin{aligned}\nH\\left(\\prod_{i=1}^{m} p_{i}^{e_{i}}\\right) & =H\\left(\\operatorname{lcm}\\left(p_{1}^{e_{1}}, \\ldots, p_{r}^{e_{r}}\\right)\\right)=\\operatorname{lcm}\\left(H\\left(p_{1}^{e_{1}}\\right), \\ldots, H\\left(p_{r}^{e_{r}}\\right)\\right)=\\operatorname{lcm}\\left(H\\left(p_{1}\\right)^{e_{1}}, \\ldots, H\\left(p_{r}\\right)^{e_{r}}\\right) \\\\\n& =\\prod_{i=1}^{m} H\\left(p_{i}\\right)^{e_{i}}\n\\end{aligned}\n\\]\nsince \\(H\\left(p_{i}\\right)\\) and \\(H\\left(p_{j}\\right)\\) are different primes for \\(i \\neq j\\).\nTake two primes \\(p \\neq q\\), and let \\(x, y\\) be positive integers such that\n\\[\ng(p)+(x-1) h(p)=g(q)+(y-1) h(q) .\n\\]\n\nThis is possible as \\(h(p)\\) and \\(h(q)\\) are two distinct primes. For every \\(k \\geqslant 0\\), by \\(P(p, x+k h(q))\\) and \\(P(q, y+k h(p))\\), we have\n\\[\n\\left\\{\\begin{array}{l}\ng(p \\cdot h(x+k h(q)))=g(p)+(x+k h(q)-1) h(p), \\\\\ng(q \\cdot h(y+k h(p)))=g(q)+(y+k h(p)-1) h(q),\n\\end{array}\\right.\n\\]\nwhere the right hand sides are equal. By the injectivity of \\(g\\), we have\n\\[\np \\cdot h(x+k h(q))=q \\cdot h(y+k h(p))\n\\]\n\nSo, \\(h(y+k h(p))\\) is divisible by \\(p\\) for all \\(k \\geqslant 0\\). By the above Claim, \\(h\\) preserves gcd, so\n\\[\nh(\\operatorname{gcd}(y, h(p)))=\\operatorname{gcd}(h(y), h(y+h(p)))\n\\]\nis divisible by \\(p\\). Since \\(h(p)\\) is a prime, \\(y\\) must be divisible by \\(h(p)\\). Moreover, \\(h(h(p))\\) is also a prime, so we have \\(h(h(p))=p\\). The function \\(h \\circ h\\) is completely multiplicative, so we have \\(h(h(n))=n\\) for every \\(n \\geqslant 2\\).\n\nBy \\(P(a, h(b))\\) and \\(P(b, h(a))\\), we have\n\\[\n\\left\\{\\begin{array}{l}\ng(a b)=g(a \\cdot h(h(b))) \\stackrel{P(a, h(b))}{=} g(a)+(h(b)-1) h(a), \\\\\ng(b a)=g(b \\cdot h(h(a))) \\stackrel{P(b, h(a))}{=} g(b)+(h(a)-1) h(b),\n\\end{array}\\right.\n\\]\nso\n\\[\ng(a)+h(a)(h(b)-1)=g(a b)=g(b)+h(b)(h(a)-1) .\n\\]\n\nHence \\(g(a)-h(a)=g(b)-h(b)\\) for any \\(a, b \\geqslant 2\\), so \\(g-h\\) is a constant function. By comparing the images of \\(g\\) and \\(h\\), the difference is -1 , i.e. \\(g(a)-h(a)=1\\) for any \\(a \\geqslant 2\\).\n\nSo, we have \\(g(h(a))=h(h(a))-1=a-1\\). By definition,\n\\[\nf(a-1)=h(a)=f^{g(h(a))}(1)=f^{a-1}(1)\n\\]\n\nBy the injectivity of \\(f\\), we have \\(f^{a-2}(1)=a-1\\) for every \\(a \\geqslant 2\\). From this, we can deduce inductively that \\(f(a)=a+1\\) for every \\(a \\geqslant 1\\).\n\\(\\infty\\)", "source_pdf": "imosl_2023.pdf", "notes": "fallback-regex"}
{"id": "IMOSL-2024-A2", "contest": "IMOSL", "year": "2024", "problem_number": "A2", "problem": "Let \\(n\\) be a positive integer. Find the minimum possible value of\n\\[\nS=2^{0} x_{0}^{2}+2^{1} x_{1}^{2}+\\cdots+2^{n} x_{n}^{2}\n\\]\nwhere \\(x_{0}, x_{1}, \\ldots, x_{n}\\) are nonnegative integers such that \\(x_{0}+x_{1}+\\cdots+x_{n}=n\\).\n(China)", "solution": "Answer: The minimum value is \\(\\frac{n(n+1)}{2}\\).\n\n1. For a fixed \\(n\\), let \\(f(n)\\) denote the minimum possible value of \\(S\\). Consider the following variant: among all infinite sequences of nonnegative integers \\(x_{0}, x_{1}, \\ldots\\), only finitely many of which are nonzero, satisfying \\(x_{0}+x_{1}+\\cdots=n\\), let \\(g(n)\\) denote the minimum possible value of\n\\[\nT=2^{0} x_{0}^{2}+2^{1} x_{1}^{2}+2^{2} x_{2}^{2}+\\cdots\n\\]\n\nIt is clear that \\(g(n) \\leqslant f(n)\\). Conversely, it is easy to see that if a sequence \\(x_{0}, x_{1}, \\ldots\\) achieves the minimum of \\(g(n)\\), then \\(x_{0} \\geqslant x_{1} \\geqslant \\cdots\\) and thus \\(x_{n+1}=x_{n+2}=\\cdots=0\\). In particular, \\(f(n)=g(n)\\).\n\nNow, we hope to get an inductive formula for \\(g(n)\\).\nNote that, in order to minimise \\(T\\) for \\(n \\geqslant 1\\), we must have \\(x_{0} \\geqslant 1\\) since the sequence ( \\(x_{i}\\) ) is nonincreasing. Note that the minimal value of\n\\[\n2^{1} x_{1}^{2}+2^{2} x_{2}^{2}+\\cdots=2\\left(2^{0} x_{1}^{2}+2^{1} x_{2}^{2}+\\cdots\\right)\n\\]\nover all infinite sequences of nonnegative integers with \\(x_{1}+x_{2}+\\cdots=m\\) is exactly \\(2 g(m)\\). As a result, for \\(n \\geqslant 1\\) we have\n\\[\ng(n)=\\min _{x_{0} \\in\\{1,2, \\ldots, n\\}}\\left(x_{0}^{2}+2 g\\left(n-x_{0}\\right)\\right) .\n\\]\n\nWe now prove \\(g(n)=\\frac{n(n+1)}{2}\\) by induction. It is clear that \\(g(0)=0\\). Assume that this has been proved for \\(n=0,1, \\ldots, N-1\\). Then,\n\\[\n\\begin{aligned}\nx_{0}^{2}+2 g\\left(N-x_{0}\\right) & =x_{0}^{2}+\\left(N-x_{0}\\right)\\left(N-x_{0}+1\\right) \\\\\n& =2 x_{0}^{2}-(2 N+1) x_{0}+N(N+1) \\\\\n& =\\frac{1}{2}\\left[\\left(2 x_{0}-N\\right)\\left(2 x_{0}-N-1\\right)+N^{2}+N\\right]\n\\end{aligned}\n\\]\n\nThe product of two consecutive integers \\(\\left(2 x_{0}-N\\right)\\left(2 x_{0}-N-1\\right)\\) is always nonnegative, and it is zero precisely when \\(2 x_{0}\\) is the even number in \\(\\{N, N+1\\}\\). Thus the minimum of the final expression in equation (1) is \\(\\frac{1}{2}\\left(N^{2}+N\\right)\\), so \\(g(N)=\\frac{N(N+1)}{2}\\), completing the inductive proof.\n\nSolution 2. Consider the following table of numbers, where the row and column indices start from 0 , and \\(a_{i, j}=2^{i}(2 j+1)\\) for \\(i, j \\geqslant 0\\).\n\n\\begin{tabular}{r|rrrrrrr} \n& \\(j=0\\) & 1 & 2 & 3 & 4 & 5 & \\(\\cdots\\) \\\\\n\\hline\\(i=0\\) & 1 & 3 & 5 & 7 & 9 & 11 & \\\\\n1 & 2 & 6 & 10 & 14 & 18 & 22 & \\\\\n2 & 4 & 12 & 20 & 28 & 36 & 44 & \\\\\n3 & 8 & 24 & 40 & 56 & 72 & 88 & \\\\\n4 & 16 & 48 & 80 & 112 & 144 & 176 & \\\\\n\\(\\vdots\\) & & & & & & &\n\\end{tabular}\n\nEvery number can be written uniquely as a product of a power of 2 and an odd number so every positive integer appears exactly once in the table above. It is easy to see that numbers in each row and each column are strictly increasing. Since the sum of the first \\(x\\) odd positive integers is \\(x^{2}\\), the sum of the first \\(x_{k}\\) numbers in the \\(k^{\\text {th }}\\) row is \\(2^{k} x_{k}^{2}\\), the \\(k^{\\text {th }}\\) term appearing in \\(S\\).\n\nThus, the sum \\(S\\) can be interpreted as the result of taking a total of \\(n\\) numbers from the first \\(n\\) rows of the table such that we take the leftmost \\(x_{k}\\) numbers from row \\(k\\) (where \\(\\sum_{k=1}^{n} x_{k}=n\\) ), and then computing the sum of these \\(n\\) numbers. In particular, the minimum possible value of \\(S\\) is the same as the sum of the smallest \\(n\\) numbers in this table, since every row and every column of the table is strictly increasing.\n\nMoreover, the smallest \\(n\\) numbers, namely \\(1,2, \\ldots, n\\), appear in the first \\(n\\) rows, so the minimum of \\(S\\) is\n\\[\n1+2+\\cdots+n=\\frac{n(n+1)}{2}\n\\]\n\nComment. As can be seen from the table in Solution 2, the equality case of the problem is given by\n\\[\nx_{i}=\\left\\lfloor\\frac{n}{2^{i+1}}+\\frac{1}{2}\\right\\rfloor\n\\]\n\nSo \\(x_{i}\\) is the result of rounding \\(\\frac{n}{2^{i+1}}\\) to the nearest integer. This also gives a proof of the identity\n\\[\nn=\\sum_{i=0}^{\\infty}\\left\\lfloor\\frac{n}{2^{i+1}}+\\frac{1}{2}\\right\\rfloor\n\\]\nwhich can be separately proven by induction on \\(n\\) : when \\(n\\) is incremented by 1 , exactly one term on the right hand side, namely the one corresponding to \\(i=\\nu_{2}(n)\\), increases by 1 while the others remain the same.\n\nComment. If the condition that the \\(x_{i}\\) are nonnegative integers is relaxed to the \\(x_{i}\\) being nonnegative reals, the problem can be solved by an application of the Cauchy-Schwarz inequality:\n\\[\n\\begin{gathered}\n\\left(2^{0}+2^{-1}+\\cdots+2^{-n}\\right)\\left(2^{0} x_{0}^{2}+2^{1} x_{1}^{2}+\\cdots+2^{n} x_{n}^{2}\\right) \\geqslant\\left(x_{0}+\\cdots+x_{n}\\right)^{2}=n^{2} \\\\\n\\Longrightarrow 2^{0} x_{0}^{2}+2^{1} x_{1}^{2}+\\cdots+2^{n} x_{n}^{2} \\geqslant \\frac{n^{2}}{2-2^{-n}}\n\\end{gathered}\n\\]\n\nThe equality case for this relaxed problem is given by\n\\[\nx_{i}=\\frac{2^{-i} n}{2-2^{-n}} \\approx\\left\\lfloor\\frac{n}{2^{i+1}}+\\frac{1}{2}\\right\\rfloor\n\\]\n\nIn fact, when the terms in the optimal sequence for the real case are all rounded to the nearest integer, we obtain the optimal sequence for the original problem. While thinking about the real case may guide one towards the equality case of the original problem, it does not seem like it can be easily continued into a full solution.", "source_pdf": "imosl_2024.pdf", "notes": "fallback-regex"}
{"id": "IMOSL-2024-A3", "contest": "IMOSL", "year": "2024", "problem_number": "A3", "problem": "Decide whether for every sequence \\(\\left(a_{n}\\right)\\) of positive real numbers,\n\\[\n\\frac{3^{a_{1}}+3^{a_{2}}+\\cdots+3^{a_{n}}}{\\left(2^{a_{1}}+2^{a_{2}}+\\cdots+2^{a_{n}}\\right)^{2}}<\\frac{1}{2024}\n\\]\nis true for at least one positive integer \\(n\\).\n(China)\nComment. The question can be asked in several forms, as follows:\n(i) students could be asked, as above, to show the existence of such an \\(n\\);\n(ii) students could be asked to show that this happens for all sufficiently large \\(n\\);\n(iii) students could be given a concrete positive integer \\(N\\) and asked to show it for all \\(n>N\\).\n\nThe solutions below provide varying bounds for \\(N\\).", "solution": "Answer: The answer is \"yes\": there is always such an \\(n\\).\nCommon remarks. We write \\(\\varepsilon=\\frac{1}{2024}\\).\n\n1. For every positive integer \\(n\\), let \\(M_{n}=\\max \\left(a_{1}, a_{2}, \\ldots, a_{n}\\right)\\). We first prove that\n\\[\n\\frac{3^{a_{1}}+3^{a_{2}}+\\cdots+3^{a_{n}}}{\\left(2^{a_{1}}+2^{a_{2}}+\\cdots+2^{a_{n}}\\right)^{2}} \\leqslant\\left(\\frac{3}{4}\\right)^{M_{n}} .\n\\]\n\nFor \\(i=1,2, \\ldots, n\\), from \\(\\left(\\frac{3}{2}\\right)^{a_{i}} \\leqslant\\left(\\frac{3}{2}\\right)^{M_{n}}\\) we can obtain \\(3^{a_{i}} \\leqslant\\left(\\frac{3}{4}\\right)^{M_{n}} \\cdot 2^{M_{n}} \\cdot 2^{a_{i}}\\). By summing up over all \\(i\\),\n\\[\n\\sum_{i=1}^{n} 3^{a_{i}} \\leqslant\\left(\\frac{3}{4}\\right)^{M_{n}} \\cdot 2^{M_{n}} \\cdot \\sum_{i=1}^{n} 2^{a_{i}} \\leqslant\\left(\\frac{3}{4}\\right)^{M_{n}} \\cdot\\left(\\sum_{i=1}^{n} 2^{a_{i}}\\right)^{2}\n\\]\nwhich is equivalent to (2).\nNow let \\(\\mu=\\log _{4 / 3} \\frac{1}{\\varepsilon}\\), so that \\(\\mu\\) is the positive real number with \\(\\left(\\frac{3}{4}\\right)^{\\mu}=\\varepsilon\\). If there is an index \\(n\\) such that \\(a_{n}>\\mu\\), then \\(M_{n} \\geqslant a_{n}>\\mu\\), and hence\n\\[\n\\frac{3^{a_{1}}+3^{a_{2}}+\\cdots+3^{a_{n}}}{\\left(2^{a_{1}}+2^{a_{2}}+\\cdots+2^{a_{n}}\\right)^{2}} \\leqslant\\left(\\frac{3}{4}\\right)^{M_{n}}<\\left(\\frac{3}{4}\\right)^{\\mu}=\\varepsilon\n\\]\n\nOtherwise we have \\(0<a_{i} \\leqslant \\mu\\) for all positive integers \\(i\\), so\n\\[\n\\frac{3^{a_{1}}+3^{a_{2}}+\\cdots+3^{a_{n}}}{\\left(2^{a_{1}}+2^{a_{2}}+\\cdots+2^{a_{n}}\\right)^{2}} \\leqslant \\frac{n \\cdot 3^{\\mu}}{(n \\cdot 1)^{2}}=\\frac{3^{\\mu}}{n}\n\\]\n\nIf \\(n>\\left\\lfloor\\frac{3^{\\mu}}{\\varepsilon}\\right\\rfloor\\), this is less than \\(\\varepsilon\\).\nComment. It is also possible to prove (2) by induction on \\(n\\). The base case \\(n=1\\) is clear. For the induction step, after ordering \\(a_{1}, a_{2}, \\ldots, a_{n}\\) in increasing order as \\(b_{1} \\leqslant b_{2} \\leqslant \\cdots \\leqslant b_{n}\\), it suffices, for example, to verify that\n\\[\n\\frac{3^{b_{1}}+3^{b_{2}}+\\cdots+3^{b_{n}}}{\\left(2^{b_{1}}+2^{b_{2}}+\\cdots+2^{b_{n}}\\right)^{2}} \\leqslant \\frac{3^{b_{1}}+3^{b_{2}}+\\cdots+3^{b_{n}}}{\\left(2^{b_{1}}+2^{b_{2}}+\\cdots+2^{b_{n}}\\right)\\left(2^{b_{2}}+\\cdots+2^{b_{n}}\\right)} \\leqslant \\frac{3^{b_{2}}+\\cdots+3^{b_{n}}}{\\left(2^{b_{2}}+\\cdots+2^{b_{n}}\\right)^{2}}\n\\]\n\nThe second inequality is equivalent to \\(3^{b_{1}} \\sum_{i=2}^{n} 2^{b_{i}} \\leqslant 2^{b_{1}} \\sum_{i=2}^{n} 3^{b_{i}}\\), which follows from \\(\\left(\\frac{3}{2}\\right)^{b_{1}} \\leqslant\\left(\\frac{3}{2}\\right)^{b_{i}}\\).\n\nSolution 2. We will combine two upper bounds.\nFirst, start with the trivial estimate\n\\[\n\\frac{3^{a_{1}}+\\cdots+3^{a_{n}}}{\\left(2^{a_{1}}+\\cdots+2^{a_{n}}\\right)^{2}} \\leqslant \\frac{3^{a_{1}}+\\cdots+3^{a_{n}}}{4^{a_{1}}+\\cdots+4^{a_{n}}}\n\\]\n\nBy applying Jensen's inequality to the convex function \\(x^{\\log _{3} 4}\\) we get\n\\[\n\\frac{4^{a_{1}}+\\cdots+4^{a_{n}}}{n}=\\frac{\\left(3^{a_{1}}\\right)^{\\log _{3} 4}+\\cdots+\\left(3^{a_{n}}\\right)^{\\log _{3} 4}}{n} \\geqslant\\left(\\frac{3^{a_{1}}+\\cdots+3^{a_{n}}}{n}\\right)^{\\log _{3} 4}\n\\]\nso\n\\[\n\\frac{3^{a_{1}}+\\cdots+3^{a_{n}}}{\\left(2^{a_{1}}+\\cdots+2^{a_{n}}\\right)^{2}} \\leqslant \\frac{3^{a_{1}}+\\cdots+3^{a_{n}}}{4^{a_{1}}+\\cdots+4^{a_{n}}} \\leqslant\\left(\\frac{n}{3^{a_{1}}+\\cdots+3^{a_{n}}}\\right)^{\\log _{3} 4-1}\n\\]\n\nHence, (1) holds true whenever\n\\[\n3^{a_{1}}+\\cdots+3^{a_{n}}>\\left(\\frac{1}{\\varepsilon}\\right)^{\\frac{1}{\\log _{3} 4-1}} \\cdot n\n\\]\n\nSecond, trivially\n\\[\n\\frac{3^{a_{1}}+\\cdots+3^{a_{n}}}{\\left(2^{a_{1}}+\\cdots+2^{a_{n}}\\right)^{2}} \\leqslant \\frac{3^{a_{1}}+\\cdots+3^{a_{n}}}{n^{2}}\n\\]\nso (1) is satisfied if\n\\[\n3^{a_{1}}+\\cdots+3^{a_{n}}<\\varepsilon \\cdot n^{2}\n\\]\n\nIf \\(n>\\left(\\frac{1}{\\varepsilon}\\right)^{1+\\frac{1}{\\log _{3} 4-1}}\\) then \\(\\left(\\frac{1}{\\varepsilon}\\right)^{\\frac{1}{\\log _{3} 4-1}} \\cdot n<\\varepsilon \\cdot n^{2}\\), and therefore at least one of (3) and (4) is satisfied.\n\nSolution 3. Define \\(C=\\log _{4 / 3} \\frac{2}{\\varepsilon}\\), so that if \\(a_{i}>C\\) then \\(3^{a_{i}}<\\frac{\\varepsilon}{2} \\cdot 4^{a_{i}}\\). We divide the sequence into \"small\" and \"large\" terms by how they compare to \\(C\\) : let\n\\[\n\\mathcal{S}_{n}=\\left\\{i \\leqslant n \\mid a_{i} \\leqslant C\\right\\} \\quad \\text { and } \\quad \\mathcal{L}_{n}=\\left\\{i \\leqslant n \\mid a_{i}>C\\right\\}\n\\]\n\nThen (1) is equivalent to\n\\[\n\\frac{\\sum_{i \\in \\mathcal{S}_{n}} 3^{a_{i}}}{\\left(\\sum_{i \\in \\mathcal{S}_{n}} 2^{a_{i}}+\\sum_{i \\in \\mathcal{L}_{n}} 2^{a_{i}}\\right)^{2}}+\\frac{\\sum_{i \\in \\mathcal{L}_{n}} 3^{a_{i}}}{\\left(\\sum_{i \\in \\mathcal{S}_{n}} 2^{a_{i}}+\\sum_{i \\in \\mathcal{L}_{n}} 2^{a_{i}}\\right)^{2}}<\\frac{\\varepsilon}{2}+\\frac{\\varepsilon}{2}\n\\]\n\nIf \\(\\mathcal{L}_{n}\\) is nonempty, we have\n\\[\n\\frac{\\sum_{i \\in \\mathcal{L}_{n}} 3^{a_{i}}}{\\left(\\sum_{i \\in \\mathcal{S}_{n}} 2^{a_{i}}+\\sum_{i \\in \\mathcal{L}_{n}} 2^{a_{i}}\\right)^{2}}<\\frac{\\varepsilon}{2} \\cdot \\frac{\\sum_{i \\in \\mathcal{L}_{n}} 4^{a_{i}}}{\\left(\\sum_{i \\in \\mathcal{L}_{n}} 2^{a_{i}}\\right)^{2}} \\leqslant \\frac{\\varepsilon}{2}\n\\]\nand this also trivially holds when \\(\\mathcal{L}_{n}\\) is empty (in which case the LHS is zero).\nNow suppose that \\(n \\geqslant \\frac{2}{\\varepsilon}\\left(\\frac{3}{2}\\right)^{C}\\). Note that \\(3^{a_{i}} \\leqslant\\left(\\frac{3}{2}\\right)^{C} 2^{a_{i}}\\) for \\(i \\in \\mathcal{S}_{n}\\), so we have\n\\[\n\\frac{\\sum_{i \\in \\mathcal{S}_{n}} 3^{a_{i}}}{\\left(\\sum_{i \\in \\mathcal{S}_{n}} 2^{a_{i}}+\\sum_{i \\in \\mathcal{L}_{n}} 2^{a_{i}}\\right)^{2}} \\leqslant \\frac{\\left(\\frac{3}{2}\\right)^{C} \\sum_{i \\in \\mathcal{S}_{n}} 2^{a_{i}}}{\\left(\\sum_{i \\in \\mathcal{S}_{n}} 2^{a_{i}}+\\sum_{i \\in \\mathcal{L}_{n}} 2^{a_{i}}\\right)^{2}} \\leqslant \\frac{\\left(\\frac{3}{2}\\right)^{C}}{\\sum_{i \\in \\mathcal{S}_{n}} 2^{a_{i}}+\\sum_{i \\in \\mathcal{L}_{n}} 2^{a_{i}}}<\\frac{\\left(\\frac{3}{2}\\right)^{C}}{n} \\leqslant \\frac{\\varepsilon}{2}\n\\]\nso we have (1).\n\nSolution 4. For every index \\(i=1,2, \\ldots, n\\), apply the weighted AM-GM inequality to numbers \\(2^{a_{i}}\\) and \\((n-1)\\) with weights \\(\\log _{2} \\frac{3}{2} \\approx 0.585\\) and \\(\\log _{2} \\frac{4}{3} \\approx 0.415\\) as\n\\[\n\\begin{gathered}\n2^{a_{1}}+2^{a_{2}}+\\cdots+2^{a_{n}} \\geqslant 2^{a_{i}}+(n-1) \\\\\n>\\log _{2} \\frac{3}{2} \\cdot 2^{a_{i}}+\\log _{2} \\frac{4}{3} \\cdot(n-1) \\geqslant\\left(2^{a_{i}}\\right)^{\\log _{2} \\frac{3}{2}} \\cdot(n-1)^{\\log _{2} \\frac{4}{3}} \\\\\n=\\left(\\frac{3}{2}\\right)^{a_{i}} \\cdot(n-1)^{\\log _{2} \\frac{4}{3}}>\\left(\\frac{3}{2}\\right)^{a_{i}} \\cdot(n-1)^{2 / 5}\n\\end{gathered}\n\\]\n\nBy summing up for \\(i=1,2, \\ldots, n\\),\n\\[\n\\left(2^{a_{1}}+\\cdots+2^{a_{n}}\\right)^{2}=\\sum_{i=1}^{n} 2^{a_{i}}\\left(2^{a_{1}}+2^{a_{2}}+\\cdots+2^{a_{n}}\\right)>(n-1)^{2 / 5} \\sum_{i=1}^{n} 3^{a_{i}}\n\\]\nso\n\\[\n\\frac{3^{a_{1}}+3^{a_{2}}+\\cdots+3^{a_{n}}}{\\left(2^{a_{1}}+2^{a_{2}}+\\cdots+2^{a_{n}}\\right)^{2}}<\\frac{1}{(n-1)^{2 / 5}}\n\\]\n\nIf \\(n \\geqslant\\left(\\frac{1}{\\varepsilon}\\right)^{5 / 2}+1\\) then \\(\\frac{1}{(n-1)^{2 / 5}}<\\varepsilon\\).", "source_pdf": "imosl_2024.pdf", "notes": "fallback-regex"}
{"id": "IMOSL-2024-A4", "contest": "IMOSL", "year": "2024", "problem_number": "A4", "problem": "Let \\(\\mathbb{Z}_{>0}\\) be the set of all positive integers. Determine all subsets \\(\\mathcal{S}\\) of \\(\\left\\{2^{0}, 2^{1}, 2^{2}, \\ldots\\right\\}\\) for which there exists a function \\(f: \\mathbb{Z}_{>0} \\rightarrow \\mathbb{Z}_{>0}\\) such that\n\\[\n\\mathcal{S}=\\left\\{f(a+b)-f(a)-f(b) \\mid a, b \\in \\mathbb{Z}_{>0}\\right\\} .\n\\]\n(Thailand)", "solution": "Answer: \\(\\mathcal{S}\\) can be any subset of size 1 or 2 .\nCommon remarks. For this problem, it is convenient to use notation such as \\(\\{a, b, c\\}\\) for multisets rather than sets, and the subset relation is likewise that for multisets. Both solutions use the following property of powers of 2 : if \\(2^{a}+2^{b}=2^{c}+2^{d}\\), then \\(\\{a, b\\}\\) and \\(\\{c, d\\}\\) are the same multiset. Define \\(e(a, b)=\\log _{2}(f(a+b)-f(a)-f(b))=e(b, a)\\). Thus,\n\\[\nf(a+b)=2^{e(a, b)}+f(a)+f(b) .\n\\]\n\n1. Clearly \\(\\mathcal{S}\\) must be nonempty. We start with constructions when \\(1 \\leqslant|\\mathcal{S}| \\leqslant 2\\).\n- If \\(\\mathcal{S}=\\left\\{2^{k}\\right\\}\\), then take \\(f(x)=c x-2^{k}\\) for any integer \\(c>2^{k}\\).\n- If \\(\\mathcal{S}=\\left\\{2^{k}, 2^{\\ell}\\right\\}\\) where \\(k>\\ell\\), then take \\(f(x)=\\left(2^{k}-2^{\\ell}\\right)\\lfloor\\alpha x\\rfloor-2^{\\ell}\\), where \\(\\alpha>2\\) is not an integer. This works because \\(\\lfloor\\alpha(x+y)\\rfloor-(\\lfloor\\alpha x\\rfloor+\\lfloor\\alpha y\\rfloor) \\in\\{0,1\\}\\) for all \\(x\\) and \\(y\\), and takes both values; the lower bound on \\(\\alpha\\) ensures the values of \\(f\\) are positive.\n\nObserve that, inductively,\n\\[\nf(n)=2^{e(1,1)}+2^{e(2,1)}+\\cdots+2^{e(n-1,1)}+n f(1) .\n\\]\n\nLemma 1. For any positive integers \\(n\\) and \\(k\\),\n\\[\n\\{e(1,1), e(2,1), \\ldots, e(k-1,1)\\} \\subset\\{e(n, 1), e(n+1,1), \\ldots, e(n+k-1,1)\\} .\n\\]\n\nProof. We work by induction on \\(k\\); in the case \\(k=1\\), the first multiset is empty, which provides our base case.\n\nFor the induction step, suppose \\(k \\geqslant 2\\) and we know that\n\\[\n\\{e(1,1), e(2,1), \\ldots, e(k-2,1)\\} \\subset\\{e(n, 1), e(n+1,1), \\ldots, e(n+k-2,1)\\} .\n\\]\n\nBy definition, \\(f(n+k)-f(n)-f(k)=2^{e(n, k)}\\), and using the first observation we see that\n\\(f(n+k)-f(n)-f(k)=\\left(2^{e(n, 1)}+2^{e(n+1,1)}+\\cdots 2^{e(n+k-1,1)}\\right)-\\left(2^{e(1,1)}+2^{e(2,1)}+\\cdots+2^{e(k-1,1)}\\right)\\).\nFrom the induction hypothesis, we may write\n\\[\n\\{e(n, 1), e(n+1,1), \\ldots, e(n+k-2,1)\\}=\\{e(1,1), e(2,1), \\ldots, e(k-2,1)\\} \\cup\\{a\\}\n\\]\nfor some \\(a\\). Thus\n\\[\n2^{e(n, k)}=2^{a}+2^{e(n+k-1,1)}-2^{e(k-1,1)} .\n\\]\n\nSo \\(\\{e(n, k), e(k-1,1)\\}=\\{a, e(n+k-1,1)\\}\\). Thus \\(e(k-1,1)=a\\) or \\(e(k-1,1)=e(n+k-1,1)\\), and in either case we have our result.\n\nLemma 2. The sequence \\(e(1,1), e(2,1), e(3,1), \\ldots\\) takes at most two different values.\n\nProof. Suppose for a contradiction that \\(k \\geqslant 2\\) is the least index with \\(e(k, 1) \\neq e(1,1)\\), and that some \\(\\ell>k\\) has \\(e(\\ell, 1) \\notin\\{e(k, 1), e(1,1)\\}\\). By Lemma 1 , any block of \\(k\\) consecutive values of the sequence has at least \\(k-1\\) values equal to \\(e(1,1)\\). This forces\n\\[\ne(\\ell-1,1)=e(\\ell-2,1)=\\cdots=e(\\ell-(k-1), 1)=e(1,1)\n\\]\nand\n\\[\ne(\\ell+1,1)=e(\\ell+2,1)=\\cdots=e(\\ell+(k-1), 1)=e(1,1) .\n\\]\n\nBut then the block \\(e(\\ell-1,1), e(\\ell, 1), e(\\ell+1,1), e(\\ell+2,1), \\ldots, e(\\ell+(k-1), 1)\\) has length \\(k+1\\) and does not contain \\(e(k, 1)\\), a contradiction.\n\nFinally, for any \\(a\\) and \\(b\\) we have\n\\[\n\\begin{aligned}\nf(a+b)-f(a)-f(b) & =\\left(2^{e(a, 1)}+2^{e(a+1,1)}+\\cdots 2^{e(a+b-1,1)}\\right)-\\left(2^{e(1,1)}+2^{e(2,1)}+\\cdots+2^{e(b-1,1)}\\right) \\\\\n& =2^{e(i, 1)}\n\\end{aligned}\n\\]\nfor some \\(a \\leqslant i \\leqslant a+b-1\\). So \\(|\\mathcal{S}| \\leqslant 2\\).\nComment. In the construction of functions, \\(\\alpha>2\\) is only necessary if \\(k=\\ell+1\\), to make sure \\(f(1) \\neq 0\\). Otherwise, any nonintegral \\(\\alpha>1\\) suffices.\n\nSolution 2. Subsets of size 1 or 2 can be achieved as in Solution 1, and \\(\\mathcal{S}\\) must be nonempty. We consider such a set \\(\\mathcal{S}\\) with \\(|\\mathcal{S}| \\geqslant 3\\) and a corresponding function \\(f\\) in order to achieve a contradiction. We will relate the \\(e(a, b)\\) to values of \\(e(c, 1)\\) with \\(c+1<a+b\\), leading to a proof of Lemma 2 from Solution 1 that does not depend on Lemma 1 from that solution.\n\nSuppose \\(a>1\\). We have \\(f(a+b)-f(a)-f(b)=2^{e(a, b)}\\) and also \\(f(a)-f(a-1)-f(1)= 2^{e(a-1,1)}\\), so\n\\[\nf(a+b)-f(a-1)-f(1)-f(b)=2^{e(a, b)}+2^{e(a-1,1)}\n\\]\n\nSimilarly, \\(f(a+b)-f(a-1)-f(b+1)=2^{e(a-1, b+1)}\\) and \\(f(b+1)-f(1)-f(b)=2^{e(b, 1)}\\), so\n\\[\nf(a+b)-f(a-1)-f(1)-f(b)=2^{e(a-1, b+1)}+2^{e(b, 1)} .\n\\]\n\nThus either\n\\[\ne(a, b)=e(a-1, b+1) \\quad \\text { and } \\quad e(a-1,1)=e(b, 1)\n\\]\nor\n\\[\ne(a, b)=e(b, 1) \\quad \\text { and } \\quad e(a-1, b+1)=e(a-1,1) .\n\\]\n\nFor \\(n \\geqslant 4\\), we consider these possibilities as ( \\(a, b\\) ) ranges over all pairs with \\(a+b=n\\). If the first case holds for every such pair (that is, if \\(e(c, 1)=e(d, 1)\\) for all \\(c+d=n-1)\\), then all the \\(e(a, b)\\) for \\(a+b=n\\) are equal (and the above equations do not constrain whether or not the value is the same as any \\(e(c, 1)\\) with \\(c+1<n\\) ). Otherwise, the values of \\(e(a, b)\\) with \\(a+b=n\\) are fully determined by the values of \\(e(c, 1)\\) for which \\(e(c, 1) \\neq e(n-1-c, 1)\\), and are not all equal.\n\nSpecifically, if \\(e(c, 1)=j\\) and \\(e(n-1-c, 1)=k\\) with \\(j \\neq k\\), we have \\(e(c, n-c)=j=e(n-c, c)\\) and \\(e(c+1, n-c-1)=k=e(n-c-1, c+1)\\). Every other value of \\(e(a, b)\\) with \\(a+b=n\\) is then determined by the rule that \\(e(a, b)=e(a-1, b+1)\\) if \\(e(a-1,1)=e(b, 1)\\) : if we have \\(e(c, 1) \\neq e(n-1-c, 1)\\), and \\(e\\left(c^{\\prime}, 1\\right) \\neq e\\left(n-1-c^{\\prime}, 1\\right)\\), but \\(e(d, 1)=e(n-1-d, 1)\\) for all \\(c<d<c^{\\prime}\\), then if \\(c<c^{\\prime}-1\\) we have \\(e\\left(c^{\\prime}-1, n-\\left(c^{\\prime}-1\\right)\\right)=e\\left(c^{\\prime}, n-c^{\\prime}\\right)\\), then if \\(c<c^{\\prime}-2\\) we have \\(e\\left(c^{\\prime}-2, n-\\left(c^{\\prime}-2\\right)\\right)=e\\left(c^{\\prime}-1, n-\\left(c^{\\prime}-1\\right)\\right)=e\\left(c^{\\prime}, n-c^{\\prime}\\right)\\), and so on until \\(e(c+1, n-c-1)=e\\left(c^{\\prime}, n-c^{\\prime}\\right)\\) (yielding a contradiction if \\(e(n-c-1,1) \\neq e\\left(c^{\\prime}, 1\\right)\\); such a contradiction also arises trivially if \\(c+1=c^{\\prime}\\) and \\(e(n-c-1,1) \\neq e\\left(c^{\\prime}, 1\\right)\\) ). If \\(c\\) is the least integer such that \\(e(c, 1) \\neq e(n-1-c, 1)\\), the values of \\(e(a, b)\\) with \\(a<c\\) are similarly determined to be equal to \\(e(c, n-c)\\) (and likewise for \\(a>n-c\\) ).\n\nIn other words, if we list the values in ascending order of \\(a\\) from 1 to \\(n-1\\), any gaps between the pairs of adjacent values determined when \\(e(c, 1) \\neq e(n-1-c, 1)\\) are filled with copies of the previously determined adjacent values, and if the values on either side of such a gap are different, we have a contradiction (including in the degenerate cases where the pairs are adjacent or overlap, if \\(c+1=c^{\\prime}\\) ). Note in particular that every value of \\(e(a, b)\\) is a value of \\(e(c, 1)\\) for some \\(c\\) with \\(c+1 \\leqslant a+b\\).\n\nIf \\(|\\mathcal{S}| \\geqslant 3\\), that means that \\(e(c, 1)\\) takes at least three different values. Let \\(m\\) be such that \\(e(m, 1)\\) does not equal any \\(e(c, 1)\\) for \\(c<m\\), and there are exactly two different values of \\(e(c, 1)\\) for \\(c<m\\) (and thus \\(m \\geqslant 3\\) ).\n\nBecause \\(e(m, 1)\\) does not equal any \\(e(c, 1)\\) for \\(c<m\\), we have that all \\(e(a, b)\\) for \\(a+b=m+1\\) are equal, and \\(e(c, 1)=e(d, 1)\\) for all \\(c+d=m\\). We now consider the values of \\(e(a, b)\\) for \\(a+b=m+2\\) determined by the above rules. Since \\(e(m, 1) \\neq e(1,1)\\), we have \\(e(1, m+1)=e(1,1)\\) and \\(e(2, m)=e(m, 1)\\). If there were any other \\(e(d, 1) \\neq e(m+1-d, 1)\\), consider the one with minimal \\(d>1\\); because \\(e(m, 1) \\neq e(d, 1)\\), we arrive at a contradiction. So every \\(e(c, 1)=e(d, 1)\\) for \\(c+d=m+1\\) except for \\(e(m, 1) \\neq e(1,1)\\). But these equalities form a path connecting all \\(e(c, 1)\\) for \\(c<m\\) :\n\\[\ne(1,1)=e(m-1,1)=e(2,1)=e(m-2,1)=e(3,1)=\\cdots\n\\]\nwhich contradicts the assumption we made that there were exactly two different values of \\(e(c, 1)\\) for \\(c<m\\).\n\nSolution 3. Constructions for \\(1 \\leqslant|\\mathcal{S}| \\leqslant 2\\) are shown in Solution 1, and \\(\\mathcal{S}\\) must be nonempty. We suppose \\(|\\mathcal{S}| \\geqslant 3\\) to derive a contradiction.\nClaim 1. \\(e(a, b), e(b, c)\\), and \\(e(a, c)\\) can take at most two different values.\nProof. By expanding \\(f(a+b+c)\\) in three different ways, we get\n\\[\n2^{e(a, b)}+2^{e(c, a+b)}=2^{e(b, c)}+2^{e(a, b+c)}=2^{e(a, c)}+2^{e(b, a+c)}\n\\]\n\nThe result follows from the equality of the three multisets of exponents.\nFor Claims 2 to 4 , we fix \\(k\\) and let \\(N\\) be the smallest integer such that \\(e(a, N-a+1)=k\\) for some \\(a \\leqslant N\\).\nClaim 2. For any \\(b\\) with \\(b \\leqslant N\\), we must have \\(e(b, N-b+1)=k\\).\nProof. Suppose that \\(e(a, N-a+1)=k\\) and \\(a<b\\). Expanding \\(f(a+(b-a)+N-b+1)\\) in two different ways, we see that\n\\[\n2^{e(a, b-a)}+2^{e(b, N-b+1)}=2^{e(N-b+1, b-a)}+2^{e(N-a+1, a)} .\n\\]\n\nBy the minimality of \\(N\\), we must have \\(e(b, N-b+1)=e(N-a+1, a)\\). The case of \\(a>b\\) follows by replacing \\(a\\) and \\(b\\) with \\(N-a+1\\) and \\(N-b+1\\).\nClaim 3. \\(e(a, 1)=e(N-a+1,1)\\) for any \\(a\\) satisfying \\(1<a<N\\).\nProof. By Claim 2, \\(e(a, N-a+1)=k\\). Then by Claim 1, \\(e(a, N-a+1), e(a, 1)\\), and \\(e(N-a+1,1)\\) can take at most two different values. But by the minimality of \\(N\\), we must have \\(e(a, N-a+1) \\neq e(a, 1)=e(N-a+1,1)\\).\nClaim 4. \\(e(a, 1)=e(N-a, 1)\\) for any \\(a\\) satisfying \\(1 \\leqslant a<N\\).\nProof. By Claim 2, \\(e(a, N-a+1)=e(a+1, N-a)=k\\). Expanding \\(f(1+a+(N-a))\\) in two different ways, we see that\n\\[\n2^{e(1, a)}+2^{e(a+1, N-a)}=2^{e(1, N-a)}+2^{e(N-a+1, a)} .\n\\]\n\nTherefore \\(e(1, a)=e(1, N-a)\\), as required.\nIf \\(|\\mathcal{S}| \\geqslant 3\\), then there exist \\(1<N_{k}<N_{\\ell}\\) where \\(N_{k}\\) and \\(N_{\\ell}\\) are the minimal values corresponding to \\(k\\) and \\(\\ell\\). But Claims 3 and 4 imply that \\(e(a, 1)\\) is constant for all \\(1 \\leqslant a<N_{\\ell}\\), which is a contradiction.", "source_pdf": "imosl_2024.pdf", "notes": "fallback-regex"}
{"id": "IMOSL-2024-A5", "contest": "IMOSL", "year": "2024", "problem_number": "A5", "problem": "Find all periodic sequences \\(a_{1}, a_{2}, \\ldots\\) of real numbers such that the following conditions hold for all \\(n \\geqslant 1\\) :\n\\[\na_{n+2}+a_{n}^{2}=a_{n}+a_{n+1}^{2} \\quad \\text { and } \\quad\\left|a_{n+1}-a_{n}\\right| \\leqslant 1 .\n\\]\n(Kosovo)", "solution": "Answer: The sequences satisfying the conditions of the problem are:\n\\[\n\\begin{aligned}\n& c,-c, c,-c, \\ldots, \\\\\n& d, d, d, d, \\ldots,\n\\end{aligned}\n\\]\nwhere \\(c \\in\\left[-\\frac{1}{2}, \\frac{1}{2}\\right]\\) and \\(d\\) is any real number.\n\n1. We rewrite the first condition as\n\\[\na_{n+2}+a_{n+1}=\\left(a_{n+1}+a_{n}\\right)\\left(a_{n+1}-a_{n}+1\\right) .\n\\]\n\nIf there exists a positive integer \\(m\\) such that \\(a_{m+1}+a_{m}=0\\), then from equation (1) we have \\(a_{n+1}+a_{n}=0\\) for all positive integers \\(n \\geqslant m\\). By the fact that the sequence ( \\(a_{i+1}+a_{i}\\) ) is periodic, we get \\(a_{i+1}+a_{i}=0\\) for every positive integer \\(i\\). Thus the sequence ( \\(a_{i}\\) ) is of the form \\(c,-c, c,-c, \\ldots\\) for some \\(|c| \\leqslant \\frac{1}{2}\\).\n\nNow suppose that \\(a_{n+1}+a_{n} \\neq 0\\) for every positive integer \\(n\\). Let \\(T\\) be the period of the sequence. From equation (1) we have\n\\[\n1=\\prod_{i=1}^{T} \\frac{a_{i+2}+a_{i+1}}{a_{i+1}+a_{i}}=\\prod_{i=1}^{T}\\left(a_{i+1}-a_{i}+1\\right) .\n\\]\n\nCombining with the second condition \\(\\left|a_{i+1}-a_{i}\\right| \\leqslant 1\\), we have \\(a_{i+1}-a_{i}+1>0\\). Using the AM-GM inequality we get\n\\[\n1=\\prod_{i=1}^{T}\\left(a_{i+1}-a_{i}+1\\right) \\leqslant\\left(\\frac{\\sum_{i=1}^{T}\\left(a_{i+1}-a_{i}+1\\right)}{T}\\right)^{T}=1 .\n\\]\n\nSo the equality holds, and thus we get\n\\[\na_{2}-a_{1}=a_{3}-a_{2}=\\cdots=a_{T+1}-a_{T}\n\\]\nwhich means that \\(\\left(a_{i}\\right)\\) is a constant sequence.\nSo all sequences satisfying the conditions of the problem are those listed above.\n\nSolution 2. Define \\(s_{n}=a_{n+1}+a_{n}\\) and \\(d_{n}=a_{n+1}-a_{n}\\), so the original sequence is periodic if and only if both these sequences are periodic. Rearranging the given conditions yields \\(s_{n+1}= s_{n}\\left(1+d_{n}\\right)\\) and \\(d_{n+1}=d_{n}\\left(s_{n}-1\\right)\\), with \\(\\left|d_{n}\\right| \\leqslant 1\\) for all \\(n\\).\n\nIf \\(s_{n}=0\\) for some \\(n\\) then \\(s_{i}=0\\) for all \\(i \\geqslant n\\), and for the sequence to be periodic we must have all \\(s_{i}=0\\) and the sequence \\(c,-c, c,-c, \\ldots\\), for some \\(|c| \\leqslant \\frac{1}{2}\\). Similarly, if \\(d_{n}=0\\) for some \\(n\\) and the sequence is periodic, then all \\(d_{i}=0\\) and the sequence is \\(c, c, c, \\ldots\\).\n\nWe claim those are the only periodic sequences, so suppose for contradiction that we have a periodic sequence where no \\(s_{i}\\) or \\(d_{i}\\) is 0 . Under this hypothesis, we will prove that \\(\\left(s_{n}\\right),\\left(d_{n}\\right)\\) have the following properties.\n1. All \\(s_{n}\\) are positive numbers. As \\(\\left|d_{n}\\right| \\leqslant 1\\) and \\(s_{n+1}=s_{n}\\left(1+d_{n}\\right) \\neq 0\\), it follows that \\(d_{n}>-1\\) and that all \\(s_{n}\\) have the same sign (all positive or all negative). If all \\(s_{n}\\) are negative, then \\(\\left|d_{n+1}\\right|=\\left|d_{n}\\left(s_{n}-1\\right)\\right|>\\left|d_{n}\\right|\\), so \\(\\left|d_{i}\\right|\\) is a strictly increasing sequence, contradicting periodicity.\n2. Whenever \\(d_{n}>0\\) we have \\(0<s_{n}<1\\). Suppose for contradiction that we have \\(d_{n}>0\\) and \\(s_{n} \\geqslant 1\\) for some \\(n\\). Since \\(d_{n+1} \\neq 0\\) we have \\(s_{n}>1\\), and then \\(d_{n+1}>0, s_{n+1}>s_{n}>1\\). Inductively, all \\(d_{i}>0\\) for \\(i \\geqslant n\\), and \\(s_{i+1}>s_{i}\\) for \\(i \\geqslant n\\), contradicting periodicity.\n\nNow we can get the desired contraction as follows. Suppose that the period of ( \\(a_{i}\\) ) is \\(T\\), then \\(\\sum_{i=1}^{T} d_{i}=a_{T+1}-a_{1}=0\\), hence there is an \\(n\\) such that \\(d_{n}>0\\). By property 2 we get \\(0<s_{n}<1\\), and in particular \\(s_{n}<2\\). Suppose that we have \\(s_{i}<2\\). If \\(d_{i}<0\\), then \\(s_{i+1}=s_{i}\\left(1+d_{i}\\right)<s_{i}<2\\); if \\(d_{i}>0\\), then by property 2 we have \\(0<s_{i}<1\\), and then \\(s_{i+1}=s_{i}\\left(1+d_{i}\\right) \\leqslant 2 s_{i}<2\\). In both cases we get \\(s_{i+1}<2\\), and then by induction we get \\(s_{k}<2\\) for all \\(k \\geqslant n\\). But then we have \\(\\left|d_{k+1}\\right|=\\left|d_{k}\\left(s_{k}-1\\right)\\right|<\\left|d_{k}\\right|\\), which contradicts the fact that ( \\(d_{k}\\) ) is periodic.\n\nSo the only periodic sequences are the two listed above.\nSolution 3. Note that if \\(a_{n+1}=-a_{n}\\) for any \\(n\\), then \\(a_{n+2}=a_{n}=-a_{n+1}\\), yielding the first answer by periodicity. Also, if \\(a_{n+1}=a_{n}\\) for any \\(n\\), then \\(a_{n+2}=a_{n}=a_{n+1}\\), yielding the second answer by periodicity. If \\(a_{n+2}=a_{n}\\) for any \\(n\\), then \\(a_{n}^{2}=a_{n+1}^{2}\\) so \\(a_{n+1}= \\pm a_{n}\\) and one of those two cases applies. Henceforth, we will assume that the sequence is neither one of the answers and \\(a_{n} \\neq a_{n+1},-a_{n+1}, a_{n+2}\\) for all \\(n\\) for the rest of the solution. Note that the recursion rearranges to\n\\[\na_{n+2}-a_{n+1}=\\left(a_{n+1}^{2}-a_{n+1}\\right)-\\left(a_{n}^{2}-a_{n}\\right)=\\left(a_{n+1}-a_{n}\\right)\\left(a_{n+1}+a_{n}-1\\right) .\n\\]\n\nClaim 1. We have that \\(a_{n} \\leqslant \\frac{1}{2}\\) for all \\(n\\).\nProof. First, we cannot have \\(a_{n}>\\frac{1}{2}\\) for all \\(n\\). Otherwise, \\(a_{n+1}+a_{n}-1\\) is positive for all \\(n\\), so (2) implies that \\(a_{n+2}-a_{n+1}\\) has the same sign as \\(a_{n+1}-a_{n}\\) for all \\(n\\). This would mean that the sequence is monotonic, contradicting periodicity.\n\nOn the other hand, if \\(a_{n+1} \\leqslant \\frac{1}{2}\\) and \\(a_{n+2}>\\frac{1}{2}\\), then\n\\[\na_{n+1}^{2}=a_{n+2}+a_{n}^{2}-a_{n} \\geqslant a_{n+2}-\\frac{1}{4}>\\frac{1}{4} \\Longrightarrow\\left|a_{n+1}\\right|>\\frac{1}{2}\n\\]\nwhere we use the fact that \\(t^{2}-t \\geqslant-\\frac{1}{4}\\) for all \\(t \\in \\mathbb{R}\\). As \\(a_{n+1} \\leqslant \\frac{1}{2}\\), this means that \\(a_{n+1}<-\\frac{1}{2}\\) so \\(\\left|a_{n+1}-a_{n+2}\\right|>1\\), a contradiction.\n\nThe identity (2) now implies that \\(a_{n+2}-a_{n+1}\\) and \\(a_{n+1}-a_{n}\\) are of opposite signs for all \\(n\\), so that \\(a_{n}<a_{n+1} \\Longleftrightarrow a_{n+1}>a_{n+2}\\).\nClaim 2. We have that \\(a_{n}>0 \\Longleftrightarrow a_{n+1} \\leqslant 0\\) : that is, the signs of the sequence are alternating.\n\nProof. First, it cannot be the case that \\(a_{n}>0\\) for all \\(n\\). Indeed, then we would have from Claim 1 that \\(\\left|a_{n+1}+a_{n}-1\\right|<1\\) for all \\(n\\), which by (2) means that \\(\\left|a_{n+1}-a_{n}\\right|\\) is strictly decreasing in \\(n\\), a contradiction of the sequence's periodicity. It also cannot be the case that \\(a_{n} \\leqslant 0\\) for all \\(n\\), as then we would have that \\(\\left|a_{n+1}+a_{n}-1\\right|>1\\) for all \\(n\\) (noting that by the nonconstant assumption we will never have \\(a_{n}=a_{n+1}=0\\) ) so \\(\\left|a_{n+1}-a_{n}\\right|\\) is strictly increasing in \\(n\\).\n\nHence, if the signs of \\(a_{n}\\) are not alternating, then by periodicity there exists \\(n\\) with \\(a_{n}>0\\) and \\(a_{n+1}, a_{n+2} \\leqslant 0\\) or \\(a_{n}, a_{n+1}>0\\) and \\(a_{n+2} \\leqslant 0\\). In either scenario, we have that\n\\[\na_{n}^{2}-a_{n}=a_{n+1}^{2}-a_{n+2} \\geqslant a_{n+1}^{2} \\geqslant 0 \\Longrightarrow a_{n}>1\n\\]\nas \\(a_{n}\\) is positive and \\(a_{n+2}\\) is nonpositive.\nIn the former case, we have that \\(a_{n}-a_{n+1}>1\\), a contradiction. In the latter case, as \\(a_{n+1}>a_{n+2}\\), we must have that \\(a_{n}<a_{n+1}\\). But then we have that \\(a_{n+1}-a_{n+2}>a_{n}-a_{n+2}>1\\), a contradiction.\n\nNote now that we cannot have \\(a_{n+2}>-a_{n+1}>a_{n}\\) for any \\(n\\), as we would then have\n\\[\na_{n+1}^{2}-a_{n}^{2}=a_{n+2}-a_{n}>-a_{n+1}-a_{n}>0 \\Longrightarrow a_{n}-a_{n+1}>1,\n\\]\na contradiction. Similarly, we cannot have \\(a_{n}>-a_{n+1}>a_{n+2}\\) for any \\(n\\), as we would then have\n\\[\na_{n}^{2}-a_{n+1}^{2}=a_{n}-a_{n+2}>a_{n}+a_{n+1}>0 \\Longrightarrow a_{n}-a_{n+1}>1 .\n\\]\n\nHaving ruled out these scenarios, we may conclude that \\(\\left|a_{n+1}\\right|\\) is not between \\(\\left|a_{n}\\right|\\) and \\(\\left|a_{n+2}\\right|\\) for any \\(n\\).\n\nLet \\(k\\) be an index such that \\(\\left|a_{k}\\right|\\) is maximal. Note that we cannot have \\(\\left|a_{k-2}\\right|=\\left|a_{k}\\right|\\), as that would imply that \\(a_{k-2}=a_{k}\\) by Claim 2. We also cannot have \\(\\left|a_{k-2}\\right| \\leqslant\\left|a_{k-1}\\right|\\), as that would imply that \\(\\left|a_{k-1}\\right|\\) is between \\(\\left|a_{k-2}\\right|\\) and \\(\\left|a_{k}\\right|\\). Hence, we must have that \\(\\left|a_{k-1}\\right|<\\left|a_{k-2}\\right|<\\left|a_{k}\\right|\\). As \\(\\left|a_{k}\\right|\\) is maximal, we cannot have \\(a_{k}=0\\). If \\(a_{k}>0\\), then we have that \\(a_{k}-a_{k-2}=a_{k-1}^{2}-a_{k-2}^{2}<0\\), a contradiction. If \\(a_{k}<0\\), then we have that \\(a_{k}-a_{k+2}=a_{k}^{2}-a_{k+1}^{2}>0\\), a contradiction.", "source_pdf": "imosl_2024.pdf", "notes": "fallback-regex"}
{"id": "IMOSL-2024-A6", "contest": "IMOSL", "year": "2024", "problem_number": "A6", "problem": "Let \\(a_{0}, a_{1}, a_{2}, \\ldots\\) be an infinite strictly increasing sequence of positive integers such that for each \\(n \\geqslant 1\\) we have\n\\[\na_{n} \\in\\left\\{\\frac{a_{n-1}+a_{n+1}}{2}, \\sqrt{a_{n-1} \\cdot a_{n+1}}\\right\\}\n\\]\n\nLet \\(b_{1}, b_{2}, \\ldots\\) be an infinite sequence of letters defined as\n\\[\nb_{n}= \\begin{cases}A, & \\text { if } a_{n}=\\frac{1}{2}\\left(a_{n-1}+a_{n+1}\\right) \\\\ G, & \\text { otherwise }\\end{cases}\n\\]\n\nProve that there exist positive integers \\(n_{0}\\) and \\(d\\) such that for all \\(n \\geqslant n_{0}\\) we have \\(b_{n+d}=b_{n}\\).\n(Czech Republic)\nCommon remarks. In fact, all known proofs proceed by showing that the eventual period of the sequence ( \\(b_{n}\\) ) always consists of some number of occurrences of \\(G\\) (possibly zero) followed by an \\(A\\).\n\nSuch sequences of any period \\(p \\geqslant 1\\) exist. Indeed, consider the sequence\n\\[\n\\ldots, k^{p}, k^{p-1}(k+1), \\ldots, k(k+1)^{p-1},(k+1)^{p},(k+1)^{p-1}(k+2), \\ldots\n\\]\n\nThe Tournament of the Towns, in Spring 2009 (Junior A-Level Paper, problem 4), considered sequences satisfying exactly this fairly natural criterion. However, it asked a vastly easier question about them: in the language of this problem, it asked whether every such sequence had ( \\(b_{n}\\) ) eventually constant. The", "solution": "answer to that problem is \"no\", as heavily hinted by the statement of this problem. Thus, at least so far as the Problem Selection Committee knows, this is a novel problem about a family of sequences which has been previously considered.\n\n1. We will show that the eventual period of sequence \\(\\left(b_{n}\\right)\\) consists of any fixed number of occurrences of \\(G\\) (possibly zero) followed by a single \\(A\\).\n\nWe look at the ratios of consecutive terms of the sequence \\(\\left(a_{n}\\right)\\). Let \\(C\\) and \\(D\\) be coprime positive integers such that \\(a_{1} / a_{0}=(C+D) / C\\). If \\(b_{n}=G\\) then \\(a_{n} / a_{n-1}=a_{n+1} / a_{n}\\). If \\(b_{n}=A\\) and \\(a_{n} / a_{n-1}=(C+k D) /(C+(k-1) D)\\) for some positive integer \\(k\\) then\n\\[\n\\frac{a_{n+1}}{a_{n}}=\\frac{2 a_{n}-a_{n-1}}{a_{n}}=\\frac{C+(k+1) D}{C+k D} .\n\\]\n\nThus, by induction, there is a sequence of positive integers \\(\\left(k_{n}\\right)\\) for \\(n \\geqslant 1\\) which satisfies \\(a_{n} / a_{n-1}=\\left(C+k_{n} D\\right) /\\left(C+\\left(k_{n}-1\\right) D\\right)\\) for all positive integers \\(n\\). Moreover, we have \\(k_{1}=1\\) and\n\\[\nk_{n+1}= \\begin{cases}k_{n}, & \\text { if } b_{n}=G \\\\ k_{n}+1, & \\text { if } b_{n}=A\\end{cases}\n\\]\n\nIf there are only finitely many values of \\(n\\) such that \\(b_{n}=A\\) then the problem statement obviously holds (we can choose \\(d=1\\) ). Thus, we may assume that \\(b_{n}=A\\) for infinitely many \\(n\\). This means that the sequence ( \\(k_{n}\\) ) attains all positive integer values. Given a value \\(q \\geqslant 1\\), denote by \\(m_{q}\\) the last index where value \\(q\\) occurs, that is, the index such that \\(k_{m_{q}}=q\\) and \\(k_{m_{q}+1}=q+1\\).\n\nOur aim is to prove that the sequence of differences ( \\(m_{q+1}-m_{q}\\) ) is eventually constant. We first show that it is bounded above. To that end, fix \\(t \\geqslant 1\\) (we will choose a suitably large \\(t\\) later on) and consider a sequence \\(s(t)_{0}, s(t)_{1}, \\ldots\\) defined for \\(q \\geqslant 1\\) by \\(s(t)_{q}=a_{m_{q}} /(C+q D)^{t}\\).\n\nWe note two properties of \\(s(t)_{q}\\). First, simple algebra gives\n\\[\n\\begin{aligned}\ns(t)_{q+1}=\\frac{a_{m_{q+1}}}{(C+(q+1) D)^{t}}=\\frac{a_{m_{q}}}{(C+(q+1) D)^{t}}\\left(\\frac{C+(q+1) D}{C+q D}\\right)^{m_{q+1}-m_{q}} \\\\\n\\quad=\\frac{a_{m_{q}}}{(C+q D)^{t}}\\left(\\frac{C+(q+1) D}{C+q D}\\right)^{m_{q+1}-m_{q}-t}=s(t)_{q}\\left(\\frac{C+(q+1) D}{C+q D}\\right)^{m_{q+1}-m_{q}-t} .\n\\end{aligned}\n\\]\n\nIt follows that\n\\[\n\\left.\\begin{array}{l}\ns(t)_{q}>s(t)_{q+1} \\\\\ns(t)_{q}=s(t)_{q+1} \\\\\ns(t)_{q}<s(t)_{q+1}\n\\end{array}\\right\\} \\quad \\text { if and only if } \\quad\\left\\{\\begin{array}{l}\nm_{q+1}-m_{q}<t, \\\\\nm_{q+1}-m_{q}=t, \\\\\nm_{q+1}-m_{q}>t .\n\\end{array}\\right.\n\\]\n\nSecond, suppose that \\(m_{q+1}-m_{q} \\geqslant t\\) for some positive integer \\(q\\). We claim that in that case \\(s(t)_{q}\\) is a positive integer. Indeed, we have\n\\[\na_{m_{q}+t}=a_{m_{q}}\\left(\\frac{C+(q+1) D}{C+q D}\\right)^{t},\n\\]\nbecause \\(k_{m_{q}+1}=k_{m_{q}+2}=\\cdots=k_{m_{q}+t}=q+1\\). Since \\(C+(q+1) D\\) and \\(C+q D\\) are coprime we have that\n\\[\ns(t)_{q}=\\frac{a_{m_{q}}}{(C+q D)^{t}}\n\\]\nis an integer.\nWe choose \\(T \\geqslant 1\\) such that \\(s(T)_{1}<1\\) (which exists since \\(C+D>1\\) ). Then, by induction we can show that \\(s(T)_{q}<1\\) for all \\(q\\). Indeed, since \\(s(T)_{q}<1\\), it is not a positive integer; this means that \\(m_{q+1}-m_{q}<T\\) by the second property above. Hence by the first property above we have \\(s(T)_{q+1}<s(T)_{q}<1\\), as needed.\n\nThis means that \\(m_{q+1}-m_{q}<T\\) for all \\(q\\). Thus there is a largest integer \\(T^{\\prime} \\leqslant T\\) with the property that an equality \\(m_{q+1}-m_{q}=T^{\\prime}\\) holds for infinitely many values of \\(q\\).\n\nTherefore, for all sufficiently large values of \\(q\\) we have the inequality \\(m_{q+1}-m_{q} \\leqslant T^{\\prime}\\), which by the first property implies that the sequence \\(s\\left(T^{\\prime}\\right)\\) is decreasing from some point on. Moreover, we know that the sequence attains infinitely many integer values since there are infinitely many values of \\(q\\) for which we have the equality \\(m_{q+1}-m_{q}=T^{\\prime}\\). As a consequence, the sequence \\(s\\left(T^{\\prime}\\right)\\) is constant from some sufficiently large index \\(Q\\) onwards.\n\nThis in turn means that the equality \\(m_{q+1}-m_{q}=T^{\\prime}\\) holds for all \\(q \\geqslant Q\\). Note that \\(b_{n}=A\\) is equivalent to the fact that \\(n=m_{q}\\) for some integer \\(q\\). Thus, the sequence ( \\(b_{n}\\) ) is periodic for \\(n \\geqslant Q\\) with period \\(T^{\\prime}\\), and the proof is complete.\n\nSolution 2. First, observe that the statement holds immediately if \\(b_{n}=G\\) for all \\(n\\); otherwise, there must be some \\(n\\) for which \\(b_{n}=A\\). Without loss of generality, we may assume that \\(n=1\\), as we can translate the sequence without affecting the statement.\n\nWe define an arithmetic sequence \\(\\left(p_{n}\\right)\\) by taking \\(p_{0}=a_{0} / \\operatorname{gcd}\\left(a_{0}, a_{1}\\right)\\) and \\(p_{1}=a_{1} / \\operatorname{gcd}\\left(a_{0}, a_{1}\\right)\\). Note that \\(p_{0}<p_{1}\\), and hence that ( \\(p_{n}\\) ) is an increasing sequence of positive integers, and also that \\(p_{2}=a_{2} / \\operatorname{gcd}\\left(a_{0}, a_{1}\\right)\\).\n\nWe also define a sequence of positive integers \\(d_{n}=a_{n}-a_{n-1}\\) and a sequence of positive rational numbers \\(q_{n}=a_{n} / a_{n-1}\\).\n\nThen the following facts are immediate consequences of the definitions:\n- if \\(b_{n}=G\\), then \\(q_{n+1}=q_{n}\\) and \\(d_{n+1}=d_{n} q_{n}\\);\n- if \\(b_{n}=A\\), then \\(d_{n+1}=d_{n}\\);\n- \\(q_{1}=p_{1} / p_{0}\\);\n- if \\(b_{n}=A\\) and \\(q_{n}=p_{i} / p_{i-1}\\), then \\(q_{n+1}=p_{i+1} / p_{i}\\).\n\nNow, let \\(k_{i}\\) be the number of integers \\(n\\) for which \\(b_{n}=G\\) and \\(q_{n}=p_{i} / p_{i-1}\\). If some \\(k_{i}\\) is infinite then \\(b_{n}\\) is eventually always \\(G\\); otherwise, all values of \\(k_{i}\\) are nonnegative integers.\n\nThe sequence of values for \\(d_{n}\\) can be written as\n\\[\nd_{0}, d_{0} \\frac{p_{1}}{p_{0}}, \\ldots, d_{0}\\left(\\frac{p_{1}}{p_{0}}\\right)^{k_{1}}, d_{0}\\left(\\frac{p_{1}}{p_{0}}\\right)^{k_{1}} \\frac{p_{2}}{p_{1}}, \\ldots, d_{0}\\left(\\frac{p_{1}}{p_{0}}\\right)^{k_{1}}\\left(\\frac{p_{2}}{p_{1}}\\right)^{k_{2}}, \\ldots\n\\]\nand in particular all terms in this sequence are positive integers. Furthermore, \\(p_{i}\\) and \\(p_{i+1}\\) are coprime for all \\(i\\), so the following sequence consists entirely of positive integers:\n\\[\n\\begin{aligned}\nu_{0} & =d_{0} p_{0}^{-k_{1}} \\\\\nu_{1} & =d_{0} p_{0}^{-k_{1}} p_{1}^{k_{1}-k_{2}} \\\\\nu_{2} & =d_{0} p_{0}^{-k_{1}} p_{1}^{k_{1}-k_{2}} p_{2}^{k_{2}-k_{3}} \\\\\n& \\vdots\n\\end{aligned}\n\\]\n\nWe will prove that \\(k_{i}\\) is eventually constant, which implies that the sequence of \\(b_{n}\\) is eventually periodic with period consisting of \\(k\\) copies of \\(G\\) followed by an \\(A\\) (where \\(k\\) is that constant value).\n\nObserve that either \\(k_{i}\\) is unbounded, or is bounded with eventual maximum \\(k\\) for some constant \\(k\\). In the second case, let \\(r_{0}\\) be minimal such that \\(k_{r_{0}}=k\\); in the first case let \\(r_{0}=0\\). We will construct an infinite sequence of integers as follows:\n- If \\(k_{r_{i}+1} \\geqslant k_{r_{i}}\\), then \\(r_{i+1}=r_{i}+1\\)\n- If \\(k_{r_{i}+1}<k_{r_{i}}\\), then \\(r_{i+1}\\) is the minimal positive integer greater than \\(r_{i}\\) such that \\(k_{r_{i+1}} \\geqslant k_{r_{i}}\\). Observe that in the second case, such an \\(r_{i+1}\\) must exist by our construction of \\(r_{0}\\).\n\nWe claim that \\(u_{r_{i+1}} \\leqslant u_{r_{i}}\\) with equality only if \\(k_{r_{i}+1}=k_{r_{i}}\\) (so \\(r_{i+1}=r_{i}+1\\) ). Indeed, if \\(k_{r_{i}+1} \\geqslant k_{r_{i}}\\) then\n\\[\nu_{r_{i+1}}=u_{r_{i}+1}=u_{r_{i}} p_{r_{i}}^{k_{r_{i}}-k_{r_{i}+1}} \\leqslant u_{r_{i}}\n\\]\nwith equality if and only if \\(k_{r_{i}}=k_{r_{i}+1}\\).\nOtherwise, we have\n\\[\n\\frac{u_{r_{i+1}}}{u_{r_{i}}}=p_{r_{i}}^{k_{r_{i}}-k_{r_{i}+1}} p_{r_{i}+1}^{k_{r_{i}+1}-k_{r_{i}+2}} \\cdots p_{r_{i+1}-1}^{k_{r_{i+1}-1}-k_{r_{i+1}}}\n\\]\nso we just need to show that the right hand side is strictly less than 1 . But this follows because\n\\[\n\\begin{aligned}\np_{r_{i}}^{k_{r_{i}}-k_{r_{i}+1}} p_{r_{i}+1}^{k_{r_{i}+1}-k_{r_{i}+2}} \\cdots p_{r_{i+1}-1}^{k_{r_{i+1}-1}-k_{r_{i+1}}} & <p_{r_{i}+1}^{k_{r_{i}}-k_{r_{i}+2}} p_{r_{i}+2}^{k_{r_{i}+2}-k_{r_{i}+3}} \\cdots p_{r_{i+1}-1}^{k_{r_{i+1}-1}-k_{r_{i+1}}} \\\\\n& <p_{r_{i}+2}^{k_{r_{i}}-k_{r_{i}+3}} p_{r_{i}+3}^{k_{r_{i}+3}-k_{r_{i}+4}} \\cdots p_{r_{i+1}-1}^{k_{i_{i}-1}-k_{r_{i+1}}} \\\\\n& \\vdots \\\\\n& <p_{r_{i+1}-1}^{k_{r_{i}-k_{r_{i+1}}}} \\\\\n& \\leqslant 1\n\\end{aligned}\n\\]\nwhere each inequality besides the last follows from the fact that \\(p_{j}<p_{j+1}\\) and \\(k_{r_{i}}>k_{j}\\) for \\(j<r_{i+1}\\), and the last follows from the fact that \\(k_{r_{i}} \\leqslant k_{r_{i+1}}\\).\n\nFinally, the sequence \\(u_{r_{i}}\\) is an infinite nonincreasing sequence of positive integers so must eventually be constant, yielding the claim.\n\nComment. The two solutions above differ in approach, but have some overlap in the structure they reveal. Indeed, the \\(C+n D\\) of Solution 1 is the \\(p_{n}\\) of Solution 2, while the \\(m_{r+1}-m_{r}\\) of Solution 1 turns out to be equal to the \\(k_{r}\\) of Solution 2.", "source_pdf": "imosl_2024.pdf", "notes": "fallback-regex"}
{"id": "IMOSL-2024-A8", "contest": "IMOSL", "year": "2024", "problem_number": "A8", "problem": "Let \\(p \\neq q\\) be coprime positive integers. Determine all infinite sequences \\(a_{1}, a_{2}, \\ldots\\) of positive integers such that the following conditions hold for all \\(n \\geqslant 1\\) :\n\\[\n\\begin{aligned}\n& \\max \\left(a_{n}, a_{n+1}, \\ldots, a_{n+p}\\right)-\\min \\left(a_{n}, a_{n+1}, \\ldots, a_{n+p}\\right)=p \\quad \\text { and } \\\\\n& \\max \\left(a_{n}, a_{n+1}, \\ldots, a_{n+q}\\right)-\\min \\left(a_{n}, a_{n+1}, \\ldots, a_{n+q}\\right)=q .\n\\end{aligned}\n\\]\n(Japan)", "solution": "Answer: The only such sequences are \\(a_{n}=n+C\\), where \\(C\\) is a nonnegative integer.\n\n\\section*{Common remarks.}\n- Denote by \\(a_{[i, j]}\\) the subsequence \\(a_{i}, a_{i+1}, \\ldots, a_{j}\\).\n- Without loss of generality, in each\n\nwe suppose \\(p<q\\). It can be convenient to treat the case where \\(p=1\\) separately.\n- The problem can also be posed for sequences of arbitrary integers (rather than positive). Refer to the comment after Solution 1 for a proof.\n\nSolution 1. Let \\(k=\\left\\lceil\\frac{q}{p}\\right\\rceil\\). Note that \\(k \\geqslant 2\\).\nLemma 1. If \\(i, j\\) and \\(m\\) are positive integers such that \\(|i-j| \\leqslant m p\\) then \\(\\left|a_{i}-a_{j}\\right| \\leqslant m p\\).\nProof. By the given condition, if \\(|i-j| \\leqslant p\\) then \\(\\left|a_{i}-a_{j}\\right| \\leqslant p\\). So the lemma follows from induction on \\(m\\) and the triangle inequality.\nLemma 2. For a fixed \\(n\\), suppose that \\(a_{i}\\) is minimal over \\(i \\geqslant n\\). Then \\(i \\leqslant n+p-1\\).\nProof. Suppose for contradiction that \\(i \\geqslant n+p\\). Then \\(\\min \\left(a_{[i-p, i+q-p]}\\right)=a_{i}\\). Since \\(q-p \\leqslant (k-1) p\\), it follows from Lemma 1 that \\(\\max \\left(a_{[i-p, i+q-p]}\\right) \\leqslant a_{i}+(k-1) p<a_{i}+q\\), which is a contradiction.\n\nLemma 3. For a fixed \\(n>q\\), suppose that \\(a_{i}\\) is maximal over \\(i \\leqslant n\\). Then \\(i \\geqslant n-p+1\\).\nProof. Suppose \\(a_{j}\\) is minimal over \\(j \\geqslant n-q\\). Then by Lemma \\(2, j \\leqslant n-q+p-1\\). So \\(\\min \\left(a_{[n-q, n]}\\right)=a_{j}\\) and \\(a_{i} \\geqslant \\max \\left(a_{[n-q, n]}\\right)\\), which implies that \\(a_{i} \\geqslant a_{j}+q\\).\n\nLemma 2 also implies that if \\(j \\geqslant n\\) then \\(a_{j} \\geqslant \\min \\left(a_{[n, n+p]}\\right)\\). So if \\(i<j\\), then we have \\(a_{j} \\geqslant a_{i}-p\\), which contradicts \\(a_{i} \\geqslant a_{j}+q\\). Hence we must have \\(i>j\\).\n\nThe above inequality also gives \\(\\left|a_{i}-a_{j}\\right| \\geqslant q>(k-1) p\\), so by Lemma 1 it follows that \\(|i-j|>(k-1) p\\). Therefore \\(i>j+(k-1) p \\geqslant n-q+(k-1) p \\geqslant n-p+1\\).\n\nLet \\(b_{n}\\) be the minimal value of \\(a_{i}\\) for \\(i \\geqslant n\\). By Lemma \\(2, b_{n+p}>b_{n}\\) for all \\(n\\). Hence \\(b_{n}=\\min \\left(a_{[n, n+p]}\\right)=\\min \\left(a_{[n, n+q]}\\right)\\). Let \\(c_{n}\\) be the maximal value of \\(a_{i}\\) for \\(i \\leqslant n\\). By Lemma 3, \\(c_{n-p}>c_{n}\\) for all \\(n>q\\). Hence \\(c_{n}=\\max \\left(a_{[n-p, n]}\\right)=\\max \\left(a_{[n-q, n]}\\right)\\) for \\(n>q\\).\n\nSo if \\(n>q\\) then \\(b_{n}=c_{n+p}-p=c_{n+q}-q\\). So for \\(n>q\\) we get \\(b_{n+q-p}+p=c_{n+q}=b_{n}+q\\), and hence \\(b_{n+q-p}=b_{n}+q-p\\).\n\nNext note that \\(b_{n+p} \\leqslant a_{n+p} \\leqslant b_{n}+p\\). So \\(b_{n+p}-b_{n} \\leqslant p\\) for all \\(n>q\\), and iterating this \\((q-p)\\) times gives \\(b_{n+p(q-p)}-b_{n} \\leqslant p(q-p)\\). But using \\(b_{n+q-p}=b_{n}+q-p\\) gives \\(b_{n+p(q-p)}-b_{n}=p(q-p)\\). Since equality occurs, we must have \\(b_{n+p}=b_{n}+p\\).\n\nSo for \\(n>q, b_{n+p}=b_{n}+p\\) and \\(b_{n+q-p}=b_{n}+q-p\\). Since \\(p\\) and \\(q-p\\) are coprime, \\(b_{n+1}=b_{n}+1\\) for all \\(n>q\\). The only way for \\(b_{n}\\) and \\(b_{n+1}\\) to be different is if \\(b_{n}=a_{n}\\), so we deduce that \\(a_{n+1}=a_{n}+1\\) and there is a constant \\(C\\) such that \\(a_{n}=n+C\\) for all \\(n>q\\).\n\nFinally, suppose \\(a_{n}=n+C\\) for all \\(n \\geqslant N\\). Then \\(p=\\max \\left(a_{N-1}, N+C+p-1\\right)- \\min \\left(a_{N-1}, N+C\\right)\\). So \\(a_{N-1}=N+C+p\\) or \\(N+C-1\\). Similarly, \\(a_{N-1}=N+C+q\\) or \\(N+C-1\\). Hence \\(a_{N-1}=N+C-1\\). So, by induction, we have \\(a_{n}=n+C\\) for all positive integers \\(n\\). Since \\(a_{1} \\geqslant 1, C\\) is a nonnegative integer.\n\nIt is trivial to check that \\(a_{n}=n+C\\) satisfies the given condition.\n\nComment. Here is a variant of Solution 1. Proceed up to proving \\(b_{n}-n\\) is eventually periodic with period \\(q-p\\). Then there is some minimal value of \\(b_{n}-n\\). Suppose \\(n\\) attains this minimal value. Since \\(b_{n+p}-n-p \\leqslant b_{n}-n, n+p\\) also attains this minimal value. And since \\(p\\) and \\(q-p\\) are coprime, all \\(n \\geqslant q\\) must attain this minimal value. Hence \\(b_{n+1}=b_{n}+1\\) for all \\(n \\geqslant q\\). Finish as above.\n\nComment. It is also possible to solve the problem using a weaker version of Lemma 2 and without Lemma 3. For example, the following lemma plays a similar role.\nLemma 2'. Let \\(b_{n}^{\\prime}=\\min \\left(a_{[n, n+p]}\\right)\\). Then \\(b_{n}^{\\prime}<b_{n+p}^{\\prime}\\).\nComment. To solve the problem for sequences \\(a_{n}\\) of arbitrary integers, we will use the following lemma.\nLemma 4. The sequence \\(a_{n}\\) is either bounded above or bounded below.\nProof. Suppose that \\(a_{n}\\) is unbounded above and below. Then there is some \\(i\\) such that \\(a_{i}<a_{1}-p\\). There is also some \\(j\\) such that \\(a_{j}>\\max \\left(a_{[1, i]}\\right)+q\\). Now let \\(a_{l}\\) be minimal amongst \\(a_{[1, j]}\\). Since \\(a_{l} \\leqslant a_{i}, a_{l}<a_{1}-p\\) and \\(a_{l}<a_{j}-k p\\). By Lemma \\(1,1+p<l<j-k p\\). So \\(\\min \\left(a_{[l-p, l+q-p]}\\right)=a_{l}\\). By Lemma 1 again, \\(\\max \\left(a_{[l-p, l+q-p]}\\right) \\leqslant a_{l}+(k-1) p<a_{l}+q\\), which is a contradiction.\n\nFrom there, the solution above can be adapted to prove that \\(a_{n}=n+C\\) for all \\(n\\) or \\(a_{n}=-n+C\\) for all \\(n\\), where \\(C\\) can be any constant integer.\n\nSolution 2. For \\(n, x \\geqslant 1\\), let the \\(x\\)-width of \\(n\\) be \\(\\max \\left(a_{[n, n+x]}\\right)-\\min \\left(a_{[n, n+x]}\\right)\\). We call a positive integer \\(x\\) good if the \\(x\\)-width of \\(n\\) is less than or equal to \\(x\\) for all sufficiently large \\(n\\), and we call \\(x\\) very good if the \\(x\\)-width of \\(n\\) is equal to \\(x\\) for sufficiently large \\(n\\).\nLemma 1. If \\(p^{\\prime}\\) is good and \\(q^{\\prime}\\) is very good with \\(p^{\\prime}<q^{\\prime}<2 p^{\\prime}\\), then \\(2 p^{\\prime}-q^{\\prime}\\) is also good.\nProof. Note that \\(0<q^{\\prime}-p^{\\prime}<p^{\\prime}<q^{\\prime}\\). Let \\(n\\) be a sufficiently large positive integer. Then for \\(k \\in\\left[n+q^{\\prime}-p^{\\prime}, n+p^{\\prime}\\right]\\), we have \\(a_{k} \\geqslant \\max \\left(a_{\\left[n, n+p^{\\prime}\\right]}\\right)-p^{\\prime}\\) and \\(a_{k} \\geqslant \\max \\left(a_{\\left[n+q^{\\prime}-p^{\\prime}, n+q^{\\prime}\\right]}\\right)-p^{\\prime}\\) since \\(p^{\\prime}\\) is good, which shows \\(a_{k} \\geqslant \\max \\left(a_{\\left[n, n+q^{\\prime}\\right]}\\right)-p^{\\prime}\\). Similarly we get \\(a_{k} \\leqslant \\min \\left(a_{\\left[n, n+q^{\\prime}\\right]}\\right)+p^{\\prime}\\).\n\nTherefore, for all \\(k \\in\\left[n+q^{\\prime}-p^{\\prime}, n+p^{\\prime}\\right]\\) we have \\(a_{k} \\in\\left[\\max \\left(a_{\\left[n, n+q^{\\prime}\\right]}\\right)-p^{\\prime}, \\min \\left(a_{\\left[n, n+q^{\\prime}\\right]}\\right)+p^{\\prime}\\right]\\). Thus, the \\(\\left(2 p^{\\prime}-q^{\\prime}\\right)\\)-width of \\(n+q^{\\prime}-p^{\\prime}\\) is at most \\(\\left(\\min \\left(a_{\\left[n, n+q^{\\prime}\\right]}\\right)+p^{\\prime}\\right)-\\left(\\max \\left(a_{\\left[n, n+q^{\\prime}\\right]}\\right)-p^{\\prime}\\right)= 2 p^{\\prime}-q^{\\prime}\\). The lemma follows.\nLemma 2. Let \\(p^{\\prime}\\) be a good number and \\(q^{\\prime}\\) a very good number with \\(p^{\\prime}<q^{\\prime}\\). For sufficiently large \\(n\\), take \\(s, t \\in\\left[n, n+q^{\\prime}\\right]\\) such that \\(\\min \\left(a_{\\left[n, n+q^{\\prime}\\right]}\\right)=a_{s}\\) and \\(\\max \\left(a_{\\left[n, n+q^{\\prime}\\right]}\\right)=a_{t}\\). Then \\(s \\in\\left[n, n+p^{\\prime}\\right]\\) and \\(t \\in\\left[n+q^{\\prime}-p^{\\prime}, n+q^{\\prime}\\right]\\).\nProof. Lemma 2 and Lemma 3 from Solution 1 hold with \\(p\\) and \\(q\\) replaced by \\(p^{\\prime}\\) and \\(q^{\\prime}\\) by similar arguments. We can deduce the statement about \\(s\\) from Lemma 2 of Solution 1. We can deduce the statement about \\(t\\) from Lemma 3 of Solution 1.\n\nLemma 3. If \\(p^{\\prime}\\) is good and \\(q^{\\prime}\\) is very good with \\(2 p^{\\prime}<q^{\\prime}\\), then there exists a positive integer \\(r\\) such that for all sufficiently large \\(n\\), we have \\(a_{n+r}-a_{n} \\geqslant r\\).\nProof. Let \\(r=q^{\\prime}-2 p^{\\prime}\\), and let \\(s\\) and \\(t\\) be as defined in Lemma 2 . Then consider the identity\n\\[\n\\left(a_{t}-a_{n+q^{\\prime}-p^{\\prime}}\\right)+\\left(a_{n+p^{\\prime}+r}-a_{n+p^{\\prime}}\\right)+\\left(a_{n+p^{\\prime}}-a_{s}\\right)=a_{t}-a_{s}=q^{\\prime}\n\\]\n\nBy Lemma 2, we have \\(s \\in\\left[n, n+p^{\\prime}\\right]\\) and \\(t \\in\\left[n+q^{\\prime}-p^{\\prime}, n+q^{\\prime}\\right]\\), so \\(a_{n+p^{\\prime}}-s \\leqslant p^{\\prime}\\) and \\(a_{t}-a_{n+q^{\\prime}-p^{\\prime}} \\leqslant p^{\\prime}\\). Combining these, we get \\(a_{n+p^{\\prime}+r}-a_{n+p^{\\prime}} \\geqslant q^{\\prime}-2 p^{\\prime}=r\\). This proves that \\(a_{n+r}-a_{n} \\geqslant r\\) for sufficiently large \\(n\\).\nLemma 4. Suppose \\((p, q) \\neq(1,2)\\). Then there exists a good number \\(p^{\\prime}\\) such that \\(2 p^{\\prime}<q\\).\nProof. Let \\(p^{\\prime}\\) be the smallest good positive integer. Note that \\(p\\) is good, so \\(p^{\\prime}\\) exists and is less than \\(q\\).\n\nSuppose for contradiction that \\(2 p^{\\prime} \\geqslant q\\). If \\(2 p^{\\prime}>q\\), then by Lemma \\(1,2 p^{\\prime}-q\\) is a good number strictly less than \\(p^{\\prime}\\), which contradicts minimality of \\(p^{\\prime}\\). If \\(2 p^{\\prime}=q\\), then \\(p^{\\prime}<p<2 p^{\\prime}\\). So we can apply Lemma 1 with \\(q_{0}=p\\) to get that \\(2 p^{\\prime}-p\\) is a good number that is strictly less than \\(p^{\\prime}\\), which again contradicts minimality.\n\nIf \\((p, q)=(1,2)\\) then the problem is easily solved. Otherwise, Lemmas 3 and 4 combined give us some \\(r>0\\) such that \\(a_{n+r}-a_{n} \\geqslant r\\) for \\(n\\) sufficiently large.\n\nBy iterating, we get \\(a_{n+p r}-a_{n} \\geqslant p r\\) for all sufficiently large \\(n\\), and hence it follows that \\(a_{n+p}-a_{n}=p\\). Similarly we get \\(a_{n+q}-a_{n}=q\\). As \\(p\\) and \\(q\\) are coprime, we deduce that \\(a_{n+1}-a_{n}=1\\) for sufficiently large \\(n\\). Thus we get \\(a_{n}=n+C\\) for sufficiently large \\(n\\), and we can conclude by the same argument as Solution 1.\n\n\\section*{Combinatorics}", "source_pdf": "imosl_2024.pdf", "notes": "fallback-regex"}
{"id": "IMOSL-2024-C1", "contest": "IMOSL", "year": "2024", "problem_number": "C1", "problem": "Let \\(n\\) be a positive integer. A class of \\(n\\) students run \\(n\\) races, in each of which they are ranked with no draws. A student is eligible for a rating ( \\(a, b\\) ) for positive integers \\(a\\) and \\(b\\) if they come in the top \\(b\\) places in at least \\(a\\) of the races. Their final score is the maximum possible value of \\(a-b\\) across all ratings for which they are eligible.\n\nFind the maximum possible sum of all the scores of the \\(n\\) students.\n(Australia)", "solution": "Answer: The maximum possible sum is \\(\\frac{n(n-1)}{2}\\).\n\n1. The answer can be achieved by the students finishing in the same order in every race. To show that this is the maximum, we will apply a series of modifications to the results of the races, each of which does not decrease the total score, such that after \\(k\\) such modifications the first \\(k\\) positions are the same in every race. Say that a student is scored on the \\(b^{\\text {th }}\\) place if their score is \\(a-b\\) because they came in the top \\(b\\) places in \\(a\\) of the races and \\(b\\) is minimal with this property for that student.\n\nSupposing that the first \\(k-1\\) positions are the same in every race, look at the students scored on the \\(k^{\\text {th }}\\) place. If there are no such students, let \\(\\ell>k\\) be minimal such that some student \\(S\\) is scored on the \\(\\ell^{\\text {th }}\\) place. Then, in every race where \\(S\\) appears in any place from the \\(k^{\\text {th }}\\) through the \\(\\ell^{\\text {th }}\\) inclusive (of which there must be at least \\(\\ell\\), otherwise \\(S\\) would achieve a higher rating of 0 based on the \\(n^{\\text {th }}\\) place), reorder the students in places \\(k\\) through \\(\\ell\\) so that \\(S\\) finishes in the \\(k^{\\text {th }}\\) place instead (and otherwise the ordering of those students is arbitrary). Now \\(S\\) is scored on the \\(k^{\\text {th }}\\) place, their score has gone up by \\(\\ell-k\\) and no other scores have gone down (some might have gone up as well).\n\nNow we know that the first \\(k-1\\) positions are the same in every race and at least one student is scored on the \\(k^{\\text {th }}\\) place. Pick one such student \\(S\\). In each race where \\(S\\) finishes behind the \\(k^{\\text {th }}\\) place, swap them with the student \\(T\\) who finishes in the \\(k^{\\text {th }}\\) place, leaving the positions of all other students unchanged. Each such swap increases the score of \\(S\\) by 1 and decreases the score of \\(T\\) by at most 1 , so such swaps do not decrease the total score. At the end of this process, the first \\(k\\) positions are the same in every race and the total score has not decreased.\n\nRepeating this \\(n\\) times yields the required result.\nComment. The following simpler approach to modifying results of races is tempting: find pairs of students \\(S\\) and \\(T\\) who are scored on places \\(k\\) and \\(\\ell\\) respectively, where \\(k<\\ell\\), but where \\(S\\) finishes after \\(T\\) in some race, and swap the positions of those two students in that race so they finish in the same order as the places they are scored on. However, such a swap can decrease the total score; for example, suppose that \\(k=1\\) and \\(\\ell=4\\), and in some race \\(S\\) finishes \\(6^{\\text {th }}\\) and \\(T\\) finishes \\(3^{\\text {rd }}\\); then swapping those students reduces the number of races contributing to \\(T\\) 's score without increasing the number contributing to \\(S\\) 's score.\n\nSolution 2. The answer can be achieved by having the same ranking for all \\(n\\) races.\nNote that taking \\(a=b=n\\) shows each student has a nonnegative score. Consider a student who has race ranks \\(r_{1}, r_{2}, \\ldots, r_{n}\\) and a final score of \\(s\\). We first prove that\n\\[\n\\sum_{i} r_{i} \\leqslant n(n-s) .\n\\]\n\nWithout loss of generality, suppose that \\(r_{1} \\leqslant r_{2} \\leqslant \\cdots \\leqslant r_{n}\\). There must exist some \\(k\\) with \\(s+1 \\leqslant k \\leqslant n\\) and \\(k-r_{k}=s\\). In order to maximise \\(\\sum_{i} r_{i}\\) while retaining the score of \\(s\\), we can\nreplace each of \\(r_{1}, \\ldots, r_{k-1}\\) by \\(r_{k}\\), and replace each of \\(r_{k+1}, \\ldots, r_{n}\\) by \\(n\\). Then the sum is\n\\[\n\\sum_{i} r_{i} \\leqslant k r_{k}+(n-k) n=n^{2}-k\\left(n-r_{k}\\right)=n^{2}-k(n+s-k) \\leqslant n^{2}-s_{n}\n\\]\n\nThe final inequality follows from the fact that given \\(s+1 \\leqslant k \\leqslant n\\), the quantity \\(k(n+s-k)\\) is minimised when \\(k=n\\).\n\nThe sum of ranks of all students across all races is \\(\\frac{n^{2}(n+1)}{2}\\). If the total of all student scores is \\(t\\), then (1) implies\n\\[\n\\frac{n^{2}(n+1)}{2} \\leqslant n^{3}-t n\n\\]\n\nThis rearranges to \\(t \\leqslant \\frac{n(n-1)}{2}\\), as required.\nSolution 3. In each race, assign the student in the \\(k^{\\text {th }}\\) place a weight of \\(1-\\frac{k}{n}\\). If a student finishes in the top \\(b\\) places in at least \\(a\\) of the races, the total of their weights is at least \\(a\\left(1-\\frac{b}{n}\\right)=a-b\\left(\\frac{a}{n}\\right) \\geqslant a-b\\). Thus the sum of a student's weights across all races is at least their score, and so the sum of all weights for all students across all races is at least the sum of all the scores of all students. The sum of weights in each race is \\(\\frac{n-1}{2}\\), so the sum of all weights across all races is \\(\\frac{n(n-1)}{2}\\). Equality is achieved if and only if, for each student, the values of \\(b\\) and \\(a\\) determining that student's score have \\(a=n\\) and they finish in exactly the \\(b^{\\text {th }}\\) place in all \\(n\\) races; that is, if the students are ranked the same in every race.\n\nSolution 4. Given a positive integer \\(b(S)\\) for each student \\(S\\), define \\(a_{b}(S)\\) to be the number of races in which \\(S\\) finished in the top \\(b(S)\\) places, and define \\(\\operatorname{score}_{b}(S)=a_{b}(S)-b(S)\\); for a race \\(r\\), let \\(I_{b}(S, r)\\) be 1 if \\(S\\) finished in the top \\(b(S)\\) places in race \\(r\\) and 0 otherwise, so\n\\[\na_{b}(S)=\\sum_{r} I_{b}(S, r)\n\\]\n\nThen the problem asks for the maximum across all possible results of the races of\n\\[\n\\max _{b} \\sum_{S} \\operatorname{score}_{b}(S)=\\max _{b}\\left(\\sum_{r} \\sum_{S} I_{b}(S, r)-\\sum_{S} b(S)\\right) .\n\\]\n\nGiven \\(b\\), the sum \\(\\sum_{S} I_{b}(S, r)\\) is maximised (not necessarily uniquely) for some choice of the rankings in race \\(r\\), which is the same choice for every race. So the maximum possible sum of the scores of all the students occurs when all students are ranked the same in all races, which yields the given answer.", "source_pdf": "imosl_2024.pdf", "notes": "fallback-regex"}
{"id": "IMOSL-2024-C2", "contest": "IMOSL", "year": "2024", "problem_number": "C2", "problem": "Let \\(n\\) be a positive integer. The integers \\(1,2,3, \\ldots, n^{2}\\) are to be written in the cells of an \\(n \\times n\\) board such that each integer is written in exactly one cell and each cell contains exactly one integer. For every integer \\(d\\) with \\(d \\mid n\\), the \\(d\\)-division of the board is the division of the board into \\((n / d)^{2}\\) nonoverlapping sub-boards, each of size \\(d \\times d\\), such that each cell is contained in exactly one \\(d \\times d\\) sub-board.\n\nWe say that \\(n\\) is a cool number if the integers can be written on the \\(n \\times n\\) board such that, for each integer \\(d\\) with \\(d \\mid n\\) and \\(1<d<n\\), in the \\(d\\)-division of the board, the sum of the integers written in each \\(d \\times d\\) sub-board is not a multiple of \\(d\\).\n\nDetermine all even cool numbers.\n(T\u00fcrkiye)", "solution": "Answer: The even cool numbers are \\(n=2^{k}\\) where \\(k\\) is a positive integer.\n\n. We first show by induction that \\(n=2^{k}\\) is a cool number. The base case of \\(n=2\\) is trivial as there is no such \\(d\\).\n\nFor induction, assume that \\(2^{k}\\) is a cool number. We construct a numbering of a \\(2^{k+1} \\times 2^{k+1}\\) board that satisfies the conditions.\n\nTake the \\(2^{k+1} \\times 2^{k+1}\\) board and divide it into four \\(2^{k} \\times 2^{k}\\) sub-boards. By assumption, there is some numbering \\(P\\) of a \\(2^{k} \\times 2^{k}\\) board that satisfies the required condition; we write down the numbering \\(P\\) in each sub-board. Next, add \\(2^{2 k}\\) to every number in the second sub-board, add \\(2 \\times 2^{2 k}\\) to every number in the third sub-board, and add \\(3 \\times 2^{2 k}\\) to every number in the fourth sub-board. Then the numbers in the cells of the \\(2^{k+1} \\times 2^{k+1}\\) board are the numbers 1 to \\(2^{2(k+1)}\\).\n\nNow locate \\(2^{2 k}\\) from the first sub-board, and swap it with \\(2^{2 k}+2^{k-1}\\) from the second subboard. Locate \\(3 \\times 2^{2 k}\\) from the third sub-board, and swap it with \\(3 \\times 2^{2 k}+2^{k-1}\\) from the fourth sub-board.\n\nWe claim that this numbering of the \\(2^{k+1} \\times 2^{k+1}\\) board satisfies the required conditions. For any \\(d=2^{i}\\) where \\(i<k\\), consider any \\(2^{i} \\times 2^{i}\\) sub-board. The sum of its cells modulo \\(2^{i}\\) is not changed in the addition step or the swapping step, so the sum is congruent modulo \\(2^{i}\\) to the sum of the corresponding \\(2^{i} \\times 2^{i}\\) sub-board in \\(P\\), which is nonzero, as required.\n\nIn the case of \\(d=2^{k}\\), we can directly evaluate the sum of the \\((b+1)^{\\text {th }}\\) sub-board for \\(b \\in\\{0,1,2,3\\}\\). The sum is given by\n\\[\n2^{2 k-1}\\left(1+2^{2 k}\\right)+b 2^{4 k}+(-1)^{b} 2^{k-1} \\equiv 2^{k-1} \\quad\\left(\\bmod 2^{k}\\right)\n\\]\n\nTherefore all sub-boards satisfy the required conditions and so \\(2^{k+1}\\) is a cool number, completing the induction.\n\nIt remains to show that no other even number is a cool number. Let \\(n=2^{s} m\\) where \\(s\\) is a positive integer and \\(m\\) is an odd integer greater than 1 . For the sake of contradiction, suppose that there is a numbering of the \\(n \\times n\\) board satisfying the required conditions.\nClaim. In the \\(2^{i}\\)-division of the board, where \\(1 \\leqslant i \\leqslant s\\), the sum of numbers in each \\(2^{i} \\times 2^{i}\\) sub-board is congruent to \\(2^{i-1}\\) modulo \\(2^{i}\\).\n\nProof. We prove the claim by induction on \\(i\\). The base case of \\(i=1\\) holds as the sum of numbers in each \\(2 \\times 2\\) sub-board must be odd. Next, suppose the claim is true for \\(2^{i}\\). In the \\(2^{i+1}\\)-division, each \\(2^{i+1} \\times 2^{i+1}\\) sub-board is made up of four \\(2^{i} \\times 2^{i}\\) sub-boards, each with a sum congruent to \\(2^{i-1}\\) modulo \\(2^{i}\\). Hence the sum of each \\(2^{i+1} \\times 2^{i+1}\\) sub-board is a multiple of \\(2^{i}\\). It cannot be a multiple of \\(2^{i+1}\\) because of the conditions, which means it must be congruent to \\(2^{i}\\) modulo \\(2^{i+1}\\). This proves the claim.\n\nBack to the problem, since \\(m\\) is odd, summing up the \\(m^{2}\\) sums of \\(2^{s} \\times 2^{s}\\) sub-boards gives\n\\[\n2^{s-1} m^{2} \\equiv 2^{s-1} \\quad\\left(\\bmod 2^{s}\\right)\n\\]\n\nHowever, the sum of the numbers from 1 to \\(n^{2}\\) is\n\\[\n\\frac{n^{2}\\left(n^{2}+1\\right)}{2}=2^{2 s-1} m^{2}\\left(2^{2 s} m^{2}+1\\right) \\equiv 0 \\quad\\left(\\bmod 2^{s}\\right)\n\\]\n\nThis is a contradiction. Therefore \\(n\\) is not a cool number.\nComment. In the case of odd \\(n\\), similar arguments show that prime powers are cool numbers. If the definition of cool numbers additionally requires that all \\(d \\times d\\) sub-boards in the \\(d\\)-division have the same nonzero residue modulo \\(d\\), then the cool numbers are precisely the prime powers.", "source_pdf": "imosl_2024.pdf", "notes": "fallback-regex"}
{"id": "IMOSL-2024-C3", "contest": "IMOSL", "year": "2024", "problem_number": "C3", "problem": "Let \\(n\\) be a positive integer. There are \\(2 n\\) knights sitting at a round table. They consist of \\(n\\) pairs of partners, each pair of which wishes to shake hands. A pair can shake hands only when next to each other. Every minute, one pair of adjacent knights swaps places.\n\nFind the minimum number of exchanges of adjacent knights such that, regardless of the initial arrangement, every knight can meet her partner and shake hands at some time.\n(Belarus)", "solution": "Answer: The minimum number of exchanges is \\(\\frac{n(n-1)}{2}\\).\n\nCommon remarks. The\n\nis divided into three lemmas. We provide multiple proofs of each lemma.\n\nSolution. Join each pair of knights with a chord across the table. We'll refer to these chords as chains.\n\nFirst we show that \\(n(n-1) / 2\\) exchanges are required for some arrangements.\nLemma 1. If each knight is initially sitting directly opposite her partner, then at least \\(n(n-1) / 2\\) exchanges are required for all knights to meet and shake hands with their partners.\n\nProof 1. In this arrangement any two chains are initially intersecting. For two knights to be adjacent to each other, it is necessary that their chain does not cross any other chain, and thus every pair of chains must be uncrossed at some time. Each exchange of adjacent knights can only uncross a single pair of intersecting chains, and thus the number of exchanges required is at least the number of pairs of chains, which is \\(n(n-1) / 2\\).\n\nProof 2. In this arrangement the two knights in each pair are initially separated by \\(n-1\\) seats in either direction around the table, and so each pair must move a total of at least \\(n-1\\) steps so as to be adjacent. There are \\(n\\) pairs, and each exchange moves two knights by a single step. Hence at least \\(n(n-1) / 2\\) moves are required.\n\nWe will now prove that \\(n(n-1) / 2\\) exchanges is sufficient in all cases. We'll prove a stronger version of this bound than is required, namely that every knight can shake hands with her partner at the end, after all exchanges have finished.\n\nBegin by adding a pillar at the centre of the table. For each chain that passes through the centre of the table, we arbitrarily choose one side of the chain and say that the pillar lies on that side of the chain. While the pillar may lie on a chain, we will never move a knight if that causes the pillar to cross to the other side of a chain. Say that a chain passes in front of a knight if it passes between that knight and the pillar, and define the length of a chain to be the number of knights it passes in front of. Then each chain has a length between 0 and \\(n-1\\) inclusive.\n\nSay that a chain \\(C\\) encloses another chain \\(C^{\\prime}\\) if \\(C\\) and \\(C^{\\prime}\\) do not cross, and \\(C\\) passes between \\(C^{\\prime}\\) and the pillar. Say that two chains are intersecting if they cross on the table; enclosing if one chain encloses the other; and disjoint otherwise. Let \\(k, l\\) and \\(m\\) denote respectively the number of enclosing, intersecting and disjoint pairs of chains. Then we have\n\\[\nk+l+m=\\frac{n(n-1)}{2}\n\\]\n\nLemma 2. \\(2 k+l\\) exchanges are sufficient to reach a position with all pairs of knights sitting adjacent to each other.\nProof 1. We proceed by induction on \\(2 k+l\\).\nIf every chain has length 0 , then every pair of knights is adjacent and the statement is trivial.\n\nOtherwise, let \\(A\\) and \\(B\\) be a pair of knights whose chain \\(C_{0}\\) has length \\(q \\geqslant 1\\). Let \\(S_{0}=A\\), and let \\(S_{1}, \\ldots, S_{q}\\) be the knights which \\(C_{0}\\) passes in front of, sitting in that order from \\(A\\) to \\(B\\). We know that \\(C_{0}\\) passes in front of \\(S_{1}\\), and there are three cases for the chain \\(C_{1}\\) for knight \\(S_{1}\\).\n\nIf \\(C_{1}\\) passes in front of \\(S_{0}\\) then \\(C_{0}\\) and \\(C_{1}\\) are intersecting, and we can make them disjoint by exchanging the positions of \\(S_{0}\\) and \\(S_{1}\\). This reduces the sum \\(2 k+l\\) by 1 .\n\nIf \\(C_{1}\\) passes in front of neither \\(S_{0}\\) nor \\(B\\) then \\(C_{1}\\) is enclosed by \\(C_{0}\\), and we can swap \\(S_{0}\\) and \\(S_{1}\\) to make \\(C_{0}\\) and \\(C_{1}\\) an intersecting pair. This increases \\(l\\) by 1 and decreases \\(k\\) by 1 , and hence reduces the sum \\(2 k+l\\) by 1 .\n\nIf this \\(C_{1}\\) passes in front of \\(B\\) then we cannot immediately find a beneficial exchange.\nIn the third case, we look instead at the knights \\(S_{i}\\) and \\(S_{i+1}\\), for each \\(i\\) in turn. Each time, we will either find a beneficial exchange, or find that the chain \\(C_{i+1}\\) for knight \\(S_{i+1}\\) passes in front of \\(B\\). Eventually we will either find a beneficial exchange in one of the first two cases above, or we will find that the chain \\(C_{q}\\) for \\(S_{q}\\) passes in front of \\(B\\), in which case \\(C_{q}\\) and \\(C_{0}\\) are intersecting and we can make \\(C_{q}\\) and \\(C_{0}\\) disjoint by swapping \\(S_{q}\\) and \\(B\\).\n\nAlso note that the only times a chain is increased in length is when it is enclosed by another chain. But this cannot happen for a chain containing the pillar, so no chains ever cross the pillar.\n\nProof 2. We begin by ignoring the seats, and let each knight walk freely to a predetermined destination. Each pair of knights will walk around the table to one of the two points on the circumference midway between their initial locations, such that the chain between them passes between the pillar and the destination. If more than one pair of knights would have the same destination point, then we make small adjustments to the destination points so that each pair has a distinct destination point.\n\nWe then imagine each knight walking at a constant speed (which may be different for each knight). They all start and stop walking at the same time. We want to count how many times two knights pass (either in opposite directions, or in the same direction but at different speeds). For any two pairs of knights, the number of passes depends on the relation between their two chains.\n\nIf their two chains are intersecting then there will be one pass, involving the two knights for whom the other chain passes between them and the pillar.\n\nIf their two chains are enclosing then there will be two passes, with one of the knights with the enclosing chain passing both of the knights with the shorter enclosed chain.\n\nIf their two chains are disjoint then there will be no passes.\nThe number of passes is therefore \\(2 k+l\\). If multiple pairs of knights would pass at the same time, we can slightly adjust the walking speeds so that the passes happen at distinct times. We can then convert this sequence of passes into a sequence of seat exchanges in the original problem, which shows that \\(2 k+l\\) exchanges is sufficient.\n\n\\section*{Lemma 3. \\(k \\leqslant m\\).}\n\nProof 1. We proceed by induction on \\(n\\). The base case \\(n=2\\) is clear.\nConsider a chain \\(C\\) of greatest length, and suppose it joins knights \\(A\\) and \\(B\\). Let \\(x\\) be the number of chains that intersect \\(C\\), and let \\(y\\) be the number of chains that are enclosed by \\(C\\). Note that no chain can enclose \\(C\\). Then \\(C\\) passes in front of one knight from each pair whose chain intersects \\(C\\), and both knights in any pair whose chain is enclosed by \\(C\\). Thus the length of \\(C\\) is \\(x+2 y \\leqslant n-1\\). The number of chains that form a disjoint pair with \\(C\\) is then\n\\[\nn-1-x-y \\geqslant(x+2 y)-x-y=y\n\\]\n\nNow we can remove \\(A\\) and \\(B\\) and use the induction hypothesis. We need to show that the length of each remaining chain is at most \\(n-2\\) so the chains remain valid. No chain increases in length after removing \\(A\\) and \\(B\\). If any chain \\(C\\) had length \\(n-1\\), then the chain between \\(A\\) and \\(B\\) also had length \\(n-1\\). Then \\(C\\) must have passed in front of exactly one of \\(A\\) or \\(B\\), and so has length \\(n-2\\) after removing \\(A\\) and \\(B\\).\nProof 2. Let \\(k_{C}\\) denote the number of chains \\(C^{\\prime}\\) such that \\(C\\) encloses \\(C^{\\prime}\\).\nNote that if \\(C\\) encloses \\(C^{\\prime}\\), then \\(k_{C^{\\prime}}<k_{C}\\).\nFirst we will show that there at least \\(k_{C}\\) chains that are disjoint from \\(C\\). Let \\(x\\) be the length of \\(C\\), let \\(\\mathcal{S}\\) be the set of \\(x\\) knights that \\(C\\) passes in front of, and let \\(\\mathcal{T}\\) be the set of \\(x\\) knights sitting directly opposite them. None of the knights in \\(\\mathcal{T}\\) can have a chain that encloses or is enclosed by \\(C\\), and if any knight in \\(\\mathcal{T}\\) has a chain that intersects \\(C\\), then her partner must be a knight in \\(\\mathcal{S}\\). So we have that\n\\[\n\\begin{aligned}\n2 k_{C} & =\\text { number of knights in } \\mathcal{S} \\text { whose chain is enclosed by } C \\\\\n& =x-\\text { number of knights in } \\mathcal{S} \\text { whose chain intersects } C \\\\\n& \\leqslant x-\\text { number of knights in } \\mathcal{T} \\text { whose chain intersects } C \\\\\n& \\leqslant \\text { number of knights in } \\mathcal{T} \\text { whose chain is disjoint from } C \\\\\n& \\leqslant 2 \\times \\text { number of chains that are disjoint from } C .\n\\end{aligned}\n\\]\n\nNow let \\(m_{C}\\) denote the number of chains \\(C^{\\prime}\\) with \\(C\\) and \\(C^{\\prime}\\) disjoint, and \\(k_{C^{\\prime}}<k_{C}\\). We will show that \\(m_{C} \\geqslant k_{C}\\).\n\nLet \\(\\mathcal{R}\\) be a set of \\(k_{C}\\) chains that are disjoint from \\(C\\), such that \\(\\sum_{C^{\\prime} \\in \\mathcal{R}} k_{C^{\\prime}}\\) is minimal. If every chain \\(C^{\\prime} \\in \\mathcal{R}\\) has \\(k_{C^{\\prime}}<k_{C}\\), then we are done. Otherwise, let consider a chain \\(C^{\\prime}\\) with \\(k_{C^{\\prime}} \\geqslant k_{C}\\). There are then at least \\(k_{C}\\) chains \\(C^{\\prime \\prime}\\) for which the chain \\(C^{\\prime}\\) passes between \\(C^{\\prime \\prime}\\) and the pillar. Each of these chains must have \\(k_{C^{\\prime \\prime}}<k_{C^{\\prime}}\\), and at least one of them is not in \\(\\mathcal{R}\\) (otherwise \\(\\mathcal{R}\\) would contain \\(C^{\\prime}\\) and at least \\(k_{C}\\) other chains), so we can swap this chain with \\(C^{\\prime}\\) to obtain a set \\(\\mathcal{R}^{\\prime}\\) with \\(\\sum_{C^{\\prime} \\in \\mathcal{R}^{\\prime}} k_{C^{\\prime}}<\\sum_{C^{\\prime} \\in \\mathcal{R}} k_{C^{\\prime}}\\). But this contradicts the minimality of \\(\\mathcal{R}\\).\n\nWe finish by summing these inequalities over all chains \\(C\\) :\n\\[\nk=\\sum_{C} k_{C} \\leqslant \\sum_{C} m_{C} \\leqslant m\n\\]\n\nBy Lemma 3, we have that \\(2 k+l \\leqslant k+l+m=n(n-1) / 2\\). Combining this with Lemma 2, we have that \\(n(n-1) / 2\\) exchanges is enough to reach an arrangement where every knight is sitting next to her partner, as desired.\n\nComment. Either proof of Lemma 3 can be adapted to show that the configuration in Lemma 1 is the only one which achieves the bound.", "source_pdf": "imosl_2024.pdf", "notes": "fallback-regex"}
{"id": "IMOSL-2024-C5", "contest": "IMOSL", "year": "2024", "problem_number": "C5", "problem": "Let \\(N\\) be a positive integer. Geoff and Ceri play a game in which they start by writing the numbers \\(1,2, \\ldots, N\\) on a board. They then take turns to make a move, starting with Geoff. Each move consists of choosing a pair of integers \\((k, n)\\), where \\(k \\geqslant 0\\) and \\(n\\) is one of the integers on the board, and then erasing every integer \\(s\\) on the board such that \\(2^{k} \\mid n-s\\). The game continues until the board is empty. The player who erases the last integer on the board loses.\n\nDetermine all values of \\(N\\) for which Geoff can ensure that he wins, no matter how Ceri plays.\n(Indonesia)", "solution": "Answer: The answer is that Geoff wins when \\(N\\) is of the form \\(2^{n}\\) for \\(n\\) odd or of the form \\(t 2^{n}\\) for \\(n\\) even and \\(t>1\\) odd.\n\nCommon remarks. We will say that a set \\(\\mathcal{S}\\) wins if the current player wins given \\(\\mathcal{S}\\) as the current set of integers on the board. Otherwise, we will say that \\(\\mathcal{S}\\) loses.\n\nWe will let \\(J(\\mathcal{S}, \\mathcal{T})=(2 \\mathcal{S}-1) \\cup(2 \\mathcal{T})\\). Note that every subset of \\(\\mathbb{Z}\\) can be written as \\(J(\\mathcal{S}, \\mathcal{T})\\) for some unique pair ( \\(\\mathcal{S}, \\mathcal{T}\\) ) of subsets of \\(\\mathbb{Z}\\).\n\nWe will let \\([n]\\) denote the set \\(\\{1,2, \\ldots, n\\}\\).\n\n\\section*{\n\n.}\n\nLemma 1. For any set \\(\\mathcal{S}, \\mathcal{S}\\) wins if and only if \\(J(\\mathcal{S}, \\varnothing)\\) wins. Similarly, \\(\\mathcal{S}\\) wins if and only if \\(J(\\varnothing, \\mathcal{S})\\) wins.\nProof. Let ( \\(k, m\\) ) be a move on \\(\\mathcal{S}\\), and let \\(\\mathcal{T}\\) be the result of applying the move. Then we can reduce \\(J(\\mathcal{S}, \\varnothing)\\) to \\(J(\\mathcal{T}, \\varnothing)\\) by applying the move ( \\(k+1,2 m-1\\) ).\n\nConversely, let \\((k, m)\\) be a move on \\(J(\\mathcal{S}, \\varnothing)\\). We can express the result of this move as \\(J(\\mathcal{T}, \\varnothing)\\) for some \\(\\mathcal{T}\\). Then we can reduce \\(\\mathcal{S}\\) to \\(\\mathcal{T}\\) by applying the move ( \\(\\max (k-1,0),(k+1) / 2\\) ).\n\nThis gives us a natural bijection between games starting with \\(\\mathcal{S}\\) and games starting with \\(J(\\mathcal{S}, \\varnothing)\\) and thus proves the first part of the lemma. The second part follows by a similar argument.\nLemma 2. If \\(\\mathcal{S}\\) and \\(\\mathcal{T}\\) are nonempty and at least one of them loses, then \\(J(\\mathcal{S}, \\mathcal{T})\\) wins.\nProof. If \\(\\mathcal{S}\\) is losing, then we can delete \\(J(\\varnothing, \\mathcal{T})\\) using the move ( \\(1, t\\) ) for some \\(t \\in J(\\varnothing, \\mathcal{T})\\), which leaves the losing set \\(J(\\mathcal{S}, \\varnothing)\\). Similarly, if \\(\\mathcal{T}\\) is losing, then we can delete \\(J(\\mathcal{S}, \\varnothing)\\) using the move ( \\(1, s\\) ) for some \\(s \\in J(\\mathcal{S}, \\varnothing\\) ), leaving the losing set \\(J(\\varnothing, \\mathcal{T})\\).\nLemma 3. If \\(\\mathcal{S}\\) is nonempty and wins, then \\(J(\\mathcal{S}, \\mathcal{S})\\) loses.\nProof. From this position, we can convert any sequence of moves into another valid sequence of moves by replacing ( \\(k, 2 n-1\\) ) with ( \\(k, 2 n\\) ), and vice versa. Thus we may assume that the initial move ( \\(k, m\\) ) has \\(m\\) odd. We want to show that any such move results in a winning position for the other player.\n\nThe move \\((0, m)\\) loses immediately. Otherwise, the move results in the set \\(J(\\mathcal{T}, \\mathcal{S})\\) for some set \\(\\mathcal{T}\\). There are three cases.\n\nIf \\(\\mathcal{T}\\) is empty then the other player gets the winning set \\(J(\\varnothing, \\mathcal{S})\\).\nIf \\(\\mathcal{T}\\) is losing then the other player can choose the move ( \\(1, s\\) ) for some \\(s \\in J(\\varnothing, \\mathcal{S})\\), which leaves the losing set \\(J(\\mathcal{T}, \\varnothing)\\).\n\nIf \\(\\mathcal{T}\\) is nonempty winning then the other player can choose the move ( \\(k, m+1\\) ), which results in the position \\(J(\\mathcal{T}, \\mathcal{T})\\). We can then proceed by induction on \\(|\\mathcal{S}|\\) to show that this is a losing set.\n\nLemma 4. [2n] wins if and only if [ \\(n\\) ] loses.\nProof. Note that \\([2 n]=J([n],[n])\\). The result then follows directly from the previous two lemmas.\n\nLemma 5. For any integer \\(n \\geqslant 1,[2 n+1]\\) wins.\nProof. By Lemma 4, either \\([n]\\) or \\([2 n]\\) loses. If \\([n]\\) loses, then by Lemma 2 we have that \\([2 n+1]=J([n+1],[n])\\) wins. Otherwise, \\([2 n]\\) loses, and therefore \\([2 n+1]\\) wins by choosing the move ( \\(k, 2 n+1\\) ) for sufficiently large \\(k\\) so that only \\(2 n+1\\) is eliminated.\n\nIt remains to verify the original answer. We have two cases to consider:\n- Suppose \\(N=2^{n}\\) for some \\(n\\). For \\(N=1\\), every move is an instant loss for Geoff. Then by Lemma 4, Geoff wins for \\(N=2^{n}\\) if and only if Geoff loses for \\(N=2^{n-1}\\), and thus by induction we have that Geoff wins for \\(N=2^{n}\\) if and only if \\(n\\) is odd.\n- Otherwise, \\(N=t 2^{n}\\), for some \\(n\\) and some \\(t>1\\) with \\(t\\) odd. By Lemma 5, Geoff wins when \\(n=0\\). Then by Lemma 4, Geoff wins for \\(N=t 2^{n}\\) if and only if Geoff loses for \\(N=t 2^{n-1}\\), and thus by induction on \\(n\\) we have that Geoff wins for \\(N=t 2^{n}\\) if and only if \\(n\\) is even.\n\nComment. We can represent this game as a game on partial binary trees. This representation could be common in rough working, as it facilitates exploration of small cases. If two sets produce trees which are topologically equivalent, then this equivalence leads to a natural bijection between games starting with the two sets. Such equivalences lead to a significant reduction in the number of distinct cases that need to be considered when exploring the game for small \\(N\\).\n\nThe construction is as follows. First we begin by considering an infinite binary tree. For each positive integer \\(n\\), we consider the binary representation of \\(n-1\\), starting with the least significant bit and ending with an infinite sequence of leading zeroes. We map this sequence of bits to a path on the binary tree by starting at the root, and then repeatedly choosing the left child if the bit is 0 and the right child if the bit is 1 . We can then truncate each path after reaching a sufficient depth to distinguish the path from all other paths in the tree.\n![](https://cdn.mathpix.com/cropped/2025_08_23_9a42685711bc262db31dg-049.jpg?height=472&width=760&top_left_y=1953&top_left_x=651)\n\nValid moves in this representation of the game consist of selecting a node with two children, and removing either the left child or the right child (and its descendants). Selecting and removing the entire graph is also an allowed move (which loses instantly).\n\nTwo trees have equivalent games if they're topologically identical. This equivalence includes swapping the left and right children of any single node, or removing a node with a single child by merging the edges above and below it (and decreasing the depth of its children by one).\n\nComment. We can also analyse this game using Grundy values (also known as nim-values or nimbers). This requires a slight modification to the rules, wherein any move that would erase all integers on the board is disallowed, and the first player who cannot move loses. This is clearly equivalent to the original game.\n\nLet \\(g(\\mathcal{S})\\) denote the Grundy value of the game starting with the set \\(\\mathcal{S}\\). Note that the bijection in Lemma 1 shows that\n\\[\ng(\\mathcal{S})=g(J(\\mathcal{S}, \\varnothing))=g(J(\\varnothing, \\mathcal{S})) .\n\\]\n\nFor any set \\(V\\), let \\(\\operatorname{mex}(V)\\) denote the least nonnegative element that is not an element of \\(V\\). For nonnegative integers \\(x\\) and \\(y\\), define \\(j(x, y)\\) recursively as\n\\[\nj(x, y)=\\operatorname{mex}(\\{x, y\\} \\cup\\{j(w, y) \\mid w<x\\} \\cup\\{j(x, z) \\mid z<y\\}) .\n\\]\n\nThe values of \\(j(x, y)\\) for small \\(x\\) and \\(y\\) are:\n\n\\begin{tabular}{c|cccccc}\n5 & 6 & 7 & 8 & 9 & 1 & 0 \\\\\n4 & 5 & 3 & 6 & 2 & 0 & 1 \\\\\n3 & 4 & 5 & 1 & 0 & 2 & 9 \\\\\n2 & 3 & 4 & 0 & 1 & 6 & 8 \\\\\n1 & 2 & 0 & 4 & 5 & 3 & 7 \\\\\n0 & 1 & 2 & 3 & 4 & 5 & 6 \\\\\n\\hline- & 0 & 1 & 2 & 3 & 4 & 5\n\\end{tabular}\n\nWe can show that \\(g(J(\\mathcal{S}, \\mathcal{T}))=j(g(\\mathcal{S}), g(\\mathcal{T}))\\) for any nonempty sets \\(\\mathcal{S}\\) and \\(\\mathcal{T}\\). The remainder of the proof follows a similar structure to the given solution.", "source_pdf": "imosl_2024.pdf", "notes": "fallback-regex"}
{"id": "IMOSL-2024-C6", "contest": "IMOSL", "year": "2024", "problem_number": "C6", "problem": "Let \\(n\\) and \\(T\\) be positive integers. James has \\(4 n\\) marbles with weights \\(1,2, \\ldots, 4 n\\). He places them on a balance scale, so that both sides have equal weight. Andrew may move a marble from one side of the scale to the other, so that the absolute difference in weights of the two sides remains at most \\(T\\).\n\nFind, in terms of \\(n\\), the minimum positive integer \\(T\\) such that Andrew may make a sequence of moves such that each marble ends up on the opposite side of the scale, regardless of how James initially placed the marbles.\n(Ghana)", "solution": "Answer: The minimum value of \\(T\\) is \\(4 n\\).\n\n1. We must have \\(T \\geqslant 4 n\\), as otherwise we can never move the marble of weight \\(4 n\\). We will show that \\(T=4 n\\) by showing that, for any initial configuration, there is a sequence of moves, never increasing the absolute value of the difference above \\(4 n\\), that results in every marble ending up on the opposite side of the scale. Because moves are reversible, it suffices to do the following: exhibit at least one configuration \\(C\\) for which this can be achieved, and show that any initial configuration can reach such a configuration \\(C\\) by some sequence of moves.\n\nConsider partitioning the weights into pairs ( \\(t, 4 n+1-t\\) ). Suppose that each side of the balance contains \\(n\\) of those pairs. If one side of the balance contains the pair ( \\(t, 4 n+1-t\\) ) for \\(1 \\leqslant t<2 n\\) and the other side contains ( \\(2 n, 2 n+1\\) ), then the following sequence of moves swaps those pairs between the sides without ever increasing the absolute value of the difference above \\(4 n\\).\n\\[\n\\begin{gathered}\nt, 4 n+1-t \\mid 2 n, 2 n+1 \\\\\nt, 2 n, 4 n+1-t \\mid 2 n+1 \\\\\nt, 2 n \\mid 2 n+1,4 n+1-t \\\\\nt, 2 n, 2 n+1 \\mid 4 n+1-t \\\\\n2 n, 2 n+1 \\mid t, 4 n+1-t\n\\end{gathered}\n\\]\n\nApplying this sequence twice swaps any two pairs ( \\(t, 4 n+1-t\\) ) and ( \\(t^{\\prime}, 4 n+1-t^{\\prime}\\) ) between the sides. So we can achieve an arbitrary exchange of pairs between the sides, and \\(C\\) can be any configuration where each side of the balance contains \\(n\\) of those pairs.\n\nWe now show that any initial configuration can reach one where each side has \\(n\\) of those pairs. Consider a configuration where one side has total weight \\(A-s\\) and the other has total weight \\(A+s\\), for some \\(0 \\leqslant s \\leqslant 2 n\\), and where some pair is split between the two sides. (If no pair is split between the two sides, they must have equal weights and we are done.) Valid moves include moving any weight \\(w\\) with \\(1 \\leqslant w \\leqslant 2 n+s\\) from the \\(A+s\\) side to the \\(A-s\\) side, and moving any weight \\(w\\) with \\(1 \\leqslant w \\leqslant 2 n-s\\) from the \\(A-s\\) side to the \\(A+s\\) side. Suppose the pair ( \\(t, 4 n+1-t\\) ), with \\(t \\leqslant 2 n\\), is split between the sides. If \\(t\\) is on the \\(A+s\\) side, or on the \\(A-s\\) side and \\(t \\leqslant 2 n-s\\), it can be moved to the other side. Otherwise, \\(t\\) is on the \\(A-s\\) side and \\(t \\geqslant 2 n-s+1\\), so \\(4 n+1-t \\leqslant 2 n+s\\) is on the \\(A+s\\) side and can be moved to the other side. So we can unite the two weights from that pair without splitting any other pair, and repeating this we reach a configuration where no pair is split between the sides.\n\nSolution 2. As in Solution 1, \\(T \\geqslant 4 n\\). Let \\(\\delta\\) be the weight of the left side minus the weight of the right side. A configuration is called legal if \\(|\\delta| \\leqslant 4 n\\), and a move is legal if it results in a legal configuration. We will show that if \\(\\delta=0\\) then there is a sequence of legal moves after which every marble is on the opposite side.\n\nWe treat the \\(n=1\\) case separately. The initial configuration has marbles 1,4 on one side and 2,3 on the other. So moving marbles 2, 4, 3, 1 in that order is legal and every marble ends on the opposite side. Now assume \\(n \\geqslant 2\\).\n\nMarbles of weight at most \\(2 n\\) are called small. We will make use of the following lemmas:\nLemma 1. If a pair of legal configurations differ only in the locations of small marbles then there is a sequence of legal moves to get from one to the other.\nProof. At first we only move marbles in the wrong position if they are not on the lighter side. (In the case of a tie, neither side is lighter.) Such a move is always legal. Since this reduces the number of marbles in the wrong position, eventually it will no longer be possible to perform such a move.\n\nThen the only marbles in the wrong position are on the lighter side. So moving one marble in the wrong position at a time will always increase \\(|\\delta|\\), and \\(|\\delta| \\leqslant 4 n\\) at the end. Hence every move is legal.\n\nLemma 2. Let \\(k \\in \\mathbb{N}\\). A positive integer can be expressed as a sum of distinct positive integers up to \\(k\\) if and only if it is at most \\(k(k+1) / 2\\).\nProof. The maximum possible sum of distinct positive integers up to \\(k\\) is \\(k(k+1) / 2\\). For the other direction we use induction on \\(k\\). The case \\(k=1\\) is trivial. Assume the statement is true for \\(k-1\\). For positive integers up to \\(k\\) we only need a single term. For larger integers, including \\(k\\) in the expression means we are done by the inductive hypothesis.\n\nAlso note that \\(n(2 n+1) \\geqslant 4 n\\) for \\(n \\geqslant 2\\).\nLet \\(2 n<m \\leqslant 4 n\\). Marbles of weight greater than \\(m\\) are called big and marbles from \\(2 n+1\\) to \\(m\\) are called medium.\n\nSuppose all big marbles are on the correct side (that is, opposite where they started), \\(m\\) is on the incorrect side and the configuration is legal. Then the following steps give a sequence of legal moves after which \\(m\\) is on the correct side and the big marbles were never moved.\n\nAssume \\(m\\) is on the left. In Step 2, we rearrange the small marbles so we can move \\(m\\). But this is only possible if the weight of big and medium marbles on the right is not too large. So we may need to move some medium marbles from the right first, which we do in Step 1.\n\nStep 1 Skip to Step 2 if the total weight of medium and big marbles on the right side is at most \\(n(4 n+1)+2 n-m\\). Since the big marbles are in the correct position and \\(m\\) is in the incorrect position, the big marbles on the right can weigh at most \\(n(4 n+1)-m\\). So there must be a medium marble \\(m^{\\prime}<m\\) on the right.\nFrom the first assumption, it is legal to move all small marbles to the left. Then by Lemma 2 we can move some of the small marbles to the right so the right side has weight exactly \\(n(4 n+1)+2 n\\). Then moving \\(m^{\\prime}\\) is legal. Repeat this step. Since the total weight of medium marbles on the right decreases, this step will occur a bounded number of times.\n\nStep 2 Let the total weight of the right side be \\(n(4 n+1)+2 n-m+x\\) and the weight of small marbles on the right side be \\(y\\). Note that \\(y \\geqslant x\\). If \\(x \\leqslant 0\\) then moving \\(m\\) is legal.\nOtherwise, by Lemma 2 there is a set of small marbles of weight \\(y-x\\). By Lemma 1, there is a sequence of legal moves of small marbles such that the right side has weight exactly \\(n(4 n+1)+2 n-m\\). Now moving \\(m\\) is legal.\n\nApplying the process above for \\(m=4 n, 4 n-1, \\ldots, 2 n+1\\) will move all nonsmall marbles to the opposite side. Then Lemma 1 completes the proof.", "source_pdf": "imosl_2024.pdf", "notes": "fallback-regex"}
{"id": "IMOSL-2024-C8", "contest": "IMOSL", "year": "2024", "problem_number": "C8", "problem": "Let \\(n\\) be a positive integer. Given an \\(n \\times n\\) board, the unit cell in the top left corner is initially coloured black, and the other cells are coloured white. We then apply a series of colouring operations to the board. In each operation, we choose a \\(2 \\times 2\\) square with exactly one cell coloured black and we colour the remaining three cells of that \\(2 \\times 2\\) square black.\n\nDetermine all values of \\(n\\) such that we can colour the whole board black.\n(Peru)", "solution": "Answer: The answer is \\(n=2^{k}\\) where \\(k\\) is a nonnegative integer.\n\n1. We first prove by induction that it is possible the colour the whole board black for \\(n=2^{k}\\). The base case of \\(k=1\\) is trivial. Assume the result holds for \\(k=m\\) and consider the case of \\(k=m+1\\). Divide the \\(2^{m+1} \\times 2^{m+1}\\) board into four \\(2^{m} \\times 2^{m}\\) sub-boards. Colour the top left \\(2^{m} \\times 2^{m}\\) sub-board using the inductive hypothesis. Next, colour the centre \\(2 \\times 2\\) square with a single operation. Finally, each of the remaining \\(2^{m} \\times 2^{m}\\) sub-board can be completely coloured using the inductive hypothesis, starting from the black square closest to the centre. This concludes the induction.\n\nNow we prove that if such a colouring is possible for \\(n\\) then \\(n\\) must be a power of 2 . Suppose it is possible to colour an \\(n \\times n\\) board where \\(n>1\\). Identify the top left corner of the board by \\((0,0)\\) and the bottom right corner by \\((n, n)\\). Whenever an operation takes place in a \\(2 \\times 2\\) square centred on ( \\(i, j\\) ), we immediately draw an \" X \", joining the four cells' centres (see Figure 4). Also, identify this \\(\\mathbf{X}\\) by \\((i, j)\\). The first operation implies there's an \\(\\mathbf{X}\\) at \\((1,1)\\). Since the whole board is eventually coloured, every cell centre must be connected to at least one X . The collection of all \\(\\mathrm{X}_{\\mathrm{S}}\\) forms a graph \\(G\\).\n\n\\begin{figure}\n\\includegraphics[width=\\textwidth]{https://cdn.mathpix.com/cropped/2025_08_23_9a42685711bc262db31dg-057.jpg?height=763&width=1606&top_left_y=1490&top_left_x=231}\n\\captionsetup{labelformat=empty}\n\\caption{Figure 4: L-trominoes placements corresponding to colouring operations (left) and the corresponding X diagram (right).}\n\\end{figure}\n\n\\section*{Claim 1. The graph \\(G\\) is a tree.}\n\nProof. Since every operation requires a pre-existing black cell, each newly drawn X apart from the first must connect to an existing X . So all Xs are connected to the first X and \\(G\\) must be connected. Now, suppose \\(G\\) has a cycle. Consider the newest X involved in the cycle, it must connect to previous \\(\\mathrm{X}_{\\mathrm{s}}\\) at at least two points. But this implies the corresponding operation will colour at most two cells, which is a contradiction.\n\nNote that in the following arguments, Claims 2 to 4 only require the condition that \\(G\\) is a tree and every cell is connected to \\(G\\).\nClaim 2. If there's an X at \\((i, j)\\), then \\(1 \\leqslant i, j \\leqslant n-1\\) and \\(i \\equiv j(\\bmod 2)\\).\nProof. The inequalities \\(1 \\leqslant i, j \\leqslant n-1\\) are clear. Call an X at \\((i, j)\\) good if \\(i \\equiv j(\\bmod 2)\\), or bad if \\(i \\not \\equiv j(\\bmod 2)\\). The first X at \\((i, j)=(1,1)\\) is good. Suppose some \\(\\mathrm{X}_{\\mathrm{s}}\\) are bad. Since \\(G\\) is connected, there must exist a good X connecting to a bad X . But this can only occur if they connect at two points, creating a cycle. This is a contradiction, thus all \\(\\mathrm{X}_{\\mathrm{s}}\\) are good.\n\nCall an X at \\((i, j)\\) odd if \\(i \\equiv j \\equiv 1(\\bmod 2)\\), even if \\(i \\equiv j \\equiv 0(\\bmod 2)\\).\nClaim 3. The integer \\(n\\) must be even. Furthermore, there must be \\(4(n / 2-1)\\) odd \\(\\mathrm{X}_{\\mathrm{S}}\\) connecting the cells on the perimeter of the board as shown in Figure 5.\nProof. If \\(n\\) is odd, the four corners of the bottom left cell are \\((n, 0),(n-1,0),(n-1,1)\\) and \\((n, 1)\\), none of which satisfies the conditions of Claim 2. So the bottom left cell cannot connect to any X . If \\(n\\) is even, each cell on the edge of the board has exactly one corner satisfying the conditions of Claim 2, so the X connecting it is uniquely determined. Therefore the cells on the perimeter of the board are connected to \\(\\mathrm{X}_{\\mathrm{s}}\\) according to Figure 5.\n\n\\begin{figure}\n\\includegraphics[width=\\textwidth]{https://cdn.mathpix.com/cropped/2025_08_23_9a42685711bc262db31dg-058.jpg?height=766&width=1609&top_left_y=1099&top_left_x=228}\n\\captionsetup{labelformat=empty}\n\\caption{Figure 5: Highlighting the permitted points for \\(\\mathrm{X}_{\\mathrm{s}}\\) (left) and \\(\\mathrm{X}_{\\mathrm{s}}\\) on the perimeter (right).}\n\\end{figure}\n\nDivide the \\(n \\times n\\) board into \\(n^{2} / 4\\) blocks of \\(2 \\times 2\\) squares. Call each of these blocks a big-cell. We say a big-cell is filled if it contains an odd X on its interior, empty otherwise. By Claim 3, each big-cell on the perimeter must be filled.\nClaim 4. Every big-cell is filled.\nProof. Recall that \\(\\mathrm{X}_{\\mathrm{s}}\\) can only be at \\((i, j)\\) with \\(i \\equiv j(\\bmod 2)\\). Suppose a big-cell centred at \\((i, j)\\) is empty. Then in order for its four cells to be coloured, there must be four even \\(\\mathrm{X}_{\\mathrm{s}}\\) on \\((i-1, j-1),(i+1, j-1),(i-1, j+1)\\) and \\((i+1, j+1)\\), \"surrounding\" the big-cell (see Figure 6).\n\nBy Claim 3, no empty big-cell can be on the perimeter. So if there exist some empty bigcells, the boundary between empty and filled big-cells must consist of a number of closed loops. Each closed loop is made up of several line segments of length 2, each of which separates a filled big-cell from an empty big-cell.\n\nSince every empty big-cell is surrounded by even \\(\\mathrm{X}_{\\mathrm{s}}\\) and every filled big-cell contains an odd X , the two end points of each such line segment must be connected by \\(\\mathrm{X}_{\\mathrm{s}}\\). Since these line segments form at least one closed loop, it implies the existence of a cycle made up of \\(\\mathrm{X}_{\\mathrm{s}}\\) (see Figure 6). This is a contradiction, thus no big-cell can be empty.\n\n\\begin{figure}\n\\includegraphics[width=\\textwidth]{https://cdn.mathpix.com/cropped/2025_08_23_9a42685711bc262db31dg-059.jpg?height=763&width=1606&top_left_y=237&top_left_x=231}\n\\captionsetup{labelformat=empty}\n\\caption{Figure 6: An empty big-cell surrounded by even \\(\\mathrm{X}_{\\mathrm{s}}\\) (left) and the boundary between empty and filled \\(\\mathrm{X}_{\\mathrm{s}}\\) creating a cycle (right).}\n\\end{figure}\n\nTherefore every big-cell is filled by an odd \\(\\mathbf{X}\\), and the connections between them are provided by even \\(\\mathrm{X}_{\\mathrm{s}}\\). We can now reduce the \\(n \\times n\\) problem to an \\(n / 2 \\times n / 2\\) problem in the following way. Perform a dilation of the board by a factor of \\(1 / 2\\) with respect to \\((0,0)\\). Each big-cell is shrunk to a regular cell. For the \\(\\mathrm{X}_{\\mathrm{s}}\\), replace each odd X at \\((i, j)\\) by the point \\((i / 2, j / 2)\\), and replace each even \\(\\mathbf{X}\\) at \\((i, j)\\) by an \\(\\mathbf{X}\\) at \\((i / 2, j / 2)\\).\n\nWe claim the new resulting graph of \\(\\mathrm{X}_{\\mathrm{s}}\\) is a tree that connects all cells of an \\(n / 2 \\times n / 2\\) board. First, two connected \\(\\mathrm{X}_{\\mathrm{s}}\\) in the original \\(n \\times n\\) board are still connected after their replacements (noting that some \\(\\mathrm{X}_{\\mathrm{S}}\\) have been replaced by single points). For each cell in the \\(n / 2 \\times n / 2\\) board, its centre corresponds to an odd X from a filled big-cell in the original \\(n \\times n\\) board, so it must be connected to the graph. Finally, suppose there exists a cycle in the new graph. The cycle consists of \\(\\mathrm{X}_{\\mathrm{s}}\\) that correspond to even \\(\\mathrm{X}_{\\mathrm{s}}\\) in the original graph connecting big-cells, forming a cycle of big-cells. Since in every big-cell, the four unit squares were connected by an odd X , this implies the existence of a cycle in the original graph, which is a contradiction.\n\nThus the new graph of \\(\\mathrm{X}_{\\mathrm{s}}\\) must be a tree that connects all cells of an \\(n / 2 \\times n / 2\\) board, which are the required conditions for Claims 2 to 4 . Hence we can repeat our argument, halving the dimensions of the board each time, until we reach the base case of a \\(1 \\times 1\\) board (where the tree is a single point). Therefore \\(n\\) must be a power of 2 , completing the solution.\n\nSolution 2. As in Solution 1, it is possible the colour the whole board black for \\(n=2^{k}\\).\nThe colouring operation is equivalent to the placement of L -trominoes. For each L -tromino we place on the board, we draw an arrow and a node as shown in Figure 7. We also draw a node in the top left corner of the board.\n\n\\begin{figure}\n\\includegraphics[width=\\textwidth]{https://cdn.mathpix.com/cropped/2025_08_23_9a42685711bc262db31dg-060.jpg?height=198&width=201&top_left_y=482&top_left_x=930}\n\\captionsetup{labelformat=empty}\n\\caption{Figure 7: Tromino with corresponding arrow and node drawn.}\n\\end{figure}\n\nClaim 1. The arrows and nodes form a directed tree rooted at the top left corner.\nProof. The proof is similar to the proof of Claim 1 in Solution 1, with the additional note that the directions of the arrows inherit the order of the colouring operations, so they must be pointing away from the top left node.\n\nNote that since all edges of the tree are diagonal, the nodes can only lie on points \\((i, j)\\) with \\(i+j \\equiv 0(\\bmod 2)\\). This implies that we can only place down L-trominoes of one particular parity: that is, with the centre of the \\(\\mathbf{L}\\)-tromino on a point with \\(i+j \\equiv 0(\\bmod 2)\\). In the remainder of the proof, we will implicitly use this parity property when determining possible positions of L-trominoes.\n\nNext, we show that certain configurations of edges of the tree are impossible.\nClaim 2. There cannot be two edges in a \"parallel\" configuration (see Figure 8).\nProof. In such a configuration, the two edges can either be directed in the same direction or opposite directions. If they point in the same direction (see Figure 8), then the L -trominoes corresponding to the two edges overlap.\n\n\\begin{figure}\n\\includegraphics[width=\\textwidth]{https://cdn.mathpix.com/cropped/2025_08_23_9a42685711bc262db31dg-060.jpg?height=318&width=746&top_left_y=1587&top_left_x=662}\n\\captionsetup{labelformat=empty}\n\\caption{Figure 8: Parallel configuration (left) and two parallel edges, case 1 (right).}\n\\end{figure}\n\nIf they point in opposite directions, then we get the diagram in Figure 9. The cells marked ( \\(\\star\\) ) must lie inside the \\(n \\times n\\) board, so they must be covered by L-trominoes. There is only one possible way to cover these with a L -tromino of the right parity. But this makes the arrows form a cycle, which cannot happen. So we have a contradiction.\n\n\\begin{figure}\n\\includegraphics[width=\\textwidth]{https://cdn.mathpix.com/cropped/2025_08_23_9a42685711bc262db31dg-060.jpg?height=395&width=998&top_left_y=2261&top_left_x=536}\n\\captionsetup{labelformat=empty}\n\\caption{Figure 9: Two parallel edges, case 2.}\n\\end{figure}\n\nClaim 3. There cannot be three edges in a \"zigzag\" configuration, shown in Figure 10.\n\n\\begin{figure}\n\\includegraphics[width=\\textwidth]{https://cdn.mathpix.com/cropped/2025_08_23_9a42685711bc262db31dg-061.jpg?height=129&width=312&top_left_y=365&top_left_x=879}\n\\captionsetup{labelformat=empty}\n\\caption{Figure 10: Zigzag configuration.}\n\\end{figure}\n\nProof. Assume for contradiction that there is a zigzag. Then take the zigzag with maximal distance from the root of the tree (measured by distance along the graph from the root to the middle edge of the zigzag).\n\nWe may assume without loss of generality that the middle edge is directed down-right. Then the right edge must be directed up-right, since no two arrows can point to the same node. Next, we draw in the corresponding L -trominoes, and consider the cell marked ( \\(\\star\\) ). There are two possible ways to cover it with an L -tromino, because of the parity of L -tromino centres.\n\nWe could choose the centre of the L -tromino to be the top right corner of the cell (see Figure 11). This immediately gives another zigzag.\n\n\\begin{figure}\n\\includegraphics[width=\\textwidth]{https://cdn.mathpix.com/cropped/2025_08_23_9a42685711bc262db31dg-061.jpg?height=300&width=1103&top_left_y=1222&top_left_x=482}\n\\captionsetup{labelformat=empty}\n\\caption{Figure 11: Zigzag configuration, case 1.}\n\\end{figure}\n\nThe other possibility is if we choose the centre of the L -tromino to be the bottom left corner of the cell (see Figure 12). Then we need to cover the cell marked (**) with an L -tromino. If\n\n\\begin{figure}\n\\includegraphics[width=\\textwidth]{https://cdn.mathpix.com/cropped/2025_08_23_9a42685711bc262db31dg-061.jpg?height=490&width=1620&top_left_y=1858&top_left_x=222}\n\\captionsetup{labelformat=empty}\n\\caption{Figure 12: Zigzag configuration, case 2.}\n\\end{figure}\nwe placed the centre of the L-tromino on the top left corner of the cell, this would give two parallel edges, contradicting Claim 2. So we must place the centre of the L -tromino on the bottom right corner of the cell, which gives a zigzag.\n\nIn each case, we get another zigzag further away from the root of the tree, which contradicts our assumption of maximality. So there cannot be any zigzags.\n\nWe now colour the nodes of the tree. Colour the root node yellow. For all other nodes, we colour it white if it has an arrow coming out of it in a different direction to the arrow going in, and black otherwise.\nClaim 4. Any child of a black node is white.\n\n\\begin{figure}\n\\includegraphics[width=\\textwidth]{https://cdn.mathpix.com/cropped/2025_08_23_9a42685711bc262db31dg-062.jpg?height=314&width=1016&top_left_y=502&top_left_x=524}\n\\captionsetup{labelformat=empty}\n\\caption{Figure 13: Black node configuration.}\n\\end{figure}\n\nProof. Suppose we have a black node with a child. Then the arrow exiting the black node must be in the same direction as the arrow entering it by the definition of our colouring, giving the left diagram of Figure 13.\n\nThe cell marked ( \\(\\star\\) ) must be covered by an L -tromino. If the centre of this L -tromino is the bottom left corner, then this would give an arrow leaving the black node in a different direction, which cannot happen. So the centre of the L -tromino must instead be the top right corner, which gives an arrow leaving the upper node in a different direction. Thus the upper node must be white.\n\nClaim 5. Every white node has three children, all of which are black.\n\n\\begin{figure}\n\\includegraphics[width=\\textwidth]{https://cdn.mathpix.com/cropped/2025_08_23_9a42685711bc262db31dg-062.jpg?height=403&width=1600&top_left_y=1476&top_left_x=234}\n\\captionsetup{labelformat=empty}\n\\caption{Figure 14: White node configuration.}\n\\end{figure}\n\nProof. Refer to Figure 14. Suppose we have a white node, as in the leftmost diagram. The cell marked ( \\(\\star\\) ) must be covered by an L -tromino. If the centre of this L -tromino is the bottom right corner of the cell, then this would form a zigzag, which by Claim 3 is not allowed. So the centre must be the top left corner.\n\nNext, the cell marked ( \\(\\star \\star\\) ) must be covered by an L -tromino. If the centre of this L -tromino is the top right corner, this would form a zigzag, so the centre must be the bottom left corner instead. Thus we have shown that any white node has three children.\n\nFinally, note that if any of the child nodes had three children of their own, then this would give parallel edges in the diagram, which contradicts Claim 2. Therefore the child nodes of the white node must all be black.\n\nWe now know that the node colours alternate between black and white as you go down the tree, so all white nodes lie on points with coordinates \\((2 i, 2 j)\\), and all black nodes lie on points with coordinates \\((2 i+1,2 j+1)\\).\n\nNow (assuming \\(n>1\\) ) we will construct a new board whose cells are \\(2 \\times 2\\) squares of our current board. We replace the root node and its child with a single big cell and a big root node,\n\n\\begin{figure}\n\\includegraphics[width=\\textwidth]{https://cdn.mathpix.com/cropped/2025_08_23_9a42685711bc262db31dg-063.jpg?height=700&width=952&top_left_y=234&top_left_x=553}\n\\captionsetup{labelformat=empty}\n\\caption{Figure 15: Replacing with larger cells and L-trominoes.}\n\\end{figure}\nand we replace each white node and its three children with a big L-tromino, big arrow and big node as shown in Figure 15.\n\nEvery black node is the child of the root node or a white node, so every L-tromino is involved in exactly one replacement. Also, the parent of any white node is a black node, whose parent, in turn, is a white node or the root. So the starting point of every big arrow will be on a big node. Therefore we obtain an L-tromino tiling forming a tree.\n\nThis shows for \\(n>1\\) that if an \\(n \\times n\\) board can be tiled by L-trominoes forming a tree, then \\(n\\) is even, and an \\(n / 2 \\times n / 2\\) board can also be tiled by L-trominoes forming a tree. Since a \\(1 \\times 1\\) board can trivially be tiled, we conclude that the only values of \\(n\\) for which an \\(n \\times n\\) board can be tiled are \\(n=2^{k}\\).\n\n\\section*{Geometry}", "source_pdf": "imosl_2024.pdf", "notes": "fallback-regex"}
{"id": "IMOSL-2024-G1", "contest": "IMOSL", "year": "2024", "problem_number": "G1", "problem": "Let \\(A B C D\\) be a cyclic quadrilateral such that \\(A C<B D<A D\\) and \\(\\angle D B A<90^{\\circ}\\). Point \\(E\\) lies on the line through \\(D\\) parallel to \\(A B\\) such that \\(E\\) and \\(C\\) lie on opposite sides of line \\(A D\\), and \\(A C=D E\\). Point \\(F\\) lies on the line through \\(A\\) parallel to \\(C D\\) such that \\(F\\) and \\(C\\) lie on opposite sides of line \\(A D\\), and \\(B D=A F\\).\n\nProve that the perpendicular bisectors of segments \\(B C\\) and \\(E F\\) intersect on the circumcircle of \\(A B C D\\).\n(Ukraine)", "solution": "1. Let \\(T\\) be the midpoint of \\(\\operatorname{arc} \\widehat{B A C}\\) and let lines \\(B A\\) and \\(C D\\) intersect \\(E F\\) at \\(K\\) and \\(L\\), respectively. Note that \\(T\\) lies on the perpendicular bisector of segment \\(B C\\).\n![](https://cdn.mathpix.com/cropped/2025_08_23_9a42685711bc262db31dg-064.jpg?height=1218&width=1192&top_left_y=973&top_left_x=439)\n\nSince \\(A B C D\\) is cyclic, \\(\\frac{B D}{\\sin \\angle B A D}=\\frac{A C}{\\sin \\angle A D C}\\). From parallel lines we have \\(\\angle D A F=\\angle A D C\\) and \\(\\angle B A D=\\angle E D A\\). Hence,\n\\[\nA F \\cdot \\sin \\angle D A F=B D \\cdot \\sin \\angle A D C=A C \\cdot \\sin \\angle B A D=D E \\cdot \\sin \\angle E D A .\n\\]\n\nSo \\(F\\) and \\(E\\) are equidistant from the line \\(A D\\), meaning that \\(E F\\) is parallel to \\(A D\\).\nWe have that \\(K A D E\\) and \\(F A D L\\) are parallelograms, hence we get \\(K A=D E=A C\\) and \\(D L=A F=B D\\). Also, \\(K E=A D=F L\\) so it suffices to prove the perpendicular bisector of \\(K L\\) passes through \\(T\\).\n\nTriangle \\(A K C\\) is isosceles so \\(\\angle B T C=\\angle B A C=2 \\angle B K C\\). Likewise, \\(\\angle B T C=2 \\angle B L C\\). Since \\(T, K\\), and \\(L\\) all lie on the same side of \\(B C\\) and \\(T\\) lies on the perpendicular bisector of \\(B C, T\\) is the centre of circle \\(B K L C\\). The result follows.\n\nSolution 2. Let \\(A F\\) and \\(D E\\) meet \\(\\omega\\) at \\(X\\) and \\(Y\\), respectively, and let \\(T\\) be as in Solution 1.\nAs \\(B D<A D, D Y \\| A B\\) and \\(\\angle B A Y=\\angle D B A<90^{\\circ}\\), we have \\(D Y<A B\\) and \\(Y\\) lies on the opposite side of line \\(A D\\) to \\(C\\). Also from \\(B D<A D\\), we have \\(B, C\\), and \\(D\\) all lie on the same side of the perpendicular bisector of \\(A B\\) which shows \\(A C>A B\\). Combining these, we get \\(D Y<A B<A C=D E\\) and, as \\(Y\\) and \\(E\\) both lie on the same side of line \\(A D, Y\\) lies in the interior of segment \\(D E\\). Similarly, \\(X\\) lies in the interior of segment \\(D F\\).\n\nSince \\(A B\\) is parallel to \\(D Y\\), we have \\(Y A=B D=F A\\). Likewise \\(X D=A C=E D\\).\n![](https://cdn.mathpix.com/cropped/2025_08_23_9a42685711bc262db31dg-065.jpg?height=618&width=757&top_left_y=642&top_left_x=651)\n\nClaim 1. \\(T\\) is the midpoint of \\(\\operatorname{arc} \\overparen{X Y}\\).\nProof. From \\(A X \\| C D\\) and \\(A B \\| D Y\\) we have\n\\[\n\\angle C A X=\\angle A X D=\\angle A Y D=\\angle Y D B .\n\\]\n\nSince \\(T\\) is the midpoint of \\(\\operatorname{arc} \\widehat{B A C}\\), we have \\(\\angle B A T=\\angle T D C\\), so\n\\[\n\\angle T A X=\\angle C A X+\\angle B A C-\\angle B A T=\\angle Y D B+\\angle B D C-\\angle T D C=\\angle Y D T .\n\\]\n\nRecall from above we have \\(A B<A C\\) and analogously, \\(D C<D B\\), which shows that \\(X, Y\\) and \\(T\\) all lie on the same side of line \\(A D\\). In particular, \\(T\\) and \\(A\\) lie on opposite sides of \\(X Y\\) so \\(T\\) lies on the internal angle bisector of \\(\\angle X A Y\\). Since \\(A F=A Y\\), we have \\(\\triangle A T F \\cong \\triangle A T Y\\), giving \\(T F=T Y\\).\n\nLikewise, \\(T E=T X\\), so \\(T E=T F\\), meaning that \\(T\\) lies on the perpendicular bisector of segment \\(E F\\) as required.\n\nComment. The statement remains true without the length and angle conditions on cyclic quadrilateral \\(A B C D\\) however additional care is required to consider different cases based on the ordering of points on lines \\(D E\\) and \\(A F\\). It is also possible for \\(T\\) to be on the external angle bisector of \\(\\angle X A Y\\).\n\nSolution 3. From \\(A F=D B, A C=D E\\) and\n\\[\n\\angle(A C, A F)=\\angle(A C, C D)=\\angle(A B, B D)=\\angle(D E, D B),\n\\]\ntriangles \\(A C F\\) and \\(D E B\\) are congruent, so \\(C F=B E\\).\nLet \\(P=B E \\cap C F\\). Since\n\\[\n\\angle(C P, B P)=\\angle(C F, B E)=\\angle(A F, D B)=\\angle(D C, D B),\n\\]\nwe have that \\(P\\) lies on circle \\(A B C D\\).\n![](https://cdn.mathpix.com/cropped/2025_08_23_9a42685711bc262db31dg-066.jpg?height=686&width=918&top_left_y=745&top_left_x=576)\n\nFinally, let \\(T\\) be the Miquel point of the quadrilateral \\(B C F E\\) so \\(T\\) lies on circles \\(E F P\\) and \\(A B C D\\). Note that \\(T\\) is the centre of spiral similarity taking segments \\(B E\\) to \\(C F\\) and since \\(B E=C F\\), this is in fact just a rotation, so \\(T B=T C\\) and \\(T E=T F\\); that is, the perpendicular bisectors of \\(B C\\) and \\(E F\\) meet at \\(T\\), on circle \\(A B C D\\).", "source_pdf": "imosl_2024.pdf", "notes": "fallback-regex"}
{"id": "IMOSL-2024-G3", "contest": "IMOSL", "year": "2024", "problem_number": "G3", "problem": "Let \\(A B C D E\\) be a convex pentagon and let \\(M\\) be the midpoint of \\(A B\\). Suppose that segment \\(A B\\) is tangent to the circumcircle of triangle \\(C M E\\) at \\(M\\) and that \\(D\\) lies on the circumcircles of triangles \\(A M E\\) and \\(B M C\\). Lines \\(A D\\) and \\(M E\\) intersect at \\(K\\), and lines \\(B D\\) and \\(M C\\) intersect at \\(L\\). Points \\(P\\) and \\(Q\\) lie on line \\(E C\\) so that \\(\\angle P D C=\\angle E D Q=\\angle A D B\\).\n\nProve that lines \\(K P, L Q\\), and \\(M D\\) are concurrent.\n(Belarus)", "solution": "Common remarks. Each of solutions we present consists of three separate parts:\n(a) proving \\(K P \\| M C\\) and \\(L Q \\| M E\\);\n(b) proving \\(K L \\| A B\\) and, optionally, showing that points \\(C, E, K\\), and \\(L\\) are concyclic;\n(c) completing the\n\neither using homotheties or the parallelogram enclosed by lines \\(K P, M K, M L\\) and \\(L Q\\), or radical axes between three circles.\n\n\\section*{Solution 1.}\n(a) Notice that the condition \\(\\angle P D C=\\angle A D B\\) is equivalent to \\(\\angle A D P=\\angle B D C\\), and \\(\\angle E D Q=\\angle A D B\\) is equivalent to \\(\\angle E D A=\\angle Q D B\\). From line \\(A B\\) being tangent to circle \\(C M E\\), and circles \\(A M D E\\) and \\(C D M E\\) we read \\(\\angle E C M=\\angle E M A=\\angle E D A=\\angle Q D B\\) and \\(\\angle M E C=\\angle B M C=\\angle B D C=\\angle A D P\\).\nUsing \\(\\angle A D P=\\angle M E C\\), the points \\(D, E, K\\), and \\(P\\) are concyclic, which gives that \\(\\angle E P K=\\angle E D A=\\angle E C M\\). From that, we can see that \\(K P \\| M C\\). It can be shown similarly that \\(C, D, Q\\), and \\(L\\) are concyclic, \\(\\angle L Q C=\\angle M E C\\) and therefore \\(L Q \\| M E\\).\n![](https://cdn.mathpix.com/cropped/2025_08_23_9a42685711bc262db31dg-070.jpg?height=846&width=1072&top_left_y=1450&top_left_x=508)\n(b) Let rays \\(D A\\) and \\(D B\\) intersect circle \\(C D E\\) at \\(R\\) and \\(S\\), respectively. We now observe that \\(\\angle S E C=\\angle S D C=\\angle M E C\\), so points \\(E, M\\), and \\(S\\) are collinear. We similarly obtain that \\(C, M\\), and \\(R\\) are collinear.\nFrom \\(\\angle S R C=\\angle S E C=\\angle B M C\\) we can see that \\(R S \\| A B\\). Since \\(M\\) bisects \\(A B\\), it follows that \\(K L \\| R S\\).\n(c) Consider the homothety at \\(D\\) that sends \\(R S\\) to \\(K L\\). Because \\(K P \\| R C\\) and \\(L Q \\| S E\\), that homothety sends the concurrent lines \\(D M, R C\\), and \\(S E\\) to \\(D M, K P\\), and \\(L Q\\), so these lines are also concurrent.\n\n\\section*{Solution 2.}\n(a) As in Solution 1, we show the following: \\(\\angle E C M=\\angle E M A=\\angle E D A=\\angle E P K\\); \\(\\angle M E C=\\angle B M C=\\angle B D C=\\angle L Q C\\); the points \\(C, D, Q\\), and \\(L\\) are concyclic; the points \\(D, E, K\\), and \\(P\\) are concyclic; \\(K P \\| M C\\); and \\(L Q \\| M E\\).\n(b) Notice that triangles \\(E K P\\) and \\(E M C\\) are homothetic at \\(E\\), so their circumcircles \\(C M E\\) and \\(D E K P\\) are tangent to each other at \\(E\\). Similarly, circle \\(C D Q L\\) is tangent to circle \\(C M E\\) at \\(C\\).\n\nSuppose that the tangents to circle \\(C M E\\) at \\(C\\) and \\(E\\) intersect at point \\(X\\). (The case when \\(C E\\) is a diameter in circle \\(C M E\\) can be considered as a limit case.) Moreover, let \\(E X\\) and \\(C X\\) intersect circles \\(D E A M\\) and \\(B C D M\\) again at \\(A_{1} \\neq E\\) and \\(B_{1} \\neq C\\), respectively.\n![](https://cdn.mathpix.com/cropped/2025_08_23_9a42685711bc262db31dg-071.jpg?height=1094&width=1389&top_left_y=885&top_left_x=379)\n\nWe have \\(X E=X C\\) because they are the tangents from \\(X\\) to circle \\(C M E\\). Moreover, in circle \\(D E A M\\), chords \\(A M\\) and \\(A_{1} E\\) are tangent to circle \\(C M E\\), so \\(A_{1} E=A M\\). Similarly, we have \\(B_{1} C=B M\\), hence \\(A_{1} E=A M=B M=B_{1} C\\). We conclude \\(X A_{1}=X B_{1}\\), so the powers of \\(X\\) with respect to circles \\(D E A M\\) and \\(B C D M\\) are equal. Therefore, \\(X\\) lies on the radical axis of these two circles, which is \\(D M\\).\n\nNow notice that by \\(X C=X E\\), point \\(X\\) has equal powers to circles \\(C D Q L\\) and \\(D E K P\\), so \\(D X\\) is the radical axis of these circles. Point \\(M\\) lies on \\(D X\\), so \\(M E \\cdot M K=M C \\cdot M L\\); we conclude that \\(C, E, K\\), and \\(L\\) are concyclic. Hence, by \\(\\angle M K L=\\angle E C M=\\angle K M A\\) we have \\(K L \\| A B\\).\n(c) As \\(\\angle E P K=\\angle E M A=\\angle Q L K\\), we have that \\(K L Q P\\) is cyclic. The radical axes between circles \\(D E K P, C D Q L\\) and \\(K L Q P\\) are \\(D M, K P\\) and \\(L Q\\), so they are concurrent at the radical centre of the three circles.\n\n\\section*{Solution 3.}\n(b) We present another proof that \\(K L \\| A B\\).\n\nLet \\(A D \\cap L Q=I, B D \\cap K P=H, A B \\cap L Q=U\\) and \\(A B \\cap K P=V\\). Since\n\\[\n\\angle D H P=\\angle D L M=180^{\\circ}-\\angle C L D=180^{\\circ}-\\angle C Q D=\\angle D Q E,\n\\]\npoint \\(H\\) lies on circle \\(D P Q\\). Similarly, we obtain that point \\(I\\) lies on this circle. Hence, \\(\\angle L I H=\\angle Q D B=\\angle E D A=\\angle E M A\\), and \\(L Q \\| M E\\) implies that \\(H I \\| A B\\).\n![](https://cdn.mathpix.com/cropped/2025_08_23_9a42685711bc262db31dg-072.jpg?height=703&width=1272&top_left_y=785&top_left_x=436)\n\nLet \\(A M=B M=d\\), then we have\n\\[\n\\frac{B U}{I H}=\\frac{B L}{L H}=\\frac{B M}{M V}=\\frac{d}{d+A V} \\quad \\text { and } \\quad \\frac{A V}{I H}=\\frac{A K}{K I}=\\frac{A M}{M U}=\\frac{d}{d+B U} .\n\\]\n\nHence, \\(B U \\cdot(d+A V)=A V \\cdot(d+B U)\\), so \\(B U=A V\\). Therefore, \\(\\triangle M L U \\cong \\triangle V K M\\) which implies \\(K L\\|A B\\| H I\\).\n(c) Lines \\(M K, M L, K P\\) and \\(L Q\\) enclose a parallelogram. Line \\(D M\\) passes through the midpoint of \\(K L\\), which the centre of the parallelogram, and passes through the vertex \\(M\\). Therefore, \\(D M\\) passes through the opposite vertex, which is the intersection of \\(K P\\) and \\(L Q\\).", "source_pdf": "imosl_2024.pdf", "notes": "fallback-regex"}
{"id": "IMOSL-2024-G4", "contest": "IMOSL", "year": "2024", "problem_number": "G4", "problem": "Let \\(A B C D\\) be a quadrilateral with \\(A B\\) parallel to \\(C D\\) and \\(A B<C D\\). Lines \\(A D\\) and \\(B C\\) intersect at a point \\(P\\). Point \\(X \\neq C\\) on the circumcircle of triangle \\(A B C\\) is such that \\(P C=P X\\). Point \\(Y \\neq D\\) on the circumcircle of triangle \\(A B D\\) is such that \\(P D=P Y\\). Lines \\(A X\\) and \\(B Y\\) intersect at \\(Q\\).\n\nProve that \\(P Q\\) is parallel to \\(A B\\).\n(Ukraine)", "solution": "1. Let \\(M\\) and \\(N\\) be the midpoints of \\(A D\\) and \\(B C\\), respectively and let the perpendicular bisector of \\(A B\\) intersect the line through \\(P\\) parallel to \\(A B\\) at \\(R\\).\nLemma. Triangles \\(Q A B\\) and \\(R N M\\) are similar.\nProof. Let \\(O\\) be the circumcentre of triangle \\(A B C\\), and let \\(S\\) be the midpoint of \\(C X\\). Since \\(N, S\\), and \\(R\\) are the respective perpendicular feet from \\(O\\) to \\(B C, C X\\), and \\(P R\\), we have that quadrilaterals \\(P R N O\\) and \\(C N S O\\) are cyclic. Furthermore, \\(P, S\\), and \\(O\\) are collinear as \\(P C=P X\\). Since \\(A B C X\\) is also cyclic, we have that\n\\[\n\\angle Q A B=\\angle X C B=\\angle P O N=180^{\\circ}-\\angle N R P=\\angle M N R .\n\\]\n\nAnalogously, we have that \\(\\angle A B Q=\\angle R M N\\), so triangles \\(Q A B\\) and \\(R N M\\) are similar.\n![](https://cdn.mathpix.com/cropped/2025_08_23_9a42685711bc262db31dg-073.jpg?height=914&width=1340&top_left_y=1262&top_left_x=365)\n\nLet \\(d(Z, \\ell)\\) denote the perpendicular distance from the point \\(Z\\) to the line \\(\\ell\\). Using that \\(P R \\| A B\\) along with the similarities \\(Q A B \\sim R N M\\) and \\(P A B \\sim P M N\\), we have that\n\\[\n\\frac{d(Q, A B)}{A B}=\\frac{d(R, M N)}{M N}=\\frac{d(P, M N)}{M N}=\\frac{d(P, A B)}{A B},\n\\]\nwhich implies that \\(P Q \\| A B\\).\n\nSolution 2. Let \\(B D\\) and \\(A C\\) intersect at \\(T\\) and let the line through \\(P\\) parallel to \\(A B\\) intersect \\(B D\\) at \\(V\\). Next, let \\(Q^{\\prime}\\) be the foot of the perpendicular from \\(T\\) to \\(P V\\). Finally, let \\(Q^{\\prime} A\\) intersect circle \\(A B C\\) again at \\(X^{\\prime}\\) and \\(Q^{\\prime} B\\) intersect circle \\(A B D\\) again at \\(Y^{\\prime}\\).\n![](https://cdn.mathpix.com/cropped/2025_08_23_9a42685711bc262db31dg-074.jpg?height=800&width=1243&top_left_y=445&top_left_x=414)\n\nClaim. \\(P Q^{\\prime}\\) bisects \\(\\angle B Q^{\\prime} D\\) externally.\nProof. Let \\(P T\\) intersect \\(C D\\) at \\(L\\). Let \\(\\infty_{C D}\\) be the point at infinity on line \\(C D\\). From the standard Ceva-Menelaus configuration we have ( \\(D, C ; L, \\infty_{C D}\\) ) is harmonic. Hence projecting through \\(P\\) we have\n\\[\n-1=\\left(D, C ; L, \\infty_{C D}\\right)=(D, B ; T, V) .\n\\]\n\nAs ( \\(D, B ; T, V\\) ) is harmonic, and also \\(\\angle V Q^{\\prime} T=90^{\\circ}\\) (by construction), the claim follows.\nNow as\n\\[\n\\angle Q^{\\prime} P D=\\angle B A D=180^{\\circ}-\\angle D Y^{\\prime} B=180^{\\circ}-\\angle D Y^{\\prime} Q^{\\prime}\n\\]\nwe have \\(Q^{\\prime} P D Y^{\\prime}\\) cyclic. By the claim, we have that \\(P\\) is the midpoint of \\(\\operatorname{arc} \\widetilde{D Q^{\\prime} Y^{\\prime}}\\), so \\(P D=P Y^{\\prime}\\).\n\nSince \\(Y\\) is the unique point not equal to \\(D\\) on circle \\(A B D\\) satisfying \\(P D=P Y\\), we have \\(Y^{\\prime}=Y\\).\n\nLikewise \\(X^{\\prime}=X\\) so \\(Q^{\\prime}=Q\\) and we are done.\n\nSolution 3. Let \\(A X\\) intersect circle \\(P C X\\) for the second time at \\(Q^{\\prime}\\). Then\n\\[\n\\angle A Q^{\\prime} P=\\angle X Q^{\\prime} P=\\angle X C P=\\angle X C B=180^{\\circ}-\\angle B A X=\\angle Q^{\\prime} A B\n\\]\nso \\(P Q^{\\prime}\\) is parallel to \\(A B\\). Hence, it suffices to show that \\(Q^{\\prime}\\) is equal to \\(Q\\). To do so, we aim to show the common chord of circles \\(P C X\\) and \\(P D Y\\) is parallel to \\(A B\\), since then by symmetry \\(Q^{\\prime}\\) is also the second intersection of \\(B Y\\) and circle \\(P D Y\\).\n![](https://cdn.mathpix.com/cropped/2025_08_23_9a42685711bc262db31dg-075.jpg?height=926&width=1223&top_left_y=642&top_left_x=394)\n\nLet the centres of circles \\(P C X\\) and \\(P D Y\\) be \\(O_{X}\\) and \\(O_{Y}\\), respectively. Let the centres of circles \\(A B C\\) and \\(A B D\\) be \\(O_{C}\\) and \\(O_{D}\\), respectively.\n\nNote \\(P, O_{X}\\), and \\(O_{C}\\) are collinear since they all lie on the perpendicular bisector of \\(C X\\). Likewise \\(P, O_{Y}\\), and \\(O_{D}\\) are collinear on the perpendicular bisector of \\(D Y\\). By considering the projections of \\(O_{X}\\) and \\(O_{C}\\) onto \\(B C\\), and \\(O_{Y}\\) and \\(O_{D}\\) onto \\(A D\\), we have\n\\[\n\\frac{P O_{X}}{P O_{C}}=\\frac{\\frac{P C}{2}}{\\frac{P B+P C}{2}}=\\frac{\\frac{P D}{2}}{\\frac{P A+P D}{2}}=\\frac{P O_{Y}}{P O_{D}} .\n\\]\n\nHence \\(O_{X} O_{Y}\\) is parallel to \\(O_{C} O_{D}\\), which is perpendicular to \\(A B\\) as desired.", "source_pdf": "imosl_2024.pdf", "notes": "fallback-regex"}
{"id": "IMOSL-2024-G5", "contest": "IMOSL", "year": "2024", "problem_number": "G5", "problem": "Let \\(A B C\\) be a triangle with incentre \\(I\\), and let \\(\\Omega\\) be the circumcircle of triangle \\(B I C\\). Let \\(K\\) be a point in the interior of segment \\(B C\\) such that \\(\\angle B A K<\\angle K A C\\). The angle bisector of \\(\\angle B K A\\) intersects \\(\\Omega\\) at points \\(W\\) and \\(X\\) such that \\(A\\) and \\(W\\) lie on the same side of \\(B C\\), and the angle bisector of \\(\\angle C K A\\) intersects \\(\\Omega\\) at points \\(Y\\) and \\(Z\\) such that \\(A\\) and \\(Y\\) lie on the same side of \\(B C\\).\n\nProve that \\(\\angle W A Y=\\angle Z A X\\).\n(Uzbekistan)", "solution": "Common remarks. The key step in each\n\nis to prove that \\(\\angle Z A K=\\angle I A Y\\) and \\(\\angle W A K=\\angle I A X\\). The problem is implied by these equalities, as we then have that\n\\[\n\\angle W A Y=\\angle W A K+\\angle K A I+\\angle I A Y=\\angle I A X+\\angle K A I+\\angle Z A K=\\angle Z A X .\n\\]\n![](https://cdn.mathpix.com/cropped/2025_08_23_9a42685711bc262db31dg-076.jpg?height=772&width=626&top_left_y=885&top_left_x=719)\n\nWe now present several proofs that \\(\\angle Z A K=\\angle I A Y\\), with \\(\\angle W A K=\\angle I A X\\) following in an analogous manner.\n\nSolution 1. Let \\(\\Gamma\\) be circle \\(A B C\\) and \\(\\omega\\) be circle \\(A Y Z\\). Let \\(O, M\\), and \\(S\\) be the centres of \\(\\Gamma, \\Omega\\), and \\(\\omega\\), respectively. Let \\(A K\\) intersect \\(\\Gamma\\) again at \\(P\\), and let the angle bisector of \\(\\angle Z A Y\\) intersect \\(\\omega\\) again at \\(N\\).\n![](https://cdn.mathpix.com/cropped/2025_08_23_9a42685711bc262db31dg-076.jpg?height=797&width=840&top_left_y=1993&top_left_x=605)\n\nBy power of a point from \\(K\\) to \\(\\Gamma\\) and \\(\\Omega\\), we have that \\(K A \\cdot K P=K B \\cdot K C=K Y \\cdot K Z\\), so \\(P\\) also lies on \\(\\omega\\). The pairwise common chords of \\(\\Gamma, \\Omega\\), and \\(\\omega\\) are then \\(A P \\perp O S, B C \\perp O M\\), and \\(Y Z \\perp M S\\), so we have that \\(\\angle O M S=\\angle C K Y=\\angle Y K A=\\angle M S O\\). As \\(M\\) lies on \\(\\Gamma\\) and \\(O M=O S, S\\) also lies on \\(\\Gamma\\). Note that \\(N\\) lies on \\(M S\\) as \\(N Y=N Z\\), so\n\\[\n\\angle P A N=\\frac{1}{2} \\angle P S N=\\frac{1}{2} \\angle P S M=\\frac{1}{2} \\angle P A M .\n\\]\n\nThus, \\(A N\\) bisects \\(\\angle P A M\\) in addition to \\(\\angle Z A Y\\), which means that \\(\\angle Z A K=\\angle I A Y\\) as \\(K\\) lies on \\(A P\\) and \\(I\\) lies on \\(A M\\).\n\nSolution 2. Define \\(M\\) and \\(P\\) as in Solution 1, and recall that \\(A Y P Z\\) is cyclic. Let \\(Q\\) be the second intersection of the line parallel to \\(B C\\) through \\(P\\) with circle \\(A B C\\) and let \\(J\\) be the incentre of triangle \\(A P Q\\).\n![](https://cdn.mathpix.com/cropped/2025_08_23_9a42685711bc262db31dg-077.jpg?height=712&width=838&top_left_y=948&top_left_x=605)\n\nSince \\(P Q\\) is parallel to \\(B C\\) and \\(\\angle B A P<\\angle P A C\\), the angle bisector of \\(\\angle A P Q\\) is parallel to the angle bisector of \\(\\angle A K C\\). Hence, \\(P J\\) is parallel to \\(Y Z\\). As \\(M\\) is the midpoint of \\(\\overparen{P Q}\\) on circle \\(A P Q\\), we have that \\(M P=M J\\). Then since segments \\(Y Z\\) and \\(P J\\) are parallel and have a common point \\(M\\) on their perpendicular bisectors, \\(P J Y Z\\) is cyclic with \\(J Y=P Z\\). It follows that \\(J\\) also lies on circle \\(A Y P Z\\) and that \\(\\angle Z A P=\\angle J A Y=\\angle I A Y\\).\n\nComment. The proof of the analogous case of \\(\\angle W A K=\\angle I A X\\) is slightly different. In this case, \\(J\\) should be defined as the \\(A\\)-excentre of \\(A P Q\\) so that \\(P J\\) is the external bisector of \\(\\angle A P Q\\) and \\(P J \\| W X\\). The proof is otherwise exactly the same.\n\nSolution 3. As in the previous solutions, let \\(M\\) be the centre of \\(\\Omega\\). Let \\(L\\) be the intersection of \\(A M\\) and \\(B C\\), and let \\(L^{\\prime}\\) be the reflection of \\(L\\) over \\(Y Z\\). Let the circle \\(M Y Z\\) intersect \\(A M\\) again at \\(T\\).\n![](https://cdn.mathpix.com/cropped/2025_08_23_9a42685711bc262db31dg-078.jpg?height=735&width=875&top_left_y=445&top_left_x=593)\n\nNote that as \\(M\\) is the midpoint of \\(\\overparen{B C}\\) on circle \\(A B C\\) and \\(L\\) is the foot of the bisector of \\(\\angle B A C\\), we have that \\(M A \\cdot M L=M I^{2}=M Y^{2}\\). It follows by power of a point that \\(M Y\\) is tangent to circle \\(A L Y\\), so \\(\\angle L A Y=\\angle L Y M\\). Using directed angles, we then have that\n\\[\n\\Varangle A Y T=\\Varangle M T Y-\\Varangle M A Y=\\Varangle M Z Y-\\Varangle L Y M=\\Varangle Z Y M-\\Varangle L Y M=\\Varangle Z Y L=\\Varangle L^{\\prime} Y Z,\n\\]\nwhere we use the fact that \\(M Y=M Z\\) and that \\(L\\) and \\(L^{\\prime}\\) are symmetric about \\(Y Z\\). Thus, \\(Y T\\) and \\(Y L^{\\prime}\\) are isogonal in \\(\\angle A Y Z\\). Analogously, we have that \\(Z T\\) and \\(Z L^{\\prime}\\) are isogonal in \\(\\angle Y Z A\\). This means that \\(T\\) and \\(L^{\\prime}\\) are isogonal conjugates in triangle \\(A Y Z\\), which allows us to conclude that \\(\\angle Z A K=\\angle I A Y\\) since \\(L^{\\prime}\\) lies on \\(A K\\) and \\(T\\) lies on \\(A I\\).\n\nComment. Owing to the condition \\(\\angle B A K<\\angle K A C\\), points \\(L^{\\prime}\\) and \\(T\\) lie inside triangle \\(A Y Z\\). However, if one tries to write down the same proof for \\(\\angle W A K=\\angle I A X\\), the analogues \\(L_{1}^{\\prime}\\) and \\(T_{1}\\) of \\(L^{\\prime}\\) and \\(T\\) would lie outside triangle \\(A W X\\). Thus, the solution has been written using directed angles so that it applies directly to this case as well. It is also possible that \\(L_{1}^{\\prime}\\) lies on circle \\(A W X\\) and \\(T_{1}\\) is a point at infinity. In this case, it is straightforward to interpret the directed angle chase to prove the isogonality, and the isogonality also follows from this scenario being a limit case of other configurations.\n\nNote. The original proposal remarks that this problem is a special case of a more general property:\n\\(A\\) convex quadrilateral \\(A B C D\\) is inscribed in a circle \\(\\omega\\). The bisectors between \\(A C\\) and \\(B D\\) intersect \\(\\omega\\) at four points, forming a convex quadrilateral PQRS. Then the conditions\n\\[\nX A \\cdot X C=X B \\cdot X D \\quad \\text { and } \\quad \\npreceq(X P, X Q)=\\Varangle(X S, X R)\n\\]\non point \\(X\\) are equivalent.\nThe Problem Selection Committee believes that the proof of this generalisation is beyond the scope of the competition and considers the original problem to be more suitable.", "source_pdf": "imosl_2024.pdf", "notes": "fallback-regex"}
{"id": "IMOSL-2024-G6", "contest": "IMOSL", "year": "2024", "problem_number": "G6", "problem": "Let \\(A B C\\) be an acute triangle with \\(A B<A C\\), and let \\(\\Gamma\\) be the circumcircle of \\(A B C\\). Points \\(X\\) and \\(Y\\) lie on \\(\\Gamma\\) so that \\(X Y\\) and \\(B C\\) intersect on the external angle bisector of \\(\\angle B A C\\). Suppose that the tangents to \\(\\Gamma\\) at \\(X\\) and \\(Y\\) intersect at a point \\(T\\) on the same side of \\(B C\\) as \\(A\\), and that \\(T X\\) and \\(T Y\\) intersect \\(B C\\) at \\(U\\) and \\(V\\), respectively. Let \\(J\\) be the centre of the excircle of triangle \\(T U V\\) opposite the vertex \\(T\\).\n\nProve that \\(A J\\) bisects \\(\\angle B A C\\).\n(Poland)", "solution": "1. Let \\(N\\) be the midpoint of \\(\\widetilde{B A C}\\) on \\(\\Gamma\\), and let \\(N X\\) and \\(N Y\\) intersect \\(B C\\) at \\(W\\) and \\(Z\\), respectively.\nClaim. Quadrilateral \\(W X Y Z\\) is cyclic, and its circumcentre is \\(J\\).\nProof. As \\(N\\) is the midpoint of \\(\\widehat{B A C}, W\\) and \\(Z\\) lie on \\(B C\\), and \\(X\\) and \\(Y\\) are the second intersections of \\(N W\\) and \\(N Z\\) with \\(\\Gamma\\), we have that \\(W X Y Z\\) is cyclic.\n\nLet the parallel to \\(B C\\) through \\(N\\) intersect \\(T U\\) and \\(T V\\) at \\(U^{\\prime}\\) and \\(V^{\\prime}\\), respectively. Then \\(U^{\\prime}\\) is the intersection of the tangents to \\(\\Gamma\\) at \\(N\\) and \\(X\\), so \\(U^{\\prime} N=U^{\\prime} X\\). As \\(N U^{\\prime} \\| B C, U^{\\prime} N X\\) is similar to \\(U W X\\), so \\(U W=U X\\) as well. Hence, the perpendicular bisector of \\(W X\\) is the internal bisector of \\(\\angle X U W\\), which is the external bisector of \\(\\angle V U T\\). Analogously, the perpendicular bisector of \\(Y Z\\) is the external bisector of \\(\\angle T V U\\). This means that the circumcentre of \\(W X Y Z\\) is the intersection of the external bisectors of \\(\\angle V U T\\) and \\(\\angle T V U\\), which is \\(J\\).\n![](https://cdn.mathpix.com/cropped/2025_08_23_9a42685711bc262db31dg-080.jpg?height=983&width=1646&top_left_y=1353&top_left_x=208)\n\nLet \\(A N\\) intersect \\(B C\\) at \\(L\\), so \\(X Y\\) passes through \\(L\\) as well. By power of a point from \\(L\\) to \\(\\Gamma\\) and circle \\(W X Y Z\\), we have that \\(L A \\cdot L N=L X \\cdot L Y=L W \\cdot L Z\\), so \\(W A N Z\\) is also cyclic. Thus, \\(A\\) is the Miquel point of quadrilateral \\(W X Y Z\\). As \\(W X Y Z\\) is cyclic with circumcentre \\(J\\) and its opposite sides \\(W X\\) and \\(Y Z\\) intersect at \\(N\\), we have that \\(A N \\perp A J\\). Since \\(A N\\) is the external bisector of \\(\\angle B A C\\), this implies that \\(A J\\) is the internal bisector of \\(\\angle B A C\\).\n\nSolution 2. Let the internal and external angle bisectors of \\(\\angle B A C\\) intersect \\(B C\\) at \\(K\\) and \\(L\\), respectively. Let \\(A K\\) intersect circle \\(A B C\\) again at \\(M\\), and let \\(D\\) be the intersection of the tangents to \\(\\Gamma\\) at \\(B\\) and \\(C\\). Let \\(\\Omega\\) be the \\(T\\)-excircle of \\(T U V\\), and let \\(\\omega\\) be the incircle of \\(D B C\\). Claim. The points \\(T, K\\), and \\(D\\) are collinear.\nProof. Note that \\(B C\\) and \\(X Y\\) are the polars of \\(T\\) and \\(D\\) with respect to \\(\\Gamma\\). By La Hire's Theorem, \\(T D\\) is the polar of \\(L\\) with respect to \\(\\Gamma\\). As \\((B, C ; K, L)=-1, K\\) also lies on the polar of \\(L\\), thus proving the collinearity.\nClaim. The incentre of \\(D B C\\) is \\(M\\).\nProof. We have that \\(\\angle M B C=\\angle M A C=\\frac{1}{2} \\angle B A C=\\frac{1}{2} \\angle D B C\\), so \\(B M\\) bisects \\(\\angle D B C\\). Similarly, \\(C M\\) bisects \\(\\angle B C D\\), so \\(M\\) is the incentre of \\(D B C\\).\n![](https://cdn.mathpix.com/cropped/2025_08_23_9a42685711bc262db31dg-081.jpg?height=983&width=1421&top_left_y=862&top_left_x=376)\n\nClaim. The intersection of the common external tangents of \\(\\Omega\\) and \\(\\omega\\) is \\(K\\).\nProof. Let \\(K^{\\prime}\\) be the intersection of the common external tangents of \\(\\Omega\\) and \\(\\omega\\). As \\(\\Omega\\) and \\(\\omega\\) are both tangent to \\(B C\\) and lie on the same side of \\(B C\\) opposite to \\(A, K^{\\prime}\\) lies on \\(B C\\). As \\(T\\) is the intersection of the common external tangents of \\(\\Gamma\\) and \\(\\Omega\\) and \\(D\\) is the intersection of the common external tangents of \\(\\Gamma\\) and \\(\\omega\\), by Monge's theorem \\(K^{\\prime}\\) lies on \\(T D\\). As \\(K^{\\prime}\\) lies on both \\(B C\\) and \\(T D\\), it is the same point as \\(K\\).\n\nHence, \\(K\\) is collinear with the centres of \\(\\Omega\\) and \\(\\omega\\), which are \\(M\\) and \\(J\\), respectively. As \\(K\\) and \\(M\\) both lie on the bisector of \\(\\angle B A C\\), so does \\(J\\).\n\nNote. It can be shown that circles \\(A U V\\) and \\(A B C\\) are tangent and that the tangents from \\(U\\) and \\(V\\) to circle \\(A B C\\) different from \\(T U\\) and \\(T V\\) intersect at a point \\(W\\) on line \\(T K\\). Reframing the problem in terms of quadrilateral \\(T U W V\\) using these properties, we obtain the following problem:\n\nLet \\(A B C D\\) be a convex quadrilateral with an incircle \\(\\omega\\), and let \\(A C\\) and \\(B D\\) intersect at \\(P\\). Point \\(E\\) lies on \\(\\omega\\) such that the circumcircle of \\(A C E\\) is tangent to \\(\\omega\\). Prove that if \\(B\\) and \\(E\\) lie on the same side of line \\(A C\\), then the centre of the excircle of triangle \\(A B C\\) opposite the vertex \\(B\\) lies on line \\(E P\\).\n\nWhile this is an appealing statement, the Problem Selection Committee is uncertain about its difficulty and whether it has solutions that do not proceed by reducing to the original problem. Thus, it is believed that the original statement is more suitable for the competition.", "source_pdf": "imosl_2024.pdf", "notes": "fallback-regex"}
{"id": "IMOSL-2024-G7", "contest": "IMOSL", "year": "2024", "problem_number": "G7", "problem": "Let \\(A B C\\) be a triangle with incentre \\(I\\) such that \\(A B<A C<B C\\). The second intersections of \\(A I, B I\\), and \\(C I\\) with the circumcircle of triangle \\(A B C\\) are \\(M_{A}, M_{B}\\), and \\(M_{C}\\), respectively. Lines \\(A I\\) and \\(B C\\) intersect at \\(D\\) and lines \\(B M_{C}\\) and \\(C M_{B}\\) intersect at \\(X\\). Suppose the circumcircles of triangles \\(X M_{B} M_{C}\\) and \\(X B C\\) intersect again at \\(S \\neq X\\). Lines \\(B X\\) and \\(C X\\) intersect the circumcircle of triangle \\(S X M_{A}\\) again at \\(P \\neq X\\) and \\(Q \\neq X\\), respectively.\n\nProve that the circumcentre of triangle \\(S I D\\) lies on \\(P Q\\).\n(Thailand)\n\n\\section*{", "solution": "1.}\n![](https://cdn.mathpix.com/cropped/2025_08_23_9a42685711bc262db31dg-082.jpg?height=1329&width=1044&top_left_y=759&top_left_x=513)\n\nLet \\(O\\) be the circumcentre of \\(\\triangle A B C\\). First we note from standard properties of the Miquel point \\(S\\) we have:\n- \\(\\triangle S M_{C} M_{B} \\sim \\triangle S B C \\sim \\triangle S P Q ; \\quad(*)\\)\n- \\(I\\) and \\(S\\) are inverses with respect to circle \\(A B C\\);\n- \\(\\angle O S X=90^{\\circ}\\).\n\nClaim 1. \\(\\angle M_{A} P B=\\angle C D A\\).\nProof. From the above we have \\(\\triangle O M_{A} I \\sim \\triangle O S M_{A}\\) and\n\\[\n\\angle M_{A} P B=\\angle M_{A} P X=\\angle M_{A} S X=90^{\\circ}+\\angle M_{A} S O=90^{\\circ}+\\angle O M_{A} I=\\angle M_{A} B A=\\angle C D A \\text {. }\n\\]\n\nClaim 2. \\(\\quad \\frac{M_{C} B}{B P}=\\frac{M_{B} C}{C Q}=\\frac{A I}{I D}\\).\nProof. Observe that \\(\\angle P M_{C} M_{A}=\\angle B M_{C} M_{A}=\\angle D A C\\) and \\(\\angle M_{C} M_{A} B=\\angle I C D\\). Combining these with Claim 1 shows \\(M_{C} P M_{A} B \\sim A D C I\\). Therefore, \\(\\frac{M_{C} B}{B P}=\\frac{A I}{I D}\\). Similarly, \\(\\frac{M_{B} C}{C Q}=\\frac{A I}{I D}\\).\n\nClaim 3. \\(\\quad \\frac{D P}{D Q}=\\frac{I B}{I C}\\).\nProof. Firstly, observe that \\(\\angle I C B=\\angle A M_{B} M_{C}\\) and \\(\\angle C B I=\\angle M_{B} M_{C} A\\) which gives that \\(\\triangle I B C \\sim \\triangle A M_{C} M_{B}\\). This, combined with Claim 2, is enough to show \\(\\triangle D P Q \\sim \\triangle I B C\\) by linearity, proving the claim.\nClaim 4. \\(\\frac{I P}{I Q}=\\frac{I B}{I C}\\).\nProof. Combining \\(\\triangle I B M_{C} \\sim \\triangle I C M_{B}\\) with Claim 2 shows \\(I B M_{C} P \\sim I C M_{B} Q\\) giving the result.\n\nFinally, we have that\n\\[\n\\frac{S P}{S Q}=\\frac{S B}{S C}=\\frac{B M_{C}}{C M_{B}}=\\frac{I B}{I C}\n\\]\nfrom (*) and \\(\\triangle I B M_{C} \\sim \\triangle I C M_{B}\\). Putting this together with Claims 3 and 4, we have that\n\\[\n\\frac{I B}{I C}=\\frac{D P}{D Q}=\\frac{I P}{I Q}=\\frac{S P}{S Q}\n\\]\nwhich shows that circle \\(S I D\\) is an Apollonius circle with respect to \\(P\\) and \\(Q\\), giving the desired conclusion.\n\nComment. The condition \\(A B<A C\\) ensures \\(S \\neq X\\). We also need to avoid the case \\(\\angle B A C=60^{\\circ}\\) as then \\(B M_{C} \\| C M_{B}\\).\n\nSolution 2. We use Claim 1 from Solution 1. We will show that \\(P\\) and \\(Q\\) are inverses in circle \\(S I D\\) which implies the result. Perform an inversion in circle \\(B I C\\) and denote the inverse of a point \\(\\bullet\\) by \\(\\bullet^{\\prime}\\).\n![](https://cdn.mathpix.com/cropped/2025_08_23_9a42685711bc262db31dg-084.jpg?height=1438&width=1332&top_left_y=416&top_left_x=368)\n\nClaim 1. \\(\\quad S^{\\prime}=J\\) where \\(J\\) is the reflection of \\(I\\) across \\(B C\\).\nProof. We have that \\(S\\) and \\(I\\) are inverses in circle \\(A B C\\). Inverting this assertion in circle \\(B I C\\) shows that \\(S^{\\prime}\\) and \\(I\\) are inverses with respect to line \\(B C\\), which is just a reflection in line \\(B C\\).\n\nLet \\(Y=M_{B} M_{C} \\cap B C\\). From \\(\\angle I M_{C} M_{B}=\\angle M_{B} M_{C} A\\) and \\(\\angle A M_{B} M_{C}=\\angle M_{C} M_{B} I\\), we see that \\(A\\) and \\(I\\) are reflections in line \\(M_{B} M_{C}\\) so \\(Y A=Y I\\). We have that circle \\(S I D\\) maps to circle \\(A I J\\) which, from the previous comment, has centre \\(Y\\). Inverting the conclusion that \\(P\\) and \\(Q\\) are inverses with respect to circle \\(S I D\\) in circle \\(B I C\\), it suffices to show \\(P^{\\prime}\\) and \\(Q^{\\prime}\\) are inverses with respect to circle \\(A I J\\) or equivalently, that \\(Y P^{\\prime} \\cdot Y Q^{\\prime}=Y A^{2}\\).\nClaim 2. Circle \\(X S M_{A}\\) maps to line \\(Y J\\) under the inversion in circle \\(B I C\\).\nProof. Since circle \\(B I C\\) has centre \\(M_{A}\\), the inverse of this circle is a line. By Claim 1, this line passes through \\(J\\) hence it suffices to prove that circle \\(X S M_{A}\\) passes through \\(Y^{\\prime}\\). From inverting line \\(B C\\) in circle \\(B I C\\), we have that \\(B C M_{A} Y^{\\prime}\\) is cyclic so\n\\[\nY S \\cdot Y X=Y B \\cdot Y C=Y Y^{\\prime} \\cdot Y M_{A} .\n\\]\nwhere we have used that \\(Y, S\\) and \\(X\\) are collinear by a standard property of the Miquel point. Hence \\(Y^{\\prime}\\) lies on circle \\(X S M_{A}\\) as required.\n\nLet \\(A_{1}\\) be the reflection of \\(A\\) in the perpendicular bisector of \\(B C\\). Using Claim 1 from Solution 1,\n\\[\n\\angle P^{\\prime} B M_{A}=\\angle M_{A} P B=\\angle C D A=180^{\\circ}-\\angle A C M_{A}=180^{\\circ}-\\angle M_{A} B A_{1} .\n\\]\n\nHence, \\(P^{\\prime}, B\\), and \\(A_{1}\\) are collinear. Similarly \\(Q^{\\prime}, C\\), and \\(A_{1}\\) are collinear. Let \\(P_{1}\\) and \\(Q_{1}\\) be the reflections of \\(P^{\\prime}\\) and \\(Q^{\\prime}\\) across \\(B C\\). As \\(P^{\\prime}\\) and \\(Q^{\\prime}\\) lie on line \\(Y J\\), it follows that \\(P_{1}\\) and \\(Q_{1}\\) lie on line \\(Y I\\). Also from the previous collinearities, we get \\(B P_{1} \\| A C\\) and \\(C Q_{1} \\| A B\\).\n\nWe have now reduced the problem to the following:\nClaim 3 (Inverted Problem). Let \\(A B C\\) be a triangle with incentre \\(I\\). Let \\(Y\\) be the point on \\(B C\\) such that \\(Y A=Y I\\). Let \\(P_{1}\\) and \\(Q_{1}\\) be points on \\(Y I\\) such that \\(B P_{1} \\| A C\\) and \\(C Q_{1} \\| A B\\). Then \\(Y A^{2}=Y P_{1} \\cdot Y Q_{1}\\).\n![](https://cdn.mathpix.com/cropped/2025_08_23_9a42685711bc262db31dg-085.jpg?height=535&width=1223&top_left_y=873&top_left_x=419)\n\nProof. Let \\(Y I\\) intersect \\(A B\\) and \\(A C\\) at \\(E\\) and \\(F\\), respectively. From the parallel lines, we get that \\(\\triangle B E P_{1}\\) and \\(\\triangle C Q_{1} F\\) are homothetic with centre \\(Y\\). Thus we have\n\\[\n\\frac{Y E}{Y P_{1}}=\\frac{Y Q_{1}}{Y F} \\Longrightarrow Y P_{1} \\cdot Y Q_{1}=Y E \\cdot Y F\n\\]\n\nMoreover, \\(A I\\) bisects \\(\\angle E A F\\) and \\(Y A=Y I\\) so the circle centred at \\(Y\\) with radius \\(Y A\\) is the Apollonius circle of \\(\\triangle A E F\\) with respect to the feet of the internal and external angle bisectors at \\(A\\). This gives \\(Y E \\cdot Y F=Y A^{2}\\). Combining these results proves the claim.\n\nSolution 3. As in Solution 1, let \\(O\\) be the circumcentre of \\(\\triangle A B C\\). Let \\(X I\\) intersect circle \\(X S M_{A}\\) again at \\(Z \\neq X\\) and let \\(Y=B C \\cap M_{B} M_{C}\\). Let \\(X^{*}\\) be the inverse of \\(X\\) in circle \\(A B C\\). We will use the properties of Miquel point \\(S\\) noted at the top of Solution 1 and in addition, that \\(S\\) lies on line \\(X Y\\).\n![](https://cdn.mathpix.com/cropped/2025_08_23_9a42685711bc262db31dg-086.jpg?height=1455&width=1329&top_left_y=482&top_left_x=371)\n\nClaim 1. YSAD is cyclic.\nProof. From \\(O M_{A} \\perp B C\\) and \\(Y S \\perp O S\\) we have \\(\\angle D Y S=180^{\\circ}-\\angle S O M_{A}\\). From inverting collinear points \\(A, I\\) and \\(M_{A}\\) in circle \\(A B C\\) we get \\(A S M_{A} O\\) is cyclic which gives\n\\[\n\\angle S O M_{A}=\\angle S A M_{A}=\\angle S A D \\Longrightarrow \\angle S A D+\\angle D Y S=180^{\\circ}\n\\]\nproving the claim.\nClaim 2. \\(\\quad X^{*}\\) lies on circle BIC which has centre \\(M_{A}\\).\nProof. This follows immediately from inverting circle \\(S B C X\\) in circle \\(A B C\\).\nClaim 3. \\(Z\\) lies on circle SID.\nProof. We have that\n\\[\n\\angle I Z S=\\angle X M_{A} S=\\angle O M_{A} S-\\angle O M_{A} X=\\angle M_{A} I O-\\angle M_{A} X^{*} O=\\angle D I O-\\angle M_{A} X^{*} O\n\\]\nwhere in the penultimate step we inverted in circle \\(A B C\\) to get the angle equalities.\n\nFrom Brocard's Theorem applied to cyclic quadrilateral \\(B M_{C} M_{B} C\\), we get \\(Y, I\\), and \\(X^{*}\\) collinear and \\(\\angle Y X^{*} O=90^{\\circ}\\). This gives that\n\\[\n\\angle M_{A} X^{*} O=90^{\\circ}-\\angle I X^{*} M_{A}=90^{\\circ}-\\angle M_{A} I X^{*}=90^{\\circ}-\\angle A I Y\n\\]\nwhere the second equality is by Claim 2. We have that \\(A\\) and \\(I\\) are reflections in line \\(M_{B} M_{C}\\). Hence,\n\\[\n90^{\\circ}-\\angle A I Y=90^{\\circ}-\\angle Y A D=90^{\\circ}-\\angle Y S D=\\angle D S O\n\\]\nwhere the second step is by Claim 1, and in the last step we are using \\(O S \\perp Y S\\). Putting these together,\n\\[\n\\angle I Z S=\\angle D I O-\\angle D S O=\\angle I D S\n\\]\nproving the claim.\nLet the tangents from \\(S\\) and \\(Z\\) to circle \\(X S M_{A}\\) intersect at \\(K\\). Observe from the standard Ceva-Menelaus configuration,\n\\[\n-1=(X Y, X I ; X B, X C) \\stackrel{X}{=}(S, Z ; P, Q) .\n\\]\n\nThis shows that \\(K\\) lies on line \\(P Q\\). We then have\n\\[\n\\angle Z K S=180^{\\circ}-2 \\angle S X Z=2\\left(90^{\\circ}-\\angle S X I\\right)=2\\left(180^{\\circ}-\\angle S I Z\\right),\n\\]\nwhere we are using \\(\\angle I S X=90^{\\circ}\\). As \\(K\\) lies on the perpendicular bisector of \\(S Z\\), this is enough to show that \\(K\\) is the centre of circle \\(S I D Z\\) completing the proof.\n\nSolution 4. Solution 1 solves the problem by establishing \\(\\frac{S P}{S Q}=\\frac{I P}{I Q}=\\frac{D P}{D Q}\\), which implies that circle \\(S I D\\) is an Apollonius circle with respect to \\(P\\) and \\(Q\\). We demonstrate an alternate approach that only requires us to show two of the ratios \\(\\frac{S P}{S Q}, \\frac{I P}{I Q}\\), and \\(\\frac{D P}{D Q}\\) to be equal. This can arise from missing some of the observations in Solution 1, for example not proving Claim 3.\nClaim. Given we have shown two of the ratios listed above to be equal, it suffices to show that circle \\(S I D\\) is orthogonal to circle \\(S X M_{A}\\), which the same circle as \\(S P Q\\).\nProof. Supposing we have shown the orthogonality, if \\(\\frac{S P}{S Q}=\\frac{I P}{I Q}\\) or \\(\\frac{S P}{S Q}=\\frac{D P}{D Q}\\), then we immediately have that circle \\(S I D\\) is an Apollonius circle with respect to \\(P\\) and \\(Q\\). If \\(\\frac{I P}{I Q}=\\frac{D P}{D Q}\\) and \\(S\\) does not lie on the Apollonius circle \\(\\mathcal{C}\\) defined by this common ratio, then \\(I\\) and \\(D\\) lie on two distinct circles orthogonal to circle \\(S P Q\\), namely circle \\(S I D\\) and \\(\\mathcal{C}\\). This implies that \\(I\\) and \\(D\\) are inverses with respect to circle \\(S P Q\\), which is a contradiction as both \\(I\\) and \\(D\\) lie inside circle \\(S P Q\\).\n\nThroughout this solution, we will use the properties of \\(S\\) from the beginning of Solution 1. Define \\(O\\) and \\(Y\\) as in previous solutions, and let \\(E\\) be the second intersection of circles \\(S O M_{A}\\) and \\(S M_{B} M_{C}\\).\n![](https://cdn.mathpix.com/cropped/2025_08_23_9a42685711bc262db31dg-088.jpg?height=1078&width=1014&top_left_y=1073&top_left_x=511)\n\n\\section*{Lemma. We have that \\(O E \\perp A Y\\).}\n\nProof. Let \\(M_{A}^{\\prime}, B^{\\prime}\\), and \\(C^{\\prime}\\) be the respective reflections of \\(M_{A}, B\\), and \\(C\\) over line \\(M_{B} M_{C}\\). As noted in Solution 3, \\(A\\) and \\(I\\) are reflections across \\(M_{B} M_{C}\\). Because \\(M_{A}\\) is the centre of circle \\(B I C\\), it follows that \\(M_{A}^{\\prime}\\) is the centre of circle \\(A B^{\\prime} C^{\\prime}\\). On the other hand, \\(Y\\) lies on \\(M_{B} M_{C}\\), so we have that \\(Y B \\cdot Y C=Y B^{\\prime} \\cdot Y C^{\\prime}\\). Thus, \\(Y\\) lies on the radical axis of circles \\(A B C\\) and \\(A B^{\\prime} C^{\\prime}\\), so \\(O M_{A}^{\\prime} \\perp A Y\\). Finally, note that the inverses of circles \\(S O M_{A}\\) and \\(S M_{B} M_{C}\\) in circle \\(A B C\\) are line \\(I M_{A}\\) and circle \\(I M_{B} M_{C}\\) respectively, so \\(E\\) and \\(M_{A}^{\\prime}\\) are inverses in circle \\(A B C\\). Thus, \\(E\\) lies on \\(O M_{A}^{\\prime}\\) and the lemma follows.\n\nLet \\(\\mathcal{T}\\) denote the composition of an inversion at \\(S\\) with radius \\(\\sqrt{S I \\cdot S O}\\) with a reflection across line \\(S I\\). By standard properties of the Miquel point, \\(\\mathcal{T}\\) swaps \\(X\\) and \\(Y\\) and any points \\(Z_{1}\\) and \\(Z_{2}\\) on circle \\(A B C\\) with \\(I \\in Z_{1} Z_{2}\\). Hence, \\(\\mathcal{T}\\) swaps the pairs \\(\\left(A, M_{A}\\right),\\left(B, M_{B}\\right),\\left(C, M_{C}\\right)\\), \\((O, I)\\), and \\((X, Y)\\). As \\(D=A I \\cap B C\\) and \\(E\\) is the intersection of circles \\(S O M_{A}\\) and \\(S M_{B} M_{C}\\), we have that \\(\\mathcal{T}(D)=E\\). Thus, \\(\\mathcal{T}\\) maps circles SID and SXM \\({ }_{A}\\) to lines \\(O E\\) and \\(A Y\\), so by the Lemma, circles SID and SXM \\({ }_{A}\\) are orthogonal, as required.\n![](https://cdn.mathpix.com/cropped/2025_08_23_9a42685711bc262db31dg-089.jpg?height=1232&width=1035&top_left_y=582&top_left_x=513)", "source_pdf": "imosl_2024.pdf", "notes": "fallback-regex"}
{"id": "IMOSL-2024-G8", "contest": "IMOSL", "year": "2024", "problem_number": "G8", "problem": "Let \\(A B C\\) be a triangle with \\(A B<A C<B C\\), and let \\(D\\) be a point in the interior of segment \\(B C\\). Let \\(E\\) be a point on the circumcircle of triangle \\(A B C\\) such that \\(A\\) and \\(E\\) lie on opposite sides of line \\(B C\\) and \\(\\angle B A D=\\angle E A C\\). Let \\(I, I_{B}, I_{C}, J_{B}\\), and \\(J_{C}\\) be the incentres of triangles \\(A B C, A B D, A D C, A B E\\), and \\(A E C\\), respectively.\n\nProve that \\(I_{B}, I_{C}, J_{B}\\), and \\(J_{C}\\) are concyclic if and only if \\(A I, I_{B} J_{C}\\), and \\(J_{B} I_{C}\\) concur.\n(Canada)", "solution": "1. Let \\(X\\) be the intersection of \\(I_{B} J_{C}\\) and \\(J_{B} I_{C}\\). We will prove that, provided that \\(A B<A C<B C\\), the following two conditions are equivalent:\n(1) \\(A X\\) bisects \\(\\angle B A C\\);\n(2) \\(I_{B}, I_{C}, J_{B}\\), and \\(J_{C}\\) are concyclic.\n\nLet circles \\(A I B\\) and \\(A I C\\) meet \\(B C\\) again at \\(P\\) and \\(Q\\), respectively. Note that \\(A B=B Q\\) and \\(A C=C P\\) because the centres of circles \\(A I B\\) and \\(A I C\\) lie on \\(C I\\) and \\(B I\\), respectively. Thus, \\(B, P, Q\\), and \\(C\\) are collinear in this order as \\(B Q+P C=A B+A C>B C\\) by the triangle inequality.\nClaim 1. Points \\(P, J_{B}\\), and \\(I_{C}\\) are collinear, and points \\(Q, I_{B}\\), and \\(J_{C}\\) are collinear.\nProof. We have that\n\\[\n\\angle A J_{B} B=90^{\\circ}+\\frac{1}{2} \\angle A E B=90^{\\circ}+\\frac{1}{2} \\angle A C B=\\angle A I B=\\angle A P B,\n\\]\nso \\(A B J_{B} P\\) is cyclic. As \\(A\\) is the centre of spiral similarity between \\(A B E\\) and \\(A D C\\), it is also the centre of spiral similarity between \\(A B J_{B}\\) and \\(A D I_{C}\\). Hence, \\(A\\) is the Miquel point of self-intersecting quadrilateral \\(B D I_{C} J_{B}\\), so \\(P\\) lies on \\(J_{B} I_{C}\\). Analogously, we have that \\(Q\\) lies on \\(I_{B} J_{C}\\).\n![](https://cdn.mathpix.com/cropped/2025_08_23_9a42685711bc262db31dg-090.jpg?height=1018&width=994&top_left_y=1681&top_left_x=548)\n\nThroughout the rest of the solution, we will use directed angles.\n\nProof of (1) \\(\\Longrightarrow\\) (2). We assume that (1) holds.\nClaim 1 and the similarities \\(A B D I_{B} \\sim A E C J_{C}\\) and \\(A B E J_{B} \\sim A D C I_{C}\\) tell us that\n\\[\n\\Varangle I_{B} X I_{C}=\\Varangle J_{C} Q C+\\Varangle B P J_{B}=\\Varangle J_{C} A C+\\Varangle B A J_{B}=\\Varangle I_{B} A D+\\Varangle D A I_{C}=\\Varangle I_{B} A I_{C},\n\\]\nso \\(A I_{B} X I_{C}\\) is cyclic. Also, as \\(X \\in A I\\), we have that\n\\[\n\\Varangle I_{B} A X=\\Varangle B A I-\\Varangle B A I_{B}=\\Varangle I_{B} A I_{C}-\\Varangle I B_{A} D=\\Varangle D A I_{C} .\n\\]\n\nUsing these, we have that\n\\[\n\\Varangle I_{B} I_{C} P=\\Varangle I_{B} A X=\\Varangle D A I_{C}=\\Varangle B A J_{B}=\\Varangle B P J_{B},\n\\]\nso \\(I_{B} I_{C} \\| B C\\). Hence,\n\\[\n\\Varangle I_{B} I_{C} J_{B}=\\Varangle B P J_{B}=\\Varangle B I J_{B}=\\Varangle I_{B} I J_{B},\n\\]\nso \\(I I_{B} J_{B} I_{C}\\) is cyclic. Analogously, we have that \\(I I_{C} J_{C} I_{B}\\) is cyclic, so \\(I_{B} J_{B} J_{C} I_{C}\\) is cyclic, thus proving (2).\nProof of (2) \\(\\Longrightarrow\\) (1). We assume that (2) holds.\nClaim 2. Circles \\(I B C, I J_{B} I_{C}\\), and \\(I I_{B} J_{C}\\) are tangent at \\(I\\).\nProof. Using the cyclic quadrilateral \\(B I J_{B} P\\), we have that\n\\[\n\\Varangle I B C=\\Varangle I B P=\\Varangle I J_{B} P=\\Varangle I J_{B} I_{C} .\n\\]\n\nAs \\(C, I_{C}\\), and \\(I\\) are collinear, the tangents to circles \\(I_{B} I_{C}\\) and \\(I B C\\) at \\(I\\) coincide, so circles \\(I J_{B} I_{C}\\) and \\(I B C\\) are tangent at \\(I\\). Analogously, circles \\(I I_{B} J_{C}\\) and \\(I B C\\) are tangent at \\(I\\), so all three circles are tangent at \\(I\\).\nClaim 3. Point \\(I\\) lies on circle \\(I_{B} J_{B} J_{C} I_{C}\\).\nProof. Suppose that \\(I\\) does not lie on circle \\(I_{B} J_{B} J_{C} I_{C}\\). Then the circles \\(I I_{B} J_{C}, I J_{B} I_{C}\\), and \\(I_{B} J_{B} J_{C} I_{C}\\) are distinct. We apply the radical axis theorem to these three circles. By Claim 2, the radical axis of circles \\(I I_{B} J_{C}\\) and \\(I J_{B} I_{C}\\) is the tangent to circle \\(I B C\\) at \\(I\\). As \\(I_{B} J_{C}\\) and \\(J_{B} I_{C}\\) intersect at \\(X, I X\\) must be tangent to circle \\(I B C\\).\n\nHowever, by Claim 1 we have that \\(X\\) is the intersection of \\(P I_{C}\\) and \\(Q I_{B}\\). As \\(D\\) lies on the interior of segment \\(B C, I_{B}\\) lies on the interior of segment \\(B I\\) and \\(I_{C}\\) lies on the interior of segment \\(C I\\). Hence, \\(I_{B}, P, Q\\), and \\(I_{C}\\) all lie on the perimeter of triangle \\(I B C\\) in this order, so \\(X\\) must be in the interior of triangle \\(I B C\\). This means that \\(I X\\) cannot be tangent to circle \\(B I C\\), so \\(I\\) must lie on circle \\(I_{B} J_{B} J_{C} I_{C}\\).\n\nBy Claims 2 and 3, circles \\(I I_{B} I_{C}\\) and \\(I B C\\) are tangent, so \\(I_{B} I_{C} \\| B C\\). Since \\(I_{B} J_{B} J_{C} I_{C}\\) is cyclic, we have that\n\\[\n\\Varangle P J_{B} J_{C}=\\Varangle I_{C} J_{B} J_{C}=\\Varangle I_{C} I_{B} J_{C}=\\Varangle P Q I_{B}=\\Varangle P Q J_{C} \\text {, }\n\\]\nso \\(P J_{B} J_{C} Q\\) is cyclic. By the radical axis theorem on circles \\(A I P J_{B}, A I Q J_{C}\\), and \\(P J_{B} J_{C} Q\\), we have that \\(A I, I_{B} J_{C}\\), and \\(J_{B} I_{C}\\) concur at \\(X\\), thus proving (1).\n\nSolution 2. Let \\(X\\) be the intersection of \\(I_{B} J_{C}\\) and \\(J_{B} I_{C}\\). As in Solution 1, we will prove that conditions (1) and (2) are equivalent. To do so, we introduce the new condition:\n(3) \\(I_{B} I_{C} \\| B C\\)\nand show that (3) is equivalent to both (1) and (2), provided that \\(A B<A C<B C\\).\nNote that \\(A B D{ }^{+} A E C\\) and \\(A B E{ }^{+} A D C\\), where \\({ }^{+}\\)denotes positive similarity. We will make use of the following fact.\n\nFact. For points \\(P, P_{1}, P_{2}, P_{3}\\), and \\(P_{4}\\), the positive similarities\n\\[\nP P_{1} P_{2} \\stackrel{+}{\\sim} P P_{3} P_{4} \\quad \\text { and } \\quad P P_{1} P_{3} \\stackrel{ \\pm}{\\sim} P P_{2} P_{4}\n\\]\nare equivalent.\nProof of (1) \\(\\Longleftrightarrow\\) (3). Let \\(A I_{B}\\) and \\(A I_{C}\\) meet \\(B C\\) at \\(S\\) and \\(T\\), respectively. Let \\(A J_{B}\\) meet \\(B E\\) at \\(K, A J_{C}\\) meet \\(C E\\) at \\(L\\), and \\(K T\\) and \\(S L\\) meet at \\(Y\\).\n![](https://cdn.mathpix.com/cropped/2025_08_23_9a42685711bc262db31dg-092.jpg?height=986&width=920&top_left_y=622&top_left_x=605)\n\nClaim 1. Line \\(A Y\\) bisects \\(\\angle B A C\\).\nProof. Let \\(Y^{\\prime}\\) be the intersection of \\(K T\\) and the bisector of \\(\\angle B A C\\). As\n\\[\n\\angle B A K=\\frac{1}{2} \\angle B A E=\\frac{1}{2} \\angle D A C=\\angle T A C,\n\\]\n\\(A Y^{\\prime}\\) also bisects \\(\\angle K A T\\). Hence, \\(Y^{\\prime}\\) is the foot of the bisector of \\(\\angle K A T\\) in triangle \\(A K T\\). Using the Fact, we have that\n\\[\n\\begin{aligned}\nA B E \\sim^{+} A D C & \\Longrightarrow A B E K \\sim^{+} A D C T \\\\\n& \\Longrightarrow A B D \\sim^{+} A K T \\sim^{+} A E C \\\\\n& \\Longrightarrow A B D S \\sim^{+} A K T Y^{\\prime} \\sim^{+} A E C L \\\\\n& \\Longrightarrow A B E K \\sim^{+} A S L Y^{\\prime} \\sim^{+} A D C T .\n\\end{aligned}\n\\]\n\nAs \\(K\\) lies on \\(B E\\), we have that \\(Y^{\\prime}\\) lies on \\(S L\\), so \\(Y=Y^{\\prime}\\) and \\(A Y\\) bisects \\(\\angle B A C\\).\nWe show that \\(X\\) lies on \\(A Y\\) if and only if \\(I_{B} I_{C} \\| B C\\), which implies the equivalence of (1) and (3) by Claim 1. Let \\(A Y\\) meet \\(I_{B} J_{C}\\) and \\(J_{B} I_{C}\\) at \\(X_{1}\\) and \\(X_{2}\\), respectively. As \\(A B D\\) and \\(A E C\\) are similar, we have that \\(\\frac{A I_{B}}{A S}=\\frac{A J_{C}}{A L}\\), so \\(I_{B} J_{C} \\| S L\\). Analogously, we have that \\(J_{B} I_{C} \\| K T\\). Hence, \\(X_{1}\\) and \\(X_{2}\\) coincide with \\(X\\) if and only if\n\\[\n\\frac{A I_{B}}{A S}=\\frac{A X_{1}}{A Y}=\\frac{A X_{2}}{A Y}=\\frac{A I_{C}}{A T},\n\\]\nwhich is equivalent to \\(I_{B} I_{C} \\| B C\\).\n\nProof of (2) \\(\\Longleftrightarrow\\) (3). Let \\(A J_{B}\\) and \\(A J_{C}\\) meet circle \\(A B C\\) at \\(M\\) and \\(N\\), respectively, and let \\(I_{B}^{\\prime}\\) and \\(I_{C}^{\\prime}\\) be the \\(A\\)-excentres of \\(A B D\\) and \\(A D C\\), respectively.\n![](https://cdn.mathpix.com/cropped/2025_08_23_9a42685711bc262db31dg-093.jpg?height=758&width=818&top_left_y=388&top_left_x=625)\n\nClaim 2. Lines \\(I_{B} I_{C}, I_{B}^{\\prime} I_{C}^{\\prime}\\), and \\(B C\\) are concurrent or pairwise parallel.\nProof. We work in the projective plane. Let \\(I_{B} I_{C}\\) and \\(I_{B}^{\\prime} I_{C}^{\\prime}\\) meet \\(B C\\) at \\(Z\\) and \\(Z^{\\prime}\\), respectively. Note that \\(Z\\) is the intersection of the external common tangents of the incircles of \\(A B D\\) and \\(A D C\\) and \\(A D\\) is a common internal tangent of the incircles of \\(A B D\\) and \\(A D C\\), so \\(\\left(A D, A Z ; A I_{B}, A I_{C}\\right)=-1\\). Applying the same argument to the \\(A\\)-excircles of \\(A B D\\) and \\(A D C\\) gives \\(\\left(A D, A Z^{\\prime} ; A I_{B}^{\\prime}, A I_{C}^{\\prime}\\right)=-1\\), which means that \\(Z=Z^{\\prime}\\). Thus, \\(I_{B} I_{C}, I_{B}^{\\prime} I_{C}^{\\prime}\\), and \\(B C\\) concur, possibly at infinity.\n![](https://cdn.mathpix.com/cropped/2025_08_23_9a42685711bc262db31dg-093.jpg?height=975&width=926&top_left_y=1647&top_left_x=599)\n\nClaim 3. Lines \\(J_{B} I_{C}\\) and \\(C M\\) are parallel, and lines \\(I_{B} J_{C}\\) and \\(B N\\) are parallel. Proof. Using the Fact, we have that\n\\[\nA B E \\stackrel{+}{\\sim} A D C \\Longrightarrow A B E J_{B} \\stackrel{+}{\\sim} A D C I_{C} \\Longrightarrow A J_{B} I_{C} \\stackrel{+}{\\sim} A B D .\n\\]\n\nThus, \\(\\angle\\left(B D, J_{B} I_{C}\\right)=\\angle B A J_{B}=\\angle B C M\\), so \\(J_{B} I_{C} \\| C M\\). Similarly, we have that \\(I_{B} J_{C} \\| B N\\).\nClaim 4. The centre of spiral similarity between \\(J_{B} J_{C}\\) and \\(I_{B}^{\\prime} I_{C}^{\\prime}\\) is \\(A\\).\nProof. As \\(I_{B}\\) and \\(I_{B}^{\\prime}\\) are respectively the incentre and \\(A\\)-excentre of triangle \\(A B D\\), we have that \\(A B I_{B}^{\\prime} \\stackrel{+}{\\sim} A I_{B} D\\). Using the similarity \\(A B D \\stackrel{+}{\\sim} A E C\\), this means that \\(A B I_{B}^{\\prime} \\stackrel{+}{\\sim} A J_{C} C\\), so \\(A B \\cdot A C=A I_{B}^{\\prime} \\cdot A J_{C}\\) and \\(\\angle B A I_{B}^{\\prime}=\\angle J_{C} A C\\). Similarly, we have that \\(A B \\cdot A C=A J_{B} \\cdot A I_{C}^{\\prime}\\) and \\(\\angle B A J_{B}=\\angle I_{C}^{\\prime} A C\\). Together, these imply that \\(A I_{B}^{\\prime} \\cdot A J_{C}=A J_{B} \\cdot A I_{C}^{\\prime}\\) and \\(\\angle J_{B} A J_{C}=\\angle I_{B}^{\\prime} A I_{C}^{\\prime}\\), so \\(A J_{B} J_{C} \\stackrel{+}{\\sim} A I_{B}^{\\prime} I_{C}^{\\prime}\\).\n\nWe proceed using directed angles. By Claim 3, we have that \\(I_{B} J_{B} J_{C} I_{C}\\) is cyclic if and only if\n\\[\n\\begin{aligned}\n\\npreceq I_{B} I_{C} J_{B}=\\Varangle I_{B} J_{C} J_{B} & \\Longleftrightarrow \\npreceq I_{B} I_{C} J_{B}+\\npreceq M C B=\\Varangle I_{B} J_{C} J_{B}+\\npreceq M N B \\\\\n& \\Longleftrightarrow \\npreceq\\left(I_{B} I_{C}, B C\\right)=\\Varangle\\left(M N, J_{B} J_{C}\\right) .\n\\end{aligned}\n\\]\n\nBy Claim 4, we have that\n\\[\n\\begin{aligned}\n\\npreceq\\left(J_{B} J_{C}, I_{B}^{\\prime} I_{C}^{\\prime}\\right) & =\\Varangle J_{B} A I_{B}^{\\prime} \\\\\n& =\\Varangle B A I_{B}+\\npreceq M A B \\\\\n& =\\Varangle E A J_{C}+\\npreceq M A B \\\\\n& =\\Varangle N A C+\\not \u53e3 M A B \\\\\n& =\\Varangle(M N, B C),\n\\end{aligned}\n\\]\nwhich is equivalent to \\(\\Varangle\\left(B C, I_{B}^{\\prime} I_{C}^{\\prime}\\right)=\\Varangle\\left(M N, J_{B} J_{C}\\right)\\). Thus, \\(I_{B} J_{B} J_{C} I_{C}\\) is cyclic if and only if\n\\[\n\\Varangle\\left(I_{B} I_{C}, B C\\right)=\\Varangle\\left(B C, I_{B}^{\\prime} I_{C}^{\\prime}\\right) .\n\\]\n\nSuppose that \\(I_{B} I_{C}\\) is parallel to \\(B C\\). By Claim 2, \\(I_{B}^{\\prime} I_{C}^{\\prime}\\) is also parallel to \\(B C\\), so we have that \\(\\Varangle\\left(I_{B} I_{C}, B C\\right)=\\Varangle\\left(B C, I_{B}^{\\prime} I_{C}^{\\prime}\\right)=0^{\\circ}\\). Thus, (*) is satisfied, so \\(I_{B} J_{B} J_{C} I_{C}\\) is cyclic.\n![](https://cdn.mathpix.com/cropped/2025_08_23_9a42685711bc262db31dg-094.jpg?height=963&width=947&top_left_y=1833&top_left_x=573)\n\nSuppose now that \\(I_{B} I_{C}\\) is not parallel to \\(B C\\) while \\(I_{B} J_{B} J_{C} I_{C}\\) is cyclic. By Claim \\(2, I_{B} I_{C}\\), \\(I_{B}^{\\prime} I_{C}^{\\prime}\\), and \\(B C\\) concur at a point \\(Z\\). As \\(I_{B}\\) and \\(I_{C}\\) lie on segments \\(B I\\) and \\(C I, Z\\) must lie outside segment \\(B C\\). Since \\(A\\) is the intersection of the common external tangents of the incircle and \\(A\\)-excircle of \\(A B D\\) and \\(Z D\\) is a common internal tangent of the incircle and \\(A\\)-excircle of \\(A B D\\), we have that ( \\(Z A, Z D ; Z I_{B}, Z I_{B}^{\\prime}\\) ) = -1. By (*), \\(Z D\\) bisects \\(\\angle I_{B} Z I_{B}^{\\prime}\\), so \\(\\angle A Z D=90^{\\circ}\\) : that is, \\(Z\\) is the foot from \\(A\\) to \\(B C\\). But this implies that \\(\\angle A B C\\) or \\(\\angle B C A\\) is obtuse, contradicting the fact that \\(A B<A C<B C\\).\n\nComment. While we have written the solution using harmonic bundles for the sake of brevity, there are ways to prove Claim 2 and obtain the final contradiction without the use of projective geometry. Claim 2 can be proven using an application of Menelaus's theorem, and the final contradiction can be obtained using the fact that an excircle of a triangle is always larger than its incircle.\n\nSolution 3. Let \\(\\omega_{B}\\) and \\(\\omega_{C}\\) denote circles \\(A I B\\) and \\(A I C\\), respectively. Introduce \\(P, Q\\) and \\(X\\) as in Solution 1 and recall from Claim 1 in Solution 1 that \\(P, J_{B}\\) and \\(I_{C}\\) are collinear with \\(J_{B}\\) lying on \\(\\omega_{B}\\). From this, we can define \\(J_{B}\\) and \\(I_{C}\\) in terms of \\(X\\) by \\(I_{C}=X P \\cap C I\\) and \\(J_{B} \\neq P\\) as the second intersection of line \\(X P\\) with \\(\\omega_{B}\\). Similarly, we can define \\(I_{B}=X Q \\cap B I\\) and \\(J_{C} \\neq Q\\) as the second intersection of line \\(X Q\\) with \\(\\omega_{C}\\). Note that this now detaches the definitions of points \\(I_{B}, I_{C}, J_{B}\\), and \\(J_{C}\\) from points \\(D\\) and \\(E\\).\n\nLet \\(\\ell\\) be a line passing through \\(I\\). We now allow \\(X\\) to vary along \\(\\ell\\) while fixing \\(\\triangle A B C\\) and points \\(I, P\\), and \\(Q\\). We use the definitions from above to construct \\(I_{B}, I_{C}, J_{B}\\), and \\(J_{C}\\). We will classify all cases where these four points are concyclic. Throughout the rest of the solution we use directed angles and directed lengths.\n\nFor nondegeneracy reasons, we exclude cases where \\(X=I\\) and \\(X\\) lies on line \\(B C\\), which means that \\(I_{B}, J_{B} \\neq B\\) and \\(I_{C}, J_{C} \\neq C\\). We also exclude the cases where \\(\\ell\\) is tangent to either \\(\\omega_{B}\\) or \\(\\omega_{C}\\). Similar results hold in these cases and they can be treated as limit cases.\n![](https://cdn.mathpix.com/cropped/2025_08_23_9a42685711bc262db31dg-095.jpg?height=1006&width=1469&top_left_y=1567&top_left_x=299)\n\nClaim 1. Line \\(I_{B} J_{B}\\) passes through a fixed point on \\(\\omega_{B}\\), and line \\(I_{C} J_{C}\\) passes through a fixed point on \\(\\omega_{C}\\) as \\(X\\) varies on \\(\\ell\\).\nProof. Let \\(U \\neq J_{B}\\) be the second intersection of \\(I_{B} J_{B}\\) with \\(\\omega_{B}\\). We have by the law of sines that\n\\[\n\\frac{\\sin \\Varangle I J_{B} U}{\\sin \\Varangle U J_{B} B}=\\frac{\\sin \\Varangle I J_{B} I_{B}}{\\sin \\Varangle I_{B} J_{B} B}=\\frac{\\sin \\Varangle J_{B} I I_{B}}{\\sin \\Varangle J_{B} B I_{B}} \\cdot \\frac{I I_{B}}{I_{B} B}=\\frac{\\sin \\Varangle J_{B} I B}{\\sin \\Varangle J_{B} B I} \\cdot \\frac{I I_{B}}{I_{B} B}=\\frac{\\sin \\Varangle X P Q}{\\sin \\Varangle X P I} \\cdot \\frac{I I_{B}}{I_{B} B} .\n\\]\n\nWe also have\n\\[\n\\frac{I I_{B}}{I_{B} B}=\\frac{\\sin \\Varangle I Q I_{B}}{\\sin \\Varangle I_{B} Q B} \\cdot \\frac{|I Q|}{|B Q|}=\\frac{\\sin \\Varangle I Q X}{\\sin \\Varangle X Q P} \\cdot \\frac{|I Q|}{|B Q|} .\n\\]\n\nCombining these and applying Ceva's Theorem in \\(\\triangle P I Q\\) with point \\(X\\), we get\n\\[\n\\frac{\\sin \\Varangle I J_{B} U}{\\sin \\Varangle U J_{B} B}=\\frac{\\sin \\Varangle X P Q}{\\sin \\Varangle X P I} \\cdot \\frac{\\sin \\Varangle I Q X}{\\sin \\Varangle X Q P} \\cdot \\frac{|I Q|}{|B Q|}=\\frac{\\sin \\Varangle X I Q}{\\sin \\Varangle X I P} \\cdot \\frac{|I Q|}{|B Q|}=\\frac{\\sin \\Varangle(\\ell, I Q)}{\\sin \\Varangle(\\ell, I P)} \\cdot \\frac{|I Q|}{|B Q|},\n\\]\nwhich is independent of the choice of \\(X\\) on \\(\\ell\\). As \\(\\Varangle I J_{B} U+\\Varangle U J_{B} B=\\Varangle I J_{B} B=\\Varangle I A B\\) is fixed, this is enough to show point \\(U\\) is fixed on \\(\\omega_{B}\\).\n\nSimilarly, if we define \\(V \\neq J_{C}\\) to be the second intersection of \\(I_{C} J_{C}\\) with \\(\\omega_{C}\\), we get that \\(V\\) is fixed on \\(\\omega_{C}\\).\n\nLet \\(G \\neq X\\) and \\(H \\neq X\\) be the second intersections of \\(\\ell\\) with \\(\\omega_{B}\\) and \\(\\omega_{C}\\), respectively which exist as we are assuming \\(\\ell\\) is not tangent to either \\(\\omega_{B}\\) or \\(\\omega_{C}\\).\nClaim 2. Points \\(U, G\\) and \\(Q\\) are collinear and points \\(V, H\\) and \\(P\\) are collinear.\nProof. Taking \\(X=G\\), we have \\(J_{B}=G\\) and \\(I_{B}=X Q \\cap B I\\). Both of these points lie on line \\(Q G\\) which, by Claim 1, shows that \\(U, G, Q\\) are collinear. Similarly, \\(V, H, P\\) are collinear.\nClaim 3. Points \\(I_{B}, I_{C}, J_{B}, J_{C}\\) are concyclic if and only if points \\(P, Q, G, H\\) are concyclic. In particular, this depends only on \\(\\ell\\), not on the choice of \\(X\\) on \\(\\ell\\).\nProof. We have that\n\\[\n\\begin{aligned}\n& \\Varangle I_{C} J_{B} I_{B}=\\Varangle P J_{B} U=\\Varangle P G U=\\Varangle P G Q \\\\\n& \\not \\Varangle I_{C} J_{C} I_{B}=\\Varangle V J_{C} Q=\\Varangle V H Q=\\Varangle P H Q .\n\\end{aligned}\n\\]\n\nThus \\(\\Varangle I_{C} J_{B} I_{B}=\\Varangle I_{C} J_{C} I_{B} \\Longleftrightarrow \\Varangle P G Q=\\Varangle P H Q\\) which proves the claim.\nClaim 4. \\(P, Q, G, H\\) are concyclic if and only if \\(\\ell \\in\\{I A, I P, I Q, t\\}\\) where \\(t\\) is the tangent to circle \\(B I C\\) at \\(I\\).\nProof. When \\(\\ell=I A\\), we have \\(G=H=A\\) so the cyclic condition from Claim 3 holds. Similarly, when \\(\\ell=I P\\) or \\(\\ell=I Q, G=P\\) or \\(H=Q\\), respectively, so again the cyclic condition holds.\n\nNow, consider the case where \\(\\ell \\notin\\{I A, I P, I Q\\}\\). In this case it is straightforward to see that the four points \\(P, Q, G\\), and \\(H\\) are distinct. We then have that \\(\\Varangle Q P G=\\Varangle B P G=\\Varangle B I G\\), so\n\\[\nP Q G H \\text { concyclic } \\Longleftrightarrow \\npreceq Q H G=\\Varangle Q P G \\Longleftrightarrow \\Varangle Q H G=\\Varangle B I G \\Longleftrightarrow Q H \\| B I .\n\\]\n\nWe also have that \\(\\Varangle C Q H=\\Varangle C I H\\), so\n\\[\n\\ell \\text { tangent to circle } B I C \\Longleftrightarrow \\Varangle C I H=\\Varangle C B I \\Longleftrightarrow \\npreceq C Q H=\\Varangle C B I \\Longleftrightarrow Q H \\| B I \\text {. }\n\\]\n\nHence, in this case \\(P, Q, G, H\\) are concyclic if and only if \\(\\ell\\) is tangent to circle \\(B I C\\), as claimed.\n\nWe now revert to using points \\(D\\) and \\(E\\) to define points \\(I_{B}, I_{C}, J_{B}, J_{C}\\), and \\(X\\), returning to the original set-up.\nClaim 5. Let \\(\\Gamma\\) be the circle passing through \\(P\\) and \\(Q\\) that is tangent to \\(I P\\) and \\(I Q\\), which exists as \\(I P=I Q=I A\\). Then \\(X\\) lies on \\(\\Gamma\\). Furthermore, \\(X\\) lies on the same side of \\(B C\\) as \\(A\\) and does not lie on line \\(B C\\).\nProof. We have that\n\\[\n\\begin{aligned}\n\\npreceq X P I & =\\Varangle J_{B} P I=\\Varangle J_{B} A I=\\Varangle B A I-\\npreceq B A J_{B}=\\Varangle J_{B} A J_{C}-\\npreceq J_{B} A E \\\\\n& =\\Varangle E A J_{C}=\\Varangle J_{C} A C=\\Varangle J_{C} Q C=\\Varangle X Q P,\n\\end{aligned}\n\\]\nso circle \\(X P Q\\) is tangent to \\(I P\\). Similarly, circle \\(X P Q\\) is tangent to \\(I Q\\), so \\(X\\) lies on \\(\\Gamma\\).\nAs \\(D\\) lies in the interior of segment \\(B C, I_{C}\\) lies in the interior of segment \\(C I\\). Since \\(X\\) is the second intersection of \\(P I_{C}\\) with \\(\\Gamma\\) and \\(I P\\) is tangent to \\(\\Gamma, X\\) lies in the interior of \\(\\widetilde{P Q}\\) on \\(\\Gamma\\) on the same side of \\(B C\\) as \\(A\\). This implies the second part of the claim.\n\nBy Claim 5, we cannot have \\(\\ell \\in\\{I P, I Q\\}\\) in the original problem. Furthermore, as shown in Claim 2 of Solution 1, we have that \\(X\\) lies inside triangle \\(I B C\\), which means that \\(\\ell \\neq t\\). Thus, the only remaining possibility in Claim 4 is \\(\\ell=A I\\). We then have\n\\[\nI_{B} I_{C} J_{B} J_{C} \\text { concyclic } \\stackrel{\\text { Claim } 3}{\\Longleftrightarrow} P Q G H \\text { concyclic } \\stackrel{\\text { Claim } 4}{\\Longleftrightarrow} X \\text { lies on } A I,\n\\]\nfinishing the problem.\nComment. The condition \\(A B<A C<B C\\) is used in an essential way in the solutions. In Solution 1, it is used in the proof of Claim 3 to ensure that \\(X\\) lies in the interior of triangle \\(I B C\\). In Solution 2, it is used in the final step to ensure that \\(\\angle A B C\\) and \\(\\angle B C A\\) cannot be obtuse. In Solution 3, it is used to exclude the case \\(\\ell=t\\). If the condition is removed, then the problem is no longer true: whenever \\(\\angle A B C\\) or \\(\\angle B C A\\) is obtuse, there exists a choice of \\(D\\) on \\(B C\\) such that \\(I_{B} J_{B} J_{C} I_{C}\\) is cyclic but \\(A I, I_{B} J_{C}\\), and \\(J_{B} I_{C}\\) do not concur. This counterexample configuration can be constructed using Solution 3 by letting \\(X\\) be the intersection of \\(t\\) with \\(\\Gamma\\) that lies on the same side of \\(B C\\) as \\(A\\) and constructing \\(I_{B}, I_{C}, J_{B}\\), and \\(J_{C}\\) as described in the solution, from which we can reconstruct \\(D\\).\n\nConversely, the problem holds whenever \\(\\angle A B C\\) and \\(\\angle B C A\\) are both not obtuse, as can be seen from Solution 2. This is thus the weakest possible condition on triangle \\(A B C\\) that is necessary for the problem to be true.\n![](https://cdn.mathpix.com/cropped/2025_08_23_9a42685711bc262db31dg-097.jpg?height=712&width=1274&top_left_y=1781&top_left_x=388)\n\nWhen \\(X\\) lies on the tangent to circle \\(I B C\\) at \\(I\\), there is no contradiction in the proof of Claim 3 in Solution 1: circles \\(I I_{B} J_{C}\\) and \\(I J_{B} I_{C}\\) are distinct, and \\(X\\) is the radical centre of circles \\(I I_{B} J_{C}, I J_{B} I_{C}\\), and \\(I_{B} J_{B} I_{C} J_{C}\\). There is also no contradiction in the final step of Solution 2, and indeed \\(I_{B} I_{C}\\) and \\(B C\\) intersect at the foot of the altitude from \\(A\\) to \\(B C\\).\n\nThere are no configuration issues with the direction (1) \\(\\Longrightarrow\\) (2). This implication holds without any constraint on triangle \\(A B C\\), and the proofs in Solutions 1 and 2 apply without any modification.\n\n\\section*{Number Theory}", "source_pdf": "imosl_2024.pdf", "notes": "fallback-regex"}
{"id": "IMOSL-2024-N1", "contest": "IMOSL", "year": "2024", "problem_number": "N1", "problem": "Find all positive integers \\(n\\) with the following property: for all positive divisors \\(d\\) of \\(n\\), we have that \\(d+1 \\mid n\\) or \\(d+1\\) is prime.\n(Ghana)", "solution": "Answer: \\(n \\in\\{1,2,4,12\\}\\).\n\n1. It is easy to verify that \\(n=1,2,4,12\\) all work. We must show they are the only possibilities. We write \\(n=2^{k} m\\), where \\(k\\) is a nonnegative integer and \\(m\\) is odd. Since \\(m \\mid n\\), either \\(m+1\\) is prime or \\(m+1 \\mid n\\).\n\nIn the former case, since \\(m+1\\) is even it must be 2 , so \\(n=2^{k}\\). If \\(k \\geqslant 3\\), we get a contradiction, since \\(8 \\mid n\\) but \\(9 \\nmid n\\). Hence \\(k \\leqslant 2\\), so \\(n \\in\\{1,2,4\\}\\).\n\nIn the latter case, we have \\(m+1 \\mid 2^{k} m\\) and \\(m+1\\) coprime to \\(m\\), and hence \\(m+1 \\mid 2^{k}\\). This means that \\(m+1=2^{j}\\) with \\(2 \\leqslant j \\leqslant k\\) (since \\(j=1\\) gives \\(m=1\\), which was considered earlier).\n\nThen we have \\(2^{k}+1 \\nmid n\\) : since \\(2^{k}+1\\) is odd, it would have to divide \\(m\\) but is larger than \\(m\\). Hence, by the condition of the problem, \\(2^{k}+1\\) is prime. If \\(k=2, j\\) must be 2 as well, and this gives the solution \\(n=12\\). Also, \\(2^{k-1}+1 \\nmid n\\) for \\(k>2\\) : since it is odd, it would have to divide \\(m\\). However, we have no solutions to \\(2^{k-1}+1 \\mid 2^{j}-1\\) with \\(j \\leqslant k\\) : the left-hand side is greater than the right unless \\(j=k\\), when the left-hand side is just over half the right-hand side.\n\nSince we have \\(2^{k} \\mid n\\) and \\(2^{k}+1 \\nmid n\\), and \\(2^{k-1} \\mid n\\) and \\(2^{k-1}+1 \\nmid n\\), we must have \\(2^{k}+1\\) and \\(2^{k-1}+1\\) both prime. However, \\(2^{a}+1\\) is a multiple of three if \\(a\\) is odd, so we must have \\(2^{k}+1=3\\) (impossible as this gives \\(k=1\\) ) or \\(2^{k-1}+1=3\\), which gives \\(j=k=2\\), whence \\(n=12\\).\n\nSolution 2. We proceed as in Solution 1 as far as determining that \\(n=2^{k}\\left(2^{j}-1\\right)\\) with \\(j \\leqslant k\\).\nNow, we have \\(2^{j} \\mid n\\) but \\(2^{j}+1 \\nmid n\\), as it is odd and does not divide \\(2^{j}-1\\). Thus \\(2^{j}+1\\) is prime. The theory of Fermat primes tells us we must have \\(j=2^{h}\\) with \\(h>0\\).\n\nThen \\(2^{2^{h}}-1\\) is congruent to 3 or 6 (modulo 9) depending on whether \\(h\\) is odd or even, respectively. In particular it is not divisible by 9 , so \\(n=2^{k}\\left(2^{2^{h}}-1\\right)\\) is not divisible by 9 ; so we must have \\(k \\leqslant 2\\), since if \\(k \\geqslant 3\\) then \\(8 \\mid n\\) but \\(9 \\nmid n\\) with 9 not prime.\n\nSolution 3. Let \\(p\\) be the smallest integer not dividing \\(n\\). Since \\(p-1\\) is a divisor of \\(n, p\\) must be a prime. Let \\(1 \\leqslant r \\leqslant p-1\\) be the remainder of \\(n\\) modulo \\(p\\). Since \\(p-r<p\\), we have \\(p-r \\mid n\\), so we may consider the divisor \\(d=\\frac{n}{p-r}\\).\n\nSince \\(p \\mid n-r\\), we have \\(p \\mid n+p-r\\), whence \\(p \\mid d+1\\). Thus \\(d+1 \\nmid n\\); so it must be prime. On the other hand, this prime is divisible by \\(p\\), so we conclude \\(d+1=p\\), which means that \\(n=(p-1)(p-r)\\).\n\nThen from \\(p-2, p-3 \\mid n\\) we get \\((p-2)(p-3) \\mid 2(p-r)\\), from which we find\n\\[\n(p-2)(p-3) \\leqslant 2(p-r) \\leqslant 2(p-1)\n\\]\n\nSolving this quadratic inequality gives \\(p \\leqslant 5\\), which means that \\(n \\in\\{1,2,4,8,12,16\\}\\). Of this set, \\(n=8\\) and \\(n=16\\) are not solutions.\n\nSolution 4. We suppose that \\(n\\) is not 1 or 2.\nSince \\(n \\mid n\\) and \\(n+1 \\nmid n\\), we know that \\(n+1\\) is prime. Thus it is odd, so \\(2 \\mid n\\); as \\(n>2\\), we have \\(\\left.\\frac{n}{2} \\right\\rvert\\, n\\) and \\(\\frac{n}{2}+1 \\nmid n\\), so \\(\\frac{n}{2}+1\\) is prime. Thus it is also odd, so \\(4 \\mid n\\).\n\nWe must then have \\(\\left.\\frac{n}{4}+1 \\right\\rvert\\, n\\) or \\(\\frac{n}{4}+1\\) prime.\n\nIn the former case, \\(\\frac{n}{4} \\left\\lvert\\, 4\\left(\\frac{n}{4}+1\\right)-n\\right.\\), so \\(\\left.\\frac{n}{4}+1 \\right\\rvert\\, 4\\). This means that \\(n=4\\) or \\(n=12\\).\nIn the latter case, \\(\\frac{n}{4}+1\\) must be odd if \\(n \\neq 4\\). Thus we have \\(n=8 m\\) where \\(2 m+1,4 m+1\\), \\(8 m+1\\) are all prime; \\(n=8\\) does not work, so \\(3 \\mid m\\) (otherwise one of those numbers would be divisible by 3). Thus \\(24 \\mid n\\), so \\(25 \\mid n\\) as 25 is not prime.\n\nNow suppose that \\(p\\) is the least positive integer not dividing \\(n\\) : as in Solution 3 we know that \\(p\\) is prime, and what we have done so far shows that \\(p \\geqslant 7\\). If \\(p^{2}-1=(p-1)(p+1)\\) is the product of coprime integers less than \\(p\\), it divides \\(n\\), and \\(p^{2}\\) is not prime so also divides \\(n\\) (a contradiction); \\(p-1\\) and \\(p+1\\) are even and have no common factor higher than 2 , so all odd prime power divisors of their product are less than \\(p\\) and the only case where \\(p^{2}-1\\) is not a product of coprime integers less than \\(p\\) is when one of \\(p-1\\) and \\(p+1\\) is a power of 2 , say \\(2^{m}\\) (with \\(m \\geqslant 3\\) ). If \\(p=2^{m}-1\\), then \\(3 p-1=4\\left(3 \\times 2^{m-2}-1\\right)\\) and \\(3 \\times 2^{m-2}-1\\) is an odd integer less than \\(p\\), so \\(3 p-1 \\mid n\\) and so \\(3 p \\mid n\\). Finally, if \\(p=2^{m}+1\\), then \\(m\\) is even and \\(2 p-1=2^{m+1}+1\\) is a multiple of 3 ; the only case where it is a power of 3 is when \\(m=2\\), but we have \\(m \\geqslant 3\\), so \\(2 p-1\\) is a product of coprime integers less than \\(p\\) and again we have a contradiction.\n\nSolution 5. As in Solution 4, we deduce that if \\(n>2\\) then \\(n\\) must be even. We write \\(n=2 \\cdot 3^{k} \\cdot r\\), where \\(k\\) is a nonnegative integer and \\(3 \\nmid r\\).\n\nSince \\(r\\) and \\(2 r\\) are both different and nonzero modulo 3, one of them must be congruent to 2 modulo 3 . We'll say that it is \\(a r\\), where \\(a \\in\\{1,2\\}\\).\n\nSince \\(a r \\mid n\\), we must have that \\(a r+1\\) is either prime or a factor of \\(n\\). In the first case, ar \\(+1=3\\) because \\(3 \\mid\\) ar +1 , and so \\(n=2 \\cdot 3^{k} \\cdot r\\), where \\(r=2 / a\\) is 1 or 2 . Noting that we must have \\(k \\leqslant 1\\) (else \\(9 \\mid n\\) but \\(10 \\nmid n\\) ), we can examine cases to deduce that \\(n \\in\\{2,4,12\\}\\) are the only possibilities.\n\nOtherwise, \\(a r+1 \\mid n\\). Since \\(a r+1\\) is coprime to \\(r\\), we must in fact have that \\(a r+1 \\mid 2 \\cdot 3^{k}\\), and since \\(3 \\mid\\) ar +1 by assumption we deduce that \\(k \\geqslant 1\\). In particular, \\(3^{k}+1\\) is an even number that is at least 4 , so is not prime and must divide \\(n\\). As it is coprime to 3 , we must in fact have \\(3^{k}+1 \\mid 2 r\\).\n\nLet \\(q_{1}\\) and \\(q_{2}\\) be such that \\(q_{1}(a r+1)=2 \\cdot 3^{k}\\) and \\(q_{2}\\left(3^{k}+1\\right)=2 r\\). We have that \\(q_{1} a r<2 \\cdot 3^{k}\\) and \\(q_{2} 3^{k}<2 r\\), and multiplying these together gives \\(q_{1} q_{2} a<4\\).\n\nIf \\(a=2\\) then \\(q_{1}=q_{2}=1\\), so \\(2 r+1=2 \\cdot 3^{k}\\), which is not possible (considering both sides modulo 2).\n\nIf \\(a=1\\) then \\(r\\) must be equivalent to 2 modulo 3 , so \\(q_{2}\\left(3^{k}+1\\right)=2 r\\) gives that \\(q_{2}\\) is equivalent to 1 modulo 3 , whence \\(q_{2}=1\\). So we deduce that \\(2 r=3^{k}+1\\). Thus, we deduce that \\(q_{1}\\left(3^{k}+3\\right)=4 \\cdot 3^{k}\\), which rearranges to give \\(3^{k-1}\\left(4-q_{1}\\right)=q_{1}\\), whence \\(3^{k-1} \\leqslant q_{1}<4\\) and so \\(k \\leqslant 2\\). We can examine cases to deduce that \\(n=12\\) is the only possibility.", "source_pdf": "imosl_2024.pdf", "notes": "fallback-regex"}
{"id": "IMOSL-2024-N2", "contest": "IMOSL", "year": "2024", "problem_number": "N2", "problem": "Determine all finite, nonempty sets \\(\\mathcal{S}\\) of positive integers such that for every \\(a, b \\in \\mathcal{S}\\) there exists \\(c \\in \\mathcal{S}\\) with \\(a \\mid b+2 c\\).\n(Netherlands)", "solution": "Answer: The possible sets are \\(\\mathcal{S}=\\{t\\}\\) and \\(\\mathcal{S}=\\{t, 3 t\\}\\) for any positive integer \\(t\\).\n\n1. Without loss of generality, we may divide all elements of \\(\\mathcal{S}\\) by any common factor, after which they cannot all be even. As \\(a \\nmid b+2 c\\) for \\(a\\) even and \\(b\\) odd, the elements of \\(\\mathcal{S}\\) are all odd.\n\nWe now divide into three cases:\nCase 1: \\(|\\mathcal{S}|=1\\).\nThe set \\(\\mathcal{S}=\\{t\\}\\) clearly works.\nCase 2: \\(|\\mathcal{S}|=2\\).\nSay \\(\\mathcal{S}=\\{r, s\\}\\) with \\(r<s\\), so either \\(s \\mid r+2 r\\) or \\(s \\mid r+2 s\\), and in either case \\(s \\mid 3 r\\). We cannot have \\(s=3 r / 2\\) as we assumed that \\(r\\) is odd, so \\(s=3 r\\) and \\(\\mathcal{S}=\\{r, 3 r\\}\\), which clearly works by examining cases for \\(a\\) and \\(b\\).\nCase 3: \\(|\\mathcal{S}| \\geqslant 3\\).\nIf all elements of \\(\\mathcal{S}\\) are odd then for any \\(b, c \\in \\mathcal{S}, b+2 c \\not \\equiv b(\\bmod 4)\\). If \\(a \\mid b+2 c\\) with \\(a \\equiv b(\\bmod 4)\\), this means there exists \\(k\\) with \\(b+2 c=k a\\) and \\(k \\equiv 3(\\bmod 4)\\), so \\(k \\geqslant 3\\). If \\(a\\) is the greatest element of \\(\\mathcal{S}\\) and \\(b<a\\), we have \\(b+2 c<3 a\\), a contradiction. Thus when \\(a\\) is the greatest element, no \\(b<a\\) has \\(b \\equiv a(\\bmod 4)\\) (and thus all elements other than the greatest are congruent modulo 4).\n\nLet \\(d\\) and \\(e\\) be the largest and second largest element of \\(\\mathcal{S}\\) respectively. Let \\(f \\neq d, e\\) be any other element of \\(\\mathcal{S}\\). There is some \\(c \\in \\mathcal{S}\\) with \\(e \\mid f+2 c\\), and \\(e \\not \\equiv f+2 c(\\bmod 4)\\), so \\(f+2 c \\geqslant 3 e\\), so \\(c>e\\). Since \\(e\\) is the second largest element of \\(\\mathcal{S}, c=d\\), so \\(e \\mid f+2 d\\), and this holds for all \\(f \\in \\mathcal{S}\\) with \\(f<e\\), but can only hold for at most one such \\(f\\). So \\(|\\mathcal{S}| \\leqslant 3\\).\n\nHence the elements of \\(\\mathcal{S}\\) are \\(d>e>f\\), and by the discussion above without loss of generality we may suppose these elements are all odd, \\(e \\equiv f(\\bmod 4)\\) and \\(d \\not \\equiv e(\\bmod 4)\\). We have above that \\(e \\mid f+2 d\\). Furthermore, there exists some \\(c \\in \\mathcal{S}\\) with \\(d \\mid f+2 c\\), and \\(c \\neq d\\) as \\(d>f\\) so \\(d \\nmid f\\), so \\(c \\leqslant e\\); as \\(f+2 e<3 e\\), we have \\(e>d / 3\\). Since \\(f+2 c\\) is odd and \\(f+2 c<3 d\\), we have \\(f+2 c=d\\).\nSubcase 3.1: \\(c=f\\).\nHere \\(d=3 f\\) and \\(e \\mid f+2 d=7 f\\). As \\(e>f\\) and \\(e \\equiv f(\\bmod 4)\\), we have \\(e=7 f / 3\\) and the elements are some multiples of \\(\\{3,7,9\\}\\). But \\(a=7\\) and \\(b=9\\) have no corresponding value of \\(c\\).\n\nSubcase 3.2: \\(c=e\\).\nHere \\(d=f+2 e\\) and \\(e \\mid f+2 d=3 f+4 e\\) so \\(e \\mid 3 f\\). But this is not possible with \\(e>f\\) and \\(e \\equiv f(\\bmod 4)\\).\n\nSolution 2. As in Solution 1, we reduce to the case where all elements of \\(\\mathcal{S}\\) are odd. Since all one-element sets satisfy the given conditions, we show that if \\(|\\mathcal{S}| \\geqslant 2\\), then \\(|\\mathcal{S}|=2\\) and \\(\\mathcal{S}=\\{t, 3 t\\}\\) for some positive integer \\(t\\).\n\nLet \\(d\\) be the largest element. For any \\(e \\in \\mathcal{S}\\) with \\(e \\neq d\\) there must be a \\(f \\in \\mathcal{S}\\) such that \\(d \\mid e+2 f\\). This implies \\(2 f \\equiv-e(\\bmod d)\\), hence \\(2 f \\equiv d-e(\\bmod d)\\). Now \\(d-e\\) is even (because all elements in \\(\\mathcal{S}\\) are odd) and \\(d\\) is odd, so \\(\\frac{d-e}{2}\\) is an integer and we have \\(f \\equiv \\frac{d-e}{2} (\\bmod d)\\). Further, \\(0<\\frac{d-e}{2}<d\\), while we must also have \\(0<f \\leqslant d\\), so \\(f=\\frac{d-e}{2}\\). We conclude that for any \\(e \\in \\mathcal{S}\\) with \\(e \\neq d\\) the integer \\(\\frac{d-e}{2}\\) is also in \\(\\mathcal{S}\\) and not equal to \\(d\\).\n\nDenote by \\(e_{1}<e_{2}<\\cdots<e_{k}<d\\) the elements of \\(\\mathcal{S}\\), where \\(k \\geqslant 1\\). Then \\(\\frac{d-e_{1}}{2}>\\frac{d-e_{2}}{2}> \\cdots>\\frac{d-e_{k}}{2}\\) are also elements of \\(\\mathcal{S}\\), none of them equal to \\(d\\). Hence we must have \\(e_{1}=\\frac{d-e_{k}}{2}\\) and\n\\(e_{k}=\\frac{d-e_{1}}{2}\\), so \\(2 e_{1}+e_{k}=d=2 e_{k}+e_{1}\\). We conclude \\(e_{1}=e_{k}\\), so \\(k=1\\), and also \\(d=2 e_{k}+e_{1}=3 e_{1}\\). Hence \\(\\mathcal{S}=\\left\\{e_{1}, 3 e_{1}\\right\\}\\) for some positive integer \\(e_{1}\\).\n\nSolution 3. As in Solution 1, we reduce to the case where all elements of \\(\\mathcal{S}\\) are odd. Since all one-element sets satisfy the given conditions, we show that if \\(|\\mathcal{S}| \\geqslant 2\\), then \\(|\\mathcal{S}|=2\\) and \\(\\mathcal{S}=\\{t, 3 t\\}\\) for some positive integer \\(t\\).\n\nLet \\(d\\) be the largest element, and let \\(e \\in \\mathcal{S}\\) be any other element. We will say that \\(x \\in \\mathcal{S} (\\bmod d)\\) if the unique element \\(y\\) in \\(\\{1, \\ldots, d\\}\\) such that \\(x \\equiv y(\\bmod d)\\) is an element of \\(\\mathcal{S}\\). Note that by the choice of \\(d\\) being the largest element, if \\(x \\neq d\\), then \\(x \\not \\equiv 0(\\bmod d)\\). The given condition implies that if \\(b \\in \\mathcal{S}\\), then \\(-\\frac{b}{2} \\in \\mathcal{S}(\\bmod d)\\). Repeating this gives \\(-\\frac{b}{2} \\in \\mathcal{S} \\Rightarrow \\frac{b}{4} \\in \\mathcal{S} (\\bmod d)\\), and by iterating, we have \\(b \\in \\mathcal{S} \\Rightarrow \\frac{b}{(-2)^{k}} \\in \\mathcal{S}(\\bmod d)\\) for all \\(k\\). Since \\(d\\) is odd, there is some \\(g\\) such that \\((-2)^{g} \\equiv 1(\\bmod d)\\), so by setting \\(k=g-1\\), we get that\n\\[\n\\text { for all } d \\neq e \\in \\mathcal{S},-2 e \\in \\mathcal{S} \\quad(\\bmod d) \\text {. }\n\\]\n\nNow, if \\(e>\\frac{d}{2}\\), then \\(-2 e \\in \\mathcal{S}(\\bmod d)\\) and \\(d-2 e<0\\), so \\(2 d-2 e \\in \\mathcal{S}\\), contradicting the lack of even elements. Then \\(e<\\frac{d}{2}\\) for any \\(e \\in \\mathcal{S} \\backslash\\{d\\}\\), so we have \\(e \\in \\mathcal{S} \\Rightarrow d-2 e \\in \\mathcal{S}\\). Since \\(d-2 e \\neq d\\), we must have \\(d-2 e<\\frac{d}{2}\\), which rearranges to \\(e>\\frac{d}{4}\\).\n\nLet \\(\\lambda \\in(0,1)\\) be a positive real number and suppose we have proved that \\(e>\\lambda d\\) for any \\(e \\in \\mathcal{S} \\backslash\\{d\\}\\). Then \\(d-2 e>\\lambda d\\), which rearranges to \\(e<\\frac{(1-\\lambda) d}{2}\\). Then \\(d-2 e<\\frac{(1-\\lambda) d}{2}\\), which rearranges to \\(e>\\frac{(1+\\lambda) d}{4}\\). Defining \\(\\lambda_{0}=\\frac{1}{4}\\) and \\(\\lambda_{i}=\\frac{1+\\lambda_{i-1}}{4}\\) for \\(i \\geqslant 1\\), we have shown that for all \\(e \\in \\mathcal{S} \\backslash\\{d\\}\\) and all \\(\\lambda_{i}, e>\\lambda_{i} d\\). Now note that the sequence \\(\\lambda_{i}\\) is increasing and bounded above by \\(\\frac{1}{3}\\), so it converges to some limit \\(\\ell\\), which satisfies \\(\\ell=\\frac{1+\\ell}{4}\\), so \\(\\ell=\\frac{1}{3}\\). Hence \\(e \\geqslant \\frac{d}{3}\\), but then \\(d-2 e \\geqslant \\frac{d}{3}\\) implies \\(e \\leqslant \\frac{d}{3}\\), so \\(e\\) must be \\(\\frac{d}{3}\\), and we are done.\n\nComment. We can finish Solution 3 alternatively as follows: after showing that if \\(e \\in \\mathcal{S} \\backslash\\{d\\}\\) then \\(d-2 e \\in \\mathcal{S} \\backslash\\{d\\}\\), note that\n\\[\n(d-2 e)-\\frac{d}{3}=\\frac{2 d}{3}-2 e=-2\\left(e-\\frac{d}{3}\\right)\n\\]\n\nSo consider \\(e \\in \\mathcal{S} \\backslash\\{d\\}\\) maximising \\(\\left|e-\\frac{d}{3}\\right|\\). If \\(e \\neq \\frac{d}{3}\\), them the above shows that \\(\\left|(d-2 e)-\\frac{d}{3}\\right|>\\left|e-\\frac{d}{3}\\right|\\), which is a contradiction. Thus \\(\\mathcal{S} \\backslash\\{d\\}\\) is empty or equal to \\(\\left\\{\\frac{d}{3}\\right\\}\\), which completes the proof.", "source_pdf": "imosl_2024.pdf", "notes": "fallback-regex"}
{"id": "IMOSL-2024-N3", "contest": "IMOSL", "year": "2024", "problem_number": "N3", "problem": "Determine all sequences \\(a_{1}, a_{2}, \\ldots\\) of positive integers such that, for any pair of positive integers \\(m \\leqslant n\\), the arithmetic and geometric means\n\\[\n\\frac{a_{m}+a_{m+1}+\\cdots+a_{n}}{n-m+1} \\quad \\text { and } \\quad\\left(a_{m} a_{m+1} \\cdots a_{n}\\right)^{\\frac{1}{n-m+1}}\n\\]\nare both integers.\n(Singapore)", "solution": "Answer: The only such sequences are the constant sequences (which clearly work).\n\n1. We say that an integer sequence \\(b_{1}, b_{2}, \\ldots\\) is good if for any pair of positive integers \\(m \\leqslant n\\), the arithmetic mean \\(\\frac{b_{m}+b_{m+1}+\\cdots+b_{n}}{n-m+1}\\) is an integer. Then the condition in the question is equivalent to saying that the sequences ( \\(a_{i}\\) ) and ( \\(\\nu_{p}\\left(a_{i}\\right)\\) ) for all primes \\(p\\) are good.\nClaim 1. If ( \\(b_{i}\\) ) is a good sequence, then \\(n-m \\mid b_{n}-b_{m}\\) for all pairs of integers \\(m, n\\).\nProof. This follows from \\(n-m\\) dividing \\(b_{m}+b_{m+1}+\\cdots+b_{n-1}\\) and \\(b_{m+1}+b_{m+2}+\\cdots+b_{n}\\), and then taking the difference.\n\nClaim 2. If ( \\(b_{i}\\) ) is a good sequence where some integer \\(b\\) occurs infinitely many times, then ( \\(b_{i}\\) ) is constant.\nProof. Say \\(b_{n_{1}}, b_{n_{2}}, b_{n_{3}}, \\ldots\\) are equal to \\(b\\). Then for all \\(m\\), we have that \\(b-b_{m}=b_{n_{j}}-b_{m}\\) is divisible by infinitely many different integers \\(n_{j}-m\\), so it must be zero. Therefore the sequence is constant.\n\nNow, for a given prime \\(p\\), we look at the sequence \\(\\left(\\nu_{p}\\left(a_{i}\\right)\\right)\\). Let \\(k=\\nu_{p}\\left(a_{1}\\right)\\). Then Claim 1 tells us that \\(a_{1} \\equiv a_{n p^{k+1}+1}\\left(\\bmod p^{k+1}\\right)\\) for all \\(n\\), which implies that \\(\\nu_{p}\\left(a_{n p^{k+1}+1}\\right)=k\\) for all \\(n\\). We now have that \\(k\\) appears infinitely many times in this good sequence, so by Claim 2, the sequence ( \\(\\nu_{p}\\left(a_{i}\\right)\\) ) is constant. This holds for all primes \\(p\\), so ( \\(a_{i}\\) ) must in fact be constant.\n\nSolution 2. As in Claim 1 of Solution 1, we have that \\(a_{i+r} \\equiv a_{i}(\\bmod r)\\), which tells us that the sequence \\(a_{i}\\) is periodic modulo \\(p\\) with period \\(p\\). Also, by a similar argument, we have that \\(a_{i+r} / a_{i}\\) is the \\(r^{\\text {th }}\\) power of a rational number.\n\nNow suppose that for some \\(i \\not \\equiv j(\\bmod p)\\) we have \\(a_{i}, a_{j} \\not \\equiv 0(\\bmod p)\\). As \\(p\\) and \\(p-1\\) are coprime, we can find some \\(i^{\\prime} \\equiv i(\\bmod p), j^{\\prime} \\equiv j(\\bmod p)\\) such that \\(p-1 \\mid i^{\\prime}-j^{\\prime}\\). Then \\(a_{i^{\\prime}} / a_{j^{\\prime}}\\) is a perfect \\((p-1)^{\\text {th }}\\) power, so\n\\[\na_{i^{\\prime}}=t u^{p-1}, \\quad a_{j^{\\prime}}=t v^{p-1}\n\\]\nfor some positive integers \\(t, u, v\\) not divisible by \\(p\\). By Fermat's little theorem, \\(u^{p-1}\\) and \\(v^{p-1}\\) must be 1 modulo \\(p\\). So we must have\n\\[\na_{i} \\equiv a_{i^{\\prime}} \\equiv t \\equiv a_{j^{\\prime}} \\equiv a_{j}(\\bmod p) .\n\\]\n\nThus all values of \\(a_{i}\\) that are not divisible by \\(p\\) are congruent modulo \\(p\\).\nFor the sum of \\(p\\) consecutive values to be divisible by \\(p\\), this means that all the \\(a_{i}\\) are congruent modulo \\(p\\). Since this is true for all primes \\(p\\), the sequence must therefore be constant.\n\nSolution 3. Fix an arbitrary index \\(m\\). First, we show that \\(a_{m}\\) divides \\(a_{n}\\) for sufficiently large \\(n\\). Let \\(n\\) be sufficiently large that \\(n>\\nu_{p}\\left(a_{m}\\right)+m\\) for every prime \\(p\\). By Claim 1 of Solution 1, we have\n\\[\n\\nu_{p}\\left(a_{m}\\right) \\equiv \\nu_{p}\\left(a_{n}\\right) \\quad(\\bmod n-m)\n\\]\n\nSince \\(\\nu_{p}\\left(a_{m}\\right)<n-m\\), it follows that \\(\\nu_{p}\\left(a_{m}\\right) \\leqslant \\nu_{p}\\left(a_{n}\\right)\\). This holds for every prime \\(p\\), so \\(a_{m} \\mid a_{n}\\).\nNext, suppose that there is some index \\(k\\) such that \\(a_{m}\\) does not divide \\(a_{k}\\). By the previous, there is a maximal such \\(k\\). Then \\(a_{k+1}, a_{k+2}, \\ldots\\) are all divisible by \\(a_{m}\\). But now applying the first condition gives\n\\[\na_{m} \\mid a_{k}+a_{k+1}+\\cdots+a_{k+a_{m}-1}\n\\]\nso \\(a_{m}\\) divides \\(a_{k}\\), a contradiction. Therefore every term \\(a_{n}\\) is divisible by \\(a_{m}\\).\nAs \\(m\\) was arbitrary, we now have \\(a_{m} \\mid a_{n}\\) and vice versa for all \\(m, n\\). So the sequence must be constant.", "source_pdf": "imosl_2024.pdf", "notes": "fallback-regex"}
{"id": "IMOSL-2024-N5", "contest": "IMOSL", "year": "2024", "problem_number": "N5", "problem": "Let \\(\\mathcal{S}\\) be a finite nonempty set of prime numbers. Let \\(1=b_{1}<b_{2}<\\cdots\\) be the sequence of all positive integers whose prime divisors all belong to \\(\\mathcal{S}\\). Prove that, for all but finitely many positive integers \\(n\\), there exist positive integers \\(a_{1}, a_{2}, \\ldots, a_{n}\\) such that\n\\[\n\\frac{a_{1}}{b_{1}}+\\frac{a_{2}}{b_{2}}+\\cdots+\\frac{a_{n}}{b_{n}}=\\left\\lceil\\frac{1}{b_{1}}+\\frac{1}{b_{2}}+\\cdots+\\frac{1}{b_{n}}\\right\\rceil\n\\]\n(Croatia)", "solution": "1. If \\(\\mathcal{S}\\) has only one element \\(p\\), then \\(b_{i}=p^{i-1}\\) and we can easily find \\(a_{1}, \\ldots, a_{n}\\) with \\(2=\\left\\lceil\\sum_{i=0}^{n-1} \\frac{1}{p^{i}}\\right\\rceil=\\sum_{i=0}^{n-1} \\frac{a_{i}}{p^{i-1}}\\) by taking \\(a_{1}=a_{2}=\\cdots=a_{n-1}=1\\) and choosing \\(a_{n}= p^{n-1}-\\left(p+p^{2}+\\ldots+p^{n-2}\\right)\\).\n\nMore generally, observe that the sum of \\(\\frac{1}{b_{i}}\\) over all \\(i\\) is\n\\[\n\\begin{aligned}\n\\sum_{i} \\frac{1}{b_{i}} & =\\prod_{i}\\left(1+\\frac{1}{p_{i}}+\\frac{1}{p_{i}^{2}}+\\ldots\\right) \\\\\n& =\\prod_{p \\in \\mathcal{S}} \\frac{p}{p-1}\n\\end{aligned}\n\\]\n\nIn particular, if \\(n\\) is large enough, then\n\\[\n\\left\\lceil\\sum_{j=1}^{n} \\frac{1}{b_{j}}\\right\\rceil=\\left\\lceil\\prod_{p \\in \\mathcal{S}} \\frac{p}{p-1}\\right\\rceil\n\\]\n\nFor the remainder of the proof, we will only consider \\(n\\) large enough that this equality holds.\nNext, we handle the special case \\(\\mathcal{S}=\\{2,3\\}\\), for which this product is 3 . Start by setting\n\\[\na_{i}= \\begin{cases}1, & \\text { if } 2 b_{i} \\leqslant b_{n} \\\\ 2, & \\text { if } 2 b_{i}>b_{n}\\end{cases}\n\\]\n\nThen,\n\\[\n\\sum_{\\substack{i \\leqslant n \\\\ \\nu_{3}\\left(b_{i}\\right)=t}} \\frac{a_{i}}{b_{i}}= \\begin{cases}\\frac{2}{3^{t}}, & \\text { if } b_{n} \\geqslant 3^{t} \\\\ 0, & \\text { otherwise }\\end{cases}\n\\]\n\nAs a result,\n\\[\n\\begin{aligned}\n\\sum_{i \\leqslant n} \\frac{a_{i}}{b_{i}} & =\\sum_{\\substack{t \\geqslant 0 \\\\\n3^{t} \\leqslant b_{n}}} \\frac{2}{3^{t}} \\\\\n& =3-\\frac{1}{3^{T}}\n\\end{aligned}\n\\]\nwhere \\(T\\) is the largest \\(t \\geqslant 0\\) with \\(3^{t} \\leqslant b_{n}\\). Thus, increasing \\(a_{j}\\) by one (where \\(b_{j}=3^{T}\\) ) gives a sequence of \\(a_{i}\\) that works.\n\nOtherwise, we may assume that \\(|\\mathcal{S}|>1\\) and \\(\\mathcal{S} \\neq\\{2,3\\}\\), which means that the product \\(\\prod_{p \\in \\mathcal{S}} \\frac{p}{p-1}\\) is not an integer. Indeed,\n- if \\(|\\mathcal{S}|>2\\) then 2 divides the denominator at least twice and so divides the denominator of the overall fraction;\n- if \\(|\\mathcal{S}|=2\\) and \\(2 \\notin \\mathcal{S}\\) then 2 divides the denominator and not the numerator;\n- if \\(\\mathcal{S}=\\{2, p\\}\\) then the product is \\(2 p /(p-1)\\) which is not an integer for \\(p>3\\).\n\nIt follows that for some fixed \\(\\alpha>0\\), we have that\n\\[\n\\left\\lceil\\prod_{p \\in \\mathcal{S}} \\frac{p}{p-1}\\right\\rceil=\\prod_{p \\in \\mathcal{S}} \\frac{p}{p-1}+\\alpha\n\\]\nfrom which it follows that\n\\[\n\\left\\lceil\\sum_{i=1}^{n} \\frac{1}{b_{i}}\\right\\rceil-\\sum_{i=1}^{n} \\frac{1}{b_{i}}>\\alpha\n\\]\n\nIt will now suffice to prove the following claim.\nClaim. Suppose that \\(n\\) is large enough, and let \\(e_{p}\\) be the largest nonnegative integer such that \\(p^{e_{p}} \\leqslant b_{n}\\). Let \\(M=\\prod_{p \\in \\mathcal{S}} p^{e_{p}}\\). If \\(u\\) is a positive integer such that \\(u / M>\\alpha\\), then there exist nonnegative integers \\(a_{i}\\) such that\n\\[\n\\sum_{i} \\frac{a_{i}}{b_{i}}=\\frac{u}{M} .\n\\]\n\nThe problem statement follows after replacing \\(a_{i}\\) with \\(a_{i}+1\\) for each \\(i\\).\nTo prove this, choose some constant \\(c\\) such that \\(\\sum_{p \\in \\mathcal{S}} p^{-c}<\\alpha\\), and suppose \\(n\\) is large enough that \\(p^{c}<b_{n}\\) for each \\(p \\in \\mathcal{S}\\); in particular, \\(p^{c} \\mid M\\) with \\(M\\) defined as above.\n\nFor each \\(p \\in \\mathcal{S}\\), let \\(i_{p}\\) be such that \\(b_{i_{p}}=p^{e_{p}}\\) and choose the smallest nonnegative integer \\(a_{i_{p}}\\) satisfying\n\\[\np^{e_{p}-c} \\left\\lvert\\, a_{i_{p}}\\left(\\frac{M}{p^{e_{p}}}\\right)-u .\\right.\n\\]\n\nSuch an \\(a_{i_{p}}\\) must exist and be at most \\(p^{e_{p}-c}\\); indeed, \\(\\frac{M}{p^{e_{p}}}\\) is an integer coprime to \\(p\\), so we can take \\(a_{i_{p}}\\) to be equal to \\(u\\) times its multiplicative inverse modulo \\(p^{e_{p}-c}\\). The sum of the contributions to the sum from the \\(a_{i_{p}}\\) is at most\n\\[\n\\sum_{p \\in \\mathcal{S}} \\frac{p^{e_{p}-c}}{p^{e_{p}}}=\\sum_{p \\in \\mathcal{S}} p^{-c}<\\alpha\n\\]\n\nSo, we have\n\\[\n\\frac{u}{M}=\\sum_{p \\in \\mathcal{S}} \\frac{a_{i_{p}}}{p^{e_{p}}}+\\frac{r}{\\prod_{p \\in \\mathcal{S}} p^{c}},\n\\]\nwhere \\(r\\) is an integer because of our choice of \\(a_{i_{p}}\\) and \\(r\\) is nonnegative because of the bound on \\(u\\). Simply choose \\(a_{i}=r\\) where \\(b_{i}=\\prod_{p \\in \\mathcal{S}} p^{c}\\) to complete the proof.\n\nSolution 2. We reduce to the claim as in Solution 1, and provide an alternative approach for constructing the \\(a_{i}\\).\n\nLet \\(p_{0} \\in \\mathcal{S}\\) be the smallest prime in \\(\\mathcal{S}\\). Let \\(z_{0}=u / M\\). We construct a sequence \\(z_{0}, z_{1}\\), \\(z_{2}, \\ldots\\) and values of \\(a_{i}\\) by the following iterative process: to construct \\(z_{j+1}\\),\n- select the largest prime \\(p \\in \\mathcal{S}\\) dividing the denominator of \\(z_{j}\\), and let \\(\\mu\\) be the number of times \\(p\\) divides the denominator of \\(z_{j}\\);\n- choose the largest \\(\\nu\\) such that \\(p_{0}^{\\nu} p^{\\mu} \\leqslant b_{n}\\), and let \\(i \\leqslant n\\) be such that \\(b_{i}=p_{0}^{\\nu} p^{\\mu}\\);\n- choose \\(0 \\leqslant a_{i}<p\\) such that the denominator of \\(z_{k}-a_{i} / b_{i}\\) has at most \\(\\mu-1\\) factors of \\(p\\), and let \\(z_{k+1}=z_{k}-a_{i} / b_{i}\\);\n- continue until \\(p_{0}\\) is the only prime dividing the denominator of \\(z_{k}\\).\n\nNote that we can always choose \\(a_{i}\\) in step 3 ; by construction, \\(z_{k} b_{i}\\) has no factors of \\(p\\) in its denominator, so must be realised as an element of \\(\\mathbb{Z}_{p}\\).\n\nEach time we do this, \\(b_{i}>M / p_{0}\\) by construction, so\n\\[\n\\frac{a_{i}}{b_{i}}<\\frac{p p_{0}}{M} \\leqslant \\frac{p_{0} p_{1}}{M},\n\\]\nwhere \\(p_{1}\\) is the largest prime in \\(\\mathcal{S}\\). And the number of times we do this operation is at most\n\\[\n\\sum_{\\substack{p \\in \\mathcal{S} \\\\ p \\ngtr p_{0}}} e_{p} \\leqslant|\\mathcal{S}| \\log _{2}(M),\n\\]\nso the sum of the \\(a_{i} / b_{i}\\) we have assigned is at most \\(|\\mathcal{S}| p_{0} p_{1} \\log _{2}(M) / M\\).\nChoose \\(n\\) large enough that \\(\\log _{2}(M) / M<\\alpha\\); after subtracting the above choices of \\(a_{i} / b_{i}\\) from \\(u / M\\), we have a quantity of the form \\(r / p_{0}^{e_{p_{0}}}\\), where \\(r\\) is an integer by construction and \\(r\\) is positive by the above bounds. Simply set \\(a_{i}=r\\) where \\(b_{i}=p_{0}^{e_{0}}\\) to complete the proof.\n\nSolution 3. As in Solution 1, we may handle \\(|\\mathcal{S}|=1\\) and \\(\\mathcal{S}=\\{2,3\\}\\) separately; otherwise, we can define \\(\\alpha\\) as we did in that solution. Also define \\(e_{p}\\) to be the largest nonnegative integer such that \\(p^{e_{p}} \\leqslant b_{n}\\) as we did in Solution 1.\n\nWe will show that, for \\(n\\) sufficiently large, we may choose some \\(j \\leqslant n\\), and positive integers \\(a_{i}\\), such that\n\\[\n\\sum_{i \\neq j} \\frac{a_{i}}{b_{i}}-\\sum_{i \\neq j} \\frac{1}{b_{i}}<\\alpha .\n\\]\nand all \\(\\frac{a_{i}}{b_{i}}\\) are integer multiples of \\(\\frac{1}{b_{j}}\\). We then set \\(a_{j}\\) to be the least positive integer such that the sum on the left is an integer, which will obviously have the required value.\n\nConcretely, choose \\(j\\) such that \\(b_{j}=\\prod_{p \\in \\mathcal{S}} p^{\\left\\lfloor e_{p} /|\\mathcal{S}|\\right\\rfloor}\\), which is less than \\(b_{n}\\) by construction. For \\(i \\neq j\\), set \\(a_{i}=b_{i} / \\operatorname{gcd}\\left(b_{i}, b_{j}\\right)\\). We have\n\\[\n\\sum_{i \\neq j} \\frac{a_{i}}{b_{i}}-\\sum_{i \\neq j} \\frac{1}{b_{i}}<\\sum_{\\substack{i \\neq j \\\\ a_{i}>1}} \\frac{a_{i}}{b_{i}} .\n\\]\n\nIf \\(a_{i}>1\\), then there must be some \\(p \\in \\mathcal{S}\\) for which \\(p^{\\left\\lfloor e_{p}|\\mathcal{S}|\\right]+1} \\mid b_{i}\\), and so\n\\[\n\\frac{a_{i}}{b_{i}}=\\frac{1}{\\operatorname{gcd}\\left(b_{i}, b_{j}\\right)} \\leqslant \\frac{1}{p^{\\left\\lfloor e_{p} /|\\mathcal{S}|\\right]}}<\\frac{p}{b_{n}^{1 /|\\mathcal{S}|}},\n\\]\nwhere the last inequality follows from the fact that \\(p^{e_{p}+1}>b_{n}\\).\nNow \\(n \\leqslant \\prod_{p \\in \\mathcal{S}}\\left(\\log _{p}\\left(b_{n}\\right)+1\\right) \\leqslant\\left(2 \\log b_{n}\\right)^{|\\mathcal{S}|}\\), so\n\\[\n\\sum_{\\substack{i \\neq j \\\\ a_{i}>1}} \\frac{a_{i}}{b_{i}} \\leqslant \\frac{\\left(2 \\log b_{n}\\right)^{|\\mathcal{S}|}}{b_{n}^{1 /|\\mathcal{S}|}},\n\\]\nand so we can choose \\(n\\) large enough that this quantity is less than \\(\\alpha\\), as required.", "source_pdf": "imosl_2024.pdf", "notes": "fallback-regex"}
{"id": "IMOSL-2024-N6", "contest": "IMOSL", "year": "2024", "problem_number": "N6", "problem": "Let \\(n\\) be a positive integer. We say that a polynomial \\(P\\) with integer coefficients is \\(n\\)-good if there exists a polynomial \\(Q\\) of degree 2 with integer coefficients such that \\(Q(k)(P(k)+Q(k))\\) is never divisible by \\(n\\) for any integer \\(k\\).\n\nDetermine all integers \\(n\\) such that every polynomial with integer coefficients is an \\(n\\)-good polynomial.\n(France)", "solution": "Answer: The set of such \\(n\\) is any \\(n>2\\).\n\n1. First, observe that no polynomial is 1-good (because \\(Q(X)(P(X)+Q(X))\\) always has roots modulo 1) and the polynomial \\(P(X)=1\\) is not 2-good (because \\(Q(X)(Q(X)+1)\\) is always divisible by 2 ).\n\nNow, if \\(P\\) is \\(d\\)-good with some \\(Q\\), then \\(Q \\cdot(P+Q)\\) has no roots mod \\(d\\). Therefore, it certainly has no roots mod \\(n\\) for \\(d \\mid n\\), so \\(P\\) must be \\(n\\)-good. Consequently, it suffices to show that all polynomials are \\(n\\)-good whenever \\(n\\) is an odd prime, or \\(n=4\\).\n\nWe start by handling the case \\(n=4\\). We will construct a \\(Q\\) such that \\(Q(X)\\) is never divisible by 4 and \\(Q(X)+P(X)\\) is always odd; this will clearly show that \\(P\\) is 4-good. Note that any function modulo 2 must be either constant or linear - in other words, there are \\(a, b \\in\\{0,1\\}\\) such that \\(P(X)=a X+b \\bmod 2\\) for all \\(X\\). If \\(a=0\\) then set \\(Q(X)=4 X^{2}+b+1\\), and if \\(a=1\\) then set \\(Q(X)=X^{2}+b+1\\); in all cases, \\(Q\\) will satisfy the required properties.\n\nIt remains to prove that any polynomial is \\(p\\)-good, where \\(p\\) is an odd prime. We will prove that for any function \\(f\\) defined \\(\\bmod p\\), there is a quadratic \\(Q\\) with no roots \\(\\bmod p\\) such that \\(Q(x) \\neq f(x) \\bmod p\\) for all \\(x\\); the statement about \\(P\\) then follows with \\(f\\) replaced by \\(-P\\). For the remainder of the proof, we will consider all equalities modulo \\(p\\).\n\nSuppose that a function \\(f\\) not satisfying the above exists; in other words, \\(f\\) has the property that for any quadratic \\(Q\\) with no roots \\(\\bmod p\\), there is some \\(x\\) such that \\(Q(x)=f(x)\\). Without loss of generality, we may assume that \\(f\\) has no roots \\(\\bmod p\\). To see why, suppose that \\(f(u)=0\\) for some \\(u\\), and let \\(g\\) be the function such that \\(g(x)=f(x)\\) for \\(x \\neq u\\) and \\(g(u)=1\\). For any \\(Q\\) with no roots, we know that there is some \\(x \\neq u\\) such that \\(P(x)=f(x)\\), and so \\(P(x)=g(x)\\) for that choice of \\(x\\). In particular, \\(g\\) is also not \\(p\\)-good.\n\nNow, suppose first that there is some nonzero \\(t\\) such that \\(t\\) is not in the image of \\(f\\). Then we may take \\(Q(X)=p X^{2}+t\\); this quadratic is never equal to \\(f\\) and is never zero. Thus, \\(f\\) must be surjective onto the nonzero residues mod \\(p\\). There are \\(p\\) choices for \\(X\\) and \\(p-1\\) nonzero residues \\(\\bmod p\\), so there must be some \\(x_{1} \\neq x_{2} \\bmod p\\) such that \\(f\\left(x_{1}\\right)=f\\left(x_{2}\\right)\\), and \\(f\\) is a bijection from the set of residues \\(\\bmod p\\) not equal to \\(x_{2}\\) to the set of nonzero residues \\(\\bmod p\\).\n\nNow, note that we may choose any \\(b\\) and \\(c\\) with \\(b\\) nonzero and replace \\(f(X)\\) with \\(g(X)= f(b X+c)\\); if there were some \\(Q\\) with no roots such that \\(Q(x) \\neq g(x)\\) for all \\(x\\), then \\(Q(X / b-c / b)\\) would work for \\(f\\). Choose \\(b\\) and \\(c\\) such that \\(b x_{1}+c=1\\) and \\(b x_{2}+c=-1\\); such \\(b\\) and \\(c\\) must exist (we may take \\(b=2 /\\left(x_{1}-x_{2}\\right)\\) and \\(c=\\left(x_{1}+x_{2}\\right) /\\left(x_{2}-x_{1}\\right)\\) ). Renaming \\(g\\) to \\(f\\), we see that we may assume \\(f(1)=f(-1)\\).\n\nLet \\(r^{\\prime}\\) be a quadratic nonresidue \\(\\bmod p\\). Choose \\(y \\neq 0\\) such that \\(f(y)=\\left(1-r^{\\prime}\\right) f(0)\\), which must exist as the right hand side is nonzero and \\(1-r^{\\prime}\\) is not equal to 1 . Choose \\(r=y^{2} / r^{\\prime}\\), which is a quadratic nonresidue.\n\nConsider \\(\\phi(X)=f(X) /\\left(X^{2}-r\\right)\\). By definition, \\(\\phi(1)=\\phi(-1)\\) and \\(\\phi(0)=\\phi(y)\\), so there are no more than \\(p-2\\) values in the image of \\(\\phi\\). Choose some nonzero \\(a\\) not in the image of \\(\\phi\\), so \\(f(X) /\\left(X^{2}-r\\right)\\) is never equal to \\(a\\). The quadratic \\(Q(X)=a\\left(X^{2}-r\\right)\\) is never zero and also never equal to \\(f(X)\\), which completes the proof.\n\nComment. In fact, there is no need to pass from polynomials \\(P\\) to functions \\(f\\), as any function mod \\(p\\) is a polynomial. Concretely, instead of passing from \\(f\\) to \\(g\\), we would have instead replaced \\(P(X)\\) with \\(P(X)+1-(X-u)^{p-1}\\), which is a polynomial that is unchanged except at \\(X=u\\).\n\nSolution 2. Given \\(f\\) a function mod \\(p\\) such that \\(f\\) is surjective onto the nonzero elements of \\(\\mathbb{Z} / p \\mathbb{Z}\\) and \\(f(1)=f(-1)\\), we provide an alternative approach to construct a nonzero quadratic \\(Q(X)\\) such that \\(Q(X) \\neq f(X)\\). Let \\(r\\) be the smallest quadratic nonresidue mod \\(p\\) (so \\(r-1\\) is a square) and let \\(a\\) vary over the nonzero elements mod \\(p\\); we will show that it is possible to choose \\(Q_{a}(X)=a\\left(X^{2}-r\\right)\\) for some choice of \\(a\\). Note that any quadratic of this form will be nowhere zero.\n\nSuppose that no such \\(Q_{a}\\) works. Then, for each \\(a\\), there exists \\(x\\) such that \\(a\\left(x^{2}-r\\right)=f(x)\\). We may assume that \\(x \\neq-1\\), as if the equality holds for \\(x=-1\\) then it also holds for \\(x=1\\). However, \\(a\\left(x^{2}-r\\right)=f(x)\\) implies \\(a=f(x) /\\left(x^{2}-r\\right)\\), so \\(f(x) /\\left(x^{2}-r\\right)\\) must be a surjection from \\(\\{x \\neq-1\\}\\) to the set of nonzero \\(a\\), and so this is a bijection. In particular, for each \\(a\\), there exists a unique \\(x_{a}\\) such that \\(f\\left(x_{a}\\right)=a\\left(x_{a}^{2}-r\\right)\\).\n\nWe now have\n\\[\n\\begin{aligned}\n\\prod_{t \\neq 0} t & =\\prod_{a \\neq 0} f\\left(x_{a}\\right) \\\\\n& =\\prod_{a \\neq 0} a \\prod_{a \\neq 0}\\left(x_{a}^{2}-r\\right) \\\\\n& =\\prod_{a \\neq 0} a \\prod_{x \\neq-1}\\left(x^{2}-r\\right)\n\\end{aligned}\n\\]\nwhere the first equality follows because \\(f\\) is surjective onto the nonzero residues mod \\(p\\), and the second equality follows from the definition of \\(x_{a}\\). The two products cancel, which means that \\(\\prod_{x \\neq-1}\\left(x^{2}-r\\right)=1\\).\n\nHowever, we also get\n\\[\n\\prod_{x \\neq-1}\\left(x^{2}-r\\right)=(-r)(1-r)\\left(\\prod_{x=2}^{(p-1) / 2}\\left(x^{2}-r\\right)\\right)^{2}\n\\]\n\nHowever, this is a contradiction as \\(-r(1-r)=r(r-1)\\), which is not a quadratic residue (by our choice of \\(r\\) ).\n\nComment. By Wilson's theorem, we know that the product of the nonzero elements mod \\(p\\) is -1 ; however, this fact was not necessary for the solution so we chose to present the solution without needing to state it.\n\nComment. One can in fact show that\n\\[\n\\prod_{x \\neq-1}\\left(x^{2}-r\\right)=\\frac{-4 r}{1-r}\n\\]\n\nTo do this, note that the polynomial \\(X^{\\frac{p-1}{2}}-1\\) has the \\(\\frac{p-1}{2}\\) quadratic residues as roots, so we have\n\\[\n\\prod_{s \\text { quad. res. }}(X-s)=X^{\\frac{p-1}{2}}-1\n\\]\nand so\n\\[\n\\prod_{x \\neq 0}\\left(X-x^{2}\\right)=\\left(X^{\\frac{p-1}{2}}-1\\right)^{2}\n\\]\n\nSince \\(r\\) is a quadratic nonresidue, by Euler's criterion \\(r^{\\frac{p-1}{2}}=-1\\), and the result follows.\nTherefore, one can replace the condition that \\(r\\) is the smallest quadratic nonresidue with the condition that \\(r\\) is a quadratic nonresidue not equal to \\(-\\frac{1}{3}\\) (which is possible for all \\(p \\geqslant 3\\) ).\n\nSolution 3. As in Solution 1, we will reduce to the case of \\(p\\) being an odd prime and \\(f\\) being a function \\(\\bmod p\\) with no roots which is surjective onto the set of nonzero residues \\(\\bmod p\\), although we make no assumption about the values of \\(x_{1}\\) and \\(x_{2}\\) with \\(f\\left(x_{1}\\right)=f\\left(x_{2}\\right)\\).\n\nWe will again consider quadratics of the form \\(Q_{a, b, c}(X)=a R(b X+c)\\), where \\(R(X)=X^{2}-r\\) for an arbitrary fixed quadratic nonresidue \\(r, a\\) and \\(b\\) are nonzero \\(\\bmod p\\), and \\(c\\) is any residue \\(\\bmod p\\).\n\nFor each fixed \\(b\\) and \\(c\\), there must be \\(n\\) pairs ( \\(a, x\\) ) such that \\(a R(b x+c)=f(x)\\), because there must be exactly one value of \\(a\\) for each \\(x\\). If any \\(a\\) appears in no such pair then we are done, so assume otherwise. In other words, there must be exactly one \\(a\\) such that there are two such \\(x\\), and for all other \\(a\\) there is only one such \\(x\\).\n\nThus, for each ( \\(b, c\\) ), there is exactly one unordered pair \\(\\left\\{x_{1}, x_{2}\\right\\}\\) such that for some \\(a\\) we have \\(f\\left(x_{i}\\right)=a R\\left(b x_{i}+c\\right)\\); in other words, there is exactly one unordered pair \\(\\left\\{x_{1}, x_{2}\\right\\}\\) such that \\(f\\left(x_{1}\\right) / R\\left(b x_{1}+c\\right)=f\\left(x_{2}\\right) / R\\left(b x_{2}+c\\right)\\).\n\nNow, we show that for each unordered pair \\(\\left\\{x_{1}, x_{2}\\right\\}\\) there must be at least one pair ( \\(b, c\\) ) such that \\(f\\left(x_{1}\\right) / R\\left(b x_{1}+c\\right)=f\\left(x_{2}\\right) / R\\left(b x_{2}+c\\right)\\). Indeed, let \\(t=f\\left(x_{1}\\right) / f\\left(x_{2}\\right)\\). There must be some \\(x_{1}^{\\prime}, x_{2}^{\\prime}\\) such that \\(R\\left(x_{1}^{\\prime}\\right) / R\\left(x_{2}^{\\prime}\\right)=t\\); this is because \\(R(X)\\) and \\(t R(X)\\) both take \\(\\frac{p+1}{2}\\) nonzero values \\(\\bmod p\\), so the intersection must be nonempty by the pigeonhole principle. Choosing \\(b\\) and \\(c\\) such that \\(b x_{1}+c=x_{1}^{\\prime}\\) and \\(b x_{2}+c=x_{2}^{\\prime}\\) gives the claim.\n\nNote further that if \\((b, c)\\) and \\(\\left\\{x_{1}, x_{2}\\right\\}\\) satisfy the relation, then the same is true for \\((-b,-c)\\) and \\(\\left\\{x_{1}, x_{2}\\right\\}\\) because \\(R(b x+c)=R(-b x-c)\\). Since \\(b\\) is nonzero, this means that each pair \\(\\left\\{x_{1}, x_{2}\\right\\}\\) corresponds to at least two pairs ( \\(b, c\\) ). However, since there are \\(p(p-1)\\) pairs ( \\(b, c\\) ) with \\(b\\) nonzero and \\(p(p-1) / 2\\) unordered pairs \\(\\left\\{x_{1}, x_{2}\\right\\}\\), each \\(\\left\\{x_{1}, x_{2}\\right\\}\\) must correspond to exactly two pairs ( \\(b, c\\) ) and ( \\(-b,-c\\) ) for some ( \\(b, c\\) ).\n\nNow, since the image of \\(f\\) has only \\(p-1\\) elements, there must be some \\(x_{1}, x_{2}\\) such that \\(f\\left(x_{1}\\right)=f\\left(x_{2}\\right)\\). Choose any \\(b, c\\) such that \\(b x_{1}+c=-\\left(b x_{2}+c\\right)\\), so \\(R\\left(b x_{1}+c\\right)=R\\left(b x_{2}+c\\right)\\) and so \\(f\\left(x_{1}\\right) / R\\left(b x_{1}+c\\right)=f\\left(x_{2}\\right) / R\\left(b x_{2}+c\\right)\\). There is such a pair \\(b, c\\) for any nonzero \\(b\\), so there are at least \\(p-1\\) such pairs, and this quantity is greater than 2 for \\(p \\geqslant 5\\).\n\nFinally, for the special case that \\(p=3\\), we observe that there must be at least one allowed value for \\(Q(x)\\) for each \\(x\\), so there must exist such a quadratic \\(Q\\) by Lagrange interpolation.\n\nComment. We may also handle the case \\(p=3\\) as follows. Recall that we may assume \\(f\\) is nonzero and surjective onto \\(\\{1,2\\} \\bmod 3\\), so the image of \\(f\\) must be \\((1,1,2)\\) or \\((1,2,2)\\) in some order. Without loss of generality \\(f(1)=f(2)\\), so we either have \\((f(0), f(1), f(2))=(1,2,2)\\) or \\((2,1,1)\\). In the first case, take \\(Q(X)=2 X^{2}+2\\), and in the second case take \\(Q(X)=X^{2}+1\\).\n\nIn some sense, this is equivalent to the Lagrange interpolation approach, as in each case the polynomial \\(Q(X)\\) can be determined by Lagrange interpolation.\n\nSolution 4. Again, we reduce to the case of \\(p\\) being an odd prime and \\(f\\) being a function \\(\\bmod p\\); we will show that there is a quadratic which is nowhere zero such that \\(Q(x)=f(x)\\) has no root. We can handle the case of \\(p=3\\) separately as in Solution 3, so assume that \\(p \\geqslant 5\\).\n\nWe will prove the following more general statement: let \\(p \\geqslant 5\\) be a prime and let \\(\\mathcal{A}_{1}, \\mathcal{A}_{2}\\), \\(\\ldots, \\mathcal{A}_{p}\\) be subsets of \\(\\mathbb{Z} / p \\mathbb{Z}\\) with \\(\\left|\\mathcal{A}_{i}\\right|=2\\) for all \\(i\\). Then there exists a polynomial \\(Q \\in \\mathbb{Z} / p \\mathbb{Z}[X]\\) of degree at most 2 such that \\(Q(i) \\notin \\mathcal{A}_{i}\\) for all \\(i\\). Indeed, applying this statement to the sets \\(\\mathcal{A}_{i}=\\{0, f(i)\\}\\) (and adding \\(p X^{2}\\) if necessary) produces a quadratic \\(Q\\) satisfying the desired property.\n\nChoose the coefficients of \\(Q\\) uniformly at random from \\(\\mathbb{Z} / p \\mathbb{Z}\\), and let \\(T\\) be the random variable denoting the number of \\(i\\) for which \\(Q(i) \\in \\mathcal{A}_{i}\\). Observe that for \\(k \\leqslant 3\\), we have\n\\[\n\\mathbb{E}\\left[\\binom{T}{k}\\right]=2^{k}\\binom{p}{k} p^{-k} .\n\\]\n\nTo see why, let \\(k \\leqslant 3\\). If \\(\\mathcal{S} \\subseteq \\mathbb{Z} / p \\mathbb{Z}\\) has size \\(k\\) and \\(\\left(a_{i}\\right)_{i \\in \\mathcal{S}}\\) is a \\(k\\)-tuple, the probability that \\(Q(i)=a_{i}\\) on \\(\\mathcal{S}\\) is equal to \\(p^{-k}\\); for \\(k=3\\) this follows by Lagrange interpolation, and for \\(k<3\\)\nit follows from the \\(k=3\\) case by summing. The expectation is therefore equal to the number of \\(\\mathcal{S} \\subseteq \\mathbb{Z} / p \\mathbb{Z}\\) of size \\(k\\) times the probability that \\(Q(i) \\in \\mathcal{A}_{i}\\) for each \\(i \\in \\mathcal{S}\\), which is equal to the right hand side as each \\(\\mathcal{A}_{i}\\) has size 2 .\n\nNow, observe that we have the identity \\((t-1)(t-3)(t-4)=-12+12\\binom{t}{1}-10\\binom{t}{2}+6\\binom{t}{3}\\), so\n\\[\n\\begin{aligned}\n\\mathbb{E}[(T-1)(T-3)(T-4)] & =-12+12 \\mathbb{E}\\left[\\binom{T}{1}\\right]-10 \\mathbb{E}\\left[\\binom{T}{2}\\right]+6 \\mathbb{E}\\left[\\binom{T}{3}\\right] \\\\\n& =-12+12 \\cdot 2-10 \\cdot 2\\left(1-\\frac{1}{p}\\right)+6 \\cdot \\frac{4}{3}\\left(1-\\frac{1}{p}\\right)\\left(1-\\frac{2}{p}\\right) \\\\\n& =-\\frac{4}{p}+\\frac{16}{p^{2}}\n\\end{aligned}\n\\]\n\nThis is negative for \\(p \\geqslant 5\\). Because \\((t-1)(t-3)(t-4) \\geqslant 0\\) for all integers \\(t>0\\), it then follows that \\(T=0\\) with positive probability, which implies that there must exist some \\(Q\\) with \\(Q(i) \\notin \\mathcal{A}_{i}\\) for all \\(i\\), as desired.\n\nComment. We do not have much freedom to choose a different polynomial in place of \\(R(T)= (T-1)(T-3)(T-4)\\) in this argument. Indeed, it can be shown (by comparing coefficients of \\(\\binom{T}{K}\\) ) that if \\(R\\) has degree at most 3 , then the expected value of \\(R(T)\\) tends to \\(\\frac{1}{3}(R(4)+2 R(1))\\) as \\(p\\) tends to infinity, so \\(R\\) must have both 1 and 4 as roots. In particular, \\(R\\) must be of the form \\(R(T)=(T-1)(T-4)(T-d)\\) for some \\(d \\geqslant 3\\), and if \\(d<4\\) then the argument works for any \\(p\\) with \\(p>4 /(4-d)\\).", "source_pdf": "imosl_2024.pdf", "notes": "fallback-regex"}
{"id": "IMOSL-2024-N7", "contest": "IMOSL", "year": "2024", "problem_number": "N7", "problem": "Let \\(\\mathbb{Z}_{>0}\\) denote the set of positive integers. Let \\(f: \\mathbb{Z}_{>0} \\rightarrow \\mathbb{Z}_{>0}\\) be a function satisfying the following property: for \\(m, n \\in \\mathbb{Z}_{>0}\\), the equation\n\\[\nf(m n)^{2}=f\\left(m^{2}\\right) f(f(n)) f(m f(n))\n\\]\nholds if and only if \\(m\\) and \\(n\\) are coprime.\nFor each positive integer \\(n\\), determine all the possible values of \\(f(n)\\).\n(Japan)", "solution": "Answer: All numbers with the same set of prime factors as \\(n\\).\nCommon remarks. We refer to the given property as \\(P(m, n)\\). We use the notation \\(\\operatorname{rad}(n)\\) for the radical of \\(n\\) : the product of the distinct primes dividing \\(n\\).\n\n1. We start with a series of straightforward deductions:\n- From \\(P(1,1)\\), we have \\(f(1)^{2}=f(1) f(f(1))^{2}\\), so \\(f(1)=f(f(1))^{2}\\).\n- From \\(P(1, f(1))\\), we have \\(f(f(1))^{2}=f(1) f(f(f(1))) f(f(f(1)))\\), so \\(f(f(f(1)))=1\\).\n- From \\(P(1, f(f(1)))\\), we have \\(f(f(f(1)))^{2}=f(1) f(f(f(f(1)))) f(f(f(f(1))))\\), which simplifies to \\(1=f(1)^{3}\\), so \\(f(1)=1\\).\n- From \\(P(1, n)\\) we deduce \\(f(n)=f(f(n))\\) for all \\(n\\).\n- From \\(P(m, 1)\\) we deduce \\(f(m)=f\\left(m^{2}\\right)\\) for all \\(m\\).\n- Simplifying \\(P(m, n)\\), we have that\n\\[\nf(m n)^{2}=f(m) f(n) f(m f(n))\n\\]\nif and only if \\(m\\) and \\(n\\) are coprime; refer to this as \\(Q(m, n)\\).\n- From \\(Q(m, f(n))\\), we have that \\(f(m f(n))=f(m) f(n)\\) if and only if \\(m\\) and \\(f(n)\\) are coprime; refer to this as \\(R(m, n)\\).\n\nClaim. If \\(f(a)=1\\), then \\(a=1\\).\nProof. If \\(a \\neq 1\\), then \\(Q(a, a)\\) gives \\(f(a)^{2} \\neq f(a)^{2} f(a f(a))\\). If \\(f(a)=1\\), then both sides simplify to 1 , a contradiction.\n\nClaim. If \\(n \\neq 1\\) then \\(\\operatorname{gcd}(n, f(n)) \\neq 1\\).\nProof. If \\(\\operatorname{gcd}(n, f(n))=1\\), then \\(Q(f(n), n)\\) gives \\(f(n f(n))^{2}=f(n)^{3}\\), and \\(Q(n, f(n))\\) gives \\(f(n f(n))^{2}=f(n)^{2} f(n f(n))\\), which together yield \\(f(n)=1\\) for a contradiction.\nClaim. For all \\(n\\) we have \\(\\operatorname{rad}(n) \\mid f(n)\\).\nProof. For any prime \\(p \\mid n\\), write \\(n=p^{v} n^{\\prime}\\) with \\(p \\nmid n^{\\prime}\\). From \\(Q\\left(p^{v}, n^{\\prime}\\right)\\) we have \\(f(n)^{2}= f\\left(p^{v}\\right) f\\left(n^{\\prime}\\right) f\\left(p^{v} f\\left(n^{\\prime}\\right)\\right)\\). Since \\(\\operatorname{gcd}\\left(p^{v}, f\\left(p^{v}\\right)\\right) \\neq 1\\), it follows that \\(p \\mid f\\left(p^{v}\\right)\\), so \\(p \\mid f(n)\\), and thus \\(\\operatorname{rad}(n) \\mid f(n)\\).\nClaim. If \\(n\\) is coprime to \\(f(k)\\), then \\(f(n)\\) is coprime to \\(f(k)\\).\nProof. From \\(Q(f(k), n)\\) we have \\(f(n f(k))^{2}=f(k) f(n) f(f(k) f(n))\\); applying \\(R(n, k)\\) to the LHS, we conclude that \\(f(k) f(n)=f(f(k) f(n))\\). Applying \\(R(f(n), k)\\) we deduce that \\(f(n)\\) is coprime to \\(f(k)\\), as required.\n\nClaim. If \\(p\\) is prime then \\(f(p)\\) is a power of \\(p\\).\n\nProof. Suppose otherwise. We know that \\(p \\mid f(p)\\); let \\(q \\neq p\\) be another prime with \\(q \\mid f(p)\\).\nIf, for some positive integer \\(N\\), we have \\(p \\nmid f(N)\\), then \\(f(p)\\) is coprime to \\(f(N)\\), so \\(q \\nmid f(N)\\), so \\(q \\nmid N\\); thus, if \\(q \\mid N\\), then \\(p \\mid f(N)\\) (and in particular, \\(p \\mid f(q)\\), by taking \\(N=q\\) ).\n\nSimilarly, if \\(q \\nmid f(N)\\) then \\(f(q)\\) is coprime to \\(f(N)\\); as \\(p \\mid f(q)\\), this means \\(p \\nmid f(N)\\), so \\(p \\nmid N\\). So if \\(p \\mid N\\), then \\(q \\mid f(N)\\).\n\nTogether with \\(\\operatorname{rad}(n) \\mid f(n)\\), this means that for any \\(n\\) not coprime to \\(p q\\), we have \\(p q \\mid f(n)\\).\nLet \\(m=\\min \\left\\{\\nu_{p}(f(x)) \\mid x\\right.\\) is not coprime to \\(\\left.p q\\right\\}\\), and let \\(X\\) be a positive integer not coprime to \\(p q\\) such that \\(\\nu_{p}(f(X))=m\\). The argument above shows \\(m \\geqslant 1\\). We can write \\(f(X)= p^{m} q^{y} X^{\\prime}\\), where \\(y \\geqslant 1, p \\nmid X^{\\prime}\\) and \\(q \\nmid X^{\\prime}\\). Since \\(f(f(X))=f(X)\\) we have \\(f\\left(p^{m} q^{y} X^{\\prime}\\right)=p^{m} q^{y} X^{\\prime}\\). Applying \\(Q\\left(p^{m}, q^{y} X^{\\prime}\\right)\\) gives \\(\\left(p^{m} q^{y} X^{\\prime}\\right)^{2}=f\\left(p^{m}\\right) f\\left(q^{y} X^{\\prime}\\right) f\\left(p^{m} f\\left(q^{y} X^{\\prime}\\right)\\right)\\). The RHS is divisible by \\(p^{3 m}\\) but the LHS is only divisible by \\(p^{2 m}\\), yielding a contradiction.\n\nClaim. For any integer \\(n, \\operatorname{rad}(f(n))=\\operatorname{rad}(n)\\).\nProof. We already have that \\(\\operatorname{rad}(n) \\mid f(n)\\), so it remains only to show that no other primes divide \\(f(n)\\). If \\(p\\) is prime and \\(p \\nmid n\\), the previous Claim shows that \\(n\\) is coprime to \\(f(p)\\), and thus \\(f(n)\\) is coprime to \\(f(p)\\); that is, \\(p \\nmid f(n)\\). So exactly the same primes divide \\(f(n)\\) as divide \\(n\\).\n\nIt remains only to exhibit functions that show all values of \\(f(n)\\) with \\(\\operatorname{rad}(f(n))=\\operatorname{rad}(n)\\) are possible. Given \\(e(p) \\geqslant 1\\) for each prime \\(p\\), take\n\\[\nf(n)=\\prod_{p \\mid n} p^{e(p)}\n\\]\nand we verify by examining exponents of each prime that this satisfies the conditions of the problem.\n\nComment. A quicker but less straightforward proof that \\(f(1)=1\\) is to let \\(f(n)=M\\) be the least value that \\(f\\) takes; then \\(P(1, n)\\) gives \\(M^{2}=f(n)^{2}=f(1) f(f(n))^{2} \\geqslant M^{3}\\) so \\(M=1\\) and \\(f(1)=1\\).\n\nSolution 2. As in Solution 1, we see that there are indeed functions \\(f\\) satisfying the given condition and producing all the given values of \\(f(n)\\), and we follow Solution 1 to show the following facts:\n- \\(f(1)=1\\).\n- \\(f(m)=f\\left(m^{2}\\right)\\) for all \\(m\\).\n- \\(f(n)=f(f(n))\\) for all \\(n\\).\n- \\(f(m n)^{2}=f(m) f(n) f(m f(n))\\) if and only if \\(m\\) and \\(n\\) are coprime; refer to this as \\(Q(m, n)\\).\n\nTaking \\(Q(m, n)\\) together with \\(Q(n, m)\\) gives that \\(f(m f(n))=f(n f(m))\\) if \\(m\\) and \\(n\\) are coprime.\nSuppose now that \\(m\\) is coprime to both \\(n\\) and \\(f(n)\\). We have \\(f(m n)^{2}=f(m) f(n) f(m f(n))\\) and squaring both sides gives\n\\[\n\\begin{aligned}\nf(m n)^{4} & =f(m)^{2} f(n)^{2} f(m f(n))^{2} \\\\\n& =f(m)^{2} f(n)^{2} f(m) f(f(n)) f(m f(f(n))) \\\\\n& =f(m)^{3} f(n)^{3} f(m f(n))\n\\end{aligned}\n\\]\n\nThus \\(f(m f(n))=f(m) f(n)\\), so \\(f(m n)^{2}=f(m)^{2} f(n)^{2}\\), so \\(f(m n)=f(m) f(n)=f(m f(n))= f(n f(m))\\).\n\nIf \\(m\\) is coprime to both \\(n\\) and \\(f(n)\\) but however \\(n\\) is not coprime to \\(f(m)\\), we have\n\\[\n\\begin{aligned}\nf(n f(m))^{2} & \\neq f(n) f(f(m)) f(n f(f(m))) \\\\\n& =f(n) f(m) f(n f(m)) \\\\\n& =f(n f(m))^{2},\n\\end{aligned}\n\\]\na contradiction. Thus, given that \\(m\\) and \\(n\\) are coprime, we know that \\(m\\) is coprime to \\(f(n)\\) if and only if \\(n\\) is coprime to \\(f(m)\\). In particular, if \\(p\\) and \\(q\\) are different primes, then \\(p \\mid f(q)\\) if and only if \\(q \\mid f(p)\\), and likewise, for any positive integer \\(k, p \\mid f\\left(q^{k}\\right)\\) if and only if \\(q \\mid f(p)\\). More generally, if \\(p \\nmid n\\), then \\(p \\mid f(n)\\) if and only if \\(n\\) is not coprime to \\(f(p)\\).\n\nNow form a graph whose vertices are the primes, and where there is an edge between primes \\(p \\neq q\\) if and only if \\(p \\mid f(q)\\) (and so \\(q \\mid f(p)\\) ); every vertex has finite degree. For any integer \\(n\\), the primes dividing \\(f(n)\\) are all the primes that are neighbours of any prime \\(q \\mid n\\), together possibly with some further primes \\(p \\mid n\\).\n\nIf \\(p\\) and \\(q\\) are different primes, we have \\(f(p f(q))=f(q f(p))\\). The LHS is divisible by all primes that (in the graph) are neighbours of \\(p\\) or neighbours of neighbours of \\(q\\), and possibly also by \\(p\\) and by some primes that are neighbours of \\(q\\), and a corresponding statement with \\(p\\) and \\(q\\) swapped applies to the RHS. Thus any prime that is a neighbour of a neighbour of \\(q\\) must be one of: \\(p, q\\), distance 1 from \\(q\\), or distance 1 or 2 from \\(p\\). For any prime \\(r\\) that is distance 2 from \\(q\\), there are only finitely many primes \\(p\\) that it is distance 2 or less from, so by choosing a suitable prime \\(p\\) (depending on \\(q\\) ) we conclude that every prime that is a neighbour of a neighbour of \\(q\\) is actually \\(q\\) itself or a neighbour of \\(q\\).\n\nSo the connected components of the graph are (finite) complete graphs. If \\(m\\) is divisible only by primes in one component, and \\(n\\) is divisible only by primes in another component, then \\(f(m n)=f(m) f(n)\\). If \\(n\\) is divisible by more than one prime from a component, considering the expression for \\(f(m n)^{2}\\) as applied with successive prime power divisors of \\(n\\) shows that \\(f(n)\\) is divisible by all the primes in that component. However, while \\(f\\left(p^{k}\\right)\\) is divisible by all the primes in the component of \\(p\\) except possibly for \\(p\\) itself, we do not yet know that \\(p \\mid f\\left(p^{k}\\right)\\). We now consider cases for the order of a component.\n\nFor any prime \\(p\\), we cannot have \\(f\\left(p^{k}\\right)=1\\), because \\(Q\\left(p^{k}, p^{k}\\right)\\) gives\n\\[\nf\\left(p^{2 k}\\right)^{2} \\neq f\\left(p^{k}\\right) f\\left(p^{k}\\right) f\\left(p^{k} f\\left(p^{k}\\right)\\right),\n\\]\nand simplifying using \\(f\\left(m^{2}\\right)=f(m)\\) results in \\(1 \\neq 1\\). So for a component of order \\(1, f\\left(p^{k}\\right)\\) is a positive power of \\(p\\), so has the same set of prime factors as \\(p\\), as required.\n\nNow consider a component of order at least 2. Since \\(f(f(n))=f(n)\\), if the component has order at least 3 , then for any \\(n \\neq 1\\) whose prime divisors are in that component, \\(f(n)\\) is divisible by all the primes in that component. If the component has order 2, we saw above that this is true except possibly for \\(n=p^{k}\\). However, if the primes in the component are \\(p\\) and \\(q\\), and \\(f\\left(p^{k}\\right)=q^{\\ell}\\), then \\(f\\left(q^{\\ell}\\right)=f\\left(f\\left(p^{k}\\right)\\right)=f\\left(p^{k}\\right)=q^{\\ell}\\), which contradicts \\(p \\mid f\\left(q^{\\ell}\\right)\\). So for any component of order at least 2 , and any \\(n \\neq 1\\) whose prime divisors are in that component, \\(f(n)\\) is divisible by all the primes in that component.\n\nIn a component of order at least 2 , let \\(m\\) be the product of all the primes in that component, and let \\(t\\) be maximal such that \\(m^{t} \\mid f(n)\\) for all \\(n \\neq 1\\) whose prime divisors are in that component; we have seen that \\(t \\geqslant 1\\). If \\(m\\) and \\(n\\) are coprime numbers greater than 1 , all of whose prime divisors are in that component, then \\(Q(m, n)\\) tells us that \\(m^{3 t / 2} \\mid f(m n)\\). For any \\(n^{\\prime} \\neq 1\\), all of whose prime divisors are in that component, \\(f\\left(n^{\\prime}\\right)\\) is divisible by all the primes in that component, so can be expressed as such a product, so \\(m^{3 t / 2} \\mid f\\left(f\\left(n^{\\prime}\\right)\\right)=f\\left(n^{\\prime}\\right)\\). But this means \\(t \\geqslant 3 t / 2\\), a contradiction, so all components have order 1 , and we are done.\n\nThe activities of the Problem Selection Committee were supported by the University of Cambridge\n\nSupported by:", "source_pdf": "imosl_2024.pdf", "notes": "fallback-regex"}
{"id": "PUTNAM-2016-A1", "contest": "PUTNAM", "year": "2016", "problem_number": "A1", "problem": "Find the smallest positive integer $j$ such that for every polynomial $p(x)$ with integer coefficients and for every integer $k$, the integer\n\\[\np^{(j)}(k) = \\left. \\frac{d^j}{dx^j} p(x) \\right|_{x=k} \n\\] \n(the $j$-th derivative of $p(x)$ at $k$) is divisible by 2016.", "solution": "The answer is $j=8$. First suppose that $j$ satisfies the given condition. For $p(x) = x^j$, we have $p^{(j)}(x) = j!$ and thus $j!$ is divisible by $2016$. Since $2016$ is divisible by $2^5$ and $7!$ is not, it follows that $j \\geq 8$. Conversely, we claim that $j=8$ works. Indeed, let $p(x) = \\sum_{m=0}^n a_m x^m$ be a polynomial with integer coefficients; then if $k$ is any integer, \n\\[\\begin{align*}\np^{(8)}(k) &= \\sum_{m=8}^n m(m-1)\\cdots (m-7) a_m k^{m-8} \\\\\n&= \\sum_{m=8}^n {m\\choose 8} 8! a_m k^{m-8}\n\\end{align*}\\]\nis divisible by $8! = 20 \\cdot 2016$, and so $p^{(8)}(k)$ is divisible by $2016$.\n\n\\noindent\n\\textbf{Remark:}\nBy the same reasoning, if one replaces $2016$ in the problem by a general integer $N$,\nthen the minimum value of $j$ is the smallest one for which $N$ divides $j!$.\nThis can be deduced from P\\'olya's observation that the set of integer-valued polynomials is the free $\\ZZ$-module generated by the binomial polynomials $\\binom{x}{n}$ for $n=0,1,\\dots$. That statement can be extended to polynomials evaluated on a subset of a Dedekind domain using Bhargava's method of \\emph{$P$-orderings}; we do not know if this generalization can be adapted to the analogue of this problem, where one considers polynomials whose $j$-th derivatives take integral values on a prescribed subset.", "source_problems": "PUTNAM-2016-problems.tex", "source_solutions": "PUTNAM-2016-solutions.tex", "notes": ""}
{"id": "PUTNAM-2016-A2", "contest": "PUTNAM", "year": "2016", "problem_number": "A2", "problem": "Given a positive integer $n$, let $M(n)$ be the largest integer $m$ such that \n\\[\n\\binom{m}{n-1} > \\binom{m-1}{n}.\n\\]\nEvaluate \n\\[\n\\lim_{n \\to \\infty} \\frac{M(n)}{n}.\n\\]", "solution": "The answer is $\\frac{3+\\sqrt{5}}{2}$. Note that for $m > n+1$, both binomial coefficients are nonzero and their ratio is\n\\begin{align*}\n{m\\choose n-1}/{m-1\\choose n} &= \\frac{m!n!(m-n-1)!}{(m-1)!(n-1)!(m-n+1)!} \\\\\n&= \\frac{mn}{(m-n+1)(m-n)}.\n\\end{align*}\nThus the condition ${m\\choose{n-1}} > {{m-1}\\choose n}$ is equivalent to $(m-n+1)(m-n)-mn < 0$. The left hand side of this last inequality is a quadratic function of $m$ with roots\n\\begin{align*}\n\\alpha(n) &= \\frac{3n-1+\\sqrt{5n^2-2n+1}}{2}, \\\\\n\\beta(n) &= \\frac{3n-1-\\sqrt{5n^2-2n+1}}{2},\n\\end{align*}\nboth of which are real since $5n^2-2n+1 = 4n^2+(n-1)^2 > 0$; it follows that $m$ satisfies the given inequality if and only if $\\beta(n) < m < \\alpha(n)$. (Note in particular that since $\\alpha(n)-\\beta(n) = \\sqrt{5n^2-2n+1} > 1$, there is always some integer $m$ between $\\beta(n)$ and $\\alpha(n)$.)\n\n\nWe conclude that $M(n)$ is the greatest integer strictly less than $\\alpha(n)$, and thus that \n$\\alpha(n)-1 \\leq M(n) < \\alpha(n)$. Now\n\\[\n\\lim_{n\\to\\infty} \\frac{\\alpha(n)}{n} = \\lim_{n\\to\\infty} \\frac{3-\\frac{1}{n}+\\sqrt{5-\\frac{2}{n}+\\frac{1}{n^2}}}{2}\n= \\frac{3+\\sqrt{5}}{2}\n\\]\nand similarly $\\lim_{n\\to\\infty} \\frac{\\alpha(n)-1}{n} = \\frac{3+\\sqrt{5}}{2}$, and so by the sandwich theorem, $\\lim_{n\\to\\infty} \\frac{M(n)}{n} = \\frac{3+\\sqrt{5}}{2}$.", "source_problems": "PUTNAM-2016-problems.tex", "source_solutions": "PUTNAM-2016-solutions.tex", "notes": ""}
{"id": "PUTNAM-2016-A3", "contest": "PUTNAM", "year": "2016", "problem_number": "A3", "problem": "Suppose that $f$ is a function from $\\mathbb{R}$ to $\\mathbb{R}$ such that\n\\[\nf(x) + f\\left( 1 - \\frac{1}{x} \\right) = \\arctan x\n\\]\nfor all real $x \\neq 0$. (As usual, $y = \\arctan x$ means $-\\pi/2 < y < \\pi/2$ and $\\tan y = x$.) Find \n\\[\n\\int_0^1 f(x)\\,dx.\n\\]", "solution": "The given functional equation, along with the same equation but with $x$ replaced by $\\frac{x-1}{x}$ and $\\frac{1}{1-x}$ respectively, yields:\n\\begin{align*}\nf(x) + f\\left(1-\\frac{1}{x}\\right) &= \\tan^{-1}(x) \\\\\nf\\left(\\frac{x-1}{x}\\right) + f\\left(\\frac{1}{1-x}\\right) &= \\tan^{-1}\\left(\\frac{x-1}{x}\\right) \\\\\nf\\left(\\frac{1}{1-x}\\right) + f(x) &= \\tan^{-1}\\left(\\frac{1}{1-x}\\right).\n\\end{align*}\nAdding the first and third equations and subtracting the second gives:\n\\[\n2f(x) = \\tan^{-1}(x) + \\tan^{-1}\\left(\\frac{1}{1-x}\\right) - \\tan^{-1}\\left(\\frac{x-1}{x}\\right).\n\\]\nNow $\\tan^{-1}(t) + \\tan^{-1}(1/t)$ is equal to $\\pi/2$ if $t>0$ and $-\\pi/2$ if $t<0$; it follows that for $x \\in (0,1)$,\n\\begin{align*}\n2(f(x)+f(1-x)) &= \\left(\\tan^{-1}(x)+\\tan^{-1}(1/x)\\right)\\\\\n&\\,\\, + \\left(\\tan^{-1}(1-x)+\\tan^{-1}\\left(\\frac{1}{1-x}\\right)\\right) \\\\\n&\\,\\,- \n\\left(\\tan^{-1}\\left(\\frac{x-1}{x}\\right) + \\tan^{-1}\\left(\\frac{x}{x-1}\\right) \\right) \\\\\n&= \\frac{\\pi}{2} + \\frac{\\pi}{2} + \\frac{\\pi}{2} \\\\\n&= \\frac{3\\pi}{2}.\n\\end{align*}\nThus\n\\[\n4\\int_0^1 f(x)\\,dx = 2\\int_0^1 (f(x)+f(1-x))dx = \\frac{3\\pi}{2}\n\\]\nand finally $\\int_0^1 f(x)\\,dx = \\frac{3\\pi}{8}$.\n\n\\noindent\n\\textbf{Remark:}\nOnce one has the formula for $f(x)$, one can also (with some effort) directly evaluate the integral of each summand over $[0,1]$ to obtain the same result. A much cleaner variant of this approach (suggested on AoPS, user \\texttt{henrikjb}) is to write\n\\[\n\\tan^{-1}(x) = \\int_0^y \\frac{1}{1+y^2}\\,dy\n\\]\nand do a change of variable on the resulting double integral.", "source_problems": "PUTNAM-2016-problems.tex", "source_solutions": "PUTNAM-2016-solutions.tex", "notes": ""}
{"id": "PUTNAM-2016-A4", "contest": "PUTNAM", "year": "2016", "problem_number": "A4", "problem": "Consider a $(2m-1) \\times (2n-1)$ rectangular region, where $m$ and $n$ are integers such that $m, n \\geq 4$. This region is to be tiled using tiles of the two types shown:\n\\[\n\\setlength{\\unitlength}{4144sp}%\n%\n\\begingroup\\makeatletter\\ifx\\SetFigFont\\undefined%\n\\gdef\\SetFigFont#1#2#3#4#5{%\n  \\reset@font\\fontsize{#1}{#2pt}%\n  \\fontfamily{#3}\\fontseries{#4}\\fontshape{#5}%\n  \\selectfont}%\n\\fi\\endgroup%\n\\begin{picture}(2724,924)(1339,-1423)\n\\thinlines\n{\\put(1351,-511){\\line( 0,-1){900}}\n\\put(1351,-1411){\\line( 1, 0){450}}\n\\put(1801,-1411){\\line( 0, 1){450}}\n\\put(1801,-961){\\line( 1, 0){450}}\n\\put(2251,-961){\\line( 0, 1){450}}\n\\put(2251,-511){\\line(-1, 0){900}}\n}%\n{\\multiput(1351,-961)(128.57143,0.00000){4}{\\line( 1, 0){ 64.286}}\n\\multiput(1801,-961)(0.00000,128.57143){4}{\\line( 0, 1){ 64.286}}\n}%\n{\\put(2701,-961){\\line( 0,-1){450}}\n\\put(2701,-1411){\\line( 1, 0){900}}\n\\put(3601,-1411){\\line( 0, 1){450}}\n\\put(3601,-961){\\line( 1, 0){450}}\n\\put(4051,-961){\\line( 0, 1){450}}\n\\put(4051,-511){\\line(-1, 0){900}}\n\\put(3151,-511){\\line( 0,-1){450}}\n\\put(3151,-961){\\line(-1, 0){450}}\n}%\n{\\multiput(3151,-1411)(0.00000,128.57143){4}{\\line( 0, 1){ 64.286}}\n\\multiput(3151,-961)(128.57143,0.00000){4}{\\line( 1, 0){ 64.286}}\n\\multiput(3601,-961)(0.00000,128.57143){4}{\\line( 0, 1){ 64.286}}\n}%\n\\end{picture}%\n\\]\n(The dotted lines divide the tiles into $1 \\times 1$ squares.)\nThe tiles may be rotated and reflected, as long as their sides are parallel to the sides\nof the rectangular region. They must all fit within the region, and they must cover it completely without overlapping.\n\nWhat is the minimum number of tiles required to tile the region?", "solution": "The minimum number of tiles is $mn$. To see that this many are required, label the squares $(i,j)$ with $1\\leq i\\leq 2m-1$ and $1\\leq j\\leq 2n-1$, and for each square with $i,j$ both odd, color the square red; then no tile can cover more than one red square, and there are $mn$ red squares.\n\nIt remains to show that we can cover any $(2m-1) \\times (2n-1)$ rectangle with $mn$ tiles when $m,n \\geq 4$. First note that we can tile any $2 \\times (2k-1)$ rectangle with $k\\geq 3$ by $k$ tiles: one of the first type, then $k-2$ of the second type, and finally one of the first type. Thus if we can cover a $7\\times 7$ square with $16$ tiles, then we can do the general $(2m-1) \\times (2n-1)$ rectangle, by decomposing this rectangle into a $7\\times 7$ square in the lower left corner, along with $m-4$ $(2\\times 7)$ rectangles to the right of the square, and $n-4$ $((2m-1)\\times 2)$ rectangles above, and tiling each of these rectangles separately, for a total of $16+4(m-4)+m(n-4) = mn$ tiles.\n\nTo cover the $7 \\times 7$ square, note that the tiling must consist of 15 tiles of the first type and 1 of the second type, and that any $2 \\times 3$ rectangle can be covered using 2 tiles of the first type. We may thus construct a suitable covering by covering all but the center square with eight $2 \\times 3$ rectangles, in such a way that we can attach the center square to one of these rectangles to get a shape that can be covered by two tiles. An example of such a covering, with the remaining $2 \\times 3$ rectangles left intact for visual clarity, is depicted below. (Many other solutions are possible.)\n\\[\n\\setlength{\\unitlength}{4144sp}%\n%\n\\begingroup\\makeatletter\\ifx\\SetFigFont\\undefined%\n\\gdef\\SetFigFont#1#2#3#4#5{%\n  \\reset@font\\fontsize{#1}{#2pt}%\n  \\fontfamily{#3}\\fontseries{#4}\\fontshape{#5}%\n  \\selectfont}%\n\\fi\\endgroup%\n\\begin{picture}(3174,3174)(1339,-7723)\n\\thinlines\n{\\put(1351,-7711){\\framebox(3150,3150){}}\n}%\n{\\put(1351,-5911){\\line( 1, 0){945}}\n\\put(2296,-5911){\\line( 0, 1){1350}}\n}%\n{\\put(2296,-5911){\\line( 1, 0){405}}\n\\put(2701,-5911){\\line( 0,-1){1800}}\n}%\n{\\put(1351,-6811){\\line( 1, 0){1350}}\n}%\n{\\put(2701,-6361){\\line( 1, 0){1800}}\n}%\n{\\put(3601,-6361){\\line( 0,-1){1350}}\n}%\n{\\put(3151,-6361){\\line( 0, 1){1800}}\n}%\n{\\put(3151,-5461){\\line( 1, 0){1350}}\n}%\n{\\multiput(2296,-5011)(128.57143,0.00000){4}{\\line( 1, 0){ 64.286}}\n\\multiput(2746,-5011)(0.00000,-128.57143){4}{\\line( 0,-1){ 64.286}}\n\\multiput(2746,-5461)(115.71429,0.00000){4}{\\line( 1, 0){ 57.857}}\n}%\n\\end{picture}%\n\\]", "source_problems": "PUTNAM-2016-problems.tex", "source_solutions": "PUTNAM-2016-solutions.tex", "notes": ""}
{"id": "PUTNAM-2016-A5", "contest": "PUTNAM", "year": "2016", "problem_number": "A5", "problem": "Suppose that $G$ is a finite group generated by the two elements $g$ and $h$, where the order of $g$ is odd. Show that every element of $G$ can be written in the form\n\\[\ng^{m_1} h^{n_1} g^{m_2} h^{n_2} \\cdots g^{m_r} h^{n_r}\n\\]\nwith $1 \\leq r \\leq |G|$ and $m_1, n_1, m_2, n_2, \\ldots, m_r, n_r \\in \\{-1, 1\\}$. \n(Here $|G|$ is the number of elements of $G$.)\n\n\\,", "solution": "\\noindent\n\\textbf{First solution:}\nFor $s \\in G$ and $r$ a positive integer, define a \\emph{representation of $s$ of length $r$}\nto be a sequence of values $m_1, n_1, \\ldots, m_r, n_r \\in \\{-1, 1\\}$ for which\n\\[\ns = g^{m_1} h^{n_1} \\cdots g^{m_r} h^{n_r}.\n\\]\nWe first check that every $s \\in G$ admits at least one representation of some length; this is equivalent to saying that the set $S$ of $s \\in G$ which admit representations of some length\nis equal to $G$ itself. \nSince $S$ is closed under the group operation and $G$ is finite, $S$ is also closed under formation of inverses and contains the identity element; that is, $S$ is a subgroup of $G$.\nIn particular, $S$ contains not only $gh$ but also its inverse $h^{-1} g^{-1}$; since $S$ also contains $g^{-1} h$, we deduce that $S$ contains $g^{-2}$. \nSince $g$ is of odd order in $G$, $g^{-2}$ is also a generator of the cyclic subgroup containing $g$; it follows that $g \\in S$ and hence $h \\in S$. Since we assumed that $g,h$ generate $G$,\nwe now conclude that $S = G$, as claimed.\n\nTo complete the proof, we must now check that for each $s \\in G$, the smallest possible length of a representation of $s$ cannot exceed $|G|$. Suppose the contrary, and let\n\\[\ns = g^{m_1} h^{n_1} \\cdots g^{m_r} h^{n_r}\n\\]\nbe a representation of the smallest possible length. Set\n\\[\ns_i = g^{m_1} h^{n_1} \\cdots g^{m_i} h^{n_i} \\qquad (i=0,\\dots,r-1),\n\\]\ninterpreting $s_0$ as $e$; since $r>|G|$ by hypothesis, by the pigeonhole principle there must exist indices $0 \\leq i < j \\leq r-1$ such that $s_i = s_j$. Then\n\\[\ns = g^{m_1} h^{n_1} \\cdots g^{m_i} h^{n_i} g^{m_{j+1}} h^{n_{j+1}} \\cdots g^{m_r} h^{n_r} \n\\]\nis another representation of $s$ of length strictly less than $r$, a contradiction.\n\n\\noindent\n\\textbf{Remark:}\nIf one considers $s_1,\\dots,s_r$ instead of $s_0,\\dots,s_{r-1}$, then the case $s=e$ must be handled separately: otherwise, one might end up with a representation of length 0 which is disallowed by the problem statement.\n\n\\noindent\n\\textbf{Reinterpretation:} \nNote that the elements $gh, gh^{-1}, g^{-1} h, g^{-1} h^{-1}$ generate $gh(g^{-1}h)^{-1} = g^2$ and hence all of $G$ (again using the hypothesis that $g$ has odd order, as above). Form the Cayley digraph on the set $G$, i.e., the directed graph with an edge from $s_1$ to $s_2$ whenever $s_2 = s_1 *$ for $* \\in \\{gh, gh^{-1}, g^{-1} h, g^{-1} h^{-1}\\}$. Since $G$ is finite, this digraph is strongly connected: there exists at least one path from any vertex to any other vertex (traveling all edges in the correct direction). The shortest such path cannot repeat any vertices (except the starting and ending vertices in case they coincide), and so has length at most $|G|$.\n\n\\noindent\n\\textbf{Second solution:}\nFor $r$ a positive integer, let $S_r$ be the set of $s \\in G$ which admit a representation of length at most $r$ (terminology as in the first solution); obviously $S_r \\subseteq S_{r+1}$.\nWe will show that $S_r \\neq S_{r+1}$ unless $S_r = G$; this will imply by induction on $r$ that $\\#S_r \\geq \\min\\{r, |G|\\}$ and hence that $S_r = G$ for some $r \\leq |G|$.\n\nSuppose that $S_r = S_{r+1}$.\nThen the map $s \\mapsto sgh$ defines an injective map $S_r \\to S_{r+1} = S_r$,\nso $S_r$ is closed under right multiplication by $gh$. By the same token, $S_r$ is closed under right multiplication by each of $gh^{-1}, g^{-1}h, g^{-1}h^{-1}$.\nSince $gh, gh^{-1}, g^{-1}h, g^{-1}h^{-1}$ generate $G$ as in the first solution, it follows that $S_r = G$ as claimed.\n\n\\noindent\n\\textbf{Remark:} The condition on the order of $g$ is needed to rule out the case where $G$ admits a (necessarily normal) subgroup $H$ of index 2 not containing either $g$ or $h$; in this case, all products of the indicated form belong to $H$.\nOn the other hand, if one assumes that both $g$ and $h$ have odd order, then one can say a bit more: there exists some positive integer $r$ with $1 \\leq r \\leq |G|$ such that every element of $G$ has a representation of length exactly $r$. (Namely, the set of such elements for a given $r$ strictly increases in size until it is stable under right multiplication by both\n$gh(g^{-1}h)^{-1} = g^2$ and $gh(gh^{-1})^{-1} = gh^2g^{-1}$, but under the present hypotheses these generate $G$.)", "source_problems": "PUTNAM-2016-problems.tex", "source_solutions": "PUTNAM-2016-solutions.tex", "notes": ""}
{"id": "PUTNAM-2016-A6", "contest": "PUTNAM", "year": "2016", "problem_number": "A6", "problem": "Find the smallest constant $C$ such that for every real polynomial $P(x)$ of degree 3 that has a root in the interval $[0,1]$,\n\\[\n\\int_0^1 \\left| P(x) \\right|\\,dx \\leq C \\max_{x \\in [0,1]} \\left| P(x) \\right|.\n\\]", "solution": "We prove that the smallest such value of $C$ is $5/6$.\n\n\\noindent\n\\textbf{First solution:}\n(based on a suggestion of Daniel Kane)\n\nWe first reduce to the case where $P$ is nonnegative in $[0,1]$ and $P(0) = 0$.\nTo achieve this reduction, suppose that a given value $C$ obeys the inequality for such $P$.\nFor $P$ general,\ndivide the interval $[0,1]$ into subintervals $I_1,\\dots,I_k$ at the roots of $P$.\nWrite $\\ell(I_i)$ for the length of the interval $I_i$; since each interval is bounded by a root of $P$, we may make a linear change of variable to see that\n\\[\n\\int_{I_i} |P(x)|\\,dx \\leq C \\ell(I_i) \\max_{x \\in I_i} |P(x)| \\quad (i=1,\\dots,k).\n\\]\nSumming over $i$ yields the desired inequality.\n\nSuppose now that $P$ takes nonnegative values on $[0,1]$, $P(0) = 0$, and $\\max_{x \\in [0,1]} P(x) = 1$. Write $P(x) = ax^3 + bx^2 + cx$ for some $a,b,c \\in \\RR$; then\n\\begin{align*}\n\\int_0^1 P(x)\\,dx &= \\frac{1}{4} a + \\frac{1}{3} b + \\frac{1}{2} c \\\\\n&= \\frac{2}{3} \\left( \\frac{1}{8} a + \\frac{1}{4} b + \\frac{1}{2} c \\right)\n+ \\frac{1}{6} (a+b+c) \\\\\n&= \\frac{2}{3} P\\left( \\frac{1}{2} \\right) + \\frac{1}{6} P(1) \\\\\n&\\leq \\frac{2}{3} + \\frac{1}{6} = \\frac{5}{6}.\n\\end{align*}\nConsequently, the originally claimed inequality holds with $C = 5/6$. To prove that this value is best possible, it suffices to exhibit a polynomial $P$ as above with $\\int_0^1 P(x)\\,dx = 5/6$; we will verify that\n\\[\nP(x) = 4x^3 - 8x^2 + 5x\n\\]\nhas this property. It is apparent that $\\int_0^1 P(x)\\, dx =5/6$.\nSince $P'(x) = (2x-1)(6x-5)$ and \n\\[\nP(0) = 0, \\,P\\left( \\frac{1}{2} \\right) = 1, \\,\nP\\left( \\frac{5}{6} \\right) = \\frac{25}{27}, P(1) = 1,\n\\]\nit follows that $P$ increases from 0 at $x=0$ to 1 at $x=1/2$, then decreases to a positive value at $x=5/6$, then increases to 1 at $x=1$. Hence $P$ has the desired form.\n\n\\noindent\n\\textbf{Remark:}\nHere is some conceptual motivation for the preceding solution.\nLet $V$ be the set of polynomials of degree at most 3 vanishing at 0, viewed as a three-dimensional vector space over $\\RR$.\nLet $S$ be the subset of $V$ consisting of those polynomials $P(x)$ for which\n$0 \\leq P(x) \\leq 1$ for all $x \\in [0,1]$; this set is convex and compact. We may then compute the minimal $C$ as the maximum value of $\\int_0^1 P(x)\\,dx$ over all $P \\in S$, provided that the maximum is achieved for some polynomial of degree exactly 3. (Note that any extremal polynomial must satisfy\n$\\max_{x \\in [0,1]} P(x) = 1$, as otherwise we could multiply it by some constant $c>1$ so as to increase $\\int_0^1 P(x)\\,dx$.)\n\nLet $f: V \\to \\RR$ be the function taking $P(x)$ to $\\int_0^1 P(x)\\,dx$. This function is linear, so we can characterize its extrema on $S$ easily: there exist exactly two level surfaces for $f$ which are supporting planes for $S$, and the intersections of these two planes\nwith $S$ are the minima and the maxima. It is obvious that the unique minimum is achieved by the zero polynomial, so this accounts for one of the planes.\n\nIt thus suffices to exhibit a single polynomial $P(x) \\in S$ such that the level plane of $f$ through $P$ is a supporting plane for $S$. \nThe calculation made in the solution amounts to verifying that\n\\[\nP(x) = 4x^3 - 8x^2 + 5x\n\\]\nhas this property, by interpolating between the constraints $P(1/2) \\leq 1$ and $P(1) \\leq 1$.\n\nThis still leaves the matter of correctly guessing the optimal polynomial. If one supposes that it should be extremized both at $x=1$ and at an interval value of the disc, it is forced to have the form $P(x) = 1 + (x-1)(cx-1)^2$ for some $c>0$; the interpolation property then pins down $c$ uniquely.\n\n\\noindent\n\\textbf{Second solution:}\n(by James Merryfield, via AoPS)\nAs in the first solution, we may assume that $P$ is nonnegative on $[0,1]$ and $P(0)= 0$.\nSince $P$ has degree at most 3, Simpson's rule for approximating $\\int_0^1 P(x)\\,dx$ is an exact formula:\n\\[\n\\int_0^1 P(x)\\,dx = \\frac{1}{6}( P(0) + 4 P\\left( \\frac{1}{2} \\right) + P(1)).\n\\]\nThis immediately yields the claimed inequality for $C = 5/6$. Again as in the first solution,\nwe obtain an example showing that this value is best possible.", "source_problems": "PUTNAM-2016-problems.tex", "source_solutions": "PUTNAM-2016-solutions.tex", "notes": ""}
{"id": "PUTNAM-2016-B1", "contest": "PUTNAM", "year": "2016", "problem_number": "B1", "problem": "Let $x_0,x_1,x_2,\\dots$ be the sequence such that $x_0=1$ and for $n \\geq 0$,\n\\[\nx_{n+1} = \\ln(e^{x_n} - x_n)\n\\]\n(as usual, the function $\\ln$ is the natural logarithm). Show that the infinite series\n\\[\nx_0 + x_1 + x_2 + \\cdots\n\\]\nconverges and find its sum.", "solution": "Note that the function $e^x - x$ is strictly increasing for $x>0$ (because its derivative is $e^x - 1$, which is positive because $e^x$ is strictly increasing), and its value at 0 is 1.\nBy induction on $n$, we see that $x_n > 0$ for all $n$.\n\nBy exponentiating the equation defining $x_{n+1}$, we obtain the expression\n\\[\nx_n = e^{x_n} - e^{x_{n+1}}.\n\\]\nWe use this equation repeatedly to acquire increasingly precise information about the sequence $\\{x_n\\}$.\n\\begin{itemize}\n\\item\nSince $x_n > 0$, we have $e^{x_n} > e^{x_{n+1}}$, so $x_n > x_{n+1}$.\n\\item\nSince the sequence $\\{x_n\\}$ is decreasing and bounded below by 0, it converges to some limit $L$.\n\\item\nTaking limits in the equation yields $L = e^L - e^L$, whence $L = 0$.\n\\item\nSince $L = 0$, the sequence $\\{e^{x_n}\\}$ converges to 1.\n\\end{itemize}\n\nWe now have a telescoping sum:\n\\begin{align*}\nx_0 + \\cdots + x_n &= (e^{x_0} - e^{x_1}) + \\cdots + (e^{x_n} - e^{x_{n+1}}) \\\\\n&=e^{x_0} - e^{x_{n+1}} = e - e^{x_{n+1}}.\n\\end{align*}\nBy taking limits, we see that the sum $x_0 + x_1 + \\cdots$ converges to the value\n$e-1$.", "source_problems": "PUTNAM-2016-problems.tex", "source_solutions": "PUTNAM-2016-solutions.tex", "notes": ""}
{"id": "PUTNAM-2016-B2", "contest": "PUTNAM", "year": "2016", "problem_number": "B2", "problem": "Define a positive integer $n$ to be \\emph{squarish} if either $n$ is itself a perfect square or the distance from $n$ to the nearest perfect square is a perfect square. For example, 2016 is squarish, because the nearest perfect square to 2016 is $45^2 = 2025$ and $2025-2016=9$ is a perfect square. (Of the positive integers between 1 and 10, only 6 and 7 are not squarish.)\n\nFor a positive integer $N$, let $S(N)$ be the number of squarish integers between 1 and $N$,\ninclusive. Find positive constants $\\alpha$ and $\\beta$ such that\n\\[\n\\lim_{N \\to \\infty} \\frac{S(N)}{N^\\alpha} = \\beta,\n\\]\nor show that no such constants exist.", "solution": "We prove that the limit exists for $\\alpha = \\frac{3}{4}$, $\\beta =\\frac{4}{3}$. \n\nFor any given positive integer $n$, the integers which are closer to $n^2$ than to any other perfect square are the ones in the interval $[n^2 - n - 1, n^2 + n]$. The number of squarish numbers in this interval is $1 + \\lfloor \\sqrt{n-1} \\rfloor + \\lfloor \\sqrt{n} \\rfloor$.\nRoughly speaking, this means that \n\\[\nS(N) \\sim \\int_0^{\\sqrt{N}} 2 \\sqrt{x} \\,dx = \\frac{4}{3} N^{3/4}.\n\\]\nTo make this precise, we use the bounds $x-1 \\leq \\lfloor x \\rfloor \\leq x$,\nand the upper and lower Riemann sum estimates for the integral of $\\sqrt{x}$,\nto derive upper and lower bounds on $S(N)$:\n\\begin{align*}\nS(N) &\\geq \\sum_{n=1}^{\\lfloor \\sqrt{N} \\rfloor - 1} \n(2 \\sqrt{n-1}-1) \\\\\n&\\geq \\int_0^{\\lfloor \\sqrt{N} \\rfloor - 2} 2\\sqrt{x} \\,dx - \\sqrt{N} \\\\\n&\\geq \\frac{4}{3} (\\sqrt{N} - 3)^{3/2} - \\sqrt{N}\n\\end{align*}\n\n\\begin{align*}\nS(N) &\\leq \\sum_{n=1}^{\\lceil \\sqrt{N} \\rceil} (2 \\sqrt{n} + 1) \\\\\n&\\leq \\int_0^{\\lceil \\sqrt{N}\\rceil + 1} 2 \\sqrt{x}\\,dx  + \\sqrt{N} + 1\\\\\n&\\leq \\frac{4}{3} (\\sqrt{N} + 2)^{3/2} + \\sqrt{N} + 1.\n\\end{align*}\n\n\\noindent\n\\textbf{Remark:}\nJohn Rickert points out that when $N = n^4$, one can turn the previous estimates into exact calculations to obtain the formula\n\\[\nS(N) = \\frac{4}{3}\\left( n^3 + \\frac{n}{2} \\right) = \\frac{4}{3} N^{3/4} + \\frac{2}{3} N^{1/4}.\n\\]\nFor general $N$, one can then use the estimates\n\\begin{align*}\n\\frac{4}{3} (N-1)^{3/4} + \\frac{2}{3} (N-1)^{1/4}\n&\\leq\nS(\\lfloor N^{1/4} \\rfloor^4) \\\\\n&\\leq S(N) \\\\\n&\\leq S(\\lceil N^{1/4} \\rceil^4) \\\\\n&\\leq \\frac{4}{3} (N+1)^{3/4} + \\frac{2}{3} (N+1)^{1/4}\n\\end{align*}\nto obtain the desired limit.", "source_problems": "PUTNAM-2016-problems.tex", "source_solutions": "PUTNAM-2016-solutions.tex", "notes": ""}
{"id": "PUTNAM-2016-B3", "contest": "PUTNAM", "year": "2016", "problem_number": "B3", "problem": "Suppose that $S$ is a finite set of points in the plane such that the area of triangle\n$\\triangle ABC$ is at most 1 whenever $A$, $B$, and $C$ are in $S$. Show that there exists a triangle of area 4 that (together with its interior) covers the set $S$.", "solution": "Since $S$ is finite, we can choose three points $A,B,C$ in $S$ so as to maximize the area of the triangle $ABC$. Let $A', B', C'$ be the points in the plane such that $A,B,C$ are the midpoints of the segments $B'C', C'A', A'B'$; the triangle $A'B'C'$ is similar to $ABC$ with sides twice as long, so its area is 4 times that of $ABC$ and hence no greater than 4.\n\nWe claim that this triangle has the desired effect; that is, every point $P$ of $S$ is contained within the triangle $A'B'C'$. \n(To be precise, the problem statement requires a triangle of area exactly 4, which need not be the case for $A'B'C'$, but this is trivially resolved by scaling up by a homothety.)\nTo see this, note that since the area of the triangle $PBC$ is no more than that of $ABC$, $P$ must lie in the half-plane bounded by $B'C'$ containing $B$ and $C$. Similarly, $P$ must lie in the half-plane bounded by $C'A'$ containing\n$C$ and $A$, and the half-plane bounded by $A'B'$ containing $A$ and $B$. These three half-planes intersect precisely in the region bounded by the triangle $A'B'C'$, proving the claim.", "source_problems": "PUTNAM-2016-problems.tex", "source_solutions": "PUTNAM-2016-solutions.tex", "notes": ""}
{"id": "PUTNAM-2016-B4", "contest": "PUTNAM", "year": "2016", "problem_number": "B4", "problem": "Let $A$ be a $2n \\times 2n$ matrix, with entries chosen independently at random. Every entry is chosen to be 0 or 1, each with probability $1/2$. Find the expected value of $\\det(A-A^t)$ (as a function of $n$), where $A^t$ is the transpose of $A$.", "solution": "The expected value equals\n\\[\n\\frac{(2n)!}{4^n n!}.\n\\]\n\\noindent\n\\textbf{First solution:}\n\nWrite the determinant of $A-A^t$ as the sum over permutations $\\sigma$ of $\\{1,\\dots,2n\\}$ of the product\n\\[\n\\sgn(\\sigma)\n\\prod_{i=1}^{2n}\n(A-A^t)_{i \\sigma(i)} \n=\n\\sgn(\\sigma) \\prod_{i=1}^{2n} (A_{i \\sigma(i)} - A_{\\sigma(i) i});\n\\]\nthen the expected value of the determinant is the sum over $\\sigma$ of the expected value of this product, which we denote by $E_\\sigma$. \n\nNote that if we partition $\\{1,\\dots,2n\\}$ into orbits for the action of $\\sigma$, then partition the factors of the product accordingly, then no entry of $A$ appears in more than one of these factors; consequently, these factors are independent random variables. This means that we can compute $E_\\sigma$ as the product of the expected values of the individual factors.\n\nIt is obvious that any orbit of size 1 gives rise to the zero product, and hence the expected value of the corresponding factor is zero. For an orbit of size $m \\geq 3$, the corresponding factor contains $2m$ distinct matrix entries, so again we may compute the expected value of the factor as the product of the expected values of the individual terms $A_{i \\sigma(i)} - A_{\\sigma(i) i}$. However, the distribution of this term is symmetric about 0, so its expected value is 0.\n\nWe conclude that $E_\\sigma = 0$ unless $\\sigma$ acts with $n$ orbits of size 2. To compute $E_\\sigma$ in this case, assume without loss of generality that the orbits of $\\sigma$ are\n$\\{1,2\\}, \\dots, \\{2n-1,2n\\}$; note that $\\sgn(\\sigma) = (-1)^n$. Then $E_\\sigma$ is the expected value of\n$\\prod_{i=1}^n -(A_{(2i-1)2i} - A_{2i(2i-1)})^2$, which is $(-1)^n$ times the $n$-th power\nof the expected value of $(A_{12} - A_{21})^2$. Since $A_{12} - A_{21}$ takes the values $-1, 0, 1$ with probabilities $\\frac{1}{4}, \\frac{1}{2}, \\frac{1}{4}$, its square takes the values\n$0,1$ with probabilities $\\frac{1}{2}, \\frac{1}{2}$; we conclude that\n\\[\nE_\\sigma = 2^{-n}.\n\\]\nThe permutations $\\sigma$ of this form correspond to unordered partitions of $\\{1,\\dots,2n\\}$ into $n$ sets of size 2, so there are\n\\[\n\\frac{(2n)!}{n!(2!)^n}\n\\]\nsuch permutations. Putting this all together yields the claimed result.\n\n\\noindent\n\\textbf{Second solution:}\n(by Manjul Bhargava)\nNote that the matrix $A-A^t$ is skew-symmetric: \n\\[\n(A-A^t)^t = A^t-A = -(A-A^t).\n\\]\nThe determinant of a $2n \\times 2n$ skew-symmetric matrix $M$ is the square of the {\\it Pfaffian} of $M$, which is a polynomial of degree $n$ in the entries of $M$ defined as follows. Define a {\\it perfect matching} of $\\{1,\\ldots,2n\\}$ to be a permutation of $\\{1,\\ldots,2n\\}$ that is the product of $n$ disjoint transpositions. Then the Pfaffian of $M$ is given by\n\\begin{equation}\\label{pfaffeq}\n\\sum_{\\alpha} \\sgn(\\alpha) M_{i_1,j_1}\\cdots M_{i_n,j_n}\n\\end{equation}\nwhere the sum is over perfect matchings $\\alpha=(i_1,j_1)\\cdots(i_n,j_n)$,\nand $\\sgn(\\alpha)$ denotes the sign of the permutation\n$\\left(\\begin{smallmatrix}\n1&2&3&4&\\cdots & (2n-1)&2n \\\\\ni_1&j_1&i_2&j_2& \\cdots & i_n & j_n\n\\end{smallmatrix} \\right)$.\nThe determinant of $M$ is then the square of \\eqref{pfaffeq}, i.e.,\n\\begin{equation}\\label{deteq} \\det(M)=\\sum_{\\alpha,\\beta} \\sgn(\\alpha)\\sgn(\\beta) M_{i_1,j_1}\\cdots M_{i_n,j_n}M_{i'_1,j'_1}\\cdots M_{i'_n,j'_n}\n\\end{equation}\nwhere the sum is now over ordered pairs $$(\\alpha=(i_1,j_1)\\cdots(i_n,j_n),\\beta=(i'_1,j'_1)\\cdots(i'_n,j'_n))$$ of perfect matchings.\n\nTaking $M = A - A^t$, so that $M_{ij} = A_{ij} - A_{ji}$,\nwe wish to find the expected value of \\eqref{deteq}; again, this is the sum of the expected values of each summand in \\eqref{deteq}. Note that each $M_{ij}$ with $i < j$ is an independent random variable taking the values $-1,0,1$ with probabilities $\\frac14,\\frac12,\\frac14$, respectively.\n\nConsider first a summand in \\eqref{deteq} with $\\alpha\\neq \\beta$. Then some factor $M_{ij}$  occurs with exponent 1; since the distribution of $M_{ij}$ is symmetric about 0, any such summand has expected value 0.\n\nConsider next a summand in \\eqref{deteq} with $\\alpha= \\beta$. This summand is a product of distinct factors of the form $M_{ij}^2$; from the distributions of the $M_{ij}$, we see that the expected value of each of these terms is $1/2^n$.\n\nSince the total number of perfect matchings $\\alpha$ is $(2n)!/(2^nn!)$, the expected value of $(\\ref{deteq})$ is therefore $(2n)!/(2^nn!)\\cdot 1/2^n=(2n)!/(4^nn!)$, as desired.", "source_problems": "PUTNAM-2016-problems.tex", "source_solutions": "PUTNAM-2016-solutions.tex", "notes": ""}
{"id": "PUTNAM-2016-B5", "contest": "PUTNAM", "year": "2016", "problem_number": "B5", "problem": "Find all functions $f$ from the interval $(1, \\infty)$ to $(1, \\infty)$ with the following property:\nif $x,y \\in (1, \\infty)$ and $x^2 \\leq y \\leq x^3$, then $(f(x))^2 \\leq f(y) \\leq (f(x))^3$.", "solution": "It is obvious that for any $c>0$, the function $f(x) = x^c$ has the desired property; we will prove that conversely, any function with the desired property has this form for some $c$.\n\nDefine the function $g: (0, \\infty) \\to (0, \\infty)$ given by\n$g(x) = \\log f(e^x)$; this function has the property that if $x,y \\in (0, \\infty)$\nand $2x \\leq y \\leq 3x$, then $2g(x) \\leq g(y) \\leq 3g(x)$. \nIt will suffice to show that there exists $c>0$ such that $g(x) = cx$ for all $x >0$.\n\nSimilarly, define the function $h: \\RR \\to \\RR$ given by\n$h(x) = \\log g(e^x)$; this function has the property that if $x,y \\in \\RR$\nand $x + \\log 2 \\leq y \\leq x + \\log 3$, then $h(x) + \\log 2 \\leq h(y) \\leq h(x) + \\log 3$. \nIt will suffice to show that there exists $c>0$ such that $h(x) = x + c$ for all $x \\in \\RR$\n(as then $h(x) = e^c x$ for all $x>0$).\n\nBy interchanging the roles of $x$ and $y$, we may restate the condition on $h$ as follows:\nif $x - \\log 3 \\leq y \\leq x - \\log 2$, then $h(x) - \\log 3 \\leq h(y) \\leq h(x) - \\log 2$. \nThis gives us the cases $a+b=0,1$ of the following statement, which we will establish in full by induction on $a+b$: for any nonnegative integers $a,b$, for all $x,y \\in \\RR$ such that\n\\[\nx + a \\log 2 - b \\log 3 \\leq y \\leq x + a \\log 3 - b \\log 2,\n\\]\nwe have\n\\[\nh(x) + a \\log 2 - b \\log 3 \\leq h(y) \\leq h(x) + a \\log 3 - b \\log 2.\n\\]\nTo this end, suppose that $a+b>0$ and that the claim is known for all smaller values of $a+b$. In particular, either $a>0$ or $b>0$; the two cases are similar, so we treat only the first one. Define the function\n\\[\nj(t) = \\frac{(a+b-1)t - b(\\log 2 + \\log 3)}{a+b},\n\\]\nso that\n\\begin{gather*}\nj(a \\log 2 - b \\log 3) = (a-1) \\log 2 - b \\log 3, \\\\\nj(a \\log 3 - b \\log 2) = (a-1) \\log 3 - b \\log 2.\n\\end{gather*}\nFor $t \\in [a \\log 2 - b \\log 3, a \\log 3 - b \\log 2]$ and $y = x+t$,\nwe have $\\log 2 \\leq t-j(t) \\leq \\log 3$ and hence\n\\begin{gather*}\n(a-1) \\log 2 - b \\log 3 \\leq h(x+j(t)) - h(x) \\leq (a-1) \\log 3 - b \\log 2 \\\\\n\\log 2 \\leq h(y)-h(x+j(t)) \\leq \\log 3; \n\\end{gather*}\nthis completes the induction.\n\nNow fix two values $x,y \\in \\RR$ with $x \\leq y$. Since $\\log 2$ and $\\log 3$ are linearly independent over $\\QQ$, the fractional parts of the nonnegative integer multiples of $\\log 3/\\log 2$ are dense in $[0,1)$. (This result is due to Kronecker; a stronger result of Weyl shows that the fractional parts are uniformly distributed in $[0,1)$.)\nIn particular, for any $\\epsilon > 0$ and any $N > 0$, we can find integers $a,b > N$ such that\n\\[\ny-x < a \\log 3 - b \\log 2 < y-x + \\epsilon.\n\\]\nBy writing\n\\begin{align*}\na \\log 2 - b \\log 3& = \\frac{\\log 2}{\\log 3}(a \\log 3 - b \\log 2) \\\\\n&\\,\\,- b \\frac{(\\log 3)^2 - (\\log 2)^2}{\\log 3},\n\\end{align*}\nwe see that this quantity tends to $-\\infty$ as $N \\to \\infty$; in particular, for $N$ sufficiently large we have that $a \\log 2 - b \\log 3 < y-x$. We thus have\n$h(y) \\leq h(x) + a \\log 2 - b \\log 3 < y-x + \\epsilon$; since $\\epsilon>0$ was chosen arbitrarily, we deduce that $h(y)-h(x) \\leq y-x$. A similar argument shows that $h(y)-h(x) \\geq y-x$; we deduce that $h(y) - h(x) = y-x$, or equivalently $h(y)-y = h(x) - x$. In other words, the function $x \\mapsto h(x) - x$ is constant, as desired.", "source_problems": "PUTNAM-2016-problems.tex", "source_solutions": "PUTNAM-2016-solutions.tex", "notes": ""}
{"id": "PUTNAM-2016-B6", "contest": "PUTNAM", "year": "2016", "problem_number": "B6", "problem": "Evaluate\n\\[\n\\sum_{k=1}^\\infty \\frac{(-1)^{k-1}}{k} \\sum_{n=0}^\\infty \\frac{1}{k2^n + 1}.\n\\]\n\\end{itemize}\n\n\\end{document}", "solution": "Let $S$ denote the desired sum. We will prove that $S=1$.\n\n\\noindent\n\\textbf{First solution:}\nWrite\n\\[\n\\sum_{n=0}^\\infty \\frac{1}{k2^n+1} = \\frac{1}{k+1} + \\sum_{n=1}^\\infty \\frac{1}{k2^n+1}; \n\\]\nthen we may write $S = S_1+S_2$ where \n\\begin{align*} \nS_1 &= \\sum_{k=1}^\\infty \\frac{(-1)^{k-1}}{k(k+1)} \\\\\nS_2 &= \\sum_{k=1}^\\infty \\frac{(-1)^{k-1}}{k} \\sum_{n=1}^\\infty \\frac{1}{k2^n+1}.\n\\end{align*}\nThe rearrangement is valid because both $S_1$ and $S_2$ converge absolutely in $k$, by comparison to $\\sum 1/k^2$.\n\nTo compute $S_1$, note that \n\\begin{align*}\n\\sum_{k=1}^N \\frac{(-1)^{k-1}}{k(k+1)} &= \\sum_{k=1}^N  (-1)^{k-1}\\left(\\frac{1}{k}-\\frac{1}{k+1} \\right) \\\\\n&= -1+\\frac{(-1)^N}{N+1}+2\\sum_{k=1}^N \\frac{(-1)^{k-1}}{k}\n\\end{align*}\nconverges to $2\\ln 2-1$ as $N\\to\\infty$, and so $S_1 = 2\\ln 2-1$.\n\nTo compute $S_2$, write $\\frac{1}{k2^n+1} = \\frac{1}{k2^n}\\cdot \\frac{1}{1+1/(k2^n)}$ as the geometric series $\\sum_{m=0}^\\infty \\frac{(-1)^m}{k^{m+1} 2^{mn+n}}$, whence\n\\[\nS_2 = \\sum_{k=1}^\\infty \\sum_{n=1}^\\infty \\sum_{m=0}^\\infty \\frac{(-1)^{k+m-1}}{k^{m+2} 2^{mn+n}}.\n\\]\n(This step requires $n \\geq 1$, as otherwise the geometric series would not converge for $k=0$.)\nNow note that this triple sum converges absolutely: we have\n\\begin{align*}\n\\sum_{m=0}^\\infty \\frac{1}{k^{m+2} 2^{mn+n}} &= \n\\frac{1}{k^2 2^n} \\cdot \\frac{1}{1-\\frac{1}{k 2^n}} \\\\\n&= \\frac{1}{k(k2^n-1)} \\leq \\frac{1}{k^2 2^{n-1}}\n\\end{align*}\nand so\n\\begin{align*}\n\\sum_{k=1}^\\infty \\sum_{n=1}^\\infty \\sum_{m=0}^\\infty \\frac{1}{k^{m+2} 2^{mn+n}} &\\leq\n\\sum_{k=1}^\\infty \\sum_{n=1}^\\infty  \\frac{1}{k^2 2^{n-1}}\\\\\n &= \\sum_{k=1}^\\infty \\frac{2}{k^2} < \\infty.\n \\end{align*}\n\nThus we can rearrange the sum to get\n\\[\nS_2 = \\sum_{m=0}^\\infty (-1)^m \\left( \\sum_{n=1}^\\infty \\frac{1}{2^{mn+n}}\\right) \\left(\\sum_{k=1}^\\infty \n\\frac{(-1)^{k-1}}{k^{m+2}} \\right).\n\\]\nThe sum in $n$ is the geometric series \n\\[\n\\frac{1}{2^{m+1}(1-\\frac{1}{2^{m+1}})} = \\frac{1}{2^{m+1}-1}.\n\\]\nIf we write the sum in $k$ as $S_3$, then note that\n\\[\n\\sum_{k=1}^\\infty \\frac{1}{k^{m+2}} = S_3 + 2 \\sum_{k=1}^\\infty \\frac{1}{(2k)^{m+2}}\n= S_3 + \\frac{1}{2^{m+1}} \\sum_{k=1}^\\infty \\frac{1}{k^{m+2}}\n\\]\n(where we can rearrange terms in the first equality because all of the series converge absolutely), and so \n\\[\nS_3 = \\left(1-\\frac{1}{2^{m+1}}\\right)  \\sum_{k=1}^\\infty \\frac{1}{k^{m+2}}.\n\\]\nIt follows that\n\\begin{align*}\nS_2 &= \\sum_{m=0}^\\infty \\frac{(-1)^m}{2^{m+1}} \\sum_{k=1}^\\infty \\frac{1}{k^{m+2}} \\\\\n&= \\sum_{k=1}^\\infty \\frac{1}{2k^2} \\sum_{m=0}^\\infty \\left(-\\frac{1}{2k}\\right)^m \\\\\n&= \\sum_{k=1}^\\infty \\frac{1}{k(2k+1)} \\\\\n&= 2 \\sum_{k=1}^\\infty \\left( \\frac{1}{2k} - \\frac{1}{2k+1} \\right) = 2(1-\\ln 2).\n\\end{align*}\nFinally, we have $S = S_1 + S_2 = 1$.\n\n\\noindent\n\\textbf{Second solution:}\n(by Tewodros Amdeberhan)\nSince $\\int_0^1 x^t\\,dx = \\frac{1}{1+t}$ for any $t \\geq 1$, we also have\n\\[\nS = \\sum_{k=1}^\\infty  \\sum_{n=0}^\\infty \\frac{(-1)^{k-1}}{k} \\int_0^1 x^{k2^n}\\,dx.\n\\]\nAgain by absolute convergence, we are free to permute the integral and the sums:\n\\begin{align*}\nS &= \\int_0^1 dx\\, \\sum_{n=0}^\\infty \\sum_{k=1}^\\infty \\frac{(-1)^{k-1}}{k} x^{k2^n} \\\\\n&= \\int_0^1 dx\\, \\sum_{n=0}^\\infty \\log (1 + x^{2^n}).\n\\end{align*}\nDue to the uniqueness of binary expansions of nonnegative integers, we have the identity\nof formal power series\n\\[\n\\frac{1}{1 - x} = \\prod_{n=0}^\\infty (1 + x^{2^n});\n\\]\nthe product converges absolutely for $0 \\leq x < 1$. We thus have\n\\begin{align*}\nS &= -\\int_0^1 \\log (1-x)\\,dx \\\\\n&= \\left((1-x) \\log (1-x) - (1-x)\\right)_0^1 \\\\\n&= 1.\n\\end{align*}\n\n\\noindent\n\\textbf{Third solution:}\n(by Serin Hong)\nAgain using absolute convergence, we may write\n\\[\nS = \\sum_{m=2}^\\infty \\frac{1}{m} \\sum_{k} \\frac{(-1)^{k-1}}{k}\n\\]\nwhere $k$ runs over all positive integers for which $m = k2^n+1$ for some $n$.\nIf we write $e$ for the 2-adic valuation of $m-1$ and $j = (m-1)2^{-e}$ for the odd part of $m-1$, then the values of $k$ are $j 2^i$ for $i=0,\\dots,e$. The inner sum can thus be evaluated as\n\\[\n\\frac{1}{j} - \\sum_{i=1}^e \\frac{1}{2^i j}\n= \\frac{1}{2^e j} = \\frac{1}{m-1}.\n\\]\nWe thus have\n\\[\nS = \\sum_{m=2}^\\infty \\frac{1}{m(m-1)} \\\\\n= \\sum_{m=2}^\\infty \\left( \\frac{1}{m-1} - \\frac{1}{m} \\right) \\\\\n= 1.\n\\]\n\n\\noindent\n\\textbf{Fourth solution:}\n(by Liang Xiao)\nLet $S_0$ and $S_1$ be the sums $\\sum_k \\frac{1}{k} \\sum_{n=0}^\\infty \\frac{1}{k2^n+1}$\nwith $k$ running over all odd and all even positive integers, respectively, so that \n\\[\nS = S_0 - S_1.\n\\]\nIn $S_1$, we may write $k = 2\\ell$ to obtain\n\\begin{align*}\nS_1 &= \\sum_{\\ell=1}^\\infty \\frac{1}{2\\ell} \\sum_{n=0}^\\infty \\frac{1}{\\ell 2^{n+1} + 1} \\\\\n&= \\frac{1}{2} (S_0 + S_1) - \\sum_{\\ell=1}^\\infty \\frac{1}{2\\ell(\\ell+1)} \\\\\n&= \\frac{1}{2} (S_0 + S_1) - \\frac{1}{2}\n\\end{align*}\nbecause the last sum telescopes; this immediately yields $S = 1$.\n\n\\end{itemize}\n\\end{document}", "source_problems": "PUTNAM-2016-problems.tex", "source_solutions": "PUTNAM-2016-solutions.tex", "notes": ""}
{"id": "PUTNAM-2017-A1", "contest": "PUTNAM", "year": "2017", "problem_number": "A1", "problem": "Let $S$ be the smallest set of positive integers such that\n\\begin{enumerate}\n\\item[(a)]\n$2$ is in $S$,\n\\item[(b)]\n$n$ is in $S$ whenever $n^2$ is in $S$, and\n\\item[(c)]\n$(n+5)^2$ is in $S$ whenever $n$ is in $S$.\n\\end{enumerate}\nWhich positive integers are not in $S$?\n\n(The set $S$ is ``smallest'' in the sense that $S$ is contained in any other such set.)", "solution": "We claim that the positive integers not in $S$ are $1$ and all multiples of $5$. If $S$ consists of all other natural numbers, then $S$ satisfies the given conditions: note that the only perfect squares not in $S$ are $1$ and numbers of the form $(5k)^2$ for some positive integer $k$, and it readily follows that both (b) and (c) hold.\n\n\nNow suppose that $T$ is another set of positive integers satisfying (a), (b), and (c). Note from (b) and (c) that if $n \\in T$ then $n+5 \\in T$, and so $T$ satisfies the following property: \n\\begin{itemize}\n\\item[(d)]\nif $n\\in T$, then $n+5k \\in T$ for all $k \\geq 0$.\n\\end{itemize} \nThe following must then be in $T$, with implications labeled by conditions (b) through (d):\n\\begin{gather*}\n2 \\stackrel{c}{\\Rightarrow} 49 \\stackrel{c}{\\Rightarrow} 54^2 \\stackrel{d}{\\Rightarrow} 56^2 \\stackrel{b}{\\Rightarrow} 56 \\stackrel{d}{\\Rightarrow} 121 \\stackrel{b}{\\Rightarrow} 11 \\\\\n11 \\stackrel{d}{\\Rightarrow} 16 \\stackrel{b}{\\Rightarrow} 4 \\stackrel{d}{\\Rightarrow} 9 \\stackrel{b}{\\Rightarrow} 3 \\\\\n16 \\stackrel{d}{\\Rightarrow} 36 \\stackrel{b}{\\Rightarrow} 6\n\\end{gather*}\n\nSince $2,3,4,6 \\in T$, by (d) $S \\subseteq T$, and so $S$ is smallest.", "source_problems": "PUTNAM-2017-problems.tex", "source_solutions": "PUTNAM-2017-solutions.tex", "notes": ""}
{"id": "PUTNAM-2017-A2", "contest": "PUTNAM", "year": "2017", "problem_number": "A2", "problem": "Let $Q_0(x) = 1$, $Q_1(x) = x$, and\n\\[\nQ_n(x) = \\frac{(Q_{n-1}(x))^2 - 1}{Q_{n-2}(x)}\n\\]\nfor all $n \\geq 2$. Show that, whenever $n$ is a positive integer, $Q_n(x)$ is equal to a polynomial with integer coefficients.", "solution": "\\textbf{First solution.}\nDefine $P_n(x)$ for $P_0(x) = 1$, $P_1(x) = x$, and $P_n(x) = x \nP_{n-1}(x)-P_{n-2}(x)$. We claim that $P_n(x) = Q_n(x)$ for all $n \\geq 0$;\nsince $P_n(x)$ clearly is a polynomial \nwith integer coefficients for all $n$, this will imply the desired result.\n\n Since $\\{P_n\\}$ and $\\{Q_n\\}$ are \nuniquely determined by their respective recurrence relations and the \ninitial conditions $P_0,P_1$ or $Q_0,Q_1$, it suffices to check that \n$\\{P_n\\}$ satisfies the same recurrence as $Q$: that is, \n$(P_{n-1}(x))^2-P_n(x)P_{n-2}(x) = 1$ for all $n \\geq 2$. Here is one \nproof of this: for $n \\geq 1$, define the $2\\times 2$ matrices \n\\[\nM_n = \n\\begin{pmatrix} P_{n-1}(x) & P_n (x) \\\\ P_{n-2}(x) & \nP_{n-1}(x) \\end{pmatrix}, \\quad T = \\begin{pmatrix} x & -1 \\\\ 1 & 0 \\end{pmatrix}\n\\]\nwith $P_{-1}(x) = 0$ (this value being consistent with the recurrence).\nThen $\\det(T) = 1$ and $T M_{n} = M_{n+1}$, so by induction on $n$ we have\n\\[\n(P_{n-1}(x))^2-P_n(x)P_{n-2}(x) = \\det(M_n) = \n\\det(M_1) = 1.\n\\]\n\n\\noindent\n\\textbf{Remark:}\nA similar argument shows that any second-order linear recurrent sequence also satisfies a quadratic second-order recurrence relation.\nA familiar example is the identity $F_{n-1} F_{n+1} - F_n^2 = (-1)^{n}$ for $F_n$ the $n$-th Fibonacci number. \nMore examples come from various classes of \\emph{orthogonal polynomials}, including the Chebyshev polynomials mentioned below.\n\n\\noindent\n\\textbf{Second solution.}\nWe establish directly that $Q_n(x) = x \nQ_{n-1}(x)-Q_{n-2}(x)$, which again suffices. \nFrom the equation\n\\[\n1 = Q_{n-1}(x)^2 - Q_n(x) Q_{n-2}(x) = Q_n(x)^2 - Q_{n+1}(x) Q_{n-1}(x)\n\\]\nwe deduce that\n\\[\nQ_{n-1}(x)(Q_{n-1}(x) + Q_{n+1}(x)) = Q_n(x) (Q_n(x) + Q_{n-2}(x)).\n\\]\nSince $\\deg(Q_n(x)) = n$ by an obvious induction, the polynomials $Q_n(x)$ are all nonzero. We may thus rewrite the previous equation as\n\\[\n\\frac{Q_{n+1}(x) + Q_{n-1}(x)}{Q_n(x)} = \\frac{Q_n(x) + Q_{n-2}(x)}{Q_{n-1}(x)},\n\\]\nmeaning that the rational functions $\\frac{Q_n(x) + Q_{n-2}(x)}{Q_{n-1}(x)}$\nare all equal to a constant value. By taking $n=2$ and computing from the definition that $Q_2(x) = x^2-1$,\nwe find the constant value to be $x$; this yields the desired recurrence.\n\n\\noindent\n\\textbf{Remark:}\nBy induction, one may also obtain the explicit formula\n\\[\nQ_n(x) = \\sum_{k=0}^{\\lfloor n/2 \\rfloor} (-1)^k \\binom{n-k}{k} x^{n-2k}.\n\\]\n\n\\noindent\n\\textbf{Remark:}\nIn light of the explicit formula for $Q_n(x)$,\nKarl Mahlburg suggests the following bijective interpretation of the identity\n$Q_{n-1}(x)^2 - Q_n(x) Q_{n-2}(x) = 1$.\nConsider the set $C_n$ of integer compositions of $n$ with all parts 1 or 2; \nthese are ordered tuples $(c_1, \\dots, c_k)$ such that $c_1 + \\cdots + c_k = n$ and $c_i  \\in \\{1,2\\}$ for all $i$.\nFor a given composition $c$, let $o(c)$ and $d(c)$ denote the number of 1's and 2's, respectively.\nDefine the generating function\n\\[\nR_n(x) = \\sum_{c \\in C_n} x^{o(c)};\n\\]\nthen $R_n(x) = \\sum_{j} \\binom{n-j}{j} x^{n-2j}$, so that $Q_n(x) = i^{-n/2} R_n(ix)$.\n(The polynomials $R_n(x)$ are sometimes called \\emph{Fibonacci polynomials}; they satisfy $R_n(1) = F_n$.\nThis interpretation of $F_n$ as the cardinality of $C_n$ first arose in the study of Sanskrit prosody, specifically the analysis of a line of verse as a sequence of long and short syllables, at least 500 years prior to\nthe work of Fibonacci.)\n\nThe original identity is equivalent to the identity\n\\[\nR_{n+1}(x) R_{n-1}(x) - R_n(x)^2 = (-1)^{n-1}.\n\\]\nThis follows because if we identify the composition $c$ with a tiling of a $1 \\times n$ rectangle by $1 \\times 1$ squares and $1 \\times 2$ dominoes, it is \\emph{almost} a bijection to place two tilings of length $n$ on top of each other, offset by one square, and hinge at the first possible point (which is the first square in either). This only fails when both tilings are all dominoes, which gives the term $(-1)^{n-1}$.\n\n\\noindent\n\\textbf{Remark:}\nThis problem appeared on the 2012 India National Math Olympiad; see\n\\url{https://artofproblemsolving.com/community/c6h1219629}.\nAnother problem based on the same idea is problem A2 from the 1993 Putnam.", "source_problems": "PUTNAM-2017-problems.tex", "source_solutions": "PUTNAM-2017-solutions.tex", "notes": ""}
{"id": "PUTNAM-2017-A3", "contest": "PUTNAM", "year": "2017", "problem_number": "A3", "problem": "Let $a$ and $b$ be real numbers with $a<b$, and let $f$ and $g$ be continuous functions from $[a,b]$ to $(0, \\infty)$\nsuch that $\\int_a^b f(x)\\,dx = \\int_a^b g(x)\\,dx$ but $f \\neq g$. For every positive integer $n$, define\n\\[\nI_n = \\int_a^b \\frac{(f(x))^{n+1}}{(g(x))^n}\\,dx.\n\\]\nShow that $I_1, I_2, I_3, \\dots$ is an increasing sequence with $\\lim_{n \\to \\infty} I_n = \\infty$.", "solution": "\\textbf{First solution.}\nExtend the definition of $I_n$ to $n=0$, so that $I_0 = \\int_a^b f(x)\\,dx > 0$. Since $\\int_a^b (f(x)-g(x))\\,dx = 0$, we have\n\\begin{align*}\nI_1-I_0 &= \\int_a^b \\frac{f(x)}{g(x)}(f(x)-g(x)) \\, dx \\\\\n&= \\int_a^b \\frac{(f(x)-g(x))^2}{g(x)} \\,dx > 0,\n\\end{align*}\nwhere the inequality follows from the fact that the integrand is a nonnegative continuous function on $[a,b]$ that is not identically $0$. Now for $n \\geq 0$, the Cauchy--Schwarz inequality gives\n\\begin{align*}\nI_n I_{n+2} &= \\left( \\int_a^b \\frac{(f(x))^{n+1}}{(g(x))^n}\\,dx \\right) \\left( \\int_a^b \\frac{(f(x))^{n+3}}{(g(x))^{n+2}}\\,dx \\right) \\\\\n&\\geq \\left(\\int_a^b \\frac{(f(x))^{n+2}}{(g(x))^{n+1}}\\,dx \\right)^2 = I_{n+1}^2.\n\\end{align*}\nIt follows that the sequence $\\{I_{n+1}/I_n\\}_{n=0}^\\infty$ is nondecreasing. Since $I_1/I_0>1$, this implies that $I_{n+1}>I_n$ for all $n$; also,\n$I_n/I_0 = \\prod_{k=0}^{n-1} (I_{k+1}/I_k) \\geq (I_1/I_0)^n$, and so $\\lim_{n\\to\\infty} I_n = \\infty$ since $I_1/I_0>1$ and $I_0 > 0$.\n\n\\noindent\n\\textbf{Remark:}\nNoam Elkies suggests the following variant of the previous solution,\nwhich eliminates the need to separately check that $I_1 > I_0$.\nFirst, the proof that $I_n I_{n+2} \\geq I_{n+1}^2$ applies also for $n=-1$ under the convention that $I_{-1} = \\int_a^b g(x)\\,dx$ (as in the fourth solution below).\nSecond, this equality must be strict for each $n \\geq -1$: \notherwise, the equality condition in Cauchy--Schwarz would imply that \n$g(x) = c f(x)$ identically for some $c>0$, and the equality $\\int_a^b f(x)\\,dx = \\int_a^b g(x)\\,dx$ would then force $c=1$, contrary to assumption. Consequently, the sequence $I_{n+1}/I_n$ is strictly increasing; since\n$I_0/I_{-1} = 1$, it follows that for $n \\geq 0$, we again have $I_{n+1}/I_n \\geq I_1/I_0 > 1$ and so on.\n\n\\textbf{Second solution.}\n(from Art of Problem Solving, user \\texttt{MSTang})\nSince $\\int_a^b (f(x) - g(x))\\,dx = 0$,\nwe have\n\\begin{align*}\nI_{n+1} - I_n &= \\int_a^b \\left( \\frac{(f(x))^{n+2}}{(g(x))^{n+1}} - \\frac{(f(x))^{n+1}}{(g(x))^{n}} \\right)\\,dx \\\\\n&= \\int_a^b \\frac{(f(x))^{n+1}}{(g(x))^{n+1}} (f(x)-g(x))\\,dx \\\\\n&= \\int_a^b \\left(\\frac{(f(x))^{n+1}}{(g(x))^{n+1}} - 1 \\right) (f(x)-g(x))\\,dx \\\\\n&= \\int_a^b \\frac{(f(x)-g(x))^2 ((f(x))^n + \\cdots + g(x)^n)}{(g(x))^{n+1}}\\,dx.\n\\end{align*}\nThe integrand is continuous, nonnegative, and not identically zero; hence $I_{n+1} - I_n > 0$.\n\nTo prove that $\\lim_{n \\to \\infty} I_n = \\infty$, note that we cannot have $f(x) \\leq g(x)$ identically, as then\nthe equality $\\int_a^b f(x)\\,dx = \\int_a^b g(x)\\,dx$ would imply $f(x) = g(x)$ identically. That is, there exists\nsome $t \\in [a,b]$ such that $f(t) > g(t)$. By continuity, there exist a quantity $c > 1$\nand an interval $J = [t_0, t_1]$ in $[a,b]$ such that $f(x) \\geq c g(x)$ for all $x \\in J$. We then have\n\\[\nI_n \\geq \\int_{t_0}^{t_1} \\frac{(f(x))^{n+1}}{(g(x))^n}\\,dx \\\\\n\\geq c^n \\int_{t_0}^{t_1} f(x)\\,dx;\n\\]\nsince $f(x) > 0$ everywhere, we have $\\int_{t_0}^{t_1} f(x)\\,dx > 0$\nand hence $I_n$ is bounded below by a quantity which tends to $\\infty$.\n\n\\noindent\n\\textbf{Remark:}\nOne can also give a variation of the second half of the solution which shows directly that\n$I_{n+1} - I_n \\geq c^n d$ for some $c > 1, d>0$, thus proving both assertions at once.\n\n%\\textbf{Third solution.}\n%(from Art of Problem Solving, user \\texttt{kybard})\n%Write\n%\\begin{align*}\n%I_n - I_{n-1} &= \\int_a^b (1 + (f(x)-g(x))/g(x))^n (f(x)-g(x))\\,dx \\\\\n%&\\geq (1 + n (f(x)-g(x))/g(x)) (f(x)-g(x))\\,dx \\\\\n%&= n \\int_a^b \\frac{(f(x)-g(x))^2}{g(x)}\\,dx.\n%\\end{align*}\n%The integrand is nonnegative and not identically zero, so\n%$I_n - I_{n-1}$ is bounded below by $n$ times a positive constant. This proves both assertions at once.\n\n\\textbf{Third solution.}\n(from David Savitt, via Art of Problem Solving)\nExtend the definition of $I_n$ to all \\emph{real} $n$,\nand note that \n\\[\nI_{-1} = \\int_a^b g(x)\\,dx = \\int_a^b f(x)\\,dx = I_0.\n\\]\nBy writing\n\\[\nI_n = \\int_a^b \\exp((n+1)\\log f(x) - n \\log g(x))\\,dx,\n\\]\nwe see that the integrand is a strictly convex function of $n$, as then is $I_n$.\nIt follows that $I_n$ is strictly increasing and unbounded for $n \\geq 1$.\n\n\\textbf{Fourth solution.}\n(by David Rusin)\nAgain, extend the definition of $I_n$ to $n=-1$.\nNow note that for $n \\geq 0$ and $x \\in [a,b]$, we have\n\\[\n(f(x) - g(x)) \\left( \\left( \\frac{f(x)}{g(x)} \\right)^{n+1}  - \\left( \\frac{f(x)}{g(x)} \\right)^{n}  \\right) \\geq 0\n\\]\nbecause both factors have the same sign (depending on the comparison between $f(x)$ and $g(x)$);\nmoreover, equality only occurs when $f(x) = g(x)$. Since $f$ and $g$ are not identically equal, we deduce that\n\\[\nI_{n+1} - I_n > I_n - I_{n-1}\n\\]\nand so in particular\n\\[\nI_{n+1} - I_n \\geq I_1 - I_0 > I_0 - I_{-1} = 0.\n\\]\nThis proves both claims.\n\n\\textbf{Remark:}\nThis problem appeared in 2005 on an undergraduate math olympiad in Brazil.\nSee \\url{https://artofproblemsolving.com/community/c7h57686p354392} for discussion.", "source_problems": "PUTNAM-2017-problems.tex", "source_solutions": "PUTNAM-2017-solutions.tex", "notes": ""}
{"id": "PUTNAM-2017-A4", "contest": "PUTNAM", "year": "2017", "problem_number": "A4", "problem": "A class with $2N$ students took a quiz, on which the possible scores were $0,1,\\dots,10$. Each of these scores\noccurred at least once, and the average score was exactly $7.4$. Show that the class can be divided into two groups of $N$ students in such a way that the average score for each group was exactly $7.4$.", "solution": "\\textbf{First solution.}\nLet $a_1,\\dots,a_{2N}$ be the scores in nondecreasing order, and define the sums\n$s_i = \\sum_{j=i+1}^{i+N} a_j$ for $i=0,\\dots,N$.\nThen $s_0 \\leq \\cdots \\leq s_{N}$\nand\n$s_0 + s_{N} = \\sum_{j=1}^{2N} a_j = 7.4(2N)$,\nso $s_0 \\leq 7.4N \\leq s_N$. Let $i$ be the largest index for which $s_i \\leq 7.4N$;\nnote that we cannot have $i = N$, as otherwise $s_0 = s_N = 7.4N$ and hence \n$a_1 = \\cdots = a_{2N} = 7.4$, contradiction.\nThen $7.4N - s_i < s_{i+1} - s_i = a_{i+N+1} - a_i$ and so\n\\[\na_i < s_i + a_{i+N+1} - 7.4N \\leq a_{i+N+1};\n\\]\nsince all possible scores occur, this means that we can find $N$ scores with sum $7.4N$\nby taking $a_{i+1}, \\dots, a_{i+N+1}$ and omitting one occurrence of the value $s_i + a_{i+N+1} - 7.4N$.\n\n\\noindent\n\\textbf{Remark:}\nDavid Savitt (via Art of Problem Solving) points out that a similar argument applies provided that\nthere are an even number of students, the total score is even, and the achieved scores form a block of consecutive integers.\n\n\\noindent\n\\textbf{Second solution.}\nWe first claim that for any integer $m$ with $15 \\leq m \\leq 40$, we can find five distinct elements of the set $\\{1,2,\\ldots,10\\}$ whose sum is $m$. Indeed, for $0 \\leq k \\leq 4$ and $1 \\leq \\ell \\leq 6$, we have\n\\[\n\\left(\\sum_{j=1}^k j \\right) + (k+\\ell) + \\left(\\sum_{j=k+7}^{10} j \\right) = 34-5k+\\ell,\\]\nand for fixed $k$ this takes all values from $35-5k$ to $40-5k$ inclusive; then as $k$ ranges from $0$ to $4$, this takes all values from $15$ to $40$ inclusive.\n\nNow suppose that the scores are $a_1,\\ldots,a_{2N}$, where we order the scores so that $a_k=k$ for $k \\leq 10$ and the subsequence $a_{11},a_{12},\\ldots,a_{2N}$ is nondecreasing. For $1 \\leq k \\leq N-4$, define $S_k = \\sum_{j=k+10}^{k+N+4} a_j$. Note that for each $k$, $S_{k+1}-S_k = a_{k+N+5}-a_{k+10}$ and so $0 \\leq S_{k+1}-S_k \\leq 10$. Thus $S_1,\\ldots,S_{N-4}$ is a nondecreasing sequence of integers where each term is at most $10$ more than the previous one. On the other hand, we have \n\\begin{align*}\nS_1 + S_{N-4} &= \\sum_{j=11}^{2N} a_j \\\\\n&= (7.4)(2N)-\\sum_{j=1}^{10} a_j \\\\\n&= (7.4)(2N)-55,\n\\end{align*}\nwhence $S_1 \\leq 7.4N-27.5 \\leq S_{N-4}$. It follows that there is some $k$ such that $S_k \\in [7.4N-40, 7.4N-15]$, since this interval has length $25$ and $7.4N-27.5$ lies inside it.\n\n\nFor this value of $k$, note that both $S_k$ and $7.4N$ are integers (the latter since the sum of all scores in the class is the integer $(7.4)(2N)$ and so $N$ must be divisible by $5$). Thus there is an integer $m$ with $15 \\leq m \\leq 40$ for which $S_k = 7.4N-m$. By our first claim, we can choose five scores from $a_1,\\ldots,a_{10}$ whose sum is $m$. When we add these to the sum of the $N-5$ scores $a_{k+10},\\ldots,a_{k+N+4}$, we get precisely $7.4N$. We have now found $N$ scores whose sum is $7.4N$ and thus whose average is $7.4$.\n\n\\noindent\n\\textbf{Third solution.}\nIt will suffices to show that given any partition of the students into two groups of $N$, if the sums are not equal we can bring them closer together by swapping one pair of students between the two groups. To state this symbolically,\nlet $S$ be the set of students and, for any subset $T$ of $S$, let $\\Sigma T$ denote the sum of the scores of the students in $T$; we then show that if $S = A \\cup B$ is a partition into two $N$-element sets with\n$\\Sigma A > \\Sigma B$, then there exist students $a \\in A, B \\in B$ such that the sets\n\\[\nA' = A \\setminus \\{a\\} \\cup \\{b\\}, \\qquad\nB' = A \\setminus \\{b\\} \\cup \\{a\\}\n\\]\nsatisfy\n\\[\n0 \\leq \\Sigma A' - \\Sigma B' < \\Sigma A - \\Sigma B.\n\\]\nIn fact, this argument will apply at the same level of generality as in the remark following the first solution.\n\nTo prove the claim, let \n$a_1,\\dots,a_n$ be the scores in $A$ and let $b_1,\\dots,b_n$ be the scores in $B$ (in any order).\nSince $\\Sigma A - \\Sigma B \\equiv \\Sigma S \\pmod{2}$ and the latter is even, we must have\n$\\Sigma A - \\Sigma B \\geq 2$.\nIn particular, there must exist indices $i,j \\in \\{1,\\dots,n\\}$ such that $a_i > b_j$.\nConsequently, if we sort the sequence $a_1,\\dots,a_n,b_1,\\dots,b_n$ into nondecreasing order,\nit must be the case that some term $b_j$ is followed by some term $a_i$.\nMoreover, since the achieved scores form a range of consecutive integers, we must in fact have\n$a_i = b_j + 1$. Consequently, if we take $a = a_i$, $b = b_j$, we then have\n$\\Sigma A' - \\Sigma' B = \\Sigma A - \\Sigma B - 2$, which proves the claim.", "source_problems": "PUTNAM-2017-problems.tex", "source_solutions": "PUTNAM-2017-solutions.tex", "notes": ""}
{"id": "PUTNAM-2017-A5", "contest": "PUTNAM", "year": "2017", "problem_number": "A5", "problem": "Each of the integers from $1$ to $n$ is written on a separate card, and then the cards are combined into a deck and shuffled. Three players, $A$, $B$, and $C$, take turns in the order $A,B,C,A,\\dots$ choosing one card at random from the deck. (Each card in the deck is equally likely to be chosen.) After a card is chosen, that card and all higher-numbered cards are removed from the deck, and the remaining cards are reshuffled before the next turn. Play continues until one of the three players wins the game by drawing the card numbered $1$.\n\nShow that for each of the three players, there are arbitrarily large values of $n$ for which that player has the highest probability among the three players of winning the game.", "solution": "\\textbf{First solution.}\nLet $a_n, b_n, c_n$ be the probabilities that players $A$, $B$, $C$, respectively, will win the game.\nWe compute these by induction on $n$, starting with the values\n\\[\na_1 = 1, \\qquad b_1 = 0, \\qquad c_1 = 0.\n\\]\nIf player $A$ draws card $k$, then the resulting game state is that of a deck of $k-1$ cards with the players taking turns in the order $B,C,A,B,\\dots$. In this state, the probabilities that players $A, B, C$ will win are\n$c_{k-1}, a_{k-1}, b_{k-1}$ provided that we adopt the convention that\n\\[\na_0 = 0, \\qquad b_0 = 0, \\qquad c_0 = 1.\n\\]\nWe thus have\n\\[\na_n = \\frac{1}{n} \\sum_{k=1}^{n} c_{k-1}, \\quad\nb_n = \\frac{1}{n} \\sum_{k=1}^{n} a_{k-1}, \\quad\nc_n = \\frac{1}{n} \\sum_{k=1}^{n} b_{k-1}.\n\\]\nPut\n\\[\nx_n = a_n - b_n, \\quad y_n = b_n - c_n, \\quad z_n = c_n - a_n;\n\\]\nwe then have\n\\begin{align*}\n x_{n+1} &= \\frac{n}{n+1} x_n + \\frac{1}{n+1}z_n, \\\\\n y_{n+1} &= \\frac{n}{n+1} y_n + \\frac{1}{n+1}x_n, \\\\\n z_{n+1} &= \\frac{n}{n+1} z_n + \\frac{1}{n+1}y_n.\n\\end{align*}\nNote that if $a_{n+1} = b_{n+1} = c_{n+1} = 0$, then\n\\[\nx_n = -nz_n = n^2y_n = -n^3x_n = n^4z_n\n\\]\nand so $x_n = z_n = 0$, or in other words $a_n = b_n = c_n$. By induction on $n$, we deduce that \n$a_n, b_n, c_n$ cannot all be equal. That is, the quantities $x_n, y_n, z_n$ add up to zero and at most one of them\nvanishes; consequently, the quantity $r_n = \\sqrt{x_n^2 + y_n^2 + z_n^2}$ is always positive\nand the quantities\n\\[\nx'_n = \\frac{x_n}{r_n}, \\quad y'_n = \\frac{y_n}{r_n}, \\quad z'_n = \\frac{z_n}{r_n}\n\\]\nform the coordinates of a point $P_n$ on a fixed circle $C$ in $\\mathbb{R}^3$.\n\nLet $P'_n$ be the point $(z_n, x_n, y_n)$ obtained from $P_n$ by a clockwise rotation of angle $\\frac{2\\pi}{3}$.\nThe point $P_{n+1}$ then lies on the ray through the origin passing through the point dividing the chord from $P_n$ to $P'_n$ in the ratio $1:n$. \nThe (clockwise) arc from $P_n$ to $P_{n+1}$ therefore has a measure of\n\\[\n\\arctan \\frac{\\sqrt{3}}{2n-1}\n= \\frac{\\sqrt{3}}{2n-1} + O(n^{-3});\n\\]\nthese measures form a null sequence whose sum diverges. It follows that any arc of $C$ contains infinitely many of the $P_n$; taking a suitably short arc around the point $(\\frac{\\sqrt{2}}{2}, 0, -\\frac{\\sqrt{2}}{2})$, we deduce that for infinitely many $n$, $A$ has the highest winning probability, and similarly for $B$ and $C$.\n\n\\noindent\n\\textbf{Remark:}\nFrom the previous analysis, we also deduce that\n\\[\n\\frac{r_{n+1}}{r_n} = \\frac{\\sqrt{n^2-n+1}}{n+1} = 1 - \\frac{3}{2(n+1)} + O(n^{-2}),\n\\]\nfrom which it follows that $r_n \\sim c n^{-3/2}$ for some $c>0$.\n\n\\noindent\n\\textbf{Second solution.}\n(by Noam Elkies)\nIn this approach, we instead compute the probability $p_n(m)$ that the game ends after exactly $m$ turns\n(the winner being determined by the residue of $m$ mod 3).\nWe use the convention that $p_0(0) = 1$, $p_0(m) = 0$ for $m>0$.\nDefine the generating function $P_n(X) = \\sum_{m=0}^n p_n(m) x^m$.\nWe will establish that\n\\[\nP_n(X) = \\frac{X(X+1)\\cdots(X+n-1)}{n!}\n\\]\n(which may be guessed by computing $p_n(m)$ for small $n$ by hand). There are several ways to do this; for instance,\nthis follows from the recursion\n\\[\nP_n(X) = \\frac{1}{n} X P_{n-1}(X) + \\frac{(n-1)}{n} P_{n-1}(X).\n\\]\n(In this recursion, the first term corresponds to conditional probabilities given that the first card drawn is $n$,\nand the second term corresponds to the remaining cases.)\n\nLet $\\omega$ be a primitive cube root of 1. With notation as in the first solution,\nwe have\n\\[\nP_n(\\omega) = a_n + b_n \\omega + c_n \\omega;\n\\]\ncombining this with the explicit formula for $P_n(X)$ and the observation that\n\\[\n\\mathrm{arg}(w+n) = \\arctan \\frac{\\sqrt{3}}{2n-1}\n\\]\nrecovers the geometric description of $a_n, b_n, c_n$\ngiven in the first solution (as well as the remark following the first solution).\n\n\\noindent\n\\textbf{Third solution.}\nFor this argument, we use the auxiliary quantities\n\\[\na'_n = a_n - \\frac{1}{3}, \\quad b'_n = b_n - \\frac{1}{3}, \\quad c'_n = c_n - \\frac{1}{3};\n\\]\nthese satisfy the relations\n\\[\na'_n = \\frac{1}{n} \\sum_{k=1}^{n} c'_{k-1}, \\quad\nb'_n = \\frac{1}{n} \\sum_{k=1}^{n} a'_{k-1}, \\quad\nc'_n = \\frac{1}{n} \\sum_{k=1}^{n} b'_{k-1}\n\\]\nas well as \n\\begin{align*}\na'_{n+1} &= a'_n + \\frac{1}{n+1} (c'_n-a'_n)  \\\\\nb'_{n+1} &= b'_n + \\frac{1}{n+1} (a'_n-b'_n) \\\\\nc'_{n+1} &= c'_n + \\frac{1}{n+1} (b'_n-c'_n).\n\\end{align*}\nWe now show that $\\sum_{n=1}^\\infty a'_n$ cannot diverge to $+\\infty$\n(and likewise for $\\sum_{n=1}^\\infty b'_n$ and $\\sum_{n=1}^\\infty c'_n$ by similar reasoning).\nSuppose the contrary; then there exists some $\\epsilon > 0$ and some $n_0 > 0$ \nsuch that $\\sum_{k=1}^n a'_k \\geq \\epsilon$ for all $n \\geq n_0$.\nFor $n > n_0$, we have $b'_n \\geq \\epsilon$; this in turn implies that $\\sum_{n=1}^\\infty b'_n$ diverges to $+\\infty$.\nContinuing around the circle, we deduce that for $n$ sufficiently large, all three of $a'_n, b'_n, c'_n$ are positive;\nbut this contradicts the identity $a'_n + b'_n + c'_n = 0$. We thus conclude that $\\sum_{n=1}^\\infty a'_n$ does not diverge to $+\\infty$; in particular, $\\liminf_{n \\to \\infty} a'_n \\leq 0$.\n\nBy the same token, we may see that $\\sum_{n=1}^\\infty a'_n$ cannot converge to a positive limit $L$\n(and likewise for $\\sum_{n=1}^\\infty b'_n$ and $\\sum_{n=1}^\\infty c'_n$ by similar reasoning).\nNamely, this would imply that $b'_n \\geq L/2$ for $n$ sufficiently large, contradicting the previous argument.\n\nBy similar reasoning, $\\sum_{n=1}^\\infty a'_n$ cannot diverge to $-\\infty$ or converge to a negative limit $L$\n(and likewise for $\\sum_{n=1}^\\infty b'_n$ and $\\sum_{n=1}^\\infty c'_n$ by similar reasoning).\n\nWe next establish that there are infinitely many $n$ for which $a'_n > 0$ (and likewise for $b'_n$ and $c'_n$ by similar reasoning).\nSuppose to the contrary that for $n$ sufficiently large, we have $a'_n \\leq 0$. \nBy the previous arguments, the sum $\\sum_{n=1}^\\infty a'_n$ cannot diverge to $\\infty$ or converge to a nonzero limit;\nit must therefore converge to 0. In particular, for $n$ sufficiently large, we have\n$b'_n = \\sum_{k=1}^n a'_{k-1} \\geq 0$. Iterating the construction, we see that for $n$ sufficiently large,\nwe must have $c'_n \\leq 0$, $a'_n \\geq 0$, $b'_n \\leq 0$, and $c'_n \\geq 0$. As a result, for $n$\nsufficiently large we must have $a'_n = b'_n = c'_n = 0$; but we may rule this out as in the original solution.\n\nBy similar reasoning, we may deduce that there are infinitely many $n$ for which $a'_n < 0$ (and likewise for $b'_n$ and $c'_n$ by similar reasoning). We now continue using a suggestion of Jon Atkins.\nDefine the values of the sequence $x_n$ according to the relative comparison of $a'_n, b'_n, c'_n$ (using the fact that these cannot all be equal):\n\\begin{align*}\nx_n = 1: & \\quad a'_n \\leq b'_n < c'_n \\\\\nx_n = 2: & \\quad b'_n \\leq c'_n < a'_n \\\\\nx_n = 3: & \\quad c'_n \\leq a'_n < b'_n \\\\\nx_n = 4: & \\quad a'_n < c'_n \\leq b'_n \\\\\nx_n = 5: & \\quad b'_n < a'_n \\leq c'_n \\\\\nx_n = 6: & \\quad c'_n < b'_n \\leq a'_n.\n\\end{align*}\nWe consider these values as \\emph{states} and say that there is a \\emph{transition} from state $i$ to state $j$,\nand write $i \\Rightarrow j$, if for every $n \\geq 2$ with $x_n = i$ there exists $n' > n$ with $x_{n'} = j$.\n(In all cases when we use this notation, it will in fact be the case that the \\emph{first} value of $n'>n$ for which\n$x_{n'} \\neq i$ satisfes $x_{n'} = j$, but this is not logically necessary for our final conclusion.) \n\nSuppose that $x_n = 1$. By the earlier discussion, we must have $a'_{n'} > 0$ for some $n' > n$, and so we cannot have $x_{n'} = 1$ for all $n' > n$. On the other hand, as long as $x_n = 1$, we have \n\\begin{align*}\nc'_{n+1}-b'_{n+1} &= c'_n - b'_n + \\frac{1}{n+1}(2b'_n  - a'_n - c'_n) \\\\\n&= \\frac{n-1}{n+1} (c'_n - b'_n) + \\frac{1}{n+1}(c'_n - a'_n) > 0 \\\\\nc'_{n+1}-a'_{n+1} &= c'_n - a'_n + \\frac{1}{n+1}(a'_n + b'_n - 2c'_n) \\\\\n&= \\frac{n-1}{n+1} (c'_n - a'_n) + \\frac{1}{n+1}(b'_n - a'_n) > 0.\n\\end{align*}\nConsequently, for $n'$ the smallest value for which $x_{n'} \\neq x_n$, we must have $x_{n'} = 2$. \nBy this and two similar arguments, we deduce that\n\\[\n1 \\Rightarrow 5, \\quad 2 \\Rightarrow 6, \\quad 3 \\Rightarrow 4.\n\\]\nSuppose that $x_n = 4$. By the earlier discussion, we must have $a'_{n'} < 0$ for some $n' > n$, and so we cannot have $x_{n'} = 4$ for all $n' > n$. On the other hand, as long as $x_n = 4$, we have  \n\\begin{align*}\nb'_{n+1}-a'_{n+1} &=b'_n - a'_n + \\frac{1}{n+1} (2a'_n - b'_n - c'_n) \\\\\n&= \\frac{n-1}{n+1} (b'_n - a'_n) + \\frac{1}{n+1}(b'_n - c'_n) > 0 \\\\\nc'_{n+1}-a'_{n+1} &= c'_n - a'_n + \\frac{1}{n+1}(a'_n + b'_n - 2c'_n) \\\\\n&= \\frac{n-1}{n+1} (c'_n - a'_n) + \\frac{1}{n+1}(b'_n - a'_n) > 0.\n\\end{align*}\nConsequently, for $n'$ the smallest value for which $x_{n'} \\neq x_n$, we must have $x_{n'} = 1$. \nBy this and two similar arguments, we deduce that\n\\[\n4 \\Rightarrow 1, \\quad 5 \\Rightarrow 2, \\quad 6 \\Rightarrow 3.\n\\]\nCombining, we obtain\n\\[\n1 \\Rightarrow 5 \\Rightarrow 2 \\Rightarrow 6 \\Rightarrow 3 \\Rightarrow 4 \\Rightarrow 1\n\\]\nand hence the desired result.", "source_problems": "PUTNAM-2017-problems.tex", "source_solutions": "PUTNAM-2017-solutions.tex", "notes": ""}
{"id": "PUTNAM-2017-A6", "contest": "PUTNAM", "year": "2017", "problem_number": "A6", "problem": "The 30 edges of a regular icosahedron are distinguished by labeling them $1,2,\\dots,30$. How many different ways \nare there to paint each edge red, white, or blue such that each of the 20 triangular faces of the icosahedron has two edges of the same color and a third edge of a different color? [Note: the top matter on each exam paper included the logo of the Mathematical Association of America, which is itself an icosahedron.]", "solution": "The number of such colorings is $2^{20} 3^{10} = 61917364224$.\n\n\\noindent\n\\textbf{First solution:}\nIdentify the three colors red, white, and blue with (in some order) the elements of the field $\\mathbb{F}_3$ of three elements (i.e., the ring of integers mod 3). \nThe set of colorings may then be identified with the $\\mathbb{F}_3$-vector space $\\mathbb{F}_3^E$\ngenerated by the set $E$ of edges. Let $F$ be the set of faces, and let $\\mathbb{F}_3^F$ be the $\\mathbb{F}_3$-vector space on the basis $F$; we may then define a linear transformation\n$T: \\mathbb{F}_3^E \\to \\mathbb{F}_3^F$ taking a coloring to the vector whose component corresponding to a given face equals the sum of the three edges of that face. The colorings we wish to count are the ones whose images under $T$ consist of vectors with no zero components.\n\nWe now show that $T$ is surjective. (There are many possible approaches to this step; for instance, see the following remark.) \nLet $\\Gamma$ be the dual graph of the icosahedron, that is, $\\Gamma$ has vertex set $F$ and two elements of $F$ are adjacent in $\\Gamma$ if they share an edge in the icosahedron. The graph $\\Gamma$ admits a hamiltonian path, that is, there exists an ordering\n$f_1,\\dots,f_{20}$ of the faces such that any two consecutive faces are adjacent in $\\Gamma$. \nFor example, such an ordering can be constructed with $f_1,\\dots,f_5$ being the five faces sharing a vertex of the icosahedron and $f_{16},\\dots,f_{20}$ being the five faces sharing the antipodal vertex.\n\nFor $i=1,\\dots,19$, let $e_i$ be the common edge of $f_i$ and $f_{i+1}$; these are obviously all distinct.\nBy prescribing components for $e_1,\\dots,e_{19}$ in turn and setting the others to zero,\nwe can construct an element of $\\mathbb{F}_3^E$ whose image under $T$ matches any given vector of $\\mathbb{F}_3^F$ in the components of $f_1,\\dots,f_{19}$. The vectors in $\\mathbb{F}_3^F$ obtained in this way thus form a 19-dimensional subspace; this subspace may also be described as the vectors for which the components of $f_1,\\dots,f_{19}$ have the same sum as the components of $f_{2},\\dots,f_{20}$. \n\nBy performing a mirror reflection, we can construct a second hamiltonian path $g_1,\\dots,g_{20}$ with the property that\n\\[\ng_1 = f_1, g_2 = f_5, g_3 = f_4, g_4 = f_3, g_5 = f_2.\n\\]\nRepeating the previous construction, we obtain a \\emph{different} 19-dimensional subspace of $\\mathbb{F}_3^F$ which is contained in the image of $T$. This implies that $T$ is surjective, as asserted earlier.\n\nSince $T$ is a surjective homomorphism from a 30-dimensional vector space to a 20-dimensional vector space, it has a 10-dimensional kernel. Each of the $2^{20}$ elements of $\\mathbb{F}_3^F$ with no zero components is then the image of exactly $3^{10}$ colorings of the desired form, yielding the result.\n\n\\noindent\n\\textbf{Remark:}\nThere are many ways to check that $T$ is surjective. One of the simplest is the following\n(from Art of Problem Solving, user \\texttt{Ravi12346}): form a vector in $\\mathbb{F}^E$ with components $2,1,2,1,2$ at the five edges around some vertex and all other components 0. This maps to a vector in $\\mathbb{F}^F$ with only a single nonzero component; by symmetry, every standard basis vector of $\\mathbb{F}^F$ arises in this way.\n\n\\noindent\n\\textbf{Second solution:}\n(from Bill Huang, via Art of Problem Solving user \\texttt{superpi83})\nLet $v$ and $w$ be two antipodal vertices of the icosahedron. Let $S_v$ (resp.\\ $S_w$) be the set of five edges incident to $v$ (resp.\\ $w$). Let $T_v$ (resp.\\ $T_w$) be the set of five edges of the pentagon formed by the opposite endpoints of the five edges in $S_v$ (resp. $S_w$). Let $U$ be the set of the ten remaining edges of the icosahedron.\n\nConsider any one of the $3^{10}$ possible colorings of $U$. The edges of $T_v \\cup U$ form the boundaries of five faces with no edges in common; thus each edge of $T_v$ can be colored in one of two ways consistent with the given condition,\nand similarly for $T_w$. That is, there are $3^{10} 2^{10}$ possible colorings of $T_v \\cup T_w \\cup U$ consistent with the given condition.\n\nTo complete the count, it suffices to check that there are exactly $2^5$ ways to color $S_v$ consistent with any given coloring of $T_v$. Using the linear-algebraic interpretation from the first solution, this follows by observing that\n(by the previous remark) the map from $\\mathbb{F}_3^{S_v}$ to the $\\mathbb{F}_3$-vector space on the faces incident to $v$ is surjective, and hence an isomorphism for dimensional reasons. A direct combinatorial proof is also possible.", "source_problems": "PUTNAM-2017-problems.tex", "source_solutions": "PUTNAM-2017-solutions.tex", "notes": ""}
{"id": "PUTNAM-2017-B1", "contest": "PUTNAM", "year": "2017", "problem_number": "B1", "problem": "Let $L_1$ and $L_2$ be distinct lines in the plane. Prove that $L_1$ and $L_2$ intersect if and only if, for every\nreal number $\\lambda\\neq 0$ and every point $P$ not on $L_1$ or $L_2$, there exist points $A_1$ on $L_1$ and $A_2$\non $L_2$ such that $\\overrightarrow{PA_2} = \\lambda \\overrightarrow{PA_1}$.", "solution": "Recall that $L_1$ and $L_2$ intersect if and only if they are not parallel. \nIn one direction, suppose that $L_1$ and $L_2$ intersect. Then for any $P$ and $\\lambda$, the dilation (homothety) of the plane by a factor of $\\lambda$ with center $P$ carries $L_1$ to another line parallel to $L_1$ and hence not parallel to $L_2$. Let $A_2$ be the unique intersection of $L_2$ with the image of $L_1$, and let $A_1$ be the point on $L_1$ whose image under the dilation is $A_2$; then $\\overrightarrow{PA_2} = \\lambda \\overrightarrow{PA_1}$.\n\nIn the other direction, suppose that $L_1$ and $L_2$ are parallel. Let $P$ be any point in the region between $L_1$ and $L_2$ and take $\\lambda = 1$. Then for any point $A_1$ on $L_1$ and any point $A_2$ on $L_2$, the vectors \n$\\overrightarrow{PA_1}$ and $\\overrightarrow{PA_2}$ have components perpendicular to $L_1$ pointing in opposite directions; in particular, the two vectors cannot be equal.\n\n\\noindent\n\\textbf{Reinterpretation:}\n(by Karl Mahlburg)\nIn terms of vectors, we may find vectors $\\vec{v}_1, \\vec{v}_2$ and scalars $c_1, c_2$ such that\n$L_i = \\{\\vec{x} \\in \\mathbb{R}^2: \\vec{v}_i \\cdot \\vec{x} = c_i\\}$.\nThe condition in the problem amounts to finding a vector $\\vec{w}$ and a scalar $t$ such that\n$P + \\vec{w} \\in L_1, P + \\lambda w \\in L_2$; this comes down to solving the linear system\n\\begin{align*}\n\\vec{v}_1 \\cdot (P + \\vec{w}) &= c_1 \\\\\n\\vec{v}_2 \\cdot (P + \\lambda \\vec{w}) &= c_2\n\\end{align*}\nwhich is nondegenerate and solvable for all $\\lambda$ if and only if $\\vec{v}_1, \\vec{v}_2$ are linearly independent.", "source_problems": "PUTNAM-2017-problems.tex", "source_solutions": "PUTNAM-2017-solutions.tex", "notes": ""}
{"id": "PUTNAM-2017-B2", "contest": "PUTNAM", "year": "2017", "problem_number": "B2", "problem": "Suppose that a positive integer $N$ can be expressed as the sum of $k$ consecutive positive integers\n\\[\nN = a + (a+1) +(a+2) + \\cdots + (a+k-1)\n\\]\nfor $k=2017$ but for no other values of $k>1$. Considering all positive integers $N$ with this property,\nwhat is the smallest positive integer $a$ that occurs in any of these expressions?", "solution": "We prove that the smallest value of $a$ is 16.\n\nNote that the expression for $N$ can be rewritten as $k(2a+k-1)/2$,\nso that $2N = k(2a+k-1)$. In this expression, $k>1$ by requirement;\n$k < 2a+k-1$ because $a>1$; and obviously $k$ and $2a+k-1$ have opposite parity. Conversely, for any factorization $2N = mn$ with $1<m<n$ and $m,n$ of opposite parity, we obtain an expression of $N$ in the desired form by taking\n$k = m$, $a = (n+1-m)/2$.\n\nWe now note that $2017$ is prime. (On the exam, solvers would have had to verify this by hand.\nSince $2017 < 45^2$, this can be done by trial division by the primes up to 43.)\nFor $2N = 2017(2a+2016)$ not to have another expression of the specified form, it must be the case that\n$2a+2016$ has no odd divisor greater than 1; that is, $2a+2016$ must be a power of 2.\nThis first occurs for $2a+2016=2048$, yielding the claimed result.\n\n\\textbf{Reinterpretation:}\n(by Karl Mahlburg)\nTo avoid $N$ having another representation, for $k = 2, \\dots, 2016$, we must have\n\\[\nN \\not\\equiv \\begin{cases} k/2 & k \\equiv 0 \\pmod{2} \\\\\n0 & k \\equiv 1 \\pmod{2}.\n\\end{cases}\n\\]\nConsequently, $N \\not\\equiv 0 \\pmod{p}$ for any odd prime $p<2017$\nand $N \\equiv 0 \\pmod{1024}$. Since $N$ must be divisible by 2017, this again yields the claimed value of $a$.", "source_problems": "PUTNAM-2017-problems.tex", "source_solutions": "PUTNAM-2017-solutions.tex", "notes": ""}
{"id": "PUTNAM-2017-B3", "contest": "PUTNAM", "year": "2017", "problem_number": "B3", "problem": "Suppose that $f(x) = \\sum_{i=0}^\\infty c_i x^i$ is a power series for which each coefficient $c_i$ is $0$ or $1$.\nShow that if $f(2/3) = 3/2$, then $f(1/2)$ must be irrational.", "solution": "Suppose by way of contradiction that $f(1/2)$ is rational. Then $\\sum_{i=0}^{\\infty} c_i 2^{-i}$ is the binary expansion of a rational number, and hence must be eventually periodic; that is, there exist some integers $m,n$ such that\n$c_i = c_{m+i}$ for all $i \\geq n$. We may then write\n\\[\nf(x) = \\sum_{i=0}^{n-1} c_i x^i + \\frac{x^n}{1-x^m} \\sum_{i=0}^{m-1} c_{n+i} x^i.\n\\]\nEvaluating at $x = 2/3$, we may equate $f(2/3) = 3/2$ with \n\\[\n\\frac{1}{3^{n-1}} \\sum_{i=0}^{n-1} c_i 2^i 3^{n-i-1} + \\frac{2^n 3^m}{3^{n+m-1}(3^m-2^m)} \\sum_{i=0}^{m-1} c_{n+i} 2^i 3^{m-1-i};\n\\]\nsince all terms on the right-hand side have odd denominator, the same must be true of the sum, a contradiction.\n\n\\noindent\n\\textbf{Remark:}\nGreg Marks asks whether the assumption that $f(2/3)=3/2$ further ensures that $f(1/2)$ is transcendental. \nWe do not know of any existing results that would imply this. However, the following result follows from a theorem of T. Tanaka (Algebraic independence of the values of power series generated by linear recurrences, \\textit{Acta Arith.} \\textbf{74} (1996), 177--190), building upon work of Mahler.\nLet $\\{a_n\\}_{n=0}^\\infty$ be a linear recurrent sequence of positive integers with characteristic polynomial $P$.\nSuppose that $P(0), P(1), P(-1) \\neq 0$ and that no two distinct roots of $P$ have ratio which is a root of unity. Then\nfor $f(x) = \\sum_{n=0}^\\infty x^{a_n}$, the values $f(1/2)$ and $f(2/3)$ are algebraically independent over $\\QQ$.\n(Note that for $f$ as in the original problem, the condition on ratios of roots of $P$ fails.)", "source_problems": "PUTNAM-2017-problems.tex", "source_solutions": "PUTNAM-2017-solutions.tex", "notes": ""}
{"id": "PUTNAM-2017-B4", "contest": "PUTNAM", "year": "2017", "problem_number": "B4", "problem": "Evaluate the sum\n\\begin{gather*}\n\\sum_{k=0}^\\infty \\left( 3 \\cdot \\frac{\\ln(4k+2)}{4k+2} - \\frac{\\ln(4k+3)}{4k+3} - \\frac{\\ln(4k+4)}{4k+4} - \\frac{\\ln(4k+5)}{4k+5} \\right) \\\\\n= 3 \\cdot \\frac{\\ln 2}{2} - \\frac{\\ln 3}{3} - \\frac{\\ln 4}{4} - \\frac{\\ln 5}{5}\n+ 3 \\cdot \\frac{\\ln 6}{6} - \\frac{\\ln 7}{7} \\\\ - \\frac{\\ln 8}{8} - \\frac{\\ln 9}{9}\n+ 3 \\cdot \\frac{\\ln 10}{10} - \\cdots .\n\\end{gather*}\n(As usual, $\\ln x$ denotes the natural logarithm of $x$.)", "solution": "We prove that the sum equals $ (\\log 2)^2$;\nas usual, we write $\\log x$ for the natural logarithm of $x$ instead of $\\ln x$.\nNote that of the two given expressions of the original sum, the first is absolutely convergent\n(the summands decay as $\\log(x)/x^2$) but the second one is not; we must thus be slightly careful when rearranging terms.\n\n\\noindent\n\\textbf{First solution.}\nDefine $a_k = \\frac{\\log k}{k} - \\frac{\\log(k+1)}{k+1}$. The infinite sum $\\sum_{k=1}^\\infty a_k$ converges to $0$ since $\\sum_{k=1}^n a_k$ telescopes to $-\\frac{\\log(n+1)}{n+1}$ and this converges to $0$ as $n\\to\\infty$. Note that $a_k > 0$ for $k \\geq 3$ since $\\frac{\\log x}{x}$ is a decreasing function of $x$ for $x>e$, and so the convergence of $\\sum_{k=1}^\\infty a_k$ is absolute.\n\nWrite $S$ for the desired sum. Then since $3a_{4k+2}+2a_{4k+3}+a_{4k+4} = (a_{4k+2}+a_{4k+4})+2(a_{4k+2}+a_{4k+3})$, we have\n\\begin{align*}\nS &= \\sum_{k=0}^\\infty (3a_{4k+2}+2a_{4k+3}+a_{4k+4}) \\\\\n&= \\sum_{k=1}^\\infty a_{2k}+\\sum_{k=0}^\\infty 2(a_{4k+2}+a_{4k+3}),\n\\end{align*}\nwhere we are allowed to rearrange the terms in the infinite sum since $\\sum a_k$ converges absolutely. Now\n$2(a_{4k+2}+a_{4k+3}) = \\frac{\\log(4k+2)}{2k+1}-\\frac{\\log(4k+4)}{2k+2} = a_{2k+1}+(\\log 2)(\\frac{1}{2k+1}-\\frac{1}{2k+2})$, and summing over $k$ gives\n\\begin{align*}\n\\sum_{k=0}^\\infty 2(a_{4k+2}+a_{4k+3}) &= \\sum_{k=0}^\\infty a_{2k+1} + (\\log 2) \\sum_{k=1}^\\infty \\frac{(-1)^{k+1}}{k}\\\\\n&= \\sum_{k=0}^\\infty a_{2k+1} +(\\log 2)^2.\n\\end{align*}\nFinally, we have \n\\begin{align*}\nS &= \\sum_{k=1}^\\infty a_{2k} + \\sum_{k=0}^\\infty a_{2k+1} +(\\log 2)^2 \\\\\n&= \\sum_{k=1}^\\infty a_k +(\\log 2)^2 = (\\log 2)^2.\n\\end{align*}\n\n\\noindent\n\\textbf{Second solution.}\nWe start with the following observation: for any positive integer $n$,\n\\[\n\\left. \\frac{d}{ds} n^{-s} \\right|_{s=1} = -(\\log n)n^{-s}.\n\\]\n(Throughout, we view $s$ as a \\emph{real} parameter, but see the remark below.)\nFor $s>0$, consider the absolutely convergent series\n\\[\nL(s) = \\sum_{k=0}^\\infty (3 (4k+2)^{-s} - (4k+3)^{-s} - (4k+4)^{-s} - (4k+5)^{-s});\n\\]\nin the same range we have\n\\begin{align*}\nL'(s) &= \\sum_{k=0}^\\infty \\left( 3 \\frac{\\log(4k+2)}{(4k+2)^s} - \\frac{\\log(4k+3)}{(4k+3)^s} \\right. \\\\\n&\\quad \\left. + \\frac{\\log(4k+4)}{(4k+4)^s} - \\frac{\\log(4k+5)}{(4k+5)^{s}} \\right),\n\\end{align*}\nso we may interchange the summation with taking the limit at $s=1$ to equate the original sum with $-L'(1)$.\n\nTo make further progress, we introduce the Riemann zeta function\n$\\zeta(s) = \\sum_{n=1}^\\infty n^{-s}$, which converges absolutely for $s>1$.\nIn that region, we may freely rearrange sums to write\n\\begin{align*}\nL(s) + \\zeta(s) &= 1 + 4 (2^{-s} + 6^{-s} + 10^{-s} + \\cdots) \\\\\n&= 1 + 2^{2-s} (1 + 3^{-s} + 5^{-s} + \\cdots) \\\\\n&= 1 + 2^{2-s} (\\zeta(s) - 2^{-s} - 4^{-s} - \\cdots) \\\\\n&= 1 + 2^{2-s} \\zeta(s) - 2^{2-2s} \\zeta(s).\n\\end{align*}\nIn other words, for $s > 1$, we have\n\\[\nL(s) = 1 + \\zeta(s) (-1 + 2^{2-s} - 2^{2-2s}).\n\\]\nNow recall that $\\zeta(s) - \\frac{s}{s-1}$ extends to a $C^\\infty$ function\nfor $s>0$, e.g., by applying Abel summation to obtain\n\\begin{align*}\n\\zeta(s) - \\frac{s}{s-1} &= \\sum_{n=1} n (n^{-s} - (n+1)^{-s}) - \\frac{s}{s-1}\\\\\n&= s \\sum_{n=1}^\\infty n \\int_n^{n+1} x^{-s-1}\\,dx  - \\frac{s}{s-1} \\\\\n&= -s \\int_1^\\infty (x - \\lfloor x \\rfloor) x^{-s-1}\\,dx.\n\\end{align*}\nAlso by writing $2^{2-s} = 2 \\exp((1-s) \\log 2$\nand $2^{2-2s} = \\exp(2(1-s)\\log 2)$, we may use the exponential series\nto compute the Taylor expansion of \n\\[\nf(s) = \\frac{-1 + 2^{2-s} - 2^{2-2s}}{s-1}\n\\]\nat $s=1$; we get\n\\[\nf(s) = -(\\log 2)^2 (s-1)^2 + O((s-1)^3).\n\\]\nConsequently, if we rewrite the previous expression for $L(s)$ as\n\\[\nL(s) =  1 + (s-1)\\zeta(s) \\cdot \\frac{-1 + 2^{2-s} - 2^{2-2s}}{s-1},\n\\]\nthen we have an equality of $C^\\infty$ functions for $s>1$, and\nhence (by continuity) an equality of Taylor series about $s=1$. \nThat is,\n\\[\nL(s) = 1 - (\\log 2)^2 (s-1) + O((s-1)^2),\n\\]\nwhich yields the desired result.\n\n\\noindent\n\\textbf{Remark:}\n\nThe use of series $\\sum_{n=1}^\\infty c_n n^{-s}$ as functions of a \\emph{real} parameter $s$\ndates back to Euler, who observed that the divergence of $\\zeta(s)$ as $s \\to 1$ gives a proof of the infinitude of primes distinct from Euclid's approach, and Dirichlet, who upgraded this idea to prove his theorem on the distribution of primes across arithmetic progressions. It was Riemann who introduced the idea of viewing these series as functions of a \\emph{complex} parameter, thus making it possible to use the tools of complex analysis (e.g., the residue theorem) and leading to the original proof of the prime number theorem by Hadamard and de la Vall\\'ee Poussin.\n\nIn the language of complex analysis, one may handle the convergence issues in the second solution \nin a different way: use the preceding calculation to establish the equality\n\\[\nL(s) = 1 + \\zeta(s) (-1 + 2^{2-s} - 2^{2-2s})\n\\]\nfor $\\mathrm{Real}(s) > 1$, then observe that both sides are holomorphic for $\\mathrm{Real}(s) > 0$\nand so the equality extends to that larger domain.", "source_problems": "PUTNAM-2017-problems.tex", "source_solutions": "PUTNAM-2017-solutions.tex", "notes": ""}
{"id": "PUTNAM-2017-B5", "contest": "PUTNAM", "year": "2017", "problem_number": "B5", "problem": "A line in the plane of a triangle $T$ is called an \\emph{equalizer} if it divides $T$ into two regions having equal area and equal perimeter. Find positive integers $a>b>c$, with $a$ as small as possible, such that there exists a triangle with side lengths $a, b, c$ that has exactly two distinct equalizers.", "solution": "The desired integers are $(a,b,c) = (9,8,7)$.\n\nSuppose we have a triangle $T = \\triangle ABC$ with $BC=a$, $CA=b$, $AB=c$ and $a>b>c$.\nSay that a line is an \\textit{area equalizer} if it divides $T$ into two regions of equal area. A line intersecting $T$ must intersect two of the three sides of $T$. First consider a line intersecting the segments $AB$ at $X$ and $BC$ at $Y$, and let $BX=x$, $BY=y$. This line is an area equalizer if and only if $xy\\sin B = 2\\operatorname{area}(\\triangle XBY) = \\operatorname{area}(\\triangle ABC) = \\frac{1}{2}ac\\sin B$, that is, $2xy=ac$. Since $x \\leq c$ and $y \\leq a$, the area equalizers correspond to values of $x,y$ with $xy=ac/2$ and $x \\in [c/2,c]$. Such an area equalizer is also an equalizer if and only if $p/2=x+y$, where $p=a+b+c$ is the perimeter of $T$. If we write $f(x) = x+ac/(2x)$, then we want to solve $f(x) = p/2$ for $x \\in [c/2,c]$. Now note that $f$ is convex, $f(c/2) = a+c/2 > p/2$, and $f(c) = a/2+c < p/2$; it follows that there is exactly one solution to $f(x)=p/2$ in $[c/2,c]$.\nSimilarly, for equalizers intersecting $T$ on the sides $AB$ and $AC$, we want to solve $g(x) = p/2$ where $g(x) = x+bc/(2x)$ and $x \\in [c/2,c]$; since $g$ is convex and $g(c/2)<p/2$, $g(c) < p/2$, there are no such solutions.\n\n\nIt follows that if $T$ has exactly two equalizers, then it must have exactly one equalizer intersecting $T$ on the sides $AC$ and $BC$. Here we want to solve $h(x) = p/2$ where $h(x) = x+ab/(2x)$ and $x \\in [a/2,a]$. Now $h$ is convex and $h(a/2) > p/2$, $h(a) > p/2$; thus $h(x) = p/2$ has exactly one solution $x \\in [a/2,a]$ if and only if there is $x_0 \\in [a/2,a]$ with $h'(x_0) = 0$ and $h(x_0) = p/2$. The first condition implies $x_0 = \\sqrt{ab/2}$, and then the second condition gives $8ab = p^2$. Note that $\\sqrt{ab/2}$ is in $[a/2,a]$ since $a>b$ and $a<b+c<2b$.\n\n\nWe conclude that $T$ has two equalizers if and only if $8ab=(a+b+c)^2$. Note that $(a,b,c) = (9,8,7)$ works. We claim that this is the only possibility when $a>b>c$ are integers and $a \\leq 9$. Indeed, the only integers $(a,b)$ such that $2 \\leq b < a \\leq 9$ and $8ab$ is a perfect square are $(a,b) = (4,2)$, $(6,3)$, $(8,4)$, $(9,2)$, and $(9,8)$, and the first four possibilities do not produce triangles since they do not satisfy $a<2b$. This gives the claimed result.", "source_problems": "PUTNAM-2017-problems.tex", "source_solutions": "PUTNAM-2017-solutions.tex", "notes": ""}
{"id": "PUTNAM-2017-B6", "contest": "PUTNAM", "year": "2017", "problem_number": "B6", "problem": "Find the number of ordered $64$-tuples $(x_0,x_1,\\dots,x_{63})$ such that $x_0,x_1,\\dots,x_{63}$ are distinct elements of $\\{1,2,\\dots,2017\\}$ and \n\\[\nx_0 + x_1 + 2x_2 + 3x_3 + \\cdots + 63 x_{63}\n\\]\nis divisible by 2017.\n\\end{itemize}\n\n\\end{document}", "solution": "\\textbf{First solution.}\nThe desired count is $\\frac{2016!}{1953!}- 63! \\cdot 2016$, which we compute using the principle of inclusion-exclusion.\nAs in A2, we use the fact that 2017 is prime; this means that we can do linear algebra over the field $\\mathbb{F}_{2017}$. In particular, every nonzero homogeneous linear equation in $n$ variables over $\\mathbb{F}_{2017}$ has exactly $2017^{n-1}$ solutions.\n\nFor $\\pi$ a partition of $\\{0,\\dots,63\\}$,\nlet $|\\pi|$ denote the number of distinct parts of $\\pi$,\nLet $\\pi_0$ denote the partition of $\\{0,\\dots,63\\}$ into 64 singleton parts.\nLet $\\pi_1$ denote the partition of $\\{0,\\dots,63\\}$ into one 64-element part.\nFor $\\pi, \\sigma$ two partitions of $\\{0,\\dots,63\\}$, write $\\pi | \\sigma$ if $\\pi$ is a refinement of $\\sigma$\n(that is, every part in $\\sigma$ is a union of parts in $\\pi$). By induction on $|\\pi|$, we may construct \na collection of integers $\\mu_\\pi$, one for each $\\pi$, with the properties that\n\\[\n\\sum_{\\pi | \\sigma} \\mu_\\pi = \\begin{cases} 1 & \\sigma = \\pi_0 \\\\ 0 & \\sigma \\neq \\pi_0 \\end{cases}.\n\\]\nDefine the sequence $c_0, \\dots, c_{63}$ by setting $c_0 = 1$ and $c_i = i$ for $i>1$.\nLet $N_\\pi$ be the number of ordered 64-tuples $(x_0,\\dots,x_{63})$ of elements of $\\mathbb{F}_{2017}$\nsuch that  $x_i = x_j$ whenever $i$ and $j$ belong to the same part and\n$\\sum_{i=0}^{63} c_i x_i$ is divisible by 2017. Then $N_\\pi$ equals $2017^{|\\pi|-1}$\nunless for each part $S$ of $\\pi$, the sum $\\sum_{i \\in S} c_i$ vanishes; in that case,\n$N_\\pi$ instead equals $2017^{|\\pi|}$.\nSince $c_0, \\dots, c_{63}$ are positive integers which sum to $1 + \\frac{63 \\cdot 64}{2} = 2017$, the second outcome only occurs for $\\pi = \\pi_1$. By inclusion-exclusion, the desired count may be written as \n\\[\n\\sum_{\\pi} \\mu_\\pi N_\\pi = 2016 \\cdot \\mu_{\\pi_1} + \\sum_{\\pi} \\mu_\\pi 2017^{|\\pi|-1}.\n\\]\nSimilarly, the number of ordered 64-tuples with no repeated elements may be written as\n\\[\n64! \\binom{2017}{64} = \\sum_{\\pi} \\mu_\\pi 2017^{|\\pi|}.\n\\]\nThe desired quantity may thus be written as $\\frac{2016!}{1953!} + 2016 \\mu_{\\pi_1}$.\n\nIt remains to compute $\\mu_{\\pi_1}$. We adopt an approach suggested by David Savitt: apply inclusion-exclusion\nto count distinct 64-tuples in an \\emph{arbitrary} set $A$. As above, this yields\n\\[\n|A|(|A|-1) \\cdots (|A|-63) = \\sum_{\\pi} \\mu_\\pi |A|^{|\\pi|}.\n\\]\nViewing both sides as polynomials in $|A|$ and comparing coefficients in degree 1 yields\n$\\mu_\\pi = -63!$ and thus the claimed answer.\n\n\\noindent\n\\textbf{Second solution.}\n(from Art of Problem Solving, user \\texttt{ABCDE})\nWe first prove an auxiliary result. \n\\begin{lemma*}\nFix a prime $p$ and define the function $f(k)$ on positive integers by the conditions\n\\begin{align*}\nf(1,p) &= 0 \\\\\nf(k,p) &= \\frac{(p-1)!}{(p-k)!} - kf(k-1,p) \\qquad (k>1).\n\\end{align*}\nThen for any positive integers $a_1,\\dots,a_k$ with\n$a_1 + \\cdots + a_k < p$, there are exactly $f(p)$ solutions to the equation $a_1 x_1 + \\cdots + a_k x_k = 0$\nwith $x_1,\\dots,x_k \\in \\mathbb{F}_p$ nonzero and pairwise distinct.\n\\end{lemma*}\n\\begin{proof}\nWe check the claim by induction, with the base case $k=1$ being obvious.\nFor the induction step, assume the claim for $k-1$.\nLet $S$ be the set of $k$-tuples of distinct elements of $\\mathbb{F}_p$;\nit consists of $\\frac{p!}{(p-k)!}$ elements.\nThis set is stable under the action of $i \\in \\mathbb{F}_p$ by translation:\n\\[\n(x_1,\\dots,x_k) \\mapsto (x_1 + i, \\dots, x_k + i).\n\\]\nSince $0 < a_1 \\cdots + a_k < p$, exactly one element of each orbit gives a solution of\n$a_1 x_1 + \\cdots + a_k x_k = 0$. Each of these solutions contributes to $f(k)$ except\nfor those in which $x_i = 0$ for some $i$.\nSince then $x_j \\neq 0$ for all $j \\neq i$, we may apply the induction hypothesis to see that there are\n$f(k-1,p)$ solutions that arise this way for a given $i$ (and these do not overlap).\nThis proves the claim.\n\\end{proof}\n\nTo compute $f(k,p)$ explicitly, it is convenient to work with the auxiliary function\n\\[\ng(k,p) = \\frac{p f(k,p)}{k!};\n\\]\nby the lemma, this satisfies $g(1,p) = 0$ and \n\\begin{align*}\ng(k,p) &= \\binom{p}{k} - g(k-1,p)  \\\\\n&= \\binom{p-1}{k} + \\binom{p-1}{k-1} - g(k-1, p) \\qquad (k>1).\n\\end{align*}\nBy induction on $k$, we deduce that\n\\begin{align*}\ng(k,p) - \\binom{p-1}{k} &= (-1)^{k-1} \\left( g(1,p) - \\binom{p-1}{1} \\right) \\\\\n &= (-1)^k (p-1)\n\\end{align*}\nand hence\n$g(k,p) = \\binom{p-1}{k} + (-1)^k (p-1)$.\n\nWe now set $p=2017$ and count the tuples in question.\nDefine $c_0,\\dots,c_{63}$ as in the first solution. Since $c_0 + \\cdots + c_{63} = p$,\nthe translation action of $\\mathbb{F}_p$ preserves the set of tuples; we may thus assume without loss of generality\nthat $x_0 = 0$ and multiply the count by $p$ at the end. That is, the desired answer is\n\\begin{align*}\n2017 f(63, 2017) &= 63! g(63, 2017) \\\\\n& = 63! \\left( \\binom{2016}{63} - 2016 \\right)\n\\end{align*}\nas claimed.\n\n\\end{itemize}\n\\end{document}", "source_problems": "PUTNAM-2017-problems.tex", "source_solutions": "PUTNAM-2017-solutions.tex", "notes": ""}
{"id": "PUTNAM-2018-A1", "contest": "PUTNAM", "year": "2018", "problem_number": "A1", "problem": "Find all ordered pairs $(a,b)$ of positive integers for which\n\\[\n\\frac{1}{a} + \\frac{1}{b} = \\frac{3}{2018}.\n\\]", "solution": "By clearing denominators and regrouping, we see that the given equation is equivalent to \n\\[\n(3a-2018)(3b-2018) = 2018^2.\n\\]\nEach of the factors is congruent to $1 \\pmod 3$. There are $6$ positive factors of $2018^2 = 2^2 \\cdot 1009^2$ that are congruent to $1 \\pmod 3$: $1$, $2^2$, $1009$, $2^2 \\cdot 1009$, $1009^2$, $2^2 \\cdot 1009^2$. These lead to the $6$ possible pairs: $(a,b) = (673,1358114)$, $(674,340033)$, $(1009,2018)$, $(2018,1009)$, $(340033,674)$, and $(1358114,673)$.\n\nAs for negative factors, the ones that are congruent to $1 \\pmod 3$ are $-2, -2 \\cdot 1009, -2 \\cdot 1009^2$.\nHowever, all of these lead to pairs where $a \\leq 0$ or $b \\leq 0$.", "source_problems": "PUTNAM-2018-problems.tex", "source_solutions": "PUTNAM-2018-solutions.tex", "notes": ""}
{"id": "PUTNAM-2018-A2", "contest": "PUTNAM", "year": "2018", "problem_number": "A2", "problem": "Let $S_1, S_2, \\dots, S_{2^n-1}$ be the nonempty subsets of $\\{1,2,\\dots,n\\}$ in some order, and let\n$M$ be the $(2^n-1) \\times (2^n-1)$ matrix whose $(i,j)$ entry is\n\\[\nm_{ij} = \\begin{cases} 0 & \\mbox{if }S_i \\cap S_j = \\emptyset; \\\\\n1 & \\mbox{otherwise.}\n\\end{cases}\n\\]\nCalculate the determinant of $M$.", "solution": "The answer is $1$ if $n=1$ and $-1$ if $n>1$. Write $M_n$ for a $(2^n-1) \\times (2^n-1)$ matrix of the given form, and note that $\\det M_n$ does not depend on the ordering of the subsets: transposing two subsets has the effect of transposing two rows and then transposing two columns in $M_n$, and this does not change the determinant.\n\nClearly $\\det M_1 = 1$. We claim that for $n>1$, $\\det M_n = -(\\det M_{n-1})^2$, and the desired answer will follow by induction. Let $S_1',\\ldots,S_{2^{n-1}-1}'$ denote the nonempty subsets of $\\{1,\\ldots,n-1\\}$ in any order, with resulting matrix $M_{n-1}$. Let $m_{ij}'$ denote the $(i,j)$ entry of $M_{n-1}$. Now order the nonempty subsets $S_1,\\ldots,S_{2^n-1}$ of $\\{1,\\ldots,n\\}$ as follows: \n\\[\nS_i= \\begin{cases} S_i' &  i \\leq 2^{n-1}-1 \\\\\nS_{i-2^{n-1}+1}' \\cup \\{n\\} & 2^{n-1} \\leq i \\leq 2^n-2 \\\\\n\\{n\\} & i=2^{n}-1.\n\\end{cases}\n\\]\n(For example, if $S_1', \\dots, S_{2^{n-1}-1}'$ are ordered in lexicographic order\nas binary strings, then so are $S_1,\\dots,S_{2^n-1}$.)\nLet $M_n$ be the resulting matrix. Then we have:\n\\[\nM_n = \\left( \\begin{array}{ccc|ccc|c}\n&&&&&& 0 \\\\\n& M_{n-1} &&& M_{n-1} && \\vdots \\\\\n&&&&&& 0 \\\\ \\hline\n&&&1 & \\cdots & 1 & 1 \\\\\n& M_{n-1} && \\vdots & \\ddots & \\vdots & \\vdots \\\\\n&&&1 &\\cdots & 1 & 1 \\\\ \\hline\n0 & \\cdots & 0 & 1 & \\cdots & 1 & 1\n\\end{array} \\right).\n\\]\n\nIn $M_n$, perform the following operations, which do not change the determinant: subtract the final row from rows $2^{n-1}$ through $2^n-2$, and then subtract the final column from columns $2^{n-1}$ through $2^n-2$. The result is the matrix\n\\[\n\\left( \\begin{array}{ccc|ccc|c}\n&&&&&& 0 \\\\\n& M_{n-1} &&& M_{n-1} && \\vdots \\\\\n&&&&&& 0 \\\\ \\hline\n&&&0 & \\cdots & 0 & 0 \\\\\n& M_{n-1} && \\vdots & \\ddots & \\vdots & \\vdots \\\\\n&&&0 &\\cdots & 0 & 0 \\\\ \\hline\n0 & \\cdots & 0 & 0 & \\cdots & 0 & 1\n\\end{array} \\right).\n\\]\n\nWe can remove the final row and column without changing the determinant. Now swap the first $2^{n-1}-1$ rows with the final $2^{n-1}-1$ rows: this changes the determinant by an overall factor of $(-1)^{(2^{n-1}-1)^2} = -1$. The result is the block-diagonal matrix $\\left( \\begin{matrix} M_{n-1} & 0 \\\\ M_{n-1} & M_{n-1} \\end{matrix} \\right)$, whose determinant is $(\\det M_{n-1})^2$. Thus $\\det M_n = -(\\det M_{n-1})^2$ as desired.", "source_problems": "PUTNAM-2018-problems.tex", "source_solutions": "PUTNAM-2018-solutions.tex", "notes": ""}
{"id": "PUTNAM-2018-A3", "contest": "PUTNAM", "year": "2018", "problem_number": "A3", "problem": "Determine the greatest possible value of $\\sum_{i=1}^{10} \\cos(3x_i)$ for real numbers $x_1,x_2,\\dots,x_{10}$\nsatisfying $\\sum_{i=1}^{10} \\cos(x_i) = 0$.", "solution": "The maximum value is $480/49$.\nSince $\\cos(3x_i) = 4 \\cos(x_i)^3 - 3 \\cos(x_i)$, it is equivalent to maximize $4 \\sum_{i=1}^{10} y_i^3$\nfor $y_1,\\dots,y_{10} \\in [-1,1]$ with $\\sum_{i=1}^{10} y_i = 0$; \nnote that this domain is compact, so the maximum value is guaranteed to exist.\nFor convenience, we establish something slightly stronger: we maximize $4 \\sum_{i=1}^{n} y_i^3$\nfor $y_1,\\dots,y_{n} \\in [-1,1]$ with $\\sum_{i=1}^{n} y_i = 0$, where $n$ may be any even nonnegative integer up to $10$,\nand show that the maximum is achieved when $n=10$.\n\nWe first study the effect of varying $y_i$ and $y_j$ while fixing their sum. If that sum is $s$,\nthen the function $y \\mapsto y^3 + (s-y)^3$ has constant second derivative $6s$, so it is either everywhere convex or everywhere concave. Consequently, if $(y_1,\\dots,y_{n})$ achieves the maximum, then for any two indices $i<j$,\nat least one of the following must be true:\n\\begin{itemize}\n\\item one of $y_i$, $y_j$ is extremal (i.e., equal to $1$ or $-1$);\n\\item $y_i = y_j < 0$ (in which case $s<0$ and the local maximum is achieved above);\n\\item $y_i = -y_j$ (in which case $s=0$ above).\n\\end{itemize}\nIn the third case, we may discard $y_i$ and $y_j$ and achieve a case with smaller $n$; we may thus assume that this does not occur. In this case, all of the non-extremal values are equal to some common value $y < 0$, and moreover we cannot have both 1 and -1. We cannot omit 1, as otherwise the condition $\\sum_{i=1}^{n} y_i = 0$ cannot be achieved;\nwe must thus have only the terms 1 and $y$, occurring with some positive multiplicities $a$ and $b$ adding up to $n$. \nSince $a+b=n$ and $a+by = 0$, we can solve for $y$ to obtain $y = -a/b$; we then have\n\\[\n4\\sum_{i=1}^n y_i^3 = a + by^3 = 4a \\left( 1 - \\frac{a^2}{b^2} \\right).\n\\]\nSince $y > -1$, we must have $a < b$. For fixed $a$, the target function increases as $b$ increases,\nso the optimal case must occur when $a+b=10$. The possible pairs $(a,b)$ at this point are\n\\[\n(1,9), (2,8), (3,7), (4,6);\n\\]\ncomputing the target function for these values yields respectively\n\\[\n\\frac{32}{9}, \\frac{15}{2}, \\frac{480}{49}, \\frac{80}{9},\n\\]\nyielding $480/49$ as the maximum value.\n\n\\noindent\n\\textbf{Remark.}\nUsing Lagrange multipliers yields a similar derivation, but with a slight detour required to separate local minima and maxima. For general $n$, the above argument shows that the target function is maximized when $a+b=n$.", "source_problems": "PUTNAM-2018-problems.tex", "source_solutions": "PUTNAM-2018-solutions.tex", "notes": ""}
{"id": "PUTNAM-2018-A4", "contest": "PUTNAM", "year": "2018", "problem_number": "A4", "problem": "Let $m$ and $n$ be positive integers with $\\gcd(m,n) = 1$, and let\n\\[\na_k = \\left\\lfloor \\frac{mk}{n} \\right\\rfloor - \\left\\lfloor \\frac{m(k-1)}{n} \\right\\rfloor\n\\]\nfor $k=1,2,\\dots,n$.\nSuppose that $g$ and $h$ are elements in a group $G$ and that \n\\[\ngh^{a_1} gh^{a_2} \\cdots gh^{a_n} = e,\n\\]\nwhere $e$ is the identity element. Show that $gh= hg$. (As usual, $\\lfloor x \\rfloor$ denotes the greatest integer\nless than or equal to $x$.)", "solution": "\\noindent\n\\textbf{First solution.}\nWe prove the claim by induction on $m+n$.\nFor the base case, suppose that $n=1$; we then have $m=1$ and the given equation becomes $gh=e$. The claim then reduces to the fact that a one-sided inverse in $G$ is also a two-sided inverse. (Because $G$ is a group, $g$ has an inverse $g^{-1}$; since $gh = e$, we have $h = g^{-1}(gh) = g^{-1} e = g^{-1}$, so $hg = e = gh$.)\n\nSuppose now that $n>1$. In case $m>n$, set $\\tilde{g} = g h$, $\\tilde{h} = h$, and\n\\[\nb_k = \\left\\lfloor \\frac{(m-n)k}{n} \\right\\rfloor - \\left\\lfloor \\frac{(m-n)(k-1)}{n} \\right\\rfloor \n\\quad (k=1,\\dots,n).\n\\]\nthen\n\\[\n\\tilde{g} \\tilde{h}^{b_1} \\cdots \\tilde{g} \\tilde{h}^{b_n} = gh^{a_1} \\cdots gh^{a_n} = e,\n\\]\nso the induction hypothesis implies that $\\tilde{g}$ and $\\tilde{h}$ commute; this implies that $g$ and $h$ commute.\n\nIn case $m < n$, note that $a_k \\in \\{0,1\\}$ for all $k$. Set $\\tilde{g} = h^{-1}$, $\\tilde{h} = g^{-1}$, and\n\\[\nb_l = \\left\\lfloor \\frac{n \\ell}{m} \\right\\rfloor - \\left\\lfloor \\frac{n(\\ell-1)}{m} \\right\\rfloor \n\\quad (\\ell=1,\\dots,m);\n\\]\nwe claim that \n\\[\n\\tilde{g}\\tilde{h}^{b_1}\\cdots\\tilde{g}\\tilde{h}^{b_m} = (gh^{a_1}\\cdots gh^{a_n})^{-1} = e,\n\\]\nso the induction hypothesis implies that $\\tilde{h}$ and $\\tilde{g}$ commute; this implies that $g$ and $h$ commute.\n\nTo clarify this last equality, consider a lattice walk starting from $(0,0)$, ending at $(n,m)$, staying below the line\n$y = mx/n$, and keeping as close to this line as possible. If one follows this walk and records the element $g$ for each horizontal step and $h$ for each vertical step, one obtains the word $gh^{a_1}\\cdots gh^{a_n}$. \nNow take this walk, reflect across the line $y = x$, rotate by a half-turn, then translate to put the endpoints at $(0,0)$ and $(m,n)$; this is the analogous walk for the pair $(n,m)$.\n\n\\noindent\n\\textbf{Remark.}\nBy tracing more carefully through the argument, one sees in addition that there exists an element $k$ of $G$\nfor which $g = k^m, h = k^{-n}$.\n\n\\noindent\n\\textbf{Second solution.} (by Greg Martin)\nSince $\\gcd(m,n) = 1$, there exist integers $x,y$ such that $mx + ny = 1$; we may further assume that \n$x \\in \\{1,\\dots,n\\}$. We first establish the identity\n\\[\na_{k-x} = \\begin{cases}\na_k - 1 & \\mbox{if $k \\equiv 0 \\pmod{n}$} \\\\\na_k + 1 & \\mbox{if $k \\equiv 1 \\pmod{n}$} \\\\\na_k & \\mbox{otherwise}.\n\\end{cases}\n\\]\nNamely, by writing $-mx = ny-1$, we see that\n\\begin{align*}\na_{k-x} &= \\left\\lfloor \\frac{m(k-x)}{n} \\right\\rfloor - \\left\\lfloor \\frac{m(k-x-1)}{n} \\right\\rfloor\n\\\\\n&= \\left\\lfloor \\frac{mk+ny-1}{n} \\right\\rfloor - \\left\\lfloor \\frac{m(k-1)+ny-1}{n} \\right\\rfloor \\\\\n&= \\left\\lfloor \\frac{mk-1}{n} \\right\\rfloor - \\left\\lfloor \\frac{m(k-1)-1}{n} \\right\\rfloor\n\\end{align*}\nand so\n\\begin{align*}\na_{k-x} - a_k &= \\left( \\left\\lfloor \\frac{mk-1}{n} \\right\\rfloor - \\left\\lfloor \\frac{mk}{n} \\right\\rfloor \\right)\n\\\\\n&\\quad\n- \\left( \\left\\lfloor \\frac{m(k-1)-1}{n} \\right\\rfloor - \\left\\lfloor \\frac{m(k-1)}{n} \\right\\rfloor \\right).\n\\end{align*}\nThe first parenthesized expression equals 1 if $n$ divides $mk$, or equivalently $n$ divides $k$, and 0 otherwise.\nSimilarly, the second parenthesized expression equals 1 if $n$ divides $k-1$ and 0 otherwise. This proves the stated identity.\n\nWe now use the given relation $g h^{a_1} \\cdots g h^{a_n} = e$ to write\n\\begin{align*}\nghg^{-1}h^{-1} &= gh(h^{a_1} g h^{a_2} \\cdots gh^{a_{n-1}} g h^{a_n})h^{-1} \\\\\n&= gh^{a_1+1} gh^{a_2} \\cdots gh^{a_{n-1}} gh^{a_n-1} \\\\\n&= gh^{a_{1-x}} \\cdots gh^{a_{n-x}} \\\\\n&= (gh^{a_{n+1-x}} \\cdots gh^{a_{n}}) (gh^{a_1} \\cdots gh^{a_{n-x}}).\n\\end{align*}\nThe two parenthesized expressions multiply in the opposite order to $g h^{a_1} \\cdots g h^{a_n} = e$, so they must be\n(two-sided) inverses of each other. We deduce that $ghg^{-1} h^{-1} = e$, meaning that $g$ and $h$ commute.\n\n\\noindent\n\\textbf{Third solution.} (by Sucharit Sarkar)\nLet $T$ denote the torus $\\mathbb{R}^2/\\mathbb{Z}^2$. The line segments from $(0,0)$ to $(1,0)$ and from $(0,0)$ to $(0,1)$ are closed loops in $T$, and we denote them by $g$ and $h$ respectively. Now let $p$ be the (image of the) point $(\\epsilon,-\\epsilon)$ in $T$ for some $0<\\epsilon\\ll 1$. The punctured torus $T \\setminus \\{p\\}$ deformation retracts onto the union of the loops $g$ and $h$, and so $\\pi_1(T\\setminus\\{p\\})$, the fundamental group of $T\\setminus\\{p\\}$ based at $(0,0)$, is the free group on two generators, $\\langle g,h\\rangle$.\n\nLet $\\gamma$ and $\\tilde{\\gamma}$ denote the following loops based at $(0,0)$ in $T$: $\\gamma$ is the image of the line segment from $(0,0)$ to $(n,m)$ under the projection $\\mathbb{R}^2 \\to T$, and $\\tilde{\\gamma}$ is the image of the lattice walk from $(0,0)$ to $(n,m)$, staying just below the line $y=mx/n$, that was described in the first solution. There is a straight-line homotopy with fixed endpoints between the two paths in $\\mathbb{R}^2$ from $(0,0)$ to $(n,m)$, the line segment and the lattice walk, and this homotopy does not pass through any point of the form $(a+\\epsilon,b-\\epsilon)$ for $a,b\\in\\mathbb{Z}$ by the construction of the lattice walk. It follows that $\\gamma$ and $\\tilde{\\gamma}$ are homotopic loops in $T \\setminus \\{p\\}$. Since the class of $\\tilde{\\gamma}$ in $\\pi_1(T\\setminus\\{p\\})$ is evidently $gh^{a_1}gh^{a_2}\\cdots gh^{a_n}$, it follows that the class of $\\gamma$ in $\\pi_1(T\\setminus\\{p\\})$ is the same.\n\nNow since $\\gcd(m,n)=1$, there is an element $\\phi \\in GL_2(\\mathbb{Z})$ sending $(n,m)$ to $(1,0)$, which then sends the line segment from $(0,0)$ to $(n,m)$ to the segment from $(0,0)$ to $(1,0)$. Then $\\phi$ induces a homeomorphism of $T$ sending $\\gamma$ to $g$, which in turn induces an isomorphism $\\phi_* :\\thinspace \\pi_1(T\\setminus \\{p\\}) \\to \\pi_1(T\\setminus \\{\\phi^{-1}(p)\\})$. Both fundamental groups are equal to $\\langle g,h\\rangle$, and we conclude that $\\phi_*$ sends $gh^{a_1}gh^{a_2}\\cdots gh^{a_n}$ to $g$. It follows that $\\phi_*$ induces an isomorphism\n\\[\n\\langle g,h\\,|\\,gh^{a_1}gh^{a_2}\\cdots gh^{a_n} \\rangle \\to \\langle g,h \\,|\\, g\\rangle \\cong \\langle h\\rangle \\cong \\mathbb{Z}.\n\\]\n\nSince $\\mathbb{Z}$ is abelian, $g$ and $h$ must commute in $\\langle g,h\\,|\\,gh^{a_1}gh^{a_2}\\cdots gh^{a_n}\\rangle$, whence they must also commute in $G$.", "source_problems": "PUTNAM-2018-problems.tex", "source_solutions": "PUTNAM-2018-solutions.tex", "notes": ""}
{"id": "PUTNAM-2018-A5", "contest": "PUTNAM", "year": "2018", "problem_number": "A5", "problem": "Let $f: \\mathbb{R} \\to \\mathbb{R}$ be an infinitely differentiable function satisfying $f(0) = 0$, $f(1)= 1$,\nand $f(x) \\geq 0$ for all $x \\in \\mathbb{R}$. Show that there exist a positive integer $n$ and a real number $x$\nsuch that $f^{(n)}(x) < 0$.", "solution": "\\textbf{First solution.}\nCall a function $f\\colon \\mathbb{R} \\to \\mathbb{R}$ \\textit{ultraconvex} if $f$ is infinitely differentiable and $f^{(n)}(x) \\geq 0$ for all $n \\geq 0$ and all $x \\in \\mathbb{R}$, where $f^{(0)}(x) = f(x)$;\nnote that if $f$ is ultraconvex, then so is $f'$.\nDefine the set\n\\[\nS = \\{ f :\\thinspace \\mathbb{R} \\to \\mathbb{R} \\,|\\,f \\text{ ultraconvex and } f(0)=0\\}.\n\\]\nFor $f \\in S$, we must have $f(x) = 0$ for all $x < 0$: if $f(x_0) > 0$ for some $x_0 < 0$, then\nby the mean value theorem there exists $x \\in (0,x_0)$ for which $f'(x) = \\frac{f(x_0)}{x_0} < 0$.\nIn particular, $f'(0) = 0$, so $f' \\in S$ also.\n\nWe show by induction that for all $n \\geq 0$,\n\\[\nf(x) \\leq \\frac{f^{(n)}(1)}{n!} x^n \\qquad (f \\in S, x \\in [0,1]).\n\\]\nWe induct with base case $n=0$, which holds because any $f \\in S$ is nondecreasing. Given the claim for $n=m$,\nwe apply the induction hypothesis to $f' \\in S$ to see that\n\\[\nf'(t) \\leq \\frac{f^{(n+1)}(1)}{n!} t^n \\qquad (t \\in [0,1]),\n\\]\nthen integrate both sides from $0$ to $x$ to conclude.\n\nNow for $f \\in S$, we have $0 \\leq f(1) \\leq \\frac{f^{(n)}(1)}{n!}$ for all $n \\geq 0$. \nOn the other hand, by Taylor's theorem with remainder,\n\\[\nf(x) \\geq \\sum_{k=0}^n \\frac{f^{(k)}(1)}{k!}(x-1)^k \\qquad (x \\geq 1).\n\\]\nApplying this with $x=2$, we obtain $f(2) \\geq \\sum_{k=0}^n \\frac{f^{(k)}(1)}{k!}$ for all $n$;\nthis implies that $\\lim_{n\\to\\infty}  \\frac{f^{(n)}(1)}{n!} = 0$.\nSince $f(1) \\leq \\frac{f^{(n)}(1)}{n!}$, we must have $f(1) = 0$.\n\nFor $f \\in S$, we proved earlier that $f(x) = 0$ for all $x\\leq 0$, as well as for $x=1$. Since\nthe function $g(x) = f(cx)$ is also ultraconvex for $c>0$, we also have $f(x) = 0$ for all $x>0$;\nhence $f$ is identically zero.\n\nTo sum up, if $f\\colon \\mathbb{R} \\to \\mathbb{R}$ is infinitely differentiable, $f(0)=0$, and $f(1) = 1$,\nthen $f$ cannot be ultraconvex. This implies the desired result.\n\n\\noindent\n\\textbf{Variant.}\n(by Yakov Berchenko-Kogan)\nAnother way to show that any $f \\in S$ is identically zero is to show that for $f \\in S$ and $k$ a positive integer,\n\\[\nf(x) \\leq \\frac{x}{k} f'(x) \\qquad (x \\geq 0).\n\\]\nWe prove this by induction on $k$.\nFor the base case $k=1$, note that $f''(x) \\geq 0$ implies that $f'$ is nondecreasing. For $x \\geq 0$, we thus have\n\\[\nf(x) = \\int_0^x f'(t)\\,dt \\leq \\int_0^x f'(x)\\,dt = x f'(x).\n\\]\nTo pass from $k$ to $k+1$, apply the induction hypothesis to $f'$ and integrate by parts to obtain\n\\begin{align*}\nkf(x) &= \\int_0^x k f'(t)\\,dt \\\\\n&\\leq \\int_0^x t f''(t)\\,dt \\\\\n&= xf'(x) - \\int_0^x f'(t)\\,dt = xf'(x) - f(x).\n\\end{align*}\n\n\n\n\\noindent\n\\textbf{Remark.}\nNoam Elkies points out that one can refine the argument to show that\nif $f$ is ultraconvex, then it is analytic (i.e., it is represented by an entire Taylor series about any point, as opposed to a function like $f(x) = e^{-1/x^2}$ whose Taylor series at $0$ is identically zero);\nhe attributes the following argument to \nPeter Shalen. Let $g_n(x) = \\sum_{k=0}^n \\frac{1}{k!} f^{(k})(0) x^k$ be the $n$-th order Taylor polynomial of $f$.\nBy Taylor's theorem with remainder (a/k/a Lagrange's theorem), $f(x) - g_n(x)$ is everywhere nonnegative;\nconsequently, for all $x \\geq 0$, the Taylor series $\\sum_{n=0}^\\infty \\frac{1}{n!} f^{(n)}(0) x^n$\nconverges and is bounded above by $f$. But since $f^{(n+1)}(x)$ is nondecreasing, Lagrange's theorem \nalso implies that $f(x) - g_n(x) \\leq \\frac{1}{(n+1)!} f^{(n+1)}(x)$; for fixed $x \\geq 0$, the right side \ntends to 0 as $n \\to \\infty$. Hence $f$ is represented by its Taylor series for $x \\geq 0$, and so\nis analytic for $x>0$; by replacing $f(x)$ with $f(x-c)$, we may conclude that $f$ is everywhere analytic.\n\n\\noindent\n\\textbf{Remark.}\nWe record some properties of the class of ultraconvex functions.\n\\begin{itemize}\n\\item\nAny nonnegative constant function is ultraconvex. The exponential function is ultraconvex.\n\\item\nIf $f$ is ultraconvex, then $f'$ is ultraconvex. Conversely, if $f'$ is ultraconvex and\n$\\liminf_{x \\to -\\infty} f(x) \\geq 0$, then $f$ is ultraconvex.\n\\item\nThe class of ultraconvex functions is closed under addition, multiplication, and composition.\n\\end{itemize}\n\n\n\\noindent\n\\textbf{Second solution.} (by Zachary Chase)\nIn this solution, we use \\emph{Bernstein's theorem on monotone functions}.\nTo state this result, we say that a function $f: [0, \\infty) \\to \\mathbb{R}$ is \\emph{totally monotone} if\n$f$ is continuous, $f$ is infinitely differentiable on $(0, \\infty)$, and $(-1)^n f^{(n)}(x)$ is nonnegative\nfor all positive integers $n$ and all $x > 0$. For such a function, Bernstein's theorem asserts that there is a nonnegative finite Borel measure $\\mu$ on $[0, \\infty)$ such that\n\\[\nf(x) = \\int_0^\\infty e^{-tx} d\\mu(t) \\qquad (x \\geq 0).\n\\]\nFor $f$ as in the problem statement, \nfor any $M > 0$, the restriction of $f(M-x)$ to $[0, \\infty)$ is totally monotone, so Bernstein's theorem provides a Borel measure $\\mu$ for which $f(M-x) = \\int_0^\\infty e^{-tx} d\\mu(t)$ for all $x \\geq 0$.\nTaking $x = M$, we see that $\\int_0^\\infty e^{-Mt} d\\mu(t) = f(0) = 0$; since $\\mu$ is a nonnegative measure, it must be identically zero. Hence $f(x)$ is identically zero for $x \\leq M$; varying over all $M$, we deduce the desired result.\n\n\\noindent\n\\textbf{Third solution.}\n(from Art of Problem Solving user \\texttt{chronondecay})\nIn this solution, we only consider the behavior of $f$ on $[0,1]$.\nWe first establish the following result.\nLet $f: (0,1) \\to \\mathbb{R}$ be a function such that for each positive integer $n$, $f^{(n)}(x)$ is nonnegative on $(0,1)$, tends to 0 as $x \\to 0^+$, and tends to some limit as $x \\to 1^-$.\nThen for each nonnegative integer $n$, $f(x) x^{-n}$ is nondecreasing on $(0,1)$.\n\nTo prove the claimed result, we proceed by induction on $n$, the case $n=0$ being a consequence of the assumption that $f'(x)$ is nonnegative on $(0,1)$. Given the claim for some $n \\geq 0$, note that\nsince $f'$ also satisfies the hypotheses of the problem, $f'(x) x^{-n}$ is also nondecreasing on $(0,1)$.\nChoose $c \\in (0,1)$ and consider the function\n\\[\ng(x) = \\frac{f'(c)}{c^n} x^n \\qquad (x \\in [0,1)).\n\\]\nFor $x \\in (0,c)$, $f'(x)x^{-n} \\leq f'(c) c^{-n}$, so $f'(x) \\leq g(x)$;\nsimilarly, for $x \\in (c,1)$, $f'(x) \\geq g(x)$. It follows that if $f'(c) > 0$, then\n\\[\n\\frac{\\int_c^1 f'(x)\\,dx}{\\int_0^c f'(x)\\,dx} \\geq \\frac{\\int_c^1 g(x)\\,dx}{\\int_0^c g(x)\\,dx}\n\\Rightarrow\n\\frac{\\int_0^c f'(x)\\,dx}{\\int_0^1 f'(x)\\,dx} \\leq \\frac{\\int_0^c g(x)\\,dx}{\\int_0^1 g(x)\\,dx}\n\\]\nand so $f(c)/f(1) \\leq c^{n+1}$. (Here for convenience, we extend $f$ continuously to $[0,1]$.)\nThat is, $f(c)/c^{n+1} \\leq f(1)$ for all $c \\in (0,1)$.\nFor any $b \\in (0,1)$, we may apply the same logic to the function $f(bx)$ to deduce that\nif $f'(c) > 0$, then $f(bc)/c^{n+1} \\leq f(b)$, or equivalently \n\\[\n\\frac{f(bc)}{(bc)^{n+1}} \\leq \\frac{f(b)}{b^{n+1}}.\n\\]\nThis yields the claim unless $f'$ is identically 0 on $(0,1)$, but in that case the claim is obvious anyway.\n\nWe now apply the claim to show that for $f$ as in the problem statement, it cannot be the case that\n$f^{(n)}(x)$ is nonnegative on $(0,1)$ for all $n$. Suppose the contrary; then for any fixed $x \\in (0,1)$,\nwe may apply the previous claim with arbitrarily large $n$ to deduce that $f(x) = 0$. By continuity, we also then have\n$f(1) = 0$, a contradiction.\n\n\\noindent\n\\textbf{Fourth solution.}\n(by Alexander Karabegov)\nAs in the first solution, we may see that $f^{(n)}(0) = 0$ for all $n$.\nConsequently, for all $n$ we have\n\\[\nf(x) = \\frac{1}{(n-1)!} \\int_0^x (x-t)^{n-1} f^{(n)}(t)\\,dt \\qquad (x \\in \\mathbb{R})\n\\]\nand hence\n\\[\n\\int_0^1 f(x)\\,dx = \\frac{1}{n!} \\int_0^1 (1-t)^n f^{(n)}(t)\\,dt. \n\\]\nSuppose now that $f$ is infinitely differentiable, $f(1) = 1$, and $f^{(n)}(x) \\geq 0$ for all $n$ and all $x \\in [0,1]$. Then\n\\begin{align*}\n\\int_0^1 f(x)\\,dx &= \\frac{1}{n} \\cdot \\frac{1}{(n-1)!} \\int_0^1 (1-t)^n f^{(n)}(t)\\,dt \\\\\n&\\leq \\frac{1}{n} \\cdot \\frac{1}{(n-1)!} \\int_0^1 (1-t)^{n-1} f^{(n)}(t)\\,dt \\\\\n&= \\frac{1}{n} f(1) = \\frac{1}{n}.\n\\end{align*}\nSince this holds for all $n$, we have $\\int_0^1 f(x)\\,dx = 0$, and so $f(x) = 0$ for $x \\in [0,1]$; this yields the desired contradiction.", "source_problems": "PUTNAM-2018-problems.tex", "source_solutions": "PUTNAM-2018-solutions.tex", "notes": ""}
{"id": "PUTNAM-2018-A6", "contest": "PUTNAM", "year": "2018", "problem_number": "A6", "problem": "Suppose that $A,B,C,$ and $D$ are distinct points, no three of which lie on a line,\nin the Euclidean plane. Show\nthat if the squares of the lengths of the line segments $AB$, $AC$, $AD$, $BC$, $BD$, and $CD$\nare rational numbers, then\nthe quotient\n\\[\n\\frac{\\mathrm{area}(\\triangle ABC)}{\\mathrm{area}(\\triangle ABD)}\n\\]\nis a rational number.", "solution": "\\textbf{First solution.}\nChoose a Cartesian coordinate system with origin at the midpoint of $AB$ and positive $x$-axis containing $A$.\nBy the condition on $AB$, we have $A = (\\sqrt{a}, 0)$, $B = (-\\sqrt{a}, 0)$ for some positive rational number $a$.\nLet $(x_1, y_1)$ and $(x_2, y_2)$ be the respective coordinates of $C$ and $D$; by computing the lengths\nof the segments $AC, BC, AD, BD, CD$, we see that the quantities\n\\begin{gather*}\n(x_1 - \\sqrt{a})^2 + y_1^2, \\quad (x_1 + \\sqrt{a})^2 + y_1^2, \\\\\n(x_2 - \\sqrt{a})^2 + y_2^2, \\quad (x_2 + \\sqrt{a})^2 + y_2^2, \\\\\n(x_1 - x_2)^2 + (y_1 - y_2)^2\n\\end{gather*}\nare all rational numbers. By adding and subtracting the first two quantities, and similarly for the next two, we see that the quantities\n\\[\nx_1^2 + y_1^2,\\quad x_1 \\sqrt{a}, \\quad x_2^2 + y_2^2, \\quad x_2 \\sqrt{a}\n\\]\nare rational numbers. Since $a$ is a rational number, so then are\n\\begin{align*}\nx_1^2 &= \\frac{(x_1 \\sqrt{a})^2}{a} \\\\\nx_2^2 &= \\frac{(x_2 \\sqrt{a})^2}{a} \\\\\nx_1x_2 &= \\frac{(x_1 \\sqrt{a})(x_2 \\sqrt{a})}{a} \\\\\ny_1^2 &= (x_1^2 + y_1^2) - x_1^2 \\\\\ny_2^2 &= (x_2^2 + y_2^2) - x_2^2.\n\\end{align*}\nNow note that the quantity\n\\[\n(x_1 - x_2)^2 + (y_1 - y_2)^2 = x_1^2 -2x_1 x_2 + x_2^2 + y_1^2 - 2y_1y_2 + y_2^2\n\\]\nis known to be rational, as is every summand on the right except $-2y_1y_2$; thus $y_1y_2$ is also rational.\nSince $y_1^2$ is also rational, so then is $y_1/y_2 = (y_1y_2)/(y_1^2)$;\nsince\n\\[\n\\mathrm{area}(\\triangle ABC) = \\sqrt{a} y_1, \\qquad \\mathrm{area}(\\triangle ABD) = \\sqrt{a} y_2,\n\\]\nthis yields the desired result.\n\n\n\\noindent\n\\textbf{Second solution.} (by Manjul Bhargava)\nLet $\\mathbf{b},\\mathbf{c}, \\mathbf{d}$ be the vectors $AB, AC, AD$ viewed as column vectors.\nThe desired ratio is given by\n\\begin{align*}\n\\frac{\\det(\\mathbf{b},\\mathbf{c})}{\\det(\\mathbf{b},\\mathbf{d})} &= \\frac{\\det(\\mathbf{b},\\mathbf{c})^T \\det(\\mathbf{b},\\mathbf{c}) }{ \\det(\\mathbf{b},\\mathbf{c})^T\\det(\\mathbf{b},\\mathbf{d})} \\\\\n&= \\det \\begin{pmatrix} \\mathbf{b} \\cdot \\mathbf{b} & \\mathbf{b} \\cdot \\mathbf{c} \\\\\n\\mathbf{c} \\cdot \\mathbf{b} & \\mathbf{c} \\cdot \\mathbf{c}\n\\end{pmatrix}\n\\det \\begin{pmatrix}\n\\mathbf{b} \\cdot \\mathbf{b} & \\mathbf{b} \\cdot \\mathbf{d} \\\\\n\\mathbf{c} \\cdot \\mathbf{b} & \\mathbf{c} \\cdot \\mathbf{d}\n\\end{pmatrix}^{-1}.\n\\end{align*}\n\nThe square of the length of $AB$ is $\\mathbf{b} \\cdot \\mathbf{b}$, so this quantity is rational.\nThe square of the lengths of $AC$ and $BC$ are $\\mathbf{c} \\cdot \\mathbf{c}$ and\n$(\\mathbf{c} - \\mathbf{b}) \\cdot (\\mathbf{c} - \\mathbf{b}) = \\mathbf{b} \\cdot \\mathbf{b} + \\mathbf{c} \\cdot \\mathbf{c}\n- 2 \\mathbf{b} \\cdot \\mathbf{c}$, so $\\mathbf{b} \\cdot \\mathbf{c} = \\mathbf{c} \\cdot \\mathbf{b}$ is rational.\nSimilarly, using $AD$ and $BD$, we deduce that $\\mathbf{d} \\cdot \\mathbf{d}$ and $\\mathbf{b} \\cdot \\mathbf{d}$ is rational; then using $CD$, we deduce that $\\mathbf{c} \\cdot \\mathbf{d}$ is rational.\n\n\\noindent\n\\textbf{Third solution.}\n(by David Rusin)\nRecall that Heron's formula (for the area of a triangle in terms of its side length) admits the following three-dimensional analogue due to Piero della Francesca: if $V$ denotes the volume of a tetrahedron with vertices $A,B,C,D \\in \\mathbb{R}^3$, then\n\\[\n288 V^2 = \\det\n\\begin{pmatrix}\n0 & AB^2 & AC^2 & AD^2 & 1 \\\\\nAB^2 & 0 & BC^2 & BD^2 & 1 \\\\\nAC^2 & BC^2 & 0 & CD^2 & 1 \\\\\nAD^2 & BD^2 & CD^2 & 0 & 1 \\\\\n1 & 1 & 1 & 1 & 0\n\\end{pmatrix}\n\\]\nIn particular, the determinant vanishes if and only if $A,B,C,D$ are coplanar. From the identity\n\\begin{gather*}\n64(4 \\mathrm{Area}(\\triangle ABC)^2 \\mathrm{Area}(\\triangle ABD)^2 - 9 AB^2 V^2) \\\\\n= (AB^4 - AB^2(AC^2 + AD^2 + BC^2 + BD^2 - 2CD^2) \\\\ + (AC^2-BC^2)(AD^2-BD^2))^2\n\\end{gather*}\nwe see that $\\mathrm{Area}(\\triangle ABC) \\mathrm{Area}(\\triangle ABD)$ is rational;\nsince each of the areas has rational square, we deduce the claim.\n\n\\noindent\n\\textbf{Fourth solution.}\n(by Greg Martin)\nDefine the signed angles $\\alpha = \\angle BAC, \\beta = \\angle BAD, \\gamma = \\angle CAD$, so that $\\alpha + \\gamma = \\beta$. By the Law of Cosines,\n\\begin{align*}\n2 AB \\cdot AC \\cos \\alpha &= AB^2 + AC^2 - BC^2 \\in \\mathbb{Q} \\\\\n2  AB \\cdot AD \\cos \\beta &= AB^2 + AD^2 - BD^2 \\in \\mathbb{Q} \\\\\n2  AC \\cdot AD \\cos \\gamma &= AC^2 + AD^2 - CD^2 \\in \\mathbb{Q}.\n\\end{align*}\nIn particular, $(2 AB \\cdot AC \\cos \\alpha)^2 \\in \\mathbb{Q}$, and so\n$\\cos^2 \\alpha \\in \\mathbb{Q}$ and $\\sin^2 \\alpha = 1 - \\cos^2 \\alpha \\in \\mathbb{Q}$,\nand similarly for the other two angles.\n\nApplying the addition formula to $\\cos \\beta$, we deduce that\n\\[\n2  AB \\cdot AD \\cos \\alpha \\cos \\gamma - \n2 AB \\cdot AD \\sin \\alpha \\sin \\gamma \\in \\mathbb{Q}. \n\\]\nThe first of these terms equals\n\\[\n\\frac{(2 AB \\cdot AC \\cos \\alpha)(2 AB \\cdot AC \\cos \\alpha)}{AC^2} \\in \\mathbb{Q},\n\\]\nso the second term must also be rational. But now\n\\begin{align*}\n\\frac{\\mathrm{Area}(\\triangle ABC)}{\\mathrm{Area}(\\triangle ACD)}\n&= \\frac{AB \\cdot AC \\sin \\alpha}{AC \\cdot AD \\sin \\gamma} \\\\\n&= \\frac{2 AB \\cdot AD \\sin \\alpha \\sin \\gamma}{2 AD^2 \\sin^2 \\gamma} \\in \\mathbb{Q}\n\\end{align*}\nas desired.\n\n\\noindent\n\\textbf{Remark.}\nDerek Smith observes that this result\nis Proposition 1 of: M. Knopf, J. Milzman, D. Smith, D. Zhu and D. Zirlin,\nLattice embeddings of planar point sets, \\textit{Discrete and Computational Geometry} \\textbf{56} (2016), 693--710.\n\n\\noindent\n\\textbf{Remark.}\nIt is worth pointing out that it is indeed possible to choose points $A,B,C,D$ satisfying the conditions of the problem;\n one can even ensure that the lengths of all four segments are themselves rational.\nFor example, it was originally observed by Euler that one can find an infinite set of points on the unit circle whose pairwise distances are all rational numbers.\nOne way to see this is to apply the linear fractional transformation $f(z) = \\frac{z+i}{z-i}$ to the Riemann sphere to carry the real axis (plus $\\infty$) to the unit circle, then compute that\n\\[\n\\left| f(z_1) - f(z_2) \\right| = \\frac{2|z_1-z_2||}{|(z_1-i)(z_2-i)|}.\n\\]\nLet $S$ be the set of rational numbers $z$ for which $2(z^2 + 1)$ is a perfect square; the set $f(S)$ has the desired property provided that it is infinite. That can be checked in various ways; for instance, the equation\n$2(x^2+1) = (2y)^2$ equates to $x^2-2y^2 = -1$ (a modified Brahmagupta-Pell equation), which has infinitely many solutions even over the integers:\n\\[\nx + y \\sqrt{2} = (1 + \\sqrt{2})^{2n+1}.\n\\]", "source_problems": "PUTNAM-2018-problems.tex", "source_solutions": "PUTNAM-2018-solutions.tex", "notes": ""}
{"id": "PUTNAM-2018-B1", "contest": "PUTNAM", "year": "2018", "problem_number": "B1", "problem": "Let $\\mathcal{P}$ be the set of vectors defined by\n\\[\n\\mathcal{P} = \\left\\{ \\left. \\begin{pmatrix} a \\\\ b \\end{pmatrix} \\right| 0 \\leq a \\leq 2, 0 \\leq b \\leq 100, \\mbox{ and } a,b \\in \\mathbb{Z} \\right\\}.\n\\]\nFind all $\\mathbf{v} \\in \\mathcal{P}$ such that the set $\\mathcal{P} \\setminus \\{ \\mathbf{v} \\}$ obtained by omitting\nvector $\\mathbf{v}$ from $\\mathcal{P}$ can be partitioned into two sets of equal size and equal sum.", "solution": "The answer is the collection of vectors $(1,b)$ where $0 \\leq b \\leq 100$ and $b$ is even.\n (For ease of typography, we write tuples instead of column vectors.)\n\nFirst we show that if $\\mathcal{P} \\setminus \\{\\mathbf{v}\\}$ can be partitioned into subsets $S_1$ and $S_2$ of equal size and equal sum, then $\\mathbf{v}$ must be of the form $(1,b)$ where $b$ is even. For a finite nonempty set $S$ of vectors in $\\mathbb{Z}^2$, let $\\Sigma(S)$ denote the sum of the vectors in $S$. \nSince the average $x$- and $y$-coordinates in $\\mathcal{P}$ are $1$ and $50$, respectively, and there are $3\\cdot 101$ elements in $\\mathcal{P}$, we have\n\\[\n\\Sigma(P) = 303 \\cdot (1,50) = (303,15150). \n\\]\nOn the other hand, \n\\[\n\\Sigma(P) = \\mathbf{v}+\\Sigma(S_1)+\\Sigma(S_2) = \\mathbf{v}+2\\Sigma(S_1). \n\\]\nBy parity considerations, the entries of $\\mathbf{v}$ must be odd and even, respectively, and thus $\\mathbf{v}$ is of the claimed form.\n\nNext suppose $\\mathbf{v} = (1,b)$ where $b$ is even. Note that $\\mathcal{P} \\setminus \\{(1,50)\\}$ can be partitioned into $151$ pairs of (distinct) vectors $(x,y)$ and $(2-x,100-y)$, each summing to $(2,100)$. If $b \\neq 50$ then three of these pairs are $\\{(1,b),(1,100-b)\\}$,$\\{(2,b),(0,100-b)\\}$, and $\\{(2,25+b/2),(0,75-b/2)\\}$. Of the remaining $148$ pairs, assign half of them to $S_1$ and half to $S_2$, and then complete the partition of $\\mathcal{P} \\setminus \\{\\mathbf{v}\\}$ by assigning $(0,100-b)$, $(2,25+b/2)$, and $(1,50)$ to $S_1$ and $(1,100-b)$, $(2,b)$, and $(0,75-b/2)$ to $S_2$. (Note that the three vectors assigned to each of $S_1$ and $S_2$ have the same sum $(3,175-b/2)$.) By construction, $S_1$ and $S_2$ have the same number of elements, and $\\Sigma(S_1) = \\Sigma(S_2)$.\n\nFor $b=50$, this construction does not work because $(1,b) = (100-b)$, but a slight variation can be made.\n In this case, three of the pairs in $\\mathcal{P} \\setminus \\{(1,50)\\}$ are $\\{(2,50),(0,50)\\}$, $\\{(1,51),(1,49)\\}$, and $\\{(0,49),(2,51)\\}$. Assign half of the other $148$ pairs to $S_1$ and half to $S_2$, and complete the partition of\n$\\mathcal{P} \\setminus \\{(1,50)\\}$ by assigning $(2,50)$, $(1,51)$, and $(0,49)$ to $S_1$ and $(0,50)$, $(1,49)$, and $(2,51)$ to $S_2$.", "source_problems": "PUTNAM-2018-problems.tex", "source_solutions": "PUTNAM-2018-solutions.tex", "notes": ""}
{"id": "PUTNAM-2018-B2", "contest": "PUTNAM", "year": "2018", "problem_number": "B2", "problem": "Let $n$ be a positive integer, and let $f_n(z) = n + (n-1) z + (n-2)z^2 + \\cdots + z^{n-1}$. Prove that\n$f_n$ has no roots in the closed unit disk $\\{z \\in \\mathbb{C}\\colon |z| \\leq 1 \\}$.", "solution": "\\textbf{First solution.}\nNote first that $f_n(1) > 0$, so $1$ is not a root of $f_n$.\nNext, note that\n\\[\n(z-1)f_n(z) = z^n + \\cdots + z - n;\n\\]\nhowever, for $\\left| z \\right| \\leq 1$, we have \n$\\left| z^n + \\cdots + z \\right| \\leq n$ by the triangle inequality;\nequality can only occur if $z,\\dots,z^n$ have norm 1 and the same argument, which only happens for $z=1$.\nThus there can be no root of $f_n$ with $|z| \\leq 1$.\n\n\n\\noindent\n\\textbf{Second solution.}\n(by Karl Mahlburg)\nDefine the polynomial\n\\[\ng_n(z) = nz^{n-1} + \\cdots + 2z + 1\n\\]\nand note that $z^{n-1} g_n(z^{-1}) = f_n(z)$.\nSince $f_n(0) \\neq 0$, to prove the claim it is equivalent to show that $g_n$\nhas no roots in the region $|z| \\geq 1$.\n\nNow note that $g_n(z) = h_n'(z)$ for\n\\[\nh_n(z) = z^n + \\cdots + z + 1,\n\\]\na polynomial with roots $e^{2\\pi ij/(n+1)}$ for $j=0,\\dots,n$.\nBy the Gauss-Lucas theorem, the roots of $g_n$ lie in the convex hull of the roots of $h_n$,\nand moreover cannot be vertices of the convex hull because $h_n$ has no repeated roots.\nThis implies the claim.\n\n\\noindent\n\\textbf{Remark.}\nYet another approach is to use the \\emph{Enestr\\\"om-Kakeya theorem}: if $P_n(z) = a_0 + \\cdots + a_n z^n$\nis a polynomial with real coefficients satisfying $|a_n|  \\geq \\cdots \\geq |a_0| > 0$, then the roots of $P_n(z)$\nall satisfy $|z| \\leq 1$. Namely, applying this to the polynomial $g_n(z/c)$ for \n$c = n/(n-1)$ shows that the roots of $g_n$ all satisfy $\\left|z \\right| \\leq 1/c$. \n\n\\noindent\n\\textbf{Remark.}\nFor a related problem, see problem A5 from the 2014 Putnam competition.", "source_problems": "PUTNAM-2018-problems.tex", "source_solutions": "PUTNAM-2018-solutions.tex", "notes": ""}
{"id": "PUTNAM-2018-B3", "contest": "PUTNAM", "year": "2018", "problem_number": "B3", "problem": "Find all positive integers $n < 10^{100}$ for which simultaneously $n$ divides $2^n$, $n-1$ divides $2^n-1$,\nand $n-2$ divides $2^n - 2$.", "solution": "The values of $n$ with this property are $2^{2^\\ell}$ for $\\ell = 1,2,4,8$.\nFirst, note that $n$ divides $2^n$ if and only if $n$ is itself a power of 2; we may thus write $n = 2^m$ and note that\nif $n<10^{100}$, then\n\\[\n2^m = n < 10^{100} < (10^3)^{34} < (2^{10})^{34} = 2^{340}.\n\\]\nMoreover, the case $m=0$ does not lead to a solution because for $n=1$, $n-1 = 0$ does not divide $2^n-1 = 1$; we \nmay thus assume $1 \\leq m \\leq 340$.\n\nNext, note that modulo $n-1 = 2^m-1$, the powers of $2$ cycle with period $m$ (the terms\n$2^0, \\dots, 2^{m-1}$ remain the same upon reduction, and then the next term repeats the initial 1); consequently,\n$n-1$ divides $2^n-1$ if and only if $m$ divides $n$, which happens if and only if $m$ is a power of 2.\nWrite $m = 2^\\ell$ and note that $2^\\ell < 340 < 512$, so $\\ell < 9$. The case $\\ell=0$ does not lead to a solution because for $n=2$, $n-2 =0$ does not divide $2^n-2 = 2$; we may thus assume $1 \\leq \\ell \\leq 8$.\n\nFinally, note that $n-2 = 2^m-2$ divides $2^n-2$ if and only if $2^{m-1} - 1$ divides $2^{n-1} - 1$.\nBy the same logic as the previous paragraph, this happens if and only if $m-1$ divides $n-1$,\nthat is, if $2^\\ell - 1$ divides $2^m-1$. This in turn happens if and only if $\\ell$ divides $m = 2^\\ell$,\nwhich happens if and only if $\\ell$ is a power of 2. The values allowed by the bound $\\ell < 9$ are\n$\\ell = 1,2,4,8$; for these values, $m \\leq 2^8 = 256$ and\n\\[\nn = 2^m \\leq 2^{256} \\leq (2^3)^{86} < 10^{86} < 10^{100},\n\\]\nso the solutions listed do satisfy the original inequality.", "source_problems": "PUTNAM-2018-problems.tex", "source_solutions": "PUTNAM-2018-solutions.tex", "notes": ""}
{"id": "PUTNAM-2018-B4", "contest": "PUTNAM", "year": "2018", "problem_number": "B4", "problem": "Given a real number $a$, we define a sequence by $x_0 = 1$, $x_1 = x_2 = a$, and $x_{n+1} = 2x_n x_{n-1} - x_{n-2}$ for $n \\geq 2$. Prove that if $x_n = 0$ for some $n$, then the sequence is periodic.", "solution": "We first rule out the case $|a|>1$. In this case, we prove that $|x_{n+1}| \\geq |x_n|$ for all $n$, meaning that we cannot have $x_n = 0$. We proceed by induction; the claim is true for $n=0,1$ by hypothesis. To prove the claim for  $n \\geq 2$, write\n\\begin{align*}\n|x_{n+1}| &= |2x_nx_{n-1}-x_{n-2}| \\\\\n&\\geq 2|x_n||x_{n-1}|-|x_{n-2}| \\\\\n&\\geq |x_n|(2|x_{n-1}|-1) \\geq |x_n|,\n\\end{align*} \nwhere the last step follows from $|x_{n-1}| \\geq |x_{n-2}| \\geq \\cdots \\geq |x_0| = 1$.\n\nWe may thus assume hereafter that $|a|\\leq 1$. We can then write $a = \\cos b$ for some $b \\in [0,\\pi]$. \nLet $\\{F_n\\}$ be the Fibonacci sequence, defined as usual by $F_1=F_2=1$ and $F_{n+1}=F_n+F_{n-1}$. We show by induction that\n\\[\nx_n = \\cos(F_n b) \\qquad (n \\geq 0).\n\\]\nIndeed, this is true for $n=0,1,2$; given that it is true for $n \\leq m$, then\n\\begin{align*}\n2x_mx_{m-1}&=2\\cos(F_mb)\\cos(F_{m-1}b) \\\\\n&= \\cos((F_m-F_{m-1})b)+\\cos((F_m+F_{m-1})b) \\\\\n&= \\cos(F_{m-2}b)+\\cos(F_{m+1}b)\n\\end{align*}\nand so \n$x_{m+1} = 2x_mx_{m-1}-x_{m-2} = \\cos(F_{m+1}b)$. This completes the induction.\n\n\nSince $x_n = \\cos(F_n b)$, if $x_n=0$ for some $n$ then $F_n b = \\frac{k}{2} \\pi$ for some odd integer $k$. In particular, we can write $b = \\frac{c}{d}(2\\pi)$ where $c = k$ and $d = 4F_n$ are integers.\n\n\nLet $x_n$ denote the pair $(F_n,F_{n+1})$, where each entry in this pair is viewed as an element of $\\mathbb{Z}/d\\mathbb{Z}$. Since there are only finitely many possibilities for $x_n$, there must be some $n_2>n_1$ such that $x_{n_1}=x_{n_2}$. Now $x_n$ uniquely determines both $x_{n+1}$ and $x_{n-1}$, and it follows that the sequence $\\{x_n\\}$ is periodic: for $\\ell = n_2-n_1$, $x_{n+\\ell} = x_n$ for all $n \\geq 0$. In particular, $F_{n+\\ell} \\equiv F_n \\pmod{d}$ for all $n$. But then $\\frac{F_{n+\\ell}c}{d}-\\frac{F_n c}{d}$ is an integer, and so\n\\begin{align*}\nx_{n+\\ell} &= \\cos\\left(\\frac{F_{n+\\ell}c}{d}(2\\pi)\\right)\\\\\n& = \\cos\\left(\\frac{F_n c}{d}(2\\pi)\\right) = x_n\n\\end{align*}\nfor all $n$. Thus the sequence $\\{x_n\\}$ is periodic, as desired.\n\n\\noindent\n\\textbf{Remark.}\nKarl Mahlburg points out that one can motivate the previous solution by computing the terms\n\\[\nx_2 = 2a^2 - 1, x_3 = 4a^3 - 3a, x_4 = 16a^5 - 20a^3 + 5a\n\\]\nand recognizing these as the Chebyshev polynomials $T_2, T_3, T_5$. (Note that $T_3$ was used in the solution of\nproblem A3.)\n\n\\noindent\n\\textbf{Remark.}\nIt is not necessary to handle the case $\\left| a \\right| > 1$ separately; the cosine function extends\nto a surjective analytic function on $\\mathbb{C}$ and continues to satisfy the addition formula,\nso one can write $a = \\cos b$ for some $b \\in \\mathbb{C}$\nand then proceed as above.", "source_problems": "PUTNAM-2018-problems.tex", "source_solutions": "PUTNAM-2018-solutions.tex", "notes": ""}
{"id": "PUTNAM-2018-B5", "contest": "PUTNAM", "year": "2018", "problem_number": "B5", "problem": "Let $f = (f_1, f_2)$ be a function from $\\mathbb{R}^2$ to $\\mathbb{R}^2$ with continuous partial derivatives\n$\\frac{\\partial f_i}{\\partial x_j}$ that are positive everywhere. Suppose that\n\\[\n\\frac{\\partial f_1}{\\partial x_1} \\frac{\\partial f_2}{\\partial x_2} - \\frac{1}{4} \\left( \\frac{\\partial f_1}{\\partial x_2}  + \\frac{\\partial f_2}{\\partial x_1} \\right)^2 > 0\n\\]\neverywhere. Prove that $f$ is one-to-one.", "solution": "Let $(a_1,a_2)$ and $(a_1',a_2')$ be distinct points in $\\mathbb{R}^2$; we want to show that $f(a_1,a_2) \\neq f(a_1',a_2')$. Write $(v_1,v_2) = (a_1',a_2')-(a_1,a_2)$, and let $\\gamma(t) = (a_1,a_2)+t(v_1,v_2)$, $t \\in [0,1]$, be the path between $(a_1,a_2)$ and $(a_1',a_2')$. Define a real-valued function $g$ by $g(t) = (v_1,v_2) \\cdot f(\\gamma(t))$.\nBy the Chain Rule, \n\\[\nf'(\\gamma(t)) = \\left( \\begin{matrix} \\partial f_1/\\partial x_1 & \\partial f_1/\\partial x_2 \\\\ \\partial f_2/\\partial x_1 & \\partial f_2/\\partial x_2 \\end{matrix} \\right) \\left(\n\\begin{matrix} v_1 \\\\ v_2 \\end{matrix} \\right). \n\\]\nAbbreviate $\\partial f_i/\\partial x_j$ by $f_{ij}$; then\n\\begin{align*}\ng'(t) &= \\left( \\begin{matrix} v_1 & v_2 \\end{matrix} \\right) \\left( \\begin{matrix} f_{11} & f_{12} \\\\ f_{21} & f_{22} \\end{matrix} \\right) \\left( \\begin{matrix} v_1 \\\\ v_2 \\end{matrix} \\right) \\\\\n&= f_{11} v_1^2 + (f_{12}+f_{21})v_1v_2+f_{22} v_2^2 \\\\\n&= f_{11} \\left(v_1+\\frac{f_{12}+f_{21}}{2f_{11}} v_2 \\right)^2 + \\frac{4f_{11}f_{22}-(f_{12}+f_{21})^2}{4f_{11}} v_2^2 \\\\\n& \\geq 0\n\\end{align*}\nsince $f_{11}$ and $f_{11}f_{22}-(f_{12}+f_{21})^2/4$ are positive by assumption. Since the only way that equality could hold is if $v_1$ and $v_2$ are both $0$, we in fact have $g'(t)>0$ for all $t$. But if $f(a_1,a_2) = f(a_1',a_2')$, then $g(0) = g(1)$, a contradiction.\n\n\\noindent\n\\textbf{Remark.}\nA similar argument shows more generally that $f:\\thinspace \\mathbb{R}^n \\to \\mathbb{R}^n$ is injective if at all points in $\\mathbb{R}^n$, the Jacobian matrix $Df$ satisfies the following property: the quadratic form associated to the bilinear form with matrix $Df$ (or the symmetrized bilinear form with matrix $(Df+(Df)^T)/2$) is positive definite. In the setting of the problem, the symmetrized matrix is\n\\[\n\\left( \\begin{matrix} f_{11} & (f_{12}+f_{21})/2 \\\\ (f_{12}+f_{21})/2 & f_{22} \\end{matrix} \\right),\n\\]\nand this is positive definite if and only if $f_{11}$ and the determinant of the matrix are both positive\n(Sylvester's criterion). Note that the assumptions that $f_{12},f_{21}>0$ are unnecessary for the argument;\nit is also easy to see that the hypotheses $f_{11}, f_{12} > 0$ are also superfluous.\n(The assumption $f_{11}f_{22}-(f_{12}+f_{21})^2 > 0$ implies $f_{11} f_{22} > 0$, so both are nonzero and of the same sign; by continuity, this common sign must be constant over all of $\\mathbb{R}^2$. If it is negative, then\napply the same logic to $(-f_1, -f_2)$.)", "source_problems": "PUTNAM-2018-problems.tex", "source_solutions": "PUTNAM-2018-solutions.tex", "notes": ""}
{"id": "PUTNAM-2018-B6", "contest": "PUTNAM", "year": "2018", "problem_number": "B6", "problem": "Let $S$ be the set of sequences of length $2018$ whose terms  are in the set $\\{1,2,3,4,5,6,10\\}$ and sum to $3860$.\nProve that the cardinality of $S$ is at most\n\\[\n2^{3860} \\cdot \\left( \\frac{2018}{2048} \\right)^{2018}.\n\\]\n\n\\end{itemize}\n\n\\end{document}", "solution": "(by Manjul Bhargava)\nLet $a(k,n)$ denote the number of sequences of length $k$ taken from the set $\\{1,2,3,4,5,6,10\\}$ and having sum $n$.\nWe prove that \n\\[\na(k,n) < 2^n \\left( \\frac{2018}{2048} \\right)^k\n\\]\nby double induction on $n+k$ and $n-k$.  The claim is clearly true when $n-k \\leq 0$ and in particular when $n=k=1$, the smallest case for $n+k$.\n\nWe categorize the sequences counted by $a(k,n)$ by whether they end in $1,2,3,4,5,6,10$; removing the last\nterm of such a sequence yields a sequence counted by $a(k-1,n-1), a(k-1,n-2), a(k-1,n-3), a(k-1,n-4), a(k-1,n-5), a(k-1,n-6), a(k-1,n-10)$, respectively.  Therefore,\n\\begin{align*}\na(k,n) &= a(k-1,n-1) + \\cdots \\\\\n&\\quad + a(k-1,n-6) + a(k-1,n-10) \\\\\n&< (  2^{n-1} + \\cdots +   2^{n-6}  +  2^{n-10} ) \\left( \\frac{2018}{2048} \\right)^{k-1} \\\\\n&= 2^n \\left( \\frac{1}{2} + \\cdots + \\frac{1}{64} + \\frac{1}{1024} \\right) \\left( \\frac{2018}{2048} \\right)^{k-1} \\\\\n&= 2^n \\left( \\frac{1009}{1024} \\right) \\left( \\frac{2018}{2048} \\right)^{k-1} \\\\\n&= 2^n \\left( \\frac{2018}{2048} \\right)^{k}\n\\end{align*}\nwhere we used directly the induction hypothesis to obtain the inequality on the second line.\nThe case $k=2018, n=3860$ yields the desired result.\n\n\\noindent\n\\textbf{Remark.}\nK. Soundararajan suggests the following reinterpretation of this argument. The quantity $a(k,n)$ can be interpreted as the coefficient of $x^n$ in $(x + x^2 + \\cdots + x^6 + x^{10})^k$. Since this polynomial has nonnegative coefficients, \nfor any $x$, we have\n\\[\na(k,n) x^n < (x + x^2 + \\cdots + x^6 + x^{10})^k.\n\\]\nSubstituting $x = \\frac{1}{2}$ yields the bound stated above.\n\nOn a related note, Alexander Givental suggests that the value $n=3860$ (which is otherwise irrelevant to the problem) may have been chosen for the following reason: as a function of $x$, the upper bound $x^{-n} (x+x^2 + \\cdots + x^6 + x^{10})^k$\nis minimized when\n\\[\n\\frac{x(1 + 2x + \\cdots + 6x^5 + x^9)}{x + x^2 + \\cdots + x^6 + x^{10}} = \\frac{n}{k}.\n\\]\nIn order for this to hold for $x = 1/2$, $k=2018$, one must take $n = 3860$.\n\n\\noindent\n\\textbf{Remark.}\nFor purposes of comparison, the stated bound is about $10^{1149}$, while the trivial upper bound\ngiven by counting all sequences of length 2018 of positive integers that sum to 3860 is\n\\[\n\\binom{3859}{2017} \\sim 10^{1158}.\n\\]\nThe latter can be easily derived by a ``stars and bars'' argument: visualize each sequence of this form by representing the value $n$ by $n$ stars and inserting a bar between adjacent terms of the sequence. The resulting string of symbols consists of one star at the beginning, 2017 bar-star combinations, and 3860-2018 more stars.\n\nUsing a computer, it is practical to compute the exact cardinality of $S$ by finding the coefficient of $x^{3860}$ in\n$(x + x^2 + \\cdots + x^6 + x^{10})^{2018}$. For example, this can be done in \\texttt{Sage} in a couple of seconds as follows. (The truncation is truncated modulo $x^{4000}$ for efficiency.)\n\n\\begin{verbatim}\nsage: P.<x> = PowerSeriesRing(ZZ, 4000)\nsage: f = (x + x^2 + x^3 + x^4 + \\\n....:      x^5 + x^6 + x^10)^2018\nsage: m = list(f)[3860]\nsage: N(m)\n8.04809122940636e1146\n\\end{verbatim}\n\nThis computation shows that the upper bound of the problem differs from the true value by a factor of about 150.\n\n\n\\end{itemize}\n\\end{document}", "source_problems": "PUTNAM-2018-problems.tex", "source_solutions": "PUTNAM-2018-solutions.tex", "notes": ""}
{"id": "PUTNAM-2019-A1", "contest": "PUTNAM", "year": "2019", "problem_number": "A1", "problem": "Determine all possible values of the expression\n\\[\nA^3+B^3+C^3-3ABC\n\\]\nwhere $A, B$, and $C$ are nonnegative integers.", "solution": "The answer is all nonnegative integers not congruent to $3$ or $6 \\pmod{9}$. Let $X$ denote the given expression;\nwe first show that we can make $X$ equal to each of the claimed values. Write $B=A+b$ and $C=A+c$, so that\n\\[\nX = (b^2-bc+c^2)(3A+b+c).\n\\]\nBy taking $(b,c) = (0,1)$ or $(b,c) = (1,1)$, we obtain respectively $X = 3A+1$ and $X = 3A+2$; consequently, as $A$ varies, we achieve every nonnegative integer not divisible by 3. By taking $(b,c) = (1,2)$, we obtain $X = 9A+9$; consequently, as $A$ varies, we achieve every positive integer divisible by 9. We may also achieve $X=0$\nby taking $(b,c) = (0,0)$.\n\nIn the other direction, $X$ is always nonnegative: either apply the arithmetic mean-geometric mean inequality, or write $b^2-bc+c^2 = (b - c/2)^2 + 3c^2/4$ to see that it is nonnegative.\nIt thus only remains to show that if $X$ is a multiple of $3$, then it is a multiple of $9$. Note that\n$3A+b+c \\equiv b+c \\pmod{3}$ and $b^2-bc+c^2 \\equiv (b+c)^2 \\pmod{3}$; consequently, if $X$ is divisible by $3$,\nthen $b+c$ must be divisible by $3$, so each factor in $X = (b^2-bc+c^2)(3A+b+c)$ is divisible by $3$.\nThis proves the claim.\n\n\\noindent\n\\textbf{Remark.}\nThe factorization of $X$ used above can be written more symmetrically as\n\\[\nX = (A+B+C)(A^2+B^2+C^2-AB-BC-CA).\n\\]\nOne interpretation of the factorization is that $X$ is the determinant of the circulant matrix\n\\[\n\\begin{pmatrix}\nA & B & C \\\\\nC & A & B \\\\\nB & C & A\n\\end{pmatrix}\n\\]\nwhich has the vector $(1,1,1)$ as an eigenvector (on either side) with eigenvalue $A+B+C$. The other eigenvalues are $A + \\zeta B + \\zeta^2 C$ where $\\zeta$ is a primitive cube root of unity; in fact, $X$ is the norm form for the ring $\\ZZ[T]/(T^3 - 1)$, from which it follows directly that the image of $X$ is closed under multiplication. (This is similar to the fact that the image of $A^2+B^2$, which is the norm form for the ring $\\mathbb{Z}[i]$ of Gaussian integers, is closed under multiplication.)\n\nOne can also the unique factorization property of the ring $\\ZZ[\\zeta]$ of Eisenstein integers as follows.\nThe three factors of $X$ over $\\ZZ[\\zeta_3]$ are pairwise congruent modulo $1-\\zeta_3$; consequently,\nif $X$ is divisible by 3, then it is divisible by $(1-\\zeta_3)^3 = -3\\zeta_3(1-\\zeta_3)$ and hence \n(because it is a rational integer) by $3^2$.", "source_problems": "PUTNAM-2019-problems.tex", "source_solutions": "PUTNAM-2019-solutions.tex", "notes": ""}
{"id": "PUTNAM-2019-A2", "contest": "PUTNAM", "year": "2019", "problem_number": "A2", "problem": "In the triangle $\\triangle ABC$, let $G$ be the centroid, and let $I$ be the center of the inscribed circle.\nLet $\\alpha$ and $\\beta$ be the angles at the vertices $A$ and $B$, respectively.\nSuppose that the segment $IG$ is parallel to $AB$ and that $\\beta = 2 \\tan^{-1} (1/3)$. Find $\\alpha$.", "solution": "\\noindent \\textbf{Solution 1.}\nLet $M$ and $D$ denote the midpoint of $AB$ and the foot of the altitude from $C$ to $AB$, respectively, and let $r$ be the inradius of $\\bigtriangleup ABC$. Since $C,G,M$ are collinear with $CM = 3GM$, the distance from $C$ to line $AB$ is $3$ times the distance from $G$ to $AB$, and the latter is $r$ since $IG \\parallel AB$; hence the altitude $CD$ has length $3r$. By the double angle formula for tangent, $\\frac{CD}{DB} = \\tan\\beta = \\frac{3}{4}$, and so $DB = 4r$. Let $E$ be the point where the incircle meets $AB$; then $EB = r/\\tan(\\frac{\\beta}{2}) = 3r$. It follows that $ED = r$, whence the incircle is tangent to the altitude $CD$. This implies that $D=A$, $ABC$ is a right triangle, and $\\alpha = \\frac{\\pi}{2}$.\n\n\\noindent\n\\textbf{Remark.}\nOne can obtain a similar solution by fixing a coordinate system with $B$ at the origin and $A$ on the positive \n$x$-axis. Since $\\tan \\frac{\\beta}{2} = \\frac{1}{3}$, we may assume without loss of generality that\n$I = (3,1)$. Then $C$ lies on the intersection of the line $y=3$ (because $CD = 3r$ as above) \nwith the line $y = \\frac{3}{4} x$ (because $\\tan \\beta = \\frac{3}{4}$ as above), forcing $C = (4,3)$ and so forth.\n\n\\noindent \\textbf{Solution 2.}\nLet $a,b,c$ be the lengths of $BC,CA,AB$, respectively.\nLet $r$, $s$, and $K$ denote the inradius, semiperimeter, and area of $\\triangle ABC$. \nBy Heron's Formula,\n\\[\nr^2s^2 = K^2 = s(s-a)(s-b)(s-c).\n\\]\n\nIf $IG$ is parallel to $AB$, then \n\\[\n\\frac{1}{2} rc = \n\\mathrm{area}(\\triangle ABI) = \\mathrm{area}(\\triangle ABG) = \\frac{1}{3} K = \\frac{1}{3} rs\n\\]\nand so $c = \\frac{a+b}{2}$. Since $s = \\frac{3(a+b)}{4}$ and $s-c = \\frac{a+b}{4}$, we have \n$3r^2 = (s-a)(s-b)$. Let $E$ be the point at which the incircle meets $AB$; then $s-b = EB = r/\\tan(\\frac{\\beta}{2})$ and $s-a = EA = r/\\tan(\\frac{\\alpha}{2})$. It follows that $\\tan(\\frac{\\alpha}{2})\\tan(\\frac{\\beta}{2}) = \\frac{1}{3}$ and so $\\tan(\\frac{\\alpha}{2}) = 1$. This implies that $\\alpha = \\frac{\\pi}{2}$.\n\n\\noindent\n\\textbf{Remark.}\nThe equality $c = \\frac{a+b}{2}$ can also be derived from the vector representations\n\\[\nG = \\frac{A+B+C}{3}, \\qquad I = \\frac{aA+bB+cC}{a+b+c}.\n\\]\n\n\n\\noindent\n\\textbf{Solution 3.}\n(by Catalin Zara)\nIt is straightforward to check that a right triangle with $AC = 3, AB = 4, BC = 5$ works. For example,\nin a coordinate system with $A = (0,0), B = (4,0), C = (0,3)$, we have\n\\[\nG = \\left(\\frac{4}{3}, 1 \\right), \\qquad \nI = (1, 1)\n\\]\nand for $D = (1,0)$, \n\\[\n\\tan \\frac{\\beta}{2} = \\frac{ID}{BD} = \\frac{1}{3}.\n\\]\nIt thus suffices to suggest that this example is unique up to similarity.\n\nLet $C'$ be the foot of the angle bisector at $C$. Then \n\\[\n\\frac{CI}{IC'} = \\frac{CA + CB}{AB}\n\\] \nand so $IG$ is parallel to $AB$ if and only if $CA + CB = 2AB$. We may assume without loss of generality that $A$ and $B$ are fixed, in which case this condition restricts $C$ to an ellipse with foci at $A$ and $B$.\nSince the angle $\\beta$ is also fixed, up to symmetry \n$C$ is further restricted to a half-line starting at $B$; this intersects the ellipse in a unique point.\n\n\\noindent \n\\textbf{Remark.}\nGiven that $CA + CB = 2AB$, one can also recover the ratio of side lengths using the law of cosines.", "source_problems": "PUTNAM-2019-problems.tex", "source_solutions": "PUTNAM-2019-solutions.tex", "notes": ""}
{"id": "PUTNAM-2019-A3", "contest": "PUTNAM", "year": "2019", "problem_number": "A3", "problem": "Given real numbers $b_0, b_1, \\dots, b_{2019}$ with $b_{2019} \\neq 0$, let $z_1,z_2,\\dots,z_{2019}$ be \nthe roots in the complex plane of the polynomial \n\\[\nP(z) = \\sum_{k=0}^{2019} b_k z^k.\n\\]\nLet $\\mu = (|z_1| + \\cdots + |z_{2019}|)/2019$ be the average of the distances from $z_1,z_2,\\dots,z_{2019}$ to the origin. Determine the largest constant $M$ such that $\\mu \\geq M$ for all choices of $b_0,b_1,\\dots, b_{2019}$ that satisfy\n\\[\n1 \\leq b_0 < b_1 < b_2 < \\cdots < b_{2019} \\leq 2019.\n\\]", "solution": "The answer is $M = 2019^{-1/2019}$. For any choices of $b_0,\\ldots,b_{2019}$ as specified, AM-GM gives\n\\[\n\\mu \\geq |z_1\\cdots z_{2019}|^{1/2019} = |b_0/b_{2019}|^{1/2019} \\geq 2019^{-1/2019}.\n\\]\nTo see that this is best possible, consider $b_0,\\ldots,b_{2019}$ given by $b_k = 2019^{k/2019}$ for all $k$. Then \n\\[\nP(z/2019^{1/2019}) = \\sum_{k=0}^{2019} z^k = \\frac{z^{2020}-1}{z-1}\n\\]\nhas all of its roots on the unit circle. It follows that all of the roots of $P(z)$ have modulus $2019^{-1/2019}$, and so $\\mu = 2019^{-1/2019}$ in this case.", "source_problems": "PUTNAM-2019-problems.tex", "source_solutions": "PUTNAM-2019-solutions.tex", "notes": ""}
{"id": "PUTNAM-2019-A4", "contest": "PUTNAM", "year": "2019", "problem_number": "A4", "problem": "Let $f$ be a continuous real-valued function on $\\mathbb{R}^3$. Suppose that for every sphere $S$ of radius 1,\nthe integral of $f(x,y,z)$ over the surface of $S$ equals 0. Must $f(x,y,z)$ be identically 0?", "solution": "The answer is no. Let $g :\\thinspace \\mathbb{R} \\to \\mathbb{R}$ be any continuous function with $g(t+2) = g(t)$ for all $t$ and $\\int_0^2 g(t)\\,dt = 0$ (for instance, $g(t) = \\sin(\\pi t)$). Define $f(x,y,z) = g(z)$. We claim that for any sphere $S$ of radius $1$, $\\iint_S f\\,dS = 0$.\n\n\nIndeed, let $S$ be the unit sphere centered at $(x_0,y_0,z_0)$. We can parametrize $S$ by $S(\\phi,\\theta) = (x_0,y_0,z_0)+(\\sin\\phi\\cos\\theta,\n\\sin\\phi\\sin\\theta,\\cos\\phi)$ for $\\phi \\in [0,\\pi]$ and $\\theta \\in [0,2\\pi]$. Then we have\n\n\\begin{align*}\n\\iint_S f(x,y,z)\\,dS &= \\int_0^\\pi \\int_0^{2\\pi} f(S(\\phi,\\theta))\\left\\|\\frac{\\partial S}{\\partial \\phi} \\times \\frac{\\partial S}{\\partial \\theta}\\right\\|\\,d\\theta\\,d\\phi \\\\\n&=  \\int_0^\\pi \\int_0^{2\\pi} g(z_0+\\cos\\phi) \\sin\\phi\\,d\\theta\\,d\\phi \\\\\n&= 2\\pi \\int_{-1}^1 g(z_0+t)\\,dt,\n\\end{align*}\n\nwhere we have used the substitution $t = \\cos\\phi$; but this last integral is $0$ for any $z_0$ by construction.\n\n\\noindent\n\\textbf{Remark.}\nThe solution recovers the famous observation of Archimedes that the surface area of a spherical cap is linear in the height of the cap. In place of spherical coordinates, one may also compute $\\iint_S f(x,y,z)\\,dS$ by computing the integral over a ball of radius $r$, then computing the derivative with respect to $r$ and evaluating at $r=1$.\n\nNoam Elkies points out that a similar result holds in $\\mathbb{R}^n$ for any $n$. Also, there exist nonzero continuous functions on $\\mathbb{R}^n$ whose integral over any unit ball vanishes; this implies certain negative results about image reconstruction.", "source_problems": "PUTNAM-2019-problems.tex", "source_solutions": "PUTNAM-2019-solutions.tex", "notes": ""}
{"id": "PUTNAM-2019-A5", "contest": "PUTNAM", "year": "2019", "problem_number": "A5", "problem": "Let $p$ be an odd prime number, and let $\\mathbb{F}_p$ denote the field of integers modulo $p$. Let $\\mathbb{F}_p[x]$ be the ring of polynomials over $\\mathbb{F}_p$, and let $q(x) \\in \\mathbb{F}_p[x]$ be given by \n\\[\nq(x) = \\sum_{k=1}^{p-1} a_k x^k,\n\\]\nwhere\n\\[\na_k = k^{(p-1)/2} \\mod{p}. \n\\]\nFind the greatest nonnegative integer $n$ such that $(x-1)^n$ divides $q(x)$ in $\\mathbb{F}_p[x]$.", "solution": "The answer is $\\frac{p-1}{2}$. \nDefine the operator $D = x \\frac{d}{dx}$, where $\\frac{d}{dx}$ indicates formal differentiation of polynomials.\nFor $n$ as in the problem statement, we have $q(x) = (x-1)^n r(x)$ for some polynomial $r(x)$ in $\\mathbb{F}_p$ not divisible by $x-1$. For $m=0,\\dots,n$, by the product rule we have\n\\[\n(D^m q)(x) \\equiv n^m x^m (x-1)^{n-m} r(x) \\pmod{(x-1)^{n-m+1}}.\n\\]\nSince $r(1) \\neq 0$ and $n \\not\\equiv 0 \\pmod{p}$ (because $n \\leq \\deg(q) = p-1$), we may identify $n$ as the smallest nonnegative integer for which $(D^n q)(1) \\neq 0$.\n\nNow note that $q = D^{(p-1)/2} s$ for\n\\[\ns(x) = 1 + x + \\cdots + x^{p-1} = \\frac{x^p-1}{x-1} = (x-1)^{p-1}\n\\]\nsince $(x-1)^p = x^p-1$ in $\\mathbb{F}_p[x]$.\nBy the same logic as above, $(D^n s)(1) = 0$ for $n=0,\\dots,p-2$ but not for $n=p-1$.\nThis implies the claimed result.\n\n\\noindent\n\\textbf{Remark.}\nOne may also finish by checking directly that \nfor any positive integer $m$,\n\\[\n\\sum_{k=1}^{p-1} k^m \\equiv \\begin{cases} -1 \\pmod{p} & \\mbox{if $(p-1)|m$} \\\\\n0 \\pmod{p} & \\mbox{otherwise.}\n\\end{cases}\n\\]\nIf $(p-1) | m$, then $k^m \\equiv 1 \\pmod{p}$ by the little Fermat theorem, and so the sum is congruent\nto $p-1 \\equiv -1 \\pmod{p}$. Otherwise, for any primitive root $\\ell$ mod $p$, multiplying the sum by $\\ell^m$ permutes the terms modulo $p$ and hence does not change the sum modulo $p$; since $\\ell^n \\not\\equiv 1 \\pmod{p}$, this is only possible if the sum is zero modulo $p$.", "source_problems": "PUTNAM-2019-problems.tex", "source_solutions": "PUTNAM-2019-solutions.tex", "notes": ""}
{"id": "PUTNAM-2019-A6", "contest": "PUTNAM", "year": "2019", "problem_number": "A6", "problem": "Let $g$ be a real-valued function that is continuous on the closed interval $[0,1]$ and twice differentiable on \nthe open interval $(0,1)$. Suppose that for some real number $r>1$, \n\\[\n\\lim_{x \\to 0^+} \\frac{g(x)}{x^r} = 0.\n\\]\nProve that either\n\\[\n\\lim_{x \\to 0^+} g'(x) = 0 \\qquad \\mbox{or} \\qquad \\limsup_{x \\to 0^+} x^r |g''(x)| = \\infty.\n\\]", "solution": "\\textbf{Solution 1.}\n(by Harm Derksen)\nWe assume that $\\limsup_{x \\to 0^+} x^r |g''(x)| < \\infty$\nand deduce that $\\lim_{x \\to 0^+} g'(x) = 0$.\nNote that\n\\[\n\\limsup_{x \\to 0^+} x^r \\sup\\{| g''(\\xi)|: \\xi \\in [x/2, x]\\}\n< \\infty.\n\\]\nSuppose for the moment that there exists a function $h$ on $(0,1)$ which is positive, nondecreasing, and satisfies\n\\[\n\\lim_{x \\to 0^+} \\frac{g(x)}{h(x)} = \\lim_{x \\to 0^+} \\frac{h(x)}{x^r} = 0.\n\\]\nFor some $c>0$, $h(x) < x^r < x$ for $x \\in (0,c)$. By Taylor's theorem with remainder, we can find a function $\\xi$ on $(0,c)$ such that\n$\\xi(x) \\in [x-h(x),x]$ and\n\\[\ng(x-h(x)) = g(x) - g'(x) h(x) + \\frac{1}{2} g''(\\xi(x)) h(x)^2.\n\\]\nWe can thus express $g'(x)$ as\n\\[\n\\frac{g(x)}{h(x)} + \\frac{1}{2} x^r g''(\\xi(x)) \\frac{h(x)}{x^r}\n-  \\frac{g(x-h(x))}{h(x-h(x))} \\frac{h(x-h(x))}{h(x)}.\n\\]\nAs $x \\to 0^+$, $g(x)/h(x)$, $g(x-h(x))/h(x-h(x))$, and\n$h(x)/x^r$ tend to 0, while $x^r g''(\\xi(x))$ remains bounded\n(because $\\xi(x) \\geq x-h(x) \\geq x - x^r \\geq x/2$ for $x$ small)\nand $h(x-h(x))/h(x)$ is bounded in $(0,1]$.\nHence $\\lim_{x \\to 0^+} g'(x) = 0$ as desired.\n\nIt thus only remains to produce a function $h$ with the desired properties; this amounts to ``inserting'' a function between $g(x)$ and $x^r$ while taking care to ensure the positive and nondecreasing properties.\nOne of many options is $h(x) = x^r \\sqrt{f(x)}$ where\n\\[\nf(x) = \\sup\\{|z^{-r} g(z)|: z \\in (0,x)\\},\n\\]\nso that\n\\[\n\\frac{h(x)}{x^r} = \\sqrt{f(x)}, \\qquad \\frac{g(x)}{h(x)} = \\sqrt{f(x)} x^{-r} g(x).\n\\]\n\n\\noindent\n\\textbf{Solution 2.}\nWe argue by contradiction. Assume that $\\limsup_{x\\to 0^+} x^r|g''(x)|<\\infty$, so that there is an $M$ such that $|g''(x)| < M x^{-r}$ for all $x$; and that $\\lim_{x\\to 0^+} g'(x) \\neq 0$, so that there is an $\\epsilon_0>0$ and a sequence $x_n\\to 0$ with $|g'(x_n)| > \\epsilon_0$ for all $n$.\n\nNow let $\\epsilon>0$ be arbitrary. Since $\\lim_{x\\to 0^+} g(x) x^{-r} = 0$, there is a $\\delta>0$ for which $|g(x)|<\\epsilon x^r$ for all $x<\\delta$.\nChoose $n$ sufficiently large that $\\frac{\\epsilon_0 x_n^r}{2M}<x_n$ and $x_n < \\delta/2$; then $x_n+\\frac{\\epsilon_0 x_n^r}{2M} < 2 x_n < \\delta$. In addition,\nwe have $|g'(x)| > \\epsilon_0/2$ for all $x\\in [x_n,x_n+\\frac{\\epsilon_0 x_n^r}{2M}]$ since $|g'(x_n)| > \\epsilon_0$ and $|g''(x)| < Mx^{-r} \\leq M x_n^{-r}$ in this range. It follows that\n\\begin{align*}\n\\frac{\\epsilon_0^2}{2} \\frac{x_n^r}{2M} &<\n|g(x_n+\\frac{\\epsilon_0 x_n^r}{2M}) - g(x_n)| \\\\\n&\\leq |g(x_n+\\frac{\\epsilon_0 x_n^r}{2M})|+|g(x_n)| \\\\\n&< \\epsilon \\left((x_n+\\frac{\\epsilon_0 x_n^r}{2M})^r+x_n^r\\right) \\\\\n&< \\epsilon(1+2^r)x_n^r,\n\\end{align*}\nwhence $4M(1+2^r)\\epsilon > \\epsilon_0^2$. Since $\\epsilon>0$ is arbitrary and $M,r,\\epsilon_0$ are fixed, this gives the desired contradiction.\n\n\n\\noindent\n\\textbf{Remark.}\nHarm Derksen points out that the ``or'' in the problem need not be exclusive. For example, take\n\\[\ng(x) = \\begin{cases} x^5\\sin(x^{-3}) & x \\in (0,1] \\\\\n0 & x = 0.\n\\end{cases}\n\\]\nThen for $x \\in (0,1)$,\n\\begin{align*}\ng'(x) &= 5x^4\\sin(x^{-3})-3x\\cos(x^{-3}) \\\\\ng''(x) &=(20x^3-9x^{-3})\\sin(x^{-3})-18\\cos(x^{-3}).\n\\end{align*}\nFor $r=2$, $\\lim_{x\\to 0^+}x^{-r}g(x)=\\lim_{x\\to 0^+}x^3\\sin(x^{-3})=0$, $\\lim_{x\\to 0^+}g'(x)=0$ and\n$x^rg''(x)=(20x^5-9x^{-1})\\sin(x^{-3})-18x^2\\cos(x^{-3})$ is unbounded as $x\\to 0^+$.\n(Note that $g'(x)$ is not differentiable at $x=0$.)", "source_problems": "PUTNAM-2019-problems.tex", "source_solutions": "PUTNAM-2019-solutions.tex", "notes": ""}
{"id": "PUTNAM-2019-B1", "contest": "PUTNAM", "year": "2019", "problem_number": "B1", "problem": "Denote by $\\mathbb{Z}^2$ the set of all points $(x,y)$ in the plane with integer coordinates. For each integer $n \\geq 0$, let $P_n$ be the subset of $\\mathbb{Z}^2$ consisting of the point $(0,0)$ together with all points $(x,y)$ such that $x^2 + y^2 = 2^k$ for some integer $k \\leq n$. Determine, as a function of $n$, the number of four-point subsets of $P_n$ whose elements are the vertices of a square.", "solution": "The answer is $5n+1$.\n\nWe first determine the set $P_n$. Let $Q_n$ be the set of points in $\\mathbb{Z}^2$ of the form $(0, \\pm 2^k)$ or $(\\pm 2^k, 0)$ for some $k \\leq n$. Let $R_n$ be the set of points in $\\mathbb{Z}^2$ of the form $(\\pm 2^k, \\pm 2^k)$ for some $k \\leq n$ (the two signs being chosen independently). \nWe prove by induction on $n$ that\n\\[\nP_n = \\{(0,0)\\} \\cup Q_{\\lfloor n/2 \\rfloor} \\cup R_{\\lfloor (n-1)/2 \\rfloor}.\n\\]\nWe take as base cases the straightforward computations\n\\begin{align*}\nP_0 &= \\{(0,0), (\\pm 1, 0), (0, \\pm 1)\\} \\\\\nP_1 &= P_0 \\cup \\{(\\pm 1, \\pm 1)\\}.\n\\end{align*}\nFor $n \\geq 2$, it is clear that $\\{(0,0)\\} \\cup Q_{\\lfloor n/2 \\rfloor} \\cup R_{\\lfloor (n-1)/2 \\rfloor} \\subseteq P_n$, so it remains to prove the reverse inclusion. For $(x,y) \\in P_n$, note that $x^2 + y^2 \\equiv 0 \\pmod{4}$;\nsince every perfect square is congruent to either 0 or 1 modulo 4, $x$ and $y$ must both be even. Consequently,\n$(x/2, y/2) \\in P_{n-2}$, so we may appeal to the induction hypothesis to conclude.\n\nWe next identify all of the squares with vertices in $P_n$. In the following discussion, let $(a,b)$\nand $(c,d)$ be two opposite vertices of a square, so that the other two vertices are\n\\[\n\\left( \\frac{a-b+c+d}{2}, \\frac{a+b-c+d}{2} \\right)\n\\]\nand \n\\[\n\\left( \\frac{a+b+c-d}{2}, \\frac{-a+b+c+d}{2} \\right).\n\\]\n\\begin{itemize}\n\\item\nSuppose that $(a,b) = (0,0)$. Then $(c,d)$ may be any element of $P_n$ not contained in $P_0$.\nThe number of such squares is $4n$.\n\n\\item\nSuppose that $(a,b), (c,d) \\in Q_k$ for some $k$. \nThere is one such square with vertices \n\\[\n\\{(0, 2^k), (0, 2^{-k}), (2^k, 0), (2^{-k}, 0)\\}\n\\]\nfor $k = 0,\\dots,\\lfloor \\frac{n}{2} \\rfloor$, for a total of $\\lfloor \\frac{n}{2} \\rfloor + 1$.\nTo show that there are no others, by symmetry it suffices to rule out the existence of a square with\nopposite vertices $(a,0)$ and $(c,0)$ where $a > \\left| c \\right|$. \nThe other two vertices of this square would be $((a+c)/2, (a-c)/2)$ and $((a+c)/2, (-a+c)/2)$.\nThese cannot belong to any $Q_k$, or be equal to $(0,0)$,\nbecause $|a+c|, |a-c| \\geq a - |c| > 0$ by the triangle inequality.\nThese also cannot belong to any $R_k$ because $(a + |c|)/2 > (a - |c|)/2$. \n(One can also phrase this argument in geometric terms.)\n\n\\item\nSuppose that $(a,b), (c,d) \\in R_k$ for some $k$.\nThere is one such square with vertices\n\\[\n\\{(2^k, 2^k), (2^k, -2^k), (-2^k, 2^k), (-2^k, -2^k)\\}\n\\]\nfor $k=0,\\dots, \\lfloor \\frac{n-1}{2} \\rfloor$, for a total of $\\lfloor \\frac{n+1}{2} \\rfloor$.\nTo show that there are no others, we may reduce to the previous case: rotating by an angle of $\\frac{\\pi}{4}$ and then rescaling by a factor of $\\sqrt{2}$ would yield a square with two opposite vertices in some $Q_k$ not centered at $(0,0)$, which we have already ruled out.\n\n\\item\nIt remains to show that we cannot have $(a,b) \\in Q_k$ and $(c,d) \\in R_k$ for some $k$.\nBy symmetry, we may reduce to the case where $(a,b) = (0, 2^k)$ and $(c,d) = (2^\\ell, \\pm 2^\\ell)$.\nIf $d>0$, then the third vertex $(2^{k-1}, 2^{k-1} + 2^\\ell)$ is impossible.\nIf $d<0$, then the third vertex $(-2^{k-1}, 2^{k-1} - 2^\\ell)$ is impossible.\n\n\\end{itemize}\n\nSumming up, we obtain\n\\[\n4n + \\left\\lfloor \\frac{n}{2} \\right\\rfloor + 1 + \\left\\lfloor \\frac{n+1}{2} \\right\\rfloor = 5n+1\n\\]\nsquares, proving the claim.\n\n\\noindent\n\\textbf{Remark.}\nGiven the computation of $P_n$, we can alternatively show that the number of squares with vertices in $P_n$ is $5n+1$ as follows. Since this is clearly true for $n=1$, it suffices to show that for $n \\geq 2$, there are exactly $5$ squares with vertices in $P_n$, at least one of which is not in $P_{n-1}$. Note that the convex hull of $P_n$ is a square $S$ whose four vertices are the four points in $P_n \\setminus P_{n-1}$. If $v$ is one of these points, then a square with a vertex at $v$ can only lie in $S$ if its two sides containing $v$ are in line with the two sides of $S$ containing $v$. It follows that there are exactly two squares with a vertex at $v$ and all vertices in $P_n$: the square corresponding to $S$ itself, and a square whose vertex diagonally opposite to $v$ is the origin. Taking the union over the four points in $P_n \\setminus P_{n-1}$ gives a total of $5$ squares, as desired.", "source_problems": "PUTNAM-2019-problems.tex", "source_solutions": "PUTNAM-2019-solutions.tex", "notes": ""}
{"id": "PUTNAM-2019-B2", "contest": "PUTNAM", "year": "2019", "problem_number": "B2", "problem": "For all $n \\geq 1$, let\n\\[\na_n = \\sum_{k=1}^{n-1} \\frac{\\sin \\left( \\frac{(2k-1)\\pi}{2n} \\right)}{\\cos^2 \\left( \\frac{(k-1)\\pi}{2n} \\right) \\cos^2 \\left( \\frac{k\\pi}{2n} \\right)}.\n\\]\nDetermine\n\\[\n\\lim_{n \\to \\infty} \\frac{a_n}{n^3}.\n\\]", "solution": "The answer is $\\frac{8}{\\pi^3}$.\n\n\\noindent\n\\textbf{Solution 1.}\nBy the double angle and sum-product identities for cosine, we have\n\\begin{align*}\n2\\cos^2\\left(\\frac{(k-1)\\pi}{2n}\\right) - 2\\cos^2 \\left(\\frac{k\\pi}{2n}\\right) &= \\cos\\left(\\frac{(k-1)\\pi}{n}\\right) - \\cos\\left(\\frac{k\\pi}{n}\\right) \\\\\n&= 2\\sin\\left(\\frac{(2k-1)\\pi}{2n}\\right) \\sin\\left(\\frac{\\pi}{2n}\\right),\n\\end{align*}\nand it follows that the summand in $a_n$ can be written as\n\\[\n\\frac{1}{\\sin\\left(\\frac{\\pi}{2n}\\right)} \\left(-\\frac{1}{\\cos^2\\left(\\frac{(k-1)\\pi}{2n}\\right)}+\\frac{1}{\\cos^2\\left(\\frac{k\\pi}{2n}\\right)}\\right).\n\\]\nThus the sum telescopes and we find that\n\\[\na_n = \\frac{1}{\\sin\\left(\\frac{\\pi}{2n}\\right)} \\left(-1+\\frac{1}{\\cos^2\\left(\\frac{(n-1)\\pi}{2n}\\right)}\\right) =\n- \\frac{1}{\\sin\\left(\\frac{\\pi}{2n}\\right)}+ \\frac{1}{\\sin^3\\left(\\frac{\\pi}{2n}\\right)}.\n\\]\nFinally, since $\\lim_{x\\to 0} \\frac{\\sin x}{x} = 1$, we have $\\lim_{n\\to\\infty} \\left( n\\sin\\frac{\\pi}{2n} \\right) = \\frac{\\pi}{2}$, and thus\n$\\lim_{n\\to\\infty} \\frac{a_n}{n^3} = \\frac{8}{\\pi^3}$.\n\n\\noindent\n\\textbf{Solution 2.}\nWe first substitute $n-k$ for $k$ to obtain\n\\[\na_n=\\sum_{k=1}^{n-1} \\frac{\\sin\\left(\\frac{(2k+1)\\pi}{2n}\\right)}{\\sin^2\\left(\\frac{(k+1)\\pi}{2n}\\right)\\sin^2\\left(\\frac{k\\pi}{2n}\\right)}.\n\\]\nWe then use the estimate\n\\[\n\\frac{\\sin x}{x} = 1 + O(x^2) \\qquad (x \\in [0, \\pi])\n\\]\nto rewrite the summand as\n\\[\n\\frac{\\left( \\frac{(2k-1)\\pi}{2n} \\right)}{\\left(\\frac{(k+1)\\pi}{2n}\\right)^2 \\left(\\frac{k\\pi}{2n}\\right)^2} \\left(1 + O\\left( \\frac{k^2}{n^2} \\right) \\right)\n\\]\nwhich simplifies to\n\\[\n\\frac{8 (2k-1) n^3}{k^2 (k+1)^2 \\pi^3} + O\\left( \\frac{n}{k} \\right).\n\\]\nConsequently,\n\\begin{align*}\n\\frac{a_n}{n^3} &= \\sum_{k=1}^{n-1} \\left( \\frac{8 (2k-1)}{k^2 (k+1)^2 \\pi^3} + O\\left( \\frac{1}{kn^2} \\right) \\right) \\\\\n&= \\frac{8}{\\pi^3} \\sum_{k=1}^{n-1} \\frac{(2k-1)}{k^2 (k+1)^2} \n+ O \\left( \\frac{\\log n}{n^2} \\right). \n\\end{align*}\nFinally, note that\n\\[\n\\sum_{k=1}^{n-1} \\frac{(2k-1)}{k^2 (k+1)^2} = \n\\sum_{k=1}^{n-1} \\left( \\frac{1}{k^2} - \\frac{1}{(k+1)^2}\\right) = 1 - \\frac{1}{n^2}\n\\]\nconverges to 1, and so $\\lim_{n \\to \\infty} \\frac{a_n}{n^3} = \\frac{8}{\\pi^3}$.", "source_problems": "PUTNAM-2019-problems.tex", "source_solutions": "PUTNAM-2019-solutions.tex", "notes": ""}
{"id": "PUTNAM-2019-B3", "contest": "PUTNAM", "year": "2019", "problem_number": "B3", "problem": "Let $Q$ be an $n$-by-$n$ real orthogonal matrix, and let $u \\in \\mathbb{R}^n$ be a unit column vector (that is,\n$u^T u = 1$). Let $P = I - 2uu^T$, where $I$ is the $n$-by-$n$ identity matrix. Show that if $1$ is not an eigenvalue of $Q$, then $1$ is an eigenvalue of $PQ$.", "solution": "\\noindent\n\\textbf{Solution 1.}\nWe first note that $P$ corresponds to the linear transformation on $\\mathbb{R}^n$ given by reflection in the hyperplane perpendicular to $u$: $P(u) = -u$, and for any $v$ with $\\langle u,v\\rangle = 0$, $P(v) = v$. In particular, $P$ is an orthogonal matrix of determinant $-1$.\n\nWe next claim that if $Q$ is an $n\\times n$ orthogonal matrix that does not have $1$ as an eigenvalue, then $\\det Q = (-1)^n$. To see this, recall that the roots of the characteristic polynomial $p(t) = \\det(tI-Q)$ all lie on the unit circle in $\\mathbb{C}$, and all non-real roots occur in conjugate pairs ($p(t)$ has real coefficients, and orthogonality implies that $p(t) = \\pm t^n p(t^{-1})$). The product of each conjugate pair of roots is $1$; thus $\\det Q = (-1)^k$ where $k$ is the multiplicity of $-1$ as a root of $p(t)$. Since $1$ is not a root and all other roots appear in conjugate pairs, $k$ and $n$ have the same parity, and so $\\det Q = (-1)^n$.\n\nFinally, if neither of the orthogonal matrices $Q$ nor $PQ$ has $1$ as an eigenvalue, then $\\det Q = \\det(PQ) = (-1)^n$, contradicting the fact that $\\det P = -1$. The result follows.\n\n\\noindent\n\\textbf{Remark.}\nIt can be shown that any $n \\times n$ orthogonal matrix $Q$ can be written as a product of at most $n$ hyperplane reflections (Householder matrices). If equality occurs, then $\\det(Q) = (-1)^n$;\nif equality does not occur, then $Q$ has $1$ as an eigenvalue.\nConsequently, equality fails for one of $Q$ and $PQ$, and that matrix has $1$ as an eigenvalue.\n\nSucharit Sarkar suggests the following topological interpretation: an orthogonal matrix without 1 as an eigenvalue\ninduces a fixed-point-free map from the $(n-1)$-sphere to itself, and the degree of such a map must be $(-1)^n$.\n\n\\noindent\n\\textbf{Solution 2.}\nThis solution uses the (reverse) \\emph{Cayley transform}: if $Q$ is an orthogonal matrix not having 1 as an eigenvalue, then\n\\[\nA = (I-Q)(I+Q)^{-1}\n\\]\nis a skew-symmetric matrix (that is, $A^T = -A$).\n\nSuppose then that $Q$ does not have $1$ as an eigenvalue.\nLet $V$ be the orthogonal complement of $u$ in $\\mathbb{R}^n$. On one hand, for $v \\in V$,\n\\[\n(I-Q)^{-1} (I - QP) v = (I-Q)^{-1} (I-Q)v = v.\n\\]\nOn the other hand,\n\\[\n(I-Q)^{-1} (I - QP) u = (I-Q)^{-1} (I+Q)u = Au\n\\]\nand $\\langle u, Au \\rangle = \\langle A^T u, u \\rangle\n= \\langle -Au, u \\rangle$, so $Au \\in V$.\nPut $w = (1-A)u$; then $(1-QP)w = 0$, so $QP$ has 1 as an eigenvalue, and the same for $PQ$ because $PQ$ and $QP$ have the same characteristic polynomial.\n\n\\noindent\n\\textbf{Remark.}\nThe \\emph{Cayley transform} is the following construction: if $A$ is a skew-symmetric matrix,\nthen $I+A$ is invertible and\n\\[\nQ = (I-A)(I+A)^{-1}\n\\]\nis an orthogonal matrix.\n\n\\noindent\n\\textbf{Remark.}\n(by Steven Klee)\nA related argument is to compute $\\det(PQ-I)$ using the \\emph{matrix determinant lemma}:\nif $A$ is an invertible $n \\times n$ matrix and $v, w$ are $1 \\times n$ column vectors, then\n\\[\n\\det(A + vw^T) = \\det(A) (1 + w^T A^{-1} v).\n\\]\nThis reduces to the case $A = I$, in which case it again comes down to the fact that the product of two square matrices (in this case, obtained from $v$ and $w$ by padding with zeroes) retains the same characteristic polynomial when the factors are reversed.", "source_problems": "PUTNAM-2019-problems.tex", "source_solutions": "PUTNAM-2019-solutions.tex", "notes": ""}
{"id": "PUTNAM-2019-B4", "contest": "PUTNAM", "year": "2019", "problem_number": "B4", "problem": "Let $\\mathcal{F}$ be the set of functions $f(x,y)$ that are twice continuously differentiable for $x \\geq 1$, $y \\geq 1$ and that satisfy the following two equations (where subscripts denote partial derivatives):\n\\begin{gather*}\nxf_x + yf_y = xy \\ln(xy), \\\\\nx^2 f_{xx} + y^2 f_{yy} = xy.\n\\end{gather*}\nFor each $f \\in \\mathcal{F}$, let\n\\[\nm(f) = \\min_{s \\geq 1} \\left(f(s+1,s+1) - f(s+1,s) - f(s,s+1) + f(s,s) \\right).\n\\]\nDetermine $m(f)$, and show that it is independent of the choice of $f$.", "solution": "\\noindent\n\\textbf{Solution 1.}\nWe compute that $m(f) = 2 \\ln 2 - \\frac{1}{2}$.\nLabel the given differential equations by (1) and (2). If we write, e.g., $x\\frac{\\partial}{\\partial x}(1)$ for the result of differentiating (1) by $x$ and multiplying the resulting equation by $x$, then the combination\n$x\\frac{\\partial}{\\partial x}(1)+y\\frac{\\partial}{\\partial y}(1)-(1)-(2)$ gives the equation\n$2xyf_{xy} = xy\\ln(xy)+xy$, whence $f_{xy} = \\frac{1}{2} (\\ln(x)+\\ln(y)+1)$.\n\nNow we observe that\n\\begin{align*}\n\\lefteqn{f(s+1,s+1)-f(s+1,s)-f(s,s+1)+f(s,s)} \\\\\n &= \\int_s^{s+1} \\int_s^{s+1} f_{xy}\\,dy\\,dx \\\\\n&= \\frac{1}{2} \\int_s^{s+1} \\int_s^{s+1} (\\ln(x)+\\ln(y)+1)\\,dy\\,dx \\\\\n&= \\frac{1}{2} + \\int_s^{s+1} \\ln(x)\\,dx.\n\\end{align*}\n\nSince $\\ln(x)$ is increasing, $\\int_s^{s+1} \\ln(x)\\,dx$ is an increasing function of $s$, and so it is minimized over $s \\in [1,\\infty)$ when $s=1$. We conclude that\n\\[\nm(f) = \\frac{1}{2} + \\int_1^2 \\ln(x)\\,dx = 2 \\ln 2-\\frac{1}{2}\n\\]\nindependent of $f$.\n\n\\noindent\n\\textbf{Remark.}\nThe phrasing of the question suggests that solvers were not expected to prove that $\\mathcal{F}$ is nonempty,\neven though this is necessary to make the definition of $m(f)$ logically meaningful. Existence will be explicitly established in the next solution.\n\n\\noindent\n\\textbf{Solution 2.}\nWe first verify that \n\\[\nf(x,y) = \\frac{1}{2}(xy\\ln(xy)-xy)\n\\]\nis an element of $\\mathcal{F}$, by computing that\n\\begin{gather*}\nxf_x = yf_y = \\frac{1}{2} xy \\ln(xy) \\\\\nx^2 f_{xx} = y^2 f_{yy} = xy.\n\\end{gather*}\n(See the following remark for motivation for this guess.)\n\nWe next show that the only elements of $\\mathcal{F}$ are $f+a \\ln(x/y) + b$ where $a,b$ are constants.\nSuppose that $f+g$ is a second element of $\\mathcal{F}$. As in the first solution, we deduce that $g_{xy} = 0$; this implies that\n$g(x,y) = u(x) + v(y)$ for some twice continuously differentiable functions $u$ and $v$. We also have\n$xg_x + yg_y = 0$, which now asserts that $xg_x = - yg_y$ is equal to some constant $a$. This yields that\n$g = a \\ln(x/y) + b$ as desired.\n\nWe next observe that \n\\[\ng(s+1,s+1)-g(s+1,s)-g(s,s+1)+g(s,s) = 0,\n\\]\nso $m(f) = m(f+g)$. It thus remains to compute $m(f)$. To do this, we verify that\n\\[\nf(s+1,s+1)-f(s+1,s)-f(s,s+1)+f(s,s)\n\\]\nis nondecreasing in $s$ by computing its derivative to be $\\ln (s+1) - \\ln(s)$\n(either directly or using the integral representation from the first solution).\nWe thus minimize by taking $s=1$ as in the first solution.\n\n\\noindent\n\\textbf{Remark.}\nOne way to make a correct guess for $f$ is to notice that the given equations are both symmetric in $x$ and $y$\nand posit that $f$ should also be symmetric. Any symmetric function of $x$ and $y$ can be written in terms of the variables $u = x+y$ and $v = xy$, so in principle we could translate the equations into those variables and solve. However, before trying this, we observe that $xy$ appears explicitly in the equations, so it is reasonable to make a first guess of the form $f(x,y) = h(xy)$. \nFor such a choice, we have\n\\[\nx f_x + y f_y = 2xy h' = xy \\ln(xy)\n\\]\nwhich forces us to set $h(t)  = \\frac{1}{2}(t \\ln(t) - t)$.", "source_problems": "PUTNAM-2019-problems.tex", "source_solutions": "PUTNAM-2019-solutions.tex", "notes": ""}
{"id": "PUTNAM-2019-B5", "contest": "PUTNAM", "year": "2019", "problem_number": "B5", "problem": "Let $F_m$ be the $m$th Fibonacci number, defined by $F_1 = F_2 = 1$ and $F_m = F_{m-1} + F_{m-2}$ for all $m \\geq 3$.\nLet $p(x)$ be the polynomial of degree $1008$ such that $p(2n+1) = F_{2n+1}$ for $n=0,1,2,\\dots,1008$. Find integers $j$ and $k$ such that $p(2019) = F_j - F_k$.", "solution": "\\noindent\n\\textbf{Solution 1.}\nWe prove that $(j,k) = (2019, 1010)$ is a valid solution.\nMore generally, let $p(x)$ be the polynomial of degree $N$ such that $p(2n+1) = F_{2n+1}$ for $0 \\leq n \\leq N$. We will show that $p(2N+3) = F_{2N+3}-F_{N+2}$. \n\nDefine a sequence of polynomials $p_0(x),\\ldots,p_N(x)$ by $p_0(x) = p(x)$ and $p_k(x) = p_{k-1}(x)-p_{k-1}(x+2)$ for $k \\geq 1$. Then by induction on $k$, it is the case that $p_k(2n+1) = F_{2n+1+k}$ for $0 \\leq n \\leq N-k$, and also that $p_k$ has degree (at most) $N-k$ for $k \\geq 1$. Thus $p_N(x) = F_{N+1}$ since $p_N(1) = F_{N+1}$ and $p_N$ is constant.\n\n\nWe now claim that for $0\\leq k\\leq N$, $p_{N-k}(2k+3) = \\sum_{j=0}^k F_{N+1+j}$. We prove this again by induction on $k$: for the induction step, we have\n\\begin{align*}\np_{N-k}(2k+3) &= p_{N-k}(2k+1)+p_{N-k+1}(2k+1) \\\\\n&= F_{N+1+k}+\\sum_{j=0}^{k-1} F_{N+1+j}.\n\\end{align*}\nThus we have $p(2N+3) = p_0(2N+3) = \\sum_{j=0}^N F_{N+1+j}$. \n\nNow one final induction shows that $\\sum_{j=1}^m F_j = F_{m+2}-1$, and so $p(2N+3) = F_{2N+3}-F_{N+2}$, as claimed. In the case $N=1008$, we thus have $p(2019) = F_{2019} - F_{1010}$.\n\n\\noindent\n\\textbf{Solution 2.}\nThis solution uses the \\emph{Lagrange interpolation formula}: given $x_0,\\dots,x_n$ and $y_0,\\dots,y_n$, the unique polynomial $P$ of degree at most $n$ satisfying $P(x_i) = y_i$ for $i=0,\\dots,n$ is\n\\[\n\\sum_{i=0}^n P(x_i) \\prod_{j \\neq i} \\frac{x-x_j}{x_i-x_j} =\n\\]\nWrite \n\\[\nF_n = \\frac{1}{\\sqrt{5}}(\\alpha^n - \\beta^{-n}), \\qquad \\alpha = \\frac{1+\\sqrt{5}}{2}, \\beta = \\frac{1-\\sqrt{5}}{2}.\n\\]\nFor $\\gamma \\in \\mathbb{R}$, let $p_\\gamma(x)$ be the unique polynomial of degree at most 1008 satisfying\n\\[\np_1(2n+1) = \\gamma^{2n+1}, p_2(2n+1) = \\gamma^{2n+1} \\, (n=0,\\dots,1008);\n\\]\nthen $p(x) = \\frac{1}{\\sqrt{5}}(p_\\alpha(x) - p_\\beta(x))$.\n\nBy Lagrange interpolation,\n\\begin{align*}\np_\\gamma(2019) &= \\sum_{n=0}^{1008} \\gamma^{2n+1} \\prod_{0 \\leq j \\leq 1008, j \\neq n} \\frac{2019-(2j+1)}{(2n+1)-(2j+1)}\\\\\n&= \\sum_{n=0}^{1008} \\gamma^{2n+1} \\prod_{0 \\leq j \\leq 1008, j \\neq n} \\frac{1009-j}{n-j}\\\\\n&= \\sum_{n=0}^{1008} \\gamma^{2n+1} (-1)^{1008-n} \\binom{1009}{n} \\\\\n&= -\\gamma ((\\gamma^2-1)^{1009} - (\\gamma^2)^{1009}).\n\\end{align*}\nFor $\\gamma \\in \\{\\alpha, \\beta\\}$ we have $\\gamma^2 = \\gamma + 1$ and so\n\\[\np_\\gamma(2019) = \\gamma^{2019} - \\gamma^{1010}.\n\\]\nWe thus deduce that $p(x) = F_{2019} - F_{1010}$ as claimed.\n\n\\noindent\n\\textbf{Remark.}\nKarl Mahlburg suggests the following variant of this. As above, use Lagrange interpolation to write\n\\[\np(2019) = \\sum_{j=0}^{1008} \\binom{1009}{j} F_j;\n\\]\nit will thus suffice to verify (by substiting $j \\mapsto 1009-j$) that\n\\[\n\\sum_{j=0}^{1009} \\binom{1009}{j} F_{j+1} = F_{2019}.\n\\]\nThis identity has the following combinatorial interpretation. Recall that $F_{n+1}$ counts the number of ways to tile a $1 \\times n$ rectangle with $1 \\times 1$ squares and $1 \\times 2$ dominoes (see below). In any such tiling with $n = 2018$, let $j$ be the number of squares among the first 1009 tiles.\nThese can be ordered in $\\binom{1009}{j}$ ways, and the remaining $2018 - j - 2(1009-j) = j$ squares can be\ntiled in $F_{j+1}$ ways.\n\nAs an aside, this interpretation of $F_{n+1}$ is the oldest known interpretation of the Fibonacci sequence,\nlong predating Fibonacci himself. In ancient Sanskrit, syllables were classified as long or short, and a long syllable was considered to be twice as long as a short syllable; consequently, the number of syllable patterns of total length $n$ equals $F_{n+1}$.\n\n\\noindent\n\\textbf{Remark.}\nIt is not difficult to show that the solution $(j,k) = (2019, 2010)$ is unique (in positive integers). \nFirst, note that to have $F_j - F_k > 0$, we must have $k < j$.\nIf $j < 2019$, then\n\\[\nF_{2019} - F_{1010} = F_{2018} + F_{2017} - F_{1010} > F_{j} > F_j - F_k.\n\\]\nIf $j > 2020$, then  \n\\[\nF_j - F_k \\geq F_j - F_{j-1} = F_{j-2} \\geq F_{2019} > F_{2019} - F_{1010}.\n\\]\nSince $j = 2019$ obviously forces $k = 1010$, the only other possible solution would be with $j = 2020$.\nBut then\n\\[\n(F_j - F_k) - (F_{2019} - F_{1010})\n= (F_{2018} - F_k) + F_{1010} \n\\]\nwhich is negative for $k=2019$ (it equals $F_{1010} - F_{2017}$)\nand positive for $k \\leq 2018$.", "source_problems": "PUTNAM-2019-problems.tex", "source_solutions": "PUTNAM-2019-solutions.tex", "notes": ""}
{"id": "PUTNAM-2019-B6", "contest": "PUTNAM", "year": "2019", "problem_number": "B6", "problem": "Let $\\mathbb{Z}^n$ be the integer lattice in $\\mathbb{R}^n$. Two points in $\\mathbb{Z}^n$ are called \n\\emph{neighbors} if they differ by exactly $1$ in one coordinate and are equal in all other coordinates. \nFor which integers $n \\geq 1$ does there exist a set of points $S \\subset \\mathbb{Z}^n$ satisfying the following two conditions?\n\\begin{enumerate}\n\\item[(1)] If $p$ is in $S$, then none of the neighbors of $p$ is in $S$.\n\\item[(2)] If $p \\in \\mathbb{Z}^n$ is not in $S$, then exactly one of the neighbors of $p$ is in $S$.\n\\end{enumerate}\n\\end{itemize}\n\n\\end{document}", "solution": "Such a set exists for every $n$. To construct an example, define the function $f: \\mathbb{Z}^n \\to \\mathbb{Z}/(2n+1) \\mathbb{Z}$ by\n\\[\nf(x_1,\\dots,x_n) = x_1 + 2x_2 + \\cdots + nx_n \\pmod{2n+1},\n\\]\nthen let $S$ be the preimage of 0.\n\nTo check condition (1), note that if $p \\in S$ and $q$ is a neighbor of $p$ differing only in coordinate $i$, then\n\\[\nf(q) = f(p) \\pm i \\equiv \\pm i \\pmod{2n+1}\n\\]\nand so $q \\notin S$.\n\nTo check condition (2), note that if $p \\in \\mathbb{Z}^n$ is not in $S$, then there exists a unique choice of $i \\in \\{1,\\dots,n\\}$ such that $f(p)$ is congruent to one of $+i$ or $-i$ modulo $2n+1$. The unique neighbor $q$ of $p$ in $S$ is then obtained by either subtracting $1$ from, or adding $1$ to, the $i$-th coordinate of $p$.\n\n\\noindent\n\\textbf{Remark.}\nAccording to Art of Problem Solving (thread c6h366290), this problem was a 1985 IMO submission from Czechoslovakia. For an application to steganography, see:\nJ. Fridrich and P. Lison\\v{e}k, Grid colorings in steganography,\n\\textit{IEEE Transactions on Information Theory} \\textbf{53} (2007), 1547--1549.\n\n\\end{itemize}\n\\end{document}", "source_problems": "PUTNAM-2019-problems.tex", "source_solutions": "PUTNAM-2019-solutions.tex", "notes": ""}
{"id": "PUTNAM-2020-A1", "contest": "PUTNAM", "year": "2020", "problem_number": "A1", "problem": "How many positive integers $N$ satisfy all of the following three conditions?\n\\begin{enumerate}\n\\item[(i)] $N$ is divisible by 2020.\n\\item[(ii)] $N$ has at most 2020 decimal digits.\n\\item[(iii)] The decimal digits of $N$ are a string of consecutive ones followed by a string of consecutive zeros.\n\\end{enumerate}", "solution": "The values of $N$ that satisfy (ii) and (iii) are precisely the numbers of the form $N = (10^a-10^b)/9$ for $0\\leq b<a\\leq 2020$; this expression represents the integer with $a$ digits beginning with a string of $1$'s and ending with $b$ $0$'s. A value $N$ of this form is divisible by $2020 = 2^2 \\cdot 5 \\cdot 101$ if and only if $10^b(10^{a-b}-1)$ is divisible by each of $3^2$, $2^2\\cdot 5$, and $101$. Divisibility by $3^2$ is a trivial condition since $10 \\equiv 1 \\pmod{9}$. Since $10^{a-b}-1$ is odd, divisibility by $2^2\\cdot 5$ occurs if and only if $b \\geq 2$. Finally, since $10^2 \\equiv -1 \\pmod{101}$, we see that $10^{a-b}$ is congruent to $10$, $-1$, $-10$, or $1 \\pmod{101}$ depending on whether $a-b$ is congruent to $1$, $2$, $3$, or $0 \\pmod{4}$; thus $10^{a-b}-1$ is divisible by $101$ if and only if $a-b$ is divisible by $4$.\n\nIt follows that we need to count the number of $(a,b)$ with $2\\leq b<a\\leq 2020$ with $4\\,|\\,a-b$. For given $b$, there are $\\lfloor \\frac{2020-b}{4} \\rfloor$ possible values of $a$. Thus the answer is\n\\begin{align*}\n& 504+504+504+503+503+503+503+\\cdots+1+1+1+1  \\\\\n&\\quad = 4(504+503+\\cdots+1)-504 = 504\\cdot 1009 = 508536.\n\\end{align*}", "source_problems": "PUTNAM-2020-problems.tex", "source_solutions": "PUTNAM-2020-solutions.tex", "notes": ""}
{"id": "PUTNAM-2020-A2", "contest": "PUTNAM", "year": "2020", "problem_number": "A2", "problem": "Let $k$ be a nonnegative integer. Evaluate\n\\[\n\\sum_{j=0}^k 2^{k-j} \\binom{k+j}{j}.\n\\]", "solution": "The answer is $4^k$. \n\n\\noindent\n\\textbf{First solution.}\nLet $S_k$ denote the given sum. Then, with the convention that ${n\\choose{-1}} = 0$ for any $n\\geq 0$, we have for $k\\geq 1$,\n\\begin{align*}\nS_k &= \\sum_{j=0}^k 2^{k-j} \\left[ {{k-1+j}\\choose {j}} + {{k-1+j}\\choose {j-1}} \\right] \\\\\n&= 2\\sum_{j=0}^{k-1} 2^{k-1-j} {{k-1+j}\\choose j}+{{2k-1}\\choose k} + \\sum_{j=1}^k 2^{k-j}{{k-1+j}\\choose{j-1}} \\\\\n&= 2S_{k-1} + {{2k-1}\\choose{k}} + \\sum_{j=0}^{k-1} 2^{k-j-1}{{k+j}\\choose j} \\\\\n&= 2S_{k-1}+S_k/2\n\\end{align*}\nand so $S_k = 4S_{k-1}$. Since $S_0 = 1$, it follows that $S_k = 4^k$ for all $k$.\n\n\\noindent\n\\textbf{Second solution.}\nConsider a sequence of fair coin flips $a_1, a_2, \\dots$ and define the random variable $X$ to be the index of the $(k+1)$-st occurrence of heads.\nThen\n\\[\nP[X = n] = \\binom{n-1}{k} 2^{-n};\n\\]\nwriting $n = k+j+1$, we may thus rewrite the given sum as\n\\[\n2^{2k+1} P[X \\leq 2k+1].\n\\]\nIt now suffices to observe that $P[X \\leq 2k+1] = \\frac{1}{2}$:\nwe have $X \\leq 2k+1$ if and only if there are at least $k+1$ heads among the first $2k+1$ flips,\nand there are exactly as many outcomes with at most $k$ heads.\n\n\\noindent\n\\textbf{Third solution.}\n(by Pankaj Sinha)\nThe sum in question in the coefficient of $x^k$ in the formal power series\n\\begin{align*}\n\\sum_{j=0}^k 2^{k-j} (1+x)^{k+j} &= 2^k (1+x)^k \\sum_{j=0}^k 2^{-j} (1+x)^j \\\\\n&= 2^k (1+x)^k \\frac{1 - (1+x)^{k+1}/2^{k+1}}{1 - (1+x)/2} \\\\\n&= \\frac{2^{k+1}(1+x)^k - (1+x)^{2k+1}}{1-x} \\\\\n&= (2^{k+1}(1+x)^k - (1+x)^{2k+1})(1+x+\\cdots).\n\\end{align*}\nThis evidently equals\n\\begin{align*}\n2^{k+1} \\sum_{j=0}^k \\binom{k}{j} - \\sum_{j=0}^k \\binom{2k+1}{j} &= 2^{k+1} (2^k) - \\frac{1}{2} 2^{2k+1}  \\\\\n&= 2^{2k+1} - 2^{2k} = 2^{2k} = 4^k.\n\\end{align*}\n\n\\noindent\n\\textbf{Remark.}\nThis sum belongs to a general class that can be evaluated mechanically using the \\emph{WZ method}. See for example the book \\textit{$A=B$}\nby Petvoksek--Wilf--Zeilberger.", "source_problems": "PUTNAM-2020-problems.tex", "source_solutions": "PUTNAM-2020-solutions.tex", "notes": ""}
{"id": "PUTNAM-2020-A3", "contest": "PUTNAM", "year": "2020", "problem_number": "A3", "problem": "Let $a_0 = \\pi/2$, and let $a_n = \\sin(a_{n-1})$ for $n \\geq 1$. Determine whether\n\\[\n\\sum_{n=1}^\\infty a_n^2\n\\]\nconverges.", "solution": "The series diverges. First note that since $\\sin (x)<x$ for all $x>0$, the sequence $\\{a_n\\}$ is positive and decreasing, with $a_1=1$. Next, we observe that for $x \\in [0,1]$, $\\sin(x) \\geq x-x^3/6$: this follows from Taylor's theorem with remainder, since $\\sin(x) = x- x^3/6+(\\sin c)x^4/24$ for some $c$ between $0$ and $x$.\n\nWe now claim that $a_n \\geq 1/\\sqrt{n}$ for all $n \\geq 1$; it follows that $\\sum a_n^2$ diverges since $\\sum 1/n$ diverges. To prove the claim, we induct on $n$, with $n=1$ being trivial. Suppose that $a_n \\geq 1/\\sqrt{n}$. To prove $\\sin(a_n) \\geq 1/\\sqrt{n+1}$, note that since $\\sin(a_n) \\geq \\sin(1/\\sqrt{n})$, it suffices to prove that $x-x^3/6 \\geq (n+1)^{-1/2}$ where $x=1/\\sqrt{n}$. Squaring both sides and clearing denominators, we find that this is equivalent to $(n+1)(6n-1)^2 \\geq 36n^3$, or $24n^2-11n+1 \\geq 0$. But this last inequality is true since $24n^2-11n+1 = (3n-1)(8n-1)$, and the induction is complete.", "source_problems": "PUTNAM-2020-problems.tex", "source_solutions": "PUTNAM-2020-solutions.tex", "notes": ""}
{"id": "PUTNAM-2020-A4", "contest": "PUTNAM", "year": "2020", "problem_number": "A4", "problem": "Consider a horizontal strip of $N+2$ squares in which the first and the last square are black and the remaining $N$ squares are all white. Choose a white square uniformly at random, choose one of its two neighbors with equal probability,\nand color this neighboring square black if it is not already black. Repeat this process until all the remaining white squares have only black neighbors. Let $w(N)$ be the expected number of white squares remaining. Find\n\\[\n\\lim_{N \\to \\infty} \\frac{w(N)}{N}.\n\\]", "solution": "The answer is $1/e$. We first establish a recurrence for $w(N)$. Number the squares $1$ to $N+2$ from left to right. There are $2(N-1)$ equally likely events leading to the first new square being colored black: either we choose one of squares $3,\\ldots,N+1$ and color the square to its left, or we choose one of squares $2,\\ldots,N$ and color the square to its right. Thus the probability of square $i$ being the first new square colored black is $\\frac{1}{2(N-1)}$ if $i=2$ or $i=N+1$ and $\\frac{1}{N-1}$ if $3\\leq i\\leq N$. Once we have changed the first square $i$ from white to black, then the strip divides into two separate systems, squares $1$ through $i$ and squares $i$ through $N+2$, each with first and last square black and the rest white, and we can view the remaining process as continuing independently for each system. Thus if square $i$ is the first square to change color, the expected number of white squares at the end of the process is $w(i-2)+w(N+1-i)$. It follows that\n\\begin{align*}\nw(N) &= \\frac{1}{2(N-1)}(w(0)+w(N-1))+\\\\\n&\\quad \\frac{1}{N-1}\\left(\\sum_{i=3}^N (w(i-2)+w(N+1-i))\\right) \\\\\n&\\quad + \\frac{1}{2(N-1)}(w(N-1)+w(0))\n\\end{align*}\nand so \n\\[\n(N-1)w(N) = 2(w(1)+\\cdots+w(N-2))+w(N-1). \n\\]\nIf we replace $N$ by $N-1$ in this equation and subtract from the original equation, then we obtain the recurrence\n\\[\nw(N) = w(N-1)+\\frac{w(N-2)}{N-1}.\n\\]\n\nWe now claim that $w(N) = (N+1) \\sum_{k=0}^{N+1} \\frac{(-1)^k}{k!}$ for $N\\geq 0$. To prove this, we induct on $N$. The formula holds for $N=0$ and $N=1$ by inspection: $w(0)=0$ and $w(1)=1$. Now suppose that $N\\geq 2$ and $w(N-1) = N\\sum_{k=0}^N \\frac{(-1)^k}{k!}$, $w(N-2)=(N-1)\\sum_{k=0}^{N-1} \\frac{(-1)^k}{k!}$. Then\n\\begin{align*}\nw(N) &= w(N-1)+\\frac{w(N-2)}{N-1} \\\\\n&= N \\sum_{k=0}^N \\frac{(-1)^k}{k!} + \\sum_{k=0}^{N-1} \\frac{(-1)^k}{k!} \\\\\n& = (N+1) \\sum_{k=0}^{N-1} \\frac{(-1)^k}{k!}+\\frac{N(-1)^N}{N!}\\\\\n&= (N+1) \\sum_{k=0}^{N+1} \\frac{(-1)^k}{k!}\n\\end{align*}\nand the induction is complete.\n\nFinally, we compute that \n\\begin{align*}\n\\lim_{N\\to\\infty} \\frac{w(N)}{N} &= \\lim_{N\\to\\infty} \\frac{w(N)}{N+1} \\\\\n&= \\sum_{k=0}^\\infty \\frac{(-1)^k}{k!} = \\frac{1}{e}.\n\\end{align*}\n\n\\noindent\n\\textbf{Remark.}\nAoPS user pieater314159 suggests the following alternate description of $w(N)$. Consider the numbers $\\{1,\\dots,N+1\\}$ all originally colored white.\nChoose a permutation $\\pi \\in S_{N+1}$ uniformly at random. For $i=1,\\dots,N+1$ in succession, color $\\pi(i)$ black in case $\\pi(i+1)$ is currently white (regarding $i+1$ modulo $N+1$). After this, the expected number of white squares remaining is $w(N)$.\n\n\\noindent\n\\textbf{Remark.}\nAndrew Bernoff reports that this problem was inspired by a similar question of Jordan Ellenberg (disseminated via Twitter), which in turn was inspired by the final question of the 2017 MATHCOUNTS competition. See\n\\url{http://bit-player.org/2017/counting-your-chickens-before-theyre-pecked} for more discussion.", "source_problems": "PUTNAM-2020-problems.tex", "source_solutions": "PUTNAM-2020-solutions.tex", "notes": ""}
{"id": "PUTNAM-2020-A5", "contest": "PUTNAM", "year": "2020", "problem_number": "A5", "problem": "Let $a_n$ be the number of sets $S$ of positive integers for which\n\\[\n\\sum_{k \\in S} F_k = n,\n\\]\nwhere the Fibonacci sequence $(F_k)_{k \\geq 1}$ satisfies $F_{k+2} = F_{k+1} + F_k$ and begins $F_1 = 1, F_2 = 1, F_3 = 2, F_4 = 3$. Find the largest integer $n$ such that $a_n = 2020$.", "solution": "The answer is $n=F_{4040}-1$. In both solutions, we use freely the identity\n\\begin{equation} \\label{eq:2020A5eq1}\nF_1+F_2+\\cdots+F_{m-2} = F_m-1\n\\end{equation}\nwhich follows by a straightforward induction on $m$.\nWe also use the directly computed values\n\\begin{equation} \\label{eq:2020A5eq2}\na_1 = a_2 = 2, a_3 = a_4 = 3.\n\\end{equation}\n\n\\noindent\n\\textbf{First solution.} (by George Gilbert)\n\nWe extend the definition of $a_n$ by setting $a_0 = 1$.\n\n\\setcounter{lemma}{0}\n\\begin{lemma}\nFor $m>0$ and $F_m \\leq n < F_{m+1}$, \n\\begin{equation} \\label{eq:2020A5eq3}\na_n = a_{n-F_m} + a_{F_{m+1}-n-1}.\n\\end{equation}\n\\end{lemma}\n\\begin{proof}\nConsider a set $S$ for which $\\sum_{k \\in S} F_k = n$.\nIf $m \\in S$ then $S \\setminus \\{m\\}$ gives a representation of $n-F_m$, and this construction is reversible because $n-F_m < F_{m-1} \\leq F_m$.\nIf $m \\notin S$, then $\\{1,\\dots,m-1\\} \\setminus S$ gives a representation of $F_{m+1} - n - 1$, and this construction is also reversible.\nThis implies the desired equality.\n\\end{proof}\n\n\\begin{lemma}\nFor $m \\geq 2$,\n\\[\na_{F_m} = a_{F_{m+1}-1} = \\left\\lfloor \\frac{m+2}{2} \\right\\rfloor.\n\\]\n\\end{lemma}\n\\begin{proof}\nBy \\eqref{eq:2020A5eq2}, this holds for $m=2,3,4$. We now proceed by induction; for $m \\geq 5$, given all preceding cases,\nwe have by Lemma 1 that\n\\begin{align*}\na_{F_m} &= a_0 + a_{F_{m-1}-1} = 1 + \\left\\lfloor \\frac{m}{2} \\right\\rfloor =  \\left\\lfloor \\frac{m+2}{2} \\right\\rfloor \\\\\na_{F_{m+1}-1} &= a_{F_{m-1}-1} + a_0 = a_{F_m}. \\qedhere\n\\end{align*}\n\\end{proof}\n\nUsing Lemma 2, we see that $a_n = 2020$ for $n = F_{4040}-1$.\n\n\\begin{lemma}\nFor $F_m \\leq n < F_{m+1}$, $a_n \\geq a_{F_m}$.\n\\end{lemma}\n\\begin{proof}\nWe again induct on $m$.\nBy Lemma 2, we may assume that \n\\begin{equation} \\label{eq:2020A5eq4}\n1 \\leq n -F_m \\leq (F_{m+1}-2) - F_m = F_{m-1} - 2.\n\\end{equation}\nBy \\eqref{eq:2020A5eq2}, we may also assume $n \\geq 6$, so that $m \\geq 5$. We apply Lemma 1, keeping in mind that\n\\[\n(n-F_m) + (F_{m+1}-n-1) = F_{m-1}-1.\n\\]\nIf $\\max\\{n-F_m, F_{m+1}-n-1\\} \\geq F_{m-2}$, then one of the summands in \\eqref{eq:2020A5eq3} \nis at least $a_{F_{m-2}}$ (by the induction hypothesis) and the other is at least 2 (by \\eqref{eq:2020A5eq4} and the induction hypothesis),\nso \n\\[\na_n \\geq a_{F_{m-2}}+2 = \\left\\lfloor \\frac{m+4}{2} \\right\\rfloor. \n\\]\nOtherwise,\n$\\min\\{n-F_m, F_{m+1}-n-1\\} \\geq F_{m-3}$ and so by the induction hypothesis again,\n\\[\na_n \\geq 2a_{F_{m-3}} = 2 \\left\\lfloor \\frac{m-1}{2} \\right\\rfloor \\geq 2 \\frac{m-2}{2} \\geq \\left\\lfloor \\frac{m+2}{2} \\right\\rfloor. \\qedhere\n\\]\n\\end{proof}\n\nCombining Lemma 2 and Lemma 3, we deduce that for $n > F_{4040}-1$, we have $a_n \\geq a_{F_{4040}} = 2021$. This completes the proof.\n\n\\noindent\n\\textbf{Second solution.}\nWe again start with a computation of some special values of $a_n$.\n\n\\setcounter{lemma}{0}\n\\begin{lemma}\nFor all $m \\geq 1$,\n\\[\na_{F_m-1} = \\left\\lfloor \\frac{m+1}2 \\right\\rfloor\n\\]\n\\end{lemma}\n\\begin{proof}\nWe proceed by induction on $m$. The result holds for $m=1$ and $m=2$ by \\eqref{eq:2020A5eq2}. For $m>2$, among the sets $S$ counted by $a_{F_m-1}$,\nby \\eqref{eq:2020A5eq1} the only one not containing $m-1$ is $S=\\{1,2,\\ldots,m-2\\}$,\nand there are $a_{F_m-F_{m-1}-1}$ others. Therefore, \n\\begin{align*}\na_{F_m-1} &= a_{F_m-F_{m-1}-1} + 1\\\\\n& = a_{F_{m-2}-1}+1 = \\left\\lfloor \\frac{m-1}2 \\right\\rfloor+1 = \\left\\lfloor \\frac{m+1}2 \\right\\rfloor. \\qedhere\n\\end{align*}\n\\end{proof}\n\nGiven an arbitrary positive integer $n$,\ndefine the set $S_0$ as follows:\nstart with the largest $k_1$ for which $F_{k_1} \\leq n$, then add the largest $k_2$ for which $F_{k_1} + F_{k_2} \\leq n$, and so on,\nstopping once $\\sum_{k \\in S_0} F_k = n$.\nThen form the bitstring \n\\[\ns_n = \\cdots e_1 e_0, \\qquad e_k = \\begin{cases} 1 & k \\in S_0 \\\\\n0 & k \\notin S_0;\n\\end{cases}\n\\]\nnote that no two 1s in this string are consecutive. We can thus divide $s_n$ into segments\n\\[\nt_{k_1,\\ell_1} \\cdots t_{k_r, \\ell_r} \\qquad (k_i, \\ell_i \\geq 1)\n\\]\nwhere the bitstring $t_{k,\\ell}$ is given by\n\\[\nt_{k,\\ell} = (10)^k (0)^\\ell\n\\]\n(that is, $k$ repetitions of $10$ followed by $\\ell$ repetitions of 0).\nNote that $\\ell_r \\geq 1$ because $e_1 = e_0 = 0$.\n\nFor $a = 1,\\dots,k$ and $b = 0,\\dots,\\lfloor (\\ell-1)/2 \\rfloor$, we can replace $t_{k,\\ell}$ with the string\nof the same length\n\\[\n(10)^{k-a} (0) (1)^{2a-1} (01)^b 1 0^{\\ell -2b}\n\\]\nto obtain a new bitstring corresponding to a set $S$ with $\\sum_{k \\in S} F_k = n$. Consequently,\n\\begin{equation} \\label{eq:2020A5eq3}\na_n \\geq \\prod_{i=1}^r \\left( 1 + k_i \\left\\lfloor \\frac{\\ell_i+1}{2} \\right\\rfloor \\right).\n\\end{equation}\n\nFor integers $k,\\ell \\geq 1$, we have\n\\[\n1 + k \\left \\lfloor \\frac{\\ell+1}{2} \\right\\rfloor\n\\geq k + \\left \\lfloor \\frac{\\ell+1}{2} \\right\\rfloor \\geq 2.\n\\]\nCombining this with repeated use of the inequality\n\\[\nxy \\geq x+y \\qquad (x,y \\geq 2),\n\\]\nwe deduce that\n\\[\na_n \\geq \\sum_{i=1}^r \\left( k_i + \\left\\lfloor \\frac{\\ell_i+1}{2} \\right\\rfloor \\right)\n\\geq \\left\\lfloor \\frac{1 + \\sum_{i=1}^r (2k_i + \\ell_i)}{2} \\right\\rfloor.\n\\]\nIn particular, for any even $m \\geq 2$, we have $a_n > \\frac{m}2$ for all $n \\geq F_m$.\nTaking $m = 4040$ yields the desired result.\n\n\\noindent\n\\textbf{Remark.}\nIt can be shown with a bit more work that the set $S_0$ gives the unique representation of $n$ as a sum of distinct Virahanka--Fibonacci numbers, no two consecutive; this is commonly called the\n\\emph{Zeckendorf representation} of $n$, but was first described by Lekkerkerker.\nUsing this property, one can show that the lower bound in \\eqref{eq:2020A5eq3} is sharp.", "source_problems": "PUTNAM-2020-problems.tex", "source_solutions": "PUTNAM-2020-solutions.tex", "notes": ""}
{"id": "PUTNAM-2020-A6", "contest": "PUTNAM", "year": "2020", "problem_number": "A6", "problem": "For a positive integer $N$, let $f_N$\\footnote{Corrected from $F_N$ in the source.} be the function defined by \n\\[\nf_N(x) = \\sum_{n=0}^N \\frac{N+1/2-n}{(N+1)(2n+1)} \\sin((2n+1)x).\n\\]\nDetermine the smallest constant $M$ such that $f_N(x) \\leq M$ for all $N$ and all real $x$.", "solution": "The smallest constant $M$ is $\\pi/4$.\n\nWe start from the expression\n\\begin{equation} \\label{2020A6eq1}\nf_N(x) = \\sum_{n=0}^N \\frac{1}{2} \\left( \\frac{2}{2n+1} - \\frac{1}{N+1} \\right) \\sin((2n+1)x).\n\\end{equation}\nNote that if $\\sin(x) > 0$, then\n\\begin{align*}\n\\sum_{n=0}^N \\sin((2n+1)x) &= \\frac{1}{2i} \\sum_{n=0}^N (e^{i(2n+1)x} - e^{-i(2n+1)x}) \\\\\n&= \\frac{1}{2i} \\left( \\frac{e^{i(2N+3)x} - e^{ix}}{e^{2ix} - 1}  -\n\\frac{e^{-i(2N+3)x} - e^{-ix}}{e^{-2ix} - 1} \\right) \\\\\n&=\\frac{1}{2i} \\left( \\frac{e^{i(2N+2)x} - 1}{e^{ix} - e^{-ix}}  -\n\\frac{e^{-i(2N+2)x} - 1}{e^{-ix} - e^{ix}} \\right) \\\\\n&=\\frac{1}{2i} \\frac{e^{i(2N+2)x}+ e^{-i(2N+2)x} - 2}{e^{ix} - e^{-ix}} \\\\\n&= \\frac{2 \\cos ((2N+2)x) - 2}{2i(2i \\sin(x))} \\\\\n&= \\frac{1 - \\cos ((2N+2)x)}{2\\sin(x)} \\geq 0.\n\\end{align*}\nWe use this to compare the expressions of $f_N(x)$ and $f_{N+1}(x)$ given by \\eqref{2020A6eq1}.\nFor $x \\in (0, \\pi)$ with $\\sin((2N+3)x) \\geq 0$, we may omit the summand $n=N+1$ from $f_{N+1}(x)$ to obtain\n\\begin{align*}\n& f_{N+1}(x) - f_N(x) \\\\\n&\\geq \\frac{1}{2}  \\left( \\frac{1}{N+1} - \\frac{1}{N+2} \\right) \\sum_{n=0}^N \\sin((2n+1)x) \\geq 0.\n\\end{align*}\nFor $x \\in (0, \\pi)$ with $\\sin((2N+3)x) \\leq 0$, we may insert the summand $n=N+1$ into $f_{N+1}(x)$ to obtain\n\\begin{align*}\n&f_{N+1}(x) - f_N(x) \\\\\n&\\geq \\frac{1}{2}  \\left( \\frac{1}{N+1} - \\frac{1}{N+2} \\right) \\sum_{n=0}^{N+1} \\sin((2n+1)x) \\geq 0.\n\\end{align*}\nIn either case, we deduce that for $x \\in (0, \\pi)$, the sequence $\\{f_N(x)\\}_N$ is nondecreasing.\n\nNow rewrite \\eqref{2020A6eq1} as \n\\begin{equation} \\label{2020A6eq2}\nf_N(x) = \\sum_{n=0}^N \\frac{ \\sin((2n+1)x) }{2n+1}- \\frac{1-\\cos((2N+2)x)}{4(N+1) \\sin(x)}\n\\end{equation}\nand note that the last term tends to 0 as $N \\to \\infty$.\nConsequently, $\\lim_{N \\to \\infty} f_N(x)$ equals the sum of the series\n\\[\n\\sum_{n=0}^\\infty \\frac{1}{2n+1} \\sin((2n+1)x),\n\\]\nwhich is the Fourier series for the ``square wave'' function defined on $(-\\pi, \\pi]$ by\n\\[\nx \\mapsto \\begin{cases} -\\frac{\\pi}{4} & x \\in (-\\pi, 0) \\\\\n\\frac{\\pi}{4} & x \\in (0, \\pi) \\\\\n0 & x = 0, \\pi\n\\end{cases}\n\\]\nand extended periodically. Since this function is continuous on $(0, \\pi)$, we deduce that the Fourier series converges to the value of the function; that is,\n\\[\n\\lim_{N \\to \\infty} f_N(x) = \\frac{\\pi}{4} \\qquad (x \\in (0, \\pi)).\n\\]\nThis is enough to deduce the desired result as follows. \nSince\n\\[\nf_N(x+2\\pi) = f_N(x), \\qquad f_N(-x) = -f_N(x),\n\\]\nit suffices to check the bound $f_N(x) \\leq \\pi$ for $x \\in (-\\pi, \\pi]$.\nFor $x = 0, \\pi$ we have $f_N(x) = 0$ for all $N$.\nFor $x \\in (-\\pi, 0)$, the previous arguments imply that\n\\[\n0 \\geq f_0(x) \\geq f_1(x) \\geq \\cdots\n\\]\nFor $x \\in (0, \\pi)$, the previous arguments imply that\n\\[\n0 \\leq f_0(x) \\leq f_1(x) \\leq \\cdots \\leq \\frac{\\pi}{4}\n\\]\nand the limit is equal to $\\pi/4$. We conclude that $f_N(x) \\leq M$ holds for $M = \\pi/4$ but not for any smaller $M$, as desired.\n\n\\noindent\n\\textbf{Remark.}\nIt is also possible to replace the use of the convergence of the Fourier series with a more direct argument; it is sufficient to do this for $x$ in a dense subset of $(0, \\pi)$, such as the rational multiples of $\\pi$.\n\nAnother alternative (described at \\url{https://how-did-i-get-here.com/2020-putnam-a6/})\nis to deduce from \\eqref{2020A6eq2} and a second geometric series computation (omitted here) that\n\\begin{align*}\nf'_N(x) &= \\sum_{n=0}^N \\cos((2n+1)x) - \\frac{d}{dx} \\left( \\frac{1-\\cos((2N+2)x)}{4(N+1) \\sin(x)} \\right) \\\\\n&=\\frac{\\sin((2N+2)x)}{2\\sin(x)} \\\\\n&\\qquad - \\frac{(2N+2)\\sin((2N+2)x) - \\cos(x) (1-\\cos((N+2)x)}{4(N+1)\\sin(x)^2} \\\\\n&= \\frac{\\cos(x) (1-\\cos((N+2)x)}{4(N+1)\\sin(x)^2},\n\\end{align*}\nwhich is nonnegative for $x \\in (0, \\pi/2]$ and nonpositive for $x \\in [\\pi/2, \\pi)$.\nThis implies that $f_N(x)$ always has a global maximum at $x = \\pi/2$, so it suffices to check the\nconvergence of the Fourier series for the square wave at that point. This reduces to the Madhava--Gregory--Newton series evaluation\n\\[\n1 - \\frac{1}{3} + \\frac{1}{5} - \\frac{1}{7} + \\cdots = \\arctan(1) = \\frac{\\pi}{4}.\n\\]", "source_problems": "PUTNAM-2020-problems.tex", "source_solutions": "PUTNAM-2020-solutions.tex", "notes": ""}
{"id": "PUTNAM-2020-B1", "contest": "PUTNAM", "year": "2020", "problem_number": "B1", "problem": "For a positive integer $n$, define $d(n)$ to be the sum of the digits of $n$ when written in binary (for example, $d(13) = 1+1+0+1=3)$. Let\n\\[\nS = \\sum_{k=1}^{2020} (-1)^{d(k)} k^3.\n\\]\nDetermine $S$ modulo 2020.", "solution": "Note that\n$$\n(1-x)(1-x^2)(1-x^4)\\cdots(1-x^{1024})=\\sum_{k=0}^{2047}(-1)^{d(k)}x^k\n$$\nand\n$$\nx^{2016}(1-x)(1-x^2)\\cdots(1-x^{16})=\\sum_{k=2016}^{2047}(-1)^{d(k)}x^k.\n$$\nApplying $x\\frac{d}{dx}$ to both sides of each of these two equations three times, and then setting $x=1$, shows that\n$$\n\\sum_{k=0}^{2047}(-1)^{d(k)}k^3 = \\sum_{k=2016}^{2047}(-1)^{d(k)}k^3 = 0,\n$$\nand therefore\n$$\n\\sum_{k=1}^{2015}(-1)^{d(k)}k^3 = 0.\n$$\nHence we may write\n\\begin{align*}\nS &=\\sum_{k=2016}^{2020}(-1)^{d(k)}k^3 \\\\\n &= \\sum_{k=0}^4 (-1)^{d(k)} (k+2016)^3 \\\\\n&\\equiv (-4)^3 + (-1)(-3)^3+(-1)(-2)^3+(1)(-1)^3 \\\\\n&= -64+27+8-1 \\\\\n&\\equiv -30\\equiv 1990\\pmod{2020}.\n\\end{align*}\n\n\\noindent\n\\textbf{Remark.} The function $d(n)$ appears in the OEIS as sequence A000120.", "source_problems": "PUTNAM-2020-problems.tex", "source_solutions": "PUTNAM-2020-solutions.tex", "notes": ""}
{"id": "PUTNAM-2020-B2", "contest": "PUTNAM", "year": "2020", "problem_number": "B2", "problem": "Let $k$ and $n$ be integers with $1 \\leq k < n$. Alice and Bob play a game with $k$ pegs in a line of $n$ holes. At the beginning of the game, the pegs occupy the $k$ leftmost holes. A legal move consists of moving a single peg\nto any vacant hole that is further to the right. The players alternate moves, with Alice playing first. The game ends when the pegs are in the $k$ rightmost holes, so whoever is next to play cannot move and therefore loses. For what values\nof $n$ and $k$ does Alice have a winning strategy?", "solution": "We refer to this two-player game, with $n$ holes and $k$ pegs, as the \\emph{$(n,k)$-game}.\nWe will show that Alice has a winning strategy for the $(n,k)$-game if and only if at least one of $n$ and $k$ is odd; otherwise Bob has a winning strategy.\n\nWe reduce the first claim to the second as follows. If $n$ and $k$ are both odd, then Alice can move the $k$-th peg to the last hole; this renders the last hole, and the peg in it, totally out of play, thus reducing the $(n,k)$-game to the $(n-1,k-1)$-game, for which Alice now has a winning strategy by the second claim. Similarly, if $n$ is odd but $k$ is even, then Alice may move the first peg to the $(k+1)$-st hole, removing the first hole from play and reducing the $(n,k)$-game to the $(n-1,k)$ game. Finally, if $n$ is even but $k$ is odd, then Alice can move the first peg to the last hole, taking the first and last holes, and the peg in the last hole, out of play, and reducing the $(n,k)$-game to the $(n-2,k-1)$-game.\n\nWe now assume $n$ and $k$ are both even and describe a winning strategy for the $(n,k)$-game for Bob.\nSubdivide the $n$ holes into $n/2$ disjoint pairs of adjacent holes. Call a configuration of $k$ pegs \\textit{good} if for each pair of holes, both or neither is occupied by pegs, and note that the starting position is good. Bob can ensure that after each of his moves, he leaves Alice with a good configuration: presented with a good configuration, Alice must move a peg from a pair of occupied holes to a hole in an unoccupied pair; then Bob can move the other peg from the first pair to the remaining hole in the second pair, resulting in another good configuration. In particular, this ensures that Bob always has a move to make. Since the game must terminate, this is a winning strategy for Bob.", "source_problems": "PUTNAM-2020-problems.tex", "source_solutions": "PUTNAM-2020-solutions.tex", "notes": ""}
{"id": "PUTNAM-2020-B3", "contest": "PUTNAM", "year": "2020", "problem_number": "B3", "problem": "Let $x_0 = 1$, and let $\\delta$ be some constant satisfying $0 < \\delta < 1$. Iteratively, for $n=0,1,2,\\dots$, a point $x_{n+1}$ is chosen uniformly from the interval $[0, x_n]$. Let $Z$ be the smallest value of $n$ for which $x_n < \\delta$.\nFind the expected value of $Z$, as a function of $\\delta$.", "solution": "Let $f(\\delta)$ denote the desired expected value of $Z$ as a function of $\\delta$.\nWe prove that $f(\\delta) = 1-\\log(\\delta)$, where $\\log$ denotes natural logarithm.\n\nFor $c \\in [0,1]$, let $g(\\delta,c)$ denote the expected value of $Z$ given that $x_1=c$, and note that $f(\\delta) = \\int_0^1 g(\\delta,c)\\,dc$. Clearly $g(\\delta,c) = 1$ if $c<\\delta$. On the other hand, if $c\\geq\\delta$, then $g(\\delta,c)$ is $1$ more than the expected value of $Z$ would be if we used the initial condition $x_0=c$ rather than $x_0=1$. By rescaling the interval $[0,c]$ linearly to $[0,1]$ and noting that this sends $\\delta$ to $\\delta/c$, we see that this latter expected value is equal to $f(\\delta/c)$. That is, for $c\\geq\\delta$, $g(\\delta,c) = 1+f(\\delta/c)$. It follows that we have\n\\begin{align*}\nf(\\delta) &= \\int_0^1 g(\\delta,c)\\,dc  \\\\\n&= \\delta + \\int_\\delta^1 (1+f(\\delta/c))\\,dc = 1+\\int_\\delta^1 f(\\delta/c)\\,dc.\n\\end{align*}\nNow define $h :\\thinspace [1,\\infty) \\to \\mathbb{R}$ by $h(x) = f(1/x)$; then we have\n\\[\nh(x) = 1+\\int_{1/x}^1 h(cx)\\,dc = 1+\\frac{1}{x}\\int_1^x h(c)\\,dc.\n\\]\nRewriting this as $xh(x)-x = \\int_1^x h(c)\\,dc$ and differentiating with respect to $x$ gives\n$h(x)+xh'(x)-1 = h(x)$, whence $h'(x) = 1/x$ and so $h(x) = \\log(x)+C$ for some constant $C$. Since $h(1)=f(1)=1$, we conclude that $C=1$, $h(x) = 1+\\log(x)$, and finally\n$f(\\delta) = 1-\\log(\\delta)$. This gives the claimed answer.", "source_problems": "PUTNAM-2020-problems.tex", "source_solutions": "PUTNAM-2020-solutions.tex", "notes": ""}
{"id": "PUTNAM-2020-B4", "contest": "PUTNAM", "year": "2020", "problem_number": "B4", "problem": "Let $n$ be a positive integer, and let $V_n$ be the set of integer $(2n+1)$-tuples $\\mathbf{v} = (s_0, s_1, \\cdots, s_{2n-1}, s_{2n})$ for which $s_0 = s_{2n} = 0$ and $|s_j - s_{j-1}| = 1$ for $j=1,2,\\cdots,2n$. Define\n\\[\nq(\\mathbf{v}) = 1 + \\sum_{j=1}^{2n-1} 3^{s_j},\n\\]\nand let $M(n)$ be the average of $\\frac{1}{q(\\mathbf{v})}$ over all $\\mathbf{v} \\in V_n$. Evaluate $M(2020)$.", "solution": "The answer is $\\frac{1}{4040}$. We will show the following more general fact. Let $a$ be any nonzero number and define $q(\\mathbf{v}) = 1+\\sum_{j=1}^{2n-1} a^{s_j}$; then the average of $\\frac{1}{q(\\mathbf{v})}$ over all $\\mathbf{v} \\in V_n$ is equal to $\\frac{1}{2n}$, independent of $a$.\n\nLet $W_n$ denote the set of $(2n)$-tuples $\\mathbf{w} = (w_1,\\ldots,w_{2n})$ such that $n$ of the $w_i$'s are equal to $+1$ and the other $n$ are equal to $-1$. Define a map $\\phi :\\thinspace W_n \\to W_n$ by $\\phi(w_1,w_2,\\ldots,w_{2n}) = (w_2,\\ldots,w_{2n},w_1)$; that is, $\\phi$ moves the first entry to the end. For $\\mathbf{w} \\in W_n$, define the \\textit{orbit} of $\\mathbf{w}$ to be the collection of elements of $W_n$ of the form $\\phi^k(\\mathbf{w})$, $k \\geq 1$, where $\\phi^k$ denotes the $k$-th iterate of $\\phi$, and note that $\\phi^{2n}(\\mathbf{w}) = \\mathbf{w}$. Then $W_n$ is a disjoint union of orbits. For a given $\\mathbf{w} \\in W_n$, the orbit of $\\mathbf{w}$ consists of $\\mathbf{w},\\phi(\\mathbf{w}),\\ldots,\\phi^{m-1}(\\mathbf{w})$, where $m$ is the smallest positive integer with $\\phi^m(\\mathbf{w}) = \\mathbf{w}$; the list $\\phi(\\mathbf{w}),\\ldots,\\phi^{2n}(\\mathbf{w})$ runs through the orbit of $\\mathbf{w}$ completely $2n/m$ times, with each element of the orbit appearing the same number of times.\n\nNow define the map $f :\\thinspace W_n \\to V_n$ by $f(\\mathbf{w}) = \\mathbf{v} = (s_0,\\ldots,s_{2n})$ with $s_j = \\sum_{i=1}^j w_i$; this is a one-to-one correspondence between $W_n$ and $V_n$, with the inverse map given by $w_j = s_j-s_{j-1}$ for $j=1,\\ldots,2n$. We claim that for any $\\mathbf{w} \\in W_n$, the average of $\\frac{1}{q(\\mathbf{v})}$, where $\\mathbf{v}$ runs over vectors in the image of the orbit of $\\mathbf{w}$ under $f$, is equal to $\\frac{1}{2n}$. Since $W_n$ is a disjoint union of orbits, $V_n$ is a disjoint union of the images of these orbits under $f$, and it then follows that the overall average of $\\frac{1}{q(\\mathbf{v})}$ over $\\mathbf{v} \\in V_n$ is $\\frac{1}{2n}$.\n\nTo prove the claim, we compute the average of $\\frac{1}{q(f(\\phi^k(\\mathbf{w})))}$ over $k=1,\\ldots,2n$; since $\\phi^k(\\mathbf{w})$ for $k=1,\\ldots,2n$ runs over the orbit of $\\mathbf{w}$ with each element in the orbit appearing equally, this is equal to the desired average. Now if we adopt the convention that the indices in $w_i$ are considered mod $2n$, so that $w_{2n+i} = w_i$ for all $i$, then the $i$-th entry of $\\phi^k(\\mathbf{w})$ is $w_{i+k}$; we can then define $s_j = \\sum_{i=1}^j w_i$ for all $j\\geq 1$, and $s_{2n+i}=s_i$ for all $i$ since $\\sum_{i=1}^{2n} w_i = 0$. We now have\n\\[\nq(f(\\phi^k(\\mathbf{w}))) = \\sum_{j=1}^{2n} a^{\\sum_{i=1}^j w_{i+k}} = \\sum_{j=1}^{2n} a^{s_{j+k}-s_k} = a^{-s_k} \\sum_{j=1}^{2n} a^{s_j}.\n\\]\n\nThus\n\\[\n\\sum_{k=1}^{2n} \\frac{1}{q(f(\\phi^k(\\mathbf{w})))} = \\sum_{k=1}^{2n} \\frac{a^{s_k}}{\\sum_{j=1}^{2n} a^{s_j}} = 1,\n\\]\nand the average of $\\frac{1}{q(f(\\phi^k(\\mathbf{w})))}$ over $k=1,\\ldots,2n$ is $\\frac{1}{2n}$, as desired.", "source_problems": "PUTNAM-2020-problems.tex", "source_solutions": "PUTNAM-2020-solutions.tex", "notes": ""}
{"id": "PUTNAM-2020-B5", "contest": "PUTNAM", "year": "2020", "problem_number": "B5", "problem": "For $j \\in \\{1, 2, 3, 4\\}$, let $z_j$ be a complex number with $|z_j| = 1$ and $z_j \\neq 1$. Prove that\n\\[\n3 - z_1 - z_2 - z_3 - z_4 + z_1 z_2 z_3 z_4 \\neq 0.\n\\]", "solution": "\\noindent\n\\textbf{First solution.} (by Mitja Mastnak)\nIt will suffice to show that for any $z_1, z_2, z_3, z_4 \\in \\CC$ of modulus 1 such that $|3-z_1-z_2-z_3-z_4| = |z_1z_2z_3z_4|$, at least one of $z_1, z_2, z_3$ is equal to 1.\n\nTo this end, let $z_1=e^{\\alpha i}, z_2=e^{\\beta i}, z_3=e^{\\gamma i}$ and \n\\[\nf(\\alpha, \\beta, \\gamma)=|3-z_1-z_2-z_3|^2-|1-z_1z_2z_3|^2.\n\\]\\\n A routine calculation shows that \n\\begin{align*}\nf(\\alpha, \\beta, \\gamma)&=\n10 - 6\\cos(\\alpha) - 6\\cos(\\beta) - 6\\cos(\\gamma) \\\\\n&\\quad + 2\\cos(\\alpha + \\beta + \\gamma) + 2\\cos(\\alpha - \\beta) \\\\\n&\\quad + 2\\cos(\\beta - \\gamma) + 2\\cos(\\gamma - \\alpha).\n\\end{align*}\nSince the function $f$ is continuously differentiable, and periodic in each variable, $f$ has a maximum and a minimum and it attains these values only at points where $\\nabla f=(0,0,0)$.  A routine calculation now shows that \n\\begin{align*}\n\\frac{\\partial f}{\\partial \\alpha} + \\frac{\\partial f}{\\partial \\beta} + \\frac{\\partial f}{\\partial \\gamma} &=\n6(\\sin(\\alpha) +\\sin(\\beta)+\\sin(\\gamma)-  \\sin(\\alpha + \\beta + \\gamma)) \\\\\n&=\n24\\sin\\left(\\frac{\\alpha+\\beta}{2}\\right) \\sin\\left(\\frac{\\beta+\\gamma}{2}\\right)\n\\sin\\left(\\frac{\\gamma+\\alpha}{2}\\right).\n\\end{align*}\nHence every critical point of $f$ must satisfy one of $z_1z_2=1$, $z_2z_3=1$, or $z_3z_1=1$. By symmetry, let us assume that $z_1z_2=1$. Then \n\\[\nf = |3-2\\mathrm{Re}(z_1)-z_3|^2-|1-z_3|^2;\n\\]\nsince $3-2\\mathrm{Re}(z_1)\\ge 1$, $f$ is nonnegative and can be zero only if the real part of $z_1$, and hence also $z_1$ itself, is equal to $1$. \n\n\\noindent\n\\textbf{Remark.}\nIf $z_1 = 1$, we may then apply the same logic to deduce that one of $z_2,z_3,z_4$ is equal to 1. If $z_1 = z_2 = 1$, we may factor the expression\n\\[\n3 - z_1 - z_2 - z_3 - z_4 + z_1 z_2 z_3 z_4\n\\]\nas $(1 - z_3)(1-z_4)$ to deduce that at least three of $z_1, \\dots, z_4$ are equal to $1$.\n\n\\noindent\n\\textbf{Second solution.}\nWe begin with an ``unsmoothing'' construction.\n\\setcounter{lemma}{0}\n\\begin{lemma}\nLet $z_1,z_2,z_3$ be three distinct complex numbers with $|z_j|= 1$ and $z_1 + z_2 + z_3 \\in [0, +\\infty)$. Then there exist another three complex numbers $z'_1, z'_2, z'_3$, not all distinct, with\n$|z'_j| = 1$ and\n\\[\nz'_1 + z'_2 + z'_3 \\in (z_1+ z_2 + z_3, +\\infty), \\quad z_1 z_2 z_3 = z'_1 z'_2 z'_3.\n\\]\n\\end{lemma}\n\\begin{proof}\nWrite $z_j = e^{i \\theta_j}$ for $j=1,2,3$. \nWe are then trying to maximize the target function\n\\[\n\\cos \\theta_1 + \\cos \\theta_2 + \\cos \\theta_3\n\\]\ngiven the constraints\n\\begin{align*}\n0 &= \\sin \\theta_1 + \\sin \\theta_2 + \\sin \\theta_3\\\\\n* &= \\theta_1 + \\theta_2 + \\theta_3\n\\end{align*}\nSince $z_1, z_2, z_3$ run over a compact region without boundary, the maximum must be achieved at a point where the matrix\n\\[\n\\begin{pmatrix}\n\\sin \\theta_1 & \\sin \\theta_2 & \\sin \\theta_3 \\\\\n\\cos \\theta_1 & \\cos \\theta_2 & \\cos \\theta_3 \\\\\n1 & 1 & 1\n\\end{pmatrix}\n\\]\nis singular. Since the determinant of this matrix computes (up to a sign and a factor of 2) the area of the triangle with vertices $z_1, z_2, z_3$,\nit cannot vanish unless some two of $z_1, z_2, z_3$ are equal. This proves the claim.\n\\end{proof}\n\nFor $n$ a positive integer, let $H_n$ be the \\emph{hypocycloid curve} in $\\CC$ given by\n\\[\nH_n = \\{(n-1) z + z^{-n+1}: z \\in \\CC, |z| = 1\\}.\n\\]\nIn geometric terms, $H_n$ is the curve traced out by a marked point on a circle of radius 1 rolling one full circuit along the interior of a circle of radius 1, starting from the point $z=1$.\nNote that the interior of $H_n$ is not convex, but it is \\emph{star-shaped}: it is closed under multiplication by any number in $[0,1]$.\n\n\\begin{lemma}\nFor $n$ a positive integer, let $S_n$ be the set of complex numbers of the form $w_1 + \\cdots + w_n$ for some $w_1,\\dots,w_n \\in \\CC$ with\n$|w_j| = 1$ and $w_1 \\cdots w_n = 1$. Then for $n \\leq 4$, $S_n$ is the closed interior of $H_n$ (i.e., including the boundary).\n\\end{lemma}\n\\begin{proof}\nBy considering $n$-tuples of the form $(z,\\dots,z,z^{-n+1})$, we see that $H_n \\subseteq S_n$.\nIt thus remains to check that $S_n$ lies in the closed interior of $H_n$.\nWe ignore the easy cases $n=1$ (where $H_1 = S_1 = \\{1\\}$) and $n=2$ (where $H_2 = S_2 = [-2,2]$)\nand assume hereafter that $n \\geq 3$.\n\nBy Lemma 1, for each ray emanating from the the origin, the extreme intersection point of $S_n$ with this ray (which exists because $S_n$ is compact) is achieved by some tuple $(w_1,\\dots,w_n)$ with at most two distinct values.\nFor $n=3$, this immediately implies that this point lies on $H_n$. For $n=4$, we must also consider tuples consisting of two pairs of equal values; however, these only give rise to points in $[-4, 4]$, which are indeed contained in $H_4$.\n\\end{proof}\n\nTurning to the original problem, consider $z_1,\\dots,z_4 \\in \\CC$ with $|z_j| = 1$ and \n\\[\n3 - z_1 - z_2 - z_3 - z_4 + z_1 z_2 z_3 z_4 = 0;\n\\]\nwe must prove that at least one $z_j$ is equal to 1.\nLet $z$ be any fourth root of $z_1 z_2 z_3 z_4$,\nput $w_j = z_j/z$, and put $s = w_1 + \\cdots + w_4$. In this notation, we have\n\\[\ns = z^3 + 3z^{-1},\n\\]\nwhere $s \\in S_4$ and $z^3 + 3z^{-1} \\in H_4$. That is, $s$ is a boundary point of $S_4$, so in particular it is the extremal point of $S_4$ on the ray emanating from the origin through $s$.\nBy Lemma 1, this implies that $w_1,\\dots,w_4$ take at most two distinct values. As in the proof of Lemma 2, we distinguish two cases.\n\\begin{itemize}\n\\item\nIf $w_1 = w_2 = w_3$, then\n\\[\nw_1^{-3} + 3w_1 = z^3 + 3z^{-1}.\n\\]\nFrom the geometric description of $H_n$, we see that this forces $w_1^{-1} = z$ and hence $z_1 = 1$.\n\n\\item\nIf $w_1 = w_2$ and $w_3 = w_4$, then $s \\in [-4, 4]$ and hence $s = \\pm 4$. This can only be achieved by taking $w_1 = \\cdots = w_4 = \\pm 1$;\nsince $s = z^3 + 3z^{-1}$ we must also have $z = \\pm 1$, yielding $z_1 = \\cdots = z_4 = 1$.\n\\end{itemize}\n\n\\noindent\n\\textbf{Remark.}\nWith slightly more work, one can show that Lemma 2 remains true for all positive integers $n$.\nThe missing extra step is to check that for $m=1,\\dots,n-1$, the hypocycloid curve\n\\[\n\\{m z^{n-m} + (n-m) z^{-m}: z \\in \\CC, |z| = 1\\}\n\\]\nis contained in the filled interior of $H_n$. In fact, this curve only touches $H_n$ at points where they both touch the unit circle (i.e., at $d$-th roots of unity for $d = \\gcd(m,n)$);\nthis can be used to formulate a corresponding version of the original problem, which we leave to the reader.", "source_problems": "PUTNAM-2020-problems.tex", "source_solutions": "PUTNAM-2020-solutions.tex", "notes": ""}
{"id": "PUTNAM-2020-B6", "contest": "PUTNAM", "year": "2020", "problem_number": "B6", "problem": "Let $n$ be a positive integer. Prove that\n\\[\n\\sum_{k=1}^n (-1)^{\\lfloor k(\\sqrt{2}-1) \\rfloor} \\geq 0.\n\\]\n(As usual, $\\lfloor x \\rfloor$ denotes the greatest integer less than or equal to $x$.)\n\n\\end{itemize}\n\n\\end{document}", "solution": "\\noindent\n\\textbf{First solution.}\nDefine the sequence $\\{a_k\\}_{k=0}^\\infty$ by $a_k = \\lfloor k(\\sqrt{2}-1)\\rfloor$. The first few terms of the sequence $\\{(-1)^{a_k}\\}$ are\n\\[\n1,1,1,-1,-1,1,1,1,-1,-1,1,1,1,\\ldots.\n\\]\nDefine a new sequence $\\{c_i\\}_{i=0}^\\infty$ given by $3,2,3,2,3,\\ldots$, whose members alternately are the lengths of the clusters of consecutive $1$'s and the lengths of the clusters of consecutive $-1$'s in the sequence $\\{(-1)^{a_k}\\}$. Then for any $i$, $c_0+\\cdots+c_i$ is the number of nonnegative integers $k$ such that $\\lfloor k(\\sqrt{2}-1) \\rfloor$ is strictly less than $i+1$, i.e., such that $k(\\sqrt{2}-1)<i+1$. This last condition is equivalent to $k<(i+1)(\\sqrt{2}+1)$, and we conclude that \\begin{align*}\nc_0+\\cdots+c_i &= \\lfloor (i+1)(\\sqrt{2}+1)\\rfloor  + 1 \\\\\n&= 2i+3+\\lfloor (i+1)(\\sqrt{2}-1)\\rfloor.\n\\end{align*}\nThus for $i>0$,\n\\begin{equation} \\label{eq:2020B6eq1}\nc_i =2+\\lfloor (i+1)(\\sqrt{2}-1)\\rfloor-\\lfloor i(\\sqrt{2}-1) \\rfloor.\n\\end{equation}\nNow note that $\\lfloor (i+1)(\\sqrt{2}-1)\\rfloor-\\lfloor i(\\sqrt{2}-1) \\rfloor$ is either $1$ or $0$ depending on whether or not there is an integer $j$ between $i(\\sqrt{2}-1)$ and $(i+1)(\\sqrt{2}-1)$: this condition is equivalent to $i<j(\\sqrt{2}+1)<i+1$. That is, for $i>0$,\n\\begin{equation} \\label{eq:2020B6eq3}\nc_i = \\begin{cases} 3 & \\text{if } i=\\lfloor j(\\sqrt{2}+1)\\rfloor \\text{ for some integer }j, \\\\\n2 &\\text{otherwise};\n\\end{cases}\n\\end{equation}\nby inspection, this also holds for $i=0$.\n\nNow we are asked to prove that\n\\begin{equation}\\label{eq:2020B6eq2}\n\\sum_{k=0}^n (-1)^{a_k} \\geq 1\n\\end{equation}\nfor all $n\\geq 1$. We will prove that if \\eqref{eq:2020B6eq2} holds for all $n\\leq N$, then \\eqref{eq:2020B6eq2} holds for all $n\\leq 4N$; since \\eqref{eq:2020B6eq2} clearly holds for $n=1$, this will imply the desired result.\n\nSuppose that \\eqref{eq:2020B6eq2} holds for $n\\leq N$. To prove that \\eqref{eq:2020B6eq2} holds for $n\\leq 4N$, it suffices to show that the partial sums\n\\[\n\\sum_{i=0}^m (-1)^i c_i\n\\]\nof the sequence $\\{(-1)^{a_k}\\}$ are positive for all $m$ such that $c_0+\\cdots+c_{m-1}<4N+3$, since these partial sums cover all clusters through $a_{4N}$. Now if $c_0+\\cdots+c_{m-1}<4N+3$, then since each $c_i$ is at least $2$, we must have $m<2N+2$. From \\eqref{eq:2020B6eq3}, we see that if $m$ is odd, then\n\\begin{align*}\n\\sum_{i=0}^m (-1)^i c_i &= \\sum_{i=0}^m (-1)^i (c_i-2) \\\\\n&= \\sum_j (-1)^{\\lfloor j(\\sqrt{2}+1)\\rfloor} = \\sum_j (-1)^{a_j}\n\\end{align*}\nwhere the sum in $j$ is over nonnegative integers $j$ with $j(\\sqrt{2}+1) < m$, i.e., $j <m(\\sqrt{2}-1)$; since $m(\\sqrt{2}-1)<m/2<N+1$,\n$\\sum_j (-1)^{a_j}$ is positive by the induction hypothesis. Similarly, if $m$ is even, then $\\sum_{i=0}^m (-1)^i c_i = c_m+ \\sum_j (-1)^{a_j}$ and this is again positive by the induction hypothesis. This concludes the induction step and the proof.\n\n\\noindent\n\\textbf{Remark.}\nMore generally, using the same proof we can establish the result with $\\sqrt{2}-1$ replaced by $\\sqrt{n^2+1}-n$ for any positive integer $n$.\n\n\n\\noindent\n\\textbf{Second solution.}\nFor $n \\geq 0$, define the function \n\\[\nf(n) = \\sum_{k=1}^n (-1)^{\\lfloor k (\\sqrt{2}-1) \\rfloor}\n\\]\nwith the convention that $f(0) = 0$.\n\nDefine the sequence $q_0, q_1, \\dots$ by the initial conditions\n\\[\nq_0 = 0, q_1 = 1\n\\]\nand the recurrence relation\n\\[\n\\qquad q_j = 2q_{j-1} + q_{j-2}.\n\\]\nThis is OEIS sequence A000129; its first few terms are\n\\[\n0,1,2,5,12,29,70,\\dots.\n\\]\nNote that $q_j \\equiv j \\pmod{2}$.\n\nWe now observe that the fractions $q_{j-1}/q_j$ are the \\emph{convergents} of the continued fraction expansion of $\\sqrt{2}-1$.\nThis implies the following additional properties of the sequence.\n\\begin{itemize}\n\\item\nFor all $j \\geq 0$, \n\\[\n\\frac{q_{2j}}{q_{2j+1}} < \\sqrt{2}-1 < \\frac{q_{2j+1}}{q_{2j+2}}.\n\\]\n\\item\nThere is no fraction $r/s$ with $s < q_j + q_{j+1}$ such that\n$\\frac{r}{s}$ separates $\\sqrt{2}-1$ from $q_j/q_{j-1}$. In particular, for $k < q_j + q_{j+1}$,\n\\[\n\\lfloor k (\\sqrt{2}-1) \\rfloor = \\left\\lfloor \\frac{kq_{j-1}}{q_j} \\right\\rfloor\n\\]\nexcept when $j$ is even and $k \\in \\{q_j, 2q_j\\}$, in which case they differ by 1.\n\\end{itemize}\n\nWe use this to deduce a ``self-similarity'' property of $f(n)$.\n\\setcounter{lemma}{0}\n\\begin{lemma}\nLet $n,j$ be nonnegative integers with $q_j \\leq n < q_j + q_{j+1}$.\n\\begin{itemize}\n\\item[(a)]\nIf $j$ is even, then\n\\[\nf(n) = f(q_j) - f(n-q_j).\n\\]\n\\item[(b)]\nIf $j$ is odd, then\n\\[\nf(n) = f(n-q_{j}) + 1.\n\\]\n\\end{itemize}\n\\end{lemma}\n\\begin{proof}\nIf $j$ is even, then\n\\begin{align*}\nf(n) &= f(q_j) + \\sum_{k=q_j+1}^n (-1)^{\\lfloor k(\\sqrt{2}-1) \\rfloor} \\\\\n&= f(q_j) + \\sum_{k=q_j+1}^n (-1)^{\\lfloor kq_{j-1}/q_j \\rfloor} + *\n\\end{align*}\nwhere $*$ equals 2 if $n \\geq 2q_j$ (accounting for the term $k = 2q_j$) and 0 otherwise.\nContinuing,\n\\begin{align*}\nf(n)\n&= f(q_j) + \\sum_{1}^{n-q_j} (-1)^{q_{j-1} + \\lfloor kq_{j-1}/q_j \\rfloor} + * \\\\\n&= f(q_j) - \\sum_{1}^{n-q_j} (-1)^{q_{j-1} + \\lfloor k(\\sqrt{2}-1) \\rfloor}\\\\\n&= f(q_j) - f(n-q_j).\n\\end{align*}\nIf $j$ is odd, then\n\\begin{align*}\nf(n) &= f(n-q_j) + \\sum_{k=n-q_j+1}^n (-1)^{\\lfloor k(\\sqrt{2}-1) \\rfloor} \\\\\n&= f(n-q_j) -2 + \\sum_{k=n-q_j+1}^n (-1)^{\\lfloor kq_{j-1}/q_j \\rfloor}.\n\\end{align*}\nSince \n\\[\n\\lfloor (k+q_j)q_{j-1}/q_j \\rfloor \\equiv \\lfloor kq_{j-1}/q_j \\rfloor \\pmod{2},\n\\]\nwe also have\n\\[\nf(n) = f(n-q_j) + \\sum_{k=1}^{q_j} (-1)^{\\lfloor kq_{j-1}/q_j \\rfloor}.\n\\]\nIn this sum, the summand indexed by $q_j$ contributes 1, and the summands indexed by $k$ and $q_j-k$ cancel each other out for \n$k=1,\\dots,q_j-1$. We thus have\n\\[\nf(n) = f(n-q_j) + 1\n\\]\nas claimed.\n\\end{proof}\n\nFrom Lemma~1, we have\n\\[\nf(q_{2j}) = f(q_{2j} - 2q_{2j-1}) + 2 = f(q_{2j-2}) + 2.\n\\]\nBy induction on $j$, $f(q_{2j}) = 2j$ for all $j \\geq 0$;\nby similar logic, we have $f(n) \\leq f(q_{2j}) = 2j$ for all $n \\leq q_{2j}$.\nWe can now apply Lemma~1 once more to deduce that $f(n) \\geq 0$ for all $j$.\n\n\\noindent\n\\textbf{Remark.}\nAs a byproduct of the first solution, we confirm the equality of two sequences that were entered separately in the OEIS but conjectured to be equal:\nA097509 (indexed from 0) matches the definition of $\\{c_i\\}$, while A276862 (indexed from 1)\nmatches the characterization of $\\{c_{i-1}\\}$ given by \\eqref{eq:2020B6eq1}.\n\n\\noindent\n\\textbf{Remark.}\nWe can confirm an additional conjecture from the OEIS by showing that in the notation of the first solution,\nthe sequence $a(n) = c_{n+1}$ indexed from 1 equals\nA082844: ``Start with 3,2 and apply the rule $a(a(1)+a(2)+\\cdots+a(n)) = a(n)$, fill in any undefined terms with $a(t) = 2$ if $a(t-1) = 3$ and $a(t) = 3$ if $a(t-1) = 2$.'' We first verify the recursion. By \\eqref{eq:2020B6eq2},\n\\begin{align*}\na(1) + \\cdots + a(n) &= c_0 + \\cdots + c_{n+1} - c_0 - c_1 \\\\\n&= \\lfloor (n+2)(\\sqrt{2}+1) \\rfloor - 4.\n\\end{align*}\nFrom \\eqref{eq:2020B6eq3}, we see that\n$a(a(1) + \\cdots + a(n)+3) = 3$. Consequently,\nexactly one of $a(a(1) + \\cdots + a(n))$ or $a(a(1) + \\cdots + a(n)+1)$ equals 3,\nand it is the former if and only if\n\\[\n\\lfloor (n+2)(\\sqrt{2}+1) \\rfloor - 3 = \\lfloor (n+1)(\\sqrt{2}+1) \\rfloor,\n\\]\ni.e., if and only if $a(n) = c_{n+1} = 3$.\n\nWe next check that the definition correctly fills in values not determined by the recursion. If \n$a(n) = 3$, then $a(a(1) + \\cdots + a(n)+1) = 2$ because no two consecutive values can both equal 3;\nby the same token, $a(n+1) = 2$ and so there are no further values to fill in. If $a(n) = 2$, then $a(a(1) + \\cdots + a(n)+1) = 3$ by the previous paragraph;\nthis in turn implies $a(a(1) + \\cdots + a(n)+2) = 2$, at which point there are no further values to fill in.\n\n\\noindent\n\\textbf{Remark.}\nWe can confirm an additional conjecture from the OEIS by showing that in the notation of the first solution,\nthe sequence $\\{c_i\\}$ equals\nA245219. This depends on some additional lemmas.\n\\begin{lemma}\nLet $k$ be a positive integer. Then\n\\[\n\\left\\{ i(\\sqrt{2}-1) \\right\\} < \\left\\{ k(\\sqrt{2}-1) \\right\\} \\qquad (i=0,\\dots,k-1)\n\\]\nif and only if $k = q_{2j}$ or $k = q_{2j}+q_{2j-1}$ for some $j>0$.\n\\end{lemma}\n\\begin{proof}\nFor each $j>0$, we have\n\\[\n\\frac{q_{2j-2}}{q_{2j-1}} < \\frac{q_{2j}}{q_{2j+1}} = \\frac{q_{2j-1} + 2q_{2j-2}}{q_{2j} + 2q_{2j-1}} < \\sqrt{2}-1 < \\frac{q_{2j+1}}{q_{2j+2}} < \\frac{q_{2j-1}}{q_{2j}}.\n\\]\nWe also have\n\\[\n\\frac{q_{2j-2}}{q_{2j-1}} < \\frac{q_{2j}}{q_{2j+1}} = \\frac{q_{2j-1} + 2q_{2j-2}}{q_{2j} + 2q_{2j-1}} < \\frac{q_{2j-1} + q_{2j-2}}{q_{2j} + q_{2j-1}}  < \\frac{q_{2j-1}}{q_{2j}}.\n\\]\nMoreover, $\\frac{q_{2j-1}+q_{2j-2}}{q_{2j}+q_{2j-1}}$ cannot be  less than $\\sqrt{2}-1$, or else it would be a better approximation to $\\sqrt{2}-1$\nthan the convergent $q_{2j}/q_{2j+1}$ with $q_{2j+1} > q_{2j}+q_{2j-1}$. By the same token, $\\frac{q_{2j-1}+q_{2j-2}}{q_{2j}+q_{2j-1}}$ cannot be a  better approximation to\n$\\sqrt{2}-1$ than $q_{2j+1}/q_{2j+2}$. We thus have\n\\[\n\\frac{q_{2j}}{q_{2j+1}} < \\sqrt{2}-1 < \\frac{q_{2j+1}}{q_{2j+2}} < \\frac{q_{2j-1} + q_{2j-2}}{q_{2j} + q_{2j-1}} < \\frac{q_{2j-1}}{q_{2j}}.\n\\]\nFrom this, we see that\n\\[\n\\{q_{2j}(\\sqrt{2}-1)\\} < \\{(q_{2j}+q_{2j-1})(\\sqrt{2}-1)\\} < \\{q_{2j+2}(\\sqrt{2}-1)\\}.\n\\]\nIt will now suffice to show that for $q_{2j} < k < q_{2j}+q_{2j-1}$,\n\\[\n\\{k(\\sqrt{2}-1)\\} < \\{q_{2j}(\\sqrt{2}-1)\\}\n\\]\nwhile for $q_{2j}+q_{2j-1} < k < q_{2j+2}$,\n\\[\n\\{k(\\sqrt{2}-1)\\} < \\{(q_{2j}+q_{2j-1})(\\sqrt{2}-1)\\}.\n\\]\nThe first of these assertion is an immediate consequence of the ``best approximation'' property of the convergent $q_{2j-1}/q_{2j}$.\nAs for the second assertion, note that for $k$ in this range, no fraction with denominator $k$ can lie strictly between\n$\\frac{q_{2j}}{q_{2j+1}}$ and $\\frac{q_{2j-1} + q_{2j-2}}{q_{2j} + q_{2j-1}}$ because these fractions are consecutive terms in a Farey sequence\n(that is, their difference has numerator 1 in lowest terms);\nin particular, such a fraction cannot be a better upper approximation to $\\sqrt{2}-1$ than $\\frac{q_{2j-1} + q_{2j-2}}{q_{2j} + q_{2j-1}}$.\n\\end{proof}\n\n\\begin{lemma}\nFor $j>0$, the sequence $c_0,\\dots,c_{j-1}$ is palindromic if and only if\n\\[\nj = q_{2i+1} \\qquad \\mbox{or} \\qquad j = q_{2i+1} + q_{2i+2}\n\\]\nfor some nonnegative integer $i$. (That is, $j$ must belong to one of the sequences A001653 or A001541.) In particular, $j$ must be odd.\n\\end{lemma}\n\\begin{proof}\nLet $j$ be an index for which $\\{c_0,\\dots,c_{j-1}\\}$ is palindromic.\nIn particular, $c_{j-1} = c_0 = 3$, so from \\eqref{eq:2020B6eq3}, we see that $j-1 = \\lfloor k(\\sqrt{2}+1) \\rfloor$ for some $k$.\nGiven this, the sequence is palindromic if and only if \n\\[\n\\lfloor i(\\sqrt{2}+1)\\rfloor + \\lfloor (k-i)(\\sqrt{2}+1)\\rfloor = \\lfloor k(\\sqrt{2}+1) \\rfloor \\quad (i=0,\\dots, k),\n\\]\nor equivalently\n\\[\n\\left\\{ i(\\sqrt{2}-1) \\right\\} + \\left\\{ (k-i)(\\sqrt{2}-1) \\right\\} = \\left\\{ k(\\sqrt{2}-1) \\right\\} \\quad (i=0,\\dots, k)\n\\]\nwhere the braces denote fractional parts. This holds if and only if\n\\[\n\\left\\{ i(\\sqrt{2}-1) \\right\\} < \\left\\{ k(\\sqrt{2}-1) \\right\\} \\qquad (i=0,\\dots,k-1),\n\\]\nso we may apply Lemma 2 to identify $k$ and hence $j$.\n\\end{proof}\n\n\\begin{lemma}\nFor $j>0$, if there exists a positive integer $k$ such that\n\\[\n(c_0,\\dots,c_{j-2}) = (c_k,\\dots,c_{k+j-2}) \\mbox{ but } c_{j-1} \\neq c_{k+j-1},\n\\]\nthen\n\\[\nj = q_{2i+1} \\qquad \\mbox{or} \\qquad j = q_{2i+1} + q_{2i+2}\n\\]\nfor some nonnegative integer $i$. In particular, $j$ is odd and (by Lemma 3) the sequence $(c_0,\\dots,c_{j-1})$ is palindromic.\n\\end{lemma}\n\\begin{proof}\nSince the sequence $\\{c_i\\}$ consists of 2s and 3s, we must have $\\{c_{j-1}, c_{k+j-1}\\} = \\{2,3\\}$.\nSince each pair of 3s is separated by either one or two 2s, we must have $c_{j-2} = 2$, $c_{j-3} = 3$. In particular, \nby \\eqref{eq:2020B6eq3} there is an integer $i$ for which\n$j-3 = \\lfloor (i-1)(\\sqrt{2}+1) \\rfloor$; there is also an integer $l$ such that $k = \\lfloor l(\\sqrt{2}+1) \\rfloor$.\nBy hypothesis, we have\n\\[\n\\lfloor (h+l) (\\sqrt{2}+1) \\rfloor = \\lfloor h (\\sqrt{2}+1)\\rfloor + \\lfloor l(\\sqrt{2}+1) \\rfloor\n\\]\nfor $h=0,\\dots,i-1$ but not for $h=i$. In other words,\n\\[\n\\left\\{ (h+l) (\\sqrt{2}-1) \\right\\} = \\left\\{ h (\\sqrt{2}-1) \\right\\} + \\left\\{ l(\\sqrt{2}-1) \\right\\}\n\\]\nfor $h=0,\\dots,i-1$ but not for $h=i$. That is, $\\{ h(\\sqrt{2}-1)\\}$ belongs to the interval $(0, 1-\\{ l (\\sqrt{2}-1)\\})$\nfor $h=0,\\dots,i-1$ but not for $h=i$; in particular,\n\\[\n\\left\\{ h(\\sqrt{2}-1) \\right\\} < \\left\\{ i(\\sqrt{2}-1) \\right\\} \\qquad (h=0,\\dots,i-1),\n\\]\nso we may apply Lemma 2 to identify $i$ and hence $j$.\n\\end{proof}\n\nThe sequence A245219 is defined as the sequence of coefficients of the continued fraction of $\\sup\\{b_i\\}$ where $b_1 = 1$\nand for $i>1$,\n\\[\nb_{i+1} = \\begin{cases} b_i+1 & \\mbox{if $i = \\lfloor j\\sqrt{2} \\rfloor$ for some integer $j$;} \\\\\n1/b_i & \\mbox{otherwise.}\n\\end{cases}\n\\]\nIt is equivalent to take the supremum over values of $i$ for which $b_{i+1} = 1/b_i$; by Beatty's theorem,\nthis occurs precisely when $i = \\lfloor j(2+\\sqrt{2})\\rfloor$ for some integer $j$.\nIn this case, $b_i$ has continued fraction\n\\[\n[c_{j-1}, \\dots, c_0].\n\\]\nLet $K$ be the real number with continued fraction $[c_0, c_1, \\dots]$; we must show that $K = \\sup\\{b_i\\}$.\nIn one direction, by Lemma 3, there are infinitely many values of $i$ for which $[c_{j-1}, \\dots, c_0] = [c_0, \\dots, c_{j-1}]$;\nthe corresponding values $b_i$ accumulate at $K$, so $K \\leq\\sup\\{b_i\\}$.\n\nIn the other direction, we show that $K \\geq \\sup\\{b_i\\}$ as follows. It is enough to prove that $K \\geq b_i$ when $i = \\lfloor j(2+\\sqrt{2})\\rfloor$ for some integer $j$.\n\\begin{itemize}\n\\item\nIf $c_0,\\dots,c_{j-1}$ is palindromic, then Lemma 3 implies that $j$ is odd; that is, the continued fraction $[c_{j-1},\\dots,c_0]$\nhas odd length. In this case, replacing the final term $c_0 = c_{j-1}$\nby the larger quantity $[c_{j-1}, c_j, \\dots]$ increases the value of the continued fraction.\n\\item\nIf $c_0,\\dots,c_{j-1}$ is not palindromic, then there is a least integer $k \\in \\{0,\\dots,j-1\\}$ such that $c_k\\neq c_{j-1-k}$.\nBy Lemma 3, the sequence $c_0, c_1, \\dots$ has arbitrarily long palindromic initial segments, so\nthe sequence $(c_{j-1},\\dots, c_{j-1-k})$ also occurs as $c_h, \\dots, c_{h+k}$ for some $h>0$.\nBy Lemma 4, $k$ is even and $c_k = 3 > 2 = c_{j-1-k}$; \nhence in the continued fraction for $b_i$, replacing the final segment $c_{j-1-k},\\dots,c_0$ by $c_k, c_{k+1}, \\dots$ increases the value.\n\\end{itemize}\n\n%\\noindent\n%\\textbf{Remark.}\n%The sequences $\\{a_k\\}$ and $\\{c_i\\}$ appear in the OEIS as sequences A097508 and A097509, respectively.\n%They are also the pairwise differences of the complementary sequences A003151 and A003152.\n%The sequences A097509 and A276862 were originally entered separately in the OEIS and conjectured to be equal up to shifts;\n%the above solution implies that this equality is correct.\n%(It is also conjectured that sequence A082844 matches these two; it may be possible to prove this by similar methods, but we did not check this.)\n\n\n\n\n\\end{itemize}\n\\end{document}", "source_problems": "PUTNAM-2020-problems.tex", "source_solutions": "PUTNAM-2020-solutions.tex", "notes": ""}
{"id": "PUTNAM-2021-A1", "contest": "PUTNAM", "year": "2021", "problem_number": "A1", "problem": "A grasshopper starts at the origin in the coordinate plane and makes a sequence of hops.\nEach hop has length $5$, and after each hop the grasshopper is at a point whose coordinates are both integers; thus, there are $12$ possible locations for the grasshopper after the first hop.\nWhat is the smallest number of hops needed for the grasshopper to reach the point $(2021, 2021)$?", "solution": "The answer is $578$. \n\nEach hop corresponds to adding one of the $12$ vectors $(0,\\pm 5)$, $(\\pm 5,0)$, $(\\pm 3,\\pm 4)$, $(\\pm 4,\\pm 3)$ to the position of the grasshopper. Since $(2021,2021) = 288(3,4)+288(4,3)+(0,5)+(5,0)$, the grasshopper can reach $(2021,2021)$ in $288+288+1+1=578$ hops.\n\nOn the other hand, let $z=x+y$ denote the sum of the $x$ and $y$ coordinates of the grasshopper, so that it starts at $z=0$ and ends at $z=4042$. Each hop changes the sum of the $x$ and $y$ coordinates of the grasshopper by at most $7$, and $4042 > 577 \\times 7$; it follows immediately that the grasshopper must take more than $577$ hops to get from $(0,0)$ to $(2021,2021)$.\n\n\\noindent\n\\textbf{Remark.}\nThis solution implicitly uses the distance function \n\\[\nd((x_1, y_1), (x_2, y_2)) = |x_1 - x_2| + |y_1 - y_2|\n\\]\non the plane, variously called the \\emph{taxicab metric}, the \\emph{Manhattan metric}, or the \\emph{$L^1$-norm} (or $\\ell_1$-norm).", "source_problems": "PUTNAM-2021-problems.tex", "source_solutions": "PUTNAM-2021-solutions.tex", "notes": ""}
{"id": "PUTNAM-2021-A2", "contest": "PUTNAM", "year": "2021", "problem_number": "A2", "problem": "For every positive real number $x$, let\n\\[\ng(x) = \\lim_{r \\to 0} ((x+1)^{r+1} - x^{r+1})^{\\frac{1}{r}}.\n\\]\nFind $\\lim_{x \\to \\infty} \\frac{g(x)}{x}$.", "solution": "The limit is $e$.\n\n\\noindent\n\\textbf{First solution.}\nBy l'H\\^opital's Rule, we have\n\\begin{align*}\n&\\lim_{r\\to 0} \\frac{\\log((x+1)^{r+1}-x^{r+1})}{r} \\\\\n&\\quad = \\lim_{r\\to 0} \\frac{d}{dr} \\log((x+1)^{r+1}-x^{r+1}) \\\\\n&\\quad = \\lim_{r\\to 0} \\frac{(x+1)^{r+1}\\log(x+1)-x^{r+1}\\log x}{(x+1)^{r+1}-x^{r+1}} \\\\\n&\\quad = (x+1)\\log(x+1)-x\\log x,\n\\end{align*}\nwhere $\\log$ denotes natural logarithm. It follows that $g(x) = e^{(x+1)\\log(x+1)-x\\log x} = \\frac{(x+1)^{x+1}}{x^x}$. Thus\n\\[\n\\lim_{x\\to\\infty} \\frac{g(x)}{x} = \\left(\\lim_{x\\to\\infty}\\frac{x+1}{x}\\right) \\cdot \\left(\\lim_{x\\to\\infty} \\left(1+\\frac{1}{x}\\right)^x\\right) = 1\\cdot e = e.\n\\]\n\n\\noindent\n\\textbf{Second solution.}\nWe first write \n\\begin{align*}\n\\lim_{x \\to \\infty} \\frac{g(x)}{x} &= \\lim_{x \\to \\infty} \\lim_{r \\to 0} \\frac{((x+1)^{r+1} - x^{r+1})^{1/r}}{x} \\\\\n&= \\lim_{x \\to \\infty} \\lim_{r \\to 0} \\frac{((r+1) x^r + O(x^{r-1}))^{1/r}}{x}.\n\\end{align*}\nWe would like to interchange the order of the limits, but this requires some justification.\nUsing Taylor's theorem with remainder, for $x \\geq 1$, $r \\leq 1$\nwe can bound the error term $O(x^{r-1})$ in absolute value by $(r+1) r x^{r-1}$. This\nmeans that if we continue to rewrite the orginial limit as\n\\[\n\\lim_{r\\to 0} \\lim_{x\\to\\infty} (r+1+O(x^{-1}))^{1/r},\n\\]\nthe error term $O(x^{-1})$ is bounded in absolute value by $(r+1) r/x$.\nFor $x \\geq 1$, $r \\leq 1$ this quantity is bounded in absolute value by $(r+1)r$, \\emph{independently of $x$}. This allows us to continue by interchanging the order of the limits,\nobtaining \n\\begin{align*}\n&\\lim_{r\\to 0} \\lim_{x\\to\\infty} (r+1+O(x^{-1}))^{1/r} \\\\\n&\\quad = \\lim_{r\\to 0} (r+1)^{1/r} \\\\\n&\\quad = \\lim_{s\\to \\infty} (1+1/s)^{s} = e,\n\\end{align*}\nwhere in the last step we take $s = 1/r$.\n\n\\noindent\n\\textbf{Third solution.} (by Clayton Lungstrum)\nWe first observe that\n\\begin{align*}\n((x+1)^{r+1} - x^{r+1})^{1/r}\n&= \\left( \\int_x^{x+1} (r+1)u^r\\,du \\right)^{1/r} \\\\\n&= (r+1)^{1/r} \\left( \\int_x^{x+1} u^r\\,du \\right)^{1/r}.\n\\end{align*}\nSince $\\lim_{r \\to 0} (r+1)^{1/r} = e$, we deduce that\n\\[\ng(x) = e \\lim_{r \\to 0} \\left( \\int_x^{x+1} u^r\\,du \\right)^{1/r}.\n\\]\nFor $r > 0$, $u^r$ is increasing for $x \\leq u \\leq x+1$, so\n\\[\nx^r \\leq \\int_x^{x+1} u^r\\,du \\leq (x+1)^r;\n\\]\nfor $r < 0$, $u^r$ is decreasing for $x \\leq u \\leq x+1$, so\n\\[\nx^r \\geq \\int_x^{x+1} u^r\\,du \\geq (x+1)^r.\n\\]\nIn both cases, we deduce that\n\\[\nx \\leq \\left( \\int_x^{x+1} u^r\\,du \\right)^{1/r} \\leq x+1;\n\\]\napplying the squeeze theorem to the resulting inequality\n $e \\leq \\frac{g(x)}{x} \\leq e\\left( 1 + \\frac{1}{x} \\right)$\n yields the claimed limit.", "source_problems": "PUTNAM-2021-problems.tex", "source_solutions": "PUTNAM-2021-solutions.tex", "notes": ""}
{"id": "PUTNAM-2021-A3", "contest": "PUTNAM", "year": "2021", "problem_number": "A3", "problem": "Determine all positive integers $N$ for which the sphere\n\\[\nx^2 + y^2 + z^2 = N\n\\]\nhas an inscribed regular tetrahedron whose vertices have integer coordinates.", "solution": "The integers $N$ with this property are those of the form $3m^2$ for some positive integer $m$.\n\nIn one direction, for $N = 3m^2$, the points\n\\[\n(m,m,m), (m,-m,-m), (-m,m,-m), (-m,-m,m)\n\\]\nform the vertices of a regular tetrahedron inscribed in the sphere $x^2 + y^2 + z^2 = N$.\n\nConversely, suppose that $P_i = (x_i, y_i, z_i)$ for $i=1,\\dots,4$ are the vertices of an inscribed regular \ntetrahedron. Then the center of this tetrahedron must equal the center of the sphere, namely $(0,0,0)$. Consequently, these four vertices together with $Q_i = (-x_i, -y_i, -z_i)$ for $i=1,\\dots,4$ form the vertices of an inscribed cube in the sphere.\nThe side length of this cube is $(N/3)^{1/2}$, so its volume is $(N/3)^{3/2}$;\non the other hand, this volume also equals the determinant of the matrix\nwith row vectors $Q_2-Q_1, Q_3-Q_1, Q_4-Q_1$, which is an integer. Hence $(N/3)^3$ is a perfect square, as then is $N/3$.", "source_problems": "PUTNAM-2021-problems.tex", "source_solutions": "PUTNAM-2021-solutions.tex", "notes": ""}
{"id": "PUTNAM-2021-A4", "contest": "PUTNAM", "year": "2021", "problem_number": "A4", "problem": "Let\n\\[\nI(R) = \\iint_{x^2+y^2 \\leq R^2} \\left( \\frac{1+2x^2}{1+x^4+6x^2y^2+y^4} - \\frac{1+y^2}{2+x^4+y^4} \\right)\\,dx\\,dy.\n\\]\nFind\n\\[\n\\lim_{R \\to \\infty} I(R),\n\\]\nor show that this limit does not exist.", "solution": "The limit exists and equals $\\frac{\\sqrt{2}}{2} \\pi \\log 2$.\n\nWe first note that we can interchange $x$ and $y$ to obtain\n\\[\nI(R) = \\iint_{x^2+y^2 \\leq R^2} \\left( \\frac{1+2y^2}{1+x^4+6x^2y^2+y^4} - \\frac{1+x^2}{2+x^4+y^4} \\right)\\,dx\\,dy.\n\\]\nAveraging the two expressions for $I(R)$ yields\n\\[\nI(R) = \\iint_{x^2+y^2 \\leq R^2} (f(x,y) - g(x,y))\\,dx\\,dy\n\\]\nwhere\n\\begin{align*}\nf(x,y) &= \\frac{1+x^2+y^2}{1 + x^4 + 6x^2y^2 + y^4} \\\\\ng(x,y) &= \\frac{1+x^2/2+y^2/2}{2 + x^4 + y^4}.\n\\end{align*}\nNow note that\n\\[f(x,y) = 2 g(x+y, x-y).\n\\]\nWe can thus write\n\\[\nI(R) = \\iint_{R^2 \\leq x^2 +y^2 \\leq 2R^2} g(x,y)\\,dx\\,dy.\n\\]\nTo compute this integral, we switch to polar coordinates:\n\\begin{align*}\nI(R) &= \\int_R^{R\\sqrt{2}} \\int_0^{2\\pi} g(r\\cos \\theta, r \\sin \\theta)r\\,dr\\,d\\theta \\\\\n&=  \\int_R^{R\\sqrt{2}} \\int_0^{2\\pi} \\frac{1 + r^2/2}{2 + r^4(1 - (\\sin^2 2\\theta)/2)} r\\,dr\\,d\\theta.\n\\end{align*}\nWe rescale $r$ to remove the factor of $R$ from the limits of integration:\n\\begin{align*}\nI(R) & =  \\int_1^{\\sqrt{2}} \\int_0^{2\\pi} \\frac{1 + R^2 r^2/2}{2 + R^4 r^4(1 - (\\sin^2 2\\theta)/2)} R^2 r\\,dr\\,d\\theta.\n\\end{align*}\n\nSince the integrand is uniformly bounded for $R \\gg 0$, we may take the limit over $R$ through the integrals to obtain\n\\begin{align*}\n\\lim_{R \\to \\infty} I(R) &= \\int_1^{\\sqrt{2}} \\int_0^{2\\pi} \\frac{r^2/2}{r^4(1 - (\\sin^2 2\\theta)/2)} r\\,dr\\,d\\theta \\\\\n&= \\int_1^{\\sqrt{2}} \\frac{dr}{r} \\int_0^{2\\pi} \\frac{1}{2- \\sin^2 2\\theta} d\\theta \\\\\n&= \\log \\sqrt{2} \\int_0^{2\\pi} \\frac{1}{1 + \\cos^2 2\\theta} d\\theta \\\\\n&= \\frac{1}{2} \\log 2 \\int_0^{2\\pi} \\frac{2}{3 + \\cos 4\\theta} d\\theta.\n\\end{align*}\nIt thus remains to evaluate \n\\[\n\\int_0^{2\\pi} \\frac{2}{3 + \\cos 4\\theta} d\\theta = \n2 \\int_0^{\\pi} \\frac{2}{3 + \\cos \\theta} d\\theta.\n\\]\nOne option for this is to use the half-angle substitution $t = \\tan (\\theta/2)$ to get\n\\begin{align*}\n\\int_{-\\infty}^\\infty \\frac{4}{3(1+t^2) + (1-t^2)}\\,dt\n&= \\int_{-\\infty}^\\infty \\frac{2}{2+t^2}\\,dt \\\\\n&= \\sqrt{2} \\arctan \\left( \\frac{x}{\\sqrt{2}} \\right)^{\\infty}_{-\\infty} \\\\\n&= \\sqrt{2} \\pi.\n\\end{align*}\nPutting this together yields the claimed result.", "source_problems": "PUTNAM-2021-problems.tex", "source_solutions": "PUTNAM-2021-solutions.tex", "notes": ""}
{"id": "PUTNAM-2021-A5", "contest": "PUTNAM", "year": "2021", "problem_number": "A5", "problem": "Let $A$ be the set of all integers $n$ such that $1 \\leq n \\leq 2021$ and $\\gcd(n, 2021) = 1$.\nFor every nonnegative integer $j$, let\n\\[\nS(j) = \\sum_{n \\in A} n^j.\n\\]\nDetermine all values of $j$ such that $S(j)$ is a multiple of 2021.", "solution": "The values of $j$ in question are those not divisible by either $42$ or $46$.\n\nWe first check that for $p$ prime,\n\\[\n\\sum_{n=1}^{p-1} n^j \\equiv 0 \\pmod{p} \\Leftrightarrow j \\not\\equiv 0 \\pmod{p-1}.\n\\]\nIf $j \\equiv 0 \\pmod{p-1}$, then $n^j \\equiv 1 \\pmod{p}$ for each $n$, so $\\sum_{n=1}^{p-1} n^j \\equiv p-1 \\pmod{p}$. If $j \\not\\equiv 0 \\pmod{p-1}$, we can pick a primitive root $m$ modulo $p$,\nobserve that $m^j \\not\\equiv 1 \\pmod{p}$, and then note that\n\\[\n\\sum_{n=1}^{p-1} n^j \\equiv \\sum_{n=1}^{p-1} (mn)^j = m^j \\sum_{n=1}^{p-1} n^j \\pmod{p},\n\\]\nwhich is only possible if $\\sum_{n=1}^{p-1} n^j \\equiv 0 \\pmod{p}$.\n\nWe now note that the prime factorization of 2021 is $43 \\times 47$,\nso it suffices to determine when $S(j)$ is divisible by each of 43 and 47.\nWe have\n\\begin{align*}\nS(j) &\\equiv 46 \\sum_{n=1}^{42} n^j \\pmod{43} \\\\\nS(j) &\\equiv 42 \\sum_{n=1}^{46} n^j \\pmod{47}.\n\\end{align*}\nSince 46 and 42 are coprime to 43 and 47, respectively, \nwe have \n\\begin{gather*}\nS(j) \\equiv 0 \\pmod{43} \\Leftrightarrow j \\not\\equiv 0 \\pmod{42} \\\\\nS(j) \\equiv 0 \\pmod{47} \\Leftrightarrow j \\not\\equiv 0 \\pmod{46}.\n\\end{gather*}\nThis yields the claimed result.", "source_problems": "PUTNAM-2021-problems.tex", "source_solutions": "PUTNAM-2021-solutions.tex", "notes": ""}
{"id": "PUTNAM-2021-A6", "contest": "PUTNAM", "year": "2021", "problem_number": "A6", "problem": "Let $P(x)$ be a polynomial whose coefficients are all either $0$ or $1$.\nSuppose that $P(x)$ can be written as a product of two nonconstant polynomials with integer coefficients. Does it follow that $P(2)$ is a composite integer?", "solution": "Yes, it follows that $P(2)$ is a composite integer. (Note: 1 is neither prime nor composite.)\n\nWrite $P(x) = a_0 + a_1 x + \\cdots + a_n x^n$ with $a_i \\in \\{0,1\\}$ and $a_n = 1$.\nLet $\\alpha$ be an arbitrary root of $P$. Since $P(\\alpha) = 0$, $\\alpha$ cannot be a positive real number.\n%In addition, if $\\alpha \\neq 0$ then\n%\\begin{align*}\n%1 &< |a_{n-1} \\alpha^{-1} + \\cdots + a_0 \\alpha^{-n}| \\\\\n%&\\leq |\\alpha|^{-1} + \\cdots + |\\alpha|^{-n}\n%\\end{align*}\n%and so $|\\alpha| < 2$.\n%\nIn addition, if $\\alpha \\neq 0$ then\n\\begin{align*}\n|1 + a_{n-1} \\alpha^{-1}| &= |a_{n-2} \\alpha^{-2} + \\cdots + a_0 \\alpha^{-n}| \\\\\n&\\leq |\\alpha|^{-2} + \\cdots + |\\alpha|^{-n}.\n\\end{align*}\nIf $\\alpha \\neq 0$ and $\\mathrm{Re}(\\alpha) \\geq 0$, then $\\mathrm{Re}(1 + a_{n-1} \\alpha^{-1}) \\geq 1$\nand \n\\[\n1 \\leq |\\alpha|^{-2} + \\cdots + |\\alpha|^{-n} < \\frac{|\\alpha|^{-2}}{1 - |\\alpha|^{-1}};\n\\]\nthis yields $|\\alpha| < (1 + \\sqrt{5})/2$.\n\nBy the same token, if $\\alpha \\neq 0$ then\n\\[\n|1 + a_{n-1} \\alpha^{-1} + a_{n-2} \\alpha^{-2}| \\leq |\\alpha|^{-3} + \\cdots + |\\alpha|^{-n}.\n\\]\nWe deduce from this that $\\mathrm{Re}(\\alpha) \\leq 3/2$ as follows.\n\\begin{itemize}\n\\item\nThere is nothing to check if $\\mathrm{Re}(\\alpha) \\leq 0$.\n\\item\nIf the argument of $\\alpha$ belongs to $[-\\pi/4, \\pi/4]$, then $\\mathrm{Re}(\\alpha^{-1}), \\mathrm{Re}(\\alpha^{-2}) \\geq 0$, so\n\\[\n1 \\leq |\\alpha|^{-3} + \\cdots + |\\alpha|^{-n} < \\frac{|\\alpha|^{-3}}{1 - |\\alpha|^{-1}}.\n\\]\nHence $|\\alpha|^{-1}$ is greater than the unique positive root of $x^3 + x - 1$, which \nis greater than $2/3$. \n\\item\nOtherwise, $\\alpha$ has argument in $(-\\pi/2,\\pi/4) \\cup (\\pi/4,\\pi/2)$,\nso the bound $|\\alpha| < (1 + \\sqrt{5})/2$ implies that $\\mathrm{Re}(\\alpha) < (1 + \\sqrt{5})/(2 \\sqrt{2}) < 3/2$.\n\\end{itemize}\n\nBy hypothesis, there exists a factorization $P(x) = Q(x)R(x)$ into two nonconstant integer polynomials, which we may assume are monic.\n$Q(x + 3/2)$ is a product of polynomials, each of the form $x - \\alpha$ where $\\alpha$ is a real root of $P$\nor of the form\n\\begin{align*}\n&\\left( x + \\frac{3}{2} - \\alpha\\right) \\left(x + \\frac{3}{2} - \\overline{\\alpha} \\right) \\\\\n&\\quad = x^2 + 2 \\mathrm{Re}\\left(\\frac{3}{2} - \\alpha\\right) x + \\left|\\frac{3}{2} - \\alpha \\right|^2\n\\end{align*}\nwhere $\\alpha$ is a nonreal root of $P$. It follows that $Q(x+3/2)$ has positive coefficients;\ncomparing its values at $x=1/2$ and $x=-1/2$ yields $Q(2) > Q(1)$. We cannot have $Q(1) \\leq 0$, as otherwise the intermediate value theorem would imply that $Q$ has a real root in $[1, \\infty)$; hence $Q(1)  \\geq 1$ and so $Q(2) \\geq 2$.\nSimilarly $R(2) \\geq 2$, so $P(2) = Q(2) R(2)$ is composite.\n\n\\noindent\n\\textbf{Remark.}\nA theorem of Brillhart, Filaseta, and Odlyzko from 1981 states that if a prime $p$ is written as $\\sum_i a_i b^i$ in any base $b \\geq 2$, the polynomial $\\sum_i a_i x^i$ is irreducible.\n(The case $b=10$ is an older result of Cohn.) \nThe solution given above is taken from: Ram Murty, Prime numbers and irreducible polynomials, \\textit{Amer. Math. Monthly} \\textbf{109} (2002), 452--458). The final step is due to P\\'olya and Szeg\\H{o}.", "source_problems": "PUTNAM-2021-problems.tex", "source_solutions": "PUTNAM-2021-solutions.tex", "notes": ""}
{"id": "PUTNAM-2021-B1", "contest": "PUTNAM", "year": "2021", "problem_number": "B1", "problem": "Suppose that the plane is tiled with an infinite checkerboard of unit squares. If another unit square is dropped on the plane at random with position and orientation independent of the checkerboard tiling, what is the probability that it does not cover any of the corners of the squares of the checkerboard?", "solution": "The probability is $2 - \\frac{6}{\\pi}$.\n\nSet coordinates so that the original tiling includes the (filled) square \n$S = \\{(x,y): 0 \\leq x,y \\leq 1 \\}$. It is then equivalent to choose the second square by first choosing a point uniformly at random in $S$ to be the center of the square, then choosing an angle of rotation uniformly at random from the interval $[0, \\pi/2]$.\n\nFor each $\\theta \\in [0, \\pi/2]$, circumscribe a square $S_\\theta$ around $S$ with angle of rotation $\\theta$ relative to $S$; this square has side length $\\sin \\theta + \\cos \\theta$. Inside $S_\\theta$, draw the smaller square $S_\\theta'$ consisting of points at distance greater than $1/2$ from each side of $S_\\theta$; this square has side length $\\sin \\theta + \\cos \\theta - 1$. \n\nWe now verify that a unit square with angle of rotation $\\theta$ fails to cover any corners of $S$ if and only if its center lies in the interior of $S_\\theta'$. In one direction, if one of the corners of $S$ is covered, then that corner lies on a side of $S_\\theta$ which meets the dropped square, so the center of the dropped square is at distance less than $1/2$ from that side of $S_\\theta$.\nTo check the converse, note that\nthere are two ways to dissect the square $S_\\theta$ into the square $S_\\theta'$ plus four $\\sin \\theta \\times \\cos \\theta$ rectangles. If $\\theta \\neq 0, \\pi/4$, then one of these dissections\nhas the property that each corner $P$ of $S$ appears as an interior point of a side (not a corner) of one of the rectangles $R$. \nIt will suffice to check that if the center of the dropped square is in $R$, then the dropped square covers $P$; this follows from the fact that $\\sin \\theta$ and $\\cos \\theta$ are both at most 1.\n\nIt follows that the conditional probability, given that the angle of rotation is chosen to be $\\theta$, that the dropped square does not cover any corners of $S$ is $(\\sin \\theta + \\cos \\theta - 1)^2$. We then compute the original probability as the integral\n\\begin{align*}\n&\\frac{2}{\\pi} \\int_0^{\\pi/2} (\\sin \\theta + \\cos \\theta - 1)^2\\,d\\theta \\\\\n&\\quad =\n\\frac{2}{\\pi} \\int_0^{\\pi/2} (2 + \\sin 2\\theta - 2\\sin \\theta - 2 \\cos \\theta)\\,d\\theta\\\\\n&\\quad = \\frac{2}{\\pi} \\left( 2 \\theta - \\frac{1}{2} \\cos 2\\theta + 2 \\cos \\theta - 2 \\sin \\theta \\right)_0^{\\pi/2} \\\\\n&\\quad = \\frac{2}{\\pi} \\left( \\pi + 1 - 2 - 2 \\right) = 2 - \\frac{6}{\\pi}.\n\\end{align*}\n\n\\noindent\n\\textbf{Remark:} Noam Elkies has some pictures illustrating this problem:\n\\href{https://abel.math.harvard.edu/~elkies/putnam_b1a.pdf}{image 1},\n\\href{https://abel.math.harvard.edu/~elkies/putnam_b1.pdf}{image 2}.", "source_problems": "PUTNAM-2021-problems.tex", "source_solutions": "PUTNAM-2021-solutions.tex", "notes": ""}
{"id": "PUTNAM-2021-B2", "contest": "PUTNAM", "year": "2021", "problem_number": "B2", "problem": "Determine the maximum value of the sum\n\\[\nS = \\sum_{n=1}^\\infty \\frac{n}{2^n} (a_1 a_2 \\cdots a_n)^{1/n}\n\\]\nover all sequences $a_1, a_2, a_3, \\cdots$ of nonnegative real numbers satisfying\n\\[\n\\sum_{k=1}^\\infty a_k = 1.\n\\]", "solution": "The answer is $2/3$. \n\nBy AM-GM, we have\n\\begin{align*}\n2^{n+1}(a_1\\cdots a_n)^{1/n} &= \\left((4a_1)(4^2a_2)\\cdots (4^na_n)\\right)^{1/n}\\\\\n& \\leq \\frac{\\sum_{k=1}^n (4^k a_k)}{n}.\n\\end{align*}\nThus\n\\begin{align*}\n2S &\\leq \\sum_{n=1}^\\infty \\frac{\\sum_{k=1}^n (4^k a_k)}{4^n} \\\\\n&= \\sum_{n=1}^\\infty \\sum_{k=1}^n (4^{k-n}a_k) = \\sum_{k=1}^\\infty \\sum_{n=k}^\\infty (4^{k-n}a_k) \\\\\n&= \\sum_{k=1}^\\infty \\frac{4a_k}{3}  = \\frac{4}{3}\n\\end{align*}\nand $S \\leq 2/3$. Equality is achieved when $a_k=\\frac{3}{4^k}$ for all $k$, since in this case $4a_1=4^2a_2=\\cdots=4^na_n$ for all $n$.", "source_problems": "PUTNAM-2021-problems.tex", "source_solutions": "PUTNAM-2021-solutions.tex", "notes": ""}
{"id": "PUTNAM-2021-B3", "contest": "PUTNAM", "year": "2021", "problem_number": "B3", "problem": "Let $h(x,y)$ be a real-valued function that is twice continuously differentiable throughout $\\mathbb{R}^2$, and define\n\\[\n\\rho(x,y) = yh_x - xh_y.\n\\]\nProve or disprove: For any positive constants $d$ and $r$ with $d>r$, there is a circle $\\mathcal{S}$ of radius $r$ whose center is a distance $d$ away from the origin such that the integral of $\\rho$ over the interior of $\\mathcal{S}$ is zero.", "solution": "We prove the given statement.\n\nFor any circle $\\mathcal{S}$ of radius $r$ whose center is at distance $d$ from the origin, express the integral in polar coordinates $s,\\theta$:\n\\[\n\\iint_{\\mathcal{S}} \\rho = \\int_{s_1}^{s_2} \\int_{\\theta_1(s)}^{\\theta_2(s)} (yh_x - xh_y)(s \\sin \\theta, s \\cos \\theta) s\\,d\\theta\\,ds.\n\\]\nFor fixed $s$, the integral over $\\theta$ is a line integral of $\\mathrm{grad} \\, h$, which evaluates to $h(P_2) - h(P_1)$\nwhere $P_1, P_2$ are the endpoints of the endpoints of the arc of the circle of radius $s$ centered at the origin lying within $\\mathcal{S}$. If we now fix $r$ and $d$ and integrate $\\iint_{\\mathcal{S}} \\rho$ over all choices of $\\mathcal{S}$ (this amounts to a single integral over an angle in the range $[0, 2\\pi]$), we may interchange the order of integration to first integrate over $\\theta$,\nthen over the choice of $\\mathcal{S}$, and at this point we get 0 for every $s$.\nWe conclude that the integral of $\\iint_{\\mathcal{S}}$ over all choices of $\\mathcal{S}$ vanishes; since the given integral varies continuously in $\\mathcal{S}$, by the intermediate value theorem there must be some $\\mathcal{S}$  where the given integral is 0.", "source_problems": "PUTNAM-2021-problems.tex", "source_solutions": "PUTNAM-2021-solutions.tex", "notes": ""}
{"id": "PUTNAM-2021-B4", "contest": "PUTNAM", "year": "2021", "problem_number": "B4", "problem": "Let $F_0, F_1, \\dots$ be the sequence of Fibonacci numbers, with $F_0 = 0$, $F_1 = 1$, and $F_n = F_{n-1} + F_{n-2}$ for $n \\geq 2$. For $m > 2$, let $R_m$ be the remainder when the product $\\prod_{k=1}^{F_m-1} k^k$ is divided by $F_m$. Prove that $R_m$ is also a Fibonacci number.", "solution": "We can check directly that $R_3=R_4=1$ are Virahanka--Fibonacci numbers; henceforth we will assume $m \\geq 5$.\n\nDenote the product $\\prod_{k=1}^{F_m-1} k^k$ by $A$. Note that if $F_m$ is composite, say $F_m = ab$ for $a,b>1$ integers, then $A$ is divisible by $a^a b^b$ and thus by $F_m=ab$; it follows that $R_m=0=F_0$ when $F_m$ is composite.\n\nNow suppose that $F_m$ is prime. Since $F_{2n} = F_n(F_{n+1}+F_{n-1})$ for all $n$, $F_m$ is composite if $m>4$ is even; thus we must have that $m$ is odd. Write $p=F_m$, and use $\\equiv$ to denote congruence $\\pmod p$. Then we have\n\\[\nA = \\prod_{k=1}^{p-1} (p-k)^{p-k} \\equiv \\prod_{k=1}^{p-1} (-k)^{p-k} = (-1)^{p(p-1)/2} \\prod_{k=1}^{p-1} k^{p-k}\n\\]\nand consequently\n\\begin{align*}\nA^2 &\\equiv (-1)^{p(p-1)/2} \\prod_{k=1}^{p-1} (k^k k^{p-k}) \\\\\n&= (-1)^{p(p-1)/2}((p-1)!)^p \\\\\n&\\equiv (-1)^{p(p+1)/2},\n\\end{align*}\nwhere the final congruence follows from Wilson's Theorem. Now observe that when $m$ is odd, $p=F_m$ must be congruent to either $1$ or $2 \\pmod{4}$: this follows from inspection of the Virahanka--Fibonacci sequence mod $4$, which has period $6$: $1,1,2,3,1,0,1,1,\\ldots$. It follows that $A^2 \\equiv (-1)^{p(p+1)/2} = -1$.\n\nOn the other hand, by the Kepler--Cassini identity\n\\[\nF_n^2 = (-1)^{n+1} + F_{n-1}F_{n+1}\n\\]\nwith $n=m-1$, we have $F_{m-1}^2 \\equiv (-1)^m = -1$. Thus we have\n$0 \\equiv A^2 - F_{m-1}^2 \\equiv (A-F_{m-1})(A-F_{m-2})$. Since $p$ is prime, it must be the case that either $A=F_{m-1}$ or $A=F_{m-2}$, and we are done.\n\n\\noindent\n\\textbf{Remark.}\nThe Kepler--Cassini identity first appears in a letter of Kepler from 1608.\nNoam Elkies has scanned the \\href{https://people.math.harvard.edu/~elkies/Kepler_XVI_p157.jpg}{relevant page of Kepler's collected works} (slightly NSFW if your boss can read Latin).", "source_problems": "PUTNAM-2021-problems.tex", "source_solutions": "PUTNAM-2021-solutions.tex", "notes": ""}
{"id": "PUTNAM-2021-B5", "contest": "PUTNAM", "year": "2021", "problem_number": "B5", "problem": "Say that an $n$-by-$n$ matrix $A = (a_{ij})_{1 \\leq i,j \\leq n}$ with integer entries is \\emph{very odd} if, for every nonempty subset $S$ of $\\{1,2,\\dots,n\\}$, the $|S|$-by-$|S|$ submatrix $(a_{ij})_{i,j \\in S}$ has odd determinant. Prove that if $A$ is very odd, then $A^k$ is very odd for every $k \\geq 1$.", "solution": "For convenience, throughout we work with matrices over the field of 2 elements. In this language, if there exists a permutation matrix $P$ such that $P^{-1} A P$ is unipotent (i.e., has 1s on the main diagonal and 0s below it), then $A$ is very odd: any principal submatrix of $A$ is conjugate to a principal submatrix of $P^{-1} A P$, which is again unipotent and in particular nonsingular.\nWe will solve the problem by showing that conversely, for any very odd matrix $A$, there exists a permutation matrix $P$ such that $P^{-1} A P$ is unipotent. Since the latter condition is preserved by taking powers, this will prove the desired result.\n\nTo begin, we may take $S = \\{i\\}$ to see that $a_{ii} = 1$. We next form a (loopless) directed graph on the vertex set $\\{1,\\dots,n\\}$ with an edge from $i$ to $j$ whenever $a_{ij} = 1$, and claim that this graph has no cycles.\nTo see this, suppose the contrary,\nchoose a cycle of minimal length $m \\geq 2$, and let $i_1,\\dots,i_m$ be the vertices in order.\nThe minimality of the cycle implies that\n\\[\na_{i_j i_k} = \\begin{cases} 1 & \\mbox{if } k - j \\equiv 0 \\mbox{ or } 1 \\pmod{m} \\\\\n0 & \\mbox{otherwise}.\n\\end{cases}\n\\]\nThe submatrix corresponding to $S = \\{i_1,\\dots,i_m\\}$ has row sum 0 and hence is singular, a contradiction.\n\nWe now proceed by induction on $n$.\nSince the directed graph has no cycles, there must be some vertex which is not the starting point of any edge\n(e.g., the endpoint of any path of maximal length).\nWe may conjugate by a permutation matrix so that this vertex becomes 1. We now apply the induction hypothesis to the submatrix corresponding to $S = \\{2,\\dots,n\\}$ to conclude.\n\n\\noindent\n\\textbf{Remark.}\nA directed graph without cycles, as in our solution, is commonly called a \\emph{DAG (directed acyclic graph)}. It is a standard fact that a directed graph is a TAG if and only if there is a linear ordering of its vertices consistent with all edge directions.\nSee for example \\url{https://en.wikipedia.org/wiki/Directed_acyclic_graph}.\n\n\\noindent\n\\textbf{Remark.}\nAn $n \\times n$ matrix $A = (a_{ij})$ for which the value of $a_{ij}$ depends only on $i-j \\pmod{n}$ is called a \\emph{circulant matrix}.\nThe circulant matrix with first row $(1,1,0,\\dots,0)$ is an example of an $n \\times n$ matrix whose determinant is even, but whose other principal minors are all odd.", "source_problems": "PUTNAM-2021-problems.tex", "source_solutions": "PUTNAM-2021-solutions.tex", "notes": ""}
{"id": "PUTNAM-2021-B6", "contest": "PUTNAM", "year": "2021", "problem_number": "B6", "problem": "Given an ordered list of $3N$ real numbers, we can \\emph{trim} it to form a list of $N$ numbers as follows: We divide the list into $N$ groups of $3$ consecutive numbers, and within each group, discard the highest and lowest numbers, keeping only the median.\n\nConsider generating a random number $X$ by the following procedure: Start with a list of $3^{2021}$ numbers, drawn independently and uniformly at random between 0 and 1. Then trim this list as defined above, leaving a list of $3^{2020}$ numbers. Then trim again repeatedly until just one number remains; let $X$ be this number. Let $\\mu$ be the expected value of $|X - \\frac{1}{2}|$. Show that\n\\[\n\\mu \\geq \\frac{1}{4} \\left( \\frac{2}{3} \\right)^{2021}.\n\\]\n\n\\end{itemize}\n\n\\end{document}", "solution": "\\noindent\n\\textbf{First solution.}\n(based on a suggestion of Noam Elkies)\nLet $f_k(x)$ be the probability distribution of $X_k$, the last number remaining when one repeatedly trims a list of $3^k$ random variables chosen with respect to the uniform distribution on $[0,1]$; note that $f_0(x) = 1$ for $x \\in [0,1]$.\nLet $F_k(x)=\\int_0^x f_k(t)\\,dt$ be the cumulative distribution function; by symmetry,\n$F_k(\\frac{1}{2}) = \\frac{1}{2}$.\nLet $\\mu_k$ be the expected value of $X_k - \\frac{1}{2}$; then $\\mu_0 = \\frac{1}{4}$, so it will suffice to prove that $\\mu_{k} \\geq \\frac{2}{3} \\mu_{k-1}$ for $k > 0$.\n\nBy integration by parts and symmetry, we have\n\\[\n\\mu_k = 2 \\int_0^{1/2} \\left( \\frac{1}{2} - x \\right) f_k(x)\\,dx  = 2 \\int_0^{1/2} F_k(x)\\,dx;\n\\]\nthat is, $\\mu_k$ computes twice the area under the curve $y = F_k(x)$ for $0 \\leq x \\leq\\frac{1}{2}$. Since $F_k$ is a monotone function from $[0, \\frac{1}{2}]$ \nwith $F_k(0) = 0$ and $F_k(\\frac{1}{2}) = \\frac{1}{2}$, we may transpose the axes to obtain\n\\begin{equation} \\label{eq:2021B6 eq4}\n\\mu_k = 2 \\int_0^{1/2} \\left( \\frac{1}{2} - F_k^{-1}(y) \\right)\\,dy.\n\\end{equation}\n\nSince $f_k(x)$ is the probability distribution of the median of three random variables chosen with respect to the distribution $f_{k-1}(x)$,\n\\begin{equation} \\label{eq:2021B6 eq1}\nf_k(x) = 6 f_{k-1}(x) F_{k-1}(x) ( 1-F_{k-1}(x) )\n\\end{equation}\nor equivalently\n\\begin{equation} \\label{eq:2021B6 eq2}\nF_k(x) = 3 F_{k-1}(x)^2 - 2 F_{k-1}(x)^3.\n\\end{equation}\nBy induction, $F_k$ is the $k$-th iterate of $F_1(x) = 3x^2 -2x^3$, so\n\\begin{equation} \\label{eq:2021B6 eq5}\nF_k(x) = F_{k-1}(F_1(x)).\n\\end{equation}\nSince $f_1(t) = 6t(1-t) \\leq \\frac{3}{2}$ for $t \\in [0,\\frac{1}{2}]$,\n\\[\n\\frac{1}{2} - F_1(x) = \\int_x^{1/2} 6t(1-t)\\,dt \\leq \\frac{3}{2}\\left(\\frac{1}{2}-x\\right);\n\\]\nfor $y \\in [0, \\frac{1}{2}]$, we may take $x = F_{k}^{-1}(y)$ to obtain\n\\begin{equation} \\label{eq:2021B6 eq3}\n\\frac{1}{2} - F_k^{-1}(y) \\geq \\frac{2}{3} \\left( \\frac{1}{2} - F_{k-1}^{-1}(y) \\right).\n\\end{equation}\nUsing \\eqref{eq:2021B6 eq5} and \\eqref{eq:2021B6 eq3}, we obtain\n\\begin{align*}\n\\mu_k &= 2 \\int_0^{1/2} \\left( \\frac{1}{2} - F_k^{-1}(y) \\right) \\,dy \\\\\n&\\geq \\frac{4}{3} \\int_0^{1/2} \\left( \\frac{1}{2} - F_{k-1}^{-1}(y) \\right) \\,dy = \\frac{2}{3}\\mu_{k-1}\n\\end{align*}\nas desired.\n\n\\noindent\n\\textbf{Second solution.}\nRetain notation as in the first solution. Again $F_k(\\frac{1}{2}) = \\frac{1}{2}$, so \\eqref{eq:2021B6 eq1} implies\n\\[\nf_k\\left( \\frac{1}{2} \\right) = 6 f_{k-1} \\left( \\frac{1}{2} \\right) \\times \\frac{1}{2} \\times \\frac{1}{2}.\n\\]\nBy induction on $k$, we deduce that %$f_k(x)$ is a polynomial in $x$,\n$f_k(\\frac{1}{2}) = (\\frac{3}{2})^k$\nand $f_k(x)$ is nondecreasing on $[0,\\frac{1}{2}]$.\n(More precisely, besides \\eqref{eq:2021B6 eq1}, the second assertion uses that $F_{k-1}(x)$ increases from $0$ to $1/2$\nand $y \\mapsto y - y^2$ is nondecreasing on $[0, 1/2]$.)\n\nThe expected value of $|X_k-\\frac{1}{2}|$ equals\n\\begin{align*}\n\\mu_k &= 2 \\int_0^{1/2} \\left( \\frac{1}{2} - x \\right) f_k(x)\\,dx \\\\\n&= 2 \\int_0^{1/2} x f_k\\left( \\frac{1}{2} - x \\right)\\,dx.% \\\\\n%&= \\int_0^{1/2} \\left( \\frac{1}{2} - F_k\\left( \\frac{1}{2} - x \\right)\\right)\\,dx \\\\\n\\end{align*}\n%where the last step is integration by parts. Define the function\nDefine the function\n\\[\ng_k(x) = \\begin{cases} \\left( \\frac{3}{2} \\right)^k & x \\in \\left[ 0, \\frac{1}{2} \\left( \\frac{2}{3} \\right)^k \\right] \\\\ 0 & \\mbox{otherwise}.\n\\end{cases}\n\\]\nNote that for $x \\in [0, 1/2]$ we have\n\\[\n\\int_0^x (g_k(t) - f_k(1/2-t))\\,dt \\geq 0\n\\]\nwith equality at $x=0$ or $x=1/2$. (On the interval $[0, (1/2)(2/3)^k]$ the integrand is nonnegative, so the function increases from 0; on the interval $[(1/2)(2/3)^k, 1/2]$ the integrand is nonpositive, so the function decreases to 0.)\nHence by integration by parts,\n\\begin{align*}\n&\\mu_k - 2 \\int_0^{1/2} x g_k(x) \\,dx \\\\\n&\\quad = \\int_0^{1/2} 2x (f_k\\left( \\frac{1}{2} - x \\right) - g_k(x)) \\,dx \\\\\n&\\quad = \\int_0^{1/2} x^2 \\left( \\int_0^x g_k(t) - \\int_0^x f_k\\left( \\frac{1}{2} - t \\right)\\,dt \\,dt \\right)\\,dx \\geq 0. \n\\end{align*}\n(This can also be interpreted as an instance of the \\emph{rearrangement inequality}.)\n\nWe now see that\n\\begin{align*}\n\\mu_k &\\geq 2\\int_0^{1/2} x g_k(x)\\,dx \\\\\n&\\quad \\geq 2 \\left( \\frac{3}{2} \\right)^k \\int_0^{(1/2)(2/3)^k} x\\,dx\\\\\n&\\quad = 2 \\left( \\frac{3}{2} \\right)^k \\left. \\frac{1}{2} x^2 \\right|_0^{(1/2)(2/3)^k} \\\\\n&\\quad = 2 \\left( \\frac{3}{2} \\right)^k \\frac{1}{8} \\left( \\frac{2}{3} \\right)^{2k}  = \\frac{1}{4} \\left( \\frac{2}{3} \\right)^k\n\\end{align*}\nas desired.\n\n\n\n\\noindent\n\\textbf{Remark.}\nFor comparison, if we instead take the median of a list of $n$ numbers, the probability distribution is given by\n\\[\nP_{2n+1}(x) = \\frac{(2n+1)!}{n!n!} x^n (1-x)^n.\n\\]\nThe expected value of the absolute difference between $1/2$ and the median is \n\\[\n2 \\int_0^{1/2} (1/2 - x) P_{2n+1}(x) dx = 2^{-2n-2}{{2n+1}\\choose n}.\n\\]\nFor $n = 3^{2021}$, using Stirling's approximation this can be estimated as\n$1.13 (0.577)^{2021} < 0.25 (0.667)^{2021}$. This shows that the trimming procedure produces a quantity that is on average further away from 1/2 than the median.\n\n\\end{itemize}\n\\end{document}", "source_problems": "PUTNAM-2021-problems.tex", "source_solutions": "PUTNAM-2021-solutions.tex", "notes": ""}
{"id": "PUTNAM-2022-A1", "contest": "PUTNAM", "year": "2022", "problem_number": "A1", "problem": "Determine all ordered pairs of real numbers $(a,b)$ such that the line $y = ax+b$ intersects the curve $y = \\ln(1+x^2)$ in exactly one point.", "solution": "Write $f(x) = \\ln(1+x^2)$.\nWe show that $y=ax+b$ intersects $y=f(x)$ in exactly one point if and only if $(a,b)$ lies in one of the following groups:\n\\begin{itemize}\n\\item\n$a=b=0$\n\\item\n$|a| \\geq 1$, arbitrary $b$\n\\item\n$0 < |a| < 1$, and $b<\\ln(1-r_-)^2-|a|r_-$ or $b>\\ln(1-r_+)^2-|a|r_+$, where \n\\[\nr_\\pm = \\frac{1\\pm\\sqrt{1-a^2}}{a}.\n\\]\n\\end{itemize}\n\n Since the graph of $y=f(x)$ is symmetric under reflection in the $y$-axis, it suffices to consider the case $a \\geq 0$: $y=ax+b$ and $y=-ax+b$ intersect $y=f(x)$ the same number of times. For $a=0$, by the symmetry of $y=f(x)$ and the fact that $f(x)> 0$ for all $x\\neq 0$ implies that the only line $y=b$ that intersects $y=f(x)$ exactly once is the line $y=0$.\n\nWe next observe that on $[0,\\infty)$, $f'(x) = \\frac{2x}{1+x^2}$ increases on $[0,1]$ from $f'(0)=0$ to a maximum at $f'(1)=1$, and then decreases on $[1,\\infty)$ with $\\lim_{x\\to\\infty} f'(x)=0$. In particular, $f'(x) \\leq 1$ for all $x$ (including $x<0$ since then $f'(x)<0$) and $f'(x)$ achieves each value in $(0,1)$ exactly twice on $[0,\\infty)$.\n\nFor $a \\geq 1$, we claim that any line $y=ax+b$ intersects $y=f(x)$ exactly once. They must intersect at least once by the intermediate value theorem: for $x\\ll 0$, $ax+b<0<f(x)$, while for $x \\gg 0$, $ax+b>f(x)$ since $\\lim_{x\\to\\infty} \\frac{\\ln(1+x^2)}{x} = 0$. On the other hand, they cannot intersect more than once: for $a>1$, this follows from the mean value theorem, since $f'(x)<a$ for all $x$. For $a=1$, suppose that they intersect at two points $(x_0,y_0)$ and $(x_1,y_1)$. Then\n\\[\n1 = \\frac{y_1-y_0}{x_1-x_0} = \\frac{\\int_{x_0}^{x_1} f'(x)\\,dx}{x_1-x_0} < 1\n\\]\nsince $f'(x)$ is continuous and $f'(x) \\leq 1$ with equality only at one point.\n\nFinally we consider $0<a<1$. The equation $f'(x) = a$ has exactly two solutions, at $x=r_-$ and $x=r_+$ for $r_{\\pm}$ as defined above.\nIf we define $g(x) = f(x)-ax$, then $g'(r_\\pm)=0$; $g'$ is strictly decreasing on $(-\\infty,r_-)$, strictly increasing on $(r_-,r_+)$, and strictly decreasing on $(r_+,\\infty)$; and $\\lim_{x\\to-\\infty} g(x) = \\infty$ while $\\lim_{x\\to\\infty} g(x) = -\\infty$. It follows that $g(x)=b$ has exactly one solution for $b<g(r_-)$ or $b>g(r_+)$, exactly three solutions for $g(r_-)<b<g(r_+)$, and exactly two solutions for $b = g(r_\\pm)$. That is, $y=ax+b$ intersects $y=f(x)$ in exactly one point if and only if $b<g(r_-)$ or $b>g(r_+)$.", "source_problems": "PUTNAM-2022-problems.tex", "source_solutions": "PUTNAM-2022-solutions.tex", "notes": ""}
{"id": "PUTNAM-2022-A2", "contest": "PUTNAM", "year": "2022", "problem_number": "A2", "problem": "Let $n$ be an integer with $n \\geq 2$. Over all real polynomials $p(x)$ of degree $n$, what is the largest possible number of negative coefficients of $p(x)^2$?", "solution": "The answer is $2n-2$. Write $p(x) = a_nx^n+\\cdots+a_1x+a_0$ and $p(x)^2 = b_{2n}x^{2n}+\\cdots+b_1x+b_0$. Note that $b_0 = a_0^2$ and $b_{2n} = a_n^2$. We claim that not all of the remaining $2n-1$ coefficients $b_1,\\ldots,b_{2n-1}$ can be negative, whence the largest possible number of negative coefficients is $\\leq 2n-2$. Indeed, suppose $b_i <0$ for $1\\leq i\\leq 2n-1$. Since $b_1 = 2a_0a_1$, we have $a_0 \\neq 0$. Assume $a_0>0$ (or else replace $p(x)$ by $-p(x)$). We claim by induction on $i$ that $a_i < 0$ for $1\\leq i\\leq n$. For $i=1$, this follows from $2a_0a_1 = b_1<0$. If $a_i<0$ for $1\\leq i\\leq k-1$, then\n\\[\n2a_0a_k = b_k - \\sum_{i=1}^{k-1} a_i a_{k-i} < b_k < 0\n\\]\nand thus $a_k<0$, completing the induction step. But now $b_{2n-1} = 2a_{n-1}a_n > 0$, contradiction.\n\nIt remains to show that there is a polynomial $p(x)$ such that $p(x)^2$ has $2n-2$ negative coefficients. For example, we may take\n\\[\np(x) = n(x^n+1) - 2(x^{n-1} + \\cdots + x),\n\\]\nso that\n\\begin{align*}\np(x)^2 &= n^2(x^{2n} + x^n + 1) - 2n(x^n+1)(x^{n-1}+\\cdots+x)\\\\\n&\\qquad \n+ (x^{n-1} + \\cdots + x)^2.\n\\end{align*}\nFor $i\\in \\{1,\\dots,n-1,n+1,\\dots,n-1\\}$, the coefficient of $x^i$ in $p(x)^2$ is at most $-2n$ (coming from the cross term)\nplus $-2n+2$ (from expanding $(x^{n-1} + \\cdots + x)^2$), and hence negative.", "source_problems": "PUTNAM-2022-problems.tex", "source_solutions": "PUTNAM-2022-solutions.tex", "notes": ""}
{"id": "PUTNAM-2022-A3", "contest": "PUTNAM", "year": "2022", "problem_number": "A3", "problem": "Let $p$ be a prime number greater than 5. Let $f(p)$ denote the number of infinite sequences $a_1, a_2, a_3, \\dots$ such that\n$a_n \\in \\{1, 2, \\dots, p-1\\}$ and $a_n a_{n+2} \\equiv 1 + a_{n+1} \\pmod{p}$ for all $n \\geq 1$. Prove that $f(p)$ is congruent to 0 or 2 $\\pmod{5}$.", "solution": "\\textbf{First solution.}\nWe view the sequence $a_1,a_2,\\ldots$ as lying in $\\mathbb{F}_p^\\times \\subset \\mathbb{F}_p$.  Then the sequence is determined by the values of $a_1$ and $a_2$, via the recurrence $a_{n+2}=(1+a_{n+1})/a_n$.  Using this recurrence, we compute\n\\begin{gather*}\na_3=\\frac{1 + a_2}{a_1}, \\, a_4 = \\frac{1 + a_1 + a_2}{a_1 a_2}, \\\\\na_5=\\frac{1 + a_1}{a_2}, \\, a_6 = a_1, \\, a_7 = a_2 \n\\end{gather*}\nand thus the sequence is periodic with period 5.  The values for $a_1$ and $a_2$ may thus be any values in $\\mathbb{F}_p^\\times$ provided that $a_1\\neq p-1$, $a_2\\neq p-1$, and $a_1+a_2\\neq p-1$.  The number of choices for $a_1,a_2\\in\\{1,\\ldots,p-2\\}$ such that $a_1+a_2\\neq p-1$ is thus $(p-2)^2 - (p-2)= (p-2)(p-3)$.\n\nSince $p$ is not a multiple of 5, $(p-2)(p-3)$ is a product of two consecutive integers $a,a+1$, where $a\\not\\equiv 2 \\pmod{5}$. Now $0\\cdot 1\\equiv 0$, $1\\cdot 2 \\equiv 2$, $3\\cdot 4\\equiv 2$, and $4\\cdot 0 \\equiv 0$ (mod 5).  Thus the number of possible sequences $a_1,a_2,\\ldots$ is 0 or 2 (mod 5), as desired. \n\n\\noindent\n\\textbf{Second solution.}\nSay that a sequence is \\textit{admissible} if it satisfies the given conditions. As in the first solution, any admissible sequence is 5-periodic.\n\nNow consider the collection $S$ of possible $5$-tuples of numbers mod $p$ given by $(a_1,a_2,a_3,a_4,a_5)$ for admissible sequences $\\{a_n\\}$. Each of these $5$-tuples in $S$ comes from a unique admissible sequence, and there is a $5$-periodic action on $S$ given by cyclic permutation: $(a,b,c,d,e) \\rightarrow (b,c,d,e,a)$. This action divides $S$ into finitely many orbits, and each orbit either consists of $5$ distinct tuples (if $a,b,c,d,e$ are not all the same) or $1$ tuple $(a,a,a,a,a)$. It follows that the number of admissible sequences is a multiple of $5$ plus the number of constant admissible sequences.\n\nConstant admissible sequences correspond to nonzero numbers $a \\pmod{p}$ such that $a^2 \\equiv 1+a \\pmod{p}$.\nSince the quadratic $x^2-x-1$ has discriminant 5, for $p > 5$ it has either 2 roots (if the discriminant is a quadratic residue mod $p$) or 0 roots mod $p$.", "source_problems": "PUTNAM-2022-problems.tex", "source_solutions": "PUTNAM-2022-solutions.tex", "notes": ""}
{"id": "PUTNAM-2022-A4", "contest": "PUTNAM", "year": "2022", "problem_number": "A4", "problem": "Suppose that $X_1, X_2, \\dots$ are real numbers between 0 and 1 that are chosen independently and uniformly at random. Let $S = \\sum_{i=1}^k X_i/2^i$, where $k$ is the least positive integer such that $X_k < X_{k+1}$, or $k = \\infty$ if there is no such integer. Find the expected value of $S$.", "solution": "The expected value is $2e^{1/2}-3$.\n\nExtend $S$ to an infinite sum by including zero summands for $i> k$. We may then compute the expected value as the sum of the expected value of the $i$-th summand over all $i$. This summand\noccurs if and only if $X_1,\\dots,X_{i-1} \\in [X_i, 1]$\nand $X_1,\\dots,X_{i-1}$ occur in nonincreasing order. These two events are independent and occur with respective probabilities $(1-X_i)^{i-1}$ and $\\frac{1}{(i-1)!}$; the expectation of this summand is therefore\n\\begin{align*}\n&\\frac{1}{2^i(i-1)!} \\int_0^1 t (1-t)^{i-1}\\,dt \\\\\n&\\qquad = \\frac{1}{2^i(i-1)!} \\int_0^1 ((1-t)^{i-1} - (1-t)^i)\\,dt \\\\\n&\\qquad = \\frac{1}{2^i(i-1)!} \\left( \\frac{1}{i} - \\frac{1}{i+1} \\right) = \\frac{1}{2^i (i+1)!}.\n\\end{align*}\nSumming over $i$, we obtain\n\\[\n\\sum_{i=1}^\\infty \\frac{1}{2^i (i+1)!}\n= 2 \\sum_{i=2}^\\infty \\frac{1}{2^i i!}\n= 2\\left(e^{1/2}-1-\\frac{1}{2} \\right).\n\\]", "source_problems": "PUTNAM-2022-problems.tex", "source_solutions": "PUTNAM-2022-solutions.tex", "notes": ""}
{"id": "PUTNAM-2022-A5", "contest": "PUTNAM", "year": "2022", "problem_number": "A5", "problem": "Alice and Bob play a game on a board consisting of one row of 2022 consecutive squares. They take turns placing tiles that cover two adjacent squares, with Alice going first. By rule, a tile must not cover a square that is already covered by another tile. The game ends when no tile can be placed according to this rule. Alice's goal is to maximize the number of uncovered squares when the game ends; Bob's goal is to minimize it. What is the greatest number of uncovered squares that Alice can ensure at the end of the game, no matter how Bob plays?", "solution": "We show that the number in question equals 290. More generally,\nlet $a(n)$ (resp.\\ $b(n)$) be the optimal final score for Alice (resp.\\ Bob) moving first in a position with $n$ consecutive squares. We show that\n\\begin{align*}\na(n) &= \\left\\lfloor \\frac{n}{7} \\right\\rfloor + a\\left(n - 7\\left\\lfloor \\frac{n}{7} \\right\\rfloor \\right), \\\\\nb(n) &= \\left\\lfloor \\frac{n}{7} \\right\\rfloor + b\\left(n - 7\\left\\lfloor \\frac{n}{7} \\right\\rfloor \\right),\n\\end{align*}\nand that the values for $n \\leq 6$ are as follows:\n\\[\n\\begin{array}{c|cccccccccc}\nn & 0 & 1 & 2 & 3 & 4 & 5 & 6 \\\\\n\\hline\na(n) & 0 & 1 & 0 & 1 & 2 & 1 & 2  \\\\\nb(n) & 0 & 1 & 0 & 1 & 0 & 1 & 0 \n\\end{array}\n\\]\nSince $2022 \\equiv 6 \\pmod{7}$, this will yield\n$a(2022) = 2 + \\lfloor \\frac{2022}{7} \\rfloor = 290$.\n\nWe proceed by induction, starting with the base cases $n \\leq 6$.\nSince the number of odd intervals never decreases, we have $a(n), b(n) \\geq n - 2 \\lfloor \\frac{n}{2} \\rfloor$; by looking at the possible final positions, we see that equality holds for $n=0,1,2,3,5$. For $n=4,6$, Alice moving first can split the original interval into two odd intervals, guaranteeing at least two odd intervals in the final position; whereas Bob can move to leave behind one or two intervals of length 2, guaranteeing no odd intervals in the final position.\n\nWe now proceed to the induction step. Suppose that $n \\geq 7$\nand the claim is known for all $m < n$. In particular, this means that $a(m) \\geq b(m)$; consequently, it does not change the analysis to allow a player to pass their turn after the first move, as both players will still have an optimal strategy which involves never passing.\n\nIt will suffice to check that\n\\[\na(n) = a(n-7) + 1, \\qquad b(n) = b(n-7) + 1.\n\\]\nMoving first, Alice can leave behind two intervals of length 1 and $n-3$. This shows that\n\\[\na(n) \\geq 1 + b(n-3) = a(n-7) + 1.\n\\]\nOn the other hand, if Alice leaves behind intervals of length $i$ and $n-2-i$, Bob can choose to play in either one of these intervals and then follow Alice's lead thereafter (exercising the pass option if Alice makes the last legal move in one of the intervals). \nThis shows that\n\\begin{align*}\na(n) &\\leq \\max\\{\\min\\{a(i) + b(n-2-i), \\\\\n& \\qquad b(i)+a(n-2-i)\\}: i =0,1,\\dots,n-2\\} \\\\\n&= a(n-7)+1.\n\\end{align*}\n\nMoving first, Bob can leave behind two intervals of lengths 2 and $n-4$. This shows that\n\\[\nb(n) \\leq a(n-4) = b(n-7) + 1.\n\\]\nOn the other hand, if Bob leaves behind intervals of length $i$ and $n-2-i$, Alice can choose to play in either one of these intervals and then follow Bob's lead thereafter (again passing as needed). This shows that\n\\begin{align*}\nb(n) &\\geq \\min\\{\\max\\{a(i) + b(n-2-i), \\\\\n& \\qquad b(i)+a(n-2-i)\\}: i =0,1,\\dots,n-2\\} \\\\\n&= b(n-7)+1.\n\\end{align*}\nThis completes the induction.", "source_problems": "PUTNAM-2022-problems.tex", "source_solutions": "PUTNAM-2022-solutions.tex", "notes": ""}
{"id": "PUTNAM-2022-A6", "contest": "PUTNAM", "year": "2022", "problem_number": "A6", "problem": "Let $n$ be a positive integer. Determine, in terms of $n$, the largest integer $m$ with the following property: There exist real numbers $x_1,\\dots,x_{2n}$ with $-1 < x_1 < x_2 < \\cdots < x_{2n} < 1$ such that the sum of the lengths of the $n$ intervals\n\\[\n[x_1^{2k-1}, x_2^{2k-1}], [x_3^{2k-1},x_4^{2k-1}], \\dots, [x_{2n-1}^{2k-1}, x_{2n}^{2k-1}]\n\\]\nis equal to 1 for all integers $k$ with $1 \\leq k \\leq m$.", "solution": "\\textbf{First solution.}\nThe largest such $m$ is $n$.\nTo show that $m \\geq n$,\nwe take\n\\[\nx_j = \\cos \\frac{(2n+1-j)\\pi}{2n+1} \\qquad (j=1,\\dots,2n).\n\\]\nIt is apparent that $-1 < x_1 < \\cdots < x_{2n} < 1$.\nThe sum of the lengths of the intervals can be interpreted as\n\\begin{align*}\n& -\\sum_{j=1}^{2n} ((-1)^{2n+1-j} x_j)^{2k-1} \\\\\n&= -\\sum_{j=1}^{2n} \\left(\\cos (2n+1-j)\\left(\\pi + \\frac{\\pi}{2n+1} \\right)\\right)^{2k-1} \\\\\n&= -\\sum_{j=1}^{2n} \\left(\\cos \\frac{2\\pi(n+1)j}{2n+1}\\right)^{2k-1}.\n\\end{align*}\nFor $\\zeta = e^{2 \\pi i (n+1)/(2n+1)}$, this becomes\n\\begin{align*}\n&= -\\sum_{j=1}^{2n} \\left( \\frac{\\zeta^j + \\zeta^{-j}}{2} \\right)^{2k-1} \\\\\n&= -\\frac{1}{2^{2k-1}}\\sum_{j=1}^{2n} \\sum_{l=0}^{2k-1} \n\\binom{2k-1}{l} \\zeta^{j(2k-1-2l)} \\\\\n&= -\\frac{1}{2^{2k-1}} \\sum_{l=0}^{2k-1} \\binom{2k-1}{l}\n\\sum_{j=1}^{2n}\n\\zeta^{j(2k-1-2l)}  \\\\\n&= -\\frac{1}{2^{2k-1}} \\sum_{l=0}^{2k-1} \\binom{2k-1}{l}\n(-1) = 1,\n\\end{align*}\nusing the fact that $\\zeta^{2k-1-2l}$ is a \\emph{nontrivial} root of unity of order dividing $2n+1$.\n\nTo show that $m \\leq n$, we use the following lemma.\nWe say that a multiset $\\{x_1,\\dots,x_m\\}$ of complex numbers is \\emph{inverse-free} if there are no two indices $1 \\leq i \\leq j \\leq m$ such that $x_i + x_j = 0$; this implies in particular that 0 does not occur.\n\\begin{lemma*}\nLet $\\{x_1,\\dots,x_m\\},\\{y_1,\\dots,y_n\\}$ be two inverse-free multisets of complex numbers such that\n\\[\n\\sum_{i=1}^m x_i^{2k-1} = \\sum_{i=1}^n y_i^{2k-1} \\qquad (k=1,\\dots,\\max\\{m,n\\}).\n\\]\nThen these two multisets are equal.\n\\end{lemma*}\n\\begin{proof}\nWe may assume without loss of generality that $m \\leq n$.\nForm the rational functions\n\\[\nf(z) = \\sum_{i=1}^m \\frac{x_i z}{1 - x_i^2 z^2}, \\quad\ng(z) = \\sum_{i=1}^n \\frac{y_i z}{1 - y_i^2 z^2};\n\\]\nboth $f(z)$ and $g(z)$ have total pole order at most $2n$.\nMeanwhile, by expanding in power series around $z=0$, we see that $f(z)-g(z)$ is divisible by $z^{2n+1}$.\nConsequently, the two series are equal. \n\nHowever, we can uniquely recover the multiset $\\{x_1,\\dots,x_m\\}$ from $f(z)$: $f$ has poles at $\\{1/x_1^2,\\dots,1/x_m^2\\}$\nand the residue of the pole at $z = 1/x_i^2$ uniquely determines both $x_i$ (i.e., its sign) and its multiplicity.\nSimilarly, we may recover $\\{y_1,\\dots,y_n\\}$ from $g(z)$, so the two multisets must coincide.\n\\end{proof}\n\nNow suppose by way of contradiction that we have an example showing that $m \\geq n+1$. We then have\n\\[\n1^{2k-1} + \\sum_{i=1}^n x_{2i-1}^{2k-1} = \\sum_{i=1}^n x_{2i}^{2k-1} \\qquad (k=1,\\dots,n+1).\n\\]\nBy the lemma, this means that the multisets $\\{1,x_1,x_3,\\dots,x_{2n-1}\\}$ and $\\{x_2,x_4,\\dots,x_{2n}\\}$ become equal after removing pairs of inverses until this becomes impossible. However, of the resulting two multisets, the first contains 1 and the second does not, yielding the desired contradiction.\n\n\\noindent\n\\textbf{Remark.}\nOne can also prove the lemma using the invertibility of the Vandermonde matrix\n\\[\n(x_i^j)_{i=0,\\dots,n; j=0,\\dots,n}\n\\]\nfor $x_0,\\dots,x_n$ pairwise distinct (this matrix has determinant $\\prod_{0 \\leq i < j \\leq n}(x_i - x_j) \\neq 0$). For a similar argument, see\nProposition 22 of: M. Bhargava, Galois groups of random integer polynomials and van der Waerden's conjecture, arXiv:2111.06507.\n\n\\noindent\n\\textbf{Remark.}\nThe solution for $m=n$ given above is not unique (see below).\nHowever, it does become unique if we add the assumption that $x_i = -x_{2n+1-i}$ for $i=1,\\dots,2n$ (i.e., the set of intervals is symmetric around 0).\n\n\\noindent\n\\textbf{Second solution.} (by Evan Dummit)\nDefine the polynomial\n\\[\np(x) = (x-x_1)(x+x_2) \\cdots (x-x_{2n-1})(x+x_{2n})(x+1);\n\\]\nby hypothesis, $p(x)$ has $2n+1$ distinct real roots in the interval $[-1, 1)$. Let $s_k$ denote the $k$-th power sum of $p(x)$; then for any given $m$, the desired condition is that\n$s_{2k-1} = 0$ for $k=1,\\dots,m$.\nLet $e_k$ denote the $k$-th elementary symmetric function of the roots of $p(x)$; that is,\n\\[\np(x) = x^{2n+1} + \\sum_{i=k}^{2n+1} (-1)^k e_k x^{2n+1-k}.\n\\]\nBy the Girard--Newton identities,\n\\[\n(2k-1) e_{2k-1} = s_1 e_{2k-2} - s_2 e_{2k-2} + \\cdots - s_{2k} e_1;\n\\]\nhence the desired condition implies that $e_{2k-1} = 0$ for $k=1,\\dots,m$.\n\nIf we had a solution with $m=n+1$, then the vanishing of $e_1,\\dots,e_{2k+1}$ would imply that $p(x)$ is an odd polynomial (that is, $p(x) = -p(x)$ for all $x$), which in turn would imply that $x=1$ is also a root of $p$. Since we have already identified $2n+1$ other roots of $p$, this yields a contradiction.\n\nBy the same token, a solution with $m=n$ corresponds to a polynomial $p(x)$ of the form $xq(x^2) + a$ for some polynomial $q(x)$ of degree $n$ and some real number $a$ (necessarily equal to $q(1)$). It will thus suffice to choose $q(x)$ so that the resulting polynomial $p(x)$ has roots consisting of $-1$ plus $2n$ distinct values in $(-1,1)$. To do this, start with any polynomial $r(x)$ of degree $n$ with $n$ distinct positive roots (e.g., $r(x) = (x-1)\\cdots(x-n)$). \nThe polynomial $x r(x^2)$ then has $2n+1$ distinct real roots;\nconsequently, for $\\epsilon > 0$ sufficiently small, $xr(x^2) + \\epsilon$ also has $2n+1$ distinct real roots. Let $-\\alpha$ be the smallest of these roots (so that $\\alpha > 0$); we then take $q(x) = r(x\\sqrt{\\alpha})$ to achieve the desired result.\n\n\\noindent\n\\textbf{Remark.}\nBrian Lawrence points out that one can also produce solutions for $m=n$ by starting with the degenerate solution\n\\[\n-a_{n-1}, \\ldots, -a_1, 0, a_1, \\ldots, a_{n-1}, 1\n\\]\n(where $0 < a_1 < \\cdots < a_{n-1} < 1$ but no other conditions are imposed) and deforming it using the implicit function theorem. More\nprecisely, there exists a differentiable parametric solution $x_1(t),\\dots,x_{2n}(t)$ with $x_i(t) = x_{2n-i}(t)$ for $i=1,\\dots,n-1$ specializing to the previous solution at $t=0$,\nsuch that $x_i'(0) \\neq 0$ for $i=n,\\dots,2n$; this is because the Jacobian matrix\n\\[\nJ = ((2k-1) x_i(0)^{2k-2})_{i=n,\\dots,2n; k=1,\\dots,n}\n\\]\n(interpreting $0^0$ as $1$) has the property that every maximal minor is nonzero (these being scaled Vandermonde matrices).\nIn particular we may normalize so that $x_{2n}'(0) < 0$, and then evaluating at a small positive value of $t$ gives the desired example.\n\nIn the proof that $m=n+1$ cannot occur, one can similarly use the implicit function theorem (with some care) to reduce to the case where $\\{|x_1|,\\dots,|x_{2n}|\\}$ has cardinality $n+1$. This can be extended to a complete solution, but the details are rather involved.", "source_problems": "PUTNAM-2022-problems.tex", "source_solutions": "PUTNAM-2022-solutions.tex", "notes": ""}
{"id": "PUTNAM-2022-B1", "contest": "PUTNAM", "year": "2022", "problem_number": "B1", "problem": "Suppose that $P(x) = a_1 x + a_2 x^2 + \\cdots + a_n x^n$ is a polynomial with integer coefficients, with $a_1$ odd. Suppose that $e^{P(x)} = b_0 + b_1 x + b_2 x^2 + \\cdots$ for all $x$. Prove that $b_k$ is nonzero for all $k \\geq 0$.", "solution": "We prove that $b_k k!$ is an odd integer for all $k \\geq 0$.\n\n\\textbf{First solution.}\nSince $e^{P(x)} = \\sum_{n=0}^\\infty \\frac{(P(x))^n}{n!}$, the number $k!\\,b_k$ is the coefficient of $x^k$ in\n\\[\n(P(x))^k + \\sum_{n=0}^{k-1} \\frac{k!}{n!}(P(x))^n.\n\\]\nIn particular, $b_0=1$ and $b_1=a_1$ are both odd. \n\nNow suppose $k \\geq 2$; we want to show that $b_k$ is odd. The coefficient of $x^k$ in $(P(x))^k$ is $a_1^k$. It suffices to show that the coefficient of $x^k$ in $\\frac{k!}{n!}(P(x))^n$ is an even integer for any $n<k$. For $k$ even or $n \\leq k-2$, this follows immediately from the fact that $\\frac{k!}{n!}$ is an even integer. For $k$ odd and $n=k-1$, we have\n\\begin{align*}\n\\frac{k!}{(k-1)!}(P(x))^{k-1} &= k(a_1x+a_2x^2+\\cdots)^{k-1} \\\\\n&= k(a_1^{k-1}x^{k-1}+(k-1)a_1^{k-2}a_2x^k+\\cdots)\n\\end{align*}\nand the coefficient of $x^k$ is $k(k-1)a_1^{k-2}a_2$, which is again an even integer.\n\n\\noindent\n\\textbf{Second solution.}\nLet $G$ be the set of power series of the form $\\sum_{n=0}^\\infty c_n \\frac{x_n}{n!}$ with $c_0 = 1, c_n \\in \\mathbb{Z}$; then $G$ forms a group under formal series multiplication because\n\\[\n\\left( \\sum_{n=0}^\\infty c_n \\frac{x^n}{n!} \\right)\n\\left( \\sum_{n=0}^\\infty d_n \\frac{x^n}{n!} \\right)\n= \\sum_{n=0}^\\infty e_n \\frac{x^n}{n!} \n\\]\nwith\n\\[\ne_n = \\sum_{m=0}^n \\binom{n}{m} c_m d_{n-m}.\n\\]\nBy the same calculation, the subset $H$ of series with $c_n \\in 2\\mathbb{Z}$ for all $n \\geq 1$ is a subgroup of $G$.\n\nWe have $e^{2x} \\in H$ because $\\frac{2^n}{n!} \\in 2\\mathbb{Z}$ for all $n \\geq 1$: the exponent of 2 in the prime factorization of $n!$ is\n\\[\n\\sum_{i=1}^\\infty \\left\\lfloor \\frac{n}{2^i} \\right\\rfloor\n< \\sum_{i=1}^\\infty \\frac{n}{2^i} = n.\n\\]\nFor any integer $k \\geq 2$, we have $e^{x^k} \\in H$ because $\\frac{(nk)!}{n!} \\in 2\\mathbb{Z}$ for all $n \\geq 1$: this is clear if $k=2,n=1$, and in all other cases the ratio is divisible by $(n+1)(n+2)$. \n\nWe deduce that $e^{P(x)-x} \\in H$.\nBy writing $e^{P(x)}$ as $e^x = \\sum_{n=0}^\\infty \\frac{x^n}{n!}$\ntimes an element of $H$, we deduce that $k! b_k$ is odd for all $k \\geq 0$.\n\n\\noindent\n\\textbf{Third solution.}\n(by David Feldman)\nWe interpret $e^{P(x)}$ using the exponential formula for generating functions.\nFor each $j$, choose a set $S_j$ consisting of $|a_j|$ colors.\nThen $b_k$ is a weighted count over set partitions of $\\{1,\\dots,k\\}$, with each part of size $j$ assigned a color in $S_j$, and the weight being $(-1)^i$ where $i$ is the number of parts of any size $j$ for which $a_j < 0$.\n\nSince we are only looking for the parity of $b_k$, we may dispense with the signs; that is, we may assume $a_j \\geq 0$ for all $j$\nand forget about the weights.\n\nChoose an involution on each $S_j$ with at most one fixed point; this induces an involution on the partitions, so to find the parity of $b_k$ we may instead count fixed points of the involution. That is, we may assume that $a_j \\in \\{0,1\\}$.\n\nLet $T_k$ be the set of set partitions in question with the all-singletons partition removed; it now suffices to exhibit a fixed-point-free involution of $T_k$. To wit, for each partition in $T_k$, there is a smallest index $i \\in \\{1,\\dots,k-1\\}$ for which $i$ and $i+1$ are not both singletons; we define an involution by swapping the positions of $i$ and $i+1$.", "source_problems": "PUTNAM-2022-problems.tex", "source_solutions": "PUTNAM-2022-solutions.tex", "notes": ""}
{"id": "PUTNAM-2022-B2", "contest": "PUTNAM", "year": "2022", "problem_number": "B2", "problem": "Let $\\times$ represent the cross product in $\\mathbb{R}^3$. For what positive integers $n$ does there exist a set $S \\subset \\mathbb{R}^3$ with exactly $n$ elements such that \n\\[\nS = \\{v \\times w: v, w \\in S\\}?\n\\]", "solution": "The possible values of $n$ are 1 and 7.\n\nClearly the set $S = \\{0\\}$ works. Suppose that $S \\neq \\{0\\}$ is a finite set satisfying the given condition; in particular, $S$ does not consist of a collection of collinear vectors, since otherwise $\\{v \\times w: v,w \\in S\\} = \\{0\\}$. We claim that $S$ cannot contain any nonzero vector $v$ with $\\|v\\| \\neq 1$. Suppose otherwise, and let $w \\in S$ be a vector not collinear with $v$. Then $S$ must contain the nonzero vector $u_1 = v\\times w$, as well as the sequence of vectors $u_n$ defined inductively by $u_n = v \\times u_{n-1}$. Since each $u_n$ is orthogonal to $v$ by construction, we have $\\|u_n\\| = \\|v\\| \\|u_{n-1}\\|$ and so $\\|u_n\\| = \\|v\\|^{n-1} \\|u_1\\|$. The sequence $\\|u_n\\|$ consists of all distinct numbers and thus $S$ is infinite, a contradiction. This proves the claim, and so every nonzero vector in $S$ is a unit vector.\n\nNext note that any pair of vectors $v,w \\in S$ must either be collinear or orthogonal: by the claim, $v,w$ are both unit vectors, and if $v,w$ are not collinear then $v\\times w \\in S$ must be a unit vector, whence $v\\perp w$. Now choose any pair of non-collinear vectors $v_1,v_2 \\in S$, and write $v_3 = v_1 \\times v_2$. Then $\\{v_1,v_2,v_3\\}$ is an orthonormal basis of $\\mathbb{R}^3$, and it follows that all of these vectors are in $S$: $0$, $v_1$, $v_2$, $v_3$, $-v_1 = v_3 \\times v_2$, $-v_2 = v_1 \\times v_3$, and $-v_3 = v_2 \\times v_1$. On the other hand, $S$ cannot contain any vector besides these seven, since any other vector $w$ in $S$ would have to be simultaneously orthogonal to all of $v_1,v_2,v_3$.\n\nThus any set $S \\neq \\{0\\}$ satisfying the given condition must be of the form $\\{0,\\pm v_1,\\pm v_2,\\pm v_3\\}$ where $\\{v_1,v_2,v_3\\}$ is an orthonormal basis of $\\mathbb{R}^3$. It is clear that any set of this form does satisfy the given condition. We conclude that the answer is $n=1$ or $n=7$.", "source_problems": "PUTNAM-2022-problems.tex", "source_solutions": "PUTNAM-2022-solutions.tex", "notes": ""}
{"id": "PUTNAM-2022-B3", "contest": "PUTNAM", "year": "2022", "problem_number": "B3", "problem": "Assign to each positive real number a color, either red or blue. Let $D$ be the set of all distances $d > 0$ such that there are two points of the same color at distance $d$ apart. Recolor the positive reals so that the numbers in $D$ are red and the numbers not in $D$ are blue. If we iterate this recoloring process, will we always end up with all the numbers red after a finite number of steps?\n\n\\smallskip", "solution": "The answer is yes. Let $R_0,B_0 \\subset \\mathbb{R}^+$ be the set of red and blue numbers at the start of the process, and let $R_n,B_n$ be the set of red and blue numbers after $n$ steps. We claim that $R_2 = \\mathbb{R}^+$.\n\nWe first note that if $y \\in B_1$, then $y/2 \\in R_1$. Namely, the numbers $y$ and $2y$ must be of opposite colors in the original coloring, and then $3y/2$ must be of the same color as one of $y$ or $2y$. \n\nNow suppose by way of contradiction that $x \\in B_2$. Then of the four numbers $x,2x,3x,4x$, every other number must be in $R_1$ and the other two must be in $B_1$. By the previous observation, $2x$ and $4x$ cannot both be in $B_1$; it follows that $2x,4x \\in R_1$ and $x,3x \\in B_1$. By the previous observation again, $x/2$ and $3x/2$ must both be in $R_1$, but then $x = 3x/2-x/2$ is in $R_2$, contradiction. We conclude that $R_2 = \\mathbb{R}^+$, as desired.", "source_problems": "PUTNAM-2022-problems.tex", "source_solutions": "PUTNAM-2022-solutions.tex", "notes": ""}
{"id": "PUTNAM-2022-B4", "contest": "PUTNAM", "year": "2022", "problem_number": "B4", "problem": "Find all integers $n$ with $n \\geq 4$ for which there exists a sequence of distinct real numbers $x_1,\\dots,x_n$ such that each of the sets\n\\begin{gather*}\n\\{x_1,x_2,x_3\\}, \\{x_2,x_3,x_4\\}, \\dots, \\\\\n\\{x_{n-2},x_{n-1},x_n\\}, \\{x_{n-1},x_n, x_1\\}, \\mbox{ and } \\{x_n, x_1, x_2\\}\n\\end{gather*}\nforms a 3-term arithmetic progression when arranged in increasing order.", "solution": "The values of $n$ in question are the multiples of 3 starting with 9. Note that we interpret ``distinct'' in the problem statement to mean ``pairwise distinct'' (i.e., no two equal). See the remark below.\n\nWe first show that such a sequence can only occur when $n$ is divisible by 3.\nIf $d_1$ and $d_2$ are the common differences of the arithmetic progressions $\\{x_m, x_{m+1}, x_{m+2}\\}$ and $\\{x_{m+1}, x_{m+2}, x_{m+3}\\}$ for some $m$, then $d_2 \\in \\{d_1, 2d_1, d_1/2\\}$. \nBy scaling we may assume that the smallest common difference that occurs is 1; in this case, all of the common differences are integers. By shifting, we may assume that the $x_i$ are themselves all integers. We now observe that any three consecutive terms in the sequence have pairwise distinct residues modulo 3, \nforcing $n$ to be divisible by 3.\n\nWe then observe that for any $m \\geq 2$, \nwe obtain a sequence of the desired form of length $3m+3 = (2m-1)+1+(m+1)+2$ by\nconcatenating the arithmetic progressions\n\\begin{gather*}\n(1, 3, \\dots, 4m-3, 4m-1), \\\\\n4m-2, (4m, 4m-4, \\dots, 4, 0), 2.\n\\end{gather*}\nWe see that no terms are repeated by noting that the first parenthesized sequence consists of odd numbers; the second sequence consists of multiples of 4; and the remaining numbers $2$ and $4m-2$ are distinct (because $m \\geq 2$) but both congruent to 2 mod 4.\n\nIt remains to show that no such sequence occurs with $n=6$.\nWe may assume without loss of generality that the smallest common difference among the arithmetic progressions is 1 and occurs for $\\{x_1, x_2, x_3\\}$; by rescaling, shifting, and reversing the sequence as needed, we may assume that\n$x_1 = 0$ and $(x_2, x_3) \\in \\{(1,2), (2,1)\\}$.\nWe then have $x_4 = 3$ and\n\\[\n(x_5, x_6) \\in \\{(4,5), (-1, -5), (-1, 7), (5, 4), (5, 7)\\}.\n\\]\nIn none of these cases does $\\{x_5, x_6, 0\\}$ form an arithmetic progression.\n\n\\noindent\n\\textbf{Remark.}\nIf one interprets ``distinct'' in the problem statement to mean ``not all equal'', then the problem becomes simpler:\nthe same argument as above shows that $n$ must be a multiple of 3, in which case a suitable repetition of the sequence $-1,0,1$ works.", "source_problems": "PUTNAM-2022-problems.tex", "source_solutions": "PUTNAM-2022-solutions.tex", "notes": ""}
{"id": "PUTNAM-2022-B5", "contest": "PUTNAM", "year": "2022", "problem_number": "B5", "problem": "For $0 \\leq p \\leq 1/2$, let $X_1, X_2, \\dots$ be independent random variables such that\n\\[\nX_i = \\begin{cases} 1 & \\mbox{with probability $p$,} \\\\\n-1 & \\mbox{with probability $p$,} \\\\\n0 & \\mbox{with probability $1-2p$,}\n\\end{cases}\n\\]\nfor all $i \\geq 1$. Given a positive integer $n$ and integers $b, a_1, \\dots, a_n$, let $P(b, a_1, \\dots, a_n)$ denote the probability that $a_1 X_1 + \\cdots + a_n X_n = b$. For which values of $p$ is it the case that\n\\[\nP(0, a_1, \\dots, a_n) \\geq P(b, a_1, \\dots, a_n)\n\\]\nfor all positive integers $n$ and all integers $b, a_1, \\dots, a_n$?", "solution": "\\textbf{First solution.}\nThe answer is $p \\leq 1/4$. We first show that $p >1/4$ does not satisfy the desired condition. For $p>1/3$, $P(0,1) = 1-2p < p = P(1,1)$. For $p=1/3$, it is easily calculated (or follows from the next calculation) that $P(0,1,2) = 1/9 < 2/9 = P(1,1,2)$. Now suppose $1/4 < p < 1/3$, and consider $(b,a_1,a_2,a_3,\\ldots,a_n) = (1,1,2,4,\\ldots,2^{n-1})$.  The only solution to\n\\[\nX_1+2X_2+\\cdots+2^{n-1}X_n = 0\n\\]\nwith $X_j \\in \\{0,\\pm 1\\}$ is $X_1=\\cdots=X_n=0$; thus $P(0,1,2,\\ldots,2^{2n-1}) = (1-2p)^n$. On the other hand, the solutions to\n\\[\nX_1+2X_2+\\cdots+2^{n-1}X_n = 1\n\\]\nwith $X_j \\in \\{0,\\pm 1\\}$ are \n\\begin{gather*}\n(X_1,X_2,\\ldots,X_n) = (1,0,\\ldots,0),(-1,1,0,\\ldots,0), \\\\\n(-1,-1,1,0,\\ldots,0), \\ldots, (-1,-1,\\ldots,-1,1),\n\\end{gather*}\nand so\n\\begin{align*}\n&P(1,1,2,\\ldots,2^{n-1}) \\\\\n& = p(1-2p)^{n-1}+p^2(1-2p)^{n-2}+\\cdots+p^n \\\\\n&= p\\frac{(1-2p)^{n}-p^{n}}{1-3p}.\n\\end{align*}\nIt follows that the inequality\n$P(0,1,2,\\ldots,2^{n-1}) \\geq P(1,1,2,\\ldots,2^{n-1})$ is equivalent to \n\\[\np^{n+1} \\geq (4p-1)(1-2p)^n,\n\\]\nbut this is false for sufficiently large $n$ since $4p-1>0$ and $p<1-2p$.\n\nNow suppose $p \\leq 1/4$; we want to show that for arbitrary $a_1,\\ldots,a_n$ and $b \\neq 0$, $P(0,a_1,\\ldots,a_n) \\geq P(b,a_1,\\ldots,a_n)$. Define the polynomial\n\\[\nf(x) = px+px^{-1}+1-2p, \n\\]\nand observe that $P(b,a_1,\\ldots,a_n)$ is the coefficient of $x^b$ in\n$f(x^{a_1})f(x^{a_2})\\cdots f(x^{a_n})$. We can write\n\\[\nf(x^{a_1})f(x^{a_2})\\cdots f(x^{a_n}) = g(x)g(x^{-1})\n\\]\nfor some real polynomial $g$: indeed, if we define $\\alpha = \\frac{1-2p+\\sqrt{1-4p}}{2p} > 0$, then $f(x) = \\frac{p}{\\alpha}(x+\\alpha)(x^{-1}+\\alpha)$, and so we can use\n\\[\ng(x) = \\left(\\frac{p}{\\alpha}\\right)^{n/2} (x^{a_1}+\\alpha)\\cdots(x^{a_n}+\\alpha).\n\\]\n\nIt now suffices to show that in $g(x)g(x^{-1})$, the coefficient of $x^0$ is at least as large as the coefficient of $x^b$ for any $b \\neq 0$. Since $g(x)g(x^{-1})$ is symmetric upon inverting $x$, we may assume that $b > 0$. If we write $g(x) = c_0 x^0 + \\cdots + c_m x^m$, then the coefficients of $x^0$ and $x^b$ in $g(x)g(x^{-1})$ are $c_0^2+c_1^2+\\cdots+c_m^2$ and $c_0c_b+c_1c_{b+1}+\\cdots+c_{m-b}c_m$, respectively. But\n\\begin{align*}\n&2(c_0c_b+c_1c_{b+1}+\\cdots+c_{m-b}c_m)\\\\\n&\\leq (c_0^2+c_b^2)+(c_1^2+c_{b+1}^2)+\\cdots+(c_{m-b}^2+c_m^2) \\\\\n& \\leq\n2(c_0^2+\\cdots+c_m^2),\n\\end{align*}\nand the result follows.\n\n\\noindent\n\\textbf{Second solution.} (by Yuval Peres)\nWe check that $p \\leq 1/4$ is necessary as in the first solution. To check that it is sufficient, we introduce the following concept: for $X$ a random variable taking finitely many integer values, define the \\emph{characteristic function}\n\\[\n\\varphi_X(\\theta) = \\sum_{\\ell \\in \\mathbb{Z}} P(X = \\ell) e^{i \\ell \\theta}\n\\]\n(i.e., the expected value of $e^{i X\\theta}$, or \nthe Fourier transform of the probability measure corresponding to $X$). We use two evident properties of these functions:\n\\begin{itemize}\n\\item\nIf $X$ and $Y$ are independent, then $\\varphi_{X+Y}(\\theta) = \\varphi_X(\\theta) + \\varphi_Y(\\theta)$.\n\\item\nFor any $b \\in \\mathbb{Z}$,\n\\[\nP(X = b) = \\frac{1}{2} \\int_0^{2\\pi} e^{-ib\\theta} \\varphi_X(\\theta)\\,d\\theta.\n\\]\nIn particular, if $\\varphi_X(\\theta) \\geq 0$ for all $\\theta$, then\n$P(X=b) \\leq P(X = 0)$.\n\\end{itemize}\n\nFor $p \\leq 1/4$, we have\n\\[\n\\varphi_{X_k}(\\theta) = (1-2p) + 2p \\cos (\\theta) \\geq 0.\n\\]\nHence for $a_1,\\dots,a_n \\in \\mathbb{Z}$, the random variable $S = a_1 X_1 + \\cdots + a_n X_n$ satisfies\n\\[\n\\varphi_S(\\theta) = \\prod_{k=1}^n \\varphi_{a_kX_k}(\\theta)\n= \\prod_{k=1}^n \\varphi_{X_k}(a_k\\theta) \\geq 0.\n\\]\nWe may thus conclude that $P(S=b) \\leq P(S=0)$ for any $b \\in \\mathbb{Z}$, as desired.", "source_problems": "PUTNAM-2022-problems.tex", "source_solutions": "PUTNAM-2022-solutions.tex", "notes": ""}
{"id": "PUTNAM-2022-B6", "contest": "PUTNAM", "year": "2022", "problem_number": "B6", "problem": "Find all continuous functions $f: \\mathbb{R}^+ \\to \\mathbb{R}^+$ such that\n\\[\nf(xf(y)) + f(yf(x)) = 1 + f(x+y)\n\\]\nfor all $x,y > 0$.\n\\end{itemize}\n\n\\end{document}", "solution": "The only such functions are the functions $f(x) = \\frac{1}{1+cx}$\nfor some $c \\geq 0$ (the case $c=0$ giving the constant function $f(x) = 1$). \nNote that we interpret $\\mathbb{R}^+$ in the problem statement to mean the set of positive real numbers, excluding 0.\n\nFor convenience, we reproduce here the given equation:\n\\begin{equation} \\label{eq:B61}\nf(xf(y)) + f(yf(x)) = 1 + f(x+y)\n\\end{equation}\n\nWe first prove that\n\\begin{equation} \\label{eq:B62}\n\\lim_{x \\to 0^+} f(x) = 1.\n\\end{equation}\nSet\n\\[\nL_- = \\liminf_{x \\to 0^+} f(x),\n\\quad\nL_+ = \\limsup_{x \\to 0^+} f(x).\n\\]\nFor any fixed $y$, we have by \\eqref{eq:B61}\n\\begin{align*}\nL_+ &= \\limsup_{x \\to 0^+} f(xf(y)) \\\\\n&\\leq \\limsup_{x \\to0^+} (1+f(x+y))\n= 1+f(y) < \\infty.\n\\end{align*}\nConsequently, $xf(x) \\to 0$ as $x \\to 0^+$.\nBy \\eqref{eq:B62} with $y=x$,\n\\begin{align*}\n2L_+ &= \\limsup_{x \\to 0^+} 2f(xf(x)) \\\\\n&= \\limsup_{x \\to 0^+} (1 + f(2x)) = 1 + L_+ \\\\\n2L_- &= \\liminf_{x \\to 0^+} 2f(xf(x)) \\\\\n&= \\liminf_{x \\to 0^+} (1 + f(2x)) = 1 + L_-\n\\end{align*}\nand so $L_- = L_+ = 1$, confirming \\eqref{eq:B62}.\n\nWe next confirm that\n\\begin{equation} \\label{eq:B63}\nf(x) \\geq 1 \\mbox{ for all } x>0 \\Longrightarrow f(x) = 1 \\mbox{ for all } x>0.\n\\end{equation}\nSuppose that $f(x) \\geq 1$ for all $x > 0$.\nFor $0 < c \\leq \\infty$, put $S_c = \\sup\\{f(x): 0 < x \\leq c\\}$;\nfor $c < \\infty$, \\eqref{eq:B62} implies that $S_c < \\infty$.\nIf there exists $y>0$ with $f(y) > 1$, then from \\eqref{eq:B61} we have $f(x+y) - f(xf(y)) = f(yf(x)) - 1 \\geq 0$;\nhence\n\\[\nS_c = S_{(c-y)f(y)} \\qquad \\left(c \\geq c_0 = \\frac{yf(y)}{f(y)-1}\\right)\n\\]\nand (since $(c-y)f(y) - c_0 = f(y)(c-c_0)$) iterating this construction shows that $S_\\infty = S_c$ for any $c > c_0$.\nIn any case, we deduce that \n\\begin{equation} \\label{eq:B64}\nf(x) \\geq 1 \\mbox{ for all } x>0 \\Longrightarrow S_\\infty < \\infty.\n\\end{equation}\nStill assuming that $f(x) \\geq 1$ for all $x>0$,\nnote that from \\eqref{eq:B61} with $x=y$,\n\\[\nf(xf(x)) = \\frac{1}{2}(1 + f(2x)).\n\\]\nSince $xf(x) \\to 0$ as $x \\to 0^+$ by \\eqref{eq:B62} and $xf(x) \\to \\infty$ as $x \\to \\infty$, $xf(x)$ takes all positive real values by the intermediate value theorem. We deduce that $2S_\\infty \\leq 1 + S_\\infty$ and hence $S_\\infty = 1$; \nthis proves \\eqref{eq:B63}.\n\nWe may thus assume hereafter that $f(x) < 1$ for some $x > 0$.\nWe next check that\n\\begin{equation} \\label{eq:B65}\n\\lim_{x \\to \\infty} f(x) = 0.\n\\end{equation}\nPut $I = \\inf\\{f(x): x > 0\\} < 1$, choose $\\epsilon \\in (0, (1-I)/2)$, and choose $y>0$ such that $f(y) < I+\\epsilon$. We then must have $xf(x) \\neq y$ for all $x$, or else\n\\[\n1 + I \\leq 1 + f(2x) = 2f(y) < 2I + 2\\epsilon,\n\\]\ncontradiction. Since $xf(x) \\to 0$ as $x \\to 0^+$ by \\eqref{eq:B62}, we have $\\sup\\{xf(x): x > 0\\} < \\infty$ by the intermediate value theorem, yielding \\eqref{eq:B65}.\n\nBy \\eqref{eq:B62} plus \\eqref{eq:B65},\n$f^{-1}(1/2)$ is nonempty and compact.\nWe can now simplify by noting that if $f(x)$ satisfies the original equation, then so does $f(cx)$ for any $c>0$; we may thus assume\nthat the least element of $f^{-1}(1/2)$ is 1,\nin which case we must show that $f(x) = \\frac{1}{1+x}$.\n\nWe next show that\n\\begin{equation}  \\label{eq:B68}\n\\lim_{x \\to \\infty} xf(x) = 1.\n\\end{equation}\nFor all $x > 0$,\nby \\eqref{eq:B61} with $y=x$,\n\\begin{equation} \\label{eq:B68a}\nf(xf(x)) = \\frac{1}{2}(1 + f(2x)) > \\frac{1}{2} = f(1),\n\\end{equation}\nso in particular $xf(x) \\neq 1$.\nAs in the proof of \\eqref{eq:B65}, this implies that $xf(x) < 1$ for all $x > 0$.\nHowever, by \\eqref{eq:B65} and \\eqref{eq:B68a}\nwe have $f(xf(x)) \\to \\frac{1}{2}$ as $x \\to \\infty$,\nyielding \\eqref{eq:B68}.\n\nBy substituting $y \\mapsto xy$ in \\eqref{eq:B61},\n\\[\nf(xf(xy)) + f(xyf(x)) = 1 + f(x+xy).\n\\]\nTaking the limit as $x \\to \\infty$ and applying \\eqref{eq:B68} yields\n\\begin{equation} \\label{eq:B69}\nf(1/y) + f(y) = 1.\n\\end{equation}\nCombining  \\eqref{eq:B61} with \\eqref{eq:B69} yields\n\\[\nf(xf(y))=f(x+y)+f \\left( \\frac{1}{yf(x)} \\right).\n\\]\nMultiply both sides by $xf(y)$, then take the limit as $x \\to \\infty$ to obtain\n\\begin{align*}\n1 &= \\lim_{x \\to \\infty} xf(y) f(x+y) + \\lim_{x \\to \\infty} xf(y) \nf\\left( \\frac{1}{yf(x)} \\right) \\\\\n&= f(y) + \\lim_{x \\to \\infty} xf(y) yf(x) \\\\\n&= f(y) + yf(y)\n\\end{align*}\nand solving for $f(y)$ now yields $f(y) = \\frac{1}{1+y}$, as desired.\n\n\\noindent\n\\textbf{Remark.}\nSome variants of the above approach are possible. For example,\nonce we have \\eqref{eq:B65}, we can establish that $f$ is monotone decreasing as follows. We first check that\n\\begin{equation} \\label{eq:B66}\nf(x) < 1 \\mbox{ for all } x > 0.\n\\end{equation}\nSuppose by way of contradiction that $f(x) = 1$ for some $x$.\nBy \\eqref{eq:B61},\n\\[\nf(2x) + 1 = 2f(xf(x)) = 2f(x) = 2\n\\]\nand so $f(2x) = 1$. It follows that $f^{-1}(1)$ is infinite, contradicting \\eqref{eq:B65}.\n\n\nWe next check that\n\\begin{equation} \\label{eq:B67}\nx<y \\Longrightarrow f(x) > f(y).\n\\end{equation}\nFor $x < y$, by substituting $x \\mapsto y-x$ in \\eqref{eq:B61} we obtain\n\\begin{align*}\n1+f(y) &= f(xf(y-x)) + f((y-x)f(x)) \\\\\n&< 1 + f((y-x)f(x)),\n\\end{align*}\nwhence $f((y-x)f(x))> f(y)$. Because $(y-x)f(x) \\to 0$ as $x \\to y^-$ and $(y-x)f(x) \\to y$ as $x \\to 0^+$, $(y-x)f(x)$ takes all values in $(0,y)$ as $x$ varies over $(0,y)$; this proves \\eqref{eq:B67}.\n\n\n\\end{itemize}\n\\end{document}", "source_problems": "PUTNAM-2022-problems.tex", "source_solutions": "PUTNAM-2022-solutions.tex", "notes": ""}
{"id": "PUTNAM-2023-A1", "contest": "PUTNAM", "year": "2023", "problem_number": "A1", "problem": "For a positive integer $n$, let $f_n(x) = \\cos(x) \\cos(2x) \\cos(3x) \\cdots \\cos(nx)$. Find the smallest $n$ such that $|f_n''(0)| > 2023$.", "solution": "If we use the product rule to calculate $f_n''(x)$, the result is a sum of terms of two types: terms where two distinct factors $\\cos(m_1x)$ and $\\cos(m_2x)$ have each been differentiated once, and terms where a single factor $\\cos(mx)$ has been differentiated twice. When we evaluate at $x=0$, all terms of the first type vanish since $\\sin(0)=0$, while the term of the second type involving $(\\cos(mx))''$ becomes $-m^2$. Thus \n\\[\n|f_n''(0)| = \\left|-\\sum_{m=1}^n m^2\\right| = \\frac{n(n+1)(2n+1)}{6}.\n\\]\nThe function $g(n) = \\frac{n(n+1)(2n+1)}{6}$ is increasing for $n\\in\\mathbb{N}$ and satisfies $g(17)=1785$ and $g(18)=2109$. It follows that the answer is $n=18$.", "source_problems": "PUTNAM-2023-problems.tex", "source_solutions": "PUTNAM-2023-solutions.tex", "notes": ""}
{"id": "PUTNAM-2023-A2", "contest": "PUTNAM", "year": "2023", "problem_number": "A2", "problem": "Let $n$ be an even positive integer. Let $p$ be a monic, real polynomial of degree $2n$; that is to say, $p(x) = x^{2n} + a_{2n-1} x^{2n-1} + \\cdots + a_1 x + a_0$ for some real coefficients $a_0, \\dots, a_{2n-1}$. Suppose that $p(1/k) = k^2$ for all integers $k$ such that $1 \\leq |k| \\leq n$. Find all other real numbers $x$ for which $p(1/x) = x^2$.", "solution": "The only other real numbers with this property are $\\pm 1/n!$.\n(Note that these are indeed \\emph{other} values than $\\pm 1, \\dots, \\pm n$ because $n>1$.)\n\nDefine the polynomial $q(x) = x^{2n+2}-x^{2n}p(1/x) = x^{2n+2}-(a_0x^{2n}+\\cdots+a_{2n-1}x+1)$. The statement that $p(1/x)=x^2$ is equivalent (for $x\\neq 0$) to the statement that $x$ is a root of $q(x)$. Thus we know that $\\pm 1,\\pm 2,\\ldots,\\pm n$ are roots of $q(x)$, and we can write\n\\[\nq(x) = (x^2+ax+b)(x^2-1)(x^2-4)\\cdots (x^2-n^2)\n\\]\nfor some monic quadratic polynomial $x^2+ax+b$. Equating the coefficients of $x^{2n+1}$ and $x^0$ on both sides gives $0=a$ and $-1=(-1)^n(n!)^2 b$, respectively. Since $n$ is even, we have $x^2+ax+b = x^2-(n!)^{-2}$. We conclude that there are precisely two other real numbers $x$ such that $p(1/x)=x^2$, and they are $\\pm 1/n!$.", "source_problems": "PUTNAM-2023-problems.tex", "source_solutions": "PUTNAM-2023-solutions.tex", "notes": ""}
{"id": "PUTNAM-2023-A3", "contest": "PUTNAM", "year": "2023", "problem_number": "A3", "problem": "Determine the smallest positive real number $r$ such that there exist differentiable functions $f\\colon \\mathbb{R} \\to \\mathbb{R}$ and\n$g\\colon \\mathbb{R} \\to \\mathbb{R}$ satisfying\n\\begin{enumerate}\n\\item[(a)] $f(0) > 0$,\n\\item[(b)] $g(0) = 0$,\n\\item[(c)] $|f'(x)| \\leq |g(x)|$ for all $x$,\n\\item[(d)] $|g'(x)| \\leq |f(x)|$ for all $x$, and\n\\item[(e)] $f(r) = 0$.\n\\end{enumerate}", "solution": "The answer is $r=\\frac{\\pi}{2}$, which manifestly is achieved by setting $f(x)=\\cos x$ and $g(x)=\\sin x$.\n\n\\noindent\n\\textbf{First solution.}\nSuppose by way of contradiction that there exist some $f,g$ satisfying the stated conditions for some $0 < r<\\frac{\\pi}{2}$. We first note that we can assume that $f(x) \\neq 0$ for $x\\in [0,r)$. Indeed, by continuity, $\\{x\\,|\\,x\\geq 0 \\text{ and } f(x)=0\\}$ is a closed subset of $[0,\\infty)$ and thus has a minimum element $r'$ with $0<r'\\leq r$. After replacing $r$ by $r'$, we now have $f(x)\\neq 0$ for $x\\in [0,r)$.\n\nNext we note that $f(r)=0$ implies $g(r) \\neq 0$. Indeed, define the function $k :\\thinspace \\mathbb{R} \\to \\mathbb{R}$ by $k(x) = f(x)^2+g(x)^2$. Then $|k'(x)| = 2|f(x)f'(x)+g(x)g'(x))| \\leq 4|f(x)g(x)| \\leq 2k(x)$, where the last inequality follows from the AM-GM inequality. It follows that $\\left|\\frac{d}{dx} (\\log k(x))\\right| \\leq 2$ for $x \\in [0,r)$; since $k(x)$ is continuous at $x=r$, we conclude that $k(r) \\neq 0$.\n\nNow define the function $h\\colon [0,r) \\to (-\\pi/2,\\pi/2)$ by $h(x) = \\tan^{-1}(g(x)/f(x))$. We compute that\n\\[\nh'(x) = \\frac{f(x)g'(x)-g(x)f'(x)}{f(x)^2+g(x)^2}\n\\]\nand thus\n\\[\n|h'(x)| \\leq \\frac{|f(x)||g'(x)|+|g(x)||f'(x)|}{f(x)^2+g(x)^2} \\leq \\frac{|f(x)|^2+|g(x)|^2}{f(x)^2+g(x)^2} = 1.\n\\]\nSince $h(0) = 0$, we have $|h(x)| \\leq x<r$ for all $x\\in [0,r)$. Since $r<\\pi/2$ and $\\tan^{-1}$ is increasing on $(-r,r)$, we conclude that $|g(x)/f(x)|$ is uniformly bounded above by $\\tan r$ for all $x\\in [0,r)$. But this contradicts the fact that $f(r)=0$ and $g(r) \\neq 0$, since $\\lim_{x\\to r^-} g(x)/f(x) = \\infty$. This contradiction shows that $r<\\pi/2$ cannot be achieved.\n\n\\noindent\n\\textbf{Second solution.}\n(by Victor Lie)\nAs in the first solution, we may assume $f(x) > 0$ \nfor $x \\in [0,r)$.\nCombining our hypothesis with the fundamental theorem of calculus, for $x > 0$ we obtain\n\\begin{align*}\n|f'(x)| &\\leq |g(x)| \\leq \\left| \\int_0^x g'(t)\\,dt \\right|  \\\\\n& \\leq \\int_0^x |g'(t)| \\,dt \\leq \\int_0^x |f(t)|\\,dt.\n\\end{align*}\nDefine $F(x) = \\int_0^x f(t)\\,dt$; we then have\n\\[\nf'(x) + F(x) \\geq 0 \\qquad (x \\in [0,r]).\n\\]\nNow suppose by way of contradiction that $r < \\frac{\\pi}{2}$.\nThen $\\cos x > 0$ for $x \\in [0,r]$, so \n\\[\nf'(x) \\cos x + F(x) \\cos x \\geq 0 \\qquad (x \\in [0,r]).\n\\]\nThe left-hand side is the derivative of $f(x) \\cos x + F(x) \\sin x $. Integrating from $x=y$ to $x=r$, we obtain\n\\[\nF(r) \\sin r \\geq f(y) \\cos y + F(y) \\sin y \\qquad (y \\in [0,r]).\n\\]\nWe may rearrange to obtain\n\\[\nF(r)\\sin r \\sec^2 y \\geq f(y) \\sec y + F(y) \\sin y \\sec^2 y \\quad (y \\in [0,r]).\n\\]\nThe two sides are the derivatives of $F(r) \\sin r \\tan y$ and $F(y) \\sec y$, respectively.\nIntegrating from $y=0$ to $y=r$ and multiplying by $\\cos^2 r$, we obtain\n\\[\nF(r) \\sin^2 r \\geq F(r)\n\\]\nwhich is impossible because $F(r) > 0$ and $0 < \\sin r < 1$.", "source_problems": "PUTNAM-2023-problems.tex", "source_solutions": "PUTNAM-2023-solutions.tex", "notes": ""}
{"id": "PUTNAM-2023-A4", "contest": "PUTNAM", "year": "2023", "problem_number": "A4", "problem": "Let $v_1, \\dots, v_{12}$ be unit vectors in $\\mathbb{R}^3$ from the origin to the vertices of a regular icosahedron. Show that for every vector $v \\in \\mathbb{R}^3$ and every $\\varepsilon > 0$, there exist integers $a_1,\\dots,a_{12}$ such that $\\| a_1 v_1 + \\cdots + a_{12} v_{12} - v \\| < \\varepsilon$.", "solution": "The assumption that all vertices of the icosahedron correspond to vectors of the same length forces the center of the icosahedron to lie at the origin, since the icosahedron is inscribed in a unique sphere.\nSince scaling the icosahedron does not change whether or not the stated conclusion is true, we may choose coordinates so that the vertices are the cyclic permutations of the vectors $(\\pm \\frac{1}{2}, \\pm \\frac{1}{2} \\phi, 0)$ where\n$\\phi = \\frac{1+\\sqrt{5}}{2}$ is the golden ratio. The subgroup of $\\RR^3$ generated by these vectors contains $G \\times G \\times G$ where $G$ is the subgroup of $\\RR$ generated by 1 and $\\phi$. Since $\\phi$ is irrational, it generates a dense subgroup of $\\RR/\\ZZ$; hence $G$ is dense in $\\RR$, and so $G \\times G \\times G$ is dense in $\\RR^3$,\nproving the claim.", "source_problems": "PUTNAM-2023-problems.tex", "source_solutions": "PUTNAM-2023-solutions.tex", "notes": ""}
{"id": "PUTNAM-2023-A5", "contest": "PUTNAM", "year": "2023", "problem_number": "A5", "problem": "For a nonnegative integer $k$, let $f(k)$ be the number of ones in the base 3 representation of $k$. Find all complex numbers $z$ such that\n\\[\n\\sum_{k=0}^{3^{1010}-1} (-2)^{f(k)} (z+k)^{2023} = 0.\n\\]", "solution": "The complex numbers $z$ with this property are\n\\[\n-\\frac{3^{1010}-1}{2} \\text{ and } -\\frac{3^{1010}-1}{2}\\pm\\frac{\\sqrt{9^{1010}-1}}{4}\\,i.\n\\]\n\nWe begin by noting that for $n \\geq 1$, we have the following equality of polynomials in a parameter $x$:\n\\[\n\\sum_{k=0}^{3^n-1} (-2)^{f(k)} x^k = \\prod_{j=0}^{n-1} (x^{2\\cdot 3^j}-2x^{3^j}+1).\n\\]\nThis is readily shown by induction on $n$, using the fact that for $0\\leq k\\leq 3^{n-1}-1$, $f(3^{n-1}+k)=f(k)+1$ and $f(2\\cdot 3^{n-1}+k)=f(k)$.\n\nNow define a ``shift'' operator $S$ on polynomials in $z$ by $S(p(z))=p(z+1)$; then we can define $S^m$ for all $m\\in\\mathbb{Z}$ by $S^m(p(z))$, and in particular $S^0=I$ is the identity map. Write\n\\[\np_n(z) := \\sum_{k=0}^{3^n-1}(-2)^{f(k)}(z+k)^{2n+3}\n\\]\nfor $n \\geq 1$; it follows that \n\\begin{align*}\np_n(z) &= \\prod_{j=0}^{n-1}(S^{2\\cdot 3^j}-2S^{3^j}+I) z^{2n+3}\n\\\\\n&= S^{(3^n-1)/2} \\prod_{j=0}^{n-1}(S^{3^j}-2I+S^{-3^j}) z^{2n+3}.\n\\end{align*}\nNext observe that for any $\\ell$, the operator $S^\\ell-2I+S^{-\\ell}$ acts on polynomials in $z$ in a way that decreases degree by $2$. More precisely, for $m\\geq 0$, we have\n\\begin{align*}\n(S^\\ell-2I+S^{-\\ell})z^m &= (z+\\ell)^m-2z^m+(z-\\ell)^m \\\\\n&= 2{m\\choose 2}\\ell^2z^{m-2}+2{m\\choose 4}\\ell^4z^{m-4}+O(z^{m-6}).\n\\end{align*}\nWe use this general calculation to establish the following: for any $1\\leq i\\leq n$, there is a nonzero constant $C_i$ (depending on $n$ and $i$ but not $z$) such that\n\\begin{gather}\n\\nonumber\n\\prod_{j=1}^{i} (S^{3^{n-j}}-2I+S^{-3^{n-j}}) z^{2n+3} \\\\\n\\nonumber\n= C_i\\left(z^{2n+3-2i}+\\textstyle{\\frac{(2n+3-2i)(n+1-i)}{6}}(\\sum_{j=1}^i 9^{n-j})z^{2n+1-2i}\\right) \\\\\n+O(z^{2n-1-2i}).\n\\label{eq:product}\n\\end{gather}\nProving \\eqref{eq:product} is a straightforward induction on $i$: the induction step applies $S^{3^{n-i-1}}-2I+S^{-3^{n-i-1}}$ to the right hand side of \\eqref{eq:product}, using the general formula for $(S^\\ell-2I+S^{-\\ell})z^m$.\n\nNow setting $i=n$ in \\eqref{eq:product}, we find that for some $C_n$,\n\\[\n\\prod_{j=0}^{n-1}(S^{3^j}-2I+S^{-3^j}) z^{2n+3} = C_n\\left(z^3+\\frac{9^n-1}{16}z\\right).\n\\]\nThe roots of this polynomial are $0$ and $\\pm \\frac{\\sqrt{9^n-1}}{4} i$, and it follows that the roots of $p_n(z)$ are these three numbers minus $\\frac{3^n-1}{2}$. In particular, when $n=1010$, we find that the roots of $p_{1010}(z)$ are as indicated above.", "source_problems": "PUTNAM-2023-problems.tex", "source_solutions": "PUTNAM-2023-solutions.tex", "notes": ""}
{"id": "PUTNAM-2023-A6", "contest": "PUTNAM", "year": "2023", "problem_number": "A6", "problem": "Alice and Bob play a game in which they take turns choosing integers from $1$ to $n$. Before any integers are chosen, Bob selects a goal of ``odd'' or ``even''. On the first turn, Alice chooses one of the $n$ integers. On the second turn, Bob chooses one of the remaining integers. They continue alternately choosing one of the integers that has not yet been chosen, until the $n$th turn, which is forced and ends the game. Bob wins if the parity of $\\{k\\colon \\mbox{the number $k$ was chosen on the $k$th turn}\\}$ matches his goal. For which values of $n$ does Bob have a winning strategy?", "solution": "(Communicated by Kai Wang)\nFor all $n$, Bob has a winning strategy. Note that we can interpret the game play as building a permutation of $\\{1,\\dots,n\\}$, and the number of times an integer $k$ is chosen on the $k$-th turn is exactly the number of fixed points of this permutation.\n\nFor $n$ even, Bob selects the goal ``even''. Divide $\\{1,\\dots,n\\}$ into the pairs $\\{1,2\\},\\{3,4\\},\\dots$; each time Alice chooses an integer, Bob follows suit with the other integer in the same pair. For each pair $\\{2k-1,2k\\}$, we see that $2k-1$ is a fixed point if and only if $2k$ is, so the number of fixed points is even.\n\nFor $n$ odd, Bob selects the goal ``odd''. On the first turn, if Alice chooses 1 or 2, then Bob chooses the other one to transpose into the strategy for $n-2$ (with no moves made). We may thus assume hereafter that Alice's first move is some $k > 2$, which Bob counters with 2; at this point there is exactly one fixed point. \n\nThereafter, as long as Alice chooses $j$ on the $j$-th turn (for $j \\geq 3$ odd), either $j+1 < k$, in which case Bob can choose $j+1$\nto keep the number of fixed points odd; or $j+1=k$, in which case $k$ is even and Bob can choose 1 to transpose into the strategy for  $n-k$ (with no moves made).\n\nOtherwise, at some odd turn $j$, Alice does not choose $j$. At this point, the number of fixed points is odd, and on each subsequent turn Bob can ensure that neither his own move nor Alice's next move does not create a fixed point: on any turn $j$ for Bob, if $j+1$ is available Bob chooses it; otherwise, Bob has at least two choices available, so he can choose a value other than $j$.", "source_problems": "PUTNAM-2023-problems.tex", "source_solutions": "PUTNAM-2023-solutions.tex", "notes": ""}
{"id": "PUTNAM-2023-B1", "contest": "PUTNAM", "year": "2023", "problem_number": "B1", "problem": "Consider an $m$-by-$n$ grid of unit squares, indexed by $(i,j)$ with $1 \\leq i \\leq m$ and $1 \\leq j \\leq n$. There are $(m-1)(n-1)$ coins, which are initially placed in the squares $(i,j)$ with $1 \\leq i \\leq m-1$ and $1 \\leq j \\leq n-1$. If a coin occupies the square $(i,j)$ with $i \\leq m-1$ and $j \\leq n-1$ and the squares $(i+1,j), (i,j+1)$, and $(i+1,j+1)$ are unoccupied, then a legal move is to slide the coin from $(i,j)$ to $(i+1,j+1)$. How many distinct configurations of coins can be reached starting from the initial configuration by a (possibly empty) sequence of legal moves?", "solution": "The number of such configurations is $\\binom{m+n-2}{m-1}$.\n\nInitially the unoccupied squares form a path from $(1,n)$ to $(m,1)$ consisting of $m-1$ horizontal steps and $n-1$ vertical steps,\nand every move preserves this property. This yields an injective map from the set of reachable configurations to the set of paths of this form.\n\nSince the number of such paths is evidently $\\binom{m+n-2}{m-1}$ (as one can arrange the horizontal and vertical steps in any order),\nit will suffice to show that the map we just wrote down is also surjective; that is, that one can reach any path of this form by a sequence of moves. \n\nThis is easiest to see by working backwards. Ending at a given path, if this path is not the initial path, then it contains at least one sequence of squares of the form $(i,j) \\to (i,j-1) \\to (i+1,j-1)$.\nIn this case the square $(i+1,j)$ must be occupied, so we can undo a move by replacing this sequence with \n$(i,j) \\to (i+1,j) \\to (i+1,j-1)$.", "source_problems": "PUTNAM-2023-problems.tex", "source_solutions": "PUTNAM-2023-solutions.tex", "notes": ""}
{"id": "PUTNAM-2023-B2", "contest": "PUTNAM", "year": "2023", "problem_number": "B2", "problem": "For each positive integer $n$, let $k(n)$ be the number of ones in the binary representation of $2023 \\cdot n$. What is the minimum value of $k(n)$?", "solution": "The minimum is $3$. \n\n\\noindent\n\\textbf{First solution.}\n\nWe record the factorization $2023 = 7\\cdot 17^2$. We first rule out $k(n)=1$ and $k(n)=2$. If $k(n)=1$, then $2023n = 2^a$ for some $a$, which clearly cannot happen. If $k(n)=2$, then $2023n=2^a+2^b=2^b(1+2^{a-b})$ for some $a>b$. Then $1+2^{a-b} \\equiv 0\\pmod{7}$; but $-1$ is not a power of $2$ mod $7$ since every power of $2$ is congruent to either $1$, $2$, or $4 \\pmod{7}$.\n\nWe now show that there is an $n$ such that $k(n)=3$. It suffices to find $a>b>0$ such that $2023$ divides $2^a+2^b+1$. First note that $2^2+2^1+1=7$ and $2^3 \\equiv 1 \\pmod{7}$; thus if $a \\equiv 2\\pmod{3}$ and $b\\equiv 1\\pmod{3}$ then $7$ divides $2^a+2^b+1$. Next, $2^8+2^5+1 = 17^2$ and $2^{16\\cdot 17} \\equiv 1 \\pmod{17^2}$ by Euler's Theorem; thus if $a \\equiv 8 \\pmod{16\\cdot 17}$ and $b\\equiv 5 \\pmod{16\\cdot 17}$ then $17^2$ divides $2^a+2^b+1$.\n\nWe have reduced the problem to finding $a,b$ such that $a\\equiv 2\\pmod{3}$, $a\\equiv 8\\pmod{16\\cdot 17}$, $b\\equiv 1\\pmod{3}$, $b\\equiv 5\\pmod{16\\cdot 17}$. But by the Chinese Remainder Theorem, integers $a$ and $b$ solving these equations exist and are unique mod $3\\cdot 16\\cdot 17$. Thus we can find $a,b$ satisfying these congruences; by adding appropriate multiples of $3\\cdot 16\\cdot 17$, we can also ensure that $a>b>1$.\n\n\\noindent\n\\textbf{Second solution.}\nWe rule out $k(n) \\leq 2$ as in the first solution.\nTo force $k(n) = 3$, we first note that $2^4 \\equiv -1 \\pmod{17}$\nand deduce that $2^{68} \\equiv -1 \\pmod{17^2}$.\n(By writing $2^{68} = ((2^4+1) - 1)^{17}$ and expanding the binomial, we obtain $-1$ plus some terms each of which is divisible by 17.) Since $(2^8-1)^2$ is divisible by $17^2$,\n\\begin{align*}\n0 &\\equiv 2^{16} - 2\\cdot 2^8 + 1 \\equiv 2^{16} + 2\\cdot 2^{68}\\cdot 2^8 + 1 \\\\\n&= 2^{77} + 2^{16} + 1 \\pmod{17^2}.\n\\end{align*}\nOn the other hand, since $2^3 \\equiv -1 \\pmod{7}$, \n\\[\n2^{77} + 2^{16} + 1 \\equiv 2^2 + 2^1 + 1 \\equiv 0 \\pmod{7}.\n\\]\nHence $n = (2^{77}+2^{16}+1)/2023$ is an integer with $k(n) = 3$.\n\n\\noindent\n\\textbf{Remark.} \nA short computer calculation shows that the value of $n$ with $k(n)=3$ found in the second solution is the smallest possible.\nFor example, in SageMath, this reduces to a single command:\n\\begin{verbatim}\nassert all((2^a+2^b+1) % 2023 != 0\n    for a in range(1,77) for b in range(1,a))\n\\end{verbatim}", "source_problems": "PUTNAM-2023-problems.tex", "source_solutions": "PUTNAM-2023-solutions.tex", "notes": ""}
{"id": "PUTNAM-2023-B3", "contest": "PUTNAM", "year": "2023", "problem_number": "B3", "problem": "A sequence $y_1,y_2,\\dots,y_k$ of real numbers is called \\emph{zigzag} if $k=1$, or if $y_2-y_1, y_3-y_2, \\dots, y_k-y_{k-1}$ are nonzero and alternate in sign. Let $X_1,X_2,\\dots,X_n$ be chosen independently from the uniform distribution on $[0,1]$. Let $a(X_1,X_2,\\dots,X_n)$ be the largest value of $k$ for which there exists an increasing sequence of integers $i_1,i_2,\\dots,i_k$ such that $X_{i_1},X_{i_2},\\dots,X_{i_k}$ is zigzag. Find the expected value of $a(X_1,X_2,\\dots,X_n)$ for $n \\geq 2$.", "solution": "The expected value is $\\frac{2n+2}{3}$.\n\nDivide the sequence $X_1,\\dots,X_n$ into alternating increasing and decreasing segments, with $N$ segments in all. Note that removing one term cannot increase $N$: if the removed term is interior to some segment then the number remains unchanged, whereas if it separates two segments then one of those decreases in length by 1 (and possibly disappears). From this it follows that $a(X_1,\\dots,X_n) = N+1$: in one direction, the endpoints of the segments form a zigzag of length $N+1$; in the other, for any zigzag $X_{i_1},\\dots, X_{i_m}$, we can view it as a sequence obtained from $X_1,\\dots,X_n$ by removing terms, so its number of segments (which is manifestly $m-1$) cannot exceed $N$.\n\nFor $n \\geq 3$, $a(X_1,\\dots,X_n) - a(X_2,\\dots,X_{n})$\nis 0 if $X_1, X_2, X_3$ form a monotone sequence and 1 otherwise. Since the six possible orderings of $X_1,X_2,X_3$ are equally likely,\n\\[\n\\mathbf{E}(a(X_1,\\dots,X_n) - a(X_1,\\dots,X_{n-1})) = \\frac{2}{3}.\n\\]\nMoreover, we always have $a(X_1, X_2) = 2$ because any sequence of two distinct elements is a zigzag. By linearity of expectation plus induction on $n$, we obtain $\\mathbf{E}(a(X_1,\\dots,X_n)) = \\frac{2n+2}{3}$ as claimed.", "source_problems": "PUTNAM-2023-problems.tex", "source_solutions": "PUTNAM-2023-solutions.tex", "notes": ""}
{"id": "PUTNAM-2023-B4", "contest": "PUTNAM", "year": "2023", "problem_number": "B4", "problem": "For a nonnegative integer $n$ and a strictly increasing sequence of real numbers $t_0,t_1,\\dots,t_n$, let $f(t)$ be the corresponding real-valued function defined for $t \\geq t_0$ by the following properties:\n\\begin{enumerate}\n\\item[(a)] $f(t)$ is continuous for $t \\geq t_0$, and is twice differentiable for all $t>t_0$ other than $t_1,\\dots,t_n$;\n\\item[(b)] $f(t_0) = 1/2$;\n\\item[(c)] $\\lim_{t \\to t_k^+} f'(t) = 0$ for $0 \\leq k \\leq n$;\n\\item[(d)] For $0 \\leq k \\leq n-1$, we have $f''(t) = k+1$ when $t_k < t< t_{k+1}$, and $f''(t) = n+1$ when $t>t_n$.\n\\end{enumerate}\nConsidering all choices of $n$ and $t_0,t_1,\\dots,t_n$ such that $t_k \\geq t_{k-1}+1$ for $1 \\leq k \\leq n$, what is the least possible value of $T$ for which $f(t_0+T) = 2023$?", "solution": "The minimum value of $T$ is 29.\n\nWrite $t_{n+1} = t_0+T$ and define $s_k = t_k-t_{k-1}$ for $1\\leq k\\leq n+1$. On $[t_{k-1},t_k]$, we have $f'(t) = k(t-t_{k-1})$ and so $f(t_k)-f(t_{k-1}) = \\frac{k}{2} s_k^2$. Thus if we define\n\\[\ng(s_1,\\ldots,s_{n+1}) = \\sum_{k=1}^{n+1} ks_k^2,\n\\]\nthen we want to minimize $\\sum_{k=1}^{n+1} s_k = T$ (for all possible values of $n$) subject to the constraints that $g(s_1,\\ldots,s_{n+1}) = 4045$ and $s_k \\geq 1$ for $k \\leq n$.\n\nWe first note that a minimum value for $T$ is indeed achieved. To see this, note that the constraints $g(s_1,\\ldots,s_{n+1}) = 4045$ and $s_k \\geq 1$ place an upper bound on $n$. For fixed $n$, the constraint $g(s_1,\\ldots,s_{n+1}) = 4045$ places an upper bound on each $s_k$, whence the set of $(s_1,\\ldots,s_{n+1})$ on which we want to minimize $\\sum s_k$ is a compact subset of $\\mathbb{R}^{n+1}$.\n\nNow say that $T_0$ is the minimum value of $\\sum_{k=1}^{n+1} s_k$ (over all $n$ and $s_1,\\ldots,s_{n+1}$), achieved by $(s_1,\\ldots,s_{n+1}) = (s_1^0,\\ldots,s_{n+1}^0)$. Observe that there cannot be another $(s_1,\\ldots,s_{n'+1})$ with the same sum, $\\sum_{k=1}^{n'+1} s_k = T_0$, satisfying $g(s_1,\\ldots,s_{n'+1}) > 4045$; otherwise, the function $f$ for $(s_1,\\ldots,s_{n'+1})$ would satisfy $f(t_0+T_0) > 4045$ and there would be some $T<T_0$ such that $f(t_0+T) = 4045$ by the intermediate value theorem.\n\nWe claim that $s_{n+1}^0 \\geq 1$ and $s_k^0 = 1$ for $1\\leq k\\leq n$. If $s_{n+1}^0<1$ then\n\\begin{align*}\n& g(s_1^0,\\ldots,s_{n-1}^0,s_n^0+s_{n+1}^0)-g(s_1^0,\\ldots,s_{n-1}^0,s_n^0,s_{n+1}^0) \\\\\n&\\quad = s_{n+1}^0(2ns_n^0-s_{n+1}^0) > 0,\n\\end{align*}\ncontradicting our observation from the previous paragraph. Thus $s_{n+1}^0 \\geq 1$. If $s_k^0>1$ for some $1\\leq k\\leq n$ then replacing $(s_k^0,s_{n+1}^0)$ by $(1,s_{n+1}^0+s_k^0-1)$ increases $g$:\n\\begin{align*}\n&g(s_1^0,\\ldots,1,\\ldots,s_{n+1}^0+s_k^0-1)-g(s_1^0,\\ldots,s_k^0,\\ldots,s_{n+1}^0) \\\\\n&\\quad= (s_k^0-1)((n+1-k)(s_k^0+1)+2(n+1)(s_{n+1}^0-1)) > 0,\n\\end{align*}\nagain contradicting the observation. This establishes the claim.\n\nGiven that $s_k^0 = 1$ for $1 \\leq k \\leq n$, we have\n$T = s_{n+1}^0 + n$ and\n\\[\ng(s_1^0,\\dots,s_{n+1}^0) = \\frac{n(n+1)}{2} + (n+1)(T-n)^2.\n\\]\nSetting this equal to 4045 and solving for $T$ yields\n\\[\nT = n+\\sqrt{\\frac{4045}{n+1} - \\frac{n}{2}}.\n\\]\nFor $n=9$ this yields $T = 29$; it thus suffices to show that for all $n$, \n\\[\nn+\\sqrt{\\frac{4045}{n+1} - \\frac{n}{2}} \\geq 29.\n\\]\nThis is evident for $n \\geq 30$. For $n \\leq 29$, rewrite the claim as\n\\[\n\\sqrt{\\frac{4045}{n+1} - \\frac{n}{2}} \\geq 29-n;\n\\]\nwe then obtain an equivalent inequality by squaring both sides:\n\\[\n\\frac{4045}{n+1} - \\frac{n}{2} \\geq n^2-58n+841.\n\\]\nClearing denominators, gathering all terms to one side, and factoring puts this in the form\n\\[\n(9-n)(n^2 - \\frac{95}{2} n + 356) \\geq 0.\n\\]\nThe quadratic factor $Q(n)$ has a minimum at $\\frac{95}{4} = 23.75$\nand satisfies $Q(8) = 40, Q(10) = -19$; it is thus positive for $n \\leq 8$ and negative for $10 \\leq n \\leq 29$.", "source_problems": "PUTNAM-2023-problems.tex", "source_solutions": "PUTNAM-2023-solutions.tex", "notes": ""}
{"id": "PUTNAM-2023-B5", "contest": "PUTNAM", "year": "2023", "problem_number": "B5", "problem": "Determine which positive integers $n$ have the following property:\nFor all integers $m$ that are relatively prime to $n$, there exists a permutation $\\pi\\colon \\{1,2,\\dots,n\\} \\to \\{1,2,\\dots,n\\}$ such that $\\pi(\\pi(k)) \\equiv mk \\pmod{n}$ for all $k \\in \\{1,2,\\dots,n\\}$.", "solution": "The desired property holds if and only if $n = 1$ or $n \\equiv 2 \\pmod{4}$.\n\nLet $\\sigma_{n,m}$ be the permutation of $\\ZZ/n\\ZZ$ induced by multiplication by $m$; the original problem asks for which $n$ does $\\sigma_{n,m}$ always have a square root. For $n=1$, $\\sigma_{n,m}$ is the identity permutation and hence has a square root.\n\nWe next identify when a general permutation admits a square root.\n\n\\begin{lemma} \\label{lem:2023B5-2}\nA permutation $\\sigma$ in $S_n$ can be written as the square of another permutation if and only if for every even positive integer $m$, the number of cycles of length $m$ in $\\sigma$ is even.\n\\end{lemma}\n\\begin{proof}\nWe first check the ``only if'' direction. Suppose that $\\sigma = \\tau^2$. Then every cycle of $\\tau$ of length $m$ remains a cycle in $\\sigma$ if $m$ is odd, and splits into two cycles of length $m/2$ if $m$ is even.\n\nWe next check the ``if'' direction. We may partition the cycles of $\\sigma$ into individual cycles of odd length and pairs of cycles of the same even length; then we may argue as above to write each partition as the square of another permutation.\n\\end{proof}\n\nSuppose now that $n>1$ is odd. Write $n = p^e k$ where $p$ is an odd prime, $k$ is a positive integer, and $\\gcd(p,k) = 1$. \nBy the Chinese remainder theorem, we have a ring isomorphism \n\\[\n\\ZZ/n\\ZZ \\cong \\ZZ/p^e \\ZZ \\times \\ZZ/k \\ZZ.\n\\]\nRecall that the group $(\\ZZ/p^e \\ZZ)^\\times$ is cyclic; choose $m \\in \\ZZ$ reducing to a generator of $(\\ZZ/p^e \\ZZ)^\\times$ and to the identity in $(\\ZZ/k\\ZZ)^\\times$. Then $\\sigma_{n,m}$ consists of $k$ cycles (an odd number) of length $p^{e-1}(p-1)$ (an even number) plus some shorter cycles. By Lemma~\\ref{lem:2023B5-2}, $\\sigma_{n,m}$ does not have a square root.\n\nSuppose next that $n \\equiv 2 \\pmod{4}$. Write $n = 2k$ with $k$ odd, so that \n\\[\n\\ZZ/n\\ZZ \\cong \\ZZ/2\\ZZ \\times \\ZZ/k\\ZZ.\n\\]\nThen $\\sigma_{n,m}$ acts on $\\{0\\} \\times \\ZZ/k\\ZZ$ and $\\{1\\} \\times \\ZZ/k\\ZZ$ with the same cycle structure, so every cycle length occurs an even number of times. By Lemma~\\ref{lem:2023B5-2}, $\\sigma_{n,m}$ has a square root.\n\nFinally, suppose that $n$ is divisible by 4. For $m = -1$, $\\sigma_{n,m}$ consists of two fixed points ($0$ and $n/2$) together with $n/2-1$ cycles (an odd number) of length 2 (an even number). \nBy Lemma~\\ref{lem:2023B5-2}, $\\sigma_{n,m}$ does not have a square root.", "source_problems": "PUTNAM-2023-problems.tex", "source_solutions": "PUTNAM-2023-solutions.tex", "notes": ""}
{"id": "PUTNAM-2023-B6", "contest": "PUTNAM", "year": "2023", "problem_number": "B6", "problem": "Let $n$ be a positive integer. For $i$ and $j$ in $\\{1,2,\\dots,n\\}$, let $s(i,j)$ be the number of pairs $(a,b)$ of nonnegative integers satisfying $ai +bj=n$. Let $S$ be the $n$-by-$n$ matrix whose $(i,j)$ entry is $s(i,j)$. For example, when $n=5$, we have\n$S = \\begin{bmatrix} 6 & 3 & 2 & 2 & 2 \\\\\n3 & 0 & 1 & 0 & 1 \\\\\n2 & 1 & 0 & 0 & 1 \\\\\n2 & 0 & 0 & 0 & 1 \\\\\n2 & 1 & 1 & 1 & 2\n\\end{bmatrix}$. \nCompute the determinant of $S$.\n\n\\end{itemize}\n\n\\end{document}", "solution": "The determinant equals $(-1)^{\\lceil n/2 \\rceil-1} 2 \\lceil \\frac{n}{2} \\rceil$.\n\nTo begin with, we read off the following features of $S$.\n\\begin{itemize}\n\\item\n$S$ is symmetric: $S_{ij} = S_{ji}$ for all $i,j$, corresponding to $(a,b) \\mapsto (b,a)$).\n\\item\n$S_{11} = n+1$, corresponding to $(a,b) = (0,n),(1,n-1),\\dots,(n,0)$.\n\\item\nIf $n = 2m$ is even, then $S_{mj} = 3$ for $j=1,m$, corresponding to $(a,b) = (2,0),(1,\\frac{n}{2j}),(0,\\frac{n}{j})$.\n\\item\nFor $\\frac{n}{2} < i \\leq n$, $S_{ij} = \\# (\\ZZ \\cap \\{\\frac{n-i}{j}, \\frac{n}{j}\\})$, corresponding to $(a,b) = (1, \\frac{n-i}{j}), (0, \\frac{n}{j})$.\n\\end{itemize}\n\nLet $T$ be the matrix obtained from $S$ by performing row and column operations as follows: for $d=2,\\dots,n-2$, \nsubtract $S_{nd}$ times row $n-1$ from row $d$ and subtract $S_{nd}$ times column $n-1$ from column $d$; then subtract \nrow $n-1$ from row $n$ and column $n-1$ from column $n$.\nEvidently $T$ is again symmetric and $\\det(T) = \\det(S)$.\n\nLet us examine row $i$ of $T$ for $\\frac{n}{2} < i < n-1$:\n\\begin{align*}\nT_{i1} &= S_{i1} - S_{in} S_{(n-1)1} = 2-1\\cdot 2 = 0 \\\\\nT_{ij} &= S_{ij} - S_{in} S_{(n-1)j} - S_{nj}S_{i(n-1)}\\\\\n& =\n\\begin{cases} 1 & \\mbox{if $j$ divides $n-i$} \\\\\n0 & \\mbox{otherwise}.\n\\end{cases} \\quad (1 < j < n-1) \\\\\nT_{i(n-1)} &= S_{i(n-1)} - S_{in} S_{(n-1)(n-1)} = 0-1\\cdot0 = 0 \\\\\nT_{in} &= S_{in} - S_{in} S_{(n-1)n} - S_{i(n-1)}\n = 1 - 1\\cdot1 - 0 = 0.\n\\end{align*}\nNow recall (e.g., from the expansion of a determinant in minors) \nif a matrix contains an entry equal to 1 which is the unique nonzero entry in either its row or its column, then we may strike out this entry (meaning striking out the row and column containing it) at the expense of multiplying the determinant by a sign. To simplify notation, we do \\emph{not} renumber rows and columns after performing this operation.\n\nWe next verify that for the matrix $T$, for $i=2,\\dots,\\lfloor \\frac{n}{2} \\rfloor$ in turn, it is valid to strike out\n$(i,n-i)$ and $(n-i, i)$ at the cost of multiplying the determinant by -1. Namely, when we reach the entry $(n-i,i)$, the only other nonzero entries in this row have the form $(n-i,j)$ where $j>1$ divides $n-i$, and those entries are in previously struck columns. \n\nWe thus compute $\\det(S) = \\det(T)$ as:\n\\begin{gather*}\n(-1)^{\\lfloor n/2 \\rfloor-1}\n\\det \\begin{pmatrix}\nn+1 & -1 & 0 \\\\\n-1 & 0 & 1 \\\\\n0 & 1  & 0\n\\end{pmatrix} \\mbox{for $n$ odd,} \\\\\n(-1)^{\\lfloor n/2 \\rfloor-1}\n \\det \\begin{pmatrix}\nn+1 & -1 & 2 & 0 \\\\\n-1 & -1 & 1 & -1 \\\\\n2 & 1 & 0 & 1 \\\\\n0 & -1 & 1 & 0\n\\end{pmatrix} \\mbox{for $n$ even.}\n\\end{gather*}\nIn the odd case, we can strike the last two rows and columns (creating another negation) and then conclude at once. In the even case, the rows and columns are labeled $1, \\frac{n}{2}, n-1, n$; by adding row/column $n-1$ to row/column $\\frac{n}{2}$, we produce\n\\[\n(-1)^{\\lfloor n/2 \\rfloor}\n \\det \\begin{pmatrix}\nn+1 & 1 & 2 & 0 \\\\\n1 & 1 & 1 & 0 \\\\\n2 & 1 & 0 & 1 \\\\\n0 & 0 & 1 & 0\n\\end{pmatrix}\n\\]\nand we can again strike the last two rows and columns (creating another negation) and then read off the result.\n\n\\noindent\n\\textbf{Remark.}\nOne can use a similar approach to compute some related determinants.\nFor example, let $J$ be the matrix with $J_{ij} = 1$ for all $i,j$.\nIn terms of an indeterminate $q$, define the matrix $T$ by \n\\[\nT_{ij} = q^{S_{ij}}.\n\\]\nWe then have\n\\[\n\\det(T-tJ) = (-1)^{\\lceil n/2 \\rceil-1} q^{2(\\tau(n)-1)} (q-1)^{n-1}f_n(q,t)\n\\]\nwhere $\\tau(n)$ denotes the number of divisors of $n$\nand\n\\[\nf_n(q,t) = \\begin{cases} q^{n-1}t+q^2-2t & \\mbox{for $n$ odd,} \\\\q^{n-1}t +q^2-qt-t & \\mbox{for $n$ even.}\n\\end{cases}\n\\]\nTaking $t=1$ and then dividing by $(q-1)^n$, this yields a \\emph{$q$-deformation} of the original matrix $S$.\n\n\\end{itemize}\n\\end{document}", "source_problems": "PUTNAM-2023-problems.tex", "source_solutions": "PUTNAM-2023-solutions.tex", "notes": ""}
{"id": "PUTNAM-2024-A1", "contest": "PUTNAM", "year": "2024", "problem_number": "A1", "problem": "Determine all positive integers $n$ for which there exist positive integers $a$, $b$, and $c$ satisfying\n\\[\n2a^n + 3b^n = 4c^n.\n\\]", "solution": "The answer is $n=1$. When $n=1$, $(a,b,c) = (1,2,2)$ is a solution to the given equation. We claim that there are no solutions when $n \\geq 2$.\n\nFor $n = 2$, suppose that we have a solution to $2a^2+3b^2=4c^2$ with $a,b,c\\in\\mathbb{N}$. By dividing each of $a,b,c$ by $\\gcd(a,b,c)$, we obtain another solution; thus we can assume that $\\gcd(a,b,c) = 1$. Note that we have $a^2+c^2 \\equiv 0 \\pmod{3}$, and that only $0$ and $1$ are perfect squares mod $3$; thus we must have $a^2 \\equiv c^2 \\equiv 0 \\pmod{3}$. But then $a,c$ are both multiples of $3$; it follows from $b^2 = 12(c/3)^2-6(a/3)^2$ that $b$ is a multiple of $3$ as well, contradicting our assumption that $\\gcd(a,b,c)=1$.\n\nFor $n \\geq 3$, suppose that $2a^n+3b^n=4c^n$. As in the previous case, we can assume $\\gcd(a,b,c)=1$. Since $3b^n=4c^n-2a^n$, $b$ must be even. \nWe can then write $a^n+2^{n-1}\\cdot 3(b/2)^n = 2 c^n$, and so $a$ must be even. Then $2^{n-1}(a/2)^n+2^{n-2} \\cdot 3(b/2)^n = c^n$, and $c$ must be even as well. This contradicts our assumption that $\\gcd(a,b,c)=1$.", "source_problems": "PUTNAM-2024-problems.tex", "source_solutions": "PUTNAM-2024-solutions.tex", "notes": ""}
{"id": "PUTNAM-2024-A2", "contest": "PUTNAM", "year": "2024", "problem_number": "A2", "problem": "For which real polynomials $p$ is there a real polynomial $q$ such that\n\\[\np(p(x)) - x = (p(x) - x)^2 q(x)\n\\]\nfor all real $x$?", "solution": "The answer is $p(x) = \\pm x+c$ for any $c \\in \\mathbb{R}$. Note that any such polynomial works: if $p(x)=x+c$ then $p(x)-x=c$, while if $p(x)=-x+c$ then $p(p(x))-x=0$.\nWe will show that in fact these are the only polynomials $p(x)$ such that $p(p(x))-x$ is divisible by $r(x)^2$, where $r(x)=p(x)-x$. \n\n\\noindent\n\\textbf{First solution.}\nSuppose that $p(p(x))-x$ is divisible by $r(x)^2$. Then\n\\begin{align*}\nx &\\equiv p(p(x)) \\\\\n&= p(x + r(x)) \\\\\n&\\equiv p(x) + p'(x) r(x) \\pmod{r(x)^2}.\n\\end{align*}\nIn other words, $r(x) (1 + p'(x))$ is divisible by $r(x)^2$.\nFrom this, it follows that either $r(x) = 0$ or $1+p'(x)$ is divisible by $r(x)$.\nIn the first case, we have $p(x) = x$.\nIn the second case, if $1 + p'(x) = 0$ then $p(x) = -x + c$ for some constant $c$;\notherwise, we have\n\\[\n\\deg(p) - 1 = \\deg(1 + p'(x)) \\geq \\deg(r)\n\\]\nand this is only possible if $p(x) = x + c$ for some constant $c$.\n\n\\noindent\n\\textbf{Second solution.}\nSuppose that $p(p(x))-x$ is divisible by $r(x)^2$. Then\n\\begin{align*}\n0 &\\equiv \\frac{d}{dx}(p(p(x)) - x) \\\\\n&= p'(x) p'(p(x)) - 1 \\\\\n&\\equiv p'(x)^2 -1 \\\\\n&= (p'(x) + 1)(p'(x) - 1) \\\\\n&= r'(x) (r'(x) + 2) \n\\pmod{r(x)}.\n\\end{align*}\nIf $\\alpha$ is a root of $r(x)$ of some multiplicity $m$, then the multiplicity of $\\alpha$ as a root of $r'(x)$ is $m-1$. Consequently, every root of $r(x)$ must be a root of $r'(x)+ 2$;\nin particular such a root cannot also be a root of $r'(x)$, so every root of $r(x)$ is simple.\nPutting this together, we deduce that $r(x)$ divides $r'(x) + 2$. If $r(x)$ is constant,\nthen $p(x) = x+c$ for some $c$. Otherwise, $\\deg(r'(x) + 2) < \\deg(r(x))$ and so $r'(x) + 2$ must be zero; then $r(x) = -2x + c$ for some $c$, whence $p(x) = -x + c$.", "source_problems": "PUTNAM-2024-problems.tex", "source_solutions": "PUTNAM-2024-solutions.tex", "notes": ""}
{"id": "PUTNAM-2024-A3", "contest": "PUTNAM", "year": "2024", "problem_number": "A3", "problem": "Let $S$ be the set of bijections\n\\[\nT \\colon \\{1,2,3\\} \\times \\{1,2,\\dots,2024\\} \\to \\{1,2,\\dots,6072\\}\n\\]\nsuch that $T(1,j) < T(2,j) < T(3,j)$ for all $j \\in \\{1,2,\\dots,2024\\}$ and $T(i,j) < T(i,j+1)$ for all $i \\in \\{1,2,3\\}$ and $j \\in \\{1,2,\\dots,2023\\}$. Do there exist $a$ and $c$ in $\\{1,2,3\\}$ and $b$ and $d$ in $\\{1,2,\\dots,2024\\}$ such that the fraction of elements $T$ in $S$ for which $T(a,b) < T(c,d)$ is at least $1/3$ and at most $2/3$?", "solution": "Yes, such $a,b,c,d$ exist: we take\n\\[\n(a,b) = (2,1), \\qquad (c,d) = (1,2).\n\\]\nWe will represent $T$ as an $3 \\times n$ array (3 rows, $n$ columns) of integers  in which each of $1,\\dots,3n$ occurs exactly once and the rows and columns are strictly increasing; we will specialize to $n=2024$ at the end.\n\nWe first note that $T(1,1) = 1$ and $2 \\in \\{T(1,2), T(2,1)\\}$.\nFrom this, it follows that $T(2,1) < T(1,2)$ if and only if $T(2,1) = 2$.\n\nWe next recall a restricted form of the \\emph{hook length formula}\n(see the first remark for a short proof of this restricted version and the second remark for the statement of the general formula).\nConsider more generally an array consisting of (up to) three rows of lengths $n_1\\geq n_2 \\geq n_3 \\geq 0$, aligned at the left.\nLet $f(n_1,n_2,n_3)$ be the number of ways to fill this array with a permutation of the numbers $1,\\dots,n_1+n_2+n_3$ in such a way that each row increases from left to right and each column increases from top to bottom. The hook length formula then shows that $f(n_1,n_2,n_3)$ equals\n\\[\n\\frac{(n_1-n_2+1)(n_1-n_3+2)(n_2-n_3+1) (n_1+n_2+n_3)!}\n{(n_1+2)! (n_2+1)! n_3!}.\n\\]\n\nWe then note that if $T(2,1) = 2$, we obtain a array with row lengths $n, n-1, n-1$ by removing 1 and 2, relabeling each remaining $i$ as $3n+1-i$, and reflecting in both axes. The probability that $T(2,1) < T(1,2)$ is thus\n\\begin{align*}\n\\frac{f(n,n-1,n-1)}{f(n,n,n)}\n&= \n\\frac{(2)(3)(n+1)n}{(1)(2) (3n)(3n-1)} \\\\\n&= \\frac{n+1}{3n-1} = \\frac{1}{3} + \\frac{4}{9n-3};\n\\end{align*}\nthis is always greater than $\\frac{1}{3}$, and for $n =2024$ it is visibly less than $\\frac{2}{3}$.\n\n\\noindent\n\\textbf{Remark.}\nWe prove the claimed formula for $f(n_1,n_2,n_3)$ by induction on $n_1+n_2+n_3$.\nTo begin with, if $n_2 = n_3 = 0$, then the desired count is indeed $f(n_1, 0, 0) = 1$.\nNext, suppose $n_2 > 0, n_3 = 0$.\nThe entry $n_1 + n_2$ must go at the end of either the first or second row;\ncounting ways to complete the diagram from these starting points yields\n\\[\nf(n_1,n_2,0) = f(n_1-1,n_2,0) + f(n_1,n_2-1,0).\n\\]\n(This works even if $n_1 = n_2$, in which case the first row is not an option but correspondingly $f(n_2-1,n_2,0) = 0$.)\nThe induction step then follows from the identity\n\\[\n\\frac{(n_1-n_2)(n_1+1) + (n_1-n_2+2)n_2}{(n_1-n_2+1)(n_1+n_2)}  = 1.\n\\]\n(As an aside, the case $n_1 = n_2, n_3 = 0$ recovers a standard interpretation of the Catalan numbers.)\n\nFinally, suppose $n_3 > 0$. We then have\n\\begin{align*}\n&f(n_1,n_2,n_3) \\\\\n&= \nf(n_1-1,n_2,n_3) + f(n_1,n_2-1,n_3) + f(n_1,n_2,n_3-1),\n\\end{align*}\nand the induction step now reduces to the algebraic identity\n\\begin{align*}\n&\\frac{(n_1-n_2)(n_1-n_3+1)(n_1+2)}{(n_1-n_2+1)(n_1-n_3+2)(n_1+n_2+n_3)} \\\\\n&+ \\frac{(n_1-n_2+2)(n_2-n_3)(n_2+1)}{(n_1-n_2+1)(n_2-n_3+1)(n_1+n_2+n_3)} \\\\\n&+ \\frac{(n_1-n_3+3)(n_2-n_3+2)n_3}{(n_1-n_3+2)(n_2-n_3+1)(n_1+n_2+n_3)}\n= 1.\n\\end{align*}\n\n\\noindent\n\\textbf{Remark.}\nWe formulate the general hook length formula in standard terminology.\nLet $N$ be a positive integer, and consider a semi-infinite checkerboard with top and left edges. A \\emph{Ferrers diagram} is a finite subset of the squares of the board which is closed under taking a unit step towards either edge. Given a Ferrers diagram with $N$ squares, a \\emph{standard Young tableau} for this diagram is a bijection of the squares of the diagram with the integers $1,\\dots,N$ such that the numbers always increase under taking a unit step away from either edge. \n\n\nFor each square $s = (i,j)$ in the diagram, the \\emph{hook length} $h_s$ of $s$ is the number of squares $(i',j')$ in the diagram\nsuch that either $i=i', j\\leq j'$ or $i\\leq i',j=j'$ (including $s$ itself). Then the number of standard Young tableaux for this diagram equals\n\\[\n\\frac{N!}{\\prod_s h_s}.\n\\]\nFor a proof along the lines of the argument given in the previous remark, see:\nKenneth Glass and Chi-Keung Ng, A simple proof of the hook length formula,\n\\textit{American Mathematical Monthly} \\textbf{111} (2004), 700--704.", "source_problems": "PUTNAM-2024-problems.tex", "source_solutions": "PUTNAM-2024-solutions.tex", "notes": ""}
{"id": "PUTNAM-2024-A4", "contest": "PUTNAM", "year": "2024", "problem_number": "A4", "problem": "Find all primes $p > 5$ for which there exists an integer $a$ and an integer $r$ satisfying $1 \\leq r \\leq p-1$ with the following property: the sequence $1,a,a^2,\\dots,a^{p-5}$ can be rearranged to form a sequence $b_0,b_1,b_2,\\dots,b_{p-5}$ such that $b_n-b_{n-1}-r$ is divisible by $p$ for $1 \\leq n \\leq p-5$.", "solution": "The prime $p=7$ works: choose $a=5$ and $r=3$, and note that $1,a,a^2$ can be rearranged to form $b_0=5$, $b_1=1$, $b_2=25$ satisfying the stated property.\n\nWe claim that no prime $p>7$ works. Suppose otherwise: there exist $p,a,r$ with $p>7$ and $r\\nmid p$ such that $1,a,\\ldots,a^{p-5}$ can be rearranged to form $b_0,\\ldots,b_{p-5}$ with $b_n \\equiv b_0+nr \\pmod{p}$ for all $0\\leq n\\leq p-5$. Since $r\\nmid p$, $\\{b_0,b_0+r,\\ldots,b_0+(p-5)r\\}$ represents a collection of $p-4$ distinct elements of $\\mathbb{Z}/p\\mathbb{Z}$. It follows that all of $1,a,\\ldots,a^{p-5}$ are distinct mod $p$. In particular, $p\\nmid a$; also, since $p-5 \\geq \\frac{p-1}{2}$, we conclude that $a^k \\not\\equiv 1 \\pmod{p}$ for any $1\\leq k\\leq \\frac{p-1}{2}$. It follows that $a$ is a primitive root mod $p$.\n\nSince $a$ is a primitive root, $a^{-3},a^{-2},a^{-1},a^0,\\ldots,a^{p-5}$ runs through all nonzero elements of $\\mathbb{Z}/p$ exactly once. On the other hand, $b_0-4r,b_0-3r,b_0-2r,b_0-r,b_0,\\ldots,b_0+(p-5)r$ runs through all elements of $\\mathbb{Z}/p\\mathbb{Z}$ exactly once. The given condition now implies that\n\\[\n\\{b_0-4r,b_0-3r,b_0-2r,b_0-r\\} = \\{0,c,c^2,c^3\\}\n\\]\n\nwhere $c = a^{-1}$; that is, $0,c,c^2,c^3$ can be rearranged to give an arithmetic sequence $x_1,x_2,x_3,x_4$ in $\\mathbb{Z}/p\\mathbb{Z}$.\n\nIf $0, c, c^2, c^3$ can be arranged into a four-term arithmetic progression, then by dividing the progression by $c$,\nwe see that $0,1,c,c^2$ can also be arranged into a four-term arithmetic progression. Now no two of $1,c,c^2$ can\nboth be adjacent to 0 in this arithmetic progression, or otherwise they would be negative of each other; but this is\nimpossible because the order of $c$ is greater than 4. We conclude that 0 must be either the first or the last term of the \nprogression, and by reversing the sequence if necessary, we can assume that 0 is the first term of the progression. \nNow the last three terms of this progression cannot be $1,c,c^2$ or $c^2,c,1$ in that order, as $c-1\\neq c^2-c$ because $c\\neq 1$. \nThus the only possibilities for the arithmetic progression that remain are\n\\begin{gather*}\n0,1,c^2,c; \\qquad\n0,c^2,1,c; \\\\\n0,c,1,c^2; \\qquad\n0,c,c^2,1.\n\\end{gather*}\nAs twice the second term must be the third term, and thrice the second term must be the fourth term, we immediately eliminate each of the above possibilities: the first sequence is not possible because we must have $c^2=2, c=3$, which is a valid solution only when $p=7$; for the second sequence, we must have $1=2c^2$ and $1=3c$, which is again a valid solution only when $p=7$; for the third sequence, we must have $1=2c$ and $c^2=3c$, implying $c=1/2=3$, which is possible only when $p=5$; and for the fourth sequence, we must have $c^2=2c$ and $1=3c$, implying $c=2=1/3$, which is again possible only when $p=5$.", "source_problems": "PUTNAM-2024-problems.tex", "source_solutions": "PUTNAM-2024-solutions.tex", "notes": ""}
{"id": "PUTNAM-2024-A5", "contest": "PUTNAM", "year": "2024", "problem_number": "A5", "problem": "Consider a circle $\\Omega$ with radius 9 and center at the origin $(0,0)$, and a disc $\\Delta$ with radius 1 and center at $(r,0)$, where $0 \\leq r \\leq 8$. Two points $P$ and $Q$ are chosen independently and uniformly at random on $\\Omega$. Which value(s) of $r$ minimize the probability that the chord $\\overline{PQ}$ intersects $\\Delta$?", "solution": "We will show that $r=0$ (and no other value of $r$) minimizes the stated probability.\nNote that $P$ and $Q$ coincide with probability $0$; thus we can assume that $P\\neq Q$.\n\n\\noindent\n\\textbf{First solution.}\nFirst restrict $P,Q$ to points on $\\Omega$ such that the segment $\\overline{PQ}$ makes an angle of $\\theta$ with the $y$ axis, where $\\theta$ is a fixed number with $-\\pi/2<\\theta\\leq\\pi/2$. By rotating the diagram by $-\\theta$ around the origin, we move $\\overline{PQ}$ to be a vertical line and move $\\Delta$ to be centered at $(r\\cos\\theta,-r\\sin\\theta)$. In this rotated picture, $P$ and $Q$ are at $(9\\cos\\phi,\\pm 9\\sin\\phi)$ where $\\phi$ is chosen uniformly at random in $(0,\\pi)$. Now the vertical tangent lines to the boundary of $\\Delta$, $x=r\\cos\\theta\\pm 1$, intersect the $y>0$ semicircle of $\\Omega$ at $(9\\cos\\phi,9\\sin\\phi)$ where $\\phi = \\cos^{-1}\\left(\\frac{r\\cos\\theta\\pm 1}{9}\\right)$. Thus the probability that $\\overline{PQ}$ intersects $\\Delta$ for a specific value of $\\theta$ is\n$\\frac{1}{\\pi} f(r,\\theta)$, where we define \n\\[\nf(r,\\theta) = \\cos^{-1} \\left(\\frac{r\\cos\\theta-1}{9}\\right) - \\cos^{-1}\\left(\\frac{r\\cos\\theta+1}{9}\\right).\n\\]\n\nIf we now allow $\\theta$ to vary (uniformly) in $(-\\pi/2,\\pi/2]$, we find that the overall probability that $\\overline{PQ}$ intersects $\\Delta$ is\n\\[\nP(r) = \\frac{1}{\\pi^2} \\int_{-\\pi/2}^{\\pi/2} f(r,\\theta)\\,d\\theta.\n\\]\nThe function $P(r)$ is differentiable with \n\\[\nP'(r) = \\frac{1}{\\pi^2} \\int_{-\\pi/2}^{\\pi/2} \\frac{\\partial f(r,\\theta)}{\\partial r}\\,d\\theta.\n\\]\nNow\n\\begin{align*}\n\\frac{\\partial f(r,\\theta)}{\\partial r} &= (\\cos t)\\left((80-2r\\cos t-r^2\\cos^2 t)^{-1/2} \\right. \\\\\n&\\qquad \\left. -(80+2r\\cos t-r^2\\cos^2 t)^{-1/2}\\right),\n\\end{align*}\nwhich, for $t\\in (-\\pi/2,\\pi/2)$, is zero for $r=0$ and strictly positive for $r>0$. It follows that $P'(0)=0$ and $P'(r)<0$ for $r\\in (0,8]$, whence $P(r)$ is minimized when $r=0$.\n\n\\noindent\n\\textbf{Second solution.} (based on ideas from Elliott Liu, Bjorn Poonen, Linus Tang, and Allen Wang)\nWe interpret the first paragraph of the first solution as reducing the original problem to the following assertion:\ngiven two parallel lines at distance 2, both of which intersect a circle of radius 9, \nthe length of either of the two congruent arcs of the circle lying between the two lines is minimized when the line halfway between the two parallel lines passes through the center of the circle.\n\nTo see this, note that the length of a minor arc of a circle is a strictly increasing function of the length of the chord connecting the two endpoints of the arc. In this case, the chord connects points on the two given parallel lines, so the distance between these points is minimized by having them be the endpoints of a segment perpendicular to the two lines; this achieves the situation described above.", "source_problems": "PUTNAM-2024-problems.tex", "source_solutions": "PUTNAM-2024-solutions.tex", "notes": ""}
{"id": "PUTNAM-2024-A6", "contest": "PUTNAM", "year": "2024", "problem_number": "A6", "problem": "Let $c_0,c_1,c_2,\\dots$ be the sequence defined so that \n\\[\n\\frac{1-3x-\\sqrt{1-14x+9x^2}}{4} = \\sum_{k=0}^\\infty c_k x^k\n\\]\nfor sufficiently small $x$. For a positive integer $n$, let $A$ be the $n$-by-$n$ matrix with $i,j$-entry $c_{i+j-1}$ for $i$ and $j$ in $\\{1,\\dots,n\\}$. Find the determinant of $A$.", "solution": "The determinant equals $10^{n(n-1)/2}$.\nWe compute the corresponding determinant for the coefficients of the generic power series\n\\[\nf(x) := \\sum_{n=1}^\\infty c_n x^n, \\qquad c_1 = 1,\n\\]\nwith associated continued fraction\n\\[\n\\frac{a_0}{x^{-1} + b_0 + \\frac{a_1}{x^{-1} + b_1 + \\cdots}}, \\qquad a_0 = 1.\n\\]\nIf we truncate by replacing $a_{n+1} = 0$, we get a rational function which can be written as $\\frac{A_n(x^{-1})}{B_n(x^{-1})}$ where $A_n(x), B_n(x)$ are polynomials determined by the initial conditions\n\\[\nA_{-1}(x) =1, A_0(x) = 0, \\quad B_{-1}(x) = 0, B_0(x) = 1\n\\]\nand the recurrences\n\\begin{align*}\nA_{n+1}(x) &= (x + b_{n})A_n(x) + a_{n} A_{n-1}(x) \\qquad (n > 0) \\\\\nB_{n+1}(x) &= (x + b_{n})B_n(x) + a_{n} B_{n-1}(x) \\qquad (n > 0).\n\\end{align*}\nSince each additional truncation accounts for two more coefficients of the power series, we have\n\\[\n\\frac{A_n(x^{-1})}{B_n(x^{-1})} = f(x) + O(x^{2n+1}),\n\\]\nor equivalently (since $B_n(x)$ is monic of degree $n$)\n\\begin{equation} \\label{eq:convergent}\nf(x) B_n(x^{-1}) - A_n(x^{-1}) = O(x^{n+1}).\n\\end{equation}\n\nWe now reinterpret in the language of \\emph{orthogonal polynomials}.\nFor a polynomial $P(x) = \\sum_i P_i x^i$, define\n\\[\n\\int_\\mu P(x) = \\sum_i P_i c_{i+1};\n\\]\nthen the vanishing of the coefficient of $x^{i+1}$\nin \\eqref{eq:convergent} (with $n := i$) implies that\n\\[\n\\int_\\mu x^i B_j(x) = 0 \\qquad (j < i).\n\\]\nBy expanding $0 = \\int_\\mu x^{i-1} B_{i+1}(x)$ using the recurrence, we deduce that $\\int_\\mu x^i B_i(x) + a_i \\int_\\mu x^{i-1} B_{i-1}(x) = 0$, and so\n\\[\n\\int_\\mu x^i B_i(x) = (-1)^i a_1 \\cdots a_i.\n\\]\nWe deduce that\n\\begin{equation} \\label{eq:orthogonality}\n\\int_\\mu B_i(x) B_j(x) = \\begin{cases} 0 & i \\neq j \\\\\n(-1)^i a_1 \\cdots a_i & i = j.\n\\end{cases}\n\\end{equation}\nIn other words, for $U$ the $n \\times n$ matrix such that\n$U_{ij}$ is the coefficient of $x^j$ in $B_i(x)$,\nthe matrix $UAU^t$ is a diagonal matrix $D$ with diagonal entries\n$D_{i,i} = (-1)^{i-1} a_1 \\cdots a_{i-1}$ for $i=1,\\dots,n$. \nSince $U$ is a unipotent matrix, its determinant is 1; we conclude that\n\\[\n\\det(A) = \\det(D) = (-1)^{n(n-1)/2} a_1^{n-1} \\cdots a_{n-1}.\n\\]\n\nWe now return to the sequence $\\{c_n\\}$ given in the problem statement, for which\n\\[\nf(x) = \\frac{1 - 3x - \\sqrt{1 - 14x +9x^{2}}}{4}.\n\\]\nFor \n\\[\ng(x) := \\frac{1-7x-\\sqrt{1-14x+9x^2}}{2x},\n\\]\nwe have\n\\[\nf(x) = \\frac{1}{x^{-1} - 5 - g(x)}, \\quad\ng(x) = \\frac{10}{x^{-1} - 7 - g(x)}.\n\\]\nThis means that the continued fraction is eventually periodic;\nin particular, $a_1 = a_2 = \\cdots = -10$.\nPlugging into the general formula for $\\det(A)$ yields the desired result.\nThis yields the desired result.\n\n\\noindent\n\\textbf{Reinterpretation.} (suggested by Bjorn Poonen)\nGiven a formal Laurent series $\\alpha = \\sum_i a_i x^i$, define the matrices\n$H_n(\\alpha) = (a_{i+j-1})_{i,j=1}^n$ and the determinants $h_n(\\alpha) = \\det H_n(\\alpha)$.\nOne can then recover the evaluation of the determinants from the following lemma.\n\n\\begin{lemma*}\nSuppose $\\alpha = \\sum_{i=1}^\\infty a_i x^i$ is a formal power series with $a_i = 1$.\nDefine the power series $\\beta$ by $\\alpha^{-1} = x^{-1} - \\beta$. Then for all $n \\geq 1$,\n$h_n(\\alpha) = h_{n-1}(\\beta)$.\n\\end{lemma*}\n\\begin{proof}\nFor $m \\geq 2$, by equating the coefficients of $x^m$ in the equality $x^{-1} \\alpha = \\alpha \\beta + 1$, we obtain\n\\[\na_{m+1} = \\sum_{r=1}^m a_r b_{m-r}.\n\\]\nWe now perform some row and column reduction on $H_n(\\alpha)$ without changing its determinant.\nStarting with $H_n(\\alpha)$,\nfor $i = n,n-1,\\dots,2$ in turn, for $k=1,\\dots,i-1$ subtract $b_{i-1-k}$ times row $k$ from row $i$. In light of the recurrence relation, the resulting matrix $M = (m_{ij})$ has the property that for $i \\geq 2$,\n\\begin{align*}\nm_{ij} &= a_{i+j-1} - \\sum_{k=1}^{i-1} a_{j+k-1} b_{i-1s-k} \\\\\n&= \\sum_{r=1}^{j-1}  a_r b_{i+j-2-r}.\n\\end{align*}\nIn particular, $m_{i1} = 0$ for $i \\geq 2$.\nStarting from $M$, for $j=2,\\dots,n-1$ in turn, for $k=j+1,\\dots,n$ subtract $a_{k-j+1}$ times column $j$ from column $i$. The resulting matrix has first column $(1, 0,\\dots,0)$ and removing its first row and column leaves $H_{n-1}(\\beta)$, yielding the claimed equality.\n\\end{proof}\n\n\\noindent\n\\textbf{Remark.} A matrix $A$ whose $i,j$-entry depends only on $i+j$ is called a \\emph{Hankel matrix}.\nThe above computation of the determinant of a Hankel matrix in terms of continued fractions is adapted from\nH.S. Wall, \\textit{Analytic Theory of Continued Fractions}, Theorems 50.1 and 51.1.\n\nThe same analysis shows that if we define the sequence $\\{c_n\\}_{n=1}$ by\n$c_1 = 1$ and\n\\[\nc_n = a c_{n-1} + b \\sum_{i=1}^{n-1} c_i c_{n-i} \\qquad (n > 1),\n\\]\nthen  $a_n = -ab-b^2$, $b_n = -a-2b$ for all $n>0$ and so\n\\[\n\\det(A) = (ab+b^2)^{n(n-1)/2};\n\\]\nthe problem statement is the case $a=3, b=2$.\nThe case $a=0, b=1$ yields the sequence of Catalan numbers;\nthe case $a=1, b=1$ yields the Schr\\\"oder numbers (OEIS sequence A006318).\n\nThere are a number of additional cases of Hankel determinants of interest in combinatorics.\nFor a survey, see: A. Junod, Hankel determinants and orthogonal polynomials,\n\\textit{Expositiones Mathematicae} \\textbf{21} (2003), 63--74.", "source_problems": "PUTNAM-2024-problems.tex", "source_solutions": "PUTNAM-2024-solutions.tex", "notes": ""}
{"id": "PUTNAM-2024-B1", "contest": "PUTNAM", "year": "2024", "problem_number": "B1", "problem": "Let $n$ and $k$ be positive integers. The square in the $i$th row and $j$th column of an $n$-by-$n$ grid contains the number $i+j-k$. For which $n$ and $k$ is it possible to select $n$ squares from the grid, no two in the same row or column, such that the numbers contained in the selected squares are exactly $1,2,\\dots,n$?", "solution": "This is possible if and only if $n$ is odd and $k = (n+1)/2$.\n\nWe first check that these conditions are necessary. If the pairs $(a_1,b_1),\\dots,(a_n,b_n)$\nindex squares of the grid with no two in the same row or column,\nthen each of the two sequences $a_1,\\dots,a_n$\nand $b_1,\\dots,b_n$ is a permutation of $\\{1,\\dots,n\\}$, and so in particular has sum $1 + \\cdots +n = \\frac{n(n+1)}{2}$. In particular, if the selected numbers are $1,2,\\dots,n$ in some order, then\n\\begin{align*}\n\\frac{n(n+1)}{2} &= \\sum_{i=1}^n (a_i+b_i-k) \\\\\n&= \\sum_{i=1}^n a_i + \\sum_{i=1}^n b_i - \\sum_{i=1}^n k \\\\\n&= \\frac{n(n+1)}{2} + \\frac{n(n+1)}{2} - nk\n\\end{align*}\nwhich simplifies to $k = (n+1)/2$.\n\nWe next check that these conditions are sufficient. For this, it suffices to observe that\nthe sequence\n\\begin{gather*}\n\\left(1, \\frac{n+1}{2}\\right), \\left(2, \\frac{n+3}{2}\\right), \\dots,\n\\left(\\frac{n+1}{2}, n\\right), \\\\\n\\left(\\frac{n+3}{2}, 1\\right), \\dots, \\left(n, \\frac{n-1}{2}\\right)\n\\end{gather*}\nof grid entries equals\n\\[\n1, 3, \\dots, n, 2, \\dots, n-1.\n\\]\nWe illustrate this for the case $n=5, k=3$ below; the selected entries are parenthesized.\n\\[\n\\begin{pmatrix}\n-1 & 0 & (1) & 2 & 3 \\\\\n0 & 1 & 2 & (3) & 4 \\\\\n1 & 2 & 3 & 4 & (5) \\\\\n(2) & 3 & 4 & 5 & 6 \\\\\n3 & (4) & 5 & 6 & 7\n\\end{pmatrix}\n\\]", "source_problems": "PUTNAM-2024-problems.tex", "source_solutions": "PUTNAM-2024-solutions.tex", "notes": ""}
{"id": "PUTNAM-2024-B2", "contest": "PUTNAM", "year": "2024", "problem_number": "B2", "problem": "Two convex quadrilaterals are called \\emph{partners} if they have three vertices in common and they can be labeled $ABCD$ and $ABCE$ so that $E$ is the reflection of $D$ across the perpendicular bisector of the diagonal $\\overline{AC}$. Is there an infinite sequence of convex quadrilaterals such that each quadrilateral is a partner of its successor and no two elements of the sequence are congruent?\n[A diagram has been omitted.]", "solution": "No, there is no such sequence. In other words, any sequence of convex quadrilaterals with the property that any two consecutive terms are partners must be finite.\n\n\\noindent\n\\textbf{First solution.}\n\n\\begin{lemma*}\nGiven five positive real numbers $a,b,c,d,K$, there are only finitely many convex quadrilaterals with side lengths $a,b,c,d$ in that order and area $K$. \n\\end{lemma*}\n\\begin{proof}\nLet $PQRS$ be a convex quadrilateral with \n\\[\n\\overline{PQ} = a, \\overline{QR} = b, \\overline{RS} = c, \\overline{SP} = d.\n\\]\nThen the congruence class of $PQRS$ is uniquely determined by the length of the diagonal $f := \\overline{PR}$.\nMoreover, as $f$ increases, the angles $\\angle RPQ$ and $\\angle RPS$ are both strictly decreasing, so $\\angle SPQ$ is decreasing; by the same logic, $\\angle QRS$ is decreasing. \n\nWe next recall \\emph{Bretschneider's formula}: for $s = (a+b+c+d)/2$,\n\\[\nK^2 = (s-a)(s-b)(s-c)(s-d) - abcd \\cos^2 \\frac{\\angle SPQ + \\angle QRS}{2}.\n\\]\nConsequently, fixing $K$ also fixes $\\cos^2 \\frac{\\angle SPQ + \\angle QRS}{2}$,\nand thus limits $\\angle SPQ + \\angle QRS$ to one of two values. By the previous paragraph, this leaves at most two possible congruence classes for the triangle.\n\\end{proof}\n\nReturning to our original sequence, note that any two consecutive quadrilaterals in the sequence have the same area and the same unordered list of side lengths. The latter can occur as an ordered list in at most six different ways (up to cyclic shift); for each of these, we can have only finitely many distinct congruence classes of quadrilaterals in our sequence with that area and ordered list of side lengths. We deduce that our sequence must be finite.\n\n\\noindent\n\\textbf{Remark.}\nVarious proofs of the lemma are possible; for example, here is one using Cartesian coordinates. We \nfirst specify \n\\[\nP = (0,0), Q = (a, 0).\n\\]\nFor two additional points $R = (x,y),S = (z,w)$, the conditions $\\overline{QR} = b$, $\\overline{SP} = d$ restrict $R$ and $S$ to the circles\n\\[\n(x-a)^2 + y^2 = b^2, \\quad\nz^2+w^2 = d^2\n\\]\nrespectively. Since we want a convex quadrilateral, we may assume without loss of generality that $y,w > 0$.\nThe area of the quadrilateral is $\\frac{1}{2} a(y+w)$, which we also want to fix; we may thus regard $w$ as a function of $y$ (possibly restricting $y$ to a range for which $w>0$). After splitting the semicircles on which $R$ and $S$ lie into two arcs each, we may also regard $x$ and $w$ as functions of $y$. It now suffices to observe that $\\overline{RS}^2 = (z-x)^2 + (w-y)^2$\nis a nonconstant algebraic function of $y$, so it takes any given value only finitely many times.\n\n\\noindent\n\\textbf{Second solution.}\nLet $ABCD$ be the first quadrilateral in the sequence.\nSince the quadrilateral is convex, the diagonals $\\overline{AC}$ and $\\overline{BD}$ intersect. In particular they are not parallel, so their perpendicular bisectors are not parallel either; let $O$ be the intersection\nof the bisectors.\n\nWe claim that the point $O$ remains fixed throughout the sequence, as do the distances $OA, OB, OC, OD$. To see this, we check this for two partners as described in the problem statement: the diagonal $\\overline{BD}$ gets reflected across the perpendicular bisector of $\\overline{AC}$, so its perpendicular bisector also gets reflected; the point $O$ is the unique point on the perpendicular bisector of $\\overline{BD}$ fixed by the reflection. In particular, the segments $\\overline{OD}$ and $\\overline{OE}$ are mirror images across the perpendicular bisector of $\\overline{AC}$, so their lengths coincide.\n\nAs noted in the first solution, the unordered list of side lengths of the quadrilateral also remains invariant throughout the sequence. Consequently, the unordered list of side lengths of each of the triangles $\\triangle OAB, \\triangle OBC, \\triangle OCD, \\triangle ODA$ is limited to a finite set;\neach such list uniquely determines the unoriented congruence class of the corresponding triangle,\nand limits the oriented congruence class to two possibilities. Given the oriented congruence classes of the four triangles we can reconstruct the quadrilateral $ABCD$ up to oriented congruence (even up to rotation around $O$); this proves that the sequence must be finite.", "source_problems": "PUTNAM-2024-problems.tex", "source_solutions": "PUTNAM-2024-solutions.tex", "notes": ""}
{"id": "PUTNAM-2024-B3", "contest": "PUTNAM", "year": "2024", "problem_number": "B3", "problem": "Let $r_n$ be the $n$th smallest positive solution to $\\tan x = x$, where the argument of tangent is in radians. Prove that\n\\[\n0 < r_{n+1} - r_n - \\pi < \\frac{1}{(n^2+n)\\pi}\n\\]\nfor $n \\geq 1$.", "solution": "\\noindent\n\\textbf{First solution.} (by Bjorn Poonen)\nLet $\\tan^{-1} \\colon \\RR \\to (-\\frac{\\pi}{2}, \\frac{\\pi}{2})$ be the principal branch of the arctangent function, and set $t(x) := x - \\tan^{-1}(x)$. Then $t(0) = 0$ and\n\\[\n\\frac{dt}{dx} = 1 - \\frac{1}{1+x^2} = \\frac{x^2}{1+x^2} > 0 \\qquad (x \\neq 0),\n\\]\nso $t(x)$ is strictly increasing.\nWe have $\\tan x = x$ if and only if $x = \\tan^{-1} x + n\\pi$ for some $n \\in \\mathbb{Z}$;\nfrom the previous analysis it follows that $r_n$ is the unique solution of $t(x) = n \\pi$.\n\nLet $x(t)$ be the inverse function of $t(x)$, so that $r_n = x(n\\pi)$. We compute that\n\\begin{align*}\n\\frac{dx}{dt} - 1 &= \\frac{1}{dt/dx} - 1 = \\frac{1}{x^2} \\\\\n\\frac{dx}{dt} - 1 - \\frac{1}{t^2} &= \\frac{1}{x^2} - \\frac{1}{t^2}.\n\\end{align*}\nFrom this we deduce that $x(t) - t$ is strictly increasing for $t > 0$ (as then $x(t) > 0$)\nand $x(t) - t + \\frac{1}{t}$ is strictly decreasing for $t > 0$ (as then $\\tan^{-1}(x(t)) > 0$ and so $t < x(t)$).  Evaluating at $t = n\\pi$ and $t = (n+1)\\pi$, we obtain \n\\begin{align*}\nr_n - n\\pi &< r_{n+1} - (n+1) \\pi \\\\\nr_n - n\\pi + \\frac{1}{n\\pi} &> r_{n+1} - (n+1)\\pi + \\frac{1}{(n+1)\\pi},\n\\end{align*}\nwhich are the desired inequalities.\n\n\\noindent\n\\textbf{Second solution.}\nDefine the function \n\\[\nf(x) := \\tan x - x.\n\\]\nWe then have $f'(x) = \\tan^2 x$.\nBy induction on $k$, $f^{(k)}(x)$ is a polynomial of degree $k+1$ in $\\tan x$\nwith leading coefficient $k!$ and all coefficients nonnegative. In particular, on each of the intervals\n\\[\nI_n := \\left(n \\pi, n \\pi + \\frac{\\pi}{2} \\right)  \\qquad (n=0,1,\\dots),\n\\]\n$\\tan x$ is positive\nand so $f^{(k)}(x)$ is positive for each $k \\geq 1$; replacing $k$ with $k+1$, we deduce that each $f^{(k)}(x)$ is strictly increasing on $I_n$ for $k \\geq 0$.\n\nWe now analyze $f$ more closely on $I_n$.\nAs $x \\to n\\pi^+$ for $n>0$, $f(x)$ tends to $f(n\\pi) = -n\\pi < 0$;\nby contrast, as $x \\to 0^+$, $f(x)$ tends to 0 via positive values.\nIn either case, as $x \\to (n \\pi + \\frac{\\pi}{2})^-$, $f(x) \\to \\infty$.\nSince $f(x)$ is strictly increasing on $I_n$, we deduce using the intermediate value theorem that:\n\\begin{itemize}\n\\item\n$f(x)$ has no zero in $I_0$;\n\\item\nfor $n > 0$, $f(x)$ has a unique zero in $I_n$.\n\\end{itemize}\nSince $f(x)$ also has no zero between $I_n$ and $I_{n+1}$ (as it takes exclusively negative values there), we deduce that\n\\[\nn\\pi < r_n < n \\pi + \\frac{\\pi}{2}.\n\\]\nThis already suffices to prove the claimed lower bound: since\n$f(r_n+\\pi) = - \\pi < 0$ and $f$ is strictly increasing on $I_{n+1}$, \nthe quantity $\\delta := r_{n+1} - (r_n + \\pi)$ is positive.\n\nTo prove the upper bound, note that for $k \\geq 1$,\nfor $0 < x < n\\pi + \\frac{\\pi}{2}-r_n$, we have\n\\begin{align*}\nf^{(k)}(x) & \\geq f^{(k)}(r_n + \\pi) = f^{(k)}(r_n) \\\\\n&\\geq k! r_n^{k+1} > k! n^{k+1} \\pi^{k+1}.\n\\end{align*}\nFor each $k \\geq 2$, we may apply the mean value theorem with remainder to deduce that for $x$ in the same range,\n\\[\nf(r_n+\\pi+x)\\geq f(r_n+\\pi) + \\sum_{i=1}^k f^{(i)}(r_n+\\pi) \\frac{x^i}{i!}.\n\\]\nTaking the limit as $k \\to \\infty$ yields\n\\begin{align*}\nf(r_n + \\pi + x) &\\geq f(r_n+\\pi) + \\sum_{i=1}^\\infty f^{(i)}(r_n+\\pi) \\frac{x^i}{i!} \\\\\n& > -\\pi + \\sum_{i=1}^k n^{i+1} \\pi^{i+1} x^i \\\\\n&> - \\pi + \\frac{n^2\\pi^2 x}{1-n \\pi x};\n\\end{align*}\ntaking $x = \\delta$ yields\n\\[\n0 > -\\pi + n \\pi \\left(\\frac{1}{1-n \\pi \\delta} - 1\\right)\n\\]\nand so $\\delta < \\frac{1}{n(n+1)\\pi}$ as desired.\n\n\\noindent\n\\textbf{Remark.}\nThere is a mild subtlety hidden in the proof:\nif one first bounds the finite sum as\n\\[\nf(r_n+\\pi+x) > -\\pi+ \\sum_{i=1}^k n^{i+1} \\pi^{i+1} x^i\n\\]\nand then takes the limit as $k \\to \\infty$, the strict inequality is not preserved. One way around this is to write $f''(r_n) = 2r_n + 2 r_n^3$,\nretain the extra term $r_n x^2$ in the lower bound, take the limit as $k \\to \\infty$, and then discard the extra term to get back to a strict inequality. \n\n\\noindent\n\\textbf{Remark.}\nThe slightly weaker inequality $\\delta < \\frac{1}{n^2 \\pi}$\nfollows at once from the inequality\n\\[\nf'(r_n + \\pi) = f'(r_n) = \\tan^2 r_n = r_n^2 > n^2 \\pi^2\n\\]\nplus the mean value theorem.\n\n\\noindent\n\\textbf{Remark.}\nOne can also reach the desired upper bound by comparing $r_{n+1}$ to $r_n + \\pi$ using the addition formula for tangents:\n\\[\n\\tan(x+y) = \\frac{\\tan x - \\tan y}{1 + \\tan x \\tan y}.\n\\]\nNamely, one then gets\n\\begin{align*}\n\\delta &< \\tan \\delta = \\frac{\\tan r_{n+1}  - \\tan (r_n+\\pi)}{1 + \\tan r_{n+1} \\tan (r_n+\\pi)} \\\\\n&= \\frac{r_{n+1}-r_n}{1 + r_n r_{n+1}} = \\frac{\\pi + \\delta}{1 + r_n r_{n+1}}\n\\end{align*}\nand hence\n\\[\n\\delta < \\frac{\\pi}{r_n r_{n+1}} < \\frac{\\pi}{(n\\pi)((n+1)\\pi)} = \\frac{1}{(n^2+n)\\pi}.\n\\]", "source_problems": "PUTNAM-2024-problems.tex", "source_solutions": "PUTNAM-2024-solutions.tex", "notes": ""}
{"id": "PUTNAM-2024-B4", "contest": "PUTNAM", "year": "2024", "problem_number": "B4", "problem": "Let $n$ be a positive integer. Set $a_{n,0} = 1$. For $k \\geq 0$, choose an integer $m_{n,k}$ uniformly at random from the set $\\{1,\\dots,n\\}$, and let\n\\[\na_{n,k+1} = \\begin{cases} a_{n,k} + 1, & \\mbox{if $m_{n,k} > a_{n,k};$} \\\\\na_{n,k}, & \\mbox{if $m_{n,k} = a_{n,k}$;} \\\\\na_{n,k}-1, & \\mbox{if $m_{n,k} < a_{n,k}$.}\n\\end{cases}\n\\]\nLet $E(n)$ be the expected value of $a_{n,n}$. Determine $\\lim_{n\\to \\infty} E(n)/n$.", "solution": "The limit equals $\\frac{1-e^{-2}}{2}$.\n\n\\noindent\n\\textbf{First solution.}\nWe first reformulate the problem as a Markov chain.\nLet $v_k$ be the column vector of length $n$ whose $i$-th entry is the probability that $a_{n,k} = i$, so that $v_0$ is the vector $(1,0,\\dots,0)$.\nThen for all $k \\geq 0$, $v_{k+1} = A v_k$ where $A$ is the $n \\times n$\nmatrix defined by\n\\[\nA_{ij} = \\begin{cases}\n\\frac{1}{n} & \\mbox{if $i = j$} \\\\\n\\frac{j-1}{n} & \\mbox{if $i = j-1$} \\\\\n\\frac{n-j}{n} & \\mbox{if $i = j+1$} \\\\\n0 & \\mbox{otherwise.}\n\\end{cases}\n\\]\nLet $w$ be the row vector $(1, \\dots, n)$; then the expected value of $a_{n,k}$ is the sole entry of the $1 \\times 1$ matrix $w v_k = w A^k v_0$. In particular, $E(n) = w A^n v_0$.\n\nWe compute some left eigenvectors of $A$. First,\n\\[\nw_0 := (1,\\dots,1)\n\\]\nsatisfies $Aw_0 = w_0$. Second,\n\\begin{align*}\nw_1 &:= (n-1, n-3, \\dots, 3-n, 1-n) \\\\\n&= (n-2j+1\\colon j=1,\\dots,n)\n\\end{align*}\nsatisfies $Aw_1 = \\frac{n-2}{n} w_1$: the $j$-th entry of $Aw_i$ equals\n\\begin{align*}\n&\\frac{j-1}{n} (n+3-2j) + \\frac{1}{n} (n+1-2j) + \\frac{n-j}{n} (n-1-2j) \\\\\n&\\quad= \\frac{n-2}{n} (n-2j+1).\n\\end{align*}\nBy the same token, we obtain\n\\[\nw = \\frac{n+1}{2} w_0 - \\frac{1}{2} w_1;\n\\]\nwe then have\n\\begin{align*}\n\\frac{E(n)}{n} &= \\frac{n+1}{2n} w_0A^n v_0 - \\frac{1}{2n} w_1A^n v_0 \\\\\n&= \\frac{n+1}{2n} w_0 v_0 - \\frac{1}{2n} \\left( 1 - \\frac{2}{n} \\right)^n w_1 v_0  \\\\\n&= \\frac{n+1}{2n} - \\frac{n-1}{2n} \\left( 1 - \\frac{2}{n} \\right)^n.\n\\end{align*}\nIn the limit, we obtain\n\\begin{align*}\n\\lim_{n \\to \\infty} \\frac{E(n)}{n} &= \\frac{1}{2} - \\frac{1}{2} \\lim_{n \\to \\infty} \\left( 1 - \\frac{2}{n} \\right)^n \\\\\n&= \\frac{1}{2} - \\frac{1}{2} e^{-2}.\n\\end{align*}\n\n\\noindent\n\\textbf{Remark.}\nWith a bit more work, one can show that $A$ has eigenvalues\n$\\frac{n-2j}{n}$ for $j=0,\\dots,n-1$, and find the corresponding left and right eigenvectors.\nIn particular, it is also possible (but much more complicated) to express $v_0$ as a linear combination of right eigenvectors and use this to calculate $A^n v_0$.\n\n\\noindent\n\\textbf{Second solution.} \nWe reinterpret the Markov chain in combinatorial terms.\nConsider an apparatus consisting of one red light bulb, which is initially lit,\nplus $n-1$ white light bulbs, which are initially unlit. \nWe then repeatedly perform the following operation. \nPick one light bulb uniformly at random. If it is the red bulb, do nothing;\notherwise, switch the bulb from lit to unlit or vice versa.\nAfter $k$ operations of this form, the random variable $a_{n,k}$ is equal to the number of lit bulbs (including the red bulb).\n\nWe may then compute the expected value of $a_{n,n}$ by summing over bulbs.\nThe red bulb contributes 1 no matter what. Each other bulb contributes $1$ if it is switched an odd number of times and 0 if it is switched an even number of times,\nor equivalently $\\frac{1}{2}(1-(-1)^j)$ where $j$ is the number of times this bulb is switched.\nHence each bulb other than the red bulb contributes\n\\begin{align*} \n&n^{-n} \\sum_{i=0}^n \\frac{1}{2}(1-(-1)^i) \\binom{n}{i} (n-1)^{n-i} \\\\\n&= \\frac{n^{-n}}{2} \\left( \\sum_{i=0}^n \\binom{n}{i} (n-1)^{n-i} \n- \\sum_{i=0}^n (-1)^i \\binom{n}{i} (n-1)^{n-i} \\right) \\\\\n&= \\frac{n^{-n}}{2} \\left( (1+(n-1))^n - (-1+(n-1))^n \\right) \\\\\n&= \\frac{n^{-n}}{2} (n^2 - (n-2)^n) \\\\\n&= \\frac{1}{2} - \\frac{1}{2} \\left( 1 - \\frac{2}{n} \\right)^n.\n\\end{align*}\nThis tends to $\\frac{1 - e^{-2}}{2}$ as $n \\to \\infty$. Since $E(n)$ equals $n-1$ times this contribution plus 1, $\\frac{E(n)}{n}$ tends to the same limit.\n\n\\noindent\n\\textbf{Third solution.}\nWe compare the effect of taking \n$a_{n,0} = j$ versus $a_{n,0} = j+1$ for some $j \\in \\{1,\\dots,n-1\\}$.\nIf $m_{n,0} \\in \\{j,j+1\\}$ then the values of $a_{n,1}$ coincide, as then do the subsequent values\nof $a_{n,k}$; this occurs with probability $\\frac{2}{n}$. Otherwise, the values of $a_{n,1}$ differ by 1 and the situation repeats.\n\nIterating, we see that the two sequences remain 1 apart (in the same direction) with probability $\\left( \\frac{n-2}{n} \\right)^n$ and converge otherwise. Consequently, changing the start value from $j$ to $j+1$ increases the expected value of $a_{n,n}$ by $\\left( \\frac{n-2}{n} \\right)^n$. \n\nNow let $c$ be the expected value of $a_{n,n}$ in the original setting where $a_{n,0} = 1$.\nBy symmetry, if we started with $a_{n,0} = n$ the expected value would change from $c$ to $n+1-c$;\non the other hand, by the previous paragraph it would increase by \n$(n-1)\\left( \\frac{n-2}{n} \\right)^n$. We deduce that\n\\[\nc = \\frac{1}{2} \\left( n+1 - (n-1) \\left( \\frac{n-2}{n} \\right)^n \\right)\n\\]\nand as above this yields the claimed limit.", "source_problems": "PUTNAM-2024-problems.tex", "source_solutions": "PUTNAM-2024-solutions.tex", "notes": ""}
{"id": "PUTNAM-2024-B5", "contest": "PUTNAM", "year": "2024", "problem_number": "B5", "problem": "Let $k$ and $m$ be positive integers. For a positive integer $n$, let $f(n)$ be the number of integer sequences $x_1,\\dots,x_k,y_1,\\dots,y_m,z$ satisfying $1 \\leq x_1 \\leq \\cdots \\leq x_k \\leq z \\leq n$ and $1 \\leq y_1 \\leq \\cdots \\leq y_m \\leq z \\leq n$. Show that $f(n)$ can be expressed as a polynomial in $n$ with nonnegative coefficients.", "solution": "For convenience, we extend the problem to allow nonnegative values for $k$ and $m$.\n\n\\noindent\n\\textbf{First solution.}\nLet $R(n,k)$ denote the number of subsets of $\\{1,...,n\\}$ of size $k$ where repetitions are allowed. \nThe ``sticks and stones'' argument shows that \n\\[\nR(n,k)=\\binom{n+k-1}{k}:\n\\]\nthere is a bijection of these subsets with linear arrangements of $k$ (unlabeled) sticks and $z-1$ (unlabeled) stones,\nwhere we recover the subset by counting the number of stones to the left of each stick.\n\nLet $f_{k,m}(n) := \\sum_{z=1}^n R(z,k)R(z,m)$. \nIt is known that for any positive integer $k$, the sum of the $k$-th powers of all positive integers less than or equal to $n$ is a polynomial in $n$ (given explicitly in terms of Bernoulli numbers via Faulhaber's formula); hence $f_{k,m}(n)$ is a polynomial in $n$. \nWe wish to show that this polynomial has nonnegative coefficients.\n\nUsing the recursion for binomial coefficients, we obtain\n\\begin{align*}\nR(n,k)R(n,m) &= f_{k,m}(n)-f_{k,m}(n-1) \\\\\n&= \\sum_{z=1}^n \\left( R(z,k)R(z,m)-R(z-1,k)R(z-1,m)\\right)\\\\\n&= \\sum_{z=1}^n \\left( R(z,k)R(z,m)-R(z-1,k)R(z,m) \\right.\\\\\n&\\quad \\left. +R(z-1,k)R(z,m)-R(z-1,k)R(z-1,m) \\right) \\\\\n&= \\sum_{z=1}^n \\left( R(z,k-1)R(z,m)+R(z-1,k)R(z,m-1) \\right) \\\\\n&= \\sum_{z=1}^n \\left( R(z,k-1)R(z,m) \\right. \\\\\n&\\quad \\left. +(R(z,k)-R(z,k-1))R(z,m-1) \\right)\\\\\n&= f_{k-1,m}(n)+f_{k,m-1}(n)-f_{k-1,m-1}(n).\n\\end{align*}\nIt follows from the latter equation (replacing the index $m$ by $m+1$) that\n\\begin{equation} \\label{eq:summation recurrence}\nf_{k,m}(n) = R(n,k)R(n,m+1) + f_{k-1,m}(n) - f_{k-1,m+1}(n);\n\\end{equation}\nthis can also be recovered by applying Abel summation (summation by parts) to\n$\\sum_{z=1}^n R(z,k) R(z,m)$.\n\nUsing \\eqref{eq:summation recurrence}, we can evaluate $f_{k,m}$ by induction on $k$: for the first few values we obtain\n\\begin{align*}\nf_{0,m}(n) &= R(n,m+1) \\\\\nf_{1,m}(n) &= R(n,1)R(n,m+1) + R(n,m+1) - R(n,m+2) \\\\\n           & = R(n,m+1)((m+1)n+1)/(m+2) \\\\\n           & = R(n,m+1) \\frac{R(m+1,1)R(n,1)+1}{m+2}\n\\end{align*}\nand similarly\n\\begin{align*}\nf_{2,m}(n) &= R(n,m+1) (R(m+1,2)R(n,2) + R(m+1,1)R(n,1) \\\\\n&\\quad +R(m+1,0)R(n,0))/R(m+2,2).\n\\end{align*}\nThis leads us to conjecture that\n\\begin{equation} \\label{eq:summation formula}\nf_{k,m}(n) = \\frac{R(n,m+1)}{R(m+2,k)} \\sum_{i=0}^k R(m+1,i)R(n,i),\n\\end{equation}\nwhich we prove by induction on $k$.\nThe base case $k=0$ is evident;\ngiven \\eqref{eq:summation formula} with $k$ replaced by $k-1$,\nwe apply \\eqref{eq:summation recurrence} to obtain\n\\begin{align*}\n&f_{k,m}(n) \\\\\n&= R(n,k) R(n,m+1) + \\frac{R(n,m+1)}{R(m+2,k-1)} \\sum_{i=0}^{k-1} R(m+1,i)R(n,i)\\\\\n&\\quad - \\frac{R(n,m+2)}{R(m+3,k-1)} \\sum_{i=0}^{k-1} R(m+2,i)R(n,i) \\\\\n&= \\frac{R(n,m+1)}{R(m+2,k)} \\sum_{i=0}^k R(m+1,i)R(n,i)\n\\end{align*}\nyielding \\eqref{eq:summation formula} as written.\n\nSince $R(n,i) = n(n+1)(n+2)\\cdots (n+i-1)/i!$ clearly has positive coefficients for all $i$, the explicit formula \\eqref{eq:summation formula} implies that $f_{k,m}(n)$ also has positive coefficients for all $k$ and $m$.\n\n\\noindent\n\\textbf{Second solution.} \n(by an anonymous Putnam participant)\nAs in the first solution, we deduce that $f_{k,m}(n)$ is a polynomial in $n$ of degree $k+m+1$\nsatisfying $f_{k,m}(0) = 0$ and $f_{k,m}(n) - f_{k,m}(n-1) = R(n,k)R(n,m)$.\nSince $f_{k,m}(n) > 0$ for $n \\gg 0$, this polynomial has positive leading coefficient.\nTo prove that it has nonnegative coefficients, it will suffice to prove the stronger assertion that the roots of $f_{k,m}(x)$ are all real and nonpositive, as then this will imply that $f_{k,m}(x) = c \\prod_{j=0}^{k+m} (x + r_j)$ for some $r_j \\geq 0$.\n\nSince $R(n,m) = 0$ for $m=0,-1,\\dots,-m+1$, we deduce that $f_{k,m}(n) = 0$ for \n$n=0,-1,\\dots,-m$. Consequently, $f_{k,m}(x)$ can be written as $x(x+1)\\cdots(x+m) Q(x)$ for some polynomial $Q(x)$ of degree $k$, and it will suffice to check that $Q(x)$ has $k$ distinct negative real roots.\n\nFrom the equality $f_{k,m}(n) - f_{k,m}(n-1) = R(n,k)R(n,m)$, if we substitute in for $Q(x)$\nand divide out common factors, we obtain\n\\[\n(x+m) Q(x) - (x-1) Q(x-1) = \\frac{1}{m!} R(x,k).\n\\]\nSubstituting $x=0,-1,\\dots,-k+1$ in turn, we obtain\n\\[\nQ(-j) = - \\frac{j+1}{m-j} Q(-j-1) \\quad (j=0, \\dots, k-1).\n\\]\nIn particular, if any of $Q(0),\\dots,Q(-k)$ were zero, then all of them would be zero and \n$Q$ would have too many roots for its degree. Consequently, $Q(0),\\dots,Q(-k)$ are all nonzero\nand alternating in sign. By the intermediate value theorem, $Q$ has a root $r_j$ in the interval $(-j-1,-j)$ for $j=0,\\dots,k-1$; this completes the proof.", "source_problems": "PUTNAM-2024-problems.tex", "source_solutions": "PUTNAM-2024-solutions.tex", "notes": ""}
{"id": "PUTNAM-2024-B6", "contest": "PUTNAM", "year": "2024", "problem_number": "B6", "problem": "For a real number $a$, let $F_a(x) = \\sum_{n \\geq 1} n^a e^{2n} x^{n^2}$ for $0 \\leq x < 1$.\nFind a real number $c$ such that\n\\begin{align*}\n& \\lim_{x \\to 1^-} F_a(x) e^{-1/(1-x)} = 0 \\qquad \\mbox{for all $a < c$, and} \\\\\n& \\lim_{x \\to 1^-} F_a(x) e^{-1/(1-x)} = \\infty \\qquad \\mbox{for all $a > c$.}\n\\end{align*}\n\n\\end{itemize}\n\n\\end{document}z", "solution": "The claim holds with $c=-\\frac{1}{2}$.\nSet $t := 1/(1-x)$, so that $x = 1 - 1/t$\nand\n\\[\n- \\frac{1}{t} - \\frac{1}{t^2} \\leq \\log x \\leq - \\frac{1}{t}.\n\\]\nSet also $m := \\lfloor t \\rfloor$.\nIn the following arguments, we use $c$ to refer to some positive constant independent of $n$ and $t$,\nbut a different such constant at each appearance.\n\nSuppose first that $a > -\\frac{1}{2}$. Then\n\\begin{align*}\nF_a(x)e^{-t} &= \\sum_{n=1}^\\infty n^a e^{2n-t} x^{n^2}  \\\\\n&\\geq \\sum_{n=1}^\\infty n^a e^{2n-t-n^2/t-n^2/t^2}  \\\\\n&= \\sum_{n=1}^\\infty n^a e^{-n^2/t^2} e^{-t(1-n/t)^2}.\n\\end{align*}\nIf we restrict the sum to the range $t < n < t + \\sqrt{t}$, we may bound the summand from below by\n$c t^a$; we then have\n$F_a(x) e^{-t} > ct^{a+1/2}$ and this tends to $\\infty$ as $t \\to \\infty$.\n\nSuppose next that $a < -\\frac{1}{2}$. Then\n\\begin{align*}\nF_a(x)e^{-t} &= \\sum_{n=1}^\\infty n^a e^{2n-t} x^{n^2} \\\\\n&\\leq \\sum_{n=1}^\\infty n^a e^{-t(1-n/t)^2}.\n\\end{align*}\nFix $\\epsilon>0$ such that $a+\\epsilon < -\\frac{1}{2}$.\nFor the summands with $t - t^{1/2+\\epsilon} < n < t + t^{1/2+\\epsilon}$, we may bound the summand from above by $ct^a$; this range of the sum is then dominated by\n$ct^{a+1/2+\\epsilon}$. \nFor the summands with $n < t - t^{1/2+\\epsilon}$, we may bound the summand by\n$n^a e^{-t^{2\\epsilon}}$; this range of the sum is then dominated by $t e^{-t^{2\\epsilon}}$.\nFor the summands with $n > t - t^{1/2+\\epsilon}$, we may again bound the summand by\n$n^a e^{-t^{2\\epsilon}}$; this range of the sum is then dominated by $c t^{a+1} e^{-t^{2\\epsilon}}$.\nSince all three bounds tends to 0 as $t \\to \\infty$, so then does $F_a(x) e^{-t}$.\n\n\\end{itemize}\n\\end{document}", "source_problems": "PUTNAM-2024-problems.tex", "source_solutions": "PUTNAM-2024-solutions.tex", "notes": ""}
{"id": "TST-2016-1", "contest": "TST", "year": "2016", "problem_number": "1", "problem": "Let \\(S=\\{1, \\ldots, n\\}\\) \uff0eGiven a bijection \\(f: S \\rightarrow S\\) an orbit of \\(f\\) is a set of the form \\(\\{x, f(x), f(f(x)), \\ldots\\}\\) for some \\(x \\in S\\) \uff0eWe denote by \\(c(f)\\) the number of distinct orbits of \\(f\\) \uff0eFor example\uff0cif \\(n=3\\) and \\(f(1)=2, f(2)=1, f(3)=3\\) \uff0cthe two orbits are \\(\\{1,2\\}\\) and \\(\\{3\\}\\) \uff0chence \\(c(f)=2\\) \uff0e Given \\(k\\) bijections \\(f_{1}, \\ldots, f_{k}\\) from \\(S\\) to itself\uff0cprove that \\[ c\\left(f_{1}\\right)+\\cdots+c\\left(f_{k}\\right) \\leq n(k-1)+c(f) \\] where \\(f: S \\rightarrow S\\) is the composed function \\(f_{1} \\circ \\cdots \\circ f_{k}\\) \uff0e", "solution": "Most motivated solution is to consider \\(n-c(f)\\) and show this is the transposition distance\uff0e Dumb graph theory works as well\uff0e", "source_pdf": "TST_2016.pdf", "notes": ""}
{"id": "TST-2016-2", "contest": "TST", "year": "2016", "problem_number": "2", "problem": "Let \\(A B C\\) be a scalene triangle with circumcircle \\(\\Omega\\) \uff0cand suppose the incircle of \\(A B C\\) touches \\(B C\\) at \\(D\\) \uff0eThe angle bisector of \\(\\angle A\\) meets \\(B C\\) and \\(\\Omega\\) at \\(K\\) and \\(M\\) \uff0e The circumcircle of \\(\\triangle D K M\\) intersects the \\(A\\)\uff0dexcircle at \\(S_{1}, S_{2}\\) \uff0cand \\(\\Omega\\) at \\(T \\neq M\\) \uff0e Prove that line \\(A T\\) passes through either \\(S_{1}\\) or \\(S_{2}\\) \uff0e", "solution": "We present an angle\uff0dchasing solution\uff0cand then a more advanced alternative finish\uff0e If First solution\uff08angle chasing\uff09\uff0eAssume for simplicity \\(A B<A C\\) \uff0eLet \\(E\\) be the contact point of the \\(A\\)\uff0dexcircle on \\(B C\\) \uff1balso let ray \\(T D\\) meet \\(\\Omega\\) again at \\(L\\) \uff0eFrom the fact that \\(\\angle M T L=\\angle M T D=180^{\\circ}-\\angle M K D\\) \uff0cwe can deduce that \\(\\angle M T L=\\angle A C M\\) \uff0c meaning that \\(L\\) is the reflection of \\(A\\) across the perpendicular bisector \\(\\ell\\) of \\(B C\\) \uff0eIf we reflect \\(T, D, L\\) over \\(\\ell\\) \uff0cwe deduce \\(A, E\\) and the reflection of \\(T\\) across \\(\\ell\\) are collinear\uff0c which implies that \\(\\angle B A T=\\angle C A E\\) \uff0e Now\uff0cconsider the reflection point \\(E\\) across line \\(A I\\) \uff0csay \\(S\\) \uff0eSince ray \\(A I\\) passes through the \\(A\\)\uff0dexcenter\uff0c\\(S\\) lies on the \\(A\\)\uff0dexcircle\uff0eSince \\(\\angle B A T=\\angle C A E, S\\) also lies on ray \\(A T\\) \uff0e But the circumcircles of triangles \\(D K M\\) and \\(K M E\\) are congruent\uff08from \\(D M=E M\\) \uff09\uff0c so \\(S\\) lies on the circumcircle of \\(\\triangle D K M\\) too\uff0eHence \\(S\\) is the desired intersection point\uff0e I Second solution\uff08advanced\uff09\uff0eIt\uff07s known that \\(T\\) is the touch\uff0dpoint of the \\(A\\)\uff0dmixtilinear incircle\uff0eLet \\(E\\) be contact point of \\(A\\)\uff0dexcircle on \\(B C\\) \uff0eNow the circumcircles of \\(\\triangle D K M\\) and \\(\\triangle K M E\\) are congruent\uff0csince \\(D M=M E\\) and the angles at \\(K\\) are supplementary\uff0e Let \\(S\\) be the reflection of \\(E\\) across line \\(K M\\) \uff0cwhich by the above the above comment lies on the circumcircle of \\(\\triangle D K M\\) \uff0eSince \\(K M\\) passes through the \\(A\\)\uff0dexcenter\uff0c\\(S\\) also lies on the \\(A\\)\uff0dexcircle\uff0eBut \\(S\\) also lies on line \\(A T\\) \uff0csince lines \\(A T\\) and \\(A E\\) are isogonal\uff08the mixtilinear cevian is isogonal to the Nagel line\uff09\uff0eThus \\(S\\) is the desired intersection point\uff0e IT Authorship comments\uff0eThis problem comes from an observation of mine\uff1alet \\(A B C\\) be a triangle\uff0clet the \\(\\angle A\\) bisector meet \\(\\overline{B C}\\) and \\((A B C)\\) at \\(E\\) and \\(M\\) \uff0eLet \\(W\\) be the tangency point of the \\(A\\)\uff0dmixtilinear excircle with the circumcircle of \\(A B C\\) \uff0eThen \\(A\\)\uff0d Nagel line passed through a common intersection of the circumcircle of \\(\\triangle M E W\\) and the \\(A\\)\uff0dmixtilinear incircle\uff0e This problem is the inverted version of this observation\uff0e", "source_pdf": "TST_2016.pdf", "notes": ""}
{"id": "TST-2016-3", "contest": "TST", "year": "2016", "problem_number": "3", "problem": "Let \\(p\\) be a prime number\uff0eLet \\(\\mathbb{F}_{p}\\) denote the integers modulo \\(p\\) \uff0cand let \\(\\mathbb{F}_{p}[x]\\) be the set of polynomials with coefficients in \\(\\mathbb{F}_{p}\\) \uff0eDefine \\(\\Psi: \\mathbb{F}_{p}[x] \\rightarrow \\mathbb{F}_{p}[x]\\) by \\[ \\Psi\\left(\\sum_{i=0}^{n} a_{i} x^{i}\\right)=\\sum_{i=0}^{n} a_{i} x^{p^{i}} \\] Prove that for nonzero polynomials \\(F, G \\in \\mathbb{F}_{p}[x]\\) \uff0c \\[ \\Psi(\\operatorname{gcd}(F, G))=\\operatorname{gcd}(\\Psi(F), \\Psi(G)) . \\]", "solution": "Observe that \\(\\Psi\\) is also a linear map of \\(\\mathbb{F}_{p}\\) vector spaces\uff0cand that \\(\\Psi(x P)=\\Psi(P)^{p}\\) for any \\(P \\in \\mathbb{F}_{p}[x]\\) \uff0e\uff08In particular\uff0c\\(\\Psi(1)=x\\) \uff0cnot 1 \uff0ctake caution\uff01\uff09 First solution\uff08Ankan Bhattacharya\uff09\uff0eWe start with\uff1a Claim\uff0dIf \\(P \\mid Q\\) then \\(\\Psi(P) \\mid \\Psi(Q)\\) \uff0e Proof\uff0eSet \\(Q=P R\\) \uff0cwhere \\(R=\\sum_{i=0}^{k} r_{i} x^{i}\\) \uff0eThen \\[ \\Psi(Q)=\\Psi\\left(P \\sum_{i=0}^{k} r_{i} x^{i}\\right)=\\sum_{i=0}^{k} \\Psi\\left(P \\cdot r_{i} x^{i}\\right)=\\sum_{i=0}^{k} r_{i} \\Psi(P)^{p^{i}} \\] which is divisible by \\(\\Psi(P)\\) \uff0e This already implies \\[ \\Psi(\\operatorname{gcd}(F, G)) \\mid \\operatorname{gcd}(\\Psi(F), \\Psi(G)) . \\] For the converse\uff0cby Bezout there exists \\(A, B \\in \\mathbb{F}_{p}[x]\\) such that \\(A F+B G=\\operatorname{gcd}(F, G)\\) \uff0c so taking \\(\\Psi\\) of both sides gives \\[ \\Psi(A F)+\\Psi(B G)=\\Psi(\\operatorname{gcd}(F, G)) \\] The left\uff0dhand side is divisible by \\(\\operatorname{gcd}(\\Psi(F), \\Psi(G))\\) since the first term is divisible by \\(\\Psi(F)\\) and the second term is divisible by \\(\\Psi(G)\\) \uff0eSo \\(\\operatorname{gcd}(\\Psi(F), \\Psi(G)) \\mid \\Psi(\\operatorname{gcd}(F, G))\\) and noting both sides are monic we are done\uff0e Second solution\uff0eHere is an alternative\uff08longer but more conceptual\uff09way to finish without Bezout lemma\uff0eLet \\(\\beth \\subseteq \\mathbb{F}_{p}[x]\\) denote the set of polynomials in the image of \\(\\Psi\\) \uff0c thus \\(\\Psi: \\mathbb{F}_{p}[x] \\rightarrow \\beth\\) is a bijection on the level of sets\uff0e Claim\uff0dIf \\(A, B \\in \\beth\\) then \\(\\operatorname{gcd}(A, B) \\in \\beth\\) \uff0e Proof\uff0eIt suffices to show that if \\(A\\) and \\(B\\) are monic\uff0cand \\(\\operatorname{deg} A>\\operatorname{deg} B\\) \uff0cthen the remainder when \\(A\\) is divided by \\(B\\) is in \\(\\beth\\) \uff0eSuppose \\(\\operatorname{deg} A=p^{k}\\) and \\(B=x^{p^{k-1}}- c_{2} x^{p^{k-2}}-\\cdots-c_{k}\\) \uff0eThen \\[ \\begin{aligned} x^{p^{k}} & \\equiv\\left(c_{2} x^{p^{k-2}}+c_{3} x^{p^{k-3}}+\\cdots+c_{k}\\right)^{p} \\quad(\\bmod B) \\\\ & \\equiv c_{2} x^{p^{k-1}}+c_{3} x^{p^{k-2}} \\cdots+c_{k} \\quad(\\bmod B) \\end{aligned} \\] since exponentiation by \\(p\\) commutes with addition in \\(\\mathbb{F}_{p}\\) \uff0eThis is enough to imply the conclusion\uff0eThe proof if \\(\\operatorname{deg} B\\) is smaller less than \\(p^{k-1}\\) is similar\uff0e Thus\uff0cif we view \\(\\mathbb{F}_{p}[x]\\) and \\(\\beth\\) as partially ordered sets under polynomial division\uff0c then gcd is the\uff02greatest lower bound\uff02or\uff02meet\uff02in both partially ordered sets\uff0eWe will now prove that \\(\\Psi\\) is an isomorphism of the posets\uff0eWe have already seen that \\(P|Q \\Longrightarrow \\Psi(P)| \\Psi(Q)\\) from the first solution\uff0eFor the converse\uff1a Claim\uff0dIf \\(\\Psi(P) \\mid \\Psi(Q)\\) then \\(P \\mid Q\\) \uff0e Proof\uff0eSuppose \\(\\Psi(P) \\mid \\Psi(Q)\\) \uff0cbut \\(Q=P A+B\\) where \\(\\operatorname{deg} B<\\operatorname{deg} P\\) \uff0eThus \\(\\Psi(P) \\mid \\Psi(P A)+\\Psi(B)\\) \uff0chence \\(\\Psi(P) \\mid \\Psi(B)\\) \uff0cbut deg \\(\\Psi(P)>\\operatorname{deg} \\Psi(B)\\) hence \\(\\Psi(B)=0 \\Longrightarrow B=0\\) \uff0e This completes the proof\uff0e Remark\uff0eIn fact \\(\\Psi: \\mathbb{F}_{p}[x] \\rightarrow \\beth\\) is a ring isomorphism if we equip \\(\\beth\\) with function composition as the ring multiplication\uff0eIndeed in the proof of the first claim\uff08that \\(P|Q \\Longrightarrow \\Psi(P)| \\Psi(Q)\\) \uff09we saw that \\[ \\Psi(R P)=\\sum_{i=0}^{k} r_{i} \\Psi(P)^{p^{i}}=\\Psi(R) \\circ \\Psi(P) \\]", "source_pdf": "TST_2016.pdf", "notes": ""}
{"id": "TST-2016-4", "contest": "TST", "year": "2016", "problem_number": "4", "problem": "Let \\(\\sqrt{3}=1 . b_{1} b_{2} b_{3} \\cdots(2)\\) be the binary representation of \\(\\sqrt{3}\\) \uff0eProve that for any positive integer \\(n\\) \uff0cat least one of the digits \\(b_{n}, b_{n+1}, \\ldots, b_{2 n}\\) equals 1 \uff0e", "solution": "Assume the contrary\uff0cso that for some integer \\(k\\) we have \\[ k<2^{n-1} \\sqrt{3}<k+\\frac{1}{2^{n+1}} . \\] Squaring gives \\[ \\begin{aligned} k^{2}<3 \\cdot 2^{2 n-2} & <k^{2}+\\frac{k}{2^{n}}+\\frac{1}{2^{2 n+2}} \\\\ & \\leq k^{2}+\\frac{2^{n-1} \\sqrt{3}}{2^{n}}+\\frac{1}{2^{2 n+2}} \\\\ & =k^{2}+\\frac{\\sqrt{3}}{2}+\\frac{1}{16} \\\\ & <k^{2}+1 \\end{aligned} \\] and this is a contradiction\uff0e", "source_pdf": "TST_2016.pdf", "notes": ""}
{"id": "TST-2016-5", "contest": "TST", "year": "2016", "problem_number": "5", "problem": "Let \\(n \\geq 4\\) be an integer\uff0eFind all functions \\(W:\\{1, \\ldots, n\\}^{2} \\rightarrow \\mathbb{R}\\) such that for every partition \\([n]=A \\cup B \\cup C\\) into disjoint sets\uff0c \\[ \\sum_{a \\in A} \\sum_{b \\in B} \\sum_{c \\in C} W(a, b) W(b, c)=|A||B||C| . \\]", "solution": "Of course\uff0c\\(W(k, k)\\) is arbitrary for \\(k \\in[n]\\) \uff0eWe claim that \\(W(a, b)= \\pm 1\\) for any \\(a \\neq b\\) \uff0c with the sign fixed\uff0e\uff08These evidently work\uff0e\uff09 First\uff0clet \\(X_{a b c}=W(a, b) W(b, c)\\) for all distinct \\(a, b, c\\) \uff0cso the given condition is \\[ \\sum_{a, b, c \\in A \\times B \\times C} X_{a b c}=|A||B||C| . \\] Consider the given equation with the particular choices \uff0d\\(A=\\{1\\}, B=\\{2\\}, C=\\{3,4, \\ldots, n\\}\\) \uff0e \uff0d\\(A=\\{1\\}, B=\\{3\\}, C=\\{2,4, \\ldots, n\\}\\) \uff0e \uff0d\\(A=\\{1\\}, B=\\{2,3\\}, C=\\{4, \\ldots, n\\}\\) \uff0e This gives \\[ \\begin{aligned} X_{123}+X_{124}+\\cdots+X_{12 n} & =n-2 \\\\ X_{132}+X_{134}+\\cdots+X_{13 n} & =n-2 \\\\ \\left(X_{124}+\\cdots+X_{12 n}\\right)+\\left(X_{134}+\\cdots+X_{13 n}\\right) & =2(n-3) . \\end{aligned} \\] Adding the first two and subtracting the last one gives \\(X_{123}+X_{132}=2\\) \uff0eSimilarly\uff0c \\(X_{123}+X_{321}=2\\) \uff0cand in this way we have \\(X_{321}=X_{132}\\) \uff0eThus \\(W(3,2) W(2,1)= W(1,3) W(3,2)\\) \uff0cand since \\(W(3,2) \\neq 0\\)\uff08clearly\uff09we get \\(W(2,1)=W(3,2)\\) \uff0e Analogously\uff0cfor any distinct \\(a, b, c\\) we have \\(W(a, b)=W(b, c)\\) \uff0eFor \\(n \\geq 4\\) this is enough to imply \\(W(a, b)= \\pm 1\\) for \\(a \\neq b\\) where the choice of sign is the same for all \\(a\\) and \\(b\\) \uff0e Remark\uff0eSurprisingly\uff0cthe \\(n=3\\) case has\uff02extra\uff02solutions for \\(W(1,2)=W(2,3)= W(3,1)= \\pm 1, W(2,1)=W(3,2)=W(1,3)=\\mp 1\\) \uff0e Remark\uff08Intuition\uff09\uff0eIt should still be possible to solve the problem with \\(X_{a b c}\\) in place of \\(W(a, b) W(b, c)\\) \uff0cbecause we have about far more equations than variables \\(X_{a, b, c}\\) so linear algebra assures us we almost certainly have a unique solution\uff0e", "source_pdf": "TST_2016.pdf", "notes": ""}
{"id": "TST-2016-6", "contest": "TST", "year": "2016", "problem_number": "6", "problem": "Let \\(A B C\\) be an acute scalene triangle and let \\(P\\) be a point in its interior\uff0eLet \\(A_{1}, B_{1}\\) \uff0c \\(C_{1}\\) be projections of \\(P\\) onto triangle sides \\(B C, C A, A B\\) \uff0crespectively\uff0eFind the locus of points \\(P\\) such that \\(A A_{1}, B B_{1}, C C_{1}\\) are concurrent and \\(\\angle P A B+\\angle P B C+\\angle P C A= 90^{\\circ}\\) \uff0e", "solution": "In complex numbers with \\(A B C\\) the unit circle\uff0cit is equivalent to solving the following two cubic equations in \\(p\\) and \\(q=\\bar{p}\\) \uff1a \\[ \\begin{aligned} (p-a)(p-b)(p-c) & =(a b c)^{2}(q-1 / a)(q-1 / b)(q-1 / c) \\\\ 0 & =\\prod_{\\mathrm{cyc}}(p+c-b-b c q)+\\prod_{\\mathrm{cyc}}(p+b-c-b c q) \\end{aligned} \\] Viewing this as two cubic curves in \\((p, q) \\in \\mathbb{C}^{2}\\) \uff0cby B\u00e9zout\uff07s Theorem it follows there are at most nine solutions\uff08unless both curves are not irreducible\uff0cbut it\uff07s easy to check the first one cannot be factored\uff09\uff0eMoreover it is easy to name nine solutions\uff08for \\(A B C\\) scalene\uff09\uff1athe three vertices\uff0cthe three excenters\uff0cand \\(I, O, H\\) \uff0eHence the answer is just those three triangle centers \\(I, O\\) and \\(H\\) \uff0e Remark\uff0eOn the other hand it is not easy to solve the cubics by hand\uff1bI tried for an hour without success\uff0eSo I think this solution is only feasible with knowledge of algebraic geometry\uff0e Remark\uff0eThese two cubics have names\uff1a \uff0dThe locus of \\(\\angle P A B+\\angle P B C+\\angle P C A=90^{\\circ}\\) is the McCay cubic\uff0cwhich is the locus of points \\(P\\) for which \\(P, P^{*}, O\\) are collinear\uff0e \uff0dThe locus of the pedal condition is the Darboux cubic\uff0cwhich is the locus of points \\(P\\) for which \\(P, P^{*}, L\\) are collinear\uff0c\\(L\\) denoting the de Longchamps point\uff0e Assuming \\(P \\neq P^{*}\\) \uff0cthis implies \\(P\\) and \\(P^{*}\\) both lie on the Euler line of \\(\\triangle A B C\\) \uff0cwhich is possible only if \\(P=O\\) or \\(P=H\\) \uff0e Some other synthetic solutions are posted at https\uff1a\uff0f\uff0faops\uff0ecom\uff0fcommunity\uff0fc6h1243902p6368189\uff0e", "source_pdf": "TST_2016.pdf", "notes": ""}
{"id": "TST-2017-1", "contest": "TST", "year": "2017", "problem_number": "1", "problem": "In a sports league\uff0ceach team uses a set of at most \\(t\\) signature colors\uff0eA set \\(S\\) of teams is color\uff0didentifiable if one can assign each team in \\(S\\) one of their signature colors\uff0csuch that no team in \\(S\\) is assigned any signature color of a different team in \\(S\\) \uff0eFor all positive integers \\(n\\) and \\(t\\) \uff0cdetermine the maximum integer \\(g(n, t)\\) such that\uff1aIn any sports league with exactly \\(n\\) distinct colors present over all teams\uff0cone can always find a color\uff0didentifiable set of size at least \\(g(n, t)\\) \uff0e", "solution": "Answer\uff1a\\(\\lceil n / t\\rceil\\) \uff0eTo see this is an upper bound\uff0cnote that one can easily construct a sports league with that many teams anyways\uff0e\n\nA quick warning\uff1aRemark\uff08Misreading the problem\uff09\uff0eIt is common to misread the problem by ignoring the word\uff02any\uff02\uff0eHere is an illustration\uff0e\n\nSuppose we have two teams\uff0cMIT and Harvard\uff1bthe colors of MIT are red\uff0fgray\uff0fblack\uff0c and the colors of Harvard are red\uff0fwhite\uff0e\uff08Thus \\(n=4\\) and \\(t=3\\) \uff0e\uff09The assignment of MIT to gray and Harvard to red is not acceptable because red is a signature color of MIT\uff0ceven though not the one assigned\uff0e\n\nWe present two proofs of the lower bound\uff0e\n\nIT Approach by deleting teams\uff08Gopal Goel\uff09\uff0eInitially\uff0cplace all teams in a set \\(S\\) \uff0eThen we repeat the following algorithm\uff1a\n\nIf there is a team all of whose signature colors are shared by some other team in \\(S\\) already\uff0cthen we delete that team\uff0e\uff08If there is more than one such team\uff0cwe pick arbitrarily\uff0e\uff09At the end of the process\uff0call \\(n\\) colors are still present at least once\uff0cso at least \\(\\lceil n / t\\rceil\\) teams remain\uff0eMoreover\uff0csince the algorithm is no longer possible\uff0cthe remaining set \\(S\\) is already color\uff0didentifiable\uff0e\n\nRemark\uff08Gopal Goel\uff09\uff0eIt might seem counter\uff0dintuitive that we are deleting teams from the full set when the original problem is trying to get a large set \\(S\\) \uff0e\n\nThis is less strange when one thinks of it instead as\uff02safely deleting useless teams\uff02\uff0e Basically\uff0cif one deletes such a team\uff0cthe problem statement implies that the task must still be possible\uff0csince \\(g(n, t)\\) does not depend on the number of teams\uff1a\\(n\\) is the number of colors present\uff0cand deleting a useless team does not change this\uff0eIt turns out that this optimization is already enough to solve the problem\uff0e\n\nIT Approach by adding colors\uff0eFor a constructive algorithmic approach\uff0cthe idea is to greedy pick by color\uff08rather than by team\uff09\uff0ctaking at each step the least used color\uff0e Select the color \\(C_{1}\\) with the fewest teams using it\uff0cand a team \\(T_{1}\\) using it\uff0eThen delete all colors \\(T_{1}\\) uses\uff0cand all teams which use \\(C_{1}\\) \uff0eNote that\n\uff0dBy problem condition\uff0cthis deletes at most \\(t\\) teams total\uff0e\n\uff0dAny remaining color \\(C\\) still has at least one user\uff0eIndeed\uff0cif not\uff0cthen \\(C\\) had the same set of teams as \\(C_{1}\\) did\uff08by minimality of \\(C\\) \uff09\uff0cbut then it should have deleted as a color of \\(T_{1}\\) \uff0e\n\nNow repeat this algorithm with \\(C_{2}\\) and \\(T_{2}\\) \uff0cand so on\uff0eThis operations uses at most \\(t\\) colors each time\uff0cso we select at least \\(\\lceil n / t\\rceil\\) colors\uff0e\n\nRemark\uff0eA greedy approach by team does not work\uff0eFor example\uff0csuppose we try to\uff02grab teams until no more can be added\uff02\uff0e\n\nAs before\uff0cassume our league has teams\uff0cMIT and Harvard\uff1bthe colors of MIT are red\uff0fgray\uff0fblack\uff0cand the colors of Harvard are red\uff0fwhite\uff0e\uff08Thus \\(n=4\\) and \\(t=3\\) \uff0e\uff09If we start by selecting MIT and red\uff0cthen it is impossible to select any more teams\uff1bbut \\(g(n, t)=2\\) \uff0e", "source_pdf": "TST_2017.pdf", "notes": ""}
{"id": "TST-2017-2", "contest": "TST", "year": "2017", "problem_number": "2", "problem": "Let \\(A B C\\) be an acute scalene triangle with circumcenter \\(O\\) \uff0cand let \\(T\\) be on line \\(B C\\) such that \\(\\angle T A O=90^{\\circ}\\) \uff0eThe circle with diameter \\(\\overline{A T}\\) intersects the circumcircle of \\(\\triangle B O C\\) at two points \\(A_{1}\\) and \\(A_{2}\\) \uff0cwhere \\(O A_{1}<O A_{2}\\) \uff0ePoints \\(B_{1}, B_{2}, C_{1}, C_{2}\\) are defined analogously\uff0e\uff08a\uff09Prove that \\(\\overline{A A_{1}}, \\overline{B B_{1}}, \\overline{C C_{1}}\\) are concurrent\uff0e\uff08b\uff09Prove that \\(\\overline{A A_{2}}, \\overline{B B_{2}}, \\overline{C C_{2}}\\) are concurrent on the Euler line of triangle \\(A B C\\) \uff0e", "solution": "Let triangle \\(A B C\\) have circumcircle \\(\\Gamma\\) \uff0eLet \\(\\triangle X Y Z\\) be the tangential triangle of \\(\\triangle A B C\\) \uff08hence \\(\\Gamma\\) is the incircle of \\(\\triangle X Y Z\\) \uff09\uff0cand denote by \\(\\Omega\\) its circumcircle\uff0eSuppose the symmedian \\(\\overline{A X}\\) meets \\(\\Gamma\\) again at \\(D\\) \uff0cand let \\(M\\) be the midpoint of \\(\\overline{A D}\\) \uff0eFinally\uff0clet \\(K\\) be the Miquel point of quadrilateral \\(Z B C Y\\) \uff0cmeaning it is the intersection of \\(\\Omega\\) and the circumcircle of \\(\\triangle B O C\\)\uff08other than \\(X\\) \uff09\uff0e\n\nWe first claim that \\(M\\) and \\(K\\) are \\(A_{1}\\) and \\(A_{2}\\) \uff0eIn that case \\(O M<O A<O K\\) \uff0cso \\(M=A_{1}, K=A_{2}\\) \uff0e\n\nTo see that \\(M=A_{1}\\) \uff0cnote that \\(\\angle O M X=90^{\\circ}\\) \uff0cand moreover that \\(\\overline{T A}, \\overline{T D}\\) are tangents to \\(\\Gamma\\) \uff0cwhence we also have \\(M=\\overline{T O} \\cap \\overline{A D}\\) \uff0eThus \\(M\\) lies on both\uff08 \\(B O C\\) \uff09and\uff08 \\(A T\\) \uff09\uff0eThis solves part\uff08a\uff09of the problem\uff1athe concurrency point is the symmedian point of \\(\\triangle A B C\\) \uff0e\n\nNow\uff0cnote that since \\(K\\) is the Miquel point\uff0c\n\\[\n\\frac{Z K}{Y K}=\\frac{Z B}{Y C}=\\frac{Z A}{Y A}\n\\]\nand hence \\(\\overline{K A}\\) is an angle bisector of \\(\\angle Z K Y\\) \uff0eThus from \\((T A ; Y Z)=-1\\) we obtain \\(\\angle T K A=90^{\\circ}\\) \uff0e\n\nIt remains to show \\(\\overline{A K}\\) passes through a fixed point on the Euler line\uff0eWe claim it is the exsimilicenter of \\(\\Gamma\\) and \\(\\Omega\\) \uff0eLet \\(L\\) be the midpoint of the arc \\(Y Z\\) of \\(\\triangle X Y Z\\) not containing \\(X\\) \uff0eThen we know that \\(K, A, L\\) are collinear\uff0eNow the positive homothety sending \\(\\Gamma\\) to \\(\\Omega\\) maps \\(A\\) to \\(L\\) \uff1bthis proves the claim\uff0eFinally\uff0cit is well\uff0dknown that the line through \\(O\\) and the circumcenter of \\(\\triangle X Y Z\\) coincides with the Euler line of \\(\\triangle A B C\\) \uff1b hence done\uff0e\n\nA second approach to\uff08b\uff09presented by many contestants is to take an inversion around the circumcircle of \\(A B C\\) \uff0eIn that situation\uff0cthe part reduces to the following known lemma\uff1aif \\(\\overline{A H_{a}}, \\overline{B H_{b}}, \\overline{C H_{c}}\\) are the altitudes of a triangle\uff0cthen the circumcircles of triangles \\(O A H_{a}, B O H_{b}, C O H_{c}\\) are coaxial\uff0cand the radical axis coincides with the Euler line\uff0eIndeed one simply observes that the orthocenter has equal power to all three circles\uff0e\n\nT Authorship comments\uff0eThis problem was inspired by the fact that \\(K, A, L\\) are collinear in the figure\uff0cwhich was produced by one of my students\uff08Ryan Kim\uff09in a solution to a homework problem\uff0eI realized for example that this implied that line \\(A K\\) passed through the \\(X_{56}\\) point of \\(\\triangle X Y Z\\)\uff08which lies on the Euler line of \\(\\triangle A B C\\) \uff09\uff0e\n\nThis problem was the result of playing around with the resulting very nice picture\uff1aall the power comes from the\uff02magic\uff02point \\(K\\) \uff0e", "source_pdf": "TST_2017.pdf", "notes": ""}
{"id": "TST-2017-3", "contest": "TST", "year": "2017", "problem_number": "3", "problem": "Let \\(P, Q \\in \\mathbb{R}[x]\\) be relatively prime nonconstant polynomials\uff0eShow that there can be at most three real numbers \\(\\lambda\\) such that \\(P+\\lambda Q\\) is the square of a polynomial\uff0e", "solution": "This is true even with \\(\\mathbb{R}\\) replaced by \\(\\mathbb{C}\\) \uff0cand it will be necessary to work in this generality\uff0e\n\nFirst solution using transformations\uff0eWe will prove the claim in the following form\uff1aClaim\uff0dAssume \\(P, Q \\in \\mathbb{C}[x]\\) are relatively prime\uff0eIf \\(\\alpha P+\\beta Q\\) is a square for four different choices of the ratio \\([\\alpha: \\beta]\\) then \\(P\\) and \\(Q\\) must be constant\uff0e\n\nCall pairs\uff08 \\(P, Q\\) \uff09as in the claim bad\uff1bso we wish to show the only bad pairs are pairs of constant polynomials\uff0eAssume not\uff0cand take a bad pair with \\(\\operatorname{deg} P+\\operatorname{deg} Q\\) minimal\uff0e\n\nBy a suitable M\u00f6bius transformation\uff0cwe may transform\uff08 \\(P, Q\\) \uff09so that the four ratios are \\([1: 0],[0: 1],[1:-1]\\) and \\([1:-k]\\) \uff0cso we find there are polynomials \\(A\\) and \\(B\\) such that\n\\[\n\\begin{aligned}\nA^{2}-B^{2} & =C^{2} \\\\\nA^{2}-k B^{2} & =D^{2}\n\\end{aligned}\n\\]\nwhere \\(A^{2}=P+\\lambda_{1} Q, B^{2}=P+\\lambda_{2} Q\\) \uff0csay\uff0eOf course \\(\\operatorname{gcd}(A, B)=1\\) \uff0eConsequently\uff0cwe have \\(C^{2}=(A+B)(A-B)\\) and \\(D^{2}=(A+\\mu B)(A-\\mu B)\\) where \\(\\mu^{2}=k\\) \uff0eNow \\(\\operatorname{gcd}(A, B)=1\\) \uff0cso \\(A+B, A-B, A+\\mu B\\) and \\(A-\\mu B\\) are squares\uff1bid est \uff08 \\(A, B\\) \uff09is bad\uff0eThis is a contradiction\uff0csince \\(\\operatorname{deg} A+\\operatorname{deg} B<\\operatorname{deg} P+\\operatorname{deg} Q\\) \uff0e\n\nI Second solution using derivatives\uff08by Zack Chroman\uff09\uff0eWe will assume without loss of generality that \\(\\operatorname{deg} P \\neq \\operatorname{deg} Q\\) \uff1bif not\uff0cthen one can replace\uff08 \\(P, Q\\) \uff09with\uff08 \\(P+c Q, Q\\) \uff09 for a suitable constant \\(c\\) \uff0e\n\nThen\uff0cthere exist \\(\\lambda_{i} \\in \\mathbb{C}\\) and polynomials \\(R_{i}\\) for \\(i=1,2,3,4\\) such that\n\\[\n\\begin{aligned}\n& P+\\lambda_{i} Q=R_{i}^{2} \\\\\n\\Longrightarrow & P^{\\prime}+\\lambda_{i} Q^{\\prime}=2 R_{i} R_{i}^{\\prime} \\\\\n& \\Longrightarrow R_{i} \\mid Q^{\\prime}\\left(P+\\lambda_{i} Q\\right)-Q\\left(P^{\\prime}+\\lambda_{i} Q^{\\prime}\\right)=Q^{\\prime} P-Q P^{\\prime}\n\\end{aligned}\n\\]\n\nOn the other hand by Euclidean algorithm it follows that \\(R_{i}\\) are relatively prime to each other\uff0eTherefore\n\\[\nR_{1} R_{2} R_{3} R_{4} \\mid Q^{\\prime} P-Q P^{\\prime} .\n\\]\n\nHowever\uff0cwe have\n\\[\n\\begin{aligned}\n\\sum_{1}^{4} \\operatorname{deg} R_{i} & \\geq \\frac{3 \\max (\\operatorname{deg} P, \\operatorname{deg} Q)+\\min (\\operatorname{deg} P, \\operatorname{deg} Q)}{2} \\\\\n& \\geq \\operatorname{deg} P+\\operatorname{deg} Q>\\operatorname{deg}\\left(Q^{\\prime} P-Q P^{\\prime}\\right)\n\\end{aligned}\n\\]\n\nThis can only occur if \\(Q^{\\prime} P-Q P^{\\prime}=0\\) or \\((P / Q)^{\\prime}=0\\) by the quotient rule\uff01But \\(P / Q\\) can\uff07t be constant\uff0cthe end\uff0e", "source_pdf": "TST_2017.pdf", "notes": ""}
{"id": "TST-2017-4", "contest": "TST", "year": "2017", "problem_number": "4", "problem": "You are cheating at a trivia contest\uff0eFor each question\uff0cyou can peek at each of the \\(n>1\\) other contestant\uff07s guesses before writing your own\uff0eFor each question\uff0cafter all guesses are submitted\uff0cthe emcee announces the correct answer\uff0eA correct guess is worth 0 points\uff0eAn incorrect guess is worth -2 points for other contestants\uff0cbut only -1 point for you\uff0cbecause you hacked the scoring system\uff0eAfter announcing the correct answer\uff0cthe emcee proceeds to read out the next question\uff0eShow that if you are leading by \\(2^{n-1}\\) points at any time\uff0cthen you can surely win first place\uff0e", "solution": "We will prove the result with \\(2^{n-1}\\) replaced even by \\(2^{n-2}+1\\) \uff0eWe first make the following reductions\uff0eFirst\uff0cchange the weights to be \\(+1,-1,0\\) respectively\uff08rather than \\(0,-2,-1\\) \uff09\uff1bthis clearly has no effect\uff0eAlso\uff0cWLOG that all contestants except you initially have score zero\uff08and that your score exceeds \\(2^{n-2}\\) \uff09\uff0e WLOG ignore rounds in which all answers are the same\uff0eFinally\uff0cignore rounds in which you get the correct answer\uff0csince that leaves you at least as well off as before\uff0din other words\uff0cwe\uff07ll assume your score is always fixed\uff0cbut you can pick any group of people with the same answers and ensure they lose 1 point\uff0cwhile some other group gains 1 point\uff0e\n\nThe key observation is the following\uff0eConsider two rounds \\(R_{1}\\) and \\(R_{2}\\) such that\uff1a\uff0dIn round \\(R_{1}\\) \uff0csome set \\(S\\) of contestants gains a point\uff0e\uff0dIn round \\(R_{2}\\) \uff0cthe set \\(S\\) of contestants all have the same answer\uff0eThen\uff0cif we copy the answers of contestants in \\(S\\) during \\(R_{2}\\) \uff0cthen the sum of the scorings in \\(R_{1}\\) and \\(R_{2}\\) cancel each other out\uff0eIn other words we can then ignore \\(R_{1}\\) and \\(R_{2}\\) forever\uff0e\n\nWe thus consider the following strategy\uff0eWe keep a list \\(\\mathcal{L}\\) of subsets of \\(\\{1, \\ldots, n\\}\\) \uff0c initially empty\uff0eNow do the following strategy\uff1a\uff0dOn a round\uff0csuppose there exists a set \\(S\\) of people with the same answer such that \\(S \\in \\mathcal{L}\\) \uff0e\uff08If multiple exist\uff0cchoose one arbitrarily\uff0e\uff09Then\uff0ccopy the answer of \\(S\\) \uff0c causing them to lose a point\uff0eDelete \\(S\\) from \\(\\mathcal{L}\\) \uff0e\uff08Importantly\uff0cwe do not add any new sets to \\(\\mathcal{L}\\) \uff0e\uff09\uff0dOtherwise\uff0ccopy any set \\(T\\) of contestants\uff0cselecting \\(|T| \\geq n / 2\\) if possible\uff0eLet \\(S\\) be the set of contestants who answer correctly\uff08if any\uff09\uff0cand add \\(S\\) to the list \\(\\mathcal{L}\\) \uff0eNote that \\(|S| \\leq n / 2\\) \uff0csince \\(S\\) is disjoint from \\(T\\) \uff0e\n\nBy construction\uff0c \\(\\mathcal{L}\\) has no duplicate sets\uff0eSo the score of any contestant \\(c\\) is bounded above by the number of times that \\(c\\) appears among sets in \\(\\mathcal{L}\\) \uff0eThe number of such sets is clearly at most \\(\\frac{1}{2} \\cdot 2^{n-1}\\) \uff0eSo\uff0cif you lead by \\(2^{n-2}+1\\) then you ensure victory\uff0eThis completes the proof\uff01\n\nRemark\uff0eSeveral remarks are in order\uff0eFirst\uff0cwe comment on the bound \\(2^{n-2}+1\\) itself\uff0e The most natural solution using only the list idea gives an upper bound of \\(\\left(2^{n}-2\\right)+1\\) \uff0cwhich is the number of nonempty proper subsets of \\(\\{1, \\ldots, n\\}\\) \uff0eThen\uff0cthere are two optimizations one can observe\uff1a\uff0dIn fact we can improve to the number of times any particular contestant \\(c\\) appears in some set\uff0crather than the total number of sets\uff0e\uff0dWhen adding new sets \\(S\\) to \\(\\mathcal{L}\\) \uff0cone can ensure \\(|S| \\leq n / 2\\) \uff0eEither observation alone improves the bound from \\(2^{n}-1\\) to \\(2^{n-1}\\) \uff0cbut both together give the bound \\(2^{n-2}+1\\) \uff0eAdditionally\uff0cwhen \\(n\\) is odd the calculation of subsets actually gives \\(2^{n-2}-\\frac{1}{2}\\binom{n-1}{\\frac{n-1}{2}}+1\\) \uff0eThis gives the best possible value at both \\(n=2\\) and \\(n=3\\) \uff0eIt seems likely some further improvements are possible\uff0cand the true bound is suspected to be polynomial in \\(n\\) \uff0e\n\nSecondly\uff0cthe solution is highly motivated by considering a true\uff0ffalse contest in which only two distinct answers are given per question\uff0eHowever\uff0ca natural mistake\uff08which graders assessed as a two\uff0dpoint deduction\uff09is to try and prove that in fact one can\uff02WLOG\uff02we are in the two\uff0dquestion case\uff0eThe proof of this requires substantially more care than expected\uff0e For instance\uff0cset \\(n=3\\) \uff0eIf \\(\\mathcal{L}=\\{\\{1\\},\\{2\\},\\{3\\}\\}\\) then it becomes impossible to prevent a duplicate set from appearing in \\(\\mathcal{L}\\) if all contestants give distinct answers\uff0eOne might attempt to fix this by instead adding to \\(\\mathcal{L}\\) the complement of the set \\(T\\) described above\uff0eThe example \\(\\mathcal{L}=\\{\\{1,2\\},\\{2,3\\},\\{3,1\\}\\}\\)\uff08followed again by a round with all distinct answers\uff09shows that this proposed fix does not work either\uff0eThis issue affects all variations of the above approach\uff0e\n\nBecause the USA TST did not have any solution\uff0dwriting process at this time\uff0cthis issue was not noticed until January 15 \uff08less than a week before the exam\uff09\uff0eWhen it was brought up by email by Evan\uff0cevery organizer who had testsolved the problem had apparently made the same error\uff0e\n\nRemark\uff0eHere are some motivations for the solution\uff1a1\uff0eThe exponential bound \\(2^{n}\\) suggests looking at subsets\uff0e2\uff0eThe \\(n=2\\) case suggests the idea of\uff02repeated rounds\uff02\uff0e\uff08I think this \\(n=2\\) case is actually really good\uff0e\uff09\n\n3\uff0eThe\uff02two distinct answers\uff02case suggests looking at rounds as partitions\uff08even though the WLOG does not work\uff0cat least not without further thought\uff09\uff0e4\uff0eThere\uff07s something weird about this problem\uff1ait\uff07s a finite bound over unbounded time\uff0e This is a hint to not worry excessively about the actual scores\uff0cwhich turn out to be almost irrelevant\uff0e", "source_pdf": "TST_2017.pdf", "notes": ""}
{"id": "TST-2017-5", "contest": "TST", "year": "2017", "problem_number": "5", "problem": "Let \\(A B C\\) be a triangle with altitude \\(\\overline{A E}\\) \uff0eThe \\(A\\)\uff0dexcircle touches \\(\\overline{B C}\\) at \\(D\\) \uff0cand intersects the circumcircle at two points \\(F\\) and \\(G\\) \uff0eProve that one can select points \\(V\\) and \\(N\\) on lines \\(D G\\) and \\(D F\\) such that quadrilateral \\(E V A N\\) is a rhombus\uff0e", "solution": "Let \\(I\\) denote the incenter\uff0c\\(J\\) the \\(A\\)\uff0dexcenter\uff0cand \\(L\\) the midpoint of \\(\\overline{A E}\\) \uff0eDenote by \\(\\overline{I Y}\\) \uff0c \\(\\overline{I Z}\\) the tangents from \\(I\\) to the \\(A\\)\uff0dexcircle\uff0eNote that lines \\(\\overline{B C}, \\overline{G F}, \\overline{Y Z}\\) then concur at \\(H\\)\uff08unless \\(A B=A C\\) \uff0cbut this case is obvious\uff09\uff0cas it\uff07s the radical center of cyclic hexagon \\(B I C Y J Z\\) \uff0cthe circumcircle and the \\(A\\)\uff0dexcircle\uff0e\n\nNow let \\(\\overline{H D}\\) and \\(\\overline{H T}\\) be the tangents from \\(H\\) to the \\(A\\)\uff0dexcircle\uff0eIt follows that \\(\\overline{D T}\\) is the symmedian of \\(\\triangle D Z Y\\) \uff0chence passes through \\(I=\\overline{Y Y} \\cap \\overline{Z Z}\\) \uff0eMoreover\uff0cit\uff07s well known that \\(\\overline{D I}\\) passes through \\(L\\) \uff0cthe midpoint of the \\(A\\)\uff0daltitude\uff08for example by homothety\uff09\uff0e Finally\uff0c\\((D T ; F G)=-1\\) \uff0chence project through \\(D\\) onto the line through \\(L\\) parallel to \\(\\overline{B C}\\) to obtain \\((\\infty L ; V N)=-1\\) as desired\uff0e\n\nII Authorship comments\uff0eThis is a joint proposal with Danielle Wang\uff08mostly by her\uff09\uff0e The formulation given was that the tangents to the \\(A\\)\uff0dexcircle at \\(F\\) and \\(G\\) was on line \\(\\overline{D I}\\) \uff1bI solved this formulation using the radical axis argument above\uff0eI then got the idea to involve the point \\(L\\) \uff0calready knowing it was on \\(\\overline{D I}\\) \uff0eObserving the harmonic quadrilateral\uff0cI took perspectivity through \\(M\\) onto the line through \\(L\\) parallel to \\(\\overline{B C}\\) \uff08before this I had tried to use the \\(A\\)\uff0daltitude with little luck\uff09\uff0eThis yields the rhombus in the problem\uff0e", "source_pdf": "TST_2017.pdf", "notes": ""}
{"id": "TST-2017-6", "contest": "TST", "year": "2017", "problem_number": "6", "problem": "Prove that there are infinitely many triples \\((a, b, p)\\) of integers\uff0cwith \\(p\\) prime and \\(0<a \\leq b<p\\) \uff0cfor which \\(p^{5}\\) divides \\((a+b)^{p}-a^{p}-b^{p}\\) \uff0e", "solution": "The key claim is that if \\(p \\equiv 1(\\bmod 3)\\) \uff0cthen\n\\[\np\\left(x^{2}+x y+y^{2}\\right)^{2} \\text { divides }(x+y)^{p}-x^{p}-y^{p}\n\\]\nas polynomials in \\(x\\) and \\(y\\) \uff0eSince it\uff07s known that one can select \\(a\\) and \\(b\\) such that \\(p^{2} \\mid a^{2}+a b+b^{2}\\) \uff0cthe conclusion follows\uff0e\uff08The theory of quadratic forms tells us we can do it with \\(p^{2}=a^{2}+a b+b^{2}\\) \uff1bThue\uff07s lemma lets us do it by solving \\(x^{2}+x+1 \\equiv 0\\left(\\bmod p^{2}\\right)\\) \uff0e\uff09\n\nTo prove this\uff0cit is the same to show that\n\\[\n\\left(x^{2}+x+1\\right)^{2} \\text { divides } F(x):=(x+1)^{p}-x^{p}-1 .\n\\]\nsince the binomial coefficients \\(\\binom{p}{k}\\) are clearly divisible by \\(p\\) \uff0eLet \\(\\zeta\\) be a third root of unity\uff0e Then \\(F(\\zeta)=(1+\\zeta)^{p}-\\zeta^{p}-1=-\\zeta^{2}-\\zeta-1=0\\) \uff0eMoreover\uff0c\\(F^{\\prime}(x)=p(x+1)^{p-1}-p x^{p-1}\\) \uff0c so \\(F^{\\prime}(\\zeta)=p-p=0\\) \uff0eHence \\(\\zeta\\) is a double root of \\(F\\) as needed\uff0e\uff08Incidentally\uff0c\\(p=2017\\) works\uff01\uff09\nRemark\uff0eOne possible motivation for this solution is the case \\(p=7\\) \uff0eIt is nontrivial even to prove that \\(p^{2}\\) can divide the expression if we exclude the situation \\(a+b=p\\)\uff08which provably never achieves \\(p^{3}\\) \uff09\uff0eAs \\(p=3,5\\) fails considering the \\(p=7\\) polynomial gives\n\\[\n(x+1)^{7}-x^{7}-1=7 x(x+1)\\left(x^{4}+2 x^{3}+3 x^{2}+2 x+1\\right)\n\\]\n\nThe key is now to notice that the last factor is \\(\\left(x^{2}+x+1\\right)^{2}\\) \uff0cwhich suggests the entire solution\uff0e\n\nIn fact\uff0ceven if \\(p \\equiv 2(\\bmod 3)\\) \uff0cthe polynomial \\(x^{2}+x+1\\) still divides \\((x+1)^{p}-x^{p}-1\\) \uff0e So even the \\(p=5\\) case can motivate the main idea\uff0e", "source_pdf": "TST_2017.pdf", "notes": ""}
{"id": "TST-2018-1", "contest": "TST", "year": "2018", "problem_number": "1", "problem": "Let \\(n \\geq 2\\) be a positive integer\uff0cand let \\(\\sigma(n)\\) denote the sum of the positive divisors of \\(n\\) \uff0eProve that the \\(n^{\\text {th }}\\) smallest positive integer relatively prime to \\(n\\) is at least \\(\\sigma(n)\\) \uff0cand determine for which \\(n\\) equality holds\uff0e", "solution": "The equality case is \\(n=p^{e}\\) for \\(p\\) prime and a positive integer \\(e\\) \uff0eIt is easy to check that this works\uff0e\n\nFirst solution\uff0eIn what follows\uff0cby \\([a, b]\\) we mean \\(\\{a, a+1, \\ldots, b\\}\\) \uff0eFirst\uff0cwe make the following easy observation\uff0e\n\nClaim\uff0dIf \\(a\\) and \\(d\\) are positive integers\uff0cthen precisely \\(\\varphi(d)\\) elements of \\([a, a+d-1]\\) are relatively prime to \\(d\\) \uff0e\n\nLet \\(d_{1}, d_{2}, \\ldots, d_{k}\\) denote denote the divisors of \\(n\\) in some order\uff0eConsider the intervals\n\\[\n\\begin{aligned}\nI_{1} & =\\left[1, d_{1}\\right] \\\\\nI_{2} & =\\left[d_{1}+1, d_{1}+d_{2}\\right] \\\\\n& \\vdots \\\\\nI_{k} & =\\left[d_{1}+\\cdots+d_{k-1}+1, d_{1}+\\cdots+d_{k}\\right]\n\\end{aligned}\n\\]\nof length \\(d_{1}, \\ldots, d_{k}\\) respectively\uff0eThe \\(j\\) th interval will have exactly \\(\\varphi\\left(d_{j}\\right)\\) elements which are relatively prime \\(d_{j}\\) \uff0chence at most \\(\\varphi\\left(d_{j}\\right)\\) which are relatively prime to \\(n\\) \uff0eConsequently\uff0c in \\(I=\\bigcup_{j=1}^{k} I_{k}\\) there are at most\n\\[\n\\sum_{j=1}^{k} \\varphi\\left(d_{j}\\right)=\\sum_{d \\mid n} \\varphi(d)=n\n\\]\nintegers relatively prime to \\(n\\) \uff0eOn the other hand \\(I=[1, \\sigma(n)]\\) so this implies the inequality\uff0e\n\nWe see that the equality holds for \\(n=p^{e}\\) \uff0eAssume now \\(p<q\\) are distinct primes dividing \\(n\\) \uff0eReorder the divisors \\(d_{i}\\) so that \\(d_{1}=q\\) \uff0eThen \\(p, q \\in I_{1}\\) \uff0cand so \\(I_{1}\\) should contain strictly fewer than \\(\\varphi\\left(d_{1}\\right)=q-1\\) elements relatively prime to \\(n\\) \uff0chence the inequality is strict\uff0e\n\nSecond solution\uff08Ivan Borsenco and Evan Chen\uff09\uff0eLet \\(n=p_{1}^{e_{1}} \\ldots p_{k}^{e_{k}}\\) \uff0cwhere \\(p_{1}<p_{2}<\\ldots\\) \uff0eWe are going to assume \\(k \\geq 2\\) \uff0csince the \\(k=1\\) case was resolved in the very beginning\uff0cand prove the strict inequality\uff0e\n\nFor a general \\(N\\) \uff0cthe number of relatively prime integers in \\([1, N]\\) is given exactly by\n\\[\nf(N)=N-\\sum_{i}\\left\\lfloor\\frac{N}{p_{i}}\\right\\rfloor+\\sum_{i<j}\\left\\lfloor\\frac{N}{p_{i} p_{j}}\\right\\rfloor-\\ldots\n\\]\naccording to the inclusion\uff0dexclusion principle\uff0eSo\uff0cwe wish to show that \\(f(\\sigma(n))<n\\)\uff08as \\(k \\geq 2\\) \uff09\uff0eDiscarding the error terms from the floors\uff08noting that we get at most 1 from the negative floors\uff09gives\n\\[\n\\begin{aligned}\nf(N) & <2^{k-1}+N-\\sum_{i} \\frac{N}{p_{i}}+\\sum_{i<j} \\frac{N}{p_{i} p_{j}}-\\cdots \\\\\n& =2^{k-1}+N \\prod_{i}\\left(1-p_{i}^{-1}\\right) \\\\\n& =2^{k-1}+\\prod_{i}\\left(1-p_{i}^{-1}\\right)\\left(1+p_{i}+p_{i}^{2}+\\cdots+p_{i}^{e_{i}}\\right) \\\\\n& =2^{k-1}+\\prod_{i}\\left(p_{i}^{e_{i}}-p_{i}^{-1}\\right)\n\\end{aligned}\n\\]\n\nThe proof is now divided into two cases\uff0eIf \\(k=2\\) we have\n\\[\n\\begin{aligned}\nf(N) & <2+\\left(p_{1}^{e_{1}}-p_{1}^{-1}\\right)\\left(p_{2}^{e_{2}}-p_{2}^{-1}\\right) \\\\\n& =2+n-\\frac{p_{2}^{e_{2}}}{p_{1}}-\\frac{p_{1}^{e_{1}}}{p_{2}}+\\frac{1}{p_{1} p_{2}} \\\\\n& \\leq 2+n-\\frac{p_{2}}{p_{1}}-\\frac{p_{1}}{p_{2}}+\\frac{1}{p_{1} p_{2}} \\\\\n& =n+\\frac{1-\\left(p_{1}-p_{2}\\right)^{2}}{p_{1} p_{2}} \\leq n\n\\end{aligned}\n\\]\n\nOn the other hand if \\(k \\geq 3\\) we may now write\n\\[\n\\begin{aligned}\nf(N) & <2^{k-1}+\\left[\\prod_{i=2}^{k-1}\\left(p_{i}^{e_{i}}\\right)\\right]\\left(p_{1}^{e_{1}}-p_{1}^{-1}\\right) \\\\\n& =2^{k-1}+n-\\frac{p_{2}^{e_{2}} \\cdots p_{k}^{e_{k}}}{p_{1}} \\\\\n& \\leq 2^{k-1}+n-\\frac{p_{2} p_{3} \\cdots p_{k}}{p_{1}}\n\\end{aligned}\n\\]\n\nIf \\(p_{1}=2\\) \uff0cthen one can show by induction that \\(p_{2} p_{3} \\ldots p_{k} \\geq 2^{k+1}-1\\) \uff0cwhich implies the result\uff0eIf \\(p_{1}>2\\) \uff0cthen one can again show by induction \\(p_{3} \\ldots p_{k} \\geq 2^{k}-1\\left(\\right.\\) since \\(\\left.p_{3} \\geq 7\\right)\\) \uff0c which also implies the result\uff0e", "source_pdf": "TST_2018.pdf", "notes": ""}
{"id": "TST-2018-2", "contest": "TST", "year": "2018", "problem_number": "2", "problem": "Find all functions \\(f: \\mathbb{Z}^{2} \\rightarrow[0,1]\\) such that for any integers \\(x\\) and \\(y\\) \uff0c\n\\[\nf(x, y)=\\frac{f(x-1, y)+f(x, y-1)}{2} .\n\\]", "solution": "We claim that the only functions \\(f\\) are constant functions\uff0e\uff08It is easy to see that they work\uff0e\uff09\n\nFirst solution\uff08hands\uff0don\uff09\uff0eFirst\uff0citerating the functional equation relation to the \\(n\\)th level shows that\n\\[\nf(x, y)=\\frac{1}{2^{n}} \\sum_{i=0}^{n}\\binom{n}{i} f(x-i, y-(n-i)) .\n\\]\n\nIn particular\uff0c\n\\[\n\\begin{aligned}\n|f(x, y)-f(x-1, y+1)| & =\\frac{1}{2^{n}}\\left|\\sum_{i=0}^{n+1} f(x-i, y-(n-i)) \\cdot\\left(\\binom{n}{i}-\\binom{n}{i-1}\\right)\\right| \\\\\n& \\leq \\frac{1}{2^{n}} \\sum_{i=0}^{n+1}\\left|\\binom{n}{i}-\\binom{n}{i-1}\\right| \\\\\n& =\\frac{1}{2^{n}} \\cdot 2\\binom{n}{\\lfloor n / 2\\rfloor}\n\\end{aligned}\n\\]\nwhere we define \\(\\binom{n}{n+1}=\\binom{n}{-1}=0\\) for convenience\uff0eSince\n\\[\n\\binom{n}{\\lfloor n / 2\\rfloor}=o\\left(2^{n}\\right)\n\\]\nit follows that \\(f\\) must be constant\uff0e\nRemark\uff0eA very similar proof extends to \\(d\\) dimensions\uff0e\n\nIT Second solution\uff08random walks\uff0cMark Sellke\uff09\uff0eWe show that if \\(x+y=x^{\\prime}+y^{\\prime}\\) then \\(f(x, y)=f\\left(x^{\\prime}, y^{\\prime}\\right)\\) \uff0eLet \\(Z_{n}, Z_{n}^{\\prime}\\) be random walks starting at\uff08 \\(x, y\\) \uff09and\uff08 \\(x^{\\prime}, y^{\\prime}\\) \uff09and moving down\uff0fleft\uff0eThen \\(f\\left(Z_{n}\\right)\\) is a martingale so we have\n\\[\n\\mathbb{E}\\left[f\\left(Z_{n}\\right)\\right]=f(x, y), \\quad \\mathbb{E}\\left[f\\left(Z_{n}^{\\prime}\\right)\\right]=f\\left(x^{\\prime}, y^{\\prime}\\right) .\n\\]\n\nWe\uff07ll take \\(Z_{n}, Z_{n}^{\\prime}\\) to be independent until they hit each other\uff0cafter which they will stay together\uff0eThen\n\\[\n\\left|\\mathbb{E}\\left[f\\left(Z_{n}\\right)-f\\left(Z_{n}^{\\prime}\\right)\\right]\\right| \\leq \\mathbb{E}\\left[\\left|f\\left(Z_{n}\\right)-f\\left(Z_{n}^{\\prime}\\right)\\right|\\right] \\leq p_{n}\n\\]\nwhere \\(p_{n}\\) is the probability that \\(Z_{n}, Z_{n}^{\\prime}\\) never collide\uff0eBut the distance between \\(Z_{n}, Z_{n}^{\\prime}\\) is essentially a 1 \uff0ddimensional random walk\uff0cso they will collide with probability 1 \uff0cmeaning \\(\\lim _{n \\rightarrow \\infty} p_{n}=0\\) \uff0eHence\n\\[\n\\left|f(x, y)-f\\left(x^{\\prime}, y^{\\prime}\\right)\\right|=\\left|\\mathbb{E}\\left[f\\left(Z_{n}\\right)-f\\left(Z_{n}^{\\prime}\\right)\\right]\\right|=o(1)\n\\]\nas desired\uff0e\n\nRemark\uff0eIf the problem were in \\(\\mathbb{Z}^{d}\\) for large \\(d\\) \uff0cthis solution wouldn\uff07t work as written because the independent random walks wouldn\uff07t hit each other\uff0eHowever\uff0cthis isn\uff07t a serious problem because \\(Z_{n}, Z_{n}^{\\prime}\\) don\uff07t have to be independent before hitting each other\uff0e Indeed\uff0cif every time \\(Z_{n}, Z_{n}^{\\prime}\\) agree on a new coordinate we force them to agree on that coordinate forever\uff0cwe can make the two walks individually have the distribution of a coordinate\uff0ddecreasing random walk but make them intersect eventually with probability 1. The difference in each coordinate will be a 1 \uff0ddimensional random walk which gets stuck at 0 \uff0e\n\nThird solution\uff08martingales\uff09\uff0eImagine starting at\uff08 \\(x, y\\) \uff09and taking a random walk down and to the left\uff0eThis is a martingale\uff0eAs \\(f\\) is bounded\uff0cthis martingale converges with probability 1 \uff0eLet \\(X_{1}, X_{2}, \\ldots\\) each be random variables that represent either down moves or left moves with equal probability\uff0eNote that by the Hewitt\uff0dSavage 0\uff0d1 law\uff0cwe have that for any real numbers \\(a<b\\) \uff0c\n\\[\n\\operatorname{Pr}\\left[\\lim _{n \\rightarrow \\infty} f\\left((x, y)+X_{1}+X_{2}+\\cdots+X_{n}\\right) \\in[a, b]\\right] \\in\\{0,1\\}\n\\]\n\nHence\uff0cthere exists a single value \\(v\\) such that with probability 1 \uff0c\n\\[\n\\operatorname{Pr}\\left[\\lim _{n \\rightarrow \\infty} f\\left((x, y)+X_{1}+X_{2}+\\cdots+X_{n}\\right)=v\\right]=1\n\\]\n\nObviously\uff0cthis value \\(v\\) must equal \\(f(x, y)\\) \uff0eNow\uff0cwe show this value \\(v\\) is the same for all \\((x, y)\\) \uff0eNote that any two starting points have a positive chance of meeting\uff0eTherefore\uff0c we are done\uff0e", "source_pdf": "TST_2018.pdf", "notes": ""}
{"id": "TST-2018-3", "contest": "TST", "year": "2018", "problem_number": "3", "problem": "At a university dinner\uff0cthere are 2017 mathematicians who each order two distinct entr\u00e9es\uff0cwith no two mathematicians ordering the same pair of entr\u00e9es\uff0eThe cost of each entr\u00e9e is equal to the number of mathematicians who ordered it\uff0cand the university pays for each mathematician\uff07s less expensive entr\u00e9e\uff08ties broken arbitrarily\uff09\uff0eOver all possible sets of orders\uff0cwhat is the maximum total amount the university could have paid\uff1f", "solution": "In graph theoretic terms\uff1awe wish to determine the maximum possible value of\n\\[\nS(G):=\\sum_{e=v w} \\min (\\operatorname{deg} v, \\operatorname{deg} w)\n\\]\nacross all graphs \\(G\\) with 2017 edges\uff0eFor each edge \\(e=v w\\) \uff0cwe refer to \\(\\min (\\operatorname{deg} v, \\operatorname{deg} w)\\) as the label\uff0e\n\nWe claim the answer is \\(63 \\cdot\\binom{64}{2}+1=127009\\) \uff0e\nIT First solution\uff08combinatorial\uff0cEvan Chen\uff09\uff0eFirst define \\(L_{k}\\) to consist of a clique on \\(k\\) vertices\uff0cplus a single vertex connected to exactly one vertex of the clique\uff0eHence \\(L_{k}\\) has \\(k+1\\) vertices\uff0c\\(\\binom{k}{2}+1\\) edges\uff0cand \\(S\\left(L_{k}\\right)=(k-1)\\binom{k}{2}+1\\) \uff0eIn particular\uff0c\\(L_{64}\\) achieves the claimed maximum\uff0cso it suffices to prove the upper bound\uff0e\n\n\\section*{Lemma}\n\nLet \\(G\\) be a graph such that either\n\uff0d\\(G\\) has \\(\\binom{k}{2}\\) edges for some \\(k \\geq 3\\) or\n\uff0d\\(G\\) has \\(\\binom{k}{2}+1\\) edges for some \\(k \\geq 4\\) \uff0e\nThen there exists a graph \\(G^{*}\\) with the same number of edges such that \\(S\\left(G^{*}\\right) \\geq S(G)\\) \uff0c and moreover \\(G^{*}\\) has a universal vertex\uff08i\uff0ee\uff0ea vertex adjacent to every other vertex\uff09\uff0e\n\nProof\uff0eFix \\(k\\) and the number \\(m\\) of edges\uff0eWe prove the result by induction on the number \\(n\\) of vertices in \\(G\\) \uff0eSince the lemma has two parts\uff0cwe will need two different base cases\uff1a\n\n1\uff0eSuppose \\(n=k\\) and \\(m=\\binom{k}{2}\\) \uff0eThen \\(G\\) must be a clique so pick \\(G^{*}=G\\) \uff0e\n2\uff0eSuppose \\(n=k+1\\) and \\(m=\\binom{k}{2}+1\\) \uff0eIf \\(G\\) has no universal vertex\uff0cwe claim we may take \\(G^{*}=L_{k}\\) \uff0eIndeed each vertex of \\(G\\) has degree at most \\(k-1\\) \uff0cand the average degree is\n\\[\n\\frac{2 m}{n}=\\frac{k^{2}-k+2}{k+1}<k-1\n\\]\nusing here \\(k \\geq 4\\) \uff0eThus there exists a vertex \\(w\\) of degree \\(1 \\leq d \\leq k-2\\) \uff0eThe edges touching \\(w\\) will have label at most \\(d\\) and hence\n\\[\nS(G) \\leq(k-1)(m-d)+d^{2}=(k-1) m-d(k-1-d)\n\\]\n\\[\n\\leq(k-1) m-(k-2)=(k-1)\\binom{k}{2}+1=S\\left(G^{*}\\right) .\n\\]\n\nNow we settle the inductive step\uff0eLet \\(w\\) be a vertex with minimal degree \\(0 \\leq d<k-1\\) \uff0c with neighbors \\(w_{1}, \\ldots, w_{d}\\) \uff0eBy our assumption\uff0cfor each \\(w_{i}\\) there exists a vertex \\(v_{i}\\) for which \\(v_{i} w_{i} \\notin E\\) \uff0eNow\uff0cwe may delete all edges \\(w w_{i}\\) and in their place put \\(v_{i} w_{i}\\) \uff0cand then delete the vertex \\(w\\) \uff0eThis gives a graph \\(G^{\\prime}\\) \uff0cpossibly with multiple edges\uff08if \\(v_{i}=w_{j}\\) and \\(w_{j}=v_{i}\\) \uff09\uff0cand with one fewer vertex\uff0e\n![](https://cdn.mathpix.com/cropped/2025_08_23_681e760f1de313d58731g-08.jpg?height=292&width=821&top_left_y=662&top_left_x=622)\n\nWe then construct a graph \\(G^{\\prime \\prime}\\) by taking any pair of double edges\uff0cdeleting one of them\uff0cand adding any missing edge of \\(G^{\\prime \\prime}\\) in its place\uff0e\uff08This is always possible\uff0csince when \\(m=\\binom{k}{2}\\) we have \\(n-1 \\geq k\\) and when \\(m=\\binom{k}{2}+1\\) we have \\(n-1 \\geq k+1\\) \uff0e\uff09\n\nThus we have arrived at a simple graph \\(G^{\\prime \\prime}\\) with one fewer vertex\uff0eWe also observe that we have \\(S\\left(G^{\\prime \\prime}\\right) \\geq S(G)\\) \uff1bafter all every vertex in \\(G^{\\prime \\prime}\\) has degree at least as large as it did in \\(G\\) \uff0cand the \\(d\\) edges we deleted have been replaced with new edges which will have labels at least \\(d\\) \uff0eHence we may apply the inductive hypothesis to the graph \\(G^{\\prime \\prime}\\) to obtain \\(G^{*}\\) with \\(S\\left(G^{*}\\right) \\geq S\\left(G^{\\prime \\prime}\\right) \\geq S(G)\\) \uff0e\n\nThe problem then is completed once we prove the following\uff1a\nClaim\uff0dFor any graph \\(G\\) \uff0c\n\uff0dIf \\(G\\) has \\(\\binom{k}{2}\\) edges for \\(k \\geq 3\\) \uff0cthen \\(S(G) \\leq\\binom{ k}{2} \\cdot(k-1)\\) \uff0e\n\uff0dIf \\(G\\) has \\(\\binom{k}{2}+1\\) edges for \\(k \\geq 4\\) \uff0cthen \\(S(G) \\leq\\binom{ k}{2} \\cdot(k-1)+1\\) \uff0e\n\nProof\uff0eWe prove both parts at once by induction on \\(k\\) \uff0cwith the base case \\(k=3\\) being plain\uff08there is nothing to prove in the second part for \\(k=3\\) \uff09\uff0eThus assume \\(k \\geq 4\\) \uff0eBy the earlier lemma\uff0cwe may assume \\(G\\) has a universal vertex \\(v\\) \uff0eFor notational convenience\uff0c we say \\(G\\) has \\(\\binom{k}{2}+\\varepsilon\\) edges for \\(\\varepsilon \\in\\{0,1\\}\\) \uff0cand \\(G\\) has \\(p+1\\) vertices\uff0cwhere \\(p \\geq k-1+\\varepsilon\\) \uff0e\n\nLet \\(H\\) be the subgraph obtained when \\(v\\) is deleted\uff0eThen \\(m=\\binom{k}{2}+\\varepsilon-p\\) is the number of edges in \\(H\\) \uff1bfrom \\(p \\geq k-1+\\varepsilon\\) we have \\(m \\leq\\binom{ k-1}{2}\\) and so we may apply the inductive hypothesis to \\(H\\) to deduce \\(S(H) \\leq\\binom{ k-1}{2} \\cdot(k-2)\\) \uff0e\n![](https://cdn.mathpix.com/cropped/2025_08_23_681e760f1de313d58731g-08.jpg?height=347&width=449&top_left_y=2141&top_left_x=805)\n\nNow the labels of edges \\(v w_{i}\\) have sum\n\\[\n\\sum_{i=1}^{p} \\min \\left(\\operatorname{deg}_{G} v, \\operatorname{deg}_{G} w_{i}\\right)=\\sum_{i=1}^{p} \\operatorname{deg}_{G} w_{i}=\\sum_{i=1}^{p}\\left(\\operatorname{deg}_{H} w_{i}+1\\right)=2 m+p\n\\]\n\nFor each of the edges contained in \\(H\\) \uff0cthe label on that edge has increased by exactly 1 \uff0c so those edges contribute \\(S(H)+m\\) \uff0eIn total\uff0c\n\\[\n\\begin{aligned}\nS(G) & =2 m+p+(S(H)+m)=(m+p)+2 m+S(H) \\\\\n& \\leq\\binom{ k}{2}+\\varepsilon+2\\binom{k-1}{2}+\\binom{k-1}{2}(k-2)=\\binom{k}{2}(k-1)+\\varepsilon\n\\end{aligned}\n\\]\n\\(\\llbracket\\) Second solution\uff08algebraic\uff0csubmitted by contestant James Lin\uff09\uff0eWe give a different proof of \\(S(G) \\leq 127009\\) \uff0eThe proof proceeds using the following two claims\uff0cwhich will show that \\(S(G) \\leq 127010\\) for all graphs \\(G\\) \uff0eThen a careful analysis of the equality cases will show that this bound is not achieved for any graph \\(G\\) \uff0eSince the example \\(L_{64}\\) earlier has \\(S\\left(L_{64}\\right)=127009\\) \uff0cthis will solve the problem\uff0e\n\n\\section*{Lemma\uff08Combinatorial bound\uff09}\n\nLet \\(G\\) be a graph with 2017 edges and let \\(d_{1} \\geq d_{2} \\geq \\cdots \\geq d_{n}\\) be the degree sequence of the graph\uff08thus \\(n \\geq 65\\) \uff09\uff0eThen\n\\[\nS(G) \\leq d_{2}+2 d_{3}+3 d_{4}+\\cdots+63 d_{64}+d_{65}\n\\]\n\nProof\uff0eLet \\(v_{1}, \\ldots, v_{n}\\) be the corresponding vertices\uff0eFor any edge \\(e=\\left\\{v_{i}, v_{j}\\right\\}\\) with \\(i<j\\) \uff0c we consider associating each edge \\(e\\) with \\(v_{j}\\) \uff0cand computing the sum \\(S(G)\\) indexing over associated vertices\uff0eTo be precise\uff0cif we let \\(a_{i}\\) denote the number of edges associated to \\(v_{i}\\) \uff0cwe now have \\(a_{i} \\leq i-1, \\sum a_{i}=2017\\) \uff0cand\n\\[\nS(G)=\\sum_{i=1}^{n} a_{i} d_{i}\n\\]\n\nThe inequality \\(\\sum a_{i} d_{i} \\leq d_{2}+2 d_{3}+3 d_{4}+\\cdots+63 d_{64}+d_{65}\\) then follows for smoothing reasons\uff08by\uff02smoothing\uff02the \\(a_{i}\\) \uff09\uff0csince the \\(d_{i}\\) are monotone\uff0eThis proves the given inequality\uff0e\n\nOnce we have this property\uff0cwe handle the bounding completely algebraically\uff0e\n\n\\section*{Lemma\uff08Algebraic bound\uff09}\n\nLet \\(x_{1} \\geq x_{2} \\geq \\cdots \\geq x_{65}\\) be any nonnegative integers such that \\(\\sum_{i=1}^{65} x_{i} \\leq 4034\\) \uff0e Then\n\\[\nx_{2}+2 x_{3}+\\cdots+63 x_{64}+x_{65} \\leq 127010 .\n\\]\n\nMoreover\uff0cequality occurs if and only if \\(x_{1}=x_{2}=x_{3}=\\cdots=x_{64}=63\\) and \\(x_{65}=2\\) \uff0e\n\nProof\uff0eLet \\(A\\) denote the left\uff0dhand side of the inequality\uff0eWe begin with a smoothing argument\uff0e\n\uff0dSuppose there are indices \\(1 \\leq i<j \\leq 64\\) such that \\(x_{i}>x_{i+1} \\geq x_{j-1}>x_{j}\\) \uff0eThen replacing\uff08 \\(x_{i}, x_{j}\\) \uff09by\uff08 \\(x_{i}-1, x_{j}+1\\) \uff09strictly increases \\(A\\) preserving all conditions\uff0e Thus we may assume all numbers in \\(\\left\\{x_{1}, \\ldots, x_{64}\\right\\}\\) differ by at most 1 \uff0e\n\uff0dSuppose \\(x_{65} \\geq 4\\) \uff0eThen we can replace \\(\\left(x_{1}, x_{2}, x_{3}, x_{4}, x_{65}\\right)\\) by \\(\\left(x_{1}+1, x_{2}+1, x_{3}+\\right. \\left.1, x_{4}+1, x_{65}-4\\right)\\) and strictly increase \\(A\\) \uff0eHence we may assume \\(x_{65} \\leq 3\\) \uff0e\n\nWe will also tacitly assume \\(\\sum x_{i}=4034\\) \uff0csince otherwise we can increase \\(x_{1}\\) \uff0eThese two properties leave only four sequences to examine\uff1a\n\uff0d\\(x_{1}=x_{2}=x_{3}=\\cdots=x_{63}=63, x_{64}=62\\), and \\(x_{65}=3\\), which gives \\(A=126948\\).\n\uff0d\\(x_{1}=x_{2}=x_{3}=\\cdots=x_{63}=x_{64}=63\\) and \\(x_{65}=2\\), which gives \\(A=127010\\).\n\uff0d\\(x_{1}=64, x_{2}=x_{3}=\\cdots=x_{63}=x_{64}=63\\) and \\(x_{65}=1\\) \uff0cwhich gives \\(A=127009\\) \uff0e\n\uff0d\\(x_{1}=x_{2}=64, x_{3}=\\cdots=x_{63}=x_{64}=63\\) and \\(x_{65}=0\\), which gives \\(A=127009\\).\nThis proves that \\(A \\leq 127010\\) \uff0eTo see that equality occurs only in the second case above\uff0c note that all the smoothing operations other than incrementing \\(x_{1}\\) were strict\uff0cand that \\(x_{1}\\) could not have been incremented in this way as \\(x_{1}=x_{2}=63\\) \uff0e\n\nThis shows that \\(S(G) \\leq 127010\\) for all graphs \\(G\\) \uff0cso it remains to show equality never occurs\uff0eRetain the notation \\(d_{i}\\) and \\(a_{i}\\) of the combinatorial bound now\uff1bwe would need to have \\(d_{1}=\\cdots=d_{64}=63\\) and \\(d_{65}=2\\)\uff08in particular\uff0cdeleting isolated vertices from \\(G\\) \uff0c we may assume \\(n=65\\) \uff09\uff0eIn that case\uff0cwe have \\(a_{i} \\leq i-1\\) but also \\(a_{65}=2\\) by definition \uff08the last vertex gets all edges associated to it\uff09\uff0eFinally\uff0c\n\\[\n\\begin{aligned}\nS(G) & =\\sum_{i=1}^{n} a_{i} d_{i}=63\\left(a_{1}+\\cdots+a_{64}\\right)+a_{65} \\\\\n& =63\\left(2017-a_{65}\\right)+2=126947\n\\end{aligned}\n\\]\ncompleting the proof\uff0e\nRemark\uff0eAnother way to finish once \\(S(G) \\leq 127010\\) is note there is a unique graph\uff08up to isomorphism and deletion of universal vertices\uff09with degree sequence\uff08 \\(d_{1}, \\ldots, d_{65}\\) \uff09\uff1d \\((63, \\ldots, 63,2)\\) \uff0eIndeed\uff0cthe complement of the graph has degree sequence \\((1, \\ldots, 1,63)\\) \uff0cand so it must be a 63 \uff0dstar plus a single edge\uff0eOne can then compute \\(S(G)\\) explicitly for this graph\uff0e\n\n\\section*{Some further remarks\uff0e}\n\nRemark\uff0eInterestingly\uff0cthe graph \\(C_{4}\\) has \\(\\binom{3}{2}+1=4\\) edges and \\(S\\left(C_{4}\\right)=8\\) \uff0cwhile \\(S\\left(L_{3}\\right)=7\\) \uff0e This boundary case is visible in the combinatorial solution in the base case of the first claim\uff0e It also explains why we end up with the bound \\(S(G) \\leq 127010\\) in the second algebraic solution\uff0cand why it is necessary to analyze the equality cases so carefully\uff1bobserve in \\(k=3\\) the situation \\(d_{1}=d_{2}=d_{3}=d_{4}=2\\) \uff0e\n\nRemark\uff0eSome comments about further context for this problem\uff1a\n\uff0dThe obvious generalization of 2017 to any constant was resolved in September 2018 by Mehtaab Sawhney and Ashwin Sah\uff0eThe relevant paper is On the discrepancy between two Zagreb indices\uff0cpublished in Discrete Mathematics\uff0cVolume 341\uff0cIssue 9\uff0c pages 2575\uff0d2589\uff0eThe arXiv link is https\uff1a\uff0f\uff0farxiv\uff0eorg\uff0fpdf\uff0f1801\uff0e02532\uff0epdf\uff0e\n\uff0dThe quantity\n\\[\nS(G)=\\sum_{e=v w} \\min (\\operatorname{deg} v, \\operatorname{deg} w)\n\\]\nin the problem has an interpretation\uff1ait can be used to provide a bound on the number of triangles in a graph \\(G\\) \uff0eTo be precise\uff0c\\(\\# E(G) \\leq \\frac{1}{3} S(G)\\) \uff0csince an edge \\(e=v w\\) is part of at most \\(\\min (\\operatorname{deg} v, \\operatorname{deg} w)\\) triangles\uff0e\n\uff0dFor planar graphs it is known \\(S(G) \\leq 18 n-36\\) and it is conjectured that for \\(n\\) large enough\uff0c\\(S(G) \\leq 18 n-72\\) \uff0eSee https\uff1a\uff0f\uff0fmathoverflow\uff0enet\uff0fa\uff0f273694\uff0f70654\uff0e\n\nIf Authorship comments\uff0eI came up with the quantity \\(S(G)\\) in a failed attempt to provide a bound on the number of triangles in a graph\uff0csince this is natural to consider when you do a standard double\uff0dcounting via the edges of the triangle\uff0eI think the problem was actually APMO 1989\uff0cand I ended up not solving the problem\uff08the solution is much simpler\uff09\uff0cbut the quantity \\(S(G)\\) stuck in my head for a while after that\uff0e\n\nLater on that month I was keeping Danielle company while she was working on art project\uff08flower necklace\uff09\uff0cand with not much to do except doodle on tables I began thinking about \\(S(G)\\) again\uff0eI did have the sense that \\(S(G)\\) should be maximized at a graph close to a complete graph\uff0eBut to my frustration I could not prove it for a long time\uff0eFinally after many hours of trying various approaches I was able to at least show that \\(S(G)\\) was maximized for complete graphs if the number of edges was a triangular number\uff0e\n\nI had come up with this in March 2016\uff0cwhich would have been perfect since 2016 is a triangular number\uff0cbut it was too late to submit it to any contest\uff08the USAMO and IMO deadlines were long past\uff09\uff0eSo on December 31\uff0c 2016 I finally sat down and solved it for the case 2017\uff0cwhich took another few hours of thought\uff0cthen submitted it to that year\uff07s IMO\uff0eTo my dismay it was rejected\uff0cbut I passed it along to the USA TST after that\uff0cthus making it just in time for the close of the calendar year\uff0e", "source_pdf": "TST_2018.pdf", "notes": ""}
{"id": "TST-2018-4", "contest": "TST", "year": "2018", "problem_number": "4", "problem": "Let \\(n\\) be a positive integer and let \\(S \\subseteq\\{0,1\\}^{n}\\) be a set of binary strings of length \\(n\\) \uff0e Given an odd number \\(x_{1}, \\ldots, x_{2 k+1} \\in S\\) of binary strings\uff08not necessarily distinct\uff09\uff0c their majority is defined as the binary string \\(y \\in\\{0,1\\}^{n}\\) for which the \\(i^{\\text {th }}\\) bit of \\(y\\) is the most common bit among the \\(i^{\\text {th }}\\) bits of \\(x_{1}, \\ldots, x_{2 k+1}\\) \uff0e\uff08For example\uff0cif \\(n=4\\) the majority of \\(0000,0000,1101,1100,0101\\) is 0100 \uff0e\uff09\n\nSuppose that for some positive integer \\(k, S\\) has the property \\(P_{k}\\) that the majority of any \\(2 k+1\\) binary strings in \\(S\\)\uff08possibly with repetition\uff09is also in \\(S\\) \uff0eProve that \\(S\\) has the same property \\(P_{k}\\) for all positive integers \\(k\\) \uff0e", "solution": "Let \\(M\\) denote the majority function\uff08of any length\uff09\uff0e\n\nFirst solution\uff08induction\uff09\uff0eWe prove all \\(P_{k}\\) are equivalent by induction on \\(n \\geq 2\\) \uff0c with the base case \\(n=2\\) being easy to check by hand\uff0e\uff08The case \\(n=1\\) is also vacuous\uff1b however\uff0cthe inductive step is not able to go from \\(n=1\\) to \\(n=2\\) \uff0e\uff09\n\nFor the inductive step\uff0cwe proceed by contradiction\uff1bassume \\(S\\) satisfies \\(P_{\\ell}\\) \uff0cbut not \\(P_{k}\\) \uff0cso there exist \\(x_{1}, \\ldots, x_{2 k+1} \\in S\\) whose majority \\(y=M\\left(x_{1}, \\ldots, x_{k}\\right)\\) is not in \\(S\\) \uff0eWe contend that\uff1a\n\nClaim\uff0dLet \\(y_{i}\\) be the string which differs from \\(y\\) only in the \\(i^{\\text {th }}\\) bit\uff0eThen \\(y_{i} \\in S\\) \uff0e\n\nProof\uff0eFor a string \\(s \\in S\\) we let \\(\\hat{s}\\) denote the string \\(s\\) with the \\(i^{\\text {th }}\\) bit deleted\uff08hence with \\(n-1\\) bits\uff09\uff0eNow let\n\\[\nT=\\{\\hat{s} \\mid s \\in S\\}\n\\]\n\nSince \\(S\\) satisfies \\(P_{\\ell}\\) \uff0cso does \\(T\\) \uff1bthus by the induction hypothesis on \\(n, T\\) satisfies \\(P_{k}\\) \uff0e\nConsequently\uff0c\\(T \\ni M\\left(\\hat{x}_{1}, \\ldots, \\hat{x}_{2 k+1}\\right)=\\hat{y}\\) \uff0eThus there exists \\(s \\in S\\) such that \\(\\hat{s}=\\hat{y}\\) \uff0e This implies \\(s=y\\) or \\(s=y_{i}\\) \uff0eBut since we assumed \\(y \\notin S\\) it follows \\(y_{i} \\in S\\) instead\uff0e\n\nNow take any \\(2 \\ell+1\\) copies of the \\(y_{i}\\) \uff0cabout equally often\uff08i\uff0ee\uff0ethe number of times any two \\(y_{i}\\) are taken differs by at most 1 \uff09\uff0eWe see the majority of these is \\(y\\) itself\uff0c contradiction\uff0e\n\nIf Second solution\uff08circuit construction\uff09\uff0eNote that \\(P_{k} \\Longrightarrow P_{1}\\) for any \\(k\\) \uff0csince\n\\[\nM(\\underbrace{a, \\ldots, a}_{k}, \\underbrace{b, \\ldots, b}_{k}, c)=M(a, b, c)\n\\]\nfor any \\(a, b, c\\) \uff0e\nWe will now prove \\(P_{1}+P_{k} \\Longrightarrow P_{k+1}\\) for any \\(k\\) \uff0cwhich will prove the result\uff0eActually\uff0c we will show that the majority of any \\(2 k+3\\) strings \\(x_{1}, \\ldots, x_{2 k+3}\\) can be expressed by 3 and \\((2 k+1)\\)\uff0dmajorities\uff0eWLOG assume that \\(M\\left(x_{1}, \\ldots, x_{2 k+3}\\right)=0 \\ldots 0\\) \uff0cand let \\(\\odot\\) denote binary AND\uff0e\n\nClaim\uff0dWe have \\(M\\left(x_{1}, x_{2}, M\\left(x_{3}, \\ldots, x_{2 k+3}\\right)\\right)=x_{1} \\odot x_{2}\\) \uff0e\n\nProof\uff0eConsider any particular bit\uff0eThe result is clear if the bits are equal\uff0eOtherwise\uff0cif they differ\uff0cthe result follows from the original hypothesis that \\(M\\left(x_{1}, \\ldots, x_{2 k+3}\\right)=0 \\ldots 0\\) \uff08removing two differing bits does not change the majority\uff09\uff0e\n\nBy analogy we can construct any \\(x_{i} \\odot x_{j}\\) \uff0eFinally\uff0cnote that\n\\[\nM\\left(x_{1} \\odot x_{2}, x_{2} \\odot x_{3}, \\ldots, x_{2 k+1} \\odot x_{2 k+2}\\right)=0 \\ldots 0\n\\]\nas desired\uff0e\uff08Indeed\uff0cif we look at any index\uff0cthere were at most \\(k+11\\)\uff07s in the \\(x_{i}\\) strings\uff0c and hence there will be at most \\(k 1\\)\uff07s among \\(x_{i} \\odot x_{i+1}\\) for \\(i=1, \\ldots, 2 k+1\\) \uff0e\uff09\n\nRemark\uff0eThe second solution can be interpreted in circuit language as showing that all \uff02 \\(2 k+1\\)\uff0dmajority gates\uff02are equivalent\uff0eSee also https\uff1a\uff0f\uff0fcstheory\uff0estackexchange\uff0ecom\uff0f a\uff0f21399\uff0f48303\uff0cin which Valiant gives a probabilistic construction to prove that one can construct \\((2 k+1)\\)\uff0dmajority gates from a polynomial number of 3 \uff0dmajority gates\uff0eNo explicit construction is known for this\uff0e", "source_pdf": "TST_2018.pdf", "notes": ""}
{"id": "TST-2018-5", "contest": "TST", "year": "2018", "problem_number": "5", "problem": "Let \\(A B C D\\) be a convex cyclic quadrilateral which is not a kite\uff0cbut whose diagonals are perpendicular and meet at \\(H\\) \uff0eDenote by \\(M\\) and \\(N\\) the midpoints of \\(\\overline{B C}\\) and \\(\\overline{C D}\\) \uff0eRays \\(M H\\) and \\(N H\\) meet \\(\\overline{A D}\\) and \\(\\overline{A B}\\) at \\(S\\) and \\(T\\) \uff0crespectively\uff0eProve there exists a point \\(E\\) \uff0clying outside quadrilateral \\(A B C D\\) \uff0csuch that\n\uff0dray \\(E H\\) bisects both angles \\(\\angle B E S, \\angle T E D\\) \uff0cand\n\uff0d\\(\\angle B E N=\\angle M E D\\) \uff0e", "solution": "The main claim is that \\(E\\) is the intersection of\uff08 \\(A B C D\\) \uff09with the circle with diameter \\(\\overline{A H}\\) \uff0e\n![](https://cdn.mathpix.com/cropped/2025_08_23_681e760f1de313d58731g-14.jpg?height=1006&width=775&top_left_y=1053&top_left_x=645)\n\nThe following observation can be quickly made without reference to \\(E\\) \uff0e\n\n\\section*{Lemma}\n\nWe have \\(\\angle H S A=\\angle H T A=90^{\\circ}\\) \uff0eConsequently\uff0cquadrilateral \\(B T S D\\) is cyclic\uff0e\n\nProof\uff0eThis is direct angle chasing\uff0eIn fact\uff0c\\(\\overline{H M}\\) passes through the circumcenter of \\(\\triangle B H C\\) and \\(\\triangle H A D \\sim \\triangle H C B\\) \uff0cso \\(\\overline{H S}\\) ought to be the altitude of \\(\\triangle H A D\\) \uff0e\n\nFrom here it follows that \\(E\\) is the Miquel point of cyclic quadrilateral \\(B T S D\\) \uff0eDefine \\(F\\) to be the point diametrically opposite \\(A\\) \uff0cso that \\(E, H, F\\) are collinear\uff0c\\(\\overline{C F} \\| \\overline{B D}\\) \uff0eBy\nnow we already have\n\\[\n\\measuredangle B E H=\\measuredangle B E F=\\measuredangle B A F=\\measuredangle C A D=\\measuredangle H A S=\\measuredangle H E S\n\\]\nso \\(\\overline{E H}\\) bisects \\(\\angle B E S\\) \uff0cand \\(\\angle T E D\\) \uff0eHence it only remains to show \\(\\angle B E M=\\angle N E D\\) \uff1b we present several proofs below\uff0e\n\nIf First proof\uff08original solution\uff09\uff0eLet \\(P\\) be the circumcenter of \\(B T S D\\) \uff0eThe properties of the Miquel point imply \\(P\\) lies on the common bisector \\(\\overline{E H}\\) already\uff0cand it also lies on the perpendicular bisector of \\(\\overline{B D}\\) \uff0chence it must be the midpoint of \\(\\overline{H F}\\) \uff0e\n\nWe now contend quadrilaterals \\(B M P S\\) and \\(D N P T\\) are cyclic\uff0eObviously \\(\\overline{M P}\\) is the external angle bisector of \\(\\angle B M S\\) \uff0cand \\(P B=P S\\) \uff0cso \\(P\\) is the \\(\\operatorname{arc}\\) midpoint of \\((B M S)\\) \uff0e The proof for \\(D N P T\\) is analogous\uff0e\n\nIt remains to show \\(\\angle B E N=\\angle M E D\\) \uff0cor equivalently \\(\\angle B E M=\\angle N E D\\) \uff0eBy proper\uff0d ties of Miquel point we have \\(E \\in(B M P S) \\cap(T P N D)\\) \uff0cso\n\\[\n\\measuredangle B E M=\\measuredangle B P M=\\measuredangle P B D=\\measuredangle B D P=\\measuredangle N P D=\\measuredangle N E D\n\\]\nas desired\uff0e\n\nIT Second proof\uff082011 G4\uff09\uff0eBy 2011 G 4 \uff0cthe circumcircle of \\(\\triangle E M N\\) is tangent to the circumcircle of \\(A B C D\\) \uff0eHence if we extend \\(\\overline{E M}\\) and \\(\\overline{E N}\\) to meet\uff08 \\(A B C D\\) \uff09again at \\(X\\) and \\(Y\\) \uff0cwe get \\(\\overline{X Y}\\|\\overline{M N}\\| \\overline{B D}\\) \uff0eThus \\(\\measuredangle B E M=\\measuredangle B E X=\\measuredangle Y E D=\\measuredangle N E D\\) \uff0e\n\nIT Third proof\uff08involutions\uff0csubmitted by Daniel Liu\uff09\uff0eLet \\(G=\\overline{B N} \\cap \\overline{M D}\\) denote the centroid of \\(\\triangle B C D\\) \uff0cand note that it lies on \\(\\overline{E H F}\\) \uff0e\n\nNow consider the dual of Desargues involution theorem on complete quadrilateral \\(B M D N C G\\) at point \\(E\\) \uff0eWe get\n\\[\n(E B, E D), \\quad(E M, E N), \\quad(E C, E G)\n\\]\nform an involutive pairing\uff0e\nHowever\uff0cthe bisector of \\(\\angle B E D\\) \uff0csay \\(\\ell\\) \uff0cis also the angle bisector of \\(\\angle C E F\\)\uff08since \\(\\overline{C F} \\| \\overline{B D}\\) \uff09\uff0eSo the involution we found must coincide with reflection across \\(\\ell\\) \uff0eThis means \\(\\angle M E N\\) is bisected by \\(\\ell\\) as well\uff0cas desired\uff0e\n\nIT Authorship comments\uff0eThis diagram actually comes from the inverted picture in IMO 2014\uff0f3\uff08which I attended\uff09\uff0eI had heard for many years that one could solve this problem quickly by inversion at \\(H\\) afterwards\uff0eBut when I actually tried to do it during an OTIS class years later\uff0cI ended up with the picture in the TST problem\uff0cand couldn\uff07t see why it was true\uff01In the process of trying to reconstruct this rumored solution\uff0cI ended up finding most of the properties that ended up in the January TST problem\uff08but were overkill for the original IMO problem\uff09\uff0e\n\nLet us make the equivalence explicit by deducing the IMO problem from our work\uff0e\nLet rays \\(E M\\) and \\(E N\\) meet the circumcircles of \\(\\triangle B H C\\) and \\(\\triangle B N C\\) again at \\(X\\) and \\(Y\\) \uff0cwith \\(E M<E X\\) and \\(E N<E Y\\) \uff0eAs above we concluded \\(E M / E X=E N / E Y\\) and so \\(\\overline{M N} \\| \\overline{X Y} \\Longrightarrow \\overline{X Y} \\perp \\overline{A H C}\\) \uff0e\n\nNow consider an inversion at \\(H\\) which swaps \\(B \\leftrightarrow D\\) and \\(A \\leftrightarrow C\\) \uff0eThe point \\(E\\) goes to \\(E^{*}\\) diametrically opposite \\(A\\) \uff0ePoints \\(X\\) and \\(Y\\) go to points on \\(X^{*} \\in \\overline{A D}\\) and \\(Y^{*} \\in \\overline{A B}\\) \uff0e Since the reflection of \\(E\\) across \\(\\overline{P X}\\) is supposed to lie on\uff08 \\(B A E\\) \uff09\uff0cit follows that the circumcenter of \\(\\triangle H X^{*} E^{*}\\) lies on \\(\\overline{A D}\\) \uff0eConsequently \\(X^{*}\\) plays the role of point\uff02\\(T\\)\uff02in the IMO problem\uff0eThen \\(Y^{*}\\) plays the role of point\uff02\\(S\\)\uff02in the IMO problem\uff0e\n\nNow the fact that \\(\\left(H X^{*} Y^{*}\\right)\\) is tangent to \\(\\overline{B D}\\) is equivalent to \\(\\overline{X Y} \\perp \\overline{A H C}\\) which we already knew\uff0e", "source_pdf": "TST_2018.pdf", "notes": ""}
{"id": "TST-2018-6", "contest": "TST", "year": "2018", "problem_number": "6", "problem": "Alice and Bob play a game\uff0eFirst\uff0cAlice secretly picks a finite set \\(S\\) of lattice points in the Cartesian plane\uff0eThen\uff0cfor every line \\(\\ell\\) in the plane which is horizontal\uff0c vertical\uff0cor has slope +1 or -1 \uff0cshe tells Bob the number of points of \\(S\\) that lie on \\(\\ell\\) \uff0e Bob wins if he can then determine the set \\(S\\) \uff0e\n\nProve that if Alice picks \\(S\\) to be of the form\n\\[\nS=\\left\\{(x, y) \\in \\mathbb{Z}^{2} \\mid m \\leq x^{2}+y^{2} \\leq n\\right\\}\n\\]\nfor some positive integers \\(m\\) and \\(n\\) \uff0cthen Bob can win\uff0e\uff08Bob does not know in advance that \\(S\\) is of this form\uff0e\uff09", "solution": "Clearly Bob can compute the number \\(N\\) of points\uff0e\nThe main claim is that\uff1a\nClaim\uff0dFix \\(m\\) and \\(n\\) as in the problem statement\uff0eAmong all sets \\(T \\subseteq \\mathbb{Z}^{2}\\) with \\(N\\) points\uff0cthe set \\(S\\) is the unique one which maximizes the value of\n\\[\nF(T):=\\sum_{(x, y) \\in T}\\left(x^{2}+y^{2}\\right)\\left(m+n-\\left(x^{2}+y^{2}\\right)\\right) .\n\\]\n\nProof\uff0eIndeed\uff0cthe different points in \\(T\\) do not interact in this sum\uff0cso we simply want the points\uff08 \\(x, y\\) \uff09with \\(x^{2}+y^{2}\\) as close as possible to \\(\\frac{m+n}{2}\\) which is exactly what \\(S\\) does\uff0e\n\nAs a result of this observation\uff0cit suffices to show that Bob has enough information to compute \\(F(S)\\) from the data given\uff0e\uff08There is no issue with fixing \\(m\\) and \\(n\\) \uff0csince Bob can find an upper bound on the magnitude of the points and then check all pairs\uff08 \\(m, n\\) \uff09 smaller than that\uff0e\uff09The idea is that he knows the full distribution of each of \\(X, Y\\) \uff0c \\(X+Y, X-Y\\) and hence can compute sums over \\(T\\) of any power of a single one of those linear functions\uff0eBy taking linear combinations we can hence compute \\(F(S)\\) \uff0e\n\nLet us make the relations explicit\uff0eFor ease of exposition we take \\(Z=(X, Y)\\) to be a uniformly random point from the set \\(S\\) \uff0eThe information is precisely the individual distributions of \\(X, Y, X+Y\\) \uff0cand \\(X-Y\\) \uff0eNow compute\n\\[\n\\begin{aligned}\n\\frac{F(S)}{N} & =\\mathbb{E}\\left[(m+n)\\left(X^{2}+Y^{2}\\right)-\\left(X^{2}+Y^{2}\\right)^{2}\\right] \\\\\n& =(m+n)\\left(\\mathbb{E}\\left[X^{2}\\right]+\\mathbb{E}\\left[Y^{2}\\right]\\right)-\\mathbb{E}\\left[X^{4}\\right]-\\mathbb{E}\\left[Y^{4}\\right]-2 \\mathbb{E}\\left[X^{2} Y^{2}\\right] .\n\\end{aligned}\n\\]\n\nOn the other hand\uff0c\n\\[\n\\mathbb{E}\\left[X^{2} Y^{2}\\right]=\\frac{\\mathbb{E}\\left[(X+Y)^{4}\\right]+\\mathbb{E}\\left[(X-Y)^{4}\\right]-2 \\mathbb{E}\\left[X^{4}\\right]-2 \\mathbb{E}\\left[Y^{4}\\right]}{12}\n\\]\n\nThus we have written \\(F(S)\\) in terms of the distributions of \\(X, Y, X-Y, X+Y\\) which completes the proof\uff0e\n\nRemark\uff08Mark Sellke\uff09\uff0e\uff0dThis proof would have worked just as well if we allowed arbitrary \\([0,1]\\)\uff0dvalued weights on points with finitely many weights non\uff0dzero\uff0eThere is an obvious continuum generalization one can make concerning the indicator func\uff0d tion for an annulus\uff0eIt\uff07s a simpler but fun problem to characterize when just the vertical\uff0fhorizontal directions determine the distribution\uff0e\n\uff0dAn obstruction to purely combinatorial arguments is that if you take an octagon with points \\(( \\pm a, \\pm b)\\) and \\(( \\pm b, \\pm a)\\) then the two ways to pick every other point\uff08going around clockwise\uff09are indistinguishable by Bob\uff0eThis at least shows that Bob\uff07s task is far from possible in general\uff0cand hints at proving an inequality\uff0e\n\uff0dA related and more standard fact\uff08among a certain type of person\uff09is that given a probability distribution \\(\\mu\\) on \\(\\mathbb{R}^{n}\\) \uff0cif I tell you the distribution of all 1\uff0ddimensional projections of \\(\\mu\\) \uff0cthat determines \\(\\mu\\) uniquely\uff0eThis works because this information gives me the Fourier transform \\(\\hat{\\mu}\\) \uff0cand Fourier transforms are injective\uff0e\nFor the continuum version of this problem\uff0cthis connection gives a much larger family of counterexamples to any proposed extension to arbitrary non\uff0dannular shapes\uff0eIndeed\uff0c take a fast\uff0ddecaying smooth function \\(f: \\mathbb{R}^{2} \\rightarrow \\mathbb{R}\\) which vanishes on the four lines\n\\[\nx=0, y=0, x+y=0, x-y=0\n\\]\n\nThen the Fourier transform \\(\\hat{f}\\) will have mean 0 on each line \\(\\ell\\) as in the problem statement\uff0eHence the positive and negative parts of \\(\\hat{f}\\) will not be distinguishable by Bob\uff0e", "source_pdf": "TST_2018.pdf", "notes": ""}
{"id": "TST-2019-1", "contest": "TST", "year": "2019", "problem_number": "1", "problem": "Let \\(A B C\\) be a triangle and let \\(M\\) and \\(N\\) denote the midpoints of \\(\\overline{A B}\\) and \\(\\overline{A C}\\) \uff0c respectively\uff0eLet \\(X\\) be a point such that \\(\\overline{A X}\\) is tangent to the circumcircle of triangle \\(A B C\\) \uff0eDenote by \\(\\omega_{B}\\) the circle through \\(M\\) and \\(B\\) tangent to \\(\\overline{M X}\\) \uff0cand by \\(\\omega_{C}\\) the circle through \\(N\\) and \\(C\\) tangent to \\(\\overline{N X}\\) \uff0eShow that \\(\\omega_{B}\\) and \\(\\omega_{C}\\) intersect on line \\(B C\\) \uff0e", "solution": "We present four solutions\uff0cthe second of which shows that \\(M\\) and \\(N\\) can be replaced by any two points on \\(A B\\) and \\(A C\\) satisfying \\(A M / A B+A N / A C=1\\) \uff0e\n\nFirst solution using symmedians\uff08Merlijn Staps\uff09\uff0eLet \\(\\overline{X Y}\\) be the other tangent from \\(X\\) to \\((A M N)\\) \uff0e\n\nClaim\uff0dLine \\(\\overline{X M}\\) is tangent to\uff08 \\(B M Y\\) \uff09\uff1bhence \\(Y\\) lies on \\(\\omega_{B}\\) \uff0e\n\nProof\uff0eLet \\(Z\\) be the midpoint of \\(\\overline{A Y}\\) \uff0eThen \\(\\overline{M X}\\) is the \\(M\\)\uff0dsymmedian in triangle \\(A M Y\\) \uff0e Since \\(\\overline{M Z} \\| \\overline{B Y}\\) \uff0cit follows that \\(\\measuredangle A M X=\\measuredangle Z M Y=\\measuredangle B Y M\\) \uff0eWe conclude that \\(\\overline{X M}\\) is tangent to the circumcircle of triangle \\(B M Y\\) \uff0e\n\nSimilarly\uff0c\\(\\omega_{C}\\) is the circumcircle of triangle \\(C N Y\\) \uff0eAs \\(A M Y N\\) is cyclic too\uff0cit follows that \\(\\omega_{B}\\) and \\(\\omega_{C}\\) intersect on \\(\\overline{B C}\\) \uff0cby Miquel\uff07s theorem\uff0e\n\nSecond solution\uff08Jetze Zoethout\uff09\uff0eLet \\(\\omega_{B}\\) intersect \\(\\overline{B C}\\) again at \\(S\\) and let \\(\\overline{M S}\\) intersect \\(\\overline{A C}\\) again at \\(Y\\) \uff0eAngle chasing gives \\(\\measuredangle X M Y=\\measuredangle X M S=\\measuredangle M B S=\\measuredangle A B C= \\measuredangle X A C=\\measuredangle X A Y\\) \uff0cso \\(Y\\) is on the circumcircle of triangle \\(A M X\\) \uff0eFurthermore\uff0cfrom \\(\\measuredangle X M Y=\\measuredangle A B C\\) and \\(\\measuredangle A C B=\\measuredangle X A B=\\measuredangle X Y M\\) it follows that \\(\\triangle A B C \\sim \\triangle X M Y\\) and from \\(\\measuredangle X A Y=\\measuredangle M B S\\) and \\(\\measuredangle Y X A=\\measuredangle Y M A=\\measuredangle B M S\\) it follows that \\(\\triangle A X Y \\sim \\triangle B M S\\) \uff0e\n\nWe now find\n\\[\n\\frac{A N}{A X}=\\frac{A N / B M}{A X / B M}=\\frac{A C / A B}{M S / X Y}=\\frac{A B / A B}{M S / X M}=\\frac{X M}{M S},\n\\]\nwhich together with \\(\\angle X M S=\\angle X A N\\) yields \\(\\triangle X M S \\sim \\triangle X A N\\) \uff0eFrom \\(\\angle X S Y= \\measuredangle X S M=\\measuredangle X N A=\\measuredangle X N Y\\) we now have that \\(S\\) is on the circumcircle of triangle \\(X N Y\\) \uff0e Finally\uff0cwe have \\(\\measuredangle X N S=\\measuredangle X Y S=\\measuredangle X Y M=\\measuredangle A C B=\\measuredangle N C S\\) so \\(\\overline{X N}\\) is tangent to the circle through \\(C, N\\) \uff0cand \\(S\\) \uff0cas desired\uff0e\n\nThird solution by moving points method\uff0eFix triangle \\(A B C\\) and animate \\(X\\) along the tangent at \\(A\\) \uff0eWe let \\(D\\) denote the second intersection point of \\(\\omega_{C}\\) with line \\(\\overline{B C}\\) \uff0e\n\nClaim\uff0dThe composed map \\(X \\mapsto D\\) is a fractional linear transformation\uff08i\uff0ee\uff0ea projective map\uff09in terms of a real coordinate on line \\(\\overline{A A}, \\overline{B C}\\) \uff0e\n\nProof\uff0eLet \\(\\ell\\) denote the perpendicular bisector of \\(\\overline{C N}\\) \uff0calso equipped with a real coordinate\uff0e We let \\(P\\) denote the intersection of \\(\\overline{X M}\\) with \\(\\ell, S\\) the circumcenter of \\(\\triangle C M D\\) \uff0eLet \\(T\\) denote the midpoint of \\(\\overline{B D}\\) \uff0e\n\nWe claim that the composed map\n\\[\n\\begin{aligned}\n\\overline{A A} & \\rightarrow \\ell \\rightarrow \\ell \\rightarrow \\overline{B C} \\rightarrow \\overline{B C} \\\\\n\\text { by } \\quad X & \\mapsto P \\mapsto S \\mapsto T \\mapsto D\n\\end{aligned}\n\\]\nis projective\uff0cby showing each individual map is projective\uff0e\n\n\uff0dThe map \\(X \\mapsto P\\) is projective since it is a perspectivity through \\(N\\) from \\(\\overline{A A}\\) to \\(\\ell\\) \uff0e\n\uff0dThe map \\(P \\mapsto S\\) is projective since it is equivalent to a negative inversion on \\(\\ell\\) at the midpoint of \\(\\overline{N C}\\) with radius \\(\\frac{1}{2} N C\\) \uff0e\uff08Note \\(\\angle P N S=90^{\\circ}\\) is fixed\uff0e\uff09\n\uff0dThe map \\(S \\mapsto T\\) is projective since it is a perspectivity \\(\\ell \\rightarrow \\overline{B C}\\) through the point at infinity perpendicular to \\(\\overline{B C}\\)\uff08in fact\uff0cit is linear\uff09\uff0e\n\uff0dThe map \\(T \\mapsto D\\) is projective\uff08in fact\uff0clinear\uff09since it is a homothety through \\(C\\) with fixed ratio 2 \uff0e\n\nThus the composed map is projective as well\uff0e\nSimilarly\uff0cif we define \\(D^{\\prime}\\) so that \\(\\overline{X M}\\) is tangent to \\(\\left(B M D^{\\prime}\\right)\\) \uff0cthe map \\(X \\mapsto D^{\\prime}\\) is projective as well\uff0eWe aim to show \\(D=D^{\\prime}\\) \uff0cand since the maps correspond to fractional linear transformations in projective coordinates\uff0cit suffices to verify it for three distinct choices of \\(X\\) \uff0eWe do so\uff1a\n\uff0dIf \\(X=\\overline{A A} \\cap \\overline{M N}\\) \uff0cthen \\(D\\) and \\(D^{\\prime}\\) satisfy \\(M B=M D^{\\prime}, N C=N D\\) \uff0eThis means they are the feet of the \\(A\\)\uff0daltitude on \\(\\overline{B C}\\) \uff0e\n\uff0dAs \\(X\\) approaches \\(A\\) the points \\(D\\) and \\(D^{\\prime}\\) approach the infinity point along \\(\\overline{B C}\\) \uff0e\n\uff0dIf \\(X\\) is a point at infinity along \\(\\overline{A A}\\) \uff0cthen \\(D\\) and \\(D^{\\prime}\\) coincide with the midpoint of \\(\\overline{B C}\\) \uff0e\n\nThis completes the solution\uff0e\nRemark\uff08Anant Mudgal\uff09\uff0eAn alternative\uff08shorter\uff09way to show \\(X \\mapsto D\\) is projective is to notice \\(\\measuredangle X N D\\) is a constant angle\uff0eI left the longer\uff02original\uff02proof for instructional reasons\uff0e\n\nFourth solution by isogonal conjugates\uff08Anant Mudgal\uff09\uff0eLet \\(Y\\) be the isogonal conjugate of \\(X\\) in \\(\\triangle A M N\\) and \\(Z\\) be the reflection of \\(Y\\) in \\(\\overline{M N}\\) \uff0eAs \\(\\overline{A X}\\) is tangent to the circumcircle of \\(\\triangle A M N\\) \uff0cit follows that \\(\\overline{A Y} \\| \\overline{M N}\\) \uff0eThus \\(Z\\) lies on \\(\\overline{B C}\\) since \\(\\overline{M N}\\) bisects the strip made by \\(\\overline{A Y}\\) and \\(\\overline{B C}\\) \uff0e\n\nFinally\uff0c\n\\[\n\\measuredangle Z M X=\\measuredangle Z M N+\\measuredangle N M X=\\measuredangle N M Y+\\measuredangle Y M A=\\measuredangle N M A=\\measuredangle Z B M\n\\]\nso \\(\\overline{X M}\\) is tangent to the circumcircle of \\(\\triangle Z M B\\) \uff0chence \\(Z\\) lies on \\(\\omega_{B}\\) \uff0eSimilarly\uff0c\\(Z\\) lies on \\(\\omega_{C}\\) and we\uff07re done\uff0e", "source_pdf": "TST_2019.pdf", "notes": ""}
{"id": "TST-2019-2", "contest": "TST", "year": "2019", "problem_number": "2", "problem": "Let \\(\\mathbb{Z} / n \\mathbb{Z}\\) denote the set of integers considered modulo \\(n\\)\uff08hence \\(\\mathbb{Z} / n \\mathbb{Z}\\) has \\(n\\) elements\uff09\uff0eFind all positive integers \\(n\\) for which there exists a bijective function \\(g: \\mathbb{Z} / n \\mathbb{Z} \\rightarrow \\mathbb{Z} / n \\mathbb{Z}\\) \uff0csuch that the 101 functions\n\\[\ng(x), \\quad g(x)+x, \\quad g(x)+2 x, \\quad \\ldots, \\quad g(x)+100 x\n\\]\nare all bijections on \\(\\mathbb{Z} / n \\mathbb{Z}\\) \uff0e", "solution": "Call a function \\(g\\) valiant if it obeys this condition\uff0eWe claim the answer is all numbers relatively prime to \\(101!\\) \uff0e\n\nThe construction is to just let \\(g\\) be the identity function\uff0e\nBefore proceeding to the converse solution\uff0cwe make a long motivational remark\uff0e\nRemark\uff08Motivation for both parts\uff09\uff0eThe following solution is dense\uff0cand it is easier to think about some small cases first\uff0cto motivate the ideas\uff0eWe consider the result where 101 is replaced by 2 or 3 \uff0e\n\uff0dIf we replaced 101 with 2 \uff0cyou can show \\(2 \\nmid n\\) easily\uff1awrite\n\\[\n\\sum_{x} x \\equiv \\sum_{x} g(x) \\equiv \\sum_{x}(g(x)+x) \\quad(\\bmod n)\n\\]\nwhich implies\n\\[\n0 \\equiv \\sum_{x} x=\\frac{1}{2} n(n+1) \\quad(\\bmod n)\n\\]\nwhich means \\(\\frac{1}{2} n(n+1) \\equiv 0(\\bmod n)\\) \uff0chence \\(n\\) odd\uff0e\n\uff0dIf we replaced 101 with 3 \uff0cthen you can try a similar approach using squares\uff0csince\n\\[\n\\begin{aligned}\n0 & \\equiv \\sum_{x}\\left[(g(x)+2 x)^{2}-2(g(x)+x)^{2}+g(x)^{2}\\right] \\quad(\\bmod n) \\\\\n& =\\sum_{x} 2 x^{2}=2 \\cdot \\frac{n(n+1)(2 n+1)}{6}\n\\end{aligned}\n\\]\nwhich is enough to force \\(3 \\nmid n\\) \uff0e\n\nWe now present several different proofs of the converse\uff0call of which generalize the ideas contained here\uff0eIn everything that follows we assume \\(n>1\\) for convenience\uff0e\n\nFirst solution\uff08original one\uff09\uff0eThe proof is split into two essentially orthogonal claims\uff0c which we state as lemmas\uff0e\n\nLemma\uff08Lemma I\uff1aelimination of \\(g\\) \uff09\nAssume valiant \\(g: \\mathbb{Z} / n \\mathbb{Z} \\rightarrow \\mathbb{Z} / n \\mathbb{Z}\\) exists\uff0eThen\n\\[\nk!\\sum_{x \\in \\mathbb{Z} / n \\mathbb{Z}} x^{k} \\equiv 0 \\quad(\\bmod n)\n\\]\nfor \\(k=0,1, \\ldots, 100\\) \uff0e\n\nProof\uff0eDefine \\(g_{x}(T)=g(x)+T x\\) for any integer \\(T\\) \uff0eIf we view \\(g_{x}(T)^{k}\\) as a polynomial in \\(\\mathbb{Z}[T]\\) of degree \\(k\\) with leading coefficient \\(x^{k}\\) \uff0cthen taking the \\(k\\) th finite difference implies that\uff0cfor any \\(x\\) \uff0c\n\\[\nk!x^{k}=\\binom{k}{0} g_{x}(k)^{k}-\\binom{k}{1} g_{x}(k-1)^{k}+\\binom{k}{2} g_{x}(k-2)^{k}-\\cdots+(-1)^{k}\\binom{k}{k} g_{x}(0)^{k}\n\\]\n\nOn the other hand\uff0cfor any \\(1 \\leq k \\leq 100\\) we should have\n\\[\n\\begin{aligned}\n\\sum_{x} g_{x}(0)^{k} \\equiv \\sum_{x} g_{x}(1)^{k} & \\equiv \\cdots \\equiv \\sum_{x} g_{x}(k)^{k} \\\\\n& \\equiv S_{k}:=0^{k}+\\cdots+(n-1)^{k} \\quad(\\bmod n)\n\\end{aligned}\n\\]\nby the hypothesis\uff0eThus we find\n\\[\nk!\\sum_{x} x^{k} \\equiv\\left[\\binom{k}{0}-\\binom{k}{1}+\\binom{k}{2}-\\cdots\\right] S_{k} \\equiv 0 \\quad(\\bmod n)\n\\]\nfor any \\(1 \\leq k \\leq 100\\) \uff0cbut also obviously for \\(k=0\\) \uff0e\nWe now prove the following self\uff0dcontained lemma\uff0e\n\nLemma\uff08Lemma II\uff1apower sum calculation\uff09\n\nLet \\(p\\) be a prime\uff0cand let \\(n, M\\) be positive integers such that\n\\[\nM \\quad \\text { divides } \\quad 1^{k}+2^{k}+\\cdots+n^{k}\n\\]\nfor \\(k=0,1, \\ldots, p-1\\) \uff0eIf \\(p \\mid n\\) then \\(\\nu_{p}(M)<\\nu_{p}(n)\\) \uff0e\n\nProof\uff0eThe hypothesis means that that any polynomial \\(f(T) \\in \\mathbb{Z}[T]\\) with \\(\\operatorname{deg} f \\leq p-1\\) will have \\(\\sum_{x=1}^{n} f(x) \\equiv 0(\\bmod M)\\) \uff0eIn particular\uff0cwe have\n\\[\n\\begin{aligned}\n0 & \\equiv \\sum_{x=1}^{n}(x-1)(x-2) \\cdots(x-(p-1)) \\\\\n& =(p-1)!\\sum_{x=1}^{n}\\binom{x-1}{p-1}=(p-1)!\\binom{n}{p} \\quad(\\bmod M)\n\\end{aligned}\n\\]\n\nBut now \\(\\nu_{p}(M) \\leq \\nu_{p}\\left(\\binom{n}{p}\\right)=\\nu_{p}(n)-1\\) \uff0e\nNow assume for contradiction that valiant \\(g: \\mathbb{Z} / n \\mathbb{Z} \\rightarrow \\mathbb{Z} / n \\mathbb{Z}\\) exists\uff0cand \\(p \\leq 101\\) is the smallest prime dividing \\(n\\) \uff0eLemma I implies that \\(k!\\sum_{x} x^{k} \\equiv 0(\\bmod n)\\) for \\(k=1, \\ldots, p-1\\) and hence \\(\\sum_{x} x^{k} \\equiv 0(\\bmod n)\\) too\uff0eThus \\(M=n\\) holds in the previous lemma\uff0cimpossible\uff0e\n\nA second solution\uff0eBoth lemmas above admit variations where we focus on working modulo \\(p^{e}\\) rather than working modulo \\(n\\) \uff0e\n\nLemma\uff08Lemma I\uff07\uff09\n\nAssume valiant \\(g: \\mathbb{Z} / n \\mathbb{Z} \\rightarrow \\mathbb{Z} / n \\mathbb{Z}\\) exists\uff0eLet \\(p \\leq 101\\) be a prime\uff0cand \\(e=\\nu_{p}(n)\\) \uff0e Then\n\\[\n\\sum_{x \\in \\mathbb{Z} / n \\mathbb{Z}} x^{k} \\equiv 0 \\quad\\left(\\bmod p^{e}\\right)\n\\]\nfor \\(k=0,1, \\ldots, p-1\\) \uff0e\n\nProof\uff0eThis is weaker than Lemma I\uff0cbut we give an independent specialized proof\uff0eBegin by writing\n\\[\n\\sum_{x}(g(x)+T x)^{k} \\equiv \\sum_{x} x^{k} \\quad\\left(\\bmod p^{e}\\right)\n\\]\n\nBoth sides are integer polynomials in \\(T\\) \uff0cwhich vanish at \\(T=0,1, \\ldots, p-1\\) by hypothesis \uff08since \\(p-1 \\leq 100\\) \uff09\uff0e\n\nWe now prove the following more general fact\uff1aif \\(f(T) \\in \\mathbb{Z}[T]\\) is an integer polynomial with \\(\\operatorname{deg} f \\leq p-1\\) \uff0csuch that \\(f(0) \\equiv \\cdots \\equiv f(p-1) \\equiv 0\\left(\\bmod p^{e}\\right)\\) \uff0cthen all coefficients of \\(f\\) are divisible by \\(p^{e}\\) \uff0eThe proof is by induction on \\(e \\geq 1\\) \uff0eWhen \\(e=1\\) \uff0cthis is just the assertion that the polynomial has at most \\(\\operatorname{deg} f\\) roots modulo \\(p\\) \uff0eWhen \\(e \\geq 2\\) \uff0cwe note that the previous result implies all coefficients are divisible by \\(p\\) \uff0cand then we divide all coefficients by \\(p\\) \uff0e\n\nApplied here\uff0cwe have that all coefficients of\n\\[\nf(T):=\\sum_{x}(g(x)+T x)^{k}-\\sum_{x} x^{k}\n\\]\nare divisible by \\(p^{e}\\) \uff0eThe leading \\(T^{k}\\) coefficient is \\(\\sum_{k} x^{k}\\) as desired\uff0e\n\nLemma\uff08Lemma II\uff07\uff09\n\nIf \\(e \\geq 1\\) is an integer\uff0cand \\(p\\) is a prime\uff0cthen\n\\[\n\\nu_{p}\\left(1^{p-1}+2^{p-1}+\\cdots+\\left(p^{e}-1\\right)^{p-1}\\right)=e-1 .\n\\]\n\nProof\uff0eFirst\uff0cnote that the cases where \\(p=2\\) or \\(e=1\\) are easy\uff1bsince if \\(p=2\\) we have \\(\\sum_{x=0}^{2^{e}-1} x \\equiv 2^{e-1}\\left(2^{e}-1\\right) \\equiv-2^{e-1}\\left(\\bmod 2^{e}\\right)\\) \uff0cwhile if \\(e=1\\) we have \\(1^{p-1}+\\cdots+(p-1)^{p-1} \\equiv -1(\\bmod p)\\) \uff0eHenceforth assume that \\(p>2, e>1\\) \uff0e\nLet \\(g\\) be an integer which is a primitive root modulo \\(p^{e}\\) \uff0eThen\uff0cwe can sum the terms which are relatively prime to \\(p\\) as\n\\[\nS_{0}:=\\sum_{\\operatorname{gcd}(x, p)=1} x^{p-1} \\equiv \\sum_{i=1}^{\\varphi\\left(p^{e}\\right)} g^{(p-1) \\cdot i} \\equiv \\frac{g^{p^{e-1}(p-1)^{2}}-1}{g^{p-1}-1} \\quad\\left(\\bmod p^{e}\\right)\n\\]\nwhich implies \\(\\nu_{p}\\left(S_{0}\\right)=e-1\\) \uff0cby lifting the exponent\uff0eMore generally\uff0cfor \\(r \\geq 1\\) we may set\n\\[\nS_{r}:=\\sum_{\\nu_{p}(x)=r} x^{p-1} \\equiv\\left(p^{r}\\right)^{p-1} \\sum_{i=1}^{\\varphi\\left(p^{e-r}\\right)} g_{r}^{(p-1) \\cdot i} \\quad\\left(\\bmod p^{e}\\right)\n\\]\nwhere \\(g_{r}\\) is a primitive root modulo \\(p^{e-r}\\) \uff0eRepeating the exponent\uff0dlifting calculation shows that \\(\\nu_{p}\\left(S_{r}\\right)=r(p-1)+((e-r)-1)>e\\) \uff0cas needed\uff0e\n\nAssume to the contrary that \\(p \\leq 101\\) is a prime dividing \\(n\\) \uff0cand a valiant \\(g: \\mathbb{Z} / n \\mathbb{Z} \\rightarrow \\mathbb{Z} / n \\mathbb{Z}\\) exists\uff0eTake \\(k=p-1\\) in Lemma I\uff07to contradict Lemma II\uff07\n\nA third remixed solution\uff0eWe use Lemma I and Lemma II\uff07from before\uff0eAs before\uff0c assume \\(g: \\mathbb{Z} / n \\mathbb{Z} \\rightarrow \\mathbb{Z} / n \\mathbb{Z}\\) is valiant\uff0cand \\(n\\) has a prime divisor \\(p \\leq 101\\) \uff0eAlso\uff0clet \\(e=\\nu_{p}(n)\\) \u3002\n\nThen \\((p-1)!\\sum_{x} x^{p-1} \\equiv 0(\\bmod n)\\) by Lemma I\uff0cand now\n\\[\n\\begin{aligned}\n0 & \\equiv \\sum_{x} x^{p-1} \\quad\\left(\\bmod p^{e}\\right) \\\\\n& \\equiv \\frac{n}{p^{e}} \\sum_{x=1}^{p^{e}-1} x^{p-1} \\not \\equiv 0 \\quad\\left(\\bmod p^{e}\\right)\n\\end{aligned}\n\\]\nby Lemma II\uff07\uff0ccontradiction\uff0e\n\nA fourth remixed solution\uff0eWe also can combine Lemma I\uff07and Lemma II\uff0eAs before\uff0c assume \\(g: \\mathbb{Z} / n \\mathbb{Z} \\rightarrow \\mathbb{Z} / n \\mathbb{Z}\\) is valiant\uff0cand let \\(p\\) be the smallest prime divisor of \\(n\\) \uff0e\n\nAssume for contradiction \\(p \\leq 101\\) \uff0eBy Lemma I\uff07we have\n\\[\n\\sum_{x} x^{k} \\equiv 0 \\quad\\left(\\bmod p^{e}\\right)\n\\]\nfor \\(k=0, \\ldots, p-1\\) \uff0eThis directly contradicts Lemma II with \\(M=p^{e}\\) \uff0e", "source_pdf": "TST_2019.pdf", "notes": ""}
{"id": "TST-2019-3", "contest": "TST", "year": "2019", "problem_number": "3", "problem": "A snake of length \\(k\\) is an animal which occupies an ordered \\(k\\)\uff0dtuple \\(\\left(s_{1}, \\ldots, s_{k}\\right)\\) of cells in an \\(n \\times n\\) grid of square unit cells\uff0eThese cells must be pairwise distinct\uff0c and \\(s_{i}\\) and \\(s_{i+1}\\) must share a side for \\(i=1, \\ldots, k-1\\) \uff0eIf the snake is currently occupying\uff08 \\(s_{1}, \\ldots, s_{k}\\) \uff09and \\(s\\) is an unoccupied cell sharing a side with \\(s_{1}\\) \uff0cthe snake can move to occupy\uff08 \\(s, s_{1}, \\ldots, s_{k-1}\\) \uff09instead\uff0eThe snake has turned around if it occupied\uff08 \\(s_{1}, s_{2}, \\ldots, s_{k}\\) \uff09at the beginning\uff0cbut after a finite number of moves occupies \\(\\left(s_{k}, s_{k-1}, \\ldots, s_{1}\\right)\\) instead\uff0e\n\nDetermine whether there exists an integer \\(n>1\\) such that one can place some snake of length at least \\(0.9 n^{2}\\) in an \\(n \\times n\\) grid which can turn around\uff0e", "solution": "The answer is yes\uff08and 0.9 is arbitrary\uff09\uff0e\n\nFirst grid\uff0dbased solution\uff0eThe following solution is due to Brian Lawrence\uff0eFor illustration reasons\uff0cwe give below a figure of a snake of length 89 turning around in an \\(11 \\times 11\\) square\uff08which generalizes readily to odd \\(n\\) \uff09\uff0eWe will see that a snake of length \\((n-1)(n-2)-1\\) can turn around in an \\(n \\times n\\) square\uff0cso this certainly implies the problem\uff0e\n\nUse the obvious coordinate system with \\((1,1)\\) in the bottom left\uff0eStart with the snake as shown in Figure 1\uff0cthen have it move to \\((2,1),(2, n),(n, n-1)\\) as in Figure 2\uff0eThen\uff0c have the snake shift to the position in Figure 3\uff1bthis is possible since the snake can just walk to \\((n, n)\\) \uff0cthen start walking to the left and then follow the route\uff1bby the time it reaches the \\(i\\) th row from the top its tail will have vacated by then\uff0eOnce it achieves Figure 3\uff0cmove the head of the snake to \\((3, n)\\) to achieve Figure 4.\n\nIn Figure 5 and 6\uff0cthe snake begins to\uff02deform\uff02its loop continuously\uff0eIn general\uff0cthis deformation by two squares is possible in the following way\uff0eThe snake walks first to \\((1, n)\\) then retraces the steps left by its tail\uff0cexcept when it reaches \\((n-1,3)\\) it makes a\nbrief detour to \\((n-2,3),(n-2,4),(n-1,4)\\) and continues along its way\uff1bthis gives the position in Figure 5\uff0eThen it retraces the entire loop again\uff0cexcept that when it reaches \uff08 \\(n-4,4\\) \uff09it turns directly down\uff0cand continues retracing its path\uff1bthus at the end of this second revolution\uff0cwe arrive at Figure 6.\n\nBy repeatedly doing perturbations of two cells\uff0cwe can move move all the\uff02bumps\uff02in the path gradually to protrude from the right\uff1bFigure 7 shows a partial application of the procedure\uff0cwith the final state as shown in Figure 8.\n\nIn Figure 9\uff0cwe stretch the bottom\uff0dmost bump by two more cells\uff1bthis shortens the \uff02tail\uff02by two units\uff0cwhich is fine\uff0eDoing this for all \\((n-3) / 2\\) bumps arrives at the situation in Figure 10\uff0cwith the snake\uff07s head at \\((3, n)\\) \uff0eWe then begin deforming the turns on the bottom\uff0dright by two steps each as in Figure 11\uff0cwhich visually will increase the length of the head\uff0eDoing this arrives finally at the situation in Figure 12\uff0eThus the snake has turned around\uff0e\n\nSecond solution phrased using graph theory\uff08Nikolai Beluhov\uff09\uff0eLet \\(G\\) be any undirected graph\uff0eConsider a snake of length \\(k\\) lying within \\(G\\) \uff0cwith each segment of the snake occupying one vertex\uff0cconsecutive segments occupying adjacent vertices\uff0cand no two segments occupying the same vertex\uff0eOne move of the snake consists of the snake\uff07s head advancing to an adjacent empty vertex and segment \\(i\\) advancing to the vertex of segment \\(i-1\\) for \\(i=2,3, \\ldots, k\\) \uff0e\n\nThe solution proceeds in two stages\uff0eFirst we construct a planar graph \\(G\\) such that it is possible for a snake that occupies nearly all of \\(G\\) to turn around inside \\(G\\) \uff0eThen we construct a subgraph \\(H\\) of a grid adjacency graph such that \\(H\\) is isomorphic to \\(G\\) and \\(H\\) occupies nearly all of the grid\uff0e\n\nFor the first stage of the solution\uff0cwe construct \\(G\\) as follows\uff0e\nLet \\(r\\) and \\(\\ell\\) be positive integers\uff0eStart with \\(r\\) disjoint main paths \\(p_{1}, p_{2}, \\ldots, p_{r}\\) \uff0ceach of length at least \\(\\ell\\) \uff0cwith \\(p_{i}\\) leading from \\(A_{i}\\) to \\(B_{i}\\) for \\(i=1,2, \\ldots, r\\) \uff0eAdd to those \\(r\\) linking paths\uff0cone leading from \\(B_{i}\\) to \\(A_{i+1}\\) for each \\(i=1,2, \\ldots, r-1\\) \uff0cand one leading from \\(B_{r}\\) to \\(A_{1}\\) \uff0eFinally\uff0cadd to those two families of transit paths\uff0cwith one family containing one transit path joining \\(A_{1}\\) to each of \\(A_{2}, A_{3}, \\ldots, A_{r}\\) and the other containing one path joining \\(B_{r}\\) to each of \\(B_{1}, B_{2}, \\ldots, B_{r-1}\\) \uff0eWe require that all paths specified in the construction have no interior vertices in common\uff0cwith the exception of transit paths in the same family\uff0e\n\nWe claim that a snake of length \\((r-1) \\ell\\) can turn around inside \\(G\\) \uff0e\nTo this end\uff0clet the concatenation \\(A_{1} B_{1} A_{2} B_{2} \\ldots A_{r} B_{r}\\) of all main and linking paths be the great cycle\uff0eWe refer to \\(A_{1} B_{1} A_{2} B_{2} \\ldots A_{r} B_{r}\\) as the counterclockwise orientation of the great cycle\uff0cand to \\(B_{r} A_{r} B_{r-1} A_{r-1} \\ldots B_{1} A_{1}\\) as its clockwise orientation\uff0e\n\nPlace the snake so that its tail is at \\(A_{1}\\) and its body extends counterclockwise along the great cycle\uff0eThen let the snake manoeuvre as follows\uff0e\uff08We track only the snake\uff07s head\uff0cas its movement uniquely determines the movement of the complete body of the snake\uff0e\uff09\n\nAt phase 1\uff0cadvance counterclockwise along the great cycle to \\(B_{r-1}\\) \uff0ctake a detour along a transit path to \\(B_{r}\\) \uff0cand advance clockwise along the great cycle to \\(A_{r}\\) \uff0e\n\nFor \\(i=2,3, \\ldots, r-1\\) \uff0cat phase \\(i\\) \uff0ctake a detour along a transit path to \\(A_{1}\\) \uff0cadvance counterclockwise along the great cycle to \\(B_{r-i}\\) \uff0ctake a detour along a transit path to \\(B_{r}\\) \uff0c and advance clockwise along the great cycle to \\(A_{r-i+1}\\) \uff0e\n\nAt phase \\(r\\) \uff0csimply advance clockwise along the great cycle to \\(A_{1}\\) \uff0e\nFor the second stage of the solution\uff0clet \\(n\\) be a sufficiently large positive integer\uff0e Consider an \\(n \\times n\\) grid \\(S\\) \uff0eNumber the columns of \\(S\\) from 1 to \\(n\\) from left to right\uff0cand its rows from 1 to \\(n\\) from bottom to top\uff0e\n\nLet \\(a_{1}, a_{2}, \\ldots, a_{r+1}\\) be cells of \\(S\\) such that all of \\(a_{1}, a_{2}, \\ldots, a_{r+1}\\) lie in column 2\uff0c \\(a_{1}\\) lies in row \\(2, a_{r+1}\\) lies in row \\(n-1\\) \uff0cand \\(a_{1}, a_{2}, \\ldots, a_{r+1}\\) are approximately equally spaced\uff0eLet \\(b_{1}, b_{2}, \\ldots, b_{r}\\) be cells of \\(S\\) such that all of \\(b_{1}, b_{2}, \\ldots, b_{r}\\) lie in column \\(n-2\\) and \\(b_{i}\\) lies in the row of \\(a_{i+1}\\) for \\(i=1,2, \\ldots, r\\) \uff0e\n\nConstruct \\(H\\) as follows\uff0eFor \\(i=1,2, \\ldots, r\\) \uff0clet the main path from \\(a_{i}\\) to \\(b_{i}\\) fill up the rectangle bounded by the rows and columns of \\(a_{i}\\) and \\(b_{i}\\) nearly completely\uff0eThen every main path is of length approximately \\(\\frac{1}{r} n^{2}\\) \uff0e\n\nFor \\(i=1,2, \\ldots, r-1\\) \uff0clet the linking path that leads from \\(b_{i}\\) to \\(a_{i+1}\\) lie inside the row of \\(b_{i}\\) and \\(a_{i+1}\\) and let the linking path that leads from \\(b_{r}\\) to \\(a_{1}\\) lie inside row \\(n\\) \uff0ccolumn \\(n\\) \uff0cand row 1 \uff0e\n\nLastly\uff0clet the union of the first family of transit paths be column 1 and let the union of the second family of transit paths be column \\(n-1\\) \uff0cwith the exception of their bottommost and topmost squares\uff0e\n\nAs in the first stage of the solution\uff0cby this construction a snake of length \\(k\\) approxi\uff0d mately equal to \\(\\frac{r-1}{r} n^{2}\\) can turn around inside an \\(n \\times n\\) grid \\(S\\) \uff0eWhen \\(r\\) is fixed and \\(n\\) tends to infinity\uff0c\\(\\frac{k}{n^{2}}\\) tends to \\(\\frac{r-1}{r}\\) \uff0eFurthermore\uff0cwhen \\(r\\) tends to infinity\uff0c\\(\\frac{r-1}{r}\\) tends to 1 \uff0e This gives the answer\uff0e", "source_pdf": "TST_2019.pdf", "notes": ""}
{"id": "TST-2019-4", "contest": "TST", "year": "2019", "problem_number": "4", "problem": "We say a function \\(f: \\mathbb{Z}_{\\geq 0} \\times \\mathbb{Z}_{\\geq 0} \\rightarrow \\mathbb{Z}\\) is great if for any nonnegative integers \\(m\\) and \\(n\\) \uff0c\n\\[\nf(m+1, n+1) f(m, n)-f(m+1, n) f(m, n+1)=1 .\n\\]\n\nIf \\(A=\\left(a_{0}, a_{1}, \\ldots\\right)\\) and \\(B=\\left(b_{0}, b_{1}, \\ldots\\right)\\) are two sequences of integers\uff0cwe write \\(A \\sim B\\) if there exists a great function \\(f\\) satisfying \\(f(n, 0)=a_{n}\\) and \\(f(0, n)=b_{n}\\) for every nonnegative integer \\(n\\)\uff08in particular\uff0c\\(a_{0}=b_{0}\\) \uff09\uff0e\n\nProve that if \\(A, B, C\\) \uff0cand \\(D\\) are four sequences of integers satisfying \\(A \\sim B\\) \uff0c \\(B \\sim C\\) \uff0cand \\(C \\sim D\\) \uff0cthen \\(D \\sim A\\) \uff0e", "solution": "We present two solutions\uff0eIn what follows\uff0cwe say\uff08 \\(A, B\\) \uff09form a great pair if \\(A \\sim B\\) \uff0e\n\nFirst solution\uff08Nikolai Beluhov\uff09\uff0eLet \\(k=a_{0}=b_{0}=c_{0}=d_{0}\\) \uff0eWe let \\(f, g, h\\) be great functions for \\((A, B),(B, C),(C, D)\\) and write the following infinite array\uff1a\n\\[\n\\left[\\begin{array}{ccccccc} \n& \\vdots & \\vdots & b_{3} & \\vdots & \\vdots & \\\\\n\\cdots & g(2,2) & g(2,1) & b_{2} & f(1,2) & f(2,2) & \\cdots \\\\\n\\cdots & g(1,2) & g(1,1) & b_{1} & f(1,1) & f(2,1) & \\cdots \\\\\nc_{3} & c_{2} & c_{1} & k & a_{1} & a_{2} & a_{3} \\\\\n\\cdots & h(2,1) & h(1,1) & d_{1} & & & \\\\\n\\cdots & h(2,2) & h(1,2) & d_{2} & & & \\\\\n& \\vdots & \\vdots & d_{3} & & & \\ddots\n\\end{array}\\right]\n\\]\n\nThe greatness condition is then equivalent to saying that any \\(2 \\times 2\\) sub\uff0dgrid has determinant \\(\\pm 1\\)\uff08the sign is +1 in two quadrants and -1 in the other two\uff09\uff0cand we wish to fill in the lower\uff0dright quadrant\uff0eTo this end\uff0cit suffices to prove the following\uff0e\n\nLemma\n\nSuppose we have a \\(3 \\times 3\\) sub\uff0dgrid\n\\[\n\\left[\\begin{array}{lll}\na & b & c \\\\\nx & y & z \\\\\np & q &\n\\end{array}\\right]\n\\]\nsatisfying the determinant conditions\uff0eThen we can fill in the ninth entry in the lower right with an integer while retaining greatness\uff0e\n\nProof\uff0eWe consider only the case where the \\(3 \\times 3\\) is completely contained inside the bottom\uff0dright quadrant\uff0csince the other cases are exactly the same\uff08or even by flipping the signs of the top row or left column appropriately\uff09\uff0e\n\nIf \\(y=0\\) we have \\(-1=b z=b x=x q\\) \uff0chence \\(q z=-1\\) \uff0cand we can fill in the entry arbitrarily\uff0e\n\nOtherwise\uff0cwe have \\(b x \\equiv x q \\equiv b z \\equiv-1(\\bmod y)\\) \uff0eThis is enough to imply \\(q z \\equiv-1 (\\bmod y)\\) \uff0cand so we can fill in the integer \\(\\frac{q z+1}{y}\\) \uff0e\n\nRemark\uff0eIn this case\uff08of all +1 determinants\uff09\uff0cI think it turns out the bottom entry is exactly equal to \\(q z a-c y p-c-p\\) \uff0cwhich is obviously an integer\uff0e\n\nSecond solution\uff08Ankan Bhattacharya\uff09\uff0eWe will give an explicit classification of great sequences\uff1a\n\nLemma\n\nThe pair\uff08 \\(A, B\\) \uff09is great if and only if \\(a_{0}=b_{0}, a_{0} \\mid a_{1} b_{1}+1\\) \uff0cand \\(a_{n} \\mid a_{n-1}+a_{n+1}\\) and \\(b_{n} \\mid b_{n-1}+b_{n+1}\\) for all \\(n\\) \uff0e\n\nProof of necessity\uff0eIt is clear that \\(a_{0}=b_{0}\\) \uff0eThen \\(a_{0} f(1,1)-a_{1} b_{1}=1\\) \uff0ci\uff0ee\uff0e\\(a_{0} \\mid a_{1} b_{1}+1\\) \uff0e\nNow\uff0cfocus on six entries \\(f(x, y)\\) with \\(x \\in\\{n-1, n, n+1\\}\\) and \\(y \\in\\{0,1\\}\\) \uff0eLet \\(f(n-1,1)=u, f(n, 1)=v\\) \uff0cand \\(f(n+1,1)=w\\) \uff0cso\n\\[\n\\begin{gathered}\nv a_{n-1}-u a_{n}=1, \\\\\nw a_{n}-v a_{n+1}=1 .\n\\end{gathered}\n\\]\n\nThen\n\\[\nu+w=\\frac{v\\left(a_{n-1}+a_{n+1}\\right)}{a_{n}}\n\\]\nand from above \\(\\operatorname{gcd}\\left(v, a_{n}\\right)=1\\) \uff0cso \\(a_{n} \\mid a_{n-1}+a_{n+1}\\) \uff1bsimilarly for \\(b_{n}\\) \uff0e\uff08If \\(a_{n}=0\\) \uff0cwe have \\(v a_{n-1}=1\\) and \\(v a_{n+1}=-1\\) \uff0cso this is OK\uff0e\uff09\n\nProof of sufficiency\uff0eNow consider two sequences \\(a_{0}, a_{1}, \\ldots\\) and \\(b_{0}, b_{1}, \\ldots\\) satisfying our criteria\uff0eWe build a great function \\(f\\) by induction on \\((x, y)\\) \uff0eMore strongly\uff0cwe will assume as part of the inductive hypothesis that any two adjacent entries of \\(f\\) are relatively prime and that for any three consecutive entries horizontally or vertically\uff0cthe middle one divides the sum of the other two\uff0e\n\nFirst we set \\(f(1,1)\\) so that \\(a_{0} f(1,1)=a_{1} b_{1}+1\\) \uff0cwhich is possible\uff0e\nConsider an uninitialized \\(f(s, t)\\) \uff1bwithout loss of generality suppose \\(s \\geq 2\\) \uff0eThen we know five values of \\(f\\) and wish to set a sixth one \\(z\\) \uff0cas in the matrix below\uff1a\n\\[\n\\begin{array}{ll}\nu & x \\\\\nv & y \\\\\nw & z\n\\end{array}\n\\]\n\uff08We imagine \\(a\\)\uff0dindices to increase southwards and \\(b\\)\uff0dindices to increase eastwards\uff0e\uff09If \\(v \\neq 0\\) \uff0cthen the choice \\(y \\cdot \\frac{u+w}{v}-x\\) works as \\(u y-v x=1\\) \uff0eIf \\(v=0\\) \uff0cit easily follows that \\(\\{u, w\\}=\\{1,-1\\}\\) and \\(y=w\\) as \\(y w=1\\) \uff0eThen we set the uninitialized entry to anything\uff0e\n\nNow we verify that this is compatible with the inductive hypothesis\uff0eFrom the determinant 1 condition\uff0cit easily follows that \\(\\operatorname{gcd}(w, z)=\\operatorname{gcd}(v, z)=1\\) \uff0eThe proof that \\(y \\mid x+z\\) is almost identical to a step performed in the\uff02necessary\uff02part of the lemma and we do not repeat it here\uff0eBy induction\uff0ca desired great function \\(f\\) exists\uff0e\n\nWe complete the solution\uff0eLet \\(A, B, C\\) \uff0cand \\(D\\) be integer sequences for which \\((A, B)\\) \uff0c \uff08 \\(B, C\\) \uff09\uff0cand\uff08 \\(C, D\\) \uff09are great\uff0eThen \\(a_{0}=b_{0}=c_{0}=d_{0}\\) \uff0cand each term in each sequence \uff08after the zeroth term\uff09divides the sum of its neighbors\uff0eSince \\(a_{0}\\) divides all three of \\(a_{1} b_{1}+1, b_{1} c_{1}+1\\) \uff0cand \\(c_{1} d_{1}+1\\) \uff0cit follows \\(a_{0}\\) divides \\(d_{1} a_{1}+1\\) \uff0cand thus\uff08 \\(D, A\\) \uff09is great as desired\uff0e\n\nRemark\uff0eTo simplify the problem\uff0cwe may restrict the codomain of great functions and elements in great pairs of sequences to \\(\\mathbb{Z}_{>0}\\) \uff0eThis allows the parts of the solution dealing with zero entries to be ignored\uff0e\n\nRemark\uff0eOf course\uff0cthis solution also shows that any odd path\uff08in the graph induced by the great relation on sequences\uff09completes to an even cycle\uff0eIf we stipulate that great functions must have \\(f(0,0)= \\pm 1\\) \uff0cthen even paths complete to cycles as well\uff0eAlternatively\uff0cwe could change the great functional equation to\n\\[\nf(x+1, y+1) f(x, y)-f(x+1, y) f(x, y+1)=-1\n\\]\n\nA quick counterexample to transitivity of \\(\\sim\\) as is without the condition \\(f(0,0)=1\\) \uff0cfor concreteness\uff1alet \\(a_{n}=c_{n}=3+n\\) and \\(b_{n}=3+2 n\\) for \\(n \\geq 0\\) \uff0e", "source_pdf": "TST_2019.pdf", "notes": ""}
{"id": "TST-2019-5", "contest": "TST", "year": "2019", "problem_number": "5", "problem": "Let \\(n\\) be a positive integer\uff0eTasty and Stacy are given a circular necklace with \\(3 n\\) sapphire beads and \\(3 n\\) turquoise beads\uff0csuch that no three consecutive beads have the same color\uff0eThey play a cooperative game where they alternate turns removing three consecutive beads\uff0csubject to the following conditions\uff1a\n\uff0dTasty must remove three consecutive beads which are turquoise\uff0csapphire\uff0cand turquoise\uff0cin that order\uff0con each of his turns\uff0e\n\uff0dStacy must remove three consecutive beads which are sapphire\uff0cturquoise\uff0cand sapphire\uff0cin that order\uff0con each of her turns\uff0e\n\nThey win if all the beads are removed in \\(2 n\\) turns\uff0eProve that if they can win with Tasty going first\uff0cthey can also win with Stacy going first\uff0e", "solution": "In the necklace\uff0cwe draw a divider between any two beads of the same color\uff0eUnless there are no dividers\uff0cthis divides the necklace into several zigzags in which the beads in each zigzag alternate\uff0eEach zigzag has two endpoints\uff08adjacent to dividers\uff09\uff0e\n\nObserve that the condition about not having three consecutive matching beads is equivalent to saying there are no zigzags of lengths 1 \uff0e\n\nThe main claim is that the game is winnable\uff08for either player going first\uff09if and only if there are at most \\(2 n\\) dividers\uff0eWe prove this in two parts\uff0cthe first part not using the hypothesis about three consecutive letters\uff0e\n\nClaim\uff0dThe game cannot be won with Tasty going first if there are more than \\(2 n\\) dividers\uff0e\n\nProof\uff0eWe claim each move removes at most one divider\uff0cwhich proves the result\uff0e\nConsider removing a TST in some zigzag\uff08necessarily of length at least 3\uff09\uff0eWe illustrate the three possibilities in the following table\uff0cwith Tasty\uff07s move shown in red\uff0e\n\n\\begin{tabular}{ccl} \nBefore & After & Change \\\\\n\\hline\\(\\ldots\\) ST \\(\\mid\\) TST \\(\\mid\\) TS \\(\\ldots\\) & \\(\\ldots\\) ST \\(\\mid\\) TS \\(\\ldots\\) & One less divider\uff1btwo zigzags merge \\\\\n\\(\\ldots\\) ST \\(\\mid\\) TSTST \\(\\ldots\\) & \\(\\ldots\\) STST \\(\\ldots\\) & One less divider\uff1btwo zigzags merge \\\\\n\\(\\ldots\\) STSTS \\(\\ldots\\) & \\(\\ldots\\) S \\(\\mid\\) S \\(\\ldots\\) & One more divider\uff1ba zigzag splits in two\n\\end{tabular}\n\nThe analysis for Stacy\uff07s move is identical\uff0e\n\nClaim\uff0dIf there are at most \\(2 n\\) dividers and there are no zigzags of length 1 then the game can be won\uff08with either player going first\uff09\uff0e\n\nProof\uff0eBy symmetry it is enough to prove Tasty wins going first\uff0e\nAt any point if there are no dividers at all\uff0cthen the necklace alternates \\(T S T S T \\ldots\\) and the game can be won\uff0eSo we will prove that on each of Tasty\uff07s turns\uff0cif there exists at least one divider\uff0cthen Tasty and Stacy can each make a move at an endpoint of some zigzag\uff08i\uff0ee\uff0ethe first two cases above\uff09\uff0eAs we saw in the previous proof\uff0csuch moves will\uff08a\uff09decrease the number of dividers by exactly one\uff0c\uff08b\uff09not introduce any singleton zigzags\uff08because the old zigzags merge\uff0crather than split\uff09\uff0eSince there are fewer than \\(2 n\\) dividers\uff0cour duo can eliminate all dividers and then win\uff0e\n\nNote that as the number of \\(S\\) and \\(T\\)\uff07s are equal\uff0cthere must be an equal number of\n\uff0dzigzags of odd length\uff08 \\(\\geq 3\\) \uff09with \\(T\\) at the endpoints\uff08i\uff0ee\uff0eone more \\(T\\) than \\(S\\) \uff09\uff0cand\n\uff0dzigzags of odd length\uff08 \\(\\geq 3\\) \uff09with \\(S\\) at the endpoints\uff08i\uff0ee\uff0eone more \\(S\\) than \\(T\\) \uff09\uff0e\nNow iff there is at least one of each\uff0cthen Tasty removes a \\(T S T\\) from the end of such a zigzag while Stacy removes an \\(S T S\\) from the end of such a zigzag\uff0e\n\nOtherwise suppose all zigzags have even size\uff0eThen Tasty finds any zigzag of length \\(\\geq 4\\)\uff08which must exist since the average zigzag length is 3 \uff09and removes \\(T S T\\) from the end containing \\(T\\) \uff0eThe resulting merged zigzag is odd and hence \\(S\\) endpoints\uff0chence Stacy can move as well\uff0e\n\nRemark\uff0eThere are many equivalent ways to phrase the solution\uff0eFor example\uff0cthe number of dividers is equal to the number of pairs of two consecutive letters\uff08rather than singleton letters\uff09\uff0eSo the win condition can also be phrased in terms of the number of adjacent pairs of letters being at least \\(2 n\\) \uff0cor equivalently the number of differing pairs being at least \\(4 n\\) \uff0e\n\nIf one thinks about the game as a process\uff0cthis is a natural\uff02monovariant\uff02to consider anyways\uff0cso the solution is not so unmotivated\uff0e\n\nRemark\uff0eThe constraint of no three consecutive identical beads is actually needed\uff1aa counterexample without this constraint is TTSTSTSTTSSS\uff0e\uff08They win if Tasty goes first and lose if Stacy goes first\uff0e\uff09\n\nRemark\uff08Why induction is unlikely to work\uff09\uff0eMany contestants attempted induction\uff0e However\uff0cin doing so they often implicitly proved a different problem\uff1a\uff02prove that if they can win with Tasty going first without ever creating a triplet\uff0cthey can also win in such a way with Stacy going first\uff02\uff0eThis essentially means nearly all induction attempts fail\uff0e\n\nAmusingly\uff0ceven the modified problem\uff08which is much more amenable to induction\uff09sill seems difficult without some sort of global argument\uff0eConsider a position in which Tasty wins going first\uff0cwith the sequence of winning moves being Tasty\uff07s first move in red below\nand Stacy\uff07s second move in blue below\uff1a\n\nThere is no\uff02nearby\uff02\\(S T S\\) that Stacy can remove instead on her first turn\uff0cwithout introduc\uff0d ing a triple\uff0d\\(T\\) and also preventing Tasty from taking a \\(T S T\\) \uff0eSo it does not seem possible to easily change a Tasty\uff0dfirst winning sequence to a Stacy\uff0dfirst one\uff0ceven in the modified version\uff0e", "source_pdf": "TST_2019.pdf", "notes": ""}
{"id": "TST-2019-6", "contest": "TST", "year": "2019", "problem_number": "6", "problem": "Let \\(A B C\\) be a triangle with incenter \\(I\\) \uff0cand let \\(D\\) be a point on line \\(B C\\) satisfying \\(\\angle A I D=90^{\\circ}\\) \uff0eLet the excircle of triangle \\(A B C\\) opposite the vertex \\(A\\) be tangent to \\(\\overline{B C}\\) at point \\(A_{1}\\) \uff0eDefine points \\(B_{1}\\) on \\(\\overline{C A}\\) and \\(C_{1}\\) on \\(\\overline{A B}\\) analogously\uff0cusing the excircles opposite \\(B\\) and \\(C\\) \uff0crespectively\uff0e\n\nProve that if quadrilateral \\(A B_{1} A_{1} C_{1}\\) is cyclic\uff0cthen \\(\\overline{A D}\\) is tangent to the circum\uff0d circle of \\(\\triangle D B_{1} C_{1}\\) \uff0e", "solution": "We present two solutions\uff0e\n\nFirst solution using spiral similarity\uff08Ankan Bhattacharya\uff09\uff0eFirst\uff0cwe prove the part of the problem which does not depend on the condition \\(A B_{1} A_{1} C_{1}\\) is cyclic\uff0e\n\nLemma\n\nLet \\(A B C\\) be a triangle and define \\(I, D, B_{1}, C_{1}\\) as in the problem\uff0eMoreover\uff0clet \\(M\\) denote the midpoint of \\(\\overline{A D}\\) \uff0eThen \\(\\overline{A D}\\) is tangent to \\(\\left(A B_{1} C_{1}\\right)\\) \uff0cand moreover \\(\\overline{B_{1} C_{1}} \\| \\overline{I M}\\) \uff0e\n\nProof\uff0eLet \\(E\\) and \\(F\\) be the tangency points of the incircle\uff0eDenote by \\(Z\\) the Miquel point of \\(B F E C\\) \uff0ci\uff0ee\uff0ethe second intersection of the circle with diameter \\(\\overline{A I}\\) and the circumcircle\uff0e\n\nNote that \\(A, Z, D\\) are collinear\uff0cby radical axis on \\((A B C),(A F I E),(B I C)\\) \uff0e\n\nThen the spiral similarity gives us\n\\[\n\\frac{Z F}{Z E}=\\frac{B F}{C E}=\\frac{A C_{1}}{A B_{1}}\n\\]\nwhich together with \\(\\measuredangle F Z E=\\measuredangle F A E=\\measuredangle B A C\\) implies that \\(\\triangle Z F E\\) and \\(\\triangle A C_{1} B_{1}\\) are\uff08directly\uff09similar\uff0e\uff08See IMO Shortlist 2006 G9 for a similar application of spiral similarity\uff0e\uff09\n\nNow the remainder of the proof is just angle chasing\uff0eFirst\uff0csince\n\\[\n\\measuredangle D A C_{1}=\\measuredangle Z A F=\\measuredangle Z E F=\\measuredangle A B_{1} C_{1}\n\\]\nwe have \\(\\overline{A D}\\) is tangent to \\(\\left(A B_{1} C_{1}\\right)\\) \uff0eMoreover\uff0cto see that \\(\\overline{I M} \\| \\overline{B_{1} C_{1}}\\) \uff0cwrite\n\\[\n\\begin{aligned}\n\\measuredangle\\left(\\overline{A I}, \\overline{B_{1} C_{1}}\\right) & =\\measuredangle I A C+\\measuredangle A B_{1} C_{1}=\\measuredangle B A I+\\measuredangle Z E F=\\measuredangle F A I+\\measuredangle Z A F \\\\\n& =\\measuredangle Z A I=\\measuredangle M A I=\\measuredangle A I M\n\\end{aligned}\n\\]\nthe last step since \\(\\triangle A I D\\) is right with hypotenuse \\(\\overline{A D}\\) \uff0cand median \\(\\overline{I M}\\) \uff0e\nNow we return to the present problem with the additional condition\uff0e\n\nClaim\uff0dGiven the condition\uff0cwe actually have \\(\\angle A B_{1} A_{1}=\\angle A C_{1} A_{1}=90^{\\circ}\\) \uff0e\n\nProof\uff0eLet \\(I_{A}, I_{B}\\) and \\(I_{C}\\) be the excenters of \\(\\triangle A B C\\) \uff0eThen the perpendiculars to \\(\\overline{B C}\\) \uff0c \\(\\overline{C A}, \\overline{A B}\\) from \\(A_{1}, B_{1}, C_{1}\\) respectively meet at the so\uff0dcalled Bevan point \\(V\\)\uff08which is the circumcenter of \\(\\triangle I_{A} I_{B} I_{C}\\) \uff09\uff0e\n\nNow \\(\\triangle A B_{1} C_{1}\\) has circumdiameter \\(\\overline{A V}\\) \uff0eWe are given \\(A_{1}\\) lies on this circle\uff0cso if \\(V \\neq A_{1}\\) then \\(\\overline{A A_{1}} \\perp \\overline{A_{1} V}\\) \uff0eBut \\(\\overline{A_{1} V} \\perp \\overline{B C}\\) by definition\uff0cwhich would imply \\(\\overline{A A_{1}} \\| \\overline{B C}\\) \uff0cwhich is absurd\uff0e\n\nClaim\uff0dGiven the condition the points \\(B_{1}, I, C_{1}\\) are collinear\uff08hence with \\(M\\) \uff09\uff0e\n\nProof\uff0eBy Pappus theorem on \\(\\overline{I_{B} A I_{C}}\\) and \\(\\overline{B A_{1} C}\\) after the previous claim\uff0e\nTo finish\uff0csince \\(\\overline{D M A}\\) was tangent to the circumcircle of \\(\\triangle A B_{1} C_{1}\\) \uff0cwe have \\(M D^{2}= M A^{2}=M C_{1} \\cdot M B_{1}\\) \uff0cimplying the required tangency\uff0e\n\nRemark\uff0eThe triangles satisfying the problem hypothesis are exactly the ones satisfying \\(r_{A}=2 R\\) \uff0cwhere \\(R\\) and \\(r_{A}\\) denote the circumradius and \\(A\\)\uff0dexradius\uff0e\n\nRemark\uff0eIf \\(P\\) is the foot of the \\(A\\)\uff0daltitude then this should also imply \\(A B_{1} P C_{1}\\) is harmonic\uff0e\n\nSecond solution by inversion and mixtilinears\uff08Anant Mudgal\uff09\uff0eAs in the end of the preceding solution\uff0cwe have \\(\\angle A B_{1} A_{1}=\\angle A C_{1} A_{1}=90^{\\circ}\\) and \\(I \\in \\overline{B_{1} C_{1}}\\) \uff0eLet \\(M\\) be the midpoint of minor \\(\\operatorname{arc} B C\\) and \\(N\\) be the midpoint of \\(\\operatorname{arc} \\widehat{B A C}\\) \uff0eLet \\(L\\) be the intouch point on \\(\\overline{B C}\\) \uff0eLet \\(O\\) be the circumcenter of \\(\\triangle A B C\\) \uff0eLet \\(K=\\overline{A I} \\cap \\overline{B C}\\) \uff0e\n\nClaim\uff0dWe have \\(\\angle\\left(\\overline{A I}, \\overline{B_{1} C_{1}}\\right)=\\angle I A D\\) \uff0e\n\nProof\uff0eLet \\(Z\\) lie on \\((A B C)\\) with \\(\\angle A Z I=90^{\\circ}\\) \uff0eBy radical axis theorem on \\((A I Z),(B I C)\\) \uff0c and\uff08 \\(A B C\\) \uff09\uff0cwe conclude that \\(D\\) lies on \\(\\overline{A Z}\\) \uff0eLet \\(\\overline{N I}\\) meet\uff08 \\(A B C\\) \uff09again at \\(T \\neq N\\) \uff0e\n\nInversion in\uff08 \\(B I C\\) \uff09maps \\(\\overline{A I}\\) to \\(\\overline{K I}\\) and\uff08 \\(A B C\\) \uff09to \\(\\overline{B C}\\) \uff0eThus\uff0c\\(Z\\) maps to \\(L\\) \uff0cso \\(Z, L, M\\) are collinear\uff0eSince \\(B L=C V\\) and \\(O I=O V\\) \uff0cwe see that \\(M L I N\\) is a trapezoid with \\(\\overline{I L} \\| \\overline{M N}\\) \uff0eThus\uff0c\\(\\overline{Z T} \\| \\overline{M N}\\) \uff0e\n\nIt is known that \\(\\overline{A T}\\) and \\(\\overline{A A_{1}}\\) are isogonal in angle \\(B A C\\) \uff0eSince \\(\\overline{A V}\\) is a circumdiameter in \\(\\left(A B_{1} C_{1}\\right)\\) \uff0cso \\(\\overline{A T} \\perp \\overline{B_{1} C_{1}}\\) \uff0eSo \\(\\measuredangle Z A I=\\measuredangle N M T=90^{\\circ}-\\measuredangle T A I=\\measuredangle\\left(\\overline{A I}, \\overline{B_{1} C_{1}}\\right)\\) \uff0e\n\nLet \\(X\\) be the midpoint of \\(\\overline{A D}\\) and \\(G\\) be the reflection of \\(I\\) in \\(X\\) \uff0eSince \\(A I D G\\) is a rectangle\uff0cwe have \\(\\measuredangle A I G=\\measuredangle Z A I=\\measuredangle\\left(\\overline{A I}, \\overline{B_{1} C_{1}}\\right)\\) \uff0cby the previous claim\uff0eSo \\(\\overline{I G}\\) coincides with \\(\\overline{B_{1} C_{1}}\\) \uff0eNow \\(\\overline{A I}\\) bisects \\(\\angle B_{1} A C_{1}\\) and \\(\\angle I A G=90^{\\circ}\\) \uff0cso \\(\\left(\\overline{I G} ; \\overline{B_{1} C_{1}}\\right)=-1\\) \uff0e\n\nSince \\(\\angle I D G=90^{\\circ}\\) \uff0cwe see that \\(\\overline{D I}\\) and \\(\\overline{D G}\\) are bisectors of angle \\(B_{1} D C_{1}\\) \uff0eNow \\(\\angle X D I=\\angle X I D \\Longrightarrow \\angle X D C_{1}=\\angle X I D-\\angle I D B_{1}=\\angle D B_{1} C_{1}\\) \uff0cso \\(\\overline{X D}\\) is tangent to \\(\\left(D B_{1} C_{1}\\right)\\) \uff0e", "source_pdf": "TST_2019.pdf", "notes": ""}
{"id": "TST-2020-1", "contest": "TST", "year": "2020", "problem_number": "1", "problem": "Choose positive integers \\(b_{1}, b_{2}, \\ldots\\) satisfying\n\\[\n1=\\frac{b_{1}}{1^{2}}>\\frac{b_{2}}{2^{2}}>\\frac{b_{3}}{3^{2}}>\\frac{b_{4}}{4^{2}}>\\cdots\n\\]\nand let \\(r\\) denote the largest real number satisfying \\(\\frac{b_{n}}{n^{2}} \\geq r\\) for all positive integers \\(n\\). What are the possible values of \\(r\\) across all possible choices of the sequence \\(\\left(b_{n}\\right)\\) ?", "solution": "The answer is \\(0 \\leq r \\leq 1 / 2\\). Obviously \\(r \\geq 0\\).\nIn one direction, we show that\nClaim (Greedy bound) - For all integers \\(n\\), we have\n\\[\n\\frac{b_{n}}{n^{2}} \\leq \\frac{1}{2}+\\frac{1}{2 n}\n\\]\n\nProof. This is by induction on \\(n\\). For \\(n=1\\) it is given. For the inductive step we have\n\\[\n\\begin{aligned}\nb_{n} & <n^{2} \\frac{b_{n-1}}{(n-1)^{2}} \\leq n^{2}\\left(\\frac{1}{2}+\\frac{1}{2(n-1)}\\right)=\\frac{n^{3}}{2(n-1)} \\\\\n& =\\frac{1}{2}\\left[n^{2}+n+1+\\frac{1}{n-1}\\right] \\\\\n& =\\frac{n(n+1)}{2}+\\frac{1}{2}\\left[1+\\frac{1}{n-1}\\right] \\\\\n& \\leq \\frac{n(n+1)}{2}+1\n\\end{aligned}\n\\]\n\nSo \\(b_{n}<\\frac{n(n+1)}{2}+1\\) and since \\(b_{n}\\) is an integer, \\(b_{n} \\leq \\frac{n(n+1)}{2}\\). This implies the result.\nWe now give a construction. For \\(r=1 / 2\\) we take \\(b_{n}=\\frac{1}{2} n(n+1)\\) for \\(r=0\\) we take \\(b_{n}=1\\).\n\nClaim (Explicit construction, given by Nikolai Beluhov) - Fix \\(0<r<1 / 2\\). Let \\(N\\) be large enough that \\(\\left\\lceil r n^{2}+n\\right\\rceil<\\frac{1}{2} n(n+1)\\) for all \\(n \\geq N\\). Then the following sequence works:\n\\[\nb_{n}= \\begin{cases}\\left\\lceil r n^{2}+n\\right\\rceil & n \\geq N \\\\\n\\frac{n^{2}+n}{2} & n<N\\end{cases}\n\\]\n\nProof. We certainly have\n\\[\n\\frac{b_{n}}{n^{2}}=\\frac{r n^{2}+n+O(1)}{n^{2}} \\xrightarrow{n \\rightarrow \\infty} r\n\\]\n\nMainly, we contend \\(b_{n} n^{-2}\\) is strictly decreasing. We need only check this for \\(n \\geq N\\); in fact\n\\[\n\\frac{b_{n}}{n^{2}} \\geq \\frac{r n^{2}+n}{n^{2}}>\\frac{\\left[r(n+1)^{2}+(n+1)\\right]+1}{(n+1)^{2}}>\\frac{b_{n+1}}{(n+1)^{2}}\n\\]\nwhere the middle inequality is true since it rearranges to \\(\\frac{1}{n}>\\frac{n+2}{(n+1)^{2}}\\).", "source_pdf": "TST_2020.pdf", "notes": ""}
{"id": "TST-2020-2", "contest": "TST", "year": "2020", "problem_number": "2", "problem": "Two circles \\(\\Gamma_{1}\\) and \\(\\Gamma_{2}\\) have common external tangents \\(\\ell_{1}\\) and \\(\\ell_{2}\\) meeting at \\(T\\). Suppose \\(\\ell_{1}\\) touches \\(\\Gamma_{1}\\) at \\(A\\) and \\(\\ell_{2}\\) touches \\(\\Gamma_{2}\\) at \\(B\\). A circle \\(\\Omega\\) through \\(A\\) and \\(B\\) intersects \\(\\Gamma_{1}\\) again at \\(C\\) and \\(\\Gamma_{2}\\) again at \\(D\\), such that quadrilateral \\(A B C D\\) is convex.\n\nSuppose lines \\(A C\\) and \\(B D\\) meet at point \\(X\\), while lines \\(A D\\) and \\(B C\\) meet at point \\(Y\\). Show that \\(T, X, Y\\) are collinear.", "solution": "We present four solutions.\n\nIf First solution, elementary (original). We have \\(\\triangle Y A C \\sim \\triangle Y B D\\), from which it follows\n\\[\n\\frac{d(Y, A C)}{d(Y, B D)}=\\frac{A C}{B D}\n\\]\n\nMoreover, if we denote by \\(r_{1}\\) and \\(r_{2}\\) the radii of \\(\\Gamma_{1}\\) and \\(\\Gamma_{2}\\), then\n\\[\n\\frac{d(T, A C)}{d(T, B D)}=\\frac{T A \\sin \\angle\\left(A C, \\ell_{1}\\right)}{T B \\sin \\angle\\left(B D, \\ell_{2}\\right)}=\\frac{2 r_{1} \\sin \\angle\\left(A C, \\ell_{1}\\right)}{2 r_{2} \\sin \\angle\\left(B D, \\ell_{2}\\right)}=\\frac{A C}{B D}\n\\]\nthe last step by the law of sines.\n\nThis solves the problem up to configuration issues: we claim that \\(Y\\) and \\(T\\) both lie inside \\(\\angle A X B \\equiv \\angle C X D\\). WLOG \\(T A<T B\\).\n- The former is since \\(Y\\) lies outside segments \\(B C\\) and \\(A D\\), since we assumed \\(A B C D\\) was convex.\n- For the latter, we note that \\(X\\) lies inside both \\(\\Gamma_{1}\\) and \\(\\Gamma_{2}\\) in fact on the radical axis of the two circles (since \\(X\\) was an interior point of both chords \\(A C\\) and \\(B D\\) ). In particular, \\(X\\) is contained inside \\(\\angle A T B\\), and moreover \\(\\angle A T B<90^{\\circ}\\), and this is enough to imply the result.\n\nIT Second solution, inversive. This is based on the solution posted by kapilpavase on AoPS. Consider the inversion at \\(T\\) swapping \\(\\Gamma_{1}\\) and \\(\\Gamma_{2}\\); we let it send \\(A\\) to \\(E, B\\) to \\(F\\), \\(C\\) to \\(V, D\\) to \\(W\\), as shown. Draw circles \\(A D W E\\) and \\(B C V F\\).\n\nClaim - Points \\(T\\) and \\(Y\\) lie on the radical axis of ( \\(A D E\\) ) and ( \\(B C F\\) ).\n\nProof. Because \\(T F \\cdot T B=T A \\cdot T E\\) and \\(Y A \\cdot Y D=Y C \\cdot Y B\\).\n\nClaim - Point \\(X\\) has equal power to \\((A D E)\\) and \\((B C F)\\).\n\nProof. Since \\(T V \\cdot T C=T A \\cdot T E\\), quadrilateral \\(V C E A\\) is cyclic too, so by radical axis with \\(\\Gamma_{1}\\) and \\(\\Gamma_{2}\\) we find \\(X\\) lies on \\(V E\\). Similarly, \\(X\\) lies on \\(F W\\). Thus, \\(X\\) is the center of negative inversion between ( \\(A D E\\) ) and ( \\(B C F\\) ).\n\nBut since \\(A E=B F\\) and moreover\n\\[\n\\begin{aligned}\n\\measuredangle B C F+\\measuredangle A D E & =(\\measuredangle B C A+\\measuredangle A C F)+(\\measuredangle A D B+\\measuredangle B D E) \\\\\n& =(\\measuredangle B C A+\\measuredangle A D B)+(\\measuredangle A C F+\\measuredangle B D E)=0+0=0\n\\end{aligned}\n\\]\nwe conclude that ( \\(A D E\\) ) and ( \\(B C F\\) ) are congruent. As \\(X\\) was the center of negative inversion between them, we're done.\n\nIT Third solution, projective (Nikolai Beluhov). We start with some definitions. Let \\(\\ell_{1}\\) touch \\(\\Gamma_{2}\\) at \\(E, \\ell_{2}\\) touch \\(\\Gamma_{1}\\) at \\(F, K=\\ell_{1} \\cap \\overline{B D}, L=\\ell_{2} \\cap \\overline{A C}\\), line \\(F X\\) meet \\(\\Gamma_{1}\\) again at \\(M\\), line \\(E X\\) meet \\(\\Gamma_{2}\\) again at \\(N\\), and lines \\(A B, A D\\), and \\(B C\\) meet line \\(T X\\) at \\(Z, Y_{1}\\), and \\(Y_{2}\\). Thus the desired statement is equivalent to \\(Y_{1}=Y_{2}\\).\n\\[\n\\text { Claim - }(E B ; N D)_{\\Gamma_{2}}=(F A ; M C)_{\\Gamma_{1}} .\n\\]\n\nProof. Note that \\(A X \\cdot X C=B X \\cdot X D=E X \\cdot X N\\), so \\(A E C N\\) is cyclic. Likewise \\(B F D M\\) is cyclic.\n\nConsider the inversion with center \\(T\\) which swaps \\(\\Gamma_{1}\\) and \\(\\Gamma_{2}\\); it also swaps the pairs \\(\\{A, E\\}\\) and \\(\\{B, F\\}\\). Since \\(A E C N\\) is cyclic, \\(C\\) is on \\(\\Gamma_{1}\\), and \\(N\\) is on \\(\\Gamma_{2}\\), it also swaps \\(\\{C, N\\}\\); similarly it swaps \\(\\{D, M\\}\\).\n\nThus \\((E B ; N D)_{\\Gamma_{2}}=(A F ; C M)_{\\Gamma_{1}}=(F A ; M C)_{\\Gamma_{1}}\\) as desired.\nWith this claim, the remainder of the proof is chasing cross-ratios:\n\\[\n\\left(T Z ; X Y_{1}\\right) \\stackrel{A}{=}(K B ; X D) \\stackrel{E}{=}(E B ; N D)_{\\Gamma_{2}}=(F A ; M C)_{\\Gamma_{1}} \\stackrel{F}{=}(L A ; X C) \\stackrel{B}{=}\\left(T Z ; X Y_{2}\\right)\n\\]\nimplies \\(Y_{1}=Y_{2}\\) as desired.\n\nIT Fourth solution by untethered moving points. Fix \\(\\ell_{1}, \\ell_{2}, T, \\Gamma_{1}\\) and \\(\\Gamma_{2}\\), and let \\(\\Gamma_{1}\\) and \\(\\Gamma_{2}\\) meet at \\(U\\) and \\(V\\). By the radical axis theorem, \\(X\\) lies on \\(U V\\).\n\nThus we instead treat \\(X\\) as a variable point on line \\(U V\\) and let \\(C=A X \\cap \\Gamma_{1}\\), \\(D=B X \\cap \\Gamma_{2}\\). By definition, \\(X\\) has degree 1 and \\(T\\) has degree 0 .\n\nWe apply Zack's lemma to untethered point \\(Y\\). Note that \\(C\\) and \\(D\\) move projectively on conics, and therefore have degree 2. Then, lines \\(A D\\) and \\(B C\\) each have degree at most \\(\\operatorname{deg}(A)+\\operatorname{deg}(D)=0+2=2\\), and so their intersection \\(Y\\) has degree at most \\(2+2=4\\). But when \\(X \\in A B\\), the lines \\(A D\\) and \\(B C\\) are the same, so Zack's lemma implies that\n\\[\n\\operatorname{deg} Y \\leq 4-1=3\n\\]\n\nThus the assertion that \\(T, X, Y\\) are collinear (which for example can be seen as a certain vanishing determinant) is a statement of degree at most \\(0+1+3=4\\). Thus it suffices to find 5 values of \\(X\\) (other than \\(X \\in \\overline{A B}\\), which we used already). This is remarkably easy:\n1. When \\(X=U\\) or \\(X=V\\), then \\(X=C=D=Y\\) and the statement is obvious.\n2. When \\(X \\in \\ell_{1}\\), say, then \\(A=C\\) and so \\(Y\\) lies on \\(A C=\\ell_{1}\\) as well. The case \\(X \\in \\ell_{2}\\) is symmetric.\n3. Finally, take \\(X\\) at infinity along \\(U V\\). Then \\(C\\) and \\(D\\) are the other tangency points of the circles with \\(\\ell_{1}, \\ell_{2}\\), and so \\(A C=\\ell_{1}, B D=\\ell_{2}\\), so \\(Y=T\\).\n\nThis finishes the problem.", "source_pdf": "TST_2020.pdf", "notes": ""}
{"id": "TST-2020-3", "contest": "TST", "year": "2020", "problem_number": "3", "problem": "Let \\(\\alpha \\geq 1\\) be a real number. Hephaestus and Poseidon play a turn-based game on an infinite grid of unit squares. Before the game starts, Poseidon chooses a finite number of cells to be flooded. Hephaestus is building a levee, which is a subset of unit edges of the grid, called walls, forming a connected, non-self-intersecting path or loop.\nThe game then begins with Hephaestus moving first. On each of Hephaestus's turns, he adds one or more walls to the levee, as long as the total length of the levee is at most \\(\\alpha n\\) after his \\(n\\)th turn. On each of Poseidon's turns, every cell which is adjacent to an already flooded cell and with no wall between them becomes flooded as well.\nHephaestus wins if the levee forms a closed loop such that all flooded cells are contained in the interior of the loop - hence stopping the flood and saving the world. For which \\(\\alpha\\) can Hephaestus guarantee victory in a finite number of turns no matter how Poseidon chooses the initial cells to flood?", "solution": "We show that if \\(\\alpha>2\\) then Hephaestus wins, but when \\(\\alpha=2\\) (and hence \\(\\alpha \\leq 2\\) ) Hephaestus cannot contain even a single-cell flood initially.\n\nStrategy for \\(\\alpha>2\\) : Impose \\(\\mathbb{Z}^{2}\\) coordinates on the cells. Adding more flooded cells does not make our task easier, so let us assume that initially the cells ( \\(x, y\\) ) with \\(|x|+|y| \\leq d\\) are flooded for some \\(d \\geq 2\\); thus on Hephaestus's \\(k\\) th turn, the water is contained in \\(|x|+|y| \\leq d+k-1\\). Our goal is to contain the flood with a large rectangle.\n\nWe pick large integers \\(N_{1}\\) and \\(N_{2}\\) such that\n\\[\n\\begin{aligned}\n\\alpha N_{1} & >2 N_{1}+(2 d+3) \\\\\n\\alpha\\left(N_{1}+N_{2}\\right) & >2 N_{2}+\\left(6 N_{1}+8 d+4\\right) .\n\\end{aligned}\n\\]\n\nMark the points \\(X_{i}, Y_{i}\\) as shown in the figure for \\(1 \\leq i \\leq 6\\). The red figures indicate the distance between the marked points on the rectangle.\n\nWe follow the following plan.\n- Turn 1: place wall \\(X_{1} Y_{1}\\). This cuts off the flood to the north.\n- Turns 2 through \\(N_{1}+1\\) : extend the levee to segment \\(X_{2} Y_{2}\\). This prevents further flooding to the north.\n- Turn \\(N_{1}+2\\) : add in broken lines \\(X_{4} X_{3} X_{2}\\) and \\(Y_{4} Y_{3} Y_{2}\\) all at once. This cuts off the flood west and east.\n- Turns \\(N_{1}+2\\) to \\(N_{1}+N_{2}+1\\) : extend the levee along segments \\(X_{4} X_{5}\\) and \\(Y_{4} Y_{5}\\). This prevents further flooding west and east.\n- Turn \\(N_{1}+N_{2}+2\\) : add in the broken line \\(X_{5} X_{6} Y_{6} Y_{5}\\) all at once and win.\n\nProof for \\(\\alpha=2\\) : Suppose Hephaestus contains the flood on his \\((n+1)\\) st turn. We prove that \\(\\alpha>2\\) by showing that in fact at least \\(2 n+4\\) walls have been constructed.\n\nLet \\(c_{0}, c_{1}, \\ldots, c_{n}\\) be a path of cells such that \\(c_{0}\\) is the initial cell flooded, and in general \\(c_{i}\\) is flooded on Poseidon's \\(i\\) th turn from \\(c_{i-1}\\). The levee now forms a closed loop enclosing all \\(c_{i}\\).\n\nClaim - If \\(c_{i}\\) and \\(c_{j}\\) are adjacent then \\(|i-j|=1\\).\n\nProof. Assume \\(c_{i}\\) and \\(c_{j}\\) are adjacent but \\(|i-j|>1\\). Then the two cells must be separated by a wall. But the levee forms a closed loop, and now \\(c_{i}\\) and \\(c_{j}\\) are on opposite sides.\n\nThus the \\(c_{i}\\) actually form a path. We color green any edge of the unit grid (wall or not) which is an edge of exactly one \\(c_{i}\\) (i.e. the boundary of the polyomino). It is easy to see there are exactly \\(2 n+4\\) green edges.\n\nNow, from the center of each cell \\(c_{i}\\), shine a laser towards each green edge of \\(c_{i}\\) (hence a total of \\(2 n+4\\) lasers are emitted). An example below is shown for \\(n=6\\), with the levee marked in brown.\n\nClaim - No wall is hit by more than one laser.\n\nProof. Assume for contradiction that a wall \\(w\\) is hit by lasers from \\(c_{i}\\) and \\(c_{j}\\). WLOG that laser is vertical, so \\(c_{i}\\) and \\(c_{j}\\) are in the same column (e.g. \\((i, j)=(0,5)\\) in figure).\n\nWe consider two cases on the position of \\(w\\).\n- If \\(w\\) is between \\(c_{i}\\) and \\(c_{j}\\), then we have found a segment intersecting the levee exactly once. But the endpoints of the segment lie inside the levee. This contradicts the assumption that the levee is a closed loop.\n- Suppose \\(w\\) lies above both \\(c_{i}\\) and \\(c_{j}\\) and assume WLOG \\(i<j\\). Then we have found that there is no levee at all between \\(c_{i}\\) and \\(c_{j}\\).\nLet \\(\\rho \\geq 1\\) be the distance between the centers of \\(c_{i}\\) and \\(c_{j}\\). Then \\(c_{j}\\) is flooded in a straight line from \\(c_{i}\\) within \\(\\rho\\) turns, and this is the unique shortest possible path. So this situation can only occur if \\(j=i+\\rho\\) and \\(c_{i}, \\ldots, c_{j}\\) form a column. But then no vertical lasers from \\(c_{i}\\) and \\(c_{j}\\) may point in the same direction, contradiction.\n\nSince neither case is possible, the proof ends here.\nThis implies the levee has at least \\(2 n+4\\) walls (the number of lasers) on Hephaestus's \\((n+1)\\) st turn. So \\(\\alpha \\geq \\frac{2 n+4}{n+1}>2\\).\n\nRemark (Author comments). The author provides the following remarks.\n- Even though the flood can be stopped when \\(\\alpha=2+\\varepsilon\\), it takes a very long time to do that. Starting from a single flooded cell, the strategy I have outlined requires \\(\\Theta\\left(1 / \\varepsilon^{2}\\right)\\) days. Starting from several flooded cells contained within an area of diameter \\(D\\), it takes \\(\\Theta\\left(D / \\varepsilon^{2}\\right)\\) days. I do not know any strategies that require fewer days than that.\n- There is a gaping chasm between \\(\\alpha \\leq 2\\) and \\(\\alpha>2\\). Since \\(\\alpha \\leq 2\\) does not suffice even when only one cell is flooded in the beginning, there are in fact no initial\nconfigurations at all for which it is sufficient. On the other hand, \\(\\alpha>2\\) works for all initial configurations.\n- The second half of the solution essentially estimates the perimeter of a polyomino in terms of its diameter (where diameter is measured entirely within the polyomino).\nIt appears that this has not been done before, or at least I was unable to find any reference for it. I did find tons of references where the perimeter of a polyomino is estimated in terms of its area, but nothing concerning the diameter.\nMy argument is a formalisation of the intuition that if \\(P\\) is any shortest path within some weirdly-shaped polyomino, then the boundary of that polyomino must hug \\(P\\) rather closely so that \\(P\\) cannot be shortened.", "source_pdf": "TST_2020.pdf", "notes": ""}
{"id": "TST-2020-4", "contest": "TST", "year": "2020", "problem_number": "4", "problem": "For a finite simple graph \\(G\\), we define \\(G^{\\prime}\\) to be the graph on the same vertex set as \\(G\\), where for any two vertices \\(u \\neq v\\), the pair \\(\\{u, v\\}\\) is an edge of \\(G^{\\prime}\\) if and only if \\(u\\) and \\(v\\) have a common neighbor in \\(G\\). Prove that if \\(G\\) is a finite simple graph which is isomorphic to \\(\\left(G^{\\prime}\\right)^{\\prime}\\), then \\(G\\) is also isomorphic to \\(G^{\\prime}\\).", "solution": "We say a vertex of a graph is fatal if it has degree at least 3 , and some two of its neighbors are not adjacent.\n\nClaim - The graph \\(G^{\\prime}\\) has at least as many triangles as \\(G\\), and has strictly more if \\(G\\) has any fatal vertices.\n\nProof. Obviously any triangle in \\(G\\) persists in \\(G^{\\prime}\\). Moreover, suppose \\(v\\) is a fatal vertex of \\(G\\). Then the neighbors of \\(G\\) will form a clique in \\(G^{\\prime}\\) which was not there already, so there are more triangles.\n\nThus we only need to consider graphs \\(G\\) with no fatal vertices. Looking at the connected components, the only possibilities are cliques (including single vertices), cycles, and paths. So in what follows we restrict our attention to graphs \\(G\\) only consisting of such components.\n\nRemark (Warning). Beware: assuming \\(G\\) is connected loses generality. For example, it could be that \\(G=G_{1} \\sqcup G_{2}\\), where \\(G_{1}^{\\prime} \\cong G_{2}\\) and \\(G_{2}^{\\prime} \\cong G_{1}\\).\n\nFirst, note that the following are stable under the operation:\n- an isolated vertex,\n- a cycle of odd length, or\n- a clique with at least three vertices.\n\nIn particular, \\(G \\cong G^{\\prime \\prime}\\) holds for such graphs.\nOn the other hand, cycles of even length or paths of nonzero length will break into more connected components. For this reason, a graph \\(G\\) with any of these components will not satisfy \\(G \\cong G^{\\prime \\prime}\\) because \\(G^{\\prime}\\) will have strictly more connected components than \\(G\\), and \\(G^{\\prime \\prime}\\) will have at least as many as \\(G^{\\prime}\\).\n\nTherefore \\(G \\cong G^{\\prime \\prime}\\) if and only if \\(G\\) is a disjoint union of the three types of connected components named earlier. Since \\(G \\cong G^{\\prime}\\) holds for such graphs as well, the problem statement follows right away.\n\nRemark. Note that the same proof works equally well for an arbitrary number of iterations \\(G^{\\prime \\prime} \\cdots^{\\prime \\prime} \\cong G\\), rather than just \\(G^{\\prime \\prime} \\cong G\\).\n\nRemark. The proposers included a variant of the problem where given any graph \\(G\\), the operation stabilized after at most \\(O(\\log n)\\) operations, where \\(n\\) was the number of vertices of \\(G\\).", "source_pdf": "TST_2020.pdf", "notes": ""}
{"id": "TST-2020-5", "contest": "TST", "year": "2020", "problem_number": "5", "problem": "Find all integers \\(n \\geq 2\\) for which there exists an integer \\(m\\) and a polynomial \\(P(x)\\) with integer coefficients satisfying the following three conditions:\n- \\(m>1\\) and \\(\\operatorname{gcd}(m, n)=1\\);\n- the numbers \\(P(0), P^{2}(0), \\ldots, P^{m-1}(0)\\) are not divisible by \\(n\\); and\n- \\(P^{m}(0)\\) is divisible by \\(n\\).\n\nHere \\(P^{k}\\) means \\(P\\) applied \\(k\\) times, so \\(P^{1}(0)=P(0), P^{2}(0)=P(P(0))\\), etc.", "solution": "The answer is that this is possible if and only if there exists primes \\(p^{\\prime}<p\\) such that \\(p \\mid n\\) and \\(p^{\\prime} \\nmid n\\). (Equivalently, the radical \\(\\operatorname{rad}(n)\\) must not be the product of the first several primes.)\n\nFor a polynomial \\(P\\), and an integer \\(N\\), we introduce the notation\n\\[\n\\operatorname{zord}(P \\bmod N):=\\min \\left\\{e>0 \\mid P^{e}(0) \\equiv 0 \\bmod N\\right\\}\n\\]\nwhere we set \\(\\min \\varnothing=0\\) by convention. Note that in general we have\n\\[\n\\operatorname{zord}(P \\bmod N)=\\underset{q \\mid N}{\\operatorname{lcm}}(\\operatorname{zord}(P \\bmod q))\n\\]\nwhere the index runs over all prime powers \\(q \\mid N\\) (by Chinese remainder theorem). This will be used in both directions.\n\nConstruction: First, we begin by giving a construction. The idea is to first use the following prime power case.\n\nClaim - Let \\(p^{e}\\) be a prime power, and \\(1 \\leq k<p\\). Then\n\\[\nf(X)=X+1-k \\cdot \\frac{X(X-1)(X-2) \\ldots(X-(k-2))}{(k-1)!}\n\\]\nviewed as a polynomial in \\(\\left(\\mathbb{Z} / p^{e}\\right)[X]\\) satisfies \\(\\operatorname{zord}\\left(f \\bmod p^{e}\\right)=k\\).\n\nProof. Note \\(f(0)=1, f(1)=2, \\ldots, f(k-2)=k-1, f(k-1)=0\\) as needed.\nThis gives us a way to do the construction now. For the prime power \\(p^{e} \\mid n\\), we choose \\(1 \\leq p^{\\prime}<p\\) and require \\(\\operatorname{zord}\\left(P \\bmod p^{e}\\right)=p^{\\prime}\\) and \\(\\operatorname{zord}(P \\bmod q)=1\\) for every other prime power \\(q\\) dividing \\(n\\). Then by ( \\(\\dagger\\) ) we are done.\n\nRemark. The claim can be viewed as a special case of Lagrange interpolation adapted to work over \\(\\mathbb{Z} / p^{e}\\) rather than \\(\\mathbb{Z} / p\\). Thus the construction of the polynomial \\(f\\) above is quite natural.\n\nNecessity: by ( \\(\\dagger\\) ) again, it will be sufficient to prove the following claim.\n\nClaim - For any prime power \\(q=p^{e}\\), and any polynomial \\(f(x) \\in \\mathbb{Z}[x]\\), if the quantity \\(\\operatorname{zord}(f \\bmod q)\\) is nonzero then it has all prime factors at most \\(p\\).\n\nProof. This is by induction on \\(e \\geq 1\\). For \\(e=1\\), the pigeonhole principle immediately implies that \\(\\operatorname{zord}(P \\bmod p) \\leq p\\).\n\nNow assume \\(e \\geq 2\\). Let us define\n\\[\nk:=\\operatorname{zord}\\left(P \\bmod p^{e-1}\\right), \\quad Q:=P^{k}\n\\]\n\nSince being periodic modulo \\(p^{e}\\) requires periodic modulo \\(p^{e-1}\\), it follows that\n\\[\n\\operatorname{zord}\\left(P \\bmod p^{e}\\right)=k \\cdot \\operatorname{zord}\\left(Q \\bmod p^{e}\\right)\n\\]\n\nHowever since \\(Q(0) \\equiv 0 \\bmod p^{e-1}\\), it follows \\(\\left\\{Q(0), Q^{2}(0), \\ldots\\right\\}\\) are actually all multiples of \\(p^{e-1}\\). There are only \\(p\\) residues modulo \\(p^{e}\\) which are also multiples of \\(p^{e-1}\\), so \\(\\boldsymbol{\\operatorname { z o r d }}\\left(Q \\bmod p^{e}\\right) \\leq p\\), as needed.\n\nRemark. One reviewer submitted the following test-solving comments:\nThis is one of these problems where you can make many useful natural observations, and if you make enough of them eventually they cohere into a solution. For example, here are some things I noticed while solving:\n- The polynomial \\(1-x\\) shows that \\(m=2\\) works for any odd \\(n\\).\n- In general, if \\(\\zeta\\) is a primitive \\(m\\) th root of unity modulo \\(n\\), then \\(\\zeta(x+1)-1\\) has the desired property (assuming \\(\\operatorname{gcd}(m, n)=1)\\). We can extend this using the Chinese remainder theorem to find that if \\(p|n, m| p-1\\), and \\(\\operatorname{gcd}(m, n)=1\\), then \\(n\\) works. So by this point I already have something about the prime factors of \\(n\\) being sort-of closed downwards.\n- By iterating \\(P\\) we see it is enough to consider \\(m\\) prime.\n- In the case where \\(n=2^{k}\\), it is not too difficult to show that no odd prime \\(m\\) works.", "source_pdf": "TST_2020.pdf", "notes": ""}
{"id": "TST-2020-6", "contest": "TST", "year": "2020", "problem_number": "6", "problem": "Let \\(P_{1} P_{2} \\ldots P_{100}\\) be a cyclic 100 -gon, and let \\(P_{i}=P_{i+100}\\) for all \\(i\\). Define \\(Q_{i}\\) as the intersection of diagonals \\(\\overline{P_{i-2} P_{i+1}}\\) and \\(\\overline{P_{i-1} P_{i+2}}\\) for all integers \\(i\\).\nSuppose there exists a point \\(P\\) satisfying \\(\\overline{P P_{i}} \\perp \\overline{P_{i-1} P_{i+1}}\\) for all integers \\(i\\). Prove that the points \\(Q_{1}, Q_{2}, \\ldots, Q_{100}\\) are concyclic.", "solution": "We show two solutions. In addition, Luke Robitaille has a reasonable complex numbers solution posted at https://aops.com/community/p26795631.\n\nI Solution to proposed problem. We let \\(\\overline{P P_{2}}\\) and \\(\\overline{P_{1} P_{3}}\\) intersect (perpendicularly) at point \\(K_{2}\\), and define \\(K_{\\bullet}\\) cyclically.\n\nClaim - The points \\(K_{\\bullet}\\) are concyclic say with circumcircle \\(\\gamma\\).\n\nProof. Note that \\(P P_{1} \\times P K_{1}=P P_{2} \\times P K_{2}=\\ldots\\) so the result follows by inversion at \\(P\\).\n\nLet \\(E_{i}\\) be the second intersection of line \\(\\overline{P_{i-1} K_{i} P_{i+1}}\\) with \\(\\gamma\\); then it follows that the perpendiculars to \\(\\overline{P_{i-1} P_{i+1}}\\) at \\(E_{i}\\) all concur at a point \\(E\\), which is the reflection of \\(P\\) across the center of \\(\\gamma\\).\n\nWe let \\(H_{2}=\\overline{P_{1} P_{3}} \\cap \\overline{P_{2} P_{4}}\\) denote the orthocenter of \\(\\triangle P P_{2} P_{3}\\) and define \\(H_{\\bullet}\\) cyclically.\n\nClaim - We have\n\\[\n\\overline{E H_{2}} \\perp \\overline{P_{1} P_{4}} \\| \\overline{K_{2} K_{3}} \\quad \\text { and } \\quad \\overline{P H_{2}} \\perp \\overline{E_{2} E_{3}} \\| \\overline{P_{2} P_{3}} .\n\\]\n\nProof. Both parallelisms follow by Reim's theorem through \\(\\angle E_{2} H_{2} E_{3}=\\angle K_{2} H_{2} K_{3}\\), So we need to show the perpendicularities.\n\nNote that \\(\\overline{H_{2} P}\\) and \\(\\overline{H_{2} E}\\) are respectively circum-diameters of \\(\\triangle H_{2} K_{2} K_{3}\\) and \\(\\triangle H_{2} E_{2} E_{3}\\). As \\(\\overline{K_{2} K_{3}}\\) and \\(\\overline{E_{2} E_{3}}\\) are anti-parallel, it follows \\(\\overline{H_{2} P}\\) and \\(\\overline{H_{2} E}\\) are isogonal and we derive both perpendicularities.\n\nClaim - The points \\(E, Q_{3}, E_{3}\\) are collinear.\n\nProof. We use the previous claim. The parallelisms imply that\n\\[\n\\frac{E_{3} H_{2}}{E_{3} P_{2}}=\\frac{E_{2} H_{2}}{E_{2} P_{3}}=\\frac{E_{4} H_{3}}{E_{4} P_{3}}=\\frac{E_{3} H_{3}}{E_{3} P_{4}} .\n\\]\n\nNow consider a homothety centered at \\(E_{3}\\) sending \\(H_{2}\\) to \\(P_{2}\\) and \\(H_{3}\\) to \\(P_{4}\\). Then it should send the orthocenter of \\(\\triangle E H_{2} H_{3}\\) to \\(Q_{3}\\), proving the result.\n\nFrom all this it follows that \\(\\triangle E Q_{2} Q_{3} \\sim \\triangle P K_{2} K_{3}\\) as the opposite sides are all parallel. Repeating this we actually find a homothety of 100 -gons\n\\[\nQ_{1} Q_{2} Q_{3} \\cdots \\sim K_{1} K_{2} K_{3} \\cdots\n\\]\nand that concludes the proof.\nRemark. The proposer remarks that in fact, if one lets \\(s\\) be an integer and instead defines \\(R_{i}=P_{i} P_{i+s} \\cap P_{i+1} P_{i+s+1}\\), then the \\(R_{\\bullet}\\) are concyclic. The present problem is the case \\(s=3\\). We comment on a few special cases:\n- There is nothing to prove for \\(s=1\\).\n- If \\(s=0\\), this amounts to proving that poles of \\(\\overline{P_{i} P_{i+1}}\\) are concyclic; by inversion this is equivalent to showing the midpoints of the sides are concyclic. This is an interesting problem but not as difficult.\n- The problem for \\(s=2\\) is to show that our \\(H \\bullet\\) are concyclic, which uses the \\(s=0\\) case as a lemma.\n\nIT Solution to generalization (Nikolai Beluhov). We are going to need some well-known lemmas.\n\n\\section*{Lemma}\n\nSuppose that \\(A B C D\\) is inscribed in a circle \\(\\Gamma\\). Let the tangents to \\(\\Gamma\\) at \\(A\\) and \\(B\\) meet at \\(E\\), let the tangents to \\(\\Gamma\\) at \\(C\\) and \\(D\\) meet at \\(F\\), and let diagonals \\(A C\\) and \\(B D\\) meet at \\(P\\). Then points \\(E, F\\), and \\(P\\) are collinear.\n\nProof. Let the circle of center \\(E\\) and radius \\(E A=E B\\) meet lines \\(A C\\) and \\(B D\\) for the second time at points \\(U\\) and \\(V\\). By a simple angle chase, triangles \\(E U V\\) and \\(F C D\\) are homothetic.\n\n\\section*{Lemma}\n\nSuppose that points \\(X\\) and \\(Y\\) are isogonal conjugates in polygon \\(\\mathcal{A}=A_{1} A_{2} \\ldots A_{n}\\). (This means that lines \\(A_{i} X\\) and \\(A_{i} Y\\) are symmetric with respect to the interior angle bisector of \\(\\angle A_{i-1} A_{i} A_{i+1}\\) for all \\(i\\), where \\(A_{n+j} \\equiv A_{j}\\) for all \\(j\\).) Then the \\(2 n\\) projections of \\(X\\) and \\(Y\\) on the sides of \\(\\mathcal{A}\\) are concyclic.\n\nProof. By a simple angle chase, for all \\(i\\) we have that the four projections on sides \\(A_{i-1} A_{i}\\) and \\(A_{i} A_{i+1}\\) are concyclic. Say that they lie on circle \\(\\Gamma_{i}\\). Consider the midpoint \\(M\\) of segment \\(X Y\\). For every side \\(s\\) of \\(\\mathcal{A}\\), we have that \\(M\\) is equidistant from the projections of \\(X\\) and \\(Y\\) on \\(s\\). Therefore, \\(M\\) is the center of \\(\\Gamma_{i}\\) for all \\(i\\), and thus all of the \\(\\Gamma_{i}\\) coincide.\n\n\\section*{Lemma}\n\nLet \\(\\Gamma^{\\prime}\\) and \\(\\Gamma^{\\prime \\prime}\\) be two circles and let \\(r\\) be some fixed real number. Then the locus of points \\(X\\) satisfying \\(\\operatorname{Pow}\\left(X, \\Gamma^{\\prime}\\right): \\operatorname{Pow}\\left(X, \\Gamma^{\\prime \\prime}\\right)=r\\) is a circle.\n\nProof. This is a classical result in circle geometry. A full proof is given, for example, in item 115 of Roger Johnson's Advanced Euclidean Geometry.\n\nWe are ready to solve the problem. Let \\(\\mathcal{P}\\) be our polygon, let \\(O\\) be its the circumcenter, and let \\(\\Gamma\\) be its circumcircle.\n\nFix any index \\(i\\). In triangle \\(P_{i-1} P_{i} P_{i+1}\\), we have that line \\(P_{i} P\\) contains the altitude through \\(P_{i}\\) and line \\(P_{i} O\\) contains the circumradius through \\(P_{i}\\). Therefore, these two lines are symmetric with respect to the interior angle bisector of \\(\\angle P_{i-1} P_{i} P_{i+1}\\).\n\nThus points \\(P\\) and \\(O\\) are isogonal conjugates in \\(\\mathcal{P}\\). By Lemma 2, it follows that the projections of \\(O\\) onto the sides of \\(\\mathcal{P}\\) are concyclic. In other words, the midpoints of the sides of \\(\\mathcal{P}\\) lie on some circle \\(\\omega\\).\n\nLet \\(M_{i}\\) be the midpoint of segment \\(P_{i} P_{i+1}\\) and let the tangents to \\(\\Gamma\\) at points \\(P_{i}\\) and \\(P_{i+1}\\) meet at \\(T_{i}\\). Since inversion with respect to \\(\\Gamma\\) swaps \\(M_{i}\\) and \\(T_{i}\\) for all \\(i\\), and also since all of the \\(M_{i}\\) lie on the same circle \\(\\omega\\), we obtain that all of the \\(T_{i}\\) lie on the same circle \\(\\Omega\\).\n\nAgain, fix any index \\(i\\). By Lemma 1 applied to cyclic quadrilateral \\(P_{i-2} P_{i-1} P_{i+1} P_{i+2}\\), we have that point \\(Q_{i}\\) lies on line \\(T_{i-2} T_{i+1}\\). Similarly, point \\(Q_{i+1}\\) lies on line \\(T_{i-1} T_{i+2}\\).\n\nDefine\n\\[\nf_{i}=\\frac{\\operatorname{Pow}\\left(Q_{i}, \\Gamma\\right)}{\\operatorname{Pow}\\left(Q_{i}, \\Omega\\right)} .\n\\]\n\nClaim - We have \\(f_{i}=f_{i+1}\\) for all \\(i\\).\n\nProof. Note that\n\\[\n\\begin{aligned}\n\\operatorname{Pow}\\left(Q_{i}, \\Gamma\\right) & =Q_{i} P_{i-1} \\cdot Q_{i} P_{i+2} \\\\\n\\operatorname{Pow}\\left(Q_{i+1}, \\Gamma\\right) & =Q_{i+1} P_{i-1} \\cdot Q_{i+1} P_{i+2} . \\\\\n\\operatorname{Pow}\\left(Q_{i}, \\Omega\\right) & =Q_{i} T_{i-2} \\cdot Q_{i} T_{i+1} \\\\\n\\operatorname{Pow}\\left(Q_{i+1}, \\Omega\\right) & =Q_{i+1} T_{i-1} \\cdot Q_{i+1} T_{i+2} .\n\\end{aligned}\n\\]\n\nConsider cyclic quadrilateral \\(T_{i-2} T_{i-1} T_{i+1} T_{i+2}\\). Since \\(\\Gamma\\) touches its opposite sides \\(T_{i-2} T_{i-1}\\) and \\(T_{i+1} T_{i+2}\\) at points \\(P_{i-1}\\) and \\(P_{i+2}\\), we have that line \\(P_{i-1} P_{i+2}\\) makes equal angles with these opposite sides. From here, a simple angle chase shows that triangles \\(P_{i-1} Q_{i} T_{i-2}\\) and \\(P_{i+2} Q_{i+1} T_{i+2}\\) are similar. Thus\n\\[\n\\frac{Q_{i} P_{i-1}}{Q_{i} T_{i-2}}=\\frac{Q_{i+1} P_{i+2}}{Q_{i+1} T_{i+2}} .\n\\]\n\nSimilarly,\n\\[\n\\frac{Q_{i} P_{i+2}}{Q_{i} T_{i+1}}=\\frac{Q_{i+1} P_{i-1}}{Q_{i+1} T_{i-1}} .\n\\]\n\nFrom these, the desired identity \\(f_{i}=f_{i+1}\\) follows.\nTherefore, the power ratio \\(f_{i}\\) is the same for all \\(i\\). By Lemma 3 for circles \\(\\Gamma\\) and \\(\\Omega\\), the solution is complete.\n\nRemark. This solution applies to the full generalization (from 3 to \\(s\\) ) mentioned in the end of the previous solution, essentially with no change.\n\nRemark. Polygon \\(T_{1} T_{2} \\ldots T_{100}\\) is both circumscribed about a circle and inscribed inside a circle. Polygons like that are known as Poncelet polygons. See, for example, https: //en.wikipedia.org/wiki/Poncelet's_closure_theorem. This solution borrows a lot from the discussion of Poncelet's closure theorem in Advanced Euclidean Geometry, referenced above for Lemma 3.", "source_pdf": "TST_2020.pdf", "notes": ""}
{"id": "TST-2021-1", "contest": "TST", "year": "2021", "problem_number": "1", "problem": "Determine all integers \\(s \\geq 4\\) for which there exist positive integers \\(a, b, c, d\\) such that \\(s=a+b+c+d\\) and \\(s\\) divides \\(a b c+a b d+a c d+b c d\\).", "solution": "The answer is \\(s\\) composite.\n\nIT Composite construction. Write \\(s=(w+x)(y+z)\\), where \\(w, x, y, z\\) are positive integers. Let \\(a=w y, b=w z, c=x y, d=x z\\). Then\n\\[\na b c+a b d+a c d+b c d=w x y z(w+x)(y+z)\n\\]\nso this works.\n\nIf Prime proof. Choose suitable \\(a, b, c, d\\). Then\n\\[\n(a+b)(a+c)(a+d)=(a b c+a b d+a c d+b c d)+a^{2}(a+b+c+d) \\equiv 0 \\quad(\\bmod s) .\n\\]\n\nHence \\(s\\) divides a product of positive integers less than \\(s\\), so \\(s\\) is composite.\nRemark. Here is another proof that \\(s\\) is composite.\nSuppose that \\(s\\) is prime. Then the polynomial \\((x-a)(x-b)(x-c)(x-d) \\in \\mathbb{F}_{s}[x]\\) is even, so the roots come in two opposite pairs in \\(\\mathbb{F}_{s}\\). Thus the sum of each pair is at least \\(s\\), so the sum of all four is at least \\(2 s>s\\), contradiction.", "source_pdf": "TST_2021.pdf", "notes": ""}
{"id": "TST-2021-2", "contest": "TST", "year": "2021", "problem_number": "2", "problem": "Points \\(A, V_{1}, V_{2}, B, U_{2}, U_{1}\\) lie fixed on a circle \\(\\Gamma\\), in that order, and such that \\(B U_{2}>A U_{1}>B V_{2}>A V_{1}\\).\n\nLet \\(X\\) be a variable point on the arc \\(V_{1} V_{2}\\) of \\(\\Gamma\\) not containing \\(A\\) or \\(B\\). Line \\(X A\\) meets line \\(U_{1} V_{1}\\) at \\(C\\), while line \\(X B\\) meets line \\(U_{2} V_{2}\\) at \\(D\\).\n\nProve there exists a fixed point \\(K\\), independent of \\(X\\), such that the power of \\(K\\) to the circumcircle of \\(\\triangle X C D\\) is constant.", "solution": "For brevity, we let \\(\\ell_{i}\\) denote line \\(U_{i} V_{i}\\) for \\(i=1,2\\).\nWe first give an explicit description of the fixed point \\(K\\). Let \\(E\\) and \\(F\\) be points on \\(\\Gamma\\) such that \\(\\overline{A E} \\| \\ell_{1}\\) and \\(\\overline{B F} \\| \\ell_{2}\\). The problem conditions imply that \\(E\\) lies between \\(U_{1}\\) and \\(A\\) while \\(F\\) lies between \\(U_{2}\\) and \\(B\\). Then we let\n\\[\nK=\\overline{A F} \\cap \\overline{B E} .\n\\]\n\nThis point exists because \\(A E F B\\) are the vertices of a convex quadrilateral.\nRemark (How to identify the fixed point). If we drop the condition that \\(X\\) lies on the arc, then the choice above is motivated by choosing \\(X \\in\\{E, F\\}\\). Essentially, when one chooses \\(X \\rightarrow E\\), the point \\(C\\) approaches an infinity point. So in this degenerate case, the only points whose power is finite to ( \\(X C D\\) ) are bounded are those on line \\(B E\\). The same logic shows that \\(K\\) must lie on line \\(A F\\). Therefore, if the problem is going to work, the fixed point must be exactly \\(\\overline{A F} \\cap \\overline{B E}\\).\n\nWe give two possible approaches for proving the power of \\(K\\) with respect to \\((X C D)\\) is fixed.\n\nFirst approach by Vincent Huang. We need the following claim:\nClaim - Suppose distinct lines \\(A C\\) and \\(B D\\) meet at \\(X\\). Then for any point \\(K\\)\n\\[\n\\operatorname{pow}(K, X A B)+\\operatorname{pow}(K, X C D)=\\operatorname{pow}(K, X A D)+\\operatorname{pow}(K, X B C) .\n\\]\n\nProof. The difference between the left-hand side and right-hand side is a linear function in \\(K\\), which vanishes at all of \\(A, B, C, D\\).\n\nConstruct the points \\(P=\\ell_{1} \\cap \\overline{B E}\\) and \\(Q=\\ell_{2} \\cap \\overline{A F}\\), which do not depend on \\(X\\).\nClaim - Quadrilaterals \\(B P C X\\) and \\(A Q D X\\) are cyclic.\n\nProof. By Reim's theorem: \\(\\measuredangle C P B=\\measuredangle A E B=\\measuredangle A X B=\\measuredangle C X B\\), etc.\n\nNow, for the particular \\(K\\) we choose, we have\n\\[\n\\begin{aligned}\n\\operatorname{pow}(K, X C D) & =\\operatorname{pow}(K, X A D)+\\operatorname{pow}(K, X B C)-\\operatorname{pow}(K, X A B) \\\\\n& =K A \\cdot K Q+K B \\cdot K P-\\operatorname{pow}(K, \\Gamma) .\n\\end{aligned}\n\\]\n\nThis is fixed, so the proof is completed.\n\nIf Second approach by authors. Let \\(Y\\) be the second intersection of ( \\(X C D\\) ) with \\(\\Gamma\\). Let \\(S=\\overline{E Y} \\cap \\ell_{1}\\) and \\(T=\\overline{F Y} \\cap \\ell_{2}\\).\n\nClaim - Points \\(S\\) and \\(T\\) lies on ( \\(X C D\\) ) as well.\n\nProof. By Reim's theorem: \\(\\measuredangle C S Y=\\measuredangle A E Y=\\measuredangle A X Y=\\measuredangle C X Y\\), etc.\nNow let \\(X^{\\prime}\\) be any other choice of \\(X\\), and define \\(C^{\\prime}\\) and \\(D^{\\prime}\\) in the obvious way. We are going to show that \\(K\\) lies on the radical axis of ( \\(X C D\\) ) and ( \\(X^{\\prime} C^{\\prime} D^{\\prime}\\) ).\n\nThe main idea is as follows:\nClaim - The point \\(L=\\overline{E Y} \\cap \\overline{A X^{\\prime}}\\) lies on the radical axis. By symmetry, so does the point \\(M=\\overline{F Y} \\cap \\overline{B X^{\\prime}}\\) (not pictured).\n\nProof. Again by Reim's theorem, \\(S C^{\\prime} Y X^{\\prime}\\) is cyclic. Hence we have\n\\[\n\\operatorname{pow}\\left(L, X^{\\prime} C^{\\prime} D^{\\prime}\\right)=L C^{\\prime} \\cdot L X^{\\prime}=L S \\cdot L Y=\\operatorname{pow}(L, X C D) .\n\\]\n\nTo conclude, note that by Pascal theorem on\n\\[\nE Y F A X^{\\prime} B\n\\]\nit follows \\(K, L, M\\) are collinear, as needed.\nRemark. All the conditions about \\(U_{1}, V_{1}, U_{2}, V_{2}\\) at the beginning are there to eliminate configuration issues, making the problem less obnoxious to the contestant.\n\nIn particular, without the various assumptions, there exist configurations in which the point \\(K\\) is at infinity. In these cases, the center of \\(X C D\\) moves along a fixed line.", "source_pdf": "TST_2021.pdf", "notes": ""}
{"id": "TST-2021-3", "contest": "TST", "year": "2021", "problem_number": "3", "problem": "Find all functions \\(f: \\mathbb{R} \\rightarrow \\mathbb{R}\\) that satisfy the inequality\n\\[\nf(y)-\\left(\\frac{z-y}{z-x} f(x)+\\frac{y-x}{z-x} f(z)\\right) \\leq f\\left(\\frac{x+z}{2}\\right)-\\frac{f(x)+f(z)}{2}\n\\]\nfor all real numbers \\(x<y<z\\).", "solution": "Answer: all functions of the form \\(f(y)=a y^{2}+b y+c\\), where \\(a, b, c\\) are constants with \\(a \\leq 0\\).\n\nIf \\(I=(x, z)\\) is an interval, we say that a real number \\(\\alpha\\) is a supergradient of \\(f\\) at \\(y \\in I\\) if we always have\n\\[\nf(t) \\leq f(y)+\\alpha(t-y)\n\\]\nfor every \\(t \\in I\\). (This inequality may be familiar as the so-called \"tangent line trick\". A cartoon of this situation is drawn below for intuition.) We will also say \\(\\alpha\\) is a supergradient of \\(f\\) at \\(y\\), without reference to the interval, if \\(\\alpha\\) is a supergradient of some open interval containing \\(y\\).\n\nClaim - The problem condition is equivalent to asserting that \\(\\frac{f(z)-f(x)}{z-x}\\) is a supergradient of \\(f\\) at \\(\\frac{x+z}{2}\\) for the interval \\((x, z)\\), for every \\(x<z\\).\n\nProof. This is just manipulation.\nAt this point, we may readily verify that all claimed quadratic functions \\(f(x)= a x^{2}+b x+c\\) work - these functions are concave, so the graphs lie below the tangent line at any point. Given \\(x<z\\), the tangent at \\(\\frac{x+z}{2}\\) has slope given by the derivative \\(f^{\\prime}(x)=2 a x+b\\), that is\n\\[\nf^{\\prime}\\left(\\frac{x+z}{2}\\right)=2 a \\cdot \\frac{x+z}{2}+b=\\frac{f(z)-f(x)}{z-x}\n\\]\nas claimed. (Of course, it is also easy to verify the condition directly by elementary means, since it is just a polynomial inequality.)\n\nNow suppose \\(f\\) satisfies the required condition; we prove that it has the above form.\nClaim - The function \\(f\\) is concave.\n\nProof. Choose any \\(\\Delta>\\max \\{z-y, y-x\\}\\). Since \\(f\\) has a supergradient \\(\\alpha\\) at \\(y\\) over the interval ( \\(y-\\Delta, y+\\Delta\\) ), and this interval includes \\(x\\) and \\(z\\), we have\n\\[\n\\begin{aligned}\n\\frac{z-y}{z-x} f(x)+\\frac{y-x}{z-x} f(z) & \\leq \\frac{z-y}{z-x}(f(y)+\\alpha(x-y))+\\frac{y-x}{z-x}(f(y)+\\alpha(z-y)) \\\\\n& =f(y)\n\\end{aligned}\n\\]\n\nThat is, \\(f\\) is a concave function. Continuity follows from the fact that any concave function on \\(\\mathbb{R}\\) is automatically continuous.\n\nLemma (see e.g. https://math.stackexchange.com/a/615161 for picture)\nAny concave function \\(f\\) on \\(\\mathbb{R}\\) is continuous.\n\nProof. Suppose we wish to prove continuity at \\(p \\in \\mathbb{R}\\). Choose any real numbers \\(a\\) and \\(b\\) with \\(a<p<b\\). For any \\(0<\\varepsilon<\\max (b-p, p-a)\\) we always have\n\\[\nf(p)+\\frac{f(b)-f(p)}{b-p} \\varepsilon \\leq f(p+\\varepsilon) \\leq f(p)+\\frac{f(p)-f(a)}{p-a} \\varepsilon\n\\]\nwhich implies right continuity; the proof for left continuity is the same.\n\nClaim - The function \\(f\\) cannot have more than one supergradient at any given point.\n\nProof. Fix \\(y \\in \\mathbb{R}\\). For \\(t>0\\), let's define the function\n\\[\ng(t)=\\frac{f(y)-f(y-t)}{t}-\\frac{f(y+t)-f(y)}{t} .\n\\]\n\nWe contend that \\(g(\\varepsilon) \\leq \\frac{3}{5} g(3 \\varepsilon)\\) for any \\(\\varepsilon>0\\). Indeed by the problem condition,\n\\[\n\\begin{aligned}\n& f(y) \\leq f(y-\\varepsilon)+\\frac{f(y+\\varepsilon)-f(y-3 \\varepsilon)}{4} \\\\\n& f(y) \\leq f(y+\\varepsilon)-\\frac{f(y+3 \\varepsilon)-f(y-\\varepsilon)}{4}\n\\end{aligned}\n\\]\n\nSumming gives the desired conclusion.\nNow suppose that \\(f\\) has two supergradients \\(\\alpha<\\alpha^{\\prime}\\) at point \\(y\\). For small enough \\(\\varepsilon\\), we should have we have \\(f(y-\\varepsilon) \\leq f(y)-\\alpha^{\\prime} \\varepsilon\\) and \\(f(y+\\varepsilon) \\leq f(y)+\\alpha \\varepsilon\\), hence\n\\[\ng(\\varepsilon)=\\frac{f(y)-f(y-\\varepsilon)}{\\varepsilon}-\\frac{f(y+\\varepsilon)-f(y)}{\\varepsilon} \\geq \\alpha^{\\prime}-\\alpha .\n\\]\n\nThis is impossible since \\(g(\\varepsilon)\\) may be arbitrarily small.\n\nClaim - The function \\(f\\) is quadratic on the rational numbers.\n\nProof. Consider any four-term arithmetic progression \\(x, x+d, x+2 d, x+3 d\\). Because \\((f(x+2 d)-f(x+d)) / d\\) and \\((f(x+3 d)-f(x)) / 3 d\\) are both supergradients of \\(f\\) at the point \\(x+3 d / 2\\), they must be equal, hence\n\\[\nf(x+3 d)-3 f(x+2 d)+3 f(x+d)-f(x)=0 .\n\\]\n\nIf we fix \\(d=1 / n\\), it follows inductively that \\(f\\) agrees with a quadratic function \\({\\underset{\\sim}{f}}_{n}\\) on the set \\(\\frac{1}{n} \\mathbb{Z}\\). On the other hand, for any \\(m \\neq n\\), we apparently have \\(\\widetilde{f}_{n}=\\widetilde{f}_{m n}=\\widetilde{f}_{m}\\), so the quadratic functions on each \"layer\" are all equal.\n\nSince \\(f\\) is continuous, it follows \\(f\\) is quadratic, as needed.\nRemark (Alternate finish using differentiability due to Michael Ren). In the proof of the main claim (about uniqueness of supergradients), we can actually notice the two terms \\(\\frac{f(y)-f(y-t)}{t}\\) and \\(\\frac{f(y+t)-f(y)}{t}\\) in the definition of \\(g(t)\\) are both monotonic (by concavity). Since we supplied a proof that \\(\\lim _{t \\rightarrow 0} g(t)=0\\), we find \\(f\\) is differentiable.\n\nNow, if the derivative at some point exists, it must coincide with all the supergradients; (informally, this is why \"tangent line trick\" always has the slope as the derivative, and formally, we use the mean value theorem). In other words, we must have\n\\[\nf(x+y)-f(x-y)=2 f^{\\prime}(x) \\cdot y\n\\]\nholds for all real numbers \\(x\\) and \\(y\\). By choosing \\(y=1\\) we obtain that \\(f^{\\prime}(x)=f(x+1)-f(x-1)\\) which means \\(f^{\\prime}\\) is also continuous.\n\nFinally differentiating both sides with respect to \\(y\\) gives\n\\[\nf^{\\prime}(x+y)-f^{\\prime}(x-y)=2 f^{\\prime}(x)\n\\]\nwhich means \\(f^{\\prime}\\) obeys Jensen's functional equation. Since \\(f^{\\prime}\\) is continuous, this means \\(f^{\\prime}\\) is linear. Thus \\(f\\) is quadratic, as needed.", "source_pdf": "TST_2021.pdf", "notes": ""}
{"id": "TST-2023-1", "contest": "TST", "year": "2023", "problem_number": "1", "problem": "There are 2022 equally spaced points on a circular track \\(\\gamma\\) of circumference 2022. The points are labeled \\(A_{1}, A_{2}, \\ldots, A_{2022}\\) in some order, each label used once. Initially, Bunbun the Bunny begins at \\(A_{1}\\). She hops along \\(\\gamma\\) from \\(A_{1}\\) to \\(A_{2}\\), then from \\(A_{2}\\) to \\(A_{3}\\), until she reaches \\(A_{2022}\\), after which she hops back to \\(A_{1}\\). When hopping from \\(P\\) to \\(Q\\), she always hops along the shorter of the two \\(\\operatorname{arcs} \\widehat{P Q}\\) of \\(\\gamma\\); if \\(\\overline{P Q}\\) is a diameter of \\(\\gamma\\), she moves along either semicircle. Determine the maximal possible sum of the lengths of the 2022 arcs which Bunbun traveled, over all possible labellings of the 2022 points.", "solution": "Replacing 2022 with \\(2 n\\), the answer is \\(2 n^{2}-2 n+2\\). (When \\(n=1011\\), the number is 2042222.)", "source_pdf": "TST_2023.pdf", "notes": ""}
{"id": "TST-2023-3", "contest": "TST", "year": "2023", "problem_number": "3", "problem": "Consider pairs ( \\(f, g\\) ) of functions from the set of nonnegative integers to itself such that - \\(f(0) \\geq f(1) \\geq f(2) \\geq \\cdots \\geq f(300) \\geq 0 ;\\) - \\(f(0)+f(1)+f(2)+\\cdots+f(300) \\leq 300\\); - for any 20 nonnegative integers \\(n_{1}, n_{2}, \\ldots, n_{20}\\), not necessarily distinct, we have \\[ g\\left(n_{1}+n_{2}+\\cdots+n_{20}\\right) \\leq f\\left(n_{1}\\right)+f\\left(n_{2}\\right)+\\cdots+f\\left(n_{20}\\right) . \\] Determine the maximum possible value of \\(g(0)+g(1)+\\cdots+g(6000)\\) over all such pairs of functions.", "solution": "Replace \\(300=\\frac{24 \\cdot 25}{2}\\) with \\(\\frac{s(s+1)}{2}\\) where \\(s=24\\), and 20 with \\(k\\). The answer is \\(115440= \\frac{k s(k s+1)}{2}\\). Equality is achieved at \\(f(n)=\\max (s-n, 0)\\) and \\(g(n)=\\max (k s-n, 0)\\).", "source_pdf": "TST_2023.pdf", "notes": ""}
{"id": "TST-2023-4", "contest": "TST", "year": "2023", "problem_number": "4", "problem": "For nonnegative integers \\(a\\) and \\(b\\), denote their bitwise xor by \\(a \\oplus b\\). (For example, \\(9 \\oplus 10=1001_{2} \\oplus 1010_{2}=0011_{2}=3\\).) Find all positive integers \\(a\\) such that for any integers \\(x>y \\geq 0\\), we have \\[ x \\oplus a x \\neq y \\oplus a y . \\]", "solution": "The function \\(x \\mapsto x \\oplus a x\\) is injective if and only if \\(a\\) is an even integer.", "source_pdf": "TST_2023.pdf", "notes": ""}
{"id": "TST-2023-5", "contest": "TST", "year": "2023", "problem_number": "5", "problem": "Let \\(m\\) and \\(n\\) be fixed positive integers. Tsvety and Freyja play a game on an infinite grid of unit square cells. Tsvety has secretly written a real number inside of each cell so that the sum of the numbers within every rectangle of size either \\(m \\times n\\) or \\(n \\times m\\) is zero. Freyja wants to learn all of these numbers. One by one, Freyja asks Tsvety about some cell in the grid, and Tsvety truthfully reveals what number is written in it. Freyja wins if, at any point, Freyja can simultaneously deduce the number written in every cell of the entire infinite grid. (If this never occurs, Freyja has lost the game and Tsvety wins.) In terms of \\(m\\) and \\(n\\), find the smallest number of questions that Freyja must ask to win, or show that no finite number of questions can suffice.", "solution": "The answer is the following: - If \\(\\operatorname{gcd}(m, n)>1\\), then Freyja cannot win. - If \\(\\operatorname{gcd}(m, n)=1\\), then Freyja can win in a minimum of \\((m-1)^{2}+(n-1)^{2}\\) questions.", "source_pdf": "TST_2023.pdf", "notes": ""}
{"id": "TST-2023-6", "contest": "TST", "year": "2023", "problem_number": "6", "problem": "Fix a function \\(f: \\mathbb{N} \\rightarrow \\mathbb{N}\\) and for any \\(m, n \\in \\mathbb{N}\\) define \\[ \\Delta(m, n)=\\underbrace{f(f(\\ldots f}_{f(n) \\text { times }}(m) \\ldots))-\\underbrace{f(f(\\ldots f}_{f(m) \\text { times }}(n) \\ldots)) . \\] Suppose \\(\\Delta(m, n) \\neq 0\\) for any distinct \\(m, n \\in \\mathbb{N}\\). Show that \\(\\Delta\\) is unbounded, meaning that for any constant \\(C\\) there exist \\(m, n \\in \\mathbb{N}\\) with \\(|\\Delta(m, n)|>C\\).", "solution": "Suppose for the sake of contradiction that \\(|\\Delta(m, n)| \\leq N\\) for all \\(m, n\\). Note that \\(f\\) is injective, as \\(f(m)=f(n) \\Longrightarrow \\Delta(m, n)=0 \\Longrightarrow m=n\\), as desired. Let \\(G\\) be the \"arrow graph\" of \\(f\\), which is the directed graph with vertex set \\(\\mathbb{N}\\) and edges \\(n \\rightarrow f(n)\\). The first step in the solution is to classify the structure of \\(G\\). Injectivity implies that \\(G\\) is a disjoint collection of chains (infinite and half-infinite) and cycles. We have the following sequence of claims that further refine the structure.", "source_pdf": "TST_2023.pdf", "notes": ""}
{"id": "TST-2024-1", "contest": "TST", "year": "2024", "problem_number": "1", "problem": "Find the smallest constant \\(C>1\\) such that the following statement holds: for every integer \\(n \\geq 2\\) and sequence of non-integer positive real numbers \\(a_{1}, a_{2}, \\ldots, a_{n}\\) satisfying \\[ \\frac{1}{a_{1}}+\\frac{1}{a_{2}}+\\cdots+\\frac{1}{a_{n}}=1, \\] it's possible to choose positive integers \\(b_{i}\\) such that (i) for each \\(i=1,2, \\ldots, n\\), either \\(b_{i}=\\left\\lfloor a_{i}\\right\\rfloor\\) or \\(b_{i}=\\left\\lfloor a_{i}\\right\\rfloor+1\\); and (ii) we have \\[ 1<\\frac{1}{b_{1}}+\\frac{1}{b_{2}}+\\cdots+\\frac{1}{b_{n}} \\leq C \\]", "solution": "The answer is \\(C=\\frac{3}{2}\\). Lower bound. Note that if \\(a_{1}=\\frac{4 n-3}{2 n-1}\\) and \\(a_{i}=\\frac{4 n-3}{2}\\) for \\(i>1\\), then we must have \\(b_{1} \\in\\{1,2\\}\\) and \\(b_{i} \\in\\{2 n-2,2 n-1\\}\\) for \\(i>1\\). If we take \\(b_{1}=2\\) then we obtain \\[ \\frac{1}{b_{1}}+\\frac{1}{b_{2}}+\\cdots+\\frac{1}{b_{n}} \\leq \\frac{1}{2}+(n-1) \\cdot \\frac{1}{2 n-2}=1 \\] whereas if we take \\(b_{1}=1\\) then we obtain \\[ \\frac{1}{b_{1}}+\\frac{1}{b_{2}}+\\cdots+\\frac{1}{b_{n}} \\geq 1+(n-1) \\cdot \\frac{1}{2 n-1}=\\frac{3 n-2}{2 n-1} . \\] This shows that \\(C \\geq \\frac{3 n-2}{2 n-1}\\), and as \\(n \\rightarrow \\infty\\) this shows that \\(C \\geq \\frac{3}{2}\\). Upper bound. For \\(0 \\leq k \\leq n\\), define \\[ c_{i}=\\sum_{i=1}^{k} \\frac{1}{\\left\\lfloor a_{i}\\right\\rfloor}+\\sum_{i=k+1}^{n} \\frac{1}{\\left\\lfloor a_{i}\\right\\rfloor+1} . \\] Note that \\(c_{0}<c_{1}<\\cdots<c_{n}\\) and \\[ c_{0}<\\frac{1}{a_{1}}+\\frac{1}{a_{2}}+\\cdots+\\frac{1}{a_{n}}=1<c_{n} . \\] This means there exists a unique value of \\(k\\) for which \\(c_{k-1}<1<c_{k}\\). For this \\(k\\) we have \\[ 1<c_{k}=c_{k-1}+\\frac{1}{\\left(\\left\\lfloor a_{k}\\right\\rfloor\\right)\\left(\\left\\lfloor a_{k}\\right\\rfloor+1\\right)}<1+\\frac{1}{1 \\cdot 2}=\\frac{3}{2} . \\] Therefore we may choose \\(b_{i}=\\left\\lfloor a_{i}\\right\\rfloor\\) for \\(i \\leq k\\) and \\(b_{i}=\\left\\lfloor a_{i}\\right\\rfloor+1\\) for \\(i>k\\). Remark. The solution can be phrased in the following \"motion-based\" way. Imagine starting with all floors (corresponding to \\(c_{0}\\) ), then changing each floor to a ceiling one by one until after \\(n\\) steps every floor is a ceiling (arriving at \\(c_{n}\\) ). As we saw, \\(c_{0}<1<c_{n}\\), but \\(c_{0}<\\cdots<c_{n}\\). Moreover, each discrete step increases the sum by at most \\[ \\frac{1}{\\left\\lfloor a_{i}\\right\\rfloor}-\\frac{1}{\\left\\lfloor a_{i}\\right\\rfloor+1} \\leq \\frac{1}{2} \\] and so the changing sum must be in the interval \\([1,3 / 2]\\) at some point. Upper bound (alternate). First suppose \\(a_{i}<2\\) for some \\(i\\). Assume without loss of generality \\(i=1\\) here. Let \\(b_{1}=1\\) and \\(b_{i}=\\left\\lfloor a_{i}\\right\\rfloor+1\\) for all other \\(i\\). Then \\[ \\begin{aligned} 1 & <\\frac{1}{b_{1}}+\\cdots+\\frac{1}{b_{n}}=1+\\frac{1}{\\left\\lfloor a_{2}\\right\\rfloor+1}+\\cdots+\\frac{1}{\\left\\lfloor a_{n}\\right\\rfloor+1} \\\\ & <\\left(\\frac{1}{2}+\\frac{1}{a_{1}}\\right)+\\frac{1}{a_{2}}+\\cdots+\\frac{1}{a_{n}}=\\frac{3}{2} \\end{aligned} \\] Now suppose \\(a_{i}>2\\) always. Then \\(\\frac{a_{i}}{\\left\\lfloor a_{i}\\right\\rfloor}<\\frac{3}{2}\\), so \\[ 1=\\frac{1}{a_{1}}+\\cdots+\\frac{1}{a_{n}}<\\frac{1}{\\left\\lfloor a_{1}\\right\\rfloor}+\\cdots+\\frac{1}{\\left\\lfloor a_{n}\\right\\rfloor}<\\frac{3}{2}\\left(\\frac{1}{a_{1}}+\\cdots+\\frac{1}{a_{n}}\\right)=\\frac{3}{2} . \\] Therefore we may let \\(b_{i}=\\left\\lfloor a_{i}\\right\\rfloor\\) for all \\(i\\). Remark. The original proposal asked to find the optimal \\(C\\) for a fixed \\(n\\). The answer is \\(\\frac{3 n-2}{2 n-1}\\), i.e. the lower bound construction in the solution is optimal.", "source_pdf": "TST_2024.pdf", "notes": ""}
{"id": "TST-2024-2", "contest": "TST", "year": "2024", "problem_number": "2", "problem": "Let \\(A B C\\) be a triangle with incenter \\(I\\). Let segment \\(A I\\) intersect the incircle of triangle \\(A B C\\) at point \\(D\\). Suppose that line \\(B D\\) is perpendicular to line \\(A C\\). Let \\(P\\) be a point such that \\(\\angle B P A=\\angle P A I=90^{\\circ}\\). Point \\(Q\\) lies on segment \\(B D\\) such that the circumcircle of triangle \\(A B Q\\) is tangent to line \\(B I\\). Point \\(X\\) lies on line \\(P Q\\) such that \\(\\angle I A X=\\angle X A C\\). Prove that \\(\\angle A X P=45^{\\circ}\\).", "solution": "We show several approaches. First solution, by author. ![](https://cdn.mathpix.com/cropped/2025_08_23_091a3966570374004cb0g-05.jpg?height=969&width=1460&top_left_y=1010&top_left_x=302) Claim - We have \\(B P=B Q\\). Proof. For readability, we split the proof into three unconditional parts. - We translate the condition \\(\\overline{B D} \\perp \\overline{A C}\\). It gives \\(\\angle D B A=90^{\\circ}-A\\), so that \\[ \\begin{aligned} & \\angle D B I=\\left|\\frac{B}{2}-\\left(90^{\\circ}-A\\right)\\right|=\\frac{|A-C|}{2} \\\\ & \\angle B D I=\\angle D B A+\\angle B A D=\\left(90^{\\circ}-A\\right)+\\frac{A}{2}=90^{\\circ}-\\frac{A}{2} . \\end{aligned} \\] Hence, letting \\(r\\) denote the inradius, we can translate \\(\\overline{B D} \\perp \\overline{A C}\\) into the following trig condition: \\[ \\sin \\frac{B}{2}=\\frac{r}{B I}=\\frac{D I}{B I}=\\frac{\\sin \\angle D B I}{\\sin \\angle B D I}=\\frac{\\sin \\frac{|A-C|}{2}}{\\sin \\left(90^{\\circ}-\\frac{A}{2}\\right)} \\] - The length of \\(B P\\) is given from right triangle \\(A P B\\) as \\[ B P=B A \\cdot \\sin \\angle P A B=B A \\cdot \\sin \\left(90^{\\circ}-\\frac{A}{2}\\right) \\] - The length of \\(B Q\\) is given from the law of sines on triangle \\(A B Q\\). The tangency gives \\(\\angle B A Q=\\angle D B I\\) and \\(\\angle B Q A=180^{\\circ}-\\angle A B I=180^{\\circ}-\\angle I B E\\) and thus \\[ B Q=B A \\cdot \\frac{\\sin \\angle B A Q}{\\sin \\angle A Q B}=B A \\cdot \\frac{\\sin \\angle D B I}{\\sin \\angle A B I}=B A \\cdot \\frac{\\sin \\frac{|A-C|}{2}}{\\sin \\frac{B}{2}} \\] The first bullet implies the expressions in the second and third bullet for \\(B P\\) and \\(B Q\\) are equal, as needed. Remark. In the above proof, one dos not actually need to compute \\(\\angle D B I=\\frac{|A-C|}{2}\\). The proof works equally leaving that expression intact as \\(\\sin \\angle D B I\\) in place of \\(\\sin \\frac{|A-C|}{2}\\). Now we can finish by angle chasing. We have \\[ \\angle P B Q=\\angle P B A+\\angle A B D=\\frac{A}{2}+90^{\\circ}-A=90^{\\circ}-\\frac{A}{2} . \\] Then \\[ \\angle B P Q=\\frac{180^{\\circ}-\\angle P B Q}{2}=45^{\\circ}+\\frac{A}{4}, \\] so \\(\\angle A P Q=90^{\\circ}-\\angle B P Q=45^{\\circ}-\\frac{A}{4}\\). Also, if we let \\(J\\) be the incenter of \\(I A C\\), then \\(\\angle P A J=90^{\\circ}+\\frac{A}{4}\\), and clearly \\(X\\) lies on line \\(A J\\). Then \\(\\angle A P Q+\\angle P A J=135^{\\circ}<180^{\\circ}\\), so \\(X\\) lies on the same side of \\(A P\\) as \\(Q\\) and \\(J\\) (by the parallel postulate). Therefore \\(\\angle A X P=180^{\\circ}-135^{\\circ}=45^{\\circ}\\), as desired. Remark. The problem was basically written backwards by starting from the \\(B D \\perp A C\\) condition, turning that into trig, and then contriving \\(P\\) and \\(Q\\) so that the \\(B D \\perp A C\\) condition implied \\(B P=B Q\\). Second solution, by Jeffrey Kwan. We prove the following restatement: Consider isosceles triangle \\(A E F\\) with \\(A E=A F\\) and incenter \\(D\\). Let \\(B\\) be the point on ray \\(A E\\) such that \\(B D \\perp A F\\), and let \\(P\\) be the projection of \\(B\\) onto the line through \\(A\\) parallel to \\(E F\\). Let \\(I\\) be the point diametrically opposite \\(A\\) in the circumcircle of \\(A E F\\), and let \\(Q\\) be the point on line \\(B D\\) such that \\(B I\\) is tangent to the circumcircle of \\(A Q B\\). Then \\(\\angle A P Q=45^{\\circ}-\\angle A / 4\\). First note that \\(\\angle D F E=45^{\\circ}-\\angle A / 4\\), so it suffices to show that \\(\\overline{P Q} \\| \\overline{D F}\\). Let \\(U=\\overline{B D} \\cap \\overline{E F}\\), and let \\(V=B I \\cap(A E F)\\). Observe that: - \\(P\\) and \\(V\\) both lie on the circle with diameter \\(A B\\), so \\(\\angle B V P=\\angle P A B=90^{\\circ}-\\angle A / 2\\). - We have \\(\\angle E V B=\\angle E V I=\\angle A / 2=\\angle D U F=\\angle B U E\\). Hence \\(B E U V\\) is cyclic. Now \\(\\angle B V U=\\angle A E U=90^{\\circ}-\\angle A / 2=\\angle B V P\\), so \\(\\overline{P U V}\\) are collinear. ![](https://cdn.mathpix.com/cropped/2025_08_23_091a3966570374004cb0g-07.jpg?height=769&width=829&top_left_y=482&top_left_x=616) From the tangency condition, we have that \\(\\angle A Q B=180^{\\circ}-\\angle A B I\\), which implies that \\[ \\angle A Q U+\\angle A P U=\\angle A Q B+\\angle A P V=\\left(180^{\\circ}-\\angle A B I\\right)+\\angle A B I=180^{\\circ}, \\] and so \\(A P U Q\\) is cyclic. Finally, note that \\(D\\) is the orthocenter of \\(\\triangle A U F\\), which implies that \\[ \\angle A P Q=\\angle A U Q=\\angle A U D=\\angle A F D=\\angle D F E . \\] This forces \\(\\overline{P Q} \\| \\overline{D F}\\), as desired. Third solution by Pitchayut Saengrungkongka and Maxim Li. We provide yet another proof that \\(B P=B Q\\). ![](https://cdn.mathpix.com/cropped/2025_08_23_091a3966570374004cb0g-07.jpg?height=427&width=789&top_left_y=1884&top_left_x=639) Let the incircle be \\(\\omega\\) and touch \\(B C\\) and \\(A B\\) at point \\(U\\) and \\(W\\). Let the tangent to \\(\\omega\\) at \\(D\\) meet \\(U W\\) at \\(T\\). Notice that \\(T\\) is the pole of \\(B D\\) with respect to \\(\\omega\\), so \\(I T \\perp B D\\). Now, we make the following critical claim, which in particular implies \\(B P=B Q\\). Claim - Quadrilaterals \\(D I W T\\) and \\(P B Q A\\) are inversely similar. Proof. This follows from four angle relations. - \\(\\measuredangle I D T=\\measuredangle B P A=90^{\\circ}\\). - \\(\\measuredangle T I W=\\measuredangle A B Q\\). - \\(\\measuredangle D I T=\\measuredangle I A C=\\measuredangle B A I=\\measuredangle A B P\\). - \\(\\measuredangle I T W=\\measuredangle Q B I=\\measuredangle Q A B\\). With \\(B P=B Q\\) obtained, one finishes with the same angle chasing as in the first solution.", "source_pdf": "TST_2024.pdf", "notes": ""}
{"id": "TST-2024-3", "contest": "TST", "year": "2024", "problem_number": "3", "problem": "Let \\(n>k \\geq 1\\) be integers and let \\(p\\) be a prime dividing \\(\\binom{n}{k}\\). Prove that the \\(k\\)-element subsets of \\(\\{1, \\ldots, n\\}\\) can be split into \\(p\\) classes of equal size, such that any two subsets with the same sum of elements belong to the same class.", "solution": "Let \\(\\sigma(S)\\) denote the sum of the elements of \\(S\\), so that \\[ P(x):=\\sum_{\\substack{S \\subseteq\\{1, \\ldots, n\\} \\\\|S|=k}} x^{\\sigma(S)} \\] is the generating function for the sums of \\(k\\)-element subsets of \\(\\{1, \\ldots, n\\}\\). By Legendre's formula, \\[ \\nu_{p}\\left(\\binom{n}{k}\\right)=\\sum_{r=1}^{\\infty}\\left(\\left\\lfloor\\frac{n}{p^{r}}\\right\\rfloor-\\left\\lfloor\\frac{k}{p^{r}}\\right\\rfloor-\\left\\lfloor\\frac{n-k}{p^{r}}\\right\\rfloor\\right) \\] so there exists a positive integer \\(r\\) with \\[ \\left\\lfloor\\frac{n}{p^{r}}\\right\\rfloor-\\left\\lfloor\\frac{k}{p^{r}}\\right\\rfloor-\\left\\lfloor\\frac{n-k}{p^{r}}\\right\\rfloor>0 \\] The main claim is the following: Claim - \\(P(x)\\) is divisible by \\[ \\Phi_{p^{r}}(x)=x^{(p-1) p^{r-1}}+\\cdots+x^{p^{r-1}}+1 \\] Before proving this claim, we will show how it solves the problem. It implies that there exists a polynomial \\(Q\\) with integer coefficients satisfying \\[ \\begin{aligned} P(x) & =\\Phi_{p^{r}}(x) Q(x) \\\\ & =\\left(x^{(p-1) p^{r-1}}+\\cdots+x^{p^{r-1}}+1\\right) Q(x) . \\end{aligned} \\] Let \\(c_{0}, c_{1}, \\ldots\\) denote the coefficients of \\(P\\), and define \\[ s_{i}=\\sum_{j \\equiv i} c_{j} . \\] Then it's easy to see that \\[ \\begin{gathered} s_{0}=s_{p^{r-1}}=\\cdots=s_{(p-1) p^{r-1}} \\\\ s_{1}=s_{p^{r-1}+1}=\\cdots=s_{(p-1) p^{r-1}+1} \\\\ \\vdots \\\\ s_{p^{r-1}-1}=s_{2 p^{r-1}-1}=\\cdots=s_{p^{r-1}} \\end{gathered} \\] This means we can construct the \\(p\\) classes by placing a set with sum \\(z\\) in class \\(\\left\\lfloor\\frac{z \\bmod p^{r}}{p^{r-1}}\\right\\rfloor\\). Now we present two ways to prove the claim. I First proof of claim. There's a natural bijection between \\(k\\)-element subsets of \\(\\{1, \\ldots, n\\}\\) and binary strings consisting of \\(k\\) zeroes and \\(\\ell\\) ones: the set \\(\\left\\{a_{1}, \\ldots, a_{k}\\right\\}\\) corresponds to the string which has zeroes at positions \\(a_{1}, \\ldots, a_{k}\\). Moreover, the inversion count of this string is simply \\(\\left(a_{1}+\\cdots+a_{k}\\right)-\\frac{1}{2} k(k+1)\\), so we only deal with these inversion counts (equivalently, we are factoring \\(x^{\\frac{k(k+1)}{2}}\\) out of \\(P\\) ). Recall that the generating function for these inversion counts is given by the \\(q\\)-binomial coefficient \\[ P(x)=\\frac{(x-1) \\cdots\\left(x^{k+\\ell}-1\\right)}{\\left[(x-1) \\cdots\\left(x^{k}-1\\right)\\right] \\times\\left[(x-1) \\cdots\\left(x^{\\ell}-1\\right)\\right]} \\] By choice of \\(r\\), the numerator of \\(P(x)\\) has more factors of \\(\\Phi_{p^{r}}(x)\\) than the denominator, so \\(\\Phi_{p^{r}}(x)\\) divides \\(P(x)\\). Remark. Here is a proof that \\(P(x)\\) is divisible by \\(\\Phi_{p^{r}}(x)\\) for some \\(r\\) using the \\(q\\)-binomial formula, without explicitly identifying \\(r\\). We know that \\(P(x)\\) is the product of several cyclotomic polynomials, and that \\(P(1)\\) is a multiple of \\(p\\). Thus there is a factor \\(\\Phi_{q}(x)\\) for which \\(\\Phi_{q}(1)\\) is a multiple of \\(p\\), which is equivalent to \\(q\\) being a power of \\(p\\). IT Second proof of claim. Note that \\(P(x)\\) is the coefficient of \\(y^{k}\\) in the polynomial \\[ Q(x, y):=(1+x y)\\left(1+x^{2} y\\right) \\cdots\\left(1+x^{n} y\\right) . \\] Let \\(a\\) be the remainder when \\(n\\) is divided by \\(p^{r}\\), and let \\(b\\) be the remainder when \\(k\\) is divided by \\(p^{r}\\); then we have \\(a<b\\) by the choice of \\(r\\). Let \\(q=\\left\\lfloor n / p^{r}\\right\\rfloor\\) so \\(n=p^{r} q+a\\). Consider taking \\(x\\) to be a primitive \\(p^{r}\\) th root of unity, say \\(\\omega\\). Then \\[ Q(\\omega, y)=\\left[(1+\\omega y)\\left(1+\\omega^{2} y\\right) \\cdots\\left(1+\\omega^{p^{r}} y\\right)\\right]^{q}(1+\\omega y)\\left(1+\\omega^{2} y\\right) \\ldots\\left(1+\\omega^{a} y\\right) \\] Now \\(\\omega, \\omega^{2}, \\ldots, \\omega^{p^{r}}\\) are all the \\(p^{r}\\) th roots of unity, each exactly once; then we can see that \\[ \\begin{aligned} & (1+\\omega y)\\left(1+\\omega^{2} y\\right) \\cdots\\left(1+\\omega^{p^{r}} y\\right) \\\\ & =(1-\\omega(-y))\\left(1-\\omega^{2}(-y)\\right) \\cdots\\left(1-\\omega^{p^{r}}(-y)\\right) \\\\ & =1-(-y)^{p^{r}} \\end{aligned} \\] so \\[ Q(\\omega, y)=\\left(1-(-y)^{p^{r}}\\right)^{q}(1+\\omega y)\\left(1+\\omega^{2} y\\right) \\ldots\\left(1+\\omega^{a} y\\right) \\] In particular, for any \\(m\\), if the coefficient of \\(y^{m}\\) in \\(Q(w, x)\\) is nonzero, then \\(m\\) must be congruent to one of \\(0,1, \\ldots, a\\left(\\bmod p^{r}\\right)\\). Therefore the coefficient of \\(y^{k}\\) in \\(Q(\\omega, y)\\) is zero. This means that \\(P(\\omega)=0\\) whenever \\(\\omega\\) is a primitive \\(p^{r}\\) th root of unity, which proves the claim.", "source_pdf": "TST_2024.pdf", "notes": ""}
{"id": "TST-2024-4", "contest": "TST", "year": "2024", "problem_number": "4", "problem": "Find all integers \\(n \\geq 2\\) for which there exists a sequence of \\(2 n\\) pairwise distinct points ( \\(P_{1}, \\ldots, P_{n}, Q_{1}, \\ldots, Q_{n}\\) ) in the plane satisfying the following four conditions: (i) no three of the \\(2 n\\) points are collinear; (ii) \\(P_{i} P_{i+1} \\geq 1\\) for all \\(i=1,2, \\ldots, n\\), where \\(P_{n+1}=P_{1}\\); (iii) \\(Q_{i} Q_{i+1} \\geq 1\\) for all \\(i=1,2, \\ldots, n\\), where \\(Q_{n+1}=Q_{1}\\); and (iv) \\(P_{i} Q_{j} \\leq 1\\) for all \\(i=1,2, \\ldots, n\\) and \\(j=1,2, \\ldots, n\\).", "solution": "Answer. Even integers only. Proof that even \\(n\\) work. If we ignore the conditions that the points are pairwise distinct and form no collinear triples, we may take \\[ P_{2 i+1}=(0.51,0), \\quad P_{2 i}=(-0.51,0), \\quad Q_{2 i+1}=(0,0.51), \\quad Q_{2 i}=(0,-0.51) . \\] The distances \\(P_{i} P_{i+1}\\) and \\(Q_{i} Q_{i+1}\\) are \\(1.02>1\\), while the distances \\(P_{i} Q_{j}\\) are \\(0.51 \\sqrt{2}<1\\). We may then perturb each point by a small amount to ensure that the distance inequalities still hold and have the points in general position. Proof that odd \\(n\\) do not work. The main claim is the following. Claim - For \\(1 \\leq i \\leq n\\), points \\(Q_{i}\\) and \\(Q_{i+1}\\) must lie on opposite sides of line \\(P_{1} P_{2}\\). To isolate the geometry component of the problem, we rewrite the claim in the following contrapositive form, without referencing the points \\(Q_{i}\\) and \\(Q_{i+1}\\) : \\section*{Lemma} Suppose \\(A\\) and \\(B\\) are two points such that \\(\\max \\left(P_{1} A, P_{1} B, P_{2} A, P_{2} B\\right) \\leq 1\\), and moreover \\(A\\) and \\(B\\) lie on the same side of line \\(P_{1} P_{2}\\). Further assume no three of \\(\\left\\{P_{1}, P_{2}, A, B\\right\\}\\) are collinear. Then \\(A B<1\\). ![](https://cdn.mathpix.com/cropped/2025_08_23_091a3966570374004cb0g-12.jpg?height=540&width=1286&top_left_y=254&top_left_x=391) Proof of lemma. Suppose for the sake of contradiction that \\(A\\) and \\(B\\) lie on the same side of \\(P_{1} P_{2}\\). The convex hull of these four points is either a quadrilateral or a triangle. - If the convex hull is a quadrilateral, assume WLOG that the vertices are \\(P_{1} P_{2} A B\\) in order. Let \\(X\\) denote the intersection of segments \\(P_{1} A\\) and \\(P_{2} B\\). Then \\[ 1+A B=P_{1} P_{2}+A B<P_{1} X+X P_{2}+A X+X B=P_{1} A+P_{2} B \\leq 2 . \\] - Otherwise, assume WLOG that \\(B\\) is in the interior of triangle \\(P_{1} P_{2} A\\). Since \\(\\angle P_{1} B A+\\angle P_{2} B A=360^{\\circ}-\\angle P_{1} B P_{2}>180^{\\circ}\\), at least one of \\(\\angle P_{1} B A\\) and \\(\\angle P_{2} B A\\) is obtuse. Assume WLOG the former angle is obtuse; then \\(A B<P_{1} A \\leq 1\\). Remark. Another proof of the lemma can be found by replacing segment \\(A B\\) with the intersection of this line on the boundary of the blue region above, which does not decrease the distance. In other words, one can assume WLOG that \\(A\\) and \\(B\\) lie on either segment \\(A B\\) or one of the two circular arcs. One then proves that \\(A B \\leq 1\\), and that for equality to occur, one of \\(A\\) and \\(B\\) must lie on segment \\(P_{1} P_{2}\\) However, this approach seems to involve a fair bit more calculation. Yet another clever approach uses the trivia-fact that a Reuleaux triangle happens to have constant width. In any case, it's important to realize that this claim is not trivial; while it looks like it is easy to prove, it is not, owing to the two near-equality cases. It follows from the claim that \\(Q_{i}\\) is on the same side of line \\(P_{1} P_{2}\\) as \\(Q_{1}\\) if \\(i\\) is odd, and on the opposite side if \\(i\\) is even. Since \\(Q_{1}=Q_{n+1}\\), this means the construction is not possible when \\(n\\) is odd. Remark. The fact that \\(n\\) cannot be odd follows from Theorem 3 of EPTAS for Max Clique on Disks and Unit Balls. In the language of that paper, if \\(G\\) is a unit ball graph, then the induced odd cycle parking number of \\(\\bar{G}\\) is at most 1 . In earlier versions of the proposed problem, the points were not necessarily distinct to make the even \\(n\\) case nicer, but this resulted in annoying boundary conditions for the odd \\(n\\) case.", "source_pdf": "TST_2024.pdf", "notes": ""}
{"id": "TST-2024-5", "contest": "TST", "year": "2024", "problem_number": "5", "problem": "Suppose \\(a_{1}<a_{2}<\\cdots<a_{2024}\\) is an arithmetic sequence of positive integers, and \\(b_{1}<b_{2}<\\cdots<b_{2024}\\) is a geometric sequence of positive integers. Find the maximum possible number of integers that could appear in both sequences, over all possible choices of the two sequences.", "solution": "Answer. 11 terms. Construction. Let \\(a_{i}=i\\) and \\(b_{i}=2^{i-1}\\). IT Bound. We show a \\(\\nu_{p}\\)-based approach communicated by Derek Liu, which seems to be the shortest one. At first, we completely ignore the geometric sequence \\(b_{i}\\) and focus only on the arithmetic sequence. Claim - Let \\(p\\) be any prime, and consider the sequence \\[ \\nu_{p}\\left(a_{1}\\right), \\nu_{p}\\left(a_{2}\\right), \\ldots, \\nu_{p}\\left(a_{2024}\\right) . \\] Set \\(C:=\\left\\lfloor\\log _{p}(2023)\\right\\rfloor\\). Then there are at most \\(C+2\\) different values in this sequence. Proof. By scaling, assume the \\(a_{i}\\) do not have a common factor, so that \\(a_{i}=a+d i\\) where \\(\\operatorname{gcd}(a, d)=1\\). - If \\(p \\mid d\\), then \\(p \\nmid a\\) and \\(\\nu_{p}\\left(a_{i}\\right)\\) is constant. - Otherwise, assume \\(p \\nmid d\\). We will in fact prove that every term in the sequence is contained in \\(\\{0,1, \\ldots, C\\}\\) with at most one exception. Define \\(M:=\\max _{i} \\nu_{p}\\left(a_{i}\\right)\\). If \\(M \\leq C\\), there is nothing to prove. Otherwise, fix some index \\(m\\) such that \\(\\nu_{p}\\left(a_{m}\\right)=M\\). We know \\(\\nu_{p}(i-m) \\leq C\\) since \\(|i-m| \\leq 2023\\). But now for any other index \\(i \\neq m\\); \\[ \\begin{aligned} \\nu_{p}(d(i-m)) & =\\nu_{p}(i-m) \\leq C<M=\\nu_{p}\\left(a_{m}\\right) \\\\ \\Longrightarrow \\nu_{p}\\left(a_{i}\\right) & =\\nu_{p}\\left(a_{m}+d(i-m)\\right)=\\nu_{p}(i-m) \\leq C \\end{aligned} \\] so \\(\\nu_{p}\\left(a_{m}\\right)\\) is the unique exceptional term of the sequence exceeding \\(C\\). Remark. The bound in the claim is best possible by taking \\(a_{i}=p^{M}+(i-1)\\) for any \\(M>C\\). Then indeed, the sequence \\(\\nu_{p}\\left(a_{i}\\right)\\) takes on values in \\(\\{0,1, \\ldots, C\\}\\) for \\(i>1\\) while \\(\\nu_{p}\\left(a_{1}\\right)=M\\). Back to the original problem with \\(\\left(b_{i}\\right)\\). Consider the common ratio \\(r \\in \\mathbb{Q}\\) of the geometric sequence ( \\(b_{i}\\) ). If \\(p\\) is any prime with \\(\\nu_{p}(r) \\neq 0\\), then every term of ( \\(b_{i}\\) ) has a different \\(\\nu_{p}\\). So there are two cases to think about. - Suppose any \\(p \\geq 3\\) has \\(\\nu_{p}(r) \\neq 0\\). Then there are at most \\[ 2+\\log _{p}(2023)=2+\\log _{3}(2023) \\approx 8.929<11 \\] overlapping terms, as needed. - Otherwise, suppose \\(r\\) is a power of 2 (in particular, \\(r \\geq 2\\) is an integer). We already have an upper bound of 12 ; we need to improve it to 11 . As in the proof before, we may assume WLOG by scaling down by a power of 2 that the common difference of \\(a_{i}\\) is odd. (This may cause some \\(b_{i}\\) to become rational non-integers, but that's OK. However, unless \\(\\nu_{2}\\left(a_{i}\\right)\\) is constant, the \\(a_{i}\\) will still be integers.) Then in order for the bound of 12 to be achieved, the sequence \\(\\nu_{2}\\left(a_{i}\\right)\\) must be contained in \\(\\{0,1, \\ldots, 10, M\\}\\) for some \\(M \\geq 11\\). In particular, we only need to work with \\(r=2\\). Denote by \\(b\\) the unique odd-integer term in the geometric sequence, which must appear among \\(\\left(a_{i}\\right)\\). Then \\(2 b\\) appears too, so the common difference of \\(a_{i}\\) is at most \\(b\\). But if ( \\(a_{i}\\) ) is an arithmetic progression of integers that contains \\(b\\) and has common difference at most \\(b\\), then no term of the sequence can ever exceed \\(b+2023 \\cdot b=2024 b\\). Hence \\(2^{M} b\\) cannot appear for any \\(M \\geq 11\\). This completes the proof. Remark. There are several other approaches to the problem, but most take some time to execute. The primary issue is that the common difference of the \\(a_{i}\\) 's could share prime factors with the common ratio in the \\(b_{i}\\) 's, which means that merely trying to write out a lot of modular arithmetic equations leads to a lot of potential technical traps that are not pleasant to defuse. One unusual thing is that many solutions end up proving a bound of 12 (in the case the common ratio is 2 ) and then having to adjust it to 11 later.", "source_pdf": "TST_2024.pdf", "notes": ""}
{"id": "TST-2024-6", "contest": "TST", "year": "2024", "problem_number": "6", "problem": "Solve over \\(\\mathbb{R}\\) the functional equation \\[ f(x f(y))+f(y)=f(x+y)+f(x y) \\]", "solution": "In addition to all constant functions, \\(f(x) \\equiv x+1\\) clearly works too. We prove these are the only solutions. The solution that follows is by the original proposer. Let \\(P(x, y)\\) denote the given assertion. Claim 2.1 - If \\(f\\) is periodic, then \\(f\\) is constant. Proof. Let \\(f\\) have period \\(d \\neq 0\\). From \\(P(x, y+d)\\), we have \\[ f(x(y+d))=f(x+y+d)-f(y+d)-f(x f(y+d))=f(x+y)-f(y)-f(x f(y)) . \\] Applying \\(P(x, y)\\) gives \\[ f(x(y+d))=f(x y) \\] In particular, taking \\(y=0\\) yields that \\(f(d x)=f(0)\\). Thus \\(f\\) is constant, as \\(d \\neq 0\\). Claim 2.2 - For all real numbers \\(x\\) and \\(y\\), we have \\(f(f(x)+y)=f(f(y)+x)\\). Proof. Applying \\(P(f(x), y)\\) and then \\(P(y, x)\\) gives us \\[ \\begin{aligned} f(f(x) f(y)) & =f(f(x)+y)+f(f(x) y)-f(y) \\\\ & =f(f(x)+y)+f(x+y)+f(x y)-f(x)-f(y) \\end{aligned} \\] Now swapping \\(x\\) and \\(y\\) gives us \\(f(f(x)+y)=f(f(y)+x)\\). Claim 2.3 - If \\(f\\) is nonconstant, then \\(f(f(x)+y)=f(x)+f(y)\\) for all reals \\(x, y\\). Proof. Let \\(x, y \\in \\mathbb{R}\\) and let \\(d:=f(f(x)+y)-f(x)-f(y)\\). Let \\(z\\) be an arbitrary real number. By repeatedly applying Claim 2.2, we have \\[ \\begin{aligned} f(z+f(f(x)+y)) & =f(f(z)+f(x)+y) \\\\ & =f(f(x)+f(z)+y) \\\\ & =f(x+f(f(z)+y)) \\\\ & =f(x+f(f(y)+z)) \\\\ & =f(f(x)+f(y)+z) \\\\ & =f(z+f(x)+f(y)) \\end{aligned} \\] If \\(d \\neq 0\\), then \\(f\\) is periodic with period \\(d\\), contradicting Claim 2.1. Claim 2.4 - If \\(f\\) is nonconstant, then \\(f(0)=1\\) and \\(f(x+1)=f(x)+1\\). Proof. From \\(P(z, 0)\\) we have \\(f(z f(0))=f(z)\\) for all real \\(z\\). Then \\(P(x f(0), y)\\) and \\(P(x, y)\\) give us \\[ \\begin{aligned} f(x f(0)+y) & =f(y)+f(x f(0) f(y))-f(x f(0) y) \\\\ & =f(y)+f(x f(y))-f(x y)=f(x+y) \\end{aligned} \\] If \\(f(0) \\neq 1\\), then \\(x f(0)-x\\) is a period of \\(f\\) for all \\(x\\), violating Claim 2.1. So we must have \\(f(0)=1\\). Now putting \\(x=0\\) in Claim 2.3 gives \\(f(x+1)=f(x)+1\\). Claim 2.5 - If \\(f\\) is nonconstant, then \\(f(x)+f(y)=f(x+y)+1\\). Proof. From \\(P(x+1, y)\\) and Claim 2.4, we have \\[ f((x+1) f(y))=f(x+y+1)+f(x y+y)-f(y)=f(x+y)+f(x y+y)-f(y)+1 . \\] Also, from Claim 2.3 and \\(P(x, y)\\), we have \\[ f((x+1) f(y))=f(x f(y))+f(y)=f(x+y)+f(x y) \\] Thus \\(f(x y)=f(x y+y)-f(y)+1\\). Replacing \\(x\\) with \\(\\frac{x}{y}\\) gives the claim for all \\(y \\neq 0\\) (whereas \\(y=0\\) follows from Claim 2.4). Claim 2.6 - If \\(f\\) is nonconstant, then \\(f(x) \\equiv x+1\\). Proof. We apply Claim 2.3, Claim 2.5, and Claim 2.4: \\[ f(f(x)+y)=f(x)+f(y)=f(x+y)+1=f(x+y+1) \\] If \\(f(x) \\neq x+1\\) for some \\(x\\), then Claim 2.1 again gives a contradiction.", "source_pdf": "TST_2024.pdf", "notes": ""}
{"id": "TST-2025-1", "contest": "TST", "year": "2025", "problem_number": "1", "problem": "Let \\(n\\) be a positive integer. Ana and Banana play a game. Banana thinks of a function \\(f: \\mathbb{Z} \\rightarrow \\mathbb{Z}\\) and a prime number \\(p\\). He tells Ana that \\(f\\) is nonconstant, \\(p<100\\), and \\(f(x+p)=f(x)\\) for all integers \\(x\\). Ana's goal is to determine the value of \\(p\\). She writes down \\(n\\) integers \\(x_{1}, \\ldots, x_{n}\\). After seeing this list, Banana writes down \\(f\\left(x_{1}\\right), \\ldots, f\\left(x_{n}\\right)\\) in order. Ana wins if she can determine the value of \\(p\\) from this information. Find the smallest value of \\(n\\) for which Ana has a winning strategy.", "solution": "The answer is \\(n=83+89-1=171\\). In general, if Ana has to decide between periods from the set \\(\\mathcal{P}:=\\left\\{p_{1}>p_{2}>\\cdots>p_{r}\\right\\}\\) of pairwise distinct relatively prime positive integers for \\(r \\geq 3\\), the answer is \\(p_{2}+p_{3}-1\\).", "source_pdf": "TST_2025.pdf", "notes": ""}
{"id": "TST-2025-2", "contest": "TST", "year": "2025", "problem_number": "2", "problem": "Let \\(a_{1}, a_{2}, \\ldots\\) and \\(b_{1}, b_{2}, \\ldots\\) be sequences of real numbers for which \\(a_{1}>b_{1}\\) and \\(\\begin{aligned} a_{n+1} & =a_{n}^{2}-2 b_{n} \\\\ b_{n+1} & =b_{n}^{2}-2 a_{n} \\end{aligned}\\) for all positive integers \\(n\\). Prove that \\(a_{1}, a_{2}, \\ldots\\) is eventually increasing (that is, there exists a positive integer \\(N\\) for which \\(a_{k}<a_{k+1}\\) for all \\(k>N\\) ).", "solution": "Let \\(r, s\\), and \\(t\\) be the complex roots of the polynomial \\(p(\\lambda)=\\lambda^{3}-a_{1} \\lambda^{2}+b_{1} \\lambda-1\\). By Vieta's formulas, \\(\\begin{aligned} a_{1} & =r+s+t \\\\ b_{1} & =1 / r+1 / s+1 / t \\\\ 1 & =r s t \\end{aligned}\\) Claim - For every positive integer \\(n\\), \\(a_{n}=r^{2^{n-1}}+s^{2^{n-1}}+t^{2^{n-1}}\\) and \\(b_{n}=(1 / r)^{2^{n-1}}+(1 / s)^{2^{n-1}}+(1 / t)^{2^{n-1}} \\text {. }\\) Proof. The base case follows from Vieta's formulas above. For the inductive step, observe that \\(r s t=1\\), so \\(\\begin{aligned} a_{n+1} & =a_{n}^{2}-2 b_{n} \\\\ & =\\left(r^{2^{n-1}}+s^{2^{n-1}}+t^{2^{n-1}}\\right)^{2}-2\\left((1 / r)^{2^{n-1}}+(1 / s)^{2^{n-1}}+(1 / t)^{2^{n-1}}\\right) \\\\ & =\\left(r^{2^{n-1}}+s^{2^{n-1}}+t^{2^{n-1}}\\right)^{2}-2\\left((s t)^{2^{n-1}}+(t r)^{2^{n-1}}+(r s)^{2^{n-1}}\\right) \\\\ & =r^{2^{n}}+s^{2^{n}}+t^{2^{n}} \\end{aligned}\\) and similarly for \\(b_{n+1}\\). Since \\(p(1)=b_{1}-a_{1}<0, p\\) has a real root greater than 1 ; let \\(r\\) be the largest such root. - If \\(s\\) and \\(t\\) are real, let \\(m=\\max (|r|,|s|,|t|)>1\\) be the largest magnitude of the roots and \\(k \\in\\{1,2,3\\}\\) be the number of roots with that magnitude. Then asymptotically \\(a_{n}=r^{2^{n-1}}+s^{2^{n-1}}+t^{2^{n-1}} \\approx k m^{2^{n-1}}\\) which implies that \\(\\left\\{a_{n}\\right\\}\\) is eventually increasing. - If \\(s\\) and \\(t\\) are not real, they must be complex conjugates of each other, each with magnitude \\(\\frac{1}{\\sqrt{r}}<1\\). Therefore \\(r^{2^{n-1}}-2<a_{n}<r^{2^{n-1}}+2\\), so \\(\\left\\{a_{n}\\right\\}\\) is eventually increasing.", "source_pdf": "TST_2025.pdf", "notes": ""}
{"id": "TST-2025-3", "contest": "TST", "year": "2025", "problem_number": "3", "problem": "Let \\(A_{1} A_{2} \\cdots A_{2025}\\) be a convex 2025-gon, and let \\(A_{i}=A_{i+2025}\\) for all integers \\(i\\). Distinct points \\(P\\) and \\(Q\\) lie in its interior such that \\(\\angle A_{i-1} A_{i} P=\\angle Q A_{i} A_{i+1}\\) for all \\(i\\). Define points \\(P_{i}^{j}\\) and \\(Q_{i}^{j}\\) for integers \\(i\\) and positive integers \\(j\\) as follows: - For all \\(i, P_{i}^{1}=Q_{i}^{1}=A_{i}\\). - For all \\(i\\) and \\(j, P_{i}^{j+1}\\) and \\(Q_{i}^{j+1}\\) are the circumcenters of \\(P P_{i}^{j} P_{i+1}^{j}\\) and \\(Q Q_{i}^{j} Q_{i+1}^{j}\\), respectively. Let \\(\\mathcal{P}\\) and \\(\\mathcal{Q}\\) be the polygons \\(P_{1}^{2025} P_{2}^{2025} \\cdots P_{2025}^{2025}\\) and \\(Q_{1}^{2025} Q_{2}^{2025} \\cdots Q_{2025}^{2025}\\), respectively. (a) Prove that \\(\\mathcal{P}\\) and \\(\\mathcal{Q}\\) are cyclic. (b) Let \\(O_{P}\\) and \\(O_{Q}\\) be the circumcenters of \\(\\mathcal{P}\\) and \\(\\mathcal{Q}\\), respectively. Assuming that \\(O_{P} \\neq O_{Q}\\), show that \\(O_{P} O_{Q}\\) is parallel to \\(P Q\\).", "solution": "Let \\(n=2025\\). Let \\(\\mathcal{P}_{i}\\) and \\(\\mathcal{Q}_{i}\\) denote the polygons \\(P_{1}^{i} \\cdots P_{n}^{i}\\) and \\(Q_{1}^{i} \\cdots Q_{n}^{i}\\). In this notation, \\(\\mathcal{P}=\\mathcal{P}_{n}, \\mathcal{Q}=\\mathcal{Q}_{n}\\), and \\(\\mathcal{P}_{1}=\\mathcal{Q}_{1}=A_{1} \\cdots A_{n}\\). The angle condition for \\(P\\) and \\(Q\\) just says that they are isogonal conjugates in \\(\\mathcal{P}_{1}\\). We will first find some properties that do not depend on \\(P\\) having an isogonal conjugate. Note that \\(P_{i-1}^{j+1} P_{i}^{j+1}\\) is the perpendicular bisector of \\(P P_{i+1}^{j}\\), so we can go backwards from \\(\\mathcal{P}_{j}\\) to \\(\\mathcal{P}_{j-1}\\) by reflecting over the sides. Use this to extend the points backwards to \\(\\mathcal{P}_{0}\\), i.e. define \\(P_{i}^{0}\\) to be the reflection of \\(P\\) over \\(P_{i-1}^{1} P_{i}^{1}\\). Lemma 1.1: For integers \\(j \\geq 0\\) and \\(i\\), \\(\\begin{aligned} & \\measuredangle P P_{i}^{j} P_{i+1}^{j}=\\measuredangle P P_{i}^{j+1} P_{i+1}^{j+1} \\quad \\text { and } \\\\ & \\measuredangle P P_{i+1}^{j} P_{i}^{j}=\\measuredangle P P_{i}^{j+1} P_{i-1}^{j+1} . \\end{aligned}\\) Proof. This is a standard circumcenter fact in disguise but we will prove it here for completeness. If \\(X\\) is the antipode of \\(P\\) on \\(\\left(P P_{i}^{j} P_{i+1}^{j}\\right)\\) (equivalently, the reflection of \\(P\\) over \\(P P_{i}^{j+1}\\) ) and \\(M\\) is the midpoint of \\(P P_{i+1}^{j}\\) then \\(\\measuredangle P P_{i}^{j} P_{i+1}^{j}=\\measuredangle P X P_{i+1}^{j}=\\measuredangle P P_{i}^{j+1} M=\\measuredangle P P_{i}^{j+1} P_{i+1}^{j+1} .\\) The second equality is analogous. Lemma: The following similarity holds: \\(\\mathcal{P}_{n} \\cup P \\stackrel{+}{\\sim} \\mathcal{P}_{0} \\cup P\\). Proof. By Lemma 1.1, \\(\\begin{aligned} & \\measuredangle P P_{i}^{0} P_{i+1}^{0}=\\measuredangle P P_{i}^{1} P_{i+1}^{1}=\\cdots=\\measuredangle P_{i}^{n} P_{i+1}^{n} \\quad \\text { and } \\\\ & \\measuredangle P P_{i+1}^{0} P_{i}^{0}=\\measuredangle P P_{i}^{1} P_{i-1}^{1}=\\cdots=\\measuredangle P_{i-n+1}^{n} P_{i-n}^{n}=\\measuredangle P_{i+1}^{n} P_{i}^{n} \\end{aligned}\\) Therefore \\(P P_{i}^{n} P_{i+1}^{n} \\stackrel{+}{\\sim} P P_{i}^{0} P_{i+1}^{0}\\). Combining these similarities for all \\(i\\) shows that \\(\\mathcal{P}_{n} \\cup P \\stackrel{+}{\\sim} \\mathcal{P}_{0} \\cup P\\). To solve part (a), we just need to show that \\(\\mathcal{P}_{0}\\) and \\(\\mathcal{Q}_{0}\\) are cyclic. This is where we need the isogonal conjugate property, and we can generalize from analogous facts for the \\(n=3\\) case. We have \\(\\measuredangle P P_{i+1}^{0} P_{i}^{0}=\\measuredangle P A_{i} A_{i-1}=\\measuredangle A_{i+1} A_{i} Q\\) so \\(90^{\\circ}=\\measuredangle\\left(P P_{i+1}^{0}, A_{i} A_{i+1}\\right)=\\measuredangle\\left(P_{i+1}^{0} P_{i}^{0}, A Q\\right) .\\) Since \\(A_{i} P_{i}^{0}=A_{i} P_{i+1}^{0}\\), it follows that \\(A_{i} Q\\) is the perpendicular bisector of \\(P_{i}^{0} P_{i+1}^{0}\\) and \\(Q P_{i}^{0}=Q P_{i+1}^{0}\\). By applying this equality for all \\(i\\), it follows that \\(\\mathcal{P}_{0}\\) is cyclic with circumcenter \\(Q\\). This completes the solution for part (a). For part (b), we will analyze the angle of rotation and scale factor for the similarity \\(\\mathcal{P}_{n} \\cup P \\stackrel{+}{\\sim} \\mathcal{P}_{0} \\cup P\\). Assume without loss of generality that \\(A_{1} A_{2} \\cdots A_{n}\\) is labeled in clockwise order as in the earlier diagrams. Claim - The spiral similarity at \\(P\\) sending \\(\\mathcal{P}_{0} \\cup Q\\) to \\(\\mathcal{P}_{n} \\cup O_{P}\\) is the composition of a clockwise rotation by \\(\\theta_{P}\\) and a dilation with factor \\(r_{P}\\), where \\(\\theta_{P}=\\frac{n \\pi}{2}-\\sum_{i=1}^{n} \\angle P A_{i} A_{i-1} \\quad \\text { and } \\quad r_{P}=\\prod_{i=1}^{n} \\frac{1}{2 \\sin \\angle P A_{i} A_{i-1}} .\\) Analogously, the spiral similarity at \\(Q\\) sending \\(\\mathcal{Q}_{0} \\cup P\\) to \\(\\mathcal{Q}_{n} \\cup O_{Q}\\) is the composition of a clockwise rotation by \\(\\theta_{Q}\\) and a dilation with factor \\(r_{Q}\\), where \\(\\theta_{Q}=\\frac{n \\pi}{2}-\\sum_{i=1}^{n} \\angle Q A_{i} A_{i-1} \\quad \\text { and } \\quad r_{Q}=\\prod_{i=1}^{n} \\frac{1}{2 \\sin \\angle Q A_{i} A_{i+1}} .\\) Proof. Note that \\(\\angle P P_{0}^{i} P P_{0}^{i+1}=\\frac{\\pi}{2}-\\angle P P_{1}^{i} P_{0}^{i}=\\frac{\\pi}{2}-\\angle P P_{i}^{1} P_{i-1}^{1}=\\frac{\\pi}{2}-\\angle P A_{i} A_{i-1}\\) by circumcenter properties and Lemma 1.1. Summing over \\(0 \\leq i<n\\) yields the claimed formula for \\(\\theta_{P}\\), since the left hand side adds up to the rotation angle from \\(P P_{0}^{0}\\) to \\(P P_{0}^{n}\\). By the law of sines, \\(\\prod_{i=1}^{n} \\frac{P P_{i}^{j+1}}{P_{i}^{j}}=\\prod_{i=1}^{n} \\frac{1}{2 \\sin \\angle P P_{i+1}^{j} P_{i}^{j}}=\\prod_{i=1}^{n} \\frac{1}{2 \\sin \\angle P A_{i} A_{i-1}}\\) where in the last equality we use Lemma 1.1 again. Multiply over \\(0 \\leq j<n\\) and raise to the power \\(\\frac{1}{n}\\) to obtain \\(\\left(\\prod_{i=1}^{n} \\frac{P P_{i}^{n}}{P_{i}^{0}}\\right)^{\\frac{1}{n}}=\\prod_{i=1}^{n} \\frac{1}{2 \\sin \\angle P A_{i} A_{i-1}} .\\) This proves the formula for \\(r_{P}\\) because the left hand side gives the scale factor. The argument for \\(Q\\) is similar. Note that we reversed the angle in the formula for \\(r_{Q}\\) but not \\(\\theta_{Q}\\) because \\(\\theta_{Q}\\) depends on orientation. By the given angle conditions on \\(P\\) and \\(Q\\) we have \\(r_{P}=r_{Q}\\). Meanwhile, \\(\\theta_{P}+\\theta_{Q}=n \\pi-\\sum_{i=1}^{n}\\left(\\angle P A_{i} A_{i-1}+\\angle Q A_{i} A_{i-1}\\right)=n \\pi-\\sum_{i=1}^{n} \\angle A_{i-1} A_{i} A_{i+1}=2 \\pi .\\) This means that clockwise rotation by \\(\\theta_{Q}\\) is just counterclockwise rotation by \\(\\theta_{P}\\). The combination of these two implies that \\(P Q O_{Q} O_{P}\\) is an isosceles trapezoid with \\(O_{P} O_{Q}\\) parallel to \\(P Q\\), which proves part (b).", "source_pdf": "TST_2025.pdf", "notes": ""}
{"id": "TST-2025-4", "contest": "TST", "year": "2025", "problem_number": "4", "problem": "Let \\(A B C\\) be a triangle, and let \\(X, Y\\), and \\(Z\\) be collinear points such that \\(A Y=A Z\\), \\(B Z=B X\\), and \\(C X=C Y\\). Points \\(X^{\\prime}, Y^{\\prime}\\), and \\(Z^{\\prime}\\) are the reflections of \\(X, Y\\), and \\(Z\\) over \\(B C, C A\\), and \\(A B\\), respectively. Prove that if \\(X^{\\prime} Y^{\\prime} Z^{\\prime}\\) is a nondegenerate triangle, then its circumcenter lies on the circumcircle of \\(A B C\\).", "solution": "Let \\(S\\) denote the circumcenter of \\(\\triangle X^{\\prime} Y^{\\prime} Z^{\\prime}\\). Observe that \\(A Y=A Z=A Y^{\\prime}=A Z^{\\prime}\\), so \\(Y Z Y^{\\prime} Z^{\\prime}\\) is cyclic and \\(A S \\perp Y^{\\prime} Z^{\\prime}\\). Similarly, \\(B S \\perp Z^{\\prime} X^{\\prime}\\) and \\(C S \\perp X^{\\prime} Y^{\\prime}\\). The rest is angle chasing. Let \\(\\measuredangle \\ell\\) denote the angle between line \\(\\ell\\) and a fixed line. Then, we have \\(\\begin{aligned} \\measuredangle A S & =90^{\\circ}+\\measuredangle Y^{\\prime} Z^{\\prime}=90^{\\circ}+\\measuredangle Y Y^{\\prime}+\\measuredangle Z Z^{\\prime}-\\measuredangle Y Z \\\\ & =90^{\\circ}+\\measuredangle C A+\\measuredangle A B-\\measuredangle Y Z . \\end{aligned}\\) Analogously, we get \\(\\measuredangle B S=90^{\\circ}+\\measuredangle A B+\\measuredangle B C-\\measuredangle X Z,\\) so subtracting these gives \\(\\measuredangle A S B=\\measuredangle A C B\\), as desired.", "source_pdf": "TST_2025.pdf", "notes": ""}
{"id": "TST-2025-5", "contest": "TST", "year": "2025", "problem_number": "5", "problem": "A pond has 2025 lily pads arranged in a circle. Two frogs, Alice and Bob, begin on different lily pads. A frog jump is a jump which travels 2,3 , or 5 positions clockwise. Alice and Bob each make a series of frog jumps, and each frog ends on the same lily pad that it started from. Given that each lily pad is the destination of exactly one jump, prove that each frog completes exactly two laps around the pond (i.e. travels 4050 positions in total).", "solution": "Let \\(\\pi: \\mathbb{Z} / 2025 \\mathbb{Z} \\rightarrow \\mathbb{Z} / 2025 \\mathbb{Z}\\) be the permutation where the jump with source \\(i\\) has destination \\(\\pi(i)\\). We know that \\(\\pi\\) has exactly two cycles, corresponding to the paths of each frog. Suppose that the frogs complete a total of \\(\\ell\\) laps around the circle, so the sum of the lengths of all the jumps made is \\(2025 \\ell\\). Thus the average jump moves \\(\\ell\\) positions, so \\(\\ell \\in\\{2,3,4,5\\}\\). We now split into cases. II Case 1: \\(\\ell \\in\\{2,5\\} \\quad\\) If \\(\\ell=2\\), then every jump travels 2 positions, so \\(\\pi(i)=i+2\\) for all \\(i\\). This permutation has exactly one cycle, contradiction. If \\(\\ell=5\\), then every jump travels 5 positions, so \\(\\pi(i)=i+5\\) for all \\(i\\). This permutation has exactly five cycles, contradiction. IT Case 2: \\(\\ell=3\\) The key idea is to consider the cycle decomposition of the auxillary permutation \\(\\pi^{\\prime}: \\mathbb{Z} / 2025 \\mathbb{Z} \\rightarrow \\mathbb{Z} / 2025 \\mathbb{Z}\\) by \\(\\pi^{\\prime}(i)=\\pi(i)-3\\). The average jump in \\(\\pi^{\\prime}\\) (i.e. the distance from \\(i\\) to \\(\\pi^{\\prime}(i)\\) traveling clockwise) travels 0 positions. Thus, either each cycle of \\(\\pi^{\\prime}\\) either travels net zero positions, or there is some cycle that travels net negative positions. Since \\(\\pi^{\\prime}(i) \\in\\{i-1, i, i+2\\}\\), the latter case can only happen if \\(\\pi^{\\prime}(i)=i-1\\) for al \\(i\\), which has average jump -1 , not 0 , contradiction. Thus, each cycle travels net 0 positions. It is easy to see that the only such cycles are \\(i \\mapsto i\\) and \\(i \\mapsto i+2 \\mapsto i+1 \\mapsto i\\). Say that \\(i\\) is a unicycle start if \\(i \\mapsto i\\) is a cycle in \\(\\pi^{\\prime}\\), a tricycle start if \\(i \\mapsto i+2 \\mapsto i+1 \\mapsto i\\) is a cycle in \\(\\pi^{\\prime}\\), and a cycle start if it is either a unicycle start or a tricycle start. It is easy to see that if \\(i\\) is a unicycle start, then \\(i+1\\) must be a cycle start, and if \\(i\\) is a tricycle start, then \\(i+3\\) must be a cycle start. Given this structural classification of \\(\\pi^{\\prime}\\), we will now generate a contradiction by showing that \\(\\pi\\) can't have exactly two cycles. Place auxillary frogs \\(C, D\\), and \\(E\\) on lily pads \\(i, i+1\\), and \\(i+2\\) respectively, where \\(i\\) is a cycle start. If \\(i\\) is a unicycle start, then have \\(C\\) jump to \\(\\pi(i)=i+3\\). If \\(i\\) is a tricycle start, then have \\(C, D\\), and \\(E\\) jump to \\(\\pi(i)=i+5, \\pi(i+1)=i+3\\), and \\(\\pi(i+2)=i+4\\), respectively. Note that \\(C, D\\), and \\(E\\) are still on consecutive lily pads in some order, with the first lily pad number being a cycle start. We can repeat this process, having either the first frog or all three frogs jump according to permutation \\(\\pi\\), depending on whether the first lily pad number is a unicycle start or a tricycle start. When all of the cycles of \\(\\pi^{\\prime}\\) have been exhausted in this manner, \\(C, D\\), and \\(E\\) are back to positions \\(i, i+1\\), and \\(i+2\\), in some order. Note that each step of the above process permutes \\(C, D\\), and \\(E\\) with an even permutation, so the final permutation of \\(C, D\\), and \\(E\\) must be \\(C D E, D E C\\), or \\(E C D\\). The first case implies that \\(\\pi\\) has three cycles, while the other two cases imply that \\(\\pi\\) has only one cycle, a contradiction. If Case 3: \\(\\ell=4\\) Now consider the auxillary permutation \\(\\pi^{\\prime \\prime}: \\mathbb{Z} / 2025 \\mathbb{Z} \\rightarrow \\mathbb{Z} / 2025 \\mathbb{Z}\\) given by \\(\\pi^{\\prime \\prime}(i)=\\pi(i)-4\\). Note that \\(\\pi^{\\prime \\prime}(i) \\in\\{i-2, i-1, i+1\\}\\), so a similar analysis as the \\(\\ell=3\\) case shows that the only two possible types of cycles in \\(\\pi^{\\prime \\prime}\\) are \\(i \\rightarrow i+1 \\rightarrow i\\) and \\(i \\rightarrow i+1 \\rightarrow i+2 \\rightarrow i\\). Again, define \\(i\\) to be a bicycle start if \\(i \\mapsto i+1 \\mapsto i\\) is a cycle in \\(\\pi^{\\prime \\prime}\\) a tricycle start if \\(i \\mapsto i+1 \\mapsto i+2 \\mapsto i\\) is a cycle in \\(\\pi^{\\prime \\prime}\\), and a cycle start if it is either a bicycle or tricycle start. It is easy to see that if \\(i\\) is a bicycle start, then \\(i+2\\) must be a cycle start, and if \\(i\\) is a tricycle start, then \\(i+3\\) must be a cycle start. Now, place auxillary frogs \\(C, D, E\\), and \\(F\\) on lily pads \\(i, i+1, i+2\\), and \\(i+3\\) respectively, where \\(i\\) is a cycle start. If \\(i\\) is a bicycle start, have \\(C\\) jump to \\(\\pi(i)=i+5\\) and \\(D\\) jump to \\(\\pi(i+1)=i+4\\), and if \\(i\\) is a tricycle start, have \\(C\\) jump to \\(\\pi(i)=i+5\\), \\(D\\) jump to \\(\\pi(i+1)=i+6\\), and \\(E\\) jump to \\(\\pi(i+2)=i+4\\). Note that \\(C, D, E\\), and \\(F\\) are still on consecutive lily pads in some order, with the first lily pad number being a cycle start. If \\(i\\) is a bicycle start, then it causes the frogs to permute according to \\(C D E F \\mapsto E F D C\\), and if \\(i\\) is a tricycle start, then it causes the frogs to permute according to \\(C D E F \\mapsto F E C D\\). Thus, when all of the cycles of \\(\\pi^{\\prime \\prime}\\) have been exhausted in this manner, \\(C, D, E\\), and \\(F\\) are back to positions \\(i, i+1, i+2\\), and \\(i+3\\), in one of the permutations \\(C D E F\\), \\(E F D C, D C F E\\), or \\(F E C D\\). The first case implies that \\(\\pi\\) has four cycles, while the second and fourth cases imply that \\(\\pi\\) has only one cycle, a contradiction, so we must be in the third case, i.e. the frogs end up on lily pads \\(i, i+1, i+2\\), and \\(i+3\\) in the order \\(D C F E\\). Therefore, one of Alice or Bob travels the combined path of \\(C\\) and \\(D\\), while the other travels the combined path of \\(E\\) and \\(F\\), each of which completes two laps around the circle, as desired.", "source_pdf": "TST_2025.pdf", "notes": ""}
{"id": "TST-2025-6", "contest": "TST", "year": "2025", "problem_number": "6", "problem": "Prove that there exists a real number \\(\\varepsilon>0\\) such that there are infinitely many sequences of integers \\(0<a_{1}<a_{2}<\\ldots<a_{2025}\\) satisfying \\(\\operatorname{gcd}\\left(a_{1}^{2}+1, a_{2}^{2}+1, \\ldots, a_{2025}^{2}+1\\right)>a_{2025}^{1+\\varepsilon} .\\)", "solution": "By the Chinese Remainder Theorem for \\(\\mathbb{Q}[x]\\), for any choice of \\(2^{12}\\) signs there exists a unique polynomial \\(f_{i}\\) of degree at most 23 such that \\(f_{i} \\equiv \\pm c x \\quad\\left(\\bmod c^{2} x^{2}+1\\right)\\) for \\(c=1,2, \\ldots, 12\\). Furthermore, these polynomials are multiples of \\(x\\) and come in pairs which sum to zero, so we can pick 2048 of these polynomials which have positive leading coefficients and label them \\(f_{1}, f_{2}, \\ldots, f_{2048}\\). Let \\(N\\) be a positive integer such that any coefficient of the polynomials is \\(\\frac{1}{N}\\) times an integer. For a suffiiently large positive integer \\(x\\), take \\(a_{i}=f_{i}(N x)\\) for \\(i=1,2, \\ldots, 2025\\), which will be positive integers. Then, \\(\\operatorname{gcd}\\left(a_{1}^{2}+1, a_{2}^{2}+1, \\ldots, a_{2025}^{2}+1\\right) \\geq \\prod_{c=1}^{12}\\left(c^{2} x^{2}+1\\right)\\) because \\(a_{i}^{2}+1 \\equiv 0\\left(\\bmod c^{2} x^{2}+1\\right)\\) for any \\(i\\) by construction. The right hand side is asymptotically \\(x^{24}\\) while \\(a_{2025}\\) is \\(x^{23}\\) up to constant factors, so any \\(\\varepsilon<\\frac{1}{23}\\) works.", "source_pdf": "TST_2025.pdf", "notes": ""}
{"id": "TSTST-2016-1", "contest": "TSTST", "year": "2016", "problem_number": "1", "problem": "Let \\(A=A(x, y)\\) and \\(B=B(x, y)\\) be two-variable polynomials with real coefficients. Suppose that \\(A(x, y) / B(x, y)\\) is a polynomial in \\(x\\) for infinitely many values of \\(y\\), and a polynomial in \\(y\\) for infinitely many values of \\(x\\). Prove that \\(B\\) divides \\(A\\), meaning there exists a third polynomial \\(C\\) with real coefficients such that \\(A=B \\cdot C\\).", "solution": "This is essentially an application of the division algorithm, but the details require significant care.\n\nFirst, we claim that \\(A / B\\) can be written as a polynomial in \\(x\\) whose coefficients are rational functions in \\(y\\). To see this, use the division algorithm to get\n\\[\nA=Q \\cdot B+R \\quad Q, R \\in(\\mathbb{R}(y))[x]\n\\]\nwhere \\(Q\\) and \\(R\\) are polynomials in \\(x\\) whose coefficients are rational functions in \\(y\\), and moreover \\(\\operatorname{deg}_{x} B>\\operatorname{deg}_{x} R\\).\n\nNow, we claim that \\(R \\equiv 0\\). Indeed, we have by hypothesis that for infinitely many values of \\(y_{0}\\) that \\(B\\left(x, y_{0}\\right)\\) divides \\(A\\left(x, y_{0}\\right)\\), which means \\(B\\left(x, y_{0}\\right) \\mid R\\left(x, y_{0}\\right)\\) as polynomials in \\(\\mathbb{R}[x]\\). Now, we have \\(\\operatorname{deg}_{x} B\\left(x, y_{0}\\right)>\\operatorname{deg}_{x} R\\left(x, y_{0}\\right)\\) outside of finitely many values of \\(y_{0}\\) (but not all of them!); this means for infinitely many \\(y_{0}\\) we have \\(R\\left(x, y_{0}\\right) \\equiv 0\\). So each coefficient of \\(x^{i}\\) (in \\(\\mathbb{R}(y)\\) ) has infinitely many roots, hence is a zero polynomial.\n\nConsequently, we are able to write \\(A / B=F(x, y) / M(y)\\) where \\(F \\in \\mathbb{R}[x, y]\\) and \\(M \\in \\mathbb{R}[y]\\) are each polynomials. Repeating the same argument now gives\n\\[\n\\frac{A}{B}=\\frac{F(x, y)}{M(y)}=\\frac{G(x, y)}{N(x)} .\n\\]\n\nNow, by unique factorization of polynomials in \\(\\mathbb{R}[x, y]\\), we can discuss GCD's. So, we tacitly assume \\(\\operatorname{gcd}(F, M)=\\operatorname{gcd}(G, N)=(1)\\). Also, we obviously have \\(\\operatorname{gcd}(M, N)=(1)\\). But \\(F \\cdot N=G \\cdot M\\), so \\(M \\mid F \\cdot N\\), thus we conclude \\(M\\) is the constant polynomial. This implies the result.", "source_pdf": "TSTST_2016.pdf", "notes": ""}
{"id": "TSTST-2016-2", "contest": "TSTST", "year": "2016", "problem_number": "2", "problem": "Let \\(A B C\\) be a scalene triangle with orthocenter \\(H\\) and circumcenter \\(O\\) and denote by \\(M, N\\) the midpoints of \\(\\overline{A H}, \\overline{B C}\\). Suppose the circle \\(\\gamma\\) with diameter \\(\\overline{A H}\\) meets the circumcircle of \\(A B C\\) at \\(G \\neq A\\), and meets line \\(\\overline{A N}\\) at \\(Q \\neq A\\). The tangent to \\(\\gamma\\) at \\(G\\) meets line \\(O M\\) at \\(P\\). Show that the circumcircles of \\(\\triangle G N Q\\) and \\(\\triangle M B C\\) intersect on \\(\\overline{P N}\\).", "solution": "We present two solutions, one using essentially only power of a point, and the other more involved.\n\nIf First solution (found by contestants). Denote by \\(\\triangle D E F\\) the orthic triangle. Observe \\(\\overline{P A}\\) and \\(\\overline{P G}\\) are tangents to \\(\\gamma\\), since \\(\\overline{O M}\\) is the perpendicular bisector of \\(\\overline{A G}\\). Also note that \\(\\overline{A G}, \\overline{E F}, \\overline{B C}\\) are concurrent at some point \\(R\\) by radical axis on \\((A B C), \\gamma\\), (\\(B F E C\\)).\n\nNow, consider circles (\\(P A G M\\)), (\\(M F D N E\\)), and (\\(M B C\\)). We already saw the point \\(R\\) satisfies\n\\[\nR A \\cdot R G=R E \\cdot R F=R B \\cdot R C\n\\]\nand hence has equal powers to all three circles; but since the circles at \\(M\\) already, they must actually be coaxial. Assume they meet again at \\(T \\in \\overline{R M}\\), say. Then \\(\\angle P T M\\) and \\(\\angle M T N\\) are both right angles, hence \\(T\\) lies on \\(\\overline{P N}\\).\n\nFinally \\(H\\) is the orthocenter of \\(\\triangle A R N\\), and thus the circle with diameter \\(\\overline{R N}\\) passes through \\(G, Q, N\\).\n\nIf Alternate solution (by proposer). Let \\(L\\) be diametrically opposite \\(A\\) on the circum-circle. Denote by \\(\\triangle D E F\\) the orthic triangle. Let \\(X=\\overline{A H} \\cap \\overline{E F}\\). Finally, let \\(T\\) be the second intersection of (\\(M F D N E\\)) and (\\(M B C\\)).\n\nWe begin with a few easy observations. First, points \\(H, G, N, L\\) are collinear and \\(\\angle A G L=90^{\\circ}\\). Also, \\(Q\\) is the foot from \\(H\\) to \\(\\overline{A N}\\). Consequently, lines \\(A G, E F, H Q\\), \\(B C, T M\\) concur at a point \\(R\\) (radical axis). Moreover, we already know \\(\\angle M T N=90^{\\circ}\\). This implies \\(T\\) lies on the circle with diameter \\(\\overline{R N}\\), which is exactly the circumcircle of \\(\\triangle G Q N\\).\n\nNote by Brocard's Theorem on \\(A F H E\\), the point \\(X\\) is the orthocenter of \\(\\triangle M B C\\). But \\(\\angle M T N=90^{\\circ}\\) already, and \\(N\\) is the midpoint of \\(\\overline{B C}\\). Consequently, points \\(T, X\\), \\(N\\) are collinear.\n\nFinally, we claim \\(P, X, N\\) are collinear, which solves the problem. Note \\(P=\\overline{G G} \\cap \\overline{A A}\\). Set \\(K=\\overline{H N L} \\cap \\overline{A P}\\). Then by noting\n\\[\n-1=(D, X ; A, H) \\stackrel{N}{=} (\\infty, \\overline{N X} \\cap \\overline{A K} ; A, K)\n\\]\nwe see that \\(\\overline{N X}\\) bisects segment \\(\\overline{A K}\\), as desired. (A more projective finish is to show that \\(\\overline{P X N}\\) is the polar of \\(R\\) to \\(\\gamma\\)).", "source_pdf": "TSTST_2016.pdf", "notes": ""}
{"id": "TSTST-2016-3", "contest": "TSTST", "year": "2016", "problem_number": "3", "problem": "Decide whether or not there exists a nonconstant polynomial \\(Q(x)\\) with integer coefficients with the following property: for every positive integer \\(n>2\\), the numbers\n\\[\nQ(0), Q(1), Q(2), \\ldots, Q(n-1)\n\\]\nproduce at most \\(0.499 n\\) distinct residues when taken modulo \\(n\\).", "solution": "We claim that\n\\[\nQ(x)=420\\left(x^{2}-1\\right)^{2}\n\\]\nworks. Clearly, it suffices to prove the result when \\(n=4\\) and when \\(n\\) is an odd prime \\(p\\). The case \\(n=4\\) is trivial, so assume now \\(n=p\\) is an odd prime.\n\nFirst, we prove the following easy claim.\nClaim-For any odd prime \\(p\\), there are at least \\(\\frac{1}{2}(p-3)\\) values of \\(a\\) for which \\(\\left(\\frac{1-a^{2}}{p}\\right)=+1\\).\n\nProof. Note that if \\(k \\neq 0\\) and \\(k^{2} \\neq-1\\), then \\(a=\\frac{1-k^{2}}{k^{2}+1}\\) works.\n\nRemark. The above identity comes from starting with the equation \\(1-a^{2}=b^{2}\\), and writing it as \\(\\left(\\frac{1}{b}\\right)^{2}-\\left(\\frac{a}{b}\\right)^{2}=1\\). Then solve \\(\\frac{1}{b}-\\frac{a}{b}=k\\) and \\(\\frac{1}{b}+\\frac{a}{b}=1 / k\\) for \\(a\\).\n\nLet \\(F(x)=\\left(x^{2}-1\\right)^{2}\\). The range of \\(F\\) modulo \\(p\\) is contained within the \\(\\frac{1}{2}(p+1)\\) quadratic residues modulo \\(p\\). On the other hand, if for some \\(t\\) neither of \\(1 \\pm t\\) is a quadratic residue, then \\(t^{2}\\) is omitted from the range of \\(F\\) as well. Call such a value of \\(t\\) useful, and let \\(N\\) be the number of useful residues. We aim to show \\(N \\geq \\frac{1}{4} p-2\\).\n\nWe compute a lower bound on the number \\(N\\) of useful \\(t\\) by writing\n\\[\n\\begin{aligned}\nN & =\\frac{1}{4}\\left(\\sum_{t}\\left[\\left(1-\\left(\\frac{1-t}{p}\\right)\\right)\\left(1-\\left(\\frac{1+t}{p}\\right)\\right)\\right]-\\left(1-\\left(\\frac{2}{p}\\right)\\right)-\\left(1-\\left(\\frac{-2}{p}\\right)\\right)\\right) \\\\\n& \\geq \\frac{1}{4} \\sum_{t}\\left[\\left(1-\\left(\\frac{1-t}{p}\\right)\\right)\\left(1-\\left(\\frac{1+t}{p}\\right)\\right)\\right]-1 \\\\\n& =\\frac{1}{4}\\left(p+\\sum_{t}\\left(\\frac{1-t^{2}}{p}\\right)\\right)-1 \\\\\n& \\geq \\frac{1}{4}\\left(p+(+1) \\cdot \\frac{1}{2}(p-3)+0 \\cdot 2+(-1) \\cdot\\left((p-2)-\\frac{1}{2}(p-3)\\right)\\right)-1 \\\\\n& \\geq \\frac{1}{4}(p-5) .\n\\end{aligned}\n\\]\n\nThus, the range of \\(F\\) has size at most\n\\[\n\\frac{1}{2}(p+1)-\\frac{1}{2} N \\leq \\frac{3}{8}(p+3)\n\\]\n\nThis is less than \\(0.499 p\\) for any \\(p \\geq 11\\).\n\nRemark. In fact, the computation above is essentially an equality. There are only two points where terms are dropped: one, when \\(p \\equiv 3(\\bmod 4)\\) there are no \\(k^{2}=-1\\) in the lemma, and secondly, the terms \\(1-(2 / p)\\) and \\(1-(-2 / p)\\) are dropped in the initial estimate for \\(N\\). With suitable modifications, one can show that in fact, the range of \\(F\\) is exactly equal to\n\\[\n\\frac{1}{2}(p+1)-\\frac{1}{2} N=\\left\\{\\begin{array}{lll}\n\\frac{1}{8}(3 p+5) & p \\equiv 1 & (\\bmod 8) \\\\\n\\frac{1}{8}(3 p+7) & p \\equiv 3 & (\\bmod 8) \\\\\n\\frac{1}{8}(3 p+9) & p \\equiv 5 & (\\bmod 8) \\\\\n\\frac{1}{8}(3 p+3) & p \\equiv 7 & (\\bmod 8)\n\\end{array}\\right.\n\\]", "source_pdf": "TSTST_2016.pdf", "notes": ""}
{"id": "TSTST-2016-4", "contest": "TSTST", "year": "2016", "problem_number": "4", "problem": "Prove that if \\(n\\) and \\(k\\) are positive integers satisfying \\(\\varphi^{k}(n)=1\\), then \\(n \\leq 3^{k}\\). (Here \\(\\varphi^{k}\\) denotes \\(k\\) applications of the Euler phi function.)", "solution": "The main observation is that the exponent of 2 decreases by at most 1 with each application of \\(\\varphi\\). This will give us the desired estimate.\n\nDefine the weight function \\(w\\) on positive integers as follows: it satisfies\n\\[\n\\begin{aligned}\nw(a b) & =w(a)+w(b) \\\\\nw(2) & =1 ; \\quad \\text { and } \\\\\nw(p) & =w(p-1) \\quad \\text { for any prime } p>2 .\n\\end{aligned}\n\\]\n\nBy induction, we see that \\(w(n)\\) counts the powers of 2 that are produced as \\(\\varphi\\) is repeatedly applied to \\(n\\). In particular, \\(k \\geq w(n)\\).\n\nFrom \\(w(2)=1\\), it suffices to prove that \\(w(p) \\geq \\log _{3} p\\) for every \\(p>2\\). We use strong induction and note that\n\\[\nw(p)=w(2)+w\\left(\\frac{p-1}{2}\\right) \\geq 1+\\log _{3}(p-1)-\\log _{3} 2 \\geq \\log _{3} p\n\\]\nfor any \\(p>2\\). This solves the problem.\nRemark. One can motivate this solution through small cases \\(2^{x} 3^{y}\\) like \\(2^{x} 17^{w}, 2^{x} 3^{y} 7^{z}\\), \\(2^{x} 11^{t}\\).\n\nMoreover, the stronger bound\n\\[\nn \\leq 2 \\cdot 3^{k-1}\n\\]\nis true and best possible.", "source_pdf": "TSTST_2016.pdf", "notes": ""}
{"id": "TSTST-2016-5", "contest": "TSTST", "year": "2016", "problem_number": "5", "problem": "In the coordinate plane are finitely many walls, which are disjoint line segments, none of which are parallel to either axis. A bulldozer starts at an arbitrary point and moves in the \\(+x\\) direction. Every time it hits a wall, it turns at a right angle to its path, away from the wall, and continues moving. (Thus the bulldozer always moves parallel to the axes.)\n\nProve that it is impossible for the bulldozer to hit both sides of every wall.", "solution": "We say a wall \\(v\\) is above another wall \\(w\\) if some point on \\(v\\) is directly above a point on \\(w\\). (This relation is anti-symmetric, as walls do not intersect).\n\nThe critical claim is as follows:\nClaim-There exists a lowest wall, i.e. a wall not above any other walls.\n\nProof. Assume not. Then we get a directed cycle of some length \\(n \\geq 3\\): it's possible to construct a series of points \\(P_{i}, Q_{i}\\), for \\(i=1, \\ldots, n\\) (indices modulo \\(n\\)), such that the point \\(Q_{i}\\) is directly above \\(P_{i+1}\\) for each \\(i\\), the segment \\(\\overline{Q_{i} P_{i+1}}\\) does not intersect any wall in its interior, and finally each segment \\(\\overline{P_{i} Q_{i}}\\) is contained inside a wall. This gives us a broken line on \\(2 n\\) vertices which is not self-intersecting.\n\nNow consider the leftmost vertical segment \\(\\overline{Q_{i} P_{i+1}}\\) and the rightmost vertical segment \\(\\overline{Q_{j} P_{j+1}}\\). The broken line gives a path from \\(P_{i+1}\\) to \\(Q_{j}\\), as well as a path from \\(P_{j+1}\\) to \\(Q_{i}\\). These clearly must intersect, contradiction.\n\nRemark. This claim is Iran TST 2010.\n\nThus if the bulldozer eventually moves upwards indefinitely, it may never hit the bottom side of the lowest wall. Similarly, if the bulldozer eventually moves downwards indefinitely, it may never hit the upper side of the highest wall.", "source_pdf": "TSTST_2016.pdf", "notes": ""}
{"id": "TSTST-2016-6", "contest": "TSTST", "year": "2016", "problem_number": "6", "problem": "Let \\(A B C\\) be a triangle with incenter \\(I\\), and whose incircle is tangent to \\(\\overline{B C}, \\overline{C A}\\), \\(\\overline{A B}\\) at \\(D, E, F\\), respectively. Let \\(K\\) be the foot of the altitude from \\(D\\) to \\(\\overline{E F}\\). Suppose that the circumcircle of \\(\\triangle A I B\\) meets the incircle at two distinct points \\(C_{1}\\) and \\(C_{2}\\), while the circumcircle of \\(\\triangle A I C\\) meets the incircle at two distinct points \\(B_{1}\\) and \\(B_{2}\\). Prove that the radical axis of the circumcircles of \\(\\triangle B B_{1} B_{2}\\) and \\(\\triangle C C_{1} C_{2}\\) passes through the midpoint \\(M\\) of \\(\\overline{D K}\\).", "solution": "If First solution (Allen Liu). Let \\(X, Y, Z\\) be midpoints of \\(E F, F D, D E\\), and let \\(G\\) be the Gergonne point. By radical axis on \\((A E I F),(D E F),(A I C)\\) we see that \\(B_{1}\\), \\(X, B_{2}\\) are collinear. Likewise, \\(B_{1}, Z, B_{2}\\) are collinear, so lines \\(B_{1} B_{2}\\) and \\(X Z\\) coincide. Similarly, lines \\(C_{1} C_{2}\\) and \\(X Y\\) coincide. In particular lines \\(B_{1} B_{2}\\) and \\(C_{1} C_{2}\\) meet at \\(X\\).\n\nNote \\(G\\) is the symmedian point of \\(D E F\\), so it is well-known that \\(X G\\) passes through the midpoint of \\(D K\\). So we just have to prove \\(G\\) lies on the radical axis.\n\nFirst, note that \\(\\triangle D E F\\) is the cevian triangle of the Gergonne point \\(G\\). Set \\(V= \\overline{X Y} \\cap \\overline{A B}, W=\\overline{X Z} \\cap \\overline{A C}\\), and \\(T=\\overline{B W} \\cap \\overline{C V}\\).\n\nWe begin with the following completely projective claim.\n\nClaim-The points \\(X, G, T\\) are collinear.\n\nProof. It suffices to view \\(\\triangle X Y Z\\) as any cevian triangle of \\(\\triangle D E F\\) (which is likewise any cevian triangle of \\(\\triangle A B C\\)). Then\n-By Cevian Nest on \\(\\triangle A B C\\), it follows that \\(\\overline{A X}, \\overline{B Y}, \\overline{C Z}\\) are concurrent.\n-Hence \\(\\triangle B Y V\\) and \\(\\triangle C Z W\\) are perspective.\n-Hence \\(\\triangle B Z W\\) and \\(\\triangle C Y V\\) are perspective too.\n-Hence we deduce by Desargues theorem that \\(T, X\\), and \\(\\overline{B Z} \\cap \\overline{C Y}\\) are collinear.\n-Finally, the Cevian Nest theorem applied on \\(\\triangle G B C\\) (which has cevian triangles \\(\\triangle D F E, \\triangle X Z Y)\\) we deduce \\(G, X\\), and \\(\\overline{B Z} \\cap \\overline{C Y}\\), proving the claim.\n\nOne could also proceed by using barycentric coordinates on \\(\\triangle D E F\\).\n\nRemark (Eric Shen). The first four bullets can be replaced by non-projective means: one can check that \\(\\overline{B Z} \\cap \\overline{C Y}\\) is the radical center of (\\(B I C\\)), (\\(B B_{1} B_{2}\\)), (\\(C C_{1} C_{2}\\)) and therefore it lies on line \\(\\overline{X T}\\).\n\nNow, we contend point \\(V\\) is the radical center \\(\\left(C C_{1} C_{2}\\right),(A B C)\\) and \\((D E F)\\). To see this, let \\(V^{\\prime}=\\overline{E D} \\cap \\overline{A B}\\); then (\\(F V^{\\prime} ; A B\\)) is harmonic, and \\(V\\) is the midpoint of \\(\\overline{F V^{\\prime}}\\), and thus \\(V A \\cdot V B=V F^{2}=V C_{1} \\cdot V C_{2}\\).\n\nSo in fact \\(\\overline{C V}\\) is the radical axis of (\\(A B C\\)) and (\\(C C_{1} C_{2}\\)).\nSimilarly, \\(\\overline{B W}\\) is the radical axis of (\\(A B C\\)) and (\\(B B_{1} B_{2}\\)). Thus \\(T\\) is the radical center of \\((A B C),\\left(B B_{1} B_{2}\\right),\\left(C C_{1} C_{2}\\right)\\).\n\nThis completes the proof, as now \\(\\overline{X T}\\) is the desired radical axis.\n\nIT Second solution (Evan Chen). As before, we just have to prove \\(G\\) lies on the radical axis.\n\nConstruct parallelograms \\(G P F Q, G R D S, G T U E\\) such that \\(P, R \\in D F, S, T \\in D E\\), \\(Q, U \\in E F\\). As \\(F G\\) bisects \\(P Q\\) and is isogonal to \\(F Z\\), we find \\(P Q E D\\), hence \\(P Q R U\\), is cyclic. Repeating the same logic and noticing \\(P R, S T, Q U\\) not concurrent, all six points \\(P Q R S T U\\) are cyclic. Moreover, since \\(P Q\\) bisects \\(G F\\), we see that a dilation with factor 2 at \\(G\\) sends \\(P Q\\) to \\(P^{\\prime}, Q^{\\prime} \\in A B\\), say, with \\(F\\) the midpoint of \\(P^{\\prime} Q^{\\prime}\\). Define \\(R^{\\prime}, S^{\\prime} \\in B C\\) similarly now and \\(T^{\\prime}, U^{\\prime} \\in C A\\).\n\nNote that \\(E Q P D S^{\\prime}\\) is in cyclic too, as \\(\\measuredangle D S^{\\prime} Q=\\measuredangle D R S=\\measuredangle D E F\\). By homothety through \\(B\\), points \\(B, P, X\\) are collinear; assume they meet (\\(E Q P D S^{\\prime}\\)) again at \\(V\\). Thus \\(E V Q P D S^{\\prime}\\) is cyclic, and now\n\\[\n\\measuredangle B V S^{\\prime}=\\measuredangle P V S^{\\prime}=\\measuredangle P Q S=\\measuredangle P T S=\\measuredangle F E D=\\measuredangle X E Z=\\measuredangle X V Z\n\\]\nhence \\(V\\) lies on (\\(B Q^{\\prime} S^{\\prime}\\)).\nSince \\(F B \\| Q P\\), we get \\(E V F B\\) is cyclic too, so \\(X V \\cdot X B=X E \\cdot X F\\) now; thus \\(X\\) lies on the radical axis of (\\(B S^{\\prime} Q^{\\prime}\\)) and (\\(D E F\\)). By the same argument with \\(W \\in B Z\\), we get \\(Z\\) lies on the radical axis too. Thus the radical axis of (\\(B S^{\\prime} Q^{\\prime}\\)) and (\\(D E F\\)) must be line \\(X Z\\), which coincides with \\(B_{1} B_{2}\\); so \\(\\left(B B_{1} B_{2}\\right)=\\left(B S^{\\prime} Q^{\\prime}\\right)\\).\n\nAnalogously, \\(\\left(C C_{1} C_{2}\\right)=\\left(C R^{\\prime} U^{\\prime}\\right)\\). Since \\(G=Q^{\\prime} S^{\\prime} \\cap R^{\\prime} U^{\\prime}\\), we need only prove that \\(Q^{\\prime} R^{\\prime} S^{\\prime} U^{\\prime}\\) is cyclic. But \\(Q R S U\\) is cyclic, so we are done.\n\nThe circle (\\(P Q R S T U\\)) is called the Lemoine circle of \\(A B C\\).", "source_pdf": "TSTST_2016.pdf", "notes": ""}
{"id": "TSTST-2017-1", "contest": "TSTST", "year": "2017", "problem_number": "1", "problem": "Let \\(A B C\\) be a triangle with circumcircle \\(\\Gamma\\) \uff0ccircumcenter \\(O\\) \uff0cand orthocenter \\(H\\) \uff0e Assume that \\(A B \\neq A C\\) and \\(\\angle A \\neq 90^{\\circ}\\) \uff0eLet \\(M\\) and \\(N\\) be the midpoints of \\(\\overline{A B}\\) and \\(\\overline{A C}\\) \uff0crespectively\uff0cand let \\(E\\) and \\(F\\) be the feet of the altitudes from \\(B\\) and \\(C\\) in \\(\\triangle A B C\\) \uff0crespectively\uff0eLet \\(P\\) be the intersection point of line \\(M N\\) with the tangent line to \\(\\Gamma\\) at \\(A\\) \uff0eLet \\(Q\\) be the intersection point\uff0cother than \\(A\\) \uff0cof \\(\\Gamma\\) with the circumcircle of \\(\\triangle A E F\\) \uff0eLet \\(R\\) be the intersection point of lines \\(A Q\\) and \\(E F\\) \uff0e Prove that \\(\\overline{P R} \\perp \\overline{O H}\\) \uff0e", "solution": "First solution\uff08power of a point\uff09\uff0eLet \\(\\gamma\\) denote the nine\uff0dpoint circle of \\(A B C\\) \uff0e\n\nNote that\n\uff0d\\(P A^{2}=P M \\cdot P N\\) \uff0cso \\(P\\) lies on the radical axis of \\(\\Gamma\\) and \\(\\gamma\\) \uff0e\n\uff0d\\(R A \\cdot R Q=R E \\cdot R F\\) \uff0cso \\(R\\) lies on the radical axis of \\(\\Gamma\\) and \\(\\gamma\\) \uff0e\nThus \\(\\overline{P R}\\) is the radical axis of \\(\\Gamma\\) and \\(\\gamma\\) \uff0cwhich is evidently perpendicular to \\(\\overline{O H}\\) \uff0e\nRemark\uff0eIn fact\uff0cby power of a point one may also observe that \\(R\\) lies on \\(\\overline{B C}\\) \uff0csince it is on the radical axis of \\((A Q F H E),(B F E C),(A B C)\\) \uff0eIronically\uff0cthis fact is not used in the solution\uff0e\n\nIf Second solution\uff08barycentric coordinates\uff09\uff0eAgain note first \\(R \\in \\overline{B C}\\)\uff08although this can be avoided too\uff09\uff0eWe compute the points in much the same way as before\uff0eSince \\(\\overline{A P} \\cap \\overline{B C}=\\left(0: b^{2}:-c^{2}\\right)\\) we have\n\\[\nP=\\left(b^{2}-c^{2}: b^{2}:-c^{2}\\right)\n\\]\n\uff08since \\(x=y+z\\) is the equation of line \\(\\overline{M N}\\) \uff09\uff0eNow in Conway notation we have\n\\[\nR=\\overline{E F} \\cap \\overline{B C}=\\left(0: S_{C}:-S_{B}\\right)=\\left(0: a^{2}+b^{2}-c^{2}:-a^{2}+b^{2}-c^{2}\\right) .\n\\]\n\nHence\n\\[\n\\overrightarrow{P R}=\\frac{1}{2\\left(b^{2}-c^{2}\\right)}\\left(b^{2}-c^{2}, c^{2}-a^{2}, a^{2}-b^{2}\\right) .\n\\]\n\nOn the other hand\uff0cwe have \\(\\overrightarrow{O H}=\\vec{A}+\\vec{B}+\\vec{C}\\) \uff0eSo it suffices to check that\n\\[\n\\sum_{\\text {cyc }} a^{2}\\left(\\left(a^{2}-b^{2}\\right)+\\left(c^{2}-a^{2}\\right)\\right)=0\n\\]\nwhich is immediate\uff0e\n\nThird solution\uff08complex numbers\uff09\uff0eLet \\(A B C\\) be the unit circle\uff0eWe first compute \\(P\\) as the midpoint of \\(A\\) and \\(\\overline{A A} \\cap \\overline{B C}\\) \uff1a\n\\[\n\\begin{aligned}\np & =\\frac{1}{2}\\left(a+\\frac{a^{2}(b+c)-b c \\cdot 2 a}{a^{2}-b c}\\right) \\\\\n& =\\frac{a\\left(a^{2}-b c\\right)+a^{2}(b+c)-2 a b c}{2\\left(a^{2}-b c\\right)} .\n\\end{aligned}\n\\]\n\nUsing the remark above\uff0c\\(R\\) is the inverse of \\(D\\) with respect to the circle with diameter \\(\\overline{B C}\\) \uff0cwhich has radius \\(\\left|\\frac{1}{2}(b-c)\\right|\\) \uff0eThus\n\\[\n\\begin{aligned}\nr-\\frac{b+c}{2} & =\\frac{\\frac{1}{4}(b-c)\\left(\\frac{1}{b}-\\frac{1}{c}\\right)}{\\frac{1}{2}\\left(a-\\frac{b c}{a}\\right)} \\\\\nr & =\\frac{b+c}{2}+\\frac{-\\frac{1}{2} \\frac{(b-c)^{2}}{b c}}{\\frac{1}{a}-\\frac{a}{b c}} \\\\\n& =\\frac{b+c}{2}+\\frac{a(b-c)^{2}}{2\\left(a^{2}-b c\\right)} \\\\\n& =\\frac{a(b-c)^{2}+(b+c)\\left(a^{2}-b c\\right)}{2\\left(a^{2}-b c\\right)}\n\\end{aligned}\n\\]\n\nExpanding and subtracting gives\n\\[\np-r=\\frac{a^{3}-a b c-a b^{2}-a c^{2}+b^{2} c+b c^{2}}{2\\left(a^{2}-b c\\right)}=\\frac{(a+b+c)(a-b)(a-c)}{2\\left(a^{2}-b c\\right)}\n\\]\nwhich is visibly equal to the negation of its conjugate once the factor of \\(a+b+c\\) is deleted\uff0e\n\uff08Actually\uff0cone can guess this factorization ahead of time by noting that if \\(A=B\\) \uff0cthen \\(P=B=R\\) \uff0cso \\(a-b\\) must be a factor\uff1banalogously \\(a-c\\) must be as well\uff0e\uff09", "source_pdf": "TSTST_2017.pdf", "notes": ""}
{"id": "TSTST-2017-2", "contest": "TSTST", "year": "2017", "problem_number": "2", "problem": "Ana and Banana are playing a game\uff0eFirst Ana picks a word\uff0cwhich is defined to be a nonempty sequence of capital English letters\uff0eThen Banana picks a nonnegative integer \\(k\\) and challenges Ana to supply a word with exactly \\(k\\) subsequences which are equal to Ana\uff07s word\uff0eAna wins if she is able to supply such a word\uff0cotherwise she loses\uff0eFor example\uff0cif Ana picks the word\uff02TST\uff02\uff0cand Banana chooses \\(k=4\\) \uff0c then Ana can supply the word\uff02TSTST\uff02which has 4 subsequences which are equal to Ana\uff07s word\uff0eWhich words can Ana pick so that she can win no matter what value of \\(k\\) Banana chooses\uff1f", "solution": "First we introduce some notation\uff0eDefine a block of letters to be a maximal contiguous subsequence of consecutive letters\uff0eFor example\uff0cthe word \\(A A B B B C A A A\\) has four blocks\uff0cnamely \\(A A, B B B, C, A A A\\) \uff0eThroughout the solution\uff0cwe fix the word \\(A\\) that Ana picks\uff0cand introduce the following notation for its \\(m\\) blocks\uff1a\n\\[\nA=A_{1} A_{2} \\ldots A_{m}=\\underbrace{a_{1} \\ldots a_{1}}_{x_{1}} \\underbrace{a_{2} \\ldots a_{2}}_{x_{2}} \\ldots \\underbrace{a_{m} \\ldots a_{m}}_{x_{m}} .\n\\]\n\nA rainbow will be a subsequence equal to Ana\uff07s initial word \\(A\\)\uff08meaning Ana seeks words with exactly \\(k\\) rainbows\uff09\uff0eFinally\uff0cfor brevity\uff0clet \\(A_{i}=\\underbrace{a_{i} \\ldots a_{i}}_{x_{i}}\\) \uff0cso \\(A=A_{1} \\ldots A_{m}\\) \uff0e\n\nWe prove two claims that resolve the problem\uff0e\nClaim\uff0dIf \\(x_{i}=1\\) for some \\(i\\) \uff0cthen for any \\(k \\geq 1\\) \uff0cthe word\n\\[\nW=A_{1} \\ldots A_{i-1} \\underbrace{a_{i} \\ldots a_{i}}_{k} A_{i+1} \\ldots A_{m}\n\\]\nobtained by repeating the \\(i\\) th letter \\(k\\) times has exactly \\(k\\) rainbows\uff0e\n\nProof\uff0eObviously there are at least \\(\\binom{k}{k-1}=k\\) rainbows\uff0cobtained by deleting \\(k-1\\) choices of the letter \\(a_{i}\\) in the repeated block\uff0eWe show they are the only ones\uff0e\n\nGiven a rainbow\uff0cconsider the location of this singleton block in \\(W\\) \uff0eIt cannot occur within the first \\(\\left|A_{1}\\right|+\\cdots+\\left|A_{i-1}\\right|\\) letters\uff0cnor can it occur within the final \\(\\left|A_{i+1}\\right|+\\cdots+\\left|A_{m}\\right|\\) letters\uff0eSo it must appear in the \\(i\\) th block of \\(W\\) \uff0eThat implies that all the other \\(a_{i}\\)\uff07s in the \\(i\\) th block of \\(W\\) must be deleted\uff0cas desired\uff0e\uff08This last argument is actually nontrivial\uff0c and has some substance\uff1bmany students failed to realize that the upper bound requires care\uff0e\uff09\n\nClaim\uff0dIf \\(x_{i} \\geq 2\\) for all \\(i\\) \uff0cthen no word \\(W\\) has exactly two rainbows\uff0e\n\nProof\uff0eWe prove if there are two rainbows of \\(W\\) \uff0cthen we can construct at least three rainbows\uff0e\n\nLet \\(W=w_{1} \\ldots w_{n}\\) and consider the two rainbows of \\(W\\) \uff0eSince they are not the same\uff0c there must be a block \\(A_{p}\\) of the rainbow\uff0cof length \\(\\ell \\geq 2\\) \uff0cwhich do not occupy the same locations in \\(W\\) \uff0e\n\nAssume the first rainbow uses \\(w_{i_{1}}, \\ldots, w_{i_{\\ell}}\\) for this block and the second rainbow uses \\(w_{j_{1}}, \\ldots, w_{j_{\\ell}}\\) for this block\uff0eThen among the letters \\(w_{q}\\) for \\(\\min \\left(i_{1}, j_{1}\\right) \\leq q \\leq \\max \\left(i_{\\ell}, j_{\\ell}\\right)\\) \uff0c there must be at least \\(\\ell+1\\) copies of the letter \\(a_{p}\\) \uff0eMoreover\uff0cgiven a choice of \\(\\ell\\) copies of the letter \\(a_{p}\\) in this range\uff0cone can complete the subsequence to a rainbow\uff0eSo the number of rainbows is at least \\(\\binom{\\ell+1}{\\ell} \\geq \\ell+1\\) \uff0e\n\nSince \\(\\ell \\geq 2\\) \uff0cthis proves \\(W\\) has at least three rainbows\uff0e\nIn summary\uff0cAna wins if and only if \\(x_{i}=1\\) for some \\(i\\) \uff0csince she can duplicate the isolated letter \\(k\\) times\uff1bbut if \\(x_{i} \\geq 2\\) for all \\(i\\) then Banana only needs to supply \\(k=2\\) \uff0e", "source_pdf": "TSTST_2017.pdf", "notes": ""}
{"id": "TSTST-2017-3", "contest": "TSTST", "year": "2017", "problem_number": "3", "problem": "Consider solutions to the equation\n\\[\nx^{2}-c x+1=\\frac{f(x)}{g(x)}\n\\]\nwhere \\(f\\) and \\(g\\) are nonzero polynomials with nonnegative real coefficients\uff0eFor each \\(c>0\\) \uff0cdetermine the minimum possible degree of \\(f\\) \uff0cor show that no such \\(f, g\\) exist\uff0e", "solution": "First\uff0cif \\(c \\geq 2\\) then we claim no such \\(f\\) and \\(g\\) exist\uff0eIndeed\uff0cone simply takes \\(x=1\\) to get \\(f(1) / g(1) \\leq 0\\) \uff0cimpossible\uff0e\n\nFor \\(c<2\\) \uff0clet \\(c=2 \\cos \\theta\\) \uff0cwhere \\(0<\\theta<\\pi\\) \uff0eWe claim that \\(f\\) exists and has minimum degree equal to \\(n\\) \uff0cwhere \\(n\\) is defined as the smallest integer satisfying \\(\\sin n \\theta \\leq 0\\) \uff0eIn other words\n\\[\nn=\\left\\lceil\\frac{\\pi}{\\arccos (c / 2)}\\right\\rceil\n\\]\n\nFirst we show that this is necessary\uff0eTo see it\uff0cwrite explicitly\n\\[\ng(x)=a_{0}+a_{1} x+a_{2} x^{2}+\\cdots+a_{n-2} x^{n-2}\n\\]\nwith each \\(a_{i} \\geq 0\\) \uff0cand \\(a_{n-2} \\neq 0\\) \uff0eAssume that \\(n\\) is such that \\(\\sin (k \\theta) \\geq 0\\) for \\(k=1, \\ldots, n-1\\) \uff0e Then\uff0cwe have the following system of inequalities\uff1a\n\\[\n\\begin{aligned}\na_{1} & \\geq 2 \\cos \\theta \\cdot a_{0} \\\\\na_{0}+a_{2} & \\geq 2 \\cos \\theta \\cdot a_{1} \\\\\na_{1}+a_{3} & \\geq 2 \\cos \\theta \\cdot a_{2} \\\\\n\\vdots & \\\\\na_{n-5}+a_{n-3} & \\geq 2 \\cos \\theta \\cdot a_{n-4} \\\\\na_{n-4}+a_{n-2} & \\geq 2 \\cos \\theta \\cdot a_{n-3} \\\\\na_{n-3} & \\geq 2 \\cos \\theta \\cdot a_{n-2}\n\\end{aligned}\n\\]\n\nNow\uff0cmultiply the first equation by \\(\\sin \\theta\\) \uff0cthe second equation by \\(\\sin 2 \\theta\\) \uff0cet cetera\uff0cup to \\(\\sin ((n-1) \\theta)\\) \uff0eThis choice of weights is selected since we have\n\\[\n\\sin (k \\theta)+\\sin ((k+2) \\theta)=2 \\sin ((k+1) \\theta) \\cos \\theta\n\\]\nso that summing the entire expression cancels nearly all terms and leaves only\n\\[\n\\sin ((n-2) \\theta) a_{n-2} \\geq \\sin ((n-1) \\theta) \\cdot 2 \\cos \\theta \\cdot a_{n-2}\n\\]\nand so by dividing by \\(a_{n-2}\\) and using the same identity gives us \\(\\sin (n \\theta) \\leq 0\\) \uff0cas claimed\uff0e\nThis bound is best possible\uff0cbecause the example\n\\[\na_{k}=\\sin ((k+1) \\theta) \\geq 0\n\\]\nmakes all inequalities above sharp\uff0chence giving a working pair\uff08 \\(f, g\\) \uff09\uff0e\n\nRemark\uff0eCalvin Deng points out that a cleaner proof of the lower bound is to take \\(\\alpha=\\cos \\theta+i \\sin \\theta\\) \uff0eThen \\(f(\\alpha)=0\\) \uff0cbut by condition the imaginary part of \\(f(\\alpha)\\) is apparently strictly positive\uff0ccontradiction\uff0e\n\nRemark\uff0eGuessing that \\(c<2\\) works at all\uff08and realizing \\(c \\geq 2\\) fails\uff09is the first part of the problem\uff0e\n\nThe introduction of trigonometry into the solution may seem magical\uff0cbut is motivated in one of two ways\uff1a\n\uff0dCalvin Deng points out that it\uff07s possible to guess the answer from small cases\uff1aFor \\(c \\leq 1\\) we have \\(n=3\\) \uff0ctight at \\(\\frac{x^{3}+1}{x+1}=x^{2}-x+1\\) \uff0cand essentially the\uff02sharpest \\(n=3\\) example\uff02\uff0eA similar example exists at \\(n=4\\) with \\(\\frac{x^{4}+1}{x^{2}+\\sqrt{2} x+1}=x^{2}-\\sqrt{2} x+1\\) by the Sophie\uff0dGermain identity\uff0eIn general\uff0cone can do long division to extract an optimal value of \\(c\\) for any given \\(n\\) \uff0calthough \\(c\\) will be the root of some polynomial\uff0e\nThe thresholds \\(c \\leq 1\\) for \\(n=3, c \\leq \\sqrt{2}\\) for \\(n=4, c \\leq \\frac{1+\\sqrt{5}}{2}\\) for \\(n=5\\) \uff0cand \\(c \\leq 2\\) for \\(n<\\infty\\) suggest the unusual form of the answer via trigonometry\uff0e\n\uff0dOne may imagine trying to construct a polynomial recursively\uff0fgreedily by making all inequalities above hold\uff08again the\uff02sharpest situation\uff02in which \\(f\\) has few coefficients\uff09\uff0e If one sets \\(c=2 t\\) \uff0cthen we have\n\\[\na_{0}=1, \\quad a_{1}=2 t, \\quad a_{2}=4 t^{2}-1, \\quad a_{3}=8 t^{3}-4 t, \\quad \\cdots\n\\]\nwhich are the Chebyshev polynomials of the second type\uff0eThis means that trigonometry is essentially mandatory\uff0e\uff08One may also run into this when by using standard linear recursion techniques\uff0cand noting that the characteristic polynomial has two conjugate complex roots\uff0e\uff09\n\nRemark\uff0eMitchell Lee notes that an IMO longlist problem from 1997 shows that if \\(P(x)\\) is any polynomial satisfying \\(P(x)>0\\) for \\(x>0\\) \uff0cthen \\((x+1)^{n} P(x)\\) has nonnegative coefficients for large enough \\(n\\) \uff0eThis show that \\(f\\) and \\(g\\) at least exist for \\(c \\leq 2\\) \uff0cbut provides no way of finding the best possible \\(\\operatorname{deg} f\\) \uff0e\n\nMeghal Gupta also points out that showing \\(f\\) and \\(g\\) exist is possible in the following way\uff1a\n\\[\n\\left(x^{2}-1.99 x+1\\right)\\left(x^{2}+1.99 x+1\\right)=\\left(x^{4}-1.9601 x^{2}+1\\right)\n\\]\nand so on\uff0crepeatedly multiplying by the\uff02conjugate\uff02until all coefficients become positive\uff0e To my best knowledge\uff0cthis also does not give any way of actually minimizing \\(\\operatorname{deg} f\\) \uff0calthough Ankan Bhattacharya points out that this construction is actually optimal in the case where \\(n\\) is a power of 2 \uff0e\n\nRemark\uff0eIt\uff07s pointed out that Matematicheskoe Prosveshchenie\uff0cissue 1\uff0c1997\uff0cpage 194 contains a nearly analogous result\uff0cavailable at https\uff1a\uff0f\uff0fmccme\uff0eru\uff0ffree\uff0dbooks\uff0fmatpros\uff0f pdf\uff0fmp\uff0d01\uff0epdf with solutions presented in https\uff1a\uff0f\uff0fmccme\uff0eru\uff0ffree\uff0dbooks\uff0fmatpros\uff0fpdf\uff0f mp\uff0d05\uff0epdf\uff0cpages 221\uff0d223\uff1band https\uff1a\uff0f\uff0fmccme\uff0eru\uff0ffree\uff0dbooks\uff0fmatpros\uff0fpdf\uff0fmp\uff0d10\uff0epdf\uff0c page 274.", "source_pdf": "TSTST_2017.pdf", "notes": ""}
{"id": "TSTST-2017-4", "contest": "TSTST", "year": "2017", "problem_number": "4", "problem": "Find all nonnegative integer solutions to\n\\[\n2^{a}+3^{b}+5^{c}=n!.\n\\]", "solution": "For \\(n \\leq 4\\) \uff0cone can check the only solutions are\uff1a\n\\[\n\\begin{aligned}\n& 2^{2}+3^{0}+5^{0}=3! \\\\\n& 2^{1}+3^{1}+5^{0}=3! \\\\\n& 2^{4}+3^{1}+5^{1}=4!.\n\\end{aligned}\n\\]\n\nNow we prove there are no solutions for \\(n \\geq 5\\) \uff0e\nA tricky way to do this is to take modulo 120 \uff0csince\n\\[\n\\begin{array}{ll}\n2^{a} & (\\bmod 120) \\in\\{1,2,4,8,16,32,64\\} \\\\\n3^{b} & (\\bmod 120) \\in\\{1,3,9,27,81\\} \\\\\n5^{c} & (\\bmod 120) \\in\\{1,5,25\\}\n\\end{array}\n\\]\nand by inspection one notes that no three elements have vanishing sum modulo 120 \uff0e\nI expect most solutions to instead use casework\uff0eHere is one possible approach with cases\uff08with \\(n \\geq 5\\) \uff09\uff0eFirst\uff0cwe analyze the cases where \\(a<3\\) \uff1a\n\uff0d\\(a=0\\) \uff1aNo solutions for parity reasons\uff0e\n\uff0d\\(a=1\\) \uff1asince \\(3^{b}+5^{c} \\equiv 6(\\bmod 8)\\) \uff0cwe find \\(b\\) even and \\(c\\) odd\uff08hence \\(c \\neq 0\\) \uff09\uff0eNow looking modulo 5 gives that \\(3^{b}+5^{c} \\equiv 3(\\bmod 5)\\) \uff0c\n\uff0d\\(a=2\\) \uff1aFrom \\(3^{b}+5^{c} \\equiv 4(\\bmod 8)\\) \uff0cwe find \\(b\\) is odd and \\(c\\) is even\uff0eNow looking modulo 5 gives a contradiction\uff0ceven if \\(c=0\\) \uff0csince \\(3^{b} \\in\\{2,3(\\bmod 5)\\}\\) but \\(3^{b}+5^{c} \\equiv 1(\\bmod 5)\\) \uff0e\n\nHenceforth assume \\(a \\geq 3\\) \uff0eNext\uff0cby taking modulo 8 we have \\(3^{b}+5^{c} \\equiv 0(\\bmod 8)\\) \uff0cwhich forces both \\(b\\) and \\(c\\) to be odd\uff08in particular\uff0c\\(b, c>0\\) \uff09\uff0eWe now have\n\\[\n\\begin{aligned}\n& 2^{a}+5^{c} \\equiv 0 \\quad(\\bmod 3) \\\\\n& 2^{a}+3^{b} \\equiv 0 \\quad(\\bmod 5)\n\\end{aligned}\n\\]\n\nThe first equation implies \\(a\\) is even\uff0cbut the second equation requires \\(a\\) to be odd\uff0c contradiction\uff0eHence no solutions with \\(n \\geq 5\\) \uff0e", "source_pdf": "TSTST_2017.pdf", "notes": ""}
{"id": "TSTST-2017-5", "contest": "TSTST", "year": "2017", "problem_number": "5", "problem": "Let \\(A B C\\) be a triangle with incenter \\(I\\) \uff0eLet \\(D\\) be a point on side \\(B C\\) and let \\(\\omega_{B}\\) and \\(\\omega_{C}\\) be the incircles of \\(\\triangle A B D\\) and \\(\\triangle A C D\\) \uff0crespectively\uff0eSuppose that \\(\\omega_{B}\\) and \\(\\omega_{C}\\) are tangent to segment \\(B C\\) at points \\(E\\) and \\(F\\) \uff0crespectively\uff0eLet \\(P\\) be the intersection of segment \\(A D\\) with the line joining the centers of \\(\\omega_{B}\\) and \\(\\omega_{C}\\) \uff0eLet \\(X\\) be the intersection point of lines \\(B I\\) and \\(C P\\) and let \\(Y\\) be the intersection point of lines \\(C I\\) and \\(B P\\) \uff0eProve that lines \\(E X\\) and \\(F Y\\) meet on the incircle of \\(\\triangle A B C\\) \uff0e", "solution": "If First solution\uff08homothety\uff09\uff0eLet \\(Z\\) be the diametrically opposite point on the incircle\uff0e We claim this is the desired intersection\uff0e\n\nNote that\uff1a\n\uff0d\\(P\\) is the insimilicenter of \\(\\omega_{B}\\) and \\(\\omega_{C}\\)\n\uff0d\\(C\\) is the exsimilicenter of \\(\\omega\\) and \\(\\omega_{C}\\) \uff0e\nThus by Monge theorem\uff0cthe insimilicenter of \\(\\omega_{B}\\) and \\(\\omega\\) lies on line \\(C P\\) \uff0e\nThis insimilicenter should also lie on the line joining the centers of \\(\\omega\\) and \\(\\omega_{B}\\) \uff0cwhich is \\(\\overline{B I}\\) \uff0chence it coincides with the point \\(X\\) \uff0eSo \\(X \\in \\overline{E Z}\\) as desired\uff0e\n\nI Second solution\uff08harmonic\uff09\uff0eLet \\(T=\\overline{I_{B} I_{C}} \\cap \\overline{B C}\\) \uff0cand \\(W\\) the foot from \\(I\\) to \\(\\overline{B C}\\) \uff0e Define \\(Z=\\overline{F Y} \\cap \\overline{I W}\\) \uff0eBecause \\(\\angle I_{B} D I_{C}=90^{\\circ}\\) \uff0cwe have\n\\[\n-1=\\left(I_{B} I_{C} ; P T\\right) \\stackrel{B}{=}\\left(I I_{C} ; Y C\\right) \\stackrel{F}{=}(I \\infty ; Z W)\n\\]\n\nSo \\(I\\) is the midpoint of \\(\\overline{Z W}\\) as desired\uff0e\n\nThird solution\uff08outline\uff0cbarycentric\uff0cAndrew Gu\uff09\uff0eLet \\(A D=t, B D=x, C D=y\\) \uff0c so \\(a=x+y\\) and by Stewart\uff07s theorem we have\n\\[\n(x+y)\\left(x y+t^{2}\\right)=b^{2} x+c^{2} y .\n\\]\n\nWe then have \\(D=(0: y: x)\\) and so\n\\[\n\\overline{A I_{B}} \\cap \\overline{B C}=\\left(0: y+\\frac{t x}{c+t}: \\frac{c x}{c+t}\\right)\n\\]\nhence intersection with \\(B I\\) gives\n\\[\nI_{B}=(a x: c y+a t: c x) .\n\\]\n\nSimilarly\uff0c\n\\[\nI_{C}=(a y: b y: b x+a t) .\n\\]\n\nThen\uff0cwe can compute\n\\[\nP=(2 a x y: y(a t+b x+c y): x(a t+b x+c y))\n\\]\nsince \\(P \\in \\overline{I_{B} I_{C}}\\) \uff0cand clearly \\(P \\in \\overline{A D}\\) \uff0eIntersection now gives\n\\[\n\\begin{aligned}\n& X=(2 a x: a t+b x+c y: 2 c x) \\\\\n& Y=(2 a y: 2 b y: a t+b x+c y)\n\\end{aligned}\n\\]\n\nFinally\uff0cwe have \\(B E=\\frac{1}{2}(c+x-t)\\) \uff0cand similarly for \\(C F\\) \uff0eNow if we reflect \\(D=\\) \uff08 \\(0, \\frac{s-c}{a}, \\frac{s-b}{a}\\) \uff09over \\(I=\\left(\\frac{a}{2 s}, \\frac{b}{2 s}, \\frac{c}{2 s}\\right)\\) \uff0cwe get the antipode\n\\[\nQ:=\\left(4 a^{2}:-a^{2}+2 a b-b^{2}+c^{2}:-a^{2}+2 a c-c^{2}+b^{2}\\right)\n\\]\n\nWe may then check \\(Q\\) lies on each of lines \\(E X\\) and \\(F Y\\)\uff08by checking \\(\\operatorname{det}(Q, E, X)=0\\) using the equation\uff081\uff09\uff09\uff0e", "source_pdf": "TSTST_2017.pdf", "notes": ""}
{"id": "TSTST-2017-6", "contest": "TSTST", "year": "2017", "problem_number": "6", "problem": "A sequence of positive integers \\(\\left(a_{n}\\right)_{n \\geq 1}\\) is of Fibonacci type if it satisfies the recursive relation \\(a_{n+2}=a_{n+1}+a_{n}\\) for all \\(n \\geq 1\\) \uff0eIs it possible to partition the set of positive integers into an infinite number of Fibonacci type sequences\uff1f", "solution": "Yes\uff0cit is possible\uff0eThe following solutions were written for me by Kevin Sun and Mark Sellke\uff0eWe let \\(F_{1}=F_{2}=1, F_{3}=2, F_{4}=3, F_{5}=5, \\ldots\\) denote the Fibonacci numbers\uff0e\n\nIf First solution\uff08Kevin Sun\uff09\uff0eWe are going to appeal to the so\uff0dcalled Zeckendorf theorem\uff1a\n\n\\section*{Theorem\uff08Zeckendorf\uff09}\n\nEvery positive integer can be uniquely expressed as the sum of nonconsecutive Fibonacci numbers\uff0e\n\nThis means every positive integer has a Zeckendorf\uff08\uff02Fibonacci\uff0dbinary\uff02\uff09representation where we put 1 in the \\(i\\) th digit from the right if \\(F_{i+1}\\) is used\uff0eThe idea is then to take the following so\uff0dcalled Wythoff array\uff1a\n\uff0dRow 1\uff1a \\(1,2,3,5, \\ldots\\)\n\uff0dRow 101\uff1a \\(1+3,2+5,3+8, \\ldots\\)\n\uff0dRow 1001\uff1a \\(1+5,2+8,3+13, \\ldots\\)\n\uff0dRow 10001\uff1a \\(1+8,2+13,3+21, \\ldots\\)\n\uff0dRow 10101\uff1a \\(1+3+8,2+5+13,3+8+21, \\ldots\\)\n\uff0d\uff0e\uff0e\uff0eet cetera\uff0e\nMore concretely\uff0cthe array has the following rows to start\uff1a\n\n\\begin{tabular}{cccccccc}\n1 & 2 & 3 & 5 & 8 & 13 & 21 & \\(\\ldots\\) \\\\\n4 & 7 & 11 & 18 & 29 & 47 & 76 & \\(\\ldots\\) \\\\\n6 & 10 & 16 & 26 & 42 & 68 & 110 & \\(\\ldots\\) \\\\\n9 & 15 & 24 & 39 & 63 & 102 & 165 & \\(\\ldots\\) \\\\\n12 & 20 & 32 & 52 & 84 & 136 & 220 & \\(\\ldots\\) \\\\\n14 & 23 & 37 & 60 & 97 & 157 & 254 & \\(\\ldots\\) \\\\\n17 & 28 & 45 & 73 & 118 & 191 & 309 & \\(\\ldots\\) \\\\\n\\(\\vdots\\) & \\(\\vdots\\) & \\(\\vdots\\) & \\(\\vdots\\) & \\(\\vdots\\) & \\(\\vdots\\) & \\(\\vdots\\) & \\(\\ddots\\)\n\\end{tabular}\n\nHere are the full details\uff0e\nWe begin by outlining a proof of Zeckendorf\uff07s theorem\uff0cwhich implies the representation above is unique\uff0eNote that if \\(F_{k}\\) is the greatest Fibonacci number at most \\(n\\) \uff0cthen\n\\[\nn-F_{k}<F_{k+1}-F_{k}=F_{k-1} .\n\\]\n\nIn particular\uff0crepeatedly subtracting off the largest \\(F_{k}\\) from \\(n\\) will produce one such representation with no two consecutive Fibonacci numbers\uff0eOn the other hand\uff0cthis \\(F_{k}\\) must be used\uff0cas\n\\[\nn \\geq F_{k}>F_{k-1}+F_{k-3}+F_{k-5}+\\cdots\n\\]\n\nThis shows\uff0cby a simple inductive argument\uff0cthat such a representation exists and unique\uff0e\nWe write \\(n=\\overline{a_{k} \\ldots a_{1}}\\) Fib for the Zeckendorf representation as we described\uff08where \\(a_{i}=1\\) if \\(F_{i+1}\\) is used\uff09\uff0eNow for each \\(\\overline{a_{k} \\ldots a_{1}}\\) Fib with \\(a_{1}=1\\) \uff0cconsider the sequence\n\\[\n{\\overline{a_{k} \\ldots a_{1}}}_{\\mathrm{Fib}},{\\overline{a_{k} \\ldots a_{1} 0}}_{\\mathrm{Fib}},{\\overline{a_{k} \\ldots a_{1} 00}}_{\\mathrm{Fib}}, \\ldots\n\\]\n\nThese sequences are Fibonacci\uff0dtype by definition\uff0cand partition the positive integers since each positive integer has exactly one Fibonacci base representation\uff0e\n\nIT Second solution\uff0eCall an infinite set of integers \\(S\\) sandwiched if there exist increasing sequences \\(\\left\\{a_{i}\\right\\}_{i=0}^{\\infty},\\left\\{b_{i}\\right\\}_{i=0}^{\\infty}\\) such that the following are true\uff1a\n\uff0d\\(a_{i}+a_{i+1}=a_{i+2}\\) and \\(b_{i}+b_{i+1}=b_{i+2}\\) \uff0e\n\uff0dThe intervals \\(\\left[a_{i}+1, b_{i}-1\\right]\\) are disjoint and are nondecreasing in length\uff0e\n\uff0d\\(S=\\bigcup_{i=0}^{\\infty}\\left[a_{i}+1, b_{i}-1\\right]\\).\nWe claim that if \\(S\\) is any nonempty sandwiched set\uff0cthen \\(S\\) can be partitioned into a Fibonacci\uff0dtype sequence\uff08involving the smallest element of \\(S\\) \uff09and two smaller sandwiched sets\uff0eIf this claim is proven\uff0cthen we can start with \\(\\mathbb{N} \\backslash\\{1,2,3,5, \\ldots\\}\\) \uff0cwhich is a sandwiched set\uff0cand repeatedly perform this partition\uff0cwhich will eventually sort each natural number into a Fibonacci\uff0dtype sequence\uff0e\n\nLet \\(S\\) be a sandwiched set given by \\(\\left\\{a_{i}\\right\\}_{i=0}^{\\infty},\\left\\{b_{i}\\right\\}_{i=0}^{\\infty}\\) \uff0cso the smallest element in \\(S\\) is \\(x=a_{0}+1\\) \uff0eNote that \\(y=a_{1}+1\\) is also in \\(S\\) and \\(x<y\\) \uff0eThen consider the Fibonacci\uff0d type sequence given by \\(f_{0}=x, f_{1}=y\\) \uff0cand \\(f_{k+2}=f_{k+1}+f_{k}\\) \uff0eWe can then see that \\(f_{i} \\in\\left[a_{i}+1, b_{i}-1\\right]\\) \uff0cas the sum of numbers in the intervals \\(\\left[a_{k}+1, b_{k}-1\\right],\\left[a_{k+1}+1, b_{k+1}-1\\right]\\) lies in the interval\n\\[\n\\left[a_{k}+a_{k+1}+2, b_{k}+b_{k+1}-2\\right]=\\left[a_{k+2}+2, b_{k+2}-2\\right] \\subset\\left[a_{k+2}+1, b_{k+2}-1\\right] .\n\\]\n\nTherefore\uff0cthis gives a natural partition of \\(S\\) into this sequence and two sets\uff1a\n\\[\n\\begin{aligned}\nS_{1} & =\\bigcup_{i=0}^{\\infty}\\left[a_{i}+1, f_{i}-1\\right] \\\\\n\\text { and } S_{2} & =\\bigcup_{i=0}^{\\infty}\\left[f_{i}+1, b_{i}-1\\right] .\n\\end{aligned}\n\\]\n\uff08For convenience\uff0c\\([x, x-1]\\) will be treated as the empty set\uff0e\uff09\nWe now show that \\(S_{1}\\) and \\(S_{2}\\) are sandwiched\uff0eSince \\(\\left\\{a_{i}\\right\\},\\left\\{f_{i}\\right\\}\\) \uff0cand \\(\\left\\{b_{i}\\right\\}\\) satisfy the Fibonacci recurrence\uff0cit is enough to check that the intervals have nondecreasing lengths\uff0e For \\(S_{1}\\) \uff0cthat is equivalent to \\(f_{k+1}-a_{k+1} \\geq f_{k}-a_{k}\\) for each \\(k\\) \uff0eFortunately\uff0cfor \\(k \\geq 1\\) \uff0c the difference is \\(f_{k-1}-a_{k-1} \\geq 0\\) \uff0cand for \\(k=0, f_{1}-a_{1}=1=f_{0}-a_{0}\\) \uff0eSimilarly for \\(S_{2}\\) \uff0c checking \\(b_{k+1}-f_{k+1} \\geq b_{k}-f_{k}\\) is easy for \\(k \\geq 1\\) as \\(b_{k-1}-f_{k-1} \\geq 0\\) \uff0cand\n\\[\n\\left(b_{1}-f_{1}\\right)-\\left(b_{0}-f_{0}\\right)=\\left(b_{1}-a_{1}\\right)-\\left(b_{0}-a_{0}\\right),\n\\]\nwhich is nonnegative since the lengths of intervals in \\(S\\) are nondecreasing\uff0e\nTherefore we have shown that \\(S_{1}\\) and \\(S_{2}\\) are sandwiched\uff0e\uff08Note that some of the \\(\\left[a_{i}+1, f_{i}-1\\right]\\) may be empty\uff0cwhich would shift some indices back\uff0e\uff09Since this gives us a procedure to take a set \\(S\\) and produce a Fibonacci\uff0dtype sequence with its smallest element\uff0calong which two other sandwiched types\uff0cwe can partition \\(\\mathbb{N}\\) into an infinite number of Fibonacci\uff0dtype sequences\uff0e\n\nIT Third solution\uff0eWe add Fibonacci\uff0dtype sequences one\uff0dby\uff0done\uff0eAt each step\uff0clet \\(x\\) be the smallest number that has not been used in any previous sequence\uff0eWe generate a new Fibonacci\uff0dtype sequence as follows\uff0eSet \\(a_{0}=x\\) and for \\(i \\geq 1\\) \uff0cset\n\\[\na_{i}=\\left\\lfloor\\varphi a_{i-1}+\\frac{1}{2}\\right\\rfloor .\n\\]\n\nEquivalently\uff0c\\(a_{i}\\) is the closest integer to \\(\\varphi a_{i-1}\\) \uff0e\nIt suffices to show that this sequence is Fibonacci\uff0dtype and that no two sequences generated in this way overlap\uff0eWe first show that for a positive integer \\(n\\) \uff0c\n\\[\n\\left\\lfloor\\varphi\\left\\lfloor\\varphi n+\\frac{1}{2}\\right\\rfloor+\\frac{1}{2}\\right\\rfloor=n+\\left\\lfloor\\varphi n+\\frac{1}{2}\\right\\rfloor .\n\\]\n\nIndeed\uff0c\n\\[\n\\begin{aligned}\n\\left\\lfloor\\varphi\\left\\lfloor\\varphi n+\\frac{1}{2}\\right\\rfloor+\\frac{1}{2}\\right\\rfloor & =\\left\\lfloor\\left(1+\\varphi^{-1}\\right)\\left\\lfloor\\varphi n+\\frac{1}{2}\\right\\rfloor+\\frac{1}{2}\\right\\rfloor \\\\\n& =\\left\\lfloor\\varphi n+\\frac{1}{2}\\right\\rfloor+\\left\\lfloor\\varphi^{-1}\\left\\lfloor\\varphi n+\\frac{1}{2}\\right\\rfloor+\\frac{1}{2}\\right\\rfloor\n\\end{aligned}\n\\]\n\nNote that \\(\\left\\lfloor\\varphi n+\\frac{1}{2}\\right\\rfloor=\\varphi n+c\\) for some \\(|c| \\leq \\frac{1}{2}\\) \uff1bthis implies that \\(\\varphi^{-1}\\left\\lfloor\\varphi n+\\frac{1}{2}\\right\\rfloor\\) is within \\(\\varphi^{-1} \\cdot \\frac{1}{2}<\\frac{1}{2}\\) of \\(n\\) \uff0cso its closest integer is \\(n\\) \uff0cproving the claim\uff0e\n\nTherefore these sequences are Fibonacci\uff0dtype\uff0eAdditionally\uff0cif \\(a \\neq b\\) \uff0cthen \\(|\\varphi a-\\varphi b| \\geq \\varphi>1\\) \uff0eThen\n\\[\na \\neq b \\Longrightarrow\\left\\lfloor\\varphi a+\\frac{1}{2}\\right\\rfloor \\neq\\left\\lfloor\\varphi b+\\frac{1}{2}\\right\\rfloor,\n\\]\nand since the first term of each sequence is chosen to not overlap with any previous sequences\uff0cthese sequences are disjoint\uff0e\n\nRemark\uff0eAnkan Bhattacharya points out that the same sequence essentially appears in IMO 1993\uff0cProblem 5 \uff0din other words\uff0ca strictly increasing function \\(f: \\mathbb{Z}_{>0} \\rightarrow \\mathbb{Z}_{>0}\\) with \\(f(1)=2\\) \uff0cand \\(f(f(n))=f(n)+n\\) \uff0e\n\nNikolai Beluhov sent us an older reference from March 1977\uff0cwhere Martin Gardner wrote in his column about Wythoff\uff07s Nim\uff0eThe relevant excerpt goes\uff1a\n\uff02Imagine that we go through the infinite sequence of safe pairs\uff08in the manner of Eratosthenes\uff07sieve for sifting out primes\uff09and cross out the infinite set of all safe pairs that are pairs in the Fibonacci sequence\uff0eThe smallest pair that is not crossed out is \\(4 / 7\\) \uff0eWe can now cross out a second infinite set of safe pairs\uff0c starting with \\(4 / 7\\) \uff0cthat are pairs in the Lucas sequence\uff0eAn infinite number of safe pairs\uff0cof which the lowest is now \\(6 / 10\\) \uff0cremain\uff0eThis pair too begins another infinite Fibonacci sequence\uff0call of whose pairs are safe\uff0eThe process continues forever\uff0eRobert Silber\uff0ca mathematician at North Carolina State University\uff0ccalls a safe pair\uff02primitive\uff02if it is the first safe pair that generates a Fibonacci sequence\uff0e\uff02\n\nThe relevant article by Robert Silber is A Fibonacci Property of Wythoff Pairs\uff0cfrom The Fibonacci Quarterly 11\uff0f1976\uff0e\n\nFourth solution\uff08Mark Sellke\uff09\uff0eFor later reference let\n\\[\nf_{1}=0, f_{2}=1, f_{3}=1, \\ldots\n\\]\ndenote the ordinary Fibonacci numbers\uff0eWe will denote the Fibonacci\uff0dlike sequences by \\(F^{i}\\) and the elements with subscripts\uff1bhence \\(F_{1}^{2}\\) is the first element of the second sequence\uff0e Our construction amounts to just iteratively add new sequences\uff1bhence the following claim is the whole problem\uff0e\n\n\\section*{Lemma}\n\nFor any disjoint collection of Fibonacci\uff0dlike sequences \\(F^{1}, \\ldots, F^{k}\\) and any integer \\(m\\) contained in none of them\uff0cthere is a new Fibonacci\uff0dlike sequence \\(F^{k+1}\\) beginning with \\(F_{1}^{k+1}=m\\) which is disjoint from the previous sequences\uff0e\n\nObserve first that for each sequence \\(F^{j}\\) there is \\(c^{j} \\in \\mathbb{R}^{n}\\) such that\n\\[\nF_{n}^{j}=c^{j} \\phi^{n}+o(1)\n\\]\nwhere\n\\[\n\\phi=\\frac{1+\\sqrt{5}}{2} .\n\\]\n\nCollapse the group\uff08 \\(\\mathbb{R}^{+}, \\times\\)\uff09into the half\uff0dopen interval \\(J=\\{x \\mid 1 \\leq x<\\phi\\}\\) by defining \\(T(x)=y\\) for the unique \\(y \\in J\\) with \\(x=y \\phi^{n}\\) for some integer \\(n\\) \uff0e\n\nFix an interval \\(I=[a, b] \\subseteq[1.2,1.3]\\)\uff08the last condition is to avoid wrap\uff0daround issues\uff09 which contains none of the \\(c^{j}\\) \uff0cand take \\(\\varepsilon<0.001\\) to be small enough that in fact each \\(c^{j}\\) has distance at least \\(10 \\varepsilon\\) from \\(I\\) \uff1bthis means any \\(c_{j}\\) and element of \\(I\\) differ by at least a \\((1+10 \\varepsilon)\\) factor\uff0eThe idea will be to take \\(F_{1}^{k+1}=m\\) and \\(F_{2}^{k+1}\\) to be a large such that the induced values of \\(F_{j}^{k+1}\\) grow like \\(k \\phi^{j}\\) for \\(j \\in T^{-1}(I)\\) \uff0cso that \\(F_{n}^{k+1}\\) is separated from the \\(c^{j}\\) after applying \\(T\\) \uff0eWhat\uff07s left to check is the convergence\uff0e\n\nNow let\n\\[\nc=\\lim _{n \\rightarrow \\infty} \\frac{f_{n}}{\\phi^{n}}\n\\]\nand take \\(M\\) large enough that for \\(n>M\\) we have\n\\[\n\\left|\\frac{f_{n}}{c \\phi^{n}}-1\\right|<\\varepsilon .\n\\]\n\nNow \\(\\frac{T^{-1}(I)}{c}\\) contains arbitrarily large integers\uff0cso there are infinitely many \\(N\\) with \\(c N \\in T^{-1}(I)\\) with \\(N>\\frac{10 m}{\\varepsilon}\\) \uff0eWe claim that for any such \\(N\\) \uff0cthe sequence \\(F^{(N)}\\) defined by\n\\[\nF_{1}^{(N)}=m, F_{2}^{(N)}=N\n\\]\nwill be very multiplicatively similar to the normal Fibonacci numbers up to rescaling\uff1b indeed for \\(j=2, j=3\\) we have \\(\\frac{F_{2}^{(N)}}{f_{2}}=N, \\frac{F_{3}^{(N)}}{f_{3}}=N+m\\) and so by induction we will have\n\\[\n\\frac{F_{j}^{(N)}}{f_{j}} \\in[N, N+m] \\subseteq[N, N(1+\\varepsilon)]\n\\]\nfor \\(j \\geq 2\\) \uff0eTherefore\uff0cup to small multiplicative errors\uff0cwe have\n\\[\nF_{j}^{(N)} \\approx N f_{j} \\approx c N \\phi^{j}\n\\]\n\nFrom this we see that for \\(j>M\\) we have\n\\[\nT\\left(F_{j}^{(N)}\\right) \\in T(c N) \\cdot[1-2 \\varepsilon, 1+2 \\varepsilon] .\n\\]\n\nIn particular\uff0csince \\(T(c N) \\in I\\) and \\(I\\) is separated from each \\(c_{j}\\) by a factor of\uff08 \\(1+10 \\varepsilon\\) \uff09\uff0c we get that \\(F_{j}^{(N)}\\) is not in any of \\(F^{1}, F^{2}, \\ldots, F^{k}\\) \uff0e\n\nFinishing is easy\uff0csince we now have a uniform estimate on how many terms we need to check for a new element before the exponential growth takes over\uff0eWe will just use pigeonhole to argue that there are few possible collisions among those early terms\uff0cso we can easily pick a value of \\(N\\) which avoids them all\uff0eWe write it out below\uff0e\n\nFor large \\(L\\) \uff0cthe set\n\\[\nS_{L}=\\left(I \\cdot \\phi^{L}\\right) \\cap \\mathbb{Z}\n\\]\ncontains at least \\(k_{I} \\phi^{L}\\) elements\uff0eAs \\(N\\) ranges over \\(S_{L}\\) \uff0cfor each fixed \\(j\\) \uff0cthe value of \\(F_{j}^{(N)}\\) varies by at most a factor of 1.1 because we imposed \\(I \\subseteq[1.2,1.3]\\) and so this is true for the first two terms\uff0chence for all subsequent terms by induction\uff0eNow suppose \\(L\\) is very large\uff0cand consider a fixed pair \\((i, j)\\) with \\(i \\leq k\\) and \\(j \\leq M\\) \uff0eWe claim there is at most 1 possible value \\(k\\) such that the term \\(F_{k}^{i}\\) could equal \\(F_{j}^{(N)}\\) for some \\(N \\in S_{L}\\) \uff1bindeed\uff0cthe terms of \\(F^{i}\\) are growing at exponential rate with factor \\(\\phi>1.1\\) \uff0cso at most one will be in a given interval of multiplicative width at most 1\uff0e1\uff0e\n\nHence\uff0cof these \\(k_{I} \\phi^{L}\\) values of \\(N\\) \uff0cat most \\(k M\\) could cause problems\uff0cone for each pair \uff08 \\(i, j\\) \uff09\uff0eHowever by monotonicity of \\(F_{j}^{(N)}\\) in \\(N\\) \uff0cat most 1 value of \\(N\\) causes a collision for each pair \\((i, j)\\) \uff0eHence for large \\(L\\) so that \\(k_{I} \\phi^{L}>10 k M\\) we can find a suitable \\(N \\in S_{L}\\) by pigeonhole and the sequence \\(F^{(N)}\\) defined by\uff08 \\(m, N, N+m, \\ldots\\) \uff09works\uff0e", "source_pdf": "TSTST_2017.pdf", "notes": ""}
{"id": "TSTST-2019-1", "contest": "TSTST", "year": "2019", "problem_number": "1", "problem": "Find all binary operations \\(\\diamond: \\mathbb{R}_{>0} \\times \\mathbb{R}_{>0} \\rightarrow \\mathbb{R}_{>0}\\) (meaning \\(\\diamond\\) takes pairs of positive real numbers to positive real numbers) such that for any real numbers \\(a, b, c>0\\),\n- the equation \\(a \\diamond(b \\diamond c)=(a \\diamond b) \\cdot c\\) holds; and\n- if \\(a \\geq 1\\) then \\(a \\diamond a \\geq 1\\).", "solution": "The answer is only multiplication and division, which both obviously work.\nWe present two approaches, one appealing to theorems on Cauchy's functional equation, and one which avoids it.\n\nFirst solution using Cauchy FE. We prove:\n\nClaim - We have \\(a \\diamond b=a f(b)\\) where \\(f\\) is some involutive and totally multiplicative function. (In fact, this classifies all functions satisfying the first condition completely.)\n\nProof. Let \\(P(a, b, c)\\) denote the assertion \\(a \\diamond(b \\diamond c)=(a \\diamond b) \\cdot c\\).\n- Note that for any \\(x\\), the function \\(y \\mapsto x \\diamond y\\) is injective, because if \\(x \\diamond y_{1}=x \\diamond y_{2}\\) then take \\(P\\left(1, x, y_{i}\\right)\\) to get \\(y_{1}=y_{2}\\).\n- Take \\(P(1, x, 1)\\) and injectivity to get \\(x \\diamond 1=x\\).\n- Take \\(P(1,1, y)\\) to get \\(1 \\diamond(1 \\diamond y)=y\\).\n- Take \\(P(x, 1,1 \\diamond y)\\) to get\n\\[\nx \\diamond y=x \\cdot(1 \\diamond y) .\n\\]\n\nHenceforth let us define \\(f(y)=1 \\diamond y\\), so \\(f(1)=1, f\\) is involutive and\n\\[\nx \\diamond y=x f(y) .\n\\]\n\nPlugging this into the original condition now gives \\(f(b f(c))=f(b) c\\), which (since \\(f\\) is an involution) gives \\(f\\) completely multiplicative.\n\nIn particular, \\(f(1)=1\\). We are now interested only in the second condition, which reads \\(f(x) \\geq 1 / x\\) for \\(x \\geq 1\\).\n\nDefine the function\n\\[\ng(t)=\\log f\\left(e^{t}\\right)\n\\]\nso that \\(g\\) is additive, and also \\(g(t) \\geq-t\\) for all \\(t \\geq 0\\). We appeal to the following theorem:\n\nLemma\n\nIf \\(h: \\mathbb{R} \\rightarrow \\mathbb{R}\\) is an additive function which is not linear, then it is dense in the plane: for any point \\(\\left(x_{0}, y_{0}\\right)\\) and \\(\\varepsilon>0\\) there exists \\((x, y)\\) such that \\(h(x)=y\\) and \\(\\sqrt{\\left(x-x_{0}\\right)^{2}+\\left(y-y_{0}\\right)^{2}}<\\varepsilon\\).\n\nApplying this lemma with the fact that \\(g(t) \\geq-t\\) implies readily that \\(g\\) is linear. In other words, \\(f\\) is of the form \\(f(x)=x^{r}\\) for some fixed real number \\(r\\). It is easy to check \\(r= \\pm 1\\) which finishes.\n\nII Second solution manually. As before we arrive at \\(a \\diamond b=a f(b)\\), with \\(f\\) an involutive and totally multiplicative function.\n\nWe prove that:\nClaim - For any \\(a>0\\), we have \\(f(a) \\in\\{1 / a, a\\}\\).\n\nProof. WLOG \\(b>1\\), and suppose \\(f(b)=a \\geq 1 / b\\) hence \\(f(a)=b\\).\nAssume that \\(a b>1\\); we show \\(a=b\\). Note that for integers \\(m\\) and \\(n\\) with \\(a^{n} b^{m} \\geq 1\\), we must have\n\\[\na^{m} b^{n}=f(b)^{m} f(a)^{n}=f\\left(a^{n} b^{m}\\right) \\geq \\frac{1}{a^{n} b^{m}} \\Longrightarrow(a b)^{m+n} \\geq 1\n\\]\nand thus we have arrived at the proposition\n\\[\nm+n<0 \\Longrightarrow n \\log _{b} a+m<0\n\\]\nfor all integers \\(m\\) and \\(n\\). Due to the density of \\(\\mathbb{Q}\\) in the real numbers, this can only happen if \\(\\log _{b} a=1\\) or \\(a=b\\).\n\nClaim - The function \\(f\\) is continuous.\n\nProof. Indeed, it's equivalent to show \\(g(t)=\\log f\\left(e^{t}\\right)\\) is continuous, and we have that\n\\[\n|g(t)-g(s)|=\\left|\\log f\\left(e^{t-s}\\right)\\right|=|t-s|\n\\]\nsince \\(f\\left(e^{t-s}\\right)=e^{ \\pm|t-s|}\\). Therefore \\(g\\) is Lipschitz. Hence \\(g\\) continuous, and \\(f\\) is too.\nFinally, we have from \\(f\\) multiplicative that\n\\[\nf\\left(2^{q}\\right)=f(2)^{q}\n\\]\nfor every rational number \\(q\\), say. As \\(f\\) is continuous this implies \\(f(x) \\equiv x\\) or \\(f(x) \\equiv 1 / x\\) identically (depending on whether \\(f(2)=2\\) or \\(f(2)=1 / 2\\), respectively).\n\nTherefore, \\(a \\diamond b=a b\\) or \\(a \\diamond b=a \\div b\\), as needed.\nRemark. The Lipschitz condition is one of several other ways to proceed. The point is that if \\(f(2)=2\\) (say), and \\(x / 2^{q}\\) is close to 1 , then \\(f(x) / 2^{q}=f\\left(x / 2^{q}\\right)\\) is close to 1 , which is enough to force \\(f(x)=x\\) rather than \\(f(x)=1 / x\\).\n\nRemark. Compare to AMC 10A 2016 \\#23, where the second condition is \\(a \\diamond a=1\\).", "source_pdf": "TSTST_2019.pdf", "notes": ""}
{"id": "TSTST-2019-2", "contest": "TSTST", "year": "2019", "problem_number": "2", "problem": "Let \\(A B C\\) be an acute triangle with circumcircle \\(\\Omega\\) and orthocenter \\(H\\). Points \\(D\\) and \\(E\\) lie on segments \\(A B\\) and \\(A C\\) respectively, such that \\(A D=A E\\). The lines through \\(B\\) and \\(C\\) parallel to \\(\\overline{D E}\\) intersect \\(\\Omega\\) again at \\(P\\) and \\(Q\\), respectively. Denote by \\(\\omega\\) the circumcircle of \\(\\triangle A D E\\).\n(a) Show that lines \\(P E\\) and \\(Q D\\) meet on \\(\\omega\\).\n(b) Prove that if \\(\\omega\\) passes through \\(H\\), then lines \\(P D\\) and \\(Q E\\) meet on \\(\\omega\\) as well.", "solution": "We will give one solution to (a), then several solutions to (b).\n\nSolution to (a). Note that \\(\\measuredangle A Q P=\\measuredangle A B P=\\measuredangle A D E\\) and \\(\\measuredangle A P Q=\\measuredangle A C Q= \\measuredangle A E D\\), so we have a spiral similarity \\(\\triangle A D E \\sim \\triangle A Q P\\). Therefore, lines \\(P E\\) and \\(Q D\\) meet at the second intersection of \\(\\omega\\) and \\(\\Omega\\) other than \\(A\\). Call this point \\(X\\).\n\nIT Solution to (b) using angle chasing. Let \\(L\\) be the reflection of \\(H\\) across \\(\\overline{A B}\\), which lies on \\(\\Omega\\).\n\nClaim - Points \\(L, D, P\\) are collinear.\n\nProof. This is just angle chasing:\n\\[\n\\begin{aligned}\n\\measuredangle C L D & =\\measuredangle D H L=\\measuredangle D H A+\\measuredangle A H L=\\measuredangle D E A+\\measuredangle A H C \\\\\n& =\\measuredangle A D E+\\measuredangle C B A=\\measuredangle A B P+\\measuredangle C B A=\\measuredangle C B P=\\measuredangle C L P .\n\\end{aligned}\n\\]\n\nNow let \\(K \\in \\omega\\) such that \\(D H K E\\) is an isosceles trapezoid, i.e. \\(\\measuredangle B A H=\\measuredangle K A E\\).\n\nClaim - Points \\(D, K, P\\) are collinear.\n\nProof. Using the previous claim,\n\\[\n\\measuredangle K D E=\\measuredangle K A E=\\measuredangle B A H=\\measuredangle L A B=\\measuredangle L P B=\\measuredangle D P B=\\measuredangle P D E .\n\\]\n\nBy symmetry, \\(\\overline{Q E}\\) will then pass through the same \\(K\\), as needed.\nRemark. These two claims imply each other, so guessing one of them allows one to realize the other. It is likely the latter is easiest to guess from the diagram, since it does not need any additional points.\n\nSolution to (b) by orthogonal circles (found by contestants). We define \\(K\\) as in the previous solution, but do not claim that \\(K\\) is the desired intersection. Instead, we note that:\n\nClaim - Point \\(K\\) is the orthocenter of isosceles triangle \\(A P Q\\).\n\nProof. Notice that \\(A H=A K\\) and \\(B C=P Q\\). Moreover from \\(\\overline{A H} \\perp \\overline{B C}\\) we deduce \\(\\overline{A K} \\perp \\overline{P Q}\\) by reflection across the angle bisector.\n\nIn light of the formula \" \\(A H^{2}=4 R^{2}-a^{2}\\) \", this implies the conclusion.\nLet \\(M\\) be the midpoint of \\(\\overline{P Q}\\). Since \\(\\triangle A P Q\\) is isosceles,\n\\[\n\\overline{A K M} \\perp \\overline{P Q} \\Longrightarrow M K \\cdot M A=M P^{2}\n\\]\nby orthocenter properties.\nSo to summarize\n- The circle with diameter \\(\\overline{P Q}\\) is orthogonal to \\(\\omega\\). In other words, point \\(P\\) lies on the polar of \\(Q\\) with respect to \\(\\omega\\).\n- The point \\(X=\\overline{Q D} \\cap \\overline{P E}\\) is on \\(\\omega\\).\n\nOn the other hand, if we let \\(K^{\\prime}=\\overline{Q E} \\cap \\omega\\), then by Brocard theorem on \\(X D K^{\\prime} E\\), the polar of \\(Q=\\overline{X D} \\cap \\overline{K^{\\prime} E}\\) pass through \\(\\overline{D K^{\\prime}} \\cap \\overline{X E}\\); this point must therefore be \\(P\\) and \\(K^{\\prime}=K\\) as desired.\n\nIT Solution to (b) by complex numbers (Yang Liu and Michael Ma). Let \\(M\\) be the arc midpoint of \\(\\widehat{B C}\\). We use the standard arc midpoint configuration. We have that\n\\[\nA=a^{2}, B=b^{2}, C=c^{2}, M=-b c, H=a^{2}+b^{2}+c^{2}, P=\\frac{a^{2} c}{b}, Q=\\frac{a^{2} b}{c},\n\\]\nwhere \\(M\\) is the arc midpoint of \\(\\widehat{B C}\\). By direct angle chasing we can verify that \\(\\overline{M B} \\| \\overline{D H}\\). Also, \\(D \\in \\overline{A B}\\). Therefore, we can compute \\(D\\) as follows.\n\\[\nd+a^{2} b^{2} \\bar{d}=a^{2}+b^{2} \\text { and } \\frac{d-h}{\\bar{d}-\\bar{h}}=-m b^{2}=b^{3} c \\Longrightarrow d=\\frac{a^{2}\\left(a^{2} c+b^{2} c+c^{3}-b^{3}\\right)}{c\\left(b c+a^{2}\\right)}\n\\]\n\nBy symmetry, we have that\n\\[\ne=\\frac{a^{2}\\left(a^{2} b+b c^{2}+b^{3}-c^{3}\\right)}{b\\left(b c+a^{2}\\right)}\n\\]\n\nTo finish, we want to show that the angle between \\(\\overline{D P}\\) and \\(\\overline{E Q}\\) is angle \\(A\\). To show this, we compute \\(\\frac{d-p}{e-q} / \\overline{\\frac{d-p}{e-q}}\\). First, we compute\n\\[\n\\begin{aligned}\nd-p & =\\frac{a^{2}\\left(a^{2} c+b^{2} c+c^{3}-b^{3}\\right)}{c\\left(b c+a^{2}\\right)}-\\frac{a^{2} c}{b} \\\\\n& =a^{2}\\left(\\frac{a^{2} c+b^{2} c+c^{3}-b^{3}}{c\\left(b c+a^{2}\\right)}-\\frac{c}{b}\\right)=\\frac{a^{2}\\left(a^{2} c-b^{3}\\right)(b-c)}{b c\\left(b c+a^{2}\\right)} .\n\\end{aligned}\n\\]\n\nBy symmetry,\n\\[\n\\frac{d-p}{e-q}=-\\frac{a^{2} c-b^{3}}{a^{2} b-c^{3}} \\Longrightarrow \\frac{d-p}{e-q} / \\overline{\\frac{d-p}{e-q}}=\\frac{a^{2} b^{3} c}{a^{2} b c^{3}}=\\frac{b^{2}}{c^{2}}\n\\]\nas desired.\n\nIT Solution to (b) using untethered moving points (Zack Chroman). We work in the real projective plane \\(\\mathbb{R P}^{2}\\), and animate \\(C\\) linearly on a fixed line through \\(A\\).\n\nRecall:\n\nLemma (Zack's lemma)\nSuppose points \\(A, B\\) have degree \\(d_{1}, d_{2}\\), and there are \\(k\\) values of \\(t\\) for which \\(A=B\\). Then line \\(A B\\) has degree at most \\(d_{1}+d_{2}-k\\). Similarly, if lines \\(\\ell_{1}, \\ell_{2}\\) have degrees \\(d_{1}, d_{2}\\), and there are \\(k\\) values of \\(t\\) for which \\(\\ell_{1}=\\ell_{2}\\), then the intersection \\(\\ell_{1} \\cap \\ell_{2}\\) has degree at most \\(d_{1}+d_{2}-k\\).\n\nNow, note that \\(H\\) moves linearly in \\(C\\) on line \\(B H\\). Furthermore, angles \\(\\angle A H E\\), \\(\\angle A H F\\) are fixed, we get that \\(D\\) and \\(E\\) have degree 2 . One way to see this is using the lemma; \\(D\\) lies on line \\(A B\\), which is fixed, and line \\(H D\\) passes through a point at infinity which is a constant rotation of the point at infinity on line \\(A H\\), and therefore has degree 1. Then \\(D, E\\) have degree at most \\(1+1-0=2\\).\n\nNow, note that \\(P, Q\\) move linearly in \\(C\\). Both of these are because the circumcenter \\(O\\) moves linearly in \\(C\\), and \\(P, Q\\) are reflections of \\(B, C\\) in a line through \\(O\\) with fixed direction, which also moves linearly.\n\nSo by the lemma, the lines \\(P D, Q E\\) have degree at most 3 . I claim they actually have degree 2; to show this it suffices to give an example of a choice of \\(C\\) for which \\(P=D\\) and one for which \\(Q=E\\). But an easy angle chase shows that in the unique case when \\(P=B\\), we get \\(D=B\\) as well and thus \\(P=D\\). Similarly when \\(Q=C, E=C\\). It follows from the lemma that lines \\(P D, Q E\\) have degree at most 2 .\n\nLet \\(\\ell_{\\infty}\\) denote the line at infinity. I claim that the points \\(P_{1}=P D \\cap \\ell_{\\infty}, P_{2}=Q E \\cap \\ell_{\\infty}\\) are projective in \\(C\\). Since \\(\\ell_{\\infty}\\) is fixed, it suffices to show by the lemma that there exists some value of \\(C\\) for which \\(Q E=\\ell_{\\infty}\\) and \\(P D=\\ell_{\\infty}\\). But note that as \\(C \\rightarrow \\infty\\), all four points \\(P, D, Q, E\\) go to infinity. It follows that \\(P_{1}, P_{2}\\) are projective in \\(C\\).\n\nThen to finish, recall that we want to show that \\(\\angle(P D, Q E)\\) is constant. It suffices then to show that there's a constant rotation sending \\(P_{1}\\) to \\(P_{2}\\). Since \\(P_{1}, P_{2}\\) are projective, it suffices to verify this for 3 values of \\(C\\).\n\nWe can take \\(C\\) such that \\(\\angle A B C=90, \\angle A C B=90\\), or \\(A B=A C\\), and all three cases are easy to check.", "source_pdf": "TSTST_2019.pdf", "notes": ""}
{"id": "TSTST-2019-3", "contest": "TSTST", "year": "2019", "problem_number": "3", "problem": "On an infinite square grid we place finitely many cars, which each occupy a single cell and face in one of the four cardinal directions. Cars may never occupy the same cell. It is given that the cell immediately in front of each car is empty, and moreover no two cars face towards each other (no right-facing car is to the left of a left-facing car within a row, etc.). In a move, one chooses a car and shifts it one cell forward to a vacant cell. Prove that there exists an infinite sequence of valid moves using each car infinitely many times.", "solution": "Let \\(S\\) be any rectangle containing all the cars. Partition \\(S\\) into horizontal strips of height 1 , and color them red and green in an alternating fashion. It is enough to prove all the cars may exit \\(S\\).\n\nTo do so, we outline a five-stage plan for the cars.\n1. All vertical cars in a green cell may advance one cell into a red cell (or exit \\(S\\) altogether), by the given condition. (This is the only place where the hypothesis about empty space is used!)\n2. All horizontal cars on green cells may exit \\(S\\), as no vertical cars occupy green cells.\n3. All vertical cars in a red cell may advance one cell into a green cell (or exit \\(S\\) altogether), as all green cells are empty.\n4. All horizontal cars within red cells may exit \\(S\\), as no vertical car occupy red cells.\n5. The remaining cars exit \\(S\\), as they are all vertical. The solution is complete.\n\nRemark (Author's comments). The solution I've given for this problem is so short and simple that it might appear at first to be about IMO 1 difficulty. I don't believe that's true! There are very many approaches that look perfectly plausible at first, and then fall apart in this or that twisted special case.\n\nRemark (Higher-dimensional generalization by author). The natural higher-dimensional generalization is true, and can be proved in largely the same fashion. For example, in three dimensions, one may let \\(S\\) be a rectangular prism and partition \\(S\\) into horizontal slabs and color them red and green in an alternating fashion. Stages 1, 3, and 5 generalize immediately, and stages 2 and 4 reduce to an application of the two-dimensional problem. In the same way, the general problem is handled by induction on the dimension.\n\nRemark (Historical comments). For \\(k>1\\), we could consider a variant of the problem where cars are \\(1 \\times k\\) rectangles (moving parallel to the longer edge) instead of occupying single cells. In that case, if there are \\(2 k-1\\) empty spaces in front of each car, the above proof works (with the red and green strips having height \\(k\\) instead). On the other hand, at least \\(k\\) empty spaces are necessary. We don't know the best constant in this case.", "source_pdf": "TSTST_2019.pdf", "notes": ""}
{"id": "TSTST-2019-4", "contest": "TSTST", "year": "2019", "problem_number": "4", "problem": "Consider coins with positive real denominations not exceeding 1. Find the smallest \\(C>0\\) such that the following holds: if we are given any 100 such coins with total value 50 , then we can always split them into two stacks of 50 coins each such that the absolute difference between the total values of the two stacks is at most \\(C\\).", "solution": "The answer is \\(C=\\frac{50}{51}\\). The lower bound is obtained if we have 51 coins of value \\(\\frac{1}{51}\\) and 49 coins of value 1 . (Alternatively, 51 coins of value \\(1-\\frac{\\varepsilon}{51}\\) and 49 coins of value \\(\\frac{\\varepsilon}{49}\\) works fine for \\(\\varepsilon>0\\).) We now present two (similar) proofs that this \\(C=\\frac{50}{51}\\) suffices.\n\\(\\llbracket\\) First proof (original). Let \\(a_{1} \\leq \\cdots \\leq a_{100}\\) denote the values of the coins in ascending order. Since the 51 coins \\(a_{50}, \\ldots, a_{100}\\) are worth at least \\(51 a_{50}\\), it follows that \\(a_{50} \\leq \\frac{50}{51}\\); likewise \\(a_{51} \\geq \\frac{1}{51}\\).\n\nWe claim that choosing the stacks with coin values\n\\[\na_{1}, a_{3}, \\ldots, a_{49}, \\quad a_{52}, a_{54}, \\ldots, a_{100}\n\\]\nand\n\\[\na_{2}, a_{4}, \\ldots, a_{50}, \\quad a_{51}, a_{53}, \\ldots, a_{99}\n\\]\nworks. Let \\(D\\) denote the (possibly negative) difference between the two total values. Then\n\\[\n\\begin{aligned}\nD & =\\left(a_{1}-a_{2}\\right)+\\cdots+\\left(a_{49}-a_{50}\\right)-a_{51}+\\left(a_{52}-a_{53}\\right)+\\cdots+\\left(a_{98}-a_{99}\\right)+a_{100} \\\\\n& \\leq 25 \\cdot 0-\\frac{1}{51}+24 \\cdot 0+1=\\frac{50}{51} .\n\\end{aligned}\n\\]\n\nSimilarly, we have\n\\[\n\\begin{aligned}\nD & =a_{1}+\\left(a_{3}-a_{2}\\right)+\\cdots+\\left(a_{49}-a_{48}\\right)-a_{50}+\\left(a_{52}-a_{51}\\right)+\\cdots+\\left(a_{100}-a_{99}\\right) \\\\\n& \\geq 0+24 \\cdot 0-\\frac{50}{51}+25 \\cdot 0=-\\frac{50}{51} .\n\\end{aligned}\n\\]\n\nIt follows that \\(|D| \\leq \\frac{50}{51}\\), as required.\n\nIT Second proof (Evan Chen). Again we sort the coins in increasing order \\(0<a_{1} \\leq a_{2} \\leq \\cdots \\leq a_{100} \\leq 1\\). A large gap is an index \\(i \\geq 2\\) such that \\(a_{i}>a_{i-1}+\\frac{50}{51}\\); obviously there is at most one such large gap.\n\nClaim - If there is a large gap, it must be \\(a_{51}>a_{50}+\\frac{50}{51}\\).\n\nProof. If \\(i<50\\) then we get \\(a_{50}, \\ldots, a_{100}>\\frac{50}{51}\\) and the sum \\(\\sum_{1}^{100} a_{i}>50\\) is too large. Conversely if \\(i>50\\) then we get \\(a_{1}, \\ldots, a_{i-1}<\\frac{1}{51}\\) and the sum \\(\\sum_{1}^{100} a_{i}<1 / 51 \\cdot 51+49\\) is too small.\n\nNow imagine starting with the coins \\(a_{1}, a_{3}, \\ldots, a_{99}\\), which have total value \\(S \\leq 25\\). We replace \\(a_{1}\\) by \\(a_{2}\\), then \\(a_{3}\\) by \\(a_{4}\\), and so on, until we replace \\(a_{99}\\) by \\(a_{100}\\). At the end of the process we have \\(S \\geq 25\\). Moreover, since we did not cross a large gap at any point, the quantity \\(S\\) changed by at most \\(C=\\frac{50}{51}\\) at each step. So at some point in the process we need to have \\(25-C / 2 \\leq S \\leq 25+C / 2\\), which proves \\(C\\) works.", "source_pdf": "TSTST_2019.pdf", "notes": ""}
{"id": "TSTST-2019-5", "contest": "TSTST", "year": "2019", "problem_number": "5", "problem": "Let \\(A B C\\) be an acute triangle with orthocenter \\(H\\) and circumcircle \\(\\Gamma\\). A line through \\(H\\) intersects segments \\(A B\\) and \\(A C\\) at \\(E\\) and \\(F\\), respectively. Let \\(K\\) be the circumcenter of \\(\\triangle A E F\\), and suppose line \\(A K\\) intersects \\(\\Gamma\\) again at a point \\(D\\). Prove that line \\(H K\\) and the line through \\(D\\) perpendicular to \\(\\overline{B C}\\) meet on \\(\\Gamma\\).", "solution": "We present several solutions. (There are more in the official packet; some are omitted here, which explains the numbering.)\n\nFirst solution (Andrew Gu). We begin with the following two observations.\nClaim - Point \\(K\\) lies on the radical axis of \\((B E H)\\) and \\((C F H)\\).\n\nProof. Actually we claim \\(\\overline{K E}\\) and \\(\\overline{K F}\\) are tangents. Indeed,\n\\[\n\\measuredangle H E K=90^{\\circ}-\\measuredangle E A F=90^{\\circ}-\\measuredangle B A C=\\measuredangle H B E\n\\]\nimplying the result. Since \\(K E=K F\\), this implies the result.\n\nClaim - The second intersection \\(M\\) of \\((B E H)\\) and \\((C F H)\\) lies on \\(\\Gamma\\).\n\nProof. By Miquel's theorem on \\(\\triangle A E F\\) with \\(H \\in \\overline{E F}, B \\in \\overline{A E}, C \\in \\overline{A F}\\).\n\nIn particular, \\(M, H, K\\) are collinear. Let \\(X\\) be on \\(\\Gamma\\) with \\(\\overline{D X} \\perp \\overline{B C}\\); we then wish to show \\(X\\) lies on the line \\(M H K\\) we found. This is angle chasing: compute\n\\[\n\\measuredangle X M B=\\measuredangle X D B=90^{\\circ}-\\measuredangle D B C=90^{\\circ}-\\measuredangle D A C\n\\]\n\\[\n=90^{\\circ}-\\measuredangle K A F=\\measuredangle F E A=\\measuredangle H E B=\\measuredangle H M B\n\\]\nas needed.\n\nI Second solution (Ankan Bhattacharya). We let \\(D^{\\prime}\\) be the second intersection of \\(\\overline{E F}\\) with ( \\(B H C\\) ) and redefine \\(D\\) as the reflection of \\(D^{\\prime}\\) across \\(\\overline{B C}\\). We will first prove that this point \\(D\\) coincides with the point \\(D\\) given in the problem statement. The idea is that:\n\nClaim - \\(A\\) is the \\(D\\)-excenter of \\(\\triangle D E F\\).\n\nProof. We contend \\(B E D^{\\prime} D\\) is cyclic. This follows by angle chasing:\n\\[\n\\begin{aligned}\n\\measuredangle D^{\\prime} D B & =\\measuredangle B D^{\\prime} D=\\measuredangle D^{\\prime} B C+90^{\\circ}=\\measuredangle D^{\\prime} H C+90^{\\circ} \\\\\n& =\\measuredangle D^{\\prime} H C+\\measuredangle(H C, A B)=\\measuredangle\\left(D^{\\prime} H, A B\\right)=\\measuredangle D^{\\prime} E B\n\\end{aligned}\n\\]\n\nNow as \\(B D=B D^{\\prime}\\), we obtain \\(\\overline{B E A}\\) externally bisects \\(\\angle D E D^{\\prime} \\cong \\angle D E F\\). Likewise \\(\\overline{F A}\\) externally bisects \\(\\angle D F E\\), so \\(A\\) is the \\(D\\)-excenter of \\(\\triangle D E F\\).\n\nHence, by the so-called \"Fact 5 \", point \\(K\\) lies on \\(\\overline{D A}\\), so this point \\(D\\) is the one given in the problem statement.\n\nNow choose point \\(X\\) on ( \\(A B C\\) ) satisfying \\(\\overline{D X} \\perp \\overline{B C}\\).\nClaim - Point \\(K\\) lies on line \\(H X\\).\n\nProof. Clearly \\(A H D^{\\prime} X\\) is a parallelogram. By Ptolemy on \\(D E K F\\),\n\\[\n\\frac{K D}{K A}=\\frac{K D}{K E}=\\frac{D E+D F}{E F} .\n\\]\n\nOn the other hand, if we let \\(r_{D}\\) denote the \\(D\\)-exradius of \\(\\triangle D E F\\) then\n\\[\n\\frac{X D}{X D^{\\prime}}=\\frac{[D E X]+[D F X]}{[X E F]}=\\frac{[D E X]+[D F X]}{[A E F]}=\\frac{D E \\cdot r_{D}+D F \\cdot r_{D}}{E F \\cdot r_{D}}=\\frac{D E+D F}{E F} .\n\\]\n\nThus\n\\[\n[A K X]=\\frac{K A}{K D} \\cdot[D K X]=\\frac{K A}{K D} \\cdot \\frac{X D}{X D^{\\prime}} \\cdot\\left[K D^{\\prime} X\\right]=\\left[D^{\\prime} K X\\right] .\n\\]\n\nThis is sufficient to prove \\(K\\) lies on \\(\\overline{H X}\\).\nThe solution is complete: \\(X\\) is the desired concurrency point.\n\nFourth solution, complex numbers with spiral similarity (Evan Chen). First if \\(\\overline{A D} \\perp \\overline{B C}\\) there is nothing to prove, so we assume this is not the case. Let \\(W\\) be the antipode of \\(D\\). Let \\(S\\) denote the second intersection of ( \\(A E F\\) ) and ( \\(A B C\\) ). Consider the spiral similarity sending \\(\\triangle S E F\\) to \\(\\triangle S B C\\) :\n- It maps \\(H\\) to a point \\(G\\) on line \\(B C\\),\n- It maps \\(K\\) to \\(O\\).\n- It maps the \\(A\\)-antipode of \\(\\triangle A E F\\) to \\(D\\).\n- Hence (by previous two observations) it maps \\(A\\) to \\(W\\).\n- Also, the image of line \\(A D\\) is line \\(W O\\), which does not coincide with line \\(B C\\) (as \\(O\\) does not lie on line \\(B C\\) ).\n\nTherefore, \\(K\\) is the unique point on line \\(\\overline{A D}\\) for one can get a direct similarity\n\\[\n\\triangle A K H \\sim \\triangle W O G\n\\]\nfor some point \\(G\\) lying on line \\(\\overline{B C}\\).\n\nOn the other hand, let us re-define \\(K\\) as \\(\\overline{X H} \\cap \\overline{A D}\\). We will show that the corresponding \\(G\\) making ( \\(\\bigcirc\\) ) true lies on line \\(B C\\).\n\nWe apply complex numbers with \\(\\Gamma\\) the unit circle, with \\(a, b, c, d\\) taking their usual meanings, \\(H=a+b+c, X=-b c / d\\), and \\(W=-d\\). Then point \\(K\\) is supposed to satisfy\n\\[\nk+a d \\bar{k}=a+d\n\\]\n\\[\n\\begin{aligned}\n\\frac{k+\\frac{b c}{d}}{a+b+c+\\frac{b c}{d}} & =\\frac{\\bar{k}+\\frac{d}{b c}}{\\frac{1}{a}+\\frac{1}{b}+\\frac{1}{c}+\\frac{d}{b c}} \\\\\n\\Longleftrightarrow \\frac{\\frac{1}{a}+\\frac{1}{b}+\\frac{1}{c}+\\frac{d}{b c}}{a+b+c+\\frac{b c}{d}}\\left(k+\\frac{b c}{d}\\right) & =\\bar{k}+\\frac{d}{b c}\n\\end{aligned}\n\\]\n\nAdding \\(a d\\) times the last line to the first line and cancelling \\(a d \\bar{k}\\) now gives\n\\[\n\\left(a d \\cdot \\frac{\\frac{1}{a}+\\frac{1}{b}+\\frac{1}{c}+\\frac{d}{b c}}{a+b+c+\\frac{b c}{d}}+1\\right) k=a+d+\\frac{a d^{2}}{b c}-a b c \\cdot \\frac{\\frac{1}{a}+\\frac{1}{b}+\\frac{1}{c}+\\frac{d}{b c}}{a+b+c+\\frac{b c}{d}}\n\\]\nor\n\\[\n\\begin{aligned}\n\\left(a d\\left(\\frac{1}{a}+\\frac{1}{b}+\\frac{1}{c}+\\frac{d}{b c}\\right)+a+b+c+\\frac{b c}{d}\\right) k & =\\left(a+b+c+\\frac{b c}{d}\\right)\\left(a+d+\\frac{a d^{2}}{b c}\\right) \\\\\n& -a b c \\cdot\\left(\\frac{1}{a}+\\frac{1}{b}+\\frac{1}{c}+\\frac{d}{b c}\\right)\n\\end{aligned}\n\\]\n\nWe begin by simplifying the coefficient of \\(k\\) :\n\\[\n\\begin{aligned}\na d\\left(\\frac{1}{a}+\\frac{1}{b}+\\frac{1}{c}+\\frac{d}{b c}\\right)+a+b+c+\\frac{b c}{d} & =a+b+c+d+\\frac{b c}{d}+\\frac{a d}{b}+\\frac{a d}{c}+\\frac{a d^{2}}{b c} \\\\\n& =a+\\frac{b c}{d}+\\left(1+\\frac{a d}{b c}\\right)(b+c+d) \\\\\n& =\\frac{a d+b c}{b c d}[b c+d(b+c+d)] \\\\\n& =\\frac{(a d+b c)(d+b)(d+c)}{b c d}\n\\end{aligned}\n\\]\n\nMeanwhile, the right-hand side expands to\n\\[\n\\begin{aligned}\n\\mathrm{RHS}= & \\left(a+b+c+\\frac{b c}{d}\\right)\\left(a+d+\\frac{a d^{2}}{b c}\\right)-a b c \\cdot\\left(\\frac{1}{a}+\\frac{1}{b}+\\frac{1}{c}+\\frac{d}{b c}\\right) \\\\\n= & \\left(a^{2}+a b+a c+\\frac{a b c}{d}\\right)+(d a+d b+d c+b c) \\\\\n& +\\left(\\frac{a^{2} d^{2}}{b c}+\\frac{a d^{2}}{c}+\\frac{a d^{2}}{b}+a d\\right)-(a b+b c+c a+a d) \\\\\n= & a^{2}+d(a+b+c)+\\frac{a b c}{d}+\\frac{a^{2} d^{2}}{b c}+\\frac{a d^{2}}{b}+\\frac{a d^{2}}{c} \\\\\n= & a^{2}+\\frac{a b c}{d}+d(a+b+c) \\cdot \\frac{a d+b c}{b c} \\\\\n= & \\frac{a d+b c}{b c d}\\left[a b c+d^{2}(a+b+c)\\right]\n\\end{aligned}\n\\]\n\nTherefore, we get\n\\[\nk=\\frac{a b c+d^{2}(a+b+c)}{(d+b)(d+c)}\n\\]\n\nIn particular,\n\\[\n\\begin{aligned}\nk-a & =\\frac{a b c+d^{2}(a+b+c)-a(d+b)(d+c)}{(d+b)(d+c)} \\\\\n& =\\frac{d^{2}(b+c)-d a(b+c)}{(d+b)(d+c)}=\\frac{d(b+c)(d-a)}{(d+b)(d+c)}\n\\end{aligned}\n\\]\n\nNow the corresponding point \\(G\\) obeying ( \\(\\varnothing\\) ) satisfies\n\\[\n\\begin{aligned}\n\\frac{g-(-d)}{0-(-d)} & =\\frac{(a+b+c)-a}{k-a} \\\\\n\\Longrightarrow g & =-d+\\frac{d(b+c)}{k-a} \\\\\n& =-d+\\frac{(d+b)(d+c)}{d-a}=\\frac{d b+d c+b c+a d}{d-a} \\\\\n\\Longrightarrow b c \\bar{g} & =\\frac{b c \\cdot \\frac{a c+a b+a d+b c}{a b c d}}{\\frac{a-d}{a d}}=-\\frac{a b+a c+a d+b c}{d-a} \\\\\n\\Longrightarrow g+b c \\bar{g} & =\\frac{(d-a)(b+c)}{d-a}=b+c\n\\end{aligned}\n\\]\n\nHence \\(G\\) lies on \\(B C\\) and this completes the proof.\n\nI Seventh solution using moving points (Zack Chroman). We state the converse of the problem as follows:\n\nTake a point \\(D\\) on \\(\\Gamma\\), and let \\(G \\in \\Gamma\\) such that \\(\\overline{D G} \\perp \\overline{B C}\\). Then define \\(K\\) to lie on \\(\\overline{G H}, \\overline{A D}\\), and take \\(L \\in \\overline{A D}\\) such that \\(K\\) is the midpoint of \\(\\overline{A L}\\). Then if we define \\(E\\) and \\(F\\) as the projections of \\(L\\) onto \\(\\overline{A B}\\) and \\(\\overline{A C}\\) we want to show that \\(E, H, F\\) are collinear.\n\nIt's clear that solving this problem will solve the original. In fact we will show later that each line \\(E F\\) through \\(H\\) corresponds bijectively to the point \\(D\\).\n\nWe animate \\(D\\) projectively on \\(\\Gamma\\) (hence \\(\\operatorname{deg} D=2\\) ). Since \\(D \\mapsto G\\) is a projective map \\(\\Gamma \\rightarrow \\Gamma\\), it follows \\(\\operatorname{deg} G=2\\). By Zack's lemma, \\(\\operatorname{deg}(\\overline{A D}) \\leq 0+2-1=1\\) (since \\(D\\) can coincide with \\(A\\) ), and \\(\\operatorname{deg}(\\overline{H G}) \\leq 0+2-0=2\\). So again by Zack's lemma, \\(\\operatorname{deg} K \\leq 1+2-1=2\\), since lines \\(A D\\) and \\(G H\\) can coincide once if \\(D\\) is the reflection of \\(H\\) over \\(\\overline{B C}\\). It follows \\(\\operatorname{deg} L=2\\), since it is obtained by dilating \\(K\\) by a factor of 2 across the fixed point \\(A\\).\n\nLet \\(\\infty_{C}\\) be the point at infinity on the line perpendicular to \\(A C\\), and similarly \\(\\infty_{B}\\). Then\n\\[\nF=\\overline{A C} \\cap \\overline{\\infty_{C} L}, \\quad E=\\overline{A B} \\cap \\overline{\\infty_{B} L} .\n\\]\n\nWe want to use Zack's lemma again on line \\(\\overline{\\infty_{B} L}\\). Consider the case \\(G=B\\); we get \\(\\overline{H G} \\| \\overline{A D}\\), so \\(A D G H\\) is a parallelogram, and then \\(K=L=\\infty_{B}\\). Thus there is at least one \\(t\\) where \\(L=\\infty_{B}\\) and by Zack's lemma we get deg \\(\\left(\\overline{\\infty_{B} L}\\right) \\leq 0+2-1=1\\). Again by Zack's lemma, we conclude \\(\\operatorname{deg} E \\leq 0+1-0=1\\). Similarly, \\(\\operatorname{deg} F \\leq 1\\).\n\nWe were aiming to show \\(E, F, H\\) collinear which is a condition of degree at most \\(1+1+0=2\\). So it suffices to verify the problem for three distinct choices of \\(D\\).\n- If \\(D=A\\), then line \\(G H\\) is line \\(A H\\), and \\(L=\\overline{A D} \\cap \\overline{A H}=A\\). So \\(E=F=A\\) and the statement is true.\n- If \\(D=B, G\\) is the antipode of \\(C\\) on \\(\\Gamma\\). Then \\(K=\\overline{H G} \\cap \\overline{A D}\\) is the midpoint of \\(\\overline{A B}\\), so \\(L=B\\). Then \\(E=B\\) and \\(F\\) is the projection of \\(B\\) onto \\(A C\\), so \\(E, H, F\\) collinear.\n- We finish similarly when \\(D=C\\).\n\nThis completes the proof.\n\nRemark. Less careful approaches are possible which give a worse bound on the degrees, requiring to check (say) five choices of \\(D\\) instead. We present the most careful one showing \\(\\operatorname{deg} D=2\\) for instructional reasons, but the others may be easier to find.", "source_pdf": "TSTST_2019.pdf", "notes": ""}
{"id": "TSTST-2019-6", "contest": "TSTST", "year": "2019", "problem_number": "6", "problem": "Suppose \\(P\\) is a polynomial with integer coefficients such that for every positive integer \\(n\\), the sum of the decimal digits of \\(|P(n)|\\) is not a Fibonacci number. Must \\(P\\) be constant?", "solution": "The answer is yes, \\(P\\) must be constant. By \\(S(n)\\) we mean the sum of the decimal digits of \\(|n|\\).\n\nWe need two claims.\nClaim - If \\(P(x) \\in \\mathbb{Z}[x]\\) is nonconstant with positive leading coefficient, then there exists an integer polynomial \\(F(x)\\) such that all coefficients of \\(P \\circ F\\) are positive except for the second one, which is negative.\n\nProof. We will actually construct a cubic \\(F\\). We call a polynomial good if it has the property.\n\nFirst, consider \\(T_{0}(x)=x^{3}+x+1\\). Observe that in \\(T_{0}^{\\operatorname{deg} P}\\), every coefficient is strictly positive, except for the second one, which is zero.\n\nThen, let \\(T_{1}(x)=x^{3}-\\frac{1}{D} x^{2}+x+1\\). Using continuity as \\(D \\rightarrow \\infty\\), it follows that if \\(D\\) is large enough (in terms of \\(\\operatorname{deg} P\\) ), then \\(T_{1}^{\\operatorname{deg} P}\\) is good, with \\(-\\frac{3}{D} x^{3 \\operatorname{deg} P-1}\\) being the only negative coefficient.\n\nFinally, we can let \\(F(x)=C T_{1}(x)\\) where \\(C\\) is a sufficiently large multiple of \\(D\\) (in terms of the coefficients of \\(P\\) ); thus the coefficients of \\(\\left(C T_{1}(x)\\right)^{\\operatorname{deg} P}\\) dominate (and are integers), as needed.\n\nClaim - There are infinitely many Fibonacci numbers in each residue class modulo 9.\n\nProof. Note the Fibonacci sequence is periodic modulo 9 (indeed it is periodic modulo any integer). Moreover (allowing negative indices),\n\\[\n\\begin{aligned}\nF_{0}=0 \\equiv 0 & (\\bmod 9) \\\\\nF_{1}=1 \\equiv 1 & (\\bmod 9) \\\\\nF_{3}=2 \\equiv 2 & (\\bmod 9) \\\\\nF_{4}=3 \\equiv 3 & (\\bmod 9) \\\\\nF_{7}=13 \\equiv 4 & (\\bmod 9) \\\\\nF_{5}=5 \\equiv 5 & (\\bmod 9) \\\\\nF_{-4}=-3 \\equiv 6 & (\\bmod 9) \\\\\nF_{9}=34 \\equiv 7 & (\\bmod 9) \\\\\nF_{6}=8 \\equiv 8 & (\\bmod 9) .\n\\end{aligned}\n\\]\n\nWe now show how to solve the problem with the two claims. WLOG \\(P\\) satisfies the conditions of the first claim, and choose \\(F\\) as above. Let\n\\[\nP(F(x))=c_{N} x^{N}-c_{N-1} x^{N-1}+c_{N-2} x^{N-2}+\\cdots+c_{0}\n\\]\nwhere \\(c_{i}>0\\) (and \\(N=3 \\operatorname{deg} P\\) ). Then if we select \\(x=10^{e}\\) for \\(e\\) large enough (say \\(x>10 \\max _{i} c_{i}\\) ), the decimal representation \\(P\\left(F\\left(10^{e}\\right)\\right)\\) consists of the concatenation of\n- the decimal representation of \\(c_{N}-1\\),\n- the decimal representation of \\(10^{e}-c_{N-1}\\)\n- the decimal representation of \\(c_{N-2}\\), with several leading zeros,\n- the decimal representation of \\(c_{N-3}\\), with several leading zeros,\n- ...\n- the decimal representation of \\(c_{0}\\), with several leading zeros.\n(For example, if \\(P(F(x))=15 x^{3}-7 x^{2}+4 x+19\\), then \\(P(F(1000))=14,993,004,019\\).) Thus, the sum of the digits of this expression is equal to\n\\[\nS\\left(P\\left(F\\left(10^{e}\\right)\\right)\\right)=9 e+k\n\\]\nfor some constant \\(k\\) depending only on \\(P\\) and \\(F\\), independent of \\(e\\). But this will eventually hit a Fibonacci number by the second claim, contradiction.\n\nRemark. It is important to control the number of negative coefficients in the created polynomial. If one tries to use this approach on a polynomial \\(P\\) with \\(m>0\\) negative coefficients, then one would require that the Fibonacci sequence is surjective modulo \\(9 m\\) for any \\(m>1\\), which is not true: for example the Fibonacci sequence avoids all numbers congruent to \\(4 \\bmod 11(\\) and thus \\(4 \\bmod 99)\\).\n\nIn bases \\(b\\) for which surjectivity modulo \\(b-1\\) fails, the problem is false. For example, \\(P(x)=11 x+4\\) will avoid all Fibonacci numbers if we take sum of digits in base 12, since that base-12 sum is necessarily \\(4(\\bmod 11)\\), hence not a Fibonacci number.", "source_pdf": "TSTST_2019.pdf", "notes": ""}
{"id": "TSTST-2019-7", "contest": "TSTST", "year": "2019", "problem_number": "7", "problem": "Let \\(f: \\mathbb{Z} \\rightarrow\\left\\{1,2, \\ldots, 10^{100}\\right\\}\\) be a function satisfying\n\\[\n\\operatorname{gcd}(f(x), f(y))=\\operatorname{gcd}(f(x), x-y)\n\\]\nfor all integers \\(x\\) and \\(y\\). Show that there exist positive integers \\(m\\) and \\(n\\) such that \\(f(x)=\\operatorname{gcd}(m+x, n)\\) for all integers \\(x\\).", "solution": "Let \\(\\mathcal{P}\\) be the set of primes not exceeding \\(10^{100}\\). For each \\(p \\in \\mathcal{P}\\), let \\(e_{p}=\\max _{x} \\nu_{p}(f(x))\\) and let \\(c_{p} \\in \\operatorname{argmax}_{x} \\nu_{p}(f(x))\\).\n\nWe show that this is good enough to compute all values of \\(x\\), by looking at the exponent at each individual prime.\n\nClaim - For any \\(p \\in \\mathcal{P}\\), we have\n\\[\n\\nu_{p}(f(x))=\\min \\left(\\nu_{p}\\left(x-c_{p}\\right), e_{p}\\right)\n\\]\n\nProof. Note that for any \\(x\\), we have\n\\[\n\\operatorname{gcd}\\left(f\\left(c_{p}\\right), f(x)\\right)=\\operatorname{gcd}\\left(f\\left(c_{p}\\right), x-c_{p}\\right) .\n\\]\n\nWe then take \\(\\nu_{p}\\) of both sides and recall \\(\\nu_{p}(f(x)) \\leq \\nu_{p}\\left(f\\left(c_{p}\\right)\\right)=e_{p}\\); this implies the result.\n\nThis essentially determines \\(f\\), and so now we just follow through. Choose \\(n\\) and \\(m\\) such that\n\\[\n\\begin{aligned}\nn & =\\prod_{p \\in \\mathcal{P}} p^{e_{p}} \\\\\nm & \\equiv-c_{p} \\quad\\left(\\bmod p^{e_{p}}\\right) \\quad \\forall p \\in \\mathcal{P}\n\\end{aligned}\n\\]\nthe latter being possible by Chinese remainder theorem. Then, from the claim we have\n\\[\n\\begin{aligned}\nf(x) & =\\prod_{p \\in \\mathcal{P}} p^{\\nu_{p}(f(x))}=\\prod_{p \\mid n} p^{\\min \\left(\\nu_{p}\\left(x-c_{p}\\right), e_{p}\\right)} \\\\\n& =\\prod_{p \\mid n} p^{\\min \\left(\\nu_{p}(x+m), \\nu_{p}(n)\\right)}=\\operatorname{gcd}(x+m, n)\n\\end{aligned}\n\\]\nfor every \\(x \\in \\mathbb{Z}\\), as desired.\nRemark. The functions \\(f(x)=x\\) and \\(f(x)=|2 x-1|\\) are examples satisfying the gcd equation (the latter always being strictly positive). Hence the hypothesis \\(f\\) bounded cannot be dropped.\n\nRemark. The pair ( \\(m, n\\) ) is essentially unique: every other pair is obtained by shifting \\(m\\) by a multiple of \\(n\\). Hence there is not really any choice in choosing \\(m\\) and \\(n\\).", "source_pdf": "TSTST_2019.pdf", "notes": ""}
{"id": "TSTST-2019-8", "contest": "TSTST", "year": "2019", "problem_number": "8", "problem": "Let \\(\\mathcal{S}\\) be a set of 16 points in the plane, no three collinear. Let \\(\\chi(\\mathcal{S})\\) denote the number of ways to draw 8 line segments with endpoints in \\(\\mathcal{S}\\), such that no two drawn segments intersect, even at endpoints. Find the smallest possible value of \\(\\chi(\\mathcal{S})\\) across all such \\(\\mathcal{S}\\).", "solution": "The answer is 1430 . In general, we prove that with \\(2 n\\) points the answer is the \\(n^{\\text {th }}\\) Catalan number \\(C_{n}=\\frac{1}{n+1}\\binom{2 n}{n}\\).\n\nFirst of all, it is well-known that if \\(\\mathcal{S}\\) is a convex \\(2 n\\)-gon, then \\(\\chi(\\mathcal{S})=C_{n}\\).\nIt remains to prove the lower bound. We proceed by (strong) induction on \\(n\\), with the base case \\(n=0\\) and \\(n=1\\) clear. Suppose the statement is proven for \\(0,1, \\ldots, n\\) and consider a set \\(\\mathcal{S}\\) with \\(2(n+1)\\) points.\n\nLet \\(P\\) be a point on the convex hull of \\(\\mathcal{S}\\), and label the other \\(2 n+1\\) points \\(A_{1}, \\ldots, A_{2 n+1}\\) in order of angle from \\(P\\).\n\nConsider drawing a segment \\(\\overline{P A_{2 k+1}}\\). This splits the \\(2 n\\) remaining points into two halves \\(\\mathcal{U}\\) and \\(\\mathcal{V}\\), with \\(2 k\\) and \\(2(n-k)\\) points respectively.\n\nNote that by choice of \\(P\\), no segment in \\(\\mathcal{U}\\) can intersect a segment in \\(\\mathcal{V}\\). By the inductive hypothesis,\n\\[\n\\chi(\\mathcal{U}) \\geq C_{k} \\quad \\text { and } \\quad \\chi(\\mathcal{V}) \\geq C_{n-k} .\n\\]\n\nThus, drawing \\(\\overline{P A_{2 k+1}}\\), we have at least \\(C_{k} C_{n-k}\\) ways to complete the drawing. Over all choices of \\(k\\), we obtain\n\\[\n\\chi(\\mathcal{S}) \\geq C_{0} C_{n}+\\cdots+C_{n} C_{0}=C_{n+1}\n\\]\nas desired.\nRemark. It is possible to show directly from the lower bound proof that convex \\(2 n\\)-gons achieve the minimum: indeed, every inequality is sharp, and no segment \\(\\overline{P A_{2 k}}\\) can be drawn (since this splits the rest of the points into two halves with an odd number of points, and no crossing segment can be drawn).\n\nBobby Shen points out that in the case of 6 points, a regular pentagon with its center also achieves equality, so this is not the only equality case.\n\nRemark. The result that \\(\\chi(S) \\geq 1\\) for all \\(S\\) is known (consider the choice of 8 segments with smallest sum), and appeared on Putnam 1979. However, it does not seem that knowing this gives an advantage for this problem, since the answer is much larger than 1 .", "source_pdf": "TSTST_2019.pdf", "notes": ""}
{"id": "TSTST-2019-9", "contest": "TSTST", "year": "2019", "problem_number": "9", "problem": "Let \\(A B C\\) be a triangle with incenter \\(I\\). Points \\(K\\) and \\(L\\) are chosen on segment \\(B C\\) such that the incircles of \\(\\triangle A B K\\) and \\(\\triangle A B L\\) are tangent at \\(P\\), and the incircles of \\(\\triangle A C K\\) and \\(\\triangle A C L\\) are tangent at \\(Q\\). Prove that \\(I P=I Q\\).", "solution": "We present two solutions.\n\nIf First solution, mostly elementary (original). Let \\(I_{B}, J_{B}, I_{C}, J_{C}\\) be the incenters of \\(\\triangle A B K, \\triangle A B L, \\triangle A C K, \\triangle A C L\\) respectively.\n\nWe begin with the following claim which does not depend on the existence of tangency points \\(P\\) and \\(Q\\).\n\nClaim - Lines \\(B C, I_{B} J_{C}, J_{B} I_{C}\\) meet at a point \\(R\\) (possibly at infinity).\n\nProof. By rotating by \\(\\frac{1}{2} \\angle A\\) we have the equality\n\\[\nA\\left(B I ; I_{B} J_{B}\\right)=A\\left(I C ; I_{C} J_{C}\\right) .\n\\]\n\nIt follows \\(\\left(B I ; I_{B} J_{B}\\right)=\\left(I C ; I_{C} J_{C}\\right)=\\left(C I ; J_{C} I_{C}\\right)\\). (One could also check directly that both cross ratios equal \\(\\frac{\\sin \\angle B A K / 2}{\\sin \\angle C A K / 2} \\div \\frac{\\sin \\angle B A L / 2}{\\sin \\angle C A L / 2}\\), rather than using rotation.)\n\nTherefore, the concurrence follows from the so-called prism lemma on \\(\\overline{I B I_{B} J_{B}}\\) and \\(\\overline{I C J_{C} I_{C}}\\).\n\nRemark (Nikolai Beluhov). This result is known; it appears as 4.5.32 in Akopyan's Geometry in Figures. The cross ratio is not necessary to prove this claim: it can be proven by length chasing with circumscribed quadrilaterals. (The generalization mentioned later also admits a trig-free proof for the analogous step.)\n\nWe now bring \\(P\\) and \\(Q\\) into the problem.\nClaim - Line \\(P Q\\) also passes through \\(R\\).\n\nProof. Note \\(\\left(B P ; I_{B} J_{B}\\right)=-1=\\left(C Q ; J_{C} I_{C}\\right)\\), so the conclusion again follows by prism lemma.\n\nWe are now ready to complete the proof. Point \\(R\\) is the exsimilicenter of the incircles of \\(\\triangle A B K\\) and \\(\\triangle A C L\\), so \\(\\frac{P I_{B}}{R I_{B}}=\\frac{Q J_{C}}{R J_{C}}\\). Now by Menelaus,\n\\[\n\\frac{I_{B} P}{P I} \\cdot \\frac{I Q}{Q J_{C}} \\cdot \\frac{J_{C} R}{R I_{B}}=-1 \\Longrightarrow I P=I Q\n\\]\n\nRemark (Author's comments on drawing the diagram). Drawing the diagram directly is quite difficult. If one draws \\(\\triangle A B C\\) first, they must locate both \\(K\\) and \\(L\\), which likely involves some trial and error due to the complex interplay between the two points.\n\nThere are alternative simpler ways. For example, one may draw \\(\\triangle A K L\\) first; then the remaining points \\(B\\) and \\(C\\) are not related and the task is much simpler (though some trial and error is still required).\n\nIn fact, by breaking symmetry, we may only require one application of guesswork. Start by drawing \\(\\triangle A B K\\) and its incircle; then the incircle of \\(\\triangle A B L\\) may be constructed, and so point \\(L\\) may be drawn. Thus only the location of point \\(C\\) needs to be guessed. I would be interested in a method to create a general diagram without any trial and error.\n\nI Second solution, inversion (Nikolai Beluhov). As above, the lines \\(B C, I_{B} J_{C}, J_{B} I_{C}\\) meet at some point \\(R\\) (possibly at infinity). Let \\(\\omega_{1}, \\omega_{2}, \\omega_{3}, \\omega_{4}\\) be the incircles of \\(\\triangle A B K\\), \\(\\triangle A C L, \\triangle A B L\\), and \\(\\triangle A C K\\).\n\nClaim - There exists an inversion \\(\\iota\\) at \\(R\\) swapping \\(\\left\\{\\omega_{1}, \\omega_{2}\\right\\}\\) and \\(\\left\\{\\omega_{3}, \\omega_{4}\\right\\}\\).\n\nProof. Consider the inversion at \\(R\\) swapping \\(\\omega_{1}\\) and \\(\\omega_{2}\\). Since \\(\\omega_{1}\\) and \\(\\omega_{3}\\) are tangent, the image of \\(\\omega_{3}\\) is tangent to \\(\\omega_{2}\\) and is also tangent to \\(B C\\). The circle \\(\\omega_{4}\\) is on the correct side of \\(\\omega_{3}\\) to be this image.\n\nClaim - Circles \\(\\omega_{1}, \\omega_{2}, \\omega_{3}, \\omega_{4}\\) share a common radical center.\n\nProof. Let \\(\\Omega\\) be the circle with center \\(R\\) fixed under \\(\\iota\\), and let \\(k\\) be the circle through \\(P\\) centered at the radical center of \\(\\Omega, \\omega_{1}, \\omega_{3}\\).\n\nThen \\(k\\) is actually orthogonal to \\(\\Omega, \\omega_{1}, \\omega_{3}\\), so \\(k\\) is fixed under \\(\\iota\\) and \\(k\\) is also orthogonal to \\(\\omega_{2}\\) and \\(\\omega_{4}\\). Thus the center of \\(k\\) is the desired radical center.\n\nThe desired statement immediately follows. Indeed, letting \\(S\\) be the radical center, it follows that \\(\\overline{S P}\\) and \\(\\overline{S Q}\\) are the common internal tangents to \\(\\left\\{\\omega_{1}, \\omega_{3}\\right\\}\\) and \\(\\left\\{\\omega_{2}, \\omega_{4}\\right\\}\\).\n\nSince \\(S\\) is the radical center, \\(S P=S Q\\). In light of \\(\\angle S P I=\\angle S Q I=90^{\\circ}\\), it follows that \\(I P=I Q\\), as desired.\n\nRemark (Nikolai Beluhov). There exists a circle tangent to all four incircles, because circle \\(k\\) is orthogonal to all four, and line \\(B C\\) is tangent to all four; thus the inverse of line \\(B C\\) in \\(k\\) is a circle tangent to all four incircles.\n\nThe amusing thing here is that Casey's theorem is completely unhelpful for proving this fact: all it can tell us is that there is a line or circle tangent to these incircles, and line \\(B C\\) already satisfies this property.\n\nRemark (Generalization by Nikolai Beluhov). The following generalization holds:\nLet \\(A B C D\\) be a quadrilateral circumscribed about a circle with center \\(I\\). A line through \\(A\\) meets \\(\\overrightarrow{B C}\\) and \\(\\overrightarrow{D C}\\) at \\(K\\) and \\(L\\); another line through \\(A\\) meets \\(\\overrightarrow{B C}\\) and \\(\\overrightarrow{D C}\\) at \\(M\\) and \\(N\\). Suppose that the incircles of \\(\\triangle A B K\\) and \\(\\triangle A B M\\) are tangent at \\(P\\), and the incircles of \\(\\triangle A C L\\) and \\(\\triangle A C N\\) are tangent at \\(Q\\). Prove that \\(I P=I Q\\).\n\nThe first approach can be modified to the generalization. There is an extra initial step required: by Monge, the exsimilicenter of the incircles of \\(\\triangle A B K\\) and \\(\\triangle A D N\\) lies on line \\(B D\\); likewise for the incircles of \\(\\triangle A B L\\) and \\(\\triangle A D M\\). Now one may prove using the same trig approach that these pairs of incircles have a common exsimilicenter, and the rest of the solution plays out similarly. The second approach can also be modified in the same way, once we obtain that a common exsimilicenter exists. (Thus in the generalization, it seems we also get there exists a circle tangent to all four incircles.)", "source_pdf": "TSTST_2019.pdf", "notes": ""}
{"id": "TSTST-2020-1", "contest": "TSTST", "year": "2020", "problem_number": "1", "problem": "Let \\(a, b, c\\) be fixed positive integers. There are \\(a+b+c\\) ducks sitting in a circle, one behind the other. Each duck picks either rock, paper, or scissors, with a ducks picking rock, \\(b\\) ducks picking paper, and \\(c\\) ducks picking scissors.\nA move consists of an operation of one of the following three forms:\n- If a duck picking rock sits behind a duck picking scissors, they switch places.\n- If a duck picking paper sits behind a duck picking rock, they switch places.\n- If a duck picking scissors sits behind a duck picking paper, they switch places.\n\nDetermine, in terms of \\(a, b\\), and \\(c\\), the maximum number of moves which could take place, over all possible initial configurations.", "solution": "The maximum possible number of moves is \\(\\max (a b, a c, b c)\\).\nFirst, we prove this is best possible. We define a feisty triplet to be an unordered triple of ducks, one of each of rock, paper, scissors, such that the paper duck is between the rock and scissors duck and facing the rock duck, as shown.\n\nClaim - The number of feisty triplets decreases by \\(c\\) if a paper duck swaps places with a rock duck, and so on.\n\nProof. Clear.\n\nObviously the number of feisty triples is at most \\(a b c\\) to start. Thus at most \\(\\max (a b, b c, c a)\\) moves may occur, since the number of feisty triplets should always be nonnegative, at which point no moves are possible at all.\n\nTo see that this many moves is possible, assume WLOG \\(a=\\min (a, b, c)\\) and suppose we have \\(a\\) rocks, \\(b\\) papers, and \\(c\\) scissors in that clockwise order.\n\nThen, allow the scissors to filter through the papers while the rocks stay put. Each of the \\(b\\) papers swaps with \\(c\\) scissors, for a total of \\(b c=\\max (a b, a c, b c)\\) swaps.\n\nRemark (Common errors). One small possible mistake: it is not quite k\u00f6sher to say that \"WLOG \\(a \\leq b \\leq c\\) \" because the condition is not symmetric, only cyclic. Therefore in this solution we only assume \\(a=\\min (a, b, c)\\).\n\nIt is true here that every pair of ducks swaps at most once, and some solutions make use of this fact. However, this fact implicitly uses the fact that \\(a, b, c>0\\) and is false without this hypothesis.", "source_pdf": "TSTST_2020.pdf", "notes": ""}
{"id": "TSTST-2020-2", "contest": "TSTST", "year": "2020", "problem_number": "2", "problem": "Let \\(A B C\\) be a scalene triangle with incenter \\(I\\). The incircle of \\(A B C\\) touches \\(\\overline{B C}\\), \\(\\overline{C A}, \\overline{A B}\\) at points \\(D, E, F\\), respectively. Let \\(P\\) be the foot of the altitude from \\(D\\) to \\(\\overline{E F}\\), and let \\(M\\) be the midpoint of \\(\\overline{B C}\\). The rays \\(A P\\) and \\(I P\\) intersect the circumcircle of triangle \\(A B C\\) again at points \\(G\\) and \\(Q\\), respectively. Show that the incenter of triangle \\(G Q M\\) coincides with \\(D\\).", "solution": "Refer to the figure below.\n\nClaim - The point \\(Q\\) is the Miquel point of \\(B F E C\\). Also, \\(\\overline{Q D}\\) bisects \\(\\angle B Q C\\).\n\nProof. Inversion around the incircle maps line \\(E F\\) to ( \\(A I E F\\) ) and the nine-point circle of \\(\\triangle D E F\\) to the circumcircle of \\(\\triangle A B C\\) (as the midpoint of \\(\\overline{E F}\\) maps to \\(A\\), etc.). This implies \\(P\\) maps to \\(Q\\); that is, \\(Q\\) coincides with the second intersection of ( \\(A F I E\\) ) with \\((A B C)\\). This is the claimed Miquel point.\n\nThe spiral similarity mentioned then gives \\(\\frac{Q B}{B F}=\\frac{Q C}{C E}\\), so \\(\\overline{Q D}\\) bisects \\(\\angle B Q C\\).\n\nRemark. The point \\(Q\\) and its properties mentioned in the first claim have appeared in other references. See for example Canada 2007/5, ELMO 2010/6, HMMT 2016 T-10, USA TST 2017/2, USA TST 2019/6 for a few examples.\n\nClaim - We have \\((Q G ; B C)=-1\\), so in particular \\(\\overline{G D}\\) bisects \\(\\angle B G C\\).\n\nProof. Note that\n\\[\n-1=(A I ; E F) \\stackrel{Q}{=} (\\overline{A Q} \\cap \\overline{E F}, P ; E, F) \\stackrel{A}{=} (Q G ; B C) .\n\\]\n\nThe last statement follows from Apollonian circle, or more bluntly \\(\\frac{G B}{G C}=\\frac{Q B}{Q C}=\\frac{B D}{D C}\\).\nHence \\(\\overline{Q D}\\) and \\(\\overline{G D}\\) are angle bisectors of \\(\\angle B Q C\\) and \\(\\angle B G C\\). However, \\(\\overline{Q M}\\) and \\(\\overline{Q G}\\) are isogonal in \\(\\angle B Q C\\) (as median and symmedian), and similarly for \\(\\angle B G C\\), as desired.", "source_pdf": "TSTST_2020.pdf", "notes": ""}
{"id": "TSTST-2020-3", "contest": "TSTST", "year": "2020", "problem_number": "3", "problem": "We say a nondegenerate triangle whose angles have measures \\(\\theta_{1}, \\theta_{2}, \\theta_{3}\\) is quirky if there exists integers \\(r_{1}, r_{2}, r_{3}\\), not all zero, such that\n\\[\nr_{1} \\theta_{1}+r_{2} \\theta_{2}+r_{3} \\theta_{3}=0\n\\]\n\nFind all integers \\(n \\geq 3\\) for which a triangle with side lengths \\(n-1, n, n+1\\) is quirky.", "solution": "The answer is \\(n=3,4,5,7\\).\nWe first introduce a variant of the \\(k\\) th Chebyshev polynomials in the following lemma (which is standard, and easily shown by induction).\n\nLemma\n\nFor each \\(k \\geq 0\\) there exists \\(P_{k}(X) \\in \\mathbb{Z}[X]\\), monic for \\(k \\geq 1\\) and with degree \\(k\\), such that\n\\[\nP_{k}\\left(X+X^{-1}\\right) \\equiv X^{k}+X^{-k}\n\\]\n\nThe first few are \\(P_{0}(X) \\equiv 2, P_{1}(X) \\equiv X, P_{2}(X) \\equiv X^{2}-2, P_{3}(X) \\equiv X^{3}-3 X\\).\n\nSuppose the angles of the triangle are \\(\\alpha<\\beta<\\gamma\\), so the law of cosines implies that\n\\[\n2 \\cos \\alpha=\\frac{n+4}{n+1} \\quad \\text { and } \\quad 2 \\cos \\gamma=\\frac{n-4}{n-1} .\n\\]\n\nClaim - The triangle is quirky iff there exists \\(r, s \\in \\mathbb{Z}_{\\geq 0}\\) not both zero such that\n\\[\n\\cos (r \\alpha)= \\pm \\cos (s \\gamma) \\quad \\text { or equivalently } \\quad P_{r}\\left(\\frac{n+4}{n+1}\\right)= \\pm P_{s}\\left(\\frac{n-4}{n-1}\\right)\n\\]\n\nProof. If there are integers \\(x, y, z\\) for which \\(x \\alpha+y \\beta+z \\gamma=0\\), then we have that \\((x-y) \\alpha=(y-z) \\gamma-\\pi y\\), whence it follows that we may take \\(r=|x-y|\\) and \\(s=|y-z|\\) (noting \\(r=s=0\\) implies the absurd \\(x=y=z\\) ). Conversely, given such \\(r\\) and \\(s\\) with \\(\\cos (r \\alpha)= \\pm \\cos (s \\gamma)\\), then it follows that \\(r \\alpha \\pm s \\gamma=k \\pi=k(\\alpha+\\beta+\\gamma)\\) for some \\(k\\), so the triangle is quirky.\n\nIf \\(r=0\\), then by rational root theorem on \\(P_{s}(X) \\pm 2\\) it follows \\(\\frac{n-4}{n-1}\\) must be an integer which occurs only when \\(n=4\\) (recall \\(n \\geq 3\\) ). Similarly we may discard the case \\(s=0\\).\n\nThus in what follows assume \\(n \\neq 4\\) and \\(r, s>0\\). Then, from the fact that \\(P_{r}\\) and \\(P_{s}\\) are nonconstant monic polynomials, we find\n\nCorollary\n\nIf \\(n \\neq 4\\) works, then when \\(\\frac{n+4}{n+1}\\) and \\(\\frac{n-4}{n-1}\\) are written as fractions in lowest terms, the denominators have the same set of prime factors.\n\nBut \\(\\operatorname{gcd}(n+1, n-1)\\) divides 2 , and \\(\\operatorname{gcd}(n+4, n+1), \\operatorname{gcd}(n-4, n-1)\\) divide 3. So we only have three possibilities:\n- \\(n+1=2^{u}\\) and \\(n-1=2^{v}\\) for some \\(u, v \\geq 0\\). This is only possible if \\(n=3\\). Here \\(2 \\cos \\alpha=\\frac{7}{4}\\) and \\(2 \\cos \\gamma=-\\frac{1}{2}\\), and indeed \\(P_{2}(-1 / 2)=-7 / 4\\).\n- \\(n+1=3 \\cdot 2^{u}\\) and \\(n-1=2^{v}\\) for some \\(u, v \\geq 0\\), which implies \\(n=5\\). Here \\(2 \\cos \\alpha=\\frac{3}{2}\\) and \\(2 \\cos \\gamma=\\frac{1}{4}\\), and indeed \\(P_{2}(3 / 2)=1 / 4\\).\n- \\(n+1=2^{u}\\) and \\(n-1=3 \\cdot 2^{v}\\) for some \\(u, v \\geq 0\\), which implies \\(n=7\\). Here \\(2 \\cos \\alpha=\\frac{11}{8}\\) and \\(2 \\cos \\gamma=\\frac{1}{2}\\), and indeed \\(P_{3}(1 / 2)=-11 / 8\\).\n\nFinally, \\(n=4\\) works because the triangle is right, completing the solution.\nRemark (Major generalization due to Luke Robitaille). In fact one may find all quirky triangles whose sides are integers in arithmetic progression.\n\nIndeed, if the side lengths of the triangle are \\(x-y, x, x+y\\) with \\(\\operatorname{gcd}(x, y)=1\\) then the problem becomes\n\\[\nP_{r}\\left(\\frac{x+4 y}{x+y}\\right)= \\pm P_{s}\\left(\\frac{x-4 y}{x-y}\\right)\n\\]\nand so in the same way as before, we ought to have \\(x+y\\) and \\(x-y\\) are both of the form \\(3 \\cdot 2^{*}\\) unless \\(r s=0\\). This time, when \\(r s=0\\), we get the extra solutions \\((1,0),(4,1)\\), and \\((5,2)\\).\n\nFor \\(r s \\neq 0\\), by triangle inequality, we have \\(x-y \\leq x+y<3(x-y)\\), and \\(\\min \\left(\\nu_{2}(x-\\right. \\left.y), \\nu_{2}(x+y)\\right) \\leq 1\\), so it follows one of \\(x-y\\) or \\(x+y\\) must be in \\(\\{1,2,3,6\\}\\). An exhaustive check then leads to\n\\[\n(x, y) \\in\\{(3,1),(5,1),(7,1),(11,5)\\} \\cup\\{(1,0),(5,2),(4,1)\\}\n\\]\nas the solution set. And in fact they all work.\nIn conclusion the equilateral triangle, 3-5-7 triangle (which has a \\(120^{\\circ}\\) angle) and \\(6-11-16\\) triangle (which satisfies \\(B=3 A+4 C\\) ) are exactly the new quirky triangles (up to similarity) whose sides are integers in arithmetic progression.", "source_pdf": "TSTST_2020.pdf", "notes": ""}
{"id": "TSTST-2020-4", "contest": "TSTST", "year": "2020", "problem_number": "4", "problem": "Find all pairs of positive integers ( \\(a, b\\) ) satisfying the following conditions:\n(i) \\(a\\) divides \\(b^{4}+1\\),\n(ii) \\(b\\) divides \\(a^{4}+1\\),\n(iii) \\(\\lfloor\\sqrt{a}\\rfloor=\\lfloor\\sqrt{b}\\rfloor\\).", "solution": "The only solutions are \\((1,1),(1,2)\\), and \\((2,1)\\), which clearly work. Now we show there are no others.\n\nObviously, \\(\\operatorname{gcd}(a, b)=1\\), so the problem conditions imply\n\\[\na b \\mid(a-b)^{4}+1\n\\]\nsince each of \\(a\\) and \\(b\\) divide the right-hand side. We define\n\\[\nk \\stackrel{\\text { def }}{=} \\frac{(b-a)^{4}+1}{a b}\n\\]\n\nClaim (Size estimate) - We must have \\(k \\leq 16\\).\n\nProof. Let \\(n=\\lfloor\\sqrt{a}\\rfloor=\\lfloor\\sqrt{b}\\rfloor\\), so that \\(a, b \\in\\left[n^{2}, n^{2}+2 n\\right]\\). We have that\n\\[\n\\begin{aligned}\na b & \\geq n^{2}\\left(n^{2}+1\\right) \\geq n^{4}+1 \\\\\n(b-a)^{4}+1 & \\leq(2 n)^{4}+1=16 n^{4}+1\n\\end{aligned}\n\\]\nwhich shows \\(k \\leq 16\\).\n\nClaim (Orders argument) - In fact, \\(k=1\\).\n\nProof. First of all, note that \\(k\\) cannot be even: if it was, then \\(a, b\\) have opposite parity, but then \\(4 \\mid(b-a)^{4}+1\\), contradiction.\n\nThus \\(k\\) is odd. However, every odd prime divisor of \\((b-a)^{4}+1\\) is congruent to 1 \\((\\bmod 8)\\) and is thus at least 17 , so \\(k=1\\) or \\(k \\geq 17\\). It follows that \\(k=1\\).\n\nAt this point, we have reduced to solving\n\\[\na b=(b-a)^{4}+1\n\\]\nand we need to prove the claimed solutions are the only ones. Write \\(b=a+d\\), and assume WLOG that \\(d \\geq 0\\) : then we have \\(a(a+d)=d^{4}+1\\), or\n\\[\na^{2}-d a-\\left(d^{4}+1\\right)=0\n\\]\n\nThe discriminant \\(d^{2}+4\\left(d^{4}+1\\right)=4 d^{4}+d^{2}+4\\) must be a perfect square.\n- The cases \\(d=0\\) and \\(d=1\\) lead to pairs \\((1,1)\\) and \\((1,2)\\).\n- If \\(d \\geq 2\\), then we can sandwich\n\\[\n\\left(2 d^{2}\\right)^{2}<4 d^{4}+d^{2}+4<4 d^{4}+4 d^{2}+1=\\left(2 d^{2}+1\\right)^{2}\n\\]\nso the discriminant is not a square.\nThe solution is complete.\nRemark (Author remarks on origin). This comes from the problem of the existence of a pair of elliptic curves over \\(\\mathbb{F}_{a}, \\mathbb{F}_{b}\\) respectively, such that the number of points on one is the field size of the other. The bound \\(n^{2} \\leq a, b<(n+1)^{2}\\) is the Hasse bound. The divisibility conditions correspond to asserting that the embedding degree of each curve is 8 , so that they are pairing friendly. In this way, the problem is essentially the key result of https://arxiv.org/pdf/1803.02067.pdf, shown in Proposition 3.", "source_pdf": "TSTST_2020.pdf", "notes": ""}
{"id": "TSTST-2020-5", "contest": "TSTST", "year": "2020", "problem_number": "5", "problem": "Let \\(\\mathbb{N}^{2}\\) denote the set of ordered pairs of positive integers. A finite subset \\(S\\) of \\(\\mathbb{N}^{2}\\) is stable if whenever ( \\(x, y\\) ) is in \\(S\\), then so are all points ( \\(x^{\\prime}, y^{\\prime}\\) ) of \\(\\mathbb{N}^{2}\\) with both \\(x^{\\prime} \\leq x\\) and \\(y^{\\prime} \\leq y\\).\n\nProve that if \\(S\\) is a stable set, then among all stable subsets of \\(S\\) (including the empty set and \\(S\\) itself), at least half of them have an even number of elements.", "solution": "The following inductive solution was given by Nikolai Beluhov. We proceed by induction on \\(|S|\\), with \\(|S| \\leq 1\\) clear.\n\nSuppose \\(|S| \\geq 2\\). For any \\(p \\in S\\), let \\(R(p)\\) denote the stable rectangle with upper-right corner \\(p\\). We say such \\(p\\) is pivotal if \\(p+(1,1) \\notin S\\) and \\(|R(p)|\\) is even.\n\nClaim - If \\(|S| \\geq 2\\), then a pivotal \\(p\\) always exists.\n\nProof. Consider the top row of \\(S\\).\n- If it has length at least 2 , one of the two rightmost points in it is pivotal.\n- Otherwise, the top row has length 1. Now either the top point or the point below it (which exists as \\(|S| \\geq 2\\) ) is pivotal.\n\nWe describe how to complete the induction, given some pivotal \\(p \\in S\\). There is a partition\n\\[\nS=R(p) \\sqcup S_{1} \\sqcup S_{2}\n\\]\nwhere \\(S_{1}\\) and \\(S_{2}\\) are the sets of points in \\(S\\) above and to the right of \\(p\\) (possibly empty).\nClaim - The desired inequality holds for stable subsets containing \\(p\\).\n\nProof. Let \\(E_{1}\\) denote the number of even stable subsets of \\(S_{1}\\); denote \\(E_{2}, O_{1}, O_{2}\\) analogously. The stable subsets containing \\(p\\) are exactly \\(R(p) \\sqcup T_{1} \\sqcup T_{2}\\), where \\(T_{1} \\subseteq S_{1}\\) and \\(T_{2} \\subseteq S_{2}\\) are stable.\n\nSince \\(|R(p)|\\) is even, exactly \\(E_{1} E_{2}+O_{1} O_{2}\\) stable subsets containing \\(p\\) are even, and exactly \\(E_{1} O_{2}+E_{2} O_{1}\\) are odd. As \\(E_{1} \\geq O_{1}\\) and \\(E_{2} \\geq O_{2}\\) by inductive hypothesis, we obtain \\(E_{1} E_{2}+O_{1} O_{2} \\geq E_{1} O_{2}+E_{2} O_{1}\\) as desired.\n\nBy the inductive hypothesis, the desired inequality also holds for stable subsets not containing \\(p\\), so we are done.", "source_pdf": "TSTST_2020.pdf", "notes": ""}
{"id": "TSTST-2020-6", "contest": "TSTST", "year": "2020", "problem_number": "6", "problem": "Let \\(A, B, C, D\\) be four points such that no three are collinear and \\(D\\) is not the orthocenter of triangle \\(A B C\\). Let \\(P, Q, R\\) be the orthocenters of \\(\\triangle B C D, \\triangle C A D\\), \\(\\triangle A B D\\), respectively. Suppose that lines \\(A P, B Q, C R\\) are pairwise distinct and are concurrent. Show that the four points \\(A, B, C, D\\) lie on a circle.", "solution": "Let \\(T\\) be the concurrency point, and let \\(H\\) be the orthocenter of \\(\\triangle A B C\\).\n\nClaim (Key claim) - \\(T\\) is the midpoint of \\(\\overline{A P}, \\overline{B Q}, \\overline{C R}, \\overline{D H}\\), and \\(D\\) is the orthocenter of \\(\\triangle P Q R\\).\n\nProof. Note that \\(\\overline{A Q} \\| \\overline{B P}\\), as both are perpendicular to \\(\\overline{C D}\\). Since lines \\(A P\\) and \\(B Q\\) are distinct, lines \\(A Q\\) and \\(B P\\) are distinct.\n\nBy symmetric reasoning, we get that \\(A Q C P B R\\) is a hexagon with opposite sides parallel and concurrent diagonals as \\(\\overline{A P}, \\overline{B Q}, \\overline{C R}\\) meet at \\(T\\). This implies that the hexagon is centrally symmetric about \\(T\\); indeed\n\\[\n\\frac{A T}{T P}=\\frac{T Q}{B T}=\\frac{C T}{T R}=\\frac{T P}{A T}\n\\]\nso all the ratios are equal to +1 .\nNext, \\(\\overline{P D} \\perp \\overline{B C} \\| \\overline{Q R}\\), so by symmetry we get \\(D\\) is the orthocenter of \\(\\triangle P Q R\\). This means that \\(T\\) is the midpoint of \\(\\overline{D H}\\) as well.\n\nCorollary\n\nThe configuration is now symmetric: we have four points \\(A, B, C, D\\), and their reflections in \\(T\\) are four orthocenters \\(P, Q, R, H\\).\n\nLet \\(S\\) be the centroid of \\(\\{A, B, C, D\\}\\), and let \\(O\\) be the reflection of \\(T\\) in \\(S\\). We are ready to conclude:\n\nClaim - \\(A, B, C, D\\) are equidistant from \\(O\\).\n\nProof. Let \\(A^{\\prime}, O^{\\prime}, S^{\\prime}, T^{\\prime}, D^{\\prime}\\) be the projections of \\(A, O, S, T, D\\) onto line \\(B C\\).\nThen \\(T^{\\prime}\\) is the midpoint of \\(\\overline{A^{\\prime} D^{\\prime}}\\), so \\(S^{\\prime}=\\frac{1}{4}\\left(A^{\\prime}+D^{\\prime}+B+C\\right)\\) gives that \\(O^{\\prime}\\) is the midpoint of \\(\\overline{B C}\\).\n\nThus \\(O B=O C\\) and we're done.", "source_pdf": "TSTST_2020.pdf", "notes": ""}
{"id": "TSTST-2020-7", "contest": "TSTST", "year": "2020", "problem_number": "7", "problem": "Find all nonconstant polynomials \\(P(z)\\) with complex coefficients for which all complex roots of the polynomials \\(P(z)\\) and \\(P(z)-1\\) have absolute value 1 .", "solution": "The answer is \\(P(x)\\) should be a polynomial of the form \\(P(x)=\\lambda x^{n}-\\mu\\) where \\(|\\lambda|=|\\mu|\\) and \\(\\operatorname{Re} \\mu=-\\frac{1}{2}\\). One may check these all work; let's prove they are the only solutions.\n\nFirst approach (Evan Chen). We introduce the following notations:\n\\[\n\\begin{aligned}\nP(x) & =c_{n} x^{n}+c_{n-1} x^{n-1}+\\cdots+c_{1} x+c_{0} \\\\\n& =c_{n}\\left(x+\\alpha_{1}\\right) \\ldots\\left(x+\\alpha_{n}\\right) \\\\\nP(x)-1 & =c_{n}\\left(x+\\beta_{1}\\right) \\ldots\\left(x+\\beta_{n}\\right)\n\\end{aligned}\n\\]\n\nBy taking conjugates,\n\\[\n\\begin{aligned}\n\\left(x+\\alpha_{1}\\right) \\cdots\\left(x+\\alpha_{n}\\right) & =\\left(x+\\beta_{1}\\right) \\cdots\\left(x+\\beta_{n}\\right)+c_{n}^{-1} \\\\\n\\Longrightarrow\\left(x+\\frac{1}{\\alpha_{1}}\\right) \\cdots\\left(x+\\frac{1}{\\alpha_{n}}\\right) & =\\left(x+\\frac{1}{\\beta_{1}}\\right) \\cdots\\left(x+\\frac{1}{\\beta_{n}}\\right)+\\left(\\overline{c_{n}}\\right)^{-1}\n\\end{aligned}\n\\]\n\nThe equation ( \\(\\mathbf{0}\\) ) is the main player:\nClaim - We have \\(c_{k}=0\\) for all \\(k=1, \\ldots, n-1\\).\n\nProof. By comparing coefficients of \\(x^{k}\\) in ( \\(\\mathbf{0}\\) ) we obtain\n\\[\n\\frac{c_{n-k}}{\\prod_{i} \\alpha_{i}}=\\frac{c_{n-k}}{\\prod_{i} \\beta_{i}}\n\\]\nbut \\(\\prod_{i} \\alpha_{i}-\\prod_{i} \\beta_{i}=\\frac{1}{c_{n}} \\neq 0\\). Hence \\(c_{k}=0\\).\nIt follows that \\(P(x)\\) must be of the form \\(P(x)=\\lambda x^{n}-\\mu\\), so that \\(P(x)=\\lambda x^{n}-(\\mu+1)\\). This requires \\(|\\mu|=|\\mu+1|=|\\lambda|\\) which is equivalent to the stated part.\n\nIT Second approach (from the author). We let \\(A=P\\) and \\(B=P-1\\) to make the notation more symmetric. We will as before show that \\(A\\) and \\(B\\) have all coefficients equal to zero other than the leading and constant coefficient; the finish is the same.\n\nFirst, we rule out double roots.\nClaim - Neither \\(A\\) nor \\(B\\) have double roots.\n\nProof. Suppose that \\(b\\) is a double root of \\(B\\). By differentiating, we obtain \\(A^{\\prime}=B^{\\prime}\\), so \\(A^{\\prime}(b)=0\\). However, by Gauss-Lucas, this forces \\(A(b)=0\\), contradiction.\n\nLet \\(\\omega=e^{2 \\pi i / n}\\), let \\(a_{1}, \\ldots, a_{n}\\) be the roots of \\(A\\), and let \\(b_{1}, \\ldots, b_{n}\\) be the roots of \\(B\\). For each \\(k\\), let \\(A_{k}\\) and \\(B_{k}\\) be the points in the complex plane corresponding to \\(a_{k}\\) and \\(b_{k}\\).\n\nClaim (Main claim) - For any \\(i\\) and \\(j, \\frac{a_{i}}{a_{j}}\\) is a power of \\(\\omega\\).\n\nProof. Note that\n\\[\n\\frac{a_{i}-b_{1}}{a_{j}-b_{1}} \\cdots \\frac{a_{i}-b_{n}}{a_{j}-b_{n}}=\\frac{B\\left(a_{i}\\right)}{B\\left(a_{j}\\right)}=\\frac{A\\left(a_{i}\\right)-1}{A\\left(a_{j}\\right)-1}=\\frac{0-1}{0-1}=1 .\n\\]\n\nSince the points \\(A_{i}, A_{j}, B_{k}\\) all lie on the unit circle, interpreting the left-hand side geometrically gives\n\\[\n\\measuredangle A_{i} B_{1} A_{j}+\\cdots+\\measuredangle A_{i} B_{n} A_{j}=0 \\Longrightarrow n \\widehat{A_{i} A_{j}}=0\n\\]\nwhere angles are directed modulo \\(180^{\\circ}\\) and arcs are directed modulo \\(360^{\\circ}\\). This implies that \\(\\frac{a_{i}}{a_{j}}\\) is a power of \\(\\omega\\).\n\nNow the finish is easy: since \\(a_{1}, \\ldots, a_{n}\\) are all different, they must be \\(a_{1} \\omega^{0}, \\ldots, a_{1} \\omega^{n-1}\\) in some order; this shows that \\(A\\) is a multiple of \\(x^{n}-a_{1}^{n}\\), as needed.", "source_pdf": "TSTST_2020.pdf", "notes": ""}
{"id": "TSTST-2020-8", "contest": "TSTST", "year": "2020", "problem_number": "8", "problem": "For every positive integer \\(N\\), let \\(\\sigma(N)\\) denote the sum of the positive integer divisors of \\(N\\). Find all integers \\(m \\geq n \\geq 2\\) satisfying\n\\[\n\\frac{\\sigma(m)-1}{m-1}=\\frac{\\sigma(n)-1}{n-1}=\\frac{\\sigma(m n)-1}{m n-1} .\n\\]", "solution": "The answer is that \\(m\\) and \\(n\\) should be powers of the same prime number. These all work because for a prime power we have\n\\[\n\\frac{\\sigma\\left(p^{e}\\right)-1}{p^{e}-1}=\\frac{\\left(1+p+\\cdots+p^{e}\\right)-1}{p^{e}-1}=\\frac{p\\left(1+\\cdots+p^{e-1}\\right)}{p^{e}-1}=\\frac{p}{p-1} .\n\\]\n\nSo we now prove these are the only ones. Let \\(\\lambda\\) be the common value of the three fractions.\n\nClaim - Any solution \\((m, n)\\) should satisfy \\(d(m n)=d(m)+d(n)-1\\).\n\nProof. The divisors of \\(m n\\) include the divisors of \\(m\\), plus \\(m\\) times the divisors of \\(n\\) (counting \\(m\\) only once). Let \\(\\lambda\\) be the common value; then this gives\n\\[\n\\begin{aligned}\n\\sigma(m n) & \\geq \\sigma(m)+m \\sigma(n)-m \\\\\n& =(\\lambda m-\\lambda+1)+m(\\lambda n-\\lambda+1)-m \\\\\n& =\\lambda m n-\\lambda+1\n\\end{aligned}\n\\]\nand so equality holds. Thus these are all the divisors of \\(m n\\), for a count of \\(d(m)+d(n)-\\) 1.\n\nClaim - If \\(d(m n)=d(m)+d(n)-1\\) and \\(\\min (m, n) \\geq 2\\), then \\(m\\) and \\(n\\) are powers of the same prime.\n\nProof. Let \\(A\\) denote the set of divisors of \\(m\\) and \\(B\\) denote the set of divisors of \\(n\\). Then \\(|A \\cdot B|=|A|+|B|-1\\) and \\(\\min (|A|,|B|)>1\\), so \\(|A|\\) and \\(|B|\\) are geometric progressions with the same ratio. It follows that \\(m\\) and \\(n\\) are powers of the same prime.\n\nRemark (Nikolai Beluhov). Here is a completion not relying on \\(|A \\cdot B|=|A|+|B|-1\\). By the above arguments, we see that every divisor of \\(m n\\) is either a divisor of \\(n\\), or \\(n\\) times a divisor of \\(m\\).\n\nNow suppose that some prime \\(p \\mid m\\) but \\(p \\nmid n\\). Then \\(p \\mid m n\\) but \\(p\\) does not appear in the above classification, a contradiction. By symmetry, it follows that \\(m\\) and \\(n\\) have the same prime divisors.\n\nNow suppose we have different primes \\(p \\mid m\\) and \\(q \\mid n\\). Write \\(\\nu_{p}(m)=\\alpha\\) and \\(\\nu_{p}(n)=\\beta\\). Then \\(p^{\\alpha+\\beta} \\mid m n\\), but it does not appear in the above characterization, a contradiction. Thus, \\(m\\) and \\(n\\) are powers of the same prime.\n\nRemark (Comments on the function in the problem). Let \\(f(n)=\\frac{\\sigma(n)-1}{n-1}\\). Then \\(f\\) is not really injective even outside the above solution; for example, we have \\(f\\left(6 \\cdot 11^{k}\\right)=\\frac{11}{5}\\) for all \\(k\\), plus sporadic equivalences like \\(f(14)=f(404)\\), as pointed out by one reviewer during test-solving. This means that both relations should be used at once, not independently.\n\nRemark (Authorship remarks). Ankan gave the following story for how he came up with the problem while thinking about so-called almost perfect numbers.\n\nI was in some boring talk when I recalled a conjecture that if \\(\\sigma(n)=2 n-1\\), then \\(n\\) is a power of 2 . For some reason (divine intervention, maybe) I had the double idea of (1) seeing whether \\(m, n, m n\\) all almost perfect implies \\(m, n\\) powers of 2 , and (2) trying the naive divisor bound to resolve this. Through sheer dumb luck this happened to work out perfectly. I thought this was kinda cool but I felt that I hadn't really unlocked a lot of the potential this idea had: then I basically tried to find the \"general situation\" which allows for this manipulation, and was amazed that it led to such a striking statement.", "source_pdf": "TSTST_2020.pdf", "notes": ""}
{"id": "TSTST-2020-9", "contest": "TSTST", "year": "2020", "problem_number": "9", "problem": "Ten million fireflies are glowing in \\(\\mathbb{R}^{3}\\) at midnight. Some of the fireflies are friends, and friendship is always mutual. Every second, one firefly moves to a new position so that its distance from each one of its friends is the same as it was before moving. This is the only way that the fireflies ever change their positions. No two fireflies may ever occupy the same point.\n\nInitially, no two fireflies, friends or not, are more than a meter away. Following some finite number of seconds, all fireflies find themselves at least ten million meters away from their original positions. Given this information, find the greatest possible number of friendships between the fireflies.", "solution": "In general, we show that when \\(n \\geq 70\\), the answer is \\(f(n)=\\left\\lfloor\\frac{n^{2}}{3}\\right\\rfloor\\).\nConstruction: Choose three pairwise parallel lines \\(\\ell_{A}, \\ell_{B}, \\ell_{C}\\) forming an infinite equilateral triangle prism (with side larger than 1 ). Split the \\(n\\) fireflies among the lines as equally as possible, and say that two fireflies are friends iff they lie on different lines.\n\nTo see this works:\n1. Reflect \\(\\ell_{A}\\) and all fireflies on \\(\\ell_{A}\\) in the plane containing \\(\\ell_{B}\\) and \\(\\ell_{C}\\).\n2. Reflect \\(\\ell_{B}\\) and all fireflies on \\(\\ell_{B}\\) in the plane containing \\(\\ell_{C}\\) and \\(\\ell_{A}\\).\n3. Reflect \\(\\ell_{C}\\) and all fireflies on \\(\\ell_{C}\\) in the plane containing \\(\\ell_{A}\\) and \\(\\ell_{B}\\).\n\nProof: Consider a valid configuration of fireflies. If there is no 4 -clique of friends, then by Tur\u00e1n's theorem, there are at most \\(f(n)\\) pairs of friends.\n\nLet \\(g(n)\\) be the answer, given that there exist four pairwise friends (say \\(a, b, c, d\\) ). Note that for a firefly to move, all its friends must be coplanar.\n\nClaim (No coplanar \\(K_{4}\\) ) - We can't have four coplanar fireflies which are pairwise friends.\n\nProof. If we did, none of them could move (unless three are collinear, in which case they can't move).\n\nClaim (Key claim - tetrahedrons don't share faces often) - There are at most 12 fireflies \\(e\\) which are friends with at least three of \\(a, b, c, d\\).\n\nProof. First denote by \\(A, B, C, D\\) the locations of fireflies \\(a, b, c, d\\). These four positions change over time as fireflies move, but the tetrahedron \\(A B C D\\) always has a fixed shape, and we will take this tetrahedron as our reference frame for the remainder of the proof.\n\nWLOG, will assume that \\(e\\) is friends with \\(a, b, c\\). Then \\(e\\) will always be located at one of two points \\(E_{1}\\) and \\(E_{2}\\) relative to \\(A B C\\), such that \\(E_{1} A B C\\) and \\(E_{2} A B C\\) are two\ncongruent tetrahedrons with fixed shape. We note that points \\(D, E_{1}\\), and \\(E_{2}\\) are all different: clearly \\(D \\neq E_{1}\\) and \\(E_{1} \\neq E_{2}\\). (If \\(D=E_{2}\\), then some fireflies won't be able to move.)\n\nConsider the moment where firefly \\(a\\) moves. Its friends must be coplanar at that time, so one of \\(E_{1}, E_{2}\\) lies in plane \\(B C D\\). Similar reasoning holds for planes \\(A C D\\) and \\(A B D\\).\n\nSo, WLOG \\(E_{1}\\) lies on both planes \\(B C D\\) and \\(A C D\\). Then \\(E_{1}\\) lies on line \\(C D\\), and \\(E_{2}\\) lies in plane \\(A B D\\). This uniquely determines ( \\(E_{1}, E_{2}\\) ) relative to \\(A B C D\\) :\n- \\(E_{1}\\) is the intersection of line \\(C D\\) with the reflection of plane \\(A B D\\) in plane \\(A B C\\).\n- \\(E_{2}\\) is the intersection of plane \\(A B D\\) with the reflection of line \\(C D\\) in plane \\(A B C\\).\n\nAccounting for WLOGs, there are at most 12 possibilities for the set \\(\\left\\{E_{1}, E_{2}\\right\\}\\), and thus at most 12 possibilities for \\(E\\). (It's not possible for both elements of one pair \\(\\left\\{E_{1}, E_{2}\\right\\}\\) to be occupied, because then they couldn't move.)\n\nThus, the number of friendships involving exactly one of \\(a, b, c, d\\) is at most \\((n-16) \\cdot 2+12 \\cdot 3=2 n+4\\), so removing these four fireflies gives\n\\[\ng(n) \\leq 6+(2 n+4)+\\max \\{f(n-4), g(n-4)\\} .\n\\]\n\nThe rest of the solution is bounding. When \\(n \\geq 24\\), we have \\((2 n+10)+f(n-4) \\leq f(n)\\), so\n\\[\ng(n) \\leq \\max \\{f(n),(2 n+10)+g(n-4)\\} \\quad \\forall n \\geq 24 .\n\\]\n\nBy iterating the above inequality, we get\n\\[\n\\begin{aligned}\ng(n) \\leq \\max \\{f(n),(2 n+10) & +(2(n-4)+10) \\\\\n& +\\cdots+(2(n-4 r)+10)+g(n-4 r-4)\\}\n\\end{aligned}\n\\]\nwhere \\(r\\) satisfies \\(n-4 r-4<24 \\leq n-4 r\\).\nNow\n\\[\n\\begin{aligned}\n& (2 n+10)+(2(n-4)+10)+\\cdots+(2(n-4 r)+10)+g(n-4 r-4) \\\\\n= & (r+1)(2 n-4 r+10)+g(n-4 r-4) \\\\\n\\leq & \\left(\\frac{n}{4}-5\\right)(n+37)+\\binom{24}{2}\n\\end{aligned}\n\\]\n\nThis is less than \\(f(n)\\) for \\(n \\geq 70\\), which concludes the solution.\nRemark. There are positive integers \\(n\\) such that it is possible to do better than \\(f(n)\\) friendships. For instance, \\(f(5)=8\\), whereas five fireflies \\(a, b, c, d\\), and \\(e\\) as in the proof of the Lemma ( \\(E_{1}\\) being the intersection point of line \\(C D\\) with the reflection of plane ( \\(A B D\\) ) in plane \\((A B C), E_{2}\\) being the intersection point of plane \\((A B D)\\) with the reflection of line \\(C D\\) in plane ( \\(A B C\\) ), and tetrahedron \\(A B C D\\) being sufficiently arbitrary that points \\(E_{1}\\) and \\(E_{2}\\) exist and points \\(D, E_{1}\\), and \\(E_{2}\\) are pairwise distinct) give a total of nine friendships.\n\nRemark (Author comments). It is natural to approach the problem by looking at the two-dimensional version first. In two dimensions, the following arrangement suggests itself almost immediately: We distribute all fireflies as equally as possible among two parallel lines, and two fireflies are friends if and only if they are on different lines.\n\nSimilarly to the three-dimensional version, this attains the greatest possible number of friendships for all sufficiently large \\(n\\), though not for all \\(n\\). For instance, at least one friendlier arrangements exists for \\(n=4\\), similarly to the above friendlier arrangement for \\(n=5\\) in three dimensions.\n\nThis observation strongly suggests that in three dimensions we should distribute the fireflies as equally as possible among two parallel planes, and that two fireflies should be friends if and only if they are on different planes. It was a great surprise for me to discover that this arrangement does not in fact give the correct answer!\n\nRemark. On the other hand, Ankan Bhattacharya gives the following reasoning as to why the answer should not be that surprising:\n\nI think the answer \\(\\left(10^{14}-1\\right) / 3\\) is quite natural if you realize that \\((n / 2)^{2}\\) is probably optimal in 2D and \\(\\binom{n}{2}\\) is optimal in super high dimensions (i.e. around \\(n\\) ). So going from dimension 2 to 3 should increase the answer (and indeed it does).", "source_pdf": "TSTST_2020.pdf", "notes": ""}
{"id": "TSTST-2022-1", "contest": "TSTST", "year": "2022", "problem_number": "1", "problem": "Let \\(n\\) be a positive integer. Find the smallest positive integer \\(k\\) such that for any set \\(S\\) of \\(n\\) points in the interior of the unit square, there exists a set of \\(k\\) rectangles such that the following hold:\n- The sides of each rectangle are parallel to the sides of the unit square.\n- Each point in \\(S\\) is not in the interior of any rectangle.\n- Each point in the interior of the unit square but not in \\(S\\) is in the interior of at least one of the \\(k\\) rectangles.\n(The interior of a polygon does not contain its boundary.)", "solution": "We give the author's solution. In terms of \\(n\\), we wish find the smallest integer \\(k\\) for which \\((0,1)^{2} \\backslash S\\) is always a union of \\(k\\) open rectangles for every set \\(S \\subset(0,1)^{2}\\) of size \\(n\\).\n\nWe claim the answer is \\(k=2 n+2\\).\nThe lower bound is given by picking\n\\[\nS=\\left\\{\\left(s_{1}, s_{1}\\right),\\left(s_{2}, s_{2}\\right), \\ldots,\\left(s_{n}, s_{n}\\right)\\right\\}\n\\]\nfor some real numbers \\(0<s_{1}<s_{2}<\\cdots<s_{n}<1\\). Consider the \\(4 n\\) points\n\\[\nS^{\\prime}=S+\\{(\\varepsilon, 0),(0, \\varepsilon),(-\\varepsilon, 0),(0,-\\varepsilon)\\} \\subset(0,1)^{2}\n\\]\nfor some sufficiently small \\(\\varepsilon>0\\). The four rectangles covering each of\n\\[\n\\left(s_{1}-\\varepsilon, s_{1}\\right),\\left(s_{1}, s_{1}-\\varepsilon\\right),\\left(s_{n}+\\varepsilon, s_{n}\\right),\\left(s_{n}, s_{n}+\\varepsilon\\right)\n\\]\ncannot cover any other points in \\(S^{\\prime}\\); all other rectangles can only cover at most 2 points in \\(S^{\\prime}\\), giving a bound of\n\\[\nk \\geq 4+\\frac{\\left|S^{\\prime}\\right|-4}{2}=2 n+2 .\n\\]\n\nTo prove that \\(2 n+2\\) rectangles are sufficient, assume that the number of distinct \\(y\\)-coordinates is at least the number of distinct \\(x\\)-coordinates. Let\n\\[\n0=x_{0}<x_{1}<\\cdots<x_{m}<x_{m+1}=1,\n\\]\nwhere \\(x_{1}, \\ldots, x_{m}\\) are the distinct \\(x\\)-coordinates of points in \\(S\\), and let \\(Y_{i}\\) be the set of \\(y\\)-coordinates of points with \\(x\\)-coordinate \\(x_{i}\\). For each \\(1 \\leq i \\leq m\\), include the \\(\\left|Y_{i}\\right|+1\\) rectangles\n\\[\n\\left(x_{i-1}, x_{i+1}\\right) \\times\\left((0,1) \\backslash Y_{i}\\right)\n\\]\nin the union, and also include \\(\\left(0, x_{1}\\right) \\times(0,1)\\) and \\(\\left(x_{m}, 1\\right) \\times(0,1)\\); this uses \\(m+n+2\\) rectangles.\n\nAll remaining uncovered points are between pairs of points with the same \\(y\\)-coordinate and adjacent \\(x\\)-coordinates \\(\\left\\{x_{i}, x_{i+1}\\right\\}\\). There are at most \\(n-m\\) such pairs by the initial assumption, so covering the points between each pair with\n\\[\n\\left(x_{i}, x_{i+1}\\right) \\times(y-\\varepsilon, y+\\varepsilon)\n\\]\nfor some sufficiently small \\(\\varepsilon>0\\) gives a total of\n\\[\n(m+n+2)+(n-m)=2 n+2\n\\]\nrectangles.", "source_pdf": "TSTST_2022.pdf", "notes": ""}
{"id": "TSTST-2022-2", "contest": "TSTST", "year": "2022", "problem_number": "2", "problem": "Let \\(A B C\\) be a triangle. Let \\(\\theta\\) be a fixed angle for which\n\\[\n\\theta<\\frac{1}{2} \\min (\\angle A, \\angle B, \\angle C)\n\\]\n\nPoints \\(S_{A}\\) and \\(T_{A}\\) lie on segment \\(B C\\) such that \\(\\angle B A S_{A}=\\angle T_{A} A C=\\theta\\). Let \\(P_{A}\\) and \\(Q_{A}\\) be the feet from \\(B\\) and \\(C\\) to \\(\\overline{A S_{A}}\\) and \\(\\overline{A T_{A}}\\) respectively. Then \\(\\ell_{A}\\) is defined as the perpendicular bisector of \\(\\overline{P_{A} Q_{A}}\\).\n\nDefine \\(\\ell_{B}\\) and \\(\\ell_{C}\\) analogously by repeating this construction two more times (using the same value of \\(\\theta)\\). Prove that \\(\\ell_{A}, \\ell_{B}\\), and \\(\\ell_{C}\\) are concurrent or all parallel.", "solution": "We discard the points \\(S_{A}\\) and \\(T_{A}\\) since they are only there to direct the angles correctly in the problem statement.\n\nIf First solution, by author. Let \\(X\\) be the projection from \\(C\\) to \\(A P_{A}, Y\\) be the projection from \\(B\\) to \\(A Q_{A}\\).\n\nClaim - Line \\(\\ell_{A}\\) passes through \\(M_{A}\\), the midpoint of \\(B C\\). Also, quadrilateral \\(P_{A} Q_{A} Y X\\) is cyclic with circumcenter \\(M_{A}\\).\n\nProof. Since\n\\[\nA P_{A} \\cdot A X=A B \\cdot A C \\cdot \\cos \\theta \\cos (\\angle A-\\theta)=A Q_{A} \\cdot A Y\n\\]\nit follows that \\(P_{A}, Q_{A}, Y, X\\) are concyclic by power of a point. Moreover, by projection, the perpendicular bisector of \\(P_{A} X\\) passes through \\(M_{A}\\), similar for \\(Q_{A} Y\\), implying that \\(M_{A}\\) is the center of \\(P_{A} Q_{A} Y X\\). Hence \\(\\ell_{A}\\) passes through \\(M_{A}\\).\n\nClaim \\(-\\measuredangle\\left(M_{A} M_{C}, \\ell_{A}\\right)=\\measuredangle Y P_{A} Q_{A}\\).\nProof. Indeed, \\(\\ell_{A} \\perp P_{A} Q_{A}\\), and \\(M_{A} M_{C} \\perp P_{A} Y\\) (since \\(M_{A} P_{A}=M_{A} Y\\) from \\(\\left(P_{A} Q_{A} Y_{A} X\\right)\\) and \\(M_{C} P_{A}=M_{C} M_{A}=M_{C} Y\\) from the circle with diameter \\(A B\\) ). Hence \\(\\measuredangle\\left(M_{A} M_{C}, \\ell_{A}\\right)= \\measuredangle\\left(P_{A} Y, P_{A} Q_{A}\\right)=\\measuredangle Y P_{A} Q_{A}\\).\n\nTherefore,\n\\[\n\\frac{\\sin \\angle\\left(M_{A} M_{C}, \\ell_{A}\\right)}{\\sin \\angle\\left(\\ell_{A}, M_{A} M_{B}\\right)}=\\frac{\\sin \\angle Y P_{A} Q_{A}}{\\sin \\angle P_{A} Q_{A} X}=\\frac{Y Q_{A}}{X P_{A}}=\\frac{B C \\sin (\\angle C+\\theta)}{B C \\sin (\\angle B+\\theta)}=\\frac{\\sin (\\angle C+\\theta)}{\\sin (\\angle B+\\theta)},\n\\]\nand we conclude by trig Ceva theorem.\n\nSecond solution via Jacobi, by Maxim Li. Let \\(D\\) be the foot of the \\(A\\)-altitude. Note that line \\(B C\\) is the external angle bisector of \\(\\angle P_{A} D Q_{A}\\).\n\nClaim - \\(\\left(D P_{A} Q_{A}\\right)\\) passes through the midpoint \\(M_{A}\\) of \\(B C\\).\n\nProof. Perform \\(\\sqrt{b c}\\) inversion. Then the intersection of \\(B C\\) and ( \\(D P_{A} Q_{A}\\) ) maps to the second intersection of \\((A B C)\\) and \\(\\left(A^{\\prime} P_{A} Q_{A}\\right)\\), where \\(A^{\\prime}\\) is the antipode to \\(A\\) on \\((A B C)\\), i.e. the center of spiral similarity from \\(B C\\) to \\(P_{A} Q_{A}\\). Since \\(B P_{A}: C Q_{A}=A B: A C\\), we see the center of spiral similarity is the intersection of the \\(A\\)-symmedian with ( \\(A B C\\) ), which is the image of \\(M_{A}\\) in the inversion.\n\nIt follows that \\(M_{A}\\) lies on \\(\\ell_{A}\\); we need to identify a second point. We'll use the circumcenter \\(O_{A}\\) of ( \\(D P_{A} Q_{A}\\) ). The perpendicular bisector of \\(D P_{A}\\) passes through \\(M_{C}\\); indeed, we can easily show the angle it makes with \\(M_{C} M_{A}\\) is \\(90^{\\circ}-\\theta-C\\), so \\(\\angle O_{A} M_{C} M_{A}=90-\\theta-C\\), and then by analogous angle-chasing we can finish with Jacobi's theorem on \\(\\triangle M_{A} M_{B} M_{C}\\).", "source_pdf": "TSTST_2022.pdf", "notes": ""}
{"id": "TSTST-2022-3", "contest": "TSTST", "year": "2022", "problem_number": "3", "problem": "Determine all positive integers \\(N\\) for which there exists a strictly increasing sequence of positive integers \\(s_{0}<s_{1}<s_{2}<\\cdots\\) satisfying the following properties:\n- the sequence \\(s_{1}-s_{0}, s_{2}-s_{1}, s_{3}-s_{2}, \\ldots\\) is periodic; and\n- \\(s_{s_{n}}-s_{s_{n-1}} \\leq N<s_{1+s_{n}}-s_{s_{n-1}}\\) for all positive integers \\(n\\).", "solution": "Answer. All \\(N\\) such that \\(t^{2} \\leq N<t^{2}+t\\) for some positive integer \\(t\\).\nSolution 1 (local). If \\(t^{2} \\leq N<t^{2}+t\\) then the sequence \\(s_{n}=t n+1\\) satisfies both conditions. It remains to show that no other values of \\(N\\) work.\n\nDefine \\(a_{n}:=s_{n}-s_{n-1}\\), and let \\(p\\) be the minimal period of \\(\\left\\{a_{n}\\right\\}\\). For each \\(k \\in \\mathbb{Z}_{\\geq 0}\\), let \\(f(k)\\) be the integer such that\n\\[\ns_{f(k)}-s_{k} \\leq N<s_{f(k)+1}-s_{k}\n\\]\n\nNote that \\(f\\left(s_{n-1}\\right)=s_{n}\\) for all \\(n\\). Since \\(\\left\\{a_{n}\\right\\}\\) is periodic with period \\(p, f(k+p)=f(k)+p\\) for all \\(k\\), so \\(k \\mapsto f(k)-k\\) is periodic with period \\(p\\). We also note that \\(f\\) is nondecreasing: if \\(k<k^{\\prime}\\) but \\(f\\left(k^{\\prime}\\right)<f(k)\\) then\n\\[\nN<s_{f\\left(k^{\\prime}\\right)+1}-s_{k^{\\prime}}<s_{f(k)}-s_{k} \\leq N,\n\\]\nwhich is absurd. We now claim that\n\\[\n\\max _{k}(f(k)-k)<p+\\min _{k}(f(k)-k) .\n\\]\n\nIndeed, if \\(f\\left(k^{\\prime}\\right)-k^{\\prime} \\geq p+f(k)-k\\) then we can shift \\(k\\) and \\(k^{\\prime}\\) so that \\(0 \\leq k-k^{\\prime}<p\\), and it follows that \\(k \\leq k^{\\prime} \\leq f\\left(k^{\\prime}\\right)<f(k)\\), violating the fact that \\(f\\) is nondecreasing. Therefore \\(\\max _{k}(f(k)-k)<p+\\min _{k}(f(k)-k)\\), so \\(f(k)-k\\) is uniquely determined by its value modulo \\(p\\). In particular, since \\(a_{n}=f\\left(s_{n-1}\\right)-s_{n-1}, a_{n}\\) is also uniquely determined by its value modulo \\(p\\), so \\(\\left\\{a_{n} \\bmod p\\right\\}\\) also has minimal period \\(p\\).\n\nNow work in \\(\\mathbb{Z} / p \\mathbb{Z}\\) and consider the sequence \\(s_{0}, f\\left(s_{0}\\right), f\\left(f\\left(s_{0}\\right)\\right), \\ldots\\) This sequence must be eventually periodic; suppose it has minimal period \\(p^{\\prime}\\), which must be at most \\(p\\). Then, since\n\\[\nf^{n}\\left(s_{0}\\right)-f^{n-1}\\left(s_{0}\\right)=s_{n}-s_{n-1}=a_{n},\n\\]\nand \\(\\left\\{a_{n} \\bmod p\\right\\}\\) has minimal period \\(p\\), we must have \\(p^{\\prime}=p\\). Therefore the directed graph \\(G\\) on \\(\\mathbb{Z} / p \\mathbb{Z}\\) given by the edges \\(k \\rightarrow f(k)\\) is simply a \\(p\\)-cycle, which implies that the map \\(k \\mapsto f(k)\\) is a bijection on \\(\\mathbb{Z} / p \\mathbb{Z}\\). Therefore, \\(f(k+1) \\neq f(k)\\) for all \\(k\\) (unless \\(p=1\\), but in this case the following holds anyways), hence\n\\[\nf(k)<f(k+1)<\\cdots<f(k+p)=f(k)+p .\n\\]\n\nThis implies \\(f(k+1)=f(k)+1\\) for all \\(k\\), so \\(f(k)-k\\) is constant, therefore \\(a_{n}= f\\left(s_{n-1}\\right)-s_{n-1}\\) is also constant. Let \\(a_{n} \\equiv t\\). It follows that \\(t^{2} \\leq N<t^{2}+t\\) as we wanted.\n\nSolution 2 (global). Define \\(\\left\\{a_{n}\\right\\}\\) and \\(f\\) as in the previous solution. We first show that \\(s_{i} \\not \\equiv s_{j}(\\bmod p)\\) for all \\(i<j<i+p\\). Suppose the contrary, i.e. that \\(s_{i} \\equiv s_{j} (\\bmod p)\\) for some \\(i, j\\) with \\(i<j<i+p\\). Then \\(a_{s_{i}+k}=a_{s_{j}+k}\\) for all \\(k \\geq 0\\), therefore \\(s_{s_{i}+k}-s_{s_{i}}=s_{s_{j}+k}-s_{s_{j}}\\) for all \\(k \\geq 0\\), therefore\n\\[\na_{i+1}=f\\left(s_{i}\\right)-s_{i}=f\\left(s_{j}\\right)-s_{j}=a_{j+1} \\quad \\text { and } \\quad s_{i+1}=f\\left(s_{i}\\right) \\equiv f\\left(s_{j}\\right)=s_{j+1} \\quad(\\bmod p)\n\\]\n\nContinuing this inductively, we obtain \\(a_{i+k}=a_{j+k}\\) for all \\(k\\), so \\(\\left\\{a_{n}\\right\\}\\) has period \\(j-i<p\\), which is a contradiction. Therefore \\(s_{i} \\not \\equiv s_{j}(\\bmod p)\\) for all \\(i<j<i+p\\), and this implies that \\(\\left\\{s_{i}, \\ldots, s_{i+p-1}\\right\\}\\) forms a complete residue system modulo \\(p\\) for all \\(i\\). Consequently we must have \\(s_{i+p} \\equiv s_{i}(\\bmod p)\\) for all \\(i\\).\n\nLet \\(T=s_{p}-s_{0}=a_{1}+\\cdots+a_{p}\\). Since \\(\\left\\{a_{n}\\right\\}\\) is periodic with period \\(p\\), and \\(\\{i+1, \\ldots, i+k p\\}\\) contains exactly \\(k\\) values of each residue class modulo \\(p\\),\n\\[\ns_{i+k p}-s_{i}=a_{i+1}+\\cdots+a_{i+k p}=k T\n\\]\nfor all \\(i, k\\). Since \\(p \\mid T\\), it follows that \\(s_{s_{p}}-s_{s_{0}}=\\frac{T}{p} \\cdot T=\\frac{T^{2}}{p}\\). Summing up the inequalities\n\\[\ns_{s_{n}}-s_{s_{n-1}} \\leq N<s_{s_{n}+1}-s_{s_{n-1}}=s_{s_{n}}-s_{s_{n-1}}+a_{s_{n}+1}\n\\]\nfor \\(n \\in\\{1, \\ldots, p\\}\\) then implies\n\\[\n\\frac{T^{2}}{p}=s_{s_{p}}-s_{s_{0}} \\leq N p<\\frac{T^{2}}{p}+a_{s_{1}+1}+a_{s_{2}+1}+\\cdots+a_{s_{p}+1}=\\frac{T^{2}}{p}+T\n\\]\nwhere the last equality holds because \\(\\left\\{s_{1}+1, \\ldots, s_{p}+1\\right\\}\\) is a complete residue system modulo \\(p\\). Dividing this by \\(p\\) yields \\(t^{2} \\leq N<t^{2}+t\\) for \\(t:=\\frac{T}{p} \\in \\mathbb{Z}^{+}\\).\n\nRemark (Author comments). There are some similarities between this problem and IMO \\(2009 / 3\\), mainly that they both involve terms of the form \\(s_{s_{n}}\\) and \\(s_{s_{n}+1}\\) and the sequence \\(s_{0}, s_{1}, \\ldots\\) turns out to be an arithmetic progression. Other than this, I don't think knowing about IMO \\(2009 / 3\\) will be that useful on this problem, since in this problem the fact that \\(\\left\\{s_{n+1}-s_{n}\\right\\}\\) is periodic is fundamentally important.\n\nThe motivation for this problem comes from the following scenario: assume we have boxes that can hold some things of total size \\(\\leq N\\), and a sequence of things of size \\(a_{1}, a_{2}, \\ldots\\) (where \\(a_{i}:=s_{i+1}-s_{i}\\) ). We then greedily pack the things in a sequence of boxes, 'closing' each box when it cannot fit the next thing. The number of things we put in each box gives a sequence \\(b_{1}, b_{2}, \\ldots\\). This problem asks when we can have \\(\\left\\{a_{n}\\right\\}=\\left\\{b_{n}\\right\\}\\), assuming that we start with a sequence \\(\\left\\{a_{n}\\right\\}\\) that is periodic.\n(Extra motivation: I first thought about this scenario when I was pasting some text repeatedly into the Notes app and noticed that the word at the end of lines are also (eventually) periodic.)", "source_pdf": "TSTST_2022.pdf", "notes": ""}
{"id": "TSTST-2022-4", "contest": "TSTST", "year": "2022", "problem_number": "4", "problem": "A function \\(f: \\mathbb{N} \\rightarrow \\mathbb{N}\\) has the property that for all positive integers \\(m\\) and \\(n\\), exactly one of the \\(f(n)\\) numbers\n\\[\nf(m+1), f(m+2), \\ldots, f(m+f(n))\n\\]\nis divisible by \\(n\\). Prove that \\(f(n)=n\\) for infinitely many positive integers \\(n\\).", "solution": "We start with the following claim:\nClaim - If \\(a \\mid b\\) then \\(f(a) \\mid f(b)\\).\n\nProof. From applying the condition with \\(n=a\\), we find that the set \\(S_{a}=\\{n \\geq 2\\) : \\(a \\mid f(n)\\}\\) is an arithmetic progression with common difference \\(f(a)\\). Similarly, the set \\(S_{b}=\\{n \\geq 2: b \\mid f(n)\\}\\) is an arithmetic progression with common difference \\(f(b)\\). From \\(a \\mid b\\) it follows that \\(S_{b} \\subseteq S_{a}\\). Because an arithmetic progression with common difference \\(x\\) can only be contained in an arithmetic progression with common difference \\(y\\) if \\(y \\mid x\\), we conclude \\(f(a) \\mid f(b)\\).\n\nIn what follows, let \\(a \\geq 2\\) be any positive integer. Because \\(f(a)\\) and \\(f(2 a)\\) are both divisible by \\(f(a)\\), there are \\(a+1\\) consecutive values of \\(f\\) of which at least two divisible by \\(f(a)\\). It follows that \\(f(f(a)) \\leq a\\).\n\nHowever, we also know that exactly one of \\(f(2), f(3), \\ldots, f(1+f(a))\\) is divisible by \\(a\\); let this be \\(f(t)\\). Then we have \\(S_{a}=\\{t, t+f(a), t+2 f(a), \\ldots\\}\\). Because \\(a|f(t)| f(2 t)\\), we know that \\(2 t \\in S_{a}\\), so \\(t\\) is a multiple of \\(f(a)\\). Because \\(2 \\leq t \\leq 1+f(a)\\), and \\(f(a) \\geq 2\\) for \\(a \\geq 2\\), we conclude that we must have \\(t=f(a)\\), so \\(f(f(a))\\) is a multiple of \\(a\\). Together with \\(f(f(a)) \\leq a\\), this yields \\(f(f(a))=a\\). Because \\(f(f(a))=a\\) also holds for \\(a=1\\) (from the given condition for \\(n=1\\) it immediately follows that \\(f(1)=1\\) ), we conclude that \\(f(f(a))=a\\) for all \\(a\\), and hence \\(f\\) is a bijection.\n\nMoreover, we now have that \\(f(a) \\mid f(b)\\) implies \\(f(f(a)) \\mid f(f(b))\\), i.e. \\(a \\mid b\\), so \\(a \\mid b\\) if and only if \\(f(a) \\mid f(b)\\). Together with the fact that \\(f\\) is a bijection, this implies that \\(f(n)\\) has the same number of divisors of \\(n\\). Let \\(p\\) be a prime. Then \\(f(p)=q\\) must be a prime as well. If \\(q \\neq p\\), then from \\(f(p) \\mid f(p q)\\) and \\(f(q) \\mid f(p q)\\) it follows that \\(p q \\mid f(p q)\\), so \\(f(p q)=p q\\) because \\(f(p q)\\) and \\(p q\\) must have the same number of divisors. Therefore, for every prime number \\(p\\) we either have that \\(f(p)=p\\) or \\(f(p f(p))=p f(p)\\). From here, it is easy to see that \\(f(n)=n\\) for infinitely many \\(n\\).", "source_pdf": "TSTST_2022.pdf", "notes": ""}
{"id": "TSTST-2022-5", "contest": "TSTST", "year": "2022", "problem_number": "5", "problem": "Let \\(A_{1}, \\ldots, A_{2022}\\) be the vertices of a regular 2022-gon in the plane. Alice and Bob play a game. Alice secretly chooses a line and colors all points in the plane on one side of the line blue, and all points on the other side of the line red. Points on the line are colored blue, so every point in the plane is either red or blue. (Bob cannot see the colors of the points.)\n\nIn each round, Bob chooses a point in the plane (not necessarily among \\(A_{1}, \\ldots\\), \\(A_{2022}\\) ) and Alice responds truthfully with the color of that point. What is the smallest number \\(Q\\) for which Bob has a strategy to always determine the colors of points \\(A_{1}, \\ldots, A_{2022}\\) in \\(Q\\) rounds?", "solution": "The answer is 22 . To prove the lower bound, note that there are \\(2022 \\cdot 2021+2>2^{21}\\) possible colorings. If Bob makes less than 22 queries, then he can only output \\(2^{21}\\) possible colorings, which means he is wrong on some coloring.\n\nNow we show Bob can always win in 22 queries. A key observation is that the set of red points is convex, as is the set of blue points, so if a set of points is all the same color, then their convex hull is all the same color.\n\nLemma\n\nLet \\(B_{0}, \\ldots, B_{k+1}\\) be equally spaced points on a circular arc such that colors of \\(B_{0}\\) and \\(B_{k+1}\\) differ and are known. Then it is possible to determine the colors of \\(B_{1}\\), \\(\\ldots, B_{k}\\) in \\(\\left\\lceil\\log _{2} k\\right\\rceil\\) queries.\n\nProof. There exists some \\(0 \\leq i \\leq k\\) such that \\(B_{0}, \\ldots, B_{i}\\) are the same color and \\(B_{i+1}\\), \\(\\ldots, B_{k+1}\\) are the same color. (If \\(i<j\\) and \\(B_{0}\\) and \\(B_{j}\\) were red and \\(B_{i}\\) and \\(B_{k+1}\\) were blue, then segment \\(B_{0} B_{j}\\) is red and segment \\(B_{i} B_{k+1}\\) is blue, but they intersect). Therefore we can binary search.\n\nLemma\n\nLet \\(B_{0}, \\ldots, B_{k+1}\\) be equally spaced points on a circular arc such that colors of \\(B_{0}\\), \\(B_{\\lceil k / 2\\rceil}, B_{k+1}\\) are both red and are known. Then at least one of the following holds: all of \\(B_{1}, \\ldots, B_{\\lceil k / 2\\rceil}\\) are red or all of \\(B_{\\lceil k / 2\\rceil}, \\ldots, B_{k}\\) are red. Furthermore, in one query we can determine which one of the cases holds.\n\nProof. The existence part holds for similar reason to previous lemma. To figure out which case, choose a point \\(P\\) such that all of \\(B_{0}, \\ldots, B_{k+1}\\) lie between rays \\(P B_{0}\\) and \\(P B_{\\lceil k / 2\\rceil}\\), and such that \\(B_{1}, \\ldots, B_{\\lceil k / 2\\rceil-1}\\) lie inside triangle \\(P B_{0} B_{\\lceil k / 2\\rceil}\\) and such that \\(B_{\\lceil k / 2\\rceil+1}, \\ldots, B_{k+1}\\) lie outside (this point should always exist by looking around the intersections of lines \\(B_{0} B_{1}\\) and \\(B_{\\lceil k / 2\\rceil-1} B_{\\lceil k / 2\\rceil}\\) ). Then if \\(P\\) is red, all the inside points are red because they lie in the convex hull of red points \\(P, B_{0}, B_{\\lceil k / 2\\rceil}\\). If \\(P\\) is blue, then all the outside points are red: if \\(B_{i}\\) were blue for \\(i>\\lceil k / 2\\rceil\\), then the segment \\(P B_{i}\\) is blue and intersect the segment \\(B_{0} B_{\\lceil k / 2\\rceil}\\), which is red, contradiction.\n\nNow the strategy is: Bob picks \\(A_{1}\\). WLOG it is red. Now suppose Bob does not know the colors of \\(\\leq 2^{k}-1\\) points \\(A_{i}, \\ldots, A_{j}\\) with \\(j-i+1 \\leq 2^{k}-1\\) and knows the rest are red. I claim Bob can win in \\(2 k-1\\) queries. First, if \\(k=1\\), there is one point and he wins by querying the point, so the base case holds, so assume \\(k>1\\). Bob queries \\(A_{i+\\lceil(j-i+1) / 2\\rceil}\\). If it is blue, he finishes in \\(2 \\log _{2}\\lceil(j-i+1) / 2\\rceil \\leq 2(k-1)\\) queries by the first lemma, for a total of \\(2 k-1\\) queries. If it is red, he can query one more point and learn some half of \\(A_{i}, \\ldots, A_{j}\\) that are red by the second lemma, and then he has reduced it to the case with \\(\\leq 2^{k-1}-1\\) points in two queries, at which point we induct.", "source_pdf": "TSTST_2022.pdf", "notes": ""}
{"id": "TSTST-2022-6", "contest": "TSTST", "year": "2022", "problem_number": "6", "problem": "Let \\(O\\) and \\(H\\) be the circumcenter and orthocenter, respectively, of an acute scalene triangle \\(A B C\\). The perpendicular bisector of \\(\\overline{A H}\\) intersects \\(\\overline{A B}\\) and \\(\\overline{A C}\\) at \\(X_{A}\\) and \\(Y_{A}\\) respectively. Let \\(K_{A}\\) denote the intersection of the circumcircles of triangles \\(O X_{A} Y_{A}\\) and \\(B O C\\) other than \\(O\\).\n\nDefine \\(K_{B}\\) and \\(K_{C}\\) analogously by repeating this construction two more times. Prove that \\(K_{A}, K_{B}, K_{C}\\), and \\(O\\) are concyclic.", "solution": "We present several approaches.\n\nIf First solution, by author. Let \\(\\odot O X_{A} Y_{A}\\) intersects \\(A B, A C\\) again at \\(U, V\\). Then by Reim's theorem \\(U V C B\\) are concyclic. Hence the radical axis of \\(\\odot O X_{A} Y_{A}, \\odot O B C\\) and \\(\\odot(U V C B)\\) are concurrent, i.e. \\(O K_{A}, B C, U V\\) are concurrent, Denote the intersection as \\(K_{A}^{*}\\), which is indeed the inversion of \\(K_{A}\\) with respect to \\(\\odot O\\). (The inversion sends \\(\\odot O B C\\) to the line \\(B C\\) ).\n\nLet \\(P_{A}, P_{B}, P_{C}\\) be the circumcenters of \\(\\triangle O B C, \\triangle O C A, \\triangle O A B\\) respectively.\nClaim \\(-K_{A}^{*}\\) coincides with the intersection of \\(P_{B} P_{C}\\) and \\(B C\\).\n\nProof. Note that \\(d(O, B C)=1 / 2 A H=d\\left(A, X_{A} Y_{A}\\right)\\). This means the midpoint \\(M_{C}\\) of \\(A B\\) is equal distance to \\(X_{A} Y_{A}\\) and the line through \\(O\\) parallel to \\(B C\\). Together with \\(O M_{C} \\perp A B\\) implies that \\(\\angle M_{C} X_{A} O=\\angle B\\). Hence \\(\\angle U V O=\\angle B=\\angle A V U\\). Similarly \\(\\angle V U O=\\angle A U V\\), hence \\(\\triangle A U V \\simeq \\triangle O U V\\). In other words, \\(U V\\) is the perpendicular bisector of \\(A O\\), which pass through \\(P_{B}, P_{C}\\). Hence \\(K_{A}^{*}\\) is indeed \\(P_{B} P_{C} \\cap B C\\).\n\nFinally by Desargue's theorem, it suffices to show that \\(A P_{A}, B P_{B}, C P_{C}\\) are concurrent. Note that\n\\[\n\\begin{aligned}\n& d\\left(P_{A}, A B\\right)=P_{A} B \\sin \\left(90^{\\circ}+\\angle C-\\angle A\\right) \\\\\n& d\\left(P_{A}, A C\\right)=P_{A} C \\sin \\left(90^{\\circ}+\\angle B-\\angle A\\right)\n\\end{aligned}\n\\]\n\nHence the symmetric product and trig Ceva finishes the proof.\n\nIf Second solution, from Jeffrey Kwan. Let \\(O_{A}\\) be the circumcenter of \\(\\triangle A X_{A} Y_{A}\\). The key claim is that:\n\nClaim \\(-O_{A} X_{A} Y_{A} O\\) is cyclic.\n\nProof. Let \\(D E F\\) be the orthic triangle; we will show that \\(\\triangle O X_{A} Y_{A} \\sim \\triangle D E F\\). Indeed, since \\(A O\\) and \\(A D\\) are isogonal, it suffices to note that\n\\[\n\\frac{A X_{A}}{A B}=\\frac{A H / 2}{A D}=\\frac{R \\cos A}{A D},\n\\]\nand so\n\\[\n\\frac{A O}{A D}=R \\cdot \\frac{A X_{A}}{A B \\cdot R \\cos A}=\\frac{A X_{A}}{A E}=\\frac{A Y_{A}}{A F}\n\\]\n\nHence \\(\\angle X_{A} O Y_{A}=180^{\\circ}-2 \\angle A=180^{\\circ}-\\angle X_{A} O_{A} Y_{A}\\), which proves the claim.\nLet \\(P_{A}\\) be the circumcenter of \\(\\triangle O B C\\), and define \\(P_{B}, P_{C}\\) similarly. By the claim, \\(A\\) is the exsimilicenter of \\(\\left(O X_{A} Y_{A}\\right)\\) and \\((O B C)\\), so \\(A P_{A}\\) is the line between their two centers. In particular, \\(A P_{A}\\) is the perpendicular bisector of \\(O K_{A}\\).\n\nClaim \\(-A P_{A}, B P_{B}, C P_{C}\\) concur at \\(T\\).\n\nProof. The key observation is that \\(O\\) is the incenter of \\(\\triangle P_{A} P_{B} P_{C}\\), and that \\(A, B, C\\) are the reflections of \\(O\\) across the sides of \\(\\triangle P_{A} P_{B} P_{C}\\). Hence \\(P_{A} A, P_{B} B, P_{C} C\\) concur by Jacobi.\n\nNow \\(T\\) lies on the perpendicular bisectors of \\(O K_{A}, O K_{B}\\), and \\(O K_{C}\\). Hence \\(O K_{A} K_{B} K_{C}\\) is cyclic with center \\(T\\), as desired.", "source_pdf": "TSTST_2022.pdf", "notes": ""}
{"id": "TSTST-2022-7", "contest": "TSTST", "year": "2022", "problem_number": "7", "problem": "Let \\(A B C D\\) be a parallelogram. Point \\(E\\) lies on segment \\(C D\\) such that\n\\[\n2 \\angle A E B=\\angle A D B+\\angle A C B\n\\]\nand point \\(F\\) lies on segment \\(B C\\) such that\n\\[\n2 \\angle D F A=\\angle D C A+\\angle D B A\n\\]\n\nLet \\(K\\) be the circumcenter of triangle \\(A B D\\). Prove that \\(K E=K F\\).", "solution": "Let the circle through \\(A, B\\), and \\(E\\) intersect \\(C D\\) again at \\(E^{\\prime}\\), and let the circle through \\(D\\), \\(A\\), and \\(F\\) intersect \\(B C\\) again at \\(F^{\\prime}\\). Now \\(A B E E^{\\prime}\\) and \\(D A F^{\\prime} F\\) are cyclic quadrilaterals with two parallel sides, so they are isosceles trapezoids. From \\(K A=K B\\), it now follows that \\(K E=K E^{\\prime}\\), whereas from \\(K A=K D\\) it follows that \\(K F=K F^{\\prime}\\).\n\nNext, let the circle through \\(A, B\\), and \\(E\\) intersect \\(A C\\) again at \\(S\\). Then\n\\[\n\\angle A S B=\\angle A E B=\\frac{1}{2}(\\angle A D B+\\angle A C B)=\\frac{1}{2}(\\angle A D B+\\angle D A C)=\\frac{1}{2} \\angle A M B,\n\\]\nwhere \\(M\\) is the intersection of \\(A C\\) and \\(B D\\). From \\(\\angle A S B=\\frac{1}{2} \\angle A M B\\), it follows that \\(M S=M B=M D\\). By symmetry, the circle through \\(A, D\\), and \\(F\\) also passes through \\(S\\), and it follows that the line \\(A S\\) is the radical axis of the circles ( \\(A B E\\) ) and ( \\(A D F\\) ).\n\nBy power of a point, we now obtain\n\\[\nC E \\cdot C E^{\\prime}=C S \\cdot C A=C F \\cdot C F^{\\prime},\n\\]\nfrom which it follows that \\(E, F, E^{\\prime}\\), and \\(F^{\\prime}\\) are concyclic. The segments \\(E E^{\\prime}\\) and \\(F F^{\\prime}\\) are not parallel, so their perpendicular bisectors only meet at one point, which is \\(K\\). Hence \\(K E=K F\\).", "source_pdf": "TSTST_2022.pdf", "notes": ""}
{"id": "TSTST-2022-8", "contest": "TSTST", "year": "2022", "problem_number": "8", "problem": "Find all functions \\(f: \\mathbb{N} \\rightarrow \\mathbb{Z}\\) such that\n\\[\n\\left\\lfloor\\frac{f(m n)}{n}\\right\\rfloor=f(m)\n\\]\nfor all positive integers \\(m, n\\).", "solution": "There are two families of functions that work: for each \\(\\alpha \\in \\mathbb{R}\\) the function \\(f(n)=\\lfloor\\alpha n\\rfloor\\), and for each \\(\\alpha \\in \\mathbb{R}\\) the function \\(f(n)=\\lceil\\alpha n\\rceil-1\\). (For irrational \\(\\alpha\\) these two functions coincide.) It is straightforward to check that these functions indeed work; essentially, this follows from the identity\n\\[\n\\left\\lfloor\\frac{\\lfloor x n\\rfloor}{n}\\right\\rfloor=\\lfloor x\\rfloor\n\\]\nwhich holds for all positive integers \\(n\\) and real numbers \\(x\\).\nWe now show that every function that works must be of one of the above forms. Let \\(f\\) be a function that works, and define the sequence \\(a_{1}, a_{2}, \\ldots\\) by \\(a_{n}=f(n!) / n!\\). Applying the give condition with ( \\(n!, n+1\\) ) yields \\(a_{n+1} \\in\\left[a_{n}, a_{n}+\\frac{1}{n!}\\right)\\). It follows that the sequence \\(a_{1}, a_{2}, \\ldots\\) is non-decreasing and bounded from above by \\(a_{1}+e\\), so this sequence must converge to some limit \\(\\alpha\\).\n\nIf there exists a \\(k\\) such that \\(a_{k}=\\alpha\\), then we have \\(a_{\\ell}=\\alpha\\) for all \\(\\ell>k\\). For each positive integer \\(m\\), there exists \\(\\ell>k\\) such that \\(m \\mid \\ell!\\). Plugging in \\(m n=\\ell!\\), it then follows that\n\\[\nf(m)=\\left\\lfloor\\frac{f(\\ell!)}{\\ell!/ m}\\right\\rfloor=\\lfloor\\alpha m\\rfloor\n\\]\nfor all \\(m\\), so \\(f\\) is of the desired form.\nIf there does not exist a \\(k\\) such that \\(a_{k}=\\alpha\\), we must have \\(a_{k}<\\alpha\\) for all \\(k\\). For each positive integer \\(m\\), we can now pick an \\(\\ell\\) such that \\(m \\mid \\ell!\\) and \\(a_{\\ell}=\\alpha-x\\) with \\(x\\) arbitrarily small. It then follows from plugging in \\(m n=\\ell!\\) that\n\\[\nf(m)=\\left\\lfloor\\frac{f(\\ell!)}{\\ell!/ m}\\right\\rfloor=\\left\\lfloor\\frac{\\ell!(\\alpha-x)}{\\ell!/ m}\\right\\rfloor=\\lfloor\\alpha m-m x\\rfloor\n\\]\n\nIf \\(\\alpha m\\) is an integer we can choose \\(\\ell\\) such that \\(m x<1\\), and it follows that \\(f(m)=\\lceil\\alpha m\\rceil-1\\). If \\(\\alpha m\\) is not an integer we can choose \\(\\ell\\) such that \\(m x<\\{\\alpha m\\}\\), and it also follows that \\(f(m)=\\lceil\\alpha m\\rceil-1\\). We conclude that in this case \\(f\\) is again of the desired form.", "source_pdf": "TSTST_2022.pdf", "notes": ""}
{"id": "TSTST-2022-9", "contest": "TSTST", "year": "2022", "problem_number": "9", "problem": "Let \\(k>1\\) be a fixed positive integer. Prove that if \\(n\\) is a sufficiently large positive integer, there exists a sequence of integers with the following properties:\n- Each element of the sequence is between 1 and \\(n\\), inclusive.\n- For any two different contiguous subsequences of the sequence with length between 2 and \\(k\\) inclusive, the multisets of values in those two subsequences is not the same.\n- The sequence has length at least \\(0.499 n^{2}\\).", "solution": "For any positive integer \\(n\\), define an ( \\(n, k\\) )-good sequence to be a finite sequence of integers each between 1 and \\(n\\) inclusive satisfying the second property in the problem statement. The problems asks to show that, for all sufficiently large integers \\(n\\), there is an ( \\(n, k\\) )-good sequence of length at least \\(0.499 n^{2}\\).\n\nFix \\(k \\geq 2\\) and consider some prime power \\(n=p^{m}\\) with \\(p>k+1\\). Consider some \\(0<g<\\frac{n}{k}-1\\) with \\(\\operatorname{gcd}(g, n)=1\\) and let \\(a\\) be the smallest positive integer with \\(g^{a} \\equiv \\pm 1 (\\bmod n)\\).\n\nClaim (Main claim) - For \\(k, n, g, a\\) defined as above, there is an \\((n, k)\\)-good sequence of length \\(a(n+2)+2\\).\n\nTo prove the main claim, we need some results about the structure of \\(\\mathbb{Z} / n \\mathbb{Z}\\). Specifically, we'll first show that any nontrivial arithmetic sequence is uniquely recoverable.\n\nLemma\n\nConsider any arithmetic progression of length \\(i \\leq k\\) whose common difference is relatively prime to \\(n\\), and let \\(S\\) be the set of residues it takes modulo \\(n\\). Then there exists a unique integer \\(0<d \\leq \\frac{n}{2}\\) and a unique integer \\(0 \\leq a<n\\) such that\n\\[\nS=\\{a, a+d, \\ldots, a+(i-1) d\\}\n\\]\n\nProof of lemma. We'll split into cases, based on if \\(i\\) is odd or not.\n- Case 1: \\(i\\) is odd, so \\(i=2 j+1\\) for some \\(j\\). Then the middle term of the arithmetic progression is the average of all residues in \\(S\\), which we can uniquely identify as some \\(u\\) (and we know \\(n\\) is coprime to \\(i\\), so it is possible to average the residues). We need to show that there is only one choice of \\(d\\), up to \\(\\pm\\), so that \\(S=\\{u- j d, u-(j-1) d, \\ldots, u+j d\\}\\).\nLet \\(X\\) be the sum of squares of the residues in \\(S\\), so we have\n\\[\nX \\equiv(u-j d)^{2}+(u-(j-1) d)^{2}+\\cdots+(u+j d)^{2}=(2 j+1) u^{2}+d^{2} \\frac{j(j+1)(2 j+1)}{3},\n\\]\nwhich therefore implies\n\\[\n3\\left(X-(2 j+1) u^{2}\\right)(j(j+1)(2 j+1))^{-1} \\equiv d^{2},\n\\]\nthus identifying \\(d\\) uniquely up to sign as desired.\n- Case 2: \\(i\\) is even, so \\(i=2 j\\) for some \\(j\\). Once again we can compute the average \\(u\\) of the residues in \\(S\\), and we need to show that there is only one choice of \\(d\\), up to \\(\\pm\\), so that \\(S=\\{u-(2 j-1) d, u-(2 j-3) d, \\ldots, u+(2 j-1) d\\}\\). Once again we compute the sum of squares \\(X\\) of the residues in \\(S\\), so that\n\\(X \\equiv(u-(2 j-1) d)^{2}+(u-(2 j-3) d)^{2}+\\cdots+(u+(2 j-1) d)^{2}=2 j u^{2}+\\frac{(2 j-1) 2 j(2 j+1)}{3}\\) which therefore implies\n\\[\n3\\left(X-2 j u^{2}\\right)((2 j-1) 2 j(2 j+1))^{-1} \\equiv d^{2},\n\\]\nagain identifying \\(d\\) uniquely up to sign as desired.\nThus we have shown that given the set of residues an arithmetic progression takes on modulo \\(n\\), we can recover that progression up to sign. Here we have used the fact that given \\(d^{2}(\\bmod n)\\), it is possible to recover \\(d\\) up to sign provided that \\(n\\) is of the form \\(p^{m}\\) with \\(p \\neq 2\\) and \\(\\operatorname{gcd}(d, n)=1\\).\n\nNow, we will proceed by chaining many arithmetic sequences together.\nDefinition. For any integer \\(l\\) between 0 and \\(a-1\\), inclusive, define \\(C_{l}\\) to be the sequence \\(0, g^{l}, g^{l}, 2 g^{l}, 3 g^{l}, \\ldots,(n-1) g^{l},(n-1) g^{l}\\) taken \\((\\bmod n)\\). (This is just a sequence where the \\(i\\) th term is \\((i-1) g^{l}\\), except the terms \\(g^{l},(n-1) g^{l}\\) is repeated once.)\n\nDefinition. Consider the sequence \\(S_{n}\\) of residues mod \\(n\\) defined as follows:\n- The first term of \\(S_{n}\\) is 0 .\n- For each \\(0 \\leq l<a\\), the next \\(n+2\\) terms of \\(S_{n}\\) are the terms of \\(C_{l}\\) in order.\n- The next and final term of \\(S_{n}\\) is 0 .\n\nWe claim that \\(S_{n}\\) constitutes a \\(k\\)-good string with respect to the alphabet of residues modulo \\(n\\). We first make some initial observations about \\(S_{n}\\).\n\nLemma\n\\(S_{n}\\) has the following properties:\n- \\(S_{n}\\) has length \\(a(n+2)+2\\).\n- If a contiguous subsequence of \\(S_{n}\\) of length \\(\\leq k\\) contains two of the same residue \\((\\bmod n)\\), those two residues occur consecutively in the subsequence.\n\nProof of lemma. The first property is clear since each \\(C_{l}\\) has length \\(n+2\\), and there are \\(a\\) of them, along with the 0s at beginning and end.\n\nTo prove the second property, consider any contiguous subsequence \\(S_{n}[i: i+k-1]\\) of length \\(k\\) which contains two of the same residue modulo \\(n\\). If \\(S_{n}[i: i+k-1]\\) is wholly contained within some \\(C_{l}\\), it's clear that the only way \\(S_{n}[i: i+k-1]\\) could repeat residues if it repeats one of the two consecutive values \\(g^{l}, g^{l}\\) or \\((n-1) g^{l},(n-1) g^{l}\\), so assume that is not the case.\n\nNow, it must be true that \\(S_{n}[i: i+k-1]\\) consists of one contiguous subsequence of the form\n\\[\n\\left(n-k_{1}\\right) g^{l-1},\\left(n-\\left(k_{1}-1\\right)\\right) g^{l-1}, \\ldots,(n-1) g^{l-1},(n-1) g^{l-1}\n\\]\nwhich are the portions of \\(S_{n}[i: i+k-1]\\) contained in \\(C_{l-1}\\), and then a second contiguous subsequence of the form\n\\[\n0, g^{l}, g^{l}, 2 g^{l}, \\ldots, k_{2} g^{l}\n\\]\nwhich are the portions of \\(S_{n}[i: i+k-1]\\) contained in \\(C_{l}\\), and we obviously have \\(k_{2}+k_{1}=k-3\\). For \\(S_{n}[i: i+k-1]\\) to contain two of the same residue in non-consecutive positions, there would have to exist some \\(0<u \\leq k_{1}, 0<v \\leq k_{2}\\) with \\((n-u) g^{l-1} \\equiv v g^{l} (\\bmod n)\\), meaning that \\(u+g v \\equiv 0(\\bmod n)\\). But we know since \\(k_{1}+k_{2}<k\\) that \\(0<u+g v<k+k g<n\\), so this is impossible, as desired.\n\nNow we can prove the main claim.\nProof of main claim. Consider any multiset \\(M\\) of \\(2 \\leq i \\leq k\\) residues \\((\\bmod n)\\) which corresponds to some unknown contiguous subsequence of \\(S_{n}\\). We will show that it is possible to uniquely identify which contiguous subsequence \\(M\\) corresponds to, thereby showing that \\(S_{n}\\) has no twins of length \\(i\\) for each \\(2 \\leq i \\leq k\\), and then the result will follow.\n\nFirst suppose \\(M\\) contains some residue twice. By the last lemma there are only a few possible cases:\n- \\(M\\) contains multiple copies of the residue 0 . In this case we know \\(M\\) contains the beginning of \\(S_{n}\\), so the corresponding contiguous subsequence is just the first \\(i\\) terms of \\(S_{n}\\).\n- \\(M\\) contains multiple copies of multiple residues. By the last lemma and the structure of \\(S_{n}\\), we can easily see that \\(M\\) must contain two copies of \\(-g^{i-1}\\) and two copies of \\(g^{i}\\) for some \\(0 \\leq i<a\\) that can be identified uniquely, and \\(M\\) must contain portions of both \\(C_{i-1}, C_{i}\\). It follows \\(M\\) 's terms can be partitioned into two portions, the first one being\n\\[-i_{1} g^{i-1},-\\left(i_{1}-1\\right) g^{i-1}, \\ldots,-g^{i-1},-g^{i-1}\\]\nand the second one being\n\\[0, g^{i}, g^{i}, 2 g^{i}, \\ldots, i_{2} g^{i}\\]\nfor some \\(i_{1}\\), \\(i_{2}\\) with \\(i_{1}+i_{2}=i-3\\), and we just need to uniquely identify \\(i_{1}, i_{2}\\). Luckily, by dividing the residues in \\(M\\) by \\(g^{i-1}\\), we know we can partition \\(M\\) 's terms into\n\\[-i_{1},-\\left(i_{1}-1\\right), \\ldots,-1,-1\\]\nas well as\n\\[0, g, g, 2 g, \\ldots, i_{2} g\\]\n\nNow since \\(i_{2} g \\leq k g<n-k\\) and \\(-i_{1} \\equiv n-i_{1} \\geq n-k\\) it is easy to see that \\(i_{1}, i_{2}\\) can be identified uniquely, as desired.\n- \\(M\\) contains multiple copies of only one residue \\(g^{i}\\), for some \\(0 \\leq i<a\\) that can be identified uniquely. Then by the last lemma \\(M\\) must be located at the beginning of \\(C_{i}\\) and possibly contain the last few terms of \\(C_{i-1}\\), so \\(M\\) must be of the form \\(g^{i}, g^{i}, 2 g^{i}, \\ldots, i_{1} g^{i}\\), along with possibly the term 0 or the terms \\(0,-g^{i-1}\\). So when we divide \\(M\\) by \\(g^{i-1}\\) we should be left with terms of the form \\(g, g, 2 g, \\ldots, i_{1} g\\) along with possibly 0 or \\(0,-1\\). Since \\(i_{1} g \\leq k g<n-k\\), we can easily disambiguate these cases and uniquely identify the contiguous subsequence corresponding to \\(M\\).\n- \\(M\\) contains multiple copies of only one residue \\(-g^{i}\\), for some \\(0 \\leq i<a\\) that can be identified uniquely. Then by the last lemma \\(M\\) must be located at the end of \\(C_{i}\\) and possibly the first terms of \\(C_{i+1}\\), so \\(M\\) must be of the form \\(-g^{i},-g^{i},-2 g^{i}, \\ldots,-i_{1} g^{i}\\), along with possibly the term 0 or the terms \\(0, g^{i+1}\\). So when we divide \\(M\\) by \\(g^{i-1}\\) we should be left with terms of the form \\(-1,-1,-2, \\ldots,-i_{1}\\), along with possibly 0 or \\(0, g\\). Since \\(-i_{1} \\equiv n-i_{1} \\geq \\frac{n}{2}\\) and \\(g<\\frac{n}{2}\\), we can disambiguate these cases and uniquely identify the contiguous subsequence corresponding to \\(M\\).\n\nThus in all cases where \\(M\\) contains a repeated residue, we can identify the unique contiguous subsequence of \\(S_{n}\\) corresponding to \\(M\\).\n\nWhen \\(M\\) does not contain a repeated residue, it follows that \\(M\\) cannot contain both of the \\(g^{i}\\) terms or \\((n-1) g^{i}\\) terms at the beginning or end of each \\(C_{i}\\). It follows that \\(M\\) is either entirely contained in some \\(C_{i}\\) or contained in the union of the end of some \\(C_{i}\\) with the beginning of some \\(C_{i+1}\\), meaning \\(M\\) corresponds to a contiguous subsequence of \\(\\left(-g^{i}, 0, g^{i+1}\\right)\\). In the first case, since each \\(C_{i}\\) is an arithmetic progression when the repeated terms are ignored, Lemma 1 implies that we can uniquely determine the location of \\(M\\), and in the second case, it is easy to tell which contiguous subsequence of ( \\(-g^{i}, 0, g^{i+1}\\) ) corresponds to \\(M\\).\n\nTherefore, in all cases, for any multiset \\(M\\) corresponding to some contiguous subsequence of \\(S_{n}\\) of length \\(i \\leq k\\), we can uniquely identify the contiguous subsequence, meaning \\(S_{n}\\) is \\(k\\)-good with respect to the alphabet of residues modulo \\(n\\), as desired.\n\nNow we will finish the problem. We observe the following.\nClaim - Fix \\(k\\) and let \\(p>k+1\\) be a prime. Then for \\(n=p^{2}\\) we can find a \\((n, k)\\)-good sequence of length \\(\\frac{p(p-1)\\left(p^{2}+2\\right)}{2}\\).\n\nProof of last claim. Let \\(g\\) be the smallest primitive root modulo \\(n=p^{2}\\), so that \\(a= \\frac{p(p-1)}{2}\\). As long as we can show that \\(g<\\frac{n}{k}-1\\), we can apply the previous claim to get the desired bound.\n\nWe will prove a stronger statement that \\(g<p\\). Indeed, consider any primitive root \\(g_{0} (\\bmod p)\\). Then \\(g_{0}+a p\\) has order \\(p-1 \\operatorname{modulo} p\\), so its order modulo \\(p^{2}\\) is divisible by \\(p-1\\), hence \\(g_{0}+a p\\) is a primitive root modulo \\(p^{2}\\) as long as \\(\\left(g_{0}+a p\\right)^{p-1} \\not \\equiv 1\\left(\\bmod p^{2}\\right)\\). Now\n\\[\n\\left(g_{0}+a p\\right)^{p-1}=\\sum_{i} g_{0}^{p-1-i}(a p)^{i}\\binom{p-1}{i} \\equiv g_{0}^{p-1}+g_{0}^{p-2}(a p) \\quad\\left(\\bmod p^{2}\\right)\n\\]\n\nIn particular, of the values \\(g_{0}, g_{0}+p, \\ldots, g_{0}+p(p-1)\\), only one has order \\(p-1\\) and the rest are primitive roots.\n\nSo for each \\(0<g_{0}<p\\) which is a primitive root modulo \\(p\\), either \\(g_{0}\\) is a primitive root modulo \\(p^{2}\\) or \\(g_{0}\\) has order \\(p-1\\) but \\(g_{0}+p, g_{0}+2 p, \\ldots, g_{0}+p(p-1)\\) are all primitive roots. By considering all choices of \\(g_{0}\\), we either find a primitive root \\(\\left(\\bmod p^{2}\\right)\\) which is between 0 and \\(p\\), or we find that all residues \\(\\left(\\bmod p^{2}\\right)\\) of order \\(p-1\\) are between 0 and \\(p\\). But if \\(\\operatorname{ord}_{p^{2}}(a)=p-1\\) then \\(\\operatorname{ord}_{p^{2}}\\left(a^{-1}\\right)=p-1\\), and two residues between \\(0, p\\) cannot be inverses modulo \\(p^{2}\\) (because with the exception of 1 , they cannot multiply to something \\(\\geq p^{2}+1\\) ), so there is always a primitive root between \\(0, p\\) as desired.\n\nNow for arbitrarily large \\(n\\) we can choose \\(p<\\sqrt{n}\\) with \\(\\frac{p}{\\sqrt{n}}\\) arbitrarily close to 1 ; by the previous claim, we can get an \\((n, k)\\)-good sequence of length at least \\(\\frac{p-1}{p} \\cdot \\frac{p^{4}}{2}\\) for any constant, so for sufficiently large \\(n, p\\) we get \\((n, k)\\)-good sequences of length \\(0.499 n^{2}\\).", "source_pdf": "TSTST_2022.pdf", "notes": ""}
{"id": "TSTST-2024-1", "contest": "TSTST", "year": "2024", "problem_number": "1", "problem": "For every ordered pair of integers \\((i, j)\\), not necessarily positive, we wish to select a point \\(P_{i, j}\\) in the Cartesian plane whose coordinates lie inside the unit square defined by \\[ i<x<i+1, \\quad j<y<j+1 . \\] Find all real numbers \\(c>0\\) for which it's possible to choose these points such that for all integers \\(i\\) and \\(j\\), the (possibly concave or degenerate) quadrilateral \\(P_{i, j} P_{i+1, j} P_{i+1, j+1} P_{i, j+1}\\) has perimeter strictly less than \\(c\\).", "solution": "Answer. \\(\\quad c \\geq 4\\). \n\n Proof \\(c<4\\) is not possible. Let \\(n\\) be an arbitrary positive integer. We take an \\(n \\times n\\) subgrid of unit squares (i.e. \\(P_{i, j}\\) for \\(1 \\leq i, j \\leq n\\) ), and compute a lower bound on the average of all possible quadrilaterals from this subgrid. Consider the average length of the \"top side\" of all possible quadrilaterals in this grid. Note that this is equal to: \\[ \\frac{1}{(n-1)^{2}} \\sum_{i=1}^{n-1} \\sum_{j=1}^{n-1} P_{i, j} P_{i+1, j} \\geq \\frac{1}{(n-1)^{2}} \\sum_{j=1}^{n-1} P_{1, j} P_{n, j}>\\frac{n-2}{n-1} . \\] We can apply this bound to all four sides of the quadrilateral (the left, right, bottom, and top sides) to find that the average perimeter of all possible quadrilaterals is greater than \\[ \\frac{4(n-2)}{n-1}=4-\\frac{4}{n-1} \\] This means we can always find a quadrilateral whose perimeter is at least \\(4-\\frac{4}{n-1}\\). By taking sufficiently large \\(n\\), this lower bound will exceed \\(c\\). \n\n Proof \\(c=4\\) is possible. We'll place point \\(P_{i, j}\\) at the coordinates ( \\(f(i), f(j)\\) ) for some function \\(f: \\mathbb{Z} \\rightarrow \\mathbb{R}\\). The perimeter of \\(P_{i, j} P_{i+1, j} P_{i+1, j+1} P_{i, j+1}\\) is then \\[ 2(|f(i+1)-f(i)|+|f(j+1)-f(j)|) . \\] Therefore we have a valid construction for \\(c=4\\) if \\(f\\) satisfies \\(n<f(n)<n+1\\) and \\(|f(n+1)-f(n)|<1\\) for all \\(n\\). This is achieved by \\[ f(n)=n+0.5+ \\begin{cases}-\\sum_{i=1}^{n} \\frac{1}{10^{i}} & \\text { if } n \\geq 0 \\\\ \\sum_{i=1}^{-n} \\frac{1}{10^{i}} & \\text { if } n<0\\end{cases} \\] Let's check the conditions. The sum is bounded by \\(\\sum_{i=1}^{\\infty} \\frac{1}{10^{i}}=\\frac{1}{9}\\) in magnitude, so \\(n<f(n)<n+1\\). Furthermore, we can verify that \\[ f(n+1)-f(n)=1- \\begin{cases}\\frac{1}{10^{n+1}} & \\text { if } n \\geq 0 \\\\ \\frac{1}{10^{-n}} & \\text { if } n<0\\end{cases} \\]", "source_pdf": "TSTST_2024.pdf", "notes": ""}
{"id": "TSTST-2024-2", "contest": "TSTST", "year": "2024", "problem_number": "2", "problem": "Let \\(p\\) be an odd prime number. Suppose \\(P\\) and \\(Q\\) are polynomials with integer coefficients such that \\(P(0)=Q(0)=1\\), there is no nonconstant polynomial dividing both \\(P\\) and \\(Q\\), and \\[ 1+\\frac{x}{1+\\frac{2 x}{1+\\frac{\\ddots}{1+(p-1) x}}}=\\frac{P(x)}{Q(x)} \\] Show that all coefficients of \\(P\\) except for the constant coefficient are divisible by \\(p\\), and all coefficients of \\(Q\\) are not divisible by \\(p\\).", "solution": "Solution 1. We first make some general observations about rational functions represented through continued fractions. Claim - Let \\(a_{1}, a_{2}, \\ldots\\), be a sequence of nonzero integers. Define the sequence of polynomials \\(P_{1}(x)=1, P_{2}(x)=1+a_{1} x\\), and \\[ P_{k+1}(x)=P_{k}(x)+a_{k} x P_{k-1}(x) \\] for \\(k \\geq 1\\). Then the following properties hold for all \\(k \\geq 0\\) : - \\(P_{k}(0)=1\\), - \\(\\operatorname{gcd}\\left(P_{k+1}, P_{k}\\right)=1\\), and - \\(\\operatorname{deg} P_{k}=\\lfloor k / 2\\rfloor\\). - \\(1+\\frac{a_{k} x}{1+\\frac{a_{k-1} x}{1+\\frac{\\ddots}{1+a_{1} x}}}=\\frac{P_{k+1}(x)}{P_{k}(x)}\\). Proof. These all follow by induction. With the setup of the claim, the polynomials \\(P\\) and \\(Q\\) in the problem are exactly \\(P_{p}\\) and \\(P_{p}\\) for the sequence \\(a_{1}=p-1, a_{2}=p-2, \\ldots, a_{p-1}=1\\). From here, we will define \\(P\\) and \\(Q\\) in terms of this recurrence and make two transformations on the \\(a_{i}\\). First, subtract \\(p\\) from each \\(a_{i}\\) so we now have \\(a_{1}=-1, a_{2}=-2, \\ldots, a_{p-1}=-(p-1)\\). The coefficients of \\(P\\) and \\(Q\\) only have changed by a multiple of \\(p\\). The claim also shows that \\(P(0)=Q(0)=1, \\operatorname{gcd}(P, Q)=1\\), and the degrees of \\(P\\) and \\(Q\\) have not changed, i.e. no leading terms have been added or removed. Therefore it is equivalent to work with this sequence instead. Similarly, we can multiply \\(a_{i}\\) by -1 to get \\(a_{1}=1, a_{2}=2, \\ldots, a_{p-1}=p-1\\). This is equivalent to replacing \\(x\\) with \\(-x\\), so some coefficients of \\(P\\) and \\(Q\\) are negated by this. The key conditions still remain unchanged. Remark. For rigor, it's important to prove the facts about continued fractions first rather than going straight to the coefficient replacement as the requirements imposed by the problem statement on \\(P\\) and \\(Q\\) are not always preserved modulo \\(p\\). At this point, we are ready to directly calculate the polynomials \\(P_{n}\\). Claim - For all \\(n\\), we have \\[ P_{n}(x)=\\sum_{k \\geq 0} \\frac{n!}{2^{k} k!(n-2 k)!} x^{k} \\] Here, we define \\(\\frac{n!}{(n-2 k)!}=n(n-1) \\ldots(n-2 k+1)\\) so the sum actually stops at \\(k=\\lfloor n / 2\\rfloor\\). Proof. We use induction. The base cases are clear, and \\[ \\begin{aligned} P_{n}+n x P_{n-1} & =\\sum_{k \\geq 0} \\frac{1}{2^{k} k!} \\frac{n!}{(n-2 k)!} x^{k}+n x \\sum_{k \\geq 0} \\frac{1}{2^{k} k!} \\frac{(n-1)!}{(n-2 k-1)!} x^{k} \\\\ & =\\sum_{k \\geq 0} \\frac{1}{2^{k} k!} \\frac{n!}{(n-2 k)!} x^{k}+\\sum_{k \\geq 0} \\frac{1}{2^{k} k!} \\frac{n!}{(n-2 k-1)!} x^{k+1} \\\\ & =\\sum_{k \\geq 0} \\frac{1}{2^{k} k!} \\frac{n!}{(n-2 k)!} x^{k}+\\sum_{k \\geq 1} \\frac{1}{2^{k-1}(k-1)!} \\frac{n!}{(n-2 k+1)!} x^{k} \\\\ & =1+\\sum_{k \\geq 1}\\left[\\frac{1}{2^{k} k!} \\frac{n!}{(n-2 k)!}+\\frac{1}{2^{k-1}(k-1)!} \\frac{n!}{(n-2 k+1)!}\\right] x^{k} \\\\ & =1+\\sum_{k \\geq 1} \\frac{1}{2^{k} k!} \\frac{n!}{(n-2 k+1)!}[(n-2 k+1)+2 k] x^{k} \\\\ & =1+\\sum_{k \\geq 1} \\frac{1}{2^{k} k!} \\frac{(n+1)!}{(n-2 k+1)!} x^{k} \\\\ & =\\sum_{k \\geq 0} \\frac{1}{2^{k} k!} \\frac{(n+1)!}{(n-2 k+1)!} x^{k} \\\\ & =P_{n+1} \\end{aligned} \\] At this point we can directly check the coefficients of \\(P\\) and \\(Q\\). We have \\[ P(x)=P_{p}(x)=\\sum_{k \\geq 0} \\frac{p!}{2^{k} k!(p-2 k)!} x^{k} \\] For \\(k=0\\), we get a coefficient of 1 . For \\(k \\geq 1\\), the denominator is not a multiple of \\(p\\), so the remaining coefficients are multiples of \\(p\\). Meanwhile, the coefficents for \\(Q\\) are \\(\\frac{(p-1)!}{2^{k} k!(p-1-2 k)!}\\). None of these are divisible by \\(p\\) because \\((p-1)!\\) is not divisible by \\(p\\). Remark. This problem was created from the identity \\[ \\frac{1}{1-\\frac{x}{1-\\frac{2 x}{1-\\frac{3 x}{1-\\ldots}}}}=\\sum_{i=0}^{\\infty}(2 i-1)!!x^{i} \\] You can use this to solve the problem. However, the proof of the identity as well as the details to convert this into the given problem are very lengthy so this is only left as a remark.", "source_pdf": "TSTST_2024.pdf", "notes": ""}
{"id": "TSTST-2024-3", "contest": "TSTST", "year": "2024", "problem_number": "3", "problem": "Let \\(A=\\left\\{a_{1}, \\ldots, a_{2024}\\right\\}\\) be a set of 2024 pairwise distinct real numbers. Assume that there exist positive integers \\(b_{1}, b_{2}, \\ldots, b_{2024}\\) such that \\[ a_{1} b_{1}+a_{2} b_{2}+\\cdots+a_{2024} b_{2024}=0 . \\] Prove that one can choose \\(a_{2025}, a_{2026}, a_{2027}, \\ldots\\) such that \\(a_{k} \\in A\\) for all \\(k \\geq 2025\\) and, for every positive integer \\(d\\), there exist infinitely many positive integers \\(n\\) satisfying \\[ \\sum_{k=1}^{n} a_{k} k^{d}=0 . \\]", "solution": "It will be convenient to use 0 -based indexing here, i.e. \\(A=\\left\\{a_{0}, \\ldots, a_{2023}\\right\\}\\) and so on. Let \\(m=\\sum_{i=0}^{2023} b_{i}\\). By appending \\(b_{i}-1\\) copies of \\(a_{i}\\) for each \\(i\\), we may extend the sequence to \\(a_{0}, \\ldots, a_{m-1}\\) such that \\(a_{0}+\\cdots+a_{m-1}=0\\). I Solution by direct construction. Let \\(s_{m}(n)\\) be the sum of the base- \\(m\\) digits of \\(n\\), reduced modulo \\(m\\). We now claim that \\(a_{k}=a_{s_{m}(k)}\\) works. It is clear that this extends the original sequence in a valid way. Claim - Fix \\(d\\). Then the sum \\[ \\sum_{k=0}^{n-1} a_{k}(k+1)^{d} \\] is zero when \\(n=c m^{d+1}\\) for any positive integer \\(c\\). If we prove this, then the problem is solved as there are infinitely many possible \\(c\\). We have two proofs of this. Proof of claim by expansion (Andrew Gu). We only need to show that each block of \\(m^{d+1}\\) terms sums to zero. Each block takes the form \\[ S=\\sum_{k=c m^{d+1}}^{(c+1) m^{d+1}-1} a_{s_{m}(k)}(k+1)^{d} \\] We group terms based on the value of \\(s_{m}(k)\\). The values of \\(k\\) in this sum are given by \\[ \\left\\{c m^{d+1}+\\sum_{i=0}^{d} e_{i} m^{i} \\mid\\left(e_{0}, \\ldots, e_{d}\\right) \\in\\{0, \\ldots, m-1\\}^{d+1}\\right\\} . \\] In this form, the sum of the base- \\(m\\) digits is \\(s_{m}(c)+e_{0}+\\cdots+e_{d}\\). Therefore we can write \\[ S=\\sum_{i=0}^{m-1} a_{i} \\underbrace{\\sum_{\\substack{\\left(e_{0}, \\ldots, e_{d}\\right) \\in\\{0, \\ldots, m-1\\}^{d+1} \\\\ e_{0}+\\cdots+e_{d} \\equiv i-s_{m}(c) \\quad(\\bmod m)}} \\underbrace{\\left.\\left(c m^{d+1}+1+\\sum_{j=0}^{d} e_{j} m^{j}\\right)^{d}\\right)}_{(2)}}_{(1)} \\] Since \\(\\sum a_{i}=0\\), it suffices to show that the value of the coefficient given by (1) is independent of \\(i\\). Expand the term (2) with the multinomial theorem. Each monomial in the expansion is a product of terms \\(c, m, e_{j}\\). Since the exponent is \\(d\\), no monomial is divisible by the whole product \\(e_{0} e_{1} \\cdots e_{d}\\). Since the tuples ( \\(e_{0}, \\ldots, e_{d}\\) ) are uniformly distributed over all possible tuples when one or more coordinates are removed, that means that the sum of each monomial term is independent of \\(i\\). We conclude that the sum (1) is independent of \\(i\\) as well. Proof of claim by Fourier transform. Let \\(\\omega \\neq 1\\) be an \\(m^{\\text {th }}\\) root of unity. Then, define the operator \\[ \\Delta_{a}^{(\\omega)} f(x)=\\sum_{i=0}^{m-1} \\omega^{i} f(x+i a) \\] By looking at the leading coefficients, one can see that \\(\\Delta_{a}^{(\\omega)}\\) lowers the degree of a polynomial by at least \\(1 .^{1}\\) As a consequence, by letting \\(f(x)=(x+1)^{d}\\) we conclude that \\[ \\sum_{k \\in\\left[0, m_{e}\\right)} \\omega^{s_{m}(k)}(k+1)^{d}=\\left(\\Delta_{m^{e-1}}^{(\\omega)} \\cdots \\Delta_{m}^{(\\omega)} \\Delta_{1}^{(\\omega)} f\\right)(0)=0 \\] Since \\(a_{1}+\\cdots+a_{m}=0\\), by a discrete Fourier transform we may write \\(a_{i}=\\sum_{j=1}^{m-1} c_{j} e^{2 \\pi i j / m}\\) for some \\(c_{1}, \\ldots, c_{m-1} \\in \\mathbb{C}\\). Therefore \\[ \\sum_{k=0}^{m^{e}-1} a_{k}(k+1)^{d}=\\sum_{j=1}^{m-1} c_{j} \\sum_{k=0}^{m^{e}-1}\\left(e^{2 \\pi i j / m}\\right)^{s_{m}(k)}(k+1)^{d}=0 \\] II Inductive solution. Define \\(m\\) and extend the sequence to \\(a_{m-1}\\) as before. For \\(d \\geq 0\\), let \\(\\Sigma_{d}(S)\\) denote \\(\\sum_{k \\in S} k^{d}\\). Also, for \\(d \\geq 0\\) call a tuple of sets ( \\(S_{0}, \\ldots, S_{m-1}\\) ) to be \\(d\\)-uniform if for all \\(0 \\leq d^{\\prime} \\leq d\\) we have \\(\\Sigma_{d^{\\prime}}\\left(S_{0}\\right)=\\Sigma_{d^{\\prime}}\\left(S_{1}\\right)=\\cdots=\\Sigma_{d^{\\prime}}\\left(S_{m-1}\\right)\\). \\section*{Lemma 1.1} Suppose \\(\\left(S_{0}, \\ldots, S_{m-1}\\right)\\) is \\(d\\)-uniform. Then for all \\(0 \\leq d^{\\prime} \\leq d+1, x \\in \\mathbb{R}\\), and \\(0 \\leq i, j<m\\), the quantity \\(\\Sigma_{d^{\\prime}}\\left(S_{i}+x\\right)-\\Sigma_{d^{\\prime}}\\left(S_{j}+x\\right)\\) is independent of \\(x\\). Proof. We may expand \\[ \\Sigma_{d^{\\prime}}\\left(S_{i}+x\\right)=\\sum_{k=0}^{d^{\\prime}}\\binom{d^{\\prime}}{k} x^{d^{\\prime}-k} \\Sigma_{k}\\left(S_{i}\\right) \\] By \\(d\\)-uniformity, the terms with \\(k \\leq d\\) are independent of \\(i\\) and go away in the subtraction. The only term left is when \\(k=d^{\\prime}=d+1\\). However, this term is independent of \\(x\\), as desired. \\footnotetext{ \\({ }^{1}\\) In fact the degree decreases by exactly 1 , but this is not that important. } \\section*{Lemma 1.2} Suppose ( \\(S_{0}, \\ldots, S_{m-1}\\) ) is a \\(d\\)-uniform partition of [ \\(0, n\\) ). Then there exists a ( \\(d+1\\) )uniform partition \\(\\left(S_{0}^{\\prime}, \\ldots, S_{m-1}^{\\prime}\\right)\\) of \\([0, m n)\\) such that \\(S_{i} \\subseteq S_{i}^{\\prime}\\) for all \\(i\\). Proof. We let \\(S_{i}^{\\prime}=\\bigcup_{k=0}^{m-1}\\left(S_{(i+k) \\bmod m}+k n\\right)\\). Then, for every \\(0 \\leq d^{\\prime} \\leq d+1\\) and \\(0 \\leq i, j<m\\), we have \\[ \\begin{aligned} \\Sigma_{d^{\\prime}}\\left(S_{i}^{\\prime}\\right)-\\Sigma_{d^{\\prime}}\\left(S_{j}^{\\prime}\\right) & =\\sum_{k=0}^{m-1} \\Sigma_{d^{\\prime}}\\left(S_{(i+k) \\bmod m}+k n\\right)-\\Sigma_{d^{\\prime}}\\left(S_{(j+k) \\bmod m}+k n\\right) \\\\ & =\\sum_{k=0}^{m-1} \\Sigma_{d^{\\prime}}\\left(S_{(i+k) \\bmod m}\\right)-\\Sigma_{d^{\\prime}}\\left(S_{(j+k) \\bmod m}\\right) \\\\ & =0 \\end{aligned} \\] Consider the 0 -uniform partition of \\([0, m)\\) given by \\((\\{0\\},\\{1\\}, \\ldots,\\{m-1\\})\\). By repeatedly applying Lemma 1.2, we get \\(d\\)-uniform partitions ( \\(S_{0}^{(d)}, \\ldots, S_{m-1}^{(d)}\\) ) of [ \\(0, m^{d+1}\\) ) such that \\(S_{i}^{(d)} \\subseteq S_{i}^{(d+1)}\\) for all \\(d\\) and \\(i\\). For every \\(k\\), let \\(i\\) be the unique index such that \\(k \\in S_{i}^{(d)}\\) for some \\(d\\), and let \\(a_{k}=a_{i}\\). (This doesn't redefine \\(a_{0}, \\ldots, a_{m-1}\\) as for \\(k<m\\), we have \\(k \\in S_{k}^{(0)}\\).) Then, for each \\(e \\geq d\\), we find that \\[ \\sum_{k=0}^{m^{e+1}-1} a_{k}(k+1)^{d}=\\sum_{i=0}^{m-1} a_{i} \\sum_{k \\in S_{i}^{(e)}}(k+1)^{d}=\\sum_{i=0}^{m-1} a_{i} \\sum_{j=1}^{d}\\binom{d}{j} \\Sigma_{j}\\left(S_{i}^{(e)}\\right)=0 \\] Remark. The construction here is essentially the same as the sum-of-digits construction (in fact it would be exactly the same if we replace \\((i+k) \\bmod m\\) in the proof of Lemma 1.2 with \\((i-k) \\bmod m)\\). However, it hints at some flexibility in the construction which is less apparent with other approaches. For example, if \\(G\\) is any transitive subgroup of permutations on \\([0, m)\\) and \\(\\pi_{0}=\\mathrm{id}, \\pi_{1}, \\ldots, \\pi_{|G|-1}\\) is an enumeration of the elements of \\(G\\), one can turn a \\(d\\)-uniform partition ( \\(S_{0}, \\ldots, S_{m-1}\\) ) of [ \\(0, n\\) ) into a ( \\(d+1\\) )-uniform partition ( \\(S_{0}^{\\prime}, \\ldots, S_{m-1}^{\\prime}\\) ) of [ \\(0,|G| n\\) ) by letting \\(S_{i}^{\\prime}=\\bigcup_{k=0}^{|G|-1}\\left(S_{\\pi_{k}(i)}+k n\\right)\\). Here we used the special case \\(\\pi_{k}(i)=(i+k) \\bmod m\\); it may also be natural to let \\(G\\) be the set of all \\(m\\) ! permutations. Remark. The construction in the solution has appeared a number of times in the literature; see - D. H. Lehmer, The Tarry-Escott problem, Scripta Math. 13, 37-41, 1947; - E. Prouhet, M\u00e9moire sur quelques relations entre les puissances des nombres, \\(C . R\\). Acad. Sci. Paris 33, 225, 1851; - E. M. Wright, Equal sums of like powers, Proc. Edinburgh Math. Soc. 2nd series 8, 138-142, 1949; - E. M. Wright, Prouhet's 1851 solution of the Tarry-Escott problem of 1910, Amer. Math. Monthly 66, 199-201, 1959.", "source_pdf": "TSTST_2024.pdf", "notes": ""}
{"id": "TSTST-2024-4", "contest": "TSTST", "year": "2024", "problem_number": "4", "problem": "Let \\(A B C D\\) be a quadrilateral inscribed in a circle with center \\(O\\) and \\(E\\) be the intersection of segments \\(A C\\) and \\(B D\\). Let \\(\\omega_{1}\\) be the circumcircle of \\(A D E\\) and \\(\\omega_{2}\\) be the circumcircle of \\(B C E\\). The tangent to \\(\\omega_{1}\\) at \\(A\\) and the tangent to \\(\\omega_{2}\\) at \\(C\\) meet at \\(P\\). The tangent to \\(\\omega_{1}\\) at \\(D\\) and the tangent to \\(\\omega_{2}\\) at \\(B\\) meet at \\(Q\\). Show that \\(O P=O Q\\).", "solution": "IT Solution 1. Let \\(R=\\overline{A D} \\cap \\overline{B C}\\) (possibly at infinity, but we'll see it's an Euclidean point later). ![](https://cdn.mathpix.com/cropped/2025_08_23_af7d8b12bec51b7bf4e3g-12.jpg?height=969&width=1186&top_left_y=1085&top_left_x=439) Claim - \\(A C R P\\) is an isosceles trapezoid with \\(\\overline{A C} \\| \\overline{P R}\\). Consequently, \\(R\\) is an Euclidean point, and \\(O P=O R\\). Proof. It is equivalent to show that \\(\\triangle P A C \\cong \\triangle R C A\\), or without using \\(R\\), that \\[ \\measuredangle P A C=\\measuredangle A C R=\\measuredangle A C B, \\quad \\text { and } \\quad \\measuredangle P C A=\\measuredangle C A R=\\measuredangle C A D . \\] Indeed, we have \\[ \\measuredangle P A C=\\measuredangle A D E=\\measuredangle A D B=\\measuredangle A C B \\] and likewise \\(\\measuredangle P C A=\\measuredangle C A D\\), as requested. Similarly \\(O Q=O R\\), so we're done.", "source_pdf": "TSTST_2024.pdf", "notes": ""}
{"id": "TSTST-2024-5", "contest": "TSTST", "year": "2024", "problem_number": "5", "problem": "For a positive integer \\(k\\), let \\(s(k)\\) denote the number of 1 s in the binary representation of \\(k\\). Prove that for any positive integer \\(n\\), \\[ \\sum_{i=1}^{n}(-1)^{s(3 i)}>0 \\]", "solution": "Solution 1. Given a set of positive integers \\(S\\), define \\[ f(S)=\\sum_{k \\in S}(-1)^{s(k)} \\] We also define \\[ \\begin{aligned} S_{\\text {even }} & =\\{k \\in S \\mid k \\text { is even }\\} \\\\ S_{\\text {odd }} & =\\{k \\in S \\mid k \\text { is odd }\\} \\end{aligned} \\] and apply functions on sets pointwise, e.g. \\[ \\frac{S-1}{2}=\\left\\{\\left.\\frac{k-1}{2} \\right\\rvert\\, k \\in S\\right\\} . \\] The problem follows from the first bullet of the following claim. Claim - For every positive integer \\(n\\), - \\(f(\\{3,6, \\ldots, 3 n\\})>0\\) - \\(f(\\{1,4, \\ldots, 3 n-2\\})<0\\) - \\(f(\\{2,5, \\ldots, 3 n-1\\}) \\leq 0\\) Proof. Induct on \\(n\\). The base case \\(n=1\\) is easy to check. - For \\(S=\\{3,6, \\ldots, 3 n\\}\\), \\[ \\begin{aligned} f(S) & =f\\left(S_{\\text {even }}\\right)+f\\left(S_{\\text {odd }}\\right) \\\\ & =f\\left(S_{\\text {even }} / 2\\right)-f\\left(\\left(S_{\\text {odd }}-1\\right) / 2\\right)>0 \\end{aligned} \\] since the elements of \\(S_{\\text {even }} / 2\\) are \\(0 \\bmod 3\\) and the elements of \\(\\left(S_{\\text {odd }}-1\\right) / 2\\) are \\(1 \\bmod 3\\). - For \\(S=\\{1,4, \\ldots, 3 n-2\\}\\), \\[ \\begin{aligned} f(S) & =f\\left(S_{\\text {even }}\\right)+f\\left(S_{\\text {odd }}\\right) \\\\ & =f\\left(S_{\\text {even }} / 2\\right)-f\\left(\\left(S_{\\text {odd }}-1\\right) / 2\\right)<0 \\end{aligned} \\] since the elements of \\(S_{\\text {even }} / 2\\) are \\(2 \\bmod 3\\) and the elements of \\(\\left(S_{\\text {odd }}-1\\right) / 2\\) are \\(0 \\bmod 3\\). (Note that \\(\\left(S_{\\text {odd }}-1\\right) / 2\\) has multiples of 3 starting at 0 rather than 3 , but this is fine because \\(f(\\{3, \\ldots, 3 n\\})>0\\) clearly implies \\(f(\\{0, \\ldots, 3 n\\})>0\\) as well.) - For \\(S=\\{2,5, \\ldots, 3 n-1\\}\\), there are two cases. - Case 1: \\(2^{2 k-1} \\leq 3 n-1<2^{2 k}\\). Define \\[ \\begin{aligned} S_{\\text {small }} & =\\left\\{s \\in S \\mid s<2^{2 k-1}\\right\\} \\\\ S_{\\text {big }} & =\\left\\{s \\in S \\mid s \\geq 2^{2 k-1}\\right\\} \\end{aligned} \\] Then \\[ \\begin{aligned} f(S) & =f\\left(S_{\\text {small }}\\right)+f\\left(S_{\\text {big }}\\right) \\\\ & =f\\left(S_{\\text {small }}\\right)-f\\left(S_{\\text {big }}-2^{2 k-1}\\right)<0 \\end{aligned} \\] since \\(S_{\\text {big }}-2^{2 k-1}=\\left\\{0, \\ldots, 3 n-1-2^{2 k-1}\\right\\}\\) consists of a prefix of the \\(0(\\bmod 3)\\) positive integers in addition to 0 . - Case 2: \\(2^{2 k}<3 n-1<2^{2 k+1}\\). Note that if \\(a+b=2^{2 k+1}-1\\), then \\(f(\\{a, b\\})=0\\). If we use this to cancel out all pairs of numbers in \\(S\\) which add to \\(2^{2 k+1}-1\\), then we find \\[ f(S)=f\\left(\\left\\{2,5, \\ldots, 2^{2 k+1}-3 n-2\\right\\}\\right) \\leq 0 \\] This completes the induction.", "source_pdf": "TSTST_2024.pdf", "notes": ""}
{"id": "TSTST-2024-6", "contest": "TSTST", "year": "2024", "problem_number": "6", "problem": "Determine whether there exists a function \\(f: \\mathbb{Z}_{>0} \\rightarrow \\mathbb{Z}_{>0}\\) such that for all positive integers \\(m\\) and \\(n\\), \\[ f(m+n f(m))=f(n)^{m}+2024!\\cdot m \\]", "solution": "The answer is no. Let \\(P(m, n)\\) denote the given FE. Solution 1 (Gopal Goel). Suppose there was a function \\(f\\), and let \\(r=f(1)\\). Note that \\(P(1, n)\\) gives \\[ f(1+r n)=f(n)+2024!. \\] Iterating this result gives \\[ f\\left(1+r+\\cdots+r^{k}\\right)=r+k \\cdot 2024! \\] for all \\(k \\in \\mathbb{Z}_{\\geq 0}\\). If \\(r=1\\), this implies \\(f(k+1)=1+k \\cdot 2024!\\), which isn't a valid solution, so \\(r \\geq 2\\). Let \\(m=1+r+\\cdots+r^{r^{2}(r-1)}\\). Note that \\[ 1+r+\\cdots+r^{k}=m+n f(m) \\Longleftrightarrow \\frac{r^{k+1}-r^{r^{2}(r-1)+1}}{r-1}=n\\left[r+r^{2}(r-1) 2024!\\right] . \\] This has a positive integer solution for \\(n\\) as long as \\(k\\) is sufficiently large in terms of \\(r\\) and \\[ k \\equiv r^{2}(r-1) \\quad(\\bmod \\phi(1+r(r-1) \\cdot 2024!)) \\] For such \\(k, P(m, n)\\) implies \\[ r+k \\cdot 2024!=f(n)^{m}+2024!\\cdot m \\] In particular, \\(r+(k-m) \\cdot 2024\\) ! is a perfect \\(m\\) th power. This has to be true for all \\(k\\) sufficiently large in an arithmetic progression, which is clearly impossible, as desired.", "source_pdf": "TSTST_2024.pdf", "notes": ""}
{"id": "TSTST-2024-7", "contest": "TSTST", "year": "2024", "problem_number": "7", "problem": "An infinite sequence \\(a_{1}, a_{2}, a_{3}, \\ldots\\) of real numbers satisfies \\[ a_{2 n-1}+a_{2 n}>a_{2 n+1}+a_{2 n+2} \\quad \\text { and } \\quad a_{2 n}+a_{2 n+1}<a_{2 n+2}+a_{2 n+3} \\] for every positive integer \\(n\\). Prove that there exists a real number \\(C\\) such that \\(a_{n} a_{n+1}<C\\) for every positive integer \\(n\\).", "solution": "It suffices to solve the problem for sufficiently large \\(n\\). Let \\(d_{n}=(-1)^{n-1}\\left(a_{n+2}-a_{n}\\right)\\). The assertion simply says that \\(d_{1}, d_{2}, \\ldots\\) is strictly increasing. We consider the following cases. - Suppose that \\(d_{k}>0\\) for some \\(k\\). Then, \\[ a_{2 n+1}=a_{1}+\\left(d_{1}+d_{3}+\\cdots+d_{2 n-1}\\right) \\] clearly diverges to \\(+\\infty\\), and \\[ a_{2 n}=a_{2}-\\left(d_{2}+d_{4}+\\cdots+d_{2 n-2}\\right) \\] clearly diverges to \\(-\\infty\\), so taking \\(C=0\\) works. - Now assume that \\(d_{k} \\leq 0\\) for all \\(k\\). This implies that \\(\\left(a_{2 n+1}\\right)_{n \\geq 0}\\) is weakly decreasing and \\(\\left(a_{2 n}\\right)_{n \\geq 1}\\) is weakly increasing. Adding the two expressions above together, we see that \\[ d_{1}+a_{1}+a_{2}<a_{2 n}+a_{2 n+1}<a_{1}+a_{2} . \\] Since \\(\\left(a_{2 n+1}\\right)_{n \\geq 0}\\) is weakly decreasing, it either diverges to \\(-\\infty\\) or has a finite limit. Similarly, \\(\\left(a_{2 n}\\right)_{n \\geq 1}\\) either diverges to \\(+\\infty\\) or has a finite limit. - If \\(\\left(a_{2 n+1}\\right)_{n \\geq 0}\\) diverges to \\(-\\infty\\), then the first inequality above implies that \\(\\left(a_{2 n}\\right)_{n \\geq 1}\\) must diverge to \\(+\\infty\\), in which case \\(C=0\\) works. - If \\(\\left(a_{2 n}\\right)_{n \\geq 1}\\) diverges to \\(+\\infty\\), then the second inequality implies that \\(\\left(a_{2 n+1}\\right)_{n \\geq 0}\\) must diverge to \\(-\\infty\\), so again \\(C=0\\) works. - Finally assume that both \\(\\lim _{n \\rightarrow \\infty} a_{2 n+1}\\) and \\(\\lim _{n \\rightarrow \\infty} a_{2 n}\\) exist, so the limit \\(L=\\lim _{n \\rightarrow \\infty} a_{2 n} a_{2 n+1}\\) also exists. The result follows taking \\(C>L\\).", "source_pdf": "TSTST_2024.pdf", "notes": ""}
{"id": "TSTST-2024-8", "contest": "TSTST", "year": "2024", "problem_number": "8", "problem": "Let \\(A B C\\) be a scalene triangle, and let \\(D\\) be a point on side \\(B C\\) satisfying \\(\\angle B A D=\\angle D A C\\). Suppose that \\(X\\) and \\(Y\\) are points inside \\(A B C\\) such that triangles \\(A B X\\) and \\(A C Y\\) are similar and quadrilaterals \\(A C D X\\) and \\(A B D Y\\) are cyclic. Let lines \\(B X\\) and \\(C Y\\) meet at \\(S\\) and lines \\(B Y\\) and \\(C X\\) meet at \\(T\\). Prove that lines \\(D S\\) and \\(A T\\) are parallel.", "solution": "If Solution by characterizing \\(\\boldsymbol{X}\\) and \\(\\boldsymbol{Y}\\). We first state an important property of \\(X\\) and \\(Y\\). Claim - Points \\(X\\) and \\(Y\\) are isogonal conjugates with respect to \\(\\triangle A B C\\). ![](https://cdn.mathpix.com/cropped/2025_08_23_af7d8b12bec51b7bf4e3g-22.jpg?height=912&width=1112&top_left_y=1127&top_left_x=482) Here are two proofs of the claim. First proof of claim by Maxim Li. We prove an equivalent statement that \\(S\\) and \\(T\\) are isogonal conjugates with respect to \\(\\triangle A B C\\). First, we note that \\(\\angle Y B C=\\angle Y A D=\\angle X A D=\\angle X C B\\), so \\(B T=T C\\). Now, let \\(T^{\\prime}\\) be the isogonal conjugate of \\(S\\) w.r.t. \\(\\triangle A B C\\). Since \\(\\angle A B S=\\angle A C S\\), it follows that \\(T^{\\prime} B=T^{\\prime} C\\). Thus, both \\(T\\) and \\(T^{\\prime}\\) lies on perpendicular bisector of \\(B C\\). Moreover, since \\(A X\\) and \\(A Y\\) are isogonal with respect to \\(\\angle B A C\\), by DDIT on point \\(A\\) and \\(B X C Y\\), we get that \\(A S\\) and \\(A T\\) are isogonal with respect to \\(\\angle B A C\\). Hence, \\(A, T, T^{\\prime}\\) are collinear. Since \\(\\triangle A B C\\) is scalene, combining this with the previous paragraph gives \\(T=T^{\\prime}\\), or \\(S\\) and \\(T\\) are isogonal conjugates. \\(A\\) second different proof of the claim. Let \\(\\gamma_{B}\\) be the circle through \\(B\\) and \\(C\\) tangent to \\(A B\\), and define \\(\\gamma_{C}\\) similarly. We claim that \\(X \\in \\gamma_{B}\\) and \\(Y \\in \\gamma_{C}\\). Let \\(E\\) be the second intersection of \\(\\gamma_{B}\\) with \\(A C\\), and let \\(F\\) be the intersection of \\(B E\\) and \\(A D\\). Consider the transformation \\(\\tau\\) that is the composition of a reflection across \\(A D\\) and a homothety at \\(A\\) with ratio \\(\\frac{A B}{A C}\\). Note that \\(\\tau\\) maps \\(Y \\mapsto X, B \\mapsto E\\), and \\(D \\mapsto F\\). Thus, \\(X\\) lies on \\(\\tau(\\odot(A B D))=\\odot(A E F)\\), so \\(X\\) is the second intersection of \\(\\odot(A E F)\\) and \\(\\odot(A D C)\\), i.e. it is the Miquel point of quadrilateral \\(C D F E\\). Thus, \\(X\\) lies on \\(\\odot(B E C)=\\gamma_{B}\\), as claimed. Finally, the main claim follows from \\(\\angle B C X=\\angle A B X=\\angle A C Y\\). Here are two ways to finish after the claim. Finish with isosceles trapezoid. We compute \\[ \\angle A X B=360^{\\circ}-\\angle B X C-\\angle C X A=360^{\\circ}-\\angle B E C-\\angle C D A=180^{\\circ}-\\frac{\\angle A}{2} . \\] Thus, if \\(B X\\) meets \\(\\odot(A C D)\\) again at \\(C^{\\prime}\\), then \\[ \\angle A D C^{\\prime}=\\angle A X C^{\\prime}=\\frac{\\angle A}{2}=\\angle C A D \\] so \\(A D C C^{\\prime}\\) is an isosceles trapezoid. Similarly, if \\(C Y\\) meets \\(\\odot(A B D)\\) again at \\(B^{\\prime}\\), then \\(A D B B^{\\prime}\\) is an isosceles trapezoid. Hence, \\(B C C^{\\prime} B^{\\prime}\\) is an isosceles trapezoid whose diagonals meet at \\(S\\), so we have that \\(S A=S D\\). However, by the claim, \\(S\\) and \\(T\\) are isogonal conjugates in \\(A B C\\). Thus, \\[ \\angle A D S=\\angle S A D=\\angle D A T \\] which completes the proof.", "source_pdf": "TSTST_2024.pdf", "notes": ""}
{"id": "TSTST-2024-9", "contest": "TSTST", "year": "2024", "problem_number": "9", "problem": "Let \\(n \\geq 2\\) be a fixed integer. The cells of an \\(n \\times n\\) table are filled with the integers from 1 to \\(n^{2}\\) with each number appearing exactly once. Let \\(N\\) be the number of unordered quadruples of cells on this board which form an axis-aligned rectangle, with the two smaller integers being on opposite vertices of this rectangle. Find the largest possible value of \\(N\\).", "solution": "The largest possible value of \\(N\\) is \\(\\frac{1}{12} n^{2}\\left(n^{2}-1\\right)\\). Call these rectangles wobbly. We defer the construction until the proof is complete, since the proof suggests the construction. IT Proof of bound. Call a triple of integers ( \\(a, b, c\\) ) an elbow if \\(a\\) and \\(b\\) are in the same row, \\(b\\) and \\(c\\) are in the same column, and \\(a<b>c\\). Observe that the wobbly rectangles are exactly the ones with 2 elbows. Claim - Every axis-aligned rectangle has at least 1 elbow. Proof. The smallest integer in any rectangle is the center of an elbow. Remark. In fact, it is true that any rectangle must have exactly 1 or 2 elbows. However, this fact is not needed in the proof. Let \\(E\\) be the number of elbows and \\(M\\) be the number of non-wobbly rectangles. Then, the number of elbows is at least \\(M+2 N=\\binom{n}{2}^{2}+N\\), so \\[ E \\geq\\binom{ n}{2}^{2}+N \\Longleftrightarrow N \\leq E-\\binom{n}{2}^{2} \\] To this end, we will provide an upper bound on \\(E\\). For each cell \\(c\\), define: - \\(f(c)\\) to be the number of cells in \\(c\\) 's row which are smaller than \\(c\\), and - \\(g(c)\\) to be the number of cells in \\(c\\) 's column which are smaller than \\(c\\). Then, the number of elbows centered at \\(c\\) equals \\(f(c) g(c)\\). Thus, the number of elbows satisfies \\[ \\begin{aligned} E & =\\sum_{c} f(c) g(c) \\\\ & \\leq \\sum_{c} \\frac{1}{2}\\left[f(c)^{2}+g(c)^{2}\\right] \\\\ & =n\\left(0^{2}+\\cdots+(n-1)^{2}\\right) \\\\ & =\\frac{n^{2}(n-1)(2 n-1)}{6} . \\end{aligned} \\] It follows that the number of wobbly rectangles satisfies \\[ N \\leq E-\\binom{n}{2}^{2} \\] \\[ \\begin{aligned} & \\leq \\frac{n^{2}(n-1)(2 n-1)}{6}-\\frac{n^{2}(n-1)^{2}}{4} \\\\ & =\\frac{n^{2}\\left(n^{2}-1\\right)}{12} \\end{aligned} \\] as desired. I Construction. From the proof above, equality holds if and only if \\(f(c)=g(c)\\) everywhere. Select any \\(n \\times n\\) Latin square on symbols \\(0, \\ldots, n-1\\), and replace the \\(n\\) copies of symbol \\(k\\) with the integers \\(k n+1, \\ldots, k n+n\\) in some order. This construction is valid, because for each cell \\(c, f(c)\\) and \\(g(c)\\) both equal the symbol originally placed in \\(c\\). Here is an example for \\(n=6\\). The left grid is the Latin square, and the right grid is one possible table that can be derived from it. \\begin{tabular}{|l|l|l|l|l|l|} \\hline 0 & 1 & 2 & 3 & 4 & 5 \\\\ \\hline 5 & 0 & 1 & 2 & 3 & 4 \\\\ \\hline 4 & 5 & 0 & 1 & 2 & 3 \\\\ \\hline 3 & 4 & 5 & 0 & 1 & 2 \\\\ \\hline 2 & 3 & 4 & 5 & 0 & 1 \\\\ \\hline 1 & 2 & 3 & 4 & 5 & 0 \\\\ \\hline \\end{tabular} \\begin{tabular}{|c|c|c|c|c|c|} \\hline 1 & 7 & 13 & 19 & 25 & 31 \\\\ \\hline 32 & 2 & 8 & 14 & 20 & 26 \\\\ \\hline 27 & 33 & 3 & 9 & 15 & 21 \\\\ \\hline 22 & 28 & 34 & 4 & 10 & 16 \\\\ \\hline 17 & 23 & 29 & 35 & 5 & 11 \\\\ \\hline 12 & 18 & 24 & 30 & 36 & 6 \\\\ \\hline \\end{tabular} Remark (Structure of optimal tables). In fact, any optimal table must lead to a Latin square in a similar way, by reversing the above idea: replace each cell \\(c\\) with \\(f(c)=g(c)\\). This suggests how to construct all optimal tables: choose any Latin square on \\(0, \\ldots\\), \\(n-1\\), and fill in the cells so that the relative order of cells in every row and column is preserved. Remark. If the grid is filled out in a random order, the expected number of wobbly rectangles is \\(\\frac{1}{12} n^{2}(n-1)^{2}\\). This is asymptotically equal to the maximum value.", "source_pdf": "TSTST_2024.pdf", "notes": ""}
{"id": "TSTST-2025-1", "contest": "TSTST", "year": "2025", "problem_number": "1", "problem": "In a finite group of people, some pairs are friends (friendship is mutual). Each person \\(p\\) has a list \\(f_{1}(p), f_{2}(p), \\ldots, f_{d(p)}(p)\\) of their friends, where \\(d(p)\\) is the number of distinct friends \\(p\\) has. Additionally, any two people are connected by a series of friendships. Each person also has a water balloon. The following game is played until someone ends up with more than one water balloon: on round \\(r\\), each person \\(p\\) throws the current water balloon they have to their friend \\(f_{s}(p)\\) such that \\(d(p)\\) divides \\(r-s\\). Show that if the game never ends, then everyone has the same number of friends.", "solution": "Given a person \\(p\\), let \\(F(p)\\) be the set of friends of \\(p\\). Choose a person \\(p\\) with the most friends. Note that for each friend \\(q\\) of \\(p, p\\) receives a water balloon from \\(q\\) once out of every \\(d(q)\\) turns. Since \\(p\\) always receives 1 water balloon, we must have\n\\[\n\\sum_{q \\in F(p)} \\frac{1}{d(q)}=1 .\n\\]\nSince this sum has \\(d(p)\\) terms, and since \\(d(q) \\leq d(p)\\) for all \\(q\\), we have\n\\[\n1 \\geq d(p) \\cdot \\frac{1}{d(p)}=1\n\\]\nThus we must have equality for all friends \\(q\\) of \\(p\\). In particular, \\(d(q)=d(p)\\). Thus all friends of any person with the most number of friends also have the most number of friends.\n\nAgain, let \\(p\\) be a person with the most friends. Now for any other person \\(q\\), there exists a sequence of people \\(p=p_{0}, p_{1}, \\ldots, p_{n}=q\\). Repeatedly applying the previous result gives us \\(d(p)=d\\left(p_{0}\\right)=d\\left(p_{1}\\right)=\\cdots=d\\left(p_{n}\\right)=d(q)\\). Thus any person has the maximum number of friends out of the group, which means that each person has the same number of friends.", "source_pdf": "TSTST_2025.pdf", "notes": ""}
{"id": "TSTST-2025-2", "contest": "TSTST", "year": "2025", "problem_number": "2", "problem": "Find all sets \\(S \\subseteq \\mathbb{Z}\\) for which there exists a function \\(f: \\mathbb{R} \\rightarrow \\mathbb{Z}\\) such that\n- \\(f(x-y)-2 f(x)+f(x+y) \\geq-1\\) for all \\(x, y \\in \\mathbb{R}\\), and\n- \\(S=\\{f(z) \\mid z \\in \\mathbb{R}\\}\\).", "solution": "The answer is \\(\\{a\\},\\{a, a+1\\},\\{a, a+1, a+2, \\ldots\\}\\), and \\(\\mathbb{Z}\\), for arbitrary \\(a \\in \\mathbb{Z}\\). For constructions, it is not hard to show that if \\(g: \\mathbb{R} \\rightarrow \\mathbb{R}\\) is a convex function, then \\(\\lfloor g\\rfloor\\) satisfies the functional equation. Thus \\(f(x)=a, f(x)=\\lfloor x\\rfloor\\), and \\(f(x)=\\left\\lfloor x^{2}\\right\\rfloor+a\\) work, covering the first, fourth, and third class of answers respectively. Furthermore, it is not hard to show that \\(f(x)=a+\\mathbf{1}_{x>0}\\) also works to cover the second class.\n\nLet \\(P(x, y)\\) denote the condition. To prove that nothing else works, the key result is to prove an \"intermediate value theorem\": if \\(a\\) and \\(b\\) are in the range of \\(f\\), then so is every integer between \\(a\\) and \\(b\\). Let's first see how this finishes. If we assume the intermediate value theorem, then all we need to show is that if the range of the range of \\(f\\) is at least 2 , then the range of \\(f\\) is unbounded above. Indeed, if \\(f(x)-f(y) \\geq 2\\), then \\(P(x, y-x)\\) gives us that \\(f(2 x-y)>f(x)\\), so iterating this procedure finishes.\n\nWe will now prove the intermediate value theorem. We will repeatedly use the fact that if \\(f(x)\\) is a solution, so is \\(f(a x+b)+c\\) for \\(a, b \\in \\mathbb{R}\\) and \\(c \\in \\mathbb{Z}\\).\n\n\\section*{Lemma 1.1}\n\nIf \\(f(0) \\leq-1\\), then \\(f\\left(2^{k}\\right) \\geq 2^{k} f(1)\\) for \\(k \\geq 0\\).\n\nProof. \\(P\\left(2^{k}, 2^{k}\\right)\\) yields that \\(f\\left(2^{k+1}\\right) \\geq 2 f\\left(2^{k}\\right)\\).\n\n\\section*{Lemma 1.2}\n\nIf \\(f(-1) \\leq-2\\) and \\(f(0)=0\\), then \\(f\\left(2^{k}\\right) \\geq 2^{k}-1\\) for all positive integers \\(k\\).\n\nProof. Applying Lemma 1.1 to \\(f(x-1)+1\\) yields that \\(f\\left(2^{k}-1\\right) \\geq 2^{k}-1\\). Then, applying Lemma 1.1 to \\(f\\left(2^{k}-x\\right)-f\\left(2^{k}\\right)-1\\) yields that\n\\[\nf(0)-f\\left(2^{k}\\right)-1 \\geq 2^{k}\\left(f\\left(2^{k}-1\\right)-f\\left(2^{k}\\right)-1\\right) \\Longrightarrow f\\left(2^{k}\\right)+1 \\geq \\frac{2^{k} f\\left(2^{k}-1\\right)}{2^{k}-1} \\geq 2^{k}\n\\]\n\nNow to prove the intermediate value theorem, scale and shift such that \\(f(-1) \\leq-2\\) and \\(f(0)=0\\); it suffices to show that there exists some number strictly between \\(f(-1)\\) and \\(f(0)\\) in the range of \\(f\\) (since by iteration we can then get all values). Suppose not and let \\(a_{k}=f\\left(-1 / 2^{k}\\right)\\). If \\(k\\) is minimal such that \\(a_{k} \\geq 0\\), then \\(P\\left(-1 / 2^{k}, 1 / 2^{k}\\right)\\) yields a contradiction. Thus \\(a_{k} \\leq-2\\) for all \\(k\\). However, applying Lemma 1.2 to \\(f\\left(x / 2^{k}\\right)\\) yields that \\(a_{k} \\leq-2 \\Longrightarrow f(1) \\geq 2^{k}-1\\), which cannot hold for all \\(k\\) since \\(f(1)\\) is constant.", "source_pdf": "TSTST_2025.pdf", "notes": ""}
{"id": "TSTST-2025-3", "contest": "TSTST", "year": "2025", "problem_number": "3", "problem": "Let \\(a_{1}, a_{2}, r\\), and \\(s\\) be positive integers with \\(r\\) and \\(s\\) odd. The sequence \\(a_{1}, a_{2}, a_{3}, \\ldots\\) is defined by\n\\[\na_{n+2}=r a_{n+1}+s a_{n}\n\\]\nfor all \\(n \\geq 1\\). Determine the maximum possible number of integers \\(1 \\leq \\ell \\leq 2025\\) such that \\(a_{\\ell}\\) divides \\(a_{\\ell+1}\\), over all possible choices of \\(a_{1}, a_{2}, r\\), and \\(s\\).", "solution": "IT Answer 1350.\n\nIT Solution We first provide the upper bound. We start by dividing out any common factors of \\(a_{1}\\) and \\(a_{2}\\) from the whole sequence. Note that since \\(r\\) and \\(s\\) are odd, and \\(a_{1}\\) and \\(a_{2}\\) cannot both be divisible by 2 , the sequence \\(a_{1}, a_{2}, a_{3}, \\ldots(\\bmod 2)\\) must be some cyclic shift of the sequence \\(1,1,0,1,1,0,1,1,0, \\ldots\\). This means that exactly \\(\\frac{2025}{3}=675\\) of the values of \\(\\ell\\) satisfy \\(a_{\\ell} \\equiv 0(\\bmod 2)\\) and \\(a_{\\ell+1} \\equiv 1(\\bmod 2)\\). An even number can never divide an odd number, so we have an upper bound of \\(2025 \\times \\frac{2}{3}=1350\\).\n\nNow we provide a construction so that \\(a_{\\ell}\\) divides \\(a_{\\ell+1}\\) for 1350 values of \\(\\ell\\). Let \\(F_{1}, F_{2}, F_{3}, \\ldots\\) denote the Fibonacci sequence with \\(F_{1}=F_{2}=1\\). Let\n\\[\nC=\\frac{F_{1} \\cdot F_{2} \\cdot F_{3} \\cdot F_{4} \\cdots F_{2025}}{F_{3} \\cdot F_{6} \\cdot F_{9} \\cdot F_{12} \\cdots F_{2025}}=F_{1} \\cdot F_{2} \\cdot F_{4} \\cdot F_{5} \\cdots F_{2024} .\n\\]\nNote that \\(C\\) is odd, since it is the product of all odd Fibonacci numbers up to \\(F_{2025}\\). We let \\(a_{n}=C^{n-1} F_{n}\\), which satisfies the recurrence with \\(r=C^{2}\\) and \\(s=C\\). This gives\n\\[\n\\frac{a_{\\ell+1}}{a_{\\ell}}=C \\cdot \\frac{F_{\\ell+1}}{F_{\\ell}},\n\\]\nwhich is an integer whenever \\(3 \\nmid \\ell\\) for \\(1 \\leq \\ell \\leq 2025\\).", "source_pdf": "TSTST_2025.pdf", "notes": ""}
{"id": "TSTST-2025-4", "contest": "TSTST", "year": "2025", "problem_number": "4", "problem": "Let \\(n \\geq 2\\) be a positive integer. Let \\(a_{1}, a_{2}, \\ldots, a_{n}\\) be a sequence of positive integers such that\n\\[\n\\operatorname{gcd}\\left(a_{1}, a_{2}\\right), \\operatorname{gcd}\\left(a_{2}, a_{3}\\right), \\ldots, \\operatorname{gcd}\\left(a_{n-1}, a_{n}\\right)\n\\]\nis a strictly increasing sequence. Find, in terms of \\(n\\), the maximum possible value of\n\\[\n\\frac{1}{a_{1}}+\\frac{1}{a_{2}}+\\cdots+\\frac{1}{a_{n}}\n\\]\nover all such sequences.", "solution": "We claim the maximum possible value is 2 . To see that this is achievable, let the sequence \\(\\left(a_{i}\\right)_{i=1}^{n}\\) be \\(1,2,4, \\ldots, 2^{n-2}, 2^{n-2}\\). Then \\(\\operatorname{gcd}\\left(a_{i}, a_{i+1}\\right)=2^{i-1}\\), which is an increasing sequence, and it is easy to check that \\(\\sum \\frac{1}{a_{i}}=2\\). We now show this is the maximum.\n\nLet \\(d_{i}=\\operatorname{gcd}\\left(a_{i}, a_{i+1}\\right)\\). Since \\(d_{i-1}<d_{i}\\), we have that \\(\\frac{a_{i}}{d_{i-1}}>\\frac{a_{i}}{d_{i}}\\). But these are both integers, so we get that\n\\[\n1 \\leq \\frac{a_{i}}{d_{i-1}}-\\frac{a_{i}}{d_{i}} \\Longrightarrow \\frac{1}{a_{i}} \\leq \\frac{1}{d_{i-1}}-\\frac{1}{d_{i}}\n\\]\nAdding everything up, we get that\n\\[\n\\sum_{i=1}^{n} \\frac{1}{a_{i}} \\leq \\frac{1}{a_{1}}+\\frac{1}{d_{1}}-\\frac{1}{d_{n-1}}+\\frac{1}{a_{n}} .\n\\]\nBut \\(d_{n-1} \\mid a_{n}\\), so \\(d_{n-1} \\leq a_{n}\\), and \\(\\frac{1}{d_{n-1}} \\geq \\frac{1}{a_{n}}\\). Thus, this sum is at most \\(\\frac{1}{a_{1}}+\\frac{1}{d_{1}} \\leq 2\\).", "source_pdf": "TSTST_2025.pdf", "notes": ""}
{"id": "TSTST-2025-5", "contest": "TSTST", "year": "2025", "problem_number": "5", "problem": "A tetrahedron \\(A B C D\\) is said to be angelic if it has nonzero volume and satisfies\n\\[\n\\begin{aligned}\n& \\angle B A C+\\angle C A D+\\angle D A B=\\angle A B C+\\angle C B D+\\angle D B A, \\\\\n& \\angle A C B+\\angle B C D+\\angle D C A=\\angle A D B+\\angle B D C+\\angle C D A .\n\\end{aligned}\n\\]\nAcross all angelic tetrahedrons, what is the maximum number of distinct lengths that could appear in the set \\(\\{A B, A C, A D, B C, B D, C D\\}\\) ?", "solution": "We claim the maximum cardinality is 4 . This is attained by taking a non-square rectangle (or parallelogram) \\(A C B D\\) and folding it along diagonal \\(A B\\), creating edges \\(A B\\) and \\(C D\\) in the process. Here, \\(A C=B D\\) and \\(A D=B C\\), while every other length is distinct in the general case. This tetrahedron is congruent to itself under the permutation of vertices \\((A, B, C, D) \\mapsto(B, A, D, C)\\), and we can verify that the required angle conditions follow from this symmetry.\n\nIn the other direction, let \\(f(X)\\) denote the sum of the angles at \\(X\\), so the conditions of the problem statement can be written as \\(f(A)=f(B)\\) and \\(f(C)=f(D)\\). Unfold the three faces that meet at \\(D\\) to create a net of the tetrahedron. Along with the face \\(\\triangle A B C\\), we also create the faces \\(\\triangle A B D_{1}, \\triangle B C D_{2}\\), and \\(\\triangle A C D_{3}\\). Note that\n\\(f(A)+f(B)+f(C)+f(D)\\) is the sum of all of the angles of all four faces of the tetrahedron, which is \\(720^{\\circ}\\). Therefore, \\(f(A)=f(B)=360^{\\circ}-f(C)=360^{\\circ}-f(D)\\). Furthermore, we have that \\(\\angle D_{1} A D_{3}=f(A)\\) and \\(\\angle D_{2} C D_{3}=360^{\\circ}-f(C)\\). Since \\(A D_{1}=A D_{3}\\) and \\(C D_{2}=C D_{3}\\) by the definition of unfolding, this gives \\(\\triangle D_{3} A D_{1} \\sim \\triangle D_{3} C D_{2}\\). Thus, due to spiral similarity, we have \\(\\triangle D_{3} A C \\sim \\triangle D_{3} D_{1} D_{2}\\).\n\nSimilarly, we also have \\(\\triangle D_{2} B D_{1} \\sim \\triangle D_{2} C D_{3} \\Longrightarrow \\triangle C B D_{2} \\sim \\triangle D_{3} D_{1} D_{2}\\). This means that \\(\\triangle C B D_{2} \\sim \\triangle D_{3} A C\\), and since \\(C D_{3}=C D_{2}\\), the two triangles are actually congruent. Therefore, \\(A C=B D_{2}=B D\\) and \\(B C=A D_{3}=A D\\). Since we have two pairs of equal edge lengths, the number of distinct edge lengths is at most 4 , as desired.", "source_pdf": "TSTST_2025.pdf", "notes": ""}
{"id": "TSTST-2025-6", "contest": "TSTST", "year": "2025", "problem_number": "6", "problem": "Alice and Bob play a game on \\(n\\) vertices labelled \\(1,2, \\ldots, n\\). They take turns adding edges \\(\\{i, j\\}\\), with Alice going first. Neither player is allowed to make a move that creates a cycle, and the game ends after \\(n-1\\) total turns.\n\nLet the weight of the edge \\(\\{i, j\\}\\) be \\(|i-j|\\), and let \\(W\\) be the total weight of all edges at the end of the game. Alice plays to maximize \\(W\\) and Bob plays to minimize \\(W\\). If both play optimally, what will \\(W\\) be?", "solution": "If Solution Let \\(k=\\left\\lceil\\frac{n-1}{2}\\right\\rceil\\). The answer is\n\\[\n\\frac{1}{2}(k+1)(2 n-k-2)=(n-k-1)+(n-k)+\\cdots+(n-1) .\n\\]\nWhen \\(n=1\\), this is clear.\nConsider now when \\(n \\geq 2\\). Note that the game consists of \\(n-1\\) moves, with Alice making \\(k\\) moves and Bob making \\(n-k-1\\) moves.\n\nWe first show Alice can guarantee a total of at least \\(\\frac{1}{2}(k+1)(2 n-k-2)\\).\nClaim - Alice can ensure her \\(i\\) th move is an edge of weight at least \\(n-i\\).\n\nProof. On her first move, Alice chooses the edge \\((1, n)\\), which has weight \\(n-1\\). Now, consider the \\(i\\) th move, for \\(i>1\\).\n\nConsider the induced subgraph on vertices \\(\\{1, \\ldots, i\\} \\sqcup\\{n-i+1, \\ldots, n\\}\\). (Note that \\(i<n-i+1\\) for all \\(1 \\leq i \\leq k\\).) Before Alice's \\(i\\) th move, exactly \\(2 i-2\\) moves have been made, so since this subgraph has \\(2 i\\) vertices, it is disconnected.\n\nTake a vertex \\(j\\) such that \\(j\\) and 1 are in different connected components. Since Alice's first move is \\((1, n), j\\) is also not connected to \\(n\\). Now, if \\(j \\in\\{1, \\ldots, i\\}\\), Alice adds \\((j, n)\\), otherwise Alice adds \\((1, j)\\).\n\nSince each of Bob's edges has weight at least 1 , his edges in total have weight at least \\(n-k-1\\). Thus, Alice can ensure a total weight of at least \\((n-k-1)+(n-k)+\\cdots+(n-1)\\).\n\nWe now give a strategy for Bob.\nClaim - Bob can ensure that for each \\(1 \\leq i \\leq k\\), there are at most \\(i\\) edges of weight at least \\(n-i\\), while only adding edges of weight 1 .\n\nProof. For \\(i=1\\), this is clear. Consider \\(i>1\\). As above, consider the induced subgraph on vertices \\(\\{1, \\ldots, i\\} \\sqcup\\{n-i+1, \\ldots, n\\}\\) before Bob's \\((i-1)\\) st move.\n\nWe show that there exists some edge of weight 1 in this subgraph that Bob can choose. Suppose not. Then, since none of \\((1,2), \\ldots,(i-1, i)\\) are valid moves, the vertices \\(1, \\ldots, i\\) are connected. Likewise, the vertices \\((n-i+1, \\ldots, n)\\) are connected.\n\nHence, there are at least \\(2(i-1)\\) edges in this subgraph. However, only \\(2 i-3\\) moves have been played up to this point, contradiction. So, Bob can choose an edge of weight 1 in this subgraph.\n\nWhen \\(n\\) is even, Bob makes \\(k-1\\) moves, so this accounts for all his moves. When \\(n\\) is odd, on the final move, since not all the vertices are connected, there exists some edge of weight 1 that Bob can add.\n\nThus, Bob can select only edges of weight 1 . Now, following the above strategy, for any \\(1 \\leq i \\leq k\\), Bob chooses at least \\(k-1\\) edges in the induced subgraph on vertices \\(\\{1, \\ldots, i\\} \\cup\\{n-i+1, \\ldots, n\\}\\). Since the induced subgraph contains no cycles, Alice plays at most \\((2 i-1)-(i-1)=i\\) edges in this subgraph.\n\nNow, note that any edge of weight at least \\(n-i\\) must have both vertices contained in this subgraph. Thus, there are at most \\(i\\) edges of weight at least \\(n-i\\), as desired. (When \\(n>2, n-i \\geq n-k>1\\), and when \\(n=2\\), Bob plays no edges, so the bound still holds.)\n\nUsing the above strategy, the total weight of Bob's edges is \\(n-k-1\\). Let \\(a_{i}\\) be the number of edges Alice plays of weight at least \\(i\\). Then, the total weight of Alice's edges is\n\\[\n\\begin{aligned}\n\\sum_{i=1}^{n-1} a_{i} & \\leq k(n-k-1)+\\sum_{i=n-k}^{n-1} a_{i} \\\\\n& \\leq k(n-k-1)+(k+(k-1)+\\cdots+1) \\\\\n& =(n-1)+(n-2)+\\cdots+(n-k)\n\\end{aligned}\n\\]\n\nThus, Bob can ensure a total weight of at most \\((n-k-1)+(n-k)+\\cdots+(n-1)\\).", "source_pdf": "TSTST_2025.pdf", "notes": ""}
{"id": "TSTST-2025-7", "contest": "TSTST", "year": "2025", "problem_number": "7", "problem": "For a positive real number \\(c\\), the sequence \\(a_{1}, a_{2}, \\ldots\\) of real numbers is defined as follows. Let \\(a_{1}=c\\), and for \\(n \\geq 2\\), let\n\\[\na_{n}=\\sum_{i=1}^{n-1}\\left(a_{i}\\right)^{n-i+1} .\n\\]\nFind all positive real numbers \\(c\\) such that \\(a_{i}>a_{i+1}\\) for all positive integers \\(i\\).", "solution": "If Solution (author) The answer is \\(c<\\frac{\\sqrt{5}-1}{2}\\).\nTo show this is necessary, note that \\(a_{2}=c^{2}\\) and \\(a_{3}=c^{3}+c^{4}\\), so if the sequence is decreasing, we have \\(c^{2}>c^{3}+c^{4}\\), implying \\(c<\\frac{\\sqrt{5}-1}{2}\\).\n\nIn the other direction, suppose \\(c\\) is a positive real number with \\(c<\\frac{\\sqrt{5}-1}{2}\\). We will apply strong induction. We have\n\\[\n\\begin{aligned}\n& a_{1}=c \\\\\n& a_{2}=c^{2} \\\\\n& a_{3}=c^{3}+c^{4}\n\\end{aligned}\n\\]\nso \\(a_{1}>a_{2}\\) (since \\(c<1\\) ) and \\(a_{2}>a_{3}\\) (since \\(c<\\frac{\\sqrt{5}-1}{2}\\) ). For the inductive step, we'll show \\(a_{n}>a_{n+1}\\) assuming that \\(n \\geq 3\\) and \\(a_{i}>a_{i+1}\\) for all \\(i<n\\). We have\n\\[\na_{1}^{n}=c^{n}>c^{n}\\left(c+c^{2}\\right)>c^{n}\\left(c+c^{n}\\right)=a_{1}^{n+1}+a_{2}^{n}\n\\]\nAlso, since \\(a_{i}>a_{i+1}\\) for \\(i=2, \\ldots, n-1\\), we have\n\\[\n\\sum_{i=2}^{n-1} a_{i}^{n-i+1}>\\sum_{i=2}^{n-1} a_{i+1}^{n-i+1}=\\sum_{j=3}^{n} a_{j}^{n-j+2},\n\\]\nwhere the equality comes from shifting indices to take \\(j=i+1\\). Thus\n\\[\na_{n}=a_{1}^{n}+\\sum_{i=2}^{n-1} a_{i}^{n-i+1}>a_{1}^{n+1}+a_{2}^{n}+\\sum_{j=3}^{n} a_{j}^{n-j+2}=a_{n+1},\n\\]\nas desired. This completes the induction step, finishing the solution.\nRemark (author). The behavior of the sequence for other values of \\(c\\) is interesting. In particular, computer experiments seem to indicate that, for \\(c=0.655736876792\\), the sequence starting from \\(a_{2}\\) increases to a value barely less than \\(\\frac{1}{2}\\) and then decreases, going to 0 as \\(n \\rightarrow \\infty\\), while for \\(c=0.655736876793\\), the sequence starting from \\(a_{2}\\) is increasing and goes to infinity. We conjecture that some form of these patterns hold in general, and that there should exist some value of \\(c\\) with \\(0.655736876792<c<0.655736876793\\) so that the sequence starting from \\(a_{2}\\) is increasing and \\(\\lim _{n \\rightarrow \\infty} a_{n}=\\frac{1}{2}\\).\n\nIf Solution (Pitchayut) We get \\(c<\\frac{\\sqrt{5}-1}{2}\\) in the same way as the first solution. To show that any such \\(c\\) gives a strictly decreasing sequence, we use induction on \\(n\\). The base cases of \\(n=1,2\\) are clear. Let \\(t=\\frac{\\sqrt{5}-1}{2}\\), then \\(t^{2}+t=1\\). For the inductive step, assume \\(n \\geq 3\\) and \\(a_{1}>a_{2}>\\cdots>a_{n-1}\\). Since \\(t>a_{1}, t\\) is greater than \\(a_{1}, a_{2}, \\ldots, a_{n-1}\\). Furthermore, \\(t^{2}>a_{1}^{2}=a_{2} \\geq a_{n-1}\\). Thus\n\\[\n\\begin{aligned}\na_{n} & =a_{1}^{n}+a_{2}^{n-1}+\\cdots+a_{n-1}^{2} \\\\\n& <t\\left(a_{1}^{n-1}+a_{2}^{n-2}+\\cdots+a_{n-2}^{2}\\right)+t^{2} a_{n-1} \\\\\n& =t a_{n-1}+t^{2} a_{n-1} \\\\\n& =a_{n-1}\n\\end{aligned}\n\\]\nas desired.", "source_pdf": "TSTST_2025.pdf", "notes": ""}
{"id": "TSTST-2025-8", "contest": "TSTST", "year": "2025", "problem_number": "8", "problem": "Find all polynomials \\(f\\) with integer coefficients such that for all positive integers \\(n\\),\n\\[\nn \\text { divides } \\underbrace{f(f(\\ldots(f(0)) \\ldots)}_{n+1 \\text { f's }}-1 \\text {. }\n\\]", "solution": "There are three families.\n- \\(f(x)=x+1\\).\n- \\(f(x)=x(x-1) g(x)+1\\) for any polynomial \\(g(x)\\) (i.e., any \\(f(x)\\) such that \\(f(0)= f(1)=1\\) ).\n- \\(f(x)=x(x-1)(x+1) g(x)+\\left(2 x^{2}-1\\right)\\) for any polynomial \\(g(x)\\) (i.e., any \\(f(x)\\) such that \\(f(0)=-1, f(-1)=f(1)=1\\) ).\n\nThese all clearly work, so we focus on proving that these are all solutions.\nClaim - For any prime \\(p\\), either\n(a) \\(f(1) \\equiv 1(\\bmod p)\\) or\n(b) the directed graph of \\(f\\) in \\(\\mathbb{F}_{p}\\) forms a single cycle of size \\(p\\).\n\nProof. Work modulo \\(p\\). Consider the sequence\n\\[\n0, f(0), f(f(0)), \\ldots,\n\\]\nwhich must be eventually periodic. Clearly 1 must be in the periodic part by taking \\(n\\) to be a large multiple of \\(p\\). Now, note that since the non-periodic part must have size less than \\(p\\), we have\n\\[\n\\left.\\begin{array}{r}\nf^{p+1}(0)=1 \\\\\nf^{2 p+1}(0)=1\n\\end{array}\\right\\} \\Rightarrow f^{p}(1)=1\n\\]\nso the period must divide \\(p\\) and hence must be either 1 or \\(p\\). If it is 1 , then \\(f(1)=1\\). Otherwise, (b) holds.\n\nNext, we note that if \\(f(x)-x\\) is non-constant, then by Schur's theorem on \\(f(x)-x, f\\) has a fixed point modulo infinitely many primes \\(p\\), so (b) fails for infinitely many primes \\(p\\). This means that (a) holds for infinitely many primes \\(p\\), so \\(f(1)=1\\). Therefore, either \\(f(x)-x\\) is constant or \\(f(1)=1\\).\n\nIn the case that \\(f(x)-x\\) a constant \\(c, f^{n+1}(0)-1=(n+1) c-1\\), so \\(n \\mid c-1\\) for all \\(n\\) and \\(f(x)=x+1\\). Henceforth, assume \\(f(1)=1\\).\n\nSince \\(f(0) \\mid f^{k}(0)\\) for all \\(k\\), plugging in \\(n=|f(0)|\\) gives\n\\[\nf(0)\\left|f^{|f(0)|+1}(0)-1 \\Longrightarrow f(0)\\right| 1 \\Longrightarrow f(0)= \\pm 1 \\text {. }\n\\]\n\nIf \\(f(0)=1\\), then we are done. Otherwise, assume \\(f(0)=-1\\). Then, \\(f(-1)\\) is odd because \\(f(1)=1\\), so plugging in \\(n=|f(-1)|=2 k-1\\) gives\n\\[\nf(-1) \\mid f^{2 k}(0)-1 .\n\\]\n\nWe have that \\(f^{2}(0)=0\\) modulo \\(f(-1)=f^{2}(0)\\), so \\(f(-1) \\mid 1\\). This gives \\(f(-1)= \\pm 1\\). If \\(f(-1)=-1\\), then we have \\(f^{n}(0)=-1\\) for all \\(n \\geq 3\\), which makes the divisibility condition fail. Hence, \\(f(-1)=1\\), and we get the third solution set.\n\nRemark (author). An easier variant is to ask for all polynomials \\(f\\) with integer coefficients such that \\(n \\mid f^{n}(0)\\) for all positive integers \\(n\\).", "source_pdf": "TSTST_2025.pdf", "notes": ""}
{"id": "TSTST-2025-9", "contest": "TSTST", "year": "2025", "problem_number": "9", "problem": "Let acute triangle \\(A B C\\) have orthocenter \\(H\\). Let \\(B_{1}, C_{1}, B_{2}\\), and \\(C_{2}\\) be collinear points which lie on lines \\(A B, A C, B H\\), and \\(C H\\), respectively. Let \\(\\omega_{B}\\) and \\(\\omega_{C}\\) be the circumcircles of triangles \\(B B_{1} B_{2}\\) and \\(C C_{1} C_{2}\\), respectively. Prove that the radical axis of \\(\\omega_{B}\\) and \\(\\omega_{C}\\) intersects the line through their centers on the nine-point circle of triangle \\(A B C\\).", "solution": "If Solution (author) The first important step is to introduce \\(N\\), the circumcenter of \\(H B_{2} C_{2}\\).\n\nClaim - Lines \\(N B_{2}\\) and \\(N C_{2}\\) are tangent to ( \\(B B_{1} B_{2}\\) ) and ( \\(C C_{1} C_{2}\\) ), respectively.\n\nProof. This follows from chasing\n\\[\n\\measuredangle N B_{2} B=\\measuredangle N B_{2} H=90^{\\circ}-\\measuredangle H C_{2} B_{2}=\\measuredangle B_{2} B_{1} B .\n\\]\n\nAn analogous proof works for the other side.\nSince \\(N B_{2}=N C_{2}\\), it follows that \\(N\\) lies on the radical axis of ( \\(B B_{1} B_{2}\\) ) and ( \\(C C_{1} C_{2}\\) ). Thus we want to show \\(X\\), the foot of \\(N\\) onto \\(O_{B} O_{C}\\), lies on the nine-point circle.\n\nLet \\(D, E, F\\) be the feet of the altitudes in \\(\\triangle A B C\\), and let \\(M_{B}, M_{C}\\) be the midpoints of \\(B H, C H\\). Let \\(B_{3}, C_{3}\\) be the second intersections of ( \\(B_{2} C_{2} H\\) ) with ( \\(B B_{1} B_{2}\\) ), ( \\(C C_{1} C_{2}\\) ).\n\nClaim - Hexagons \\(O_{B} B_{2} B_{3} M_{B} X N\\) and \\(O_{C} C_{2} C_{3} M_{C} X N\\) are cyclic.\n\nProof. Clearly \\(B_{2}, B_{3}\\) and \\(X\\) lie on the circle of diameter \\(O_{B} N\\). To show \\(M_{B}\\) lies in this circle, we first note that \\(B B_{3} H F D\\) is cyclic. Indeed, this follows from chasing\n\\[\n\\measuredangle B B_{3} H=\\measuredangle B_{2} B_{3} H-\\measuredangle B_{2} B_{3} B=\\measuredangle B_{2} C_{2} H-\\measuredangle B_{2} B_{1} B=\\measuredangle B_{1} F C_{2}=\\measuredangle B F H .\n\\]\n\nThis circle has center \\(M_{B}\\), so \\(O_{B} M_{B}\\) and \\(M_{B} N\\) are the perpendicular bisectors of \\(B B_{3}\\), \\(B_{3} H\\). Since \\(B B_{3} \\perp B_{3} H, O_{B} M_{B} \\perp M_{B} N\\), as we wanted to show.\n\nNow we are ready to finish. We know \\(\\measuredangle M_{B} D M_{C}=\\measuredangle M_{C} H M_{B}=\\measuredangle B A C\\). We will now show that \\(\\measuredangle M_{B} X M_{C}\\) gives the same value. On one hand\n\\[\n\\measuredangle M_{B} X O_{B}=\\measuredangle M_{B} B_{2} O_{B}=\\measuredangle B B_{2} O_{B}=90^{\\circ}-\\measuredangle B_{2} B_{1} B=90^{\\circ}-\\measuredangle C_{1} B_{1} A .\n\\]\n\nSimilarly \\(\\measuredangle O_{C} X M_{C}=90^{\\circ}-\\measuredangle A C_{1} B_{1}\\), so\n\\[\n\\measuredangle M_{B} X M_{C}=\\left(90^{\\circ}-\\measuredangle C_{1} B_{1} A\\right)+\\left(90^{\\circ}-\\measuredangle A C_{1} B_{1}\\right)=\\measuredangle B A C,\n\\]\nwhich establishes the result.\nRemark (author). Since the problem is symmetric under \\(A \\leftrightarrow H\\), a similar solution can be found by considering the circumcenter of \\(\\triangle A B_{1} C_{1}\\) (instead of \\(N\\) ). Moreover, introducing both circumcenters adds more structure to the diagram, which can make it easier to finish.\n\nThe most important step in this solution is to introduce the point \\(N\\). This can be motivated by noticing that the circles ( \\(B B_{1} B_{2}\\) ) and ( \\(H B_{2} C_{2}\\) ) are orthogonal.\n\nII Moving Points Solution (Krishna) Let \\(E, F\\) be the feet of the \\(B, C\\) altitudes, as in the first solution.\n\nClaim - As \\(\\ell\\) varies while staying parallel to a fixed line, \\(\\overline{O_{B} O_{C}}\\) passes through a fixed point \\(Y\\) on the nine-point circle.\n\nProof. Move \\(\\ell\\) linearly. Then \\(\\triangle B B_{1} B_{2}\\) is dilating at \\(B\\) linearly, so \\(O_{B}\\) moves linearly. Similarly \\(O_{C}\\) moves linearly. Furthermore, we have that\n\\[\n\\measuredangle \\overline{B O_{B}}=90+\\measuredangle B A+\\measuredangle B H-\\measuredangle \\ell=\\measuredangle B A+\\measuredangle B C-\\measuredangle \\ell,\n\\]\nwhich by symmetry means \\(\\overline{B O_{B}} \\| \\overline{C O_{C}}\\). Thus we need to find a point \\(Y\\) on the nine-point circle such that \\(O_{B}-O_{C}-Y\\) in 2 cases.\n\nSuppose \\(\\ell\\) passes through \\(H\\). In that case, let \\(Q=\\left(B B_{1} H\\right) \\cap\\left(C C_{1} H\\right)\\). We get that \\(Q\\) lies on \\((A B C)\\) by chasing\n\\[\n\\measuredangle B Q C=\\measuredangle B Q H+\\measuredangle H Q C=\\measuredangle B B_{1} H+\\measuredangle H C_{1} C=\\measuredangle A B B_{1}+\\measuredangle B C_{1} A=\\measuredangle B A C .\n\\]\n\nThe perpendicular bisector of \\(\\overline{H Q}\\) is \\(\\overline{O_{B} O_{C}}\\), and the midpoint of \\(H Q\\) lies on the nine-point circle. Let the perpendicular from \\(Q\\) to \\(\\overline{H Q}\\) intersect ( \\(A B C\\) ) at \\(Y_{1}\\). Then\n\\[\n\\measuredangle B A Y_{1}=\\measuredangle B Q Y_{1}=90+\\measuredangle B Q H=90+\\measuredangle A B_{1} H,\n\\]\nso \\(\\overline{A Y_{1}} \\perp \\ell\\). If \\(Y\\) is the midpoint of \\(H Y_{1}\\), then \\(Y\\) lies on \\(\\overline{O_{B} O_{C}}\\) and the nine-point circle of \\((A B C)\\). The line between \\(Y\\) and the midpoint of \\(A H\\) is perpendicular to \\(\\ell\\). Hence when \\(\\ell\\) passes through \\(A\\), by symmetry we also get \\(O_{B}-O_{C}-Y\\), as desired (this angle chase is basically done as part of 2019 TSTST 5).\n\nLet \\(P_{\\infty}\\) be the point at infinity of \\(\\ell\\), and let \\(P=r \\cap \\ell\\). Since \\(P B_{1} \\cdot P B_{2}=P C_{1} \\cdot P C_{2}\\) (with signed lengths), we have that \\(\\left(P, P_{\\infty}\\right),\\left(B_{1}, B_{2}\\right),\\left(C_{1}, C_{2}\\right)\\) are 3 pairs under the same involution on \\(\\ell\\). Then by DIT on the 4 points \\(A, H, E, F\\) and the line \\(\\ell\\), if \\(\\mathcal{C}\\) is the conic through \\(A, H, E, F, P_{\\infty}\\), then \\(P\\) also lies on \\(\\mathcal{C}\\). Now we do moving points.\n\n- Let \\(P_{\\infty}\\) be a sufficiently general fixed point at infinity (proving the problem for sufficiently general \\(P_{\\infty}\\) suffices by continuity.\n- Define \\(P\\) as a moving point with degree 2 varying on the conic through \\(A, H, E, F, P_{\\infty}\\).\n- As we let \\(P\\) vary and we let \\(\\ell=\\overline{P P_{\\infty}}\\), we get that \\(\\overline{P P_{\\infty}}\\) has degree 1 so \\(B_{1}\\) has degree 1. The perpendicular bisector of \\(B B_{1}\\) then has degree 1, and \\(\\overline{B O_{B}}\\) is fixed so \\(O_{B}\\) has degree 1.\n- \\(Y\\) has degree 0 , and the antipode \\(Y^{\\prime}\\) of \\(Y\\) on the nine-point circle has degree 0 . It suffices to show that \\(\\overline{Y^{\\prime} P} \\perp \\overline{O_{B} Y}\\).\n- \\(\\overline{Y^{\\prime} P}\\) has degree \\(\\leq 2\\) and \\(\\overline{O_{B} Y}\\) has degree 1 , so we get a degree 3 statement that needs to be checked at 4 cases.\n\nWe can do \\(P=A, H, E, F . P=H\\) and \\(P=A\\) are true by previous work. By symmetry, to solve \\(P=E\\) and \\(P=F\\) we only need to look at \\(P=E\\). In this case, we want to show that \\(E-O_{B}-O_{C}\\).\n\\(\\measuredangle E O_{B}=\\measuredangle B A+\\measuredangle \\ell-\\measuredangle B H=90+\\measuredangle C H+\\measuredangle \\ell-90-\\measuredangle A C=90-90+\\measuredangle E O_{C}=\\measuredangle E O_{C}\\), as desired.\n\nIf Solution (Vivian Loh) Let \\(S_{B}=(B H) \\cap\\left(B B_{1} B_{2}\\right)\\), and \\(S_{C}=(C H) \\cap\\left(C C_{1} C_{2}\\right)\\). Then \\(S_{B}\\) and \\(S_{C}\\) are the Miquel points of complete quadrilaterals \\(\\left\\{B, B_{1}, B_{2}, H, C_{2}, C H \\cap A B\\right\\}\\) and \\(\\left\\{C, C_{1}, C_{2}, H, B_{2}, B H \\cap A C\\right\\}\\) respectively, so \\(S_{B}\\) and \\(S_{C}\\) both lie on ( \\(H B_{2} C_{2}\\) ). Furthermore, by radical center, \\(P=B_{2} S_{B} \\cap C_{2} S_{C}\\) lies on the radical axis of \\(\\omega_{B}, \\omega_{C}\\). Also note that if \\(H^{\\prime}\\) is the antipode of \\(H\\) with respect to \\(\\left(H B_{2} C_{2}\\right)\\), then \\(S_{B}\\) and \\(S_{C}\\) are the projections of \\(H\\) onto \\(B H^{\\prime}\\) and \\(C H^{\\prime}\\), respectively. Note that the 6 points \\(H, B_{2}, C_{2}\\), \\(H^{\\prime}, S_{B}, S_{C}\\) all lie on \\(\\left(H H^{\\prime}\\right)\\).\n\nClaim 3.1 - If \\(O_{B}\\) and \\(O_{C}\\) are the centers of \\(\\omega_{B}\\) and \\(\\omega_{C}\\) respectively, then \\(O_{B}\\) is the intersection of tangents to ( \\(H H^{\\prime}\\) ) at \\(B_{2}\\) and \\(S_{B}\\), while \\(O_{C}\\) is the intersection of tangents to \\(\\left(H H^{\\prime}\\right)\\) at \\(C_{2}\\) and \\(S_{C}\\).\n\nProof. Angle chasing; \\(\\angle B_{2} O_{B} S_{B}=2 \\angle B_{2} B S_{B}=2\\left(90^{\\circ}-\\angle B H S_{B}\\right)=180^{\\circ}-2 \\angle B H S_{B}\\). It works for \\(O_{C}\\) similarly.\n\nClaim \\(3.2-O_{B} O_{C}\\) is the polar of \\(P\\) with respect to \\(\\left(H H^{\\prime}\\right)\\).\n\nProof. By the definition of poles and polars, \\(B_{2} S_{B}\\) is the polar of \\(O_{B}\\) and \\(C_{2} S_{C}\\) is the polar of \\(O_{C}\\), and by La Hire's, we know that a point lies on the polar of \\(O_{B}\\) and the polar of \\(O_{C}\\) if and only if \\(O_{B}\\) and \\(O_{C}\\) both lie on its polar, so \\(O_{B} O_{C}\\) is the polar of \\(B_{2} S_{B} \\cap C_{2} S_{C}=P\\).\n\nSince \\(P\\) lies on the radical axis of \\(\\omega_{B}\\) and \\(\\omega_{C}\\), the desired point in the problem (the intersection of the radical axis and \\(O_{B} O_{C}\\) ) is the foot from \\(P\\) to \\(O_{B} O_{C}\\), which is the inverse \\(P^{*}\\) of \\(P\\) about ( \\(H H^{\\prime}\\) ). It suffices to show that this point lies on the nine-point circle of \\(\\triangle A B C\\).\n\nLet \\(M_{B}\\) and \\(M_{C}\\) be the midpoints of \\(H B\\) and \\(H C\\). Then the nine-point circle of \\(\\triangle A B C\\) passes through \\(M_{B}, M_{C}\\), and the foot from \\(H\\) to \\(B C\\), so \\(P^{*}\\) lies on this nine-point circle if and only if \\(\\angle M_{B} P^{*} M_{C}=\\angle B H C\\).\n\nClaim \\(3.3-M_{B}^{*} \\in B_{2} S_{B}, M_{C}^{*} \\in C_{2} S_{C}\\).\n\nProof. This is simply angle chasing. We will show that \\(M_{C}^{*} \\in C_{2} S_{C}\\). Let \\(O\\) be the center of ( \\(H H^{\\prime}\\) ). Then \\(\\angle O M_{C} H=\\angle O H M_{C}^{*}\\), which equals \\(\\angle O S_{C} M_{C}^{*}\\) since \\(O M_{C} \\perp H S_{C}\\). However, \\(\\angle O S_{C} C_{2}=\\angle H S_{C} C_{2}-\\angle H S_{C} O=\\angle\\left(H C_{2}, S_{C} H^{\\prime}\\right)=\\angle O M_{C} H\\), so \\(M_{C}^{*} \\in C_{2} S_{C}\\), and \\(M_{B}^{*}\\) follows similarly.\n\nThe last part is just angle chasing. We know from before that it is sufficient to show \\(\\angle M_{B} P^{*} M_{C}=\\angle B H C\\). We have: \\(\\angle M_{B} P^{*} M_{C}=\\angle O P^{*} M_{B}+\\angle O P^{*} M_{C}=\\angle O M_{B}^{*} P+ \\angle O M_{C}^{*} P=360^{\\circ}-\\angle M_{B}^{*} O M_{C}^{*}-\\angle M_{B}^{*} P M_{C}^{*}=360^{\\circ}-\\angle S_{C} P S_{B}-\\angle S_{C} H^{\\prime} S_{B}=\\angle H^{\\prime} S_{B} P+ \\angle H^{\\prime} S_{C} P=\\angle B_{2} H C_{2}=\\angle B H C\\), as desired.", "source_pdf": "TSTST_2025.pdf", "notes": ""}
{"id": "USAMO-2016-1", "contest": "USAMO", "year": "2016", "problem_number": "1", "problem": "Let \\(X_{1}, X_{2}, \\ldots, X_{100}\\) be a sequence of mutually distinct nonempty subsets of a set \\(S\\). Any two sets \\(X_{i}\\) and \\(X_{i+1}\\) are disjoint and their union is not the whole set \\(S\\), that is, \\(X_{i} \\cap X_{i+1}=\\emptyset\\) and \\(X_{i} \\cup X_{i+1} \\neq S\\), for all \\(i \\in\\{1, \\ldots, 99\\}\\). Find the smallest possible number of elements in \\(S\\).", "solution": "Solution with Danielle Wang: the answer is that \\(|S| \\geq 8\\). Proof that \\(|S| \\geq 8\\) is necessary. Since we must have \\(2^{|S|} \\geq 100\\), we must have \\(|S| \\geq 7\\). To see that \\(|S|=8\\) is the minimum possible size, consider a chain on the set \\(S= \\{1,2, \\ldots, 7\\}\\) satisfying \\(X_{i} \\cap X_{i+1}=\\emptyset\\) and \\(X_{i} \\cup X_{i+1} \\neq S\\). Because of these requirements any subset of size 4 or more can only be neighbored by sets of size 2 or less, of which there are \\(\\binom{7}{1}+\\binom{7}{2}=28\\) available. Thus, the chain can contain no more than 29 sets of size 4 or more and no more than 28 sets of size 2 or less. Finally, since there are only \\(\\binom{7}{3}=35\\) sets of size 3 available, the total number of sets in such a chain can be at most \\(29+28+35=92<100\\), contradiction. Construction. We will provide an inductive construction for a chain of subsets \\(X_{1}, X_{2}, \\ldots, X_{2^{n-1}+1}\\) of \\(S=\\{1, \\ldots, n\\}\\) satisfying \\(X_{i} \\cap X_{i+1}=\\varnothing\\) and \\(X_{i} \\cup X_{i+1} \\neq S\\) for each \\(n \\geq 4\\). For \\(S=\\{1,2,3,4\\}\\), the following chain of length \\(2^{3}+1=9\\) will work: \\[ \\begin{array}{lllllllll} 34 & 1 & 23 & 4 & 12 & 3 & 14 & 2 & 13 . \\end{array} \\] Now, given a chain of subsets of \\(\\{1,2, \\ldots, n\\}\\) the following procedure produces a chain of subsets of \\(\\{1,2, \\ldots, n+1\\}\\) : 1. take the original chain, delete any element, and make two copies of this chain, which now has even length; 2. glue the two copies together, joined by \\(\\varnothing\\) in between; and then 3. insert the element \\(n+1\\) into the sets in alternating positions of the chain starting with the first. For example, the first iteration of this construction gives: \\begin{tabular}{ccccccccc} 345 & 1 & 235 & 4 & 125 & 3 & 145 & 2 & 5 \\ 34 & 15 & 23 & 45 & 12 & 35 & 14 & 25 & \\end{tabular} It can be easily checked that if the original chain satisfies the requirements, then so does the new chain, and if the original chain has length \\(2^{n-1}+1\\), then the new chain has length \\(2^{n}+1\\), as desired. This construction yields a chain of length 129 when \\(S=\\{1,2, \\ldots, 8\\}\\). Remark. Here is the construction for \\(n=8\\) in its full glory. \\begin{tabular}{|l|l|l|l|l|l|l|l|l|} \\hline 345678 & 1 & 235678 & 4 & 125678 & 3 & 145678 & 2 & 5678 \\\\ \\hline 34 & 15678 & 23 & 45678 & 12 & 35678 & 14 & 678 & \\\\ \\hline 345 & 1678 & 235 & 4678 & 125 & 3678 & 145 & 2678 & 5 \\\\ \\hline 34678 & 15 & 23678 & 45 & 12678 & 35 & 78 & & \\\\ \\hline 3456 & 178 & 2356 & 478 & 1256 & 378 & 1456 & 278 & 56 \\\\ \\hline 3478 & 156 & 2378 & 456 & 1278 & 356 & 1478 & 6 & \\\\ \\hline 34578 & 16 & 23578 & 46 & 12578 & 36 & 14578 & 26 & 578 \\\\ \\hline 346 & 1578 & 236 & 4578 & 126 & 8 & & & \\\\ \\hline 34567 & 18 & 23567 & 48 & 12567 & 38 & 14567 & 28 & 567 \\\\ \\hline 348 & 1567 & 238 & 4567 & 128 & 3567 & 148 & 67 & \\\\ \\hline 3458 & 167 & 2358 & 467 & 1258 & 367 & 1458 & 267 & 58 \\\\ \\hline 3467 & 158 & 2367 & 458 & 1267 & 358 & 7 & & \\\\ \\hline 34568 & 17 & 23568 & 47 & 12568 & 37 & 14568 & 27 & 568 \\\\ \\hline 347 & 1568 & 237 & 4568 & 127 & 3568 & 147 & 68 & \\\\ \\hline 3457 & 168 & 2357 & 468 & 1257 & 368 & 1457 & 268 & 57 \\\\ \\hline 3468 & 157 & 2368 & 457 & 1268 & & & & \\\\ \\hline \\end{tabular}", "source_pdf": "USAMO_2016.pdf", "notes": ""}
{"id": "USAMO-2016-2", "contest": "USAMO", "year": "2016", "problem_number": "2", "problem": "Prove that for any positive integer \\(k\\), \\[ \\left(k^{2}\\right)!\\cdot \\prod_{j=0}^{k-1} \\frac{j!}{(j+k)!} \\] is an integer.", "solution": "We show the exponent of any given prime \\(p\\) is nonnegative in the expression. Recall that the exponent of \\(p\\) in \\(n!\\) is equal to \\(\\sum_{i \\geq 1}\\left\\lfloor n / p^{i}\\right\\rfloor\\). In light of this, it suffices to show that for any prime power \\(q\\), we have \\[ \\left\\lfloor\\frac{k^{2}}{q}\\right\\rfloor+\\sum_{j=0}^{k-1}\\left\\lfloor\\frac{j}{q}\\right\\rfloor \\geq \\sum_{j=0}^{k-1}\\left\\lfloor\\frac{j+k}{q}\\right\\rfloor \\] Since both sides are integers, we show \\[ \\left\\lfloor\\frac{k^{2}}{q}\\right\\rfloor+\\sum_{j=0}^{k-1}\\left\\lfloor\\frac{j}{q}\\right\\rfloor>-1+\\sum_{j=0}^{k-1}\\left\\lfloor\\frac{j+k}{q}\\right\\rfloor \\] If we denote by \\(\\{x\\}\\) the fractional part of \\(x\\), then \\(\\lfloor x\\rfloor=x-\\{x\\}\\) so it's equivalent to \\[ \\left\\{\\frac{k^{2}}{q}\\right\\}+\\sum_{j=0}^{k-1}\\left\\{\\frac{j}{q}\\right\\}<1+\\sum_{j=0}^{k-1}\\left\\{\\frac{j+k}{q}\\right\\} \\] However, the sum of remainders when \\(0,1, \\ldots, k-1\\) are taken modulo \\(q\\) is easily seen to be less than the sum of remainders when \\(k, k+1, \\ldots, 2 k-1\\) are taken modulo \\(q\\). So \\[ \\sum_{j=0}^{k-1}\\left\\{\\frac{j}{q}\\right\\} \\leq \\sum_{j=0}^{k-1}\\left\\{\\frac{j+k}{q}\\right\\} \\] follows, and we are done upon noting \\(\\left\\{k^{2} / q\\right\\}<1\\).", "source_pdf": "USAMO_2016.pdf", "notes": ""}
{"id": "USAMO-2016-3", "contest": "USAMO", "year": "2016", "problem_number": "3", "problem": "Let \\(A B C\\) be an acute triangle and let \\(I_{B}, I_{C}\\), and \\(O\\) denote its \\(B\\)-excenter, \\(C\\) excenter, and circumcenter, respectively. Points \\(E\\) and \\(Y\\) are selected on \\(\\overline{A C}\\) such that \\(\\angle A B Y=\\angle C B Y\\) and \\(\\overline{B E} \\perp \\overline{A C}\\). Similarly, points \\(F\\) and \\(Z\\) are selected on \\(\\overline{A B}\\) such that \\(\\angle A C Z=\\angle B C Z\\) and \\(\\overline{C F} \\perp \\overline{A B}\\). Lines \\(I_{B} F\\) and \\(I_{C} E\\) meet at \\(P\\). Prove that \\(\\overline{P O}\\) and \\(\\overline{Y Z}\\) are perpendicular.", "solution": "We present two solutions. If First solution. Let \\(I_{A}\\) denote the \\(A\\)-excenter and \\(I\\) the incenter. Then let \\(D\\) denote the foot of the altitude from \\(A\\). Suppose the \\(A\\)-excircle is tangent to \\(\\overline{B C}, \\overline{A B}, \\overline{A C}\\) at \\(A_{1}, B_{1}, C_{1}\\) and let \\(A_{2}, B_{2}, C_{2}\\) denote the reflections of \\(I_{A}\\) across these points. Let \\(S\\) denote the circumcenter of \\(\\triangle I I_{B} I_{C}\\). We begin with the following observation: Claim - Points \\(D, I, A_{2}\\) are collinear. Similarly, points \\(E, I_{C}, C_{2}\\) are collinear and points \\(F, I_{B}, B_{2}\\) are collinear. Proof. This basically follows from the \"midpoints of altitudes\" lemma. To see \\(D, I, A_{2}\\) are collinear, recall first that \\(\\overline{I A_{1}}\\) passes through the midpoint \\(M\\) of \\(\\overline{A D}\\). Now since \\(\\overline{A D} \\| \\overline{I_{A} A_{2}}\\), and \\(M\\) and \\(A_{1}\\) are the midpoints of \\(\\overline{A D}\\) and \\(\\overline{I_{A} A_{2}}\\), it follows from the collinearity of \\(A, I, I_{A}\\) that \\(D, I, A_{2}\\) are collinear as well. The other two claims follow in a dual fashion. For example, using the homothety taking the \\(A\\) to \\(C\\)-excircle, we find that \\(\\overline{C_{1} I_{C}}\\) bisects the altitude \\(\\overline{B E}\\). (The homothety at \\(B\\) will send \\(C_{1}\\) to the point on the \\(C\\)-excircle which is diametrically opposite the foot from \\(I_{C}\\) to \\(A C\\). This diameter of the \\(C\\)-excircle is then mapped through homothety through \\(C_{1}\\) onto the \\(B\\)-altitude.) Then since \\(I_{C}, B, I_{A}\\) are collinear the same argument now gives \\(I_{C}, E, C_{2}\\) are collinear. The fact that \\(I_{B}, F, B_{2}\\) are collinear is symmetric. Observe that \\(\\overline{B_{2} C_{2}}\\left\\|\\overline{B_{1} C_{1}}\\right\\| \\overline{I_{B} I_{C}}\\). Proceeding similarly on the other sides, we discover \\(\\triangle I I_{B} I_{C}\\) and \\(\\triangle A_{2} B_{2} C_{2}\\) are homothetic. Hence \\(P\\) is the center of this homothety (in particular, \\(D, I, P, A_{2}\\) are collinear). Moreover, \\(P\\) lies on the line joining \\(I_{A}\\) to \\(S\\), which is the Euler line of \\(\\triangle I I_{B} I_{C}\\), so it passes through the nine-point center of \\(\\triangle I I_{B} I_{C}\\), which is \\(O\\). Consequently, \\(P, O, I_{A}\\) are collinear as well. To finish, we need only prove that \\(\\overline{O S} \\perp \\overline{Y Z}\\). In fact, we claim that \\(\\overline{Y Z}\\) is the radical axis of the circumcircles of \\(\\triangle A B C\\) and \\(\\triangle I I_{B} I_{C}\\). Actually, \\(Y\\) is the radical center of these two circumcircles and the circle with diameter \\(\\overline{I I_{B}}\\) (which passes through \\(A\\) and \\(C)\\). Analogously \\(Z\\) is the radical center of the circumcircles and the circle with diameter \\(\\overline{I I_{C}}\\), and the proof is complete. IT Second solution (barycentric, outline, Colin Tang). we are going to use barycentric coordinates to show that the line through \\(O\\) perpendicular to \\(\\overline{Y Z}\\) is concurrent with \\(\\overline{I_{B} F}\\) and \\(\\overline{I_{C} E}\\). The displacement vector \\(\\overrightarrow{Y Z}\\) is proportional to \\((a(b-c):-b(a+c): c(a+b))\\), and so by strong perpendicularity criterion and doing a calculation gives the line \\[ x(b-c) b c(a+b+c)+y(a+c) a c(a+b-c)+z(a+b) a b(-a+b-c)=0 \\] On the other hand, line \\(I_{C} E\\) has equation \\[ 0=\\operatorname{det}\\left[\\begin{array}{ccc} a & b & -c \\\\ S_{C} & 0 & S_{A} \\\\ x & y & z \\end{array}\\right]=b S_{a} \\cdot x+\\left(-c S_{C}-a S_{A}\\right) \\cdot y+\\left(-b S_{C}\\right) \\cdot z \\] and similarly for \\(I_{B} F\\). Consequently, concurrence of these lines is equivalent to \\[ \\operatorname{det}\\left[\\begin{array}{ccc} b S_{A} & -c S_{C}-a S_{A} & -b S_{C} \\\\ c S_{A} & -c S_{B} & -a S_{A}-b S_{B} \\\\ (b-c) b c(a+b+c) & (a+c) a c(a+b-c) & (a+b) a b(-a+b-c) \\end{array}\\right]=0 \\] which is a computation. IT Authorship comments. I was intrigued by a Taiwan TST problem which implied that, in the configuration above, \\(\\angle I_{B} D I_{C}\\) was bisected by \\(\\overline{D A}\\). This motivated me to draw all three properties above where \\(I_{A}\\) and \\(P\\) were isogonal conjugates with respect to \\(D E F\\). After playing around with this picture for a long time, I finally noticed that \\(O\\) was on line \\(P I_{A}\\). (So the original was to show that \\(I_{B} F, I_{C} E, D A_{2}\\) concurrent). Eventually I finally noticed in the picture that \\(P I_{A}\\) actually passed through the circumcenter of \\(A B C\\) as well. This took me many hours to prove. The final restatement (which follows quickly from \\(P, O, I_{A}\\) collinear) was discovered by Telv Cohl when I showed him the problem.", "source_pdf": "USAMO_2016.pdf", "notes": ""}
{"id": "USAMO-2016-4", "contest": "USAMO", "year": "2016", "problem_number": "4", "problem": "Find all functions \\(f: \\mathbb{R} \\rightarrow \\mathbb{R}\\) such that for all real numbers \\(x\\) and \\(y\\), \\[ (f(x)+x y) \\cdot f(x-3 y)+(f(y)+x y) \\cdot f(3 x-y)=(f(x+y))^{2} . \\]", "solution": "We claim that the only two functions satisfying the requirements are \\(f(x) \\equiv 0\\) and \\(f(x) \\equiv x^{2}\\). These work. First, taking \\(x=y=0\\) in the given yields \\(f(0)=0\\), and then taking \\(x=0\\) gives \\(f(y) f(-y)=f(y)^{2}\\). So also \\(f(-y)^{2}=f(y) f(-y)\\), from which we conclude \\(f\\) is even. Then taking \\(x=-y\\) gives \\[ \\forall x \\in \\mathbb{R}: \\quad f(x)=x^{2} \\quad \\text { or } \\quad f(4 x)=0 \\] for all \\(x\\). Remark. Note that an example of a function satisfying ( \\(\\boldsymbol{\\star}\\) ) is \\[ f(x)= \\begin{cases}x^{2} & \\text { if }|x|<1 \\\\ 1-\\cos \\left(\\frac{\\pi}{2} \\cdot x^{1337}\\right) & \\text { if } 1 \\leq|x|<4 \\\\ 0 & \\text { if }|x| \\geq 4\\end{cases} \\] So, yes, we are currently in a world of trouble, still. (This function is even continuous; I bring this up to emphasize that \"continuity\" is completely unrelated to the issue at hand.) Now we claim Claim \\(-f(z)=0 \\Longleftrightarrow f(2 z)=0 \\quad\\) (A). Proof. Let \\((x, y)=(3 t, t)\\) in the given to get \\[ \\left(f(t)+3 t^{2}\\right) f(8 t)=f(4 t)^{2} . \\] Now if \\(f(4 t) \\neq 0\\) (in particular, \\(t \\neq 0\\) ), then \\(f(8 t) \\neq 0\\). Thus we have ( \\(\\mathbf{\\mathbf { 4 }}\\) ) in the reverse direction. Then \\(f(4 t) \\neq 0 \\stackrel{(\\star)}{\\Longrightarrow} f(t)=t^{2} \\neq 0 \\stackrel{( }{(\\mathbf{A})} f(2 t) \\neq 0\\) implies the forwards direction, the last step being the reverse direction ( \\(\\mathbf{0}\\) ). By putting together ( \\(\\boldsymbol{\\star}\\) ) and ( \\(\\boldsymbol{\\phi}\\) ) we finally get \\[ \\forall x \\in \\mathbb{R}: \\quad f(x)=x^{2} \\quad \\text { or } \\quad f(x)=0 \\] We are now ready to approach the main problem. Assume there's an \\(a \\neq 0\\) for which \\(f(a)=0\\); we show that \\(f \\equiv 0\\). Let \\(b \\in \\mathbb{R}\\) be given. Since \\(f\\) is even, we can assume without loss of generality that \\(a, b>0\\). Also, note that \\(f(x) \\geq 0\\) for all \\(x\\) by ( \\(\\odot\\) ). By using ( \\(\\boldsymbol{\\phi}\\) ) we can generate \\(c>b\\) such that \\(f(c)=0\\) by taking \\(c=2^{n} a\\) for a large enough integer \\(n\\). Now, select \\(x, y>0\\) such that \\(x-3 y=b\\) and \\(x+y=c\\). That is, \\[ (x, y)=\\left(\\frac{3 c+b}{4}, \\frac{c-b}{4}\\right) \\] Substitution into the original equation gives \\[ 0=(f(x)+x y) f(b)+(f(y)+x y) f(3 x-y) \\geq(f(x)+x y) f(b) \\] But since \\(f(b) \\geq 0\\), it follows \\(f(b)=0\\), as desired.", "source_pdf": "USAMO_2016.pdf", "notes": ""}
{"id": "USAMO-2016-5", "contest": "USAMO", "year": "2016", "problem_number": "5", "problem": "An equilateral pentagon \\(A M N P Q\\) is inscribed in triangle \\(A B C\\) such that \\(M \\in \\overline{A B}\\), \\(Q \\in \\overline{A C}\\), and \\(N, P \\in \\overline{B C}\\). Let \\(S\\) be the intersection of \\(\\overline{M N}\\) and \\(\\overline{P Q}\\). Denote by \\(\\ell\\) the angle bisector of \\(\\angle M S Q\\). Prove that \\(\\overline{O I}\\) is parallel to \\(\\ell\\), where \\(O\\) is the circumcenter of triangle \\(A B C\\), and \\(I\\) is the incenter of triangle \\(A B C\\).", "solution": "T First solution (complex). In fact, we only need \\(A M=A Q=N P\\) and \\(M N=Q P\\). We use complex numbers with \\(A B C\\) the unit circle, assuming WLOG that \\(A, B, C\\) are labeled counterclockwise. Let \\(x, y, z\\) be the complex numbers corresponding to the arc midpoints of \\(B C, C A, A B\\), respectively; thus \\(x+y+z\\) is the incenter of \\(\\triangle A B C\\). Finally, let \\(s>0\\) be the side length of \\(A M=A Q=N P\\). Then, since \\(M A=s\\) and \\(M A \\perp O Z\\), it follows that \\[ m-a=i \\cdot s z . \\] Similarly, \\(p-n=i \\cdot s y\\) and \\(a-q=i \\cdot s x\\), so summing these up gives \\[ i \\cdot s(x+y+z)=(p-q)+(m-n)=(m-n)-(q-p) \\] Since \\(M N=P Q\\), the argument of \\((m-n)-(q-p)\\) is along the external angle bisector of the angle formed, which is perpendicular to \\(\\ell\\). On the other hand, \\(x+y+z\\) is oriented in the same direction as \\(O I\\), as desired. If Second solution (trig, Danielle Wang). Let \\(\\delta\\) and \\(\\epsilon\\) denote \\(\\angle M N B\\) and \\(\\angle C P Q\\). Also, assume \\(A M N P Q\\) has side length 1. In what follows, assume \\(A B<A C\\). First, we note that \\[ \\begin{aligned} B N & =(c-1) \\cos B+\\cos \\delta, \\\\ C P & =(b-1) \\cos C+\\cos \\epsilon, \\text { and } \\\\ a & =1+B N+C P \\end{aligned} \\] from which it follows that \\[ \\cos \\delta+\\cos \\epsilon=\\cos B+\\cos C-1 \\] Also, by the Law of Sines, we have \\(\\frac{c-1}{\\sin \\delta}=\\frac{1}{\\sin B}\\) and similarly on triangle \\(C P Q\\), and from this we deduce \\[ \\sin \\epsilon-\\sin \\delta=\\sin B-\\sin C \\] The sum-to-product formulas \\[ \\begin{aligned} \\sin \\epsilon-\\sin \\delta & =2 \\cos \\left(\\frac{\\epsilon+\\delta}{2}\\right) \\sin \\left(\\frac{\\epsilon-\\delta}{2}\\right) \\\\ \\cos \\epsilon-\\cos \\delta & =2 \\cos \\left(\\frac{\\epsilon+\\delta}{2}\\right) \\cos \\left(\\frac{\\epsilon-\\delta}{2}\\right) \\end{aligned} \\] give us \\[ \\tan \\left(\\frac{\\epsilon-\\delta}{2}\\right)=\\frac{\\sin \\epsilon-\\sin \\delta}{\\cos \\epsilon-\\cos \\delta}=\\frac{\\sin B-\\sin C}{\\cos B+\\cos C-1} \\] Now note that \\(\\ell\\) makes an angle of \\(\\frac{1}{2}(\\pi+\\epsilon-\\delta)\\) with line \\(B C\\). Moreover, if line \\(O I\\) intersects line \\(B C\\) with angle \\(\\varphi\\) then \\[ \\tan \\varphi=\\frac{r-R \\cos A}{\\frac{1}{2}(b-c)} \\] So in order to prove the result, we only need to check that \\[ \\frac{r-R \\cos A}{\\frac{1}{2}(b-c)}=\\frac{\\cos B+\\cos C+1}{\\sin B-\\sin C} \\] Using the fact that \\(b=2 R \\sin B, c=2 R \\sin C\\), this reduces to the fact that \\(r / R+1= \\cos A+\\cos B+\\cos C\\), which is the so-called Carnot theorem.", "source_pdf": "USAMO_2016.pdf", "notes": ""}
{"id": "USAMO-2016-6", "contest": "USAMO", "year": "2016", "problem_number": "6", "problem": "Integers \\(n\\) and \\(k\\) are given, with \\(n \\geq k \\geq 2\\). You play the following game against an evil wizard. The wizard has \\(2 n\\) cards; for each \\(i=1, \\ldots, n\\), there are two cards labeled \\(i\\). Initially, the wizard places all cards face down in a row, in unknown order. You may repeatedly make moves of the following form: you point to any \\(k\\) of the cards. The wizard then turns those cards face up. If any two of the cards match, the game is over and you win. Otherwise, you must look away, while the wizard arbitrarily permutes the \\(k\\) chosen cards and then turns them back face-down. Then, it is your turn again. We say this game is winnable if there exist some positive integer \\(m\\) and some strategy that is guaranteed to win in at most \\(m\\) moves, no matter how the wizard responds. For which values of \\(n\\) and \\(k\\) is the game winnable?", "solution": "The game is winnable if and only if \\(k<n\\). First, suppose \\(2 \\leq k<n\\). Query the cards in positions \\(\\{1, \\ldots, k\\}\\), then \\(\\{2, \\ldots, k+1\\}\\), and so on, up to \\(\\{2 n-k+1,2 n\\}\\). Indeed, by taking the difference of the \\(i\\) th and \\((i+1)\\) st query, we can deduce the value of the \\(i\\) th card, for \\(1 \\leq i \\leq 2 n-k\\). (This is possible because the cards are flipped face up before they are re-shuffled, so even if two adjacent queries return the same set, one can still determine the \\(i\\) th card. It is possible to solve the problem even without the flipped information, though.) If \\(k \\leq n\\), this is more than \\(n\\) cards, so we can find a matching pair. For \\(k=n\\) we remark the following: at each turn after the first, assuming one has not won, there are \\(n\\) cards representing each of the \\(n\\) values exactly once, such that the player has no information about the order of those \\(n\\) cards. We claim that consequently the player cannot guarantee victory. Indeed, let \\(S\\) denote this set of \\(n\\) cards, and \\(\\bar{S}\\) the other \\(n\\) cards. The player will never win by picking only cards in \\(S\\) or \\(\\bar{S}\\). Also, if the player selects some cards in \\(S\\) and some cards in \\(\\bar{S}\\), then it is possible that the choice of cards in \\(S\\) is exactly the complement of those selected from \\(\\bar{S}\\); the strategy cannot prevent this since the player has no information on \\(S\\). This implies the result.", "source_pdf": "USAMO_2016.pdf", "notes": ""}
{"id": "USAMO-2017-1", "contest": "USAMO", "year": "2017", "problem_number": "1", "problem": "Prove that there exist infinitely many pairs of relatively prime positive integers \\(a, b>1\\) for which \\(a+b\\) divides \\(a^{b}+b^{a}\\).", "solution": "One construction: let \\(d \\equiv 1(\\bmod 4), d>1\\). Let \\(x=\\frac{d^{d}+2^{d}}{d+2}\\). Then set\n\\[\na=\\frac{x+d}{2}, \\quad b=\\frac{x-d}{2}\n\\]\nTo see this works, first check that \\(b\\) is odd and \\(a\\) is even. Let \\(d=a-b\\) be odd. Then:\n\\[\n\\begin{aligned}\na+b \\mid a^{b}+b^{a} & \\Longleftrightarrow(-b)^{b}+b^{a} \\equiv 0 \\quad(\\bmod a+b) \\\\\n& \\Longleftrightarrow b^{a-b} \\equiv 1 \\quad(\\bmod a+b) \\\\\n& \\Longleftrightarrow b^{d} \\equiv 1 \\quad(\\bmod d+2 b) \\\\\n& \\Longleftrightarrow(-2)^{d} \\equiv d^{d}(\\bmod d+2 b) \\\\\n& \\Longleftrightarrow d+2 b \\mid d^{d}+2^{d} .\n\\end{aligned}\n\\]\nSo it would be enough that\n\\[\nd+2 b=\\frac{d^{d}+2^{d}}{d+2} \\Longrightarrow b=\\frac{1}{2}\\left(\\frac{d^{d}+2^{d}}{d+2}-d\\right)\n\\]\nwhich is what we constructed. Also, since \\(\\operatorname{gcd}(x, d)=1\\) it follows \\(\\operatorname{gcd}(a, b)=\\operatorname{gcd}(d, b)=\\) 1.\n\nRemark. Ryan Kim points out that in fact, \\((a, b)=(2 n-1,2 n+1)\\) is always a solution.", "source_pdf": "USAMO_2017.pdf", "notes": ""}
{"id": "USAMO-2017-2", "contest": "USAMO", "year": "2017", "problem_number": "2", "problem": "Let \\(m_{1}, m_{2}, \\ldots, m_{n}\\) be a collection of \\(n\\) positive integers, not necessarily distinct. For any sequence of integers \\(A=\\left(a_{1}, \\ldots, a_{n}\\right)\\) and any permutation \\(w=w_{1}, \\ldots, w_{n}\\) of \\(m_{1}, \\ldots, m_{n}\\), define an \\(A\\)-inversion of \\(w\\) to be a pair of entries \\(w_{i}, w_{j}\\) with \\(i<j\\) for which one of the following conditions holds:\n- \\(a_{i} \\geq w_{i}>w_{j}\\),\n- \\(w_{j}>a_{i} \\geq w_{i}\\), or\n- \\(w_{i}>w_{j}>a_{i}\\).\n\nShow that, for any two sequences of integers \\(A=\\left(a_{1}, \\ldots, a_{n}\\right)\\) and \\(B=\\left(b_{1}, \\ldots, b_{n}\\right)\\), and for any positive integer \\(k\\), the number of permutations of \\(m_{1}, \\ldots, m_{n}\\) having exactly \\(k A\\)-inversions is equal to the number of permutations of \\(m_{1}, \\ldots, m_{n}\\) having exactly \\(k B\\)-inversions.", "solution": "The following solution was posted by Michael Ren, and I think it is the most natural one (since it captures all the combinatorial ideas using a \\(q\\)-generating function that is easier to think about, and thus makes the problem essentially a long computation).\n\nDenote by \\(M\\) our multiset of \\(n\\) positive integers. Define an inversion of a permutation to be pair \\(i<j\\) with \\(w_{i}<w_{j}\\) (which is a \\((0, \\ldots, 0)\\)-inversion in the problem statement); this is the usual definition (see https://en.wikipedia.org/wiki/Inversion_(discrete_ mathematics)). So we want to show the number of \\(A\\)-inversions is equal to the number of usual inversions. In what follows we count permutations on \\(M\\) with multiplicity: so \\(M=\\{1,1,2\\}\\) still has \\(3!=6\\) permutations.\n\nWe are going to do what is essentially recursion, but using generating functions in a variable \\(q\\) to do our book-keeping. (Motivation: there's no good closed form for the number of inversions, but there's a great generating function known - which is even better for us, since we're only trying to show two numbers are equal!) First, we prove two claims.\n\nClaim - For any positive integer \\(n\\), the generating function for the number of permutations of \\((1,2, \\ldots, n)\\) with exactly \\(k\\) inversions is\n\\[\nn!_{q}:=1 \\cdot(1+q) \\cdot\\left(1+q+q^{2}\\right) \\cdot \\ldots\\left(1+q+\\cdots+q^{n-1}\\right) .\n\\]\nHere we mean that the coefficient of \\(q^{s}\\) above gives the number of permutations with exactly \\(s\\) inversions.\n\nProof. This is an induction on \\(n\\), with \\(n=1\\) being trivial. Suppose we choose the first element to be \\(i\\), with \\(1 \\leq i \\leq n\\). Then there will always be exactly \\(i-1\\) inversions using the first element, so this contributes \\(q^{i} \\cdot(n-1)!_{q}\\). Summing \\(1 \\leq i \\leq n\\) gives the result.\n\nUnfortunately, the main difficulty of the problem is that there are repeated elements, which makes our notation much more horrific.\n\nLet us define the following. We take our given multiset \\(M\\) of \\(n\\) positive integers, we suppose the distinct numbers are \\(\\theta_{1}<\\theta_{2}<\\cdots<\\theta_{m}\\). We let \\(e_{i}\\) be the number of times \\(\\theta_{i}\\) appears. Therefore the multiplicities \\(e_{i}\\) should have sums\n\\[\ne_{1}+\\cdots+e_{m}=n\n\\]\nand \\(m\\) denotes the number of distinct elements. Finally, we let\n\\[\nF\\left(e_{1}, \\ldots, e_{m}\\right)=\\sum_{\\text {permutations } \\sigma} q^{\\text {number inversions of } \\sigma}\n\\]\nbe the associated generating function for the number of inversions. For example, the first claim we proved says that \\(F(1, \\ldots, 1)=n!q_{q}\\).\n\nClaim - We have the explicit formula\n\\[\nF\\left(e_{1}, \\ldots, e_{m}\\right)=n!_{q} \\cdot \\prod_{i=1}^{m} \\frac{e_{i}!}{e_{i}!_{q}}\n\\]\n\nProof. First suppose we perturb all the elements slightly, so that they are no longer equal. Then the generating function would just be \\(n!_{q}\\).\n\nThen, we undo the perturbations for each group, one at a time, and claim that we get the above \\(e_{i}!_{q}\\) factor each time. Indeed, put the permutations into classes of \\(e_{1}!\\) each where permutations in the same classes differ only in the order of the perturbed \\(\\theta_{1}\\) 's (with the other \\(n-e_{1}\\) elements being fixed). Then there is a factor of \\(e_{1}!_{q}\\) from each class, owing to the slightly perturbed inversions we added within each class. So we remove that factor and add \\(e_{1}!\\cdot q^{0}\\) instead. This accounts for the first term of the product.\n\nRepeating this now with each term of the product implies the claim.\nThus we have the formula for the number of inversions in general. We wish to show this also equals the generating function the number of \\(A\\)-inversions, for any fixed choice of \\(A\\). This will be an induction by \\(n\\), with the base case being immediate.\n\nFor the inductive step, fix \\(A\\), and assume the first element satisfies \\(\\theta_{k} \\leq a_{1}<\\theta_{k+1}\\) (so \\(0 \\leq k \\leq m\\); we for convenience set \\(\\theta_{0}=-\\infty\\) and \\(\\left.\\theta_{m}=+\\infty\\right)\\). We count the permutations based on what the first element \\(\\theta_{i}\\) of the permutation is. Then:\n- Consider permutations starting with \\(\\theta_{i} \\in\\left\\{\\theta_{1}, \\ldots, \\theta_{k}\\right\\}\\). Then the number of inversions which will use this first term is \\(\\left(e_{1}+\\cdots+e_{i-1}\\right)+\\left(e_{k+1}+\\cdots+e_{m}\\right)\\). Also, there are \\(e_{i}\\) ways to pick which \\(\\theta_{i}\\) gets used as the first term. So we get a contribution of\n\\[\nq^{e_{1}+\\cdots+e_{i-1}+\\left(e_{k+1}+\\cdots+e_{m}\\right)} \\cdot e_{i} \\cdot F\\left(e_{1}, \\ldots, e_{i}-1, \\ldots, e_{m}\\right)\n\\]\nin this case (with inductive hypothesis to get the last \\(F\\)-term).\n- Now suppose \\(\\theta_{i} \\in\\left\\{\\theta_{k+1}, \\ldots, \\theta_{m}\\right\\}\\). Then the number of inversions which will use this first term is \\(e_{k+1}+\\cdots+e_{i-1}\\). Thus by a similar argument the contribution is\n\\[\nq^{e_{k+1}+\\cdots+e_{i-1}} \\cdot e_{i} \\cdot F\\left(e_{1}, \\ldots, e_{i}-1, \\ldots, e_{m}\\right)\n\\]\n\nTherefore, to complete the problem it suffices to prove\n\\[\n\\sum_{i=1}^{k} q^{\\left(e_{1}+\\cdots+e_{i-1}\\right)+\\left(e_{k+1}+\\cdots+e_{m}\\right)} \\cdot e_{i} \\cdot F\\left(e_{1}, \\ldots, e_{i}-1, \\ldots, e_{m}\\right)\n\\]\n\\[\n\\begin{aligned}\n& +\\sum_{i=k+1}^{m} q^{e_{k+1}+\\cdots+e_{i-1}} \\cdot e_{i} \\cdot F\\left(e_{1}, \\ldots, e_{i}-1, \\ldots, e_{m}\\right) \\\\\n& =F\\left(e_{1}, \\ldots, e_{m}\\right)\n\\end{aligned}\n\\]\n\nNow, we see that\n\\[\n\\frac{e_{i} \\cdot F\\left(e_{1}, \\ldots, e_{i}-1, \\ldots, e_{m}\\right)}{F\\left(e_{1}, \\ldots, e_{m}\\right)}=\\frac{1+\\cdots+q^{e_{i}-1}}{1+q+\\cdots+q^{n-1}}=\\frac{1-q^{e_{i}}}{1-q^{n}}\n\\]\nso it's equivalent to show\n\\[\n1-q^{n}=q^{e_{k+1}+\\cdots+e_{m}} \\sum_{i=1}^{k} q^{e_{1}+\\cdots+e_{i-1}}\\left(1-q^{e_{i}}\\right)+\\sum_{i=k+1}^{m} q^{e_{k+1}+\\cdots+e_{i-1}}\\left(1-q^{e_{i}}\\right)\n\\]\nwhich is clear, since the left summand telescopes to \\(q^{e_{k+1}+\\cdots+e_{m}}-q^{n}\\) and the right summand telescopes to \\(1-q^{e_{k+1}+\\cdots+e_{m}}\\).\n\nRemark. Technically, we could have skipped straight to the induction, without proving the first two claims. However I think the solution reads more naturally this way.", "source_pdf": "USAMO_2017.pdf", "notes": ""}
{"id": "USAMO-2017-3", "contest": "USAMO", "year": "2017", "problem_number": "3", "problem": "Let \\(A B C\\) be a scalene triangle with circumcircle \\(\\Omega\\) and incenter \\(I\\). Ray \\(A I\\) meets \\(\\overline{B C}\\) at \\(D\\) and \\(\\Omega\\) again at \\(M\\); the circle with diameter \\(\\overline{D M}\\) cuts \\(\\Omega\\) again at \\(K\\). Lines \\(M K\\) and \\(B C\\) meet at \\(S\\), and \\(N\\) is the midpoint of \\(\\overline{I S}\\). The circumcircles of \\(\\triangle K I D\\) and \\(\\triangle M A N\\) intersect at points \\(L_{1}\\) and \\(L_{2}\\). Prove that \\(\\Omega\\) passes through the midpoint of either \\(\\overline{I L_{1}}\\) or \\(\\overline{I L_{2}}\\).", "solution": "Let \\(W\\) be the midpoint of \\(\\overline{B C}\\), let \\(X\\) be the point on \\(\\Omega\\) opposite \\(M\\). Observe that \\(\\overline{K D}\\) passes through \\(X\\), and thus lines \\(B C, M K, X A\\) concur at the orthocenter of \\(\\triangle D M X\\), which we call \\(S\\). Denote by \\(I_{A}\\) the \\(A\\)-excenter of \\(A B C\\).\n\nNext, let \\(E\\) be the foot of the altitude from \\(I\\) to \\(\\overline{X I_{A}}\\); observe that \\(E\\) lies on the circle centered at \\(M\\) through \\(I, B, C, I_{A}\\). Then, \\(S\\) is the radical center of \\(\\Omega\\) and the circles with diameter \\(\\overline{I X}\\) and \\(\\overline{I I_{A}}\\); hence line \\(S I\\) passes through \\(E\\); accordingly \\(I\\) is the orthocenter of \\(\\triangle X S I_{A}\\); denote by \\(L\\) the foot from \\(X\\) to \\(\\overline{S I_{A}}\\).\n\nWe claim that this \\(L\\) lies on both the circumcircle of \\(\\triangle K I D\\) and \\(\\triangle M A N\\). It lies on the circumcircle of \\(\\triangle M A N\\) since this circle is the nine-point circle of \\(\\triangle X S I_{A}\\). Also, \\(X D \\cdot X K=X W \\cdot X M=X A \\cdot X S=X I \\cdot X L\\), so \\(K D I L\\) are concyclic.\n\nAll that remains to show is that the midpoint \\(T\\) of \\(\\overline{I L}\\) lies on \\(\\Omega\\). But this follows from the fact that \\(\\overline{T M} \\| \\overline{L I_{A}} \\Longrightarrow \\angle M T X=90^{\\circ}\\), thus the problem is solved.\n\nRemark. Some additional facts about this picture: the point \\(T\\) is the contact point of the \\(A\\)-mixtilinear incircle (since it is collinear with \\(X\\) and \\(I\\) ), while the point \\(K\\) is such that \\(\\overline{A K}\\) is an \\(A\\)-symmedian (since \\(\\overline{K D}\\) and \\(\\overline{A D}\\) bisect \\(\\angle A\\) and \\(\\angle K\\), say).\n\nRemark. In fact, the point \\(L\\) is the Miquel point of cyclic quadrilateral \\(I_{B} I_{C} B C\\) (inscribed in the circle with diameter \\(\\left.\\overline{I_{B} I_{C}}\\right)\\). This implies many of the properties that \\(L\\) has above. For example, it directly implies that \\(L\\) lies on the circumcircles of triangles \\(I_{A} I_{B} I_{C}\\) and \\(B C I_{A}\\), and that the point \\(L\\) lies on \\(\\overline{S I_{A}}\\) (since \\(S=\\overline{B C} \\cap \\overline{I_{B} I_{C}}\\) ). For this reason, many students found it easier to think about the problem in terms of \\(\\triangle I_{A} I_{B} I_{C}\\) rather than \\(\\triangle A B C\\).", "source_pdf": "USAMO_2017.pdf", "notes": ""}
{"id": "USAMO-2017-4", "contest": "USAMO", "year": "2017", "problem_number": "4", "problem": "Let \\(P_{1}, P_{2}, \\ldots, P_{2 n}\\) be \\(2 n\\) distinct points on the unit circle \\(x^{2}+y^{2}=1\\), other than \\((1,0)\\). Each point is colored either red or blue, with exactly \\(n\\) red points and \\(n\\) blue points. Let \\(R_{1}, R_{2}, \\ldots, R_{n}\\) be any ordering of the red points. Let \\(B_{1}\\) be the nearest blue point to \\(R_{1}\\) traveling counterclockwise around the circle starting from \\(R_{1}\\). Then let \\(B_{2}\\) be the nearest of the remaining blue points to \\(R_{2}\\) traveling counterclockwise around the circle from \\(R_{2}\\), and so on, until we have labeled all of the blue points \\(B_{1}, \\ldots, B_{n}\\). Show that the number of counterclockwise arcs of the form \\(R_{i} \\rightarrow B_{i}\\) that contain the point ( 1,0 ) is independent of the way we chose the ordering \\(R_{1}, \\ldots, R_{n}\\) of the red points.", "solution": "We present two solutions, one based on swapping and one based on an invariant.\n\nFirst \"local\" solution by swapping two points. Let \\(1 \\leq i<n\\) be any index and consider the two red points \\(R_{i}\\) and \\(R_{i+1}\\). There are two blue points \\(B_{i}\\) and \\(B_{i+1}\\) associated with them.\n\nClaim - If we swap the locations of points \\(R_{i}\\) and \\(R_{i+1}\\) then the new arcs \\(R_{i} \\rightarrow B_{i}\\) and \\(R_{i+1} \\rightarrow B_{i+1}\\) will cover the same points.\n\nProof. Delete all the points \\(R_{1}, \\ldots, R_{i-1}\\) and \\(B_{1}, \\ldots, B_{i-1}\\); instead focus on the positions of \\(R_{i}\\) and \\(R_{i+1}\\).\n\nThe two blue points can then be located in three possible ways: either 0,1 , or 2 of them lie on the \\(\\operatorname{arc} R_{i} \\rightarrow R_{i+1}\\). For each of the cases below, we illustrate on the left the locations of \\(B_{i}\\) and \\(B_{i+1}\\) and the corresponding arcs in green; then on the right we show the modified picture where \\(R_{i}\\) and \\(R_{i+1}\\) have swapped. (Note that by hypothesis there are no other blue points in the green arcs).\n\nCase 1\n\nCase 2\n\nCase 3\n\nObserve that in all cases, the number of arcs covering any given point on the circumference is not changed. Consequently, this proves the claim.\n\nFinally, it is enough to recall that any permutation of the red points can be achieved by swapping consecutive points (put another way: \\((i i+1)\\) generates the permutation group \\(S_{n}\\) ). This solves the problem.\n\nRemark. This proof does not work if one tries to swap \\(R_{i}\\) and \\(R_{j}\\) if \\(|i-j| \\neq 1\\). For example if we swapped \\(R_{i}\\) and \\(R_{i+2}\\) then there are some issues caused by the possible presence of the blue point \\(B_{i+1}\\) in the green arc \\(R_{i+2} \\rightarrow B_{i+2}\\).\n\nIT Second longer solution using an invariant. Visually, if we draw all the segments \\(R_{i} \\rightarrow B_{i}\\) then we obtain a set of \\(n\\) chords. Say a chord is inverted if satisfies the problem condition, and stable otherwise. The problem contends that the number of stable/inverted chords depends only on the layout of the points and not on the choice of chords.\n\nIn fact we'll describe the number of inverted chords explicitly. Starting from \\((1,0)\\) we keep a running tally of \\(R-B\\); in other words we start the counter at 0 and decrement\nby 1 at each blue point and increment by 1 at each red point. Let \\(x \\leq 0\\) be the lowest number ever recorded. Then:\n\nClaim - The number of inverted chords is \\(-x\\) (and hence independent of the choice of chords).\n\nThis is by induction on \\(n\\). I think the easiest thing is to delete chord \\(R_{1} B_{1}\\); note that the arc cut out by this chord contains no blue points. So if the chord was stable certainly no change to \\(x\\). On the other hand, if the chord is inverted, then in particular the last point before ( 1,0 ) was red, and so \\(x<0\\). In this situation one sees that deleting the chord changes \\(x\\) to \\(x+1\\), as desired.", "source_pdf": "USAMO_2017.pdf", "notes": ""}
{"id": "USAMO-2017-5", "contest": "USAMO", "year": "2017", "problem_number": "5", "problem": "Find all real numbers \\(c>0\\) such that there exists a labeling of the lattice points in \\(\\mathbb{Z}^{2}\\) with positive integers for which:\n- only finitely many distinct labels occur, and\n- for each label \\(i\\), the distance between any two points labeled \\(i\\) is at least \\(c^{i}\\).", "solution": "The answer is \\(c<\\sqrt{2}\\). Here is a solution with Calvin Deng.\nThe construction for any \\(c<\\sqrt{2}\\) can be done as follows. Checkerboard color the lattice points and label the black ones with 1 . The white points then form a copy of \\(\\mathbb{Z}^{2}\\) again scaled up by \\(\\sqrt{2}\\) so we can repeat the procedure with 2 on half the resulting points. Continue this dyadic construction until a large \\(N\\) for which \\(c^{N}<2^{\\frac{1}{2}(N-1)}\\), at which point we can just label all the points with \\(N\\).\n\nI'll now prove that \\(c=\\sqrt{2}\\) (and hence \\(c \\geq \\sqrt{2}\\) ) can't be done.\nClaim - It is impossible to fill a \\(2^{n} \\times 2^{n}\\) square with labels not exceeding \\(2 n\\).\nThe case \\(n=1\\) is clear. So now assume it's true up to \\(n-1\\); and assume for contradiction a \\(2^{n} \\times 2^{n}\\) square \\(S\\) only contains labels up to \\(2 n\\). (Of course every \\(2^{n-1} \\times 2^{n-1}\\) square contains an instance of a label at least \\(2 n-1\\).)\n\nNow, we contend there are fewer than four copies of \\(2 n\\) :\n\n\\section*{Lemma}\n\nIn a unit square, among any four points, two of these points have distance \\(\\leq 1\\) apart.\n\nProof. Look at the four rays emanating from the origin and note that two of them have included angle \\(\\leq 90^{\\circ}\\).\n\nSo WLOG the northwest quadrant has no \\(2 n\\) 's. Take a \\(2 n-1\\) in the northwest and draw a square of size \\(2^{n-1} \\times 2^{n-1}\\) directly right of it (with its top edge coinciding with the top of \\(S\\) ). Then \\(A\\) can't contain \\(2 n-1\\), so it must contain a \\(2 n\\) label; that \\(2 n\\) label must be in the northeast quadrant.\n\nThen we define a square \\(B\\) of size \\(2^{n-1} \\times 2^{n-1}\\) as follows. If \\(2 n-1\\) is at least as high \\(2 n\\), let \\(B\\) be a \\(2^{n-1} \\times 2^{n-1}\\) square which touches \\(2 n-1\\) north and is bounded east by \\(2 n\\). Otherwise let \\(B\\) be the square that touches \\(2 n-1\\) west and is bounded north by \\(2 n\\). We then observe \\(B\\) can neither have \\(2 n-1\\) nor \\(2 n\\) in it, contradiction.\n\nRemark. To my knowledge, essentially all density arguments fail because of hexagonal lattice packing.", "source_pdf": "USAMO_2017.pdf", "notes": ""}
{"id": "USAMO-2017-6", "contest": "USAMO", "year": "2017", "problem_number": "6", "problem": "Find the minimum possible value of\n\\[\n\\frac{a}{b^{3}+4}+\\frac{b}{c^{3}+4}+\\frac{c}{d^{3}+4}+\\frac{d}{a^{3}+4}\n\\]\ngiven that \\(a, b, c, d\\) are nonnegative real numbers such that \\(a+b+c+d=4\\).", "solution": "The minimum \\(\\frac{2}{3}\\) is achieved at \\((a, b, c, d)=(2,2,0,0)\\) and cyclic permutations.\nThe problem is an application of the tangent line trick: we observe the miraculous identity\n\\[\n\\frac{1}{b^{3}+4} \\geq \\frac{1}{4}-\\frac{b}{12}\n\\]\nsince \\(12-(3-b)\\left(b^{3}+4\\right)=b(b+1)(b-2)^{2} \\geq 0\\). Moreover,\n\\[\na b+b c+c d+d a=(a+c)(b+d) \\leq\\left(\\frac{(a+c)+(b+d)}{2}\\right)^{2}=4\n\\]\nThus\n\\[\n\\sum_{\\text {cyc }} \\frac{a}{b^{3}+4} \\geq \\frac{a+b+c+d}{4}-\\frac{a b+b c+c d+d a}{12} \\geq 1-\\frac{1}{3}=\\frac{2}{3}\n\\]\n\nRemark. The main interesting bit is the equality at \\((a, b, c, d)=(2,2,0,0)\\). This is the main motivation for trying tangent line trick, since a lower bound of the form \\(\\sum a(1-\\lambda b)\\) preserves the unusual equality case above. Thus one takes the tangent at \\(b=2\\) which miraculously passes through the point \\((0,1 / 4)\\) as well.", "source_pdf": "USAMO_2017.pdf", "notes": ""}
{"id": "USAMO-2018-1", "contest": "USAMO", "year": "2018", "problem_number": "1", "problem": "Let \\(a, b, c\\) be positive real numbers such that \\(a+b+c=4 \\sqrt[3]{a b c}\\). Prove that\n\\[\n2(a b+b c+c a)+4 \\min \\left(a^{2}, b^{2}, c^{2}\\right) \\geq a^{2}+b^{2}+c^{2}\n\\]", "solution": "WLOG let \\(c=\\min (a, b, c)=1\\) by scaling. The given inequality becomes equivalent to\n\\[\n4 a b+2 a+2 b+3 \\geq(a+b)^{2} \\quad \\forall a+b=4(a b)^{1 / 3}-1\n\\]\n\nNow, let \\(t=(a b)^{1 / 3}\\) and eliminate \\(a+b\\) using the condition, to get\n\\[\n4 t^{3}+2(4 t-1)+3 \\geq(4 t-1)^{2} \\Longleftrightarrow 0 \\leq 4 t^{3}-16 t^{2}+16 t=4 t(t-2)^{2}\n\\]\nwhich solves the problem.\nEquality occurs only if \\(t=2\\), meaning \\(a b=8\\) and \\(a+b=7\\), which gives\n\\[\n\\{a, b\\}=\\left\\{\\frac{7 \\pm \\sqrt{17}}{2}\\right\\}\n\\]\nwith the assumption \\(c=1\\). Scaling gives the curve of equality cases.", "source_pdf": "USAMO_2018.pdf", "notes": ""}
{"id": "USAMO-2018-2", "contest": "USAMO", "year": "2018", "problem_number": "2", "problem": "Find all functions \\(f:(0, \\infty) \\rightarrow(0, \\infty)\\) such that\n\\[\nf\\left(x+\\frac{1}{y}\\right)+f\\left(y+\\frac{1}{z}\\right)+f\\left(z+\\frac{1}{x}\\right)=1\n\\]\nfor all \\(x, y, z>0\\) with \\(x y z=1\\).", "solution": "The main part of the problem is to show all solutions are linear. As always, let \\(x=b / c\\), \\(y=c / a, z=a / b\\) (classical inequality trick). Then the problem becomes\n\\[\n\\sum_{\\mathrm{cyc}} f\\left(\\frac{b+c}{a}\\right)=1\n\\]\n\nLet \\(f(t)=g\\left(\\frac{1}{t+1}\\right)\\), equivalently \\(g(s)=f(1 / s-1)\\). Thus \\(g:(0,1) \\rightarrow(0,1)\\) which satisfies \\(\\sum_{\\text {cyc }} g\\left(\\frac{a}{a+b+c}\\right)=1\\), or equivalently\n\\[\ng(a)+g(b)+g(c)=1 \\quad \\forall a+b+c=1 .\n\\]\n\nThe rest of the solution is dedicated to solving this equivalent functional equation in \\(g\\). It is a lot of technical details and I will only outline them (with apologies to the contestants who didn't have that luxury).\n\nClaim - The function \\(g\\) is linear.\n\nProof. This takes several steps, all of which are technical. We begin by proving \\(g\\) is linear over \\([1 / 8,3 / 8]\\).\n- First, whenever \\(a+b \\leq 1\\) we have\n\\[\n1-g(1-(a+b))=g(a)+g(b)=2 g\\left(\\frac{a+b}{2}\\right)\n\\]\n\nHence \\(g\\) obeys Jensen's functional equation over \\((0,1 / 2)\\).\n- Define \\(h:[0,1] \\rightarrow \\mathbb{R}\\) by \\(h(t)=g\\left(\\frac{2 t+1}{8}\\right)-(1-t) \\cdot g(1 / 8)-t \\cdot g(3 / 8)\\), then \\(h\\) satisfies Jensen's functional equation too over \\([0,1]\\). We have also arranged that \\(h(0)=h(1)=0\\), hence \\(h(1 / 2)=0\\) as well.\n- Since\n\\[\nh(t)=h(t)+h(1 / 2)=2 h(t / 2+1 / 4)=h(t+1 / 2)+h(0)=h(t+1 / 2)\n\\]\nfor any \\(t<1 / 2\\), we find \\(h\\) is periodic modulo \\(1 / 2\\). It follows one can extend \\(\\widetilde{h}\\) by\n\\[\n\\widetilde{h}: \\mathbb{R} \\rightarrow \\mathbb{R} \\quad \\text { by } \\quad \\widetilde{h}(t)=h(t-\\lfloor t\\rfloor)\n\\]\nand still satisfy Jensen's functional equation. Because \\(\\widetilde{h}(0)=0\\), it's well-known this implies \\(\\widetilde{h}\\) is additive (because \\(\\widetilde{h}(x+y)=2 \\widetilde{h}((x+y) / 2)=\\widetilde{h}(x)+\\widetilde{h}(y)\\) for any real numbers \\(x\\) to \\(y\\) ).\n\nBut \\(\\widetilde{h}\\) is bounded below on \\([0,1]\\) since \\(g \\geq 0\\), and since \\(\\widetilde{h}\\) is also additive, it follows (well-known) that \\(\\widetilde{h}\\) is linear. Thus \\(h\\) is the zero function. So, the function \\(g\\) is linear over \\([1 / 8,3 / 8]\\); thus we may write \\(g(x)=k x+\\ell\\), valid for \\(1 / 8 \\leq x \\leq 3 / 8\\).\n\nSince \\(3 g(1 / 3)=1\\), it follows \\(k+3 \\ell=1\\).\nFor \\(0<x<1 / 8\\) we have \\(g(x)=2 g(0.15)-g(0.3-x)=2(0.15 k+\\ell)-(k(0.3-x)+\\ell)= k x+\\ell\\), so \\(g\\) is linear over ( \\(0,3 / 8\\) ) as well. Finally, for \\(3 / 8<x<1\\), we use the given equation\n\\[\n1=g\\left(\\frac{1-x}{2}\\right)+g\\left(\\frac{1-x}{2}\\right)+g(x) \\Longrightarrow g(x)=1-2\\left(k \\cdot \\frac{1-x}{2}+\\ell\\right)=k x+\\ell\n\\]\nsince \\(\\frac{1-x}{2}<\\frac{5}{16}<\\frac{3}{8}\\). Thus \\(g\\) is linear over all.\nPutting this back in, we deduce that \\(g(x)=k x+\\frac{1-k}{3}\\) for some \\(k \\in[-1 / 2,1]\\), and so\n\\[\nf(x)=\\frac{k}{x+1}+\\frac{1-k}{3}\n\\]\nfor some \\(k \\in[-1 / 2,1]\\). All such functions work.", "source_pdf": "USAMO_2018.pdf", "notes": ""}
{"id": "USAMO-2018-3", "contest": "USAMO", "year": "2018", "problem_number": "3", "problem": "Let \\(n \\geq 2\\) be an integer, and let \\(\\left\\{a_{1}, \\ldots, a_{m}\\right\\}\\) denote the \\(m=\\varphi(n)\\) integers less than \\(n\\) and relatively prime to \\(n\\). Assume that every prime divisor of \\(m\\) also divides \\(n\\). Prove that \\(m\\) divides \\(a_{1}^{k}+\\cdots+a_{m}^{k}\\) for every positive integer \\(k\\).", "solution": "For brevity, given any \\(n\\), we let \\(A(n)=\\{1 \\leq x \\leq n, \\operatorname{gcd}(x, n)=1\\}\\) (thus \\(|A(n)|=\\varphi(n)\\) ). Also, let \\(S(n, k)=\\sum_{a \\in A(n)} a^{k}\\).\n\nWe will prove the stronger statement (which eliminates the hypothesis on \\(n\\) ).\nClaim - Let \\(n \\geq 2\\) be arbitrary (and \\(k \\geq 0\\) ). If \\(p \\mid n\\), then\n\\[\n\\nu_{p}(\\varphi(n)) \\leq \\nu_{p}(S(n, k))\n\\]\n\nWe start with the special case where \\(n\\) is a prime power.\n\n\\section*{Lemma}\n\nLet \\(p\\) be prime, \\(e \\geq 1, k \\geq 0\\). We always have\n\\[\nS\\left(p^{e}, k\\right)=\\sum_{x \\in A\\left(p^{e}\\right)} x^{k} \\equiv 0 \\quad\\left(\\bmod p^{e-1}\\right)\n\\]\n\nProof. For \\(p\\) odd, this follows by taking a primitive root \\(g\\) modulo \\(p^{e}\\). We will have\n\\[\nS\\left(p^{e}, k\\right) \\equiv 1+g^{k}+g^{2 k}+\\cdots+g^{\\left(\\varphi\\left(p^{e}\\right)-1\\right) k} \\equiv \\frac{g^{\\varphi\\left(p^{e}\\right) k}-1}{g^{k}-1}\n\\]\n\nIf \\(p-1 \\nmid k\\), then the denominator is not divisible by \\(p\\) and hence the entire expression is \\(0\\left(\\bmod p^{e}\\right)\\). In the other case where \\(p-1 \\mid k\\), since \\(\\nu_{p}\\left(\\varphi\\left(p^{e}\\right)\\right)=e-1\\), the exponent lifting lemma implies\n\\[\n\\nu_{p}\\left(\\left(g^{k}\\right)^{\\varphi\\left(p^{e}\\right)}-1\\right)=\\nu_{p}\\left(g^{k}-1\\right)+(e-1)\n\\]\nand so the conclusion is true here too.\nIn the annoying case \\(p=2\\), the proof is broken into two cases: for \\(k\\) odd it follows by pairing \\(x\\) with \\(2^{e}-x\\) and when \\(k\\) is even one can take 5 as a generator of all the quadratic residues as in the \\(p>2\\) case.\n\n\\section*{Corollary}\n\nWe have \\(\\nu_{p}\\left(1^{k}+\\cdots+t^{k}\\right) \\geq \\nu_{p}(t)-1\\) for any \\(k, t, p\\).\n\nProof. Assume \\(p \\mid t\\). Handle the terms in that sum divisible by \\(p\\) (by induction) and apply the lemma a bunch of times.\n\nNow the idea is to add primes \\(q\\) one at a time to \\(n\\), starting from the base case \\(n=p^{e}\\). So, formally we proceed by induction on the number of prime divisors of \\(n\\). We'll also assume \\(k \\geq 1\\) in what follows since the base case \\(k=0\\) is easy.\n- First, suppose we want to go from \\(n\\) to \\(n q\\) where \\(q \\nmid n\\). In that case \\(\\varphi(n q)\\) gained \\(\\nu_{p}(q-1)\\) factors of \\(p\\) and then we need to show \\(\\nu_{p}(S(n q, k)) \\geq \\nu_{p}(\\varphi(n))+\\nu_{p}(q-1)\\). The trick is to write\n\\[\nA(n q)=\\{a+n h \\mid a \\in A(n) \\text { and } h=0, \\ldots, q-1\\} \\backslash q A(n)\n\\]\nand then expand using binomial theorem:\n\\[\n\\begin{aligned}\nS(n q, k) & =\\sum_{a \\in A(n)} \\sum_{h=0}^{q-1}(a+n h)^{k}-\\sum_{a \\in A(n)}(q a)^{k} \\\\\n& =-q^{k} S(n, k)+\\sum_{a \\in A(n)} \\sum_{h=0}^{q-1} \\sum_{j=0}^{k}\\left[\\binom{k}{j} a^{k-j} n^{j} h^{j}\\right] \\\\\n& =-q^{k} S(n, k)+\\sum_{j=0}^{k}\\left[\\binom{k}{j} n^{j}\\left(\\sum_{a \\in A(n)} a^{k-j}\\right)\\left(\\sum_{h=0}^{q-1} h^{j}\\right)\\right] \\\\\n& =-q^{k} S(n, k)+\\sum_{j=0}^{k}\\left[\\binom{k}{j} n^{j} S(n, k-j)\\left(\\sum_{h=1}^{q-1} h^{j}\\right)\\right] .\n\\end{aligned}\n\\]\n\nWe claim every term here has enough powers of \\(p\\). For the first term, \\(S(n, k)\\) has at least \\(\\nu_{p}(\\varphi(n))\\) factors of \\(p\\); and we have the \\(q-q^{k}\\) multiplier out there. For the other terms, we apply induction to \\(S(n, k-j)\\); moreover \\(\\sum_{h=1}^{q-1} h^{j}\\) has at least \\(\\nu_{p}(q-1)-1\\) factors of \\(p\\) by corollary, and we get one more factor of \\(p\\) (at least) from \\(n^{j}\\).\n- On the other hand, if \\(q\\) already divides \\(n\\), then this time\n\\[\nA(n q)=\\{a+n h \\mid a \\in A(n) \\text { and } h=0, \\ldots, q-1\\}\n\\]\nand we have no additional burden of \\(p\\) to deal with; the same calculation gives\n\\[\nS(n q, k)=q S(n, k)+\\sum_{j=1}^{k}\\left[\\binom{k}{j} n^{j} S(n, k-j)\\left(\\sum_{h=1}^{q-1} h^{j}\\right)\\right]\n\\]\nwhich certainly has enough factors of \\(p\\) already.\n\nRemark. A curious bit about the problem is that \\(\\nu_{p}(\\varphi(n))\\) can exceed \\(\\nu_{p}(n)\\), and so it is not true that the residues of \\(A(n)\\) are well-behaved modulo \\(\\varphi(n)\\).\n\nAs an example, let \\(n=2 \\cdot 3 \\cdot 7 \\cdot 13=546\\), so \\(m=\\varphi(n)=1 \\cdot 2 \\cdot 6 \\cdot 12=144\\). Then \\(A(n)\\) contains 26 elements which are \\(1 \\bmod 9\\) and 23 elements which are \\(4 \\bmod 9\\).\n\nRemark. The converse of the problem is true too (but asking both parts would make this too long for exam).", "source_pdf": "USAMO_2018.pdf", "notes": ""}
{"id": "USAMO-2018-4", "contest": "USAMO", "year": "2018", "problem_number": "4", "problem": "Let \\(p\\) be a prime, and let \\(a_{1}, \\ldots, a_{p}\\) be integers. Show that there exists an integer \\(k\\) such that the numbers\n\\[\na_{1}+k, a_{2}+2 k, \\ldots, a_{p}+p k\n\\]\nproduce at least \\(\\frac{1}{2} p\\) distinct remainders upon division by \\(p\\).", "solution": "For each \\(k=0, \\ldots, p-1\\) let \\(G_{k}\\) be the graph on \\(\\{1, \\ldots, p\\}\\) where we join \\(\\{i, j\\}\\) if and only if\n\\[\na_{i}+i k \\equiv a_{j}+j k \\quad(\\bmod p) \\Longleftrightarrow k \\equiv-\\frac{a_{i}-a_{j}}{i-j} \\quad(\\bmod p) .\n\\]\n\nSo we want a graph \\(G_{k}\\) with at least \\(\\frac{1}{2} p\\) connected components.\nHowever, each \\(\\{i, j\\}\\) appears in exactly one graph \\(G_{k}\\), so some graph has at most \\(\\frac{1}{p}\\binom{p}{2}=\\frac{1}{2}(p-1)\\) edges (by \"pigeonhole\"). This graph has at least \\(\\frac{1}{2}(p+1)\\) connected components, as desired.\n\nRemark. Here is an example for \\(p=5\\) showing equality can occur:\n\\[\n\\left[\\begin{array}{lllll}\n0 & 0 & 3 & 4 & 3 \\\\\n0 & 1 & 0 & 2 & 2 \\\\\n0 & 2 & 2 & 0 & 1 \\\\\n0 & 3 & 4 & 3 & 0 \\\\\n0 & 4 & 1 & 1 & 4\n\\end{array}\\right]\n\\]\n\nAnkan Bhattacharya points out more generally that \\(a_{i}=i^{2}\\) is sharp in general.", "source_pdf": "USAMO_2018.pdf", "notes": ""}
{"id": "USAMO-2018-5", "contest": "USAMO", "year": "2018", "problem_number": "5", "problem": "Let \\(A B C D\\) be a convex cyclic quadrilateral with \\(E=\\overline{A C} \\cap \\overline{B D}, F=\\overline{A B} \\cap \\overline{C D}\\), \\(G=\\overline{D A} \\cap \\overline{B C}\\). The circumcircle of \\(\\triangle A B E\\) intersects line \\(C B\\) at \\(B\\) and \\(P\\), and the circumcircle of \\(\\triangle A D E\\) intersects line \\(C D\\) at \\(D\\) and \\(Q\\). Assume \\(C, B, P, G\\) and \\(C\\), \\(Q, D, F\\) are collinear in that order. Let \\(M=\\overline{F P} \\cap \\overline{G Q}\\). Prove that \\(\\angle M A C=90^{\\circ}\\).", "solution": "We present three general routes. (The second route, using the fact that \\(\\overline{A C}\\) is an angle bisector, has many possible variations.)\n\nIT First solution (Miquel points). This is indeed a Miquel point problem, but the main idea is to focus on the self-intersecting cyclic quadrilateral \\(P B Q D\\) as the key player, rather than on the given \\(A B C D\\).\n\nIndeed, we will prove that \\(A\\) is its Miquel point; this follows from the following two claims.\n\nClaim - The self-intersecting quadrilateral \\(P Q D B\\) is cyclic.\n\nProof. By power of a point from \\(C: C Q \\cdot C D=C A \\cdot C E=C B \\cdot C P\\).\n\nClaim - Point \\(E\\) lies on line \\(P Q\\).\n\nProof. \\(\\measuredangle A E P=\\measuredangle A B P=\\measuredangle A B C=\\measuredangle A D C=\\measuredangle A D Q=\\measuredangle A E Q\\).\n![](https://cdn.mathpix.com/cropped/2025_08_23_bbca072b905f08d866b4g-10.jpg?height=804&width=757&top_left_y=1627&top_left_x=651)\n\nTo finish, let \\(H=\\overline{P D} \\cap \\overline{B Q}\\). By properties of the Miquel point, we have \\(A\\) is the foot from \\(H\\) to \\(\\overline{C E}\\). But also, points \\(M, A, H\\) are collinear by Pappus theorem on \\(\\overline{B P G}\\) and \\(\\overline{D Q F}\\), as desired.\n\nSecond solution (projective). We start with a synthetic observation.\nClaim - The line \\(\\overline{A C}\\) bisects \\(\\angle P A D\\) and \\(\\angle B A Q\\).\n\nProof. Angle chase: \\(\\measuredangle P A C=\\measuredangle P A E=\\measuredangle P B E=\\measuredangle C B D=\\measuredangle C A D\\).\nThere are three ways to finish from here:\n- (Michael Kural) Suppose the external bisector of \\(\\angle P A D\\) and \\(\\angle B A Q\\) meet lines \\(B C\\) and \\(D C\\) at \\(X\\) and \\(Y\\). Then\n\\[\n-1=(G P ; X C)=(F D ; Y C)\n\\]\nwhich is enough to imply that \\(\\overline{X Y}, \\overline{G Q}, \\overline{P F}\\) are concurrent (by so-called prism lemma).\n- (Daniel Liu) Alternatively, apply the dual Desargues involution theorem to complete quadrilateral \\(G Q F P C M\\), through the point \\(A\\). This gives that an involutive pairing of\n\\[\n(A C, A M)(A P, A Q)(A G, A F) .\n\\]\n\nThis is easier to see if we project it onto the line \\(\\ell\\) through \\(C\\) perpendicular to \\(\\overline{A C}\\) : let \\(P^{\\prime}, Q^{\\prime}, G^{\\prime}, F^{\\prime}\\) be the images of the last four lines, so \\(C\\) is the common midpoint of \\(\\overline{F^{\\prime} Q^{\\prime}}\\) and \\(\\overline{G^{\\prime} P^{\\prime}}\\). Hence the involution swapping \\(G^{\\prime} \\leftrightarrow F^{\\prime}\\) and \\(P^{\\prime} \\leftrightarrow Q^{\\prime}\\) coincides with negative inversion through \\(C\\) with power \\(\\sqrt{C P^{\\prime} \\cdot C Q^{\\prime}}\\) which implies that \\(\\overline{A M} \\cap \\ell\\) is an infinity point, as desired.\n- (Kada Williams) The official solution instead shows the external angle bisector by a long trig calculation.\n\nIf Third solution (inversion, Andrew Wu). Noting that \\(C E \\cdot C A=C P \\cdot C B=C Q \\cdot C D\\), we perform an inversion at \\(C\\) swapping these pairs of points. The point \\(G\\) is mapped to a point \\(G^{*}\\) ray \\(C B\\) for which \\(Q E G^{*} C\\) is cyclic, but then\n\\[\n\\measuredangle C G^{*} E=\\measuredangle C Q E=\\measuredangle C Q P=\\measuredangle D B C=\\measuredangle C B E\n\\]\nand so we conclude \\(E B=E G^{*}\\). Similarly, \\(E D=E F^{*}\\).\nFinally, \\(M^{*}=\\left(C G^{*} D\\right) \\cap\\left(C F^{*} B\\right) \\neq C\\), and we wish to show that \\(\\angle E M^{*} C=90^{\\circ}\\).\n![](https://cdn.mathpix.com/cropped/2025_08_23_bbca072b905f08d866b4g-11.jpg?height=809&width=592&top_left_y=1833&top_left_x=739)\n\nNote that \\(M^{*}\\) is the center of the spiral similarity sending \\(\\overline{B G^{*}}\\) to \\(\\overline{F^{*} D}\\). Hence it also maps the midpoint \\(K\\) of \\(B G^{*}\\) to the midpoint \\(L\\) of \\(\\overline{F^{*} E}\\). Consequently, \\(M^{*}\\) lies on the circumcircle \\(K L C\\) as well. In other words, \\(E L C K M^{*}\\) is a cyclic pentagon with circumdiameter \\(\\overline{C E}\\), as desired.", "source_pdf": "USAMO_2018.pdf", "notes": ""}
{"id": "USAMO-2018-6", "contest": "USAMO", "year": "2018", "problem_number": "6", "problem": "Let \\(a_{n}\\) be the number of permutations \\(\\left(x_{1}, \\ldots, x_{n}\\right)\\) of \\((1, \\ldots, n)\\) such that the ratios \\(x_{k} / k\\) are all distinct. Prove that \\(a_{n}\\) is odd for all \\(n \\geq 1\\).", "solution": "This is the official solution; the proof has two main insights.\nThe first idea:\n\n\\section*{Lemma}\n\nIf a permutation \\(x\\) works, so does the inverse permutation.\n\nThus it suffices to consider permutations \\(x\\) in which all cycles have length at most 2 . Of course, there can be at most one fixed point (since that gives the ratio 1), and hence exactly one if \\(n\\) is odd, none if \\(n\\) is even.\n\nWe consider the graph \\(K_{n}\\) such that the edge \\(\\{i, j\\}\\) is labeled with \\(i / j\\) (for \\(i<j\\) ). The permutations we're considering are then equivalent to maximal matchings of this \\(K_{n}\\). We call such a matching fantastic if it has all distinct edge labels.\n\nNow the second insight is that if edges \\(a b\\) and \\(c d\\) have the same label for \\(a<b\\) and \\(c<d\\), then so do edges \\(a c\\) and \\(b d\\). Thus:\n\nDefinition. Given a matching \\(\\mathcal{M}\\) as above we say the neighbors of \\(\\mathcal{M}\\) are those other matchings obtained as follows: for each label \\(\\ell\\), we take some disjoint pairs of edges (possibly none) with label \\(\\ell\\) and apply the above switching operation (in which we replace \\(a b\\) and \\(c d\\) with \\(a c\\) and \\(b d\\) ).\n\nThis neighborship relation is reflexive, and most importantly it is symmetric (because one can simply reverse the moves). But it is not transitive.\n\nThe second observation is that:\nClaim - The matching \\(\\mathcal{M}\\) has an odd number of neighbors (including itself) if and only if it is fantastic.\n\nProof. Consider the label \\(\\ell\\), and assume it appears \\(n_{\\ell} \\geq 1\\) times.\nIf we pick \\(k\\) disjoint pairs and swap them, the number of ways to do this is \\(\\binom{n_{\\ell}}{2 k}(2 k-1)!!\\), and so the total number of ways to perform operations on the edges labeled \\(\\ell\\) is\n\\[\n\\sum_{k}\\binom{n_{\\ell}}{2 k}(2 k-1)!!\\equiv \\sum_{k}\\binom{n_{\\ell}}{2 k}=2^{n_{\\ell}-1} \\quad(\\bmod 2) .\n\\]\n\nThis is even if and only if \\(n_{\\ell}>1\\).\nFinally, note that the number of neighbors of \\(\\mathcal{M}\\) is the product across all \\(\\ell\\) of the above. So it is odd if and only if each factor is odd, if and only if \\(n_{\\ell}=1\\) for every \\(\\ell\\).\n\nTo finish, consider a huge simple graph \\(\\Gamma\\) on all the maximal matchings, with edge relations given by neighbor relation (we don't consider vertices to be connected to themselves). Observe that:\n- The fantastic matchings of the vertices of \\(\\Gamma\\) have odd degrees (one less than the neighbor count).\n- The other matchings correspond to isolated vertices (of degree zero, with no other neighbors) of \\(\\Gamma\\).\n- The graph \\(\\Gamma\\) has an even number of vertices of odd degree (this is true for any simple graph, see \"handshake lemma\").\n- The number of vertices of \\(\\Gamma\\) is odd, namely \\((2\\lceil n / 2\\rceil-1)!!\\).\n\nThis concludes the proof.", "source_pdf": "USAMO_2018.pdf", "notes": ""}
{"id": "USAMO-2019-1", "contest": "USAMO", "year": "2019", "problem_number": "1", "problem": "A function \\(f: \\mathbb{N} \\rightarrow \\mathbb{N}\\) satisfies\n\\[\n\\underbrace{f(f(\\ldots f}_{f(n) \\text { times }}(n) \\ldots))=\\frac{n^{2}}{f(f(n))}\n\\]\nfor all positive integers \\(n\\). What are all possible values of \\(f(1000)\\) ?", "solution": "Actually, we classify all such functions: \\(f\\) can be any function which fixes odd integers and acts as an involution on the even integers. In particular, \\(f(1000)\\) may be any even integer.\n\nIt's easy to check that these all work, so now we check they are the only solutions.\nClaim - \\(f\\) is injective.\n\nProof. If \\(f(a)=f(b)\\), then \\(a^{2}=f^{f(a)}(a) f(f(a))=f^{f(b)}(b) f(f(b))=b^{2}\\), so \\(a=b\\).\n\nClaim - We have \\(f(n)=n\\) for every odd integer \\(n \\geq 1\\).\n\nProof. We prove this by induction on odd \\(n \\geq 1\\).\nAssume \\(f\\) fixes \\(S=\\{1,3, \\ldots, n-2\\}\\) now (allowing \\(S=\\varnothing\\) for \\(n=1\\) ). Now we have that\n\\[\nf^{f(n)}(n) \\cdot f^{2}(n)=n^{2} .\n\\]\n\nHowever, neither of the two factors on the left-hand side can be in \\(S\\) since \\(f\\) was injective. Therefore they must both be \\(n\\), and we have \\(f^{2}(n)=n\\).\n\nNow let \\(y=f(n)\\), so \\(f(y)=n\\). Substituting \\(y\\) into the given yields\n\\[\ny^{2}=f^{n}(y) \\cdot y=f^{n+1}(n) \\cdot y=n y\n\\]\nsince \\(n+1\\) is even. We conclude \\(n=y\\), as desired.\n\nRemark (Motivation). After obtaining \\(f(1)=1\\) and \\(f\\) injective, here is one way to motivate where the above proof comes from. From the equation\n\\[\nf^{f(n)}(n) \\cdot f^{2}(n)=n^{2}\n\\]\nit would be natural to consider the case where \\(n\\) is prime, because \\(p^{2}\\) only has a few possible factorizations. In fact, actually because of injectivity and \\(f(1)=1\\), we would need to have\n\\[\nf^{f(p)}(p)=f^{2}(p)=p\n\\]\nin order for the equation to be true. Continuing on as in the proof above, one then gets \\(f(p)=p\\) for odd primes \\(p\\) (but no control over \\(f(2)\\) ).\n\nThe special case of prime \\(n\\) then serves as a foothold by which one can continue the induction towards all numbers \\(n\\), finding the induction works out exactly when the prime 2 never appears.\n\nAs a general point, in mathematical problem-solving, one often needs to be willing to try out a proof idea or strategy and then retroactively determine what hypothesis is needed, rather than hoping one will always happen to guess exactly the right claim first. In other words, it may happen that one begins working out a proof of a claim before knowing exactly what the claim will turn out to say, and this is the case here (despite the fact the proof strategy uses induction).\n\nThus, \\(f\\) maps even integers to even integers. In light of this, we may let \\(g:=f(f(n))\\) (which is also injective), so we conclude that\n\\[\ng^{f(n) / 2}(n) g(n)=n^{2} \\quad \\text { for } n=2,4, \\ldots\n\\]\n\nClaim - The function \\(g\\) is the identity function.\n\nProof. The proof is similar to the earlier proof of the claim. Note that \\(g\\) fixes the odd integers already. We proceed by induction to show \\(g\\) fixes the even integers; so assume \\(g\\) fixes the set \\(S=\\{1,2, \\ldots, n-1\\}\\), for some even integer \\(n \\geq 2\\). In the equation\n\\[\ng^{f(n) / 2}(n) \\cdot g(n)=n^{2}\n\\]\nneither of the two factors may be less than \\(n\\). So they must both be \\(n\\).\nThese three claims imply that the solutions we claimed earlier are the only ones.\nRemark. The last claim is not necessary to solve the problem; after realizing \\(f\\) and injective fixes the odd integers, this answers the question about the values of \\(f(1000)\\). However, we chose to present the \"full\" solution anyways.\n\nRemark. After noting \\(f\\) is injective, another approach is outlined below. Starting from any \\(n\\), consider the sequence\n\\[\nn, f(n), f(f(n)),\n\\]\nand so on. We may let \\(m\\) be the smallest term of the sequence; then \\(m^{2}=f(f(m)) \\cdot f^{f(m)}(m)\\) which forces \\(f^{f(m)}(m)=f(f(m))=m\\) by minimality. Thus the sequence is 2-periodic. Therefore, \\(f(f(n))=n\\) always holds, which is enough to finish.\n\nAuthorship comments. I will tell you a great story about this problem. Two days before the start of grading of USAMO 2017, I had a dream that I was grading a functional equation. When I woke up, I wrote it down, and it was\n\\[\nf^{f(n)}(n)=\\frac{n^{2}}{f(f(n))}\n\\]\n\nYou can guess the rest of the story (and imagine how surprised I was the solution set was interesting). I guess some dreams do come true, huh?", "source_pdf": "USAMO_2019.pdf", "notes": ""}
{"id": "USAMO-2019-2", "contest": "USAMO", "year": "2019", "problem_number": "2", "problem": "Let \\(A B C D\\) be a cyclic quadrilateral satisfying \\(A D^{2}+B C^{2}=A B^{2}\\). The diagonals of \\(A B C D\\) intersect at \\(E\\). Let \\(P\\) be a point on side \\(\\overline{A B}\\) satisfying \\(\\angle A P D=\\angle B P C\\). Show that line \\(P E\\) bisects \\(\\overline{C D}\\).", "solution": "Here are three solutions. The first two are similar although the first one makes use of symmedians. The last solution by inversion is more advanced.\n\nFirst solution using symmedians. We define point \\(P\\) to obey\n\\[\n\\frac{A P}{B P}=\\frac{A D^{2}}{B C^{2}}=\\frac{A E^{2}}{B E^{2}}\n\\]\nso that \\(\\overline{P E}\\) is the \\(E\\)-symmedian of \\(\\triangle E A B\\), therefore the \\(E\\)-median of \\(\\triangle E C D\\).\nNow, note that\n\\[\nA D^{2}=A P \\cdot A B \\quad \\text { and } \\quad B C^{2}=B P \\cdot B A\n\\]\n\nThis implies \\(\\triangle A P D \\sim \\triangle A D B\\) and \\(\\triangle B P C \\sim \\triangle B C A\\). Thus\n\\[\n\\measuredangle D P A=\\measuredangle A D B=\\measuredangle A C B=\\measuredangle B C P\n\\]\nand so \\(P\\) satisfies the condition as in the statement (and is the unique point to do so), as needed.\n\nIf Second solution using only angle chasing (by proposer). We again re-define \\(P\\) to obey \\(A D^{2}=A P \\cdot A B\\) and \\(B C^{2}=B P \\cdot B A\\). As before, this gives \\(\\triangle A P D \\sim \\triangle A B D\\) and \\(\\triangle B P C \\sim \\triangle B D P\\) and so we let\n\\[\n\\theta:=\\measuredangle D P A=\\measuredangle A D B=\\measuredangle A C B=\\measuredangle B C P .\n\\]\n\nOur goal is to now show \\(\\overline{P E}\\) bisects \\(\\overline{C D}\\).\nLet \\(K=\\overline{A C} \\cap \\overline{P D}\\) and \\(L=\\overline{A D} \\cap \\overline{P C}\\). Since \\(\\measuredangle K P A=\\theta=\\measuredangle A C B\\), quadrilateral \\(B P K C\\) is cyclic. Similarly, so is \\(A P L D\\).\n\nFinally \\(A K L B\\) is cyclic since\n\\[\n\\measuredangle B K A=\\measuredangle B K C=\\measuredangle B P C=\\theta=\\measuredangle D P A=\\measuredangle D L A=\\measuredangle B L A .\n\\]\n\nThis implies \\(\\measuredangle C K L=\\measuredangle L B A=\\measuredangle D C K\\), so \\(\\overline{K L} \\| \\overline{C D}\\). Then \\(P E\\) bisects \\(\\overline{B C}\\) by Ceva's theorem on \\(\\triangle P C D\\).\n\nThird solution (using inversion). By hypothesis, the circle \\(\\omega_{a}\\) centered at \\(A\\) with radius \\(A D\\) is orthogonal to the circle \\(\\omega_{b}\\) centered at \\(B\\) with radius \\(B C\\). For brevity, we let \\(\\mathbf{I}_{a}\\) and \\(\\mathbf{I}_{b}\\) denote inversion with respect to \\(\\omega_{a}\\) and \\(\\omega_{b}\\).\n\nWe let \\(P\\) denote the intersection of \\(\\overline{A B}\\) with the radical axis of \\(\\omega_{a}\\) and \\(\\omega_{b}\\); hence \\(P=\\mathbf{I}_{a}(B)=\\mathbf{I}_{b}(A)\\). This already implies that\n\\[\n\\measuredangle D P A \\stackrel{\\mathbf{I}_{a}}{=} \\measuredangle A D B=\\measuredangle A C B \\stackrel{\\mathbf{I}_{b}}{=} \\measuredangle B C P\n\\]\nso \\(P\\) satisfies the angle condition.\n\nClaim - The point \\(K=\\mathbf{I}_{a}(C)\\) lies on \\(\\omega_{b}\\) and \\(\\overline{D P}\\). Similarly \\(L=\\mathbf{I}_{b}(D)\\) lies on \\(\\omega_{a}\\) and \\(\\overline{C P}\\).\n\nProof. The first assertion follows from the fact that \\(\\omega_{b}\\) is orthogonal to \\(\\omega_{a}\\). For the other, since ( \\(B C D\\) ) passes through \\(A\\), it follows \\(P=\\mathbf{I}_{a}(B), K=\\mathbf{I}_{a}(C)\\), and \\(D=\\mathbf{I}_{a}(D)\\) are collinear.\n\nFinally, since \\(C, L, P\\) are collinear, we get \\(A\\) is concyclic with \\(K=\\mathbf{I}_{a}(C), L=\\mathbf{I}_{a}(L)\\), \\(B=\\mathbf{I}_{a}(P)\\), i.e. that \\(A K L B\\) is cyclic. So \\(\\overline{K L} \\| \\overline{C D}\\) by Reim's theorem, and hence \\(\\overline{P E}\\) bisects \\(\\overline{C D}\\) by Ceva's theorem.", "source_pdf": "USAMO_2019.pdf", "notes": ""}
{"id": "USAMO-2019-3", "contest": "USAMO", "year": "2019", "problem_number": "3", "problem": "Let \\(K\\) be the set of positive integers not containing the decimal digit 7. Determine all polynomials \\(f(x)\\) with nonnegative coefficients such that \\(f(x) \\in K\\) for all \\(x \\in K\\).", "solution": "The answer is only the obvious ones: \\(f(x)=10^{e} x, f(x)=k\\), and \\(f(x)=10^{e} x+k\\), for any choice of \\(k \\in K\\) and \\(e>\\log _{10} k\\) (with \\(e \\geq 0\\) ).\n\nNow assume \\(f\\) satisfies \\(f(K) \\subseteq K\\); such polynomials will be called stable. We first prove the following claim which reduces the problem to the study of monomials.\n\n\\section*{Lemma (Reduction to monomials)}\n\nIf \\(f(x)=a_{0}+a_{1} x+a_{2} x^{2}+\\ldots\\) is stable, then each monomial \\(a_{0}, a_{1} x, a_{2} x^{2}, \\ldots\\) is stable.\n\nProof. For any \\(x \\in K\\), plug in \\(f\\left(10^{e} x\\right)\\) for large enough \\(e\\) : the decimal representation of \\(f\\) will contain \\(a_{0}, a_{1} x, a_{2} x^{2}\\) with some zeros padded in between.\n\nLet's tackle the linear case next. Here is an ugly but economical proof.\nClaim (Linear classification) - If \\(f(x)=c x\\) is stable, then \\(c=10^{e}\\) for some nonnegative integer \\(e\\).\n\nProof. We will show when \\(c \\neq 10^{e}\\) then we can find \\(x \\in K\\) such that \\(c x\\) starts with the digit 7. This can actually be done with the following explicit cases in terms of how \\(c\\) starts in decimal notation:\n- For \\(9 \\cdot 10^{e} \\leq c<10 \\cdot 10^{e}\\), pick \\(x=8\\).\n- For \\(8 \\cdot 10^{e} \\leq c<9 \\cdot 10^{e}\\), pick \\(x=88\\).\n- For \\(7 \\cdot 10^{e} \\leq c<8 \\cdot 10^{e}\\), pick \\(x=1\\).\n- For \\(4.4 \\cdot 10^{e} \\leq c<7 \\cdot 10^{e}\\), pick \\(11 \\leq x \\leq 16\\).\n- For \\(2.7 \\cdot 10^{e} \\leq c<4.4 \\cdot 10^{e}\\), pick \\(18 \\leq x \\leq 26\\).\n- For \\(2 \\cdot 10^{e} \\leq c<2.7 \\cdot 10^{e}\\), pick \\(28 \\leq x \\leq 36\\).\n- For \\(1.6 \\cdot 10^{e} \\leq c<2 \\cdot 10^{e}\\), pick \\(38 \\leq x \\leq 46\\).\n- For \\(1.3 \\cdot 10^{e} \\leq c<1.6 \\cdot 10^{e}\\), pick \\(48 \\leq x \\leq 56\\).\n- For \\(1.1 \\cdot 10^{e} \\leq c<1.3 \\cdot 10^{e}\\), pick \\(58 \\leq x \\leq 66\\).\n- For \\(1 \\cdot 10^{e} \\leq c<1.1 \\cdot 10^{e}\\), pick \\(x=699 \\ldots 9\\) for suitably many 9 's.\n\nThe hardest part of the problem is the case where \\(\\operatorname{deg} f>1\\). We claim that no solutions exist then:\n\nClaim (Higher-degree classification) - No monomial of the form \\(f(x)=c x^{d}\\) is stable for any \\(d>1\\).\n\nProof. Note that \\(f(10 x+3)\\) is stable too. Thus\n\\[\nf(10 x+3)=3^{d}+10 d \\cdot 3^{d-1} x+100\\binom{d}{2} \\cdot 3^{d-1} x^{2}+\\ldots\n\\]\nis stable. By applying the lemma the linear monomial \\(10 d \\cdot 3^{d-1} x\\) is stable, so \\(10 d \\cdot 3^{d-1}\\) is a power of 10 , which can only happen if \\(d=1\\).\n\nThus the only nonconstant stable polynomials with nonnegative coefficients must be of the form \\(f(x)=10^{e} x+k\\) for \\(e \\geq 0\\). It is straightforward to show we then need \\(k<10^{e}\\) and this finishes the proof.\n\nRemark. The official solution replaces the proof for \\(f(x)=c x\\) with Kronecker density. Here is how it goes.\n\nFrom \\(f(1)=c \\in K\\), we get \\(f(c)=c^{2} \\in K\\), et cetera and hence \\(c^{n} \\in K\\). However, I claim that when \\(c\\) is not a power of 10 , some power of \\(c\\) starts with any specified prefix. For example, there should be an integer \\(n\\) such that \\(c^{n}\\) starts with the digits 98765 . And this is obviously a contradiction to \\(c^{n} \\in K\\).\n\nTo see why, note this is equivalent to requiring that\n\\[\n\\log _{10}(9.8765) \\leq\\left\\{n \\log _{10} c\\right\\}<\\log _{10}(9.8766)\n\\]\nwhere \\(\\{x\\}\\) is the fractional part of \\(x\\). However, when \\(c\\) is not a power of 10 , the number \\(\\log _{10}(c)\\) is irrational. And Kronecker density theorem asserts that whenever \\(\\alpha\\) is irrational, the fractional parts \\(\\{n \\alpha\\}\\) for \\(n \\geq 0\\) are actually equally distributed across the entire open interval \\((0,1)\\). In particular, there are \\(n\\) for which the fractional part lie in any interval of positive length.", "source_pdf": "USAMO_2019.pdf", "notes": ""}
{"id": "USAMO-2019-4", "contest": "USAMO", "year": "2019", "problem_number": "4", "problem": "Let \\(n\\) be a nonnegative integer. Determine the number of ways to choose sets \\(S_{i j} \\subseteq\\{1,2, \\ldots, 2 n\\}\\), for all \\(0 \\leq i \\leq n\\) and \\(0 \\leq j \\leq n\\) (not necessarily distinct), such that\n- \\(\\left|S_{i j}\\right|=i+j\\), and\n- \\(S_{i j} \\subseteq S_{k l}\\) if \\(0 \\leq i \\leq k \\leq n\\) and \\(0 \\leq j \\leq l \\leq n\\).", "solution": "The answer is \\((2 n)!\\cdot 2^{n^{2}}\\). First, we note that \\(\\varnothing=S_{00} \\subsetneq S_{01} \\subsetneq \\cdots \\subsetneq S_{n n}=\\{1, \\ldots, 2 n\\}\\) and thus multiplying by (2n)! we may as well assume \\(S_{0 i}=\\{1, \\ldots, i\\}\\) and \\(S_{i n}=\\{1, \\ldots, n+i\\}\\). We illustrate this situation by placing the sets in a grid, as below for \\(n=4\\); our goal is to fill in the rest of the grid.\n\\[\n\\left[\\begin{array}{ccccc}\n1234 & 12345 & 123456 & 1234567 & 12345678 \\\\\n123 & & & & \\\\\n12 & & & & \\\\\n1 & & & & \\\\\n\\varnothing & & & &\n\\end{array}\\right]\n\\]\n\nWe claim the number of ways to do so is \\(2^{n^{2}}\\). In fact, more strongly even the partial fillings are given exactly by powers of 2 .\n\nClaim - Fix a choice \\(T\\) of cells we wish to fill in, such that whenever a cell is in \\(T\\), so are all the cells above and left of it. (In other words, \\(T\\) is a Young tableau.) The number of ways to fill in these cells with sets satisfying the inclusion conditions is \\(2^{|T|}\\).\n\nAn example is shown below, with an indeterminate set marked in red (and the rest of \\(T\\) marked in blue).\n\\[\n\\left[\\begin{array}{ccccc}\n1234 & 12345 & 123456 & 1234567 & 12345678 \\\\\n123 & 1234 & 12346 & 123467 & \\\\\n12 & 124 & 1234 \\text { or } 1246 & & \\\\\n1 & 12 & & & \\\\\n\\varnothing & 2 & & &\n\\end{array}\\right]\n\\]\n\nProof. The proof is by induction on \\(|T|\\), with \\(|T|=0\\) being vacuous.\nNow suppose we have a corner \\(\\left[\\begin{array}{cc}B & C \\\\ A & S\\end{array}\\right]\\) where \\(A, B, C\\) are fixed and \\(S\\) is to be chosen. Then we may write \\(B=A \\cup\\{x\\}\\) and \\(C=A \\cup\\{x, y\\}\\) for \\(x, y \\notin A\\). Then the two choices of \\(S\\) are \\(A \\cup\\{x\\}\\) (i.e. \\(B\\) ) and \\(A \\cup\\{y\\}\\), and both of them are seen to be valid.\n\nIn this way, we gain a factor of 2 any time we add one cell as above to \\(T\\). Since we can achieve any Young tableau in this way, the induction is complete.", "source_pdf": "USAMO_2019.pdf", "notes": ""}
{"id": "USAMO-2019-5", "contest": "USAMO", "year": "2019", "problem_number": "5", "problem": "Let \\(m\\) and \\(n\\) be relatively prime positive integers. The numbers \\(\\frac{m}{n}\\) and \\(\\frac{n}{m}\\) are written on a blackboard. At any point, Evan may pick two of the numbers \\(x\\) and \\(y\\) written on the board and write either their arithmetic mean \\(\\frac{1}{2}(x+y)\\) or their harmonic mean \\(\\frac{2 x y}{x+y}\\). For which \\((m, n)\\) can Evan write 1 on the board in finitely many steps?", "solution": "We claim this is possible if and only \\(m+n\\) is a power of 2 . Let \\(q=m / n\\), so the numbers on the board are \\(q\\) and \\(1 / q\\).\n\nImpossibility. The main idea is the following.\nClaim - Suppose \\(p\\) is an odd prime. Then if the initial numbers on the board are \\(-1(\\bmod p)\\), then all numbers on the board are \\(-1(\\bmod p)\\).\n\nProof. Let \\(a \\equiv b \\equiv-1(\\bmod p)\\). Note that \\(2 \\not \\equiv 0(\\bmod p)\\) and \\(a+b \\equiv-2 \\not \\equiv 0(\\bmod p)\\). Thus \\(\\frac{a+b}{2}\\) and \\(\\frac{2 a b}{a+b}\\) both make sense modulo \\(p\\) and are equal to \\(-1(\\bmod p)\\).\n\nThus if there exists any odd prime divisor \\(p\\) of \\(m+n\\) (implying \\(p \\nmid m n\\) ), then\n\\[\nq \\equiv \\frac{1}{q} \\equiv-1 \\quad(\\bmod p) .\n\\]\nand hence all numbers will be \\(-1(\\bmod p)\\) forever. This implies that it's impossible to write 1 , whenever \\(m+n\\) is divisible by some odd prime.\n\nIT Construction. Conversely, suppose \\(m+n\\) is a power of 2 . We will actually construct 1 without even using the harmonic mean.\n\nNote that\n\\[\n\\frac{n}{m+n} \\cdot q+\\frac{m}{m+n} \\cdot \\frac{1}{q}=1\n\\]\nand obviously by taking appropriate midpoints (in a binary fashion) we can achieve this using arithmetic mean alone.", "source_pdf": "USAMO_2019.pdf", "notes": ""}
{"id": "USAMO-2019-6", "contest": "USAMO", "year": "2019", "problem_number": "6", "problem": "Find all polynomials \\(P\\) with real coefficients such that\n\\[\n\\frac{P(x)}{y z}+\\frac{P(y)}{z x}+\\frac{P(z)}{x y}=P(x-y)+P(y-z)+P(z-x)\n\\]\nfor all nonzero real numbers \\(x, y, z\\) obeying \\(2 x y z=x+y+z\\).", "solution": "The given can be rewritten as saying that\n\\[\n\\begin{aligned}\nQ(x, y, z) & :=x P(x)+y P(y)+z P(z) \\\\\n& -x y z(P(x-y)+P(y-z)+P(z-x))\n\\end{aligned}\n\\]\nis a polynomial vanishing whenever \\(x y z \\neq 0\\) and \\(2 x y z=x+y+z\\), for real numbers \\(x, y\\), \\(z\\).\n\nClaim - This means \\(Q(x, y, z)\\) vanishes also for any complex numbers \\(x, y, z\\) obeying \\(2 x y z=x+y+z\\).\n\nProof. Indeed, this means that the rational function\n\\[\nR(x, y):=Q\\left(x, y, \\frac{x+y}{2 x y-1}\\right)\n\\]\nvanishes for any real numbers \\(x\\) and \\(y\\) such that \\(x y \\neq \\frac{1}{2}, x \\neq 0, y \\neq 0, x+y \\neq 0\\). This can only occur if \\(R\\) is identically zero as a rational function with real coefficients. If we then regard \\(R\\) as having complex coefficients, the conclusion then follows.\n\nRemark (Algebraic geometry digression on real dimension). Note here we use in an essential way that \\(z\\) can be solved for in terms of \\(x\\) and \\(y\\). If \\(s(x, y, z)=2 x y z-(x+y+z)\\) is replaced with some general condition, the result may become false; e.g. we would certainly not expect the result to hold when \\(s(x, y, z)=x^{2}+y^{2}+z^{2}-(x y+y z+z x)\\) since for real numbers \\(s=0\\) only when \\(x=y=z\\) !\n\nThe general condition we need here is that \\(s(x, y, z)=0\\) should have \"real dimension two\". Here is a proof using this language, in our situation.\n\nLet \\(M \\subset \\mathbb{R}^{3}\\) be the surface \\(s=0\\). We first contend \\(M\\) is two-dimensional manifold. Indeed, the gradient \\(\\nabla s=\\langle 2 y z-1,2 z x-1,2 x y-1\\rangle\\) vanishes only at the points \\(( \\pm 1 / \\sqrt{2}, \\pm 1 / \\sqrt{2}, \\pm 1 / \\sqrt{2})\\) where the \\(\\pm\\) signs are all taken to be the same. These points do not lie on \\(M\\), so the result follows by the regular value theorem. In particular the topological closure of points on \\(M\\) with \\(x y z \\neq 0\\) is all of \\(M\\) itself; so \\(Q\\) vanishes on all of \\(M\\).\n\nIf we now identify \\(M\\) with the semi-algebraic set consisting of maximal ideals ( \\(x-a, y- b, z-c)\\) in Spec \\(\\mathbb{R}[x, y, z]\\) satisfying \\(2 a b c=a+b+c\\), then we have real dimension two, and thus the Zariski closure of \\(M\\) is a two-dimensional closed subset of \\(\\operatorname{Spec} \\mathbb{R}[x, y, z]\\). Thus it must be \\(Z=\\mathcal{V}(2 x y z-(x+y+z))\\), since this \\(Z\\) is an irreducible two-dimensional closed subset (say, by Krull's principal ideal theorem) containing \\(M\\). Now \\(Q\\) is a global section vanishing on all of \\(Z\\), therefore \\(Q\\) is contained in the (radical, principal) ideal \\((2 x y z-(x+y+z))\\) as needed. So it is actually divisible by \\(2 x y z-(x+y+z)\\) as desired.\n\nNow we regard \\(P\\) and \\(Q\\) as complex polynomials instead. First, note that substituting \\((x, y, z)=(t,-t, 0)\\) implies \\(P\\) is even. We then substitute\n\\[\n(x, y, z)=\\left(x, \\frac{i}{\\sqrt{2}}, \\frac{-i}{\\sqrt{2}}\\right)\n\\]\nto get\n\\[\n\\begin{aligned}\n& x P(x)+\\frac{i}{\\sqrt{2}}\\left(P\\left(\\frac{i}{\\sqrt{2}}\\right)-P\\left(\\frac{-i}{\\sqrt{2}}\\right)\\right) \\\\\n= & \\frac{1}{2} x(P(x-i / \\sqrt{2})+P(x+i / \\sqrt{2})+P(\\sqrt{2} i))\n\\end{aligned}\n\\]\nwhich in particular implies that\n\\[\nP\\left(x+\\frac{i}{\\sqrt{2}}\\right)+P\\left(x-\\frac{i}{\\sqrt{2}}\\right)-2 P(x) \\equiv P(\\sqrt{2} i)\n\\]\nidentically in \\(x\\). The left-hand side is a second-order finite difference in \\(x\\) (up to scaling the argument), and the right-hand side is constant, so this implies \\(\\operatorname{deg} P \\leq 2\\).\n\nSince \\(P\\) is even and \\(\\operatorname{deg} P \\leq 2\\), we must have \\(P(x)=c x^{2}+d\\) for some real numbers \\(c\\) and \\(d\\). A quick check now gives the answer \\(P(x)=c\\left(x^{2}+3\\right)\\) which all work.", "source_pdf": "USAMO_2019.pdf", "notes": ""}
{"id": "USAMO-2020-1", "contest": "USAMO", "year": "2020", "problem_number": "1", "problem": "Let \\(A B C\\) be a fixed acute triangle inscribed in a circle \\(\\omega\\) with center \\(O\\). A variable point \\(X\\) is chosen on minor arc \\(A B\\) of \\(\\omega\\), and segments \\(C X\\) and \\(A B\\) meet at \\(D\\). Denote by \\(O_{1}\\) and \\(O_{2}\\) the circumcenters of triangles \\(A D X\\) and \\(B D X\\), respectively. Determine all points \\(X\\) for which the area of triangle \\(O O_{1} O_{2}\\) is minimized.", "solution": "We prove \\(\\left[O O_{1} O_{2}\\right] \\geq \\frac{1}{4}[A B C]\\), with equality if and only if \\(\\overline{C X} \\perp \\overline{A B}\\). First approach (Bobby Shen). We use two simultaneous inequalities: - Let \\(M\\) and \\(N\\) be the midpoints of \\(C X\\) and \\(D X\\). Then \\(M N\\) equals the length of the \\(O\\)-altitude of \\(\\triangle O O_{1} O_{2}\\), since \\(\\overline{O_{1} O_{2}}\\) and \\(\\overline{D X}\\) meet at \\(N\\) at a right angle. Moreover, we have \\[ M N=\\frac{1}{2} C D \\geq \\frac{1}{2} h_{a} \\] where \\(h_{a}\\) denotes the \\(A\\)-altitude. - The projection of \\(O_{1} O_{2}\\) onto line \\(A B\\) has length exactly \\(A B / 2\\). Thus \\[ O_{1} O_{2} \\geq \\frac{1}{2} A B \\] So, we find \\[ \\left[O O_{1} O_{2}\\right]=\\frac{1}{2} \\cdot M N \\cdot O_{1} O_{2} \\geq \\frac{1}{8} h_{a} \\cdot A B=\\frac{1}{4}[A B C] . \\] Note that equality occurs in both cases if and only if \\(\\overline{C X} \\perp \\overline{A B}\\). So the area is minimized exactly when this occurs. I Second approach (Evan's solution). We need two claims. Claim - We have \\(\\triangle O O_{1} O_{2} \\sim \\triangle C B A\\), with opposite orientation. Proof. Notice that \\(\\overline{O O_{1}} \\perp \\overline{A X}\\) and \\(\\overline{O_{1} O_{2}} \\perp \\overline{C X}\\), so \\(\\measuredangle O O_{1} O_{2}=\\measuredangle A X C=\\measuredangle A B C\\). Similarly \\(\\measuredangle O O_{2} O_{1}=\\measuredangle B A C\\). Therefore, the problem is equivalent to minimizing \\(O_{1} O_{2}\\). Claim (Salmon theorem) - We have \\(\\triangle X O_{1} O_{2} \\sim \\triangle X A B\\). Proof. It follows from the fact that \\(\\triangle A O_{1} X \\sim \\triangle B O_{2} X\\) (since \\(\\measuredangle A D X=\\measuredangle X D B \\Longrightarrow \\left.\\measuredangle X O_{1} A=\\measuredangle X O_{2} B\\right)\\) and that spiral similarities come in pairs. Let \\(\\theta=\\angle A D X\\). The ratio of similarity in the previous claim is equal to \\(\\frac{X O_{1}}{X A}=\\frac{1}{2 \\sin \\theta}\\). In other words, \\[ O_{1} O_{2}=\\frac{A B}{2 \\sin \\theta} \\] This is minimized when \\(\\theta=90^{\\circ}\\), in which case \\(O_{1} O_{2}=A B / 2\\) and \\(\\left[O O_{1} O_{2}\\right]=\\frac{1}{4}[A B C]\\). This completes the solution.", "source_pdf": "USAMO_2020.pdf", "notes": ""}
{"id": "USAMO-2020-2", "contest": "USAMO", "year": "2020", "problem_number": "2", "problem": "An empty \\(2020 \\times 2020 \\times 2020\\) cube is given, and a \\(2020 \\times 2020\\) grid of square unit cells is drawn on each of its six faces. A beam is a \\(1 \\times 1 \\times 2020\\) rectangular prism. Several beams are placed inside the cube subject to the following conditions: - The two \\(1 \\times 1\\) faces of each beam coincide with unit cells lying on opposite faces of the cube. (Hence, there are \\(3 \\cdot 2020^{2}\\) possible positions for a beam.) - No two beams have intersecting interiors. - The interiors of each of the four \\(1 \\times 2020\\) faces of each beam touch either a face of the cube or the interior of the face of another beam. What is the smallest positive number of beams that can be placed to satisfy these conditions?", "solution": "Answer. 3030 beams. Construction. We first give a construction with \\(3 n / 2\\) beams for any \\(n \\times n \\times n\\) box, where \\(n\\) is an even integer. Shown below is the construction for \\(n=6\\), which generalizes. (The left figure shows the cube in 3d; the right figure shows a direct view of the three visible faces.) To be explicit, impose coordinate axes such that one corner of the cube is the origin. We specify a beam by two opposite corners. The \\(3 n / 2\\) beams come in three directions, \\(n / 2\\) in each direction: - \\((0,0,0) \\rightarrow(1,1, n),(2,2,0) \\rightarrow(3,3, n),(4,4,0) \\rightarrow(5,5, n)\\), and so on; - \\((1,0,0) \\rightarrow(2, n, 1),(3,0,2) \\rightarrow(4, n, 3),(5,0,4) \\rightarrow(6, n, 5)\\), and so on; - \\((0,1,1) \\rightarrow(n, 2,2),(0,3,3) \\rightarrow(n, 4,4),(0,5,5) \\rightarrow(n, 6,6)\\), and so on. This gives the figure we drew earlier and shows 3030 beams is possible. IT Necessity. We now show at least \\(3 n / 2\\) beams are necessary. Maintain coordinates, and call the beams \\(x\\)-beams, \\(y\\)-beams, \\(z\\)-beams according to which plane their long edges are perpendicular too. Let \\(N_{x}, N_{y}, N_{z}\\) be the number of these. Claim - If \\(\\min \\left(N_{x}, N_{y}, N_{z}\\right)=0\\), then at least \\(n^{2}\\) beams are needed. Proof. Assume WLOG that \\(N_{z}=0\\). Orient the cube so the \\(z\\)-plane touches the ground. Then each of the \\(n\\) layers of the cube (from top to bottom) must be completely filled, and so at least \\(n^{2}\\) beams are necessary, We henceforth assume \\(\\min \\left(N_{x}, N_{y}, N_{z}\\right)>0\\). Claim - If \\(N_{z}>0\\), then we have \\(N_{x}+N_{y} \\geq n\\). Proof. Again orient the cube so the \\(z\\)-plane touches the ground. We see that for each of the \\(n\\) layers of the cube (from top to bottom), there is at least one \\(x\\)-beam or \\(y\\)-beam. (Pictorially, some of the \\(x\\) and \\(y\\) beams form a \"staircase\".) This completes the proof. Proceeding in a similar fashion, we arrive at the three relations \\[ \\begin{aligned} & N_{x}+N_{y} \\geq n \\\\ & N_{y}+N_{z} \\geq n \\\\ & N_{z}+N_{x} \\geq n \\end{aligned} \\] Summing gives \\(N_{x}+N_{y}+N_{z} \\geq 3 n / 2\\) too. Remark. The problem condition has the following \"physics\" interpretation. Imagine the cube is a metal box which is sturdy enough that all beams must remain orthogonal to the faces of the box (i.e. the beams cannot spin). Then the condition of the problem is exactly what is needed so that, if the box is shaken or rotated, the beams will not move. Remark. Walter Stromquist points out that the number of constructions with 3030 beams is actually enormous: not dividing out by isometries, the number is \\((2 \\cdot 1010!)^{3}\\).", "source_pdf": "USAMO_2020.pdf", "notes": ""}
{"id": "USAMO-2020-3", "contest": "USAMO", "year": "2020", "problem_number": "3", "problem": "Let \\(p\\) be an odd prime. An integer \\(x\\) is called a quadratic non-residue if \\(p\\) does not divide \\(x-t^{2}\\) for any integer \\(t\\). Denote by \\(A\\) the set of all integers \\(a\\) such that \\(1 \\leq a<p\\), and both \\(a\\) and \\(4-a\\) are quadratic non-residues. Calculate the remainder when the product of the elements of \\(A\\) is divided by \\(p\\).", "solution": "The answer is that \\(\\prod_{a \\in A} a \\equiv 2(\\bmod p)\\) regardless of the value of \\(p\\). In the following solution, we work in \\(\\mathbb{F}_{p}\\) always and abbreviate \"quadratic residue\" and \"non-quadratic residue\" to \"QR\" and \"non-QR\", respectively. We define \\[ \\begin{aligned} & A=\\left\\{a \\in \\mathbb{F}_{p} \\mid a, 4-a \\text { non-QR }\\right\\} \\\\ & B=\\left\\{b \\in \\mathbb{F}_{p} \\mid b, 4-b \\mathrm{QR}, b \\neq 0, b \\neq 4\\right\\} . \\end{aligned} \\] Notice that \\[ A \\cup B=\\left\\{n \\in \\mathbb{F}_{p} \\mid n(4-n) \\text { is } \\mathrm{QR} n \\neq 0,4\\right\\} . \\] We now present two approaches both based on the set \\(B\\). IT First approach (based on Holden Mui's presentation in Mathematics Magazine). The idea behind this approach is that \\(n(4-n)\\) is itself an element of \\(B\\) for \\(n \\in A \\cup B\\), because \\(4-n(4-n)=(n-2)^{2}\\). This motivates the following claim. Claim - The map \\[ A \\cup B \\backslash\\{2\\} \\rightarrow B \\quad \\text { by } \\quad n \\mapsto n(4-n) \\] is a well-defined two-to-one map, i.e. every \\(b \\in B\\) has exactly two pre-images. Proof. Since \\(n \\notin\\{0,2,4\\}\\), we have \\(n(4-n) \\notin\\{0,4\\}\\), so as discussed previously, \\(n(4-n) \\in B\\). Thus this map is well-defined. Choose \\(b \\in B\\). The quadratic equation \\(n(4-n)=b\\) in \\(n\\) rewrites as \\(n^{2}-4 n+b=0\\), and has discriminant \\(4(4-b)\\), which is a nonzero QR . Hence there are exactly two values of \\(n\\), as desired. Therefore, it follows that \\[ \\prod_{n \\in A \\cup B \\backslash\\{2\\}} n=\\prod_{b \\in B} b \\] by pairing \\(n\\) with \\(4-n\\) on the left-hand side. So, \\(\\prod_{a \\in A} a=2\\). IT Second calculation approach (along the lines of official solution). We now do the following magical calculation in \\(\\mathbb{F}_{p}\\) : \\[ \\prod_{b \\in B} b=\\prod_{b \\in B}(4-b)=\\prod_{\\substack{1 \\leq y \\leq(p-1) / 2 \\\\ y \\neq 2 \\\\ 4-y^{2} \\text { is } \\mathrm{QR}}}\\left(4-y^{2}\\right) \\] \\[ \\begin{aligned} & =\\prod_{\\substack{1 \\leq y \\leq(p-1) / 2 \\\\ y \\neq 2 \\\\ 4-y^{2} \\text { is } \\mathrm{QR}}}(2+y) \\prod_{\\substack{1 \\leq y \\leq(p-1) / 2 \\\\ y \\neq 2 \\\\ 4-y^{2} \\text { is } \\mathrm{QR}}}(2-y) \\\\ & =\\prod_{\\substack{1 \\leq y \\leq(p-1) / 2 \\\\ y \\neq 2 \\\\ 4-y^{2} \\text { is } \\mathrm{QR}}}(2+y) \\prod_{\\substack{(p+1) / 2 \\leq y \\leq p-1 \\\\ y \\neq p-2 \\\\ 4-y^{2} \\text { is } \\mathrm{QR}}}(2+y) \\\\ & =\\prod_{\\substack{1 \\leq y \\leq p-1 \\\\ y \\neq 2, p-2 \\\\ 4-y^{2} \\text { is } \\mathrm{QR}}}(2+y) \\\\ & =\\prod_{\\substack{3 \\leq z \\leq p+1 \\\\ z \\neq 4, p \\\\ z(4-z) \\text { is } \\mathrm{QR}}} z \\\\ & =\\prod_{\\substack{0 \\leq z \\leq p-1 \\\\ z \\neq 0,4,2 \\\\ z(4-z) \\text { is } \\mathrm{QR}}} z . \\end{aligned} \\] Note \\(z(4-z)\\) is a nonzero QR if and only if \\(z \\in A \\cup B\\). So the right-hand side is almost the product over \\(z \\in A \\cup B\\), except it is missing the \\(z=2\\) term. Adding it in gives \\[ \\prod_{b \\in B} b=\\frac{1}{2} \\prod_{\\substack{0 \\leq z \\leq p-1 \\ z \\neq 0,4 \\ z(4-z) \\text { is } \\mathrm{QR}}} z=\\frac{1}{2} \\prod_{a \\in A} a \\prod_{b \\in B} b \\] This gives \\(\\prod_{a \\in A} a=2\\) as desired.", "source_pdf": "USAMO_2020.pdf", "notes": ""}
{"id": "USAMO-2020-4", "contest": "USAMO", "year": "2020", "problem_number": "4", "problem": "Suppose that \\(\\left(a_{1}, b_{1}\\right),\\left(a_{2}, b_{2}\\right), \\ldots,\\left(a_{100}, b_{100}\\right)\\) are distinct ordered pairs of nonnegative integers. Let \\(N\\) denote the number of pairs of integers ( \\(i, j\\) ) satisfying \\(1 \\leq i<j \\leq 100\\) and \\(\\left|a_{i} b_{j}-a_{j} b_{i}\\right|=1\\). Determine the largest possible value of \\(N\\) over all possible choices of the 100 ordered pairs.", "solution": "The answer is 197 . In general, if 100 is replaced by \\(n \\geq 2\\) the answer is \\(2 n-3\\). The idea is that if we let \\(P_{i}=\\left(a_{i}, b_{i}\\right)\\) be a point in the coordinate plane, and let \\(O=(0,0)\\) then we wish to maximize the number of triangles \\(\\triangle O P_{i} P_{j}\\) which have area \\(1 / 2\\). Call such a triangle good. Construction of 197 points. It suffices to use the points \\((1,0),(1,1),(2,1),(3,1)\\), \\(\\ldots,(99,1)\\) as shown. Notice that: - There are 98 good triangles with vertices \\((0,0),(k, 1)\\) and \\((k+1,1)\\) for \\(k=1, \\ldots, 98\\). - There are 99 good triangles with vertices \\((0,0),(1,0)\\) and \\((k, 1)\\) for \\(k=1, \\ldots, 99\\). This is a total of \\(98+99=197\\) triangles. If Proof that 197 points is optimal. We proceed by induction on \\(n\\) to show the bound of \\(2 n-3\\). The base case \\(n=2\\) is evident. For the inductive step, suppose (without loss of generality) that the point \\(P=P_{n}= (a, b)\\) is the farthest away from the point \\(O\\) among all points. Claim - This farthest point \\(P=P_{n}\\) is part of at most two good triangles. Proof. We must have \\(\\operatorname{gcd}(a, b)=1\\) for \\(P\\) to be in any good triangles at all, since otherwise any divisor of \\(\\operatorname{gcd}(a, b)\\) also divides \\(2[O P Q]\\). Now, we consider the locus of all points \\(Q\\) for which \\([O P Q]=1 / 2\\). It consists of two parallel lines passing with slope \\(O P\\), as shown. Since \\(\\operatorname{gcd}(a, b)=1\\), see that only two lattice points on this locus actually lie inside the quarter-circle centered at \\(O\\) with radius \\(O P\\). Indeed if one of the points is \\((u, v)\\) then the others on the line are ( \\(u \\pm a, v \\pm b\\) ) where the signs match. This proves the claim. This claim allows us to complete the induction by simply deleting \\(P_{n}\\).", "source_pdf": "USAMO_2020.pdf", "notes": ""}
{"id": "USAMO-2020-5", "contest": "USAMO", "year": "2020", "problem_number": "5", "problem": "A finite set \\(S\\) of points in the coordinate plane is called overdetermined if \\(|S| \\geq 2\\) and there exists a nonzero polynomial \\(P(t)\\), with real coefficients and of degree at most \\(|S|-2\\), satisfying \\(P(x)=y\\) for every point \\((x, y) \\in S\\). For each integer \\(n \\geq 2\\), find the largest integer \\(k\\) (in terms of \\(n\\) ) such that there exists a set of \\(n\\) distinct points that is not overdetermined, but has \\(k\\) overdetermined subsets.", "solution": "We claim the answer is \\(k=2^{n-1}-n\\). We denote the \\(n\\) points by \\(A\\). Throughout the solution we will repeatedly use the following fact: \\section*{Lemma} If \\(S\\) is a finite set of points in the plane there is at most one polynomial with real coefficients and of degree at most \\(|S|-1\\) whose graph passes through all points of \\(S\\). Proof. If any two of the points have the same \\(x\\)-coordinate then obviously no such polynomial may exist at all. Otherwise, suppose \\(f\\) and \\(g\\) are two such polynomials. Then \\(f-g\\) has degree at most \\(|S|-1\\), but it has \\(|S|\\) roots, so is the zero polynomial. Remark. Actually Lagrange interpolation implies that such a polynomial exists as long as all the \\(x\\)-coordinates are different! Construction: Consider the set \\(A=\\{(1, a),(2, b),(3, b),(4, b), \\ldots,(n, b)\\}\\), where \\(a\\) and \\(b\\) are two distinct nonzero real numbers. Any subset of the latter \\(n-1\\) points with at least one element is overdetermined, and there are \\(2^{n-1}-n\\) such sets. Bound: Say a subset \\(S\\) of \\(A\\) is flooded if it is not overdetermined. For brevity, an \\(m\\)-set refers simply to a subset of \\(A\\) with \\(m\\) elements. Claim - If \\(S\\) is an flooded \\(m\\)-set for \\(m \\geq 3\\), then at most one ( \\(m-1\\) )-subset of \\(S\\) is not flooded. Proof. Let \\(S=\\left\\{p_{1}, \\ldots, p_{m}\\right\\}\\) be flooded. Assume for contradiction that \\(S-\\left\\{p_{i}\\right\\}\\) and \\(S-\\left\\{p_{j}\\right\\}\\) are both overdetermined. Then we can find polynomials \\(f\\) and \\(g\\) of degree at most \\(m-3\\) passing through \\(S-\\left\\{p_{i}\\right\\}\\) and \\(S-\\left\\{p_{j}\\right\\}\\), respectively. Since \\(f\\) and \\(g\\) agree on \\(S-\\left\\{p_{i}, p_{j}\\right\\}\\), which has \\(m-2\\) elements, by the lemma we have \\(f=g\\). Thus this common polynomial (actually of degree at most \\(m-3\\) ) witnesses that \\(S\\) is overdetermined, which is a contradiction. Claim - For all \\(m=2,3, \\ldots, n\\) there are at least \\(\\binom{n-1}{m-1}\\) flooded \\(m\\)-sets of \\(A\\). Proof. The proof is by downwards induction on \\(m\\). The base case \\(m=n\\) is by assumption. For the inductive step, suppose it's true for \\(m\\). Each of the \\(\\binom{n-1}{m-1}\\) flooded \\(m\\)-sets has at least \\(m-1\\) flooded ( \\(m-1\\) )-subsets. Meanwhile, each ( \\(m-1\\) )-set has exactly \\(n-(m-1)\\) parent \\(m\\)-sets. We conclude the number of flooded sets of size \\(m-1\\) is at least \\[ \\frac{m-1}{n-(m-1)}\\binom{n-1}{m-1}=\\binom{n-1}{m-2} \\] as desired. This final claim completes the proof, since it shows there are at most \\[ \\sum_{m=2}^{n}\\left(\\binom{n}{m}-\\binom{n-1}{m-1}\\right)=2^{n-1}-n \\] overdetermined sets, as desired. Remark (On repeated \\(x\\)-coordinates). Suppose \\(A\\) has two points \\(p\\) and \\(q\\) with repeated \\(x\\) coordinates. We can argue directly that \\(A\\) satisfies the bound. Indeed, any overdetermined set contains at most one of \\(p\\) and \\(q\\). Moreover, given \\(S \\subseteq A-\\{p, q\\}\\), if \\(S \\cup\\{p\\}\\) is overdetermined then \\(S \\cup\\{q\\}\\) is not, and vice-versa. (Recall that overdetermined sets always have distinct \\(x\\)-coordinates.) This gives a bound \\(\\left[2^{n-2}-(n-2)-1\\right]+\\left[2^{n-2}-1\\right]=2^{n-1}-n\\) already. Remark (Alex Zhai). An alternative approach to the double-counting argument is to show that any overdetermined \\(m\\)-set has an flooded \\(m\\)-superset. Together with the first claim, this lets us pair overdetermined sets in a way that implies the bound.", "source_pdf": "USAMO_2020.pdf", "notes": ""}
{"id": "USAMO-2020-6", "contest": "USAMO", "year": "2020", "problem_number": "6", "problem": "Let \\(n \\geq 2\\) be an integer. Let \\(x_{1} \\geq x_{2} \\geq \\cdots \\geq x_{n}\\) and \\(y_{1} \\geq y_{2} \\geq \\cdots \\geq y_{n}\\) be \\(2 n\\) real numbers such that \\[ \\begin{aligned} 0 & =x_{1}+x_{2}+\\cdots+x_{n}=y_{1}+y_{2}+\\cdots+y_{n}, \\\\ \\text { and } \\quad 1 & =x_{1}^{2}+x_{2}^{2}+\\cdots+x_{n}^{2}=y_{1}^{2}+y_{2}^{2}+\\cdots+y_{n}^{2} . \\end{aligned} \\] Prove that \\[ \\sum_{i=1}^{n}\\left(x_{i} y_{i}-x_{i} y_{n+1-i}\\right) \\geq \\frac{2}{\\sqrt{n-1}} \\]", "solution": "We present two approaches. In both approaches, it's helpful motivation that for even \\(n\\), equality occurs at \\[ \\begin{aligned} & \\left(x_{i}\\right)=(\\underbrace{\\frac{1}{\\sqrt{n}}, \\ldots, \\frac{1}{\\sqrt{n}}}_{n / 2}, \\underbrace{-\\frac{1}{\\sqrt{n}}, \\ldots,-\\frac{1}{\\sqrt{n}}}_{n / 2}) \\\\ & \\left(y_{i}\\right)=(\\frac{n-1}{\\sqrt{n(n-1)}},-\\underbrace{\\frac{1}{\\sqrt{n(n-1)}}, \\ldots,-\\frac{1}{\\sqrt{n(n-1)}}}_{n-1}) \\end{aligned} \\] First approach (expected value). For a permutation \\(\\sigma\\) on \\(\\{1,2, \\ldots, n\\}\\) we define \\[ S_{\\sigma}=\\sum_{i=1}^{n} x_{i} y_{\\sigma(i)} \\] Claim - For random permutations \\(\\sigma, \\mathbb{E}\\left[S_{\\sigma}\\right]=0\\) and \\(\\mathbb{E}\\left[S_{\\sigma}^{2}\\right]=\\frac{1}{n-1}\\). Proof. The first one is clear. Since \\(\\sum_{i<j} 2 x_{i} x_{j}=-1\\), it follows that (for fixed \\(i\\) and \\(j\\) ), \\(\\mathbb{E}\\left[y_{\\sigma(i)} y_{\\sigma(j)}\\right]=-\\frac{1}{n(n-1)}\\), Thus \\[ \\begin{aligned} \\sum_{i} x_{i}^{2} \\cdot \\mathbb{E}\\left[y_{\\sigma(i)}^{2}\\right] & =\\frac{1}{n} \\\\ 2 \\sum_{i<j} x_{i} x_{j} \\cdot \\mathbb{E}\\left[y_{\\sigma(i)} y_{\\sigma(j)}\\right] & =(-1) \\cdot \\frac{1}{n(n-1)} \\end{aligned} \\] the conclusion follows. Claim (A random variable in \\([0,1]\\) has variance at most \\(1 / 4\\) ) - If \\(A\\) is a random variable with mean \\(\\mu\\) taking values in the closed interval [ \\(m, M\\) ] then \\[ \\mathbb{E}\\left[(A-\\mu)^{2}\\right] \\leq \\frac{1}{4}(M-m)^{2} \\] Proof. By shifting and scaling, we may assume \\(m=0\\) and \\(M=1\\), so \\(A \\in[0,1]\\) and hence \\(A^{2} \\leq A\\). Then \\[ \\mathbb{E}\\left[(A-\\mu)^{2}\\right]=\\mathbb{E}\\left[A^{2}\\right]-\\mu^{2} \\leq \\mathbb{E}[A]-\\mu^{2}=\\mu-\\mu^{2} \\leq \\frac{1}{4} . \\] This concludes the proof. Thus the previous two claims together give \\[ \\max _{\\sigma} S_{\\sigma}-\\min _{\\sigma} S_{\\sigma} \\geq \\sqrt{\\frac{4}{n-1}}=\\frac{2}{\\sqrt{n-1}} \\] But \\(\\sum_{i} x_{i} y_{i}=\\max _{\\sigma} S_{\\sigma}\\) and \\(\\sum_{i} x_{i} y_{n+1-i}=\\min _{\\sigma} S_{\\sigma}\\) by rearrangement inequality and therefore we are done. T Outline of second approach (by convexity, due to Alex Zhai). We will instead prove a converse result: given the hypotheses - \\(x_{1} \\geq \\cdots \\geq x_{n}\\) - \\(y_{1} \\geq \\cdots \\geq y_{n}\\) - \\(\\sum_{i} x_{i}=\\sum_{i} y_{i}=0\\) - \\(\\sum_{i} x_{i} y_{i}-\\sum_{i} x_{i} y_{n+1-i}=\\frac{2}{\\sqrt{n-1}}\\) we will prove that \\(\\sum x_{i}^{2} \\sum y_{i}^{2} \\leq 1\\). Fix the choice of \\(y\\) 's. We see that we are trying to maximize a convex function in \\(n\\) variables \\(\\left(x_{1}, \\ldots, x_{n}\\right)\\) over a convex domain (actually the intersection of two planes with several half planes). So a maximum can only happen at the boundaries: when at most two of the \\(x\\) 's are different. An analogous argument applies to \\(y\\). In this way we find that it suffices to consider situations where \\(x_{\\bullet}\\) takes on at most two different values. The same argument applies to \\(y \\bullet\\). At this point the problem can be checked directly.", "source_pdf": "USAMO_2020.pdf", "notes": ""}
{"id": "USAMO-2021-1", "contest": "USAMO", "year": "2021", "problem_number": "1", "problem": "Rectangles \\(B C C_{1} B_{2}, C A A_{1} C_{2}\\), and \\(A B B_{1} A_{2}\\) are erected outside an acute triangle \\(A B C\\). Suppose that \\[ \\angle B C_{1} C+\\angle C A_{1} A+\\angle A B_{1} B=180^{\\circ} . \\] Prove that lines \\(B_{1} C_{2}, C_{1} A_{2}\\), and \\(A_{1} B_{2}\\) are concurrent.", "solution": "The angle condition implies the circumcircles of the three rectangles concur at a single point \\(P\\). Then \\(\\measuredangle C P B_{2}=\\measuredangle C P A_{1}=90^{\\circ}\\), hence \\(P\\) lies on \\(A_{1} B_{2}\\) etc., so we're done. Remark. As one might guess from the two-sentence solution, the entire difficulty of the problem is getting the characterization of the concurrence point.", "source_pdf": "USAMO_2021.pdf", "notes": ""}
{"id": "USAMO-2021-2", "contest": "USAMO", "year": "2021", "problem_number": "2", "problem": "The Planar National Park is a undirected 3-regular planar graph (i.e. all vertices have degree 3). A visitor walks through the park as follows: she begins at a vertex and starts walking along an edge. When she reaches the other endpoint, she turns left. On the next vertex she turns right, and so on, alternating left and right turns at each vertex. She does this until she gets back to the vertex where she started. What is the largest possible number of times she could have entered any vertex during her walk, over all possible layouts of the park?", "solution": "The answer is 3. We consider the trajectory of the visitor as an ordered sequence of turns. A turn is defined by specifying a vertex, the incoming edge, and the outgoing edge. Hence there are six possible turns for each vertex. Claim - Given one turn in the sequence, one can reconstruct the entire sequence of turns. Proof. This is clear from the process's definition: given a turn \\(t\\), one can compute the turn after it and the turn before it. This implies already that the trajectory of the visitor, when extended to an infinite sequence, is totally periodic (not just eventually periodic), because there are finitely many possible turns, so some turn must be repeated. So, any turn appears at most once in the period of the sequence, giving a na\u00efve bound of 6 for the original problem. However, the following claim improves the bound to 3. Claim - It is impossible for both of the turns \\(a \\rightarrow b \\rightarrow c\\) and \\(c \\rightarrow b \\rightarrow a\\) to occur in the same trajectory. Proof. If so, then extending the path, we get \\(a \\rightarrow b \\rightarrow c \\rightarrow d \\rightarrow e \\rightarrow \\cdots\\) and \\(\\cdots \\rightarrow e \\rightarrow d \\rightarrow c \\rightarrow b \\rightarrow a\\), as illustrated below in red and blue respectively. However, we assumed for contradiction the red and blue paths were part of the same trajectory, yet they clearly never meet. It remains to give a construction showing 3 can be achieved. There are many, many valid constructions. One construction due to Danielle Wang is given here, who provided the following motivation: \"I was lying in bed and drew the first thing I could think of\". The path is \\(C A H I F G D B A H E F G J B A C\\) which visits \\(A\\) three times. Remark. As the above example shows it is possible to transverse an edge more than once even in the same direction, as in edge \\(A H\\) above.", "source_pdf": "USAMO_2021.pdf", "notes": ""}
{"id": "USAMO-2021-3", "contest": "USAMO", "year": "2021", "problem_number": "3", "problem": "Let \\(n \\geq 2\\) be an integer. An \\(n \\times n\\) board is initially empty. Each minute, you may perform one of three moves: - If there is an L-shaped tromino region of three cells without stones on the board (see figure; rotations not allowed), you may place a stone in each of those cells. - If all cells in a column have a stone, you may remove all stones from that column. - If all cells in a row have a stone, you may remove all stones from that row. For which \\(n\\) is it possible that, after some non-zero number of moves, the board has no stones?", "solution": "The answer is \\(3 \\mid n\\). Construction: For \\(n=3\\), the construction is fairly straightforward, shown below. This can be extended to any \\(3 \\mid n\\). Polynomial-based proof of converse: Assume for contradiction \\(3 \\nmid n\\). We will show the task is impossible even if we allow stones to have real weights in our process. A valid elimination corresponds to a polynomial \\(P \\in \\mathbb{R}[x, y]\\) such that \\[ \\begin{aligned} \\operatorname{deg}_{x} P & \\leq n-2 \\\\ \\operatorname{deg}_{y} P & \\leq n-2 \\\\ (1+x+y) P(x, y) & \\in\\left\\langle 1+x+\\cdots+x^{n-1}, 1+y+\\cdots+y^{n-1}\\right\\rangle \\end{aligned} \\] (Here \\(\\langle\\ldots\\rangle\\) is an ideal of \\(\\mathbb{R}[x, y]\\).) In particular, if \\(S\\) is the set of \\(n\\)th roots of unity other than 1 , we should have \\[ \\left(1+z_{1}+z_{2}\\right) P\\left(z_{1}, z_{2}\\right)=0 \\] for any \\(z_{1}, z_{2} \\in S\\). Since \\(3 \\nmid n\\), it follows that \\(1+z_{1}+z_{2} \\neq 0\\) always. So \\(P\\) vanishes on \\(S \\times S\\), a contradiction to the bounds on \\(\\operatorname{deg} P\\) (by, say, combinatorial nullstellensatz on any nonzero term). Linear algebraic proof of converse (due to William Wang): Suppose there is a valid sequence of moves. Call \\(r_{j}\\) the number of operations clearing row \\(j\\), indexing from bottom-to-top. The idea behind the solution is that we are going to calculate, for each cell, the number of times it is operated on entirely as a function of \\(r_{j}\\). For example, a hypothetical illustration with \\(n=6\\) is partially drawn below, with the number in each cell denoting how many times it was the corner of an \\(L\\). Let \\(a_{i, j}\\) be the expression in \\((i, j)\\). It will also be helpful to define \\(c_{i}\\) in the obvious way as well. Claim - We have \\(c_{n}=r_{n}=0, a_{n-1, j}=r_{j}\\) and \\(a_{i, n-1}=c_{i}\\). Proof. The first statement follows since ( \\(n, n\\) ) may never obtain a stone. The equation \\(a_{n-1, j}=r_{j}\\) follows as both equal the number of times that cell ( \\(n, j\\) ) obtains a stone. The final equation is similar. Claim - For \\(1 \\leq i, j \\leq n-1\\), the following recursion holds: \\[ a_{i, j}+a_{i+1, j}+a_{i+1, j-1}=r_{j}+c_{i+1} \\] Proof. Focus on cell \\((i+1, j)\\). The left-hand side counts the number of times that gains a stone while the right-hand side counts the number of times it loses a stone; they must be equal. We can coerce the table above into matrix form now as follows. Define \\[ K=\\left[\\begin{array}{cccccccc} -1 & -1 & 0 & 0 & \\ldots & 0 & 0 & 0 \\\\ 0 & -1 & -1 & 0 & \\ldots & 0 & 0 & 0 \\\\ 0 & 0 & -1 & -1 & \\ldots & 0 & 0 & 0 \\\\ \\vdots & \\vdots & \\vdots & \\vdots & \\ddots & \\vdots & \\vdots & \\vdots \\\\ 0 & 0 & 0 & 0 & \\ldots & -1 & -1 & 0 \\\\ 0 & 0 & 0 & 0 & \\ldots & 0 & -1 & -1 \\\\ 1 & 1 & 1 & 1 & \\ldots & 1 & 1 & 0 \\end{array}\\right] \\] Then define a sequence of matrices \\(M_{i}\\) recursively by \\(M_{n-1}=\\mathrm{id}\\), and \\[ M_{i}=\\mathrm{id}+K M_{i+1}=\\mathrm{id}+K+\\cdots+K^{n-1-i} . \\] The matrices are chosen so that, by construction, \\[ \\left\\langle r_{1}, \\ldots, r_{n-1}\\right\\rangle M_{i}=\\left\\langle a_{i, 1}, \\ldots, a_{i, n-1}\\right\\rangle \\] for \\(i=1,2, \\ldots, n-1\\). On the other hand, we can extend the recursion one level deeper and obtain \\[ \\left\\langle r_{1}, \\ldots, r_{n-1}\\right\\rangle M_{0}=\\langle 0, \\ldots, 0\\rangle \\] However, the crux of the solution is the following. Claim - The eigenvalues of \\(K\\) are exactly \\(-\\left(1+e^{\\frac{2 \\pi i k}{n}}\\right)\\) for \\(k=1,2, \\ldots, n-1\\). Proof. The matrix \\(-(K+\\mathrm{id})\\) is fairly known to have roots of unity as the coefficients. However, we are told that apparently \\[ 0=\\operatorname{det} M_{0}=\\operatorname{det}\\left(\\mathrm{id}+K+K^{2}+\\cdots+K^{n-1}\\right) \\] which means \\(\\operatorname{det}\\left(K^{n}-\\mathrm{id}\\right)=0\\). This can only happen if \\(K^{n}\\) has eigenvalue 1 , meaning that \\[ [-(1+\\omega)]^{n}=1 \\] for \\(\\omega\\) some \\(n^{\\text {th }}\\) root of unity, not necessarily primitive. This can only happen if \\(|1+\\omega|=1\\), ergo \\(3 \\mid n\\).", "source_pdf": "USAMO_2021.pdf", "notes": ""}
{"id": "USAMO-2021-4", "contest": "USAMO", "year": "2021", "problem_number": "4", "problem": "A finite set \\(S\\) of positive integers has the property that, for each \\(s \\in S\\), and each positive integer divisor \\(d\\) of \\(s\\), there exists a unique element \\(t \\in S\\) satisfying \\(\\operatorname{gcd}(s, t)=d\\). (The elements \\(s\\) and \\(t\\) could be equal.) Given this information, find all possible values for the number of elements of \\(S\\).", "solution": "The answer is that \\(|S|\\) must be a power of 2 (including 1), or \\(|S|=0\\) (a trivial case we do not discuss further). Construction. For any nonnegative integer \\(k\\), a construction for \\(|S|=2^{k}\\) is given by \\[ S=\\left\\{\\left(p_{1} \\text { or } q_{1}\\right) \\times\\left(p_{2} \\text { or } q_{2}\\right) \\times \\cdots \\times\\left(p_{k} \\text { or } q_{k}\\right)\\right\\} \\] for \\(2 k\\) distinct primes \\(p_{1}, \\ldots, p_{k}, q_{1}, \\ldots, q_{k}\\). Converse. The main claim is as follows. Claim - In any valid set \\(S\\), for any prime \\(p\\) and \\(x \\in S, \\nu_{p}(x) \\leq 1\\). Proof. Assume for contradiction \\(e=\\nu_{p}(x) \\geq 2\\). - On the one hand, let \\(s=x\\) in the statement. Vary \\(t \\in S\\) across all the elements in \\(S\\) to get each divisor of \\(x\\) once. Since \\(\\frac{e}{e+1}\\) of the divisors of \\(x\\) are divisible by \\(p\\), it thus follows that \\(\\frac{e}{e+1}\\) of the elements are divisible by \\(p\\). - On the other hand, consider a \\(y \\in S\\) such that \\(\\nu_{p}(y)=1\\), which must exist (say if \\(\\operatorname{gcd}(x, y)=p\\) ). Taking \\(s=y\\) in the statement and repeating the same argument, we see \\(\\frac{1}{2}\\) of the elements of \\(S\\) are divisible by \\(p\\). So \\(e=1\\), contradiction. Now since \\(|S|\\) equals the number of divisors of any element of \\(S\\), we are done.", "source_pdf": "USAMO_2021.pdf", "notes": ""}
{"id": "USAMO-2021-5", "contest": "USAMO", "year": "2021", "problem_number": "5", "problem": "Let \\(n \\geq 4\\) be an integer. Find all positive real solutions to the following system of \\(2 n\\) equations: \\[ \\begin{aligned} a_{1} & =\\frac{1}{a_{2 n}}+\\frac{1}{a_{2}}, & a_{2} & =a_{1}+a_{3} \\\\ a_{3} & =\\frac{1}{a_{2}}+\\frac{1}{a_{4}}, & a_{4} & =a_{3}+a_{5} \\\\ a_{5} & =\\frac{1}{a_{4}}+\\frac{1}{a_{6}}, & a_{6} & =a_{5}+a_{7} \\\\ & \\vdots & & \\vdots \\\\ a_{2 n-1} & =\\frac{1}{a_{2 n-2}}+\\frac{1}{a_{2 n}}, & a_{2 n} & =a_{2 n-1}+a_{1} \\end{aligned} \\]", "solution": "The answer is that the only solution is \\((1,2,1,2, \\ldots, 1,2)\\) which works. We will prove \\(a_{2 k}\\) is a constant sequence, at which point the result is obvious. First approach (Andrew Gu). Apparently, with indices modulo \\(2 n\\), we should have \\[ a_{2 k}=\\frac{1}{a_{2 k-2}}+\\frac{2}{a_{2 k}}+\\frac{1}{a_{2 k+2}} \\] for every index \\(k\\) (this eliminates all \\(a_{\\text {odd }}\\) 's). Define \\[ m=\\min _{k} a_{2 k} \\quad \\text { and } \\quad M=\\max _{k} a_{2 k} \\] Look at the indices \\(i\\) and \\(j\\) achieving \\(m\\) and \\(M\\) to respectively get \\[ \\begin{aligned} & m=\\frac{2}{m}+\\frac{1}{a_{2 i-2}}+\\frac{1}{a_{2 i+2}} \\geq \\frac{2}{m}+\\frac{1}{M}+\\frac{1}{M}=\\frac{2}{m}+\\frac{2}{M} \\\\ & M=\\frac{2}{M}+\\frac{1}{a_{2 j-2}}+\\frac{1}{a_{2 j+2}} \\leq \\frac{2}{M}+\\frac{1}{m}+\\frac{1}{m}=\\frac{2}{m}+\\frac{2}{M} . \\end{aligned} \\] Together this gives \\(m \\geq M\\), so \\(m=M\\). That means \\(a_{2 i}\\) is constant as \\(i\\) varies, solving the problem. IT Second approach (author's solution). As before, we have \\[ a_{2 k}=\\frac{1}{a_{2 k-2}}+\\frac{2}{a_{2 k}}+\\frac{1}{a_{2 k+2}} \\] The proof proceeds in three steps. - Define \\[ S=\\sum_{k} a_{2 k}, \\quad \\text { and } \\quad T=\\sum_{k} \\frac{1}{a_{2 k}} . \\] Summing gives \\(S=4 T\\). On the other hand, Cauchy-Schwarz says \\(S \\cdot T \\geq n^{2}\\), so \\(T \\geq \\frac{1}{2} n\\). - On the other hand, \\[ 1=\\frac{1}{a_{2 k-2} a_{2 k}}+\\frac{2}{a_{2 k}^{2}}+\\frac{1}{a_{2 k} a_{2 k+2}} \\] Sum this modified statement to obtain \\[ n=\\sum_{k}\\left(\\frac{1}{a_{2 k}}+\\frac{1}{a_{2 k+2}}\\right)^{2} \\stackrel{\\mathrm{QM}-\\mathrm{AM}}{\\geq} \\frac{1}{n}\\left(\\sum_{k} \\frac{1}{a_{2 k}}+\\frac{1}{a_{2 k+2}}\\right)^{2}=\\frac{1}{n}(2 T)^{2} \\] So \\(T \\leq \\frac{1}{2} n\\). - Since \\(T \\leq \\frac{1}{2} n\\) and \\(T \\geq \\frac{1}{2} n\\), we must have equality everywhere above. This means \\(a_{2 k}\\) is a constant sequence. Remark. The problem is likely intractable over \\(\\mathbb{C}\\), in the sense that one gets a high-degree polynomial which almost certainly has many complex roots. So it seems likely that most solutions must involve some sort of inequality, using the fact we are over \\(\\mathbb{R}_{>0}\\) instead.", "source_pdf": "USAMO_2021.pdf", "notes": ""}
{"id": "USAMO-2021-6", "contest": "USAMO", "year": "2021", "problem_number": "6", "problem": "Let \\(A B C D E F\\) be a convex hexagon satisfying \\(\\overline{A B}\\|\\overline{D E}, \\overline{B C}\\| \\overline{E F}, \\overline{C D} \\| \\overline{F A}\\), and \\[ A B \\cdot D E=B C \\cdot E F=C D \\cdot F A \\] Let \\(X, Y\\), and \\(Z\\) be the midpoints of \\(\\overline{A D}, \\overline{B E}\\), and \\(\\overline{C F}\\). Prove that the circumcenter of \\(\\triangle A C E\\), the circumcenter of \\(\\triangle B D F\\), and the orthocenter of \\(\\triangle X Y Z\\) are collinear.", "solution": "We present two solutions. If Parallelogram solution found by contestants. Note that the following figure is intentionally not drawn to scale, to aid legibility. We construct parallelograms \\(A B C E^{\\prime}\\), etc as shown. Note that this gives two congruent triangles \\(A^{\\prime} C^{\\prime} E^{\\prime}\\) and \\(B^{\\prime} D^{\\prime} F^{\\prime}\\). (Assuming that triangle \\(X Y Z\\) is non-degenerate, the triangles \\(A^{\\prime} C^{\\prime} E^{\\prime}\\) and \\(B^{\\prime} D^{\\prime} F^{\\prime}\\) will also be nondegenerate.) Claim - If \\(A B \\cdot D E=B C \\cdot E F=C D \\cdot F A=k\\), then the circumcenters of \\(A C E\\) and \\(A^{\\prime} C^{\\prime} E^{\\prime}\\) coincide. Proof. The power of \\(A\\) to ( \\(A^{\\prime} C^{\\prime} E^{\\prime}\\) ) is \\(A E^{\\prime} \\cdot A C^{\\prime}=B C \\cdot E F=k\\); same for \\(C\\) and \\(E\\). Claim - Triangle \\(X Y Z\\) is the vector average of the (congruent) medial triangles of triangles \\(A^{\\prime} C^{\\prime} E^{\\prime}\\) and \\(B^{\\prime} D^{\\prime} F^{\\prime}\\). Proof. If \\(M\\) and \\(N\\) are the midpoints of \\(\\overline{C^{\\prime} E^{\\prime}}\\) and \\(\\overline{B^{\\prime} F^{\\prime}}\\), then \\(X\\) is the midpoint of \\(\\overline{M N}\\) by vector calculation: \\[ \\begin{aligned} \\frac{\\vec{M}+\\vec{N}}{2} & =\\frac{\\frac{\\vec{C}^{\\prime}+\\vec{E}^{\\prime}}{2}+\\frac{\\vec{B}^{\\prime}+\\vec{F}^{\\prime}}{2}}{2} \\\\ & =\\frac{\\vec{C}^{\\prime}+\\vec{E}^{\\prime}+\\vec{B}^{\\prime}+\\vec{F}^{\\prime}}{4} \\\\ & =\\frac{(\\vec{A}+\\vec{E}-\\vec{F})+(\\vec{C}+\\vec{A}-\\vec{B})+(\\vec{D}+\\vec{F}-\\vec{E})+(\\vec{B}+\\vec{D}-\\vec{C})}{4} \\\\ & =\\frac{\\vec{A}+\\vec{D}}{2}=\\vec{X} \\end{aligned} \\] Hence the orthocenter of \\(X Y Z\\) is the midpoint of the orthocenters of the medial triangles of \\(A^{\\prime} C^{\\prime} E^{\\prime}\\) and \\(B^{\\prime} D^{\\prime} F^{\\prime}\\) - that is, their circumcenters. If Author's solution. Call \\(M N P\\) and \\(U V W\\) the medial triangles of \\(A C E\\) and \\(B D F\\). Claim - In trapezoid \\(A B D E\\), the perpendicular bisector of \\(\\overline{X Y}\\) is the same as the perpendicular bisector of the midline \\(\\overline{W N}\\). Proof. This is true for any trapezoid: because \\(W X=\\frac{1}{2} A B=Y N\\). Claim - The points \\(V, W, M, N\\) are cyclic. Proof. By power of a point from \\(Y\\), since \\[ W Y \\cdot Y N=\\frac{1}{2} D E \\cdot \\frac{1}{2} A B=\\frac{1}{2} E F \\cdot \\frac{1}{2} B C=V Y \\cdot Y M \\] Applying all the cyclic variations of the above two claims, it follows that all six points \\(U, V, W, M, N, P\\) are concyclic, and the center of that circle coincides with the circumcenter of \\(\\triangle X Y Z\\). Remark. It is also possible to implement ideas from the first solution here, by showing all six midpoints have equal power to ( \\(X Y Z\\) ). Claim - The orthocenter of \\(X Y Z\\) is the midpoint of the circumcenters of \\(\\triangle A C E\\) and \\(\\triangle B D F\\). Proof. Apply complex numbers with the unit circle coinciding with the circumcircle of NVPWMU. Then \\[ \\begin{aligned} \\operatorname{orthocenter}(X Y Z) & =x+y+z=\\frac{a+b+c+d+e+f}{2} \\\\ \\text { circumcenter }(A C E) & =\\operatorname{orthocenter}(M N P) \\end{aligned} \\] \\[ \\begin{aligned} & =m+n+p=\\frac{c+e}{2}+\\frac{e+a}{2}+\\frac{a+c}{2}=a+c+e \\\\ \\operatorname{circumcenter}(B D F) & =\\operatorname{orthocenter}(U V W) \\\\ & =u+v+w=\\frac{d+f}{2}+\\frac{f+b}{2}+\\frac{b+d}{2}=b+d+f \\end{aligned} \\]", "source_pdf": "USAMO_2021.pdf", "notes": ""}
{"id": "USAMO-2022-1", "contest": "USAMO", "year": "2022", "problem_number": "1", "problem": "Let \\(a\\) and \\(b\\) be positive integers. Every cell of an \\((a+b+1) \\times(a+b+1)\\) grid is colored either amber or bronze such that there are at least \\(a^{2}+a b-b\\) amber cells and at least \\(b^{2}+a b-a\\) bronze cells. Prove that it is possible to choose \\(a\\) amber cells and \\(b\\) bronze cells such that no two of the \\(a+b\\) chosen cells lie in the same row or column.", "solution": "Claim - There exists a transversal \\(T_{a}\\) with at least \\(a\\) amber cells. Analogously, there exists a transversal \\(T_{b}\\) with at least \\(b\\) bronze cells.\n\nProof. If one picks a random transversal, the expected value of the number of amber cells is at least\n\\[\n\\frac{a^{2}+a b-b}{a+b+1}=(a-1)+\\frac{1}{a+b+1}>a-1 .\n\\]\n\nNow imagine we transform \\(T_{a}\\) to \\(T_{b}\\) in some number of steps, by repeatedly choosing cells \\(c\\) and \\(c^{\\prime}\\) and swapping them with the two other corners of the rectangle formed by their row/column, as shown in the figure.\n\nBy \"discrete intermediate value theorem\", the number of amber cells will be either \\(a\\) or \\(a+1\\) at some point during this transformation. This completes the proof.", "source_pdf": "USAMO_2022.pdf", "notes": ""}
{"id": "USAMO-2022-2", "contest": "USAMO", "year": "2022", "problem_number": "2", "problem": "Let \\(b \\geq 2\\) and \\(w \\geq 2\\) be fixed integers, and \\(n=b+w\\). Given are \\(2 b\\) identical black rods and \\(2 w\\) identical white rods, each of side length 1 .\nWe assemble a regular \\(2 n\\)-gon using these rods so that parallel sides are the same color. Then, a convex \\(2 b\\)-gon \\(B\\) is formed by translating the black rods, and a convex \\(2 w\\)-gon \\(W\\) is formed by translating the white rods. An example of one way of doing the assembly when \\(b=3\\) and \\(w=2\\) is shown below, as well as the resulting polygons \\(B\\) and \\(W\\).\n\nProve that the difference of the areas of \\(B\\) and \\(W\\) depends only on the numbers \\(b\\) and \\(w\\), and not on how the \\(2 n\\)-gon was assembled.", "solution": "We are going to prove that one may swap a black rod with an adjacent white rod (as well as the rods parallel to them) without affecting the difference in the areas of \\(B-W\\). Let \\(\\vec{u}\\) and \\(\\vec{v}\\) denote the originally black and white vectors that were adjacent on the \\(2 n\\)-gon and are now going to be swapped. Let \\(\\vec{x}\\) denote the sum of all the other black vectors between \\(\\vec{u}\\) and \\(-\\vec{u}\\), and define \\(\\vec{y}\\) similarly. See the diagram below, where \\(B_{0}\\) and \\(W_{0}\\) are the polygons before the swap, and \\(B_{1}\\) and \\(W_{1}\\) are the resulting changed polygons.\n\nObserve that the only change in \\(B\\) and \\(W\\) is in the parallelograms shown above in each diagram. Letting \\(\\wedge\\) denote the wedge product, we need to show that\n\\[\n\\vec{u} \\wedge \\vec{x}-\\vec{v} \\wedge \\vec{y}=\\vec{v} \\wedge \\vec{x}-\\vec{u} \\wedge \\vec{y}\n\\]\nwhich can be rewritten as\n\\[\n(\\vec{u}-\\vec{v}) \\wedge(\\vec{x}+\\vec{y})=0 .\n\\]\n\nIn other words, it would suffice to show \\(\\vec{u}-\\vec{v}\\) and \\(\\vec{x}+\\vec{y}\\) are parallel. (Students not familiar with wedge products can replace every \\(\\wedge\\) with the cross product \\(\\times\\) instead.)\n\nClaim - Both \\(\\vec{u}-\\vec{v}\\) and \\(\\vec{x}+\\vec{y}\\) are perpendicular to vector \\(\\vec{u}+\\vec{v}\\).\n\nProof. We have \\((\\vec{u}-\\vec{v}) \\perp(\\vec{u}+\\vec{v})\\) because \\(\\vec{u}\\) and \\(\\vec{v}\\) are the same length.\nFor the other perpendicularity, note that \\(\\vec{u}+\\vec{v}+\\vec{x}+\\vec{y}\\) traces out a diameter of the circumcircle of the original \\(2 n\\)-gon; call this diameter \\(A B\\), so\n\\[\nA+\\vec{u}+\\vec{v}+\\vec{x}+\\vec{y}=B .\n\\]\n\nNow point \\(A+\\vec{u}+\\vec{v}\\) is a point on this semicircle, which means (by the inscribed angle theorem) the angle between \\(\\vec{u}+\\vec{v}\\) and \\(\\vec{x}+\\vec{y}\\) is \\(90^{\\circ}\\).", "source_pdf": "USAMO_2022.pdf", "notes": ""}
{"id": "USAMO-2022-3", "contest": "USAMO", "year": "2022", "problem_number": "3", "problem": "Solve over positive real numbers the functional equation\n\\[\nf(x)=f(f(f(x))+y)+f(x f(y)) f(x+y) .\n\\]", "solution": "The answer is \\(f(x) \\equiv c / x\\) for any \\(c>0\\). This works, so we'll prove this is the only solution. The following is based on the solution posted by pad on AoPS.\n\nIn what follows, \\(f^{n}\\) as usual denotes \\(f\\) iterated \\(n\\) times, and \\(P(x, y)\\) is the given statement. Also, we introduce the notation \\(Q\\) for the statement\n\\[\nQ(a, b): \\quad f(a) \\geq f(b) \\Longrightarrow f(f(b)) \\geq a .\n\\]\n\nTo see why this statement \\(Q\\) is true, assume for contradiction that \\(a>f(f(b))\\); then consider \\(P(b, a-f(f(b)))\\) to get a contradiction.\n\nThe main idea of the problem is the following:\nClaim - Any function \\(f: \\mathbb{R}_{>0} \\rightarrow \\mathbb{R}_{>0}\\) obeying statement \\(Q\\) satisfies \\(f^{2}(x)=f^{4}(x)\\).\n\nProof. From \\(Q(t, t)\\) we get\n\\[\nf^{2}(t) \\geq t \\quad \\text { for all } t>0 .\n\\]\n\nSo this already implies \\(f^{4}(x) \\geq f^{2}(x)\\) by choosing \\(t=f^{2}(x)\\). It also gives \\(f(x) \\leq f^{3}(x) \\leq f^{5}(x)\\) by choosing \\(t=f(x), t=f^{3}(x)\\).\nThen \\(Q\\left(f^{4}(x), x\\right)\\) is valid and gives \\(f^{2}(x) \\geq f^{4}(x)\\), as needed.\n\nClaim - The function \\(f\\) is injective.\n\nProof. Suppose \\(f(u)=f(v)\\) for some \\(u>v\\). From \\(Q(u, v)\\) and \\(Q(v, u)\\) we have \\(f^{2}(v) \\geq u\\) and \\(f^{2}(u) \\geq v\\). Note that for all \\(x>0\\) we have statements\n\\[\n\\begin{aligned}\n& P\\left(f^{2}(x), u\\right) \\Longrightarrow f^{3}(x)=f(x+u)+f(x f(u)) f(x+u)=(1+f(x f(u))) f(x+u) \\\\\n& P\\left(f^{2}(x), v\\right) \\Longrightarrow f^{3}(x)=f(x+v)+f(x f(v)) f(x+v)=(1+f(x f(v))) f(x+v) .\n\\end{aligned}\n\\]\n\nIt follows that \\(f(x+u)=f(x+v)\\) for all \\(x>0\\).\nThis means that \\(f\\) is periodic with period \\(T=u-v>0\\). However, this is incompatible with \\(Q\\), because we would have \\(Q(1+n T, 1)\\) for all positive integers \\(n\\), which is obviously absurd.\n\nSince \\(f\\) is injective, we obtain that \\(f^{2}(x)=x\\). Thus \\(P(x, y)\\) now becomes the statement\n\\[\nP(x, y): \\quad f(x)=f(x+y) \\cdot[1+f(x f(y))] .\n\\]\n\nIn particular\n\\[\nP(1, y) \\Longrightarrow f(1+y)=\\frac{f(1)}{1+y}\n\\]\nso \\(f\\) is determined on inputs greater than 1 . Finally, if \\(a, b>1\\) we get\n\\[\nP(a, b) \\Longrightarrow \\frac{1}{a}=\\frac{1}{a+b} \\cdot\\left[1+f\\left(\\frac{a}{b} f(1)\\right)\\right]\n\\]\nwhich is enough to determine \\(f\\) on all inputs, by varying \\((a, b)\\).", "source_pdf": "USAMO_2022.pdf", "notes": ""}
{"id": "USAMO-2022-4", "contest": "USAMO", "year": "2022", "problem_number": "4", "problem": "Find all pairs of primes ( \\(p, q\\) ) for which \\(p-q\\) and \\(p q-q\\) are both perfect squares.", "solution": "The answer is \\((3,2)\\) only. This obviously works so we focus on showing it is the only one.\n\nIT Approach using difference of squares (from author). Set\n\\[\n\\begin{aligned}\na^{2} & =p-q \\\\\nb^{2} & =p q-q .\n\\end{aligned}\n\\]\n\nNote that \\(0<a<p\\), and \\(0<b<p\\) (because \\(q \\leq p\\) ). Now subtracting gives\n\\[\n\\underbrace{(b-a)}_{<p} \\underbrace{(b+a)}_{<2 p}=b^{2}-a^{2}=p(q-1)\n\\]\n\nThe inequalities above now force \\(b+a=p\\). Hence \\(q-1=b-a\\).\nThis means \\(p\\) and \\(q-1\\) have the same parity, which can only occur if \\(q=2\\). Finally, taking \\(\\bmod 3\\) shows \\(p \\equiv 0(\\bmod 3)\\). So ( 3,2 ) is the only possibility (and it does work).\n\nDivisibility approach (Aharshi Roy). Since \\(p q-q=q(p-1)\\) is a square, it follows that \\(q\\) divides \\(p-1\\) and that \\(\\frac{p-1}{q}\\) is a perfect square too. Hence the number\n\\[\ns^{2}:=(p-q) \\cdot \\frac{p-1}{q}=\\frac{p^{2}-q p-p+q}{q}\n\\]\nis also a perfect square. Rewriting this equation gives\n\\[\nq=\\frac{p^{2}-p}{s^{2}+(p-1)}\n\\]\n\nIn particular, \\(s^{2}+(p-1)\\) divides \\(p^{2}-p\\), and in particular \\(s \\leq p\\). We consider two cases:\n- If \\(s^{2}+(p-1)\\) is not divisible by \\(p\\), then it must divide \\(p-1\\), which can only happen if \\(s^{2}=0\\), or \\(p=q\\). However, it's easy to check there are no solutions in this case.\n- Otherwise, we should have \\(s^{2} \\equiv 1(\\bmod p)\\), so either \\(s=1\\) or \\(s=p-1\\). If \\(s=p-1\\) we get \\(q=1\\) which is absurd. On the other hand, if \\(s=1\\) we conclude \\(q=p-1\\) and hence \\(q=2, p=3\\).", "source_pdf": "USAMO_2022.pdf", "notes": ""}
{"id": "USAMO-2022-5", "contest": "USAMO", "year": "2022", "problem_number": "5", "problem": "A function \\(f: \\mathbb{R} \\rightarrow \\mathbb{R}\\) is essentially increasing if \\(f(s) \\leq f(t)\\) holds whenever \\(s \\leq t\\) are real numbers such that \\(f(s) \\neq 0\\) and \\(f(t) \\neq 0\\).\nFind the smallest integer \\(k\\) such that for any 2022 real numbers \\(x_{1}, x_{2}, \\ldots, x_{2022}\\), there exist \\(k\\) essentially increasing functions \\(f_{1}, \\ldots, f_{k}\\) such that\n\\[\nf_{1}(n)+f_{2}(n)+\\cdots+f_{k}(n)=x_{n} \\quad \\text { for every } n=1,2, \\ldots, 2022 .\n\\]", "solution": "The answer is 11 and, more generally, if 2022 is replaced by \\(N\\) then the answer is \\(\\left\\lfloor\\log _{2} N\\right\\rfloor+1\\).\n\nBound. Suppose for contradiction that \\(2^{k}-1>N\\) and choose \\(x_{n}=-n\\) for each \\(n=1, \\ldots, N\\). Now for each index \\(1 \\leq n \\leq N\\), define\n\\[\nS(n)=\\left\\{\\text { indices } i \\text { for which } f_{i}(n) \\neq 0\\right\\} \\subseteq\\{1, \\ldots, k\\}\n\\]\n\nAs each \\(S(n t)\\) is nonempty, by pigeonhole, two \\(S(n)\\) 's coincide, say \\(S(n)=S\\left(n^{\\prime}\\right)\\) for \\(n<n^{\\prime}\\). But it's plainly impossible that \\(x_{n}>x_{n^{\\prime}}\\) in that case due to the essentially increasing condition.\n\nI Construction. It suffices to do \\(N=2^{k}-1\\). Rather than drown the reader in notation, we'll just illustrate an example of the (inductive) construction for \\(k=4\\). Empty cells are zero.\n\n\\begin{tabular}{|l|l|l|l|l|}\n\\hline & \\(f_{1}\\) & \\(f_{2}\\) & \\(f_{3}\\) & \\(f_{4}\\) \\\\\n\\hline \\(x_{1}=3\\) & 3 & & & \\\\\n\\hline \\(x_{2}=1\\) & 10 & -9 & & \\\\\n\\hline \\(x_{3}=4\\) & \\multicolumn{4}{|c|}{4} \\\\\n\\hline \\(x_{4}=1\\) & 100 & 200 & -299 & \\\\\n\\hline \\(x_{5}=5\\) & & 200 & -195 & \\\\\n\\hline \\(x_{6}=9\\) & 100 & & -91 & \\\\\n\\hline \\(x_{7}=2\\) & \\multicolumn{4}{|c|}{2} \\\\\n\\hline \\(x_{8}=6\\) & 1000 & 2000 & 4000 & -6994 \\\\\n\\hline \\(x_{9}=5\\) & & 2000 & 4000 & -5995 \\\\\n\\hline \\(x_{10}=3\\) & 1000 & & 4000 & -4997 \\\\\n\\hline \\(x_{11}=5\\) & & & 4000 & -3995 \\\\\n\\hline \\(x_{12}=8\\) & 1000 & 2000 & & -2992 \\\\\n\\hline \\(x_{13}=9\\) & & 2000 & & -1991 \\\\\n\\hline \\(x_{14}=7\\) & 1000 & & & -993 \\\\\n\\hline \\(x_{15}=9\\) & \\multicolumn{4}{|r|}{9} \\\\\n\\hline\n\\end{tabular}\n\nThe general case is handled in the same way with powers of 10 replaced by powers of \\(B\\), for a sufficiently large number \\(B\\).", "source_pdf": "USAMO_2022.pdf", "notes": ""}
{"id": "USAMO-2022-6", "contest": "USAMO", "year": "2022", "problem_number": "6", "problem": "There are 2022 users on a social network called Mathbook, and some of them are Mathbook-friends. (On Mathbook, friendship is always mutual and permanent.)\nStarting now, Mathbook will only allow a new friendship to be formed between two users if they have at least two friends in common. What is the minimum number of friendships that must already exist so that every user could eventually become friends with every other user?", "solution": "With 2022 replaced by \\(n\\), the answer is \\(\\left\\lceil\\frac{3}{2} n\\right\\rceil-2\\).\n\nIT Terminology. Standard graph theory terms: starting from a graph \\(G\\) on \\(n\\) vertices, we're allowed to take any \\(C_{4}\\) in the graph and complete it to a \\(K_{4}\\). The problem asks the minimum number of edges needed so that this operation lets us transform \\(G\\) to \\(K_{n}\\).\n\nIT Construction. For even \\(n\\), start with an edge \\(a b\\), and then create \\(n / 2-1\\) copies of \\(C_{4}\\) that use \\(a b\\) as an edge, as shown below for \\(n=14\\) (six copies of \\(C_{4}\\) ).\n\nThis can be completed into \\(K_{n}\\) by first completing the \\(n / 2-1 C_{4}\\) 's into \\(K_{4}\\), then connecting red vertices to every gray vertex, and then finishing up.\n\nThe construction for odd \\(n\\) is the same except with one extra vertex \\(c\\) which is connected to both \\(a\\) and \\(b\\).\n\nI Bound. Notice that additional operations or connections can never hurt. So we will describe a specific algorithm that performs operations on the graph until no more operations are possible. This means that if this algorithm terminates with anything other \\(G=K_{n}\\), the graph was never completable to \\(K_{n}\\) to begin with.\n\nThe algorithm uses the following data: it keeps a list \\(\\mathcal{C}\\) of cliques of \\(G\\), and a labeling \\(\\mathcal{L}: E(G) \\rightarrow \\mathcal{C}\\) which assigns to every edge one of the cliques that contains it.\n- Initially, \\(\\mathcal{C}\\) consists of one \\(K_{2}\\) for every edge of \\(G\\), and each edge is labeled in the obvious way.\n- At each step, the algorithm arbitrarily takes any \\(C_{4}=a b c d\\) whose four edges \\(a b\\), \\(b c, c d, d a\\) do not all have the same label. Consider these labels that appear (at least two, and up to four), and let \\(V\\) be the union of all vertices in any of these 2-4 cliques.\n- Do the following graph operations: connect \\(a c\\) and \\(b d\\), then connect every vertex in \\(V-\\{a, b, c, d\\}\\) to each of \\(\\{a, b, c, d\\}\\). Finally, complete this to a clique on \\(V\\).\n- Update \\(\\mathcal{C}\\) by merging these \\(2-4\\) cliques into a single clique \\(K_{V}\\).\n- Update \\(\\mathcal{L}\\) by replacing every edge that was labeled with one of these \\(2-4\\) cliques with the label \\(K_{V}\\). Also, update every newly created edge to have label \\(K_{V}\\). However, if there were existing edges not labeled with one of the \\(2-4\\) cliques, then we do not update these!\n- Stop once every \\(C_{4}\\) has only one label appearing among its edges. When this occurs, no operations are possible at all on the graph.\n\nA few steps of the process are illustrated below for a graph on six vertices with nine initial edges. There are initially nine \\(K_{2}\\) 's labeled A, B, ..., I. Original edges are always bolder than added edges. The relabeled edges in each step are highlighted in color. Notice how we need an entirely separate operation to get G to become L , even though no new edges are drawn in the graph.\n\nAs we remarked, if the graph is going to be completable to \\(K_{n}\\) at all, then this algorithm must terminate with \\(\\mathcal{C}=\\left\\{K_{n}\\right\\}\\). We will use this to prove our bound.\n\nWe proceed by induction in the following way. For a clique \\(K\\), let \\(\\theta(K)\\) denote the number of edges of the original graph \\(G\\) which are labeled by \\(K\\) (this does not include new edges added by the algorithm); hence the problem amounts to estimating how small \\(\\theta\\left(K_{n}\\right)\\) can be. We are trying to prove:\n\nClaim - At any point in the operation, if \\(K\\) is a clique in the cover \\(\\mathcal{C}\\), then\n\\[\n\\theta(K) \\geq \\frac{3|K|}{2}-2\n\\]\nwhere \\(|K|\\) is the number of vertices in \\(K\\).\n\nProof. By induction on the time step of the algorithm. The base case is clear, because then \\(K\\) is just a single edge of \\(G\\), so \\(\\theta(K)=1\\) and \\(|K|=2\\).\n\nThe inductive step is annoying casework based on the how the merge occurred. Let \\(C_{4}=a b c d\\) be the 4 -cycle operated on. In general, the \\(\\theta\\) value of a newly created \\(K\\) is exactly the sum of the \\(\\theta\\) values of the merged cliques, by definition. Meanwhile, \\(|K|\\) is the number of vertices in the union of the merged cliques; so it's the sum of the sizes of these cliques minus some error due to overcounting of vertices appearing more than once. To be explicit:\n- Suppose we merged four cliques \\(W, X, Y, Z\\). By definition,\n\\[\n\\begin{aligned}\n\\theta(K) & =\\theta(W)+\\theta(X)+\\theta(Y)+\\theta(Z) \\\\\n& \\geq \\frac{3}{2}(|W|+|X|+|Y|+|Z|)-8=\\frac{3}{2}(|W|+|X|+|Y|+|Z|-4)-2\n\\end{aligned}\n\\]\n\nOn the other hand \\(|K| \\leq|W|+|X|+|Y|+|Z|-4\\); the -4 term comes from each of \\(\\{a, b, c, d\\}\\) being in two (or more) of \\(\\{W, X, Y, Z\\}\\). So this case is OK.\n- Suppose we merged three cliques \\(X, Y, Z\\). By definition,\n\\[\n\\begin{aligned}\n\\theta(K) & =\\theta(X)+\\theta(Y)+\\theta(Z) \\\\\n& \\geq \\frac{3}{2}(|X|+|Y|+|Z|)-6=\\frac{3}{2}\\left(|X|+|Y|+|Z|-\\frac{8}{3}\\right)-2\n\\end{aligned}\n\\]\n\nOn the other hand, \\(|K| \\leq|X|+|Y|+|Z|-3\\), since at least 3 of \\(\\{a, b, c, d\\}\\) are repeated among \\(X, Y, Z\\). Note in this case the desired inequality is actually strict.\n- Suppose we merged two cliques \\(Y, Z\\). By definition,\n\\[\n\\begin{aligned}\n\\theta(K) & =\\theta(Y)+\\theta(Z) \\\\\n& \\geq \\frac{3}{2}(|Y|+|Z|)-4=\\frac{3}{2}\\left(|Y|+|Z|-\\frac{4}{3}\\right)-2\n\\end{aligned}\n\\]\n\nOn the other hand, \\(|K| \\leq|Y|+|Z|-2\\), since at least 2 of \\(\\{a, b, c, d\\}\\) are repeated among \\(Y, Z\\). Note in this case the desired inequality is actually strict.\n\nRemark. Several subtle variations of this method do not seem to work.\n- It does not seem possible to require the cliques in \\(\\mathcal{C}\\) to be disjoint, which is why it's necessary to introduce a label function \\(\\mathcal{L}\\) as well.\n- It seems you do have to label the newly created edges, even though they do not count towards any \\(\\theta\\) value. Otherwise the termination of the algorithm doesn't tell you enough.\n- Despite this, relabeling existing edges, like G in step 1 of the example, 1 seems to cause a lot of issues. The induction becomes convoluted if \\(\\theta(K)\\) is not exactly the sum of \\(\\theta\\)-values of the subparts, while the disappearance of an edge from a clique will\nalso break induction.", "source_pdf": "USAMO_2022.pdf", "notes": ""}
{"id": "USAMO-2023-1", "contest": "USAMO", "year": "2023", "problem_number": "1", "problem": "In an acute triangle \\(A B C\\), let \\(M\\) be the midpoint of \\(\\overline{B C}\\). Let \\(P\\) be the foot of the perpendicular from \\(C\\) to \\(A M\\). Suppose that the circumcircle of triangle \\(A B P\\) intersects line \\(B C\\) at two distinct points \\(B\\) and \\(Q\\). Let \\(N\\) be the midpoint of \\(\\overline{A Q}\\). Prove that \\(N B=N C\\).", "solution": "We show several different approaches. In all solutions, let \\(D\\) denote the foot of the altitude from \\(A\\). The solution hinges on the following claim: Claim - \\(Q\\) coincides with the reflection of \\(D\\) across \\(M\\). Proof. Note that \\(\\measuredangle A D C=\\measuredangle A P C=90^{\\circ}\\), so \\(A D P C\\) is cyclic. Then by power of a point (with the lengths directed), \\[ M B \\cdot M Q=M A \\cdot M P=M C \\cdot M D \\] Since \\(M B=M C\\), the claim follows. It follows that \\(\\overline{M N} \\| \\overline{A D}\\), as \\(M\\) and \\(N\\) are respectively the midpoints of \\(\\overline{A Q}\\) and \\(\\overline{D Q}\\). Thus \\(\\overline{M N} \\perp \\overline{B C}\\), and so \\(N\\) lies on the perpendicular bisector of \\(\\overline{B C}\\), as needed.", "source_pdf": "USAMO_2023.pdf", "notes": ""}
{"id": "USAMO-2023-2", "contest": "USAMO", "year": "2023", "problem_number": "2", "problem": "Solve over the positive real numbers the functional equation \\[ f(x y+f(x))=x f(y)+2 \\]", "solution": "The answer is \\(f(x) \\equiv x+1\\), which is easily verified to be the only linear solution. We show conversely that \\(f\\) is linear. Let \\(P(x, y)\\) be the assertion. Claim - \\(f\\) is weakly increasing. Proof. Assume for contradiction \\(a>b\\) but \\(f(a)<f(b)\\). Choose \\(y\\) such that \\(a y+f(a)= b y+f(b)\\), that is \\(y=\\frac{f(b)-f(a)}{a-b}\\). Then \\(P(a, y)\\) and \\(P(b, y)\\) gives \\(a f(y)+2=b f(y)+2\\), which is impossible. Claim (Up to an error of 2, \\(f\\) is linear) - We have \\[ |f(x)-(K x+C)| \\leq 2 \\] where \\(K:=\\frac{2}{f(1)}\\) and \\(C:=f(2 f(1))-2\\) are constants. Proof. Note \\(P(1, y)\\) gives \\(f(y+f(1))=f(y)+2\\). Hence, \\(f(n f(1))=2(n-1)+f(f(1))\\) for \\(n \\geq 1\\). Combined with weakly increasing, this gives \\[ 2\\left\\lfloor\\frac{x}{f(1)}\\right\\rfloor+C \\leq f(x) \\leq 2\\left\\lceil\\frac{x}{f(1)}\\right\\rceil+C \\] which implies the result. However, we will only need to remember from the earlier claim that \\[ f(x)=K x+O(1) \\] Then for any \\(x\\) and \\(y\\), the above claim gives \\[ K(x y+K x+O(1))+O(1)=x f(y)+2 \\] which means that \\[ x \\cdot\\left(K y+K^{2}-f(y)\\right)=O(1) . \\] If we fix \\(y\\) and consider large \\(x\\), we see this can only happen if \\(K y+K^{2}-f(y)=0\\), i.e. \\(f\\) is linear.", "source_pdf": "USAMO_2023.pdf", "notes": ""}
{"id": "USAMO-2023-3", "contest": "USAMO", "year": "2023", "problem_number": "3", "problem": "Consider an \\(n\\)-by- \\(n\\) board of unit squares for some odd positive integer \\(n\\). We say that a collection \\(C\\) of identical dominoes is a maximal grid-aligned configuration on the board if \\(C\\) consists of \\(\\left(n^{2}-1\\right) / 2\\) dominoes where each domino covers exactly two neighboring squares and the dominoes don't overlap: \\(C\\) then covers all but one square on the board. We are allowed to slide (but not rotate) a domino on the board to cover the uncovered square, resulting in a new maximal grid-aligned configuration with another square uncovered. Let \\(k(C)\\) be the number of distinct maximal grid-aligned configurations obtainable from \\(C\\) by repeatedly sliding dominoes. Find all possible values of \\(k(C)\\) as a function of \\(n\\).", "solution": "The answer is that \\[ k(C) \\in\\left\\{1,2, \\ldots,\\left(\\frac{n-1}{2}\\right)^{2}\\right\\} \\cup\\left\\{\\left(\\frac{n+1}{2}\\right)^{2}\\right\\} . \\] Index the squares by coordinates \\((x, y) \\in\\{1,2, \\ldots, n\\}^{2}\\). We say a square is special if it is empty or it has the same parity in both coordinates as the empty square. We now proceed in two cases: IT The special squares have both odd coordinates. We construct a directed graph \\(G=G(C)\\) whose vertices are special squares as follows: for each domino on a special square \\(s\\), we draw a directed edge from \\(s\\) to the special square that domino points to. Thus all special squares have an outgoing edge except the empty cell. Claim - Any undirected connected component of \\(G\\) is acyclic unless the cycle contains the empty square inside it. Proof. Consider a cycle of \\(G\\); we are going to prove that the number of chessboard cells enclosed is always odd. This can be proven directly by induction, but for theatrical effect, we use Pick's theorem. Mark the center of every chessboard cell on or inside the cycle to get a lattice. The dominoes of the cycle then enclose a polyominoe which actually consists of \\(2 \\times 2\\) squares, meaning its area is a multiple of 4 . Hence \\(B / 2+I-1\\) is a multiple of 4 , in the notation of Pick's theorem. As \\(B\\) is twice the number of dominoes, and a parity argument on the special squares shows that number is even, it follows that \\(B\\) is also a multiple of 4 (these correspond to blue and black in the figure above). This means \\(I\\) is odd (the red dots in the figure above), as desired. Let \\(T\\) be the connected component containing the empty cell. By the claim, \\(T\\) is acyclic, so it's a tree. Now, notice that all the arrows point along \\(T\\) towards the empty cell, and moving a domino corresponds to flipping an arrow. Therefore: Claim - \\(k(C)\\) is exactly the number of vertices of \\(T\\). Proof. Starting with the underlying tree, the set of possible graphs is described by picking one vertex to be the sink (the empty cell) and then directing all arrows towards it. This implies that \\(k(C) \\leq\\left(\\frac{n+1}{2}\\right)^{2}\\) in this case. Equality is achieved if \\(T\\) is a spanning tree of \\(G\\). One example of a way to achieve this is using the snake configuration below. Conversely, suppose \\(T\\) was not a spanning tree, i.e. \\(T \\neq G\\). Since in this odd-odd case, \\(G\\) has one fewer edge than vertex, if \\(G\\) is not a tree, then it must contain at least one cycle. That cycle encloses every special square of \\(T\\). In particular, this means that \\(T\\) can't contain any special squares from the outermost row or column of the \\(n \\times n\\) grid. In this situation, we therefore have \\(k(C) \\leq\\left(\\frac{n-3}{2}\\right)^{2}\\). IT The special squares have both even coordinates. We construct the analogous graph \\(G\\) on the same special squares. However, in this case, some of the points may not have outgoing edges, because their domino may \"point\" outside the grid. As before, the connected component \\(T\\) containing the empty square is a tree, and \\(k(C)\\) is exactly the number of vertices of \\(T\\). Thus to finish the problem we need to give, for each \\(k \\in\\left\\{1,2, \\ldots,\\left(\\frac{n-1}{2}\\right)^{2}\\right\\}\\), an example of a configuration where \\(G\\) has exactly \\(k\\) vertices. The construction starts with a \"snake\" picture for \\(k=\\left(\\frac{n-1}{2}\\right)^{2}\\), then decreases \\(k\\) by one by perturbing a suitable set of dominoes. Rather than write out the procedure in words, we show the sequence of nine pictures for \\(n=7\\) (where \\(k=9,8, \\ldots, 1\\) ); the generalization to larger \\(n\\) is straightforward.", "source_pdf": "USAMO_2023.pdf", "notes": ""}
{"id": "USAMO-2023-4", "contest": "USAMO", "year": "2023", "problem_number": "4", "problem": "Positive integers \\(a\\) and \\(N\\) are fixed, and \\(N\\) positive integers are written on a blackboard. Alice and Bob play the following game. On Alice's turn, she must replace some integer \\(n\\) on the board with \\(n+a\\), and on Bob's turn he must replace some even integer \\(n\\) on the board with \\(n / 2\\). Alice goes first and they alternate turns. If on his turn Bob has no valid moves, the game ends. After analyzing the \\(N\\) integers on the board, Bob realizes that, regardless of what moves Alice makes, he will be able to force the game to end eventually. Show that, in fact, for this value of \\(a\\) and these \\(N\\) integers on the board, the game is guaranteed to end regardless of Alice's or Bob's moves.", "solution": "For \\(N=1\\), there is nothing to prove. We address \\(N \\geq 2\\) only henceforth. Let \\(S\\) denote the numbers on the board. Claim - When \\(N \\geq 2\\), if \\(\\nu_{2}(x)<\\nu_{2}(a)\\) for all \\(x \\in S\\), the game must terminate no matter what either player does. Proof. The \\(\\nu_{2}\\) of a number is unchanged by Alice's move and decreases by one on Bob's move. The game ends when every \\(\\nu_{2}\\) is zero. Hence, in fact the game will always terminate in exactly \\(\\sum_{x \\in S} \\nu_{2}(x)\\) moves in this case, regardless of what either player does. Claim - When \\(N \\geq 2\\), if there exists a number \\(x\\) on the board such that \\(\\nu_{2}(x) \\geq \\nu_{2}(a)\\), then Alice can cause the game to go on forever. Proof. Denote by \\(x\\) the first entry of the board (its value changes over time). Then Alice's strategy is to: - Operate on the first entry if \\(\\nu_{2}(x)=\\nu_{2}(a)\\) (the new entry thus has \\(\\nu_{2}(x+a)>\\nu_{2}(a)\\) ); - Operate on any other entry besides the first one, otherwise. A double induction then shows that - Just before each of Bob's turns, \\(\\nu_{2}(x)>\\nu_{2}(a)\\) always holds; and - After each of Bob's turns, \\(\\nu_{2}(x) \\geq \\nu_{2}(a)\\) always holds. In particular Bob will never run out of legal moves, since halving \\(x\\) is always legal.", "source_pdf": "USAMO_2023.pdf", "notes": ""}
{"id": "USAMO-2023-5", "contest": "USAMO", "year": "2023", "problem_number": "5", "problem": "Let \\(n \\geq 3\\) be an integer. We say that an arrangement of the numbers \\(1,2, \\ldots, n^{2}\\) in an \\(n \\times n\\) table is row-valid if the numbers in each row can be permuted to form an arithmetic progression, and column-valid if the numbers in each column can be permuted to form an arithmetic progression. For what values of \\(n\\) is it possible to transform any row-valid arrangement into a column-valid arrangement by permuting the numbers in each row?", "solution": "Answer: \\(n\\) prime only. IT Proof for \\(n\\) prime. Suppose \\(n=p\\). In an arithmetic progression with \\(p\\) terms, it's easy to see that either every term has a different residue modulo \\(p\\) (if the common difference is not a multiple of \\(p\\) ), or all of the residues coincide (when the common difference is a multiple of \\(p\\) ). So, look at the multiples of \\(p\\) in a row-valid table; there is either 1 or \\(p\\) per row. As there are \\(p\\) such numbers total, there are two cases: - If all the multiples of \\(p\\) are in the same row, then the common difference in each row is a multiple of \\(p\\). In fact, it must be exactly \\(p\\) for size reasons. In other words, up to permutation the rows are just the \\(k(\\bmod p)\\) numbers in some order, and this is obviously column-valid because we can now permute such that the \\(k\\) th column contains exactly \\(\\{(k-1) p+1,(k-1) p+2, \\ldots, k p\\}\\). - If all the multiples of \\(p\\) are in different rows, then it follows each row contains every residue modulo \\(p\\) exactly once. So we can permute to a column-valid arrangement by ensuring the \\(k\\) th column contains all the \\(k(\\bmod p)\\) numbers. I Counterexample for \\(n\\) composite (due to Anton Trygub). Let \\(p\\) be any prime divisor of \\(n\\). Construct the table as follows: - Row 1 contains 1 through \\(n\\). - Rows 2 through \\(p+1\\) contain the numbers from \\(p+1\\) to \\(n p+n\\) partitioned into arithmetic progressions with common difference \\(p\\). - The rest of the rows contain the remaining numbers in reading order. For example, when \\(p=2\\) and \\(n=10\\), we get the following table: \\[ \\left[\\begin{array}{cccccccccc} 1 & 2 & 3 & 4 & 5 & 6 & 7 & 8 & 9 & 10 \\\\ \\mathbf{1 1} & \\mathbf{1 3} & \\mathbf{1 5} & \\mathbf{1 7} & \\mathbf{1 9} & \\mathbf{2 1} & \\mathbf{2 3} & \\mathbf{2 5} & \\mathbf{2 7} & \\mathbf{2 9} \\\\ \\mathbf{1 2} & \\mathbf{1 4} & \\mathbf{1 6} & \\mathbf{1 8} & \\mathbf{2 0} & \\mathbf{2 2} & \\mathbf{2 4} & \\mathbf{2 6} & \\mathbf{2 8} & \\mathbf{3 0} \\\\ 31 & 32 & 33 & 34 & 35 & 36 & 37 & 38 & 39 & 40 \\\\ 41 & 42 & 43 & 44 & 45 & 46 & 47 & 48 & 49 & 50 \\\\ 51 & 52 & 53 & 54 & 55 & 56 & 57 & 58 & 59 & 60 \\\\ 61 & 62 & 63 & 64 & 65 & 66 & 67 & 68 & 69 & 70 \\\\ 71 & 72 & 73 & 74 & 75 & 76 & 77 & 78 & 79 & 80 \\\\ 81 & 82 & 83 & 84 & 85 & 86 & 87 & 88 & 89 & 90 \\\\ 91 & 92 & 93 & 94 & 95 & 96 & 97 & 98 & 99 & 100 \\end{array}\\right] \\] We claim this works fine. Assume for contradiction the rows may be permuted to obtain a column-valid arrangement. Then the \\(n\\) columns should be arithmetic progressions whose smallest element is in \\([1, n]\\) and whose largest element is in \\(\\left[n^{2}-n+1, n^{2}\\right]\\). These two elements must be congruent modulo \\(n-1\\), so in particular the column containing 2 must end with \\(n^{2}-n+2\\). Hence in that column, the common difference must in fact be exactly \\(n\\). And yet \\(n+2\\) and \\(2 n+2\\) are in the same row, contradiction.", "source_pdf": "USAMO_2023.pdf", "notes": ""}
{"id": "USAMO-2023-6", "contest": "USAMO", "year": "2023", "problem_number": "6", "problem": "Let \\(A B C\\) be a triangle with incenter \\(I\\) and excenters \\(I_{a}, I_{b}, I_{c}\\) opposite \\(A, B\\), and \\(C\\), respectively. Given an arbitrary point \\(D\\) on the circumcircle of \\(\\triangle A B C\\) that does not lie on any of the lines \\(I I_{a}, I_{b} I_{c}\\), or \\(B C\\), suppose the circumcircles of \\(\\triangle D I I_{a}\\) and \\(\\triangle D I_{b} I_{c}\\) intersect at two distinct points \\(D\\) and \\(F\\). If \\(E\\) is the intersection of lines \\(D F\\) and \\(B C\\), prove that \\(\\angle B A D=\\angle E A C\\).", "solution": "Here are two approaches. IT Barycentric coordinates (Carl Schildkraut). With reference triangle \\(\\triangle A B C\\), set \\(D=(r: s: t)\\). Claim - The equations of ( \\(D I I_{a}\\) ) and ( \\(D I_{b} I_{c}\\) ) are, respectively, \\[ \\begin{aligned} & 0=-a^{2} y z-b^{2} z x-c^{2} x y+(x+y+z) \\cdot\\left(b c x-\\frac{b c r}{c s-b t}(c y-b z)\\right) \\\\ & 0=-a^{2} y z-b^{2} z x-c^{2} x y+(x+y+z) \\cdot\\left(-b c x+\\frac{b c r}{c s+b t}(c y+b z)\\right) . \\end{aligned} \\] Proof. Since \\(D \\in(A B C)\\), we have \\(a^{2} s t+b^{2} t r+c^{2} r s=0\\). Now each equation can be verified by direct substitution of three points. By EGMO Lemma 7.24, the radical axis is then given by \\[ \\overline{D F}: b c x-\\frac{b c r}{c s-b t}(c y-b z)=-b c x+\\frac{b c r}{c s+b t}(c y+b z) . \\] Now the point \\[ \\left(0: \\frac{b^{2}}{s}: \\frac{c^{2}}{t}\\right)=\\left(0: b^{2} t: c^{2} s\\right) \\] lies on line \\(D F\\) by inspection, and is obviously on line \\(B C\\), hence it coincides with \\(E\\). This lies on the isogonal of \\(\\overline{A D}\\) (by EGMO Lemma 7.6), as needed. IT Synthetic approach (Anant Mudgal). Focus on just ( \\(D I I_{a}\\) ). Let \\(P\\) be the second intersection of ( \\(D I I_{a}\\) ) with ( \\(A B C\\) ), and let \\(M\\) be the midpoint of minor arc \\(\\widehat{B C}\\). Then by radical axis, lines \\(A M, D P\\), and \\(B C\\) are concurrent at a point \\(K\\). Let \\(E^{\\prime}=\\overline{P M} \\cap \\overline{B C}\\). Claim - We have \\(\\measuredangle B A D=\\measuredangle E^{\\prime} A C\\). Proof. By shooting lemma, \\(A K E^{\\prime} P\\) is cyclic, so \\[ \\measuredangle K A E^{\\prime}=\\measuredangle K P E^{\\prime}=\\measuredangle D P M=\\measuredangle D A M . \\] Claim - The power of point \\(E^{\\prime}\\) with respect to ( \\(D I I_{a}\\) ) is \\(2 E^{\\prime} B \\cdot E^{\\prime} C\\). Proof. Construct parallelogram \\(I E^{\\prime} I_{a} X\\). Since \\(M I^{2}=M E^{\\prime} \\cdot M P\\), we can get \\[ \\measuredangle X I_{a} I=\\measuredangle I_{a} I E^{\\prime}=\\measuredangle M I E^{\\prime}=\\measuredangle M P I=\\measuredangle X P I . \\] Hence \\(X\\) lies on ( \\(D I I_{a}\\) ), and \\(E^{\\prime} X \\cdot E^{\\prime} P=2 E^{\\prime} M \\cdot E^{\\prime} P=2 E^{\\prime} B \\cdot E^{\\prime} C\\). Repeat the argument on \\(\\left(D I_{b} I_{c}\\right)\\); the same point \\(E^{\\prime}\\) (because of the first claim) then has power \\(2 E^{\\prime} B \\cdot E^{\\prime} C\\) with respect to \\(\\left(D I_{b} I_{c}\\right)\\). Hence \\(E^{\\prime}\\) lies on the radical axis of ( \\(D I I_{a}\\) ) and \\(\\left(D I_{b} I_{c}\\right)\\), ergo \\(E^{\\prime}=E\\). The first claim then solves the problem.", "source_pdf": "USAMO_2023.pdf", "notes": ""}
{"id": "USAMO-2024-1", "contest": "USAMO", "year": "2024", "problem_number": "1", "problem": "Find all integers \\(n \\geq 3\\) such that the following property holds: if we list the divisors of \\(n!\\) in increasing order as \\(1=d_{1}<d_{2}<\\cdots<d_{k}=n!\\), then we have \\[ d_{2}-d_{1} \\leq d_{3}-d_{2} \\leq \\cdots \\leq d_{k}-d_{k-1} \\]", "solution": "The answer is \\(n \\in\\{3,4\\}\\). These can be checked by listing all the divisors: - For \\(n=3\\) we have \\((1,2,3,6)\\). - For \\(n=4\\) we have \\((1,2,3,4,6,8,12,24)\\). We prove these are the only ones. The numbers \\(5 \\leq n \\leq 12\\) all fail because: - For \\(n=5\\) we have \\(20-15>24-20\\). - For \\(n=6\\) we have \\(120-90>144-20\\). - For \\(7 \\leq n \\leq 12\\) we have because \\(14-12>15-14\\) (and \\(13 \\nmid n!\\) ). Now assume \\(n \\geq 13\\). In that case, we have \\[ \\left\\lfloor\\frac{n}{2}\\right\\rfloor^{2}-1 \\geq 2 n . \\] So by Bertrand postulate, we can find a prime \\(p\\) such that \\[ n<p<\\left\\lfloor\\frac{n}{2}\\right\\rfloor^{2}-1 . \\] However, note that \\[ \\left\\lfloor\\frac{n}{2}\\right\\rfloor^{2}-1=\\left(\\left\\lfloor\\frac{n}{2}\\right\\rfloor-1\\right)\\left(\\left\\lfloor\\frac{n}{2}\\right\\rfloor+1\\right), \\quad\\left\\lfloor\\frac{n}{2}\\right\\rfloor^{2} \\] are consecutive integers both dividing \\(n!\\) (the latter number divides \\(\\left\\lfloor\\frac{n}{2}\\right\\rfloor \\cdot\\left(2\\left\\lfloor\\frac{n}{2}\\right\\rfloor\\right)\\) ). So the prime \\(p\\) causes the desired contradiction.", "source_pdf": "USAMO_2024.pdf", "notes": ""}
{"id": "USAMO-2024-2", "contest": "USAMO", "year": "2024", "problem_number": "2", "problem": "Let \\(S_{1}, S_{2}, \\ldots, S_{100}\\) be finite sets of integers whose intersection is not empty. For each non-empty \\(T \\subseteq\\left\\{S_{1}, S_{2}, \\ldots, S_{100}\\right\\}\\), the size of the intersection of the sets in \\(T\\) is a multiple of \\(|T|\\). What is the smallest possible number of elements which are in at least 50 sets?", "solution": "The answer is \\(50\\binom{100}{50}\\). IT Rephrasing (cosmetic translation only, nothing happens yet). We encode with binary strings \\(v \\in \\mathbb{F}_{2}^{100}\\) of length 100 . Write \\(v \\subseteq w\\) if \\(w\\) has 1 's in every component \\(v\\) does, and let \\(|v|\\) denote the number of 1 's in \\(v\\). Then for each \\(v\\), we let \\(f(v)\\) denote the number of elements \\(x \\in \\bigcup S_{i}\\) such that \\(x \\in S_{i} \\Longleftrightarrow v_{i}=1\\). For example, - \\(f(1 \\ldots 1)\\) denotes \\(\\left|\\bigcap_{1}^{100} S_{i}\\right|\\), so we know \\(f(1 \\ldots 1) \\equiv 0(\\bmod 100)\\). - \\(f(1 \\ldots 10)\\) denotes the number of elements in \\(S_{1}\\) through \\(S_{99}\\) but not \\(S_{100}\\) so we know that \\(f(1 \\ldots 1)+f(1 \\ldots 10) \\equiv 0(\\bmod 99)\\). - . . .And so on. So the problem condition means that \\(f(v)\\) translates to the statement \\[ P(u): \\quad|u| \\text { divides } \\sum_{v \\supseteq u} f(v) \\] for any \\(u \\neq 0 \\ldots 0\\), plus one extra condition \\(f(1 \\ldots 1)>0\\). And the objective function is to minimize the quantity \\[ A:=\\sum_{|v| \\geq 50} f(v) . \\] So the problem is transformed into an system of equations over \\(\\mathbb{Z}_{\\geq 0}\\) (it's clear any assignment of values of \\(f(v)\\) can be translated to a sequence ( \\(S_{1}, \\ldots, S_{100}\\) ) in the original notation). Note already that: Claim - It suffices to assign \\(f(v)\\) for \\(|v| \\geq 50\\). Proof. If we have found a valid assignment of values to \\(f(v)\\) for \\(|v| \\geq 50\\), then we can always arbitrarily assign values of \\(f(v)\\) for \\(|v|<50\\) by downwards induction on \\(|v|\\) to satisfy the divisibility condition (without changing \\(M\\) ). Thus, for the rest of the solution, we altogether ignore \\(f(v)\\) for \\(|v|<50\\) and only consider \\(P(u)\\) for \\(|u| \\geq 50\\). Construction. Consider the construction \\[ f_{0}(v)=2|v|-100 \\] This construction is valid since if \\(|u|=100-k\\) for \\(k \\leq 50\\) then \\[ \\begin{aligned} \\sum_{v \\supseteq u} f_{0}(v) & =\\binom{k}{0} \\cdot 100+\\binom{k}{1} \\cdot 98+\\binom{k}{2} \\cdot 96+\\cdots+\\binom{k}{k} \\cdot(100-2 k) \\\\ & =(100-k) \\cdot 2^{k}=|u| \\cdot 2^{k} \\end{aligned} \\] is indeed a multiple of \\(|u|\\), hence \\(P(u)\\) is true. In that case, the objective function is \\[ A=\\sum_{i=50}^{100}\\binom{100}{i}(2 i-100)=50\\binom{100}{50} \\] as needed. Remark. This construction is the \"easy\" half of the problem because it coincides with what you get from a greedy algorithm by downwards induction on \\(|u|\\) (equivalently, induction on \\(k=100-|u| \\geq 0\\) ). To spell out the first three steps, - We know \\(f(1 \\ldots 1)\\) is a nonzero multiple of 100 , so it makes sense to guess \\(f(1 \\ldots 1)=\\) 100. - Then we have \\(f(1 \\ldots 10)+100 \\equiv 0(\\bmod 99)\\), and the smallest multiple of 99 which is at least 100 is 198 . So it makes sense to guess \\(f(1 \\ldots 10)=98\\), and similarly guess \\(f(v)=98\\) whenever \\(|v|=99\\). - Now when we consider, say \\(v=1 \\ldots 100\\) with \\(|v|=98\\), we get \\[ f(1 \\ldots 100)+\\underbrace{f(1 \\ldots 101)}_{=98}+\\underbrace{f(1 \\ldots 110)}_{=98}+\\underbrace{f(1 \\ldots 111)}_{=100} \\equiv 0 \\quad(\\bmod 98) . \\] we obtain \\(f(1 \\ldots 100) \\equiv 96(\\bmod 98)\\). That makes \\(f(1 \\ldots 100)=96\\) a reasonable guess. Continuing in this way gives the construction above. Proof of bound. We are going to use a smoothing argument: if we have a general working assignment \\(f\\), we will mold it into \\(f_{0}\\). We define a push-down on \\(v\\) as the following operation: - Pick any \\(v\\) such that \\(|v| \\geq 50\\) and \\(f(v) \\geq|v|\\). - Decrease \\(f(v)\\) by \\(|v|\\). - For every \\(w\\) such that \\(w \\subseteq v\\) and \\(|w|=|v|-1\\), increase \\(f(w)\\) by 1 . Claim - Apply a push-down preserves the main divisibility condition. Moreover, it doesn't change \\(A\\) unless \\(|v|=50\\), where it decreases \\(A\\) by 50 instead. Proof. The statement \\(P(u)\\) is only affected when \\(u \\subseteq v\\) : to be precise, one term on the right-hand side of \\(P(u)\\) decreases by \\(|v|\\), while \\(|v|-|u|\\) terms increase by 1 , for a net change of \\(-|u|\\). So \\(P(u)\\) still holds. To see \\(A\\) doesn't change for \\(|v|>50\\), note \\(|v|\\) terms increase by 1 while one term decreases by \\(-|v|\\). When \\(|v|=50\\), only \\(f(v)\\) decreases by 50 . Now, given a valid assignment, we can modify it as follows: - First apply pushdowns on \\(1 \\ldots 1\\) until \\(f(1 \\ldots 1)=100\\); - Then we may apply pushdowns on each \\(v\\) with \\(|v|=99\\) until \\(f(v)<99\\); - Then we may apply pushdowns on each \\(v\\) with \\(|v|=98\\) until \\(f(v)<98\\); - . . . and so on, until we have \\(f(v)<50\\) for \\(|v|=50\\). Hence we get \\(f(1 \\ldots 1)=100\\) and \\(0 \\leq f(v)<|v|\\) for all \\(50 \\leq|v| \\leq 100\\). However, by downwards induction on \\(|v|=99,98, \\ldots, 50\\), we also have \\[ f(v) \\equiv f_{0}(v) \\quad(\\bmod |v|) \\Longrightarrow f(v)=f_{0}(v) \\] since \\(f_{0}(v)\\) and \\(f(v)\\) are both strictly less than \\(|v|\\). So in fact \\(f=f_{0}\\), and we're done. Remark. The fact that push-downs actually don't change \\(A\\) shows that the equality case we described is far from unique: in fact, we could have made nearly arbitrary sub-optimal decisions during the greedy algorithm and still ended up with an equality case. For a concrete example, the construction \\[ f(v)= \\begin{cases}500 & |v|=100 \\\\ 94 & |v|=99 \\\\ 100-2|v| & 50 \\leq|v| \\leq 98\\end{cases} \\] works fine as well (where we arbitrarily chose 500 at the start, then used the greedy algorithm thereafter).", "source_pdf": "USAMO_2024.pdf", "notes": ""}
{"id": "USAMO-2024-3", "contest": "USAMO", "year": "2024", "problem_number": "3", "problem": "Let \\((m, n)\\) be positive integers with \\(n \\geq 3\\) and draw a regular \\(n\\)-gon. We wish to triangulate this \\(n\\)-gon into \\(n-2\\) triangles, each colored one of \\(m\\) colors, so that each color has an equal sum of areas. For which \\((m, n)\\) is such a triangulation and coloring possible?", "solution": "The answer is if and only if \\(m\\) is a proper divisor of \\(n\\). Throughout this solution, we let \\(\\omega=\\exp (2 \\pi i / n)\\) and let the regular \\(n\\)-gon have vertices \\(1, \\omega, \\ldots, \\omega^{n-1}\\). We cache the following frequent calculation: Lemma The triangle with vertices \\(\\omega^{k}, \\omega^{k+a}, \\omega^{k+b}\\) has signed area \\[ T(a, b):=\\frac{\\left(\\omega^{a}-1\\right)\\left(\\omega^{b}-1\\right)\\left(\\omega^{-b}-\\omega^{-a}\\right)}{4 i} . \\] Proof. Rotate by \\(\\omega^{-k}\\) to assume WLOG that \\(k=0\\). Apply complex shoelace to the triangles with vertices \\(1, \\omega^{a}, \\omega^{b}\\) to get \\[ \\frac{i}{4} \\operatorname{det}\\left[\\begin{array}{ccc} 1 & 1 & 1 \\\\ \\omega^{a} & \\omega^{-a} & 1 \\\\ \\omega^{b} & \\omega^{-b} & 1 \\end{array}\\right]=\\frac{i}{4} \\operatorname{det}\\left[\\begin{array}{ccc} 0 & 0 & 1 \\\\ \\omega^{a}-1 & \\omega^{-a}-1 & 1 \\\\ \\omega^{b}-1 & \\omega^{-b}-1 & 1 \\end{array}\\right] \\] which equals the above. IT Construction. It suffices to actually just take all the diagonals from the vertex 1, and then color the triangles with the \\(m\\) colors in cyclic order. For example, when \\(n=9\\) and \\(m=3\\), a coloring with red, green, blue would be: ![](https://cdn.mathpix.com/cropped/2025_08_23_3e2b36edf2ab6bf632c2g-07.jpg?height=607&width=601&top_left_y=1881&top_left_x=733) To see this works one can just do the shoelace calculation: fix a residue \\(r \\bmod m\\) corresponding to one of the colors. Then \\[ \\begin{aligned} \\sum_{\\substack{0 \\leq j<n \\\\ j \\equiv r \\bmod m}} \\operatorname{Area}\\left(\\omega^{0}, \\omega^{j}, \\omega^{j+1}\\right) & =\\sum_{\\substack{0 \\leq j<n \\\\ j \\equiv r \\bmod m}} T(j, j+1) \\\\ & =\\sum_{\\substack{0 \\leq j<n \\\\ j \\equiv r \\bmod m}} \\frac{\\left(\\omega^{j}-1\\right)\\left(\\omega^{j+1}-1\\right)\\left(\\omega^{-(j+1)}-\\omega^{-j}\\right)}{4 i} \\\\ & =\\frac{\\omega-1}{4 i} \\sum_{\\substack{0 \\leq j<n \\\\ j \\equiv r \\bmod m}}\\left(\\omega^{-j}-1\\right)\\left(\\omega^{j}-\\omega^{-1}\\right) \\\\ & =\\frac{\\omega-1}{4 i}\\left(\\frac{n}{m}\\left(1+\\omega^{-1}\\right)+\\sum_{\\substack{0 \\leq j<n \\\\ j \\equiv r \\bmod m}}\\left(\\omega^{-1-j}-\\omega^{j}\\right)\\right) \\end{aligned} \\] (We allow degenerate triangles where \\(j \\in\\{0, m-1\\}\\) with area zero to simplify the notation above.) However, if \\(m\\) is a proper divisor of \\(m\\), then \\(\\sum_{j} \\omega^{j}=\\omega^{r}\\left(1+\\omega^{m}+\\omega^{2 m}+\\cdots+\\omega^{n-m}\\right)=0\\). For the same reason, \\(\\sum_{j} \\omega^{-1-j}=0\\). So the inner sum vanishes, and the total area of this color equals \\[ \\sum_{\\substack{0 \\leq j<n \\\\ j \\equiv r \\bmod m}} \\operatorname{Area}\\left(\\omega^{0}, \\omega^{j}, \\omega^{j+1}\\right)=\\frac{n}{m} \\frac{(\\omega-1)\\left(\\omega^{-1}+1\\right)}{4 i}=\\frac{n}{m} \\cdot \\frac{\\omega-\\omega^{-1}}{4 i} . \\] Because the right-hand side does not depend on the residue \\(r\\), this shows all colors have equal area. IT Proof of necessity. It's obvious that \\(m<n\\) (in fact \\(m \\leq n-2\\) ). So we focus on just showing \\(m \\mid n\\). Repeating the same calculation as above, we find that if there was a valid triangulation and coloring, the total area of each color would equal \\[ S:=\\frac{n}{m} \\cdot \\frac{\\omega-\\omega^{-1}}{4 i} \\] However: Claim - The number \\(4 i \\cdot S\\) is not an algebraic integer when \\(m \\nmid n\\). Proof. This is easiest to see if one knows the advanced result that \\(K:=\\mathbb{Q}(\\omega)\\) is a number field whose ring of integers is known to be \\(\\mathcal{O}_{K}=\\mathbb{Z}[\\omega]\\), in which case it follows right away. Remark. We spell out the details in the proof a bit more explicitly here. It's enough to show that \\(\\omega \\cdot 4 i \\cdot S=\\frac{n}{m} \\omega^{2}-\\frac{n}{m}\\) is not an algebraic integer for completeness. Take \\(K=\\mathbb{Q}(\\omega)\\) of degree \\(d:=\\varphi(n) \\geq 2\\); as a \\(\\mathbb{Q}\\)-module, it obeys \\(K=\\mathbb{Q} \\oplus \\omega \\mathbb{Q} \\oplus \\cdots \\oplus \\omega^{d-1} \\mathbb{Q}\\). The theorem we are quoting is that, as \\(\\mathbb{Z}\\)-modules, we have \\(\\mathcal{O}_{K}=\\mathbb{Z}[\\omega]=\\mathbb{Z} \\oplus \\omega \\mathbb{Z} \\oplus \\cdots \\oplus \\omega^{d-1} \\mathbb{Z}\\) i.e. \\(\\mathcal{O}_{K}\\) contains exactly those numbers in \\(K\\) for which the canonical \\(\\mathbb{Q}\\)-coefficients happen to be integers. (This is quite famous, but for a print reference, see Neukirch's Algebraic Number Theory, Section I.10.) And \\(\\omega \\cdot 4 i \\cdot S\\) fails this criteria, since \\(\\frac{n}{m} \\notin \\mathbb{Z}\\). However, for any \\(a\\) and \\(b\\), the number \\[ 4 i \\cdot T(a, b)=\\left(\\omega^{a}-1\\right)\\left(\\omega^{b}-1\\right)\\left(\\omega^{-b}-\\omega^{-a}\\right) \\] is an algebraic integer. Since a finite sum of algebraic integers is also an algebraic integer, the sum of expressions of the form \\(4 i \\cdot T(a, b)\\) will never equal \\(4 i \\cdot S\\). Remark. If one wants to avoid citing the fact that \\(\\mathcal{O}_{K}=\\mathbb{Z}[\\omega]\\), then one can instead note that \\(T(a, b)\\) is actually always divisible by \\((\\omega-1)\\left(\\omega^{-1}+1\\right)=\\omega-\\omega^{-1}\\) over the algebraic integers (at least one of \\(\\left\\{\\omega^{a}-1, \\omega^{b}-1, \\omega^{-a}-\\omega^{-b}\\right\\}\\) is a multiple of \\(\\omega+1\\), by casework on \\(a, b \\bmod 2)\\). Then one using \\(\\frac{4 i}{(\\omega-1)\\left(\\omega^{-1}+1\\right)}\\) as the scaling factor instead of \\(4 i\\), one sees that we actually need \\(\\frac{n}{m}\\) to be an algebraic integer. But a rational number is an algebraic integer if and only if it's a rational integer; so \\(\\frac{n}{m}\\) is an algebraic integer exactly when \\(m\\) divides \\(n\\).", "source_pdf": "USAMO_2024.pdf", "notes": ""}
{"id": "USAMO-2024-4", "contest": "USAMO", "year": "2024", "problem_number": "4", "problem": "Let \\(m\\) and \\(n\\) be positive integers. A circular necklace contains \\(m n\\) beads, each either red or blue. It turned out that no matter how the necklace was cut into \\(m\\) blocks of \\(n\\) consecutive beads, each block had a distinct number of red beads. Determine, with proof, all possible values of the ordered pair \\((m, n)\\).", "solution": "The answer is \\(m \\leq n+1\\) only. If Proof the task requires \\(m \\leq n+1\\). Each of the \\(m\\) blocks has a red bead count between 0 and \\(n\\), each of which appears at most once, so \\(m \\leq n+1\\) is needed. If Construction when \\(m=n+1\\). For concreteness, here is the construction for \\(n=4\\), which obviously generalizes. The beads are listed in reading order as an array with \\(n+1\\) rows and \\(n\\) columns. Four of the blue beads have been labeled \\(B_{1}, \\ldots, B_{n}\\) to make them easier to track as they move. \\[ T_{0}=\\left[\\begin{array}{llll} R & R & R & R \\\\ R & R & R & B_{1} \\\\ R & R & B & B_{2} \\\\ R & B & B & B_{3} \\\\ B & B & B & B_{4} \\end{array}\\right] . \\] To prove this construction works, it suffices to consider the \\(n\\) cuts \\(T_{0}, T_{1}, T_{2}, \\ldots, T_{n-1}\\) made where \\(T_{i}\\) differs from \\(T_{i-1}\\) by having the cuts one bead later also have the property each row has a distinct red count: \\[ T_{1}=\\left[\\begin{array}{llll} R & R & R & R \\\\ R & R & B_{1} & R \\\\ R & B & B_{2} & R \\\\ B & B & B_{3} & B \\\\ B & B & B_{4} & R \\end{array}\\right] \\quad T_{2}=\\left[\\begin{array}{cccc} R & R & R & R \\\\ R & B_{1} & R & R \\\\ B & B_{2} & R & B \\\\ B & B_{3} & B & B \\\\ B & B_{4} & R & R \\end{array}\\right] \\quad T_{3}=\\left[\\begin{array}{cccc} R & R & R & R \\\\ B_{1} & R & R & B \\\\ B_{2} & R & B & B \\\\ B_{3} & B & B & B \\\\ B_{4} & R & R & R \\end{array}\\right] . \\] We can construct a table showing for each \\(1 \\leq k \\leq n+1\\) the number of red beads which are in the \\((k+1)\\) st row of \\(T_{i}\\) from the bottom: \\begin{tabular}{c|cccc} \\(k\\) & \\(T_{0}\\) & \\(T_{1}\\) & \\(T_{2}\\) & \\(T_{3}\\) \\\\ \\hline\\(k=4\\) & 4 & 4 & 4 & 4 \\\\ \\(k=3\\) & 3 & 3 & 3 & 2 \\\\ \\(k=2\\) & 2 & 2 & 1 & 1 \\\\ \\(k=1\\) & 1 & 0 & 0 & 0 \\\\ \\(k=0\\) & 0 & 1 & 2 & 3 \\end{tabular}. This suggests following explicit formula for the entry of the \\((i, k)\\) th cell which can then be checked straightforwardly: \\[ \\#\\left(\\text { red cells in } k \\text { th row of } T_{i}\\right)= \\begin{cases}k & k>i \\\\ k-1 & i \\geq k>0 \\\\ i & k=0\\end{cases} \\] And one can see for each \\(i\\), the counts are all distinct (they are ( \\(i, 0,1, \\ldots, k-1, k+1, \\ldots, k\\) ) from bottom to top). This completes the construction. Construction when \\(m<n+1\\). Fix \\(m\\). Take the construction for ( \\(m, m-1\\) ) and add \\(n+1-m\\) cyan beads to the start of each row; for example, if \\(n=7\\) and \\(m=5\\) then the new construction is \\[ T=\\left[\\begin{array}{lllllll} C & C & C & R & R & R & R \\\\ C & C & C & R & R & R & B_{1} \\\\ C & C & C & R & R & B & B_{2} \\\\ C & C & C & R & B & B & B_{3} \\\\ C & C & C & B & B & B & B_{4} \\end{array}\\right] \\] This construction still works for the same reason (the cyan beads do nothing for the first \\(n+1-m\\) shifts, then one reduces to the previous case). If we treat cyan as a shade of blue, this finishes the problem.", "source_pdf": "USAMO_2024.pdf", "notes": ""}
{"id": "USAMO-2024-5", "contest": "USAMO", "year": "2024", "problem_number": "5", "problem": "Point \\(D\\) is selected inside acute triangle \\(A B C\\) so that \\(\\angle D A C=\\angle A C B\\) and \\(\\angle B D C= 90^{\\circ}+\\angle B A C\\). Point \\(E\\) is chosen on ray \\(B D\\) so that \\(A E=E C\\). Let \\(M\\) be the midpoint of \\(B C\\). Show that line \\(A B\\) is tangent to the circumcircle of triangle \\(B E M\\).", "solution": "This problem has several approaches and we showcase a collection of them. The author's original solution. Complete isosceles trapezoid \\(A B Q C\\) (so \\(D \\in \\overline{A Q}\\) ). Reflect \\(B\\) across \\(E\\) to point \\(F\\). ![](https://cdn.mathpix.com/cropped/2025_08_23_3e2b36edf2ab6bf632c2g-12.jpg?height=653&width=700&top_left_y=964&top_left_x=685) Claim - We have \\(D Q C F\\) is cyclic. Proof. Since \\(E A=E C\\), we have \\(\\overline{Q F} \\perp \\overline{A C}\\) as line \\(Q F\\) is the image of the perpendicular bisector of \\(\\overline{A C}\\) under a homothety from \\(B\\) with scale factor 2 . Then \\[ \\begin{aligned} \\measuredangle F D C & =-\\measuredangle C D B=180^{\\circ}-\\left(90^{\\circ}+\\measuredangle C A B\\right)=90^{\\circ}-\\measuredangle C A B \\\\ & =90^{\\circ}-\\measuredangle Q C A=\\measuredangle F Q C . \\end{aligned} \\] To conclude, note that \\[ \\measuredangle B E M=\\measuredangle B F C=\\measuredangle D F C=\\measuredangle D Q C=\\measuredangle A Q C=\\measuredangle A B C=\\measuredangle A B M . \\] Remark (Motivation). Here is one possible way to come up with the construction of point \\(F\\) (at least this is what led Evan to find it). If one directs all the angles in the obvious way, there are really two points \\(D\\) and \\(D^{\\prime}\\) that are possible, although one is outside the triangle; they give corresponding points \\(E\\) and \\(E^{\\prime}\\). The circles \\(B E M\\) and \\(B E^{\\prime} M\\) must then actually coincide since they are both alleged to be tangent to line \\(A B\\). See the figure below. ![](https://cdn.mathpix.com/cropped/2025_08_23_3e2b36edf2ab6bf632c2g-13.jpg?height=1109&width=1017&top_left_y=242&top_left_x=531) One can already prove using angle chasing that \\(\\overline{A B}\\) is tangent to ( \\(B E E^{\\prime}\\) ). So the point of the problem is to show that \\(M\\) lies on this circle too. However, from looking at the diagram, one may realize that in fact it seems \\[ \\triangle M E E^{\\prime} \\stackrel{+}{\\sim} \\triangle C D D^{\\prime} \\] is going to be true from just those marked in the figure (and this would certainly imply the desired concyclic conclusion). Since \\(M\\) is a midpoint, it makes sense to dilate \\(\\triangle E M E^{\\prime}\\) from \\(B\\) by a factor of 2 to get \\(\\triangle F C F^{\\prime}\\) so that the desired similarity is actually a spiral similarity at \\(C\\). Then the spiral similarity lemma says that the desired similarity is equivalent to requiring \\(\\overline{D D^{\\prime}} \\cap \\overline{F F^{\\prime}}=Q\\) to lie on both ( \\(C D F\\) ) and ( \\(C D^{\\prime} F^{\\prime}\\) ). Hence the key construction and claim from the solution are both discovered naturally, and we find the solution above. (The points \\(D^{\\prime}, E^{\\prime}, F^{\\prime}\\) can then be deleted to hide the motivation.) If Another short solution. Let \\(Z\\) be on line \\(B D E\\) such that \\(\\angle B A Z=90^{\\circ}\\). This lets us interpret the angle condition as follows: Claim - Points \\(A, D, Z, C\\) are cyclic. Proof. Because \\(\\measuredangle Z A C=90^{\\circ}-A=180^{\\circ}-\\measuredangle C D B=\\measuredangle Z D C\\). ![](https://cdn.mathpix.com/cropped/2025_08_23_3e2b36edf2ab6bf632c2g-14.jpg?height=815&width=697&top_left_y=245&top_left_x=688) Define \\(W\\) as the midpoint of \\(\\overline{B Z}\\), so \\(\\overline{M W} \\| \\overline{C Z}\\). And let \\(O\\) denote the center of \\((A B C)\\). Claim - Points \\(M, E, O, W\\) are cyclic. Proof. Note that \\[ \\begin{aligned} \\measuredangle M O E & =\\measuredangle(\\overline{O M}, \\overline{B C})+\\measuredangle(\\overline{B C}, \\overline{A C})+\\measuredangle(\\overline{A C}, \\overline{O E}) \\\\ & =90^{\\circ}+\\measuredangle B C A+90^{\\circ} \\\\ & =\\measuredangle B C A=\\measuredangle C A D=\\measuredangle C Z D=\\measuredangle M W D=\\measuredangle M W E . \\end{aligned} \\] To finish, note \\[ \\begin{aligned} \\measuredangle M E B & =\\measuredangle M E W=\\measuredangle M O W \\\\ & =\\measuredangle(\\overline{M O}, \\overline{B C})+\\measuredangle(\\overline{B C}, \\overline{A B})+\\measuredangle(\\overline{A B}, \\overline{O W}) \\\\ & =90^{\\circ}+\\measuredangle C B A+90^{\\circ}=\\measuredangle C B A=\\measuredangle M B A . \\end{aligned} \\] This implies the desired tangency. If A Menelaus-based approach (Kevin Ren). Let \\(P\\) be on \\(\\overline{B C}\\) with \\(A P=P C\\). Let \\(Y\\) be the point on line \\(A B\\) such that \\(\\angle A C Y=90^{\\circ}\\); as \\(\\angle A Y C=90^{\\circ}-A\\) it follows \\(B D Y C\\) is cyclic. Let \\(K=\\overline{A P} \\cap \\overline{C Y}\\), so \\(\\triangle A C K\\) is a right triangle with \\(P\\) the midpoint of its hypotenuse. ![](https://cdn.mathpix.com/cropped/2025_08_23_3e2b36edf2ab6bf632c2g-15.jpg?height=1194&width=1069&top_left_y=254&top_left_x=502) Claim - Triangles \\(B P E\\) and \\(D Y K\\) are similar. Proof. We have \\(\\measuredangle M P E=\\measuredangle C P E=\\measuredangle K C P=\\measuredangle P K C\\) and \\(\\measuredangle E B P=\\measuredangle D B C= \\measuredangle D Y C=\\measuredangle D Y K\\). Claim - Triangles \\(B E M\\) and \\(Y D C\\) are similar. Proof. By Menelaus \\(\\triangle P C K\\) with respect to collinear points \\(A, B, Y\\) that \\[ \\frac{B P}{B C} \\frac{Y C}{Y K} \\frac{A K}{A P}=1 . \\] Since \\(A K / A P=2\\) (note that \\(P\\) is the midpoint of the hypotenuse of right triangle \\(A C K\\) ) and \\(B C=2 B M\\), this simplifies to \\[ \\frac{B P}{B M}=\\frac{Y K}{Y C} . \\] To finish, note that \\[ \\measuredangle D B A=\\measuredangle D B Y=\\measuredangle D C Y=\\measuredangle B M E \\] implying the desired tangency. A spiral similarity approach (Hans Yu). As in the previous solution, let \\(Y\\) be the point on line \\(A B\\) such that \\(\\angle A C Y=90^{\\circ}\\); so \\(B D Y C\\) is cyclic. Let \\(\\Gamma\\) be the circle through \\(B\\) and \\(M\\) tangent to \\(\\overline{A B}\\), and let \\(\\Omega:=(B C Y D)\\). We need to show \\(E \\in \\Gamma\\). ![](https://cdn.mathpix.com/cropped/2025_08_23_3e2b36edf2ab6bf632c2g-16.jpg?height=1104&width=1017&top_left_y=436&top_left_x=528) Denote by \\(S\\) the second intersection of \\(\\Gamma\\) and \\(\\Omega\\). The main idea behind is to consider the spiral similarity \\[ \\Psi: \\Omega \\rightarrow \\Gamma \\quad C \\mapsto M \\text { and } Y \\mapsto B \\] centered at \\(S\\) (due to the spiral similarity lemma), and show that \\(\\Psi(D)=E\\). The spiral similarity lemma already promises \\(\\Psi(D)\\) lies on line \\(B D\\). Claim - We have \\(\\Psi(A)=O\\), the circumcenter of \\(A B C\\). Proof. Note \\(\\triangle O B M \\stackrel{+}{\\sim} \\triangle A Y C\\); both are right triangles with \\(\\measuredangle B A C=\\measuredangle B O M\\). Claim - \\(\\Psi\\) maps line \\(A D\\) to line \\(O P\\). Proof. If we let \\(P\\) be on \\(\\overline{B C}\\) with \\(A P=P C\\) as before, \\[ \\measuredangle(\\overline{A D}, \\overline{O P})=\\measuredangle A P O=\\measuredangle O P C=\\measuredangle Y C P=\\measuredangle(\\overline{Y C}, \\overline{B M}) . \\] As \\(\\Psi\\) maps line \\(Y C\\) to line \\(B M\\) and \\(\\Psi(A)=O\\), we're done. Hence \\(\\Psi(D)\\) should not only lie on \\(B D\\) but also line \\(O P\\). This proves \\(\\Psi(D)=E\\), so \\(E \\in \\Gamma\\) as needed.", "source_pdf": "USAMO_2024.pdf", "notes": ""}
{"id": "USAMO-2024-6", "contest": "USAMO", "year": "2024", "problem_number": "6", "problem": "Let \\(n>2\\) be an integer and let \\(\\ell \\in\\{1,2, \\ldots, n\\}\\). A collection \\(A_{1}, \\ldots, A_{k}\\) of (not necessarily distinct) subsets of \\(\\{1,2, \\ldots, n\\}\\) is called \\(\\ell\\)-large if \\(\\left|A_{i}\\right| \\geq \\ell\\) for all \\(1 \\leq i \\leq k\\). Find, in terms of \\(n\\) and \\(\\ell\\), the largest real number \\(c\\) such that the inequality \\[ \\sum_{i=1}^{k} \\sum_{j=1}^{k} x_{i} x_{j} \\frac{\\left|A_{i} \\cap A_{j}\\right|^{2}}{\\left|A_{i}\\right| \\cdot\\left|A_{j}\\right|} \\geq c\\left(\\sum_{i=1}^{k} x_{i}\\right)^{2} \\] holds for all positive integer \\(k\\), all nonnegative real numbers \\(x_{1}, x_{2}, \\ldots, x_{k}\\), and all \\(\\ell\\)-large collections \\(A_{1}, A_{2}, \\ldots, A_{k}\\) of subsets of \\(\\{1,2, \\ldots, n\\}\\).", "solution": "The answer turns out to be \\[ c=\\frac{n+\\ell^{2}-2 \\ell}{n(n-1)} \\] The following solution using indicator functions was suggested by the language reasoning system developed by Thang Luong and the team at Google DeepMind (https://dpmd. ai/imo-silver). If Rewriting the sum. Abbreviate \\([n]:=\\{1, \\ldots, n\\}\\), and WLOG assume \\(\\sum x_{i}=1\\). To prove the bound, we first rewrite the left-hand side using indicator functions and switch the order of summation as \\[ \\begin{aligned} \\text { LHS } & =\\sum_{i=1}^{k} \\sum_{j=1}^{k} \\frac{x_{i}}{\\left|A_{i}\\right|} \\frac{x_{j}}{\\left|A_{j}\\right|}\\left|A_{i} \\cap A_{j}\\right|^{2} \\\\ & =\\sum_{i=1}^{k} \\sum_{j=1}^{k} \\frac{x_{i}}{\\left|A_{i}\\right|} \\frac{x_{j}}{\\left|A_{j}\\right|}\\left(\\sum_{p \\in[n]} \\sum_{q \\in[n]} \\mathbf{1}_{p \\in A_{i}} \\mathbf{1}_{q \\in A_{j}}\\right) \\\\ & =\\sum_{p \\in[n]} \\sum_{q \\in[n]} \\sum_{i=1}^{k} \\sum_{j=1}^{k} \\frac{x_{i} \\mathbf{1}_{p \\in A_{i}}}{\\left|A_{i}\\right|} \\cdot \\frac{x_{j} \\mathbf{1}_{q \\in A_{j}}}{\\left|A_{j}\\right|} . \\end{aligned} \\] Hence, if we define the \\(n^{2}\\) variables \\[ v_{p, q}:=\\sum_{i: p, q \\in A_{i}} \\frac{x_{i}}{\\left|A_{i}\\right|} \\] for each \\((p, q) \\in[n]^{2}\\) then the previous expression simplifies to just \\[ \\mathrm{LHS}=\\sum_{p \\in[n]} \\sum_{q \\in[n]} v_{p, q}^{2} . \\] T Proof of bound. We split the sum into \\(p=q\\) versus \\(p \\neq q\\) and bound by QM-AM separately in the obvious way. For the terms \\(p=q\\), \\[ \\sum_{p \\in[n]} v_{p, p}=\\sum_{i=1}^{k}\\left|A_{i}\\right| \\cdot \\frac{x_{i}}{\\left|A_{i}\\right|}=\\sum_{i=1}^{k} x_{i}=1 \\] \\[ \\Longrightarrow \\sum_{p \\in[n]} v_{p, p}^{2} \\geq \\frac{\\left(\\sum_{p \\in[n]} v_{p, p}\\right)^{2}}{n}=\\frac{1}{n} \\] When \\(p \\neq q\\) we instead have \\[ \\begin{aligned} \\sum_{p \\neq q \\in[n]} v_{p, q} & =\\sum_{i=1}^{k} 2\\binom{\\left|A_{i}\\right|}{2} \\cdot \\frac{x_{i}}{\\left|A_{i}\\right|}=\\sum_{i=1}^{k}\\left(\\left|A_{i}\\right|-1\\right) x_{i} \\geq \\sum_{i=1}^{k}(\\ell-1) x_{i}=\\ell-1 \\\\ \\Longrightarrow \\quad \\sum_{p \\neq q \\in[n]} v_{p, q}^{2} & \\geq \\frac{\\left(\\sum_{p \\neq q \\in[n]} v_{p, q}\\right)^{2}}{n(n-1)} \\geq \\frac{(\\ell-1)^{2}}{n(n-1)} . \\end{aligned} \\] Combining the two bounds gives \\[ \\mathrm{LHS} \\geq \\frac{1}{n}+\\frac{(\\ell-1)^{2}}{n(n-1)}=\\frac{n+\\ell^{2}-2 \\ell}{n(n-1)} \\] which matches the answer claimed above. Construction. Equality occurs if \\(v_{p, p}\\) is the same for all \\(p\\) and \\(v_{p, q}\\) is the same for all \\(p \\neq q\\), and \\(\\left|A_{i}\\right|=\\ell\\) for all \\(i\\). This occurs if one takes, say, \\(k=\\binom{n}{\\ell}\\) and \\(A_{i}\\) to be all the subsets of size \\(\\ell\\) each exactly once. Remark. Originally, the write-up I used considered vectors in \\(\\mathbb{R}^{n^{2}}\\) where entries will be indexed by ordered pairs \\((p, q) \\in\\{1, \\ldots, n\\}^{2}\\). It was equivalent to the solution above, but looking back, I think this makes the problem look harder than it actually is. For comparison, here is how the notation with vectors works, using \\(\\langle\\bullet, \\bullet\\rangle\\) for dot product, and \\(\\|\\bullet\\|\\) for the vector norm. For \\(i=1, \\ldots, n\\) define \\(\\mathbf{v}_{i}\\) by \\[ \\mathbf{v}_{i}[p, q]:=\\left\\{\\begin{array}{ll} \\frac{1}{\\left|A_{i}\\right|} & p \\in A_{i} \\text { and } q \\in A_{i} \\\\ 0 & \\text { otherwise } \\end{array} \\quad \\mathbf{v}:=\\sum_{i} x_{i} \\mathbf{v}_{i}\\right. \\] Then \\[ \\begin{aligned} \\sum_{i} \\sum_{j} x_{i} x_{j} \\frac{\\left|A_{i} \\cap A_{j}\\right|^{2}}{\\left|A_{i} \\| A_{j}\\right|} & =\\sum_{i} \\sum_{j} x_{i} x_{j}\\left\\langle\\mathbf{v}_{i}, \\mathbf{v}_{j}\\right\\rangle \\\\ & =\\langle\\mathbf{v}, \\mathbf{v}\\rangle=\\|\\mathbf{v}\\|^{2} \\end{aligned} \\] Define two more vectors \\(\\mathbf{e}\\) and \\(\\mathbf{1}\\); the vector \\(\\mathbf{e}\\) has 1 in the \\((p, q)^{\\text {th }}\\) component if \\(p=q\\), and 0 otherwise, while 1 has all-ones. In that case, note that \\[ \\begin{aligned} & \\langle\\mathbf{e}, \\mathbf{v}\\rangle=\\sum_{i} x_{i}\\left\\langle\\mathbf{e}, \\mathbf{v}_{i}\\right\\rangle=\\sum_{i} x_{i} \\\\ & \\langle\\mathbf{1}, \\mathbf{v}\\rangle=\\sum_{i} x_{i}\\left\\langle\\mathbf{1}, \\mathbf{v}_{i}\\right\\rangle=\\sum_{i} x_{i}\\left|A_{i}\\right| . \\end{aligned} \\] That means for any positive real constants \\(\\alpha\\) and \\(\\beta\\), by Cauchy-Schwarz for vectors, we should have \\[ \\begin{aligned} \\|\\alpha \\mathbf{e}+\\beta \\mathbf{1}\\|\\|\\mathbf{v}\\| & \\geq\\langle\\alpha \\mathbf{e}+\\beta \\mathbf{1}, \\mathbf{v}\\rangle=\\alpha\\langle\\mathbf{e}, \\mathbf{v}\\rangle+\\beta\\langle\\mathbf{1}, \\mathbf{v}\\rangle \\\\ & =\\alpha \\cdot \\sum x_{i}+\\beta \\cdot \\sum x_{i}\\left|A_{i}\\right| \\geq(\\alpha+\\ell \\beta) \\sum x_{i} \\end{aligned} \\] Set \\(\\mathbf{w}:=\\alpha \\mathbf{e}+\\beta \\mathbf{1}\\) for brevity. Then \\[ \\mathbf{w}[p, q]=\\left\\{\\begin{array}{ll} \\alpha+\\beta & \\text { if } p=q \\\\ \\beta & \\text { if } p \\neq q \\end{array} \\Longrightarrow\\|\\mathbf{w}\\|=\\sqrt{n \\cdot(\\alpha+\\beta)^{2}+\\left(n^{2}-n\\right) \\cdot \\beta^{2}}\\right. \\] Therefore, we get an lower bound \\[ \\frac{\\|\\mathbf{v}\\|}{\\sum x_{i}} \\geq \\frac{\\alpha+\\ell \\beta}{\\sqrt{n \\cdot(\\alpha+\\beta)^{2}+\\left(n^{2}-n\\right) \\cdot \\beta^{2}}} \\] Letting \\(\\alpha=n-\\ell\\) and \\(\\beta=\\ell-1\\) gives a proof that the constant \\[ c=\\frac{((n-\\ell)+\\ell(\\ell-1))^{2}}{n \\cdot(n-1)^{2}+\\left(n^{2}-n\\right) \\cdot(\\ell-1)^{2}}=\\frac{\\left(n+\\ell^{2}-2 \\ell\\right)^{2}}{n(n-1)\\left(n+\\ell^{2}-2 \\ell\\right)}=\\frac{n+\\ell^{2}-2 \\ell}{n(n-1)} \\] makes the original inequality always true. (The choice of \\(\\alpha: \\beta\\) is suggested by the example below.) Meanwhile, for the construction (where \\(k=\\binom{n}{\\ell}\\), etc.) it would be sufficient to show that \\(\\mathbf{w}\\) and \\(\\mathbf{v}\\) are scalar multiples, so that the above Cauchy-Schwarz is equality. However, we can compute \\[ \\mathbf{w}[p, q]=\\left\\{\\begin{array}{ll} n-1 & \\text { if } p=q \\\\ \\ell-1 & \\text { if } p \\neq q \\end{array}, \\quad \\mathbf{v}[p, q]= \\begin{cases}\\binom{n-1}{\\ell-1} \\cdot \\frac{1}{\\ell} & \\text { if } p=q \\\\ \\binom{n-2}{\\ell-2} \\cdot \\frac{1}{\\ell} & \\text { if } p \\neq q\\end{cases}\\right. \\] which are indeed scalar multiples.", "source_pdf": "USAMO_2024.pdf", "notes": ""}
{"id": "USAMO-2025-1", "contest": "USAMO", "year": "2025", "problem_number": "1", "problem": "Fix positive integers \\(k\\) and \\(d\\). Prove that for all sufficiently large odd positive integers \\(n\\), the digits of the base- \\(2 n\\) representation of \\(n^{k}\\) are all greater than \\(d\\).", "solution": "The problem actually doesn't have much to do with digits: the idea is to pick any length \\(\\ell \\leq k\\), and look at the rightmost \\(\\ell\\) digits of \\(n^{k}\\); that is, the remainder upon division by \\((2 n)^{\\ell}\\). We compute it exactly:\n\nClaim - Let \\(n \\geq 1\\) be an odd integer, and \\(k \\geq \\ell \\geq 1\\) integers. Then\n\\[\nn^{k} \\bmod (2 n)^{i}=c(k, \\ell) \\cdot n^{i}\n\\]\nfor some odd integer \\(1 \\leq c(k, \\ell) \\leq 2^{\\ell}-1\\).\n\nProof. This follows directly by the Chinese remainder theorem, with \\(c(k, \\ell)\\) being the residue class of \\(n^{k-i}\\left(\\bmod 2^{\\ell}\\right)\\) (which makes sense because \\(n\\) was odd).\n\nIn particular, for the \\(\\ell\\) th digit from the right to be greater than \\(d\\), it would be enough that\n\\[\nc(k, \\ell) \\cdot n^{\\ell} \\geq(d+1) \\cdot(2 n)^{\\ell-1}\n\\]\n\nBut this inequality holds whenever \\(n \\geq(d+1) \\cdot 2^{\\ell-1}\\).\nPutting this together by varying \\(\\ell\\), we find that for all odd\n\\[\nn \\geq(d+1) \\cdot 2^{k-1}\n\\]\nwe have that\n- \\(n^{k}\\) has \\(k\\) digits in base- \\(2 n\\); and\n- for each \\(\\ell=1, \\ldots, k\\), the \\(\\ell^{\\text {th }}\\) digit from the right is at least \\(d+1\\)\nso the problem is solved.\nRemark. Note it doesn't really matter that \\(c(k, i)\\) is odd per se; we only need that \\(c(k, i) \\geq 1\\).", "source_pdf": "USAMO_2025.pdf", "notes": ""}
{"id": "USAMO-2025-2", "contest": "USAMO", "year": "2025", "problem_number": "2", "problem": "Let \\(n>k \\geq 1\\) be integers. Let \\(P(x) \\in \\mathbb{R}[x]\\) be a polynomial of degree \\(n\\) with no repeated roots and \\(P(0) \\neq 0\\). Suppose that for any real numbers \\(a_{0}, \\ldots, a_{k}\\) such that the polynomial \\(a_{k} x^{k}+\\cdots+a_{1} x+a_{0}\\) divides \\(P(x)\\), the product \\(a_{0} a_{1} \\ldots a_{k}\\) is zero. Prove that \\(P(x)\\) has a nonreal root.", "solution": "By considering any \\(k+1\\) of the roots of \\(P\\), we may as well assume WLOG that \\(n=k+1\\). Suppose that \\(P(x)=\\left(x+r_{1}\\right) \\ldots\\left(x+r_{n}\\right) \\in \\mathbb{R}[x]\\) has \\(P(0) \\neq 0\\). Then the problem hypothesis is that each of the \\(n\\) polynomials (of degree \\(n-1\\) ) given by\n\\[\n\\begin{aligned}\nP_{1}(x) & =\\left(x+r_{2}\\right)\\left(x+r_{3}\\right)\\left(x+r_{4}\\right) \\ldots\\left(x+r_{n}\\right) \\\\\nP_{2}(x) & =\\left(x+r_{1}\\right)\\left(x+r_{3}\\right)\\left(x+r_{4}\\right) \\ldots\\left(x+r_{n}\\right) \\\\\nP_{3}(x) & =\\left(x+r_{1}\\right)\\left(x+r_{2}\\right)\\left(x+r_{4}\\right) \\ldots\\left(x+r_{n}\\right) \\\\\n& \\vdots \\\\\nP_{n}(x) & =\\left(x+r_{1}\\right)\\left(x+r_{2}\\right)\\left(x+r_{3}\\right) \\ldots\\left(x+r_{n-1}\\right)\n\\end{aligned}\n\\]\nhas at least one coefficient equal to zero. (Explicitly, \\(P_{i}(x)=\\frac{P(x)}{x+r_{i}}\\).) We'll prove that at least one \\(r_{i}\\) is not real.\n\nObviously the leading and constant coefficients of each \\(P_{i}\\) are nonzero, and there are \\(n-2\\) other coefficients to choose between. So by pigeonhole principle, we may assume, say, that \\(P_{1}\\) and \\(P_{2}\\) share the position of a zero coefficient, say the \\(x^{k}\\) one, for some \\(1 \\leq k<n-1\\).\n\nClaim - If \\(P_{1}\\) and \\(P_{2}\\) both have \\(x^{k}\\) coefficient equal to zero, then the polynomial\n\\[\nQ(x)=\\left(x+r_{3}\\right)\\left(x+r_{4}\\right) \\ldots\\left(x+r_{n}\\right)\n\\]\nhas two consecutive zero coefficients, namely \\(b_{k}=b_{k-1}=0\\).\n\nProof. Invoking Vieta formulas, suppose that\n\\[\nQ(x)=x^{n-2}+b_{n-3} x^{n-3}+\\cdots+b_{0} .\n\\]\n(And let \\(b_{n-2}=1\\).) Then the fact that the \\(x^{k}\\) coefficient of \\(P_{1}\\) and \\(P_{2}\\) are both zero means\n\\[\nr_{1} b_{k}+b_{k-1}=r_{2} b_{k}+b_{k-1}=0\n\\]\nand hence that \\(b_{k}=b_{k-1}=0\\) (since the \\(r_{i}\\) are nonzero).\nTo solve the problem, we use:\n\n\\section*{Lemma}\n\nIf \\(F(x) \\in \\mathbb{R}[x]\\) is a polynomial with two consecutive zero coefficients, it cannot have all distinct real roots.\n\nHere are two possible proofs of the lemma I know (there are more).\nFirst proof using Rolle's theorem. Say \\(x^{t}\\) and \\(x^{t+1}\\) coefficients of \\(F\\) are both zero.\nAssume for contradiction all the roots of \\(F\\) are real and distinct. Then by Rolle's theorem, every higher-order derivative of \\(F\\) should have this property too. However, the \\(t\\) th order derivative of \\(F\\) has a double root of 0 , contradiction.\n\nSecond proof using Descartes rule of signs. The number of (nonzero) roots of \\(F\\) is bounded above by the number of sign changes of \\(F(x)\\) (for the positive roots) and the number of sign changes of \\(F(-x)\\) (for the negative roots). Now consider each pair of consecutive nonzero coefficients in \\(F\\), say \\(\\star x^{i}\\) and \\(\\star x^{j}\\) for \\(i>j\\).\n- If \\(i-j=1\\), then this sign change will only count for one of \\(F(x)\\) or \\(F(-x)\\)\n- If \\(i-j \\geq 2\\), then the sign change could count towards both \\(F(x)\\) or \\(F(-x)\\) (i.e. counted twice), but also there is at least one zero coefficient between them.\n\nHence if \\(b\\) is the number of nonzero coefficients of \\(F\\), and \\(z\\) is the number of consecutive runs of zero coefficients of \\(F\\), then the number of real roots is bounded above by\n\\[\n1 \\cdot(b-1-z)+2 \\cdot z=b-1+z \\leq \\operatorname{deg} F\n\\]\n\nHowever, if \\(F\\) has two consecutive zero coefficients, then the inequality is strict.\n\nRemark. The final claim has appeared before apparently in the HUST Team Selection Test for the Vietnamese Math Society's undergraduate olympiad; see https://aops.com/ community/p33893374 for citation.", "source_pdf": "USAMO_2025.pdf", "notes": ""}
{"id": "USAMO-2025-3", "contest": "USAMO", "year": "2025", "problem_number": "3", "problem": "Alice the architect and Bob the builder play a game. First, Alice chooses two points \\(P\\) and \\(Q\\) in the plane and a subset \\(\\mathcal{S}\\) of the plane, which are announced to Bob. Next, Bob marks infinitely many points in the plane, designating each a city. He may not place two cities within distance at most one unit of each other, and no three cities he places may be collinear. Finally, roads are constructed between the cities as follows: each pair \\(A, B\\) of cities is connected with a road along the line segment \\(A B\\) if and only if the following condition holds:\n\nFor every city \\(C\\) distinct from \\(A\\) and \\(B\\), there exists \\(R \\in \\mathcal{S}\\) such that \\(\\triangle P Q R\\) is directly similar to either \\(\\triangle A B C\\) or \\(\\triangle B A C\\).\n\nAlice wins the game if (i) the resulting roads allow for travel between any pair of cities via a finite sequence of roads and (ii) no two roads cross. Otherwise, Bob wins. Determine, with proof, which player has a winning strategy.", "solution": "The answer is that Alice wins. Let's define a \\(B o b-s e t V\\) to be a set of points in the plane with no three collinear and with all distances at least 1 . The point of the problem is to prove the following fact.\n\nClaim - Given a Bob-set \\(V \\subseteq \\mathbb{R}^{2}\\), consider the Bob-graph with vertex set \\(V\\) defined as follows: draw edge \\(a b\\) if and only if the disk with diameter \\(\\overline{a b}\\) contains no other points of \\(V\\) on or inside it. Then the Bob-graph is (i) connected, and (ii) planar.\n\nProving this claim shows that Alice wins since Alice can specify \\(\\mathcal{S}\\) to be the set of points outside the disk of diameter \\(P Q\\).\n\nProof that every Bob-graph is connected. Assume for contradiction the graph is disconnected. Let \\(p\\) and \\(q\\) be two points in different connected components. Since \\(p q\\) is not an edge, there exists a third point \\(r\\) inside the disk with diameter \\(\\overline{p q}\\).\n\nHence, \\(r\\) is in a different connected component from at least one of \\(p\\) or \\(q\\) - let's say point \\(p\\). Then we repeat the same argument on the disk with diameter \\(\\overline{p r}\\) to find a new point \\(s\\), non-adjacent to either \\(p\\) or \\(r\\). See the figure below, where the X'ed out dashed edges indicate points which are not only non-adjacent but in different connected components.\n![](https://cdn.mathpix.com/cropped/2025_08_23_a5312aa46f6f301b6521g-07.jpg?height=586&width=601&top_left_y=245&top_left_x=733)\n\nIn this way we generate an infinite sequence of distances \\(\\delta_{1}, \\delta_{2}, \\delta_{3}, \\ldots\\) among the non-edges in the picture above. By the \"Pythagorean theorem\" (or really the inequality for it), we have\n\\[\n\\delta_{i}^{2} \\leq \\delta_{i-1}^{2}-1\n\\]\nand this eventually generates a contradiction for large \\(i\\), since we get \\(0 \\leq \\delta_{i}^{2} \\leq \\delta_{1}^{2}-(i- 1)\\).\n\nProof that every Bob-graph is planar. Assume for contradiction edges ac and bd meet, meaning \\(a b c d\\) is a convex quadrilateral. WLOG assume \\(\\angle b a d \\geq 90^{\\circ}\\) (each quadrilateral has an angle at least \\(90^{\\circ}\\) ). Then the disk with diameter \\(\\overline{b d}\\) contains \\(a\\), contradiction.\n\nRemark. In real life, the Bob-graph is actually called the Gabriel graph. Note that we never require the Bob-set to be infinite; the solution works unchanged for finite Bob-sets.\n\nHowever, there are approaches that work for finite Bob-sets that don't work for infinite sets, such as the relative neighbor graph, in which one joins \\(a\\) and \\(b\\) iff there is no \\(c\\) such that \\(d(a, b) \\leq \\max \\{d(a, c), d(b, c)\\}\\). In other words, edges are blocked by triangles where \\(a b\\) is the longest edge (rather than by triangles where \\(a b\\) is the longest edge of a right or obtuse triangle as in the Gabriel graph).\n\nThe relative neighbor graph has fewer edges than the Gabriel graph, so it is planar too. When the Bob-set is finite, the relative distance graph is still connected. The same argument above works where the distances now satisfy\n\\[\n\\delta_{1}>\\delta_{2}>\\ldots\n\\]\ninstead, and since there are finitely many distances one arrives at a contradiction.\nHowever for infinite Bob-sets the descending condition is insufficient, and connectedness actually fails altogether. A counterexample (communicated to me by Carl Schildkraut) is to start by taking \\(A_{n} \\approx(2 n, 0)\\) and \\(B_{n} \\approx(2 n+1, \\sqrt{3})\\) for all \\(n \\geq 1\\), then perturb all the points slightly so that\n\\[\n\\begin{aligned}\nB_{1} A_{1} & >A_{1} A_{2}>A_{2} B_{1}>B_{1} B_{2}>B_{2} A_{2} \\\\\n& >A_{2} A_{3}>A_{3} B_{2}>B_{2} B_{3}>B_{3} A_{3} \\\\\n& >\\cdots .\n\\end{aligned}\n\\]\n\nA cartoon of the graph is shown below.\n![](https://cdn.mathpix.com/cropped/2025_08_23_a5312aa46f6f301b6521g-08.jpg?height=281&width=800&top_left_y=251&top_left_x=631)\n\nIn that case, \\(\\left\\{A_{n}\\right\\}\\) and \\(\\left\\{B_{n}\\right\\}\\) will be disconnected from each other: none of the edges \\(A_{n} B_{n}\\) or \\(B_{n} A_{n+1}\\) are formed. In this case the relative neighbor graph consists of the edges \\(A_{1} A_{2} A_{3} A_{4} \\cdots\\) and \\(B_{1} B_{2} B_{3} B_{4} \\cdots\\). That's why for the present problem, the inequality\n\\[\n\\delta_{i}^{2} \\leq \\delta_{i-1}^{2}-1\n\\]\nplays such an important role, because it causes the (squared) distances to decrease appreciably enough to give the final contradiction.", "source_pdf": "USAMO_2025.pdf", "notes": ""}
{"id": "USAMO-2025-4", "contest": "USAMO", "year": "2025", "problem_number": "4", "problem": "Let \\(H\\) be the orthocenter of an acute triangle \\(A B C\\), let \\(F\\) be the foot of the altitude from \\(C\\) to \\(A B\\), and let \\(P\\) be the reflection of \\(H\\) across \\(B C\\). Suppose that the circumcircle of triangle \\(A F P\\) intersects line \\(B C\\) at two distinct points \\(X\\) and \\(Y\\). Prove that \\(C X=C Y\\).", "solution": "Let \\(Q\\) be the antipode of \\(B\\).\nClaim - \\(A H Q C\\) is a parallelogram, and \\(A P C Q\\) is an isosceles trapezoid.\n\nProof. As \\(\\overline{A H} \\perp \\overline{B C} \\perp \\overline{C Q}\\) and \\(\\overline{C F} \\perp \\overline{A B} \\perp \\overline{A Q}\\).\n![](https://cdn.mathpix.com/cropped/2025_08_23_a5312aa46f6f301b6521g-09.jpg?height=795&width=775&top_left_y=1150&top_left_x=645)\n\nLet \\(M\\) be the midpoint of \\(\\overline{Q C}\\).\nClaim - Point \\(M\\) is the circumcenter of \\(\\triangle A F P\\).\n\nProof. It's clear that \\(M A=M P\\) from the isosceles trapezoid. As for \\(M A=M F\\), let \\(N\\) denote the midpoint of \\(\\overline{A F}\\); then \\(\\overline{M N}\\) is a midline of the parallelogram, so \\(\\overline{M N} \\perp \\overline{A F}\\).\n\nSince \\(\\overline{C M} \\perp \\overline{B C}\\) and \\(M\\) is the center of ( \\(A F P\\) ), it follows \\(C X=C Y\\).", "source_pdf": "USAMO_2025.pdf", "notes": ""}
{"id": "USAMO-2025-5", "contest": "USAMO", "year": "2025", "problem_number": "5", "problem": "Find all positive integers \\(k\\) such that: for every positive integer \\(n\\), the sum\n\\[\n\\binom{n}{0}^{k}+\\binom{n}{1}^{k}+\\cdots+\\binom{n}{n}^{k}\n\\]\nis divisible by \\(n+1\\).", "solution": "The answer is all even \\(k\\).\nLet's abbreviate \\(S(n):=\\binom{n}{0}^{k}+\\cdots+\\binom{n}{n}^{k}\\) for the sum in the problem.\nProof that even \\(k\\) is necessary. Choose \\(n=2\\). We need \\(3 \\mid S(2)=2+2^{k}\\), which requires \\(k\\) to be even.\n\nRemark. It's actually not much more difficult to just use \\(n=p-1\\) for prime \\(p\\), since \\(\\binom{p-1}{i} \\equiv(-1)^{i}(\\bmod p)\\). Hence \\(S(p-1) \\equiv 1+(-1)^{k}+1+(-1)^{k}+\\cdots+1(\\bmod p)\\), and this also requires \\(k\\) to be even. This special case is instructive in figuring out the proof to follow.\n\nIf Proof that \\(k\\) is sufficient. From now on we treat \\(k\\) as fixed, and we let \\(p^{e}\\) be a prime fully dividing \\(n+1\\). The basic idea is to reduce from \\(n+1\\) to \\((n+1) / p\\) by an induction.\n\nRemark. Here is a concrete illustration that makes it clear what's going on. Let \\(p=5\\). When \\(n=p-1=4\\), we have\n\\[\nS(4)=1^{k}+4^{k}+6^{k}+4^{k}+1^{k} \\equiv 1+1+1+1+1 \\equiv 0 \\quad(\\bmod 5) .\n\\]\n\nWhen \\(n=p^{2}-1=24\\), the 25 terms of \\(S(24)\\) in order are, modulo 25 ,\n\\[\n\\begin{aligned}\nS(24) & \\equiv 1^{k}+1^{k}+1^{k}+1^{k}+1^{k} \\\\\n& +4^{k}+4^{k}+4^{k}+4^{k}+4^{k} \\\\\n& +6^{k}+6^{k}+6^{k}+6^{k}+6^{k} \\\\\n& +4^{k}+4^{k}+4^{k}+4^{k}+4^{k} \\\\\n& +1^{k}+1^{k}+1^{k}+1^{k}+1^{k} \\\\\n& =5\\left(1^{k}+4^{k}+6^{k}+4^{k}+1^{k}\\right)\n\\end{aligned}\n\\]\n\nThe point is that \\(S(24)\\) has five copies of \\(S(4)\\), modulo 25.\n\nTo make the pattern in the remark explicit, we prove the following lemma on each individual binomial coefficient.\n\n\\section*{Lemma 2.1}\n\nSuppose \\(p^{e}\\) is a prime power which fully divides \\(n+1\\). Then\n\\[\n\\binom{n}{i} \\equiv \\pm\\binom{\\frac{n+1}{p}-1}{\\lfloor i / p\\rfloor} \\quad\\left(\\bmod p^{e}\\right)\n\\]\n\nProof of lemma. It's easiest to understand the proof by looking at the cases \\(\\lfloor i / p\\rfloor \\in \\{0,1,2\\}\\) first.\n- For \\(0 \\leq i<p\\), since \\(n \\equiv-1 \\bmod p^{e}\\), we have\n\\[\n\\binom{n}{i}=\\frac{n(n-1) \\ldots(n-i+1)}{1 \\cdot 2 \\cdots \\cdot i} \\equiv \\frac{(-1)(-2) \\ldots(-i)}{1 \\cdot 2 \\cdots \\cdot i} \\equiv \\pm 1 \\quad\\left(\\bmod p^{e}\\right)\n\\]\n- For \\(p \\leq i<2 p\\) we have\n\\[\n\\begin{aligned}\n\\binom{n}{i} & \\equiv \\pm 1 \\cdot \\frac{n-p+1}{p} \\cdot \\frac{(n-p)(n-p-1) \\ldots(n-i+1)}{(p+1)(p+2) \\ldots i} \\\\\n& \\equiv \\pm 1 \\cdot \\frac{\\frac{n-p+1}{p}}{1} \\cdot \\pm 1 \\\\\n& \\equiv \\pm\\binom{\\frac{n+1}{p}-1}{1} \\quad\\left(\\bmod p^{e}\\right)\n\\end{aligned}\n\\]\n- For \\(2 p \\leq i<3 p\\) the analogous reasoning gives\n\\[\n\\begin{aligned}\n\\binom{n}{i} & \\equiv \\pm 1 \\cdot \\frac{n-p+1}{p} \\cdot \\pm 1 \\cdot \\frac{n-2 p+1}{2 p} \\cdot \\pm 1 \\\\\n& \\equiv \\pm \\frac{\\left(\\frac{n+1}{p}-1\\right)\\left(\\frac{n+1}{p}-2\\right)}{1 \\cdot 2} \\\\\n& \\equiv \\pm\\binom{\\frac{n+1}{p}-1}{2} \\quad\\left(\\bmod p^{e}\\right)\n\\end{aligned}\n\\]\n\nAnd so on. The point is that in general, if we write\n\\[\n\\binom{n}{i}=\\prod_{1 \\leq j \\leq i} \\frac{n-(j-1)}{j}\n\\]\nthen the fractions for \\(p \\nmid j\\) are all \\(\\pm 1\\left(\\bmod p^{e}\\right)\\). So only considers those \\(j\\) with \\(p \\mid j\\); in that case one obtains the claimed \\(\\binom{\\frac{n+1}{p}-1}{\\lfloor i / p\\rfloor}\\) exactly (even without having to take modulo \\(p^{e}\\) ).\n\nFrom the lemma, it follows if \\(p^{e}\\) is a prime power which fully divides \\(n+1\\), then\n\\[\nS(n) \\equiv p \\cdot S\\left(\\frac{n+1}{p}-1\\right) \\quad\\left(\\bmod p^{e}\\right)\n\\]\nby grouping the \\(n+1\\) terms (for \\(0 \\leq i \\leq n\\) ) into consecutive ranges of length \\(p\\) (by the value of \\(\\lfloor i / p\\rfloor)\\).\n\nRemark. Actually, with the exact same proof (with better \\(\\pm\\) bookkeeping) one may show that\n\\[\nn+1 \\left\\lvert\\, \\sum_{i=0}^{n}\\left((-1)^{i}\\binom{n}{i}\\right)^{k}\\right.\n\\]\nholds for all nonnegative integers \\(k\\), not just \\(k\\) even. So in some sense this result is more natural than the one in the problem statement.", "source_pdf": "USAMO_2025.pdf", "notes": ""}
{"id": "USAMO-2025-6", "contest": "USAMO", "year": "2025", "problem_number": "6", "problem": "Let \\(m\\) and \\(n\\) be positive integers with \\(m \\geq n\\). There are \\(m\\) cupcakes of different flavors arranged around a circle and \\(n\\) people who like cupcakes. Each person assigns a nonnegative real number score to each cupcake, depending on how much they like the cupcake. Suppose that for each person \\(P\\), it is possible to partition the circle of \\(m\\) cupcakes into \\(n\\) groups of consecutive cupcakes so that the sum of \\(P\\) 's scores of the cupcakes in each group is at least 1 . Prove that it is possible to distribute the \\(m\\) cupcakes to the \\(n\\) people so that each person \\(P\\) receives cupcakes of total score at least 1 with respect to \\(P\\).", "solution": "Arbitrarily pick any one person - call her Pip - and her \\(n\\) arcs. The initial idea is to try to apply Hall's marriage lemma to match the \\(n\\) people with Pip's arcs (such that each such person is happy with their matched arc). To that end, construct the obvious bipartite graph \\(\\mathfrak{G}\\) between the people and the arcs for Pip.\n\nWe now consider the following algorithm, which takes several steps.\n- If a perfect matching of \\(\\mathfrak{G}\\) exists, we're done!\n- We're probably not that lucky. Per Hall's condition, this means there is a bad set \\(\\mathcal{B}_{1}\\) of people, who are compatible with fewer than \\(\\left|\\mathcal{B}_{1}\\right|\\) of the arcs. Then delete \\(\\mathcal{B}_{1}\\) and the neighbors of \\(\\mathcal{B}_{1}\\), then try to find a matching on the remaining graph.\n- If a matching exists now, terminate the algorithm. Otherwise, that means there's another bad set \\(\\mathcal{B}_{2}\\) for the remaining graph. We again delete \\(\\mathcal{B}_{2}\\) and the fewer than \\(\\mathcal{B}_{2}\\) neighbors.\n- Repeat until some perfect matching \\(\\mathcal{M}\\) is possible in the remaining graph, i.e. there are no more bad sets (and then terminate once that occurs).\nSince Pip is a universal vertex, it's impossible to delete Pip, so the algorithm does indeed terminate with nonempty \\(\\mathcal{M}\\).\n\nA cartoon of this picture is shown below.\n![](https://cdn.mathpix.com/cropped/2025_08_23_a5312aa46f6f301b6521g-14.jpg?height=804&width=769&top_left_y=242&top_left_x=645)\n\nWe commit to assigning each of person in \\(\\mathcal{M}\\) their matched arc (in particular if there are no bad sets at all, the problem is already solved). Now we finish the problem by induction on \\(n\\) (for the remaining people) by simply deleting the arcs used up by \\(\\mathcal{M}\\).\n\nTo see why this deletion-induction works, consider any particular person Quinn not in \\(\\mathcal{M}\\). By definition, Quinn is not happy with any of the \\(\\arcsin \\mathcal{M}\\). So when an arc \\(\\mathcal{A}\\) of \\(\\mathcal{M}\\) is deleted, it had value less than 1 for Quinn so in particular it couldn't contain entirely any of Quinn's arcs. Hence at most one endpoint among Quinn's arcs was in the deleted \\(\\operatorname{arc} \\mathcal{A}\\). When this happens, this causes two arcs of Quinn to merge, and the merged value is\n\\[\n(\\geq 1)+(\\geq 1)-(\\leq 1) \\quad \\geq\n\\]\nmeaning the induction is OK. See below for a cartoon of the deletion, where Pip's arcs are drawn in blue while Quinn's arcs and scores are drawn in red (in this example \\(n=3\\) ).\n![](https://cdn.mathpix.com/cropped/2025_08_23_a5312aa46f6f301b6521g-14.jpg?height=532&width=1280&top_left_y=1699&top_left_x=394)\n\nRemark. This deletion argument can be thought of in some special cases even before the realization of Hall, in the case where \\(\\mathcal{M}\\) has only one person (Pip). This amounts to saying that if one of Pip's arcs isn't liked by anybody, then that arc can be deleted and the induction carries through.\n\nRemark. Conversely, it should be reasonable to expect Hall's theorem to be helpful even before finding the deletion argument. While working on this problem, one of the first things I said was:\n\"We should let Hall do the heavy lifting for us: find a way to make \\(n\\) groups that satisfy Hall's condition, rather than an assignment of \\(n\\) groups to \\(n\\) people.\"\nAs a general heuristic, for any type of \"compatible matching\" problem, Hall's condition is usually the go-to tool. (It is much easier to verify Hall's condition than actually find the matching yourself.) Actually in most competition problems, if one realizes one is in a Hall setting, one is usually close to finishing the problem. This is a relatively rare example in which one needs an additional idea to go alongside Hall's theorem.", "source_pdf": "USAMO_2025.pdf", "notes": ""}
