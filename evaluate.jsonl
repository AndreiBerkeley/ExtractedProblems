{"id": "APMO-2022-1", "contest": "APMO", "year": "2022", "problem_number": "1", "problem": "Find all pairs ( \\(a, b\\) ) of positive integers such that \\(a^{3}\\) is a multiple of \\(b^{2}\\) and \\(b-1\\) is a multiple of \\(a-1\\). Note: An integer \\(n\\) is said to be a multiple of an integer \\(m\\) if there is an integer \\(k\\) such that \\(n=k m\\).", "solution": "\\section*{Solution}\n\n\\section*{Solution 1.1}\n\nBy inspection, we see that the pairs ( \\(a, b\\) ) with \\(a=b\\) are solutions, and so too are the pairs ( \\(a, 1\\) ). We will see that these are the only solutions.\n- Case 1. Consider the case \\(b<a\\). Since \\(b-1\\) is a multiple of \\(a-1\\), it follows that \\(b=1\\). This yields the second set of solutions described above.\n- Case 2. This leaves the case \\(b \\geq a\\). Since the positive integer \\(a^{3}\\) is a multiple of \\(b^{2}\\), there is a positive integer \\(c\\) such that \\(a^{3}=b^{2} c\\).\nNote that \\(a \\equiv b \\equiv 1\\) modulo \\(a-1\\). So we have\n\\[\n1 \\equiv a^{3}=b^{2} c \\equiv c \\quad(\\bmod a-1) .\n\\]\n\nIf \\(c<a\\), then we must have \\(c=1\\), hence, \\(a^{3}=b^{2}\\). So there is a positive integer \\(d\\) such that \\(a=d^{2}\\) and \\(b=d^{3}\\). Now \\(a-1 \\mid b-1\\) yields \\(d^{2}-1 \\mid d^{3}-1\\). This implies that \\(d+1 \\mid d(d+1)+1\\), which is impossible.\nIf \\(c \\geq a\\), then \\(b^{2} c \\geq b^{2} a \\geq a^{3}=b^{2} c\\). So there's equality throughout, implying \\(a=c=b\\). This yields the first set of solutions described above.\n\nTherefore, the solutions described above are the only solutions.\n\n\\section*{Solution 1.2}\n\nWe will start by showing that there are positive integers \\(x, c, d\\) such that \\(a=x^{2} c d\\) and \\(b=x^{3} c\\). Let \\(g=\\operatorname{gcd}(a, b)\\) so that \\(a=g d\\) and \\(b=g x\\) for some coprime \\(d\\) and \\(x\\). Then, \\(b^{2} \\mid a^{3}\\) is equivalent to \\(g^{2} x^{2} \\mid g^{3} d^{3}\\), which is equivalent to \\(x^{2} \\mid g d^{3}\\). Since \\(x\\) and \\(d\\) are coprime, this implies \\(x^{2} \\mid g\\). Hence, \\(g=x^{2} c\\) for some \\(c\\), giving \\(a=x^{2} c d\\) and \\(b=x^{3} c\\) as required.\nNow, it remains to find all positive integers \\(x, c, d\\) satisfying\n\\[\nx^{2} c d-1 \\mid x^{3} c-1 .\n\\]\n\nThat is, \\(x^{3} c \\equiv 1\\left(\\bmod x^{2} c d-1\\right)\\). Assuming that this congruence holds, it follows that \\(d \\equiv x^{3} c d \\equiv x \\left(\\bmod x^{2} c d-1\\right)\\). Then, either \\(x=d\\) or \\(x-d \\geq x^{2} c d-1\\) or \\(d-x \\geq x^{2} c d-1\\).\n- If \\(x=d\\) then \\(b=a\\).\n- If \\(x-d \\geq x^{2} c d-1\\), then \\(x-d \\geq x^{2} c d-1 \\geq x-1 \\geq x-d\\). Hence, each of these inequalities must in fact be an equality. This implies that \\(x=c=d=1\\), which implies that \\(a=b=1\\).\n- If \\(d-x \\geq x^{2} c d-1\\), then \\(d-x \\geq x^{2} c d-1 \\geq d-1 \\geq d-x\\). Hence, each of these inequalities must in fact be an equality. This implies that \\(x=c=1\\), which implies that \\(b=1\\).\n\nHence the only solutions are the pairs ( \\(a, b\\) ) such that \\(a=b\\) or \\(b=1\\). These pairs can be checked to satisfy the given conditions.\n\n\\section*{Solution 1.3}\n\nAll answers are ( \\(n, n\\) ) and ( \\(n, 1\\) ) where \\(n\\) is any positive integer. They all clearly work.\nTo show that these are all solutions, note that we can easily eliminate the case \\(a=1\\) or \\(b=1\\). Thus, assume that \\(a, b \\neq 1\\) and \\(a \\neq b\\). By the second divisibility, we see that \\(a-1 \\mid b-a\\). However, \\(\\operatorname{gcd}(a, b) \\mid b-a\\) and \\(a-1\\) is relatively prime to \\(\\operatorname{gcd}(a, b)\\). This implies that \\((a-1) \\operatorname{gcd}(a, b) \\mid b-a\\), which implies \\(\\operatorname{gcd}(a, b) \\left\\lvert\\, \\frac{b-1}{a-1}-1\\right.\\).\nThe last relation implies that \\(\\operatorname{gcd}(a, b)<\\frac{b-1}{a-1}\\), since the right-hand side are positive. However, due to the first divisibility,\n\\[\n\\operatorname{gcd}(a, b)^{3}=\\operatorname{gcd}\\left(a^{3}, b^{3}\\right) \\geq \\operatorname{gcd}\\left(b^{2}, b^{3}\\right)=b^{2} .\n\\]\n\nCombining these two inequalities, we get that\n\\[\nb^{\\frac{2}{3}}<\\frac{b-1}{a-1}<2 \\frac{b}{a} .\n\\]\n\nThis implies \\(a<2 b^{\\frac{1}{3}}\\). However, \\(b^{2} \\mid a^{3}\\) gives \\(b \\leq a^{\\frac{3}{2}}\\). This forces\n\\[\na<2\\left(a^{\\frac{3}{2}}\\right)^{\\frac{1}{3}}=2 \\sqrt{a} \\Longrightarrow a<4 .\n\\]\n\nExtracting \\(a=2,3\\) by hand yields no additional solution.", "source_pdf": "apmo_2022.pdf", "notes": ""}
{"id": "APMO-2022-2", "contest": "APMO", "year": "2022", "problem_number": "2", "problem": "Let \\(A B C\\) be a right triangle with \\(\\angle B=90^{\\circ}\\). Point \\(D\\) lies on the line \\(C B\\) such that \\(B\\) is between \\(D\\) and \\(C\\). Let \\(E\\) be the midpoint of \\(A D\\) and let \\(F\\) be the second intersection point of the circumcircle of \\(\\triangle A C D\\) and the circumcircle of \\(\\triangle B D E\\). Prove that as \\(D\\) varies, the line \\(E F\\) passes through a fixed point.", "solution": "\\section*{Solution}\n\n\\section*{Solution 2.1}\n\nLet the line \\(E F\\) intersect the line \\(B C\\) at \\(P\\) and the circumcircle of \\(\\triangle A C D\\) at \\(G\\) distinct from \\(F\\). We will prove that \\(P\\) is the fixed point.\n\nFirst, notice that \\(\\triangle B E D\\) is isosceles with \\(E B=E D\\). This implies \\(\\angle E B C=\\angle E D P\\).\nThen, \\(\\angle D A G=\\angle D F G=\\angle E B C=\\angle E D P\\) which implies \\(A G \\| D C\\). Hence, \\(A G C D\\) is an isosceles trapezoid.\nAlso, \\(A G \\| D C\\) and \\(A E=E D\\). This implies \\(\\triangle A E G \\cong \\triangle D E P\\) and \\(A G=D P\\).\nSince \\(B\\) is the foot of the perpendicular from \\(A\\) onto the side \\(C D\\) of the isosceles trapezoid \\(A G C D\\), we have \\(P B=P D+D B=A G+D B=B C\\), which does not depend on the choice of \\(D\\). Hence, the initial statement is proven.\n\n\\section*{Solution 2.2}\n\nSet up a coordinate system where \\(B C\\) is along the positive \\(x\\)-axis, \\(B A\\) is along the positive \\(y\\)-axis, and \\(B\\) is the origin. Take \\(A=(0, a), B=(0,0), C=(c, 0), D=(-d, 0)\\) where \\(a, b, c, d>0\\). Then \\(E=\\left(-\\frac{d}{2}, \\frac{a}{2}\\right)\\). The general equation of a circle is\n\\[\nx^{2}+y^{2}+2 f x+2 g y+h=0\n\\]\n\nSubstituting the coordinates of \\(A, D, C\\) into (1) and solving for \\(f, g, h\\), we find that the equation of the circumcircle of \\(\\triangle A D C\\) is\n\\[\nx^{2}+y^{2}+(d-c) x+\\left(\\frac{c d}{a}-a\\right) y-c d=0 .\n\\]\n\nSimilarly, the equation of the circumcircle of \\(\\triangle B D E\\) is\n\\[\nx^{2}+y^{2}+d x+\\left(\\frac{d^{2}}{2 a}-\\frac{a}{2}\\right) y=0 .\n\\]\n\nThen (3)-(2) gives the equation of the line \\(D F\\) which is\n\\[\nc x+\\frac{a^{2}+d^{2}-2 c d}{2 a} y+c d=0 .\n\\]\n\nSolving (3) and (4) simultaneously, we get\n\\[\nF=\\left(\\frac{c\\left(d^{2}-a^{2}-2 c d\\right)}{a^{2}+(d-2 c)^{2}}, \\frac{2 a c(c-d)}{a^{2}+(d-2 c)^{2}}\\right),\n\\]\nand the other solution \\(D=(-d, 0)\\).\nFrom this we obtain the equation of the line \\(E F\\) which is \\(a x+(d-2 c) y+a c=0\\). It passes through \\(P(-c, 0)\\) which is independent of \\(d\\).", "source_pdf": "apmo_2022.pdf", "notes": ""}
{"id": "APMO-2022-3", "contest": "APMO", "year": "2022", "problem_number": "3", "problem": "Find all positive integers \\(k<202\\) for which there exists a positive integer \\(n\\) such that\n\\[\n\\left\\{\\frac{n}{202}\\right\\}+\\left\\{\\frac{2 n}{202}\\right\\}+\\cdots+\\left\\{\\frac{k n}{202}\\right\\}=\\frac{k}{2},\n\\]\nwhere \\(\\{x\\}\\) denote the fractional part of \\(x\\).\nNote: \\(\\{x\\}\\) denotes the real number \\(k\\) with \\(0 \\leq k<1\\) such that \\(x-k\\) is an integer.", "solution": "\\section*{Solution}\n\nDenote the equation in the problem statement as (*), and note that it is equivalent to the condition that the average of the remainders when dividing \\(n, 2 n, \\ldots, k n\\) by 202 is 101 . Since \\(\\left\\{\\frac{i n}{202}\\right\\}\\) is invariant in each residue class modulo 202 for each \\(1 \\leq i \\leq k\\), it suffices to consider \\(0 \\leq n<202\\).\n\nIf \\(n=0\\), so is \\(\\left\\{\\frac{i n}{202}\\right\\}\\), meaning that \\(\\left(^{*}\\right)\\) does not hold for any \\(k\\). If \\(n=101\\), then it can be checked that (*) is satisfied if and only if \\(k=1\\). From now on, we will assume that \\(101 \\nmid n\\).\nFor each \\(1 \\leq i \\leq k\\), let \\(a_{i}=\\left\\lfloor\\frac{i n}{202}\\right\\rfloor=\\frac{i n}{202}-\\left\\{\\frac{i n}{202}\\right\\}\\). Rewriting (*) and multiplying the equation by 202, we find that\n\\[\nn(1+2+\\ldots+k)-202\\left(a_{1}+a_{2}+\\ldots+a_{k}\\right)=101 k .\n\\]\n\nEquivalently, letting \\(z=a_{1}+a_{2}+\\ldots+a_{k}\\),\n\\[\nn k(k+1)-404 z=202 k .\n\\]\n\nSince \\(n\\) is not divisible by 101 , which is prime, it follows that \\(101 \\mid k(k+1)\\). In particular, \\(101 \\mid k\\) or \\(101 \\mid k+1\\). This means that \\(k \\in\\{100,101,201\\}\\). We claim that all these values of \\(k\\) work.\n- If \\(k=201\\), we may choose \\(n=1\\). The remainders when dividing \\(n, 2 n, \\ldots, k n\\) by 202 are 1,2 , \\(\\ldots, 201\\), which have an average of 101 .\n- If \\(k=100\\), we may choose \\(n=2\\). The remainders when dividing \\(n, 2 n, \\ldots, k n\\) by 202 are 2,4 , \\(\\ldots, 200\\), which have an average of 101 .\n- If \\(k=101\\), we may choose \\(n=51\\). To see this, note that the first four remainders are \\(51,102,153\\), 2 , which have an average of 77 . The next four remainders ( \\(53,104,155,4\\) ) are shifted upwards from the first four remainders by 2 each, and so on, until the 25 th set of the remainders ( 99 , 150, 201, 50) which have an average of 125 . Hence, the first 100 remainders have an average of \\(\\frac{77+125}{2}=101\\). The 101th remainder is also 101, meaning that the average of all 101 remainders is 101 .\n\nIn conclusion, all values \\(k \\in\\{1,100,101,201\\}\\) satisfy the initial condition.", "source_pdf": "apmo_2022.pdf", "notes": ""}
{"id": "APMO-2022-4", "contest": "APMO", "year": "2022", "problem_number": "4", "problem": "Let \\(n\\) and \\(k\\) be positive integers. Cathy is playing the following game. There are \\(n\\) marbles and \\(k\\) boxes, with the marbles labelled 1 to \\(n\\). Initially, all marbles are placed inside one box. Each turn, Cathy chooses a box and then moves the marbles with the smallest label, say \\(i\\), to either any empty box or the box containing marble \\(i+1\\). Cathy wins if at any point there is a box containing only marble \\(n\\).\nDetermine all pairs of integers ( \\(n, k\\) ) such that Cathy can win this game.", "solution": "\\section*{Solution}\n\nWe claim Cathy can win if and only if \\(n \\leq 2^{k-1}\\).\n\nFirst, note that each non-empty box always contains a consecutive sequence of labeled marbles. This is true since Cathy is always either removing from or placing in the lowest marble in a box. As a consequence, every move made is reversible.\n\nNext, we prove by induction that Cathy can win if \\(n=2^{k-1}\\). The base case of \\(n=k=1\\) is trivial. Assume a victory can be obtained for \\(m\\) boxes and \\(2^{m-1}\\) marbles. Consider the case of \\(m+1\\) boxes and \\(2^{m}\\) marbles. Cathy can first perform a sequence of moves so that only marbles \\(2^{m-1}, \\ldots, 2^{m}\\) are left in the starting box, while keeping one box, say \\(B\\), empty. Now move the marble \\(2^{m-1}\\) to box \\(B\\), then reverse all of the initial moves while treating \\(B\\) as the starting box. At the end of that, we will have marbles \\(2^{m-1}+1, \\ldots, 2^{m}\\) in the starting box, marbles \\(1,2, \\ldots, 2^{m-1}\\) in box \\(B\\), and \\(m-1\\) empty boxes. By repeating the original sequence of moves on marbles \\(2^{m-1}+1, \\ldots, 2^{m}\\), using the \\(m\\) boxes that are not box \\(B\\), we can reach a state where only marble \\(2^{m}\\) remains in the starting box. Therefore\na victory is possible if \\(n=2^{k-1}\\) or smaller.\n\nWe now prove by induction that Cathy loses if \\(n=2^{k-1}+1\\). The base case of \\(n=2\\) and \\(k=1\\) is trivial. Assume a victory is impossible for \\(m\\) boxes and \\(2^{m-1}+1\\) marbles. For the sake of contradiction, suppose that victory is possible for \\(m+1\\) boxes and \\(2^{m}+1\\) marbles. In a winning sequence of moves, consider the last time a marble \\(2^{m-1}+1\\) leaves the starting box, call this move \\(X\\). After \\(X\\), there cannot be a time when marbles \\(1, \\ldots, 2^{m-1}+1\\) are all in the same box. Otherwise, by reversing these moves after \\(X\\) and deleting marbles greater than \\(2^{m-1}+1\\), it gives us a winning sequence of moves for \\(2^{m-1}+1\\) marbles and \\(m\\) boxes (as the original starting box is not used here), contradicting the inductive hypothesis. Hence starting from \\(X\\), marbles 1 will never be in the same box as any marbles greater than or equal to \\(2^{m-1}+1\\).\n\nNow delete marbles \\(2, \\ldots, 2^{m-1}\\) and consider the winning moves starting from \\(X\\). Marble 1 would only move from one empty box to another, while blocking other marbles from entering its box. Thus we effectively have a sequence of moves for \\(2^{m-1}+1\\) marbles, while only able to use \\(m\\) boxes. This again contradicts the inductive hypothesis. Therefore, a victory is not possible if \\(n=2^{k-1}+1\\) or greater.", "source_pdf": "apmo_2022.pdf", "notes": ""}
{"id": "APMO-2022-5", "contest": "APMO", "year": "2022", "problem_number": "5", "problem": "Let \\(a, b, c, d\\) be real numbers such that \\(a^{2}+b^{2}+c^{2}+d^{2}=1\\). Determine the minimum value of \\((a-b)(b-c)(c-d)(d-a)\\) and determine all values of \\((a, b, c, d)\\) such that the minimum value is achieved.", "solution": "\\section*{Solution}\n\nThe minimum value is \\(-\\frac{1}{8}\\). There are eight equality cases in total. The first one is\n\\[\n\\left(\\frac{1}{4}+\\frac{\\sqrt{3}}{4},-\\frac{1}{4}-\\frac{\\sqrt{3}}{4}, \\frac{1}{4}-\\frac{\\sqrt{3}}{4},-\\frac{1}{4}+\\frac{\\sqrt{3}}{4}\\right) .\n\\]\n\nCyclic shifting all the entries give three more quadruples. Moreover, flipping the sign \\(((a, b, c, d) \\rightarrow (-a,-b,-c,-d)\\) ) all four entries in each of the four quadruples give four more equality cases.\n\n\\section*{Solution 5.1}\n\nSince the expression is cyclic, we could WLOG \\(a=\\max \\{a, b, c, d\\}\\). Let\n\\[\nS(a, b, c, d)=(a-b)(b-c)(c-d)(d-a)\n\\]\n\nNote that we have given \\((a, b, c, d)\\) such that \\(S(a, b, c, d)=-\\frac{1}{8}\\). Therefore, to prove that \\(S(a, b, c, d) \\geq -\\frac{1}{8}\\), we just need to consider the case where \\(S(a, b, c, d)<0\\).\n- Exactly 1 of \\(a-b, b-c, c-d, d-a\\) is negative.\n\nSince \\(a=\\max \\{a, b, c, d\\}\\), then we must have \\(d-a<0\\). This forces \\(a>b>c>d\\). Now, let us write\n\\[\nS(a, b, c, d)=-(a-b)(b-c)(c-d)(a-d)\n\\]\n\nWrite \\(a-b=y, b-c=x, c-d=w\\) for some positive reals \\(w, x, y>0\\). Plugging to the original condition, we have\n\\[\n(d+w+x+y)^{2}+(d+w+x)^{2}+(d+w)^{2}+d^{2}-1=0\n\\]\nand we want to prove that \\(w x y(w+x+y) \\leq \\frac{1}{8}\\). Consider the expression \\((*)\\) as a quadratic in \\(d\\) :\n\\[\n4 d^{2}+d(6 w+4 x+2 y)+\\left((w+x+y)^{2}+(w+x)^{2}+w^{2}-1\\right)=0\n\\]\n\nSince \\(d\\) is a real number, then the discriminant of the given equation has to be non-negative, i.e. we must have\n\\[\n\\begin{aligned}\n4 & \\geq 4\\left((w+x+y)^{2}+(w+x)^{2}+w^{2}\\right)-(3 w+2 x+y)^{2} \\\\\n& =\\left(3 w^{2}+2 w y+3 y^{2}\\right)+4 x(w+x+y) \\\\\n& \\geq 8 w y+4 x(w+x+y) \\\\\n& =4(x(w+x+y)+2 w y)\n\\end{aligned}\n\\]\n\nHowever, AM-GM gives us\n\\[\nw x y(w+x+y) \\leq \\frac{1}{2}\\left(\\frac{x(w+x+y)+2 w y}{2}\\right)^{2} \\leq \\frac{1}{8}\n\\]\n\nThis proves \\(S(a, b, c, d) \\geq-\\frac{1}{8}\\) for any \\(a, b, c, d \\in \\mathbb{R}\\) such that \\(a>b>c>d\\). Equality holds if and only if \\(w=y, x(w+x+y)=2 w y\\) and \\(w x y(w+x+y)=\\frac{1}{8}\\). Solving these equations gives us \\(w^{4}=\\frac{1}{16}\\) which forces \\(w=\\frac{1}{2}\\) since \\(w>0\\). Solving for \\(x\\) gives us \\(x(x+1)=\\frac{1}{2}\\), and we will get \\(x=-\\frac{1}{2}+\\frac{\\sqrt{3}}{2}\\) as \\(x>0\\). Plugging back gives us \\(d=-\\frac{1}{4}-\\frac{\\sqrt{3}}{4}\\), and this gives us\n\\[\n(a, b, c, d)=\\left(\\frac{1}{4}+\\frac{\\sqrt{3}}{4},-\\frac{1}{4}+\\frac{\\sqrt{3}}{4}, \\frac{1}{4}-\\frac{\\sqrt{3}}{4},-\\frac{1}{4}-\\frac{\\sqrt{3}}{4}\\right)\n\\]\n\nThus, any cyclic permutation of the above solution will achieve the minimum equality.\n- Exactly 3 of \\(a-b, b-c, c-d, d-a\\) are negative Since \\(a=\\max \\{a, b, c, d\\}\\), then \\(a-b\\) has to be positive. So we must have \\(b<c<d<a\\). Now, note that\n\\[\n\\begin{aligned}\nS(a, b, c, d) & =(a-b)(b-c)(c-d)(d-a) \\\\\n& =(a-d)(d-c)(c-b)(b-a) \\\\\n& =S(a, d, c, b)\n\\end{aligned}\n\\]\n\nNow, note that \\(a>d>c>b\\). By the previous case, \\(S(a, d, c, b) \\geq-\\frac{1}{8}\\), which implies that\n\\[\nS(a, b, c, d)=S(a, d, c, b) \\geq-\\frac{1}{8}\n\\]\nas well. Equality holds if and only if\n\\[\n(a, b, c, d)=\\left(\\frac{1}{4}+\\frac{\\sqrt{3}}{4},-\\frac{1}{4}-\\frac{\\sqrt{3}}{4}, \\frac{1}{4}-\\frac{\\sqrt{3}}{4},-\\frac{1}{4}+\\frac{\\sqrt{3}}{4}\\right)\n\\]\nand its cyclic permutation.\n\n\\section*{Solution 5.2}\n\nThe minimum value is \\(-\\frac{1}{8}\\). There are eight equality cases in total. The first one is\n\\[\n\\left(\\frac{1}{4}+\\frac{\\sqrt{3}}{4},-\\frac{1}{4}-\\frac{\\sqrt{3}}{4}, \\frac{1}{4}-\\frac{\\sqrt{3}}{4},-\\frac{1}{4}+\\frac{\\sqrt{3}}{4}\\right) .\n\\]\n\nCyclic shifting all the entries give three more quadruples. Moreover, flipping the sign \\(((a, b, c, d) \\rightarrow (-a,-b,-c,-d)\\) ) all four entries in each of the four quadruples give four more equality cases. We then begin the proof by the following optimization:\n\nClaim 1. In order to get the minimum value, we must have \\(a+b+c+d=0\\).\n\nProof. Assume not, let \\(\\delta=\\frac{a+b+c+d}{4}\\) and note that\n\\[\n(a-\\delta)^{2}+(b-\\delta)^{2}+(c-\\delta)^{2}+(d-\\delta)^{2}<a^{2}+b^{2}+c^{2}+d^{2}\n\\]\nso by shifting by \\(\\delta\\) and scaling, we get an even smaller value of \\((a-b)(b-c)(c-d)(d-a)\\).\n\nThe key idea is to substitute the variables\n\\[\n\\begin{aligned}\n& x=a c+b d \\\\\n& y=a b+c d \\\\\n& z=a d+b c\n\\end{aligned}\n\\]\nso that the original expression is just \\((x-y)(x-z)\\). We also have the conditions \\(x, y, z \\geq-0.5\\) because of:\n\\[\n2 x+\\left(a^{2}+b^{2}+c^{2}+d^{2}\\right)=(a+c)^{2}+(b+d)^{2} \\geq 0\n\\]\n\nMoreover, notice that\n\\[\n0=(a+b+c+d)^{2}=a^{2}+b^{2}+c^{2}+d^{2}+2(x+y+z) \\Longrightarrow x+y+z=\\frac{-1}{2}\n\\]\n\nNow, we reduce to the following optimization problem.\nClaim 2. Let \\(x, y, z \\geq-0.5\\) such that \\(x+y+z=-0.5\\). Then, the minimum value of\n\\[\n(x-y)(x-z)\n\\]\nis \\(-1 / 8\\). Moreover, the equality case occurs when \\(x=-1 / 4\\) and \\(\\{y, z\\}=\\{1 / 4,-1 / 2\\}\\).\nProof. We notice that\n\\[\n\\begin{aligned}\n(x-y)(x-z)+\\frac{1}{8} & =\\left(2 y+z+\\frac{1}{2}\\right)\\left(2 z+y+\\frac{1}{2}\\right)+\\frac{1}{8} \\\\\n& =\\frac{1}{8}(4 y+4 z+1)^{2}+\\left(y+\\frac{1}{2}\\right)\\left(z+\\frac{1}{2}\\right) \\geq 0\n\\end{aligned}\n\\]\n\nThe last inequality is true since both \\(y+\\frac{1}{2}\\) and \\(z+\\frac{1}{2}\\) are not less than zero.\nThe equality in the last inequality is attained when either \\(y+\\frac{1}{2}=0\\) or \\(z+\\frac{1}{2}=0\\), and \\(4 y+4 z+1=0\\). This system of equations give \\((y, z)=(1 / 4,-1 / 2)\\) or \\((y, z)=(-1 / 2,1 / 4)\\) as the desired equality cases.\n\nNote: We can also prove (the weakened) Claim 2 by using Lagrange Multiplier, as follows. We first prove that, in fact, \\(x, y, z \\in[-0.5,0.5]\\). This can be proved by considering that\n\\[\n-2 x+\\left(a^{2}+b^{2}+c^{2}+d^{2}\\right)=(a-c)^{2}+(b-d)^{2} \\geq 0\n\\]\n\nWe will prove the Claim 2, only that in this case, \\(x, y, z \\in[-0.5,0.5]\\). This is already sufficient to prove the original question. We already have the bounded domain \\([-0.5,0.5]^{3}\\), so the global minimum must occur somewhere. Thus, it suffices to consider two cases:\n- If the global minimum lies on the boundary of \\([-0.5,0.5]^{3}\\). Then, one of \\(x, y, z\\) must be -0.5 or 0.5 . By symmetry between \\(y\\) and \\(z\\), we split to a few more cases.\n- If \\(x=0.5\\), then \\(y=z=-0.5\\), so \\((x-y)(x-z)=1\\), not the minimum.\n- If \\(x=-0.5\\), then both \\(y\\) and \\(z\\) must be greater or equal to \\(x\\), so \\((x-y)(x-z) \\geq 0\\), not the minimum.\n- If \\(y=0.5\\), then \\(x=z=-0.5\\), so \\((x-y)(x-z)=0\\), not the minimum.\n- If \\(y=-0.5\\), then \\(z=-x\\), so\n\\[\n(x-y)(x-z)=2 x(x+0.5),\n\\]\nwhich obtain the minimum at \\(x=-1 / 4\\). This gives the desired equality case.\n- If the global minimum lies in the interior \\((-0.5,0.5)^{3}\\), then we apply Lagrange multiplier:\n\\[\n\\begin{aligned}\n\\frac{\\partial}{\\partial x}(x-y)(x-z) & =\\lambda \\frac{\\partial}{\\partial x}(x+y+z) \\\\\n\\frac{\\partial}{\\partial y}(x-y)(x-z) & =\\lambda \\frac{\\partial}{\\partial y}(x+y+z) \\Longrightarrow z-x=\\lambda . \\\\\n\\frac{\\partial}{\\partial z}(x-y)(x-z) & =\\lambda \\frac{\\partial}{\\partial z}(x+y+z) \\Longrightarrow y-x=\\lambda .\n\\end{aligned}\n\\]\n\nAdding the last two equations gives \\(\\lambda=0\\), or \\(x=y=z\\). This gives \\((x-y)(x-z)=0\\), not the minimum.\n\nHaving exhausted all cases, we are done.", "source_pdf": "apmo_2022.pdf", "notes": ""}
{"id": "APMO-2023-1", "contest": "APMO", "year": "2023", "problem_number": "1", "problem": "Let \\(n \\geq 5\\) be an integer. Consider \\(n\\) squares with side lengths \\(1,2, \\ldots, n\\), respectively. The squares are arranged in the plane with their sides parallel to the \\(x\\) and \\(y\\) axes. Suppose that no two squares touch, except possibly at their vertices.\nShow that it is possible to arrange these squares in a way such that every square touches exactly two other squares.", "solution": "\\section*{Solution 1}\n\nSet aside the squares with sidelengths \\(n-3, n-2, n-1\\), and \\(n\\) and suppose we can split the remaining squares into two sets \\(A\\) and \\(B\\) such that the sum of the sidelengths of the squares in \\(A\\) is 1 or 2 units larger than the sum of the sidelengths of the squares in \\(B\\).\nString the squares of each set \\(A, B\\) along two parallel diagonals, one for each diagonal. Now use the four largest squares along two perpendicular diagonals to finish the construction: one will have sidelengths \\(n\\) and \\(n-3\\), and the other, sidelengths \\(n-1\\) and \\(n-2\\). If the sum of the sidelengths of the squares in \\(A\\) is 1 unit larger than the sum of the sidelengths of the squares in \\(B\\), attach the squares with sidelengths \\(n-3\\) and \\(n-1\\) to the \\(A\\)-diagonal, and the other two squares to the \\(B\\)-diagonal. The resulting configuration, in which the \\(A\\) and \\(B\\)-diagonals are represented by unit squares, and the sidelengths \\(a_{i}\\) of squares from \\(A\\) and \\(b_{j}\\) of squares from \\(B\\) are indicated within each square, follows:\n![](https://cdn.mathpix.com/cropped/2025_08_23_f8a083d79305c9305a0cg-01.jpg?height=586&width=1329&top_left_y=1199&top_left_x=331)\n\nSince \\(\\left(a_{1}+a_{2}+\\cdots+a_{k}\\right) \\sqrt{2}+\\frac{((n-3)+(n-2)) \\sqrt{2}}{2}=\\left(b_{1}+b_{2}+\\cdots+b_{\\ell}+2\\right) \\sqrt{2}+\\frac{(n+(n-1)) \\sqrt{2}}{2}\\), this case is done.\nIf the sum of the sidelengths of the squares in \\(A\\) is 1 unit larger than the sum of the sidelengths of the squares in \\(B\\), attach the squares with sidelengths \\(n-3\\) and \\(n-2\\) to the \\(A\\)-diagonal, and the other two squares to the \\(B\\)-diagonal. The resulting configuration follows:\n![](https://cdn.mathpix.com/cropped/2025_08_23_f8a083d79305c9305a0cg-01.jpg?height=615&width=1329&top_left_y=2095&top_left_x=331)\n\nSince \\(\\left(a_{1}+a_{2}+\\cdots+a_{k}\\right) \\sqrt{2}+\\frac{((n-3)+(n-1)) \\sqrt{2}}{2}=\\left(b_{1}+b_{2}+\\cdots+b_{\\ell}+1\\right) \\sqrt{2}+\\frac{(n+(n-2)) \\sqrt{2}}{2}\\), this case is also done.\nIn both cases, the distance between the \\(A\\)-diagonal and the \\(B\\)-diagonal is \\(\\frac{((n-3)+n) \\sqrt{2}}{2}=\\frac{(2 n-3) \\sqrt{2}}{2}\\).\nSince \\(a_{i}, b_{j} \\leq n-4, \\frac{\\left(a_{i}+b_{j}\\right) \\sqrt{2}}{2}<\\frac{(2 n-4) \\sqrt{2}}{2}<\\frac{(2 n-3) \\sqrt{2}}{2}\\), and therefore the \\(A\\) - and \\(B\\)-diagonals do not overlap.\nFinally, we prove that it is possible to split the squares of sidelengths 1 to \\(n-4\\) into two sets \\(A\\) and \\(B\\) such that the sum of the sidelengths of the squares in \\(A\\) is 1 or 2 units larger than the sum of the sidelengths of the squares in \\(B\\). One can do that in several ways; we present two possibilities:\n- Direct construction: Split the numbers from 1 to \\(n-4\\) into several sets of four consecutive numbers \\(\\{t, t+1, t+2, t+3\\}\\), beginning with the largest numbers; put squares of sidelengths \\(t\\) and \\(t+3\\) in \\(A\\) and squares of sidelengths \\(t+1\\) and \\(t+2\\) in \\(B\\). Notice that \\(t+(t+3)= (t+1)+(t+2)\\). In the end, at most four numbers remain.\n- If only 1 remains, put the corresponding square in \\(A\\), so the sum of the sidelengths of the squares in \\(A\\) is one unit larger that those in \\(B\\);\n- If 1 and 2 remains, put the square of sidelength 2 in \\(A\\) and the square of sidelength 1 in \\(B\\) (the difference is 1 );\n- If 1,2, and 3 remains, put the squares of sidelengths 1 and 3 in \\(A\\), and the square of sidelength 2 in \\(B\\) (the difference is 2 );\n- If 1,2,3, and 4 remains, put the squares of sidelengths 2 and 4 in \\(A\\), and the squares of sidelengths 1 and 3 in \\(B\\) (the difference is 2 ).\n- Indirect construction: Starting with \\(A\\) and \\(B\\) as empty sets, add the squares of sidelengths \\(n-4, n-3, \\ldots, 2\\) to either \\(A\\) or \\(B\\) in that order such that at each stage the difference between the sum of the sidelengths in \\(A\\) and the sum of the sidelengths of B is minimized. By induction it is clear that after adding an integer \\(j\\) to one of the sets, this difference is at most \\(j\\). In particular, the difference is 0,1 or 2 at the end. Finally adding the final 1 to one of the sets can ensure that the final difference is 1 or 2 . If necessary, flip \\(A\\) and \\(B\\).\n\n\\section*{Solution 2}\n\nSolve the problem by induction in \\(n\\). Construct examples for \\(n=5,6,7,8,9,10\\) (one can use the constructions from the previous solution, for instance). For \\(n>10\\), set aside the six larger squares and arrange them in the following fashion:\n![](https://cdn.mathpix.com/cropped/2025_08_23_f8a083d79305c9305a0cg-02.jpg?height=804&width=1029&top_left_y=1955&top_left_x=482)\n\nBy the induction hypothesis, one can arrange the remaining \\(n-6\\) squares away from the six larger squares, so we are done.", "source_pdf": "apmo_2023.pdf", "notes": ""}
{"id": "APMO-2023-2", "contest": "APMO", "year": "2023", "problem_number": "2", "problem": "Find all integers \\(n\\) satisfying \\(n \\geq 2\\) and \\(\\frac{\\sigma(n)}{p(n)-1}=n\\), in which \\(\\sigma(n)\\) denotes the sum of all positive divisors of \\(n\\), and \\(p(n)\\) denotes the largest prime divisor of \\(n\\).\n\nAnswer: \\(n=6\\).", "solution": "\\section*{Solution}\n\nLet \\(n=p_{1}^{\\alpha_{1}} \\cdot \\ldots \\cdot p_{k}^{\\alpha_{k}}\\) be the prime factorization of \\(n\\) with \\(p_{1}<\\ldots<p_{k}\\), so that \\(p(n)=p_{k}\\) and \\(\\sigma(n)=\\left(1+p_{1}+\\cdots+p_{1}^{\\alpha_{1}}\\right) \\ldots\\left(1+p_{k}+\\cdots+p_{k}^{\\alpha_{k}}\\right)\\). Hence\n\\(p_{k}-1=\\frac{\\sigma(n)}{n}=\\prod_{i=1}^{k}\\left(1+\\frac{1}{p_{i}}+\\cdots+\\frac{1}{p_{i}^{\\alpha_{i}}}\\right)<\\prod_{i=1}^{k} \\frac{1}{1-\\frac{1}{p_{i}}}=\\prod_{i=1}^{k}\\left(1+\\frac{1}{p_{i}-1}\\right) \\leq \\prod_{i=1}^{k}\\left(1+\\frac{1}{i}\\right)=k+1\\),\nthat is, \\(p_{k}-1<k+1\\), which is impossible for \\(k \\geq 3\\), because in this case \\(p_{k}-1 \\geq 2 k-2 \\geq k+1\\). Then \\(k \\leq 2\\) and \\(p_{k}<k+2 \\leq 4\\), which implies \\(p_{k} \\leq 3\\).\nIf \\(k=1\\) then \\(n=p^{\\alpha}\\) and \\(\\sigma(n)=1+p+\\cdots+p^{\\alpha}\\), and in this case \\(n \\nmid \\sigma(n)\\), which is not possible. Thus \\(k=2\\), and \\(n=2^{\\alpha} 3^{\\beta}\\) with \\(\\alpha, \\beta>0\\). If \\(\\alpha>1\\) or \\(\\beta>1\\),\n\\[\n\\frac{\\sigma(n)}{n}>\\left(1+\\frac{1}{2}\\right)\\left(1+\\frac{1}{3}\\right)=2 .\n\\]\n\nTherefore \\(\\alpha=\\beta=1\\) and the only answer is \\(n=6\\).\nComment: There are other ways to deal with the case \\(n=2^{\\alpha} 3^{\\beta}\\). For instance, we have \\(2^{\\alpha+2} 3^{\\beta}=\\left(2^{\\alpha+1}-1\\right)\\left(3^{\\beta+1}-1\\right)\\). Since \\(2^{\\alpha+1}-1\\) is not divisible by 2 , and \\(3^{\\beta+1}-1\\) is not divisible by 3 , we have\n\\[\n\\left\\{\\begin{array} { l } \n{ 2 ^ { \\alpha + 1 } - 1 = 3 ^ { \\beta } } \\\\\n{ 3 ^ { \\beta + 1 } - 1 = 2 ^ { \\alpha + 2 } }\n\\end{array} \\Longleftrightarrow \\left\\{\\begin{array} { c } \n{ 2 ^ { \\alpha + 1 } - 1 = 3 ^ { \\beta } } \\\\\n{ 3 \\cdot ( 2 ^ { \\alpha + 1 } - 1 ) - 1 = 2 \\cdot 2 ^ { \\alpha + 1 } }\n\\end{array} \\Longleftrightarrow \\left\\{\\begin{array}{r}\n2^{\\alpha+1}=4 \\\\\n3^{\\beta}=3\n\\end{array},\\right.\\right.\\right.\n\\]\nand \\(n=2^{\\alpha} 3^{\\beta}=6\\).", "source_pdf": "apmo_2023.pdf", "notes": ""}
{"id": "APMO-2023-3", "contest": "APMO", "year": "2023", "problem_number": "3", "problem": "Let \\(A B C D\\) be a parallelogram. Let \\(W, X, Y\\), and \\(Z\\) be points on sides \\(A B, B C, C D\\), and \\(D A\\), respectively, such that the incenters of triangles \\(A W Z, B X W, C Y X\\) and \\(D Z Y\\) form a parallelogram. Prove that \\(W X Y Z\\) is a parallelogram.", "solution": "\\section*{Solution}\n\nLet the four incenters be \\(I_{1}, I_{2}, I_{3}\\), and \\(I_{4}\\) with inradii \\(r_{1}, r_{2}, r_{3}\\), and \\(r_{4}\\) respectively (in the order given in the question). Without loss of generality, let \\(I_{1}\\) be closer to \\(A B\\) than \\(I_{2}\\). Let the acute angle between \\(I_{1} I_{2}\\) and \\(A B\\) (and hence also the angle between \\(I_{3} I_{4}\\) and \\(C D\\) ) be \\(\\theta\\). Then\n\\[\nr_{2}-r_{1}=I_{1} I_{2} \\sin \\theta=I_{3} I_{4} \\sin \\theta=r_{4}-r_{3},\n\\]\nwhich implies \\(r_{1}+r_{4}=r_{2}+r_{3}\\). Similar arguments show that \\(r_{1}+r_{2}=r_{3}+r_{4}\\). Thus we obtain \\(r_{1}=r_{3}\\) and \\(r_{2}=r_{4}\\).\n![](https://cdn.mathpix.com/cropped/2025_08_23_f8a083d79305c9305a0cg-05.jpg?height=492&width=784&top_left_y=848&top_left_x=596)\n\nNow let's consider the possible positions of \\(W, X, Y, Z\\). Suppose \\(A Z \\neq C X\\). Without loss of generality assume \\(A Z>C X\\). Since the incircles of \\(A W Z\\) and \\(C Y X\\) are symmetric about the centre of the parallelogram \\(A B C D\\), this implies \\(C Y>A W\\). Using similar arguments, we have\n\\[\nC Y>A W \\Longrightarrow B W>D Y \\Longrightarrow D Z>B X \\Longrightarrow C X>A Z,\n\\]\nwhich is a contradiction. Therefore \\(A Z=C X \\Longrightarrow A W=C Y\\) and \\(W X Y Z\\) is a parallelogram.\nComment: There are several ways to prove that \\(r_{1}=r_{3}\\) and \\(r_{2}=r_{4}\\). The proposer shows the following three alternative approaches:\nUsing parallel lines: Let \\(O\\) be the centre of parallelogram \\(A B C D\\) and \\(P\\) be the centre of parallelogram \\(I_{1} I_{2} I_{3} I_{4}\\). Since \\(A I_{1}\\) and \\(C I_{3}\\) are angle bisectors, we must have \\(A I_{1} \\| C I_{3}\\). Let \\(\\ell_{1}\\) be the line through \\(O\\) parallel to \\(A I_{1}\\). Since \\(A O=O C, \\ell_{1}\\) is halfway between \\(A I_{1}\\) and \\(C I_{3}\\). Hence \\(P\\) must lie on \\(\\ell_{1}\\).\nSimilarly, \\(P\\) must also lie on \\(\\ell_{2}\\), the line through \\(O\\) parallel to \\(B I_{2}\\). Thus \\(P\\) is the intersection of \\(\\ell_{1}\\) and \\(\\ell_{2}\\), which must be \\(O\\). So the four incentres and hence the four incircles must be symmetric about \\(O\\), which implies \\(r_{1}=r_{3}\\) and \\(r_{2}=r_{4}\\).\nUsing a rotation: Let the bisectors of \\(\\angle D A B\\) and \\(\\angle A B C\\) meet at \\(X\\) and the bisectors of \\(\\angle B C D\\) and \\(\\angle C D A\\) meet at \\(Y\\). Then \\(I_{1}\\) is on \\(A X, I_{2}\\) is on \\(B X, I_{3}\\) is on \\(C Y\\), and \\(I_{4}\\) is on \\(D Y\\). Let \\(O\\) be the centre of \\(A B C D\\). Then a 180 degree rotation about \\(O\\) takes \\(\\triangle A X B\\) to \\(\\triangle C Y D\\). Under the same transformation \\(I_{1} I_{2}\\) is mapped to a parallel segment \\(I_{1}^{\\prime} I_{2}^{\\prime}\\) with \\(I_{1}^{\\prime}\\) on \\(C Y\\) and \\(I_{2}^{\\prime}\\) on \\(D Y\\). Since \\(I_{1} I_{2} I_{3} I_{4}\\) is a parallelogram, \\(I_{3} I_{4}=I_{1} I_{2}\\) and \\(I_{3} I_{4} \\| I_{1} I_{2}\\). Hence \\(I_{1}^{\\prime} I_{2}^{\\prime}\\) and \\(I_{3} I_{4}\\) are parallel, equal length segments on sides \\(C Y, D Y\\) and we conclude that \\(I_{1}^{\\prime}=I_{3}, I_{2}^{\\prime}=I_{4}\\). Hence the centre of \\(I_{1} I_{2} I_{3} I_{4}\\) is also \\(O\\) and we establish that by rotational symmetry that \\(r_{1}=r_{3}\\) and \\(r_{2}=r_{4}\\).\nUsing congruent triangles: Let \\(A I_{1}\\) and \\(B I_{2}\\) intersect at \\(E\\) and let \\(C I_{3}\\) and \\(D I_{4}\\) intersect at \\(F\\). Note that \\(\\triangle A B E\\) and \\(\\triangle C D F\\) are congruent, since \\(A B=C D\\) and corresponding pairs of angles are equal (equal opposite angles parallelogram \\(A B C D\\) are each bisected).\n\nSince \\(A I_{1} \\| C I_{3}\\) and \\(I_{1} I_{2} \\| I_{4} I_{3}, \\angle I_{2} I_{1} E=\\angle I_{4} I_{3} F\\). Similarly \\(\\angle I_{1} I_{2} E=\\angle I_{3} I_{4} F\\). Furthermore \\(I_{1} I_{2}=I_{3} I_{4}\\). Hence triangles \\(I_{2} I_{1} E\\) and \\(I 4 I_{3} F\\) are also congruent.\nHence \\(A B E I_{1} I_{2}\\) and \\(D C F I_{3} I_{4}\\) are congruent. Therefore, the perpendicular distance from \\(I_{1}\\) to \\(A B\\) equals the perpendicular distance from \\(I_{3}\\) to \\(C D\\), that is, \\(r_{1}=r_{3}\\). Similarly \\(r_{2}=r_{4}\\).", "source_pdf": "apmo_2023.pdf", "notes": ""}
{"id": "APMO-2023-4", "contest": "APMO", "year": "2023", "problem_number": "4", "problem": "Let \\(c>0\\) be a given positive real and \\(\\mathbb{R}_{>0}\\) be the set of all positive reals. Find all functions \\(f: \\mathbb{R}_{>0} \\rightarrow \\mathbb{R}_{>0}\\) such that\n\\[\nf((c+1) x+f(y))=f(x+2 y)+2 c x \\quad \\text { for all } x, y \\in \\mathbb{R}_{>0} .\n\\]\n\nAnswer: \\(f(x)=2 x\\) for all \\(x>0\\).", "solution": "\\section*{Solution 1}\n\nWe first prove that \\(f(x) \\geq 2 x\\) for all \\(x>0\\). Suppose, for the sake of contradiction, that \\(f(y)<2 y\\) for some positive \\(y\\). Choose \\(x\\) such that \\(f((c+1) x+f(y))\\) and \\(f(x+2 y)\\) cancel out, that is,\n\\[\n(c+1) x+f(y)=x+2 y \\Longleftrightarrow x=\\frac{2 y-f(y)}{c} .\n\\]\n\nNotice that \\(x>0\\) because \\(2 y-f(y)>0\\). Then \\(2 c x=0\\), which is not possible. This contradiction yields \\(f(y) \\geq 2 y\\) for all \\(y>0\\).\nNow suppose, again for the sake of contradiction, that \\(f(y)>2 y\\) for some \\(y>0\\). Define the following sequence: \\(a_{0}\\) is an arbitrary real greater than \\(2 y\\), and \\(f\\left(a_{n}\\right)=f\\left(a_{n-1}\\right)+2 c x\\), so that\n\\[\n\\left\\{\\begin{array}{r}\n(c+1) x+f(y)=a_{n} \\\\\nx+2 y=a_{n-1}\n\\end{array} \\Longleftrightarrow x=a_{n-1}-2 y \\quad \\text { and } \\quad a_{n}=(c+1)\\left(a_{n-1}-2 y\\right)+f(y) .\\right.\n\\]\n\nIf \\(x=a_{n-1}-2 y>0\\) then \\(a_{n}>f(y)>2 y\\), so inductively all the substitutions make sense.\nFor the sake of simplicity, let \\(b_{n}=a_{n}-2 y\\), so \\(b_{n}=(c+1) b_{n-1}+f(y)-2 y \\quad(*)\\). Notice that \\(x=b_{n-1}\\) in the former equation, so \\(f\\left(a_{n}\\right)=f\\left(a_{n-1}\\right)+2 c b_{n-1}\\). Telescoping yields\n\\[\nf\\left(a_{n}\\right)=f\\left(a_{0}\\right)+2 c \\sum_{i=0}^{n-1} b_{i}\n\\]\n\nOne can find \\(b_{n}\\) from the recurrence equation \\((*): b_{n}=\\left(b_{0}+\\frac{f(y)-2 y}{c}\\right)(c+1)^{n}-\\frac{f(y)-2 y}{c}\\), and then\n\\[\n\\begin{aligned}\nf\\left(a_{n}\\right) & =f\\left(a_{0}\\right)+2 c \\sum_{i=0}^{n-1}\\left(\\left(b_{0}+\\frac{f(y)-2 y}{c}\\right)(c+1)^{i}-\\frac{f(y)-2 y}{c}\\right) \\\\\n& =f\\left(a_{0}\\right)+2\\left(b_{0}+\\frac{f(y)-2 y}{c}\\right)\\left((c+1)^{n}-1\\right)-2 n(f(y)-2 y) .\n\\end{aligned}\n\\]\n\nSince \\(f\\left(a_{n}\\right) \\geq 2 a_{n}=2 b_{n}+4 y\\),\n\\[\n\\begin{aligned}\n& f\\left(a_{0}\\right)+2\\left(b_{0}+\\frac{f(y)-2 y}{c}\\right)\\left((c+1)^{n}-1\\right)-2 n(f(y)-2 y) \\geq 2 b_{n}+4 y \\\\\n= & 2\\left(b_{0}+\\frac{f(y)-2 y}{c}\\right)(c+1)^{n}-2 \\frac{f(y)-2 y}{c},\n\\end{aligned}\n\\]\nwhich implies\n\\[\nf\\left(a_{0}\\right)+2 \\frac{f(y)-2 y}{c} \\geq 2\\left(b_{0}+\\frac{f(y)-2 y}{c}\\right)+2 n(f(y)-2 y),\n\\]\nwhich is not true for sufficiently large \\(n\\).\nA contradiction is reached, and thus \\(f(y)=2 y\\) for all \\(y>0\\). It is immediate that this function satisfies the functional equation.\n\n\\section*{Solution 2}\n\nAfter proving that \\(f(y) \\geq 2 y\\) for all \\(y>0\\), one can define \\(g(x)=f(x)-2 x, g: \\mathbb{R}_{>0} \\rightarrow \\mathbb{R}_{\\geq 0}\\), and our goal is proving that \\(g(x)=0\\) for all \\(x>0\\). The problem is now rewritten as\n\\[\n\\begin{aligned}\n& g((c+1) x+g(y)+2 y)+2((c+1) x+g(y)+2 y)=g(x+2 y)+2(x+2 y)+2 c x \\\\\n\\Longleftrightarrow & g((c+1) x+g(y)+2 y)+2 g(y)=g(x+2 y) .\n\\end{aligned}\n\\]\n\nThis readily implies that \\(g(x+2 y) \\geq 2 g(y)\\), which can be interpreted as \\(z>2 y \\Longrightarrow g(z) \\geq 2 g(y)\\), by plugging \\(z=x+2 y\\).\nNow we prove by induction that \\(z>2 y \\Longrightarrow g(z) \\geq 2 m \\cdot g(y)\\) for any positive integer \\(2 m\\). In fact, since \\((c+1) x+g(y)+2 y>2 y, g((c+1) x+g(y)+2 y) \\geq 2 m \\cdot g(y)\\), and by \\((? ?)\\),\n\\[\ng(x+2 y) \\geq 2 m \\cdot g(y)+2 g(y)=2(m+1) g(y),\n\\]\nand we are done by plugging \\(z=x+2 y\\) again.\nThe problem now is done: if \\(g(y)>0\\) for some \\(y>0\\), choose a fixed \\(z>2 y\\) arbitrarily and and integer \\(m\\) such that \\(m>\\frac{g(z)}{2 g(y)}\\). Then \\(g(z)<2 m \\cdot g(y)\\), contradiction.", "source_pdf": "apmo_2023.pdf", "notes": ""}
{"id": "APMO-2023-5", "contest": "APMO", "year": "2023", "problem_number": "5", "problem": "There are \\(n\\) line segments on the plane, no three intersecting at a point, and each pair intersecting once in their respective interiors. Tony and his \\(2 n-1\\) friends each stand at a distinct endpoint of a line segment. Tony wishes to send Christmas presents to each of his friends as follows:\nFirst, he chooses an endpoint of each segment as a \"sink\". Then he places the present at the endpoint of the segment he is at. The present moves as follows:\n- If it is on a line segment, it moves towards the sink.\n- When it reaches an intersection of two segments, it changes the line segment it travels on and starts moving towards the new sink.\n\nIf the present reaches an endpoint, the friend on that endpoint can receive their present. Prove Tony can send presents to exactly \\(n\\) of his \\(2 n-1\\) friends.", "solution": "\\section*{Solution 1}\n\nDraw a circle that encloses all the intersection points between line segments and extend all line segments until they meet the circle, and then move Tony and all his friends to the circle. Number the intersection points with the circle from 1 to \\(2 n\\) anticlockwise, starting from Tony (Tony has number 1). We will prove that the friends eligible to receive presents are the ones on even-numbered intersection points.\nFirst part: at most \\(n\\) friends can receive a present.\nThe solution relies on a well-known result: the \\(n\\) lines determine regions inside the circle; then it is possible to paint the regions with two colors such that no regions with a common (line) boundary have the same color. The proof is an induction on \\(n\\) : the fact immediately holds for \\(n=0\\), and the induction step consists on taking away one line \\(\\ell\\), painting the regions obtained with \\(n-1\\) lines, drawing \\(\\ell\\) again and flipping all colors on exactly one half plane determined by \\(\\ell\\).\nNow consider the line starting on point 1 . Color the regions in red and blue such that neighboring regions have different colors, and such that the two regions that have point 1 as a vertex are red on the right and blue on the left, from Tony's point of view. Finally, assign to each red region the clockwise direction and to each blue region the anticlockwise direction. Because of the coloring, every boundary will have two directions assigned, but the directions are the same since every boundary divides regions of different colors. Then the present will follow the directions assigned to the regions: it certainly does for both regions in the beginning, and when the present reaches an intersection it will keep bordering one of the two regions it was dividing. To finish this part of the problem, consider the regions that share a boundary with the circle. The directions alternate between outcoming and incoming, starting from 1 (outcoming), so all even-numbered vertices are directed as incoming and are the only ones able to receive presents.\nSecond part: all even-numbered vertices can receive a present.\nFirst notice that, since every two chords intersect, every chord separates the endpoints of each of the other \\(n-1\\) chords. Therefore, there are \\(n-1\\) vertices on each side of every chord, and each chord connects vertices \\(k\\) and \\(k+n, 1 \\leq k \\leq n\\).\nWe prove a stronger result by induction in \\(n\\) : let \\(k\\) be an integer, \\(1 \\leq k \\leq n\\). Direct each chord from \\(i\\) to \\(i+n\\) if \\(1 \\leq i \\leq k\\) and from \\(i+n\\) to \\(i\\) otherwise; in other words, the sinks are \\(k+1, k+2, \\ldots, k+n\\). Now suppose that each chord sends a present, starting from the vertex opposite to each sink, and all presents move with the same rules. Then \\(k-i\\) sends a present to \\(k+i+1, i=0,1, \\ldots, n-1\\) (indices taken modulo \\(2 n\\) ). In particular, for \\(i=k-1\\), Tony, in vertex 1 , send a present to vertex \\(2 k\\). Also, the \\(n\\) paths the presents make do not cross (but they may touch.) More formally, for all \\(i, 1 \\leq i \\leq n\\), if one path takes a present from \\(k-i\\) to \\(k+i+1\\), separating the circle into two regions, all paths taking a present from \\(k-j\\) to \\(k+j+1, j<i\\), are completely contained in one region, and all paths taking a present from\n\\(k-j\\) to \\(k+j+1, j>i\\), are completely contained in the other region. For instance, possible \\({ }^{1}\\) paths for \\(k=3\\) and \\(n=5\\) follow:\n![](https://cdn.mathpix.com/cropped/2025_08_23_f8a083d79305c9305a0cg-10.jpg?height=535&width=543&top_left_y=291&top_left_x=708)\n\nThe result is true for \\(n=1\\). Let \\(n>1\\) and assume the result is true for less chords. Consider the chord that takes \\(k\\) to \\(k+n\\) and remove it. Apply the induction hypothesis to the remaining \\(n-1\\) lines: after relabeling, presents would go from \\(k-i\\) to \\(k+i+2,1 \\leq i \\leq n-1\\) if the chord were not there.\nReintroduce the chord that takes \\(k\\) to \\(k+n\\). From the induction hypothesis, the chord intersects the paths of the presents in the following order: the \\(i\\)-th path the chord intersects is the the one that takes \\(k-i\\) to \\(k+i, i=1,2, \\ldots, n-1\\).\n\n\\begin{figure}\n\\includegraphics[width=\\textwidth]{https://cdn.mathpix.com/cropped/2025_08_23_f8a083d79305c9305a0cg-10.jpg?height=601&width=724&top_left_y=1267&top_left_x=245}\n\\captionsetup{labelformat=empty}\n\\caption{Paths without chord \\(k \\rightarrow k+n\\)}\n\\end{figure}\n\n\\begin{figure}\n\\includegraphics[width=\\textwidth]{https://cdn.mathpix.com/cropped/2025_08_23_f8a083d79305c9305a0cg-10.jpg?height=606&width=723&top_left_y=1262&top_left_x=1022}\n\\captionsetup{labelformat=empty}\n\\caption{Corrected paths with chord \\(k \\rightarrow k+n\\)}\n\\end{figure}\n\nThen the presents cover the following new paths: the present from \\(k\\) will leave its chord and take the path towards \\(k+1\\); then, for \\(i=1,2, \\ldots, n-1\\), the present from \\(k-i\\) will meet the chord from \\(k\\) to \\(k+n\\), move towards the intersection with the path towards \\(k+i+1\\) and go to \\(k+i+1\\), as desired. Notice that the paths still do not cross. The induction (and the solution) is now complete.\n\n\\section*{Solution 2}\n\nFirst part: at most \\(n\\) friends can receive a present.\nSimilarly to the first solution, consider a circle that encompasses all line segments, extend the lines, and use the endpoints of the chords instead of the line segments, and prove that each chord connects vertices \\(k\\) and \\(k+n\\). We also consider, even in the first part, \\(n\\) presents leaving from \\(n\\) outcoming vertices.\nFirst we prove that a present always goes to a sink. If it does not, then it loops; let it first enter the loop at point \\(P\\) after turning from chord \\(a\\) to chord \\(b\\). Therefore after it loops once,\n\n\\footnotetext{\n\\({ }^{1}\\) The paths do not depend uniquely on \\(k\\) and \\(n\\); different chord configurations and vertex labelings may change the paths.\n}\nit must turn to chord \\(b\\) at \\(P\\). But \\(P\\) is the intersection of \\(a\\) and \\(b\\), so the present should turn from chord \\(a\\) to chord \\(b\\), which can only be done in one way - the same way it came in first. This means that some part of chord \\(a\\) before the present enters the loop at \\(P\\) is part of the loop, which contradicts the fact that \\(P\\) is the first point in the loop. So no present enters a loop, and every present goes to a sink.\n\n\\begin{figure}\n\\includegraphics[width=\\textwidth]{https://cdn.mathpix.com/cropped/2025_08_23_f8a083d79305c9305a0cg-11.jpg?height=215&width=255&top_left_y=428&top_left_x=585}\n\\captionsetup{labelformat=empty}\n\\caption{There are no loops}\n\\end{figure}\n\n\\begin{figure}\n\\includegraphics[width=\\textwidth]{https://cdn.mathpix.com/cropped/2025_08_23_f8a083d79305c9305a0cg-11.jpg?height=215&width=255&top_left_y=428&top_left_x=1136}\n\\captionsetup{labelformat=empty}\n\\caption{No two paths cross}\n\\end{figure}\n\nThe present paths also do not cross: in fact, every time two paths share a point \\(P\\), intersection of chords \\(a\\) and \\(b\\), one path comes from \\(a\\) to \\(b\\) and the other path comes from \\(b\\) to \\(a\\), and they touch at \\(P\\). This implies the following sequence of facts:\n- Every path divides the circle into two regions with paths connecting vertices within each region.\n- All \\(n\\) presents will be delivered to \\(n\\) different persons; that is, all sinks receive a present. This implies that every vertex is an endpoint of a path.\n- The number of chord endpoints inside each region is even, because they are connected within their own region.\n\nNow consider the path starting at vertex 1, with Tony. It divides the circle into two regions with an even number of vertices in their interior. Then there is an even number of vertices between Tony and the recipient of his present, that is, their vertex is an even numbered one. Second part: all even-numbered vertices can receive a present.\nThe construction is the same as the in the previous solution: direct each chord from \\(i\\) to \\(i+n\\) if \\(1 \\leq i \\leq k\\) and from \\(i+n\\) to \\(i\\) otherwise; in other words, the sinks are \\(k+1, k+2, \\ldots, k+n\\). Then, since the paths do not cross, \\(k\\) will send a present to \\(k+1, k-1\\) will send a present to \\(k+2\\), and so on, until 1 sends a present to \\((k+1)+(k-1)=2 k\\).", "source_pdf": "apmo_2023.pdf", "notes": ""}
{"id": "APMO-2024-1", "contest": "APMO", "year": "2024", "problem_number": "1", "problem": "Let \\(A B C\\) be an acute triangle. Let \\(D\\) be a point on side \\(A B\\) and \\(E\\) be a point on side \\(A C\\) such that lines \\(B C\\) and \\(D E\\) are parallel. Let \\(X\\) be an interior point of \\(B C E D\\). Suppose rays \\(D X\\) and \\(E X\\) meet side \\(B C\\) at points \\(P\\) and \\(Q\\), respectively such that both \\(P\\) and \\(Q\\) lie between \\(B\\) and \\(C\\). Suppose that the circumcircles of triangles \\(B Q X\\) and \\(C P X\\) intersect at a point \\(Y \\neq X\\). Prove that points \\(A, X\\), and \\(Y\\) are collinear.", "solution": "\\section*{Solution 1}\n![](https://cdn.mathpix.com/cropped/2025_08_23_cf9a878261b0acb030afg-01.jpg?height=700&width=989&top_left_y=691&top_left_x=502)\n\nLet \\(\\ell\\) be the radical axis of circles \\(B Q X\\) and \\(C P X\\). Since \\(X\\) and \\(Y\\) are on \\(\\ell\\), it is sufficient to show that \\(A\\) is on \\(\\ell\\). Let line \\(A X\\) intersect segments \\(B C\\) and \\(D E\\) at \\(Z\\) and \\(Z^{\\prime}\\), respectively. Then it is sufficient to show that \\(Z\\) is on \\(\\ell\\). By \\(B C \\| D E\\), we obtain\n\\[\n\\frac{B Z}{Z C}=\\frac{D Z^{\\prime}}{Z^{\\prime} E}=\\frac{P Z}{Z Q},\n\\]\nthus \\(B Z \\cdot Q Z=C Z \\cdot P Z\\), which implies that \\(Z\\) is on \\(\\ell\\).\n\n\\section*{Solution 2}\n![](https://cdn.mathpix.com/cropped/2025_08_23_cf9a878261b0acb030afg-01.jpg?height=701&width=992&top_left_y=2004&top_left_x=502)\n\nLet circle \\(B Q X\\) intersect line \\(A B\\) at a point \\(S\\) which is different from \\(B\\). Then \\(\\angle D E X= \\angle X Q C=\\angle B S X\\), thus \\(S\\) is on circle \\(D E X\\). Similarly, let circle \\(C P X\\) intersect line \\(A C\\) at a point \\(T\\) which is different from \\(C\\). Then \\(T\\) is on circle \\(D E X\\). The power of \\(A\\) with respect to the circle \\(D E X\\) is \\(A S \\cdot A D=A T \\cdot A E\\). Since \\(\\frac{A D}{A B}=\\frac{A E}{A C}, A S \\cdot A B=A T \\cdot A C\\). Then \\(A\\) is in the radical axis of circles \\(B Q X\\) and \\(C P X\\), which implies that three points \\(A, X\\) and \\(Y\\) are collinear.\n\n\\section*{Solution 3}\n\nConsider the (direct) homothety that takes triangle \\(A D E\\) to triangle \\(A B C\\), and let \\(Y^{\\prime}\\) be the image of \\(Y\\) under this homothety; in other words, let \\(Y^{\\prime}\\) be the intersection of the line parallel to \\(B Y\\) through \\(D\\) and the line parallel to \\(C Y\\) through \\(E\\).\n![](https://cdn.mathpix.com/cropped/2025_08_23_cf9a878261b0acb030afg-02.jpg?height=704&width=992&top_left_y=693&top_left_x=502)\n\nThe homothety implies that \\(A, Y\\), and \\(Y^{\\prime}\\) are collinear, and that \\(\\angle D Y^{\\prime} E=\\angle B Y C\\). Since \\(B Q X Y\\) and \\(C P X Y\\) are cyclic,\n\\(\\angle D Y^{\\prime} E=\\angle B Y C=\\angle B Y X+\\angle X Y C=\\angle X Q P+\\angle X P Q=180^{\\circ}-\\angle P X Q=180^{\\circ}-\\angle D X E\\),\nwhich implies that \\(D Y^{\\prime} E X\\) is cyclic. Therefore\n\\[\n\\angle D Y^{\\prime} X=\\angle D E X=\\angle P Q X=\\angle B Y X,\n\\]\nwhich, combined with \\(D Y^{\\prime} \\| B Y\\), implies \\(Y^{\\prime} X \\| Y X\\). This proves that \\(X, Y\\), and \\(Y^{\\prime}\\) are collinear, which in turn shows that \\(A, X\\), and \\(Y\\) are collinear.", "source_pdf": "apmo_2024.pdf", "notes": ""}
{"id": "APMO-2024-2", "contest": "APMO", "year": "2024", "problem_number": "2", "problem": "Consider a \\(100 \\times 100\\) table, and identify the cell in row \\(a\\) and column \\(b, 1 \\leq a, b \\leq 100\\), with the ordered pair \\((a, b)\\). Let \\(k\\) be an integer such that \\(51 \\leq k \\leq 99\\). A \\(k\\)-knight is a piece that moves one cell vertically or horizontally and \\(k\\) cells to the other direction; that is, it moves from \\((a, b)\\) to ( \\(c, d\\) ) such that ( \\(|a-c|,|b-d|\\) ) is either ( \\(1, k\\) ) or ( \\(k, 1\\) ). The \\(k\\)-knight starts at cell \\((1,1)\\), and performs several moves. A sequence of moves is a sequence of cells \\(\\left(x_{0}, y_{0}\\right)=(1,1)\\), \\(\\left(x_{1}, y_{1}\\right),\\left(x_{2}, y_{2}\\right), \\ldots,\\left(x_{n}, y_{n}\\right)\\) such that, for all \\(i=1,2, \\ldots, n, 1 \\leq x_{i}, y_{i} \\leq 100\\) and the \\(k\\)-knight can move from \\(\\left(x_{i-1}, y_{i-1}\\right)\\) to \\(\\left(x_{i}, y_{i}\\right)\\). In this case, each cell \\(\\left(x_{i}, y_{i}\\right)\\) is said to be reachable. For each \\(k\\), find \\(L(k)\\), the number of reachable cells.\n\nAnswer: \\(L(k)=\\left\\{\\begin{array}{ll}100^{2}-(2 k-100)^{2} & \\text { if } k \\text { is even } \\\\ \\frac{100^{2}-(2 k-100)^{2}}{2} & \\text { if } k \\text { is odd }\\end{array}\\right.\\).", "solution": "\\section*{Solution}\n\nCell ( \\(x, y\\) ) is directly reachable from another cell if and only if \\(x-k \\geq 1\\) or \\(x+k \\leq 100\\) or \\(y-k \\geq 1\\) or \\(y+k \\leq 100\\), that is, \\(x \\geq k+1\\) or \\(x \\leq 100-k\\) or \\(y \\geq k+1\\) or \\(y \\leq 100-k(*)\\). Therefore the cells ( \\(x, y\\) ) for which \\(101-k \\leq x \\leq k\\) and \\(101-k \\leq y \\leq k\\) are unreachable. Let \\(S\\) be this set of unreachable cells in this square, namely the square of cells \\((x, y), 101-k \\leq x, y \\leq k\\).\nIf condition (*) is valid for both ( \\(x, y\\) ) and ( \\(x \\pm 2, y \\pm 2\\) ) then one can move from ( \\(x, y\\) ) to \\((x \\pm 2, y \\pm 2)\\), if they are both in the table, with two moves: either \\(x \\leq 50\\) or \\(x \\geq 51\\); the same is true for \\(y\\). In the first case, move \\((x, y) \\rightarrow(x+k, y \\pm 1) \\rightarrow(x, y \\pm 2)\\) or \\((x, y) \\rightarrow (x \\pm 1, y+k) \\rightarrow(x \\pm 2, y)\\). In the second case, move \\((x, y) \\rightarrow(x-k, y \\pm 1) \\rightarrow(x, y \\pm 2)\\) or \\((x, y) \\rightarrow(x \\pm 1, y-k) \\rightarrow(x \\pm 2, y)\\).\nHence if the table is colored in two colors like a chessboard, if \\(k \\leq 50\\), cells with the same color as \\((1,1)\\) are reachable. Moreover, if \\(k\\) is even, every other move changes the color of the occupied cell, and all cells are potentially reachable; otherwise, only cells with the same color as \\((1,1)\\) can be visited. Therefore, if \\(k\\) is even then the reachable cells consists of all cells except the center square defined by \\(101-k \\leq x \\leq k\\) and \\(101-k \\leq y \\leq k\\), that is, \\(L(k)=100^{2}-(2 k-100)^{2}\\); if \\(k\\) is odd, then only half of the cells are reachable: the ones with the same color as \\((1,1)\\), and \\(L(k)=\\frac{1}{2}\\left(100^{2}-(2 k-100)^{2}\\right)\\).", "source_pdf": "apmo_2024.pdf", "notes": ""}
{"id": "APMO-2024-3", "contest": "APMO", "year": "2024", "problem_number": "3", "problem": "Let \\(n\\) be a positive integer and \\(a_{1}, a_{2}, \\ldots, a_{n}\\) be positive real numbers. Prove that\n\\[\n\\sum_{i=1}^{n} \\frac{1}{2^{i}}\\left(\\frac{2}{1+a_{i}}\\right)^{2^{i}} \\geq \\frac{2}{1+a_{1} a_{2} \\ldots a_{n}}-\\frac{1}{2^{n}}\n\\]", "solution": "\\section*{Solution}\n\nWe first prove the following lemma:\nLemma 1. For \\(k\\) positive integer and \\(x, y>0\\),\n\\[\n\\left(\\frac{2}{1+x}\\right)^{2^{k}}+\\left(\\frac{2}{1+y}\\right)^{2^{k}} \\geq 2\\left(\\frac{2}{1+x y}\\right)^{2^{k-1}} .\n\\]\n\nThe proof goes by induction. For \\(k=1\\), we have\n\\[\n\\left(\\frac{2}{1+x}\\right)^{2}+\\left(\\frac{2}{1+y}\\right)^{2} \\geq 2\\left(\\frac{2}{1+x y}\\right)\n\\]\nwhich reduces to\n\\[\nx y(x-y)^{2}+(x y-1)^{2} \\geq 0 .\n\\]\n\nFor \\(k>1\\), by the inequality \\(2\\left(A^{2}+B^{2}\\right) \\geq(A+B)^{2}\\) applied at \\(A=\\left(\\frac{2}{1+x}\\right)^{2^{k-1}}\\) and \\(B=\\left(\\frac{2}{1+y}\\right)^{2^{k-1}}\\) followed by the induction hypothesis\n\\[\n\\begin{aligned}\n2\\left(\\left(\\frac{2}{1+x}\\right)^{2^{k}}+\\left(\\frac{2}{1+y}\\right)^{2^{k}}\\right) & \\geq\\left(\\left(\\frac{2}{1+x}\\right)^{2^{k-1}}+\\left(\\frac{2}{1+y}\\right)^{2^{k-1}}\\right)^{2} \\\\\n& \\geq\\left(2\\left(\\frac{2}{1+x y}\\right)^{2^{k-2}}\\right)^{2}=4\\left(\\frac{2}{1+x y}\\right)^{2^{k-1}}\n\\end{aligned}\n\\]\nfrom which the lemma follows.\nThe problem now can be deduced from summing the following applications of the lemma, multiplied by the appropriate factor:\n\\[\n\\begin{aligned}\n\\frac{1}{2^{n}}\\left(\\frac{2}{1+a_{n}}\\right)^{2^{n}}+\\frac{1}{2^{n}}\\left(\\frac{2}{1+1}\\right)^{2^{n}} & \\geq \\frac{1}{2^{n-1}}\\left(\\frac{2}{1+a_{n} \\cdot 1}\\right)^{2^{n-1}} \\\\\n\\frac{1}{2^{n-1}}\\left(\\frac{2}{1+a_{n-1}}\\right)^{2^{n-1}}+\\frac{1}{2^{n-1}}\\left(\\frac{2}{1+a_{n}}\\right)^{2^{n-1}} & \\geq \\frac{1}{2^{n-2}}\\left(\\frac{2}{1+a_{n-1} a_{n}}\\right)^{2^{n-2}} \\\\\n\\frac{1}{2^{n-2}}\\left(\\frac{2}{1+a_{n-2}}\\right)^{2^{n-2}}+\\frac{1}{2^{n-2}}\\left(\\frac{2}{1+a_{n-1} a_{n}}\\right)^{2^{n-2}} & \\geq \\frac{1}{2^{n-3}}\\left(\\frac{2}{1+a_{n-2} a_{n-1} a_{n}}\\right)^{2^{n-3}} \\\\\n\\cdots & 2^{2^{k}} \\\\\n\\frac{1}{2^{k}}\\left(\\frac{2}{1+a_{k}}\\right)^{2^{k}}+\\frac{1}{2^{k}}\\left(\\frac{2}{1+a_{k+1} \\ldots a_{n-1} a_{n}}\\right)^{2^{k-1}} & \\geq \\frac{1}{2^{k-1}}\\left(\\frac{2}{1+a_{k} \\ldots a_{n-2} a_{n-1} a_{n}}\\right)^{-} \\\\\n\\frac{1}{2}\\left(\\frac{2}{1+a_{1}}\\right)^{2}+\\frac{1}{2}\\left(\\frac{2}{1+a_{2} \\ldots a_{n-1} a_{n}}\\right)^{2} & \\geq \\frac{2}{1+a_{1} \\ldots a_{n-2} a_{n-1} a_{n}}\n\\end{aligned}\n\\]\n\nComment: Equality occurs if and only if \\(a_{1}=a_{2}=\\cdots=a_{n}=1\\).\n\nComment: The main motivation for the lemma is trying to \"telescope\" the sum\n\\[\n\\frac{1}{2^{n}}+\\sum_{i=1}^{n} \\frac{1}{2^{i}}\\left(\\frac{2}{1+a_{i}}\\right)^{2^{i}},\n\\]\nthat is,\n\\[\n\\frac{1}{2}\\left(\\frac{2}{1+a_{1}}\\right)^{2}+\\cdots+\\frac{1}{2^{n-1}}\\left(\\frac{2}{1+a_{n-1}}\\right)^{2^{n-1}}+\\frac{1}{2^{n}}\\left(\\frac{2}{1+a_{n}}\\right)^{2^{n}}+\\frac{1}{2^{n}}\\left(\\frac{2}{1+1}\\right)^{2^{n}}\n\\]\nto obtain an expression larger than or equal to\n\\[\n\\frac{2}{1+a_{1} a_{2} \\ldots a_{n}} .\n\\]\n\nIt seems reasonable to obtain a inequality that can be applied from right to left, decreases the exponent of the factor \\(1 / 2^{k}\\) by 1 , and multiplies the variables in the denominator. Given that, the lemma is quite natural:\n\\[\n\\frac{1}{2^{k}}\\left(\\frac{2}{1+x}\\right)^{2^{k}}+\\frac{1}{2^{k}}\\left(\\frac{2}{1+y}\\right)^{2^{k}} \\geq \\frac{1}{2^{k-1}}\\left(\\frac{2}{1+x y}\\right)^{2^{i-1}},\n\\]\nor\n\\[\n\\left(\\frac{2}{1+x}\\right)^{2^{k}}+\\left(\\frac{2}{1+y}\\right)^{2^{k}} \\geq 2\\left(\\frac{2}{1+x y}\\right)^{2^{k-1}} .\n\\]", "source_pdf": "apmo_2024.pdf", "notes": ""}
{"id": "APMO-2024-4", "contest": "APMO", "year": "2024", "problem_number": "4", "problem": "Prove that for every positive integer \\(t\\) there is a unique permutation \\(a_{0}, a_{1}, \\ldots, a_{t-1}\\) of \\(0,1, \\ldots, t-\\) 1 such that, for every \\(0 \\leq i \\leq t-1\\), the binomial coefficient \\(\\binom{t+i}{2 a_{i}}\\) is odd and \\(2 a_{i} \\neq t+i\\).", "solution": "\\section*{Solution}\n\nWe constantly make use of Kummer's theorem which, in particular, implies that \\(\\binom{n}{k}\\) is odd if and only if \\(k\\) and \\(n-k\\) have ones in different positions in binary. In other words, if \\(S(x)\\) is the set of positions of the digits 1 of \\(x\\) in binary (in which the digit multiplied by \\(2^{i}\\) is in position \\(i),\\binom{n}{k}\\) is odd if and only if \\(S(k) \\subseteq S(n)\\). Moreover, if we set \\(k<n, S(k)\\) is a proper subset of \\(S(n)\\), that is, \\(|S(k)|<|S(n)|\\).\nWe start with a lemma that guides us how the permutation should be set.\n\n\\section*{Lemma 1.}\n\\[\n\\sum_{i=0}^{t-1}|S(t+i)|=t+\\sum_{i=0}^{t-1}|S(2 i)| .\n\\]\n\nThe proof is just realizing that \\(S(2 i)=\\{1+x, x \\in S(i)\\}\\) and \\(S(2 i+1)=\\{0\\} \\cup\\{1+x, x \\in S(i)\\}\\), because \\(2 i\\) in binary is \\(i\\) followed by a zero and \\(2 i+1\\) in binary is \\(i\\) followed by a one. Therefore\n\\[\n\\begin{aligned}\n\\sum_{i=0}^{t-1}|S(t+i)| & =\\sum_{i=0}^{2 t-1}|S(i)|-\\sum_{i=0}^{t-1}|S(i)|=\\sum_{i=0}^{t-1}|S(2 i)|+\\sum_{i=0}^{t-1}|S(2 i+1)|-\\sum_{i=0}^{t-1}|S(i)| \\\\\n& =\\sum_{i=0}^{t-1}|S(i)|+\\sum_{i=0}^{t-1}(1+|S(i)|)-\\sum_{i=0}^{t-1}|S(i)|=t+\\sum_{i=0}^{t-1}|S(i)|=t+\\sum_{i=0}^{t-1}|S(2 i)| .\n\\end{aligned}\n\\]\n\nThe lemma has an immediate corollary: since \\(t+i>2 a_{i}\\) and \\(\\binom{t+i}{2 a_{i}}\\) is odd for all \\(i, 0 \\leq i \\leq t-1\\), \\(S\\left(2 a_{i}\\right) \\subset S(t+i)\\) with \\(\\left|S\\left(2 a_{i}\\right)\\right| \\leq|S(t+i)|-1\\). Since the sum of \\(\\left|S\\left(2 a_{i}\\right)\\right|\\) is \\(t\\) less than the sum of \\(|S(t+i)|\\), and there are \\(t\\) values of \\(i\\), equality must occur, that is, \\(\\left|S\\left(2 a_{i}\\right)\\right|=|S(t+i)|-1\\), which in conjunction with \\(S\\left(2 a_{i}\\right) \\subset S(t+i)\\) means that \\(t+i-2 a_{i}=2^{k_{i}}\\) for every \\(i, 0 \\leq i \\leq t-1\\), \\(k_{i} \\in S(t+i)\\) (more precisely, \\(\\left\\{k_{i}\\right\\}=S(t+i) \\backslash S\\left(2 a_{i}\\right)\\).)\nIn particular, for \\(t+i\\) odd, this means that \\(t+i-2 a_{i}=1\\), because the only odd power of 2 is 1. Then \\(a_{i}=\\frac{t+i-1}{2}\\) for \\(t+i\\) odd, which takes up all the numbers greater than or equal to \\(\\frac{t-1}{2}\\). Now we need to distribute the numbers that are smaller than \\(\\frac{t-1}{2}\\) (call these numbers small). If \\(t+i\\) is even then by Lucas' Theorem \\(\\binom{t+i}{2 a_{i}} \\equiv\\left(\\frac{t+i}{2}\\right)(\\bmod 2)\\), so we pair numbers from \\(\\lceil t / 2\\rceil\\) to \\(t-1\\) (call these numbers big) with the small numbers.\nSay that a set \\(A\\) is paired with another set \\(B\\) whenever \\(|A|=|B|\\) and there exists a bijection \\(\\pi: A \\rightarrow B\\) such that \\(S(a) \\subset S(\\pi(a))\\) and \\(|S(a)|=|S(\\pi(a))|-1\\); we also say that \\(a\\) and \\(\\pi(a)\\) are paired. We prove by induction in \\(t\\) that \\(A_{t}=\\{0,1,2, \\ldots,\\lfloor t / 2\\rfloor-1\\}\\) (the set of small numbers) and \\(B_{t}=\\{\\lceil t / 2\\rceil, \\ldots, t-2, t-1\\}\\) (the set of big numbers) can be uniquely paired.\nThe claim is immediate for \\(t=1\\) and \\(t=2\\). For \\(t>2\\), there is exactly one power of two in \\(B_{t}\\), since \\(t / 2 \\leq 2^{a}<t \\Longleftrightarrow a=\\left\\lceil\\log _{2}(t / 2)\\right\\rceil\\). Let \\(2^{a}\\) be this power of two. Then, since \\(2^{a} \\geq t / 2\\), no number in \\(A_{t}\\) has a one in position \\(a\\) in binary. Since for every number \\(x, 2^{a} \\leq x<t, a \\in S(x)\\) and \\(a \\notin S(y)\\) for all \\(y \\in A_{t}, x\\) can only be paired with \\(x-2^{a}\\), since \\(S(x)\\) needs to be stripped of exactly one position. This takes cares of \\(x \\in B_{t}, 2^{a} \\leq x<t\\), and \\(y \\in A_{t}, 0 \\leq y<t-2^{a}\\).\nNow we need to pair the numbers from \\(A^{\\prime}=\\left\\{t-2^{a}, t-2^{a}+1, \\ldots,\\lfloor t / 2\\rfloor-1\\right\\} \\subset A\\) with the numbers from \\(B^{\\prime}=\\left\\{\\lceil t / 2\\rceil,\\lceil t / 2\\rceil+1, \\ldots, 2^{a}-1\\right\\} \\subset B\\). In order to pair these \\(t-2\\left(t-2^{a}\\right)= 2^{a+1}-t<t\\) numbers, we use the induction hypothesis and a bijection between \\(A^{\\prime} \\cup B^{\\prime}\\) and \\(B_{2^{a+1}{ }_{-t}} \\cup A_{2^{a+1}{ }_{-t}}\\). Let \\(S=S\\left(2^{a}-1\\right)=\\{0,1,2, \\ldots, a-1\\}\\). Then take a pair \\(x, y, x \\in A_{2^{a+1}-t}\\) and \\(y \\in B_{2^{a+1}-t}\\) and biject it with \\(2^{a}-1-x \\in B^{\\prime}\\) and \\(2^{a}-1-y \\in A^{\\prime}\\). In fact,\n\\[\n0 \\leq x \\leq\\left\\lfloor\\frac{2^{a+1}-t}{2}\\right\\rfloor-1=2^{a}-\\left\\lceil\\frac{t}{2}\\right\\rceil-1 \\Longleftrightarrow\\left\\lceil\\frac{t}{2}\\right\\rceil \\leq 2^{a}-1-x \\leq 2^{a}-1\n\\]\nand\n\\[\n\\left\\lceil\\frac{2^{a+1}-t}{2}\\right\\rceil=2^{a}-\\left\\lfloor\\frac{t}{2}\\right\\rfloor \\leq y \\leq 2^{a+1}-t-1 \\Longleftrightarrow t-2^{a} \\leq 2^{a}-1-y \\leq\\left\\lfloor\\frac{t}{2}\\right\\rfloor-1 .\n\\]\n\nMoreover, \\(S\\left(2^{a}-1-x\\right)=S \\backslash S(x)\\) and \\(S\\left(2^{a}-1-y\\right)=S \\backslash S(y)\\) are complements with respect to \\(S\\), and \\(S(x) \\subset S(y)\\) and \\(|S(x)|=|S(y)|-1\\) implies \\(S\\left(2^{a}-1-y\\right) \\subset S\\left(2^{a}-1-x\\right)\\) and \\(\\left|S\\left(2^{a}-1-y\\right)\\right|=\\left|S\\left(2^{a}-1-x\\right)\\right|-1\\). Therefore a pairing between \\(A^{\\prime}\\) and \\(B^{\\prime}\\) corresponds to a pairing between \\(A_{2^{a+1}-t}\\) and \\(B_{2^{a+1}-t}\\). Since the latter pairing is unique, the former pairing is also unique, and the result follows.\nWe illustrate the bijection by showing the case \\(t=23\\) :\n\\[\nA_{23}=\\{0,1,2, \\ldots, 10\\}, \\quad B_{23}=\\{12,13,14, \\ldots, 22\\}\n\\]\n\nThe pairing is\n\\[\n\\left(\\begin{array}{ccccccccccc}\n12 & 13 & 14 & 15 & 16 & 17 & 18 & 19 & 20 & 21 & 22 \\\\\n8 & 9 & 10 & 7 & 0 & 1 & 2 & 3 & 4 & 5 & 6\n\\end{array}\\right)\n\\]\nin which the bijection is between\n\\[\n\\left(\\begin{array}{cccc}\n12 & 13 & 14 & 15 \\\\\n8 & 9 & 10 & 7\n\\end{array}\\right) \\quad \\text { and } \\quad\\left(\\begin{array}{cccc}\n3 & 2 & 1 & 0 \\\\\n7 & 6 & 5 & 8\n\\end{array}\\right) \\rightarrow\\left(\\begin{array}{cccc}\n5 & 6 & 7 & 8 \\\\\n1 & 2 & 3 & 0\n\\end{array}\\right)\n\\]", "source_pdf": "apmo_2024.pdf", "notes": ""}
{"id": "APMO-2024-5", "contest": "APMO", "year": "2024", "problem_number": "5", "problem": "Line \\(\\ell\\) intersects sides \\(B C\\) and \\(A D\\) of cyclic quadrilateral \\(A B C D\\) in its interior points \\(R\\) and \\(S\\) respectively, and intersects ray \\(D C\\) beyond point \\(C\\) at \\(Q\\), and ray \\(B A\\) beyond point \\(A\\) at \\(P\\). Circumcircles of the triangles \\(Q C R\\) and \\(Q D S\\) intersect at \\(N \\neq Q\\), while circumcircles of the triangles \\(P A S\\) and \\(P B R\\) intersect at \\(M \\neq P\\). Let lines \\(M P\\) and \\(N Q\\) meet at point \\(X\\), lines \\(A B\\) and \\(C D\\) meet at point \\(K\\) and lines \\(B C\\) and \\(A D\\) meet at point \\(L\\). Prove that point \\(X\\) lies on line \\(K L\\).", "solution": "\\section*{Solution 1}\n\nWe start with the following lemma.\nLemma 1. Points \\(M, N, P, Q\\) are concyclic.\nPoint \\(M\\) is the Miquel point of lines \\(A P=A B, P S=\\ell, A S=A D\\), and \\(B R=B C\\), and point \\(N\\) is the Miquel point of lines \\(C Q=C D, R C=B C, Q R=\\ell\\), and \\(D S=A D\\). Both points \\(M\\) and \\(N\\) are on the circumcircle of the triangle determined by the common lines \\(A D, \\ell\\), and \\(B C\\), which is \\(L R S\\).\nThen, since quadrilaterals \\(Q N R C, P M A S\\), and \\(A B C D\\) are all cyclic, using directed angles (modulo \\(180^{\\circ}\\) )\n\\[\n\\begin{aligned}\n\\measuredangle N M P & =\\measuredangle N M S+\\measuredangle S M P=\\measuredangle N R S+\\measuredangle S A P=\\measuredangle N R Q+\\measuredangle D A B=\\measuredangle N R Q+\\measuredangle D C B \\\\\n& =\\measuredangle N R Q+\\measuredangle Q C R=\\measuredangle N R Q+\\measuredangle Q N R=\\measuredangle N Q R=\\measuredangle N Q P,\n\\end{aligned}\n\\]\nwhich implies that \\(M N Q P\\) is a cyclic quadrilateral.\n![](https://cdn.mathpix.com/cropped/2025_08_23_cf9a878261b0acb030afg-08.jpg?height=952&width=1094&top_left_y=1319&top_left_x=451)\n\nLet \\(E\\) be the Miquel point of \\(A B C D\\) (that is, of lines \\(A B, B C, C D, D A\\) ). It is well known that \\(E\\) lies in the line \\(t\\) connecting the intersections of the opposite lines of \\(A B C D\\). Let lines \\(N Q\\) and \\(t\\) meet at \\(T\\). If \\(T \\neq E\\), using directed angles, looking at the circumcircles of \\(L A B\\) (which contains, by definition, \\(E\\) and \\(M\\) ), \\(A P S\\) (which also contains \\(M\\) ), and \\(M N Q P\\),\n\\[\n\\measuredangle T E M=\\measuredangle L E M=\\measuredangle L A M=\\measuredangle S A M=\\measuredangle S P M=\\measuredangle Q P M=\\measuredangle Q N M=\\measuredangle T N M,\n\\]\nthat is, \\(T\\) lies in the circumcircle \\(\\omega\\) of \\(E M N\\). If \\(T=E\\), the same computation shows that \\(\\measuredangle L E M=\\measuredangle E N M\\), which means that \\(t\\) is tangent to \\(\\omega\\).\n\nNow let lines \\(M P\\) and \\(t\\) meet at \\(V\\). An analogous computation shows, by looking at the circumcircles of \\(L C D\\) (which contains \\(E\\) and \\(N\\) ), \\(C Q R\\), and \\(M N Q P\\), that \\(V\\) lies in \\(\\omega\\) as well, and that if \\(V=E\\) then \\(t\\) is tangent to \\(\\omega\\).\nTherefore, since \\(\\omega\\) meet \\(t\\) at \\(T, V\\), and \\(E\\), either \\(T=V\\) if both \\(T \\neq E\\) and \\(V \\neq E\\) or \\(T=V=E\\). At any rate, the intersection of lines \\(M P\\) and \\(N Q\\) lies in \\(t\\).\n\n\\section*{Solution 2}\n\nBarycentric coordinates are a viable way to solve the problem, but even the solution we have found had some clever computations. Here is an outline of this solution.\n\nLemma 2. Denote by \\(\\operatorname{pow}_{\\omega} X\\) the power of point \\(X\\) with respect to circle \\(\\omega\\). Let \\(\\Gamma_{1}\\) and \\(\\Gamma_{2}\\) be circles with different centers. Considering \\(A B C\\) as the reference triangle in barycentric coordinates, the radical axis of \\(\\Gamma_{1}\\) and \\(\\Gamma_{2}\\) is given by\n\\[\n\\left(\\operatorname{pow}_{\\Gamma_{1}} A-\\operatorname{pow}_{\\Gamma_{2}} A\\right) x+\\left(\\operatorname{pow}_{\\Gamma_{1}} B-\\operatorname{pow}_{\\Gamma_{2}} B\\right) y+\\left(\\operatorname{pow}_{\\Gamma_{1}} C-\\operatorname{pow}_{\\Gamma_{2}} C\\right) z=0 .\n\\]\n\nProof: Let \\(\\Gamma_{i}\\) have the equation \\(\\Gamma_{i}(x, y, z)=-a^{2} y z-b^{2} z x-c^{2} x y+(x+y+z)\\left(r_{i} x+s_{i} y+t_{i} z\\right)\\). Then \\(\\operatorname{pow}_{\\Gamma_{i}} P=\\Gamma_{i}(P)\\). In particular, \\(\\operatorname{pow}_{\\Gamma_{i}} A=\\Gamma_{i}(1,0,0)=r_{i}\\) and, similarly, \\(\\operatorname{pow}_{\\Gamma_{i}} B=s_{i}\\) and \\(\\operatorname{pow}_{\\Gamma_{i}} C=t_{i}\\).\nFinally, the radical axis is\n\\[\n\\begin{aligned}\n& \\operatorname{pow}_{\\Gamma_{1}} P=\\operatorname{pow}_{\\Gamma_{2}} P \\\\\n\\Longleftrightarrow & \\Gamma_{1}(x, y, z)=\\Gamma_{2}(x, y, z) \\\\\n\\Longleftrightarrow & r_{1} x+s_{1} y+t_{1} z=r_{2} x+s_{2} y+t_{2} z \\\\\n\\Longleftrightarrow & \\left(\\operatorname{pow}_{\\Gamma_{1}} A-\\operatorname{pow}_{\\Gamma_{2}} A\\right) x+\\left(\\operatorname{pow}_{\\Gamma_{1}} B-\\operatorname{pow}_{\\Gamma_{2}} B\\right) y+\\left(\\operatorname{pow}_{\\Gamma_{1}} C-\\operatorname{pow}_{\\Gamma_{2}} C\\right) z=0 .\n\\end{aligned}\n\\]\n\nWe still use the Miquel point \\(E\\) of \\(A B C D\\). Notice that the problem is equivalent to proving that lines \\(M P, N Q\\), and \\(E K\\) are concurrent. The main idea is writing these three lines as radical axes. In fact, by definition of points \\(M, N\\), and \\(E\\) :\n- \\(M P\\) is the radical axis of the circumcircles of \\(P A S\\) and \\(P B R\\);\n- \\(N Q\\) is the radical axis of the circumcircles of \\(Q C R\\) and \\(Q D S\\);\n- \\(E K\\) is the radical axis of the circumcircles of \\(K B C\\) and \\(K A D\\).\n\nLooking at these facts and the diagram, it makes sense to take triangle \\(K Q P\\) the reference triangle. Because of that, we do not really need to draw circles nor even points \\(M\\) and \\(N\\), as all powers can be computed directly from points in lines \\(K P, K Q\\), and \\(P Q\\).\n![](https://cdn.mathpix.com/cropped/2025_08_23_cf9a878261b0acb030afg-09.jpg?height=507&width=1035&top_left_y=2058&top_left_x=482)\n\nAssociate \\(P\\) with the \\(x\\)-coordinate, \\(Q\\) with the \\(y\\)-coordinate, and \\(K\\) with the \\(z\\)-coordinate. Applying the lemma, the equations of lines \\(P M, Q N\\), and \\(E K\\) are\n- \\(M P:(K A \\cdot K P-K B \\cdot K P) x+(Q S \\cdot Q P-Q R \\cdot Q P) y=0\\)\n- \\(N Q:(K C \\cdot K Q-K D \\cdot K Q) x+(P R \\cdot P Q-P S \\cdot P Q) z=0\\)\n- \\(M P:(-Q C \\cdot Q K+Q D \\cdot Q K) y+(P B \\cdot P K-P A \\cdot P K) z=0\\)\n\nThese equations simplify to\n- \\(M P:(A B \\cdot K P) x+(P Q \\cdot R S) y=0\\)\n- \\(N Q:(-C D \\cdot K Q) x+(P Q \\cdot R S) z=0\\)\n- \\(M P:(C D \\cdot K Q) y+(A B \\cdot K P) z=0\\)\n\nNow, if \\(u=A B \\cdot K P, v=P Q \\cdot R S\\), and \\(w=C D \\cdot K Q\\), it suffices to show that\n\\[\n\\left|\\begin{array}{ccc}\nu & v & 0 \\\\\n-w & 0 & v \\\\\n0 & w & u\n\\end{array}\\right|=0,\n\\]\nwhich is a straightforward computation.", "source_pdf": "apmo_2024.pdf", "notes": ""}
{"id": "APMO-2025-1", "contest": "APMO", "year": "2025", "problem_number": "1", "problem": "Let \\(A B C\\) be an acute triangle inscribed in a circle \\(\\Gamma\\). Let \\(A_{1}\\) be the orthogonal projection of \\(A\\) onto \\(B C\\) so that \\(A A_{1}\\) is an altitude. Let \\(B_{1}\\) and \\(C_{1}\\) be the orthogonal projections of \\(A_{1}\\) onto \\(A B\\) and \\(A C\\), respectively. Point \\(P\\) is such that quadrilateral \\(A B_{1} P C_{1}\\) is convex and has the same area as triangle \\(A B C\\). Is it possible that \\(P\\) strictly lies in the interior of circle \\(\\Gamma\\) ? Justify your answer.\n\nAnswer: No.", "solution": "\\section*{Solution}\n\nFirst notice that, since angles \\(\\angle A A_{1} B_{1}\\) and \\(\\angle A A_{1} C_{1}\\) are both right, the points \\(B_{1}\\) and \\(C_{1}\\) lie on the circle with \\(A A_{1}\\) as a diameter. Therefore, \\(A C_{1}=A A_{1} \\sin \\angle A A_{1} C_{1}=A A_{1} \\sin \\left(90^{\\circ}-\\right. \\left.\\angle A_{1} A C\\right)=A A_{1} \\sin \\angle C\\), similarly \\(A B_{1}=A A_{1} \\sin \\angle B\\), and \\(B_{1} C_{1}=A A_{1} \\sin \\angle A\\). Hence; triangles \\(A C_{1} B_{1}\\) and \\(A B C\\) are similar.\n![](https://cdn.mathpix.com/cropped/2025_08_23_c776d6401e128283d249g-1.jpg?height=672&width=601&top_left_y=936&top_left_x=696)\n\nLet \\(O\\) be the circumcenter of \\(A B C\\) and \\(A D\\) be one of its diameters. Since \\(\\angle O A C=\\frac{1}{2}\\left(180^{\\circ}-\\right. \\angle A O C)=90^{\\circ}-\\angle B=90^{\\circ}-\\angle A C_{1} B_{1}\\), it follows that \\(A D\\) is perpendicular to \\(B_{1} C_{1}\\). Let \\(A D=2 R\\); recall that, from the law of sines, \\(\\frac{B C}{\\sin \\angle A}=2 R \\Longleftrightarrow B C=2 R \\sin \\angle A\\). The area of quadrilateral \\(A B_{1} D C_{1}\\) is\n\\[\n\\frac{B_{1} C_{1} \\cdot A D}{2}=\\frac{A A_{1} \\sin \\angle A \\cdot 2 R}{2}=\\frac{A A_{1} \\cdot B C}{2},\n\\]\nwhich is indeed the area of \\(A B C\\).\nSince \\(B_{1}\\) and \\(C_{1}\\) are fixed points, the loci of the points \\(P\\) such that \\(A B_{1} P C_{1}\\) is a convex quadrilateral with the same area as \\(A B C\\) is a line parallel to \\(B_{1} C_{1}\\). That is, perpendicular to \\(A D\\). Since the area of \\(A B_{1} D C_{1}\\) is the same as the area of \\(A B C\\), this locus is the line perpendicular to \\(A D\\) through \\(D\\), which is tangent to the circumcircle of \\(A B C\\). Therefore, it is not possible that the point \\(P\\) lies inside the circumcircle of \\(A B C\\).", "source_pdf": "apmo_2025.pdf", "notes": ""}
{"id": "APMO-2025-2", "contest": "APMO", "year": "2025", "problem_number": "2", "problem": "Let \\(\\alpha\\) and \\(\\beta\\) be positive real numbers. Emerald makes a trip in the coordinate plane, starting off from the origin \\((0,0)\\). Each minute she moves one unit up or one unit to the right, restricting herself to the region \\(|x-y|<2025\\), in the coordinate plane. By the time she visits a point ( \\(x, y\\) ) she writes down the integer \\(\\lfloor x \\alpha+y \\beta\\rfloor\\) on it. It turns out that Emerald wrote each non-negative integer exactly once. Find all the possible pairs ( \\(\\alpha, \\beta\\) ) for which such a trip would be possible.\n\nAnswer: \\((\\alpha, \\beta)\\) such that \\(\\alpha+\\beta=2\\).", "solution": "\\section*{Solution}\n\nLet \\(\\left(x_{n}, y_{n}\\right)\\) be the point that Emerald visits after \\(n\\) minutes. Then \\(\\left(x_{n+1}, y_{n+1}\\right) \\in\\left\\{\\left(x_{n}+\\right.\\right. \\left.\\left.1, y_{n}\\right),\\left(x_{n}, y_{n}+1\\right)\\right\\}\\). Either way, \\(x_{n+1}+y_{n+1}=x_{n}+y_{n}+1\\), and since \\(x_{0}+y_{0}=0+0=0\\), \\(x_{n}+y_{n}=n\\).\nThe \\(n\\)-th number would be then\n\\[\nz_{n}=\\left\\lfloor x_{n} \\alpha+\\left(n-x_{n}\\right) \\beta\\right\\rfloor \\Longrightarrow n \\beta+x_{n}(\\alpha-\\beta)-1<z_{n}<n \\beta+x_{n}(\\alpha-\\beta),\n\\]\nin which\n\\[\n-2025<x_{n}-y_{n}<2025 \\Longleftrightarrow \\frac{n-2025}{2}<x_{n}<\\frac{n+2025}{2} .\n\\]\n\nSuppose without loss of generality that \\(\\alpha \\geq \\beta\\). Then\n\\[\nn \\beta+\\frac{n-2025}{2}(\\alpha-\\beta)-1<z_{n}<n \\beta+\\frac{n+2025}{2}(\\alpha-\\beta),\n\\]\nwhich reduces to\n\\[\n\\left|z_{n}-\\frac{\\alpha+\\beta}{2} n\\right|<\\frac{2025}{2}(\\alpha-\\beta)+1 .\n\\]\n\nOn the other hand, \\(z_{n+1}=\\left\\lfloor x_{n+1} \\alpha+y_{n+1} \\beta\\right\\rfloor \\in\\left\\{\\left\\lfloor x_{n} \\alpha+y_{n} \\beta+\\alpha\\right\\rfloor,\\left\\lfloor x_{n} \\alpha+y_{n} \\beta+\\beta\\right\\rfloor\\right\\}\\), which implies \\(z_{n+1} \\geq z_{n}\\). Since every non-negative integer appears exactly once, in increasing order, it follows that \\(z_{n}=n\\).\nTherefore, for all positive integers \\(n\\),\n\\[\n\\left|n-\\frac{\\alpha+\\beta}{2} n\\right|<\\frac{2025}{2}(\\alpha-\\beta)+1,\n\\]\nwhich can only be possible if \\(\\alpha+\\beta=2\\); otherwise, the left hand side would be unbounded. If \\(\\alpha+\\beta=2\\), consider \\(x_{n}=\\left\\lceil\\frac{n}{2}\\right\\rceil\\) and \\(y_{n}=\\left\\lfloor\\frac{n}{2}\\right\\rfloor\\). If \\(n\\) is even,\n\\[\nz_{n}=\\left\\lfloor\\frac{n}{2} \\alpha+\\frac{n}{2} \\beta\\right\\rfloor=n ;\n\\]\nif \\(n\\) is odd,\n\\[\nz_{n}=\\left\\lfloor\\frac{n+1}{2} \\alpha+\\frac{n-1}{2} \\beta\\right\\rfloor=n+\\left\\lfloor\\frac{\\alpha-\\beta}{2}\\right\\rfloor,\n\\]\nwhich equals \\(n\\) because \\(0<\\beta \\leq \\alpha<\\alpha+\\beta=2 \\Longrightarrow 0 \\leq \\alpha-\\beta<2\\).", "source_pdf": "apmo_2025.pdf", "notes": ""}
{"id": "APMO-2025-3", "contest": "APMO", "year": "2025", "problem_number": "3", "problem": "Let \\(P(x)\\) be a non-constant polynomial with integer coefficients such that \\(P(0) \\neq 0\\). Let \\(a_{1}, a_{2}, a_{3}, \\ldots\\) be an infinite sequence of integers such that \\(P(i-j)\\) divides \\(a_{i}-a_{j}\\) for all distinct positive integers \\(i, j\\). Prove that the sequence \\(a_{1}, a_{2}, a_{3}, \\ldots\\) must be constant, that is, \\(a_{n}\\) equals a constant \\(c\\) for all \\(n\\) positive integer.", "solution": "\\section*{Solution}\n\nLet \\(a_{0}=P(0) \\neq 0\\) be the independent coefficient, i.e., the constant term of \\(P(x)\\). Then there are infinitely many primes \\(p\\) such that \\(p\\) divides \\(P(k)\\) but \\(p\\) does not divide \\(k\\). In fact, since \\(P(k)-a_{0}\\) is a multiple of \\(k, \\operatorname{gcd}(P(k), k)=\\operatorname{gcd}\\left(k, a_{0}\\right) \\leq a_{0}\\) is bounded, so pick, say, \\(k\\) with prime factors each larger than \\(a_{0}\\).\nSince \\(P(k)\\) divides \\(a_{i+k}-a_{i}, p\\) divides \\(a_{i+k}-a_{i}\\). Moreover, since \\(P(k+p) \\equiv P(k) \\equiv 0(\\bmod p)\\), \\(p\\) also divides \\(a_{i+k+p}-a_{i}\\). Therefore, \\(a_{i} \\bmod p\\) is periodic with periods \\(k+p\\) and \\(k\\). By Bezout's theorem, \\(\\operatorname{gcd}(k+p, k)=1\\) is also a period, that is, \\(p\\) divides \\(a_{i+1}-a_{i}\\) for all \\(i\\) and \\(p\\) such that \\(p \\mid P(k)\\) and \\(p \\nmid k\\) for some \\(k\\). Since there are infinitely many such primes \\(p, a_{i+1}-a_{i}\\) is divisible by infinitely many primes, which implies \\(a_{i+1}=a_{i}\\), that is, the sequence is constant.", "source_pdf": "apmo_2025.pdf", "notes": ""}
{"id": "APMO-2025-4", "contest": "APMO", "year": "2025", "problem_number": "4", "problem": "Let \\(n \\geq 3\\) be an integer. There are \\(n\\) cells on a circle, and each cell is assigned either 0 or 1 . There is a rooster on one of these cells, and it repeats the following operations:\n- If the rooster is on a cell assigned 0 , it changes the assigned number to 1 and moves to the next cell counterclockwise.\n- If the rooster is on a cell assigned 1 , it changes the assigned number to 0 and moves to the cell after the next cell counterclockwise.\n\nProve that the following statement holds true after sufficiently many operations:\nIf the rooster is on a cell \\(C\\), then the rooster would go around the circle exactly three times, stopping again at \\(C\\). Moreover, every cell would be assigned the same number as it was assigned right before the rooster went around the circle 3 times.", "solution": "\\section*{Solution 1}\n\nReformulate the problem as a \\(n\\)-string of numbers in \\(\\{0,1\\}\\) and a position at which the action described in the problem is performed, and add 1 or 2 modulo \\(n\\) to the position according to the action. Say that a lap is complete for each time the position resets to 0 or 1 . We will prove that the statement claim holds after at most two laps, after which the \\(n\\)-tuple cycles every three laps.\nSay the rooster stops at a position in a certain lap if it performs an action at that position on that lap; otherwise, the rooster bypasses that position. We start with some immediate claims:\n- The rooster has to stop at at least one of each two consecutive positions.\n- The rooster stops at every position preceded by a 0 . Indeed, if the numbers preceding that position are 00 then the rooster will definitely stop at the second zero, and it the numbers preceding that position are 10 then the rooster will either stop at 1 and go directly to the position or bypass 1 and stop at the second zero, and then stop at the position.\n- Therefore, if the rooster bypasses a position, then it is preceded by a 1 , and that 1 must be changed to a 0 . This means that the rooster never bypasses a position in two consecutive laps.\n- The rooster bypasses every position preceded by 01 . Indeed, the rooster stops at either 1 or at 0 , after which it will move to 1 ; at any rate, it stops at 1 and bypasses the position.\n\nOur goal is to prove that, eventually, for every three consecutive laps, each position is bypassed exactly once. Then each position changes states exactly twice, so it gets back to its initial state after three laps. The following two lemmata achieve this goal:\n\nLemma 1. If the rooster stops at a certain position in two laps in a row, it bypasses it on the next lap, except for the \\(n\\)-string 1010 . . . 10, for which the problem statement holds.\n\nProof. If the rooster stopped at a position in lap \\(t\\), then it is preceded by either (A) a 0 that was changed to 1 , (B) a 11 that was changed to 01 , or (C) a 10 in which the rooster stopped at 1 . In case (A), the position must be preceded by 11 in the lap \\(t+1\\), which becomes 01 , so the rooster will bypass the position in the lap \\(t+2\\). In case (B), the position will be bypassed in lap \\(t+1\\).\nNow we deal with case ( C ): suppose that the position was preceded by \\(m\\) occurrences of 10 , that is, \\((10)^{m}\\), on lap \\(t\\) and take \\(m \\leq \\frac{n}{2}\\) maximal. The rooster stopped at the 1 from each occurrence of 10 , except possibly the first one.\n\nFirst, suppose that \\(n \\geq 2 m+2\\). After lap \\(t,(10)^{m}\\) becomes either \\((00)^{m}\\) or \\(11(00)^{m-1}\\) in lap \\(t+1\\). In the latter case, initially we had \\(1(10)^{m}\\), which became \\(011(00)^{m-1}\\). It will then become \\(a 01(11)^{m-1}\\) in lap \\(t+2\\), in which the rooster will bypass the position. In the former case, \\((10)^{m}\\) becomes \\((00)^{m}\\), so it was either \\(00(10)^{m}\\) or \\(11(10)^{m}\\) in lap \\(t\\), which becomes respectively \\(a 1(00)^{m}\\) and \\(01(00)^{m}\\) in lap \\(t+1\\), respectively. In the second sub-case, it becomes \\(b 001(11)^{m-1}\\) in lap \\(t+2\\), and the position will be bypassed. In the first sub-case, it must be \\(11(00)^{m}\\) after which it becomes either \\(01(11)^{m}\\) or \\(1001(11)^{m-1}\\). In any case, the position will be bypassed in lap \\(t+2\\). If \\(n=2 m+1\\), the possible configurations are\n\\[\n(10)^{m} 0 \\rightarrow(00)^{m} 1 \\rightarrow(11)^{m} 0 \\rightarrow(10)^{m} 0\n\\]\nthe rooster stops at the 1 from the first 10 because it was preceded by a 0 .\n\\[\n(10)^{m} 1 \\rightarrow(00)^{m} 0 \\rightarrow 0(11)^{m} \\rightarrow 1(01)^{m}\n\\]\nor\n\\[\n(10)^{m} 1 \\rightarrow 11(00)^{m-1} 0 \\rightarrow 01(11)^{m-1} 1 \\rightarrow(10)^{m} 1\n\\]\n\nIn any case, the position is bypassed in lap \\(t+2\\).\nIf \\(n=2 m\\), the entire configuration is \\((10)^{m}, m \\geq 2\\). If the rooster did not stop at the first 1 , it becomes \\(11(00)^{m-1}\\) in the lap \\(t+1\\), then \\(01(11)^{m-1}\\) in the lap \\(t+2\\), so the position is bypassed in this last lap. If the rooster stopped at the first 1 , it becomes \\((00)^{m}\\), then \\((11)^{m}\\), then \\((01)^{m}\\), then \\(10(00)^{m-1}\\), then \\((11)^{m}\\), and then it cycles between \\((11)^{m},(01)^{m}\\) and \\(10(00)^{m-1}\\).\nSo, apart from this specific string, the rooster will stop at most two laps in a row at each position.\n\nLemma 2. If the rooster bypasses one position on a lap, then it stops at that position on the next two laps, with the same exception as lemma 1.\n\nProof. The position must be preceded by 1 in lap \\(t\\). If it is preceded by 11 , it changes to 10 in lap \\(t+1\\). Then it becomes 00 because the 1 was already skipped in the previous lap, and the rooster will stop at the position in the lap \\(t+2\\).\nNow suppose that the position was preceded by \\((01)^{m}\\) on lap \\(t\\) and take \\(m \\leq \\frac{n}{2}\\) maximal. It becomes \\(10(00)^{m-1}\\) or \\((00)^{m}\\) in lap \\(t+1\\). In the former case, in lap \\(t+2\\) it becomes either \\(00(11)^{m-1}\\), after which the rooster stops at the position again, or \\((11)^{m}\\), which we'll study later. In the former case, \\((00)^{m}\\) becomes \\((11)^{m}\\) or \\(01(11)^{m-1}\\). In the latter case, the 0 was bypassed, so it must be sopped in the next lap, becoming \\((10)^{m}\\). In the \\((11)^{m}\\) case, in order to bypass the position in lap \\(t+2\\), it must become \\((10)^{m}\\). All in all, the preceding terms are \\((01)^{m}\\). Then, either \\(10(00)^{m-1}\\) or \\((00)^{m}\\), then either \\((11)^{m}\\) or \\(01(11)^{m-1}\\), then \\((10)^{m}\\). Then the second term in \\((01)^{m}\\) is 1 , then 0 , then 1 , and then 0 , that is, it changed three times. So we fall under the exception to lemma 1.\n\nThe result then immediately follows from lemmata 1 and 2 .\n\n\\section*{Solution 2}\n\nDefine positions, laps, stoppings, and bypassing as in Solution 1. This other pair of lemmata also solves the problem.\n\nLemma 3. There is a position and a lap in which the rooster stops twice and bypasses once (in some order) in the next three laps.\n\nProof. There is a position \\(j\\) the rooster stops for infinitely many times. Each time it stops at \\(j\\), it changes between stopping and bypassing \\(j+1\\). So the rooster stops and bypasses \\(j+1\\) infinitely many times. Then there is a lap in which the rooster stops at \\(j+1\\), and bypasses it in the next. As in solution 1 , it cannot bypass \\(j+1\\) two times in a row, so it stops at \\(j+1\\) in the next lap.\n\nLemma 4. If the rooster stops twice and bypasses once (in some order) at some position in three consecutive laps, it also stops twice and bypasses once at the next position (in some order) in the same laps (or in the next laps, in case the lap changes from one position to the other).\n\nProof. When the rooster bypasses the position, it must stop at the next one. In the two times it stops at the position, the cell has different numbers on it, so the rooster will stop once and bypass once at the next position.\n\nBy lemmata 3 and 4, there would be a moment that the rooster stops twice and bypasses once (in some order) at any position after this moment. After this moment, if the rooster is in a cell \\(C\\) in lap \\(t\\), we know that it stopped; stopped-bypassed; and bypassed-stopped at \\(C\\) in laps \\(t, t+1, t+2\\). Since it stopped twice and bypassed once (in some order) in laps \\(t+1, t+2, t+3\\), it must stop at \\(C\\) in lap \\(t+3\\). Moreover, the rooster stopped twice and bypassed once (in some order) each cell between stopping at \\(C\\) in laps \\(t\\) and \\(t+3\\), so every cell has the same assigned number before and after going around the circle three times.\n\n\\section*{Solution 3}\n\nLet us reformulate the problem in terms of Graphs: we have a directed graph \\(G\\) with \\(V= \\left\\{v_{1}, v_{2}, \\ldots, v_{n}\\right\\}\\) representing positions and \\(E=\\left\\{v_{i} \\rightarrow v_{i+1}, v_{i} \\rightarrow v_{i+2} \\mid 1 \\leq i \\leq n\\right\\}\\) representing moves. Indices are taken \\(\\bmod n\\). Note that each vertex has in-degree and out-degree both equal to 2 . We say that the edge \\(v_{i} \\rightarrow v_{i+1}\\) is active and \\(v_{i} \\rightarrow v_{i+2}\\) is inactive if the number on \\(v_{i}\\) is 0 , or the edge \\(v_{i} \\rightarrow v_{i+2}\\) is active and \\(v_{i} \\rightarrow v_{i+1}\\) is inactive if the number on \\(v_{i}\\) is 1 . The rooster then traces an infinite trail on the graph in the following manner;\n- it starts at \\(v_{1}\\);\n- if the rooster is at \\(v_{i}\\), it uses the active edge going out of \\(v_{i}\\) to continue the path, and changes the number on \\(v_{i}\\).\n\nTake the first vertex that appears 3 times on the rooster's trail, and suppose without any loss of generality that it is \\(v_{1}\\) (otherwise, just ignore the path before the first time that this vertex appears). Consider the sub-trail from the first to the third time \\(v_{1}\\) appears: \\(C=v_{1} \\rightarrow \\cdots \\rightarrow v_{1} \\rightarrow \\cdots \\rightarrow v_{1}\\). Trail \\(C\\) induces a circuit \\(C^{*}\\) on \\(G\\) that passes through \\(v_{1}\\) twice.\nIn between two occurrences of \\(v_{1}\\), the rooster must have completed at least one lap. Vertex \\(v_{1}\\) appears three times at \\(C\\), so \\(C\\) contains at least two laps. Since (as per Solution 1) no vertex is bypassed twice in a row, \\(C^{*}\\) must contain every vertex. Moreover, \\(v_{1}\\) is the first (and only) vertex that appeared three times on the rooster's path, so each vertex appear at most twice on \\(C^{*}\\).\n\nLemma 5. Take \\(V^{\\prime}\\) to be the subset of \\(V\\) containing the vertices that only appears once on \\(C^{*}\\) and \\(E^{\\prime}\\) to be the edges of \\(G\\) that don't appear on \\(C^{*}\\). So \\(G^{\\prime}=\\left(V^{\\prime}, E^{\\prime}\\right)\\) is a simple cycle or \\(V^{\\prime}=E^{\\prime}=\\emptyset\\).\n\nProof. We will first prove that each edge in \\(C^{*}\\) appears exactly one. Suppose, for the sake of contradiction, that there is an edge \\(u \\rightarrow v\\) that appears twice on \\(C^{*}\\). So \\(u\\) must appear times in \\(C\\), because the active edge going out of \\(u\\) changes at each visit to it. So \\(u=v_{1}\\), but the rooster only goes out of \\(v_{1}\\) twice in \\(C\\), which is a contradiction.\nNow, since \\(C^{*}\\) does not have repeated edges, all four edges through \\(v\\) are in \\(C^{*}\\) if \\(v\\) is visited twice in this cycle. So the edges on \\(E^{\\prime}\\) cannot pass through vertices in \\(V \\backslash V^{\\prime}\\), then \\(G^{\\prime}\\) is well-defined.\nSince \\(v \\in V^{\\prime}\\) is visited once on \\(C^{*}\\), it has \\(\\operatorname{deg}_{\\text {in }}(v)=\\operatorname{deg}_{\\text {out }}(v)=1\\) in \\(G^{\\prime}\\), so \\(G^{\\prime}\\) is a union of disjoint simple cycles. Each of these cycles completes at least one lap, and \\(v_{1}\\) is skipped on these laps, so all cycles must use the edge \\(v_{n} \\rightarrow v_{2}\\). But the cycles are disjoint, so there is at most one cycle.\n\nLemma 6. The rooster eventually traverses a contiguous Eulerian circuit of \\(G\\).\n\nProof. If \\(V^{\\prime}=E^{\\prime}=\\emptyset, C^{*}\\) is already an Eulerian circuit traversed in \\(C\\). If not, take \\(u_{1}\\) to be the first vertex of \\(C\\) that is in \\(V^{\\prime}\\). Let \\(U=u_{1} \\rightarrow \\cdots \\rightarrow u_{k} \\rightarrow u_{1}\\) be the cycle determined by \\(G^{\\prime}\\) by Lemma 5, \\(C_{1}=v_{1} \\rightarrow \\cdots \\rightarrow u_{1}\\) be the sub-path of \\(C\\) from the first \\(v_{1}\\) to \\(u_{1}\\), and \\(C_{2}=u_{1} \\rightarrow \\cdots \\rightarrow v_{1}\\) be the rest of \\(C\\).\nEach vertex on \\(V \\backslash V^{\\prime}\\) has been changed twice, so they would be in their initial states after \\(C\\); every vertex on \\(V^{\\prime}\\) has been changed only once, and therefore are not on their initial states. Let us trace the rooster's trail after it traversed \\(C\\). By the minimality of \\(u_{1}\\), all the edges of \\(C_{1}\\) are active after \\(C\\), so the rooster traverses \\(C_{1}\\) after \\(C\\). Moreover, each \\(u_{i}\\) was visited exactly once in \\(C\\) and has not yet used the edge \\(u_{i} \\rightarrow u_{i+1}\\). Since all their states have changed, all edges of \\(U\\) are active after \\(C\\). Therefore, the rooster traverse \\(U\\) after \\(C_{1}\\), flipping all the vertices in \\(U\\) to their initial states. Then, since every state in \\(U\\) was changed, the rooster traverses \\(C_{2}\\) instead of \\(U\\). The trail is then \\(C \\rightarrow C_{1} \\rightarrow U \\rightarrow C_{2}\\), and hen \\(C_{1} \\rightarrow U \\rightarrow C_{2}\\) is an Eulerian circuit.\n\nHaving this in mind, after the rooster completes an Eulerian circuit, it has passed through each vertex twice and returned to its initial vertex, so the state of the rooster and of the edges are the same before and after the Eulerian cycle. The rooster will then traverse the Eulerian circuit repeatedly.\nThe edges \\(v_{i} \\rightarrow v_{i+1}\\) move forward by one position and the edges \\(v_{i} \\rightarrow v_{i+2}\\) move forward by two positions. Since all edges are used, each time the rooster traverses the Eulerian circuit, it moves forward a total of \\(n(1+2)=3 n\\) positions, which corresponds to three laps. The proof is now complete.\n\nComment: Solution 1 presents a somewhat brute-force case analysis; the main ideas are\n- Lemma 1: The rooster stops at one position in at most two consecutive laps, with one notable exception.\n- Lemma 2: If the rooster bypasses one position then it stops at it in the next two laps, with the same notable exception.\n\nSolution 2 has a recursive nature; the main ideas are\n- Lemma 3: Proving that one position changes states exactly two out of three laps.\n- Lemma 4: Given that this happens to one position, it also happens to the next position in the same laps, so it happens to every position.\n\nSolution 3 cleverly identifies the moves the rooster performs within a graph theoretical framework. The main goal is to prove that the rooster traces an Eulerian circuit in a graph.\n- Lemma 5: Analyzing what happens after the rooster first visits a position three times.\n- Lemma 6: Proving that the rooster traces an Eulerian circuit.", "source_pdf": "apmo_2025.pdf", "notes": ""}
{"id": "APMO-2025-5", "contest": "APMO", "year": "2025", "problem_number": "5", "problem": "Consider an infinite sequence \\(a_{1}, a_{2}, \\ldots\\) of positive integers such that\n\\[\n100!\\left(a_{m}+a_{m+1}+\\cdots+a_{n}\\right) \\quad \\text { is a multiple of } \\quad a_{n-m+1} a_{n+m}\n\\]\nfor all positive integers \\(m, n\\) such that \\(m \\leq n\\).\nProve that the sequence is either bounded or linear.\nObservation: A sequence of positive integers is bounded if there exists a constant \\(N\\) such that \\(a_{n}<N\\) for all \\(n \\in \\mathbb{Z}_{>0}\\). A sequence is linear if \\(a_{n}=n \\cdot a_{1}\\) for all \\(n \\in \\mathbb{Z}_{>0}\\).", "solution": "\\section*{Solution}\n\nLet \\(c=100\\) !. Suppose that \\(n \\geq m+2\\). Then \\(a_{m+n}=a_{(m+1)+(n-1)}\\) divides both \\(c\\left(a_{m}+a_{m+1}+\\right. \\left.\\cdots+a_{n-1}+a_{n}\\right)\\) and \\(c\\left(a_{m+1}+\\cdots+a_{n-1}\\right)\\), so it also divides the difference \\(c\\left(a_{m}+a_{n}\\right)\\). Notice that if \\(n=m+1\\) then \\(a_{m+n}\\) divides \\(c\\left(a_{m}+a_{m+1}\\right)=c\\left(a_{m}+a_{n}\\right)\\), and if \\(n=m\\) then \\(a_{m+n}\\) divides both \\(c a_{m}\\) and \\(2 c a_{m}=c\\left(a_{m}+a_{n}\\right)\\). In either cases; \\(a_{m+n}\\) divides \\(c\\left(a_{m}+a_{n}\\right)\\).\nAnalogously, one can prove that if \\(m>n, a_{m-n}=a_{(m-1)-(n-1)}\\) divides \\(c\\left(a_{m}-a_{n}\\right)\\), as it divides both \\(c\\left(a_{n+1}+\\cdots+a_{m}\\right)\\) and \\(c\\left(a_{n}+\\cdots+a_{m-1}\\right)\\).\nFrom now on, drop the original divisibility statement and keep the statements \" \\(a_{m+n}\\) divides \\(c\\left(a_{m}+a_{n}\\right)\\) \" and \" \\(a_{m-n}\\) divides \\(c\\left(a_{m}-a_{n}\\right)\\).\" Now, all conditions are linear, and we can suppose without loss of generality that there is no integer \\(D>1\\) that divides every term of the sequence; if there is such an integer \\(D\\), divide all terms by \\(D\\).\nHaving this in mind, notice that \\(a_{m}=a_{m+n-n}\\) divides \\(c\\left(a_{m+n}-a_{n}\\right)\\) and also \\(c\\left(a_{m+n}-a_{m}-a_{n}\\right)\\); analogously, \\(a_{n}\\) also divides \\(c\\left(a_{m+n}-a_{m}-a_{n}\\right)\\), and since \\(a_{m+n}\\) divides \\(c\\left(a_{m}+a_{n}\\right)\\), it also divides \\(c\\left(a_{m+n}-a_{m}-a_{n}\\right)\\). Therefore, \\(c\\left(a_{m+n}-a_{m}-a_{n}\\right)\\) is divisible by \\(a_{m}, a_{n}\\), and \\(a_{m+n}\\), and therefore also by \\(\\operatorname{lcm}\\left(a_{m}, a_{n}, a_{m+n}\\right)\\). In particular, \\(c a_{m+n} \\equiv c\\left(a_{m}+a_{n}\\right)\\left(\\bmod \\operatorname{lcm}\\left(a_{m}, a_{n}\\right)\\right)\\).\nSince \\(a_{m+n}\\) divides \\(c\\left(a_{m}+a_{n}\\right), a_{m+n} \\leq c\\left(a_{m}+a_{n}\\right)\\).\nFrom now on, we divide the problem in two cases.\nCase 1: there exist \\(m, n\\) such that \\(\\operatorname{lcm}\\left(a_{m}, a_{n}\\right)>c^{2}\\left(a_{m}+a_{n}\\right)\\).\nIf \\(\\operatorname{lcm}\\left(a_{m}, a_{n}\\right)>c^{2}\\left(a_{m}+a_{n}\\right)>c\\left(a_{m}+a_{n}\\right)\\) then both \\(c\\left(a_{m}+a_{n}\\right)\\) and \\(c a_{m+n}\\) are less than \\(c a_{m+n} \\leq c^{2}\\left(a_{m}+a_{n}\\right)<\\operatorname{lcm}\\left(a_{m}, a_{n}\\right)\\). This implies \\(c a_{m+n}=c\\left(a_{m}+a_{n}\\right) \\Longleftrightarrow a_{m+n}=a_{m}+a_{n}\\). Now we can extend this further: since \\(\\operatorname{gcd}\\left(a_{m}, a_{m+n}\\right)=\\operatorname{gcd}\\left(a_{m}, a_{m}+a_{n}\\right)=\\operatorname{gcd}\\left(a_{m}, a_{n}\\right)\\), it follows that\n\\[\n\\begin{aligned}\n\\operatorname{lcm}\\left(a_{m}, a_{m+n}\\right) & =\\frac{a_{m} a_{m+n}}{\\operatorname{gcd}\\left(a_{m}, a_{n}\\right)}=\\frac{a_{m+n}}{a_{n}} \\operatorname{lcm}\\left(a_{m}, a_{n}\\right)>\\frac{c^{2}\\left(a_{m}+a_{n}\\right)^{2}}{a_{n}} \\\\\n& >\\frac{c^{2}\\left(2 a_{m} a_{n}+a_{n}^{2}\\right)}{a_{n}}=c^{2}\\left(2 a_{m}+a_{n}\\right)=c^{2}\\left(a_{m}+a_{m+n}\\right)\n\\end{aligned}\n\\]\n\nWe can iterate this reasoning to obtain that \\(a_{k m+n}=k a_{m}+a_{n}\\), for all \\(k \\in \\mathbb{Z}_{>0}\\). In fact, if the condition \\(\\operatorname{lcm}\\left(a_{m}, a_{n}\\right)>c^{2}\\left(a_{m}+a_{n}\\right)\\) holds for the pair ( \\(n, m\\) ), then it also holds for the pairs \\((m+n, m),(2 m+n, m), \\ldots,((k-1) m+n, m)\\), which implies \\(a_{k m+n}=a_{(k-1) m+n}+a_{m}= a_{(k-2) m+n}+2 a_{m}=\\cdots=a_{n}+k a_{m}\\).\nSimilarly, \\(a_{m+k n}=a_{m}+k a_{n}\\).\nNow, \\(a_{m+n+m n}=a_{n+(n+1) m}=a_{m+(m+1) n} \\Longrightarrow a_{n}+(n+1) a_{m}=a_{m}+(m+1) a_{n} \\Longleftrightarrow m a_{n}= n a_{m}\\). If \\(d=\\operatorname{gcd}(m, n)\\) then \\(\\frac{n}{d} a_{m}=\\frac{m}{d} a_{n}\\).\nTherefore, since \\(\\operatorname{gcd}\\left(\\frac{m}{d}, \\frac{n}{d}\\right)=1, \\frac{m}{d}\\) divides \\(a_{m}\\) and \\(\\frac{n}{d}\\) divides \\(a_{n}\\), which means that\n\\[\na_{n}=\\frac{m}{d} \\cdot t=\\frac{t}{d} m \\quad \\text { and } \\quad a_{m}=\\frac{n}{d} \\cdot t=\\frac{t}{d} n, \\quad \\text { for some } t \\in \\mathbb{Z}_{>0}\n\\]\nwhich also implies\n\\[\na_{k m+n}=\\frac{t}{d}(k m+n) \\quad \\text { and } \\quad a_{m+k n}=\\frac{t}{d}(m+k n), \\quad \\text { for all } k \\in \\mathbb{Z}_{>0} .\n\\]\n\nNow let's prove that \\(a_{k d}=t k=\\frac{t}{d}(k d)\\) for all \\(k \\in \\mathbb{Z}_{>0}\\). In fact, there exist arbitrarily large positive integers \\(R, S\\) such that \\(k d=R m-S n=(n+(R+1) m)-(m+(S+1) n)\\) (for instance, let \\(u, v \\in \\mathbb{Z}\\) such that \\(k d=m u-n v\\) and take \\(R=u+Q n\\) and \\(S=v+Q m\\) for \\(Q\\) sufficiently large.)\nLet \\(x=n+(R+1) m\\) and \\(y=m+(S+1) n\\). Then \\(k d=x-y \\Longleftrightarrow x=y+k d, a_{x}=\\frac{t}{d} x\\), and \\(a_{y}=\\frac{t}{d} y=\\frac{t}{d}(x-k d)=a_{x}-t k\\). Thus \\(a_{x}\\) divides \\(c\\left(a_{y}+a_{k d}\\right)=c\\left(a_{k d}+a_{x}-t k\\right)\\), and therefore also \\(c\\left(a_{k d}-t k\\right)\\). Since \\(a_{x}=\\frac{t}{d} x\\) can be arbitrarily large, \\(a_{k d}=t k=\\frac{t}{d}(k d)\\). In particular, \\(a_{d}=t\\), so \\(a_{k d}=k a_{d}\\).\nSince \\(k a_{d}=a_{k d}=a_{1+(k d-1)}\\) divides \\(c\\left(a_{1}+a_{k d-1}\\right), b_{k}=a_{k d-1}\\) is unbounded. Pick \\(p>a_{k d-1}\\) a large prime and consider \\(a_{p d}=p a_{d}\\). Then\n\\[\n\\operatorname{lcm}\\left(a_{p d}, a_{k d-1}\\right) \\geq \\operatorname{lcm}\\left(p, a_{k d-1}\\right)=p a_{k d-1}\n\\]\n\nWe can pick \\(a_{k d-1}\\) and \\(p\\) large enough so that their product is larger than a particular linear combination of them, that is,\n\\[\n\\operatorname{lcm}\\left(p, a_{k d-1}\\right)=p a_{k d-1}>c^{2}\\left(p a_{d}+a_{k d-1}\\right)=c^{2}\\left(a_{p d}+a_{k d-1}\\right)\n\\]\n\nThen all the previous facts can be applied, and since \\(\\operatorname{gcd}(p d, k d-1)=1, a_{k}=a_{k \\operatorname{gcd}(p d, k d-1)} =k a_{\\operatorname{gcd}(p d, k d-1)}=k a_{1}\\), that is, the sequence is linear. Also, since \\(a_{1}\\) divides all terms, \\(a_{1}=1\\).\nCase 2: \\(\\operatorname{lcm}\\left(a_{m}, a_{n}\\right) \\leq c^{2}\\left(a_{m}+a_{n}\\right)\\) for all \\(m, n\\).\nSuppose that \\(a_{m} \\leq a_{n}\\); then \\(\\operatorname{lcm}\\left(a_{m}, a_{n}\\right)=M a_{n} \\leq c^{2}\\left(a_{m}+a_{n}\\right) \\leq 2 c^{2} a_{n} \\Longrightarrow M \\leq 2 c^{2}\\), that is, the factor in the smaller term that is not in the larger term is at most \\(2 c^{2}\\).\nWe prove that in this case the sequence must be bounded. Suppose on the contrary; then there is a term \\(a_{m}\\) that is divisible by a large prime power \\(p^{d}\\). Then every larger term \\(a_{n}\\) is divisible by a factor larger than \\(\\frac{p^{d}}{2 c^{2}}\\). So we pick \\(p^{d}>\\left(2 c^{2}\\right)^{2}\\), so that every large term \\(a_{n}\\) is divisible by the prime power \\(p^{e}>2 c^{2}\\). Finally, fix \\(a_{k}\\) for any \\(k\\). It follows from \\(a_{k+n} \\mid c\\left(a_{k}+a_{n}\\right)\\) that \\(\\left(a_{n}\\right)\\) is unbounded, so we can pick \\(a_{n}\\) and \\(a_{k+n}\\) large enough such that both are divisible by \\(p^{e}\\). Hence any \\(a_{k}\\) is divisible by \\(p\\), which is a contradiction to the fact that there is no \\(D>1\\) that divides every term in the sequence.", "source_pdf": "apmo_2025.pdf", "notes": ""}
{"id": "EGMO-2022-1", "contest": "EGMO", "year": "2022", "problem_number": "1", "problem": "Let \\(A B C\\) be an acute-angled triangle in which \\(B C<A B\\) and \\(B C<C A\\). Let point \\(P\\) lie on segment \\(A B\\) and point \\(Q\\) lie on segment \\(A C\\) such that \\(P \\neq B, Q \\neq C\\) and \\(B Q=B C=C P\\). Let \\(T\\) be the circumcentre of triangle \\(A P Q, H\\) the orthocentre of triangle \\(A B C\\), and \\(S\\) the point of intersection of the lines \\(B Q\\) and \\(C P\\). Prove that \\(T, H\\) and \\(S\\) are collinear.", "solution": "We show that \\(T\\) and \\(H\\) are both on the angle bisector \\(\\ell\\) of \\(\\angle B S C\\). We first prove that \\(H \\in \\ell\\). The altitude \\(C H\\) in triangle \\(A B C\\) is also the altitude in isosceles triangle \\(P B C\\) with \\(C P=C B\\). Therefore, \\(C H\\) is also the angle bisector of \\(\\angle P C B\\) and hence also of \\(\\angle S C B\\). Analogously, \\(B H\\) is the angle bisector of \\(\\angle S B C\\). We conclude that \\(H\\), as the intersection of two angle bisectors of \\(\\triangle B S C\\), is also on the third angle bisector, which is \\(\\ell\\). We now prove that \\(T \\in \\ell\\). Variant 1. In the isosceles triangles \\(\\triangle B C P\\) and \\(\\triangle C B Q\\) we see that \\(\\angle B C P=180^{\\circ}-2 \\angle B\\) and \\(\\angle C B Q=180^{\\circ}-2 \\angle C\\). This yields \\(\\angle P S Q=\\angle B S C=180^{\\circ}-\\left(180^{\\circ}-2 \\angle B\\right)-\\left(180^{\\circ}-2 \\angle C\\right)= 180^{\\circ}-2 \\angle A\\). Furthermore, \\(\\angle P T Q=2 \\angle P A Q=2 \\angle A\\) ( \\(T\\) being circumcentre of \\(\\triangle A P Q\\) ). Now \\(\\angle P T Q+\\angle P S Q=180^{\\circ}\\), so \\(P T Q S\\) is a cyclic quadrilateral. From \\(P T=T Q\\) we then obtain that \\(\\angle P S T=\\angle P Q T=\\angle Q P T=\\angle Q S T\\), so \\(T\\) is on the angle bisector \\(\\angle P S Q\\), which is also \\(\\ell\\). We conclude that \\(T, S\\) and \\(H\\) are collinear. Variant 2. Let \\(R\\) be the second intersection of \\(B Q\\) and \\(\\odot A P Q\\). \\(A P R Q\\) is cyclic quadrilateral, so \\(\\angle P R S=\\angle A, \\angle A P R=\\angle B Q C=\\angle C\\). On the other hand \\(\\angle B P C=\\angle B\\). Therefore \\(\\angle R P S=180^{\\circ}-\\angle B-\\angle C=\\angle A\\). Hence, the triangle \\(P R S\\) is isosceles with \\(S P=S R\\); then \\(\\ell\\) is the perpendicular bisector of the chord \\(P R\\) in the circle that passes through \\(T\\). Note that if \\(B Q\\) is tangent to \\(\\odot A P Q\\), then \\(C P\\) is also tangent to \\(\\odot A P Q\\) and triangle \\(A B C\\) is isosceles, so \\(T, S\\) and \\(H\\) lie on the altitude from \\(A\\). Remark. The fact that \\(C P\\) is also tangent to \\(\\odot A P Q\\) could be shown with \\(P T Q S\\) beeing a cyclic quadrilateral like in the first variant of the solution. Otherwise we can consider \\(R\\) the second intersection of \\(C P\\) and \\(\\odot A P Q\\) and prove that triangle \\(Q R S\\) is isosceles. In the same way as in the previous solution, we see that \\(\\angle P S Q=180^{\\circ}-2 \\angle A\\), so \\(\\angle C S Q=2 \\angle A\\). From the cyclic quadrilateral \\(A E H D\\) (with \\(E\\) and \\(D\\) feet of the altitudes \\(C H\\) and \\(B H\\) ) we see that \\(\\angle D H C=\\angle D A E=\\angle A\\). Since \\(B H\\) is the perpendicular bisector of \\(C Q\\), we have \\(\\angle D H Q=\\angle A\\) as well, so \\(\\angle C H Q=2 \\angle A\\). From \\(\\angle C H Q=2 \\angle A=\\angle C S Q\\), we see \\(C H S Q\\) is a cyclic quadrilateral. This means \\(\\angle Q H S=\\angle Q C S\\). Since triangles \\(P T Q\\) and \\(C H Q\\) are both isosceles with apex \\(2 \\angle A\\), we get \\(\\triangle P T Q \\sim \\triangle C H Q\\). We see that one can be obtained from the other by a spiral similarity centered at \\(Q\\), so we also obtain \\(\\triangle Q T H \\sim \\triangle Q P C\\). This means that \\(\\angle Q H T=\\angle Q C P\\). Combining this with \\(\\angle Q H S=\\angle Q C S\\), we see that \\(\\angle Q H T=\\angle Q C P=\\angle Q C S=\\angle Q H S\\). So \\(\\angle Q H T=\\angle Q H S\\), which means that \\(T, S\\) and \\(H\\) are collinear. Let us draw a parallel \\(f\\) to \\(B C\\) through \\(A\\). Let \\(B^{\\prime}=B Q \\cap f, C^{\\prime}=C P \\cap f\\). Then \\(A Q B^{\\prime} \\sim C Q B\\) and \\(A P C^{\\prime} \\sim B P C\\), therefore both \\(Q A B^{\\prime}\\) and \\(A P C^{\\prime}\\) will be isosceles. Also, \\(B C S \\sim B^{\\prime} C^{\\prime} S\\) with respect to the similarity with center \\(S\\), therefore if we take the image of the line \\(B H\\) (which is the perpendicular bisector of the segment \\(C Q\\) ) through this transformation, it will go through the point \\(B^{\\prime}\\), and be perpendicular to \\(A Q\\) (as the image of \\(C Q\\) is parallel to \\(C Q\\) ). As \\(A Q B^{\\prime}\\) is isosceles, this line is the perpendicular bisector of the segment \\(A Q\\). This means it goes through \\(T\\), the circumcenter of \\(A P Q\\). Similarly on the other side the image of \\(C H\\) also goes through \\(T\\). This means that the image of \\(H\\) with respect to the similarity though \\(S\\) will be \\(T\\), so \\(T, S, H\\) are collinear.", "source_pdf": "egmo_2022.pdf", "notes": ""}
{"id": "EGMO-2022-2", "contest": "EGMO", "year": "2022", "problem_number": "2", "problem": "Let \\(\\mathbb{N}=\\{1,2,3, \\ldots\\}\\) be the set of all positive integers. Find all functions \\(f: \\mathbb{N} \\rightarrow \\mathbb{N}\\) such that for any positive integers \\(a\\) and \\(b\\), the following two conditions hold: (1) \\(f(a b)=f(a) f(b)\\), and (2) at least two of the numbers \\(f(a), f(b)\\) and \\(f(a+b)\\) are equal.", "solution": "Answer: \\(\\quad f(n)=a^{v_{p}(n)}\\), where \\(a \\in \\mathbb{N}, p\\) is a prime and \\(v_{p}(n)\\) is the largest exponent of \\(p\\) dividing \\(n\\). Solution 1. First, all such functions \\(f\\) satisfy the conditions, as \\(v_{p}(a) \\neq v_{p}(b)\\) implies \\(v_{p}(a+b)= \\min \\left(v_{p}(a), v_{p}(b)\\right)\\). Plugging \\(a, b=1\\) into (1) gives \\(f(1)=1\\). Also, a simple induction gives that \\(f\\left(\\prod_{i=1}^{k} p_{i}^{a_{i}}\\right)=\\prod_{i=1}^{k} f\\left(p_{i}\\right)^{a_{i}}\\). Let \\(S\\) be the set of all primes \\(p\\) such that \\(f(p) \\neq 1\\). If \\(|S|=1\\), then \\(S=\\{p\\}\\) and \\(f(p)=a\\) for some \\(a \\neq 1\\), and thus \\(f(n)=a^{v_{p}(n)}\\) for all \\(n\\). If \\(S=\\emptyset\\) then \\(f(n)=1\\) for all \\(n\\), which can be also written in the above form for \\(a=1\\). Now suppose that \\(S\\) contains at least two primes. Let \\(p<q\\) be the two smallest elements of \\(S\\). Since all prime divisors of \\(q-p\\) are smaller than \\(q\\) and not equal to \\(p, f(q-p)=1\\). Using (2) for \\(p\\) and \\(q-p\\) gives us that some two of \\(f(p) \\neq 1, f(p-q)=1\\) and \\(f(q) \\neq 1\\) are equal, meaning that \\(f(p)=f(q)\\). Let \\(t \\geq 2\\) be the smallest integer such that \\(p^{t}>q\\), and let \\(p^{t}=a q+b\\) with \\(0 \\leq b \\leq q\\). Since \\(q \\geq p^{t-1}\\) and \\(q\\) is not divisible by \\(p\\), we have \\(q>p^{t-1}\\), so \\(a<p\\), and thus \\(f(a)=1\\). Therefore \\(a q\\) is not divisible by \\(p\\), thus neither is \\(b\\), and since \\(b<q, f(b)=1\\). Now using (2) for \\(a q\\) and \\(b\\) we get that some two of \\(f(a q)=f(a) f(q)=f(q)=f(p), f(b)=1\\) and \\(f(a q+b)=f\\left(p^{t}\\right)=f(p)^{t}\\) are equal, which is a contradiction. Solution 1B (for the main part). Suppose that there are two primes, \\(p<q\\) such that \\(f(p)>1\\) and \\(f(q)>1\\), and these are the two smallest such primes. \\(1<p-q<q\\) and it is not divisible by \\(p\\) and \\(q\\), therefore its prime factors are smaller than \\(q\\), so we conclude \\(f(q-p)=1\\). By (2), two of \\(f(q-p)=1, f(q-p)>1\\) and \\(f(q)>1\\) are equal, so \\(f(q)=f(p)=a\\). If \\(p^{2}<q\\) then \\(q-p^{2}\\) is not divisible by \\(p\\) and \\(q\\), so we conclude \\(f\\left(q-p^{2}\\right)=1\\) in the same way. Then \\(f\\left(p^{2}\\right)=f(p)^{2}=a^{2}, f\\left(q-p^{2}\\right)=1\\) and \\(f(q)=a\\) are distinct, contradicting (2). Hence, \\(q<p^{2}\\). Let \\(c=\\left\\lfloor p^{2} / q\\right\\rfloor\\); then \\(0<c<p\\), so \\(f(c)=1\\). By \\(0<p^{2}-c q<q\\), we get \\(f\\left(p^{2}-c q\\right)=1\\). Now \\(f\\left(p^{2}-c q\\right)=1, f\\left(p^{2}\\right)=a^{2}\\) and \\(f(c q)=a\\) are distinct, contradicting (2) again. Solution 2 (for the main part). Suppose there exists a positive integer \\(n\\) such that \\(f(n) \\neq 1\\) and \\(f(n+1) \\neq 1\\). We know that \\(f(1)=1\\), so by (2) two of \\(f(n) \\neq 1, f(n+1) \\neq 1\\) and \\(f(1)=1\\) are equal, therefore \\(f(n)=f(n+1)\\). \\(f\\left(n^{2}\\right)=f(n)^{2} \\neq 1\\) and \\(f\\left(n^{2}-1\\right)=f(n+1) f(n-1)=f(n) f(n-1) \\neq 1\\), but by (2) two of \\(f(1)=1, f\\left(n^{2}-1\\right) \\neq 1\\) and \\(f\\left(n^{2}\\right) \\neq 1\\) are equal, so \\(f\\left(n^{2}-1\\right)=f\\left(n^{2}\\right)\\) and thus \\(f(n) f(n-1)=f(n)^{2}\\), therefore \\(f(n-1)=f(n)\\). Then for \\(n-1\\), it is also true that \\(f(n-1) \\neq 1\\) and \\(f(n-1+1) \\neq 1\\), so the same proof applies, \\(f(n-1-1)=f(n-1)\\) and so on. By induction we get that \\(f(n)=f(1)\\), which is a contradiction, as \\(f(1)=1\\) and we assumed that \\(f(n) \\neq 1\\). Therefore, there can't be any \\(n\\) for which \\(f(n) \\neq 1\\) and \\(f(n+1) \\neq 1\\). Now suppose there are two primes, \\(p \\neq q \\in S\\) such that \\(f(p) \\neq 1\\) and \\(f(q) \\neq 1\\). Then by the Chinese remainder theorem, there exists a number \\(n\\) such that \\(p \\mid n\\) and \\(q \\mid n+1\\), so \\(f(p) \\mid f(n)\\) and \\(f(q) \\mid f(n+1)\\) thus \\(f(n) \\neq 1\\) and \\(f(n+1) \\neq 1\\). This is a contradiction, so \\(S\\) can't have two distinct elements. Solution 3 (Joseph Myers) (for the second part). Claim 3.1. If \\(f(m)>1\\) for some \\(m \\in \\mathbb{N}\\), then there are less than \\(m\\) different prime numbers \\(p_{i}\\) with \\(f\\left(p_{i}\\right)>1\\). Proof. On the one hand, if \\(f(m)=c>1\\), then for any \\(n \\in \\mathbb{N}\\), there is some \\(k \\in\\{n+1, n+2 \\ldots, n+m\\}\\) such that \\(f(k) \\in\\{1, c\\}\\). To show this, it is enough to see that condition (2) implies that for any \\(n \\in \\mathbb{N}\\) - if \\(f(n)=c\\), then \\(f(n+1) \\in\\{1, c\\}\\); - if \\(f(n)=1\\), then \\(f(n+m) \\in\\{1, c\\}\\). On the other hand, if we suppose that there are \\(m\\) different prime numbers \\(p_{1}, p_{2}, \\ldots, p_{m}\\), then we know (by the Chinese Remainder Theorem) that for any number \\(t \\in \\mathbb{N}\\), there exists a number \\(n_{t} \\in \\mathbb{N}\\) such that \\(p_{k}^{t} \\mid n_{t}+k\\) for each \\(k \\in\\{1,2, \\ldots, m\\}\\). Hence for each \\(k\\), we have \\[ f\\left(n_{t}+k\\right) \\geq f\\left(p_{i}^{t}\\right)=f\\left(p_{i}\\right)^{t} \\geq 2^{t} . \\] If \\(2^{t}>c\\), then it means that \\(f(k)>c\\) for all \\(k \\in\\left\\{n_{t}+1, n_{t}+2 \\ldots, n_{t}+m\\right\\}\\). Now we can suppose that for some \\(m \\geq 2\\), the set of primes with \\(f(p)>1\\) is \\(S=\\left\\{p_{1}, p_{2}, \\ldots, p_{m}\\right\\}\\). Now let \\(S_{1}\\) and \\(S_{2}\\) be two disjoint nonempty subsets such that \\(S_{1} \\cup S_{2}=S\\). Let \\(a=\\prod_{p_{i} \\in S_{1}} p_{i}\\) and \\(b=\\prod_{p_{j} \\in S_{2}} p_{j}\\). Now for any \\(k, \\ell \\in \\mathbb{N}, a^{k}+b^{\\ell}\\) is coprime to all primes in \\(S\\), hence \\(f\\left(a^{k}+b^{\\ell}\\right)=1\\). It is easy to see that we can choose \\(k\\) and \\(\\ell\\) such that \\(f\\left(a^{k}\\right) \\neq f\\left(b^{\\ell}\\right)\\), which contradicts condition (2). Solution 4 (for the main part). Let \\(p\\) the minimal (prime) number with \\(f(p)=c>1\\). Claim 4.1. For any \\(k \\in \\mathbb{N}, f\\left(1+p+p^{2}+\\ldots+p^{k}\\right) \\in\\left\\{1, c, c^{2}, \\ldots, c^{k}\\right\\}\\). Proof of the claim. Use condition (2) recursively. Now suppose that there exists some prime \\(q>p\\) with \\(f(q)>1\\), and consider the following three values of \\(f\\) : - \\(f(1)=1\\). - \\(f\\left(p^{q-1}-1\\right)=f(p-1) f\\left(p^{q-2}+p^{q-3}+\\ldots+p+1\\right) \\in\\left\\{1, c, c^{2}, \\ldots, c^{q-2}\\right\\}\\) using our claim, (note that we know \\(f(p-1)=1\\) by the minimality of \\(p\\) ). But we also know (by Fermat's little theorem) that \\(q \\mid p^{q-1}-1\\), hence \\(f(q) \\mid f\\left(p^{q-1}-1\\right)\\). Therefore we have that: \\(f\\left(p^{q-1}-1\\right) \\in\\left\\{c, c^{2}, \\ldots, c^{q-2}\\right\\}\\). - \\(f\\left(p^{q-1}\\right)=c^{q-1}\\). These are three different values, hence we have a contradiction by condition (2). Solution 4B (for the main part). Let \\(p\\) the minimal (prime) number with \\(f(p)=c>1\\). Lemma 4B.1. For any \\(k \\in \\mathbb{N}, f\\left(1+p+p^{2}+\\ldots+p^{k}\\right)=1\\). Proof of the Lemma, by induction. \\(k=0\\) is trivial. \\(k=1\\) is also easy, as \\(p+1\\) cannot be a prime, except in the case of \\(p=2\\), which is also easy. (If \\(f(2)=c>1\\), then \\(f(3) \\in\\{1, c\\}\\) by \\(3=1+2\\) and \\(f(3) \\in\\left\\{1, c^{2}\\right\\}\\) by \\(2^{2}=1+3\\).) From now we suppose \\(k \\geq 2\\) and \\(f\\left(1+p+\\ldots+p^{k-1}\\right)=1\\). By condition (2), we have that: - As \\(f\\left(1+p+\\ldots+p^{k-1}\\right)=1\\) and \\(f\\left(p^{k}\\right)=c^{k}\\), we have that \\(f\\left(1+p+\\ldots+p^{k-1}\\right) \\in\\left\\{1, c^{k}\\right\\}\\) - As \\(f(1)=1\\) and \\(f\\left(p+\\ldots+p^{k}\\right)=f(p) f\\left(1+p+\\ldots+p^{k-1}\\right)=c\\), we also have that \\(f\\left(1+p+\\ldots+p^{k-1}\\right) \\in\\{1, c\\}\\). If \\(k>1, c \\neq c^{k}\\), therefore \\(f\\left(1+p+\\ldots+p^{k}\\right)=1\\). Now suppose that there exists some prime \\(q>p\\) with \\(f(q)>1\\). Then by condition (1), \\[ f\\left(p^{q-1}-1\\right)=f(p-1) f\\left(1+p+\\ldots+p^{q-2}\\right) \\] here \\(f(p-1)=1\\) (by the minimality of \\(p\\) ) and \\(f\\left(1+p+\\ldots+p^{q-2}\\right)=1\\) by the lemma. But we also know (by Fermat's little theorem) that \\(q \\mid p^{q-1}-1\\), hence \\(1<f(q) \\leq f\\left(p^{q-1}-1\\right)\\), which is a contradiction. Solution 5 (for the main part). Lemma 5.1. If \\(f(m) \\neq f(n)\\), then \\(f(n+m)=f(n-m)\\) (for all \\(n>m \\in \\mathbb{N}\\) ). Proof of the Lemma. By condition (2), \\(\\{f(n+m), f(n-m)\\} \\subseteq\\{f(n), f(m)\\}\\). We also have that: \\[ f(n-m) f(n+m)=f\\left(n^{2}-m^{2}\\right) \\in\\left\\{f(n)^{2}, f(m)^{2}\\right\\} \\] which is only possible if \\(f(n-m)=f(n+m)=f(n)\\) or \\(f(n-m)=f(n+m)=f(m)\\). Now let \\(p\\) be the smallest (prime) number with \\(f(p)>1\\). Claim 5.2. If \\(p\\) does not divide \\(n\\), then \\(f(n)=1\\). Proof of the Claim. Let \\(n\\) be the minimal counterexample, and and let \\(n=d p+r\\) with \\(0<r<p\\). Here \\(d \\geq 1\\) by the minimality of \\(p\\). Now \\(1<f(d) f(p)=f(d p) \\neq f(r)=1\\), hence by our lemma, \\(f(d p+r)=f(d p-r)=1\\), contradiction.", "source_pdf": "egmo_2022.pdf", "notes": ""}
{"id": "EGMO-2022-3", "contest": "EGMO", "year": "2022", "problem_number": "3", "problem": "An infinite sequence of positive integers \\(a_{1}, a_{2}, \\ldots\\) is called good if (1) \\(a_{1}\\) is a perfect square, and (2) for any integer \\(n \\geq 2, a_{n}\\) is the smallest positive integer such that \\[ n a_{1}+(n-1) a_{2}+\\ldots+2 a_{n-1}+a_{n} \\] is a perfect square. Prove that for any good sequence \\(a_{1}, a_{2}, \\ldots\\), there exists a positive integer \\(k\\) such that \\(a_{n}=a_{k}\\) for all integers \\(n \\geq k\\).", "solution": "Solution. Define the following auxiliary sequences: \\[ \\begin{array}{ll} b_{1}=a_{1}, & b_{n}=a_{1}+a_{2}+\\cdots+a_{n}, \\\\ c_{1}=b_{1}, & c_{n}=b_{1}+b_{2}+\\cdots+b_{n} . \\end{array} \\] Observe that \\[ \\begin{gathered} c_{n}-c_{n-1}=b_{n} \\\\ b_{n}-b_{n-1}=\\left(c_{n}-c_{n-1}\\right)-\\left(c_{n-1}-c_{n-2}\\right)=a_{n} \\end{gathered} \\] Therefore, \\[ c_{n}=\\left(2 c_{n-1}-c_{n-2}\\right)+a_{n} \\] is the smallest square greater than \\(2 c_{n-1}-c_{n-2}\\). Claim. \\(\\sqrt{c_{n}}-\\sqrt{c_{n-1}} \\leq \\sqrt{c_{n-1}}-\\sqrt{c_{n-2}}\\) Proof 1. Let \\(c_{n}=m_{n}^{2}, c_{n-1}=m_{n-1}^{2}, c_{n-2}=m_{n-2}^{2}\\), where the value of \\(c_{n}\\) is momentarily permitted to exceed its minimum. Any value is permitted for which \\[ \\left(m_{n}-m_{n-1}\\right)\\left(m_{n}+m_{n-1}\\right)>\\left(m_{n-1}-m_{n-2}\\right)\\left(m_{n-1}+m_{n-2}\\right) . \\] In the case that \\(m_{n}-m_{n-1}=m_{n-1}-m_{n-2}\\), this inequality clearly holds, as \\(m_{n}+m_{n-1}>m_{n-1}+m_{n-2}\\). Thus, the minimal possible value of \\(m_{n}\\) satisfies the claimed inequality. Proof 2. Denote \\(c_{n-1}=x^{2}, c_{n-2}=(x-d)^{2}\\). Then \\[ 2 c_{n-1}-c_{n-2}=2 x^{2}-(x-d)^{2}=x^{2}+2 d x-d^{2}=(x+d)^{2}-2 d^{2}<(x+d)^{2} . \\] It follows that \\(c_{n} \\leq(x+d)^{2}\\). And so the sequence of positive integers \\(\\sqrt{c_{n}}-\\sqrt{c_{n-1}}\\) is decreasing. Any such sequence is eventually constant. As a corollary, \\(c_{n}=(x+n d)^{2}\\) for sufficiently large \\(n\\), with fixed integers \\(x\\) and \\(d\\). Along the lines above, it becomes clear that \\(a_{n}=c_{n}-2 c_{n-1}+c_{n-2}=2 d^{2}\\), so the sequence ( \\(a_{n}\\) ) is constant. Solution. We write: \\[ s_{n}^{2}=S_{n}=a_{1}+\\left(a_{1}+a_{2}\\right)+\\ldots+\\left(a_{1}+\\ldots+a_{n}\\right) . \\] So, setting \\(b_{n}:=a_{1}+\\ldots+a_{n}\\), we have \\(S_{n}=b_{1}+b_{2}+\\ldots+b_{n}\\) and, in particular \\(S_{n+1}=S_{n}+b_{n+1}\\). Now, we study the quantity \\(S_{n} b_{n}=+b_{1}+b_{2}+\\ldots+b_{n}+b_{n}\\) in two different ways. Since \\(b_{n+1}\\) is the smallest integer strictly greater than \\(b_{n}\\) such that \\(b_{1}+\\ldots+b_{n}+b_{n+1}\\) is a perfect square, we must have \\[ b_{1}+b_{2}+\\ldots+b_{n}+b_{n} \\geq\\left(s_{n+1}-1\\right)^{2} \\] However, we also have \\[ b_{1}+b_{2}+\\ldots+b_{n}+b_{n}=S_{n}+b_{n}=2 S_{n}-S_{n-1} \\] Combining, we obtain \\[ s_{n}^{2} \\geq \\frac{s_{n-1}^{2}+\\left(s_{n+1}-1\\right)^{2}}{2}>\\left(\\frac{s_{n-1}+s_{n+1}-1}{2}\\right)^{2} \\] where the final inequality is strict since the sequence ( \\(s_{k}\\) ) is strictly increasing. Taking a square root, and noting that all the ( \\(s_{n}\\) ) are integers, one obtains \\(s_{n+1}-s_{n} \\leq s_{n}-s_{n-1}\\). Now we focus on the sequence \\(d_{n}=s_{n+1}-s_{n}\\). ( \\(s_{k}\\) ) is strictly increasing thus ( \\(d_{k}\\) ) is positive. However we proved that \\(d_{n+1} \\leq d_{n}\\), so the sequence ( \\(d_{k}\\) ) is eventually constant, so eventually \\(s_{n}=b n+c\\) and \\(S_{n}=(b n+c)^{2}\\) with some numbers \\(b, c\\); then \\[ a_{n+2}=S_{n+2}-2 S_{n+1}+S_{n}=(b(n+2)+c)^{2}-2(b(n+1)+c)^{2}+(b n+c)^{2}=2 b^{2} . \\] Remark. The key idea is to use the \\(D\\) difference operator on the space of sequences. That is a function which takes a sequence as an input and outputs another sequence the following way: if ( \\(x\\) ) is the input sequence, then \\[ D(x)=D\\left(\\left(x_{1}, x_{2}, x_{3}, x_{4}, \\ldots\\right)\\right)=\\left(x_{2}-x_{1}, x_{3}-x_{2}, x_{4}-x_{3}, \\ldots\\right) . \\] Here \\(D D(S)=(a)\\) (with some shift), \\(D(s)=(d)\\). This \\(D\\) operator has some nice properties; if someone studied calculus, these properties will be familiar. \\(D(x+y)=D(x)+D(y) ; D(\\lambda x)=\\lambda D(x) ;(x)\\) constant iff \\(D x\\) zero ; ( \\(x\\) ) is linear iff \\(D x\\) constant ; in general ( \\(x\\) ) is a polynomial with degree \\(l+1\\) iff \\(D(x)\\) is a polynomial with degree \\(l\\). First we proved that sequence ( \\(d\\) ) is eventually constant, thus \\(D(d)=D D(s)\\) is eventually zero. Therefore the sequence ( \\(s\\) ) is eventually a linear function, hence \\(s^{2}=S\\) is eventually a quadratic polynomial, therefore \\(0=D D D(S)=D(a)\\), so \\((a)\\) is constant eventually.", "source_pdf": "egmo_2022.pdf", "notes": ""}
{"id": "EGMO-2022-4", "contest": "EGMO", "year": "2022", "problem_number": "4", "problem": "Given a positive integer \\(n \\geq 2\\), determine the largest positive integer \\(N\\) for which there exist \\(N+1\\) real numbers \\(a_{0}, a_{1}, \\ldots, a_{N}\\) such that (1) \\(a_{0}+a_{1}=-\\frac{1}{n}\\), and (2) \\(\\left(a_{k}+a_{k-1}\\right)\\left(a_{k}+a_{k+1}\\right)=a_{k-1}-a_{k+1}\\) for \\(1 \\leq k \\leq N-1\\).", "solution": "Solution 1. \\(\\left(a_{k}+a_{k-1}\\right)\\left(a_{k}+a_{k+1}\\right)=a_{k-1}-a_{k+1}\\) is equivalent to \\(\\left(a_{k}+a_{k-1}+1\\right)\\left(a_{k}+a_{k+1}-1\\right)=-1\\). Let \\(b_{k}=a_{k}+a_{k+1}\\). Thus we need \\(b_{0}, b_{1}, \\ldots\\) the following way: \\(b_{0}=-\\frac{1}{n}\\) and \\(\\left(b_{k-1}+1\\right)\\left(b_{k}-1\\right)=-1\\). There is a proper sequence \\(b_{0}, b_{1}, \\ldots, b_{N-1}\\) if and only if there is proper sequence \\(a_{0}, a_{1}, \\ldots, a_{N}\\), because from a a proper ( \\(a_{k}\\) ) sequence we can get a proper ( \\(b_{k}\\) ) sequence with \\(b_{k}=a_{k}+a_{k+1}\\) for \\(k=0,1, \\ldots, N-1\\) and from a proper ( \\(b_{k}\\) ) sequence we can get a proper ( \\(a_{k}\\) ) sequence by arbitrarily setting \\(a_{0}\\) and then inductively defining \\(a_{k}=b_{k-1}-a_{k-1}\\) for \\(k=1,2, \\ldots, N\\). We prove by induction that \\(b_{k}=-\\frac{1}{n-k}\\) for \\(k<n\\). This is true for \\(k=0\\), as \\(b_{0}=-\\frac{1}{n}\\) and \\[ b_{k}=1-\\frac{1}{b_{k-1}+1}=1-\\frac{1}{1-\\frac{1}{n-k+1}}=-\\frac{1}{n-k} \\] for \\(k<n\\). Thus there is a proper sequence \\(b_{0}, b_{1}, \\ldots, b_{n-1}\\), but it can't be continued, because \\(b_{n-1}+1=\\) 0 so there is no \\(b_{n}\\) for which \\(\\left(b_{n-1}+1\\right)\\left(b_{n}-1\\right)=-1\\). Therefore the longest proper sequence ( \\(b_{k}\\) ) is \\(n\\)-long, so the longest proper sequence ( \\(a_{k}\\) ) is \\(n+1\\) long, so \\(N=n\\). Solution 2. The required maximum is \\(N=n\\). To rule out the case \\(N \\geq n+1\\), it is clearly sufficient to rule out the case \\(N=n+1\\). Assume for contradiction that \\(a_{0}, a_{1}, \\ldots, a_{n+1}\\) are real numbers satisfying both conditions in the statement. It is sufficient to show that \\(a_{k}+a_{k+1}=0\\) for some \\(k \\leq n\\), because then \\(a_{k-1}-a_{k+1}=0\\) so \\(a_{k+1}=a_{k-1}\\), therefore \\(a_{k-1}+a_{k}=0\\) and so on, by backwards recursion we get that \\(a_{j}+a_{j+1}=0\\) for all \\(0 \\leq j \\leq k\\), but this is a contradiction with \\(a_{0}+a_{1}=-\\frac{1}{n}\\). To prove that \\(a_{k}+a_{k+1}=0\\) for some \\(k \\leq n\\), assume that \\(a_{k}+a_{k+1} \\neq 0\\) for all \\(k \\leq n\\), to rewrite the second condition in the statement in the form \\[ \\frac{1}{a_{k}+a_{k+1}}-\\frac{1}{a_{k-1}+a_{k}}=1, \\quad k=1, \\ldots, n . \\] and sum both sides over the full range from \\(k=1\\) to \\(n\\). This gives \\[ \\frac{1}{a_{n}+a_{n+1}}-\\frac{1}{a_{0}+a_{1}}=n . \\] As \\(a_{0}+a_{1}=-\\frac{1}{n}\\), this means that \\(\\frac{1}{a_{n}+a_{n+1}}=0\\), which is a contradiction. Consequently, \\(N \\leq n\\). To provide \\(n+1\\) real numbers satisfying both conditions in the statement, fix \\(a_{0}\\) and go through the telescoping procedure above to obtain \\[ a_{k}=(-1)^{k} a_{0}+\\sum_{j=1}^{k} \\frac{(-1)^{k-j+1}}{n-j+1}, \\quad k=1, \\ldots, n . \\] This concludes the proof.", "source_pdf": "egmo_2022.pdf", "notes": ""}
{"id": "EGMO-2022-5", "contest": "EGMO", "year": "2022", "problem_number": "5", "problem": "For all positive integers \\(n, k\\), let \\(f(n, 2 k)\\) be the number of ways an \\(n \\times 2 k\\) board can be fully covered by \\(n k\\) dominoes of size \\(2 \\times 1\\). (For example, \\(f(2,2)=2\\) and \\(f(3,2)=3\\).) Find all positive integers \\(n\\) such that for every positive integer \\(k\\), the number \\(f(n, 2 k)\\) is odd.", "solution": "Solution. The integers \\(n\\) with the requested property are exactly the ones of the form \\(2^{k}-1\\). In what follows, let \\(f(m, n)\\) denote the number of domino tilings of an \\(m \\times n\\) grid. (For convenience, we also allow \\(m\\) and \\(n\\) to be 0 , in which case \\(f(m, n)=1\\).) Claim. \\(f(m, 2 n+1) \\equiv f(m, n)(\\bmod 2)\\) for all \\(n\\) and even \\(m\\) Proof. Consider reflecting \\(m \\times(2 n+1)\\) tilings across the central column. In this way, the tilings are grouped into singletons and pairs, so modulo \\(2, f(m, 2 n+1)\\) is congruent to the number of singletons. If a tiling is invariant under reflection in the central column, then every domino with one cell in that column must have both cells in that column. In other words, the central column is filled with \\(\\frac{m}{2}\\) vertical dominoes, splitting the remainder of the grid into two \\(m \\times n\\) grids. Obeying the symmetry constraint, there are \\(f(m, n)\\) tilings: each of the tilings of the left grid fixes the tiling of the right grid. Claim. \\(f(n, n) \\equiv 0(\\bmod 2)\\) for all even \\(n \\geq 2\\). (Recall that \\(f(0,0)=1\\) is odd.) Proof. Consider reflecting \\(n \\times n\\) tilings across the diagonal. This groups the tilings into pairs, (no tiling is grouped with itself). Hence the number of \\(n \\times n\\) tilings is even. We are ready to complete the solution. - If \\(n\\) is odd, the first claim shows that \\(n\\) satisfies the property if and only if \\(\\frac{1}{2}(n-1)\\) does. - If \\(n \\geq 2\\) is even, the second claim shows that \\(n\\) does not satisfy the property. - If \\(n=0\\), then \\(n\\) satisfies the property, as \\(f(m, 0)=1\\) always. This concludes the proof that the sought numbers are the ones of the form \\(2^{k}-1\\). Solution 2. Color the board as a chessboard. Consider the bipartite graph whose vertices are the squares and the neighbors are connected by an edge. Notice that a domino tiling described in the problem corresponds to a perfect matching in this bipartite graph, so we are interested in the number of perfect matchings. And that is the permanent of the (bipartite) adjacency matrix. However we need to compute it \\(\\bmod 2\\) (over \\(F_{2}\\) ), so that is the determinant of that matrix. So our goal is to decide whether the determinant is 0 or \\(1 \\bmod 2\\), or in other world, that matrix is singular or not. From now we compute everything mod 2. Now we understand what does it mean, that a vector \\(v\\) is in the nullspace (has eigenvalue 0 ). But each entry of \\(v\\) is \\(0-1\\), so in other words we choose a subset of the black squares ( \\(v\\) is the characteristic vector of that subset). So in the language of the board, there is a nontrivial \\(v\\) in the nullspace iff we have a subspace of black square such a way that each white square has even number of black chosen neighbors. If \\(n\\) is even, then we can choose a subset such a way in the \\(n \\times n\\) square: the diagonal. Now we prove similar connection between \\(n\\) and \\(2 n+1\\) : there is a construction for \\(n\\) iff we have one for \\(2 n+1 . k\\) is always even. If we have a construction in \\(n \\times k\\) then we have one in \\((2 n+1) \\times k\\) : we mirror the construction to the middle row. Now we prove that from a construction in \\((2 n+1) \\times k\\) we can make a construction in \\(n \\times k\\). First, we don't have any chosen black square in the middle row. Then the chosen black squares in the upper (or lower) \\(n \\times k\\) rectangle is a construction for \\(n \\times k\\). Second, we have some chosen black square in the middle row. Because we can find a white square in the middle row such that is has only one chosen black neighbor in the middle row. Thus this construction isn't symmetric to the horizontal line the symmetric difference of the construction and its reflection (to the vertical line) is a nontrivial vector in the nullspace, thus we can use the first case.", "source_pdf": "egmo_2022.pdf", "notes": ""}
{"id": "EGMO-2022-6", "contest": "EGMO", "year": "2022", "problem_number": "6", "problem": "Let \\(A B C D\\) be a cyclic quadrilateral with circumcentre \\(O\\). Let the internal angle bisectors at \\(A\\) and \\(B\\) meet at \\(X\\), the internal angle bisectors at \\(B\\) and \\(C\\) meet at \\(Y\\), the internal angle bisectors at \\(C\\) and \\(D\\) meet at \\(Z\\), and the internal angle bisectors at \\(D\\) and \\(A\\) meet at \\(W\\). Further, let \\(A C\\) and \\(B D\\) meet at \\(P\\). Suppose that the points \\(X, Y, Z, W, O\\) and \\(P\\) are distinct. Prove that \\(O, X, Y, Z\\) and \\(W\\) lie on the same circle if and only if \\(P, X, Y, Z\\) and \\(W\\) lie on the same circle.", "solution": "Solution 1. Let \\(\\Omega\\) be the circumcircle of the quadrilateral \\(A B C D\\) and let \\(r\\) be its radius. First, notice that the points \\(X, Y, Z, W\\) are concyclic. Indeed, using oriented (modulo \\(180^{\\circ}\\) ) angles, \\[ \\angle(X W, X Y)+\\angle(Z Y, Z W)=\\angle(X A, X B)+\\angle(Z C, Z D)=-\\frac{\\angle A+\\angle B}{2}-\\frac{\\angle C+\\angle D}{2}=0 . \\] Let \\(\\omega\\) be the circle passing through these four points. Our goal is to prove that \\(O \\in \\omega\\) occurs if and only if \\(P \\in \\omega\\). Next, we rule out the case when \\(A B C D\\) is a trapezium. Suppose that if \\(A B C D\\) is an isosceles trapezium; without loss of generality say \\(A B \\| C D\\). By symmetry, points \\(X, Z, O\\) and \\(P\\) lie on the symmetry axis (that is, the common perpendicular bisector of \\(A B\\) and \\(C D\\) ), therefore they are collinear. By the conditions of the problem, these four points are distinct and \\(X\\) and \\(Z\\) are on \\(\\omega\\), so neither \\(O\\), nor \\(P\\) can lie on \\(\\omega\\); therefore the problem statement is obvious. From now on we assume that \\(A B \\nVdash C D\\) and \\(B C \\nmid A D\\). Let \\(A B\\) and \\(C D\\) meet at \\(Q\\), and let \\(B C\\) and \\(A D\\) meet at \\(R\\). Without loss of generality, suppose that \\(B\\) lies between \\(A\\) and \\(Q\\), and \\(D\\) lies between \\(A\\) and \\(R\\). Now we show that line \\(Q R\\) is the radical axis between circles \\(\\Omega\\) and \\(\\omega\\). Point \\(W\\) is the intersection point of the bisectors of \\(\\angle A\\) and \\(\\angle D\\), so in triangle \\(A D Q\\), point \\(W\\) is the incentre. Similary, \\(B Y\\) and \\(C Y\\) are the external bisectors of \\(\\angle Q B C\\) and \\(\\angle B C Q\\), so in triangle \\(B C Q\\), point \\(Y\\) is the excentre opposite to \\(Q\\). Hence, both \\(Y\\) and \\(W\\) lie on the bisector of \\(\\angle D Q A\\). By \\(\\angle D Q A=180^{\\circ}-\\angle D-\\angle A=\\angle B-\\angle A\\) we get \\[ \\angle B Y Q=\\angle Y B A-\\angle Y Q B=\\frac{\\angle B}{2}-\\frac{\\angle D Q A}{2}=\\frac{\\angle B}{2}-\\frac{\\angle B-\\angle A}{2}=\\frac{\\angle A}{2}=\\angle B A W, \\] so the points \\(A, B, Y, W\\) are concyclic, and therefore \\(Q A \\cdot Q B=Q Y \\cdot Q W\\); hence, \\(Q\\) has equal power with respect to \\(\\Omega\\) and \\(\\omega\\). It can be seen similarly that \\(R\\) has equal power with respect to the circles \\(\\Omega\\) and \\(\\omega\\). Hence, the radical axis of \\(\\Omega\\) and \\(\\omega\\) is line \\(Q R\\). Let lines \\(O P\\) and \\(Q R\\) meet at point \\(S\\). It is well-known that with respect to circle \\(A B C D\\), the diagonal triangle \\(P Q R\\) is autopolar. As consequences we have \\(O P \\perp Q R\\), and the points \\(P\\) and \\(S\\) are symmetric to circle \\(A B C D\\), so \\(O S \\cdot O P=r^{2}\\). Notice that \\(P\\) and \\(O\\) lie inside \\(\\Omega\\), so the polar line \\(Q R\\) lies entirely outside, so \\(S\\) is different from \\(P\\) and \\(O\\). Moreover, \\[ S O \\cdot S P=O S \\cdot(O S-O P)=O S^{2}-O S \\cdot O P=S O^{2}-r^{2}, \\] so \\(S O \\cdot S P\\) is equal to the power of \\(S\\) with respect to \\(\\Omega\\). Since \\(S\\) lies on the radical axis \\(Q R\\), it has equal power with respect to the two circles; therefore, \\(S O \\cdot S P\\) is equal to the power of \\(S\\) with respect to \\(\\omega\\). From this, it follows that \\(O \\in \\omega\\) if and only if \\(P \\in \\omega\\). Solution 2. We will prove that the points \\(X, Y, Z, W, O, P\\) lie on a conic section \\(\\Gamma\\). Five distinct points uniquely determine a conic section, therefore \\[ X, Y, Z, W, O \\text { are concyclic } \\Leftrightarrow \\Gamma \\text { is a circle } \\Leftrightarrow X, Y, Z, W, P \\text { are concyclic. } \\] Let \\(A^{\\prime}, B^{\\prime}, C^{\\prime}\\) and \\(D^{\\prime}\\) be the second intersection of the angle bisectors of \\(\\angle D A C\\), \\(\\angle A B C, \\angle B C D\\) and \\(\\angle C D A\\) with the circumcircle of \\(A B C D\\), respectively. Notice that \\(A^{\\prime}\\) and \\(C^{\\prime}\\) are the midpoints of the two arcs of \\(B D\\) and \\(B^{\\prime}\\) and \\(D^{\\prime}\\) are the midpoints of arcs corresponding to \\(A C\\) so the lines \\(A^{\\prime} C^{\\prime}\\) and \\(B^{\\prime} D^{\\prime}\\) intersect in \\(O\\). We will prove that the points \\(X, Y, Z, W, P\\) and \\(O\\) lie on a conic section. This is a more general statement because five points uniquely determine a conic sections so if \\(X, Y, Z, W\\) and \\(P\\) lie on a circle then this circle is the conic section so \\(O\\) also lies on this circle. In the same way if \\(X, Y, Z\\), \\(W\\) and \\(O\\) are on a circle then it also contains \\(P\\). Let \\(E\\) be the intersection of the lines \\(A^{\\prime} B\\) and \\(C D^{\\prime}\\). Let \\(F\\) be the intersection of the lines \\(A^{\\prime} D\\) and \\(B^{\\prime} C\\). Finally, let \\(G\\) be the intesection of \\(X Y\\) and \\(Z W\\). Now we use Pascal's theorem five times: 1. From \\(B D D^{\\prime} C A A^{\\prime}\\) we see that the points \\(P, W\\) and \\(E\\) are collinear. 2. From \\(B B^{\\prime} D^{\\prime} C C^{\\prime} A^{\\prime}\\) we see that the points \\(Y, O\\) and \\(E\\) are collinear. 3. From \\(B^{\\prime} B D A^{\\prime} A C\\) we see that the points \\(X, P\\) and \\(F\\) are collinear. 4. From \\(B^{\\prime} D^{\\prime} D A^{\\prime} C^{\\prime} C\\) we see that the points \\(O, Z\\) and \\(F\\) are collinear. 5. From \\(D^{\\prime} C B^{\\prime} B A^{\\prime} D\\) we see that the points \\(E, F\\) and \\(G\\) are collinear. So the opposite sides of the hexagon \\(P X Y O Z W\\) intersect at points \\(F, G\\) and \\(E\\), which are collinear, so by the converse of Pascal's theorem the points \\(X, Y, Z, W, P\\) and \\(O\\) indeed lie on a conic section.", "source_pdf": "egmo_2022.pdf", "notes": ""}
{"id": "EGMO-2023-1", "contest": "EGMO", "year": "2023", "problem_number": "1", "problem": "There are \\(n \\geqslant 3\\) positive real numbers \\(a_{1}, a_{2}, \\ldots, a_{n}\\). For each \\(1 \\leqslant i \\leqslant n\\) we let \\(b_{i}=\\frac{a_{i-1}+a_{i+1}}{a_{i}}\\) (here we define \\(a_{0}\\) to be \\(a_{n}\\) and \\(a_{n+1}\\) to be \\(a_{1}\\) ). Assume that for all \\(i\\) and \\(j\\) in the range 1 to \\(n\\), we have \\(a_{i} \\leqslant a_{j}\\) if and only if \\(b_{i} \\leqslant b_{j}\\).\n\nProve that \\(a_{1}=a_{2}=\\cdots=a_{n}\\).", "solution": "Suppose that not all \\(a_{i}\\) are equal. Consider an index \\(i\\) such that \\(a_{i}\\) is maximal and \\(a_{i+1}<a_{i}\\). Then\n\\[\nb_{i}=\\frac{a_{i-1}+a_{i+1}}{a_{i}}<\\frac{2 a_{i}}{a_{i}}=2 .\n\\]\n\nBut since \\(a_{i}\\) is maximal, \\(b_{i}\\) is also maximal, so we must have \\(b_{j}<2\\) for all \\(j \\in\\{1,2, \\ldots, n\\}\\).\nHowever, consider the product \\(b_{1} b_{2} \\ldots b_{n}\\). We have\n\\[\n\\begin{aligned}\nb_{1} b_{2} \\ldots b_{n} & =\\frac{a_{n}+a_{2}}{a_{1}} \\cdot \\frac{a_{1}+a_{3}}{a_{2}} \\cdot \\ldots \\cdot \\frac{a_{n-1}+a_{1}}{a_{n}} \\\\\n& \\geqslant 2^{n} \\frac{\\sqrt{a_{n} a_{2}} \\sqrt{a_{1} a_{3}} \\ldots \\sqrt{a_{n-1} a_{1}}}{a_{1} a_{2} \\ldots a_{n}} \\\\\n& =2^{n}\n\\end{aligned}\n\\]\nwhere we used the inequality \\(x+y \\geqslant 2 \\sqrt{x y}\\) for \\(x=a_{i-1}, y=a_{i+1}\\) for all \\(i \\in\\{1,2, \\ldots, n\\}\\) in the second row.\n\nSince the product of all \\(b_{i}\\) is at least \\(2^{n}\\), at least one of them must be greater than 2 , which is a contradiction with the previous conclusion.\n\nThus, all \\(a_{i}\\) must be equal.\n\nSolution 2. This is a version of Solution 1 without use of proof by contradiction.\nTaking \\(a_{i}\\) such that it is maximal among \\(a_{1}, \\ldots, a_{n}\\), we obtain \\(b_{i} \\leqslant 2\\). Thus \\(b_{i} \\leqslant 2\\) for all \\(j \\in\\{1,2, \\ldots, n\\}\\).\n\nThe second part of Solution 1 then gives \\(2^{n} \\geqslant b_{1} \\cdots b_{n} \\geqslant 2^{n}\\), which together with \\(b_{i} \\leqslant 2\\) for all \\(j \\in\\{1,2, \\ldots, n\\}\\) implies that \\(b_{j}=2\\) for all \\(j \\in\\{1,2, \\ldots, n\\}\\). Since we have \\(b_{1}= b_{2}=\\cdots=b_{n}\\), the condition that \\(a_{i} \\leqslant a_{j} \\Longleftrightarrow b_{i} \\leqslant b_{j}\\) gives that \\(a_{1}=a_{2}=\\cdots=a_{n}\\).\n\nSolution 3. We first show that \\(b_{j} \\leqslant 2\\) for all \\(j\\) as in Solution 2. Then\n\\[\n\\begin{aligned}\n2 n & \\geqslant b_{1}+\\cdots+b_{n}=\\frac{a_{n}}{a_{1}}+\\frac{a_{2}}{a_{1}}+\\frac{a_{1}}{a_{2}}+\\frac{a_{3}}{a_{2}}+\\cdots+\\frac{a_{n-1}}{a_{n}}+\\frac{a_{1}}{a_{n}} \\\\\n& \\geqslant 2 n \\sqrt[n]{\\frac{a_{n}}{a_{1}} \\cdot \\frac{a_{2}}{a_{1}} \\cdot \\frac{a_{1}}{a_{2}} \\cdot \\frac{a_{3}}{a_{2}} \\cdots \\frac{a_{n-1}}{a_{n}} \\cdot \\frac{a_{1}}{a_{n}}}=2 n \\cdot 1=2 n,\n\\end{aligned}\n\\]\nwhere we used the AM-GM inequality.\nIt follows that all \\(b_{j}\\) 's are equal which as in Solution 2 gives \\(a_{1}=a_{2}=\\cdots=a_{n}\\).\n\nSolution 4. By assumption \\(a_{i} b_{i}=a_{i-1}+a_{i+1}\\) for \\(i=\\{1,2, \\ldots, n\\}\\), hence,\n\\[\n\\sum_{i=1}^{n} a_{i} b_{i}=2 \\sum_{i=1}^{n} a_{i} .\n\\]\n\nSince \\(a_{i} \\leqslant a_{j}\\) if and only if \\(b_{i} \\leqslant b_{j}\\), the Chebyshev's inequality implies\n\\[\n\\left(\\sum_{i=1}^{n} a_{i}\\right) \\cdot\\left(\\sum_{i=1}^{n} b_{i}\\right) \\leqslant n \\cdot \\sum_{i=1}^{n} a_{i} b_{i}=2 n \\cdot \\sum_{i=1}^{n} a_{i}\n\\]\nand so \\(\\sum_{i=1}^{n} b_{i} \\leqslant 2 n\\). On the other hand, we have\n\\[\n\\sum_{i=1}^{n} b_{i}=\\sum_{i=1}^{n} \\frac{a_{i-1}}{a_{i}}+\\sum_{i=1}^{n} \\frac{a_{i+1}}{a_{i}}=\\sum_{i=1}^{n} \\frac{a_{i-1}}{a_{i}}+\\sum_{i=1}^{n} \\frac{a_{i}}{a_{i-1}}=\\sum_{i=1}^{n}\\left(\\frac{a_{i-1}}{a_{i}}+\\frac{a_{i}}{a_{i-1}}\\right),\n\\]\nso we can use the AM-GM inequality to estimate\n\\[\n\\sum_{i=1}^{n} b_{i} \\geqslant \\sum_{i=1}^{n} 2 \\sqrt{\\frac{a_{i-1}}{a_{i}} \\cdot \\frac{a_{i}}{a_{i-1}}}=2 n .\n\\]\n\nWe conclude that we must have equalities in all the above, which implies \\(\\frac{a_{i-1}}{a_{i}}=\\frac{a_{i}}{a_{i-1}}\\) and consequently \\(a_{i}=a_{i-1}\\) for all positive integers \\(i\\). Hence, all \\(a\\) 's are equal.\n\nSolution 5. As in Solution 4 we show that \\(\\sum_{i=1}^{n} b_{i} \\leqslant 2 n\\) and as in Solution 1 we show that \\(\\prod_{i=1}^{n} b_{i} \\geqslant 2^{n}\\). We now use the AM-GM inequality and the first inequality to get\n\\[\n\\prod_{i=1}^{n} b_{i} \\leqslant\\left(\\frac{1}{n} \\sum_{i=1}^{n} b_{i}\\right)^{n} \\leqslant\\left(\\frac{1}{n} \\cdot 2 n\\right)^{n}=2^{n}\n\\]\n\nThis implies that we must have equalities in all the above. In particular, we have equality in the AM-GM inequality, so all \\(b\\) 's are equal and as in Solution 2 then all \\(a\\) 's are equal.\n\nSolution 6. Let \\(a_{i}\\) to be minimal and \\(a_{j}\\) maximal among all \\(a\\) 's. Then\n\\[\nb_{j}=\\frac{a_{j-1}+a_{j+1}}{a_{j}} \\leqslant \\frac{2 a_{j}}{a_{j}}=2=\\frac{2 a_{i}}{a_{i}} \\leqslant \\frac{a_{i-1}+a_{i+1}}{a_{i}}=b_{i}\n\\]\nand by assumption \\(b_{i} \\leqslant b_{j}\\). Hence, we have equalities in the above so \\(b_{j}=2\\) so \\(a_{j-1}+ a_{j+1}=2 a_{j}\\) and therefore \\(a_{j-1}=a_{j}=a_{j+1}\\). We have thus shown that the two neighbors of a maximal \\(a\\) are also maximal. By an inductive argument all \\(a\\) 's are maximal, hence equal.\n\nSolution 7. Choose an arbitrary index \\(i\\) and assume without loss of generality that \\(a_{i} \\leqslant a_{i+1}\\). (If the opposite inequality holds, reverse all the inequalities below.) By induction we will show that for each \\(k \\in \\mathbb{N}_{0}\\) the following two inequalities hold\n\\[\n\\begin{gathered}\na_{i+1+k} \\geqslant a_{i-k} \\\\\na_{i+1+k} a_{i+1-k} \\geqslant a_{i-k} a_{i+k}\n\\end{gathered}\n\\]\n(where all indices are cyclic modulo \\(n\\) ). Both inequalities trivially hold for \\(k=0\\).\nAssume now that both inequalities hold for some \\(k \\geqslant 0\\). The inequality \\(a_{i+1+k} \\geqslant a_{i-k}\\) implies \\(b_{i+1+k} \\geqslant b_{i-k}\\), so\n\\[\n\\frac{a_{i+k}+a_{i+2+k}}{a_{i+1+k}} \\geqslant \\frac{a_{i-1-k}+a_{i+1-k}}{a_{i-k}} .\n\\]\n\nWe may rearrange this inequality by making \\(a_{i+2+k}\\) the subject so\n\\[\na_{i+2+k} \\geqslant \\frac{a_{i+1+k} a_{i-1-k}}{a_{i-k}}+\\frac{a_{i+1-k} a_{i+1+k}-a_{i+k} a_{i-k}}{a_{i-k}} \\geqslant \\frac{a_{i+1+k} a_{i-1-k}}{a_{i-k}},\n\\]\nwhere the last inequality holds by (2). It follows that\n\\[\na_{(i+1)+(k+1)} a_{(i+1)-(k+1)} \\geqslant a_{i+(k+1)} a_{i-(k+1)},\n\\]\ni.e. the inequality (2) holds also for \\(k+1\\). Using (1) we now get\n\\[\na_{(i+1)+(k+1)} \\geqslant \\frac{a_{i+k+1}}{a_{i-k}} a_{i-(k+1)} \\geqslant a_{i-(k+1)}\n\\]\ni.e. (1) holds for \\(k+1\\).\nNow we use the inequality (1) for \\(k=n-1\\). We get \\(a_{i} \\geqslant a_{i+1}\\), and since at the beginning we assumed \\(a_{i} \\leqslant a_{i+1}\\), we get that any two consecutive \\(a\\) 's are equal, so all of them are equal.\n\nSolution 8. We first prove the following claim by induction:\nClaim 1: If \\(a_{k} a_{k+2}<a_{k+1}^{2}\\) and \\(a_{k}<a_{k+1}\\), then \\(a_{j} a_{j+2}<a_{j+1}^{2}\\) and \\(a_{j}<a_{j+1}\\) for all \\(j\\).\nWe assume that \\(a_{i} a_{i+2}<a_{i+1}^{2}\\) and \\(a_{i}<a_{i+1}\\), and then show that \\(a_{i-1} a_{i+1}<a_{i}^{2}\\) and \\(a_{i-1}<a_{i}\\).\n\nSince \\(a_{i} \\leq a_{i+1}\\) we have that \\(b_{i} \\leq b_{i+1}\\). By plugging in the definition of \\(b_{i}\\) and \\(b_{i+1}\\) we have that\n\\[\na_{i+1} a_{i-1}+a_{i+1}^{2} \\leq a_{i}^{2}+a_{i+2} a_{i} .\n\\]\n\nUsing \\(a_{i} a_{i+2}<a_{i+1}^{2}\\) we get that\n\\[\na_{i+1} a_{i-1}<a_{i}^{2}\n\\]\n\nSince \\(a_{i}<a_{i+1}\\) we have that \\(a_{i-1}<a_{i}\\), which concludes the induction step and hence proves the claim.\n\nWe cannot have that \\(a_{j}<a_{j+1}\\) for all indices \\(j\\). Similar as in the above claim, one can prove that if \\(a_{k} a_{k+2}<a_{k+1}^{2}\\) and \\(a_{k+2}<a_{k+1}\\), then \\(a_{j+1}<a_{j}\\) for all \\(j\\), which also cannot be the case. Thus we have that \\(a_{k} a_{k+2} \\geq a_{k+1}^{2}\\) for all indices \\(k\\).\n\nNext observe (e.g. by taking the product over all indices) that this implies \\(a_{k} a_{k+2}=a_{k+1}^{2}\\) for all indices \\(k\\), which is equivalent to \\(b_{k}=b_{k+1}\\) for all \\(k\\) and hence \\(a_{k+1}=a_{k}\\) for all \\(k\\).\n\nSolution 9. Define \\(c_{i}:=\\frac{a_{i}}{a_{i+1}}\\), then \\(b_{i}=c_{i-1}+1 / c_{i}\\). Assume that not all \\(c_{i}\\) are equal to 1. Since, \\(\\prod_{i=1}^{n} c_{i}=1\\) there exists a \\(k\\) such that \\(c_{k} \\geqslant 1\\). From the condition given in the problem statement for \\((i, j)=(k, k+1)\\) we have\n\\[\nc_{k} \\geqslant 1 \\Longleftrightarrow c_{k-1}+\\frac{1}{c_{k}} \\geqslant c_{k}+\\frac{1}{c_{k+1}} \\Longleftrightarrow c_{k-1} c_{k} c_{k+1}+c_{k+1} \\geqslant c_{k}^{2} c_{k+1}+c_{k}\n\\]\n\nNow since \\(c_{k+1} \\leqslant c_{k}^{2} c_{k+1}\\), it follows that\n\\[\nc_{i-1} c_{i} c_{i+1} \\geqslant c_{i} \\Longrightarrow\\left(c_{i-1} \\geqslant 1 \\text { or } c_{i+1} \\geqslant 1\\right) .\n\\]\n\nSo there exist a set of at least 2 consecutive integers, such that the corresponding \\(c_{i}\\) are greater or equal to one. By the innitial assumption there must exist an index \\(\\ell\\), such that \\(c_{\\ell-1}, c_{\\ell} \\geqslant 1\\) and \\(c_{\\ell+1}<1\\). We distinguish two cases:\n\nCase 1: \\(c_{\\ell}>c_{\\ell-1} \\geqslant 1\\)\nFrom \\(c_{\\ell-1} c_{\\ell} c_{\\ell+1}<c_{\\ell}^{2} c_{\\ell+1}\\) and the inequality (5), we get that \\(c_{\\ell+1}>c_{\\ell} \\geqslant 1\\), which is a contradiction to our choice of \\(\\ell\\).\n\nCase 2: \\(c_{\\ell-1} \\geqslant c_{\\ell} \\geqslant 1\\)\nOnce again looking at the inequality (5) we can find that\n\\[\nc_{\\ell-2} c_{\\ell-1} c_{\\ell} \\geqslant c_{\\ell-1}^{2} c_{\\ell} \\Longrightarrow c_{\\ell-2} \\geqslant c_{\\ell-1}\n\\]\n\nNote that we only needed \\(c_{\\ell-1} \\geqslant c_{\\ell} \\geqslant 1\\) to show \\(c_{\\ell-2} \\geqslant c_{\\ell-1} \\geqslant 1\\). So using induction we can easily show \\(c_{\\ell-s-1} \\geqslant c_{\\ell-s}\\) for all \\(s\\).\nSo\n\\[\nc_{1} \\leqslant c_{2} \\leqslant \\cdots \\leqslant c_{n} \\leqslant c_{1}\n\\]\na contradiction to our innitial assumption.\n\nSo our innitial assumtion must have been wrong, which implies that all the \\(a_{i}\\) must have been equal from the start.", "source_pdf": "egmo_2023.pdf", "notes": "fallback-regex"}
{"id": "EGMO-2023-2", "contest": "EGMO", "year": "2023", "problem_number": "2", "problem": "We are given an acute triangle \\(A B C\\). Let \\(D\\) be the point on its circumcircle such that \\(A D\\) is a diameter. Suppose that points \\(K\\) and \\(L\\) lie on segments \\(A B\\) and \\(A C\\), respectively, and that \\(D K\\) and \\(D L\\) are tangent to circle \\(A K L\\).\n\nShow that line \\(K L\\) passes through the orthocentre of \\(A B C\\).\nThe altitudes of a triangle meet at its orthocentre.", "solution": "\\begin{figure}\n\\includegraphics[width=\\textwidth]{https://cdn.mathpix.com/cropped/2025_08_23_146291bab5ef73d6732cg-07.jpg?height=1066&width=992&top_left_y=708&top_left_x=533}\n\\captionsetup{labelformat=empty}\n\\caption{Figure 1: Diagram to solution 1}\n\\end{figure}\n\nSolution 1. Let \\(M\\) be the midpoint of \\(K L\\). We will prove that \\(M\\) is the orthocentre of \\(A B C\\). Since \\(D K\\) and \\(D L\\) are tangent to the same circle, \\(|D K|=|D L|\\) and hence \\(D M \\perp K L\\). The theorem of Thales in circle \\(A B C\\) also gives \\(D B \\perp B A\\) and \\(D C \\perp C A\\). The right angles then give that quadrilaterals \\(B D M K\\) and \\(D M L C\\) are cyclic.\n\nIf \\(\\angle B A C=\\alpha\\), then clearly \\(\\angle D K M=\\angle M L D=\\alpha\\) by angle in the alternate segment of circle \\(A K L\\), and so \\(\\angle M D K=\\angle L D M=\\frac{\\pi}{2}-\\alpha\\), which thanks to cyclic quadrilaterals gives \\(\\angle M B K=\\angle L C M=\\frac{\\pi}{2}-\\alpha\\). From this, we have \\(B M \\perp A C\\) and \\(C M \\perp A B\\), and so \\(M\\) indeed is the orthocentre of \\(A B C\\).\n\n\\section*{Solution 2. Preliminaries}\n\nLet \\(A B C\\) be a triangle with circumcircle \\(\\Gamma\\). Let \\(X\\) be a point in the plane. The Simson line (Wallace-Simson line) is defined via the following theorem. Drop perpendiculars from \\(X\\) to each of the three side lines of \\(A B C\\). The feet of these perpendiculars are collinear (on\nthe Simson line of \\(X\\) ) if and only if \\(X\\) lies of \\(\\Gamma\\). The Simson line of \\(X\\) in the circumcircle bisects the line segment \\(X H\\) where \\(H\\) is the orthocentre of triangle \\(A B C\\). See Figure 2\n\n\\begin{figure}\n\\includegraphics[width=\\textwidth]{https://cdn.mathpix.com/cropped/2025_08_23_146291bab5ef73d6732cg-08.jpg?height=573&width=1184&top_left_y=396&top_left_x=436}\n\\captionsetup{labelformat=empty}\n\\caption{Figure 2: The Wallace-Simson configuration}\n\\end{figure}\n\nWhen \\(X\\) is on \\(\\Gamma\\), we can enlarge from \\(X\\) with scale factor 2 (a homothety) to take the Simson line to the doubled Simson line which passes through the orthocentre \\(H\\) and contains the reflections of \\(X\\) in each of the three sides of \\(A B C\\).\n\n\\section*{Solution of the problem}\n\n\\begin{figure}\n\\includegraphics[width=\\textwidth]{https://cdn.mathpix.com/cropped/2025_08_23_146291bab5ef73d6732cg-08.jpg?height=798&width=795&top_left_y=1376&top_left_x=633}\n\\captionsetup{labelformat=empty}\n\\caption{Figure 3: Three circles do the work}\n\\end{figure}\n\nLet \\(\\Gamma\\) be the circle \\(A B C, \\Sigma\\) be the circle \\(A K L\\) with centre \\(O\\), and \\(\\Omega\\) be the circle on diameter \\(O D\\) so \\(K\\) and \\(L\\) are on this circle by converse of Thales. Let \\(\\Omega\\) and \\(\\Gamma\\) meet at \\(D\\) and \\(F\\). By Thales in both circles, \\(\\angle A F D\\) and \\(\\angle O F D\\) are both right angles so \\(A O F\\) is a line. Let \\(A F\\) meet \\(\\Sigma\\) again at \\(T\\) so \\(A T\\) (containing \\(O\\) ) is a diameter of this circle and by Thales, \\(T L \\perp A C\\).\n\nLet \\(G\\) (on \\(\\Sigma\\) ) be the reflection of \\(K\\) in \\(A F\\). Now \\(A T\\) is the internal angle bisector of \\(\\angle G A K\\) so, by an upmarket use of angles in the same segment (of \\(\\Sigma\\) ), \\(T L\\) is the internal\nangle bisector of \\(\\angle G L K\\). Thus the line \\(G L\\) is the reflection of the line \\(K L\\) in \\(T L\\), and so also the reflection of \\(K L\\) in the line \\(A C\\) (internal and external angle bisectors).\n\nOur next project is to show that \\(L G F\\) are collinear. Well \\(\\angle F L K=\\angle F O K\\) (angles in the same segment of \\(\\Omega)\\) and \\(\\angle G L K=\\angle G A K(\\) angles in the same segment of \\(\\Sigma)=2 \\angle O A K\\) ( \\(A K G\\) is isosceles with apex \\(A\\) ) = \\(\\angle T O K\\) (since \\(O A K\\) is isosceles with apex \\(O\\), and this is an external angle at \\(O\\) ). The point \\(T\\) lies in the interior of the line segment \\(F O\\) so \\(\\angle T O K=\\angle F O K\\). Therefore \\(\\angle F L K=\\angle G L K\\) so \\(L G F\\) is a line.\n\nNow from the second paragraph, \\(F\\) is on the reflection of \\(K L\\) in \\(A C\\). By symmetry, \\(F\\) is also on the reflection of \\(K L\\) in \\(A B\\). Therefore the reflections of \\(F\\) in \\(A B\\) and \\(A C\\) are both on \\(K L\\) which must therefore be the doubled Wallace-Simson line of \\(F\\). Therefore the orthocentre of \\(A B C\\) lies on \\(K L\\).\n\nSolution 3. Let \\(H\\) be the orthocentre of triangle \\(A B C\\) and \\(\\Sigma\\) the circumcircle of \\(A K L\\) with centre \\(O\\). Let \\(\\Omega\\) be the circle with diameter \\(O D\\), which contains \\(K\\) and \\(L\\) by Thales, and let \\(\\Gamma\\) be the circumcircle of \\(A B C\\) containing \\(D\\). Denote the second intersection of \\(\\Omega\\) and \\(\\Gamma\\) by \\(F\\). Since \\(O D\\) and \\(A D\\) are diameters of \\(\\Omega\\) and \\(\\Gamma\\) we have \\(\\angle O F D=\\frac{\\pi}{2}=\\angle A F D\\), so the points \\(A, O, F\\) are collinear. Let \\(M\\) and \\(N\\) be the second intersections of \\(C H\\) and \\(B H\\) with \\(\\Gamma\\), respectively. It is well-known that \\(M\\) and \\(N\\) are the reflections of \\(H\\) in \\(A B\\) and \\(A C\\), respectively (because \\(\\angle N C A=\\angle N B A=\\angle A C M=\\angle A B M\\) ). By collinearity of \\(A, O, F\\) and the angles in \\(\\Gamma\\) we have\n\\[\n\\angle N F O=\\angle N F A=\\angle N B A=\\frac{\\pi}{2}-\\angle B A C=\\frac{\\pi}{2}-\\angle K A L .\n\\]\n\nSince \\(D L\\) is tangent to \\(\\Sigma\\) we obtain\n\\[\n\\angle N F O=\\frac{\\pi}{2}-\\angle K L D=\\angle L D O,\n\\]\nwhere the last equality follows from the fact that \\(O D\\) is bisector of \\(\\angle L D K\\) since \\(L D\\)\n\n\\begin{figure}\n\\includegraphics[width=\\textwidth]{https://cdn.mathpix.com/cropped/2025_08_23_146291bab5ef73d6732cg-09.jpg?height=801&width=795&top_left_y=1798&top_left_x=633}\n\\captionsetup{labelformat=empty}\n\\caption{Figure 4: Diagram to Solution 3}\n\\end{figure}\nand \\(K D\\) are tangent to \\(\\Sigma\\). Furthermore, \\(\\angle L D O=\\angle L F O\\) since these are angles in \\(\\Omega\\). Hence, \\(\\angle N F O=\\angle L F O\\), which implies that points \\(N, L, F\\) are collinear. Similarly points \\(M, K, F\\) are collinear. Since \\(N\\) and \\(M\\) are reflections of \\(H\\) in \\(A C\\) and \\(A B\\) we have\n\\[\n\\angle L H N=\\angle H N L=\\angle B N F=\\angle B M F=\\angle B M K=\\angle K H B .\n\\]\n\nHence,\n\\[\n\\angle L H K=\\angle L H N+\\angle N H K=\\angle K H B+\\angle N H K=\\pi\n\\]\nand the points \\(L, H, K\\) are collinear.\n\nSolution 4. As in Solution 3 let \\(M\\) and \\(N\\) be the reflections of the orthocentre in \\(A B\\) and \\(A C\\). Let \\(\\angle B A C=\\alpha\\). Then \\(\\angle N D M=\\pi-\\angle M A N=\\pi-2 \\alpha\\).\n\nLet \\(M K\\) and \\(N L\\) intersect at \\(F\\). See Figure 3.\nClaim. \\(\\angle N F M=\\pi-2 \\alpha\\), so \\(F\\) lies on the circumcircle.\nProof. Since \\(K D\\) and \\(L D\\) are tangents to circle \\(A K L\\), we have \\(|D K|=|D L|\\) and \\(\\angle D K L=\\angle K L D=\\alpha\\), so \\(\\angle L D K=\\pi-2 \\alpha\\).\n\nBy definition of \\(M, N\\) and \\(D, \\angle M N D=\\angle A N D-\\angle A N M=\\frac{\\pi}{2}-\\left(\\frac{\\pi}{2}-\\alpha\\right)=\\alpha\\) and analogously \\(\\angle D M N=\\alpha\\). Hence \\(|D M|=|D N|\\).\n\nFrom \\(\\angle N D M=\\angle L D K=\\pi-2 \\alpha\\) if follows that \\(\\angle L D N=\\angle K D M\\). Since \\(|D K|=|D L|\\) and \\(|D M|=|D N|\\), triangles \\(M D K\\) and \\(N D L\\) are related by a rotation about \\(D\\) through angle \\(\\pi-2 \\alpha\\), and hence the angle between \\(M K\\) and \\(N L\\) is \\(\\pi-2 \\alpha\\), which proved the claim.\n\nWe now finish as in Solution 3:\n\\[\n\\begin{gathered}\n\\angle M H K=\\angle K M H=\\angle F M C=\\angle F A C, \\\\\n\\angle L H N=\\angle H N L=\\angle B N F=\\angle B A F .\n\\end{gathered}\n\\]\n\nAs \\(\\angle B A F+\\angle F A C=\\alpha\\), we have \\(\\angle L H K=\\alpha+\\angle N H M=\\alpha+\\pi-\\alpha=\\pi\\), so \\(H\\) lies on \\(K L\\) \n\nSolution 5. Since \\(A D\\) is a diameter, it is well known that \\(D B H C\\) is a parallelogram (indeed, both \\(B D\\) and \\(C H\\) are perpendicular to \\(A B\\), hence parallel, and similarly for \\(D C \\| B H\\) ). Let \\(B^{\\prime}, C^{\\prime}\\) be the reflections of \\(D\\) in lines \\(A K B\\) and \\(A L C\\), respectively; since \\(A B D\\) and \\(A C D\\) are right angles, these are also the factor-2 homotheties of \\(B\\) and \\(C\\) with respect to \\(D\\), hence \\(H\\) is the midpoint of \\(B^{\\prime} C^{\\prime}\\). We will prove that \\(B^{\\prime} K C^{\\prime} L\\) is a parallelogram: it will then follow that the midpoint of \\(B^{\\prime} C^{\\prime}\\), which is \\(H\\), is also the midpoint of \\(K L\\), and in particular is on the line, as we wanted to show.\n\nWe will prove \\(B^{\\prime} K C^{\\prime} L\\) is a parallelogram by showing that \\(B^{\\prime} K\\) and \\(C^{\\prime} L\\) are the same length and direction. Indeed, for lengths we have \\(K B^{\\prime}=K D=L D=L C^{\\prime}\\), where the first and last equalities arise from the reflections defining \\(B^{\\prime}\\) and \\(C^{\\prime}\\), and the middle one\nis equality of tangents. For directions, let \\(\\alpha, \\beta, \\gamma\\) denote the angles of triangle \\(A K L\\). Immediate angle chasing in the circle \\(A K L\\), and the properties of the reflections, yield\n\\[\n\\begin{gathered}\n\\angle C^{\\prime} L C=\\angle C L D=\\angle A K L=\\beta \\\\\n\\angle B K B^{\\prime}=\\angle D K B=\\angle K L A=\\gamma \\\\\n\\angle L D K=2 \\alpha-\\pi\n\\end{gathered}\n\\]\nand therefore in directed angles \\((\\bmod 2 \\pi)\\) we have\n\\(\\angle\\left(C^{\\prime} L, B^{\\prime} K\\right)=\\angle C^{\\prime} L C+\\angle C L D+\\angle L D K+\\angle D K B+\\angle B K B^{\\prime}=2 \\alpha+2 \\beta+2 \\gamma-\\pi=\\pi\\)\nand hence \\(C^{\\prime} L\\) and \\(B^{\\prime} K\\) are parallel and in opposite directions, i.e. \\(C^{\\prime} L\\) and \\(K B^{\\prime}\\) are in the same direction, as claimed. Comment. While not necessary for the final solution, the following related observation motivates how the fact that \\(H\\) is the midpoint of \\(K L\\) (and therefore \\(B^{\\prime} K C^{\\prime} L\\) is a parallelogram) was first conjectured. We have \\(A B^{\\prime}=A D=A C^{\\prime}\\) by the reflections, i.e. \\(B^{\\prime} A C^{\\prime}\\) is an isosceles triangle with \\(H\\) being the midpoint of the base. Thus \\(A H\\) is the median, altitude and angle bisector in \\(B^{\\prime} A C^{\\prime}\\), thus \\(\\angle B^{\\prime} A K+\\angle K A H=\\angle H A L+\\angle L A C^{\\prime}\\). Since from the reflections we also have \\(\\angle B^{\\prime} A K=\\angle K A D\\) and \\(\\angle D A L=\\angle L A C^{\\prime}\\) it follows that \\(\\angle H A L=\\angle K A D\\) and \\(\\angle K A H=\\angle D A L\\). Since \\(D\\) is the symmedian point in \\(A K L\\), the angle conjugation implies \\(A H\\) is the median line of \\(K L\\). Thus, if \\(H\\) is indeed on \\(K L\\) (as the problem assures us), it can only be the midpoint of \\(K L\\).\n\nSolution 6. There are a number of \"phantom point\" arguments which define \\(K^{\\prime}\\) and \\(L^{\\prime}\\) in terms of angles and then deduce that these points are actually \\(K\\) and \\(L\\).\n\nNote: In these solutions it is necessary to show that \\(K\\) and \\(L\\) are uniquely determined by the conditions of the problem. One example of doing this is the following:\n\nTo prove uniqueness of \\(K\\) and \\(L\\), let us consider that there exist two other points \\(K^{\\prime}\\) and \\(L^{\\prime}\\) that satisfy the same properties ( \\(K^{\\prime}\\) on \\(A B\\) and \\(L^{\\prime}\\) on \\(A C\\) such that \\(D K^{\\prime}\\) and \\(D L^{\\prime}\\) are tangent to the circle \\(A K^{\\prime} L^{\\prime}\\) ).\nThen, we have that \\(D K=D L\\) and \\(D K^{\\prime}=D L^{\\prime}\\). We also have that \\(\\angle K D L=\\angle K^{\\prime} D L^{\\prime}= \\pi-2 \\angle A\\). Hence, we deduce \\(\\angle K D K^{\\prime}=\\angle K D L-\\angle K^{\\prime} D L=\\angle K^{\\prime} D L^{\\prime}-\\angle K^{\\prime} D L=\\angle L D L^{\\prime}\\) Thus we have that \\(\\triangle K D K^{\\prime} \\equiv \\triangle L D L^{\\prime}\\), so we deduce \\(\\angle D K A=\\angle D K K^{\\prime}=\\angle D L L^{\\prime}= \\pi-\\angle A L D\\). This implies that \\(A K D L\\) is concyclic, which is clearly a contradiction since \\(\\angle K A L+\\angle K D L=\\pi-\\angle B A C\\).\n\nSolution 7. We will use the usual complex number notation, where we will use a capital letter (like \\(Z\\) ) to denote the point associated to a complex number (like \\(z\\) ). Consider \\(\\triangle A K L\\) on the unit circle. So, we have \\(a \\cdot \\bar{a}=k \\cdot \\bar{k}=l \\cdot \\bar{l}=1\\) As point \\(D\\) is the intersection of the tangents to the unit circle at \\(K\\) and \\(L\\), we have that\n\\[\nd=\\frac{2 k l}{k+l} \\text { and } \\bar{d}=\\frac{2}{k+l}\n\\]\n\nDefining \\(B\\) as the foot of the perpendicular from \\(D\\) on the line \\(A K\\), and \\(C\\) as the foot of the perpendicular from \\(D\\) on the line \\(A L\\), we have the formulas:\n\\[\nb=\\frac{1}{2}\\left(d+\\frac{(a-k) \\bar{d}+\\bar{a} k-a \\bar{k}}{\\bar{a}-\\bar{k}}\\right)\n\\]\n\\[\nc=\\frac{1}{2}\\left(d+\\frac{(a-l) \\bar{d}+\\bar{a} l-a \\bar{l}}{\\bar{a}-\\bar{l}}\\right)\n\\]\n\nSimplyfing these formulas, we get:\n\\[\n\\begin{gathered}\nb=\\frac{1}{2}\\left(d+\\frac{(a-k) \\frac{2}{k+l}+\\frac{k}{a}-\\frac{a}{k}}{\\frac{1}{a}-\\frac{1}{k}}\\right)=\\frac{1}{2}\\left(d+\\frac{\\frac{2(a-k)}{k+l}+\\frac{k^{2}-a^{2}}{a k}}{\\frac{k-a}{a k}}\\right) \\\\\nb=\\frac{1}{2}\\left(\\frac{2 k l}{k+l}-\\frac{2 a k}{k+l}+(a+k)\\right)=\\frac{k(l-a)}{k+l}+\\frac{1}{2}(k+a) \\\\\nc=\\frac{1}{2}\\left(d+\\frac{(a-l) \\frac{2}{k+l}+\\frac{l}{a}-\\frac{a}{l}}{\\frac{1}{a}-\\frac{1}{l}}\\right)=\\frac{1}{2}\\left(d+\\frac{\\frac{2(a-l)}{k+l}+\\frac{l^{2}-a^{2}}{a l}}{\\frac{l-a}{a l}}\\right) \\\\\nc=\\frac{1}{2}\\left(\\frac{2 k l}{k+l}-\\frac{2 a l}{k+l}+(a+l)\\right)=\\frac{l(k-a)}{k+l}+\\frac{1}{2}(l+a)\n\\end{gathered}\n\\]\n\nLet \\(O\\) be the the circumcenter of triangle \\(\\triangle A B C\\). As \\(A D\\) is the diameter of this circle, we have that:\n\\[\no=\\frac{a+d}{2}\n\\]\n\nDefining \\(H\\) as the orthocentre of the \\(\\triangle A B C\\), we get that:\n\\[\n\\begin{gathered}\nh=a+b+c-2 \\cdot o=a+\\left(\\frac{k(l-a)}{k+l}+\\frac{1}{2}(k+a)\\right)+\\left(\\frac{l(k-a)}{k+l}+\\frac{1}{2}(l+a)\\right)-(a+d) \\\\\nh=a+\\frac{2 k l}{k+l}-\\frac{a(k+l)}{k+l}+\\frac{1}{2} k++\\frac{1}{2} l++a-\\left(a+\\frac{2 k l}{k+l}\\right) \\\\\nh=\\frac{1}{2}(k+l)\n\\end{gathered}\n\\]\n\nHence, we conclude that \\(H\\) is the midpoint of \\(K L\\), so \\(H, K, L\\) are collinear.\n\nSolution 8. Let us employ the barycentric coordinates. Set \\(A(1,0,0), K(0,1,0), L(0,0,1)\\). The tangent at \\(K\\) of ( \\(A K L\\) ) is \\(a^{2} z+c^{2} x=0\\), and the tangent of of \\(L\\) at ( \\(A K L\\) ) is \\(a^{2} y+b^{2} x=0\\). Their intersection is\n\\[\nD\\left(-a^{2}: b^{2}: c^{2}\\right)\n\\]\n\nSince \\(B \\in A K\\), we can let \\(B(1-t, t, 0)\\). Solving for \\(\\overrightarrow{A B} \\cdot \\overrightarrow{B D}=0\\) gives\n\\[\nt=\\frac{3 b^{2}+c^{2}-a^{2}}{2\\left(b^{2}+c^{2}-a^{2}\\right)} \\Longrightarrow B=\\left(\\frac{-a^{2}-b^{2}+c^{2}}{2\\left(b^{2}+c^{2}-a^{2}\\right)}, \\frac{-a^{2}+3 b^{2}+c^{2}}{2\\left(b^{2}+c^{2}-a^{2}\\right)}, 0\\right)\n\\]\n\nLikewise, \\(C\\) has the coordinate\n\\[\nC=\\left(\\frac{-a^{2}+b^{2}-c^{2}}{2\\left(b^{2}+c^{2}-a^{2}\\right)}, 0, \\frac{-a^{2}+b^{2}+3 c^{2}}{2\\left(b^{2}+c^{2}-a^{2}\\right)}\\right)\n\\]\n\nThe altitude from \\(B\\) for triangle \\(A B C\\) is\n\\[\n-b^{2}\\left(x-z-\\frac{-a^{2}-b^{2}+c^{2}}{2\\left(b^{2}+c^{2}-a^{2}\\right)}\\right)+\\left(c^{2}-a^{2}\\right)\\left(y-\\frac{-a^{2}+3 b^{2}+c^{2}}{2\\left(b^{2}+c^{2}-a^{2}\\right)}\\right)=0\n\\]\n\nAlso the altitude from \\(C\\) for triangle \\(A B C\\) is\n\\[\n-c^{2}\\left(x-y-\\frac{-a^{2}+b^{2}-c^{2}}{2\\left(b^{2}+c^{2}-a^{2}\\right)}\\right)+\\left(a^{2}-b^{2}\\right)\\left(z-\\frac{-a^{2}+b^{2}+3 c^{2}}{2\\left(b^{2}+c^{2}-a^{2}\\right)}\\right)=0 .\n\\]\n\nThe intersection of these two altitudes, which is the orthocenter of triangle \\(A B C\\), has the barycentric coordinate\n\\[\nH=(0,1 / 2,1 / 2),\n\\]\nwhich is the midpoint of the segment \\(K L\\).", "source_pdf": "egmo_2023.pdf", "notes": "fallback-regex"}
{"id": "EGMO-2023-3", "contest": "EGMO", "year": "2023", "problem_number": "3", "problem": "Let \\(k\\) be a positive integer. Lexi has a dictionary \\(\\mathcal{D}\\) consisting of some \\(k\\)-letter strings containing only the letters \\(A\\) and \\(B\\). Lexi would like to write either the letter \\(A\\) or the letter \\(B\\) in each cell of a \\(k \\times k\\) grid so that each column contains a string from \\(\\mathcal{D}\\) when read from top-to-bottom and each row contains a string from \\(\\mathcal{D}\\) when read from left-to-right.\n\nWhat is the smallest integer \\(m\\) such that if \\(\\mathcal{D}\\) contains at least \\(m\\) different strings, then Lexi can fill her grid in this manner, no matter what strings are in \\(\\mathcal{D}\\) ?", "solution": "We claim the minimum value of \\(m\\) is \\(2^{k-1}\\).\nFirstly, we provide a set \\(\\mathcal{S}\\) of size \\(2^{k-1}-1\\) for which Lexi cannot fill her grid. Consider the set of all length- \\(k\\) strings containing only \\(A\\) s and \\(B\\) s which end with a \\(B\\), and remove the string consisting of \\(k B\\) s. Clearly there are 2 independent choices for each of the first \\(k-1\\) letters and 1 for the last letter, and since exactly one string is excluded, there must be exactly \\(2^{k-1}-1\\) strings in this set.\n\nSuppose Lexi tries to fill her grid. For each row to have a valid string, it must end in a \\(B\\). But then the right column would necessarily contain \\(k B s\\), and not be in our set. Thus, Lexi cannot fill her grid with our set, and we must have \\(m \\geqslant 2^{k-1}\\).\n\nNow, consider any set \\(\\mathcal{S}\\) with at least \\(2^{k-1}\\) strings. Clearly, if \\(\\mathcal{S}\\) contained either the uniform string with \\(k A\\) s or the string with \\(k B\\) s, then Lexi could fill her grid with all of the relevant letters and each row and column would contain that string.\n\nConsider the case where \\(\\mathcal{S}\\) contains neither of those strings. Among all \\(2^{k}\\) possible length\\(k\\) strings with \\(A\\) s and \\(B\\) s, each has a complement which corresponds to the string with \\(B\\) s in every position where first string had \\(A\\) s and vice-versa. Clearly, the string with all \\(A\\) s is paired with the string with all \\(B\\) s. We may assume that we do not take the two uniform strings and thus applying the pigeonhole principle to the remaining set of strings, we must have two strings which are complementary.\n\nLet this pair of strings be \\(\\ell, \\ell^{\\prime} \\in \\mathcal{S}\\) in some order. Define the set of indices \\(\\mathcal{J}\\) corresponding to the \\(A\\) s in \\(\\ell\\) and thus the \\(B\\) s in \\(\\ell^{\\prime}\\), and all other indices (not in \\(\\mathcal{J}\\) ) correspond to \\(B\\) s in \\(\\ell\\) (and thus \\(A\\) s in \\(\\ell^{\\prime}\\) ). Then, we claim that Lexi puts an \\(A\\) in the cell in row \\(r\\), column \\(c\\) if \\(r, c \\in \\mathcal{J}\\) or \\(r, c \\notin \\mathcal{J}\\), and a \\(B\\) otherwise, each row and column contains a string in \\(\\mathcal{S}\\).\n\nWe illustrate this with a simple example: If \\(k=6\\) and we have that \\(A A A B A B\\) and \\(B B B A B A\\) are both in the dictionary, then Lexi could fill the table as follows:\n\n\\begin{tabular}{|c|c|c|c|c|c|}\n\\hline A & A & A & B & A & B \\\\\n\\hline A & A & A & B & A & B \\\\\n\\hline A & A & A & B & A & B \\\\\n\\hline B & B & B & A & B & A \\\\\n\\hline A & A & A & B & A & B \\\\\n\\hline B & B & B & A & B & A \\\\\n\\hline\n\\end{tabular}\n\nSuppose we are looking at row \\(i\\) or column \\(i\\) for \\(i \\in \\mathcal{J}\\). Then by construction the string in this row/column contains \\(A\\) s at indices \\(k\\) with \\(k \\in \\mathcal{J}\\) and \\(B\\) s elsewhere, and thus is precisely \\(\\ell\\). Suppose instead we are looking at row \\(i\\) or column \\(i\\) for \\(i \\notin \\mathcal{J}\\). Then again\nby construction the string in this row/column contains \\(A\\) s at indices \\(k\\) with \\(k \\notin \\mathcal{J}\\) and \\(B\\) s elsewhere, and thus is precisely \\(\\ell^{\\prime}\\). So each row and column indeed contains a string in \\(\\mathcal{S}\\).\nThus, for any \\(\\mathcal{S}\\) with \\(|\\mathcal{S}| \\geqslant 2^{k-1}\\), Lexi can definitely fill the grid appropriately. Since we know \\(m \\geqslant 2^{k-1}, 2^{k-1}\\) is the minimum possible value of \\(m\\) as claimed.", "source_pdf": "egmo_2023.pdf", "notes": "fallback-regex"}
{"id": "EGMO-2023-5", "contest": "EGMO", "year": "2023", "problem_number": "5", "problem": "We are given a positive integer \\(s \\geqslant 2\\). For each positive integer \\(k\\), we define its twist \\(k^{\\prime}\\) as follows: write \\(k\\) as \\(a s+b\\), where \\(a, b\\) are non-negative integers and \\(b<s\\), then \\(k^{\\prime}=b s+a\\). For the positive integer \\(n\\), consider the infinite sequence \\(d_{1}, d_{2}, \\ldots\\) where \\(d_{1}=n\\) and \\(d_{i+1}\\) is the twist of \\(d_{i}\\) for each positive integer \\(i\\).\n\nProve that this sequence contains 1 if and only if the remainder when \\(n\\) is divided by \\(s^{2}-1\\) is either 1 or \\(s\\).", "solution": "Solution 1. First, we consider the difference \\(k-k^{\\prime \\prime}\\). If \\(k=a s+b\\) as in the problem statement, then \\(k^{\\prime}=b s+a\\). We write \\(a=l s+m\\) with \\(m, l\\) non-negative numbers and \\(m \\leq s-1\\). This gives \\(k^{\\prime \\prime}=m s+(b+l)\\) and hence \\(k-k^{\\prime \\prime}=(a-m) s-l=l\\left(s^{2}-1\\right)\\).\n\nWe conclude\nFact 1.1. \\(k \\geq k^{\\prime \\prime}\\) for every every \\(k \\geq 1\\)\nFact 1.2. \\(s^{2}-1\\) divides the difference \\(k-k^{\\prime \\prime}\\).\nFact 1.2 implies that the sequences \\(d_{1}, d_{3}, d_{5}, \\ldots\\) and \\(d_{2}, d_{4}, d_{6}, \\ldots\\) are constant modulo \\(s^{2}-1\\). Moreover, Fact 1.1 says that the sequences are (weakly) decreasing and hence eventually constant. In other words, the sequence \\(d_{1}, d_{2}, d_{3}, \\ldots\\) is 2 -periodic modulo \\(s^{2}-1\\) (from the start) and is eventually 2 -periodic.\n\nNow, assume that some term in the sequence is equal to 1 . The next term is equal to \\(1^{\\prime}=s\\) and since the sequence is 2 -periodic from the start modulo \\(s^{2}-1\\), we conclude that \\(d_{1}\\) is either equal to 1 or \\(s\\) modulo \\(s^{2}-1\\). This proves the first implication.\n\nTo prove the other direction, assume that \\(d_{1}\\) is congruent to 1 or \\(s\\) modulo \\(s^{2}-1\\). We need the observation that once one of the sequences \\(d_{1}, d_{3}, d_{5}, \\ldots\\) or \\(d_{2}, d_{4}, d_{6}, \\ldots\\) stabilises, then their value is less than \\(s^{2}\\). This is implied by the following fact.\n\nFact 1.3. If \\(k=k^{\\prime \\prime}\\), then \\(k=k^{\\prime \\prime}<s^{2}\\).\n\nProof. We use the expression for \\(k-k^{\\prime \\prime}\\) found before. If \\(k=k^{\\prime \\prime}\\), then \\(l=0\\), and so \\(k^{\\prime \\prime}=m s+b\\). Both \\(m\\) and \\(b\\) are reminders after division by \\(s\\), so they are both \\(\\leq s-1\\). This gives \\(k^{\\prime \\prime} \\leq(s-1) s+(s-1)<s^{2}\\).\n\nUsing Fact 1.2, it follows that the sequence \\(d_{1}, d_{3}, d_{5}, \\ldots\\) is constant to 1 or \\(s\\) modulo \\(s^{2}-1\\) and stabilises to 1 or \\(s\\) by Fact 1.3. Since \\(s^{\\prime}=1\\), we conclude that the sequence contains a 1 .\n\nSolution 2. We make a number of initial observations. Let \\(k\\) be a positive integer.\nFact 2.1. If \\(k \\geq s^{2}\\), then \\(k^{\\prime}<k\\).\nProof. Write \\(k=a s+b\\), as in the problem statement. If \\(k \\geq s^{2}\\), then \\(a \\geq s\\) because \\(b<s\\). So, \\(k^{\\prime}=b s+a \\leq(s-1) s+a \\leq a s \\leq a s+b=k\\). Moreover, we cannot have equality since that would imply \\(s-1=b=0\\).\n\nFact 2.2. If \\(k \\leq s^{2}-1\\), then \\(k^{\\prime} \\leq s^{2}-1\\) and \\(k^{\\prime \\prime}=k\\).\n\nProof. Write \\(k=a s+b\\), as in the problem statement. If \\(k<s^{2}\\), then it must hold \\(1 \\leq a, b<s\\), hence \\(k^{\\prime}=b s+a<s^{2}\\) and \\(k^{\\prime \\prime}=(b s+a)^{\\prime}=a s+b=k\\).\n\nFact 2.3. We have \\(k^{\\prime} \\equiv s k\\left(\\bmod s^{2}-1\\right)\\left(\\right.\\) or equivalently \\(\\left.k \\equiv s k^{\\prime}\\left(\\bmod s^{2}-1\\right)\\right)\\).\nProof. We write \\(k=a s+b\\), as in the problem statement. Now,\n\\[\ns k-k^{\\prime}=s(a s+b)-(b s+a)=a\\left(s^{2}-1\\right) \\equiv 0 \\quad\\left(\\bmod s^{2}-1\\right),\n\\]\nas desired.\n\nCombining Facts 2.1 and 2.2, we find that the sequence \\(d_{1}, d_{2}, d_{3} \\ldots\\) is eventually periodic with period 2 , starting at the first value less than \\(s^{2}\\). From Fact 2.3 , it follows that\n\\[\nk^{\\prime \\prime} \\equiv s k^{\\prime} \\equiv s^{2} k \\equiv k \\quad\\left(\\bmod s^{2}-1\\right)\n\\]\nand hence the sequence is periodic modulo \\(s^{2}-1\\) from the start with period 2 .\n\nNow, if the sequence contains 1 , the sequence eventually alternates between 1 and \\(s\\) since the twist of 1 is \\(s\\) and vice versa. Using periodicity modulo \\(s^{2}-1\\), we must have \\(n \\equiv 1, s \\left(\\bmod s^{2}-1\\right)\\). Conversely, if \\(n \\equiv 1, s\\left(\\bmod s^{2}-1\\right)\\) then the eventual period must contain at least one value congruent to either 1 or \\(s\\) modulo \\(s^{2}-1\\). Since these values must be less than \\(s^{2}\\), this implies that the sequence eventually alternates between 1 and \\(s\\), showing that it contains a 1 .\n\nSolution 3. We give an alternate proof of the direct implication: if the sequence contains a 1 , then the first term is 1 or \\(s\\) modulo \\(s^{2}-1\\). We prove the following fact, which is a combination of Facts 2.1 and 2.3.\n\nFact 3.1. For all \\(k \\geq s^{2}\\), we have \\(\\left(k-s^{2}+1\\right)^{\\prime} \\in\\left\\{k^{\\prime}, k^{\\prime}-s^{2}+1\\right\\}\\).\nProof. We write \\(k=a s+b\\), as in the problem statement. Since \\(k \\geq s^{2}\\), we have \\(a \\geq s\\). If \\(b<s-1\\), then\n\\[\n\\left(k-s^{2}+1\\right)^{\\prime}=((a-s) s+(b+1))^{\\prime}=(b+1) s+(a-s)=b s+a=k^{\\prime}\n\\]\n\nOn the other hand, if \\(b=s-1\\), then\n\\[\n\\left(k-s^{2}+1\\right)^{\\prime}=((a-s+1) s+0)^{\\prime}=0 s+(a-s+1)=a-s+1=k^{\\prime}-s^{2}+1\n\\]\n\nNow assume \\(n \\geq s^{2}\\) and the sequence \\(d_{1}, d_{2}, \\ldots\\) contains a 1 . Denote by \\(e_{1}, e_{2}, \\ldots\\) the sequence constructed as in the problem statement, but with initial value \\(e_{1}=n-s^{2}+1\\). Using the above fact, we deduce that \\(e_{i} \\equiv d_{i}\\left(\\bmod s^{2}-1\\right)\\) and \\(e_{i} \\leq d_{i}\\) for all \\(i \\geq 1\\) by induction on \\(i\\). Hence, the sequence \\(e_{1}, e_{2}, \\ldots\\) also contains a 1 .\n\nSince the conclusion we are trying to reach only depends on the residue of \\(d_{1}\\) modulo \\(s^{2}-1\\), we conclude that without loss of generality we can assume \\(n<s^{2}\\).\n\nUsing Fact 2.2, it now follows that the sequence \\(d_{1}, d_{2}, \\ldots\\) is periodic with period two. Since 1 and \\(s\\) are twists of each other, it follows that if this sequence contains a 1 , it must be alternating between 1 and \\(s\\). Hence, \\(d_{1} \\equiv 1, s\\left(\\bmod s^{2}-1\\right)\\) as desired.\n\nFor the other direction we can make a similar argument, observing that the second of the two cases in the proof of Fact 3.1 can only apply to finitely many terms of the sequence \\(d_{1}, d_{2}, d_{3}, \\ldots\\), allowing us to also go the other way.\n\nSolution 4. First assume that \\(d_{k}=1\\) for some \\(k\\). Let \\(k\\) be the smallest such index. If \\(k=1\\) then \\(n=1\\), so we may assume \\(k \\geqslant 2\\).\n\nThen \\(d_{k-1}=a s+b\\) for some non-negative integers \\(a, b\\) satisfying \\(b<s\\) and \\(b s+a=1\\). The only solution is \\(b=0, a=1\\), so \\(d_{k-1}=s\\). So, if \\(k=2\\), then \\(n=s\\), so we may assume \\(k \\geqslant 3\\).\n\nThen there exist non-negative integers \\(c, d\\) satisfying \\(d_{k-2}=c s+d, d<s\\) and \\(d s+c=s\\). We have two solutions: \\(d=0, c=s\\) and \\(d=1, c=0\\). However, in the second case we get \\(d_{k-2}=1\\), which contradicts the minimality of \\(k\\). Hence, \\(d_{k-2}=s^{2}\\). If \\(k=3\\), then \\(n=d_{1}=s^{2}\\), which gives remainder 1 when divided by \\(s^{2}-1\\).\n\nAssume now that \\(k \\geqslant 4\\). We will show that for each \\(m \\in\\{3,4, \\ldots, k-1\\}\\) there exist \\(b_{1}, b_{2}, \\ldots, b_{m-2} \\in\\{0,1, \\ldots, s-1\\}\\) such that\n\\[\nd_{k-m}=s^{m}-\\sum_{i=1}^{m-2} b_{i}\\left(s^{m-i}-s^{m-i-2}\\right)\n\\]\n\nWe will prove this equality by induction on \\(m\\). If \\(m=3\\), then \\(d_{k-3}=a_{1} s+b_{1}\\) for some non-negative integers \\(a_{1}, b_{1}\\) satisfying \\(b_{1}<s\\) and \\(b_{1} s+a_{1}=d_{k-2}=s^{2}\\). Then \\(a_{1}=s^{2}-b_{1} s\\), so \\(d_{k-3}=s^{3}-b_{1}\\left(s^{2}-1\\right)\\), which proves (9) for \\(m=3\\).\n\nAssume that (9) holds for some \\(m\\) and consider \\(d_{k-(m+1)}\\). There exist non-negative integers \\(a_{m-1}, b_{m-1}\\) such that \\(d_{k-(m+1)}=a_{m-1} s+b_{m-1}, b_{m-1}<s\\) and \\(d_{k-m}=b_{m-1} s+a_{m-1}\\). Using the inductive assumption we get\n\\[\na_{m-1}=d_{k-m}-b_{m-1} s=s^{m}-\\sum_{i=1}^{m-2} b_{i}\\left(s^{m-i}-s^{m-i-2}\\right)-b_{m-1} s,\n\\]\ntherefore\n\\[\n\\begin{aligned}\nd_{k-(m+1)} & =a_{m-1} s+b_{m-1}=s^{m+1}-\\sum_{i=1}^{m-2} b_{i}\\left(s^{m-i}-s^{m-i-2}\\right) s-b_{m-1} s^{2}+b_{m-1} \\\\\n& =s^{m+1}-\\sum_{i=1}^{m-1} b_{i}\\left(s^{m+1-i}-s^{m-i-1}\\right)\n\\end{aligned}\n\\]\nwhich completes the proof of (9). In particular, for \\(m=k-1\\) we get\n\\[\nd_{1}=s^{k-1}-\\sum_{i=1}^{k-3} b_{i}\\left(s^{k-i-1}-s^{k-i-3}\\right) .\n\\]\n\nThe above sum is clearly divisible by \\(s^{2}-1\\), and it is clear that the remainder of \\(s^{k-1}\\) when divided by \\(s^{2}-1\\) is 1 when \\(k\\) is odd, and \\(s\\) when \\(k\\) is even. It follows that the remainder when \\(n=d_{1}\\) is divided by \\(s^{2}-1\\) is either 1 or \\(s\\).\n\nTo prove the other implication, assume that \\(n\\) gives remainder 1 or \\(s\\) when divided by \\(s^{2}-1\\). If \\(n \\in\\left\\{1, s, s^{2}\\right\\}\\), then one of the numbers \\(d_{1}, d_{2}\\) and \\(d_{3}\\) is 1 . We therefore assume that \\(n>s^{2}\\). Since the reminder when a power of \\(s\\) is divided by \\(s^{2}-1\\) is either 1 or \\(s\\), there exists a positive integer \\(m\\) such that \\(s^{m}-n\\) is non-negative and divisible by \\(s^{2}-1\\). By our assumption \\(m \\geqslant 3\\). We also take the smallest such \\(m\\), so that \\(n>s^{m-2}\\). The quotient \\(\\frac{s^{m}-n}{s^{2}-1}\\) is therefore smaller than \\(s^{m-2}\\), so there exist \\(b_{1}, \\ldots, b_{m-2} \\in\\{0,1, \\ldots, s-1\\}\\) such that \\(\\frac{s^{m}-n}{s^{2}-1}=\\sum_{i=1}^{m-2} b_{i} s^{i-1}\\). It follows that\n\\[\nn=s^{m}-\\sum_{i=1}^{m-2} b_{i}\\left(s^{i+1}-s^{i-1}\\right)\n\\]\n\nWe now show that\n\\[\nd_{j}=s^{m+1-j}-\\sum_{i=1}^{m-1-j} b_{i}\\left(s^{i+1}-s^{i-1}\\right)\n\\]\nfor \\(j=1,2, \\ldots, m-2\\) by induction on \\(j\\). For \\(j=1\\) this follows from \\(d_{1}=n\\). Assume now that (10) holds for some \\(j<m-2\\). Then\n\\[\nd_{j}=\\left(s^{m-j}-\\sum_{i=2}^{m-1-j} b_{i}\\left(s^{i}-s^{i-2}\\right)-b_{1} s\\right) s+b_{1} .\n\\]\n\nAs \\(d_{j}\\) is positive and \\(b_{1} \\in\\{0,1, \\ldots, s-1\\}\\), the expression \\(s^{m-j}-\\sum_{i=2}^{m-1-j} b_{i}\\left(s^{i}-s^{i-2}\\right)-b_{1} s\\) has to be non-negative, so we can compute the twist of \\(d_{j}\\) as\n\\[\nd_{j+1}=b_{1} s+s^{m-j}-\\sum_{i=2}^{m-1-j} b_{i}\\left(s^{i}-s^{i-2}\\right)-b_{1} s=s^{m-j}-\\sum_{i=1}^{m-2-j} b_{i}\\left(s^{i+1}-s^{i-1}\\right),\n\\]\nwhich finishes the induction.\nNow we use (10) for \\(j=m-2\\) and get \\(d_{m-2}=s^{3}-b_{1}\\left(s^{2}-1\\right)=\\left(s^{2}-b_{1} s\\right)+b_{1}\\). Then \\(d_{m-1}=b_{1} s+s^{2}-b_{1} s=s^{2}=s \\cdot s+0, d_{m}=0 \\cdot s+s=s=1 \\cdot s+0\\) and \\(d_{m+1}=0 \\cdot s+1=1\\).", "source_pdf": "egmo_2023.pdf", "notes": "fallback-regex"}
{"id": "EGMO-2023-6", "contest": "EGMO", "year": "2023", "problem_number": "6", "problem": "Let \\(A B C\\) be a triangle with circumcircle \\(\\Omega\\). Let \\(S_{b}\\) and \\(S_{c}\\) respectively denote the midpoints of the arcs \\(A C\\) and \\(A B\\) that do not contain the third vertex. Let \\(N_{a}\\) denote the midpoint of \\(\\operatorname{arc} B A C\\) (the \\(\\operatorname{arc} B C\\) containing \\(A\\) ). Let \\(I\\) be the incentre of \\(A B C\\). Let \\(\\omega_{b}\\) be the circle that is tangent to \\(A B\\) and internally tangent to \\(\\Omega\\) at \\(S_{b}\\), and let \\(\\omega_{c}\\) be the circle that is tangent to \\(A C\\) and internally tangent to \\(\\Omega\\) at \\(S_{c}\\). Show that the line \\(I N_{a}\\), and the line through the intersections of \\(\\omega_{b}\\) and \\(\\omega_{c}\\), meet on \\(\\Omega\\).\n\nThe incentre of a triangle is the centre of its incircle, the circle inside the triangle that is tangent to all three sides.", "solution": "\\begin{figure}\n\\includegraphics[width=\\textwidth]{https://cdn.mathpix.com/cropped/2025_08_23_146291bab5ef73d6732cg-23.jpg?height=989&width=1111&top_left_y=805&top_left_x=471}\n\\captionsetup{labelformat=empty}\n\\caption{Figure 6: Diagram to Solution 1}\n\\end{figure}\n\nSolution 1. Part I: First we show that A lies on the radical axis of \\(\\omega_{b}\\) and \\(\\omega_{c}\\).\nWe first note that the line through the intersections of two circles is the radical line of the two circles. Let the tangents to \\(\\Omega\\) at \\(S_{b}\\) and \\(S_{c}\\) intersect at \\(T\\). Clearly \\(T\\) is on the radical axis of \\(\\omega_{b}\\) and \\(\\omega_{c}\\) (and in fact is the radical centre of \\(\\omega_{b}, \\omega_{c}\\) and \\(\\Omega\\) ).\n\nWe next show that \\(A\\) lies on the radical axis of \\(\\omega_{b}\\) and \\(\\omega_{c}\\). Let \\(P_{b}\\) denote the point of tangency of \\(\\omega_{b}\\) and \\(A B\\), and let \\(P_{c}\\) denote the point of tangency of \\(\\omega_{c}\\) and \\(A C\\). Furthermore, let \\(U\\) be the intersection of the tangent to \\(\\Omega\\) at \\(S_{b}\\) with the line \\(A B\\), and let \\(V\\) be the intersection of the tangent to \\(\\Omega\\) at \\(S_{c}\\) with the line \\(A C\\). Then \\(T V A U\\) is parallelogram. Morover, due to equality of tangent segments we have \\(\\left|U S_{b}\\right|=\\left|U P_{b}\\right|,\\left|V P_{c}\\right|=\\left|V S_{c}\\right|\\) and \\(\\left|T S_{b}\\right|=\\left|T S_{c}\\right|\\). It follows that\n\\[\n\\begin{aligned}\n\\left|A P_{b}\\right| & =\\left|U P_{b}\\right|-|U A|=\\left|U S_{b}\\right|-|T V|=\\left|T S_{b}\\right|-|T U|-|T V| \\\\\n& =\\left|T S_{s}\\right|-|T V|-|T U|=\\left|V S_{c}\\right|-|A V|=\\left|V P_{c}\\right|-|V A|=\\left|A P_{c}\\right|\n\\end{aligned}\n\\]\n\nBut \\(\\left|A P_{b}\\right|,\\left|A P_{c}\\right|\\) are exactly the square roots of powers of \\(A\\) with respect to \\(\\omega_{b}\\) and \\(\\omega_{c}\\), hence \\(A\\) is indeed on their radical axis.\n\nThus, the radical axis of \\(\\omega_{b}, \\omega_{c}\\) is \\(A T\\).\nPart II: Consider the triangle \\(A S_{b} S_{c}\\). Note that since \\(T\\) is the intersection of the tangents at \\(S_{b}\\) and \\(S_{c}\\) to the circumcircle of \\(A S_{b} S_{c}\\), it follows that \\(A T\\) is the symmedian of \\(A\\) in this triangle. Let \\(X\\) denote the second intersection of the symmedian \\(A T\\) with \\(\\Omega\\). We wish to show that \\(X\\) is also on \\(I N_{a}\\).\n\nNote that \\(A N_{a}\\) is the external angle bisector of angle \\(A\\), and therefore it is parallel to \\(S_{b} S_{c}\\). Let \\(M\\) denote the midpoint of \\(S_{b} S_{c}\\), and let \\(Y\\) be the second intersection of \\(A M\\) with \\(\\Omega\\). Since in \\(A S_{b} S_{c}, A X T\\) is the symmedian and \\(A M Y\\) is the median, it follows that \\(X Y\\) is also parallel to \\(S_{b} S_{c}\\). Thus, reflecting in the perpendicular bisector of \\(S_{b} S_{c}\\) sends the line \\(A M Y\\) to line \\(N_{a} M X\\).\n\nNext, consider the quadrilateral \\(A S_{b} I S_{c}\\). From the trillium theorem we have \\(\\left|S_{b} A\\right|=\\left|S_{b} I\\right|\\) and \\(\\left|S_{c} A\\right|=\\left|S_{c} I\\right|\\), thus the quadrilateral is a kite, from which it follows that the reflection of the line \\(A M\\) in \\(S_{b} S_{c}\\) is the line \\(I M\\). But previously we have seen that this is also the line \\(N_{a} M X\\). Thus \\(M, I, N_{a}\\) and \\(X\\) are collinear, as we wanted to show.\n\nSolution 2. This is a variation of Solution 1 which avoids the theory of the symmedian point.\n\nWe begin by showing that the radical axis of \\(\\omega_{b}, \\omega_{c}\\) is \\(A T\\) as in Solution 1 .\nPart II: We introduce the point \\(S_{a}\\) with the obvious meaning. Observe that the incentre \\(I\\) of \\(A B C\\) is the orthocentre of \\(S_{a} S_{b} S_{c}\\) either because this is well-known, or because of an angle argument that \\(A\\) reflects in \\(S_{b} S_{c}\\) to \\(I\\) (and similar results by cyclic change of letters). Therefore \\(A S_{a}\\) is perpendicular to \\(S_{b} S_{c}\\).\n\n\\begin{figure}\n\\includegraphics[width=\\textwidth]{https://cdn.mathpix.com/cropped/2025_08_23_146291bab5ef73d6732cg-24.jpg?height=786&width=1494&top_left_y=1690&top_left_x=237}\n\\captionsetup{labelformat=empty}\n\\caption{Figure 7: A reflections argument for Solution 2}\n\\end{figure}\n\nLet \\(M\\) denote the midpoint of \\(S_{b} S_{c}\\). Then \\(A\\) is the reflection of \\(S_{a}\\) in the diameter parallel to \\(S_{b} S_{c}\\), so the reflection of \\(A\\) in the diameter perpendicular to \\(S_{b} S_{c}\\) is \\(N_{a}\\), the antipode\nof \\(S_{a}\\). Let the reflection of \\(X\\) in \\(T M\\) be \\(Y\\), so \\(T Y\\) passes through \\(N_{a}\\) and is the reflection of \\(T X\\) in \\(T M\\).\n\nNow \\(S_{b} S_{c}\\) is the polar line of \\(T\\) with respect to \\(\\Omega\\), so \\(A Y\\) and \\(N_{a} X\\) meet on this line, and by symmetry at its midpoint \\(M\\). The line \\(N_{a} M X\\) is therefore the reflection of the line \\(Y M A\\) in \\(S_{b} S_{c}\\), and so \\(N_{a} M X\\) passes through \\(I\\) (the reflection of \\(A\\) in \\(S_{b} S_{c}\\) ).\n\nThe triangle \\(A S_{c} S_{b}\\) can be taken as generic, and from the argument above we can extract the fact that the symmedian point and the centroid are isogonal conjugates in that triangle.\n\nSolution 3. Assume the notation from Solution 1, part I of Solution 1, and let \\(O\\) be the centre of \\(\\Omega\\).\n\n\\begin{figure}\n\\includegraphics[width=\\textwidth]{https://cdn.mathpix.com/cropped/2025_08_23_146291bab5ef73d6732cg-25.jpg?height=1186&width=1101&top_left_y=942&top_left_x=479}\n\\captionsetup{labelformat=empty}\n\\caption{Figure 8: Diagram to Solution 3}\n\\end{figure}\n\nPart II: As in Solution 1, by the trillelium theorem, \\(S_{c} S_{b}\\) bisects \\(A I\\), and since \\(N_{a} A \\| S_{b} S_{c}\\), then \\(O T\\) is a bisector of \\(A N_{a}\\). This implies \\(\\left|M N_{a}\\right|=|M A|=|M I|\\), since \\(M\\) is the midpoint of \\(S_{c} S_{b}\\) and lies also on \\(O T\\). Hence, \\(M\\) is the circumcentre of triangle \\(I A N_{a}\\). But this triangle has a right angle at \\(A\\) (since \\(A I\\) and \\(A N_{a}\\) are the inner and outer angle bisector at \\(A\\) ), hence \\(M\\) lies on \\(I N_{a}\\).\n\nAgain, let \\(X\\) be the second intersection of \\(T A\\) and \\(\\Omega\\). By the above, it suffices to prove that \\(X\\) lies on the line \\(N_{a} M\\). From the power of point \\(T\\) with respect to \\(\\Omega\\) we get \\(|T A| \\cdot|T X|=\\left|T S_{c}\\right|^{2}\\). Since \\(M\\) is the foot of the altitude of right triangle \\(T S_{c} O\\), we obtain\n\\(\\left|T S_{c}\\right|^{2}=|T M| \\cdot|T O|\\). Hence, \\(|T A| \\cdot|T X|=|T M| \\cdot|T O|\\) so the points \\(O, M, A, X\\) are concyclic. It follows that \\(\\angle M X A=\\angle M O A=\\frac{1}{2} \\angle N_{a} O A=\\angle N_{a} X A\\). Hence, \\(X\\) lies on the line \\(N_{a} M\\).\n\nRemark. To show that \\(O M A X\\) is cyclic, one can also invert the line \\(T A X\\) in the circumcircle of the triangle \\(A B C\\).\n\nSolution 4. Part I is done as in solution 1.\n\n\\begin{figure}\n\\includegraphics[width=\\textwidth]{https://cdn.mathpix.com/cropped/2025_08_23_146291bab5ef73d6732cg-26.jpg?height=1097&width=1249&top_left_y=722&top_left_x=399}\n\\captionsetup{labelformat=empty}\n\\caption{Figure 9: Diagram to Solution 4}\n\\end{figure}\n\nPart II: as in Solution 1 we show that \\(A N_{a} \\| S_{b} S_{c}\\). In particular, \\(\\angle N_{a} O T=\\angle T O A\\). The conclusion of the problem trivially holds if \\(|A B|=|A C|\\), therefore we assume without loss of generality that \\(|A C|>|A B|\\). Let \\(S_{a}\\) be the midpoint of the arc \\(B C\\) which does not contain \\(A\\). Then \\(N_{a} S_{a}\\) is a diameter, so \\(\\angle S_{a} B N_{a}=\\frac{\\pi}{2}=\\angle O S_{c} T\\). We also compute \\(\\angle B N_{a} S_{a}=\\angle B A S_{a}=\\frac{1}{2} \\angle B A C=\\frac{1}{2} \\angle S_{c} T S_{b}=\\angle S_{c} T O\\). It follows that the triangles \\(T S_{c} O\\) and \\(N_{a} B S_{a}\\) are similar. In particular,\n\\[\n\\frac{\\left|N_{a} B\\right|}{\\left|T S_{c}\\right|}=\\frac{\\left|S_{a} B\\right|}{\\left|O S_{c}\\right|} .\n\\]\n\nNext we compute\n\\[\n\\angle I S_{a} B=\\angle N_{a} S_{a} B-\\angle N_{a} S_{a} I=\\angle T O S_{c}-\\frac{1}{2} \\angle N_{a} O A=\\angle T O S_{c}-\\angle T O A=\\angle A O S_{c}\n\\]\nand\n\\(\\angle I B N_{a}=\\angle C B N_{a}-\\angle C B I=\\frac{1}{2}\\left(\\pi-\\angle B N_{a} C\\right)-\\frac{1}{2} \\angle C B A=\\frac{1}{2} \\angle A C B=\\angle A C S_{c}=\\angle A S_{c} T\\),\nhence\n\\[\n\\angle S_{a} B I=\\frac{\\pi}{2}-\\angle I B N_{a}=\\frac{\\pi}{2}-\\angle A S_{c} T=\\angle O S_{c} A .\n\\]\n\nTogether with (13) it follows that the triangles \\(I B S_{a}\\) and \\(A S_{c} O\\) are similar, so \\(\\frac{\\left|S_{a} B\\right|}{\\left|O S_{c}\\right|}= \\frac{|I B|}{\\left|A S_{c}\\right|}\\), and (12) implies \\(\\frac{\\left|N_{a} B\\right|}{\\left|T S_{c}\\right|}=\\frac{|I B|}{\\left|A S_{c}\\right|}\\). Consequently, by (14) the triangles \\(T S_{c} A\\) and \\(N_{a} B I\\) are similar and therefore \\(\\angle S_{c} T A=\\angle B N_{a} I\\). Now let \\(Q\\) be the second intersection of \\(N_{a} I\\) with \\(\\Omega\\). Then \\(\\angle B N_{a} I=\\angle B N_{a} Q=\\angle B A Q\\), so \\(\\angle S_{c} T A=\\angle B A Q\\). Since \\(A B\\) is parallel to \\(T S_{c}\\), we get \\(A Q \\| T A\\), i.e. \\(A, T, Q\\) are collinear.\n\nRemark. After proving similarity of triangles \\(T S_{c} O\\) and \\(N_{a} B S_{a}\\) one can use spiral symmetry to show similarity of triangles \\(T S_{c} A\\) and \\(N_{a} B I\\).\n\nSolution 5. Part I: First we show that \\(A\\) lies on the radical axis between \\(\\omega_{b}\\) and \\(\\omega_{c}\\).\nLet \\(T\\) be the radical center of the circumcircle, \\(\\omega_{b}\\) and \\(\\omega_{c}\\); then \\(T S_{b}\\) and \\(T S_{c}\\) are common tangents of the circles, as shown in Figure 5a. Moreover, let \\(P_{b}=A B \\cap S_{b} S_{c}\\) and \\(P_{c}= A C \\cap S_{b} S_{c}\\). The triangle \\(T S_{c} S_{b}\\) is isosceles: \\(A B \\| T S_{c}\\) and \\(A C \\| T S_{b}\\) so\n\\[\n\\angle A P_{b} P_{c}=\\angle T S_{c} S_{b}=\\angle S_{c} S_{b} T=\\angle P_{b} P_{c} A .\n\\]\n\nFrom these angles we can see that \\(\\omega_{b}\\) passes through \\(P_{b}, \\omega_{c}\\) passes through \\(P_{c}\\), and finally \\(A P_{b}\\) and \\(A P_{c}\\) are equal tangents to \\(\\omega_{b}\\) and \\(\\omega_{c}\\), so \\(A\\) lies on the radical axis.\n\n\\begin{figure}\n\\includegraphics[width=\\textwidth]{https://cdn.mathpix.com/cropped/2025_08_23_146291bab5ef73d6732cg-27.jpg?height=964&width=686&top_left_y=1604&top_left_x=345}\n\\captionsetup{labelformat=empty}\n\\caption{Figure 5a}\n\\end{figure}\n\n\\begin{figure}\n\\includegraphics[width=\\textwidth]{https://cdn.mathpix.com/cropped/2025_08_23_146291bab5ef73d6732cg-27.jpg?height=964&width=661&top_left_y=1604&top_left_x=1050}\n\\captionsetup{labelformat=empty}\n\\caption{Figure 5b}\n\\end{figure}\n\nPart II. Let the radical axis \\(T A\\) meet the circumcircle again at \\(X\\), let \\(S_{a}\\) be the midpoint of the arc \\(B C\\) opposite to \\(A\\), and let \\(X I\\) meet the circumcirlce again at \\(N\\). (See Figure 2.) For solving the problem, we have prove that \\(N_{a}=N\\).\n\nThe triples of points \\(A, I, S_{a} ; B, I, S_{b}\\) and \\(C, I, S_{c}\\) are collinear because they lie on the angle bisectors of the triangle \\(A B C\\).\n\nNotice that the quadrilateral \\(A S_{c} X S_{b}\\) is harmonic, because the tangents at \\(S_{b}\\) and \\(S_{c}\\), and the line \\(A X\\) are concurrent at \\(T\\). This quadrilateral can be projected (or inverted) to the quadrilateral \\(S_{a} C N B\\) through \\(I\\). So, \\(S_{a} C N B\\) also is a harmonic quadrilateral. Due to \\(S_{a} B=S_{a} C\\), this implies \\(N B=N C\\), so \\(N=N_{a}\\). Done.\n\nRemark. Instead of mentioning inversion and harmonic quadrilaterals, from the similar triangles \\(\\triangle T S_{c} A \\sim \\triangle T X S_{c}\\) and \\(\\triangle T A S_{b} \\sim \\triangle T S_{b} X\\) we can get\n\\[\n\\frac{A S_{c}}{S_{c} X}=\\frac{A S_{b}}{S_{b} X} .\n\\]\n\nThen, we can apply the trigonometric form of Ceva's theorem to triangle \\(B C X\\)\n\\[\n\\frac{\\sin \\angle B X N_{a}}{\\sin \\angle N_{a} X C} \\cdot \\frac{\\sin \\angle C B S_{b}}{\\sin \\angle S_{b} B X} \\cdot \\frac{\\sin \\angle X C S_{c}}{\\sin \\angle S_{c} C B}=\\frac{B N_{a}}{N_{a} C} \\cdot \\frac{-C S_{b}}{S_{b} X} \\cdot \\frac{X S_{c}}{-S_{c} B}=1 \\cdot \\frac{S_{b} A}{S_{b} N_{a}} \\cdot \\frac{N_{a} S_{c}}{S_{c} B}=1,\n\\]\nso the Cevians \\(B S_{b}, C S_{c}\\) and \\(X N_{a}\\) are concurrent.\n\nSolution 6. Part I: First let's show that this is equivalent to proving that \\(T A\\) and \\(N_{a} I\\) intersect in \\(\\Omega\\).\n\nLemma: Let's recall that if we have two circles \\(\\omega_{1}\\) and \\(\\omega_{2}\\) which are internally tangent at point \\(X\\) and if we have a line \\(A B\\) tangent to \\(\\omega_{2}\\) at \\(Y\\). Let \\(M\\) be the midpoint of the arc \\(A B\\) not containing \\(Z\\). We have that \\(Z, Y, M\\) are collinear.\n\n\\begin{figure}\n\\includegraphics[width=\\textwidth]{https://cdn.mathpix.com/cropped/2025_08_23_146291bab5ef73d6732cg-28.jpg?height=460&width=483&top_left_y=1796&top_left_x=782}\n\\captionsetup{labelformat=empty}\n\\caption{Solution 6: Lemma}\n\\end{figure}\n\nLet \\(P_{b}=A B \\cap \\omega_{b}\\) and \\(P_{c}=A C \\cap \\omega_{c}\\). We can notice by the lemma that \\(S_{b}, P_{b}\\) and \\(S_{c}\\) are collinear, and similarly \\(S_{c}, P_{c}\\) and \\(S_{b}\\) are also collinear. Therefore \\(S_{c}, P_{b}, P_{c}\\), and \\(S_{b}\\) are collinear, and since \\(\\angle A P_{b} P_{c}=\\frac{\\angle A B C}{2}+\\frac{\\angle A C B}{2}=\\angle A P_{c} P_{b}\\) then \\(A P_{b}=A P_{c}\\) so \\(A\\) is on the radical axis of \\(\\omega_{b}\\) and \\(\\omega_{c}\\). Let \\(T\\) be the intersection of the tangent lines of \\(\\Omega\\) through \\(S_{c}\\) and \\(S_{b}\\). Since \\(T S_{c}=T S_{b}\\) then \\(A T\\) is the radical axis between \\(\\omega_{b}\\) and \\(\\omega_{c}\\).\n\nPart II: \\(T A\\) and \\(N_{a} I\\) intersect in \\(\\Omega\\).\n\nLet \\(\\omega_{a}\\) the \\(A\\)-mixtilinear incircle (that is, the circle internally tangent to \\(\\Omega\\), and tangent to both \\(A B\\) and \\(A C\\) ), and let \\(X=\\Omega \\cap \\omega_{a}\\). It is known that \\(N_{a}, I, X\\) are collinear.\n\nLet \\(M_{c}\\) and \\(M_{b}\\) be the tangent points of \\(\\omega_{A}\\) to \\(A B\\) and \\(A C\\) respectively, then by the lemma \\(X, M_{c}, S_{c}\\) are collinear and \\(X, M_{b}, S_{b}\\) are collinear. We can see that \\(S_{c} T S_{b}\\) and \\(M_{c} A M_{b}\\) are homothetic with respect to \\(X\\); therefore \\(T\\) and \\(A\\) are homothetic with respect to \\(X\\), impying that \\(T, A, X\\) are collinear.\n\n\\begin{figure}\n\\includegraphics[width=\\textwidth]{https://cdn.mathpix.com/cropped/2025_08_23_146291bab5ef73d6732cg-29.jpg?height=1320&width=1003&top_left_y=628&top_left_x=525}\n\\captionsetup{labelformat=empty}\n\\caption{Figure 10: Diagram to Solution 6}\n\\end{figure}", "source_pdf": "egmo_2023.pdf", "notes": "fallback-regex"}
{"id": "EGMO-2024-1", "contest": "EGMO", "year": "2024", "problem_number": "1", "problem": "Two different integers \\(u\\) and \\(v\\) are written on a board. We perform a sequence of steps. At each step we do one of the following two operations: (i) If \\(a\\) and \\(b\\) are different integers on the board, then we can write \\(a+b\\) on the board, if it is not already there. (ii) If \\(a, b\\) and \\(c\\) are three different integers on the board, and if an integer \\(x\\) satisfies \\(a x^{2}+b x+c=0\\), then we can write \\(x\\) on the board, if it is not already there. Determine all pairs of starting numbers ( \\(u, v\\) ) from which any integer can eventually be written on the board after a finite sequence of steps.", "solution": "We will show that the answer are the integer pairs ( \\(u, v\\) ) such that \\(u \\neq 0\\), \\(v \\neq 0,\\{u, v\\} \\neq\\{-1,1\\}\\) and \\(u>0\\) or \\(v>0\\). If \\(u=0\\) or \\(v=0\\), then (i) will never yield a new number and we cannot use (ii) with only two numbers. Hence, if \\(u=0\\) or \\(v=0\\), we cannot reach every possible \\(y\\). From now on, assume \\(u \\neq 0\\) and \\(v \\neq 0\\). If both numbers \\(u, v\\) were negative, we will show that there can only be negative numbers on the board. With negative numbers \\(a, b\\), operation (i) will only yield a negative number. The same holds for operation (ii), because for a non-negative \\(x\\) and negative \\(a, b, c\\), we have \\(a x^{2}+b x+c<0\\). Hence, if both \\(u<0\\) and \\(v<0\\), then we cannot reach every possible \\(y\\). From now on, assume that at least one of \\(u, v\\) is positive. Without loss of generality take \\(u<v\\), and so \\(v>0\\). After one step, we can have the numbers \\(u, v, u+v\\), which are mutually distinct due to \\(u, v\\) being nonzero. Notice that the equation \\(u x^{2}+(u+v) x+v=0\\) has a root -1 , and so we can have -1 on the board. We now check two cases: case \\(v=1\\), and case \\(v>1\\). If \\(v=1\\), then \\(u<0\\). Further split the case of \\(v=1\\) based on whether \\(u=-1\\) or \\(u<-1\\). If \\(v=1\\) and \\(u=-1\\), we can only additionally write number 0 on the board using operation (i); and no additional numbers using (ii) because setting \\(\\{a, b, c\\}\\) to \\(\\{-1,0,1\\}\\) in any order only has solutions for \\(x\\) in \\(\\{-1,0,1\\}\\). Hence, if \\(\\{u, v\\}=\\{-1,1\\}\\), then we cannot reach every possible \\(y\\). If \\(v=1\\) and \\(u<-1\\), we can use operation (i) on numbers \\(u,-1\\) (and then repeat choosing the obtained result and -1 ) to get any negative number smaller than \\(u\\), and operation (i) on numbers ( \\(u, 1\\) ) (and then repeat choosing the obtained result and 1) to get any negative number larger than \\(u\\), as well as 0 . Then, we set \\((a, b, c)=(0,1,-2)\\) and apply operation (ii) to additionally get number 2. Applying (i) on (2,1) (and then repeat choosing the obtained result and 1), we can get all the remaining integers too. From now on, assume \\(v>1\\). Recall that we can make \\(u+v\\) and -1 . We will now apply operation (i). First, ( \\(v,-1\\) ) gives \\(v-1\\). Next, ( \\(v, v-1\\) ) gives \\(2 v-1\\). Since \\(v>1\\), we know \\(v \\neq 2 v-1\\), so we can apply operation (i) on \\((v, 2 v-1)\\) to get \\(3 v-1\\), and then continue adding \\((v, k v-1)\\) to get \\((k+1) v-1\\) for any positive \\(k\\). Since \\(v>1\\), we can get an arbitrarily large integer by repeating this. If \\(a\\) is any positive number on the board, applying (i) to \\((a,-1)\\) gives \\(a-1\\). By repeating this, we have that we can get all numbers smaller than \\(a\\) and larger than or equal to -1 . Together with previously having found a way to get an arbitrarily large integer, we have that we can get any integer \\(l \\geq-1\\) on the board. Now, we set \\((a, b, c)=(0,1,2)\\) and apply operation (ii) to additionally get number -2. Then we can repeat operation (i) on ( \\(-1,-2\\) ) (and afterwards on -1 and the obtained result) to get any negative number. Therefore, if \\(u \\neq 0, v \\neq 0,\\{u, v\\} \\neq\\{-1,1\\}\\) and \\(u>0\\) or \\(v>0\\), we can write every integer on the board. Remark. There are of course many other ways to create all integers in case of ( \\(u, v\\) ) that satisfies all the requirements. Basically you will always use (i) to create arbitrarily large numbers and then (ii) to create a number in a range that you didn't have before.", "source_pdf": "egmo_2024.pdf", "notes": ""}
{"id": "EGMO-2024-2", "contest": "EGMO", "year": "2024", "problem_number": "2", "problem": "Let \\(A B C\\) be a triangle with \\(A C>A B\\), and denote its circumcircle by \\(\\Omega\\) and incentre by \\(I\\). Let its incircle meet sides \\(B C, C A, A B\\) at \\(D, E, F\\) respectively. Let \\(X\\) and \\(Y\\) be two points on minor arcs \\(\\widehat{D F}\\) and \\(\\widehat{D E}\\) of the incircle, respectively, such that \\(\\angle B X D=\\angle D Y C\\). Let line \\(X Y\\) meet line \\(B C\\) at \\(K\\). Let \\(T\\) be the point on \\(\\Omega\\) such that \\(K T\\) is tangent to \\(\\Omega\\) and \\(T\\) is on the same side of line \\(B C\\) as \\(A\\). Prove that lines \\(T D\\) and \\(A I\\) meet on \\(\\Omega\\).", "solution": "By the alternate segment theorem we have that: \\[ 180^{\\circ}=\\angle D C Y+\\angle C Y D+\\angle Y D C=\\angle D C Y+\\angle D X B+\\angle Y X D=\\angle D C Y+\\angle Y X B . \\] Therefore opposite angle of \\(B X Y C\\) are supplementary and so \\(C Y X B\\) cyclic. One can apply power of a point at \\(K\\) : \\[ K T^{2}=K B \\cdot K C=K X \\cdot K Y=K D^{2} \\Longrightarrow K T=K D . \\] (Alternatively you can sidestep power of a point by observing that \\(K\\) is the radical centre of the incircle \\(D E F\\), the circumcircle \\(\\Gamma\\) and the circle \\(C Y X B\\) and so \\(K T^{2}=K D^{2}\\).) Now let \\(A I\\) meet \\(\\Omega\\) at \\(M\\), the midpoint of \\(\\widehat{B C}\\) not containing \\(A\\). Let the tangent at \\(M\\) meet \\(K T\\) at \\(Q\\). Observe that \\(Q M \\| K D\\) so \\(\\angle T K D=\\angle T Q M\\) and also \\(K T=K D\\), \\(Q T=Q M\\) hence \\(\\triangle T K D \\sim \\triangle T Q M\\). As \\(T, K, Q\\) are collinear, this means that \\(T, D, M\\) are collinear so \\(T D\\) and \\(A I\\) meet at \\(M\\) which lies on \\(\\Omega\\).", "source_pdf": "egmo_2024.pdf", "notes": ""}
{"id": "EGMO-2024-3", "contest": "EGMO", "year": "2024", "problem_number": "3", "problem": "We call a positive integer \\(n\\) peculiar if, for any positive divisor \\(d\\) of \\(n\\), the integer \\(d(d+1)\\) divides \\(n(n+1)\\). Prove that for any four different peculiar positive integers \\(A, B, C\\) and \\(D\\), the following holds: \\[ \\operatorname{gcd}(A, B, C, D)=1 \\] Here \\(\\operatorname{gcd}(A, B, C, D)\\) is the largest positive integer that divides all of \\(A, B, C\\) and \\(D\\).", "solution": "Observe that \\(n=1\\) is peculiar and that every prime is peculiar. Consider \\(\\frac{n}{d}\\), where \\(d>1\\) is a divisor of \\(n\\). Then \\(\\frac{n}{d}\\left(\\frac{n}{d}+1\\right)\\) divides \\(n(n+1)\\), equivalent to \\(n+d\\) dividing \\(d^{2}(n+1)\\). Since \\(n \\equiv-d(\\bmod n+d)\\), we obtain that \\(n+d\\) divides \\(d^{3}-d^{2}\\), hence \\(n+d \\leq d^{3}-d^{2}\\) and in particular \\(n<d^{3}\\). Now taking \\(d\\) to be the smallest prime divisor of \\(n\\), we deduce that \\(n\\) cannot have more than two prime factors, counting multiplicities. Hence from now on we work with \\(n=p q\\), where \\(p\\) and \\(q\\) are primes. In fact, \\(p \\neq q\\), as otherwise \\(p+1 \\mid p^{2}-p\\), i.e. \\(p+1 \\mid 2\\), contradiction. The only relations of concern are \\(p(p+1) \\mid n(n+1)\\) and \\(q(q+1) \\mid n(n+1)\\). The former yields \\(p(p+1) \\mid p q(p q+1)\\), i.e. \\(p+1 \\mid q(p q+1)\\), that is, \\(p+1 \\mid q(q-1)\\); analogously \\(q+1 \\mid p(p-1)\\). Without loss of generality assume \\(p>q\\). If \\(q\\) does not divide \\(p+1\\), then since \\(p+1\\) and \\(q\\) are relatively prime, we obtain from \\(p+1 \\mid q(q-1)\\) that \\(p+1\\) divides \\(q-1\\) and hence \\(p<p+1 \\leq q-1<q\\), contradiction. Hence \\(q\\) divides \\(p+1\\). Also, \\(p\\) does not divide \\(q+1\\) due to \\(p>q(\\) unless \\(p=q+1\\), i.e. \\(p=3, q=2\\), but then \\(p+1 \\nmid q(q-1))\\) and now from \\(q+1 \\mid p(p-1)\\) we deduce that \\(q+1\\) divides \\(p-1\\). Write \\(p+1=m q\\) for some positive integer \\(m\\). Then \\(q+1\\) divides \\(p-1=m q-2= m(q+1)-m-2\\), so \\(q+1\\) divides \\(m+2\\). On the other hand, \\(p+1 \\mid q(q-1)\\) implies that \\(m\\) divides \\(q-1\\). If the ratio of the latter is greater than 1 , then \\(m \\leq \\frac{q-1}{2}\\), but \\(q+1\\) dividing \\(m+2\\) from above insists on \\(q \\leq m+1\\), so \\(m \\leq \\frac{q-1}{2} \\leq \\frac{m}{2}\\), contradiction. Hence \\(m=q-1\\) and we have proven the following: if \\(n>1\\) is composite and peculiar, then \\(n=p q\\), where \\(p>q\\) are primes and \\(p=q^{2}-q-1\\). In conclusion, a prime \\(p\\) can only divide the peculiar numbers \\(p, p\\left(p^{2}-p-1\\right)\\) (if \\(p^{2}-p-1\\) is prime) and \\(p q\\) where \\(p=q^{2}-q-1\\) (if \\(q\\) is prime). In particular, the greatest common divisor of more than three peculiar numbers must be 1 . (Note that three peculiar numbers may indeed have a common divisor, e.g. 5, \\(15=3 \\cdot 5\\) and \\(95=5 \\cdot 19\\) are all peculiar.)", "source_pdf": "egmo_2024.pdf", "notes": ""}
{"id": "EGMO-2024-4", "contest": "EGMO", "year": "2024", "problem_number": "4", "problem": "For a sequence \\(a_{1}<a_{2}<\\cdots<a_{n}\\) of integers, a pair ( \\(a_{i}, a_{j}\\) ) with \\(1 \\leq i<j \\leq n\\) is called interesting if there exists a pair ( \\(a_{k}, a_{l}\\) ) of integers with \\(1 \\leq k<l \\leq n\\) such that \\[ \\frac{a_{l}-a_{k}}{a_{j}-a_{i}}=2 \\] For each \\(n \\geq 3\\), find the largest possible number of interesting pairs in a sequence of length \\(n\\).", "solution": "Consider the numbers \\(a_{i}=2^{i}\\) for \\(2 \\leq i \\leq n\\) and \\(a_{1}=0\\), and choose any pair \\((i, j)\\) with \\(1 \\leq i<j \\leq n\\). If \\(i=1\\), the pair \\((1, j)\\) is interesting for all \\(2 \\leq j \\leq n-1\\), as \\(\\frac{a_{j+1}-a_{1}}{a_{j}-a_{1}}=\\frac{2^{j+1}}{2^{j}}=2\\). If \\(i \\geq 2\\), the pair \\((i, j)\\) is also interesting for all \\(j\\) such that \\(i+1 \\leq j \\leq n-1\\), since \\(\\frac{a_{j+1}-a_{i+1}}{a_{j}-a_{i}}=\\frac{2^{j+1}-2^{i+1}}{2^{j}-2^{i}}=2\\). In addition, the pair \\((n-1, n)\\) is interesting, as \\(\\frac{a_{n}-a_{0}}{a_{n}-a_{n-1}}=2\\). Hence, all pairs in which \\(j \\leq n-1\\), and additionally the pair ( \\(n-1, n\\) ), are interesting, giving \\(\\frac{1}{2}(n-1)(n-2)+1\\) pairs in total. Now, let's show that there can't be more interesting pairs. To this end we show that at least \\(\\frac{1}{2} n(n-1)-\\left(\\frac{1}{2}(n-1)(n-2)+1\\right)=n-2\\) pairs are not interesting. Clearly, the pair ( \\(1, n\\) ) is not interesting. Let's make the following observation: if a pair \\((i, j)\\) is interesting and it's not \\((1, n)\\), then \\(a_{j}-a_{i}\\) can't exceed \\(\\frac{1}{2}\\left(a_{n}-a_{1}\\right)\\). (Since, if \\((i, j)\\) is interesting then \\(a_{l}-a_{k}=2\\left(a_{j}-a_{i}\\right)\\) for some pair ( \\(k, l\\) ). If then \\(2\\left(a_{j}-a_{i}\\right)>a_{n}-a_{1}\\) we would have \\(a_{l}-a_{k}>a_{n}-a_{1}\\), which is not possible.) Finally, for any \\(2 \\leq i \\leq n-1\\) consider pairs ( \\(1, i\\) ) and ( \\(i, n\\) ). If both of them are interesting, then, following the observation above, the only possibility is \\(a_{i}-a_{1}=a_{n}-a_{i}=\\frac{a_{n}-a_{1}}{2}\\). Clearly, this is possible for at most one \\(i\\), so for all other \\(n-3\\) values of \\(i\\), at least one of pairs ( \\(1, i\\) ) and ( \\(i, n\\) ) is not interesting. Combining with the pair ( \\(1, n\\) ), we get at least \\(n-2\\) not interesting pairs in total, as desired.", "source_pdf": "egmo_2024.pdf", "notes": ""}
{"id": "EGMO-2024-5", "contest": "EGMO", "year": "2024", "problem_number": "5", "problem": "Let \\(\\mathbb{N}\\) denote the set of positive integers. Find all functions \\(f: \\mathbb{N} \\rightarrow \\mathbb{N}\\) such that the following assertions are true for every pair of positive integers ( \\(x, y\\) ): - \\(x\\) and \\(f(x)\\) have the same number of positive divisors. - If \\(x\\) does not divide \\(y\\) and \\(y\\) does not divide \\(x\\), then \\[ \\operatorname{gcd}(f(x), f(y))>f(\\operatorname{gcd}(x, y)) . \\] Here \\(\\operatorname{gcd}(m, n)\\) is the largest positive integer that divides both \\(m\\) and \\(n\\).", "solution": "Throughout this proof, when we write divisors we mean positive divisors. Let \\(f\\) be a function satisfying these properties. From the first one, it follows that \\(f(1)=1\\) and for each prime number \\(p, f(p)=q_{p}\\) for some prime number \\(q_{p}\\). Assume \\(p \\neq 2\\), the pair ( \\(2, p\\) ) in property 2 gives \\[ \\operatorname{gcd}\\left(q_{2}, q_{p}\\right)=\\operatorname{gcd}(f(2), f(p))>f(\\operatorname{gcd}(2, p))=f(1)=1, \\] so \\(q_{p}=q_{2}\\) for all \\(p\\). Set \\(q=q_{2}\\). Denote by \\(d(n)\\) the number of divisors of a positive integer \\(n\\). We will prove the following claim by induction on \\(k \\geq 0\\), the number of distinct prime divisors of \\(n\\) : For a positive integer \\(n, f(n)\\) is a power of \\(q\\). The claim, together with the first property, imply that \\(f(n)=q^{d(n)-1}\\). For \\(k=0\\) the claim is already proved. For \\(k=1\\), we need to prove that \\(f\\left(p^{m}\\right)\\) is a power of \\(q\\) for all positive \\(m\\). The case \\(m=1\\) was already proved. Assume now the result being proved for all positive integers \\(\\leq m\\). As \\(d\\left(p^{t}\\right)=t+1\\), we then know \\(f\\left(p^{t}\\right)=q^{t}\\) for all \\(t \\leq m\\). Now we consider \\(t=m+1\\). Let \\(r \\neq p\\) be a prime. Plug the pair ( \\(p^{m-1} r, p^{m}\\) ) into the second property: \\[ \\operatorname{gcd}\\left(f\\left(p^{m-1} r\\right), q^{m}\\right)=\\operatorname{gcd}\\left(f\\left(p^{m-1} r\\right), f\\left(p^{m}\\right)\\right)>f\\left(p^{m-1}\\right)=q^{m-1} . \\] This implies \\(q^{m}\\) divides \\(f\\left(p^{m-1} r\\right)\\). Since \\(f\\left(p^{m-1} r\\right)\\) has \\(2 m\\) divisors, and \\(v_{q}\\left(f\\left(p^{m-1} r\\right)\\right) \\geq m\\), it follows that \\(f\\left(p^{m-1} r\\right)\\) does not have prime divisors other than \\(q\\), since it would then have at least \\(2 \\cdot\\left(v_{q}\\left(f\\left(p^{m-1} r\\right)\\right)+1\\right)>2 m\\) divisors. Thus, \\(f\\left(p^{m-1} r\\right)\\) is a power of \\(q\\). And since it has \\(2 m\\) divisors, we must have \\(f\\left(p^{m-1} r\\right)=q^{2 m-1}\\). Now, plug the pair ( \\(p^{m+1}, p^{m-1} r\\) ) into the second property. We have \\[ \\operatorname{gcd}\\left(f\\left(p^{m+1}\\right), q^{2 m-1}\\right)=\\operatorname{gcd}\\left(f\\left(p^{m+1}\\right), f\\left(p^{m-1} r\\right)\\right)>f\\left(p^{m-1}\\right)=q^{m-1} . \\] Then \\(f\\left(p^{m+1}\\right)\\) is divisible by \\(q^{m}\\). If \\(f\\left(p^{m+1}\\right)\\) had a prime factor other than \\(q\\), it would have at least \\(2(m+1)\\) divisors, but it has \\(m+2\\) divisors and \\(2(m+1)>m+2\\) since \\(m \\geq 1\\). Hence, \\(f\\left(p^{m+1}\\right)\\) must also be a power of \\(q\\). By induction, the proof is finished for \\(k=1\\). Suppose the claim is true for all integers \\(n\\) with at most \\(k\\) distinct prime factors, for some \\(k \\geq 1\\). In order to prove the claim for integers with \\(k+1\\) distinct prime factors, it suffices to show that for every positive integer \\(N\\) with \\(k\\) distinct prime factors, every positive integer \\(m\\) and every prime \\(p\\) which does not divide \\(N\\), the number \\(f\\left(N p^{m}\\right)\\) is a power of \\(q\\). We will prove this by induction on \\(m\\). The case \\(m=0\\) follows from the previous induction hypothesis. Now suppose it has already been proved for a certain \\(m \\geq 0\\). Let \\(s\\) be a prime divisor of \\(N\\). Consider the numbers ( \\(N p^{m+1}, N s p^{m}\\) ). By the second property, \\[ \\operatorname{gcd}\\left(f\\left(N p^{m+1}\\right), q^{d\\left(N s p^{m}\\right)-1}\\right)=\\operatorname{gcd}\\left(f\\left(N p^{m+1}\\right), f\\left(N s p^{m}\\right)\\right)>f\\left(N p^{m}\\right)=q^{d\\left(N p^{m}\\right)-1} . \\] Then \\(q^{d\\left(N p^{m}\\right)}\\) divides \\(f\\left(N p^{m+1}\\right)\\). If \\(f\\left(N p^{m+1}\\right)\\) has a prime factor other than \\(q\\), it would have at least \\(2\\left(d\\left(N p^{m}\\right)+1\\right)=2((m+1) d(N)+1)=(2 m+2) d(N)+2\\) divisors, but it has only \\((m+2) d(N)\\) divisors. Hence, \\(f\\left(N p^{m+1}\\right)\\) must also be a power of \\(q\\). Finally, let us check that the function \\(f(n)=q^{d(n)-1}\\) does satisfy the properties of the problem for any prime number \\(q\\). The first property obviously holds. To check the second one, note that \\[ \\operatorname{gcd}(f(x), f(y))=q^{\\min (d(x), d(y))}>q^{d(\\operatorname{gcd}(x, y))}=f(\\operatorname{gcd}(x, y)) \\] whenever \\(x \\nmid y\\) and \\(y \\nmid x\\).", "source_pdf": "egmo_2024.pdf", "notes": ""}
{"id": "EGMO-2024-6", "contest": "EGMO", "year": "2024", "problem_number": "6", "problem": "Find all positive integers \\(d\\) for which there exists a degree \\(d\\) polynomial \\(P\\) with real coefficients such that there are at most \\(d\\) different values among \\(P(0), P(1), \\ldots, P\\left(d^{2}-\\right. d)\\).", "solution": "We claim that such polynomials exist if and only if \\(d \\leq 3\\). The following examples show that such polynomials do exist for \\(d \\leq 3\\) : \\[ \\begin{array}{llll} d=1: & d^{2}-d=0, & P_{1}(x)=x, & P(0)=0 ; \\\\ d=2: & d^{2}-d=2, & P_{2}(x)=x(x-1), & \\left\\{\\begin{array}{l} P(0)=P(1)=0 \\\\ P(2)=2 ; \\end{array}\\right. \\\\ d=3: & d^{2}-d=6, & P_{3}(x)=x(x-4)(x-5), & \\left\\{\\begin{array}{l} P(0)=P(4)=P(5)=0 \\\\ P(1)=P(2)=P(6)=12 \\\\ P(3)=6 \\end{array}\\right. \\end{array} \\] We can make more examples by adding constants. Now we will show that there are no examples of degree greater than 3 . From now on we assume (without loss of generality) that the leading coefficient of our polynomial \\(P\\) is positive and that all values \\(P(i)\\) are positive (by adding a constant if necessary) for integers \\(i\\) in the range \\(0 \\leq i \\leq d^{2}-d+1\\). Assume (for contradiction) that \\(P\\) is a polynomial of degree \\(d \\geq 4\\) that satisfies the conditions of the problem and let \\(P(0), \\ldots, P\\left(d^{2}-d\\right)\\) take values among \\(p_{1}<\\cdots<p_{d}\\). For \\(i=1, \\ldots, d\\), let \\(n_{i} \\geq 0\\) be the number of appearances of \\(p_{i}\\) among \\(P(0), \\ldots, P\\left(d^{2}-d\\right)\\). By definition \\(n_{1}+\\cdots+n_{d}=d^{2}-d+1\\). Since \\(P\\) has degree \\(d, n_{i} \\leq d\\). The key observation is now the following. Claim 1 Make the convention that \\(n_{0}=n_{d+1}=0\\). If \\(n_{i}=d\\) for some \\(i\\) in the range \\(1 \\leq i \\leq d\\), then \\(n_{i \\pm 1} \\leq d-2\\). Proof. Up to scaling and hence without loss of generality, \\(P\\) has leading coefficient +1 . Since \\(n_{i}=d\\), there exist non-negative integers \\(a_{1, i}<\\cdots<a_{d, i} \\leq d^{2}-d\\) such that \\[ P(X)=\\left(X-a_{1, i}\\right) \\cdots\\left(X-a_{d, i}\\right)+p_{i} . \\] By construction, each of the \\(d-1\\) intervals \\(I_{j}=\\left[a_{j, i}, a_{j+1, i}\\right]\\) contains at least one local extremum of \\(P\\), so contains exactly one such extremum because \\(P\\), having degree \\(d\\), has at most \\(d-1\\) such extrema. Suppose that \\(i \\leq d-1\\) and that \\(P(m)=p_{i+1}>p_{i}\\) for some \\(m \\in\\left\\{0, \\ldots, d^{2}-d\\right\\}\\). Since \\(P\\) has positive leading coefficient, \\[ m \\in\\left(a_{d, i}, \\infty\\right) \\cup\\left(a_{d-2, i}, a_{d-1, i}\\right) \\cup \\cdots \\cup\\left(a_{i, 1}, a_{2, i}\\right) \\] if \\(d\\) is odd or \\[ m \\in\\left(a_{d, i}, \\infty\\right) \\cup\\left(a_{d-2, i}, a_{d-1, i}\\right) \\cup \\cdots \\cup\\left(-\\infty, a_{1, i}\\right) \\] if \\(d\\) is even. Suppose that \\(a_{j, i}<m<a_{j+1, i}\\), for some \\(j \\in\\{1, \\ldots, d-1\\}\\). If \\(a_{j, i}+1<m<a_{j+1, i}-1\\), then, because \\(I_{j}\\) contains exactly one local extremum (which is a maximum), Either \\(p_{i+1}=P(m)>P\\left(a_{j, i}+1\\right)\\) or \\(p_{i+1}=P(m)>P\\left(a_{j+1, i}-1\\right)\\). Since \\(P\\left(a_{j, i}+1\\right)> P\\left(a_{j, i}\\right)=p_{i}\\) and \\(P\\left(a_{j, i}-1\\right)>P\\left(a_{j+1, i}\\right)=p_{i}\\), this contradicts the requirement that \\(P\\left(a_{j, i}+1\\right), P\\left(a_{j+1, i}-1\\right) \\in\\left\\{p_{1}, \\ldots, p_{d}\\right\\}\\). Hence \\(m=a_{j, i}+1\\) or \\(m=a_{j, i}-1\\). Similarly, if \\(m>a_{d, i}\\), then \\(m=a_{d, i}+1\\), but if \\(m<a_{i, 1}\\) (which may arise when \\(d\\) is even), then \\(m=a_{i, 1}-1\\). This shows that \\(m\\) belongs to this list: \\[ a_{d, i}+1, a_{d-1, i}-1, \\ldots, a_{2, i}+(-1)^{d}, a_{1, i}-(-1)^{d} \\] This list contains at most \\(d\\) different integers. It follows in particular that, if \\(n_{i+1}>d-2\\), then either \\[ P\\left(a_{d, i}+1\\right)=p_{i+1}=P\\left(a_{d-1, i}-1\\right) \\] or \\[ P\\left(a_{2, i}+(-1)^{d}\\right)=p_{i+1}=P\\left(a_{1, i}-(-1)^{d}\\right) \\] with, additionally, \\(a_{2, i}+(-1)^{d} \\neq a_{1, i}-(-1)^{d}\\). We have \\[ \\left|P\\left(a_{1, i} \\pm 1\\right)-p_{i}\\right|=1 \\cdot\\left|a_{1, i} \\pm 1-a_{2, i}\\right| \\cdot \\prod_{j=3}^{d}\\left|a_{1, i} \\pm 1-a_{j, i}\\right| \\] and \\[ \\left|P\\left(a_{2, i} \\mp 1\\right)-p_{i}\\right|=\\left|a_{2, i} \\mp 1-a_{1, i}\\right| \\cdot 1 \\cdot \\prod_{j=3}^{d}\\left|a_{2, i} \\mp 1-a_{j, i}\\right| . \\] As \\(a_{1, i}<a_{2, i}<a_{3, i}<\\ldots<a_{d, i}\\) we have \\(\\left|a_{1, i} \\pm 1-a_{j, i}\\right| \\geq\\left|a_{2, i} \\mp 1-a_{j, i}\\right|\\) with equality possible only if \\(a_{1, i}+1=a_{2, i}-1\\). We also have \\(\\left|a_{1, i} \\pm 1-a_{2, i}\\right|=\\left|a_{2, i} \\mp 1-a_{1, i}\\right|\\), which can be zero only if \\(a_{1, i}+1=a_{2, i}-1\\). We conclude that \\(\\left|P\\left(a_{1, i} \\pm 1\\right)-p_{i}\\right|>\\left|P\\left(a_{2, i} \\mp 1\\right)-p_{i}\\right|\\) or \\(a_{1, i}+1=a_{2, i}-1\\). Looking at the other end of the list of \\(\\left(a_{j, i}\\right)\\) as \\(j\\) varies, we have \\[ \\left|P\\left(a_{d-1, i}-1\\right)-p_{i}\\right|=1 \\cdot\\left|a_{d-1, i}-1-a_{d, i}\\right| \\cdot \\prod_{j=1}^{d-2}\\left|a_{d-1, i}-1-a_{j, i}\\right| \\] and \\[ \\left|P\\left(a_{d, i}+1\\right)-p_{i}\\right|=\\left|a_{d, i}+1-a_{d-1, i}\\right| \\cdot 1 \\cdot \\prod_{j=1}^{d-2}\\left|a_{d, i}+1-a_{j, i}\\right| \\] In these two formulas the shared factor outside the product is at least 2 and so is not 0 . Now look at the factors behind the product symbols. As \\(a_{1, i}<a_{2, i}<a_{3, i}<\\ldots<a_{d, i}\\), for \\(j \\leq d-2\\) we have \\(\\left|a_{d, i}+1-a_{j, i}\\right|>\\left|a_{d-1, i}-1-a_{j, i}\\right|\\). We conclude that \\(\\left|P\\left(a_{d, i}+1\\right)-p_{i}\\right|> \\left|P\\left(a_{d-1, i}-1\\right)-p_{i}\\right|\\). Claim 1 is proved. For each \\(i \\in\\{1, \\ldots, d-1\\}\\), there are three possibilities: - \\(n_{i}, n_{i+1} \\leq d-1\\) - \\(n_{i}=d\\) and \\(n_{i+1} \\leq d-2\\) - \\(n_{i+1}=d\\) and \\(n_{i} \\leq d-2\\). In all three cases, \\(n_{i}+n_{i+1} \\leq 2(d-1)\\). If \\(n\\) is even, this leads to the contradiction \\[ d^{2}-d+1=\\left(n_{1}+n_{2}\\right)+\\cdots+\\left(n_{d-1}+n_{d}\\right) \\leq(d / 2)[2(d-1)]=d^{2}-d \\] This is an important staging point in the argument because we have eliminated the possibility of a polynomial of even degree \\(d\\) satisfying the conditions of the problem if \\(d \\geq 4\\). From now on we assume that \\(d \\geq 5\\) is odd, and \\(d^{2}-d+1=\\left(n_{1}+n_{2}\\right)+\\cdots+\\left(n_{d-2}+n_{d-1}\\right)+n_{d} \\leq[(d-1) / 2][2(d-1)]+d=d^{2}-d+1\\). Equality must therefore hold throughout. Since the sum can also be grouped as \\[ n_{1}+\\left(n_{2}+n_{3}\\right)+\\cdots+\\left(n_{d-1}+n_{d}\\right), \\] this requires \\(n_{1}=n_{d}=d, n_{i}+n_{i+1}=2(d-1)\\) for \\(i=1,2, \\ldots, d-1\\) i.e. \\(n_{i}=d\\) for odd \\(i\\) and \\(n_{i}=d-2\\) for even \\(i\\). We are interested in the degree of \\(P\\) being \\(d \\geq 5\\) and odd, and showing that no polynomial \\(P\\) satisfying the conditions of the problem can exist. There are \\(d-1 \\geq 4\\) extremal points points which alternate between local maxima and minima (in that order) as you read from left to right (we normalize so that \\(P\\) is monic). For any \\(p_{i}\\) with \\(i\\) odd, the line \\(y=p_{i}\\) (with \\(i\\) odd) crosses the graph of \\(P\\) in \\(d\\) places with \\(x\\)-coordinates in the real closed interval \\(\\left[0, d^{2}-d+1\\right]\\) at points \\(\\left(z, p_{i}\\right)\\) so each \\(z\\) must be an integer. Suppose that \\(J\\) is a real interval on the \\(x\\)-axis ending at adjacent local extrema. The function defined by \\(P\\) is monotonic on each \\(J\\). The line \\(y=p_{i}\\) ( \\(i\\) odd) meets the graph at most once on \\(J\\). Therefore it meets the graph of \\(P\\) exactly once in the interior of each \\(J\\) (there are \\(d-2\\) such intervals) and at the only two possible places outside the union of these intervals. Now consider \\(p_{j}\\) when \\(j\\) is even (so \\(n_{j}=d-2\\) ). These \\(d-2\\) intervals \\(J\\) afford \\(d-2\\) real values at which \\(P\\) will take \\(p_{j}\\) as a value where \\(j\\) is fixed and even. The question is, are the corresponding arguments integers? The proof of Claim 1 tells us that in the middle of the run \\(\\left\\{0,1, \\ldots, d^{2}-d+1\\right\\}\\) all is well: the polynomial is assuming the value \\(p_{j}\\) at an integer where the polynomial assumes the values \\(p_{j-1}\\) and \\(p_{j+1}\\) at adjacent integers in some order. The problem is at the ends of the run where \\(\\left|P\\left(a_{1, i}+1\\right)-p_{i}\\right|>\\left|P\\left(a_{2, i}-1\\right)-p_{i}\\right|\\) and \\(\\left|P\\left(a_{d, i}+1\\right)-p_{i}\\right|>\\left|P\\left(a_{d-1, i}-1\\right)-p_{i}\\right|\\). When \\(j\\) is even, two of the roots of \\(P(x)-p_{j}\\) are not integers, and we now know approximately where this trouble is happening (at the ends). At this point we could finish if \\(d \\geq 7\\), because the run of regular behaviour in the middle is sufficiently long that we could obtain a contradiction. However we have to work a little harder to include the case \\(d=5\\). We now show that the run of regular behaviour is slightly longer than we have currently established. We do this using Claim 2. Claim 2. If \\(d\\) is odd, and \\(n_{i}=d, n_{i \\pm 1}=d-2\\) for some \\(i\\), then \\(P\\) attains \\(p_{i \\pm 1}\\) precisely at the \\(d-2\\) integers \\[ a_{2, i}-1, a_{3, i}+1, \\cdots, a_{d-2, i}-1, a_{d-1, i}+1 . \\] Proof Suppose (for contradiction) \\(a_{1, i}+1 \\neq a_{2, i}-1\\) and \\(P\\left(a_{1, i}+1\\right)=p_{i+1}\\). Now \\(a_{1, i}<a_{2, i}\\) so either \\(a_{1, i}+1<a_{2, i}-1\\) or \\(a_{1, i}=a_{2, i}-1\\). In the latter case, \\(P\\left(a_{1, i}+1\\right)=P\\left(a_{2, i}\\right)=p_{i}\\), a contradiction. In the former case, the proof of Claim 1 shows that \\[ \\left|P\\left(a_{2, i}-1\\right)-p_{i}\\right|<\\left|P\\left(a_{1, i}+1\\right)-p_{i}\\right|=\\left|p_{i+1}-p_{i}\\right|=p_{i+1}-p_{i} \\] so \\(P\\left(a_{2, i}-1\\right)<p_{i+1}\\). The polynomial is decreasing on the interval \\(\\left(a_{2, d}, a_{2,1}\\right)\\) so \\(p_{i}<P\\left(a_{2, i}-1\\right)<p_{i+1}\\) which is absurd because \\(P\\left(a_{2, i}-1\\right)=p_{j}\\) for some \\(j\\). Therefore \\(P\\left(a_{2, i}-1\\right)=p_{i+1}\\) for all odd \\(i\\). A similar argument shows that \\(P\\left(a_{d-1, i}+1\\right)=p_{i+1}\\) so Claim 2 is established. Now we have n sequence of alternating falling then rising then falling etc. full runs starting at ( \\(a_{2, d}, p_{d}\\) ) and ending at ( \\(a_{d-1,1}, p_{1}\\) ) so the initial run of \\(3 d+1\\) terms of this run of values is \\[ p_{d}, p_{d-1}, \\cdots p_{1}, p_{1}, p_{2}, \\ldots, p_{d}, p_{d}, p_{d-1}, \\cdots p_{1}, p_{1} \\] which starts at ( \\(a_{2, d}, p_{d}\\) ) and ends at ( \\(a_{4,1}+1, p_{1}\\) ) which is fine because \\(4 \\leq d-1\\). There are now various ways we can finish. (a) Consider the run of length \\(2 d\\) consecutive values \\[ p_{d}, p_{d-1}, \\cdots p_{1}, p_{1}, p_{2}, \\ldots, p_{d} \\] The first \\(d+1\\) points determine \\(P(x)\\). The last \\(d+1\\) values also determine \\(P\\) but the values are in the reverse order, so \\(P(X)=P(c-X)\\) for some constant \\(c\\). However, the coefficients of \\(X^{d}\\) are have opposite signs ( \\(d\\) is odd) so this is absurd. (b) The idea in (a) can be expressed in terms of Lagrange interpolation to obtain essentially the same contradiction. Construct \\(P\\) in two ways using Lagrange interpolation on both the first \\(d+1\\) and the last \\(d+1\\) points. The symmetry in the data forces the graph of \\(P\\) to have a vertical axis of symmetry. This is absurd because the degree of \\(P\\) is odd. (c) The initial fragment length \\(3 d+1\\) mentioned above at ( \\(*)\\ ) includes two identical runs of values of \\(P\\) (in the same order) of length \\(d+1\\). The polynomial \\(P\\) is determined by each of them and so \\(P(X)=P(X+c)\\) for some constant \\(c\\) and so the polynomial defines a bounded function which is absurd.", "source_pdf": "egmo_2024.pdf", "notes": ""}
{"id": "EGMO-2025-P1", "contest": "EGMO", "year": "2025", "problem_number": "P1", "problem": "For a positive integer N, let c_{1}<c_{2}<\\cdots<c_{m} be all the positive integers smaller than N that are coprime to N. Find all N \\geq 3 such that \\[ \\operatorname{gcd}\\left(N, c_{i}+c_{i+1}\\right) \\neq 1 \\] for all 1 \\leq i \\leq m-1. Here \\operatorname{gcd}(a, b) is the largest positive integer that divides both a and b. Integers a and b are coprime if \\operatorname{gcd}(a, b)=1.", "solution": "The answer is all even integers and all powers of 3. First we show that these work. - When N is even, all c_{i} are odd, and so 2 \\mid \\operatorname{gcd}\\left(N, c_{i}+c_{i+1}\\right) for every i. - When N is a power of 3 , the c_{i} are exactly the numbers in the range 1,2, \\ldots, N-1 that are not divisible by 3 . So, the sequence c_{1}, \\ldots, c_{m} alternates between numbers congruent to 1(\\bmod 3) and 2(\\bmod 3). Thus 3 \\mid \\operatorname{gcd}\\left(N, c_{i}+c_{i+1}\\right) for every i. Now we show that no other positive integer works. For the sake of contradiction, consider an odd candidate N that is not a power of 3 , and suppose it satisfies the problem condition. Then, since c_{1}=1 and c_{2}=2, we have \\operatorname{gcd}(N, 1+2) \\neq 1, so 3 \\mid N. Thus, we can write N as 3^{k} M, where k \\geq 1 and \\operatorname{gcd}(M, 6)=1. We have M \\geq 5 (as M \\neq 1 by assumption) and M+2<N. We now split into two cases based on M modulo 3. Case 1. M \\equiv 1(\\bmod 3). As 3 \\mid M-1 and M \\mid M, neither M-1 nor M are in the sequence \\left\\{c_{i}\\right\\}. As M is odd and M \\equiv 1 (\\bmod 3), M-2 and M+1 are congruent to 1(\\bmod 3), are coprime to M, and are smaller than N. Thus, both M-2 and M+1 are in the sequence, and they are consecutive terms. However, this means \\operatorname{gcd}(N, 2 M-1) \\neq 1. This gives a contradiction, as both 3 and M are coprime to 2 M-1. Case 2. M \\equiv 2(\\bmod 3). This case is similar to Case 1. Neither M nor M+1 are in the sequence, but M-1 and M+2 are. We obtain a similar contradiction from \\operatorname{gcd}(N, 2 M+1) \\neq 1.", "source_pdf": "egmo_2025.pdf", "notes": ""}
{"id": "EGMO-2025-P2", "contest": "EGMO", "year": "2025", "problem_number": "P2", "problem": "An infinite increasing sequence a_{1}<a_{2}<a_{3}<\\cdots of positive integers is called central if for every positive integer n, the arithmetic mean of the first a_{n} terms of the sequence is equal to a_{n}. Show that there exists an infinite sequence b_{1}, b_{2}, b_{3}, \\ldots of positive integers such that for every central sequence a_{1}, a_{2}, a_{3}, \\ldots, there are infinitely many positive integers n with a_{n}=b_{n}.", "solution": "We claim that the sequence b_{1}, b_{2}, b_{3}, \\ldots defined by b_{i}=2 i-1 has this property. Let d_{i}=a_{i}-b_{i}=a_{i}-2 i+1. The condition a_{i}<a_{i+1} now becomes d_{i}+2 i-1<d_{i+1}+2 i+1, which can be rewritten as d_{i+1} \\geqslant d_{i}-1. Thus, if d_{i+1}<d_{i}, then d_{i+1} must be equal to d_{i}-1. This implies in particular that if d_{i_{0}} \\geqslant 0 but d_{i_{1}} \\leqslant 0 for some indices i_{1}>i_{0}, there must be some intermediate index i_{0} \\leqslant i \\leqslant i_{1} with d_{i}=0. Because the average of the first a_{n} terms of the sequence is equal to a_{n}, we know for all n that \\[ \\sum_{i=1}^{a_{n}} d_{i}=\\sum_{i=1}^{a_{n}}\\left(a_{i}-2 i+1\\right)=\\sum_{i=1}^{a_{n}} a_{i}-\\sum_{i=1}^{a_{n}}(2 i-1)=a_{n}^{2}-a_{n}^{2}=0 \\] Because the sequence ( a_{n} ) is increasing, this implies that the sequence ( d_{i} ) contains infinitely many non-negative ( d_{i} \\geqslant 0 ) and infinitely many non-positive ( d_{i} \\leqslant 0 ) terms. In particular, we can find arbitrarily large indices i_{0} \\leqslant i_{1} such that d_{i_{0}} \\geqslant 0 and d_{i_{1}} \\leqslant 0. By our earlier observation, it follows that there are infinitely many i such that d_{i}=0, as desired.", "source_pdf": "egmo_2025.pdf", "notes": ""}
{"id": "EGMO-2025-P3", "contest": "EGMO", "year": "2025", "problem_number": "P3", "problem": "Let A B C be an acute triangle. Points B, D, E, and C lie on a line in this order and satisfy B D= D E=E C. Let M and N be the midpoints of A D and A E, respectively. Let H be the orthocentre of triangle A D E. Let P and Q be points on lines B M and C N, respectively, such that D, H, M, and P are concyclic and E, H, N, and Q are concyclic. Prove that P, Q, N, and M are concyclic. The orthocentre of a triangle is the point of intersection of its altitudes.", "solution": "Denote by B^{\\prime} and C^{\\prime} the reflections of B and C in M and N, respectively. Points C^{\\prime}, A, B^{\\prime} are clearly collinear and D E B^{\\prime} A is a parallelogram. Since E H \\perp A D, we have E H \\perp E B^{\\prime}. Also H A \\perp A B^{\\prime}, so points H, E, B^{\\prime}, A are concyclic. This gives \\[ \\angle C^{\\prime} Q H=\\angle N Q H=\\angle N E H=\\angle A E H=\\angle A B^{\\prime} H=\\angle C^{\\prime} B^{\\prime} H, \\] and so points C^{\\prime}, B^{\\prime}, Q, H are concyclic. Analogously points C^{\\prime}, B^{\\prime}, P, H are concyclic, and so all points B^{\\prime}, C^{\\prime}, P, Q, H are. Now we have \\[ \\angle N M B^{\\prime}=\\angle A B^{\\prime} M=\\angle C^{\\prime} B^{\\prime} P=\\angle C^{\\prime} Q P=\\angle N Q P, \\] which proves that P, Q, N, M are also concyclic.", "source_pdf": "egmo_2025.pdf", "notes": ""}
{"id": "EGMO-2025-P4", "contest": "EGMO", "year": "2025", "problem_number": "P4", "problem": "Let A B C be an acute triangle with incentre I and A B \\neq A C. Let lines B I and C I intersect the circumcircle of A B C at P \\neq B and Q \\neq C, respectively. Consider points R and S such that A Q R B and A C S P are parallelograms (with A Q\\|R B, A B\\| Q R, A C \\| S P, and A P \\| C S ). Let T be the point of intersection of lines R B and S C. Prove that points R, S, T, and I are concyclic.", "solution": "We will prove that \\triangle B I R \\sim \\triangle C I S, since the statement then follows from \\angle T R I=\\angle B R I=\\angle C S I= \\angle T S I. Step 1. Let us prove \\angle R B I=\\angle S C I. We will use directed angles: \\[ \\begin{aligned} (B R, B I) & =(B R, A B)+(A B, B I)=(A Q, A B)+(B I, B C) \\\\ & =(C Q, B C)+(B I, B C)=(C I, C B)+(B I, B C), \\end{aligned} \\] which is symmetric in B, C. Therefore, analogously we would obtain the same expression for ( C S, C I ). Step 2. Let us prove B R / B I=C S / C I. Clearly B R=A Q and C S=A P. Angle chasing gives \\angle I C B=\\angle Q C B=\\angle A P Q, and similarly \\angle P Q A=\\angle C B I, and so \\triangle I B C \\sim \\triangle A Q P, from which the desired A Q / B I=A P / C I follows. This finishes the solution.", "source_pdf": "egmo_2025.pdf", "notes": ""}
{"id": "EGMO-2025-P5", "contest": "EGMO", "year": "2025", "problem_number": "P5", "problem": "Let n>1 be an integer. In a configuration of an n \\times n board, each of the n^{2} cells contains an arrow, either pointing up, down, left, or right. Given a starting configuration, Turbo the snail starts in one of the cells of the board and travels from cell to cell. In each move, Turbo moves one square unit in the direction indicated by the arrow in her cell (possibly leaving the board). After each move, the arrows in all of the cells rotate 90^{\\circ} counterclockwise. We call a cell good if, starting from that cell, Turbo visits each cell of the board exactly once, without leaving the board, and returns to her initial cell at the end. Determine, in terms of n, the maximum number of good cells over all possible starting configurations.", "solution": "We will show that the maximum number of good cells over all possible starting configurations is \\[ \\begin{aligned} \\frac{n^{2}}{4} & \\text { if } n \\text { is even and } \\\\ 0 & \\text { if } n \\text { is odd. } \\end{aligned} \\] Odd n First, we will prove that there are no good cells if n is an odd number. For Turbo to reach her goal, she must return to her initial cell after visiting every cell exactly once. Consider the chessboard coloring of the board. Without loss of generality, we assume that Turbo starts in a black cell. Since, at every step, Turbo moves to a cell of a different color; she will be in a white cell after n^{2} \\equiv 1 \\bmod 2 moves. Thus, it is impossible for Turbo to come back to her initial black cell on her n^{2}-th move, which is a contradiction. Thus there are no good cells. Lower bound for even n We will now construct a starting configuration with \\frac{n^{2}}{4} good cells for even n. Let (i, j) denote the cell in row i and column j. Consider the following cycle \\[ \\begin{aligned} (1,1) & \\rightarrow(1,2) \\rightarrow(1,3) \\rightarrow \\ldots \\rightarrow(1, n) \\\\ & \\rightarrow(2, n) \\rightarrow(2, n-1) \\rightarrow \\ldots \\rightarrow(2,2) \\\\ & \\ldots \\\\ & \\rightarrow(2 i-1,2) \\rightarrow(2 i-1,3) \\rightarrow \\ldots \\rightarrow(2 i-1, n) \\\\ & \\rightarrow(2 i, n) \\rightarrow(2 i, n-1) \\rightarrow \\ldots \\rightarrow(2 i, 2) \\\\ & \\ldots \\\\ & \\rightarrow(n, n) \\rightarrow(n, n-1) \\rightarrow \\ldots \\rightarrow(n, 2) \\\\ & \\rightarrow(n, 1) \\rightarrow(n-1,1) \\rightarrow \\ldots \\rightarrow(2,1) \\rightarrow(1,1) \\end{aligned} \\] Note that the cycle returns to the initial cell after visiting every cell exactly once. To prove that (1,1) is good, we need to find a starting configuration such that Turbo traverses this cycle. Let c_{i} be the (i-1)-th cell on the cycle: so we have c_{0}=(1,1), c_{2}=(1,2), \\ldots, c_{n^{2}-1}=(2,1). For every i, we draw an arrow in cell c_{i} pointing towards cell c_{i+1} (or pointing towards c_{0} if i=n^{2}-1 ) and then rotate this arrow i times 90^{\\circ} in the clockwise direction. After i moves, the arrow in c_{i} will have rotated i times 90^{\\circ} counterclockwise and be in the same direction as on the path defined above. Thus, Turbo will traverse the cycle c_{0}, c_{1}, c_{2}, \\ldots, c_{n^{2}-1}, c_{0} and ( 1,1 ) is good. Every four moves, all arrows point in the same direction as in the beginning. Moreover, the board will return to its initial configuration after traversing the full cycle, since n^{2}, the length of the cycle, is divisible by 4 . Therefore Turbo can also start at any c_{i} with 4 \\mid i and follow the same route. Hence the cells c_{0}, c_{4}, c_{8}, \\ldots, c_{n^{2}-4} are good and there are \\frac{n^{2}}{4} of such cells. Upper bound for even n We will prove that for even n and any start configuration there are at most \\frac{n^{2}}{4} good cells. Let a_{0} be a good cell. Let a_{0}, a_{1}, a_{2}, \\ldots, a_{n^{2}-1}, a_{n^{2}}=a_{0} be the sequence of cells that Turbo visits when she starts at a_{0}. Now suppose there is another good cell b_{0} and let b_{0}, b_{1}, b_{2}, \\ldots, b_{n^{2}-1}, b_{n^{2}}=b_{0} be the sequence of cells that Turbo visits when she starts at b_{0}. Note that, since 4 \\mid n^{2}, the arrows are back to their initial configuration after n^{2} steps. Thus, if Turbo keeps walking after returning to her initial cell, she would just traverse the same cycle over and over again. Consider the upper left corner of the board. With standard row and column numbering, the corner cell is (1,1). This cell has only two neighbours, so both the a-route and the b-route must have cells (2,1),(1,1),(1,2) in that order or (1,2),(1,1),(2,1) in that order. Without loss of generality, a_{i-1}= (2,1), a_{i}=(1,1) and a_{i+1}=(1,2) for some i. Let j be such that b_{j}= (1,1). If b_{j-1}=(2,1)=a_{i-1}, then the arrow in cell (2,1) must be pointed in the same direction after i-1 steps and after j-1 steps, so i \\equiv j \\bmod 4. But then the arrow in cell b_{j}=(1,1)=a_{i} must also be pointed in the same direction after i and after j steps, so Turbo moves to b_{j+1}=a_{i+1} in both cases, and again finds the arrow pointed in the same direction in both cases. Continuing, we find that the b-route is actually identical to a_{4 t}, a_{4 t+1}, \\ldots, a_{n^{2}}=a_{0}, a_{1}, \\ldots, a_{4 t-1}, a_{4 t} for some t, as any other starting point would have the arrows in the wrong direction initially. Now suppose instead that b_{j+1}=(2,1)=a_{i-1}. Considering the a-route, the arrows in the upper left corner after i-1 steps must be like this: or Considering the b-route instead, the arrows after j-1 steps must be like this: or From the arrows in cell (1,1) we see that i \\equiv j+1 \\bmod 4. However, for the cells (2,1) and (1,2) this gives a contradiction. We conclude that the only possible good cells are a_{4 t} for t=0,1, \\ldots, \\frac{n^{2}}{4}-1, which gives at most \\frac{n^{2}}{4} good cells.", "source_pdf": "egmo_2025.pdf", "notes": ""}
{"id": "EGMO-2025-P6", "contest": "EGMO", "year": "2025", "problem_number": "P6", "problem": "In each cell of a 2025 \\times 2025 board, a nonnegative real number is written in such a way that the sum of the numbers in each row is equal to 1 , and the sum of the numbers in each column is equal to 1 . Define r_{i} to be the largest value in row i, and let R=r_{1}+r_{2}+\\cdots+r_{2025}. Similarly, define c_{i} to be the largest value in column i, and let C=c_{1}+c_{2}+\\cdots+c_{2025}. What is the largest possible value of \\frac{R}{C} ?", "solution": "Answer: \\frac{2025}{89}. In general, if the table is m^{2} \\times m^{2}, the answer is \\frac{m^{2}}{2 m-1}. The example is as follows: label rows and columns from 1 to m^{2}, from top to bottom and left to right. For the first m columns, write \\frac{1}{m} in all squares whose coordinates have the same residue modulo m and place 0 everywhere else. For the remaining m^{2}-m columns, place \\frac{1}{m^{2}} everywhere. Then R=m^{2} \\cdot \\frac{1}{m}=m, and C=m \\cdot \\frac{1}{m}+\\left(m^{2}-m\\right) \\cdot \\frac{1}{m^{2}}=2-\\frac{1}{m}. So the ratio is as claimed. In particular, when n:=m^{2}=2025, we get \\frac{2025}{89}. Now we need to show that \\frac{R}{C} \\leq \\frac{n}{2 \\sqrt{n}-1}. For each row, select one cell having the largest value appearing in said row and colour it red. Then, without loss of generality, we may rearrange the columns such that the red cells appear in the first k columns from the left, and each such column contains at least one red cell, for some k \\leq n. For the j^{\\text {th }} column, for all 1 \\leq j \\leq k, let p_{j} and n_{j} denote the sum and number of red cells in it, respectively. We observe that c_{j}, the biggest number in the j^{\\text {th }} column, is at least \\frac{p_{j}}{n_{j}}, for all 1 \\leq j \\leq k. For all other columns, the largest value they contain is at least \\frac{1}{n}, as their sum is 1 . Thus, C \\geq \\frac{p_{1}}{n_{1}}+\\frac{p_{2}}{n_{2}}+\\cdots+\\frac{p_{k}}{n_{k}}+\\frac{n-k}{n}. We can also observe that R=p_{1}+p_{2}+\\cdots+p_{k}. Therefore we have to show that: \\[ p_{1}+p_{2}+\\cdots+p_{k} \\leq \\frac{n}{2 \\sqrt{n}-1} \\cdot\\left(\\frac{p_{1}}{n_{1}}+\\frac{p_{2}}{n_{2}}+\\cdots+\\frac{p_{k}}{n_{k}}+\\frac{n-k}{n}\\right) . \\] By construction, n_{1}+n_{2}+\\cdots+n_{k}=n, and, as the numbers in every column are nonnegative, we see that p_{j} \\leq 1 for every j. Also, since each number in a red cell is at least \\frac{1}{n}, we also have p_{j} \\geq \\frac{n_{j}}{n}. Since our inequality is linear in each p_{j}, it suffices to prove it when each variable equals one of its two critical values. By relabeling, we may assume that p_{j}=\\frac{n_{j}}{n} for 1 \\leq j \\leq t, and p_{j}=1 for t+1 \\leq j \\leq k, for an integer 0 \\leq t \\leq k. First, if t=k, we observe that p_{1}+p_{2}+\\cdots+p_{k}=\\frac{n_{1}}{n}+\\frac{n_{2}}{n}+\\cdots+\\frac{n_{k}}{n}=1, and that \\frac{p_{1}}{n_{1}}+\\frac{p_{2}}{n_{2}}+\\cdots+\\frac{p_{k}}{n_{k}}= \\frac{k}{n}, so the inequality becomes 1 \\leq \\frac{n}{2 \\sqrt{n}-1}, which is true. From now on we may assume that t<k. We need to show that: \\[ \\frac{n_{1}+\\cdots+n_{t}}{n}+k-t \\leq \\frac{n}{2 \\sqrt{n}-1} \\cdot\\left(\\frac{t}{n}+\\frac{1}{n_{t+1}}+\\cdots+\\frac{1}{n_{k}}+\\frac{n-k}{n}\\right) . \\] By Cauchy-Schwarz inequality we have that: \\[ \\frac{1}{n_{t+1}}+\\cdots+\\frac{1}{n_{k}} \\geq \\frac{(k-t)^{2}}{n_{t+1}+\\cdots+n_{k}}=\\frac{(k-t)^{2}}{n-\\left(n_{1}+\\cdots+n_{t}\\right)} . \\] Let n_{1}+\\cdots+n_{t}=n \\cdot q, where 0 \\leq q<1. Thus, it is now enough to show that: \\[ q+k-t \\leq \\frac{1}{2 \\sqrt{n}-1} \\cdot\\left(n-\\ell+\\frac{\\ell^{2}}{1-q}\\right) \\] Let k-t=\\ell \\geq 1. The inequality becomes: \\[ q+\\ell \\leq \\frac{1}{2 \\sqrt{n}-1} \\cdot\\left(n-\\ell+\\frac{\\ell^{2}}{1-q}\\right) \\] Rearranging this we get: \\[ n+q+\\frac{\\ell^{2}}{1-q} \\geq 2(q+\\ell) \\sqrt{n} \\] If q=0 the inequality is trivially true by A M-G M. Suppose now that 0<q<1. Then, by Cauchy-Schwarz, we have: \\[ q+\\frac{\\ell^{2}}{1-q}=\\frac{q^{2}}{q}+\\frac{\\ell^{2}}{1-q} \\geq(q+\\ell)^{2} \\] It is therefore enough to show that n+(q+\\ell)^{2} \\geq 2(q+\\ell) \\sqrt{n}, which is true by A M-G M, completing the proof.", "source_pdf": "egmo_2025.pdf", "notes": ""}
{"id": "IMO-2022-2", "contest": "IMO", "year": "2022", "problem_number": "A3", "problem": "Let \\(\\mathbb{R}_{>0}\\) be the set of positive real numbers. Find all functions \\(f: \\mathbb{R}_{>0} \\rightarrow \\mathbb{R}_{>0}\\) such that, for every \\(x \\in \\mathbb{R}_{>0}\\), there exists a unique \\(y \\in \\mathbb{R}_{>0}\\) satisfying\n\\[\nx f(y)+y f(x) \\leqslant 2 .\n\\]\n(Netherlands)", "solution": "Answer: The function \\(f(x)=1 / x\\) is the only\n\n.\nSolution 1. First we prove that the function \\(f(x)=1 / x\\) satisfies the condition of the problem statement. The AM-GM inequality gives\n\\[\n\\frac{x}{y}+\\frac{y}{x} \\geqslant 2\n\\]\nfor every \\(x, y>0\\), with equality if and only if \\(x=y\\). This means that, for every \\(x>0\\), there exists a unique \\(y>0\\) such that\n\\[\n\\frac{x}{y}+\\frac{y}{x} \\leqslant 2,\n\\]\nnamely \\(y=x\\).\nLet now \\(f: \\mathbb{R}_{>0} \\rightarrow \\mathbb{R}_{>0}\\) be a function that satisfies the condition of the problem statement. We say that a pair of positive real numbers ( \\(x, y\\) ) is good if \\(x f(y)+y f(x) \\leqslant 2\\). Observe that if ( \\(x, y\\) ) is good, then so is ( \\(y, x\\) ).\nLemma 1.0. If ( \\(x, y\\) ) is good, then \\(x=y\\).\nProof. Assume that there exist positive real numbers \\(x \\neq y\\) such that ( \\(x, y\\) ) is good. The uniqueness assumption says that \\(y\\) is the unique positive real number such that ( \\(x, y\\) ) is good. In particular, ( \\(x, x\\) ) is not a good pair. This means that\n\\[\nx f(x)+x f(x)>2\n\\]\nand thus \\(x f(x)>1\\). Similarly, ( \\(y, x\\) ) is a good pair, so ( \\(y, y\\) ) is not a good pair, which implies \\(y f(y)>1\\). We apply the AM-GM inequality to obtain\n\\[\nx f(y)+y f(x) \\geqslant 2 \\sqrt{x f(y) \\cdot y f(x)}=2 \\sqrt{x f(x) \\cdot y f(y)}>2 .\n\\]\n\nThis is a contradiction, since ( \\(x, y\\) ) is a good pair.\nBy assumption, for any \\(x>0\\), there always exists a good pair containing \\(x\\), however Lemma 1 implies that the only good pair that can contain \\(x\\) is ( \\(x, x\\) ), so\n\\[\nx f(x) \\leqslant 1 \\quad \\Longleftrightarrow \\quad f(x) \\leqslant \\frac{1}{x},\n\\]\nfor every \\(x>0\\).\nIn particular, with \\(x=1 / f(t)\\) for \\(t>0\\), we obtain\n\\[\n\\frac{1}{f(t)} \\cdot f\\left(\\frac{1}{f(t)}\\right) \\leqslant 1 .\n\\]\n\nHence\n\\[\nt \\cdot f\\left(\\frac{1}{f(t)}\\right) \\leqslant t f(t) \\leqslant 1\n\\]\n\nWe claim that \\((t, 1 / f(t))\\) is a good pair for every \\(t>0\\). Indeed,\n\\[\nt \\cdot f\\left(\\frac{1}{f(t)}\\right)+\\frac{1}{f(t)} f(t)=t \\cdot f\\left(\\frac{1}{f(t)}\\right)+1 \\leqslant 2\n\\]\n\nLemma 1 implies that \\(t=1 / f(t) \\Longleftrightarrow f(t)=1 / t\\) for every \\(t>0\\).\n\nSolution 1.1. We give an alternative way to prove that \\(f(x)=1 / x\\) assuming \\(f(x) \\leqslant 1 / x\\) for every \\(x>0\\).\n\nIndeed, if \\(f(x)<1 / x\\) then for every \\(a>0\\) with \\(f(x)<1 / a<1 / x\\) (and there are at least two of them), we have\n\\[\na f(x)+x f(a)<1+\\frac{x}{a}<2 .\n\\]\n\nHence ( \\(x, a\\) ) is a good pair for every such \\(a\\), a contradiction. We conclude that \\(f(x)=1 / x\\).\nSolution 1.2. We can also conclude from Lemma 1 and \\(f(x) \\leqslant 1 / x\\) as follows.\nLemma 2. The function \\(f\\) is decreasing.\nProof. Let \\(y>x>0\\). Lemma 1 says that ( \\(x, y\\) ) is not a good pair, but ( \\(y, y\\) ) is. Hence\n\\[\nx f(y)+y f(x)>2 \\geqslant 2 y f(y)>y f(y)+x f(y),\n\\]\nwhere we used \\(y>x\\) (and \\(f(y)>0\\) ) in the last inequality. This implies that \\(f(x)>f(y)\\), showing that \\(f\\) is decreasing.\n\nWe now prove that \\(f(x)=1 / x\\) for all \\(x\\). Fix a value of \\(x\\) and note that for \\(y>x\\) we must have \\(x f(x)+y f(x)>x f(y)+y f(x)>2\\) (using that \\(f\\) is decreasing for the first step), hence \\(f(x)>\\frac{2}{x+y}\\). The last inequality is true for every \\(y>x>0\\). If we fix \\(x\\) and look for the supremum of the expression \\(\\frac{2}{x+y}\\) over all \\(y>x\\), we get\n\\[\nf(x) \\geqslant \\frac{2}{x+x}=\\frac{1}{x}\n\\]\n\nSince we already know that \\(f(x) \\leqslant 1 / x\\), we conclude that \\(f(x)=1 / x\\).\nSolution 2.0. As in the first solution, we note that \\(f(x)=1 / x\\) is a solution, and we set out to prove that it is the only one. We write \\(g(x)\\) for the unique positive real number such that \\((x, g(x))\\) is a good pair. In this solution, we prove Lemma 2 without assuming Lemma 1.\nLemma 2. The function \\(f\\) is decreasing.\nProof. Consider \\(x<y\\). It holds that \\(y f(g(y))+g(y) f(y) \\leqslant 2\\). Moreover, because \\(y\\) is the only positive real number such that \\((g(y), y)\\) is a good pair and \\(x \\neq y\\), we have \\(x f(g(y))+g(y) f(x)>\\) 2. Combining these two inequalities yields\n\\[\nx f(g(y))+g(y) f(x)>2 \\geqslant y f(g(y))+g(y) f(y),\n\\]\nor \\(f(g(y))(x-y)>g(y)(f(y)-f(x))\\). Because \\(g(y)\\) and \\(f(g(y))\\) are both positive while \\(x-y\\) is negative, it follows that \\(f(y)<f(x)\\), showing that \\(f\\) is decreasing.\n\nWe now prove Lemma 1 using Lemma 2. Suppose that \\(x \\neq y\\) but \\(x f(y)+y f(x) \\leqslant 2\\). As in the first solution, we get \\(x f(x)+x f(x)>2\\) and \\(y f(y)+y f(y)>2\\), which implies \\(x f(x)+y f(y)>2\\). Now\n\\[\nx f(x)+y f(y)>2 \\geqslant x f(y)+y f(x)\n\\]\nimplies \\((x-y)(f(x)-f(y))>0\\), which contradicts the fact that \\(f\\) is decreasing. So \\(y=x\\) is the unique \\(y\\) such that ( \\(x, y\\) ) is a good pair, and in particular we have \\(f(x) \\leqslant 1 / x\\).\n\nWe can now conclude the proof as in any of the Solutions 1.x.\nSolution 3.0. As in the other solutions we verify that the function \\(f(x)=1 / x\\) is a solution. We first want to prove the following lemma:\nLemma 3. For all \\(x \\in \\mathbb{R}_{>0}\\) we actually have \\(x f(g(x))+g(x) f(x)=2\\) (that is: the inequality is actually an equality).\n\nProof. We proceed by contradiction: Assume there exists some number \\(x>0\\) such that for \\(y=g(x)\\) we have \\(x f(y)+y f(x)<2\\). Then for any \\(0<\\epsilon<\\frac{2-x f(y)-y f(x)}{2 f(x)}\\) we have, by uniqueness of \\(y\\), that \\(x f(y+\\epsilon)+(y+\\epsilon) f(x)>2\\). Therefore\n\\[\n\\begin{aligned}\nf(y+\\epsilon) & >\\frac{2-(y+\\epsilon) f(x)}{x}=\\frac{2-y f(x)-\\epsilon f(x)}{x} \\\\\n& >\\frac{2-y f(x)-\\frac{2-x f(y)-y f(x)}{2}}{x} \\\\\n& =\\frac{2-x f(y)-y f(x)}{2 x}+f(y)>f(y)\n\\end{aligned}\n\\]\n\nFurthermore, for every such \\(\\epsilon\\) we have \\(g(y+\\epsilon) f(y+\\epsilon)+(y+\\epsilon) f(g(y+\\epsilon)) \\leqslant 2\\) and \\(g(y+\\epsilon) f(y)+y f(g(y+\\epsilon))>2\\) (since \\(y \\neq y+\\epsilon=g(g(y+\\epsilon)))\\). This gives us the two inequalities\n\\[\nf(g(y+\\epsilon)) \\leqslant \\frac{2-g(y+\\epsilon) f(y+\\epsilon)}{y+\\epsilon} \\quad \\text { and } \\quad f(g(y+\\epsilon))>\\frac{2-g(y+\\epsilon) f(y)}{y} .\n\\]\n\nCombining these two inequalities and rearranging the terms leads to the inequality\n\\[\n2 \\epsilon<g(y+\\epsilon)[(y+\\epsilon) f(y)-y f(y+\\epsilon)] .\n\\]\n\nMoreover combining with the inequality (1) we obtain\n\\(2 \\epsilon<g(y+\\epsilon)\\left[(y+\\epsilon) f(y)-y\\left(\\frac{2-x f(y)-y f(x)}{2 x}+f(y)\\right)\\right]=g(y+\\epsilon)\\left[\\epsilon f(y)-y \\frac{2-x f(y)-y f(x)}{2 x}\\right]\\).\nWe now reach the desired contradiction, since for \\(\\epsilon\\) sufficiently small we have that the left hand side is positive while the right hand side is negative.\n\nWith this lemma it then follows that for all \\(x, y \\in \\mathbb{R}_{>0}\\) we have\n\\[\nx f(y)+y f(x) \\geqslant 2\n\\]\nsince for \\(y=g(x)\\) we have equality and by uniqueness for \\(y \\neq g(x)\\) the inequality is strict.\nIn particular for every \\(x \\in \\mathbb{R}_{>0}\\) and for \\(y=x\\) we have \\(2 x f(x) \\geqslant 2\\), or equivalently \\(f(x) \\geqslant 1 / x\\) for all \\(x \\in \\mathbb{R}_{>0}\\). With this inequality we obtain for all \\(x \\in \\mathbb{R}_{>0}\\)\n\\[\n2 \\geqslant x f(g(x))+g(x) f(x) \\geqslant \\frac{x}{g(x)}+\\frac{g(x)}{x} \\geqslant 2\n\\]\nwhere the first inequality comes from the problem statement. Consequently each of these inequalities must actually be an equality, and in particular we obtain \\(f(x)=1 / x\\) for all \\(x \\in \\mathbb{R}_{>0}\\).\n\nSolution 4. Again, let us prove that \\(f(x)=1 / x\\) is the only solution. Let again \\(g(x)\\) be the unique positive real number such that ( \\(x, g(x)\\) ) is a good pair.\nLemma 4. The function \\(f\\) is strictly convex.\nProof. Consider the function \\(q_{s}(x)=f(x)+s x\\) for some real number \\(s\\). If \\(f\\) is not strictly convex, then there exist \\(u<v\\) and \\(t \\in(0,1)\\) such that\n\\[\nf(t u+(1-t) v) \\geqslant t f(u)+(1-t) f(v) .\n\\]\n\nHence\n\\[\n\\begin{aligned}\nq_{s}(t u+(1-t) v) & \\geqslant t f(u)+(1-t) f(v)+s(t u+(1-t) v) \\\\\n& =t q_{s}(u)+(1-t) q_{s}(v)\n\\end{aligned}\n\\]\n\nLet \\(w=t u+(1-t) v\\) and consider the case \\(s=f(g(w)) / g(w)\\). For that particular choice of \\(s\\), the function \\(q_{s}(x)\\) has a unique minimum at \\(x=w\\). However, since \\(q_{s}(w) \\geqslant t q_{s}(u)+(1-t) q_{s}(v)\\), it must hold \\(q_{s}(u) \\leqslant q_{s}(w)\\) or \\(q_{s}(v) \\leqslant q_{s}(w)\\), a contradiction.\nLemma 5. The function \\(f\\) is continuous.\nProof. Since \\(f\\) is strictly convex and defined on an open interval, it is also continuous.\nAs in Solution 1, we can prove that \\(f(x) \\leqslant 1 / x\\). If \\(f(x)<1 / x\\), then we consider the function \\(h(y)=x f(y)+y f(x)\\) which is continuous. Since \\(h(x)<2\\), there exist at least two distinct \\(z \\neq x\\) such that \\(h(z)<2\\) giving that \\((x, z)\\) is good pair for both values of \\(z\\), a contradiction. We conclude that \\(f(x)=1 / x\\) as desired.\n\nComment. Lemma 5 implies Lemma 3, using an argument similar as in the end of Solution 4.", "source_pdf": "imosl_2022.pdf", "notes": "fallback-regex"}
{"id": "IMO-2022-1", "contest": "IMO", "year": "2022", "problem_number": "C2", "problem": "The Bank of Oslo issues coins made out of two types of metal: aluminium (denoted \\(A\\) ) and copper (denoted \\(C\\) ). Morgane has \\(n\\) aluminium coins, and \\(n\\) copper coins, and arranges her \\(2 n\\) coins in a row in some arbitrary initial order. Given a fixed positive integer \\(k \\leqslant 2 n\\), she repeatedly performs the following operation: identify the largest subsequence containing the \\(k\\)-th coin from the left which consists of consecutive coins made of the same metal, and move all coins in that subsequence to the left end of the row. For example, if \\(n=4\\) and \\(k=4\\), the process starting from the configuration \\(A A C C C A C A\\) would be\n\\[\nA A C C C A C A \\rightarrow C C C A A A C A \\rightarrow A A A C C C C A \\rightarrow C C C C A A A A \\rightarrow \\cdots .\n\\]\n\nFind all pairs ( \\(n, k\\) ) with \\(1 \\leqslant k \\leqslant 2 n\\) such that for every initial configuration, at some point of the process there will be at most one aluminium coin adjacent to a copper coin.\n(France)", "solution": "Answer: All pairs \\((n, k)\\) such that \\(n \\leqslant k \\leqslant \\frac{3 n+1}{2}\\).\n\n. Define a block to be a maximal subsequence of consecutive coins made out of the same metal, and let \\(M^{b}\\) denote a block of \\(b\\) coins of metal \\(M\\). The property that there is at most one aluminium coin adjacent to a copper coin is clearly equivalent to the configuration having two blocks, one consisting of all \\(A\\)-s and one consisting of all \\(C\\)-s.\n\nFirst, notice that if \\(k<n\\), the sequence \\(A^{n-1} C^{n-1} A C\\) remains fixed under the operation, and will therefore always have 4 blocks. Next, if \\(k>\\frac{3 n+1}{2}\\), let \\(a=k-n-1, b=2 n-k+1\\). Then \\(k>2 a+b, k>2 b+a\\), so the configuration \\(A^{a} C^{b} A^{b} C^{a}\\) will always have four blocks:\n\\[\nA^{a} C^{b} A^{b} C^{a} \\rightarrow C^{a} A^{a} C^{b} A^{b} \\rightarrow A^{b} C^{a} A^{a} C^{b} \\rightarrow C^{b} A^{b} C^{a} A^{a} \\rightarrow A^{a} C^{b} A^{b} C^{a} \\rightarrow \\ldots\n\\]\n\nTherefore a pair ( \\(n, k\\) ) can have the desired property only if \\(n \\leqslant k \\leqslant \\frac{3 n+1}{2}\\). We claim that all such pairs in fact do have the desired property. Clearly, the number of blocks in a configuration cannot increase, so whenever the operation is applied, it either decreases or remains constant. We show that unless there are only two blocks, after a finite amount of steps the number of blocks will decrease.\n\nConsider an arbitrary configuration with \\(c \\geqslant 3\\) blocks. We note that as \\(k \\geqslant n\\), the leftmost block cannot be moved, because in this case all \\(n\\) coins of one type are in the leftmost block, meaning there are only two blocks. If a block which is not the leftmost or rightmost block is moved, its neighbor blocks will be merged, causing the number of blocks to decrease.\n\nHence the only case in which the number of blocks does not decrease in the next step is if the rightmost block is moved. If \\(c\\) is odd, the leftmost and the rightmost blocks are made of the same metal, so this would merge two blocks. Hence \\(c \\geqslant 4\\) must be even. Suppose there is a configuration of \\(c\\) blocks with the \\(i\\)-th block having size \\(a_{i}\\) so that the operation always moves the rightmost block:\n\\[\nA^{a_{1}} \\ldots A^{a_{c-1}} C^{a_{c}} \\rightarrow C^{a_{c}} A^{a_{1}} \\ldots A^{a_{c-1}} \\rightarrow A^{a_{c-1}} C^{a_{c}} A^{a_{1}} \\ldots C^{a_{c-2}} \\rightarrow \\ldots\n\\]\n\nBecause the rightmost block is always moved, \\(k \\geqslant 2 n+1-a_{i}\\) for all \\(i\\). Because \\(\\sum a_{i}=2 n\\), summing this over all \\(i\\) we get \\(c k \\geqslant 2 c n+c-\\sum a_{i}=2 c n+c-2 n\\), so \\(k \\geqslant 2 n+1-\\frac{2 n}{c} \\geqslant \\frac{3 n}{2}+1\\). But this contradicts \\(k \\leqslant \\frac{3 n+1}{2}\\). Hence at some point the operation will not move the rightmost block, meaning that the number of blocks will decrease, as desired.", "source_pdf": "imosl_2022.pdf", "notes": "fallback-regex"}
{"id": "IMO-2022-4", "contest": "IMO", "year": "2022", "problem_number": "G1", "problem": "Let \\(A B C D E\\) be a convex pentagon such that \\(B C=D E\\). Assume there is a point \\(T\\) inside \\(A B C D E\\) with \\(T B=T D, T C=T E\\) and \\(\\angle T B A=\\angle A E T\\). Let lines \\(C D\\) and \\(C T\\) intersect line \\(A B\\) at points \\(P\\) and \\(Q\\), respectively, and let lines \\(C D\\) and \\(D T\\) intersect line \\(A E\\) at points \\(R\\) and \\(S\\), respectively. Assume that points \\(P, B, A, Q\\) and \\(R, E, A, S\\) respectively, are collinear and occur on their lines in this order. Prove that the points \\(P, S, Q, R\\) are concyclic.\n(Slovakia)", "solution": "1. By the conditions we have \\(B C=D E, C T=E T\\) and \\(T B=T D\\), so the triangles \\(T B C\\) and \\(T D E\\) are congruent, in particular \\(\\angle B T C=\\angle D T E\\).\n\nIn triangles \\(T B Q\\) and \\(T E S\\) we have \\(\\angle T B Q=\\angle S E T\\) and \\(\\angle Q T B=180^{\\circ}-\\angle B T C=180^{\\circ}- \\angle D T E=\\angle E T S\\), so these triangles are similar to each other. It follows that \\(\\angle T S E=\\angle B Q T\\) and\n\\[\n\\frac{T D}{T Q}=\\frac{T B}{T Q}=\\frac{T E}{T S}=\\frac{T C}{T S} .\n\\]\n\nBy rearranging this relation we get \\(T D \\cdot T S=T C \\cdot T Q\\), so \\(C, D, Q\\) and \\(S\\) are concyclic. (Alternatively, we can get \\(\\angle C Q D=\\angle C S D\\) from the similar triangles \\(T C S\\) and \\(T D Q\\).) Hence, \\(\\angle D C Q=\\angle D S Q\\).\n\nFinally, from the angles of triangle \\(C Q P\\) we get\n\\[\n\\angle R P Q=\\angle R C Q-\\angle P Q C=\\angle D S Q-\\angle D S R=\\angle R S Q,\n\\]\nwhich proves that \\(P, Q, R\\) and \\(S\\) are concyclic.\n![](https://cdn.mathpix.com/cropped/2025_08_23_bba1c16f961fdd6f4eb4g-46.jpg?height=563&width=1483&top_left_y=1513&top_left_x=291)\n\nSolution 2. As in the previous solution, we note that triangles \\(T B C\\) and \\(T D E\\) are congruent. Denote the intersection point of \\(D T\\) and \\(B A\\) by \\(V\\), and the intersection point of \\(C T\\) and \\(E A\\) by \\(W\\). From triangles \\(B C Q\\) and \\(D E S\\) we then have\n\\[\n\\begin{aligned}\n\\angle V S W & =\\angle D S E=180^{\\circ}-\\angle S E D-\\angle E D S=180^{\\circ}-\\angle A E T-\\angle T E D-\\angle E D T \\\\\n& =180^{\\circ}-\\angle T B A-\\angle T C B-\\angle C B T=180^{\\circ}-\\angle Q C B-\\angle C B Q=\\angle B Q C=\\angle V Q W,\n\\end{aligned}\n\\]\nmeaning that \\(V S Q W\\) is cyclic, and in particular \\(\\angle W V Q=\\angle W S Q\\). Since\n\\[\n\\angle V T B=180^{\\circ}-\\angle B T C-\\angle C T D=180^{\\circ}-\\angle C T D-\\angle D T E=\\angle E T W,\n\\]\nand \\(\\angle T B V=\\angle W E T\\) by assumption, we have that the triangles \\(V T B\\) and \\(W T E\\) are similar, hence\n\\[\n\\frac{V T}{W T}=\\frac{B T}{E T}=\\frac{D T}{C T} .\n\\]\n\nThus \\(C D \\| V W\\), and angle chasing yields\n\\[\n\\angle R P Q=\\angle W V Q=\\angle W S Q=\\angle R S Q\n\\]\nconcluding the proof.", "source_pdf": "imosl_2022.pdf", "notes": "fallback-regex"}
{"id": "IMO-2022-5", "contest": "IMO", "year": "2022", "problem_number": "N4", "problem": "Find all triples of positive integers \\((a, b, p)\\) with \\(p\\) prime and\n\\[\na^{p}=b!+p .\n\\]\n(Belgium)", "solution": "Answer: (2, 2, 2) and (3, 4, 3).\n\n1. Clearly, \\(a>1\\). We consider three cases.\nCase 1: We have \\(a<p\\). Then we either have \\(a \\leqslant b\\) which implies \\(a \\mid a^{p}-b!=p\\) leading to a contradiction, or \\(a>b\\) which is also impossible since in this case we have \\(b!\\leqslant a!<a^{p}-p\\), where the last inequality is true for any \\(p>a>1\\).\nCase 2: We have \\(a>p\\). In this case \\(b!=a^{p}-p>p^{p}-p \\geqslant p!\\) so \\(b>p\\) which means that \\(a^{p}=b!+p\\) is divisible by \\(p\\). Hence, \\(a\\) is divisible by \\(p\\) and \\(b!=a^{p}-p\\) is not divisible by \\(p^{2}\\). This means that \\(b<2 p\\). If \\(a<p^{2}\\) then \\(a / p<p\\) divides both \\(a^{p}\\) and \\(b!\\) and hence it also divides \\(p=a^{p}-b!\\) which is impossible. On the other hand, the case \\(a \\geqslant p^{2}\\) is also impossible since then \\(a^{p} \\geqslant\\left(p^{2}\\right)^{p}>(2 p-1)!+p \\geqslant b!+p\\).\n\nComment. The inequality \\(p^{2 p}>(2 p-1)!+p\\) can be shown e.g. by using\n\\[\n(2 p-1)!=[1 \\cdot(2 p-1)] \\cdot[2 \\cdot(2 p-2)] \\cdots \\cdots[(p-1)(p+1)] \\cdot p<\\left(\\left(\\frac{2 p}{2}\\right)^{2}\\right)^{p-1} \\cdot p=p^{2 p-1}\n\\]\nwhere the inequality comes from applying AM-GM to each of the terms in square brackets.\nCase 3: We have \\(a=p\\). In this case \\(b!=p^{p}-p\\). One can check that the values \\(p=2,3\\) lead to the claimed solutions and \\(p=5\\) does not lead to a solution. So we now assume that \\(p \\geqslant 7\\). We have \\(b!=p^{p}-p>p!\\) and so \\(b \\geqslant p+1\\) which implies that\n\\(v_{2}((p+1)!) \\leqslant v_{2}(b!)=v_{2}\\left(p^{p-1}-1\\right) \\stackrel{L T E}{=} 2 v_{2}(p-1)+v_{2}(p+1)-1=v_{2}\\left(\\frac{p-1}{2} \\cdot(p-1) \\cdot(p+1)\\right)\\),\nwhere in the middle we used lifting-the-exponent lemma. On the RHS we have three factors of \\((p+1)\\) !. But, due to \\(p+1 \\geqslant 8\\), there are at least 4 even numbers among \\(1,2, \\ldots, p+1\\), so this case is not possible.\n\nSolution 2. The cases \\(a \\neq p\\) are covered as in solution 1 , as are \\(p=2,3\\). For \\(p \\geqslant 5\\) we have \\(b!=p\\left(p^{p-1}-1\\right)\\). By Zsigmondy's Theorem there exists some prime \\(q\\) that divides \\(p^{p-1}-1\\) but does not divide \\(p^{k}-1\\) for \\(k<p-1\\). It follows that \\(\\operatorname{ord}_{q}(p)=p-1\\), and hence \\(q \\equiv 1 \\bmod (p-1)\\). Note that \\(p \\neq q\\). But then we must have \\(q \\geqslant 2 p-1\\), giving\n\\(b!\\geqslant(2 p-1)!=[1 \\cdot(2 p-1)] \\cdot[2 \\cdot(2 p-2)] \\cdots \\cdots[(p-1) \\cdot(p+1)] \\cdot p>(2 p-1)^{p-1} p>p^{p}>p^{p}-p\\), a contradiction.\n\nSolution 3. The cases \\(a \\neq p\\) are covered as in solution 1 , as are \\(p=2,3\\). Also \\(b>p\\), as \\(p^{p}>p!+p\\) for \\(p>2\\). The cases \\(p=5,7,11\\) are also checked manually, so assume \\(p \\geqslant 13\\). Let \\(q \\mid p+1\\) be an odd prime. By LTE\n\\[\nv_{q}\\left(p^{p}-p\\right)=v_{q}\\left(\\left(p^{2}\\right)^{\\frac{p-1}{2}}-1\\right)=v_{q}\\left(p^{2}-1\\right)+v_{q}\\left(\\frac{p-1}{2}\\right)=v_{q}(p+1) .\n\\]\n\nBut \\(b \\geqslant p+1\\), so then \\(v_{q}(b!)>v_{q}(p+1)\\), since \\(q<p+1\\), a contradiction. This means that \\(p+1\\) has no odd prime divisor, i.e. \\(p+1=2^{k}\\) for some \\(k\\).\n\nNow let \\(q \\mid p-1\\) be an odd prime. By LTE\n\\[\nv_{q}\\left(p^{p}-p\\right)=2 v_{q}(p-1)\n\\]\n\nLet \\(d=v_{q}(p-1)\\). Then \\(p \\geqslant 1+q^{d}\\), so\n\\[\nv_{q}(b!) \\geqslant v_{q}(p!) \\geqslant v_{q}\\left(q^{d}!\\right)>q^{d-1} \\geqslant 2 d\n\\]\nprovided \\(d \\geqslant 2\\) and \\(q>3\\), or \\(d \\geqslant 3\\).\nIf \\(q=3, d=2\\) and \\(p \\geqslant 13\\) then \\(v_{q}(b!) \\geqslant v_{q}(p!) \\geqslant v_{q}(13!)=5>2 d\\). Either way, \\(d \\leqslant 1\\).\nIf \\(p>2 q+1\\) (so \\(p>3 q\\), as \\(q \\mid p-1\\) ) then\n\\[\nv_{q}(b!) \\geqslant v_{q}((3 q)!)=3\n\\]\nso we must have \\(q \\geqslant \\frac{p}{2}\\), in other words, \\(p-1=2 q\\). This implies that \\(p=2^{k}-1\\) and \\(q=2^{k-1}-1\\) are both prime, but it is not possible to have two consecutive Mersenne primes.\n\nSolution 4. Let \\(a=p, b>p\\) and \\(p \\geqslant 5\\) (the remaining cases are dealt with as in solution 3). Modulo \\((p+1)^{2}\\) it holds that\n\\(p^{p}-p=(p+1-1)^{p}-p \\equiv\\binom{p}{1}(p+1)(-1)^{p-1}+(-1)^{p}-p=p(p+1)-1-p=p^{2}-1 \\not \\equiv 0 \\quad \\bmod \\left((p+1)^{2}\\right)\\).\nSince \\(p \\geqslant 5\\), the numbers 2 and \\(\\frac{p+1}{2}\\) are distinct and less than or equal to \\(p\\). Therefore, \\(p+1 \\mid p!\\), and so \\((p+1)^{2} \\mid(p+1)\\) !.\nBut \\(b \\geqslant p+1\\), so \\(b!\\equiv 0 \\not \\equiv p^{p}-p \\bmod (p+1)^{2}\\), a contradiction.", "source_pdf": "imosl_2022.pdf", "notes": "fallback-regex"}
{"id": "IMO-2022-3", "contest": "IMO", "year": "2022", "problem_number": "N7", "problem": "Let \\(k\\) be a positive integer and let \\(S\\) be a finite set of odd prime numbers. Prove that there is at most one way (modulo rotation and reflection) to place the elements of \\(S\\) around a circle such that the product of any two neighbors is of the form \\(x^{2}+x+k\\) for some positive integer \\(x\\).", "solution": ". Let us allow the value \\(x=0\\) as well; we prove the same statement under this more general constraint. Obviously that implies the statement with the original conditions.\n\nCall a pair \\(\\{p, q\\}\\) of primes with \\(p \\neq q\\) special if \\(p q=x^{2}+x+k\\) for some nonnegative integer \\(x\\). The following claim is the key mechanism of the problem:\nClaim.\n(a) For every prime \\(r\\), there are at most two primes less than \\(r\\) forming a special pair with \\(r\\).\n(b) If such \\(p\\) and \\(q\\) exist, then \\(\\{p, q\\}\\) is itself special.\n\nWe present two proofs of the claim.\nProof 1. We are interested in integers \\(1 \\leqslant x<r\\) satsfying\n\\[\nx^{2}+x+k \\equiv 0 \\quad(\\bmod r)\n\\]\n\nSince there are at most two residues modulo \\(r\\) that can satisfy that quadratic congruence, there are at most two possible values of \\(x\\). That proves (a).\n\nNow suppose there are primes \\(p, q\\) with \\(p<q<r\\) and nonnegative integers \\(x, y\\) such that\n\\[\n\\begin{aligned}\n& x^{2}+x+k=p r \\\\\n& y^{2}+y+k=q r .\n\\end{aligned}\n\\]\n\nFrom \\(p<q<r\\) we can see that \\(0 \\leqslant x<y \\leqslant r-1\\). The numbers \\(x, y\\) are the two solutions of (1); by Vieta's formulas, we should have \\(x+y \\equiv-1(\\bmod r)\\), so \\(x+y=r-1\\).\n\nLetting \\(K=4 k-1, X=2 x+1\\), and \\(Y=2 y+1\\), we obtain\n\\[\n\\begin{gathered}\n4 p r=X^{2}+K, \\\\\n4 q r=Y^{2}+K\n\\end{gathered}\n\\]\nwith \\(X+Y=2 r\\). Multiplying the two above equations,\n\\[\n\\begin{aligned}\n16 p q r^{2} & =\\left(X^{2}+K\\right)\\left(Y^{2}+K\\right) \\\\\n& =(X Y-K)^{2}+K(X+Y)^{2} \\\\\n& =(X Y-K)^{2}+4 K r^{2}, \\\\\n4 p q & =\\left(\\frac{X Y-K}{2 r}\\right)^{2}+K .\n\\end{aligned}\n\\]\n\nIn particular, the number \\(Z=\\frac{X Y-K}{2 r}\\) should be an integer, and so \\(4 p q=Z^{2}+K\\). By parity, \\(Z\\) is odd, and thus\n\\[\np q=z^{2}+z+k \\quad \\text { where } z=\\frac{Z-1}{2}\n\\]\nso \\(\\{p, q\\}\\) is special.\n\nProof 2. As before, we suppose that\n\\[\n\\begin{aligned}\n& x^{2}+x+k=p r \\\\\n& y^{2}+y+k=q r .\n\\end{aligned}\n\\]\n\nSubtracting, we have\n\\[\n(x+y+1)(x-y)=r(p-q) .\n\\]\n\nAs before, we have \\(x+y=r-1\\), so \\(x-y=p-q\\), and\n\\[\n\\begin{aligned}\n& x=\\frac{1}{2}(r+p-q-1) \\\\\n& y=\\frac{1}{2}(r+q-p-1)\n\\end{aligned}\n\\]\n\nThen,\n\\[\n\\begin{aligned}\nk=p r-x^{2}-x & =\\frac{1}{4}\\left(4 p r-(r+p-q-1)^{2}-2(r+p-q-1)\\right) \\\\\n& =\\frac{1}{4}\\left(4 p r-(r+p-q)^{2}+1\\right) \\\\\n& =\\frac{1}{4}\\left(2 p q+2 p r+2 q r-p^{2}-q^{2}-r^{2}+1\\right),\n\\end{aligned}\n\\]\nwhich is symmetric in \\(p, q, r\\), so\n\\[\np q=z^{2}+z+k \\quad \\text { where } z=\\frac{1}{2}(p+q-r-1)\n\\]\nand \\(\\{p, q\\}\\) is special.\nNow we settle the problem by induction on \\(|S|\\), with \\(|S| \\leqslant 3\\) clear.\nSuppose we have proven it for \\(|S|=n\\) and consider \\(|S|=n+1\\). Let \\(r\\) be the largest prime in \\(S\\); the claim tells us that in any valid cycle of primes:\n- the neighbors of \\(r\\) are uniquely determined, and\n- removing \\(r\\) from the cycle results in a smaller valid cycle.\n\nIt follows that there is at most one valid cycle, completing the inductive step.\nComment. The statement is not as inapplicable as it might seem. For example, for \\(k=41\\), the following 385 primes form a valid cycle of primes:\n\\[\n\\begin{aligned}\n& 53,4357,104173,65921,36383,99527,193789,2089123,1010357,2465263,319169,15559,3449,2647,1951,152297, \\\\\n& 542189,119773,91151,66431,222137,1336799,469069,45613,1047941,656291,355867,146669,874879,2213327, \\\\\n& 305119,3336209,1623467,520963,794201,1124833,28697,15683,42557,6571,39607,1238833,835421,2653681, \\\\\n& 5494387,9357539,511223,1515317,8868173,114079681,59334071,22324807,3051889,5120939,7722467,266239, \\\\\n& 693809,3931783,1322317,100469,13913,74419,23977,1361,62983,935021,512657,1394849,216259,45827, \\\\\n& 31393,100787,1193989,600979,209543,357661,545141,19681,10691,28867,165089,2118023,6271891,12626693, \\\\\n& 21182429,1100467,413089,772867,1244423,1827757,55889,1558873,5110711,1024427,601759,290869,91757, \\\\\n& 951109,452033,136471,190031,4423,9239,15809,24133,115811,275911,34211,877,6653,88001,46261,317741, \\\\\n& 121523,232439,379009,17827,2699,15937,497729,335539,205223,106781,1394413,4140947,8346383,43984757, \\\\\n& 14010721,21133961,729451,4997297,1908223,278051,529747,40213,768107,456821,1325351,225961,1501921, \\\\\n& 562763,75527,5519,9337,14153,499,1399,2753,14401,94583,245107,35171,397093,195907,2505623,34680911, \\\\\n& 18542791,7415917,144797293,455529251,86675291,252704911,43385123,109207907,204884269,330414209, \\\\\n& 14926789,1300289,486769,2723989,907757,1458871,65063,4561,124427,81343,252887,2980139,1496779, \\\\\n& 3779057,519193,47381,135283,268267,446333,669481,22541,54167,99439,158357,6823,32497,1390709, \\\\\n& 998029,670343,5180017,13936673,2123491,4391941,407651,209953,77249,867653,427117,141079,9539,227, \\\\\n& 1439,18679,9749,25453,3697,42139,122327,712303,244261,20873,52051,589997,4310569,1711069,291563, \\\\\n& 3731527,11045429,129098443,64620427,162661963,22233269,37295047,1936969,5033449,725537,1353973, \\\\\n& 6964457,2176871,97231,7001,11351,55673,16747,169003,1218571,479957,2779783,949609,4975787,1577959, \\\\\n& 2365007,3310753,79349,23189,107209,688907,252583,30677,523,941,25981,205103,85087,1011233,509659, \\\\\n& 178259,950479,6262847,2333693,305497,3199319,9148267,1527563,466801,17033,9967,323003,4724099, \\\\\n& 14278309,2576557,1075021,6462593,2266021,63922471,209814503,42117791,131659867,270892249,24845153, \\\\\n& 12104557,3896003,219491,135913,406397,72269,191689,2197697,1091273,2727311,368227,1911661,601883, \\\\\n& 892657,28559,4783,60497,31259,80909,457697,153733,11587,1481,26161,15193,7187,2143,21517,10079, \\\\\n& 207643,1604381,657661,126227,372313,2176331,748337,64969,844867,2507291,29317943,14677801,36952793, \\\\\n& 69332267,111816223,5052241,8479717,441263,3020431,1152751,13179611,38280013,6536771,16319657, \\\\\n& 91442699,30501409,49082027,72061511,2199433,167597,317963,23869,2927,3833,17327,110879,285517, \\\\\n& 40543,4861,21683,50527,565319,277829,687917,3846023,25542677,174261149,66370753,9565711,1280791, \\\\\n& 91393,6011,7283,31859,8677,10193,43987,11831,13591,127843,358229,58067,15473,65839,17477,74099, \\\\\n& 19603,82847,21851,61 .\n\\end{aligned}\n\\]", "source_pdf": "imosl_2022.pdf", "notes": "fallback-regex"}
{"id": "IMO-2023-4", "contest": "IMO", "year": "2023", "problem_number": "A3", "problem": "Let \\(x_{1}, x_{2}, \\ldots, x_{2023}\\) be distinct real positive numbers such that\n\\[\na_{n}=\\sqrt{\\left(x_{1}+x_{2}+\\cdots+x_{n}\\right)\\left(\\frac{1}{x_{1}}+\\frac{1}{x_{2}}+\\cdots+\\frac{1}{x_{n}}\\right)}\n\\]\nis an integer for every \\(n=1,2, \\ldots, 2023\\). Prove that \\(a_{2023} \\geqslant 3034\\).\n(Netherlands)", "solution": "1. We start with some basic observations. First note that the sequence \\(a_{1}, a_{2}, \\ldots, a_{2023}\\) is increasing and thus, since all elements are integers, \\(a_{n+1}-a_{n} \\geqslant 1\\). We also observe that \\(a_{1}=1\\) and\n\\[\na_{2}=\\sqrt{\\left(x_{1}+x_{2}\\right)\\left(\\frac{1}{x_{1}}+\\frac{1}{x_{2}}\\right)}>2\n\\]\nby Cauchy-Schwarz inequality and using \\(x_{1} \\neq x_{2}\\). So, \\(a_{2} \\geqslant 3\\).\nNow, we proceed to the main part of the argument. We observe that 3034 is about three halves of 2023. Motivated by this observation, we will prove the following.\nClaim. If \\(a_{n+1}-a_{n}=1\\), then \\(a_{n+2}-a_{n+1} \\geqslant 2\\).\nIn other words, the sequence has to increase by at least 2 at least half of the times. Assuming the claim is true, since \\(a_{1}=1\\), we would be done since\n\\[\n\\begin{aligned}\na_{2023} & =\\left(a_{2023}-a_{2022}\\right)+\\left(a_{2022}-a_{2021}\\right)+\\cdots+\\left(a_{2}-a_{1}\\right)+a_{1} \\\\\n& \\geqslant(2+1) \\cdot 1011+1 \\\\\n& =3034\n\\end{aligned}\n\\]\n\nWe now prove the claim. We start by observing that\n\\[\n\\begin{aligned}\na_{n+1}^{2}= & \\left(x_{1}+\\cdots+x_{n+1}\\right)\\left(\\frac{1}{x_{1}}+\\cdots+\\frac{1}{x_{n+1}}\\right) \\\\\n= & \\left(x_{1}+\\cdots+x_{n}\\right)\\left(\\frac{1}{x_{1}}+\\cdots+\\frac{1}{x_{n}}\\right)+1 \\\\\n& \\quad+\\frac{1}{x_{n+1}}\\left(x_{1}+\\cdots+x_{n}\\right)+x_{n+1}\\left(\\frac{1}{x_{1}}+\\cdots+\\frac{1}{x_{n}}\\right) \\\\\n\\geqslant & a_{n}^{2}+1+2 \\sqrt{\\frac{1}{x_{n+1}}\\left(x_{1}+\\cdots+x_{n}\\right) \\cdot x_{n+1}\\left(\\frac{1}{x_{1}}+\\cdots+\\frac{1}{x_{n}}\\right)} \\\\\n= & a_{n}^{2}+1+2 a_{n} \\\\\n= & \\left(a_{n}+1\\right)^{2}\n\\end{aligned}\n\\]\nwhere we used AM-GM to obtain the inequality. In particular, if \\(a_{n+1}=a_{n}+1\\), then\n\\[\n\\frac{1}{x_{n+1}}\\left(x_{1}+\\cdots+x_{n}\\right)=x_{n+1}\\left(\\frac{1}{x_{1}}+\\cdots+\\frac{1}{x_{n}}\\right)\n\\]\n\nNow, assume for the sake of contradiction that both \\(a_{n+1}=a_{n}+1\\) and \\(a_{n+2}=a_{n+1}+1\\) hold. In this case, (1) gives\n\\[\n\\frac{1}{x_{n+2}}\\left(x_{1}+\\cdots+x_{n+1}\\right)=x_{n+2}\\left(\\frac{1}{x_{1}}+\\cdots+\\frac{1}{x_{n+1}}\\right) .\n\\]\n\nWe can rewrite this relation as\n\\[\n\\frac{x_{n+1}}{x_{n+2}}\\left(\\frac{1}{x_{n+1}}\\left(x_{1}+\\cdots+x_{n}\\right)+1\\right)=\\frac{x_{n+2}}{x_{n+1}}\\left(x_{n+1}\\left(\\frac{1}{x_{1}}+\\cdots+\\frac{1}{x_{n}}\\right)+1\\right)\n\\]\n\nFrom (1) again, we conclude that \\(x_{n+1}=x_{n+2}\\) which is a contradiction.\n\nSolution 2. The trick is to compare \\(a_{n+2}\\) and \\(a_{n}\\). Observe that\n\\[\n\\begin{aligned}\na_{n+2}^{2}= & \\left(x_{1}+\\cdots+x_{n+2}\\right)\\left(\\frac{1}{x_{1}}+\\cdots+\\frac{1}{x_{n+2}}\\right) \\\\\n= & \\left(x_{1}+\\cdots+x_{n}\\right)\\left(\\frac{1}{x_{1}}+\\cdots+\\frac{1}{x_{n}}\\right)+\\left(x_{n+1}+x_{n+2}\\right)\\left(\\frac{1}{x_{n+1}}+\\frac{1}{x_{n+2}}\\right) \\\\\n& \\quad+\\left(x_{1}+\\cdots+x_{n}\\right)\\left(\\frac{1}{x_{n+1}}+\\frac{1}{x_{n+2}}\\right)+\\left(x_{n+1}+x_{n+2}\\right)\\left(\\frac{1}{x_{1}}+\\cdots+\\frac{1}{x_{n}}\\right) \\\\\n\\geqslant & a_{n}^{2}+\\left(x_{n+1}+x_{n+2}\\right)\\left(\\frac{1}{x_{n+1}}+\\frac{1}{x_{n+2}}\\right) \\\\\n& \\quad+2 \\sqrt{\\left(x_{n+1}+x_{n+2}\\right)\\left(\\frac{1}{x_{n+1}}+\\frac{1}{x_{n+2}}\\right)\\left(x_{1}+\\cdots+x_{n}\\right)\\left(\\frac{1}{x_{1}}+\\cdots+\\frac{1}{x_{n}}\\right)} \\\\\n= & a_{n}^{2}+\\left(x_{n+1}+x_{n+2}\\right)\\left(\\frac{1}{x_{n+1}}+\\frac{1}{x_{n+2}}\\right)+2 a_{n} \\sqrt{\\left(x_{n+1}+x_{n+2}\\right)\\left(\\frac{1}{x_{n+1}}+\\frac{1}{x_{n+2}}\\right)},\n\\end{aligned}\n\\]\nwhere we used AM-GM to obtain the inequality. Furthermore, we have\n\\[\n\\left(x_{n+1}+x_{n+2}\\right)\\left(\\frac{1}{x_{n+1}}+\\frac{1}{x_{n+2}}\\right)>4\n\\]\nbecause \\(x_{n+1} \\neq x_{n+2}\\) by assumption. Therefore, it follows that\n\\[\na_{n+2}^{2}>a_{n}^{2}+4+4 a_{n}=\\left(a_{n}+2\\right)^{2}\n\\]\n\nBecause \\(a_{n+2}\\) and \\(a_{n}\\) are both positive integers, we conclude that\n\\[\na_{n+2} \\geqslant a_{n}+3 .\n\\]\n\nA simple induction gives \\(a_{2 k+1} \\geqslant 3 k+a_{1}\\) for every \\(k \\geqslant 0\\). Since \\(a_{1}=1\\), it follows that \\(a_{2 k+1} \\geqslant 3 k+1\\). We get the desired conclusion for \\(k=1011\\).\n\nComment 1. A similar argument as in Solution 2 shows that \\(a_{2} \\geqslant 3\\) and \\(a_{2 k} \\geqslant 3 k\\) for every \\(k \\geqslant 1\\). Actually, these lower bounds on \\(a_{n}\\) are sharp (at least for \\(n \\leqslant 2023\\) ). In other words, there exists a sequence of distinct values \\(x_{1}, \\ldots, x_{2023}>0\\) for which\n\\[\na_{n}= \\begin{cases}\\frac{3 n-1}{2} & \\text { if } n \\text { is odd }, \\\\ \\frac{3 n}{2} & \\text { if } n \\text { is even },\\end{cases}\n\\]\nfor \\(n=1, \\ldots, 2023\\). The value of \\(x_{1}\\) can be chosen arbitrarily. The next values can be obtained inductively by solving the quadratic equation\n\\[\na_{n+1}^{2}=a_{n}^{2}+1+\\left(\\sum_{i=1}^{n} x_{i}\\right) \\frac{1}{x_{n+1}}+\\left(\\sum_{i=1}^{n} \\frac{1}{x_{i}}\\right) x_{n+1}\n\\]\nfor \\(x_{n+1}\\). Computation gives, for \\(n \\geqslant 1\\),\n\\[\nx_{n+1}= \\begin{cases}\\frac{3 n}{2\\left(\\sum_{i=1}^{n} \\frac{1}{x_{i}}\\right)} & \\text { if } n \\text { is even } \\\\ \\frac{6 n+1 \\pm 3 \\sqrt{n(3 n+2)}}{2\\left(\\sum_{i=1}^{n} \\frac{1}{x_{i}}\\right)} & \\text { if } n \\text { is odd }\\end{cases}\n\\]\n\nOne can check (with the help of a computer), that the values \\(x_{1}, \\ldots, x_{2023}\\) obtained by choosing \\(x_{1}=1\\) and \" + \" every time in the odd case are indeed distinct.\n\nIt is interesting to note that the discriminant always vanishes in the even case. This is a consequence of \\(a_{n+1}=a_{n}+1\\) being achieved as an equality case of AM-GM. Another cute observation is that the ratio \\(x_{2} / x_{1}\\) is equal to the fourth power of the golden ratio.\n\nComment 2. The estimations in Solutions 1 and 2 can be made more efficiently if one applies the following form of the Cauchy-Schwarz inequality instead:\n\\[\n\\sqrt{(a+b)(c+d)} \\geqslant \\sqrt{a c}+\\sqrt{b d}\n\\]\nfor arbitrary nonnegative numbers \\(a, b, c, d\\). Equality occurs if and only if \\(a: c=b: d=(a+b):(c+d)\\).\nFor instance, by applying (2) to \\(a=x_{1}+\\cdots+x_{n}, b=x_{n+1}, c=\\frac{1}{x_{1}}+\\cdots+\\frac{1}{x_{n}}\\) and \\(d=\\frac{1}{x_{n+1}}\\) we get\n\\[\n\\begin{aligned}\na_{n+1} & =\\sqrt{\\left(x_{1}+\\cdots+x_{n}+x_{n+1}\\right)\\left(\\frac{1}{x_{1}}+\\cdots+\\frac{1}{x_{n}}+\\frac{1}{x_{n+1}}\\right)} \\\\\n& \\geqslant \\sqrt{\\left(x_{1}+\\cdots+x_{n}\\right)\\left(\\frac{1}{x_{1}}+\\cdots+\\frac{1}{x_{n}}\\right)}+\\sqrt{x_{n+1} \\cdot \\frac{1}{x_{n+1}}}=a_{n}+1\n\\end{aligned}\n\\]\n\nA study of equality cases show that equality cannot occur twice in a row, as in Solution 1. Suppose that \\(a_{n+1}=a_{n}+1\\) and \\(a_{n+2}=a_{n+1}+1\\) for some index \\(n\\). By the equality case in (2) we have\n\\[\n\\frac{\\left(x_{1}+\\cdots+x_{n}\\right)+x_{n+1}}{\\left(\\frac{1}{x_{1}}+\\cdots+\\frac{1}{x_{n}}\\right)+\\frac{1}{x_{n+1}}}=\\frac{x_{n+1}}{1 / x_{n+1}}=x_{n+1}^{2} \\quad \\text { because } a_{n+1}=a_{n}+1\n\\]\nand\n\\[\n\\frac{x_{1}+\\cdots+x_{n}+x_{n+1}}{\\frac{1}{x_{1}}+\\cdots+\\frac{1}{x_{n}}+\\frac{1}{x_{n+1}}}=\\frac{x_{n+2}}{1 / x_{n+2}}=x_{n+2}^{2} \\quad \\text { because } a_{n+2}=a_{n+1}+1\n\\]\n\nThe left-hand sides are the same, so \\(x_{n+1}=x_{n+2}\\), but this violates the condition that \\(x_{n+1}\\) and \\(x_{n+2}\\) are distinct.\n\nThe same trick applies to Solution 2. We can compare \\(a_{n}\\) and \\(a_{n+2}\\) directly as\n\\[\n\\begin{aligned}\na_{n+2} & =\\sqrt{\\left(x_{1}+\\cdots+x_{n}+x_{n+1}+x_{n+2}\\right)\\left(\\frac{1}{x_{1}}+\\cdots+\\frac{1}{x_{n}}+\\frac{1}{x_{n+1}}+\\frac{1}{x_{n+2}}\\right)} \\\\\n& \\geqslant \\sqrt{\\left(x_{1}+\\cdots+x_{n}\\right)\\left(\\frac{1}{x_{1}}+\\cdots+\\frac{1}{x_{n}}\\right)}+\\sqrt{\\left(x_{n+1}+x_{n+2}\\right) \\cdot\\left(\\frac{1}{x_{n+1}}+\\frac{1}{x_{n+2}}\\right)} \\\\\n& =a_{n}+\\sqrt{\\left(x_{n+1}+x_{n+2}\\right) \\cdot\\left(\\frac{1}{x_{n+1}}+\\frac{1}{x_{n+2}}\\right)} \\\\\n& \\geqslant a_{n}+2 .\n\\end{aligned}\n\\]\n\nIn the last estimate, equality is not possible because \\(x_{n+1}\\) and \\(x_{n+2}\\) are distinct, so \\(a_{n+2}>a_{n}+2\\) and therefore \\(a_{n+2} \\geqslant a_{n}+3\\).", "source_pdf": "imosl_2023.pdf", "notes": "fallback-regex"}
{"id": "IMO-2023-3", "contest": "IMO", "year": "2023", "problem_number": "A6", "problem": "Let \\(k \\geqslant 2\\) be an integer. Determine all sequences of positive integers \\(a_{1}, a_{2}, \\ldots\\) for which there exists a monic polynomial \\(P\\) of degree \\(k\\) with non-negative integer coefficients such that\n\\[\nP\\left(a_{n}\\right)=a_{n+1} a_{n+2} \\cdots a_{n+k}\n\\]\nfor every integer \\(n \\geqslant 1\\).\n(Malaysia)", "solution": "Answer: The sequence ( \\(a_{n}\\) ) must be an arithmetic progression consisting of positive integers with common difference \\(d \\geqslant 0\\), and \\(P(x)=(x+d) \\cdots(x+k d)\\).\n\nCommon remarks. The following arguments and observations are implicit in the solutions given below.\n\nSuppose the sequence \\(\\left(a_{n}\\right)\\) is an arithmetic progression with common difference \\(d \\geqslant 0\\). Then it satisfies the condition with\n\\[\nP(x)=(x+d) \\cdots(x+k d)\n\\]\n\nThis settles one direction. Now suppose \\(\\left(a_{n}\\right)\\) is a sequence satisfying the condition. We will show that it is a non-decreasing arithmetic progression.\n\nSince \\(P(x)\\) has non-negative integer coefficients, it is strictly increasing on the positive real line. In particular, it holds that, for any positive integer \\(x, y\\),\n\\[\nP(x)<P(y) \\quad \\Longleftrightarrow \\quad x<y .\n\\]\n\nFurthermore, if the sequence ( \\(a_{n}\\) ) is eventually constant, then \\(P(x)=x^{k}\\) and the sequence \\(\\left(a_{n}\\right)\\) is actually constant. Indeed, if \\(P(x)\\) were not the polynomial \\(x^{k}\\), then \\(P\\left(a_{n}\\right)=a_{n+1} \\cdots a_{n+k}\\) cannot be satisfied for \\(n\\) such that \\(a_{n}=\\cdots=a_{n+k}\\). By a descending induction, we conclude that \\(\\left(a_{n}\\right)\\) is constant. Thus we can restrict to the case \\(\\left(a_{n}\\right)\\) is not eventually constant.\n\n1. We assume that \\(\\left(a_{n}\\right)\\) is not eventually constant.\nStep 1. The first goal is to show that the sequence must be increasing, i.e. \\(a_{n}<a_{n+1}\\) for all \\(n \\geqslant 1\\).\n\nFirst, by comparing the two equalities\n\\[\n\\begin{aligned}\nP\\left(a_{n}\\right) & =a_{n+1} a_{n+2} \\cdots a_{n+k} \\\\\nP\\left(a_{n+1}\\right) & =a_{n+2} \\cdots a_{n+k} a_{n+k+1}\n\\end{aligned}\n\\]\nwe observe that\n\\[\n\\begin{aligned}\n& a_{n}<a_{n+1} \\Longleftrightarrow P\\left(a_{n}\\right)<P\\left(a_{n+1}\\right) \\Longleftrightarrow a_{n+1}<a_{n+k+1}, \\\\\n& a_{n}>a_{n+1} \\Longleftrightarrow P\\left(a_{n}\\right)>P\\left(a_{n+1}\\right) \\Longleftrightarrow a_{n+1}>a_{n+k+1}, \\\\\n& a_{n}=a_{n+1} \\Longleftrightarrow P\\left(a_{n}\\right)=P\\left(a_{n+1}\\right) \\Longleftrightarrow a_{n+1}=a_{n+k+1} .\n\\end{aligned}\n\\]\n\nClaim 1. \\(\\quad a_{n} \\leqslant a_{n+1}\\) for all \\(n \\geqslant 1\\).\nProof. Suppose, to the contrary, that \\(a_{n(0)-1}>a_{n(0)}\\) for some \\(n(0) \\geqslant 2\\). We will give an infinite sequence of positive integers \\(n(0)<n(1)<\\cdots\\) satisfying\n\\[\na_{n(i)-1}>a_{n(i)} \\text { and } a_{n(i)}>a_{n(i+1)}\n\\]\n\nThen \\(a_{n(0)}, a_{n(1)}, a_{n(2)}, \\ldots\\) is an infinite decreasing sequence of positive integers, which is absurd.\nWe construct such a sequence inductively. If we have chosen \\(n(i)\\), then we let \\(n(i+1)\\) be the smallest index larger than \\(n(i)\\) such that \\(a_{n(i)}>a_{n(i+1)}\\). Note that such an index always exists and satisfies \\(n(i)+1 \\leqslant n(i+1) \\leqslant n(i)+k\\) because \\(a_{n(i)}>a_{n(i)+k}\\) by (2). We need to check that \\(a_{n(i+1)-1}>a_{n(i+1)}\\). This is immediate if \\(n(i+1)=n(i)+1\\) by construction. If \\(n(i+1) \\geqslant n(i)+2\\), then \\(a_{n(i+1)-1} \\geqslant a_{n(i)}\\) by minimality of \\(n(i+1)\\), and so \\(a_{n(i+1)-1} \\geqslant a_{n(i)}>a_{n(i+1)}\\).\n\nWe are now ready to prove that the sequence \\(a_{n}\\) is increasing. Suppose \\(a_{n}=a_{n+1}\\) for some \\(n \\geqslant 1\\). Then we also have \\(a_{n+1}=a_{n+k+1}\\) by (3), and since the sequence is non-decreasing we have \\(a_{n}=a_{n+1}=a_{n+2}=\\cdots=a_{n+k+1}\\). We repeat the argument for \\(a_{n+k}=a_{n+k+1}\\) and get that the sequence is eventually constant, which contradicts our assumption. Hence\n\\[\na_{n}<a_{n+1} \\text { for all } n \\geqslant 1\n\\]\n\nStep 2. The next and final goal is to prove that the sequence \\(a_{n}\\) is an arithmetic progression. Observe that we can make differences of terms appear as follows\n\\[\n\\begin{aligned}\nP\\left(a_{n}\\right) & =a_{n+1} a_{n+2} \\cdots a_{n+k} \\\\\n& =\\left(a_{n}+\\left(a_{n+1}-a_{n}\\right)\\right)\\left(a_{n}+\\left(a_{n+2}-a_{n}\\right)\\right) \\cdots\\left(a_{n}+\\left(a_{n+k}-a_{n}\\right)\\right) .\n\\end{aligned}\n\\]\n\nWe will prove that, for \\(n\\) large enough, the sum\n\\[\n\\left(a_{n+1}-a_{n}\\right)+\\left(a_{n+2}-a_{n}\\right)+\\cdots+\\left(a_{n+k}-a_{n}\\right)\n\\]\nis equal to the coefficient \\(b\\) of the term \\(x^{k-1}\\) in \\(P\\). The argument is based on the following claim.\nClaim 2. There exists a bound \\(A\\) with the following properties:\n1. If \\(\\left(c_{1}, \\ldots, c_{k}\\right)\\) is a \\(k\\)-tuple of positive integers with \\(c_{1}+\\cdots+c_{k}>b\\), then for every \\(x \\geqslant A\\) we have \\(P(x)<\\left(x+c_{1}\\right)\\left(x+c_{2}\\right) \\cdots\\left(x+c_{k}\\right)\\).\n2. If \\(\\left(c_{1}, \\ldots, c_{k}\\right)\\) is a \\(k\\)-tuple of positive integers with \\(c_{1}+\\cdots+c_{k}<b\\), then for every \\(x \\geqslant A\\) we have \\(P(x)>\\left(x+c_{1}\\right)\\left(x+c_{2}\\right) \\cdots\\left(x+c_{k}\\right)\\).\nProof. It suffices to show parts 1 and 2 separately, because then we can take the maximum of two bounds.\n\nWe first show part 1 . For each single \\(\\left(c_{1}, \\ldots, c_{k}\\right)\\) such a bound \\(A\\) exists since\n\\[\nP(x)-\\left(x+c_{1}\\right)\\left(x+c_{2}\\right) \\cdots\\left(x+c_{k}\\right)=\\left(b-\\left(c_{1}+\\cdots+c_{k}\\right)\\right) x^{k-1}+(\\text { terms of degree } \\leqslant k-2)\n\\]\nhas negative leading coefficient and hence takes negative values for \\(x\\) large enough.\nSuppose \\(A\\) is a common bound for all tuples \\(c=\\left(c_{1}, \\ldots, c_{k}\\right)\\) satisfying \\(c_{1}+\\cdots+c_{k}=b+1\\) (note that there are only finitely many such tuples). Then, for any tuple \\(c^{\\prime}=\\left(c_{1}^{\\prime}, \\ldots, c_{k}^{\\prime}\\right)\\) with \\(c_{1}^{\\prime}+\\cdots+c_{k}^{\\prime}>b\\), there exists a tuple \\(c=\\left(c_{1}, \\ldots, c_{k}\\right)\\) with \\(c_{1}+\\cdots+c_{k}=b+1\\) and \\(c_{i}^{\\prime} \\geqslant c_{i}\\), and then the inequality for \\(c^{\\prime}\\) follows from the inequality for \\(c\\).\n\nWe can show part 2 either in a similar way, or by using that there are only finitely many such tuples.\n\nTake \\(A\\) satisfying the assertion of Claim 2, and take \\(N\\) such that \\(n \\geqslant N\\) implies \\(a_{n} \\geqslant A\\). Then for each \\(n \\geqslant N\\), we have\n\\[\n\\left(a_{n+1}-a_{n}\\right)+\\cdots+\\left(a_{n+k}-a_{n}\\right)=b .\n\\]\n\nBy taking the difference of this equality and the equality for \\(n+1\\), we obtain\n\\[\na_{n+k+1}-a_{n+1}=k\\left(a_{n+1}-a_{n}\\right)\n\\]\nfor every \\(n \\geqslant N\\).\nWe conclude using an extremal principle. Let \\(d=\\min \\left\\{a_{n+1}-a_{n} \\mid n \\geqslant N\\right\\}\\), and suppose it is attained at some index \\(n \\geqslant N\\). Since\n\\[\nk d=k\\left(a_{n+1}-a_{n}\\right)=a_{n+k+1}-a_{n+1}=\\sum_{i=1}^{k}\\left(a_{n+i+1}-a_{n+i}\\right)\n\\]\nand each summand is at least \\(d\\), we conclude that \\(d\\) is also attained at \\(n+1, \\ldots, n+k\\), and inductively at all \\(n^{\\prime} \\geqslant n\\). We see that the equation \\(P(x)=(x+d)(x+2 d) \\cdots(x+k d)\\) is true for infinitely many values of \\(x\\) (all \\(a_{n^{\\prime}}\\) for \\(n^{\\prime} \\geqslant n\\) ), hence this is an equality of polynomials. Finally we use (backward) induction to show that \\(a_{n+1}-a_{n}=d\\) for every \\(n \\geqslant 1\\).\n\nSolution 2. We assume that \\(\\left(a_{n}\\right)\\) is not eventually constant. In this solution, we first prove an alternative version of Claim 1.\nClaim 3. There exist infinitely many \\(n \\geqslant 1\\) with\n\\[\na_{n} \\leqslant \\min \\left\\{a_{n+1}, \\ldots, a_{n+k}\\right\\} .\n\\]\n\nProof. Suppose not, then for all but finitely many \\(n \\geqslant 1\\), it holds that \\(a_{n}>\\min \\left\\{a_{n+1}, \\ldots, a_{n+k}\\right\\}\\). Hence for all large enough \\(n\\), there always exist some \\(1 \\leqslant l \\leqslant k\\) such that \\(a_{n}>a_{n+l}\\). This induces an infinite decreasing sequence \\(a_{n}>a_{n+l_{1}}>a_{n+l_{2}}>\\cdots\\) of positive integers, which is absurd.\n\nWe use Claim 3 to quickly settle the case \\(P(x)=x^{k}\\). In that case, for every \\(n\\) with \\(a_{n} \\leqslant \\min \\left\\{a_{n+1}, \\ldots, a_{n+k}\\right\\}\\), since \\(a_{n+1} \\cdots a_{n+k}=a_{n}^{k}\\), it implies \\(a_{n}=a_{n+1}=\\cdots=a_{n+k}\\). This shows that the sequence is eventually constant, which contradicts our assumption.\n\nFrom now on, assume\n\\[\nP(x)>x^{k} \\text { for all } x>0 .\n\\]\n\nClaim 4. For every \\(M>0\\), there exists some \\(N>0\\) such that \\(a_{n}>M\\) for all \\(n>N\\).\nProof. Suppose there exists some \\(M>0\\), such that \\(a_{n} \\leqslant M\\) for infinitely many \\(n\\). For each \\(i\\) with \\(a_{i} \\leqslant M\\), we consider the \\(k\\)-tuple ( \\(a_{i+1}, \\ldots, a_{i+k}\\) ). Then each of the terms in the \\(k\\)-tuple is bounded from above by \\(P\\left(a_{i}\\right)\\), and hence by \\(P(M)\\) too. Since the number of such \\(k\\)-tuples is bounded by \\(P(M)^{k}\\), we deduce by the Pigeonhole Principle that there exist some indices \\(i<j\\) such that \\(\\left(a_{i+1}, \\ldots, a_{i+k}\\right)=\\left(a_{j+1}, \\ldots, a_{j+k}\\right)\\). Since \\(a_{n}\\) is uniquely determined by the \\(k\\) terms before it, we conclude that \\(a_{i+k+1}=a_{j+k+1}\\) must hold, and similarly \\(a_{i+l}=a_{j+l}\\) for all \\(l \\geqslant 0\\), so the sequence is eventually periodic, for some period \\(p=j-i\\).\n\nTake \\(K\\) such that \\(a_{n}=a_{n+p}\\) for every \\(n \\geqslant K\\). Then, by taking the products of the inequalities\n\\[\na_{n}^{k}<P\\left(a_{n}\\right)=a_{n+1} \\cdots a_{n+k}\n\\]\nfor \\(K \\leqslant n \\leqslant K+p-1\\), we obtain\n\\[\n\\begin{aligned}\n\\prod_{n=K}^{K+p-1} a_{n}^{k} & <\\prod_{n=K}^{K+p-1} a_{n+1} \\cdots a_{n+k} \\\\\n& =a_{K+1} a_{K+2}^{2} \\cdots a_{K+k-1}^{k-1}\\left(\\prod_{n=K+k}^{K+p} a_{n}\\right)^{k} a_{K+p+1}^{k-1} \\cdots a_{K+p+k-2}^{2} a_{K+p+k-1} \\\\\n& =\\left(\\prod_{n=K}^{K+p-1} a_{n}\\right)^{k} \\quad(\\text { by periodicity }),\n\\end{aligned}\n\\]\nwhich is a contradiction.\nWrite \\(P(x)=x^{k}+b x^{k-1}+Q(x)\\), where \\(Q(x)\\) is of degree at most \\(k-2\\). Take \\(M\\) such that \\(x>M\\) implies \\(x^{k-1}>Q(x)\\).\nClaim 5. There exist non-negative integers \\(b_{1}, \\cdots, b_{k}\\) such that \\(P(x)=\\left(x+b_{1}\\right) \\cdots\\left(x+b_{k}\\right)\\), and such that, for infinitely many \\(n \\geqslant 1\\), we have \\(a_{n+i}=a_{n}+b_{i}\\) for every \\(1 \\leqslant i \\leqslant k\\).\nProof. By Claims 3 and 4, there are infinitely many \\(n\\) such that\n\\[\na_{n}>M \\text { and } a_{n} \\leqslant \\min \\left\\{a_{n+1}, \\ldots, a_{n+k}\\right\\} .\n\\]\n\nCall such indices \\(n\\) to be good. We claim that if \\(n\\) is a good index then\n\\[\n\\max \\left\\{a_{n+1}, \\ldots, a_{n+k}\\right\\} \\leqslant a_{n}+b\n\\]\n\nIndeed, if \\(a_{n+i} \\geqslant a_{n}+b+1\\), then together with \\(a_{n} \\leqslant \\min \\left\\{a_{n+1}, \\ldots, a_{n+k}\\right\\}\\) and \\(a_{n}^{k-1}>Q\\left(a_{n}\\right)\\), we have\n\\[\na_{n}^{k}+(b+1) a_{n}^{k-1}>a_{n}^{k}+b a_{n}^{k-1}+Q\\left(a_{n}\\right)=P\\left(a_{n}\\right) \\geqslant\\left(a_{n}+b+1\\right) a_{n}^{k-1}\n\\]\na contradiction.\nHence for each good index \\(n\\), we may write \\(a_{n+i}=a_{n}+b_{i}\\) for all \\(1 \\leqslant i \\leqslant k\\) for some choices of \\(\\left(b_{1}, \\ldots, b_{k}\\right)\\) (which may depend on \\(n\\) ) and \\(0 \\leqslant b_{i} \\leqslant b\\). Again by Pigeonhole Principle, some \\(k\\)-tuple ( \\(b_{1}, \\ldots, b_{k}\\) ) must be chosen for infinitely such good indices \\(n\\). This means that the equation \\(P\\left(a_{n}\\right)=\\left(a_{n}+b_{1}\\right) \\cdots\\left(a_{n}+b_{k}\\right)\\) is satisfied by infinitely many good indices \\(n\\). By Claim 4, \\(a_{n}\\) is unbounded among these \\(a_{n}\\) 's, hence \\(P(x)=\\left(x+b_{1}\\right) \\cdots\\left(x+b_{k}\\right)\\) must hold identically.\nClaim 6. We have \\(b_{i}=i b_{1}\\) for all \\(1 \\leqslant i \\leqslant k\\).\nProof. Call an index \\(n\\) excellent if \\(a_{n+i}=a_{n}+b_{i}\\) for every \\(1 \\leqslant i \\leqslant k\\). From Claim 5 we know there are infinitely many excellent \\(n\\).\n\nWe first show that for any pair \\(1 \\leqslant i<j \\leqslant k\\) there is \\(1 \\leqslant l \\leqslant k\\) such that \\(b_{j}=b_{i}+b_{l}\\). Indeed, for such \\(i\\) and \\(j\\) and for excellent \\(n, a_{n}+b_{j}\\) (which is equal to \\(a_{n+j}\\) ) divides \\(P\\left(a_{n+i}\\right)= \\prod_{l=1}^{k}\\left(a_{n}+b_{i}+b_{l}\\right)\\), and hence divides \\(\\prod_{l=1}^{k}\\left(b_{i}+b_{l}-b_{j}\\right)\\). Since \\(a_{n}+b_{j}\\) is unbounded among excellent \\(n\\), we have \\(\\prod_{l=1}^{k}\\left(b_{i}+b_{l}-b_{j}\\right)=0\\), hence there is \\(l\\) such that \\(b_{j}=b_{i}+b_{l}\\).\n\nIn particular, \\(b_{j}=b_{i}+b_{l} \\geqslant b_{i}\\), i.e. ( \\(b_{1}, \\ldots, b_{k}\\) ) is non-decreasing.\nSuppose \\(b_{1}=0\\) and \\(n\\) is an excellent number. In particular, it holds that \\(a_{n}=a_{n+1}\\). Moreover, since\n\\[\na_{n+k+1} P\\left(a_{n}\\right)=a_{n+1} \\cdots a_{n+k+1}=a_{n+1} P\\left(a_{n+1}\\right)\n\\]\nwe have \\(a_{n}=a_{n+1}=a_{n+k+1}\\), which divides \\(P\\left(a_{n+i}\\right)=\\prod_{l=1}^{k}\\left(a_{n}+b_{i}+b_{l}\\right)\\) for each \\(1 \\leqslant i \\leqslant k\\). Hence \\(a_{n}\\) divides \\(\\prod_{l=1}^{k}\\left(b_{i}+b_{l}\\right)\\). By the same reasoning, we have \\(b_{i}+b_{l}=0\\) for some \\(l\\), but since \\(b_{i}, b_{l} \\geqslant 0\\) we obtain \\(b_{i}=0\\) for each \\(1 \\leqslant i \\leqslant k\\).\n\nNow suppose \\(b_{1} \\geqslant 1\\). Then, for each \\(1 \\leqslant i<j \\leqslant k\\), we have \\(b_{j}-b_{i}=b_{l} \\geqslant b_{1} \\geqslant 1\\), hence ( \\(b_{1}, \\ldots, b_{k}\\) ) is strictly increasing. Therefore, the \\(k-1\\) elements \\(b_{2}<b_{3}<\\cdots<b_{k}\\) are exactly equal to \\(b_{1}+b_{1}<\\cdots<b_{1}+b_{k-1}\\), since they cannot be equal to \\(b_{1}+b_{k}\\). This gives \\(b_{i}=i b_{1}\\) for all \\(1 \\leqslant i \\leqslant k\\) as desired.\n\nClaim 6 implies \\(P(x)=(x+d)(x+2 d) \\cdots(x+k d)\\) for some \\(d \\geqslant 1\\), and there are infinitely many indices \\(n\\) with \\(a_{n+i}=a_{n}+i d\\) for \\(1 \\leqslant i \\leqslant k\\). By backwards induction, \\(P\\left(a_{n-1}\\right)= a_{n} \\cdots a_{n+k-1}\\) implies \\(a_{n-1}=a_{n}-d\\), and so on. Thus \\(a_{1}, \\ldots, a_{n}\\) forms an arithmetic progression with common difference \\(d\\). Since \\(n\\) can be arbitrarily large, the whole sequence is an arithmetic progression too, as desired.\n\nComment 1. A typical solution would first show some kind of increasing property (assuming \\(a_{n}\\) is not constant), and then use that property to deduce informations on the numbers \\(a_{n+i}-a_{n}(1 \\leqslant i \\leqslant k)\\) and/or on the polynomial \\(P\\).\n\nSolution 1 shows a strict one: \\(a_{n}<a_{n+1}\\) (arguments after Claim 1), which makes the latter part easier. Solution 2 (Claims 3 and 4) shows only weaker increasing properties, which require more complicated/tricky arguments in the latter part but still can solve the problem.\n\nComment 2. It would be interesting to sort out the case when \\(P\\) can take negative integer coefficients, or ( \\(a_{n}\\) ) is just an integer sequence. Then a decreasing arithmetic progression is possible too, yet that is not the only possibility. There exist bounded examples such as \\(1,-1,1,-1, \\ldots\\) with \\(P(x)=-x^{2}\\), or \\(0,1,-1,0,1,-1, \\ldots\\) with \\(P(x)=x^{2}-1\\). If furthermore \\(P\\) is allowed to be non-monic, then the situation is even more unclear. For instance, the sequence \\(1,2,4,8, \\ldots\\) works for the polynomial \\(P(x)=8 x^{2}\\).", "source_pdf": "imosl_2023.pdf", "notes": "fallback-regex"}
{"id": "IMO-2023-2", "contest": "IMO", "year": "2023", "problem_number": "G4", "problem": "Let \\(A B C\\) be an acute-angled triangle with \\(A B<A C\\). Denote its circumcircle by \\(\\Omega\\) and denote the midpoint of \\(\\operatorname{arc} C A B\\) by \\(S\\). Let the perpendicular from \\(A\\) to \\(B C\\) meet \\(B S\\) and \\(\\Omega\\) at \\(D\\) and \\(E \\neq A\\) respectively. Let the line through \\(D\\) parallel to \\(B C\\) meet line \\(B E\\) at \\(L\\) and denote the circumcircle of triangle \\(B D L\\) by \\(\\omega\\). Let \\(\\omega\\) meet \\(\\Omega\\) again at \\(P \\neq B\\).\n\nProve that the line tangent to \\(\\omega\\) at \\(P\\), and line \\(B S\\) intersect on the internal bisector of \\(\\angle B A C\\).\n(Portugal)", "solution": "1 (Triangles in Perspective). Let \\(S^{\\prime}\\) be the midpoint of \\(\\operatorname{arc} B C\\) of \\(\\Omega\\), diametrically opposite to \\(S\\) so \\(S S^{\\prime}\\) is a diameter in \\(\\Omega\\) and \\(A S^{\\prime}\\) is the angle bisector of \\(\\angle B A C\\). Let the tangent of \\(\\omega\\) at \\(P\\) meet \\(\\Omega\\) again at \\(Q \\neq P\\), then we have \\(\\angle S Q S^{\\prime}=90^{\\circ}\\).\n\nWe will show that triangles \\(A P D\\) and \\(S^{\\prime} Q S\\) are similar and their corresponding sides are parallel. Then it will follow that the lines connecting the corresponding vertices, namely line \\(A S^{\\prime}\\), that is the angle bisector of \\(\\angle B A C\\), line \\(P Q\\), that is the tangent to \\(\\omega\\) at \\(P\\), and \\(D S\\) are concurrent. Note that the sides \\(A D\\) and \\(S^{\\prime} S\\) have opposite directions, so the three lines cannot be parallel.\n![](https://cdn.mathpix.com/cropped/2025_08_23_2cb0be1b73ef2aa9a4e9g-65.jpg?height=1083&width=1346&top_left_y=1099&top_left_x=359)\n\nFirst we show that \\(A P \\perp D P\\). Indeed, from cyclic quadrilaterals \\(A P B E\\) and \\(D P L B\\) we can see that\n\\[\n\\angle P A D=\\angle P A E=180^{\\circ}-\\angle E B P=\\angle P B L=\\angle P D L=90^{\\circ}-\\angle A D P .\n\\]\n\nThen, in triangle \\(A P D\\) we have \\(\\angle D P A=180^{\\circ}-\\angle P A D-\\angle A D P=90^{\\circ}\\).\nNow we can see that:\n- Both lines \\(A D E\\) and \\(S S^{\\prime}\\) are perpendicular to \\(B C\\), so \\(A D \\| S^{\\prime} S\\).\n- Line \\(P Q\\) is tangent to circle \\(\\omega\\) at \\(P\\) so \\(\\angle D P Q=\\angle D B P=\\angle S B P=\\angle S Q P\\); it follows that \\(P D \\| Q S\\).\n- Finally, since \\(A P \\perp P D \\| Q S \\perp S^{\\prime} Q\\), we have \\(A P \\| S^{\\prime} Q\\) as well.\n\nHence the corresponding sides of triangles \\(A P D\\) and \\(S^{\\prime} Q S\\) are parallel completing the solution.\n\nSolution 2 (Pascal). Again, let \\(S^{\\prime}\\) be the midpoint of arc \\(B C\\), diametrically opposite to \\(S\\), so \\(A E S^{\\prime} S\\) is an isosceles trapezoid, and \\(\\angle S^{\\prime} B S=\\angle S^{\\prime} P S=90^{\\circ}\\). Let lines \\(A E\\) and \\(P S^{\\prime}\\) meet at \\(T\\) and let \\(A P\\) and \\(S^{\\prime} B\\) meet at point \\(M\\).\n\nWe will need that points \\(L, P, S\\) are collinear, and points \\(T\\) and \\(M\\) lie on circle \\(\\omega\\).\n- From \\(\\angle L P B=\\angle L D B=90^{\\circ}-\\angle B D E=90^{\\circ}-\\angle B S S^{\\prime}=\\angle S S^{\\prime} B=180^{\\circ}-\\angle B P S\\) we get \\(\\angle L P B+\\angle B P S=180^{\\circ}\\), so \\(L, P\\) and \\(S\\) are indeed collinear.\n- Since \\(S S^{\\prime}\\) is a diameter in \\(\\Omega\\), lines \\(L P S\\) and \\(P T S^{\\prime}\\) are perpendicular. We also have \\(L D \\| B C \\perp A E\\) hence \\(\\angle L D T=\\angle L P T=90^{\\circ}\\) and therefore \\(T \\in \\omega\\).\n- By \\(\\angle L P M=\\angle S P A=\\angle S E A=\\angle E A S^{\\prime}=\\angle E B S^{\\prime}=\\angle L B M\\), point \\(M\\) is concyclic with \\(B, P, L\\) so \\(M \\in \\omega\\).\n![](https://cdn.mathpix.com/cropped/2025_08_23_2cb0be1b73ef2aa9a4e9g-67.jpg?height=1086&width=1349&top_left_y=919&top_left_x=368)\n\nNow let \\(X\\) be the intersection of line \\(B D S\\) with the tangent of \\(\\omega\\) at \\(P\\) and apply Pascal's theorem to the degenerate cyclic hexagon \\(P P M B D T\\). This gives points \\(P P \\cap B D=X\\), \\(P M \\cap D T=A\\) and \\(M B \\cap T P=S^{\\prime}\\) are collinear so \\(X\\) lies on line \\(A S^{\\prime}\\), that is the bisector of \\(\\angle B A C\\).\n\nComment. It is easy to see that LMTD is a rectangle, but we did not need this information for the solution.\n\nSolution 3 (Projections). Let \\(A^{\\prime}\\) and \\(S^{\\prime}\\) be the points of \\(\\Omega\\) diametrically opposite to \\(A\\) and \\(S\\) respectively. It is well-known that \\(E\\) and \\(A^{\\prime}\\) are reflections with respect to \\(S S^{\\prime}\\) so \\(A S^{\\prime}\\) is the angle bisector of \\(\\angle E A A^{\\prime}\\). Define point \\(T\\) to be the intersection of \\(A E\\) and \\(P S^{\\prime}\\). As in the previous two solutions, we have: \\(\\angle D P A=90^{\\circ}\\) so \\(P D\\) passes through \\(A^{\\prime}\\); points \\(L, P, S\\) are collinear; and \\(T \\in \\omega\\).\n\nLet lines \\(A S^{\\prime}\\) and \\(P D A^{\\prime}\\) meet at \\(R\\). From the angles of triangles \\(P R S^{\\prime}\\) and \\(P T E\\) we get\n\\[\n\\angle A R P=\\angle A S^{\\prime} P+\\angle S^{\\prime} P A^{\\prime}=\\angle A E P+\\angle E P S^{\\prime}=\\angle A T P\n\\]\nso points \\(A, P, T, R\\) are concyclic. Denote their circle by \\(\\gamma\\). Due to \\(\\angle R P A=\\angle D P A=90^{\\circ}\\), segment \\(A R\\) is a diameter in \\(\\gamma\\).\n![](https://cdn.mathpix.com/cropped/2025_08_23_2cb0be1b73ef2aa9a4e9g-68.jpg?height=1181&width=1306&top_left_y=756&top_left_x=388)\n\nWe claim that circles \\(\\omega\\) and \\(\\gamma\\) are perpendicular. Let line \\(L P S\\) meet \\(\\gamma\\) again at \\(U \\neq P\\), and consider triangles \\(P L T\\) and \\(P T U\\). By \\(\\angle L P T=\\angle T P U=90^{\\circ}\\) and\n\\[\n\\angle P T L=\\angle P B L=180^{\\circ}-\\angle E B P=\\angle P A E=\\angle P A T=\\angle P U T,\n\\]\ntriangles PLT and PTU are similar. It follows that the spiral similarity that takes PLT to \\(P T U\\), maps \\(\\omega\\) to \\(\\gamma\\) and the angle of this similarity is \\(90^{\\circ}\\), so circles \\(\\omega\\) and \\(\\gamma\\) are indeed perpendicular.\n\nFinally, let lines \\(B D S\\) and \\(A R S^{\\prime}\\) meet at \\(X\\). We claim that \\(X\\) bisects \\(A R\\), so point \\(X\\) is the centre of \\(\\gamma\\) and, as \\(\\omega\\) and \\(\\gamma\\) are perpendicular, \\(P X\\) is tangent to \\(\\omega\\).\n\nLet \\(t\\) be the tangent of \\(\\omega\\) at \\(D\\). From \\(\\angle(D T, t)=\\angle T P D=\\angle S^{\\prime} P A^{\\prime}=\\angle E A S^{\\prime}\\) it can be seen that \\(t \\| A S^{\\prime}\\). Let \\(I\\) be the common point at infinity of \\(t\\) and \\(A S^{\\prime}\\). Moreover, let lines \\(L P S\\) and \\(A D T E\\) meet at \\(V\\). By projecting line \\(A S^{\\prime}\\) to circle \\(\\omega\\) through \\(D\\), then projecting \\(\\omega\\) to line \\(A E\\) through \\(L\\), finally projecting \\(A E\\) to \\(\\Omega\\) through \\(P\\), we find\n\\[\n\\frac{A X}{R X}=(A, R ; X, I) \\stackrel{D}{=}(T, P ; B, D) \\stackrel{L}{=}(T, V ; E, D) \\stackrel{P}{=}\\left(S^{\\prime}, S ; E, A^{\\prime}\\right)=-1,\n\\]\nso \\(X\\) is the midpoint of \\(A R\\).", "source_pdf": "imosl_2023.pdf", "notes": "fallback-regex"}
{"id": "IMO-2023-6", "contest": "IMO", "year": "2023", "problem_number": "G8", "problem": "Let \\(A B C\\) be an equilateral triangle. Points \\(A_{1}, B_{1}, C_{1}\\) lie inside triangle \\(A B C\\) such that triangle \\(A_{1} B_{1} C_{1}\\) is scalene, \\(B A_{1}=A_{1} C, C B_{1}=B_{1} A, A C_{1}=C_{1} B\\) and\n\\[\n\\angle B A_{1} C+\\angle C B_{1} A+\\angle A C_{1} B=480^{\\circ} .\n\\]\n\nLines \\(B C_{1}\\) and \\(C B_{1}\\) intersect at \\(A_{2}\\); lines \\(C A_{1}\\) and \\(A C_{1}\\) intersect at \\(B_{2}\\); and lines \\(A B_{1}\\) and \\(B A_{1}\\) intersect at \\(C_{2}\\).\n\nProve that the circumcircles of triangles \\(A A_{1} A_{2}, B B_{1} B_{2}, C C_{1} C_{2}\\) have two common points.", "solution": ". Let \\(\\delta_{A}, \\delta_{B}, \\delta_{C}\\) be the circumcircles of \\(\\triangle A A_{1} A_{2}, \\triangle B B_{1} B_{2}, \\triangle C C_{1} C_{2}\\). The general strategy of the solution is to find two different points having equal power with respect to \\(\\delta_{A}, \\delta_{B}, \\delta_{C}\\).\nClaim. \\(A_{1}\\) is the circumcentre of \\(A_{2} B C\\) and cyclic variations.\nProof. Since \\(A_{1}\\) lies on the perpendicular bisector of \\(B C\\) and inside \\(\\triangle B A_{2} C\\), it suffices to prove \\(\\angle B A_{1} C=2 \\angle B A_{2} C\\). This follows from\n\\[\n\\begin{aligned}\n\\angle B A_{2} C & =\\angle A_{2} B A+\\angle B A C+\\angle A C A_{2} \\\\\n& =\\frac{1}{2}\\left(\\left(180^{\\circ}-\\angle A C_{1} B\\right)+\\left(180^{\\circ}-\\angle C B_{1} A\\right)\\right)+60^{\\circ} \\\\\n& =240^{\\circ}-\\frac{1}{2}\\left(480^{\\circ}-\\angle B A_{1} C\\right) \\\\\n& =\\frac{1}{2} \\angle B A_{1} C\n\\end{aligned}\n\\]\n![](https://cdn.mathpix.com/cropped/2025_08_23_2cb0be1b73ef2aa9a4e9g-80.jpg?height=864&width=1006&top_left_y=1541&top_left_x=531)\n\nThe circumcentres above give\n\\[\n\\angle B_{1} B_{2} C_{1}=\\angle B_{1} B_{2} A=\\angle B_{2} A B_{1}=\\angle C_{1} A C_{2}=\\angle A C_{2} C_{1}=\\angle B_{1} C_{2} C_{1}\n\\]\nand so \\(B_{1} C_{1} B_{2} C_{2}\\) is cyclic. Likewise \\(C_{1} A_{1} C_{2} A_{2}\\) and \\(A_{1} B_{1} A_{2} B_{2}\\) are cyclic. Note that hexagon \\(A_{1} B_{2} C_{1} A_{2} B_{1} C_{2}\\) is not cyclic since\n\\[\n\\angle C_{2} A_{1} B_{2}+\\angle B_{2} C_{1} A_{2}+\\angle A_{2} B_{1} C_{2}=480^{\\circ} \\neq 360^{\\circ} .\n\\]\n\nThus we can apply radical axis theorem to the three circles to show that \\(A_{1} A_{2}, B_{1} B_{2}, C_{1}, C_{2}\\) concur at a point \\(X\\) and this point has equal power with respect to \\(\\delta_{A}, \\delta_{B}, \\delta_{C}\\).\n\nLet the circumcircle of \\(\\triangle A_{2} B C\\) meet \\(\\delta_{A}\\) at \\(A_{3} \\neq A_{2}\\). Define \\(B_{3}\\) and \\(C_{3}\\) similarly.\nClaim. \\(B C B_{3} C_{3}\\) cyclic.\nProof. Using directed angles\n\\[\n\\begin{aligned}\n\\npreceq B C_{3} C & =\\Varangle B C_{3} C_{2}+\\npreceq C_{2} C_{3} C \\\\\n& =\\Varangle B A C_{2}+\\npreceq C_{2} C_{1} C \\\\\n& =90^{\\circ}+\\npreceq\\left(C_{1} C, A C_{2}\\right)+\\npreceq C_{2} C_{1} C \\\\\n& =90^{\\circ}+\\npreceq C_{1} C_{2} B_{1} .\n\\end{aligned}\n\\]\n\nSimilarly \\(\\Varangle C B_{3} B=90^{\\circ}+\\Varangle B_{1} B_{2} C_{1}\\). Hence, using \\(B_{1} C_{1} B_{2} C_{2}\\) cyclic\n\\[\n\\Varangle B B_{3} C=90^{\\circ}+\\Varangle C_{1} B_{2} B_{1}=90^{\\circ}+\\Varangle C_{1} C_{2} B_{1}=\\Varangle B C_{3} C\n\\]\nas required.\n![](https://cdn.mathpix.com/cropped/2025_08_23_2cb0be1b73ef2aa9a4e9g-81.jpg?height=1032&width=1475&top_left_y=1102&top_left_x=296)\n\nSimilarly \\(C A C_{3} A_{3}\\) and \\(A B A_{3} B_{3}\\) are cyclic. \\(A C_{3} B A_{3} C B_{3}\\) is not cyclic because then \\(A B_{2} C B_{3}\\) cyclic would mean \\(B_{2}\\) lies on \\(\\odot A B C\\) which is impossible since \\(B_{2}\\) lies inside \\(\\triangle A B C\\). Thus we can apply radical axis theorem to the three circles to get \\(A A_{3}, B B_{3}, C C_{3}\\) concur at a point \\(Y\\) which has equal power with respect to \\(\\delta_{A}, \\delta_{B}, \\delta_{C}\\).\n\nWe now make some technical observations before finishing.\n- Let \\(O\\) be the centre of \\(\\triangle A B C\\). We have that\n\\[\n\\angle B A_{1} C=480^{\\circ}-\\angle C B_{1} A-\\angle A C_{1} B>480^{\\circ}-180^{\\circ}-180^{\\circ}=120^{\\circ} .\n\\]\nso \\(A_{1}\\) lies inside \\(\\triangle B O C\\). We have similar results for \\(B_{1}, C_{1}\\) and thus \\(\\triangle B A_{1} C, \\triangle C B_{1} A\\), \\(\\triangle A C_{1} B\\) have disjoint interiors. It follows that \\(A_{1} B_{2} C_{1} A_{2} B_{1} C_{2}\\) is a convex hexagon thus \\(X\\) lies on segment \\(A_{1} A_{2}\\) and therefore is inside \\(\\delta_{A}\\).\n- Since \\(A_{1}\\) is the centre of \\(A_{2} B C\\) we have that \\(A_{1} A_{2}=A_{1} A_{3}\\) so, from cyclic quadrilateral \\(A A_{2} A_{1} A_{3}\\) we get that lines \\(A A_{2}\\) and \\(A A_{3} \\equiv A Y\\) are reflections in line \\(A A_{1}\\). As \\(X\\) lies on segment \\(A_{1} A_{2}\\), the only way \\(X \\equiv Y\\) is if \\(A_{1}\\) and \\(A_{2}\\) both lie on the perpendicular bisector of \\(B C\\). But this forces \\(B_{1}\\) and \\(C_{1}\\) to also be reflections in this line meaning \\(A_{1} B_{1}=A_{1} C_{1}\\) contradicting the scalene condition.\n\nSummarising, we have distinct points \\(X, Y\\) with equal power with respect to \\(\\delta_{A}, \\delta_{B}, \\delta_{C}\\) thus these circles have a common radical axis. As \\(X\\) lies inside \\(\\delta_{A}\\) (and similarly \\(\\delta_{B}, \\delta_{C}\\) ), this radical axis intersects the circles at two points and so \\(\\delta_{A}, \\delta_{B}, \\delta_{C}\\) have two points in common.\n\nComment. An alternative construction for \\(Y\\) comes by observing that\n\\[\n\\frac{\\sin \\angle B A A_{2}}{\\sin \\angle A_{2} A C}=\\frac{\\frac{A_{2} B}{A A_{2}} \\sin \\angle A_{2} B A}{\\frac{A_{2} C}{A A_{2}} \\sin \\angle A C A_{2}}=\\frac{A_{2} B}{A_{2} C} \\cdot \\frac{\\sin \\angle C_{1} B A}{\\sin \\angle A C B_{1}}=\\frac{\\sin \\angle B_{1} C B}{\\sin \\angle C B C_{1}} \\cdot \\frac{\\sin \\angle C_{1} B A}{\\sin \\angle A C B_{1}}\n\\]\nand hence\n\\[\n\\frac{\\sin \\angle B A A_{2}}{\\sin \\angle A_{2} A C} \\cdot \\frac{\\sin \\angle C B B_{2}}{\\sin \\angle B_{2} B A} \\cdot \\frac{\\sin \\angle A C C_{2}}{\\sin \\angle C_{2} C B}=1\n\\]\nso by Ceva's theorem, \\(A A_{2}, B B_{2}, C C_{2}\\) concur and thus we can construct the isogonal conjugate of this point of concurrency which turns out to be \\(Y\\).\n\n\\section*{Number Theory}", "source_pdf": "imosl_2023.pdf", "notes": "fallback-regex"}
{"id": "IMO-2023-1", "contest": "IMO", "year": "2023", "problem_number": "N1", "problem": "Determine all positive, composite integers \\(n\\) that satisfy the following property: if the positive divisors of \\(n\\) are \\(1=d_{1}<d_{2}<\\cdots<d_{k}=n\\), then \\(d_{i}\\) divides \\(d_{i+1}+d_{i+2}\\) for every \\(1 \\leqslant i \\leqslant k-2\\).\n(Colombia)", "solution": "Answer: \\(n=p^{r}\\) is a prime power for some \\(r \\geqslant 2\\).\n\n1. It is easy to see that such an \\(n=p^{r}\\) with \\(r \\geqslant 2\\) satisfies the condition as \\(d_{i}=p^{i-1}\\) with \\(1 \\geqslant i \\geqslant k=r+1\\) and clearly\n\\[\np^{i-1} \\mid p^{i}+p^{i+1}\n\\]\n\nNow, let us suppose that there is a positive integer \\(n\\) that satisfies the divisibility condition of the problem and that has two different prime divisors \\(p\\) and \\(q\\). Without lost of generality, we assume \\(p<q\\) and that they are the two smallest prime divisors of \\(n\\). Then there is a positive integer \\(j\\) such that\n\\[\nd_{1}=1, d_{2}=p, \\ldots, d_{j}=p^{j-1}, d_{j+1}=p^{j}, d_{j+2}=q\n\\]\nand it follows that\n\\[\nd_{k-j-1}=\\frac{n}{q}, d_{k-j}=\\frac{n}{p^{j}}, d_{k-j+1}=\\frac{n}{p^{j-1}}, \\ldots, d_{k-1}=\\frac{n}{p}, d_{k}=n\n\\]\n\nThus\n\\[\nd_{k-j-1}=\\frac{n}{q} \\left\\lvert\\, d_{k-j}+d_{k-j+1}=\\frac{n}{p^{j}}+\\frac{n}{p^{j-1}}=\\frac{n}{p^{j}}(p+1)\\right.\n\\]\n\nThis gives \\(p^{j} \\mid q(p+1)\\), which is a contradiction since \\(\\operatorname{gcd}(p, p+1)=1\\) and \\(p \\neq q\\).\nSolution 2. Since \\(d_{i} d_{k+1-i}=n\\), we have the equivalence:\n\\[\nd_{k-i-1}\\left|d_{k-i}+d_{k-i+1} \\Longleftrightarrow \\frac{n}{d_{i+2}}\\right| \\frac{n}{d_{i+1}}+\\frac{n}{d_{i}}\n\\]\n\nWe multiply both sides by \\(d_{i} d_{i+1} d_{i+2}\\) and cancel the \\(n\\) 's to get\n\\[\nd_{i} d_{i+1} \\mid d_{i} d_{i+2}+d_{i+1} d_{i+2}\n\\]\n\nHence,\n\\[\nd_{i} \\mid d_{i+1} d_{i+2}\n\\]\n\nMoreover, by the condition of the problem,\n\\[\nd_{i} \\mid d_{i+1}\\left(d_{i+1}+d_{i+2}\\right)=d_{i+1}^{2}+d_{i+1} d_{i+2}\n\\]\n\nCombining this with (2) we get that \\(d_{i} \\mid d_{i+1}^{2}\\) for all \\(1 \\leqslant i \\leqslant k-2\\).\nLet \\(d_{2}=p\\) be the smallest prime divisor of \\(n\\). By induction on \\(i\\) we prove that \\(p \\mid d_{i}\\) for all \\(2 \\leqslant i \\leqslant k-1\\). The base case \\(d_{2}=p\\) is obvious. Let us suppose that \\(p \\mid d_{j}\\) for some \\(2 \\leqslant j \\leqslant k-2\\). Then we have that\n\\[\np\\left|d_{j}\\right| d_{j+1}^{2} \\Longrightarrow p \\mid d_{j+1}\n\\]\nas \\(p\\) is prime, which completes the induction. This implies that \\(n\\) has to be a prime power, as otherwise there would be another prime \\(q\\) that divides \\(n\\) and we would get that \\(p \\mid q\\) which is obviously false.\n\nWe finally check that the powers of \\(p\\) satisfy the condition in the statement of the problem as in Solution 1.\n\nSolution 3. We start by proving the following claim:\nClaim. \\(d_{i} \\mid d_{i+1}\\) for every \\(1 \\leqslant i \\leqslant k-1\\).\nProof. We prove the Claim by induction on \\(i\\); it is trivial for \\(i=1\\) because \\(d_{1}=1\\). Suppose that \\(2 \\leqslant i \\leqslant k-1\\) and the Claim is true for \\(i-1\\), i.e. \\(d_{i-1} \\mid d_{i}\\). By the induction hypothesis and the problem condition, \\(d_{i-1} \\mid d_{i}\\) and \\(d_{i-1} \\mid d_{i}+d_{i+1}\\), so \\(d_{i-1} \\mid d_{i+1}\\).\n\nNow consider the divisors \\(d_{k-i}=\\frac{n}{d_{i+1}}, d_{k-i+1}=\\frac{n}{d_{i}}, d_{k-i+2}=\\frac{n}{d_{i-1}}\\). By the problem condition,\n\\[\n\\frac{d_{k-i+1}+d_{k-i+2}}{d_{k-i}}=\\frac{\\frac{n}{d_{i}}+\\frac{n}{d_{i-1}}}{\\frac{n}{d_{i+1}}}=\\frac{d_{i+1}}{d_{i}}+\\frac{d_{i+1}}{d_{i-1}}\n\\]\nis an integer. We conclude that \\(\\frac{d_{i+1}}{d_{i}}\\) is an integer, so \\(d_{i} \\mid d_{i+1}\\).\nBy the Claim, \\(n\\) cannot have two different prime divisors because the smallest one would divide the other one. Hence, \\(n\\) must be a power of a prime, and powers of primes satisfy the condition of the problem as we saw in Solution 1.\n\nSolution 4. We present here a more technical way of finishing Solution 1 after obtaining (1). We let \\(v_{p}(m)\\) denote the \\(p\\)-adic valuation of \\(m\\). Notice that \\(v_{p}(n / q)=v_{p}(n)\\) as \\(\\operatorname{gcd}(p, q)=1\\) and that\n\\[\nv_{p}\\left(\\frac{n}{p^{j}}(p+1)\\right)=v_{p}(n)-j\n\\]\nas \\(\\operatorname{gcd}(p, p+1)=1\\). But (1) implies\n\\[\nv_{p}(n)=v_{p}(n / q) \\leqslant v_{p}\\left(\\frac{n}{p^{j}}(p+1)\\right)=v_{p}(n)-j\n\\]\nwhich is a contradiction. Thus \\(n\\) has only one prime divisor as desired.", "source_pdf": "imosl_2023.pdf", "notes": "fallback-regex"}
{"id": "IMO-2024-1", "contest": "IMO", "year": "2024", "problem_number": "A1", "problem": "Determine all real numbers \\(\\alpha\\) such that the number\n\\[\n\\lfloor\\alpha\\rfloor+\\lfloor 2 \\alpha\\rfloor+\\cdots+\\lfloor n \\alpha\\rfloor\n\\]\nis a multiple of \\(n\\) for every positive integer \\(n\\). (Here \\(\\lfloor z\\rfloor\\) denotes the greatest integer less than or equal to \\(z\\).)\n(Colombia)", "solution": "Answer: All even integers satisfy the condition of the problem and no other real number \\(\\alpha\\) does so.\n\n1. First we will show that even integers satisfy the condition. If \\(\\alpha=2 m\\) where \\(m\\) is an integer then\n\\[\n\\lfloor\\alpha\\rfloor+\\lfloor 2 \\alpha\\rfloor+\\cdots+\\lfloor n \\alpha\\rfloor=2 m+4 m+\\cdots+2 m n=m n(n+1)\n\\]\nwhich is a multiple of \\(n\\).\nNow we will show that they are the only real numbers satisfying the conditions of the problem. Let \\(\\alpha=k+\\epsilon\\) where \\(k\\) is an integer and \\(0 \\leqslant \\epsilon<1\\). Then the number\n\\[\n\\begin{aligned}\n\\lfloor\\alpha\\rfloor+\\lfloor 2 \\alpha\\rfloor+\\cdots+\\lfloor n \\alpha\\rfloor & =k+\\lfloor\\epsilon\\rfloor+2 k+\\lfloor 2 \\epsilon\\rfloor+\\cdots+n k+\\lfloor n \\epsilon\\rfloor \\\\\n& =\\frac{k n(n+1)}{2}+\\lfloor\\epsilon\\rfloor+\\lfloor 2 \\epsilon\\rfloor+\\cdots+\\lfloor n \\epsilon\\rfloor\n\\end{aligned}\n\\]\nhas to be a multiple of \\(n\\). We consider two cases based on the parity of \\(k\\).\nCase 1: \\(k\\) is even.\nThen \\(\\frac{k n(n+1)}{2}\\) is always a multiple of \\(n\\). Thus\n\\[\n\\lfloor\\epsilon\\rfloor+\\lfloor 2 \\epsilon\\rfloor+\\cdots+\\lfloor n \\epsilon\\rfloor\n\\]\nalso has to be a multiple of \\(n\\).\nWe will prove that \\(\\lfloor n \\epsilon\\rfloor=0\\) for every positive integer \\(n\\) by strong induction. The base case \\(n=1\\) follows from the fact that \\(0 \\leqslant \\epsilon<1\\). Let us suppose that \\(\\lfloor m \\epsilon\\rfloor=0\\) for every \\(1 \\leqslant m<n\\). Then the number\n\\[\n\\lfloor\\epsilon\\rfloor+\\lfloor 2 \\epsilon\\rfloor+\\cdots+\\lfloor n \\epsilon\\rfloor=\\lfloor n \\epsilon\\rfloor\n\\]\nhas to be a multiple of \\(n\\). As \\(0 \\leqslant \\epsilon<1\\) then \\(0 \\leqslant n \\epsilon<n\\), which means that the number \\(\\lfloor n \\epsilon\\rfloor\\) has to be equal to 0 .\n\nThe equality \\(\\lfloor n \\epsilon\\rfloor=0\\) implies \\(0 \\leqslant \\epsilon<1 / n\\). Since this has to happen for all \\(n\\), we conclude that \\(\\epsilon=0\\) and then \\(\\alpha\\) is an even integer.\n\n\\section*{Case 2: \\(k\\) is odd.}\n\nWe will prove that \\(\\lfloor n \\epsilon\\rfloor=n-1\\) for every natural number \\(n\\) by strong induction. The base case \\(n=1\\) again follows from the fact that \\(0 \\leqslant \\epsilon<1\\). Let us suppose that \\(\\lfloor m \\epsilon\\rfloor=m-1\\) for every \\(1 \\leqslant m<n\\). We need the number\n\\[\n\\begin{aligned}\n\\frac{k n(n+1)}{2}+\\lfloor\\epsilon\\rfloor+\\lfloor 2 \\epsilon\\rfloor+\\cdots+\\lfloor n \\epsilon\\rfloor & =\\frac{k n(n+1)}{2}+0+1+\\cdots+(n-2)+\\lfloor n \\epsilon\\rfloor \\\\\n& =\\frac{k n(n+1)}{2}+\\frac{(n-2)(n-1)}{2}+\\lfloor n \\epsilon\\rfloor \\\\\n& =\\frac{k+1}{2} n^{2}+\\frac{k-3}{2} n+1+\\lfloor n \\epsilon\\rfloor\n\\end{aligned}\n\\]\nto be a multiple of \\(n\\). As \\(k\\) is odd, we need \\(1+\\lfloor n \\epsilon\\rfloor\\) to be a multiple of \\(n\\). Again, as \\(0 \\leqslant \\epsilon<1\\) then \\(0 \\leqslant n \\epsilon<n\\), so \\(\\lfloor n \\epsilon\\rfloor=n-1\\) as we wanted.\n\nThis implies that \\(1-\\frac{1}{n} \\leqslant \\epsilon<1\\) for all \\(n\\) which is absurd. So there are no other solutions in this case.\n\nSolution 2. As in Solution 1 we check that for even integers the condition is satisfied. Then, without loss of generality we can assume \\(0 \\leqslant \\alpha<2\\). We set \\(S_{n}=\\lfloor\\alpha\\rfloor+\\lfloor 2 \\alpha\\rfloor+\\cdots+\\lfloor n \\alpha\\rfloor\\).\n\nNotice that\n\\[\n\\begin{array}{ll}\nS_{n} \\equiv 0 & (\\bmod n) \\\\\nS_{n} \\equiv S_{n}-S_{n-1}=\\lfloor n \\alpha\\rfloor & (\\bmod n-1)\n\\end{array}\n\\]\n\nSince \\(\\operatorname{gcd}(n, n-1)=1\\), (1) and (2) imply that\n\\[\nS_{n} \\equiv n\\lfloor n \\alpha\\rfloor \\quad(\\bmod n(n-1))\n\\]\n\nIn addition,\n\\[\n0 \\leqslant n\\lfloor n \\alpha\\rfloor-S_{n}=\\sum_{k=1}^{n}(\\lfloor n \\alpha\\rfloor-\\lfloor k \\alpha\\rfloor)<\\sum_{k=1}^{n}(n \\alpha-k \\alpha+1)=\\frac{n(n-1)}{2} \\alpha+n\n\\]\n\nFor \\(n\\) large enough, the RHS of (4) is less than \\(n(n-1)\\). Then (3) forces\n\\[\n0=S_{n}-n\\lfloor n \\alpha\\rfloor=\\sum_{k=1}^{n}(\\lfloor n \\alpha\\rfloor-\\lfloor k \\alpha\\rfloor)\n\\]\nfor \\(n\\) large enough.\nSince \\(\\lfloor n \\alpha\\rfloor-\\lfloor k \\alpha\\rfloor \\geqslant 0\\) for \\(1 \\leqslant k \\leqslant n\\), we get from (5) that, for all \\(n\\) large enough, all these inequalities are equalities. In particular \\(\\lfloor\\alpha\\rfloor=\\lfloor n \\alpha\\rfloor\\) for all \\(n\\) large enough, which is absurd unless \\(\\alpha=0\\).\n\nComment. An alternative ending to the previous solution is as follows.\nBy definition we have \\(S_{n} \\leqslant \\alpha \\frac{n(n+1)}{2}\\), on the other hand (5) implies \\(S_{n} \\geqslant \\alpha n^{2}-n\\) for all \\(n\\) large enough, so \\(\\alpha=0\\).\n\nSolution 3. As in other solutions, without loss of generality we may assume that \\(0 \\leqslant \\alpha<2\\). Even integers satisfy the condition, so we assume \\(0<\\alpha<2\\) and we will derive a contradiction.\n\nBy induction on \\(n\\), we will simultaneously show that\n\\[\n\\begin{gathered}\n\\lfloor\\alpha\\rfloor+\\lfloor 2 \\alpha\\rfloor+\\cdots+\\lfloor n \\alpha\\rfloor=n^{2}, \\\\\n\\text { and } \\quad \\frac{2 n-1}{n} \\leqslant \\alpha<2 .\n\\end{gathered}\n\\]\n\nThe base case is \\(n=1\\) : If \\(\\alpha<1\\), consider \\(m=\\left\\lceil\\frac{1}{\\alpha}\\right\\rceil>1\\), then\n\\[\n\\lfloor\\alpha\\rfloor+\\lfloor 2 \\alpha\\rfloor+\\cdots+\\lfloor m \\alpha\\rfloor=1\n\\]\nis not a multiple of \\(m\\), so we deduce (7). Hence, \\(\\lfloor\\alpha\\rfloor=1\\) and (6) follows.\nFor the induction step: assume the induction hypothesis to be true for \\(n\\), then by (7)\n\\[\n2 n+1-\\frac{1}{n} \\leqslant(n+1) \\alpha<2 n+2\n\\]\n\nHence,\n\\[\nn^{2}+2 n \\leqslant\\lfloor\\alpha\\rfloor+\\lfloor 2 \\alpha\\rfloor+\\cdots+\\lfloor n \\alpha\\rfloor+\\lfloor(n+1) \\alpha\\rfloor=n^{2}+\\lfloor(n+1) \\alpha\\rfloor<n^{2}+2 n+2 .\n\\]\n\nSo, necessarily \\(\\lfloor(n+1) \\alpha\\rfloor=2 n+1\\) and\n\\[\n\\lfloor\\alpha\\rfloor+\\lfloor 2 \\alpha\\rfloor+\\cdots+\\lfloor n \\alpha\\rfloor+\\lfloor(n+1) \\alpha\\rfloor=(n+1)^{2}\n\\]\nin order to obtain a multiple of \\(n+1\\). These two equalities give (6) and (7) respectively.\nFinally, we notice that condition (7) being true for all \\(n\\) gives a contradiction.\nSolution 4. As in other solutions without loss of generality we will assume that \\(0<\\alpha<2\\) and derive a contradiction. For each \\(n\\), we define\n\\[\nb_{n}=\\frac{\\lfloor\\alpha\\rfloor+\\lfloor 2 \\alpha\\rfloor+\\cdots+\\lfloor n \\alpha\\rfloor}{n},\n\\]\nwhich is a nonnegative integer by the problem condition and our assumption. Note that\n\\[\n\\lfloor(n+1) \\alpha\\rfloor \\geqslant\\lfloor\\alpha\\rfloor,\\lfloor 2 \\alpha\\rfloor, \\ldots,\\lfloor n \\alpha\\rfloor \\quad \\text { and } \\quad\\lfloor(n+1) \\alpha\\rfloor>\\lfloor\\alpha\\rfloor\n\\]\nfor all \\(n>\\frac{1}{\\alpha}\\). It follows that \\(b_{n+1}>b_{n} \\Longrightarrow b_{n+1} \\geqslant b_{n}+1\\) for \\(n>\\frac{1}{\\alpha}\\). Thus, for all such \\(n\\),\n\\[\nb_{n} \\geqslant n+C\n\\]\nwhere \\(C\\) is a fixed integer. On the other hand, the definition of \\(b_{n}\\) gives\n\\[\nb_{n}=\\frac{\\lfloor\\alpha\\rfloor+\\lfloor 2 \\alpha\\rfloor+\\cdots+\\lfloor n \\alpha\\rfloor}{n} \\leqslant \\frac{\\alpha+2 \\alpha+\\cdots+n \\alpha}{n}=\\frac{\\alpha}{2}(n+1),\n\\]\nwhich is a contradiction for sufficiently large \\(n\\).", "source_pdf": "imosl_2024.pdf", "notes": "fallback-regex"}
{"id": "IMO-2024-6", "contest": "IMO", "year": "2024", "problem_number": "A7", "problem": "Let \\(\\mathbb{Q}\\) be the set of rational numbers. Let \\(f: \\mathbb{Q} \\rightarrow \\mathbb{Q}\\) be a function such that the following property holds: for all \\(x, y \\in \\mathbb{Q}\\),\n\\[\nf(x+f(y))=f(x)+y \\quad \\text { or } \\quad f(f(x)+y)=x+f(y)\n\\]\n\nDetermine the maximum possible number of elements of \\(\\{f(x)+f(-x) \\mid x \\in \\mathbb{Q}\\}\\).\n(Japan)", "solution": "Answer: 2 is the maximum number of elements.\nCommon remarks. Suppose that \\(f\\) is a function satisfying the condition of the problem. We will use the following throughout all solutions.\n- \\(a \\sim b\\) if either \\(f(a)=b\\) or \\(f(b)=a\\),\n- \\(a \\rightarrow b\\) if \\(f(a)=b\\),\n- \\(P(x, y)\\) to denote the proposition that either \\(f(x+f(y))=f(x)+y\\) or \\(f(f(x)+y)= x+f(y)\\),\n- \\(g(x)=f(x)+f(-x)\\).\n\nWith this, the condition \\(P(x, y)\\) could be rephrased as saying that \\(x+f(y) \\sim f(x)+y\\), and we are asked to determine the maximum possible number of elements of \\(\\{g(x) \\mid x \\in \\mathbb{Q}\\}\\).\n\n1. We begin by providing an example of a function \\(f\\) for which there are two values of \\(g(x)\\). We take the function \\(f(x)=\\lfloor x\\rfloor-\\{x\\}\\), where \\(\\lfloor x\\rfloor\\) denotes the floor of \\(x\\) (that is, the largest integer less than or equal to \\(x\\) ) and \\(\\{x\\}=x-\\lfloor x\\rfloor\\) denotes the fractional part of \\(x\\).\n\nFirst, we show that \\(f\\) satisfies \\(P(x, y)\\). Given \\(x, y \\in \\mathbb{Q}\\), we have\n\\[\n\\begin{aligned}\n& f(x)+y=\\lfloor x\\rfloor-\\{x\\}+\\lfloor y\\rfloor+\\{y\\}=(\\lfloor x\\rfloor+\\lfloor y\\rfloor)+(\\{y\\}-\\{x\\}) ; \\\\\n& x+f(y)=\\lfloor x\\rfloor+\\{x\\}+\\lfloor y\\rfloor-\\{y\\}=(\\lfloor x\\rfloor+\\lfloor y\\rfloor)+(\\{x\\}-\\{y\\}) .\n\\end{aligned}\n\\]\n\nIf \\(\\{x\\}<\\{y\\}\\), then we have that the fractional part of \\(f(x)+y\\) is \\(\\{y\\}-\\{x\\}\\) and the floor is \\(\\lfloor x\\rfloor+\\lfloor y\\rfloor\\), so \\(f(x)+y \\rightarrow x+f(y)\\). Likewise, if \\(\\{x\\}>\\{y\\}\\), then \\(x+f(y) \\rightarrow f(x)+y\\). Finally, if \\(\\{x\\}=\\{y\\}\\), then \\(f(x)+y=x+f(y)=\\lfloor x\\rfloor+\\lfloor y\\rfloor\\) is an integer. In all cases, the relation \\(P\\) is satisfied.\n\nFinally, we observe that if \\(x\\) is an integer then \\(g(x)=0\\), and if \\(x\\) is not an integer then \\(g(x)=-2\\), so there are two values for \\(g(x)\\) as required.\n\nNow, we prove that there cannot be more than two values of \\(g(x) . P(x, x)\\) tells us that \\(x+f(x) \\sim x+f(x)\\), or in other words, for all \\(x\\),\n\\[\nf(x+f(x))=x+f(x)\n\\]\n\nWe begin with the following lemma.\nLemma 1. \\(f\\) is a bijection, and satisfies\n\\[\nf(-f(-x))=x .\n\\]\n\nProof. We first prove that \\(f\\) is injective. Suppose that \\(f\\left(x_{1}\\right)=f\\left(x_{2}\\right)\\); then \\(P\\left(x_{1}, x_{2}\\right)\\) tells us that \\(f\\left(x_{1}\\right)+x_{2} \\sim f\\left(x_{2}\\right)+x_{1}\\). Without loss of generality, suppose that \\(f\\left(x_{1}\\right)+x_{2} \\rightarrow f\\left(x_{2}\\right)+x_{1}\\).\n\nBut \\(f\\left(x_{1}\\right)=f\\left(x_{2}\\right)\\), so \\(f\\left(f\\left(x_{1}\\right)+x_{2}\\right)=f\\left(f\\left(x_{2}\\right)+x_{2}\\right)=f\\left(x_{2}\\right)+x_{2}\\) by (1). Therefore, \\(f\\left(x_{2}\\right)+x_{1}=f\\left(x_{2}\\right)+x_{2}\\), as required.\n\nNow, (1) with \\(x=0\\) tells us that \\(f(f(0))=f(0)\\) and so by injectivity \\(f(0)=0\\).\nApplying \\(P(x,-f(x))\\) tells us that \\(0 \\sim x+f(-f(x))\\), so either \\(0=f(0)=x+f(-f(x))\\) or \\(f(x+f(-f(x)))=0\\) which implies that \\(x+f(-f(x))=0\\) by injectivity. Either way, we deduce that \\(x=-f(-f(x))\\), or \\(x=f(-f(-x))\\) by replacing \\(x\\) with \\(-x\\).\n\nFinally, note that bijectivity follows immediately from (2).\nSince \\(f\\) is bijective, it has an inverse, which we denote \\(f^{-1}\\). Rearranging (2) (after replacing \\(x\\) with \\(-x)\\) gives that \\(f(-x)=-f^{-1}(x)\\). We have \\(g(x)=f(x)+f(-x)=f(x)-f^{-1}(x)\\).\n\nSuppose \\(g(x)=u\\) and \\(g(y)=v\\), where \\(u \\neq v\\) are both nonzero. Define \\(x^{\\prime}=f^{-1}(x)\\) and \\(y^{\\prime}=f^{-1}(y)\\); by definition, we have\n\\[\n\\begin{aligned}\n& x^{\\prime} \\rightarrow x \\rightarrow x^{\\prime}+u \\\\\n& y^{\\prime} \\rightarrow y \\rightarrow y^{\\prime}+v .\n\\end{aligned}\n\\]\n\nPutting in \\(P\\left(x^{\\prime}, y\\right)\\) gives \\(x+y \\sim x^{\\prime}+y^{\\prime}+v\\), and putting in \\(P\\left(x, y^{\\prime}\\right)\\) gives \\(x+y \\sim x^{\\prime}+y^{\\prime}+u\\). These are not equal since \\(u \\neq v\\), and \\(x+y\\) may have only one incoming and outgoing arrow because \\(f\\) is a bijection, so we must have either \\(x^{\\prime}+y^{\\prime}+u \\rightarrow x+y \\rightarrow x^{\\prime}+y^{\\prime}+v\\) or the same with the arrows reversed. Swapping \\((x, u)\\) and \\((y, v)\\) if necessary, we may assume without loss of generality that this is the correct direction for the arrows.\n\nAlso, we have \\(-x^{\\prime}-u \\rightarrow-x \\rightarrow-x^{\\prime}\\) by Lemma 1. Putting in \\(P\\left(x+y,-x^{\\prime}-u\\right)\\) gives \\(y \\sim y^{\\prime}+v-u\\), and so \\(y^{\\prime}+v-u\\) must be either \\(y^{\\prime}+v\\) or \\(y^{\\prime}\\). This means \\(u\\) must be either 0 or \\(v\\), and this contradicts our assumption about \\(u\\) and \\(v\\).\n\nComment. Lemma 1 can also be proven as follows. We start by proving that \\(f\\) must be surjective. Suppose not; then, there must be some \\(t\\) which does not appear in the output of \\(f\\). \\(P(x, t-f(x))\\) tells us that \\(t \\sim x+f(t-f(x))\\), and so by assumption \\(f(t)=x+f(t-f(x))\\) for all \\(x\\). But setting \\(x=f(t)-t\\) gives \\(t=f(t-f(f(t)-t))\\), contradicting our assumption about \\(t\\).\n\nNow, choose some \\(t\\) such that \\(f(t)=0\\); such a \\(t\\) must exist by surjectivity. \\(P(t, t)\\) tells us that \\(f(t)=t\\), or in other words \\(t=0\\) and \\(f(0)=0\\). The remainder of the proof is the same as the proof given in Solution 1.\n\nSolution 2. We again start with Lemma 1 , and note \\(f(0)=0\\) as in the proof of that lemma.\n\\(P(x,-f(y))\\) gives \\(x+f(-f(y)) \\sim f(x)-f(y)\\), and using (2) this becomes \\(x-y \\sim f(x)-f(y)\\). In other words, either \\(f(x-y)=f(x)-f(y)\\) or \\(x-y=f(f(x)-f(y))\\). In the latter case, we deduce that\n\\[\n\\begin{aligned}\nf(-(x-y)) & =f(-f(f(x)-f(y))) \\\\\nf(y-x) & =f(-f(f(x)-f(y))) \\\\\n& =f(y)-f(x)\n\\end{aligned}\n\\]\n\nThus, \\(f(y)-f(x)\\) is equal to either \\(f(y-x)\\) or \\(-f(x-y)\\). Replacing \\(y\\) with \\(x+d\\), we deduce that \\(f(x+d)-f(x) \\in\\{f(d),-f(-d)\\}\\).\n\nNow, we prove the following claim.\nClaim. For any \\(n \\in \\mathbb{Z}_{>0}\\) and \\(d \\in \\mathbb{Q}\\), we have that either \\(g(d)=0\\) or \\(g(d)= \\pm g(d / n)\\).\nIn particular, if \\(g(d / n)=0\\) then \\(g(d)=0\\).\n\nProof. We first prove that if \\(g(d / n)=0\\) then \\(g(d)=0\\). Suppose that \\(g(d / n)=0\\). Then \\(f(d / n)=-f(-d / n)\\) and so \\(f(x+d / n)-f(x)=f(d / n)\\) for any \\(x\\). Applying this repeatedly, we deduce that \\(f(x+d)-f(x)=n f(d / n)\\) for any \\(x\\). Applying this with \\(x=0\\) and \\(x=-d\\) and adding gives \\(f(d)+f(-d)=0\\), so \\(g(d)=0\\), and in particular the claim is true whenever \\(g(d)=0\\).\n\nNow, select \\(n \\in \\mathbb{Z}_{>0}\\) and \\(d \\in \\mathbb{Q}\\) such that \\(g(d) \\neq 0\\), and observe that we must have \\(g(d / n) \\neq\\) 0 . Observe that for any \\(k \\in \\mathbb{Z}\\) we have that \\(f(k d / n)-f((k-1) d / n) \\in\\{f(d / n),-f(-d / n)\\}\\). Let \\(A_{i}\\) be the number of \\(k \\in \\mathbb{Z}\\) with \\(i-n<k \\leqslant i\\) such that this difference equals \\(f(d / n)\\).\n\nWe deduce that for any \\(i \\in \\mathbb{Z}\\),\n\\[\n\\begin{aligned}\nf(i d / n)-f(i d / n-d) & =\\sum_{i-n<k \\leqslant i} f(k d / n)-f((k-1) d / n) \\\\\n& =A_{i} f(d / n)-\\left(n-A_{i}\\right) f(-d / n) \\\\\n& =-n f(-d / n)+A_{i} g(d / n)\n\\end{aligned}\n\\]\n\nSince \\(g(d / n)\\) is nonzero, this is a nonconstant linear function of \\(A_{i}\\). However, there are only two possible values for \\(f(i d / n)-f(i d / n-d)\\), so there must be at most two possible values for \\(A_{i}\\) as \\(i\\) varies. And since \\(A_{i+1}-A_{i} \\in\\{-1,0,1\\}\\), those two values must differ by 1 (if there are two values).\n\nNow, we have\n\\[\n\\begin{aligned}\nf(d)-f(0) & =-n f(-d / n)+A_{n} g(d / n), \\quad \\text { and } \\\\\nf(0)-f(-d) & =-n f(-d / n)+A_{0} g(d / n)\n\\end{aligned}\n\\]\n\nSubtracting these (using the fact that \\(f(0)=0\\) ) we obtain\n\\[\n\\begin{aligned}\nf(d)+f(-d) & =\\left(A_{n}-A_{0}\\right) g(d / n) \\\\\n& = \\pm g(d / n)\n\\end{aligned}\n\\]\nwhere the last line follows from the fact that \\(g(d)\\) is nonzero.\nIt immediately follows that there can only be one nonzero number of the form \\(g(x)\\) up to sign; to see why, if \\(g(d)\\) and \\(g\\left(d^{\\prime}\\right)\\) are both nonzero, then for some \\(n, n^{\\prime} \\in \\mathbb{Z}_{>0}\\) we have \\(d / n=d^{\\prime} / n^{\\prime}\\). But\n\\[\ng(d)= \\pm g(d / n)= \\pm g\\left(d^{\\prime}\\right)\n\\]\n\nFinally, suppose that for some \\(d, d^{\\prime}\\) we have \\(g(d)=c\\) and \\(g\\left(d^{\\prime}\\right)=-c\\) for some nonzero \\(c\\). So we have\n\\[\nf(d)+f(-d)-f\\left(d^{\\prime}\\right)-f\\left(-d^{\\prime}\\right)=2 c\n\\]\nwhich rearranges to become \\(\\left(f(d)-f\\left(d^{\\prime}\\right)\\right)-\\left(f\\left(-d^{\\prime}\\right)-f(-d)\\right)=2 c\\).\nEach of the bracketed terms must be equal to either \\(f\\left(d-d^{\\prime}\\right)\\) or \\(-f\\left(d^{\\prime}-d\\right)\\). However, they cannot be equal since \\(c\\) is nonzero, so \\(g\\left(d-d^{\\prime}\\right)=f\\left(d-d^{\\prime}\\right)+f\\left(d^{\\prime}-d\\right)= \\pm 2 c\\). This contradicts the assertion that \\(g(-x)= \\pm c\\) for all \\(x\\).\n\nSolution 3. As in Solution 1, we start by establishing Lemma 1 as above, and write \\(f^{-1}(x)= -f(-x)\\) for the inverse of \\(f\\), and \\(g(x)=f(x)-f^{-1}(x)\\).\n\nWe now prove the following.\nLemma 2. If \\(g(x) \\neq g(y)\\), then \\(g(x+y)= \\pm(g(x)-g(y))\\).\n\nProof. Assume \\(x\\) and \\(y\\) are such that \\(g(x) \\neq g(y)\\). Applying \\(P\\left(x, f^{-1}(y)\\right)\\) gives \\(x+y \\sim f(x)+f^{-1}(y)\\), and applying \\(P\\left(f^{-1}(x), y\\right)\\) gives \\(x+y \\sim f^{-1}(x)+f(y)\\).\n\nObserve that\n\\[\n\\begin{aligned}\n\\left(f(x)+f^{-1}(y)\\right)-\\left(f^{-1}(x)+f(y)\\right) & =\\left(f(x)-f^{-1}(x)\\right)-\\left(f(y)-f^{-1}(y)\\right) \\\\\n& =g(x)-g(y) .\n\\end{aligned}\n\\]\n\nBy assumption, \\(g(x) \\neq g(y)\\), and so \\(f(x)+f^{-1}(y) \\neq f^{-1}(x)+f(y)\\). Since \\(f\\) is bijective, this means that these two values must be \\(f(x+y)\\) and \\(f^{-1}(x+y)\\) in some order, and so \\(g(x+y)=f(x+y)-f^{-1}(x+y)\\) must be their difference up to sign, which is either \\(g(x)-g(y)\\) or \\(g(y)-g(x)\\).\n\nClaim. If \\(x\\) and \\(q\\) are rational numbers such that \\(g(q)=0\\) and \\(n\\) is an integer, then \\(g(x+n q)= g(x)\\).\n\nProof. If \\(g(b)=0\\) and \\(g(a) \\neq g(a+b)\\), then the lemma tells us that \\(g(b)= \\pm(g(a+b)-g(a))\\), which contradicts our assumptions. Therefore, \\(g(a)=g(a+b)\\) whenever \\(g(b)=0\\).\n\nA simple induction then gives that \\(g(n b)=0\\) for any positive integer \\(n\\), and \\(g(n b)=0\\) for negative \\(n\\) as \\(g(x)=g(-x)\\). The claim follows immediately.\n\nLemma 3. There cannot be both positive and negative elements in the range of \\(g\\).\nProof. Suppose that \\(g(x)>0\\) and \\(g(y)<0\\). Let \\(\\mathcal{S}\\) be the set of numbers of the form \\(m x+n y\\) for integers \\(m, n\\). We first show that \\(g(\\mathcal{S})\\) has infinitely many elements. Indeed, suppose \\(g(\\mathcal{S})\\) is finite, and let \\(a \\in \\mathcal{S}\\) maximise \\(g\\) and \\(b \\in \\mathcal{S}\\) maximise \\(-g\\). Then \\(a+b \\in \\mathcal{S}\\), and \\(g(a+b)=g(a)-g(b)\\) or \\(g(b)-g(a)\\). In the first case \\(g(a+b)>g(a)\\) and in the second case \\(g(a+b)<g(b)\\); in either case we get a contradiction.\n\nNow, we show that there must exist some nonzero rational number \\(q\\) with \\(g(q)=0\\). Indeed, suppose first that \\(a+f(a)=0\\) for all \\(a\\). Then \\(g(a)=f(a)+f(-a)=0\\) for all \\(a\\), and so \\(g\\) takes no nonzero value. Otherwise, there is some \\(a\\) with \\(a+f(a) \\neq 0\\), and so (1) yields that \\(f(q)=0\\) for \\(q=a+f(a) \\neq 0\\). Noting that \\(f(-q)=0\\) from Lemma 1 tells us that \\(g(q)=0\\), as required.\n\nNow, there must exist integers \\(s\\) and \\(s^{\\prime}\\) such that \\(x s=q s^{\\prime}\\) and integers \\(t\\) and \\(t^{\\prime}\\) such that \\(y t=q t^{\\prime}\\). The claim above gives that the value of \\(g(m x+n y)\\) depends only on the values of \\(m \\bmod s\\) and \\(n \\bmod t\\), so \\(g(m x+n y)\\) can only take finitely many values.\n\nFinally, suppose that \\(g(x)=u\\) and \\(g(y)=v\\) where \\(u \\neq v\\) have the same sign. Assume \\(u, v>0\\) (the other case is similar) and assume \\(u>v\\) without loss of generality.\n\\(P\\left(f^{-1}(x), f^{-1}(y)\\right)\\) gives \\(x-y \\sim f^{-1}(x)-f^{-1}(y)=f(x)-f(y)-(u-v)\\), and \\(P(x, y)\\) gives \\(x-y \\sim f(x)-f(y) . u-v\\) is nonzero, so \\(f(x-y)\\) and \\(f^{-1}(x-y)\\) must be \\(f(x)-f(y)-(u-v)\\) and \\(f(x)-f(y)\\) in some order, and since \\(g(x-y)\\) must be nonnegative, we have\n\\[\nf(x)-f(y)-(u-v) \\rightarrow x-y \\rightarrow f(x)-f(y) .\n\\]\n\nThen, \\(P\\left(x-y, f^{-1}(y)\\right)\\) tells us that \\((x-y)+y \\sim(f(x)-f(y))+(f(y)-v)\\), so \\(x \\sim f(x)-v\\), contradicting either \\(v \\neq u\\) or \\(v>0\\).\n\nComment. Lemma 2 also follows from \\(f(x+d)-f(x) \\in\\{f(d),-f(-d)\\}\\) as proven in Solution 2. Indeed, we also have \\(f(-x)-f(-x-d) \\in\\{f(d),-f(-d)\\}\\), and then subtracting the second from the first we get \\(g(x+d)-g(x) \\in\\{g(d),-g(d), 0\\}\\). Replacing \\(x+d\\) and \\(x\\) with \\(x\\) and \\(-y\\) gives the statement of Lemma 2.\n\nComment. It is possible to prove using Lemma 2 that \\(g\\) must have image of the form \\(\\{0, c, 2 c\\}\\) if it has size greater than 2 . Indeed, if \\(g(x)=c\\) and \\(g(y)=d\\) with \\(0<c<d\\), then \\(g(x+y)=d-c\\) as it must be nonnegative, and \\(g(y)=g((x+y)+(-x))=|d-2 c|\\) provided that \\(d \\neq 2 c\\).\n\nHowever, it is not possible to rule out \\(\\{0, c, 2 c\\}\\) based entirely on the conclusion of Lemma 2; indeed, the function given by\n\\[\ng(x)= \\begin{cases}0, & \\text { if } x=2 n \\text { for } n \\in \\mathbb{Z} \\\\ 2, & \\text { if } x=2 n+1 \\text { for } n \\in \\mathbb{Z} \\\\ 1, & \\text { if } x \\notin \\mathbb{Z}\\end{cases}\n\\]\nsatisfies the conclusion of Lemma 2 (even though there is no function \\(f\\) giving this choice of \\(g\\) ).\nNote. Solution 1 actually implies that the result also holds over \\(\\mathbb{R}\\). The proposal was originally submitted and evaluated over \\(\\mathbb{Q}\\) as it is presented here, and the Problem Selection Committee believes that this form is more suitable for the competition because it allows for more varied and interesting approaches once Lemma 1 has been established. Even the variant here defined over \\(\\mathbb{Q}\\) was found to be fairly challenging.", "source_pdf": "imosl_2024.pdf", "notes": "fallback-regex"}
{"id": "IMO-2024-5", "contest": "IMO", "year": "2024", "problem_number": "C4", "problem": "On a board with 2024 rows and 2023 columns, Turbo the snail tries to move from the first row to the last row. On each attempt, he chooses to start on any cell in the first row, then moves one step at a time to an adjacent cell sharing a common side. He wins if he reaches any cell in the last row. However, there are 2022 predetermined, hidden monsters in 2022 of the cells, one in each row except the first and last rows, such that no two monsters share the same column. If Turbo unfortunately reaches a cell with a monster, his attempt ends and he is transported back to the first row to start a new attempt. The monsters do not move.\n\nSuppose Turbo is allowed to take \\(n\\) attempts. Determine the minimum value of \\(n\\) for which he has a strategy that guarantees reaching the last row, regardless of the locations of the monsters.\n(Hong Kong)\n\nComment. One of the main difficulties of solving this question is in determining the correct expression for \\(n\\). Students may spend a long time attempting to prove bounds for the wrong value for \\(n\\) before finding better strategies.\n\nStudents may incorrectly assume that Turbo is not allowed to backtrack to squares he has already visited within a single attempt. Fortunately, making this assumption does not change the", "solution": "answer to the problem, though it may make it slightly harder to find a winning strategy.\n\nAnswer: The answer is \\(n=3\\).\n\n. First we demonstrate that there is no winning strategy if Turbo has 2 attempts.\nSuppose that \\((2, i)\\) is the first cell in the second row that Turbo reaches on his first attempt. There can be a monster in this cell, in which case Turbo must return to the first row immediately, and he cannot have reached any other cells past the first row.\n\nNext, suppose that \\((3, j)\\) is the first cell in the third row that Turbo reaches on his second attempt. Turbo must have moved to this cell from \\((2, j)\\), so we know \\(j \\neq i\\). So it is possible that there is a monster on \\((3, j)\\), in which case Turbo also fails on his second attempt. Therefore Turbo cannot guarantee to reach the last row in 2 attempts.\n\nNext, we exhibit a strategy for \\(n=3\\). On the first attempt, Turbo travels along the path\n\\[\n(1,1) \\rightarrow(2,1) \\rightarrow(2,2) \\rightarrow \\cdots \\rightarrow(2,2023) .\n\\]\n\nThis path meets every cell in the second row, so Turbo will find the monster in row 2 and his attempt will end.\n\nIf the monster in the second row is not on the edge of the board (that is, it is in cell \\((2, i)\\) with \\(2 \\leqslant i \\leqslant 2022\\) ), then Turbo takes the following two paths in his second and third attempts:\n\\[\n\\begin{aligned}\n& (1, i-1) \\rightarrow(2, i-1) \\rightarrow(3, i-1) \\rightarrow(3, i) \\rightarrow(4, i) \\rightarrow \\cdots \\rightarrow(2024, i) . \\\\\n& (1, i+1) \\rightarrow(2, i+1) \\rightarrow(3, i+1) \\rightarrow(3, i) \\rightarrow(4, i) \\rightarrow \\cdots \\rightarrow(2024, i) .\n\\end{aligned}\n\\]\n\nThe only cells that may contain monsters in either of these paths are ( \\(3, i-1\\) ) and ( \\(3, i+1\\) ). At most one of these can contain a monster, so at least one of the two paths will be successful.\n\n\\begin{figure}\n\\includegraphics[width=\\textwidth]{https://cdn.mathpix.com/cropped/2025_08_23_9a42685711bc262db31dg-046.jpg?height=703&width=1423&top_left_y=237&top_left_x=322}\n\\captionsetup{labelformat=empty}\n\\caption{Figure 1: Turbo's first attempt, and his second and third attempts in the case where the monster on the second row is not on the edge. The cross indicates the location of a monster, and the shaded cells are cells guaranteed to not contain a monster.}\n\\end{figure}\n\nIf the monster in the second row is on the edge of the board, without loss of generality we may assume it is in \\((2,1)\\). Then, on the second attempt, Turbo takes the following path:\n\\[\n(1,2) \\rightarrow(2,2) \\rightarrow(2,3) \\rightarrow(3,3) \\rightarrow \\cdots \\rightarrow(2022,2023) \\rightarrow(2023,2023) \\rightarrow(2024,2023) .\n\\]\n\n\\begin{figure}\n\\includegraphics[width=\\textwidth]{https://cdn.mathpix.com/cropped/2025_08_23_9a42685711bc262db31dg-046.jpg?height=709&width=1429&top_left_y=1479&top_left_x=319}\n\\captionsetup{labelformat=empty}\n\\caption{Figure 2: Turbo's second and third attempts in the case where the monster on the second row is on the edge. The light gray cells on the right diagram indicate cells that were visited on the previous attempt. Note that not all safe cells have been shaded.}\n\\end{figure}\n\nIf there are no monsters on this path, then Turbo wins. Otherwise, let \\((i, j)\\) be the first cell on which Turbo encounters a monster. We have that \\(j=i\\) or \\(j=i+1\\). Then, on the third attempt, Turbo takes the following path:\n\\[\n\\begin{aligned}\n(1,2) & \\rightarrow(2,2) \\rightarrow(2,3) \\rightarrow(3,3) \\rightarrow \\cdots \\rightarrow(i-2, i-1) \\rightarrow(i-1, i-1) \\\\\n& \\rightarrow(i, i-1) \\rightarrow(i, i-2) \\rightarrow \\cdots \\rightarrow(i, 2) \\rightarrow(i, 1) \\\\\n& \\rightarrow(i+1,1) \\rightarrow \\cdots \\rightarrow(2023,1) \\rightarrow(2024,1) .\n\\end{aligned}\n\\]\n\n\\section*{Now note that}\n- The cells from \\((1,2)\\) to \\((i-1, i-1)\\) do not contain monsters because they were reached earlier than \\((i, j)\\) on the previous attempt.\n- The cells \\((i, k)\\) for \\(1 \\leqslant k \\leqslant i-1\\) do not contain monsters because there is only one monster in row \\(i\\), and it lies in \\((i, i)\\) or \\((i, i+1)\\).\n- The cells \\((k, 1)\\) for \\(i \\leqslant k \\leqslant 2024\\) do not contain monsters because there is at most one monster in column 1 , and it lies in \\((2,1)\\).\n\nTherefore Turbo will win on the third attempt.\nComment. A small variation on Turbo's strategy when the monster on the second row is on the edge is possible. On the second attempt, Turbo can instead take the path\n\\[\n\\begin{aligned}\n(1,2023) & \\rightarrow(2,2023) \\rightarrow(2,2022) \\rightarrow \\cdots \\rightarrow(2,3) \\rightarrow(2,2) \\rightarrow(2,3) \\rightarrow \\cdots \\rightarrow(2,2023) \\\\\n& \\rightarrow(3,2023) \\rightarrow(3,2022) \\rightarrow \\cdots \\rightarrow(3,4) \\rightarrow(3,3) \\rightarrow(3,4) \\rightarrow \\cdots \\rightarrow(3,2023) \\\\\n& \\rightarrow \\cdots \\\\\n& \\rightarrow(2022,2023) \\rightarrow(2022,2022) \\rightarrow(2022,2023) \\\\\n& \\rightarrow(2023,2023) \\\\\n& \\rightarrow(2024,2023) .\n\\end{aligned}\n\\]\n\nIf there is a monster on this path, say in cell \\((i, j)\\), then on the third attempt Turbo can travel straight down to the cell just left of the monster instead of following the path traced out in the second attempt.\n\\[\n\\begin{aligned}\n(1, j-1) & \\rightarrow(2, j-1) \\rightarrow \\cdots \\rightarrow(i-1, j-1) \\rightarrow(i, j-1) \\\\\n& \\rightarrow(i, j-2) \\rightarrow \\cdots \\rightarrow(i, 2) \\rightarrow(i, 1) \\\\\n& \\rightarrow(i+1,1) \\rightarrow \\cdots \\rightarrow(2023,1) \\rightarrow(2024,1) .\n\\end{aligned}\n\\]\n\n\\begin{figure}\n\\includegraphics[width=\\textwidth]{https://cdn.mathpix.com/cropped/2025_08_23_9a42685711bc262db31dg-047.jpg?height=709&width=1432&top_left_y=1707&top_left_x=319}\n\\captionsetup{labelformat=empty}\n\\caption{Figure 3: Alternative strategy for Turbo's second and third attempts.}\n\\end{figure}", "source_pdf": "imosl_2024.pdf", "notes": "fallback-regex"}
{"id": "IMO-2024-3", "contest": "IMO", "year": "2024", "problem_number": "C7", "problem": "Let \\(N\\) be a positive integer and let \\(a_{1}, a_{2}, \\ldots\\) be an infinite sequence of positive integers. Suppose that, for each \\(n>N, a_{n}\\) is equal to the number of times \\(a_{n-1}\\) appears in the list \\(a_{1}, a_{2}, \\ldots, a_{n-1}\\).\n\nProve that at least one of the sequences \\(a_{1}, a_{3}, a_{5}, \\ldots\\) and \\(a_{2}, a_{4}, a_{6}, \\ldots\\) is eventually periodic.\n(Australia)", "solution": "1. Let \\(M>\\max \\left(a_{1}, \\ldots, a_{N}\\right)\\). We first prove that some integer appears infinitely many times. If not, then the sequence contains arbitrarily large integers. The first time each integer larger than \\(M\\) appears, it is followed by a 1 . So 1 appears infinitely many times, which is a contradiction.\n\nNow we prove that every integer \\(x \\geqslant M\\) appears at most \\(M-1\\) times. If not, consider the first time that any \\(x \\geqslant M\\) appears for the \\(M^{\\text {th }}\\) time. Up to this point, each appearance of \\(x\\) is preceded by an integer which has appeared \\(x \\geqslant M\\) times. So there must have been at least \\(M\\) numbers that have already appeared at least \\(M\\) times before \\(x\\) does, which is a contradiction.\n\nThus there are only finitely many numbers that appear infinitely many times. Let the largest of these be \\(k\\). Since \\(k\\) appears infinitely many times there must be infinitely many integers greater than \\(M\\) which appear at least \\(k\\) times in the sequence, so each integer \\(1,2, \\ldots, k-1\\) also appears infinitely many times. Since \\(k+1\\) doesn't appear infinitely often there must only be finitely many numbers which appear more than \\(k\\) times. Let the largest such number be \\(l \\geqslant k\\). From here on we call an integer \\(x\\) big if \\(x>l\\), medium if \\(l \\geqslant x>k\\) and small if \\(x \\leqslant k\\). To summarise, each small number appears infinitely many times in the sequence, while each big number appears at most \\(k\\) times in the sequence.\n\nChoose a large enough \\(N^{\\prime}>N\\) such that \\(a_{N^{\\prime}}\\) is small, and in \\(a_{1}, \\ldots, a_{N^{\\prime}}\\) :\n- every medium number has already made all of its appearances;\n- every small number has made more than \\(\\max (k, N)\\) appearances.\n\nSince every small number has appeared more than \\(k\\) times, past this point each small number must be followed by a big number. Also, by definition each big number appears at most \\(k\\) times, so it must be followed by a small number. Hence the sequence alternates between big and small numbers after \\(a_{N^{\\prime}}\\).\nLemma 1. Let \\(g\\) be a big number that appears after \\(a_{N^{\\prime}}\\). If \\(g\\) is followed by the small number \\(h\\), then \\(h\\) equals the amount of small numbers which have appeared at least \\(g\\) times before that point.\nProof. By the definition of \\(N^{\\prime}\\), the small number immediately preceding \\(g\\) has appeared more than \\(\\max (k, N)\\) times, so \\(g>\\max (k, N)\\). And since \\(g>N\\), the \\(g^{\\text {th }}\\) appearance of every small number must occur after \\(a_{N}\\) and hence is followed by \\(g\\). Since there are \\(k\\) small numbers and \\(g\\) appears at most \\(k\\) times, \\(g\\) must appear exactly \\(k\\) times, always following a small number after \\(a_{N}\\). Hence on the \\(h^{\\text {th }}\\) appearance of \\(g\\), exactly \\(h\\) small numbers have appeared at least \\(g\\) times before that point.\n\nDenote by \\(a_{[i, j]}\\) the subsequence \\(a_{i}, a_{i+1}, \\ldots, a_{j}\\).\nLemma 2. Suppose that \\(i\\) and \\(j\\) satisfy the following conditions:\n(a) \\(j>i>N^{\\prime}+2\\),\n(b) \\(a_{i}\\) is small and \\(a_{i}=a_{j}\\),\n(c) no small value appears more than once in \\(a_{[i, j-1]}\\).\n\nThen \\(a_{i-2}\\) is equal to some small number in \\(a_{[i, j-1]}\\).\n\nProof. Let \\(\\mathcal{I}\\) be the set of small numbers that appear at least \\(a_{i-1}\\) times in \\(a_{[1, i-1]}\\). By Lemma 1, \\(a_{i}=|\\mathcal{I}|\\). Similarly, let \\(\\mathcal{J}\\) be the set of small numbers that appear at least \\(a_{j-1}\\) times in \\(a_{[1, j-1]}\\). Then by Lemma \\(1, a_{j}=|\\mathcal{J}|\\) and hence by (b), \\(|\\mathcal{I}|=|\\mathcal{J}|\\). Also by definition, \\(a_{i-2} \\in \\mathcal{I}\\) and \\(a_{j-2} \\in \\mathcal{J}\\).\n\nSuppose the small number \\(a_{j-2}\\) is not in \\(\\mathcal{I}\\). This means \\(a_{j-2}\\) has appeared less than \\(a_{i-1}\\) times in \\(a_{[1, i-1]}\\). By (c), \\(a_{j-2}\\) has appeared at most \\(a_{i-1}\\) times in \\(a_{[1, j-1]}\\), hence \\(a_{j-1} \\leqslant a_{i-1}\\). Combining with \\(a_{[1, i-1]} \\subset a_{[1, j-1]}\\), this implies \\(\\mathcal{I} \\subseteq \\mathcal{J}\\). But since \\(a_{j-2} \\in \\mathcal{J} \\backslash \\mathcal{I}\\), this contradicts \\(|\\mathcal{I}|=|\\mathcal{J}|\\). So \\(a_{j-2} \\in \\mathcal{I}\\), which means it has appeared at least \\(a_{i-1}\\) times in \\(a_{[1, i-1]}\\) and one more time in \\(a_{[i, j-1]}\\). Therefore \\(a_{j-1}>a_{i-1}\\).\n\nBy (c), any small number appearing at least \\(a_{j-1}\\) times in \\(a_{[1, j-1]}\\) has also appeared \\(a_{j-1}-1 \\geqslant a_{i-1}\\) times in \\(a_{[1, i-1]}\\). So \\(\\mathcal{J} \\subseteq \\mathcal{I}\\) and hence \\(\\mathcal{I}=\\mathcal{J}\\). Therefore, \\(a_{i-2} \\in \\mathcal{J}\\), so it must appear at least \\(a_{j-1}-a_{i-1}=1\\) more time in \\(a_{[i, j-1]}\\).\n\nFor each small number \\(a_{n}\\) with \\(n>N^{\\prime}+2\\), let \\(p_{n}\\) be the smallest number such that \\(a_{n+p_{n}}=a_{i}\\) is also small for some \\(i\\) with \\(n \\leqslant i<n+p_{n}\\). In other words, \\(a_{n+p_{n}}=a_{i}\\) is the first small number to occur twice after \\(a_{n-1}\\). If \\(i>n\\), Lemma 2 (with \\(j=n+p_{n}\\) ) implies that \\(a_{i-2}\\) appears again before \\(a_{n+p_{n}}\\), contradicting the minimality of \\(p_{n}\\). So \\(i=n\\). Lemma 2 also implies that \\(p_{n} \\geqslant p_{n-2}\\). So \\(p_{n}, p_{n+2}, p_{n+4}, \\ldots\\) is a nondecreasing sequence bounded above by \\(2 k\\) (as there are only \\(k\\) small numbers). Therefore, \\(p_{n}, p_{n+2}, p_{n+4}, \\ldots\\) is eventually constant and the subsequence of small numbers is eventually periodic with period at most \\(k\\).\n\nNote. Since every small number appears infinitely often, Solution 1 additionally proves that the sequence of small numbers has period \\(k\\). The repeating part of the sequence of small numbers is thus a permutation of the integers from 1 to \\(k\\). It can be shown that every permutation of the integers from 1 to \\(k\\) is attainable in this way.\n\nSolution 2. We follow Solution 1 until after Lemma 1. For each \\(n>N^{\\prime}\\) we keep track of how many times each of \\(1,2, \\ldots, k\\) has appeared in \\(a_{1}, \\ldots, a_{n}\\). We will record this information in an updating ( \\(k+1\\) )-tuple\n\\[\n\\left(b_{1}, b_{2}, \\ldots, b_{k} ; j\\right)\n\\]\nwhere each \\(b_{i}\\) records the number of times \\(i\\) has appeared. The final element \\(j\\) of the \\((k+1)\\) tuple, also called the active element, represents the latest small number that has appeared in \\(a_{1}, \\ldots, a_{n}\\).\n\nAs \\(n\\) increases, the value of ( \\(b_{1}, b_{2}, \\ldots, b_{k} ; j\\) ) is updated whenever \\(a_{n}\\) is small. The ( \\(k+1\\) )tuple updates deterministically based on its previous value. In particular, when \\(a_{n}=j\\) is small, the active element is updated to \\(j\\) and we increment \\(b_{j}\\) by 1 . The next big number is \\(a_{n+1}=b_{j}\\). By Lemma 1, the next value of the active element, or the next small number \\(a_{n+2}\\), is given by the number of \\(b\\) terms greater than or equal to the newly updated \\(b_{j}\\), or\n\\[\n\\left|\\left\\{i \\mid 1 \\leqslant i \\leqslant k, b_{i} \\geqslant b_{j}\\right\\}\\right| .\n\\]\n\nEach sufficiently large integer which appears \\(i+1\\) times must also appear \\(i\\) times, with both of these appearances occurring after the initial block of \\(N\\). So there exists a global constant \\(C\\) such that \\(b_{i+1}-b_{i} \\leqslant C\\). Suppose that for some \\(r, b_{r+1}-b_{r}\\) is unbounded from below. Since the value of \\(b_{r+1}-b_{r}\\) changes by at most 1 when it is updated, there must be some update where \\(b_{r+1}-b_{r}\\) decreases and \\(b_{r+1}-b_{r}<-(k-1) C\\). Combining with the fact that \\(b_{i}-b_{i-1} \\leqslant C\\) for all \\(i\\), we see that at this particular point, by the triangle inequality\n\\[\n\\min \\left(b_{1}, \\ldots, b_{r}\\right)>\\max \\left(b_{r+1}, \\ldots, b_{k}\\right)\n\\]\n\nSince \\(b_{r+1}-b_{r}\\) just decreased, the new active element is \\(r\\). From this point on, if the new active element is at most \\(r\\), by (1) and (2), the next element to increase is once again from \\(b_{1}, \\ldots, b_{r}\\). Thus only \\(b_{1}, \\ldots, b_{r}\\) will increase from this point onwards, and \\(b_{k}\\) will no longer increase, contradicting the fact that \\(k\\) must appear infinitely often in the sequence. Therefore \\(\\left|b_{r+1}-b_{r}\\right|\\) is bounded.\n\nSince \\(\\left|b_{r+1}-b_{r}\\right|\\) is bounded, it follows that each of \\(\\left|b_{i}-b_{1}\\right|\\) is bounded for \\(i=1, \\ldots, k\\). This means that there are only finitely many different states for ( \\(b_{1}-b_{1}, b_{2}-b_{1}, \\ldots, b_{k}-b_{1} ; j\\) ). Since the next active element is completely determined by the relative sizes of \\(b_{1}, b_{2}, \\ldots, b_{k}\\) to each other, and the update of \\(b\\) terms depends on the active element, the active element must be eventually periodic. Therefore the small numbers subsequence, which is either \\(a_{1}, a_{3}, a_{5}, \\ldots\\) or \\(a_{2}, a_{4}, a_{6}, \\ldots\\), must be eventually periodic.", "source_pdf": "imosl_2024.pdf", "notes": "fallback-regex"}
{"id": "IMO-2024-4", "contest": "IMO", "year": "2024", "problem_number": "G2", "problem": "Let \\(A B C\\) be a triangle with \\(A B<A C<B C\\), incentre \\(I\\) and incircle \\(\\omega\\). Let \\(X\\) be the point in the interior of side \\(B C\\) such that the line through \\(X\\) parallel to \\(A C\\) is tangent to \\(\\omega\\). Similarly, let \\(Y\\) be the point in the interior of side \\(B C\\) such that the line through \\(Y\\) parallel to \\(A B\\) is tangent to \\(\\omega\\). Let \\(A I\\) intersect the circumcircle of triangle \\(A B C\\) again at \\(P \\neq A\\). Let \\(K\\) and \\(L\\) be the midpoints of \\(A B\\) and \\(A C\\), respectively.\n\nProve that \\(\\angle K I L+\\angle Y P X=180^{\\circ}\\).\n(Poland)", "solution": "1. Let \\(A^{\\prime}\\) be the reflection of \\(A\\) in \\(I\\), then \\(A^{\\prime}\\) lies on the angle bisector \\(A P\\). Lines \\(A^{\\prime} X\\) and \\(A^{\\prime} Y\\) are the reflections of \\(A C\\) and \\(A B\\) in \\(I\\), respectively, and so they are the tangents to \\(\\omega\\) from \\(X\\) and \\(Y\\). As is well-known, \\(P B=P C=P I\\), and since \\(\\angle B A P=\\angle P A C>30^{\\circ}\\), \\(P B=P C\\) is greater than the circumradius. Hence \\(P I>\\frac{1}{2} A P>A I\\); we conclude that \\(A^{\\prime}\\) lies in the interior of segment \\(A P\\).\n![](https://cdn.mathpix.com/cropped/2025_08_23_9a42685711bc262db31dg-067.jpg?height=1072&width=1003&top_left_y=990&top_left_x=531)\n\nWe have \\(\\angle A P B=\\angle A C B\\) in the circumcircle and \\(\\angle A C B=\\angle A^{\\prime} X C\\) because \\(A^{\\prime} X \\| A C\\). Hence, \\(\\angle A P B=\\angle A^{\\prime} X C\\), and so quadrilateral \\(B P A^{\\prime} X\\) is cyclic. Similarly, it follows that \\(C Y A^{\\prime} P\\) is cyclic.\n\nNow we are ready to transform \\(\\angle K I L+\\angle Y P X\\) to the sum of angles in triangle \\(A^{\\prime} C B\\). By a homothety of factor 2 at \\(A\\) we have \\(\\angle K I L=\\angle C A^{\\prime} B\\). In circles \\(B P A^{\\prime} X\\) and \\(C Y A^{\\prime} P\\) we have \\(\\angle A P X=\\angle A^{\\prime} B C\\) and \\(\\angle Y P A=\\angle B C A^{\\prime}\\), therefore\n\\[\n\\angle K I L+\\angle Y P X=\\angle C A^{\\prime} B+(\\angle Y P A+\\angle A P X)=\\angle C A^{\\prime} B+\\angle B C A^{\\prime}+\\angle A^{\\prime} B C=180^{\\circ} .\n\\]\n\nComment. The constraint \\(A B<A C<B C\\) was added by the Problem Selection Committee in order to reduce case-sensitivity. Without that, there would be two more possible configurations according to the possible orders of points \\(A, P\\) and \\(A^{\\prime}\\), as shown in the pictures below. The solution for these cases is broadly the same, but some extra care is required in the degenerate case when \\(A^{\\prime}\\) coincides with \\(P\\) and line \\(A P\\) is a common tangent to circles \\(B P X\\) and \\(C P Y\\).\n![](https://cdn.mathpix.com/cropped/2025_08_23_9a42685711bc262db31dg-068.jpg?height=987&width=1564&top_left_y=515&top_left_x=251)\n\nSolution 2. Let \\(B C=a, A C=b, A B=c\\) and \\(s=\\frac{a+b+c}{2}\\), and let the radii of the incircle, \\(B\\)-excircle and \\(C\\)-excircle be \\(r, r_{b}\\) and \\(r_{c}\\), respectively. Let the incircle be tangent to \\(A C\\) and \\(A B\\) at \\(B_{0}\\) and \\(C_{0}\\), respectively; let the \\(B\\)-excircle be tangent to \\(A C\\) at \\(B_{1}\\), and let the \\(C\\)-excircle be tangent to \\(A B\\) at \\(C_{1}\\). As is well-known, \\(A B_{1}=s-c\\) and area \\((\\triangle A B C)=r s=r_{c}(s-c)\\).\n\nLet the line through \\(X\\), parallel to \\(A C\\) be tangent to the incircle at \\(E\\), and the line through \\(Y\\), parallel to \\(A B\\) be tangent to the incircle at \\(D\\). Finally, let \\(A P\\) meet \\(B B_{1}\\) at \\(F\\).\n![](https://cdn.mathpix.com/cropped/2025_08_23_9a42685711bc262db31dg-069.jpg?height=915&width=1566&top_left_y=582&top_left_x=251)\n\nIt is well-known that points \\(B, E\\), and \\(B_{1}\\) are collinear by the homothety between the incircle and the \\(B\\)-excircle, and \\(B E \\| I K\\) because \\(I K\\) is a midline in triangle \\(B_{0} E B_{1}\\). Similarly, it follows that \\(C, D\\), and \\(C_{1}\\) are collinear and \\(C D \\| I L\\). Hence, the problem reduces to proving \\(\\angle Y P A=\\angle C B E\\) (and its symmetric counterpart \\(\\angle A P X=\\angle D C B\\) with respect to the vertex \\(C\\) ), so it suffices to prove that \\(F Y P B\\) is cyclic. Since \\(A C P B\\) is cyclic, that is equivalent to \\(F Y \\| B_{1} C\\) and \\(\\frac{B F}{F B_{1}}=\\frac{B Y}{Y C}\\).\n\nBy the angle bisector theorem we have\n\\[\n\\frac{B F}{F B_{1}}=\\frac{A B}{A B_{1}}=\\frac{c}{s-c} .\n\\]\n\nThe homothety at \\(C\\) that maps the incircle to the \\(C\\)-excircle sends \\(Y\\) to \\(B\\), so\n\\[\n\\frac{B C}{Y C}=\\frac{r_{c}}{r}=\\frac{s}{s-c} .\n\\]\n\nSo,\n\\[\n\\frac{B Y}{Y C}=\\frac{B C}{Y C}-1=\\frac{s}{s-c}-1=\\frac{c}{s-c}=\\frac{B F}{F B_{1}},\n\\]\nwhich completes the solution.", "source_pdf": "imosl_2024.pdf", "notes": "fallback-regex"}
{"id": "IMO-2024-2", "contest": "IMO", "year": "2024", "problem_number": "N4", "problem": "Determine all positive integers \\(a\\) and \\(b\\) such that there exists a positive integer \\(g\\) such that \\(\\operatorname{gcd}\\left(a^{n}+b, b^{n}+a\\right)=g\\) for all sufficiently large \\(n\\).\n(Indonesia)", "solution": "Answer: The only\n\nis \\((a, b)=(1,1)\\).\nSolution 1. It is clear that we may take \\(g=2\\) for \\((a, b)=(1,1)\\). Supposing that \\((a, b)\\) satisfies the conditions in the problem, let \\(N\\) be a positive integer such that \\(\\operatorname{gcd}\\left(a^{n}+b, b^{n}+a\\right)=g\\) for all \\(n \\geqslant N\\).\nLemma. We have that \\(g=\\operatorname{gcd}(a, b)\\) or \\(g=2 \\operatorname{gcd}(a, b)\\).\nProof. Note that both \\(a^{N}+b\\) and \\(a^{N+1}+b\\) are divisible by \\(g\\). Hence\n\\[\na\\left(a^{N}+b\\right)-\\left(a^{N+1}+b\\right)=a b-b=a(b-1)\n\\]\nis divisible by \\(g\\). Analogously, \\(b(a-1)\\) is divisible by \\(g\\). Their difference \\(a-b\\) is then divisible by \\(g\\), so \\(g\\) also divides \\(a(b-1)+a(a-b)=a^{2}-a\\). All powers of \\(a\\) are then congruent modulo \\(g\\), so \\(a+b \\equiv a^{N}+b \\equiv 0(\\bmod g)\\). Then \\(2 a=(a+b)+(a-b)\\) and \\(2 b=(a+b)-(a-b)\\) are both divisible by \\(g\\), so \\(g \\mid 2 \\operatorname{gcd}(a, b)\\). On the other hand, it is clear that \\(\\operatorname{gcd}(a, b) \\mid g\\), thus proving the Lemma.\n\nLet \\(d=\\operatorname{gcd}(a, b)\\), and write \\(a=d x\\) and \\(b=d y\\) for coprime positive integers \\(x\\) and \\(y\\). We have that\n\\[\n\\operatorname{gcd}\\left((d x)^{n}+d y,(d y)^{n}+d x\\right)=d \\operatorname{gcd}\\left(d^{n-1} x^{n}+y, d^{n-1} y^{n}+x\\right),\n\\]\nso the Lemma tells us that\n\\[\n\\operatorname{gcd}\\left(d^{n-1} x^{n}+y, d^{n-1} y^{n}+x\\right) \\leqslant 2\n\\]\nfor all \\(n \\geqslant N\\). Defining \\(K=d^{2} x y+1\\), note that \\(K\\) is coprime to each of \\(d, x\\), and \\(y\\). By Euler's theorem, for \\(n \\equiv-1(\\bmod \\varphi(K))\\) we have that\n\\[\nd^{n-1} x^{n}+y \\equiv d^{-2} x^{-1}+y \\equiv d^{-2} x^{-1}\\left(1+d^{2} x y\\right) \\equiv 0 \\quad(\\bmod K)\n\\]\nso \\(K \\mid d^{n-1} x^{n}+y\\). Analogously, we have that \\(K \\mid d^{n-1} y^{n}+x\\). Taking such an \\(n\\) which also satisfies \\(n \\geqslant N\\) gives us that\n\\[\nK \\mid \\operatorname{gcd}\\left(d^{n-1} x^{n}+y, d^{n-1} y^{n}+x\\right) \\leqslant 2 .\n\\]\n\nThis is only possible when \\(d=x=y=1\\), which yields the only solution \\((a, b)=(1,1)\\).\nSolution 2. After proving the Lemma, one can finish the solution as follows.\nFor any prime factor \\(p\\) of \\(a b+1, p\\) is coprime to \\(a\\) and \\(b\\). Take an \\(n \\geqslant N\\) such that \\(n \\equiv-1 (\\bmod p-1)\\). By Fermat's little theorem, we have that\n\\[\n\\begin{aligned}\n& a^{n}+b \\equiv a^{-1}+b=a^{-1}(1+a b) \\equiv 0 \\quad(\\bmod p) \\\\\n& b^{n}+a \\equiv b^{-1}+a=b^{-1}(1+a b) \\equiv 0 \\quad(\\bmod p)\n\\end{aligned}\n\\]\nthen \\(p\\) divides \\(g\\). By the Lemma, we have that \\(p \\mid 2 \\operatorname{gcd}(a, b)\\), and thus \\(p=2\\). Therefore, \\(a b+1\\) is a power of 2 , and \\(a\\) and \\(b\\) are both odd numbers.\n\nIf \\((a, b) \\neq(1,1)\\), then \\(a b+1\\) is divisible by 4 , hence \\(\\{a, b\\}=\\{-1,1\\}(\\bmod 4)\\). For odd \\(n \\geqslant N\\), we have that\n\\[\na^{n}+b \\equiv b^{n}+a \\equiv(-1)+1=0 \\quad(\\bmod 4)\n\\]\nthen \\(4 \\mid g\\). But by the Lemma, we have that \\(\\nu_{2}(g) \\leqslant \\nu_{2}(2 \\operatorname{gcd}(a, b))=1\\), which is a contradiction. So the only solution to the problem is \\((a, b)=(1,1)\\).", "source_pdf": "imosl_2024.pdf", "notes": "fallback-regex"}
{"id": "PUTNAM-2022-A1", "contest": "PUTNAM", "year": "2022", "problem_number": "A1", "problem": "Determine all ordered pairs of real numbers $(a,b)$ such that the line $y = ax+b$ intersects the curve $y = \\ln(1+x^2)$ in exactly one point.", "solution": "Write $f(x) = \\ln(1+x^2)$.\nWe show that $y=ax+b$ intersects $y=f(x)$ in exactly one point if and only if $(a,b)$ lies in one of the following groups:\n\\begin{itemize}\n\\item\n$a=b=0$\n\\item\n$|a| \\geq 1$, arbitrary $b$\n\\item\n$0 < |a| < 1$, and $b<\\ln(1-r_-)^2-|a|r_-$ or $b>\\ln(1-r_+)^2-|a|r_+$, where \n\\[\nr_\\pm = \\frac{1\\pm\\sqrt{1-a^2}}{a}.\n\\]\n\\end{itemize}\n\n Since the graph of $y=f(x)$ is symmetric under reflection in the $y$-axis, it suffices to consider the case $a \\geq 0$: $y=ax+b$ and $y=-ax+b$ intersect $y=f(x)$ the same number of times. For $a=0$, by the symmetry of $y=f(x)$ and the fact that $f(x)> 0$ for all $x\\neq 0$ implies that the only line $y=b$ that intersects $y=f(x)$ exactly once is the line $y=0$.\n\nWe next observe that on $[0,\\infty)$, $f'(x) = \\frac{2x}{1+x^2}$ increases on $[0,1]$ from $f'(0)=0$ to a maximum at $f'(1)=1$, and then decreases on $[1,\\infty)$ with $\\lim_{x\\to\\infty} f'(x)=0$. In particular, $f'(x) \\leq 1$ for all $x$ (including $x<0$ since then $f'(x)<0$) and $f'(x)$ achieves each value in $(0,1)$ exactly twice on $[0,\\infty)$.\n\nFor $a \\geq 1$, we claim that any line $y=ax+b$ intersects $y=f(x)$ exactly once. They must intersect at least once by the intermediate value theorem: for $x\\ll 0$, $ax+b<0<f(x)$, while for $x \\gg 0$, $ax+b>f(x)$ since $\\lim_{x\\to\\infty} \\frac{\\ln(1+x^2)}{x} = 0$. On the other hand, they cannot intersect more than once: for $a>1$, this follows from the mean value theorem, since $f'(x)<a$ for all $x$. For $a=1$, suppose that they intersect at two points $(x_0,y_0)$ and $(x_1,y_1)$. Then\n\\[\n1 = \\frac{y_1-y_0}{x_1-x_0} = \\frac{\\int_{x_0}^{x_1} f'(x)\\,dx}{x_1-x_0} < 1\n\\]\nsince $f'(x)$ is continuous and $f'(x) \\leq 1$ with equality only at one point.\n\nFinally we consider $0<a<1$. The equation $f'(x) = a$ has exactly two solutions, at $x=r_-$ and $x=r_+$ for $r_{\\pm}$ as defined above.\nIf we define $g(x) = f(x)-ax$, then $g'(r_\\pm)=0$; $g'$ is strictly decreasing on $(-\\infty,r_-)$, strictly increasing on $(r_-,r_+)$, and strictly decreasing on $(r_+,\\infty)$; and $\\lim_{x\\to-\\infty} g(x) = \\infty$ while $\\lim_{x\\to\\infty} g(x) = -\\infty$. It follows that $g(x)=b$ has exactly one solution for $b<g(r_-)$ or $b>g(r_+)$, exactly three solutions for $g(r_-)<b<g(r_+)$, and exactly two solutions for $b = g(r_\\pm)$. That is, $y=ax+b$ intersects $y=f(x)$ in exactly one point if and only if $b<g(r_-)$ or $b>g(r_+)$.", "source_problems": "PUTNAM-2022-problems.tex", "source_solutions": "PUTNAM-2022-solutions.tex", "notes": ""}
{"id": "PUTNAM-2022-A2", "contest": "PUTNAM", "year": "2022", "problem_number": "A2", "problem": "Let $n$ be an integer with $n \\geq 2$. Over all real polynomials $p(x)$ of degree $n$, what is the largest possible number of negative coefficients of $p(x)^2$?", "solution": "The answer is $2n-2$. Write $p(x) = a_nx^n+\\cdots+a_1x+a_0$ and $p(x)^2 = b_{2n}x^{2n}+\\cdots+b_1x+b_0$. Note that $b_0 = a_0^2$ and $b_{2n} = a_n^2$. We claim that not all of the remaining $2n-1$ coefficients $b_1,\\ldots,b_{2n-1}$ can be negative, whence the largest possible number of negative coefficients is $\\leq 2n-2$. Indeed, suppose $b_i <0$ for $1\\leq i\\leq 2n-1$. Since $b_1 = 2a_0a_1$, we have $a_0 \\neq 0$. Assume $a_0>0$ (or else replace $p(x)$ by $-p(x)$). We claim by induction on $i$ that $a_i < 0$ for $1\\leq i\\leq n$. For $i=1$, this follows from $2a_0a_1 = b_1<0$. If $a_i<0$ for $1\\leq i\\leq k-1$, then\n\\[\n2a_0a_k = b_k - \\sum_{i=1}^{k-1} a_i a_{k-i} < b_k < 0\n\\]\nand thus $a_k<0$, completing the induction step. But now $b_{2n-1} = 2a_{n-1}a_n > 0$, contradiction.\n\nIt remains to show that there is a polynomial $p(x)$ such that $p(x)^2$ has $2n-2$ negative coefficients. For example, we may take\n\\[\np(x) = n(x^n+1) - 2(x^{n-1} + \\cdots + x),\n\\]\nso that\n\\begin{align*}\np(x)^2 &= n^2(x^{2n} + x^n + 1) - 2n(x^n+1)(x^{n-1}+\\cdots+x)\\\\\n&\\qquad \n+ (x^{n-1} + \\cdots + x)^2.\n\\end{align*}\nFor $i\\in \\{1,\\dots,n-1,n+1,\\dots,n-1\\}$, the coefficient of $x^i$ in $p(x)^2$ is at most $-2n$ (coming from the cross term)\nplus $-2n+2$ (from expanding $(x^{n-1} + \\cdots + x)^2$), and hence negative.", "source_problems": "PUTNAM-2022-problems.tex", "source_solutions": "PUTNAM-2022-solutions.tex", "notes": ""}
{"id": "PUTNAM-2022-A3", "contest": "PUTNAM", "year": "2022", "problem_number": "A3", "problem": "Let $p$ be a prime number greater than 5. Let $f(p)$ denote the number of infinite sequences $a_1, a_2, a_3, \\dots$ such that\n$a_n \\in \\{1, 2, \\dots, p-1\\}$ and $a_n a_{n+2} \\equiv 1 + a_{n+1} \\pmod{p}$ for all $n \\geq 1$. Prove that $f(p)$ is congruent to 0 or 2 $\\pmod{5}$.", "solution": "\\textbf{First solution.}\nWe view the sequence $a_1,a_2,\\ldots$ as lying in $\\mathbb{F}_p^\\times \\subset \\mathbb{F}_p$.  Then the sequence is determined by the values of $a_1$ and $a_2$, via the recurrence $a_{n+2}=(1+a_{n+1})/a_n$.  Using this recurrence, we compute\n\\begin{gather*}\na_3=\\frac{1 + a_2}{a_1}, \\, a_4 = \\frac{1 + a_1 + a_2}{a_1 a_2}, \\\\\na_5=\\frac{1 + a_1}{a_2}, \\, a_6 = a_1, \\, a_7 = a_2 \n\\end{gather*}\nand thus the sequence is periodic with period 5.  The values for $a_1$ and $a_2$ may thus be any values in $\\mathbb{F}_p^\\times$ provided that $a_1\\neq p-1$, $a_2\\neq p-1$, and $a_1+a_2\\neq p-1$.  The number of choices for $a_1,a_2\\in\\{1,\\ldots,p-2\\}$ such that $a_1+a_2\\neq p-1$ is thus $(p-2)^2 - (p-2)= (p-2)(p-3)$.\n\nSince $p$ is not a multiple of 5, $(p-2)(p-3)$ is a product of two consecutive integers $a,a+1$, where $a\\not\\equiv 2 \\pmod{5}$. Now $0\\cdot 1\\equiv 0$, $1\\cdot 2 \\equiv 2$, $3\\cdot 4\\equiv 2$, and $4\\cdot 0 \\equiv 0$ (mod 5).  Thus the number of possible sequences $a_1,a_2,\\ldots$ is 0 or 2 (mod 5), as desired. \n\n\\noindent\n\\textbf{Second solution.}\nSay that a sequence is \\textit{admissible} if it satisfies the given conditions. As in the first solution, any admissible sequence is 5-periodic.\n\nNow consider the collection $S$ of possible $5$-tuples of numbers mod $p$ given by $(a_1,a_2,a_3,a_4,a_5)$ for admissible sequences $\\{a_n\\}$. Each of these $5$-tuples in $S$ comes from a unique admissible sequence, and there is a $5$-periodic action on $S$ given by cyclic permutation: $(a,b,c,d,e) \\rightarrow (b,c,d,e,a)$. This action divides $S$ into finitely many orbits, and each orbit either consists of $5$ distinct tuples (if $a,b,c,d,e$ are not all the same) or $1$ tuple $(a,a,a,a,a)$. It follows that the number of admissible sequences is a multiple of $5$ plus the number of constant admissible sequences.\n\nConstant admissible sequences correspond to nonzero numbers $a \\pmod{p}$ such that $a^2 \\equiv 1+a \\pmod{p}$.\nSince the quadratic $x^2-x-1$ has discriminant 5, for $p > 5$ it has either 2 roots (if the discriminant is a quadratic residue mod $p$) or 0 roots mod $p$.", "source_problems": "PUTNAM-2022-problems.tex", "source_solutions": "PUTNAM-2022-solutions.tex", "notes": ""}
{"id": "PUTNAM-2022-A4", "contest": "PUTNAM", "year": "2022", "problem_number": "A4", "problem": "Suppose that $X_1, X_2, \\dots$ are real numbers between 0 and 1 that are chosen independently and uniformly at random. Let $S = \\sum_{i=1}^k X_i/2^i$, where $k$ is the least positive integer such that $X_k < X_{k+1}$, or $k = \\infty$ if there is no such integer. Find the expected value of $S$.", "solution": "The expected value is $2e^{1/2}-3$.\n\nExtend $S$ to an infinite sum by including zero summands for $i> k$. We may then compute the expected value as the sum of the expected value of the $i$-th summand over all $i$. This summand\noccurs if and only if $X_1,\\dots,X_{i-1} \\in [X_i, 1]$\nand $X_1,\\dots,X_{i-1}$ occur in nonincreasing order. These two events are independent and occur with respective probabilities $(1-X_i)^{i-1}$ and $\\frac{1}{(i-1)!}$; the expectation of this summand is therefore\n\\begin{align*}\n&\\frac{1}{2^i(i-1)!} \\int_0^1 t (1-t)^{i-1}\\,dt \\\\\n&\\qquad = \\frac{1}{2^i(i-1)!} \\int_0^1 ((1-t)^{i-1} - (1-t)^i)\\,dt \\\\\n&\\qquad = \\frac{1}{2^i(i-1)!} \\left( \\frac{1}{i} - \\frac{1}{i+1} \\right) = \\frac{1}{2^i (i+1)!}.\n\\end{align*}\nSumming over $i$, we obtain\n\\[\n\\sum_{i=1}^\\infty \\frac{1}{2^i (i+1)!}\n= 2 \\sum_{i=2}^\\infty \\frac{1}{2^i i!}\n= 2\\left(e^{1/2}-1-\\frac{1}{2} \\right).\n\\]", "source_problems": "PUTNAM-2022-problems.tex", "source_solutions": "PUTNAM-2022-solutions.tex", "notes": ""}
{"id": "PUTNAM-2022-A5", "contest": "PUTNAM", "year": "2022", "problem_number": "A5", "problem": "Alice and Bob play a game on a board consisting of one row of 2022 consecutive squares. They take turns placing tiles that cover two adjacent squares, with Alice going first. By rule, a tile must not cover a square that is already covered by another tile. The game ends when no tile can be placed according to this rule. Alice's goal is to maximize the number of uncovered squares when the game ends; Bob's goal is to minimize it. What is the greatest number of uncovered squares that Alice can ensure at the end of the game, no matter how Bob plays?", "solution": "We show that the number in question equals 290. More generally,\nlet $a(n)$ (resp.\\ $b(n)$) be the optimal final score for Alice (resp.\\ Bob) moving first in a position with $n$ consecutive squares. We show that\n\\begin{align*}\na(n) &= \\left\\lfloor \\frac{n}{7} \\right\\rfloor + a\\left(n - 7\\left\\lfloor \\frac{n}{7} \\right\\rfloor \\right), \\\\\nb(n) &= \\left\\lfloor \\frac{n}{7} \\right\\rfloor + b\\left(n - 7\\left\\lfloor \\frac{n}{7} \\right\\rfloor \\right),\n\\end{align*}\nand that the values for $n \\leq 6$ are as follows:\n\\[\n\\begin{array}{c|cccccccccc}\nn & 0 & 1 & 2 & 3 & 4 & 5 & 6 \\\\\n\\hline\na(n) & 0 & 1 & 0 & 1 & 2 & 1 & 2  \\\\\nb(n) & 0 & 1 & 0 & 1 & 0 & 1 & 0 \n\\end{array}\n\\]\nSince $2022 \\equiv 6 \\pmod{7}$, this will yield\n$a(2022) = 2 + \\lfloor \\frac{2022}{7} \\rfloor = 290$.\n\nWe proceed by induction, starting with the base cases $n \\leq 6$.\nSince the number of odd intervals never decreases, we have $a(n), b(n) \\geq n - 2 \\lfloor \\frac{n}{2} \\rfloor$; by looking at the possible final positions, we see that equality holds for $n=0,1,2,3,5$. For $n=4,6$, Alice moving first can split the original interval into two odd intervals, guaranteeing at least two odd intervals in the final position; whereas Bob can move to leave behind one or two intervals of length 2, guaranteeing no odd intervals in the final position.\n\nWe now proceed to the induction step. Suppose that $n \\geq 7$\nand the claim is known for all $m < n$. In particular, this means that $a(m) \\geq b(m)$; consequently, it does not change the analysis to allow a player to pass their turn after the first move, as both players will still have an optimal strategy which involves never passing.\n\nIt will suffice to check that\n\\[\na(n) = a(n-7) + 1, \\qquad b(n) = b(n-7) + 1.\n\\]\nMoving first, Alice can leave behind two intervals of length 1 and $n-3$. This shows that\n\\[\na(n) \\geq 1 + b(n-3) = a(n-7) + 1.\n\\]\nOn the other hand, if Alice leaves behind intervals of length $i$ and $n-2-i$, Bob can choose to play in either one of these intervals and then follow Alice's lead thereafter (exercising the pass option if Alice makes the last legal move in one of the intervals). \nThis shows that\n\\begin{align*}\na(n) &\\leq \\max\\{\\min\\{a(i) + b(n-2-i), \\\\\n& \\qquad b(i)+a(n-2-i)\\}: i =0,1,\\dots,n-2\\} \\\\\n&= a(n-7)+1.\n\\end{align*}\n\nMoving first, Bob can leave behind two intervals of lengths 2 and $n-4$. This shows that\n\\[\nb(n) \\leq a(n-4) = b(n-7) + 1.\n\\]\nOn the other hand, if Bob leaves behind intervals of length $i$ and $n-2-i$, Alice can choose to play in either one of these intervals and then follow Bob's lead thereafter (again passing as needed). This shows that\n\\begin{align*}\nb(n) &\\geq \\min\\{\\max\\{a(i) + b(n-2-i), \\\\\n& \\qquad b(i)+a(n-2-i)\\}: i =0,1,\\dots,n-2\\} \\\\\n&= b(n-7)+1.\n\\end{align*}\nThis completes the induction.", "source_problems": "PUTNAM-2022-problems.tex", "source_solutions": "PUTNAM-2022-solutions.tex", "notes": ""}
{"id": "PUTNAM-2022-A6", "contest": "PUTNAM", "year": "2022", "problem_number": "A6", "problem": "Let $n$ be a positive integer. Determine, in terms of $n$, the largest integer $m$ with the following property: There exist real numbers $x_1,\\dots,x_{2n}$ with $-1 < x_1 < x_2 < \\cdots < x_{2n} < 1$ such that the sum of the lengths of the $n$ intervals\n\\[\n[x_1^{2k-1}, x_2^{2k-1}], [x_3^{2k-1},x_4^{2k-1}], \\dots, [x_{2n-1}^{2k-1}, x_{2n}^{2k-1}]\n\\]\nis equal to 1 for all integers $k$ with $1 \\leq k \\leq m$.", "solution": "\\textbf{First solution.}\nThe largest such $m$ is $n$.\nTo show that $m \\geq n$,\nwe take\n\\[\nx_j = \\cos \\frac{(2n+1-j)\\pi}{2n+1} \\qquad (j=1,\\dots,2n).\n\\]\nIt is apparent that $-1 < x_1 < \\cdots < x_{2n} < 1$.\nThe sum of the lengths of the intervals can be interpreted as\n\\begin{align*}\n& -\\sum_{j=1}^{2n} ((-1)^{2n+1-j} x_j)^{2k-1} \\\\\n&= -\\sum_{j=1}^{2n} \\left(\\cos (2n+1-j)\\left(\\pi + \\frac{\\pi}{2n+1} \\right)\\right)^{2k-1} \\\\\n&= -\\sum_{j=1}^{2n} \\left(\\cos \\frac{2\\pi(n+1)j}{2n+1}\\right)^{2k-1}.\n\\end{align*}\nFor $\\zeta = e^{2 \\pi i (n+1)/(2n+1)}$, this becomes\n\\begin{align*}\n&= -\\sum_{j=1}^{2n} \\left( \\frac{\\zeta^j + \\zeta^{-j}}{2} \\right)^{2k-1} \\\\\n&= -\\frac{1}{2^{2k-1}}\\sum_{j=1}^{2n} \\sum_{l=0}^{2k-1} \n\\binom{2k-1}{l} \\zeta^{j(2k-1-2l)} \\\\\n&= -\\frac{1}{2^{2k-1}} \\sum_{l=0}^{2k-1} \\binom{2k-1}{l}\n\\sum_{j=1}^{2n}\n\\zeta^{j(2k-1-2l)}  \\\\\n&= -\\frac{1}{2^{2k-1}} \\sum_{l=0}^{2k-1} \\binom{2k-1}{l}\n(-1) = 1,\n\\end{align*}\nusing the fact that $\\zeta^{2k-1-2l}$ is a \\emph{nontrivial} root of unity of order dividing $2n+1$.\n\nTo show that $m \\leq n$, we use the following lemma.\nWe say that a multiset $\\{x_1,\\dots,x_m\\}$ of complex numbers is \\emph{inverse-free} if there are no two indices $1 \\leq i \\leq j \\leq m$ such that $x_i + x_j = 0$; this implies in particular that 0 does not occur.\n\\begin{lemma*}\nLet $\\{x_1,\\dots,x_m\\},\\{y_1,\\dots,y_n\\}$ be two inverse-free multisets of complex numbers such that\n\\[\n\\sum_{i=1}^m x_i^{2k-1} = \\sum_{i=1}^n y_i^{2k-1} \\qquad (k=1,\\dots,\\max\\{m,n\\}).\n\\]\nThen these two multisets are equal.\n\\end{lemma*}\n\\begin{proof}\nWe may assume without loss of generality that $m \\leq n$.\nForm the rational functions\n\\[\nf(z) = \\sum_{i=1}^m \\frac{x_i z}{1 - x_i^2 z^2}, \\quad\ng(z) = \\sum_{i=1}^n \\frac{y_i z}{1 - y_i^2 z^2};\n\\]\nboth $f(z)$ and $g(z)$ have total pole order at most $2n$.\nMeanwhile, by expanding in power series around $z=0$, we see that $f(z)-g(z)$ is divisible by $z^{2n+1}$.\nConsequently, the two series are equal. \n\nHowever, we can uniquely recover the multiset $\\{x_1,\\dots,x_m\\}$ from $f(z)$: $f$ has poles at $\\{1/x_1^2,\\dots,1/x_m^2\\}$\nand the residue of the pole at $z = 1/x_i^2$ uniquely determines both $x_i$ (i.e., its sign) and its multiplicity.\nSimilarly, we may recover $\\{y_1,\\dots,y_n\\}$ from $g(z)$, so the two multisets must coincide.\n\\end{proof}\n\nNow suppose by way of contradiction that we have an example showing that $m \\geq n+1$. We then have\n\\[\n1^{2k-1} + \\sum_{i=1}^n x_{2i-1}^{2k-1} = \\sum_{i=1}^n x_{2i}^{2k-1} \\qquad (k=1,\\dots,n+1).\n\\]\nBy the lemma, this means that the multisets $\\{1,x_1,x_3,\\dots,x_{2n-1}\\}$ and $\\{x_2,x_4,\\dots,x_{2n}\\}$ become equal after removing pairs of inverses until this becomes impossible. However, of the resulting two multisets, the first contains 1 and the second does not, yielding the desired contradiction.\n\n\\noindent\n\\textbf{Remark.}\nOne can also prove the lemma using the invertibility of the Vandermonde matrix\n\\[\n(x_i^j)_{i=0,\\dots,n; j=0,\\dots,n}\n\\]\nfor $x_0,\\dots,x_n$ pairwise distinct (this matrix has determinant $\\prod_{0 \\leq i < j \\leq n}(x_i - x_j) \\neq 0$). For a similar argument, see\nProposition 22 of: M. Bhargava, Galois groups of random integer polynomials and van der Waerden's conjecture, arXiv:2111.06507.\n\n\\noindent\n\\textbf{Remark.}\nThe solution for $m=n$ given above is not unique (see below).\nHowever, it does become unique if we add the assumption that $x_i = -x_{2n+1-i}$ for $i=1,\\dots,2n$ (i.e., the set of intervals is symmetric around 0).\n\n\\noindent\n\\textbf{Second solution.} (by Evan Dummit)\nDefine the polynomial\n\\[\np(x) = (x-x_1)(x+x_2) \\cdots (x-x_{2n-1})(x+x_{2n})(x+1);\n\\]\nby hypothesis, $p(x)$ has $2n+1$ distinct real roots in the interval $[-1, 1)$. Let $s_k$ denote the $k$-th power sum of $p(x)$; then for any given $m$, the desired condition is that\n$s_{2k-1} = 0$ for $k=1,\\dots,m$.\nLet $e_k$ denote the $k$-th elementary symmetric function of the roots of $p(x)$; that is,\n\\[\np(x) = x^{2n+1} + \\sum_{i=k}^{2n+1} (-1)^k e_k x^{2n+1-k}.\n\\]\nBy the Girard--Newton identities,\n\\[\n(2k-1) e_{2k-1} = s_1 e_{2k-2} - s_2 e_{2k-2} + \\cdots - s_{2k} e_1;\n\\]\nhence the desired condition implies that $e_{2k-1} = 0$ for $k=1,\\dots,m$.\n\nIf we had a solution with $m=n+1$, then the vanishing of $e_1,\\dots,e_{2k+1}$ would imply that $p(x)$ is an odd polynomial (that is, $p(x) = -p(x)$ for all $x$), which in turn would imply that $x=1$ is also a root of $p$. Since we have already identified $2n+1$ other roots of $p$, this yields a contradiction.\n\nBy the same token, a solution with $m=n$ corresponds to a polynomial $p(x)$ of the form $xq(x^2) + a$ for some polynomial $q(x)$ of degree $n$ and some real number $a$ (necessarily equal to $q(1)$). It will thus suffice to choose $q(x)$ so that the resulting polynomial $p(x)$ has roots consisting of $-1$ plus $2n$ distinct values in $(-1,1)$. To do this, start with any polynomial $r(x)$ of degree $n$ with $n$ distinct positive roots (e.g., $r(x) = (x-1)\\cdots(x-n)$). \nThe polynomial $x r(x^2)$ then has $2n+1$ distinct real roots;\nconsequently, for $\\epsilon > 0$ sufficiently small, $xr(x^2) + \\epsilon$ also has $2n+1$ distinct real roots. Let $-\\alpha$ be the smallest of these roots (so that $\\alpha > 0$); we then take $q(x) = r(x\\sqrt{\\alpha})$ to achieve the desired result.\n\n\\noindent\n\\textbf{Remark.}\nBrian Lawrence points out that one can also produce solutions for $m=n$ by starting with the degenerate solution\n\\[\n-a_{n-1}, \\ldots, -a_1, 0, a_1, \\ldots, a_{n-1}, 1\n\\]\n(where $0 < a_1 < \\cdots < a_{n-1} < 1$ but no other conditions are imposed) and deforming it using the implicit function theorem. More\nprecisely, there exists a differentiable parametric solution $x_1(t),\\dots,x_{2n}(t)$ with $x_i(t) = x_{2n-i}(t)$ for $i=1,\\dots,n-1$ specializing to the previous solution at $t=0$,\nsuch that $x_i'(0) \\neq 0$ for $i=n,\\dots,2n$; this is because the Jacobian matrix\n\\[\nJ = ((2k-1) x_i(0)^{2k-2})_{i=n,\\dots,2n; k=1,\\dots,n}\n\\]\n(interpreting $0^0$ as $1$) has the property that every maximal minor is nonzero (these being scaled Vandermonde matrices).\nIn particular we may normalize so that $x_{2n}'(0) < 0$, and then evaluating at a small positive value of $t$ gives the desired example.\n\nIn the proof that $m=n+1$ cannot occur, one can similarly use the implicit function theorem (with some care) to reduce to the case where $\\{|x_1|,\\dots,|x_{2n}|\\}$ has cardinality $n+1$. This can be extended to a complete solution, but the details are rather involved.", "source_problems": "PUTNAM-2022-problems.tex", "source_solutions": "PUTNAM-2022-solutions.tex", "notes": ""}
{"id": "PUTNAM-2022-B1", "contest": "PUTNAM", "year": "2022", "problem_number": "B1", "problem": "Suppose that $P(x) = a_1 x + a_2 x^2 + \\cdots + a_n x^n$ is a polynomial with integer coefficients, with $a_1$ odd. Suppose that $e^{P(x)} = b_0 + b_1 x + b_2 x^2 + \\cdots$ for all $x$. Prove that $b_k$ is nonzero for all $k \\geq 0$.", "solution": "We prove that $b_k k!$ is an odd integer for all $k \\geq 0$.\n\n\\textbf{First solution.}\nSince $e^{P(x)} = \\sum_{n=0}^\\infty \\frac{(P(x))^n}{n!}$, the number $k!\\,b_k$ is the coefficient of $x^k$ in\n\\[\n(P(x))^k + \\sum_{n=0}^{k-1} \\frac{k!}{n!}(P(x))^n.\n\\]\nIn particular, $b_0=1$ and $b_1=a_1$ are both odd. \n\nNow suppose $k \\geq 2$; we want to show that $b_k$ is odd. The coefficient of $x^k$ in $(P(x))^k$ is $a_1^k$. It suffices to show that the coefficient of $x^k$ in $\\frac{k!}{n!}(P(x))^n$ is an even integer for any $n<k$. For $k$ even or $n \\leq k-2$, this follows immediately from the fact that $\\frac{k!}{n!}$ is an even integer. For $k$ odd and $n=k-1$, we have\n\\begin{align*}\n\\frac{k!}{(k-1)!}(P(x))^{k-1} &= k(a_1x+a_2x^2+\\cdots)^{k-1} \\\\\n&= k(a_1^{k-1}x^{k-1}+(k-1)a_1^{k-2}a_2x^k+\\cdots)\n\\end{align*}\nand the coefficient of $x^k$ is $k(k-1)a_1^{k-2}a_2$, which is again an even integer.\n\n\\noindent\n\\textbf{Second solution.}\nLet $G$ be the set of power series of the form $\\sum_{n=0}^\\infty c_n \\frac{x_n}{n!}$ with $c_0 = 1, c_n \\in \\mathbb{Z}$; then $G$ forms a group under formal series multiplication because\n\\[\n\\left( \\sum_{n=0}^\\infty c_n \\frac{x^n}{n!} \\right)\n\\left( \\sum_{n=0}^\\infty d_n \\frac{x^n}{n!} \\right)\n= \\sum_{n=0}^\\infty e_n \\frac{x^n}{n!} \n\\]\nwith\n\\[\ne_n = \\sum_{m=0}^n \\binom{n}{m} c_m d_{n-m}.\n\\]\nBy the same calculation, the subset $H$ of series with $c_n \\in 2\\mathbb{Z}$ for all $n \\geq 1$ is a subgroup of $G$.\n\nWe have $e^{2x} \\in H$ because $\\frac{2^n}{n!} \\in 2\\mathbb{Z}$ for all $n \\geq 1$: the exponent of 2 in the prime factorization of $n!$ is\n\\[\n\\sum_{i=1}^\\infty \\left\\lfloor \\frac{n}{2^i} \\right\\rfloor\n< \\sum_{i=1}^\\infty \\frac{n}{2^i} = n.\n\\]\nFor any integer $k \\geq 2$, we have $e^{x^k} \\in H$ because $\\frac{(nk)!}{n!} \\in 2\\mathbb{Z}$ for all $n \\geq 1$: this is clear if $k=2,n=1$, and in all other cases the ratio is divisible by $(n+1)(n+2)$. \n\nWe deduce that $e^{P(x)-x} \\in H$.\nBy writing $e^{P(x)}$ as $e^x = \\sum_{n=0}^\\infty \\frac{x^n}{n!}$\ntimes an element of $H$, we deduce that $k! b_k$ is odd for all $k \\geq 0$.\n\n\\noindent\n\\textbf{Third solution.}\n(by David Feldman)\nWe interpret $e^{P(x)}$ using the exponential formula for generating functions.\nFor each $j$, choose a set $S_j$ consisting of $|a_j|$ colors.\nThen $b_k$ is a weighted count over set partitions of $\\{1,\\dots,k\\}$, with each part of size $j$ assigned a color in $S_j$, and the weight being $(-1)^i$ where $i$ is the number of parts of any size $j$ for which $a_j < 0$.\n\nSince we are only looking for the parity of $b_k$, we may dispense with the signs; that is, we may assume $a_j \\geq 0$ for all $j$\nand forget about the weights.\n\nChoose an involution on each $S_j$ with at most one fixed point; this induces an involution on the partitions, so to find the parity of $b_k$ we may instead count fixed points of the involution. That is, we may assume that $a_j \\in \\{0,1\\}$.\n\nLet $T_k$ be the set of set partitions in question with the all-singletons partition removed; it now suffices to exhibit a fixed-point-free involution of $T_k$. To wit, for each partition in $T_k$, there is a smallest index $i \\in \\{1,\\dots,k-1\\}$ for which $i$ and $i+1$ are not both singletons; we define an involution by swapping the positions of $i$ and $i+1$.", "source_problems": "PUTNAM-2022-problems.tex", "source_solutions": "PUTNAM-2022-solutions.tex", "notes": ""}
{"id": "PUTNAM-2022-B2", "contest": "PUTNAM", "year": "2022", "problem_number": "B2", "problem": "Let $\\times$ represent the cross product in $\\mathbb{R}^3$. For what positive integers $n$ does there exist a set $S \\subset \\mathbb{R}^3$ with exactly $n$ elements such that \n\\[\nS = \\{v \\times w: v, w \\in S\\}?\n\\]", "solution": "The possible values of $n$ are 1 and 7.\n\nClearly the set $S = \\{0\\}$ works. Suppose that $S \\neq \\{0\\}$ is a finite set satisfying the given condition; in particular, $S$ does not consist of a collection of collinear vectors, since otherwise $\\{v \\times w: v,w \\in S\\} = \\{0\\}$. We claim that $S$ cannot contain any nonzero vector $v$ with $\\|v\\| \\neq 1$. Suppose otherwise, and let $w \\in S$ be a vector not collinear with $v$. Then $S$ must contain the nonzero vector $u_1 = v\\times w$, as well as the sequence of vectors $u_n$ defined inductively by $u_n = v \\times u_{n-1}$. Since each $u_n$ is orthogonal to $v$ by construction, we have $\\|u_n\\| = \\|v\\| \\|u_{n-1}\\|$ and so $\\|u_n\\| = \\|v\\|^{n-1} \\|u_1\\|$. The sequence $\\|u_n\\|$ consists of all distinct numbers and thus $S$ is infinite, a contradiction. This proves the claim, and so every nonzero vector in $S$ is a unit vector.\n\nNext note that any pair of vectors $v,w \\in S$ must either be collinear or orthogonal: by the claim, $v,w$ are both unit vectors, and if $v,w$ are not collinear then $v\\times w \\in S$ must be a unit vector, whence $v\\perp w$. Now choose any pair of non-collinear vectors $v_1,v_2 \\in S$, and write $v_3 = v_1 \\times v_2$. Then $\\{v_1,v_2,v_3\\}$ is an orthonormal basis of $\\mathbb{R}^3$, and it follows that all of these vectors are in $S$: $0$, $v_1$, $v_2$, $v_3$, $-v_1 = v_3 \\times v_2$, $-v_2 = v_1 \\times v_3$, and $-v_3 = v_2 \\times v_1$. On the other hand, $S$ cannot contain any vector besides these seven, since any other vector $w$ in $S$ would have to be simultaneously orthogonal to all of $v_1,v_2,v_3$.\n\nThus any set $S \\neq \\{0\\}$ satisfying the given condition must be of the form $\\{0,\\pm v_1,\\pm v_2,\\pm v_3\\}$ where $\\{v_1,v_2,v_3\\}$ is an orthonormal basis of $\\mathbb{R}^3$. It is clear that any set of this form does satisfy the given condition. We conclude that the answer is $n=1$ or $n=7$.", "source_problems": "PUTNAM-2022-problems.tex", "source_solutions": "PUTNAM-2022-solutions.tex", "notes": ""}
{"id": "PUTNAM-2022-B3", "contest": "PUTNAM", "year": "2022", "problem_number": "B3", "problem": "Assign to each positive real number a color, either red or blue. Let $D$ be the set of all distances $d > 0$ such that there are two points of the same color at distance $d$ apart. Recolor the positive reals so that the numbers in $D$ are red and the numbers not in $D$ are blue. If we iterate this recoloring process, will we always end up with all the numbers red after a finite number of steps?\n\n\\smallskip", "solution": "The answer is yes. Let $R_0,B_0 \\subset \\mathbb{R}^+$ be the set of red and blue numbers at the start of the process, and let $R_n,B_n$ be the set of red and blue numbers after $n$ steps. We claim that $R_2 = \\mathbb{R}^+$.\n\nWe first note that if $y \\in B_1$, then $y/2 \\in R_1$. Namely, the numbers $y$ and $2y$ must be of opposite colors in the original coloring, and then $3y/2$ must be of the same color as one of $y$ or $2y$. \n\nNow suppose by way of contradiction that $x \\in B_2$. Then of the four numbers $x,2x,3x,4x$, every other number must be in $R_1$ and the other two must be in $B_1$. By the previous observation, $2x$ and $4x$ cannot both be in $B_1$; it follows that $2x,4x \\in R_1$ and $x,3x \\in B_1$. By the previous observation again, $x/2$ and $3x/2$ must both be in $R_1$, but then $x = 3x/2-x/2$ is in $R_2$, contradiction. We conclude that $R_2 = \\mathbb{R}^+$, as desired.", "source_problems": "PUTNAM-2022-problems.tex", "source_solutions": "PUTNAM-2022-solutions.tex", "notes": ""}
{"id": "PUTNAM-2022-B4", "contest": "PUTNAM", "year": "2022", "problem_number": "B4", "problem": "Find all integers $n$ with $n \\geq 4$ for which there exists a sequence of distinct real numbers $x_1,\\dots,x_n$ such that each of the sets\n\\begin{gather*}\n\\{x_1,x_2,x_3\\}, \\{x_2,x_3,x_4\\}, \\dots, \\\\\n\\{x_{n-2},x_{n-1},x_n\\}, \\{x_{n-1},x_n, x_1\\}, \\mbox{ and } \\{x_n, x_1, x_2\\}\n\\end{gather*}\nforms a 3-term arithmetic progression when arranged in increasing order.", "solution": "The values of $n$ in question are the multiples of 3 starting with 9. Note that we interpret ``distinct'' in the problem statement to mean ``pairwise distinct'' (i.e., no two equal). See the remark below.\n\nWe first show that such a sequence can only occur when $n$ is divisible by 3.\nIf $d_1$ and $d_2$ are the common differences of the arithmetic progressions $\\{x_m, x_{m+1}, x_{m+2}\\}$ and $\\{x_{m+1}, x_{m+2}, x_{m+3}\\}$ for some $m$, then $d_2 \\in \\{d_1, 2d_1, d_1/2\\}$. \nBy scaling we may assume that the smallest common difference that occurs is 1; in this case, all of the common differences are integers. By shifting, we may assume that the $x_i$ are themselves all integers. We now observe that any three consecutive terms in the sequence have pairwise distinct residues modulo 3, \nforcing $n$ to be divisible by 3.\n\nWe then observe that for any $m \\geq 2$, \nwe obtain a sequence of the desired form of length $3m+3 = (2m-1)+1+(m+1)+2$ by\nconcatenating the arithmetic progressions\n\\begin{gather*}\n(1, 3, \\dots, 4m-3, 4m-1), \\\\\n4m-2, (4m, 4m-4, \\dots, 4, 0), 2.\n\\end{gather*}\nWe see that no terms are repeated by noting that the first parenthesized sequence consists of odd numbers; the second sequence consists of multiples of 4; and the remaining numbers $2$ and $4m-2$ are distinct (because $m \\geq 2$) but both congruent to 2 mod 4.\n\nIt remains to show that no such sequence occurs with $n=6$.\nWe may assume without loss of generality that the smallest common difference among the arithmetic progressions is 1 and occurs for $\\{x_1, x_2, x_3\\}$; by rescaling, shifting, and reversing the sequence as needed, we may assume that\n$x_1 = 0$ and $(x_2, x_3) \\in \\{(1,2), (2,1)\\}$.\nWe then have $x_4 = 3$ and\n\\[\n(x_5, x_6) \\in \\{(4,5), (-1, -5), (-1, 7), (5, 4), (5, 7)\\}.\n\\]\nIn none of these cases does $\\{x_5, x_6, 0\\}$ form an arithmetic progression.\n\n\\noindent\n\\textbf{Remark.}\nIf one interprets ``distinct'' in the problem statement to mean ``not all equal'', then the problem becomes simpler:\nthe same argument as above shows that $n$ must be a multiple of 3, in which case a suitable repetition of the sequence $-1,0,1$ works.", "source_problems": "PUTNAM-2022-problems.tex", "source_solutions": "PUTNAM-2022-solutions.tex", "notes": ""}
{"id": "PUTNAM-2022-B5", "contest": "PUTNAM", "year": "2022", "problem_number": "B5", "problem": "For $0 \\leq p \\leq 1/2$, let $X_1, X_2, \\dots$ be independent random variables such that\n\\[\nX_i = \\begin{cases} 1 & \\mbox{with probability $p$,} \\\\\n-1 & \\mbox{with probability $p$,} \\\\\n0 & \\mbox{with probability $1-2p$,}\n\\end{cases}\n\\]\nfor all $i \\geq 1$. Given a positive integer $n$ and integers $b, a_1, \\dots, a_n$, let $P(b, a_1, \\dots, a_n)$ denote the probability that $a_1 X_1 + \\cdots + a_n X_n = b$. For which values of $p$ is it the case that\n\\[\nP(0, a_1, \\dots, a_n) \\geq P(b, a_1, \\dots, a_n)\n\\]\nfor all positive integers $n$ and all integers $b, a_1, \\dots, a_n$?", "solution": "\\textbf{First solution.}\nThe answer is $p \\leq 1/4$. We first show that $p >1/4$ does not satisfy the desired condition. For $p>1/3$, $P(0,1) = 1-2p < p = P(1,1)$. For $p=1/3$, it is easily calculated (or follows from the next calculation) that $P(0,1,2) = 1/9 < 2/9 = P(1,1,2)$. Now suppose $1/4 < p < 1/3$, and consider $(b,a_1,a_2,a_3,\\ldots,a_n) = (1,1,2,4,\\ldots,2^{n-1})$.  The only solution to\n\\[\nX_1+2X_2+\\cdots+2^{n-1}X_n = 0\n\\]\nwith $X_j \\in \\{0,\\pm 1\\}$ is $X_1=\\cdots=X_n=0$; thus $P(0,1,2,\\ldots,2^{2n-1}) = (1-2p)^n$. On the other hand, the solutions to\n\\[\nX_1+2X_2+\\cdots+2^{n-1}X_n = 1\n\\]\nwith $X_j \\in \\{0,\\pm 1\\}$ are \n\\begin{gather*}\n(X_1,X_2,\\ldots,X_n) = (1,0,\\ldots,0),(-1,1,0,\\ldots,0), \\\\\n(-1,-1,1,0,\\ldots,0), \\ldots, (-1,-1,\\ldots,-1,1),\n\\end{gather*}\nand so\n\\begin{align*}\n&P(1,1,2,\\ldots,2^{n-1}) \\\\\n& = p(1-2p)^{n-1}+p^2(1-2p)^{n-2}+\\cdots+p^n \\\\\n&= p\\frac{(1-2p)^{n}-p^{n}}{1-3p}.\n\\end{align*}\nIt follows that the inequality\n$P(0,1,2,\\ldots,2^{n-1}) \\geq P(1,1,2,\\ldots,2^{n-1})$ is equivalent to \n\\[\np^{n+1} \\geq (4p-1)(1-2p)^n,\n\\]\nbut this is false for sufficiently large $n$ since $4p-1>0$ and $p<1-2p$.\n\nNow suppose $p \\leq 1/4$; we want to show that for arbitrary $a_1,\\ldots,a_n$ and $b \\neq 0$, $P(0,a_1,\\ldots,a_n) \\geq P(b,a_1,\\ldots,a_n)$. Define the polynomial\n\\[\nf(x) = px+px^{-1}+1-2p, \n\\]\nand observe that $P(b,a_1,\\ldots,a_n)$ is the coefficient of $x^b$ in\n$f(x^{a_1})f(x^{a_2})\\cdots f(x^{a_n})$. We can write\n\\[\nf(x^{a_1})f(x^{a_2})\\cdots f(x^{a_n}) = g(x)g(x^{-1})\n\\]\nfor some real polynomial $g$: indeed, if we define $\\alpha = \\frac{1-2p+\\sqrt{1-4p}}{2p} > 0$, then $f(x) = \\frac{p}{\\alpha}(x+\\alpha)(x^{-1}+\\alpha)$, and so we can use\n\\[\ng(x) = \\left(\\frac{p}{\\alpha}\\right)^{n/2} (x^{a_1}+\\alpha)\\cdots(x^{a_n}+\\alpha).\n\\]\n\nIt now suffices to show that in $g(x)g(x^{-1})$, the coefficient of $x^0$ is at least as large as the coefficient of $x^b$ for any $b \\neq 0$. Since $g(x)g(x^{-1})$ is symmetric upon inverting $x$, we may assume that $b > 0$. If we write $g(x) = c_0 x^0 + \\cdots + c_m x^m$, then the coefficients of $x^0$ and $x^b$ in $g(x)g(x^{-1})$ are $c_0^2+c_1^2+\\cdots+c_m^2$ and $c_0c_b+c_1c_{b+1}+\\cdots+c_{m-b}c_m$, respectively. But\n\\begin{align*}\n&2(c_0c_b+c_1c_{b+1}+\\cdots+c_{m-b}c_m)\\\\\n&\\leq (c_0^2+c_b^2)+(c_1^2+c_{b+1}^2)+\\cdots+(c_{m-b}^2+c_m^2) \\\\\n& \\leq\n2(c_0^2+\\cdots+c_m^2),\n\\end{align*}\nand the result follows.\n\n\\noindent\n\\textbf{Second solution.} (by Yuval Peres)\nWe check that $p \\leq 1/4$ is necessary as in the first solution. To check that it is sufficient, we introduce the following concept: for $X$ a random variable taking finitely many integer values, define the \\emph{characteristic function}\n\\[\n\\varphi_X(\\theta) = \\sum_{\\ell \\in \\mathbb{Z}} P(X = \\ell) e^{i \\ell \\theta}\n\\]\n(i.e., the expected value of $e^{i X\\theta}$, or \nthe Fourier transform of the probability measure corresponding to $X$). We use two evident properties of these functions:\n\\begin{itemize}\n\\item\nIf $X$ and $Y$ are independent, then $\\varphi_{X+Y}(\\theta) = \\varphi_X(\\theta) + \\varphi_Y(\\theta)$.\n\\item\nFor any $b \\in \\mathbb{Z}$,\n\\[\nP(X = b) = \\frac{1}{2} \\int_0^{2\\pi} e^{-ib\\theta} \\varphi_X(\\theta)\\,d\\theta.\n\\]\nIn particular, if $\\varphi_X(\\theta) \\geq 0$ for all $\\theta$, then\n$P(X=b) \\leq P(X = 0)$.\n\\end{itemize}\n\nFor $p \\leq 1/4$, we have\n\\[\n\\varphi_{X_k}(\\theta) = (1-2p) + 2p \\cos (\\theta) \\geq 0.\n\\]\nHence for $a_1,\\dots,a_n \\in \\mathbb{Z}$, the random variable $S = a_1 X_1 + \\cdots + a_n X_n$ satisfies\n\\[\n\\varphi_S(\\theta) = \\prod_{k=1}^n \\varphi_{a_kX_k}(\\theta)\n= \\prod_{k=1}^n \\varphi_{X_k}(a_k\\theta) \\geq 0.\n\\]\nWe may thus conclude that $P(S=b) \\leq P(S=0)$ for any $b \\in \\mathbb{Z}$, as desired.", "source_problems": "PUTNAM-2022-problems.tex", "source_solutions": "PUTNAM-2022-solutions.tex", "notes": ""}
{"id": "PUTNAM-2022-B6", "contest": "PUTNAM", "year": "2022", "problem_number": "B6", "problem": "Find all continuous functions $f: \\mathbb{R}^+ \\to \\mathbb{R}^+$ such that\n\\[\nf(xf(y)) + f(yf(x)) = 1 + f(x+y)\n\\]\nfor all $x,y > 0$.\n\\end{itemize}\n\n\\end{document}", "solution": "The only such functions are the functions $f(x) = \\frac{1}{1+cx}$\nfor some $c \\geq 0$ (the case $c=0$ giving the constant function $f(x) = 1$). \nNote that we interpret $\\mathbb{R}^+$ in the problem statement to mean the set of positive real numbers, excluding 0.\n\nFor convenience, we reproduce here the given equation:\n\\begin{equation} \\label{eq:B61}\nf(xf(y)) + f(yf(x)) = 1 + f(x+y)\n\\end{equation}\n\nWe first prove that\n\\begin{equation} \\label{eq:B62}\n\\lim_{x \\to 0^+} f(x) = 1.\n\\end{equation}\nSet\n\\[\nL_- = \\liminf_{x \\to 0^+} f(x),\n\\quad\nL_+ = \\limsup_{x \\to 0^+} f(x).\n\\]\nFor any fixed $y$, we have by \\eqref{eq:B61}\n\\begin{align*}\nL_+ &= \\limsup_{x \\to 0^+} f(xf(y)) \\\\\n&\\leq \\limsup_{x \\to0^+} (1+f(x+y))\n= 1+f(y) < \\infty.\n\\end{align*}\nConsequently, $xf(x) \\to 0$ as $x \\to 0^+$.\nBy \\eqref{eq:B62} with $y=x$,\n\\begin{align*}\n2L_+ &= \\limsup_{x \\to 0^+} 2f(xf(x)) \\\\\n&= \\limsup_{x \\to 0^+} (1 + f(2x)) = 1 + L_+ \\\\\n2L_- &= \\liminf_{x \\to 0^+} 2f(xf(x)) \\\\\n&= \\liminf_{x \\to 0^+} (1 + f(2x)) = 1 + L_-\n\\end{align*}\nand so $L_- = L_+ = 1$, confirming \\eqref{eq:B62}.\n\nWe next confirm that\n\\begin{equation} \\label{eq:B63}\nf(x) \\geq 1 \\mbox{ for all } x>0 \\Longrightarrow f(x) = 1 \\mbox{ for all } x>0.\n\\end{equation}\nSuppose that $f(x) \\geq 1$ for all $x > 0$.\nFor $0 < c \\leq \\infty$, put $S_c = \\sup\\{f(x): 0 < x \\leq c\\}$;\nfor $c < \\infty$, \\eqref{eq:B62} implies that $S_c < \\infty$.\nIf there exists $y>0$ with $f(y) > 1$, then from \\eqref{eq:B61} we have $f(x+y) - f(xf(y)) = f(yf(x)) - 1 \\geq 0$;\nhence\n\\[\nS_c = S_{(c-y)f(y)} \\qquad \\left(c \\geq c_0 = \\frac{yf(y)}{f(y)-1}\\right)\n\\]\nand (since $(c-y)f(y) - c_0 = f(y)(c-c_0)$) iterating this construction shows that $S_\\infty = S_c$ for any $c > c_0$.\nIn any case, we deduce that \n\\begin{equation} \\label{eq:B64}\nf(x) \\geq 1 \\mbox{ for all } x>0 \\Longrightarrow S_\\infty < \\infty.\n\\end{equation}\nStill assuming that $f(x) \\geq 1$ for all $x>0$,\nnote that from \\eqref{eq:B61} with $x=y$,\n\\[\nf(xf(x)) = \\frac{1}{2}(1 + f(2x)).\n\\]\nSince $xf(x) \\to 0$ as $x \\to 0^+$ by \\eqref{eq:B62} and $xf(x) \\to \\infty$ as $x \\to \\infty$, $xf(x)$ takes all positive real values by the intermediate value theorem. We deduce that $2S_\\infty \\leq 1 + S_\\infty$ and hence $S_\\infty = 1$; \nthis proves \\eqref{eq:B63}.\n\nWe may thus assume hereafter that $f(x) < 1$ for some $x > 0$.\nWe next check that\n\\begin{equation} \\label{eq:B65}\n\\lim_{x \\to \\infty} f(x) = 0.\n\\end{equation}\nPut $I = \\inf\\{f(x): x > 0\\} < 1$, choose $\\epsilon \\in (0, (1-I)/2)$, and choose $y>0$ such that $f(y) < I+\\epsilon$. We then must have $xf(x) \\neq y$ for all $x$, or else\n\\[\n1 + I \\leq 1 + f(2x) = 2f(y) < 2I + 2\\epsilon,\n\\]\ncontradiction. Since $xf(x) \\to 0$ as $x \\to 0^+$ by \\eqref{eq:B62}, we have $\\sup\\{xf(x): x > 0\\} < \\infty$ by the intermediate value theorem, yielding \\eqref{eq:B65}.\n\nBy \\eqref{eq:B62} plus \\eqref{eq:B65},\n$f^{-1}(1/2)$ is nonempty and compact.\nWe can now simplify by noting that if $f(x)$ satisfies the original equation, then so does $f(cx)$ for any $c>0$; we may thus assume\nthat the least element of $f^{-1}(1/2)$ is 1,\nin which case we must show that $f(x) = \\frac{1}{1+x}$.\n\nWe next show that\n\\begin{equation}  \\label{eq:B68}\n\\lim_{x \\to \\infty} xf(x) = 1.\n\\end{equation}\nFor all $x > 0$,\nby \\eqref{eq:B61} with $y=x$,\n\\begin{equation} \\label{eq:B68a}\nf(xf(x)) = \\frac{1}{2}(1 + f(2x)) > \\frac{1}{2} = f(1),\n\\end{equation}\nso in particular $xf(x) \\neq 1$.\nAs in the proof of \\eqref{eq:B65}, this implies that $xf(x) < 1$ for all $x > 0$.\nHowever, by \\eqref{eq:B65} and \\eqref{eq:B68a}\nwe have $f(xf(x)) \\to \\frac{1}{2}$ as $x \\to \\infty$,\nyielding \\eqref{eq:B68}.\n\nBy substituting $y \\mapsto xy$ in \\eqref{eq:B61},\n\\[\nf(xf(xy)) + f(xyf(x)) = 1 + f(x+xy).\n\\]\nTaking the limit as $x \\to \\infty$ and applying \\eqref{eq:B68} yields\n\\begin{equation} \\label{eq:B69}\nf(1/y) + f(y) = 1.\n\\end{equation}\nCombining  \\eqref{eq:B61} with \\eqref{eq:B69} yields\n\\[\nf(xf(y))=f(x+y)+f \\left( \\frac{1}{yf(x)} \\right).\n\\]\nMultiply both sides by $xf(y)$, then take the limit as $x \\to \\infty$ to obtain\n\\begin{align*}\n1 &= \\lim_{x \\to \\infty} xf(y) f(x+y) + \\lim_{x \\to \\infty} xf(y) \nf\\left( \\frac{1}{yf(x)} \\right) \\\\\n&= f(y) + \\lim_{x \\to \\infty} xf(y) yf(x) \\\\\n&= f(y) + yf(y)\n\\end{align*}\nand solving for $f(y)$ now yields $f(y) = \\frac{1}{1+y}$, as desired.\n\n\\noindent\n\\textbf{Remark.}\nSome variants of the above approach are possible. For example,\nonce we have \\eqref{eq:B65}, we can establish that $f$ is monotone decreasing as follows. We first check that\n\\begin{equation} \\label{eq:B66}\nf(x) < 1 \\mbox{ for all } x > 0.\n\\end{equation}\nSuppose by way of contradiction that $f(x) = 1$ for some $x$.\nBy \\eqref{eq:B61},\n\\[\nf(2x) + 1 = 2f(xf(x)) = 2f(x) = 2\n\\]\nand so $f(2x) = 1$. It follows that $f^{-1}(1)$ is infinite, contradicting \\eqref{eq:B65}.\n\n\nWe next check that\n\\begin{equation} \\label{eq:B67}\nx<y \\Longrightarrow f(x) > f(y).\n\\end{equation}\nFor $x < y$, by substituting $x \\mapsto y-x$ in \\eqref{eq:B61} we obtain\n\\begin{align*}\n1+f(y) &= f(xf(y-x)) + f((y-x)f(x)) \\\\\n&< 1 + f((y-x)f(x)),\n\\end{align*}\nwhence $f((y-x)f(x))> f(y)$. Because $(y-x)f(x) \\to 0$ as $x \\to y^-$ and $(y-x)f(x) \\to y$ as $x \\to 0^+$, $(y-x)f(x)$ takes all values in $(0,y)$ as $x$ varies over $(0,y)$; this proves \\eqref{eq:B67}.\n\n\n\\end{itemize}\n\\end{document}", "source_problems": "PUTNAM-2022-problems.tex", "source_solutions": "PUTNAM-2022-solutions.tex", "notes": ""}
{"id": "PUTNAM-2023-A1", "contest": "PUTNAM", "year": "2023", "problem_number": "A1", "problem": "For a positive integer $n$, let $f_n(x) = \\cos(x) \\cos(2x) \\cos(3x) \\cdots \\cos(nx)$. Find the smallest $n$ such that $|f_n''(0)| > 2023$.", "solution": "If we use the product rule to calculate $f_n''(x)$, the result is a sum of terms of two types: terms where two distinct factors $\\cos(m_1x)$ and $\\cos(m_2x)$ have each been differentiated once, and terms where a single factor $\\cos(mx)$ has been differentiated twice. When we evaluate at $x=0$, all terms of the first type vanish since $\\sin(0)=0$, while the term of the second type involving $(\\cos(mx))''$ becomes $-m^2$. Thus \n\\[\n|f_n''(0)| = \\left|-\\sum_{m=1}^n m^2\\right| = \\frac{n(n+1)(2n+1)}{6}.\n\\]\nThe function $g(n) = \\frac{n(n+1)(2n+1)}{6}$ is increasing for $n\\in\\mathbb{N}$ and satisfies $g(17)=1785$ and $g(18)=2109$. It follows that the answer is $n=18$.", "source_problems": "PUTNAM-2023-problems.tex", "source_solutions": "PUTNAM-2023-solutions.tex", "notes": ""}
{"id": "PUTNAM-2023-A2", "contest": "PUTNAM", "year": "2023", "problem_number": "A2", "problem": "Let $n$ be an even positive integer. Let $p$ be a monic, real polynomial of degree $2n$; that is to say, $p(x) = x^{2n} + a_{2n-1} x^{2n-1} + \\cdots + a_1 x + a_0$ for some real coefficients $a_0, \\dots, a_{2n-1}$. Suppose that $p(1/k) = k^2$ for all integers $k$ such that $1 \\leq |k| \\leq n$. Find all other real numbers $x$ for which $p(1/x) = x^2$.", "solution": "The only other real numbers with this property are $\\pm 1/n!$.\n(Note that these are indeed \\emph{other} values than $\\pm 1, \\dots, \\pm n$ because $n>1$.)\n\nDefine the polynomial $q(x) = x^{2n+2}-x^{2n}p(1/x) = x^{2n+2}-(a_0x^{2n}+\\cdots+a_{2n-1}x+1)$. The statement that $p(1/x)=x^2$ is equivalent (for $x\\neq 0$) to the statement that $x$ is a root of $q(x)$. Thus we know that $\\pm 1,\\pm 2,\\ldots,\\pm n$ are roots of $q(x)$, and we can write\n\\[\nq(x) = (x^2+ax+b)(x^2-1)(x^2-4)\\cdots (x^2-n^2)\n\\]\nfor some monic quadratic polynomial $x^2+ax+b$. Equating the coefficients of $x^{2n+1}$ and $x^0$ on both sides gives $0=a$ and $-1=(-1)^n(n!)^2 b$, respectively. Since $n$ is even, we have $x^2+ax+b = x^2-(n!)^{-2}$. We conclude that there are precisely two other real numbers $x$ such that $p(1/x)=x^2$, and they are $\\pm 1/n!$.", "source_problems": "PUTNAM-2023-problems.tex", "source_solutions": "PUTNAM-2023-solutions.tex", "notes": ""}
{"id": "PUTNAM-2023-A3", "contest": "PUTNAM", "year": "2023", "problem_number": "A3", "problem": "Determine the smallest positive real number $r$ such that there exist differentiable functions $f\\colon \\mathbb{R} \\to \\mathbb{R}$ and\n$g\\colon \\mathbb{R} \\to \\mathbb{R}$ satisfying\n\\begin{enumerate}\n\\item[(a)] $f(0) > 0$,\n\\item[(b)] $g(0) = 0$,\n\\item[(c)] $|f'(x)| \\leq |g(x)|$ for all $x$,\n\\item[(d)] $|g'(x)| \\leq |f(x)|$ for all $x$, and\n\\item[(e)] $f(r) = 0$.\n\\end{enumerate}", "solution": "The answer is $r=\\frac{\\pi}{2}$, which manifestly is achieved by setting $f(x)=\\cos x$ and $g(x)=\\sin x$.\n\n\\noindent\n\\textbf{First solution.}\nSuppose by way of contradiction that there exist some $f,g$ satisfying the stated conditions for some $0 < r<\\frac{\\pi}{2}$. We first note that we can assume that $f(x) \\neq 0$ for $x\\in [0,r)$. Indeed, by continuity, $\\{x\\,|\\,x\\geq 0 \\text{ and } f(x)=0\\}$ is a closed subset of $[0,\\infty)$ and thus has a minimum element $r'$ with $0<r'\\leq r$. After replacing $r$ by $r'$, we now have $f(x)\\neq 0$ for $x\\in [0,r)$.\n\nNext we note that $f(r)=0$ implies $g(r) \\neq 0$. Indeed, define the function $k :\\thinspace \\mathbb{R} \\to \\mathbb{R}$ by $k(x) = f(x)^2+g(x)^2$. Then $|k'(x)| = 2|f(x)f'(x)+g(x)g'(x))| \\leq 4|f(x)g(x)| \\leq 2k(x)$, where the last inequality follows from the AM-GM inequality. It follows that $\\left|\\frac{d}{dx} (\\log k(x))\\right| \\leq 2$ for $x \\in [0,r)$; since $k(x)$ is continuous at $x=r$, we conclude that $k(r) \\neq 0$.\n\nNow define the function $h\\colon [0,r) \\to (-\\pi/2,\\pi/2)$ by $h(x) = \\tan^{-1}(g(x)/f(x))$. We compute that\n\\[\nh'(x) = \\frac{f(x)g'(x)-g(x)f'(x)}{f(x)^2+g(x)^2}\n\\]\nand thus\n\\[\n|h'(x)| \\leq \\frac{|f(x)||g'(x)|+|g(x)||f'(x)|}{f(x)^2+g(x)^2} \\leq \\frac{|f(x)|^2+|g(x)|^2}{f(x)^2+g(x)^2} = 1.\n\\]\nSince $h(0) = 0$, we have $|h(x)| \\leq x<r$ for all $x\\in [0,r)$. Since $r<\\pi/2$ and $\\tan^{-1}$ is increasing on $(-r,r)$, we conclude that $|g(x)/f(x)|$ is uniformly bounded above by $\\tan r$ for all $x\\in [0,r)$. But this contradicts the fact that $f(r)=0$ and $g(r) \\neq 0$, since $\\lim_{x\\to r^-} g(x)/f(x) = \\infty$. This contradiction shows that $r<\\pi/2$ cannot be achieved.\n\n\\noindent\n\\textbf{Second solution.}\n(by Victor Lie)\nAs in the first solution, we may assume $f(x) > 0$ \nfor $x \\in [0,r)$.\nCombining our hypothesis with the fundamental theorem of calculus, for $x > 0$ we obtain\n\\begin{align*}\n|f'(x)| &\\leq |g(x)| \\leq \\left| \\int_0^x g'(t)\\,dt \\right|  \\\\\n& \\leq \\int_0^x |g'(t)| \\,dt \\leq \\int_0^x |f(t)|\\,dt.\n\\end{align*}\nDefine $F(x) = \\int_0^x f(t)\\,dt$; we then have\n\\[\nf'(x) + F(x) \\geq 0 \\qquad (x \\in [0,r]).\n\\]\nNow suppose by way of contradiction that $r < \\frac{\\pi}{2}$.\nThen $\\cos x > 0$ for $x \\in [0,r]$, so \n\\[\nf'(x) \\cos x + F(x) \\cos x \\geq 0 \\qquad (x \\in [0,r]).\n\\]\nThe left-hand side is the derivative of $f(x) \\cos x + F(x) \\sin x $. Integrating from $x=y$ to $x=r$, we obtain\n\\[\nF(r) \\sin r \\geq f(y) \\cos y + F(y) \\sin y \\qquad (y \\in [0,r]).\n\\]\nWe may rearrange to obtain\n\\[\nF(r)\\sin r \\sec^2 y \\geq f(y) \\sec y + F(y) \\sin y \\sec^2 y \\quad (y \\in [0,r]).\n\\]\nThe two sides are the derivatives of $F(r) \\sin r \\tan y$ and $F(y) \\sec y$, respectively.\nIntegrating from $y=0$ to $y=r$ and multiplying by $\\cos^2 r$, we obtain\n\\[\nF(r) \\sin^2 r \\geq F(r)\n\\]\nwhich is impossible because $F(r) > 0$ and $0 < \\sin r < 1$.", "source_problems": "PUTNAM-2023-problems.tex", "source_solutions": "PUTNAM-2023-solutions.tex", "notes": ""}
{"id": "PUTNAM-2023-A4", "contest": "PUTNAM", "year": "2023", "problem_number": "A4", "problem": "Let $v_1, \\dots, v_{12}$ be unit vectors in $\\mathbb{R}^3$ from the origin to the vertices of a regular icosahedron. Show that for every vector $v \\in \\mathbb{R}^3$ and every $\\varepsilon > 0$, there exist integers $a_1,\\dots,a_{12}$ such that $\\| a_1 v_1 + \\cdots + a_{12} v_{12} - v \\| < \\varepsilon$.", "solution": "The assumption that all vertices of the icosahedron correspond to vectors of the same length forces the center of the icosahedron to lie at the origin, since the icosahedron is inscribed in a unique sphere.\nSince scaling the icosahedron does not change whether or not the stated conclusion is true, we may choose coordinates so that the vertices are the cyclic permutations of the vectors $(\\pm \\frac{1}{2}, \\pm \\frac{1}{2} \\phi, 0)$ where\n$\\phi = \\frac{1+\\sqrt{5}}{2}$ is the golden ratio. The subgroup of $\\RR^3$ generated by these vectors contains $G \\times G \\times G$ where $G$ is the subgroup of $\\RR$ generated by 1 and $\\phi$. Since $\\phi$ is irrational, it generates a dense subgroup of $\\RR/\\ZZ$; hence $G$ is dense in $\\RR$, and so $G \\times G \\times G$ is dense in $\\RR^3$,\nproving the claim.", "source_problems": "PUTNAM-2023-problems.tex", "source_solutions": "PUTNAM-2023-solutions.tex", "notes": ""}
{"id": "PUTNAM-2023-A5", "contest": "PUTNAM", "year": "2023", "problem_number": "A5", "problem": "For a nonnegative integer $k$, let $f(k)$ be the number of ones in the base 3 representation of $k$. Find all complex numbers $z$ such that\n\\[\n\\sum_{k=0}^{3^{1010}-1} (-2)^{f(k)} (z+k)^{2023} = 0.\n\\]", "solution": "The complex numbers $z$ with this property are\n\\[\n-\\frac{3^{1010}-1}{2} \\text{ and } -\\frac{3^{1010}-1}{2}\\pm\\frac{\\sqrt{9^{1010}-1}}{4}\\,i.\n\\]\n\nWe begin by noting that for $n \\geq 1$, we have the following equality of polynomials in a parameter $x$:\n\\[\n\\sum_{k=0}^{3^n-1} (-2)^{f(k)} x^k = \\prod_{j=0}^{n-1} (x^{2\\cdot 3^j}-2x^{3^j}+1).\n\\]\nThis is readily shown by induction on $n$, using the fact that for $0\\leq k\\leq 3^{n-1}-1$, $f(3^{n-1}+k)=f(k)+1$ and $f(2\\cdot 3^{n-1}+k)=f(k)$.\n\nNow define a ``shift'' operator $S$ on polynomials in $z$ by $S(p(z))=p(z+1)$; then we can define $S^m$ for all $m\\in\\mathbb{Z}$ by $S^m(p(z))$, and in particular $S^0=I$ is the identity map. Write\n\\[\np_n(z) := \\sum_{k=0}^{3^n-1}(-2)^{f(k)}(z+k)^{2n+3}\n\\]\nfor $n \\geq 1$; it follows that \n\\begin{align*}\np_n(z) &= \\prod_{j=0}^{n-1}(S^{2\\cdot 3^j}-2S^{3^j}+I) z^{2n+3}\n\\\\\n&= S^{(3^n-1)/2} \\prod_{j=0}^{n-1}(S^{3^j}-2I+S^{-3^j}) z^{2n+3}.\n\\end{align*}\nNext observe that for any $\\ell$, the operator $S^\\ell-2I+S^{-\\ell}$ acts on polynomials in $z$ in a way that decreases degree by $2$. More precisely, for $m\\geq 0$, we have\n\\begin{align*}\n(S^\\ell-2I+S^{-\\ell})z^m &= (z+\\ell)^m-2z^m+(z-\\ell)^m \\\\\n&= 2{m\\choose 2}\\ell^2z^{m-2}+2{m\\choose 4}\\ell^4z^{m-4}+O(z^{m-6}).\n\\end{align*}\nWe use this general calculation to establish the following: for any $1\\leq i\\leq n$, there is a nonzero constant $C_i$ (depending on $n$ and $i$ but not $z$) such that\n\\begin{gather}\n\\nonumber\n\\prod_{j=1}^{i} (S^{3^{n-j}}-2I+S^{-3^{n-j}}) z^{2n+3} \\\\\n\\nonumber\n= C_i\\left(z^{2n+3-2i}+\\textstyle{\\frac{(2n+3-2i)(n+1-i)}{6}}(\\sum_{j=1}^i 9^{n-j})z^{2n+1-2i}\\right) \\\\\n+O(z^{2n-1-2i}).\n\\label{eq:product}\n\\end{gather}\nProving \\eqref{eq:product} is a straightforward induction on $i$: the induction step applies $S^{3^{n-i-1}}-2I+S^{-3^{n-i-1}}$ to the right hand side of \\eqref{eq:product}, using the general formula for $(S^\\ell-2I+S^{-\\ell})z^m$.\n\nNow setting $i=n$ in \\eqref{eq:product}, we find that for some $C_n$,\n\\[\n\\prod_{j=0}^{n-1}(S^{3^j}-2I+S^{-3^j}) z^{2n+3} = C_n\\left(z^3+\\frac{9^n-1}{16}z\\right).\n\\]\nThe roots of this polynomial are $0$ and $\\pm \\frac{\\sqrt{9^n-1}}{4} i$, and it follows that the roots of $p_n(z)$ are these three numbers minus $\\frac{3^n-1}{2}$. In particular, when $n=1010$, we find that the roots of $p_{1010}(z)$ are as indicated above.", "source_problems": "PUTNAM-2023-problems.tex", "source_solutions": "PUTNAM-2023-solutions.tex", "notes": ""}
{"id": "PUTNAM-2023-A6", "contest": "PUTNAM", "year": "2023", "problem_number": "A6", "problem": "Alice and Bob play a game in which they take turns choosing integers from $1$ to $n$. Before any integers are chosen, Bob selects a goal of ``odd'' or ``even''. On the first turn, Alice chooses one of the $n$ integers. On the second turn, Bob chooses one of the remaining integers. They continue alternately choosing one of the integers that has not yet been chosen, until the $n$th turn, which is forced and ends the game. Bob wins if the parity of $\\{k\\colon \\mbox{the number $k$ was chosen on the $k$th turn}\\}$ matches his goal. For which values of $n$ does Bob have a winning strategy?", "solution": "(Communicated by Kai Wang)\nFor all $n$, Bob has a winning strategy. Note that we can interpret the game play as building a permutation of $\\{1,\\dots,n\\}$, and the number of times an integer $k$ is chosen on the $k$-th turn is exactly the number of fixed points of this permutation.\n\nFor $n$ even, Bob selects the goal ``even''. Divide $\\{1,\\dots,n\\}$ into the pairs $\\{1,2\\},\\{3,4\\},\\dots$; each time Alice chooses an integer, Bob follows suit with the other integer in the same pair. For each pair $\\{2k-1,2k\\}$, we see that $2k-1$ is a fixed point if and only if $2k$ is, so the number of fixed points is even.\n\nFor $n$ odd, Bob selects the goal ``odd''. On the first turn, if Alice chooses 1 or 2, then Bob chooses the other one to transpose into the strategy for $n-2$ (with no moves made). We may thus assume hereafter that Alice's first move is some $k > 2$, which Bob counters with 2; at this point there is exactly one fixed point. \n\nThereafter, as long as Alice chooses $j$ on the $j$-th turn (for $j \\geq 3$ odd), either $j+1 < k$, in which case Bob can choose $j+1$\nto keep the number of fixed points odd; or $j+1=k$, in which case $k$ is even and Bob can choose 1 to transpose into the strategy for  $n-k$ (with no moves made).\n\nOtherwise, at some odd turn $j$, Alice does not choose $j$. At this point, the number of fixed points is odd, and on each subsequent turn Bob can ensure that neither his own move nor Alice's next move does not create a fixed point: on any turn $j$ for Bob, if $j+1$ is available Bob chooses it; otherwise, Bob has at least two choices available, so he can choose a value other than $j$.", "source_problems": "PUTNAM-2023-problems.tex", "source_solutions": "PUTNAM-2023-solutions.tex", "notes": ""}
{"id": "PUTNAM-2023-B1", "contest": "PUTNAM", "year": "2023", "problem_number": "B1", "problem": "Consider an $m$-by-$n$ grid of unit squares, indexed by $(i,j)$ with $1 \\leq i \\leq m$ and $1 \\leq j \\leq n$. There are $(m-1)(n-1)$ coins, which are initially placed in the squares $(i,j)$ with $1 \\leq i \\leq m-1$ and $1 \\leq j \\leq n-1$. If a coin occupies the square $(i,j)$ with $i \\leq m-1$ and $j \\leq n-1$ and the squares $(i+1,j), (i,j+1)$, and $(i+1,j+1)$ are unoccupied, then a legal move is to slide the coin from $(i,j)$ to $(i+1,j+1)$. How many distinct configurations of coins can be reached starting from the initial configuration by a (possibly empty) sequence of legal moves?", "solution": "The number of such configurations is $\\binom{m+n-2}{m-1}$.\n\nInitially the unoccupied squares form a path from $(1,n)$ to $(m,1)$ consisting of $m-1$ horizontal steps and $n-1$ vertical steps,\nand every move preserves this property. This yields an injective map from the set of reachable configurations to the set of paths of this form.\n\nSince the number of such paths is evidently $\\binom{m+n-2}{m-1}$ (as one can arrange the horizontal and vertical steps in any order),\nit will suffice to show that the map we just wrote down is also surjective; that is, that one can reach any path of this form by a sequence of moves. \n\nThis is easiest to see by working backwards. Ending at a given path, if this path is not the initial path, then it contains at least one sequence of squares of the form $(i,j) \\to (i,j-1) \\to (i+1,j-1)$.\nIn this case the square $(i+1,j)$ must be occupied, so we can undo a move by replacing this sequence with \n$(i,j) \\to (i+1,j) \\to (i+1,j-1)$.", "source_problems": "PUTNAM-2023-problems.tex", "source_solutions": "PUTNAM-2023-solutions.tex", "notes": ""}
{"id": "PUTNAM-2023-B2", "contest": "PUTNAM", "year": "2023", "problem_number": "B2", "problem": "For each positive integer $n$, let $k(n)$ be the number of ones in the binary representation of $2023 \\cdot n$. What is the minimum value of $k(n)$?", "solution": "The minimum is $3$. \n\n\\noindent\n\\textbf{First solution.}\n\nWe record the factorization $2023 = 7\\cdot 17^2$. We first rule out $k(n)=1$ and $k(n)=2$. If $k(n)=1$, then $2023n = 2^a$ for some $a$, which clearly cannot happen. If $k(n)=2$, then $2023n=2^a+2^b=2^b(1+2^{a-b})$ for some $a>b$. Then $1+2^{a-b} \\equiv 0\\pmod{7}$; but $-1$ is not a power of $2$ mod $7$ since every power of $2$ is congruent to either $1$, $2$, or $4 \\pmod{7}$.\n\nWe now show that there is an $n$ such that $k(n)=3$. It suffices to find $a>b>0$ such that $2023$ divides $2^a+2^b+1$. First note that $2^2+2^1+1=7$ and $2^3 \\equiv 1 \\pmod{7}$; thus if $a \\equiv 2\\pmod{3}$ and $b\\equiv 1\\pmod{3}$ then $7$ divides $2^a+2^b+1$. Next, $2^8+2^5+1 = 17^2$ and $2^{16\\cdot 17} \\equiv 1 \\pmod{17^2}$ by Euler's Theorem; thus if $a \\equiv 8 \\pmod{16\\cdot 17}$ and $b\\equiv 5 \\pmod{16\\cdot 17}$ then $17^2$ divides $2^a+2^b+1$.\n\nWe have reduced the problem to finding $a,b$ such that $a\\equiv 2\\pmod{3}$, $a\\equiv 8\\pmod{16\\cdot 17}$, $b\\equiv 1\\pmod{3}$, $b\\equiv 5\\pmod{16\\cdot 17}$. But by the Chinese Remainder Theorem, integers $a$ and $b$ solving these equations exist and are unique mod $3\\cdot 16\\cdot 17$. Thus we can find $a,b$ satisfying these congruences; by adding appropriate multiples of $3\\cdot 16\\cdot 17$, we can also ensure that $a>b>1$.\n\n\\noindent\n\\textbf{Second solution.}\nWe rule out $k(n) \\leq 2$ as in the first solution.\nTo force $k(n) = 3$, we first note that $2^4 \\equiv -1 \\pmod{17}$\nand deduce that $2^{68} \\equiv -1 \\pmod{17^2}$.\n(By writing $2^{68} = ((2^4+1) - 1)^{17}$ and expanding the binomial, we obtain $-1$ plus some terms each of which is divisible by 17.) Since $(2^8-1)^2$ is divisible by $17^2$,\n\\begin{align*}\n0 &\\equiv 2^{16} - 2\\cdot 2^8 + 1 \\equiv 2^{16} + 2\\cdot 2^{68}\\cdot 2^8 + 1 \\\\\n&= 2^{77} + 2^{16} + 1 \\pmod{17^2}.\n\\end{align*}\nOn the other hand, since $2^3 \\equiv -1 \\pmod{7}$, \n\\[\n2^{77} + 2^{16} + 1 \\equiv 2^2 + 2^1 + 1 \\equiv 0 \\pmod{7}.\n\\]\nHence $n = (2^{77}+2^{16}+1)/2023$ is an integer with $k(n) = 3$.\n\n\\noindent\n\\textbf{Remark.} \nA short computer calculation shows that the value of $n$ with $k(n)=3$ found in the second solution is the smallest possible.\nFor example, in SageMath, this reduces to a single command:\n\\begin{verbatim}\nassert all((2^a+2^b+1) % 2023 != 0\n    for a in range(1,77) for b in range(1,a))\n\\end{verbatim}", "source_problems": "PUTNAM-2023-problems.tex", "source_solutions": "PUTNAM-2023-solutions.tex", "notes": ""}
{"id": "PUTNAM-2023-B3", "contest": "PUTNAM", "year": "2023", "problem_number": "B3", "problem": "A sequence $y_1,y_2,\\dots,y_k$ of real numbers is called \\emph{zigzag} if $k=1$, or if $y_2-y_1, y_3-y_2, \\dots, y_k-y_{k-1}$ are nonzero and alternate in sign. Let $X_1,X_2,\\dots,X_n$ be chosen independently from the uniform distribution on $[0,1]$. Let $a(X_1,X_2,\\dots,X_n)$ be the largest value of $k$ for which there exists an increasing sequence of integers $i_1,i_2,\\dots,i_k$ such that $X_{i_1},X_{i_2},\\dots,X_{i_k}$ is zigzag. Find the expected value of $a(X_1,X_2,\\dots,X_n)$ for $n \\geq 2$.", "solution": "The expected value is $\\frac{2n+2}{3}$.\n\nDivide the sequence $X_1,\\dots,X_n$ into alternating increasing and decreasing segments, with $N$ segments in all. Note that removing one term cannot increase $N$: if the removed term is interior to some segment then the number remains unchanged, whereas if it separates two segments then one of those decreases in length by 1 (and possibly disappears). From this it follows that $a(X_1,\\dots,X_n) = N+1$: in one direction, the endpoints of the segments form a zigzag of length $N+1$; in the other, for any zigzag $X_{i_1},\\dots, X_{i_m}$, we can view it as a sequence obtained from $X_1,\\dots,X_n$ by removing terms, so its number of segments (which is manifestly $m-1$) cannot exceed $N$.\n\nFor $n \\geq 3$, $a(X_1,\\dots,X_n) - a(X_2,\\dots,X_{n})$\nis 0 if $X_1, X_2, X_3$ form a monotone sequence and 1 otherwise. Since the six possible orderings of $X_1,X_2,X_3$ are equally likely,\n\\[\n\\mathbf{E}(a(X_1,\\dots,X_n) - a(X_1,\\dots,X_{n-1})) = \\frac{2}{3}.\n\\]\nMoreover, we always have $a(X_1, X_2) = 2$ because any sequence of two distinct elements is a zigzag. By linearity of expectation plus induction on $n$, we obtain $\\mathbf{E}(a(X_1,\\dots,X_n)) = \\frac{2n+2}{3}$ as claimed.", "source_problems": "PUTNAM-2023-problems.tex", "source_solutions": "PUTNAM-2023-solutions.tex", "notes": ""}
{"id": "PUTNAM-2023-B4", "contest": "PUTNAM", "year": "2023", "problem_number": "B4", "problem": "For a nonnegative integer $n$ and a strictly increasing sequence of real numbers $t_0,t_1,\\dots,t_n$, let $f(t)$ be the corresponding real-valued function defined for $t \\geq t_0$ by the following properties:\n\\begin{enumerate}\n\\item[(a)] $f(t)$ is continuous for $t \\geq t_0$, and is twice differentiable for all $t>t_0$ other than $t_1,\\dots,t_n$;\n\\item[(b)] $f(t_0) = 1/2$;\n\\item[(c)] $\\lim_{t \\to t_k^+} f'(t) = 0$ for $0 \\leq k \\leq n$;\n\\item[(d)] For $0 \\leq k \\leq n-1$, we have $f''(t) = k+1$ when $t_k < t< t_{k+1}$, and $f''(t) = n+1$ when $t>t_n$.\n\\end{enumerate}\nConsidering all choices of $n$ and $t_0,t_1,\\dots,t_n$ such that $t_k \\geq t_{k-1}+1$ for $1 \\leq k \\leq n$, what is the least possible value of $T$ for which $f(t_0+T) = 2023$?", "solution": "The minimum value of $T$ is 29.\n\nWrite $t_{n+1} = t_0+T$ and define $s_k = t_k-t_{k-1}$ for $1\\leq k\\leq n+1$. On $[t_{k-1},t_k]$, we have $f'(t) = k(t-t_{k-1})$ and so $f(t_k)-f(t_{k-1}) = \\frac{k}{2} s_k^2$. Thus if we define\n\\[\ng(s_1,\\ldots,s_{n+1}) = \\sum_{k=1}^{n+1} ks_k^2,\n\\]\nthen we want to minimize $\\sum_{k=1}^{n+1} s_k = T$ (for all possible values of $n$) subject to the constraints that $g(s_1,\\ldots,s_{n+1}) = 4045$ and $s_k \\geq 1$ for $k \\leq n$.\n\nWe first note that a minimum value for $T$ is indeed achieved. To see this, note that the constraints $g(s_1,\\ldots,s_{n+1}) = 4045$ and $s_k \\geq 1$ place an upper bound on $n$. For fixed $n$, the constraint $g(s_1,\\ldots,s_{n+1}) = 4045$ places an upper bound on each $s_k$, whence the set of $(s_1,\\ldots,s_{n+1})$ on which we want to minimize $\\sum s_k$ is a compact subset of $\\mathbb{R}^{n+1}$.\n\nNow say that $T_0$ is the minimum value of $\\sum_{k=1}^{n+1} s_k$ (over all $n$ and $s_1,\\ldots,s_{n+1}$), achieved by $(s_1,\\ldots,s_{n+1}) = (s_1^0,\\ldots,s_{n+1}^0)$. Observe that there cannot be another $(s_1,\\ldots,s_{n'+1})$ with the same sum, $\\sum_{k=1}^{n'+1} s_k = T_0$, satisfying $g(s_1,\\ldots,s_{n'+1}) > 4045$; otherwise, the function $f$ for $(s_1,\\ldots,s_{n'+1})$ would satisfy $f(t_0+T_0) > 4045$ and there would be some $T<T_0$ such that $f(t_0+T) = 4045$ by the intermediate value theorem.\n\nWe claim that $s_{n+1}^0 \\geq 1$ and $s_k^0 = 1$ for $1\\leq k\\leq n$. If $s_{n+1}^0<1$ then\n\\begin{align*}\n& g(s_1^0,\\ldots,s_{n-1}^0,s_n^0+s_{n+1}^0)-g(s_1^0,\\ldots,s_{n-1}^0,s_n^0,s_{n+1}^0) \\\\\n&\\quad = s_{n+1}^0(2ns_n^0-s_{n+1}^0) > 0,\n\\end{align*}\ncontradicting our observation from the previous paragraph. Thus $s_{n+1}^0 \\geq 1$. If $s_k^0>1$ for some $1\\leq k\\leq n$ then replacing $(s_k^0,s_{n+1}^0)$ by $(1,s_{n+1}^0+s_k^0-1)$ increases $g$:\n\\begin{align*}\n&g(s_1^0,\\ldots,1,\\ldots,s_{n+1}^0+s_k^0-1)-g(s_1^0,\\ldots,s_k^0,\\ldots,s_{n+1}^0) \\\\\n&\\quad= (s_k^0-1)((n+1-k)(s_k^0+1)+2(n+1)(s_{n+1}^0-1)) > 0,\n\\end{align*}\nagain contradicting the observation. This establishes the claim.\n\nGiven that $s_k^0 = 1$ for $1 \\leq k \\leq n$, we have\n$T = s_{n+1}^0 + n$ and\n\\[\ng(s_1^0,\\dots,s_{n+1}^0) = \\frac{n(n+1)}{2} + (n+1)(T-n)^2.\n\\]\nSetting this equal to 4045 and solving for $T$ yields\n\\[\nT = n+\\sqrt{\\frac{4045}{n+1} - \\frac{n}{2}}.\n\\]\nFor $n=9$ this yields $T = 29$; it thus suffices to show that for all $n$, \n\\[\nn+\\sqrt{\\frac{4045}{n+1} - \\frac{n}{2}} \\geq 29.\n\\]\nThis is evident for $n \\geq 30$. For $n \\leq 29$, rewrite the claim as\n\\[\n\\sqrt{\\frac{4045}{n+1} - \\frac{n}{2}} \\geq 29-n;\n\\]\nwe then obtain an equivalent inequality by squaring both sides:\n\\[\n\\frac{4045}{n+1} - \\frac{n}{2} \\geq n^2-58n+841.\n\\]\nClearing denominators, gathering all terms to one side, and factoring puts this in the form\n\\[\n(9-n)(n^2 - \\frac{95}{2} n + 356) \\geq 0.\n\\]\nThe quadratic factor $Q(n)$ has a minimum at $\\frac{95}{4} = 23.75$\nand satisfies $Q(8) = 40, Q(10) = -19$; it is thus positive for $n \\leq 8$ and negative for $10 \\leq n \\leq 29$.", "source_problems": "PUTNAM-2023-problems.tex", "source_solutions": "PUTNAM-2023-solutions.tex", "notes": ""}
{"id": "PUTNAM-2023-B5", "contest": "PUTNAM", "year": "2023", "problem_number": "B5", "problem": "Determine which positive integers $n$ have the following property:\nFor all integers $m$ that are relatively prime to $n$, there exists a permutation $\\pi\\colon \\{1,2,\\dots,n\\} \\to \\{1,2,\\dots,n\\}$ such that $\\pi(\\pi(k)) \\equiv mk \\pmod{n}$ for all $k \\in \\{1,2,\\dots,n\\}$.", "solution": "The desired property holds if and only if $n = 1$ or $n \\equiv 2 \\pmod{4}$.\n\nLet $\\sigma_{n,m}$ be the permutation of $\\ZZ/n\\ZZ$ induced by multiplication by $m$; the original problem asks for which $n$ does $\\sigma_{n,m}$ always have a square root. For $n=1$, $\\sigma_{n,m}$ is the identity permutation and hence has a square root.\n\nWe next identify when a general permutation admits a square root.\n\n\\begin{lemma} \\label{lem:2023B5-2}\nA permutation $\\sigma$ in $S_n$ can be written as the square of another permutation if and only if for every even positive integer $m$, the number of cycles of length $m$ in $\\sigma$ is even.\n\\end{lemma}\n\\begin{proof}\nWe first check the ``only if'' direction. Suppose that $\\sigma = \\tau^2$. Then every cycle of $\\tau$ of length $m$ remains a cycle in $\\sigma$ if $m$ is odd, and splits into two cycles of length $m/2$ if $m$ is even.\n\nWe next check the ``if'' direction. We may partition the cycles of $\\sigma$ into individual cycles of odd length and pairs of cycles of the same even length; then we may argue as above to write each partition as the square of another permutation.\n\\end{proof}\n\nSuppose now that $n>1$ is odd. Write $n = p^e k$ where $p$ is an odd prime, $k$ is a positive integer, and $\\gcd(p,k) = 1$. \nBy the Chinese remainder theorem, we have a ring isomorphism \n\\[\n\\ZZ/n\\ZZ \\cong \\ZZ/p^e \\ZZ \\times \\ZZ/k \\ZZ.\n\\]\nRecall that the group $(\\ZZ/p^e \\ZZ)^\\times$ is cyclic; choose $m \\in \\ZZ$ reducing to a generator of $(\\ZZ/p^e \\ZZ)^\\times$ and to the identity in $(\\ZZ/k\\ZZ)^\\times$. Then $\\sigma_{n,m}$ consists of $k$ cycles (an odd number) of length $p^{e-1}(p-1)$ (an even number) plus some shorter cycles. By Lemma~\\ref{lem:2023B5-2}, $\\sigma_{n,m}$ does not have a square root.\n\nSuppose next that $n \\equiv 2 \\pmod{4}$. Write $n = 2k$ with $k$ odd, so that \n\\[\n\\ZZ/n\\ZZ \\cong \\ZZ/2\\ZZ \\times \\ZZ/k\\ZZ.\n\\]\nThen $\\sigma_{n,m}$ acts on $\\{0\\} \\times \\ZZ/k\\ZZ$ and $\\{1\\} \\times \\ZZ/k\\ZZ$ with the same cycle structure, so every cycle length occurs an even number of times. By Lemma~\\ref{lem:2023B5-2}, $\\sigma_{n,m}$ has a square root.\n\nFinally, suppose that $n$ is divisible by 4. For $m = -1$, $\\sigma_{n,m}$ consists of two fixed points ($0$ and $n/2$) together with $n/2-1$ cycles (an odd number) of length 2 (an even number). \nBy Lemma~\\ref{lem:2023B5-2}, $\\sigma_{n,m}$ does not have a square root.", "source_problems": "PUTNAM-2023-problems.tex", "source_solutions": "PUTNAM-2023-solutions.tex", "notes": ""}
{"id": "PUTNAM-2023-B6", "contest": "PUTNAM", "year": "2023", "problem_number": "B6", "problem": "Let $n$ be a positive integer. For $i$ and $j$ in $\\{1,2,\\dots,n\\}$, let $s(i,j)$ be the number of pairs $(a,b)$ of nonnegative integers satisfying $ai +bj=n$. Let $S$ be the $n$-by-$n$ matrix whose $(i,j)$ entry is $s(i,j)$. For example, when $n=5$, we have\n$S = \\begin{bmatrix} 6 & 3 & 2 & 2 & 2 \\\\\n3 & 0 & 1 & 0 & 1 \\\\\n2 & 1 & 0 & 0 & 1 \\\\\n2 & 0 & 0 & 0 & 1 \\\\\n2 & 1 & 1 & 1 & 2\n\\end{bmatrix}$. \nCompute the determinant of $S$.\n\n\\end{itemize}\n\n\\end{document}", "solution": "The determinant equals $(-1)^{\\lceil n/2 \\rceil-1} 2 \\lceil \\frac{n}{2} \\rceil$.\n\nTo begin with, we read off the following features of $S$.\n\\begin{itemize}\n\\item\n$S$ is symmetric: $S_{ij} = S_{ji}$ for all $i,j$, corresponding to $(a,b) \\mapsto (b,a)$).\n\\item\n$S_{11} = n+1$, corresponding to $(a,b) = (0,n),(1,n-1),\\dots,(n,0)$.\n\\item\nIf $n = 2m$ is even, then $S_{mj} = 3$ for $j=1,m$, corresponding to $(a,b) = (2,0),(1,\\frac{n}{2j}),(0,\\frac{n}{j})$.\n\\item\nFor $\\frac{n}{2} < i \\leq n$, $S_{ij} = \\# (\\ZZ \\cap \\{\\frac{n-i}{j}, \\frac{n}{j}\\})$, corresponding to $(a,b) = (1, \\frac{n-i}{j}), (0, \\frac{n}{j})$.\n\\end{itemize}\n\nLet $T$ be the matrix obtained from $S$ by performing row and column operations as follows: for $d=2,\\dots,n-2$, \nsubtract $S_{nd}$ times row $n-1$ from row $d$ and subtract $S_{nd}$ times column $n-1$ from column $d$; then subtract \nrow $n-1$ from row $n$ and column $n-1$ from column $n$.\nEvidently $T$ is again symmetric and $\\det(T) = \\det(S)$.\n\nLet us examine row $i$ of $T$ for $\\frac{n}{2} < i < n-1$:\n\\begin{align*}\nT_{i1} &= S_{i1} - S_{in} S_{(n-1)1} = 2-1\\cdot 2 = 0 \\\\\nT_{ij} &= S_{ij} - S_{in} S_{(n-1)j} - S_{nj}S_{i(n-1)}\\\\\n& =\n\\begin{cases} 1 & \\mbox{if $j$ divides $n-i$} \\\\\n0 & \\mbox{otherwise}.\n\\end{cases} \\quad (1 < j < n-1) \\\\\nT_{i(n-1)} &= S_{i(n-1)} - S_{in} S_{(n-1)(n-1)} = 0-1\\cdot0 = 0 \\\\\nT_{in} &= S_{in} - S_{in} S_{(n-1)n} - S_{i(n-1)}\n = 1 - 1\\cdot1 - 0 = 0.\n\\end{align*}\nNow recall (e.g., from the expansion of a determinant in minors) \nif a matrix contains an entry equal to 1 which is the unique nonzero entry in either its row or its column, then we may strike out this entry (meaning striking out the row and column containing it) at the expense of multiplying the determinant by a sign. To simplify notation, we do \\emph{not} renumber rows and columns after performing this operation.\n\nWe next verify that for the matrix $T$, for $i=2,\\dots,\\lfloor \\frac{n}{2} \\rfloor$ in turn, it is valid to strike out\n$(i,n-i)$ and $(n-i, i)$ at the cost of multiplying the determinant by -1. Namely, when we reach the entry $(n-i,i)$, the only other nonzero entries in this row have the form $(n-i,j)$ where $j>1$ divides $n-i$, and those entries are in previously struck columns. \n\nWe thus compute $\\det(S) = \\det(T)$ as:\n\\begin{gather*}\n(-1)^{\\lfloor n/2 \\rfloor-1}\n\\det \\begin{pmatrix}\nn+1 & -1 & 0 \\\\\n-1 & 0 & 1 \\\\\n0 & 1  & 0\n\\end{pmatrix} \\mbox{for $n$ odd,} \\\\\n(-1)^{\\lfloor n/2 \\rfloor-1}\n \\det \\begin{pmatrix}\nn+1 & -1 & 2 & 0 \\\\\n-1 & -1 & 1 & -1 \\\\\n2 & 1 & 0 & 1 \\\\\n0 & -1 & 1 & 0\n\\end{pmatrix} \\mbox{for $n$ even.}\n\\end{gather*}\nIn the odd case, we can strike the last two rows and columns (creating another negation) and then conclude at once. In the even case, the rows and columns are labeled $1, \\frac{n}{2}, n-1, n$; by adding row/column $n-1$ to row/column $\\frac{n}{2}$, we produce\n\\[\n(-1)^{\\lfloor n/2 \\rfloor}\n \\det \\begin{pmatrix}\nn+1 & 1 & 2 & 0 \\\\\n1 & 1 & 1 & 0 \\\\\n2 & 1 & 0 & 1 \\\\\n0 & 0 & 1 & 0\n\\end{pmatrix}\n\\]\nand we can again strike the last two rows and columns (creating another negation) and then read off the result.\n\n\\noindent\n\\textbf{Remark.}\nOne can use a similar approach to compute some related determinants.\nFor example, let $J$ be the matrix with $J_{ij} = 1$ for all $i,j$.\nIn terms of an indeterminate $q$, define the matrix $T$ by \n\\[\nT_{ij} = q^{S_{ij}}.\n\\]\nWe then have\n\\[\n\\det(T-tJ) = (-1)^{\\lceil n/2 \\rceil-1} q^{2(\\tau(n)-1)} (q-1)^{n-1}f_n(q,t)\n\\]\nwhere $\\tau(n)$ denotes the number of divisors of $n$\nand\n\\[\nf_n(q,t) = \\begin{cases} q^{n-1}t+q^2-2t & \\mbox{for $n$ odd,} \\\\q^{n-1}t +q^2-qt-t & \\mbox{for $n$ even.}\n\\end{cases}\n\\]\nTaking $t=1$ and then dividing by $(q-1)^n$, this yields a \\emph{$q$-deformation} of the original matrix $S$.\n\n\\end{itemize}\n\\end{document}", "source_problems": "PUTNAM-2023-problems.tex", "source_solutions": "PUTNAM-2023-solutions.tex", "notes": ""}
{"id": "TST-2023-1", "contest": "TST", "year": "2023", "problem_number": "1", "problem": "There are 2022 equally spaced points on a circular track \\(\\gamma\\) of circumference 2022. The points are labeled \\(A_{1}, A_{2}, \\ldots, A_{2022}\\) in some order, each label used once. Initially, Bunbun the Bunny begins at \\(A_{1}\\). She hops along \\(\\gamma\\) from \\(A_{1}\\) to \\(A_{2}\\), then from \\(A_{2}\\) to \\(A_{3}\\), until she reaches \\(A_{2022}\\), after which she hops back to \\(A_{1}\\). When hopping from \\(P\\) to \\(Q\\), she always hops along the shorter of the two \\(\\operatorname{arcs} \\widehat{P Q}\\) of \\(\\gamma\\); if \\(\\overline{P Q}\\) is a diameter of \\(\\gamma\\), she moves along either semicircle. Determine the maximal possible sum of the lengths of the 2022 arcs which Bunbun traveled, over all possible labellings of the 2022 points.", "solution": "Replacing 2022 with \\(2 n\\), the answer is \\(2 n^{2}-2 n+2\\). (When \\(n=1011\\), the number is 2042222.)", "source_pdf": "TST_2023.pdf", "notes": ""}
{"id": "TST-2023-3", "contest": "TST", "year": "2023", "problem_number": "3", "problem": "Consider pairs ( \\(f, g\\) ) of functions from the set of nonnegative integers to itself such that - \\(f(0) \\geq f(1) \\geq f(2) \\geq \\cdots \\geq f(300) \\geq 0 ;\\) - \\(f(0)+f(1)+f(2)+\\cdots+f(300) \\leq 300\\); - for any 20 nonnegative integers \\(n_{1}, n_{2}, \\ldots, n_{20}\\), not necessarily distinct, we have \\[ g\\left(n_{1}+n_{2}+\\cdots+n_{20}\\right) \\leq f\\left(n_{1}\\right)+f\\left(n_{2}\\right)+\\cdots+f\\left(n_{20}\\right) . \\] Determine the maximum possible value of \\(g(0)+g(1)+\\cdots+g(6000)\\) over all such pairs of functions.", "solution": "Replace \\(300=\\frac{24 \\cdot 25}{2}\\) with \\(\\frac{s(s+1)}{2}\\) where \\(s=24\\), and 20 with \\(k\\). The answer is \\(115440= \\frac{k s(k s+1)}{2}\\). Equality is achieved at \\(f(n)=\\max (s-n, 0)\\) and \\(g(n)=\\max (k s-n, 0)\\).", "source_pdf": "TST_2023.pdf", "notes": ""}
{"id": "TST-2023-4", "contest": "TST", "year": "2023", "problem_number": "4", "problem": "For nonnegative integers \\(a\\) and \\(b\\), denote their bitwise xor by \\(a \\oplus b\\). (For example, \\(9 \\oplus 10=1001_{2} \\oplus 1010_{2}=0011_{2}=3\\).) Find all positive integers \\(a\\) such that for any integers \\(x>y \\geq 0\\), we have \\[ x \\oplus a x \\neq y \\oplus a y . \\]", "solution": "The function \\(x \\mapsto x \\oplus a x\\) is injective if and only if \\(a\\) is an even integer.", "source_pdf": "TST_2023.pdf", "notes": ""}
{"id": "TST-2023-5", "contest": "TST", "year": "2023", "problem_number": "5", "problem": "Let \\(m\\) and \\(n\\) be fixed positive integers. Tsvety and Freyja play a game on an infinite grid of unit square cells. Tsvety has secretly written a real number inside of each cell so that the sum of the numbers within every rectangle of size either \\(m \\times n\\) or \\(n \\times m\\) is zero. Freyja wants to learn all of these numbers. One by one, Freyja asks Tsvety about some cell in the grid, and Tsvety truthfully reveals what number is written in it. Freyja wins if, at any point, Freyja can simultaneously deduce the number written in every cell of the entire infinite grid. (If this never occurs, Freyja has lost the game and Tsvety wins.) In terms of \\(m\\) and \\(n\\), find the smallest number of questions that Freyja must ask to win, or show that no finite number of questions can suffice.", "solution": "The answer is the following: - If \\(\\operatorname{gcd}(m, n)>1\\), then Freyja cannot win. - If \\(\\operatorname{gcd}(m, n)=1\\), then Freyja can win in a minimum of \\((m-1)^{2}+(n-1)^{2}\\) questions.", "source_pdf": "TST_2023.pdf", "notes": ""}
{"id": "TST-2023-6", "contest": "TST", "year": "2023", "problem_number": "6", "problem": "Fix a function \\(f: \\mathbb{N} \\rightarrow \\mathbb{N}\\) and for any \\(m, n \\in \\mathbb{N}\\) define \\[ \\Delta(m, n)=\\underbrace{f(f(\\ldots f}_{f(n) \\text { times }}(m) \\ldots))-\\underbrace{f(f(\\ldots f}_{f(m) \\text { times }}(n) \\ldots)) . \\] Suppose \\(\\Delta(m, n) \\neq 0\\) for any distinct \\(m, n \\in \\mathbb{N}\\). Show that \\(\\Delta\\) is unbounded, meaning that for any constant \\(C\\) there exist \\(m, n \\in \\mathbb{N}\\) with \\(|\\Delta(m, n)|>C\\).", "solution": "Suppose for the sake of contradiction that \\(|\\Delta(m, n)| \\leq N\\) for all \\(m, n\\). Note that \\(f\\) is injective, as \\(f(m)=f(n) \\Longrightarrow \\Delta(m, n)=0 \\Longrightarrow m=n\\), as desired. Let \\(G\\) be the \"arrow graph\" of \\(f\\), which is the directed graph with vertex set \\(\\mathbb{N}\\) and edges \\(n \\rightarrow f(n)\\). The first step in the solution is to classify the structure of \\(G\\). Injectivity implies that \\(G\\) is a disjoint collection of chains (infinite and half-infinite) and cycles. We have the following sequence of claims that further refine the structure.", "source_pdf": "TST_2023.pdf", "notes": ""}
{"id": "TST-2025-1", "contest": "TST", "year": "2025", "problem_number": "1", "problem": "Let \\(n\\) be a positive integer. Ana and Banana play a game. Banana thinks of a function \\(f: \\mathbb{Z} \\rightarrow \\mathbb{Z}\\) and a prime number \\(p\\). He tells Ana that \\(f\\) is nonconstant, \\(p<100\\), and \\(f(x+p)=f(x)\\) for all integers \\(x\\). Ana's goal is to determine the value of \\(p\\). She writes down \\(n\\) integers \\(x_{1}, \\ldots, x_{n}\\). After seeing this list, Banana writes down \\(f\\left(x_{1}\\right), \\ldots, f\\left(x_{n}\\right)\\) in order. Ana wins if she can determine the value of \\(p\\) from this information. Find the smallest value of \\(n\\) for which Ana has a winning strategy.", "solution": "The answer is \\(n=83+89-1=171\\). In general, if Ana has to decide between periods from the set \\(\\mathcal{P}:=\\left\\{p_{1}>p_{2}>\\cdots>p_{r}\\right\\}\\) of pairwise distinct relatively prime positive integers for \\(r \\geq 3\\), the answer is \\(p_{2}+p_{3}-1\\).", "source_pdf": "TST_2025.pdf", "notes": ""}
{"id": "TST-2025-2", "contest": "TST", "year": "2025", "problem_number": "2", "problem": "Let \\(a_{1}, a_{2}, \\ldots\\) and \\(b_{1}, b_{2}, \\ldots\\) be sequences of real numbers for which \\(a_{1}>b_{1}\\) and \\(\\begin{aligned} a_{n+1} & =a_{n}^{2}-2 b_{n} \\\\ b_{n+1} & =b_{n}^{2}-2 a_{n} \\end{aligned}\\) for all positive integers \\(n\\). Prove that \\(a_{1}, a_{2}, \\ldots\\) is eventually increasing (that is, there exists a positive integer \\(N\\) for which \\(a_{k}<a_{k+1}\\) for all \\(k>N\\) ).", "solution": "Let \\(r, s\\), and \\(t\\) be the complex roots of the polynomial \\(p(\\lambda)=\\lambda^{3}-a_{1} \\lambda^{2}+b_{1} \\lambda-1\\). By Vieta's formulas, \\(\\begin{aligned} a_{1} & =r+s+t \\\\ b_{1} & =1 / r+1 / s+1 / t \\\\ 1 & =r s t \\end{aligned}\\) Claim - For every positive integer \\(n\\), \\(a_{n}=r^{2^{n-1}}+s^{2^{n-1}}+t^{2^{n-1}}\\) and \\(b_{n}=(1 / r)^{2^{n-1}}+(1 / s)^{2^{n-1}}+(1 / t)^{2^{n-1}} \\text {. }\\) Proof. The base case follows from Vieta's formulas above. For the inductive step, observe that \\(r s t=1\\), so \\(\\begin{aligned} a_{n+1} & =a_{n}^{2}-2 b_{n} \\\\ & =\\left(r^{2^{n-1}}+s^{2^{n-1}}+t^{2^{n-1}}\\right)^{2}-2\\left((1 / r)^{2^{n-1}}+(1 / s)^{2^{n-1}}+(1 / t)^{2^{n-1}}\\right) \\\\ & =\\left(r^{2^{n-1}}+s^{2^{n-1}}+t^{2^{n-1}}\\right)^{2}-2\\left((s t)^{2^{n-1}}+(t r)^{2^{n-1}}+(r s)^{2^{n-1}}\\right) \\\\ & =r^{2^{n}}+s^{2^{n}}+t^{2^{n}} \\end{aligned}\\) and similarly for \\(b_{n+1}\\). Since \\(p(1)=b_{1}-a_{1}<0, p\\) has a real root greater than 1 ; let \\(r\\) be the largest such root. - If \\(s\\) and \\(t\\) are real, let \\(m=\\max (|r|,|s|,|t|)>1\\) be the largest magnitude of the roots and \\(k \\in\\{1,2,3\\}\\) be the number of roots with that magnitude. Then asymptotically \\(a_{n}=r^{2^{n-1}}+s^{2^{n-1}}+t^{2^{n-1}} \\approx k m^{2^{n-1}}\\) which implies that \\(\\left\\{a_{n}\\right\\}\\) is eventually increasing. - If \\(s\\) and \\(t\\) are not real, they must be complex conjugates of each other, each with magnitude \\(\\frac{1}{\\sqrt{r}}<1\\). Therefore \\(r^{2^{n-1}}-2<a_{n}<r^{2^{n-1}}+2\\), so \\(\\left\\{a_{n}\\right\\}\\) is eventually increasing.", "source_pdf": "TST_2025.pdf", "notes": ""}
{"id": "TST-2025-3", "contest": "TST", "year": "2025", "problem_number": "3", "problem": "Let \\(A_{1} A_{2} \\cdots A_{2025}\\) be a convex 2025-gon, and let \\(A_{i}=A_{i+2025}\\) for all integers \\(i\\). Distinct points \\(P\\) and \\(Q\\) lie in its interior such that \\(\\angle A_{i-1} A_{i} P=\\angle Q A_{i} A_{i+1}\\) for all \\(i\\). Define points \\(P_{i}^{j}\\) and \\(Q_{i}^{j}\\) for integers \\(i\\) and positive integers \\(j\\) as follows: - For all \\(i, P_{i}^{1}=Q_{i}^{1}=A_{i}\\). - For all \\(i\\) and \\(j, P_{i}^{j+1}\\) and \\(Q_{i}^{j+1}\\) are the circumcenters of \\(P P_{i}^{j} P_{i+1}^{j}\\) and \\(Q Q_{i}^{j} Q_{i+1}^{j}\\), respectively. Let \\(\\mathcal{P}\\) and \\(\\mathcal{Q}\\) be the polygons \\(P_{1}^{2025} P_{2}^{2025} \\cdots P_{2025}^{2025}\\) and \\(Q_{1}^{2025} Q_{2}^{2025} \\cdots Q_{2025}^{2025}\\), respectively. (a) Prove that \\(\\mathcal{P}\\) and \\(\\mathcal{Q}\\) are cyclic. (b) Let \\(O_{P}\\) and \\(O_{Q}\\) be the circumcenters of \\(\\mathcal{P}\\) and \\(\\mathcal{Q}\\), respectively. Assuming that \\(O_{P} \\neq O_{Q}\\), show that \\(O_{P} O_{Q}\\) is parallel to \\(P Q\\).", "solution": "Let \\(n=2025\\). Let \\(\\mathcal{P}_{i}\\) and \\(\\mathcal{Q}_{i}\\) denote the polygons \\(P_{1}^{i} \\cdots P_{n}^{i}\\) and \\(Q_{1}^{i} \\cdots Q_{n}^{i}\\). In this notation, \\(\\mathcal{P}=\\mathcal{P}_{n}, \\mathcal{Q}=\\mathcal{Q}_{n}\\), and \\(\\mathcal{P}_{1}=\\mathcal{Q}_{1}=A_{1} \\cdots A_{n}\\). The angle condition for \\(P\\) and \\(Q\\) just says that they are isogonal conjugates in \\(\\mathcal{P}_{1}\\). We will first find some properties that do not depend on \\(P\\) having an isogonal conjugate. Note that \\(P_{i-1}^{j+1} P_{i}^{j+1}\\) is the perpendicular bisector of \\(P P_{i+1}^{j}\\), so we can go backwards from \\(\\mathcal{P}_{j}\\) to \\(\\mathcal{P}_{j-1}\\) by reflecting over the sides. Use this to extend the points backwards to \\(\\mathcal{P}_{0}\\), i.e. define \\(P_{i}^{0}\\) to be the reflection of \\(P\\) over \\(P_{i-1}^{1} P_{i}^{1}\\). Lemma 1.1: For integers \\(j \\geq 0\\) and \\(i\\), \\(\\begin{aligned} & \\measuredangle P P_{i}^{j} P_{i+1}^{j}=\\measuredangle P P_{i}^{j+1} P_{i+1}^{j+1} \\quad \\text { and } \\\\ & \\measuredangle P P_{i+1}^{j} P_{i}^{j}=\\measuredangle P P_{i}^{j+1} P_{i-1}^{j+1} . \\end{aligned}\\) Proof. This is a standard circumcenter fact in disguise but we will prove it here for completeness. If \\(X\\) is the antipode of \\(P\\) on \\(\\left(P P_{i}^{j} P_{i+1}^{j}\\right)\\) (equivalently, the reflection of \\(P\\) over \\(P P_{i}^{j+1}\\) ) and \\(M\\) is the midpoint of \\(P P_{i+1}^{j}\\) then \\(\\measuredangle P P_{i}^{j} P_{i+1}^{j}=\\measuredangle P X P_{i+1}^{j}=\\measuredangle P P_{i}^{j+1} M=\\measuredangle P P_{i}^{j+1} P_{i+1}^{j+1} .\\) The second equality is analogous. Lemma: The following similarity holds: \\(\\mathcal{P}_{n} \\cup P \\stackrel{+}{\\sim} \\mathcal{P}_{0} \\cup P\\). Proof. By Lemma 1.1, \\(\\begin{aligned} & \\measuredangle P P_{i}^{0} P_{i+1}^{0}=\\measuredangle P P_{i}^{1} P_{i+1}^{1}=\\cdots=\\measuredangle P_{i}^{n} P_{i+1}^{n} \\quad \\text { and } \\\\ & \\measuredangle P P_{i+1}^{0} P_{i}^{0}=\\measuredangle P P_{i}^{1} P_{i-1}^{1}=\\cdots=\\measuredangle P_{i-n+1}^{n} P_{i-n}^{n}=\\measuredangle P_{i+1}^{n} P_{i}^{n} \\end{aligned}\\) Therefore \\(P P_{i}^{n} P_{i+1}^{n} \\stackrel{+}{\\sim} P P_{i}^{0} P_{i+1}^{0}\\). Combining these similarities for all \\(i\\) shows that \\(\\mathcal{P}_{n} \\cup P \\stackrel{+}{\\sim} \\mathcal{P}_{0} \\cup P\\). To solve part (a), we just need to show that \\(\\mathcal{P}_{0}\\) and \\(\\mathcal{Q}_{0}\\) are cyclic. This is where we need the isogonal conjugate property, and we can generalize from analogous facts for the \\(n=3\\) case. We have \\(\\measuredangle P P_{i+1}^{0} P_{i}^{0}=\\measuredangle P A_{i} A_{i-1}=\\measuredangle A_{i+1} A_{i} Q\\) so \\(90^{\\circ}=\\measuredangle\\left(P P_{i+1}^{0}, A_{i} A_{i+1}\\right)=\\measuredangle\\left(P_{i+1}^{0} P_{i}^{0}, A Q\\right) .\\) Since \\(A_{i} P_{i}^{0}=A_{i} P_{i+1}^{0}\\), it follows that \\(A_{i} Q\\) is the perpendicular bisector of \\(P_{i}^{0} P_{i+1}^{0}\\) and \\(Q P_{i}^{0}=Q P_{i+1}^{0}\\). By applying this equality for all \\(i\\), it follows that \\(\\mathcal{P}_{0}\\) is cyclic with circumcenter \\(Q\\). This completes the solution for part (a). For part (b), we will analyze the angle of rotation and scale factor for the similarity \\(\\mathcal{P}_{n} \\cup P \\stackrel{+}{\\sim} \\mathcal{P}_{0} \\cup P\\). Assume without loss of generality that \\(A_{1} A_{2} \\cdots A_{n}\\) is labeled in clockwise order as in the earlier diagrams. Claim - The spiral similarity at \\(P\\) sending \\(\\mathcal{P}_{0} \\cup Q\\) to \\(\\mathcal{P}_{n} \\cup O_{P}\\) is the composition of a clockwise rotation by \\(\\theta_{P}\\) and a dilation with factor \\(r_{P}\\), where \\(\\theta_{P}=\\frac{n \\pi}{2}-\\sum_{i=1}^{n} \\angle P A_{i} A_{i-1} \\quad \\text { and } \\quad r_{P}=\\prod_{i=1}^{n} \\frac{1}{2 \\sin \\angle P A_{i} A_{i-1}} .\\) Analogously, the spiral similarity at \\(Q\\) sending \\(\\mathcal{Q}_{0} \\cup P\\) to \\(\\mathcal{Q}_{n} \\cup O_{Q}\\) is the composition of a clockwise rotation by \\(\\theta_{Q}\\) and a dilation with factor \\(r_{Q}\\), where \\(\\theta_{Q}=\\frac{n \\pi}{2}-\\sum_{i=1}^{n} \\angle Q A_{i} A_{i-1} \\quad \\text { and } \\quad r_{Q}=\\prod_{i=1}^{n} \\frac{1}{2 \\sin \\angle Q A_{i} A_{i+1}} .\\) Proof. Note that \\(\\angle P P_{0}^{i} P P_{0}^{i+1}=\\frac{\\pi}{2}-\\angle P P_{1}^{i} P_{0}^{i}=\\frac{\\pi}{2}-\\angle P P_{i}^{1} P_{i-1}^{1}=\\frac{\\pi}{2}-\\angle P A_{i} A_{i-1}\\) by circumcenter properties and Lemma 1.1. Summing over \\(0 \\leq i<n\\) yields the claimed formula for \\(\\theta_{P}\\), since the left hand side adds up to the rotation angle from \\(P P_{0}^{0}\\) to \\(P P_{0}^{n}\\). By the law of sines, \\(\\prod_{i=1}^{n} \\frac{P P_{i}^{j+1}}{P_{i}^{j}}=\\prod_{i=1}^{n} \\frac{1}{2 \\sin \\angle P P_{i+1}^{j} P_{i}^{j}}=\\prod_{i=1}^{n} \\frac{1}{2 \\sin \\angle P A_{i} A_{i-1}}\\) where in the last equality we use Lemma 1.1 again. Multiply over \\(0 \\leq j<n\\) and raise to the power \\(\\frac{1}{n}\\) to obtain \\(\\left(\\prod_{i=1}^{n} \\frac{P P_{i}^{n}}{P_{i}^{0}}\\right)^{\\frac{1}{n}}=\\prod_{i=1}^{n} \\frac{1}{2 \\sin \\angle P A_{i} A_{i-1}} .\\) This proves the formula for \\(r_{P}\\) because the left hand side gives the scale factor. The argument for \\(Q\\) is similar. Note that we reversed the angle in the formula for \\(r_{Q}\\) but not \\(\\theta_{Q}\\) because \\(\\theta_{Q}\\) depends on orientation. By the given angle conditions on \\(P\\) and \\(Q\\) we have \\(r_{P}=r_{Q}\\). Meanwhile, \\(\\theta_{P}+\\theta_{Q}=n \\pi-\\sum_{i=1}^{n}\\left(\\angle P A_{i} A_{i-1}+\\angle Q A_{i} A_{i-1}\\right)=n \\pi-\\sum_{i=1}^{n} \\angle A_{i-1} A_{i} A_{i+1}=2 \\pi .\\) This means that clockwise rotation by \\(\\theta_{Q}\\) is just counterclockwise rotation by \\(\\theta_{P}\\). The combination of these two implies that \\(P Q O_{Q} O_{P}\\) is an isosceles trapezoid with \\(O_{P} O_{Q}\\) parallel to \\(P Q\\), which proves part (b).", "source_pdf": "TST_2025.pdf", "notes": ""}
{"id": "TST-2025-4", "contest": "TST", "year": "2025", "problem_number": "4", "problem": "Let \\(A B C\\) be a triangle, and let \\(X, Y\\), and \\(Z\\) be collinear points such that \\(A Y=A Z\\), \\(B Z=B X\\), and \\(C X=C Y\\). Points \\(X^{\\prime}, Y^{\\prime}\\), and \\(Z^{\\prime}\\) are the reflections of \\(X, Y\\), and \\(Z\\) over \\(B C, C A\\), and \\(A B\\), respectively. Prove that if \\(X^{\\prime} Y^{\\prime} Z^{\\prime}\\) is a nondegenerate triangle, then its circumcenter lies on the circumcircle of \\(A B C\\).", "solution": "Let \\(S\\) denote the circumcenter of \\(\\triangle X^{\\prime} Y^{\\prime} Z^{\\prime}\\). Observe that \\(A Y=A Z=A Y^{\\prime}=A Z^{\\prime}\\), so \\(Y Z Y^{\\prime} Z^{\\prime}\\) is cyclic and \\(A S \\perp Y^{\\prime} Z^{\\prime}\\). Similarly, \\(B S \\perp Z^{\\prime} X^{\\prime}\\) and \\(C S \\perp X^{\\prime} Y^{\\prime}\\). The rest is angle chasing. Let \\(\\measuredangle \\ell\\) denote the angle between line \\(\\ell\\) and a fixed line. Then, we have \\(\\begin{aligned} \\measuredangle A S & =90^{\\circ}+\\measuredangle Y^{\\prime} Z^{\\prime}=90^{\\circ}+\\measuredangle Y Y^{\\prime}+\\measuredangle Z Z^{\\prime}-\\measuredangle Y Z \\\\ & =90^{\\circ}+\\measuredangle C A+\\measuredangle A B-\\measuredangle Y Z . \\end{aligned}\\) Analogously, we get \\(\\measuredangle B S=90^{\\circ}+\\measuredangle A B+\\measuredangle B C-\\measuredangle X Z,\\) so subtracting these gives \\(\\measuredangle A S B=\\measuredangle A C B\\), as desired.", "source_pdf": "TST_2025.pdf", "notes": ""}
{"id": "TST-2025-5", "contest": "TST", "year": "2025", "problem_number": "5", "problem": "A pond has 2025 lily pads arranged in a circle. Two frogs, Alice and Bob, begin on different lily pads. A frog jump is a jump which travels 2,3 , or 5 positions clockwise. Alice and Bob each make a series of frog jumps, and each frog ends on the same lily pad that it started from. Given that each lily pad is the destination of exactly one jump, prove that each frog completes exactly two laps around the pond (i.e. travels 4050 positions in total).", "solution": "Let \\(\\pi: \\mathbb{Z} / 2025 \\mathbb{Z} \\rightarrow \\mathbb{Z} / 2025 \\mathbb{Z}\\) be the permutation where the jump with source \\(i\\) has destination \\(\\pi(i)\\). We know that \\(\\pi\\) has exactly two cycles, corresponding to the paths of each frog. Suppose that the frogs complete a total of \\(\\ell\\) laps around the circle, so the sum of the lengths of all the jumps made is \\(2025 \\ell\\). Thus the average jump moves \\(\\ell\\) positions, so \\(\\ell \\in\\{2,3,4,5\\}\\). We now split into cases. II Case 1: \\(\\ell \\in\\{2,5\\} \\quad\\) If \\(\\ell=2\\), then every jump travels 2 positions, so \\(\\pi(i)=i+2\\) for all \\(i\\). This permutation has exactly one cycle, contradiction. If \\(\\ell=5\\), then every jump travels 5 positions, so \\(\\pi(i)=i+5\\) for all \\(i\\). This permutation has exactly five cycles, contradiction. IT Case 2: \\(\\ell=3\\) The key idea is to consider the cycle decomposition of the auxillary permutation \\(\\pi^{\\prime}: \\mathbb{Z} / 2025 \\mathbb{Z} \\rightarrow \\mathbb{Z} / 2025 \\mathbb{Z}\\) by \\(\\pi^{\\prime}(i)=\\pi(i)-3\\). The average jump in \\(\\pi^{\\prime}\\) (i.e. the distance from \\(i\\) to \\(\\pi^{\\prime}(i)\\) traveling clockwise) travels 0 positions. Thus, either each cycle of \\(\\pi^{\\prime}\\) either travels net zero positions, or there is some cycle that travels net negative positions. Since \\(\\pi^{\\prime}(i) \\in\\{i-1, i, i+2\\}\\), the latter case can only happen if \\(\\pi^{\\prime}(i)=i-1\\) for al \\(i\\), which has average jump -1 , not 0 , contradiction. Thus, each cycle travels net 0 positions. It is easy to see that the only such cycles are \\(i \\mapsto i\\) and \\(i \\mapsto i+2 \\mapsto i+1 \\mapsto i\\). Say that \\(i\\) is a unicycle start if \\(i \\mapsto i\\) is a cycle in \\(\\pi^{\\prime}\\), a tricycle start if \\(i \\mapsto i+2 \\mapsto i+1 \\mapsto i\\) is a cycle in \\(\\pi^{\\prime}\\), and a cycle start if it is either a unicycle start or a tricycle start. It is easy to see that if \\(i\\) is a unicycle start, then \\(i+1\\) must be a cycle start, and if \\(i\\) is a tricycle start, then \\(i+3\\) must be a cycle start. Given this structural classification of \\(\\pi^{\\prime}\\), we will now generate a contradiction by showing that \\(\\pi\\) can't have exactly two cycles. Place auxillary frogs \\(C, D\\), and \\(E\\) on lily pads \\(i, i+1\\), and \\(i+2\\) respectively, where \\(i\\) is a cycle start. If \\(i\\) is a unicycle start, then have \\(C\\) jump to \\(\\pi(i)=i+3\\). If \\(i\\) is a tricycle start, then have \\(C, D\\), and \\(E\\) jump to \\(\\pi(i)=i+5, \\pi(i+1)=i+3\\), and \\(\\pi(i+2)=i+4\\), respectively. Note that \\(C, D\\), and \\(E\\) are still on consecutive lily pads in some order, with the first lily pad number being a cycle start. We can repeat this process, having either the first frog or all three frogs jump according to permutation \\(\\pi\\), depending on whether the first lily pad number is a unicycle start or a tricycle start. When all of the cycles of \\(\\pi^{\\prime}\\) have been exhausted in this manner, \\(C, D\\), and \\(E\\) are back to positions \\(i, i+1\\), and \\(i+2\\), in some order. Note that each step of the above process permutes \\(C, D\\), and \\(E\\) with an even permutation, so the final permutation of \\(C, D\\), and \\(E\\) must be \\(C D E, D E C\\), or \\(E C D\\). The first case implies that \\(\\pi\\) has three cycles, while the other two cases imply that \\(\\pi\\) has only one cycle, a contradiction. If Case 3: \\(\\ell=4\\) Now consider the auxillary permutation \\(\\pi^{\\prime \\prime}: \\mathbb{Z} / 2025 \\mathbb{Z} \\rightarrow \\mathbb{Z} / 2025 \\mathbb{Z}\\) given by \\(\\pi^{\\prime \\prime}(i)=\\pi(i)-4\\). Note that \\(\\pi^{\\prime \\prime}(i) \\in\\{i-2, i-1, i+1\\}\\), so a similar analysis as the \\(\\ell=3\\) case shows that the only two possible types of cycles in \\(\\pi^{\\prime \\prime}\\) are \\(i \\rightarrow i+1 \\rightarrow i\\) and \\(i \\rightarrow i+1 \\rightarrow i+2 \\rightarrow i\\). Again, define \\(i\\) to be a bicycle start if \\(i \\mapsto i+1 \\mapsto i\\) is a cycle in \\(\\pi^{\\prime \\prime}\\) a tricycle start if \\(i \\mapsto i+1 \\mapsto i+2 \\mapsto i\\) is a cycle in \\(\\pi^{\\prime \\prime}\\), and a cycle start if it is either a bicycle or tricycle start. It is easy to see that if \\(i\\) is a bicycle start, then \\(i+2\\) must be a cycle start, and if \\(i\\) is a tricycle start, then \\(i+3\\) must be a cycle start. Now, place auxillary frogs \\(C, D, E\\), and \\(F\\) on lily pads \\(i, i+1, i+2\\), and \\(i+3\\) respectively, where \\(i\\) is a cycle start. If \\(i\\) is a bicycle start, have \\(C\\) jump to \\(\\pi(i)=i+5\\) and \\(D\\) jump to \\(\\pi(i+1)=i+4\\), and if \\(i\\) is a tricycle start, have \\(C\\) jump to \\(\\pi(i)=i+5\\), \\(D\\) jump to \\(\\pi(i+1)=i+6\\), and \\(E\\) jump to \\(\\pi(i+2)=i+4\\). Note that \\(C, D, E\\), and \\(F\\) are still on consecutive lily pads in some order, with the first lily pad number being a cycle start. If \\(i\\) is a bicycle start, then it causes the frogs to permute according to \\(C D E F \\mapsto E F D C\\), and if \\(i\\) is a tricycle start, then it causes the frogs to permute according to \\(C D E F \\mapsto F E C D\\). Thus, when all of the cycles of \\(\\pi^{\\prime \\prime}\\) have been exhausted in this manner, \\(C, D, E\\), and \\(F\\) are back to positions \\(i, i+1, i+2\\), and \\(i+3\\), in one of the permutations \\(C D E F\\), \\(E F D C, D C F E\\), or \\(F E C D\\). The first case implies that \\(\\pi\\) has four cycles, while the second and fourth cases imply that \\(\\pi\\) has only one cycle, a contradiction, so we must be in the third case, i.e. the frogs end up on lily pads \\(i, i+1, i+2\\), and \\(i+3\\) in the order \\(D C F E\\). Therefore, one of Alice or Bob travels the combined path of \\(C\\) and \\(D\\), while the other travels the combined path of \\(E\\) and \\(F\\), each of which completes two laps around the circle, as desired.", "source_pdf": "TST_2025.pdf", "notes": ""}
{"id": "TST-2025-6", "contest": "TST", "year": "2025", "problem_number": "6", "problem": "Prove that there exists a real number \\(\\varepsilon>0\\) such that there are infinitely many sequences of integers \\(0<a_{1}<a_{2}<\\ldots<a_{2025}\\) satisfying \\(\\operatorname{gcd}\\left(a_{1}^{2}+1, a_{2}^{2}+1, \\ldots, a_{2025}^{2}+1\\right)>a_{2025}^{1+\\varepsilon} .\\)", "solution": "By the Chinese Remainder Theorem for \\(\\mathbb{Q}[x]\\), for any choice of \\(2^{12}\\) signs there exists a unique polynomial \\(f_{i}\\) of degree at most 23 such that \\(f_{i} \\equiv \\pm c x \\quad\\left(\\bmod c^{2} x^{2}+1\\right)\\) for \\(c=1,2, \\ldots, 12\\). Furthermore, these polynomials are multiples of \\(x\\) and come in pairs which sum to zero, so we can pick 2048 of these polynomials which have positive leading coefficients and label them \\(f_{1}, f_{2}, \\ldots, f_{2048}\\). Let \\(N\\) be a positive integer such that any coefficient of the polynomials is \\(\\frac{1}{N}\\) times an integer. For a suffiiently large positive integer \\(x\\), take \\(a_{i}=f_{i}(N x)\\) for \\(i=1,2, \\ldots, 2025\\), which will be positive integers. Then, \\(\\operatorname{gcd}\\left(a_{1}^{2}+1, a_{2}^{2}+1, \\ldots, a_{2025}^{2}+1\\right) \\geq \\prod_{c=1}^{12}\\left(c^{2} x^{2}+1\\right)\\) because \\(a_{i}^{2}+1 \\equiv 0\\left(\\bmod c^{2} x^{2}+1\\right)\\) for any \\(i\\) by construction. The right hand side is asymptotically \\(x^{24}\\) while \\(a_{2025}\\) is \\(x^{23}\\) up to constant factors, so any \\(\\varepsilon<\\frac{1}{23}\\) works.", "source_pdf": "TST_2025.pdf", "notes": ""}
{"id": "USAMO-2022-1", "contest": "USAMO", "year": "2022", "problem_number": "1", "problem": "Let \\(a\\) and \\(b\\) be positive integers. Every cell of an \\((a+b+1) \\times(a+b+1)\\) grid is colored either amber or bronze such that there are at least \\(a^{2}+a b-b\\) amber cells and at least \\(b^{2}+a b-a\\) bronze cells. Prove that it is possible to choose \\(a\\) amber cells and \\(b\\) bronze cells such that no two of the \\(a+b\\) chosen cells lie in the same row or column.", "solution": "Claim - There exists a transversal \\(T_{a}\\) with at least \\(a\\) amber cells. Analogously, there exists a transversal \\(T_{b}\\) with at least \\(b\\) bronze cells.\n\nProof. If one picks a random transversal, the expected value of the number of amber cells is at least\n\\[\n\\frac{a^{2}+a b-b}{a+b+1}=(a-1)+\\frac{1}{a+b+1}>a-1 .\n\\]\n\nNow imagine we transform \\(T_{a}\\) to \\(T_{b}\\) in some number of steps, by repeatedly choosing cells \\(c\\) and \\(c^{\\prime}\\) and swapping them with the two other corners of the rectangle formed by their row/column, as shown in the figure.\n\nBy \"discrete intermediate value theorem\", the number of amber cells will be either \\(a\\) or \\(a+1\\) at some point during this transformation. This completes the proof.", "source_pdf": "USAMO_2022.pdf", "notes": ""}
{"id": "USAMO-2022-2", "contest": "USAMO", "year": "2022", "problem_number": "2", "problem": "Let \\(b \\geq 2\\) and \\(w \\geq 2\\) be fixed integers, and \\(n=b+w\\). Given are \\(2 b\\) identical black rods and \\(2 w\\) identical white rods, each of side length 1 .\nWe assemble a regular \\(2 n\\)-gon using these rods so that parallel sides are the same color. Then, a convex \\(2 b\\)-gon \\(B\\) is formed by translating the black rods, and a convex \\(2 w\\)-gon \\(W\\) is formed by translating the white rods. An example of one way of doing the assembly when \\(b=3\\) and \\(w=2\\) is shown below, as well as the resulting polygons \\(B\\) and \\(W\\).\n\nProve that the difference of the areas of \\(B\\) and \\(W\\) depends only on the numbers \\(b\\) and \\(w\\), and not on how the \\(2 n\\)-gon was assembled.", "solution": "We are going to prove that one may swap a black rod with an adjacent white rod (as well as the rods parallel to them) without affecting the difference in the areas of \\(B-W\\). Let \\(\\vec{u}\\) and \\(\\vec{v}\\) denote the originally black and white vectors that were adjacent on the \\(2 n\\)-gon and are now going to be swapped. Let \\(\\vec{x}\\) denote the sum of all the other black vectors between \\(\\vec{u}\\) and \\(-\\vec{u}\\), and define \\(\\vec{y}\\) similarly. See the diagram below, where \\(B_{0}\\) and \\(W_{0}\\) are the polygons before the swap, and \\(B_{1}\\) and \\(W_{1}\\) are the resulting changed polygons.\n\nObserve that the only change in \\(B\\) and \\(W\\) is in the parallelograms shown above in each diagram. Letting \\(\\wedge\\) denote the wedge product, we need to show that\n\\[\n\\vec{u} \\wedge \\vec{x}-\\vec{v} \\wedge \\vec{y}=\\vec{v} \\wedge \\vec{x}-\\vec{u} \\wedge \\vec{y}\n\\]\nwhich can be rewritten as\n\\[\n(\\vec{u}-\\vec{v}) \\wedge(\\vec{x}+\\vec{y})=0 .\n\\]\n\nIn other words, it would suffice to show \\(\\vec{u}-\\vec{v}\\) and \\(\\vec{x}+\\vec{y}\\) are parallel. (Students not familiar with wedge products can replace every \\(\\wedge\\) with the cross product \\(\\times\\) instead.)\n\nClaim - Both \\(\\vec{u}-\\vec{v}\\) and \\(\\vec{x}+\\vec{y}\\) are perpendicular to vector \\(\\vec{u}+\\vec{v}\\).\n\nProof. We have \\((\\vec{u}-\\vec{v}) \\perp(\\vec{u}+\\vec{v})\\) because \\(\\vec{u}\\) and \\(\\vec{v}\\) are the same length.\nFor the other perpendicularity, note that \\(\\vec{u}+\\vec{v}+\\vec{x}+\\vec{y}\\) traces out a diameter of the circumcircle of the original \\(2 n\\)-gon; call this diameter \\(A B\\), so\n\\[\nA+\\vec{u}+\\vec{v}+\\vec{x}+\\vec{y}=B .\n\\]\n\nNow point \\(A+\\vec{u}+\\vec{v}\\) is a point on this semicircle, which means (by the inscribed angle theorem) the angle between \\(\\vec{u}+\\vec{v}\\) and \\(\\vec{x}+\\vec{y}\\) is \\(90^{\\circ}\\).", "source_pdf": "USAMO_2022.pdf", "notes": ""}
{"id": "USAMO-2022-3", "contest": "USAMO", "year": "2022", "problem_number": "3", "problem": "Solve over positive real numbers the functional equation\n\\[\nf(x)=f(f(f(x))+y)+f(x f(y)) f(x+y) .\n\\]", "solution": "The answer is \\(f(x) \\equiv c / x\\) for any \\(c>0\\). This works, so we'll prove this is the only solution. The following is based on the solution posted by pad on AoPS.\n\nIn what follows, \\(f^{n}\\) as usual denotes \\(f\\) iterated \\(n\\) times, and \\(P(x, y)\\) is the given statement. Also, we introduce the notation \\(Q\\) for the statement\n\\[\nQ(a, b): \\quad f(a) \\geq f(b) \\Longrightarrow f(f(b)) \\geq a .\n\\]\n\nTo see why this statement \\(Q\\) is true, assume for contradiction that \\(a>f(f(b))\\); then consider \\(P(b, a-f(f(b)))\\) to get a contradiction.\n\nThe main idea of the problem is the following:\nClaim - Any function \\(f: \\mathbb{R}_{>0} \\rightarrow \\mathbb{R}_{>0}\\) obeying statement \\(Q\\) satisfies \\(f^{2}(x)=f^{4}(x)\\).\n\nProof. From \\(Q(t, t)\\) we get\n\\[\nf^{2}(t) \\geq t \\quad \\text { for all } t>0 .\n\\]\n\nSo this already implies \\(f^{4}(x) \\geq f^{2}(x)\\) by choosing \\(t=f^{2}(x)\\). It also gives \\(f(x) \\leq f^{3}(x) \\leq f^{5}(x)\\) by choosing \\(t=f(x), t=f^{3}(x)\\).\nThen \\(Q\\left(f^{4}(x), x\\right)\\) is valid and gives \\(f^{2}(x) \\geq f^{4}(x)\\), as needed.\n\nClaim - The function \\(f\\) is injective.\n\nProof. Suppose \\(f(u)=f(v)\\) for some \\(u>v\\). From \\(Q(u, v)\\) and \\(Q(v, u)\\) we have \\(f^{2}(v) \\geq u\\) and \\(f^{2}(u) \\geq v\\). Note that for all \\(x>0\\) we have statements\n\\[\n\\begin{aligned}\n& P\\left(f^{2}(x), u\\right) \\Longrightarrow f^{3}(x)=f(x+u)+f(x f(u)) f(x+u)=(1+f(x f(u))) f(x+u) \\\\\n& P\\left(f^{2}(x), v\\right) \\Longrightarrow f^{3}(x)=f(x+v)+f(x f(v)) f(x+v)=(1+f(x f(v))) f(x+v) .\n\\end{aligned}\n\\]\n\nIt follows that \\(f(x+u)=f(x+v)\\) for all \\(x>0\\).\nThis means that \\(f\\) is periodic with period \\(T=u-v>0\\). However, this is incompatible with \\(Q\\), because we would have \\(Q(1+n T, 1)\\) for all positive integers \\(n\\), which is obviously absurd.\n\nSince \\(f\\) is injective, we obtain that \\(f^{2}(x)=x\\). Thus \\(P(x, y)\\) now becomes the statement\n\\[\nP(x, y): \\quad f(x)=f(x+y) \\cdot[1+f(x f(y))] .\n\\]\n\nIn particular\n\\[\nP(1, y) \\Longrightarrow f(1+y)=\\frac{f(1)}{1+y}\n\\]\nso \\(f\\) is determined on inputs greater than 1 . Finally, if \\(a, b>1\\) we get\n\\[\nP(a, b) \\Longrightarrow \\frac{1}{a}=\\frac{1}{a+b} \\cdot\\left[1+f\\left(\\frac{a}{b} f(1)\\right)\\right]\n\\]\nwhich is enough to determine \\(f\\) on all inputs, by varying \\((a, b)\\).", "source_pdf": "USAMO_2022.pdf", "notes": ""}
{"id": "USAMO-2022-4", "contest": "USAMO", "year": "2022", "problem_number": "4", "problem": "Find all pairs of primes ( \\(p, q\\) ) for which \\(p-q\\) and \\(p q-q\\) are both perfect squares.", "solution": "The answer is \\((3,2)\\) only. This obviously works so we focus on showing it is the only one.\n\nIT Approach using difference of squares (from author). Set\n\\[\n\\begin{aligned}\na^{2} & =p-q \\\\\nb^{2} & =p q-q .\n\\end{aligned}\n\\]\n\nNote that \\(0<a<p\\), and \\(0<b<p\\) (because \\(q \\leq p\\) ). Now subtracting gives\n\\[\n\\underbrace{(b-a)}_{<p} \\underbrace{(b+a)}_{<2 p}=b^{2}-a^{2}=p(q-1)\n\\]\n\nThe inequalities above now force \\(b+a=p\\). Hence \\(q-1=b-a\\).\nThis means \\(p\\) and \\(q-1\\) have the same parity, which can only occur if \\(q=2\\). Finally, taking \\(\\bmod 3\\) shows \\(p \\equiv 0(\\bmod 3)\\). So ( 3,2 ) is the only possibility (and it does work).\n\nDivisibility approach (Aharshi Roy). Since \\(p q-q=q(p-1)\\) is a square, it follows that \\(q\\) divides \\(p-1\\) and that \\(\\frac{p-1}{q}\\) is a perfect square too. Hence the number\n\\[\ns^{2}:=(p-q) \\cdot \\frac{p-1}{q}=\\frac{p^{2}-q p-p+q}{q}\n\\]\nis also a perfect square. Rewriting this equation gives\n\\[\nq=\\frac{p^{2}-p}{s^{2}+(p-1)}\n\\]\n\nIn particular, \\(s^{2}+(p-1)\\) divides \\(p^{2}-p\\), and in particular \\(s \\leq p\\). We consider two cases:\n- If \\(s^{2}+(p-1)\\) is not divisible by \\(p\\), then it must divide \\(p-1\\), which can only happen if \\(s^{2}=0\\), or \\(p=q\\). However, it's easy to check there are no solutions in this case.\n- Otherwise, we should have \\(s^{2} \\equiv 1(\\bmod p)\\), so either \\(s=1\\) or \\(s=p-1\\). If \\(s=p-1\\) we get \\(q=1\\) which is absurd. On the other hand, if \\(s=1\\) we conclude \\(q=p-1\\) and hence \\(q=2, p=3\\).", "source_pdf": "USAMO_2022.pdf", "notes": ""}
{"id": "USAMO-2022-5", "contest": "USAMO", "year": "2022", "problem_number": "5", "problem": "A function \\(f: \\mathbb{R} \\rightarrow \\mathbb{R}\\) is essentially increasing if \\(f(s) \\leq f(t)\\) holds whenever \\(s \\leq t\\) are real numbers such that \\(f(s) \\neq 0\\) and \\(f(t) \\neq 0\\).\nFind the smallest integer \\(k\\) such that for any 2022 real numbers \\(x_{1}, x_{2}, \\ldots, x_{2022}\\), there exist \\(k\\) essentially increasing functions \\(f_{1}, \\ldots, f_{k}\\) such that\n\\[\nf_{1}(n)+f_{2}(n)+\\cdots+f_{k}(n)=x_{n} \\quad \\text { for every } n=1,2, \\ldots, 2022 .\n\\]", "solution": "The answer is 11 and, more generally, if 2022 is replaced by \\(N\\) then the answer is \\(\\left\\lfloor\\log _{2} N\\right\\rfloor+1\\).\n\nBound. Suppose for contradiction that \\(2^{k}-1>N\\) and choose \\(x_{n}=-n\\) for each \\(n=1, \\ldots, N\\). Now for each index \\(1 \\leq n \\leq N\\), define\n\\[\nS(n)=\\left\\{\\text { indices } i \\text { for which } f_{i}(n) \\neq 0\\right\\} \\subseteq\\{1, \\ldots, k\\}\n\\]\n\nAs each \\(S(n t)\\) is nonempty, by pigeonhole, two \\(S(n)\\) 's coincide, say \\(S(n)=S\\left(n^{\\prime}\\right)\\) for \\(n<n^{\\prime}\\). But it's plainly impossible that \\(x_{n}>x_{n^{\\prime}}\\) in that case due to the essentially increasing condition.\n\nI Construction. It suffices to do \\(N=2^{k}-1\\). Rather than drown the reader in notation, we'll just illustrate an example of the (inductive) construction for \\(k=4\\). Empty cells are zero.\n\n\\begin{tabular}{|l|l|l|l|l|}\n\\hline & \\(f_{1}\\) & \\(f_{2}\\) & \\(f_{3}\\) & \\(f_{4}\\) \\\\\n\\hline \\(x_{1}=3\\) & 3 & & & \\\\\n\\hline \\(x_{2}=1\\) & 10 & -9 & & \\\\\n\\hline \\(x_{3}=4\\) & \\multicolumn{4}{|c|}{4} \\\\\n\\hline \\(x_{4}=1\\) & 100 & 200 & -299 & \\\\\n\\hline \\(x_{5}=5\\) & & 200 & -195 & \\\\\n\\hline \\(x_{6}=9\\) & 100 & & -91 & \\\\\n\\hline \\(x_{7}=2\\) & \\multicolumn{4}{|c|}{2} \\\\\n\\hline \\(x_{8}=6\\) & 1000 & 2000 & 4000 & -6994 \\\\\n\\hline \\(x_{9}=5\\) & & 2000 & 4000 & -5995 \\\\\n\\hline \\(x_{10}=3\\) & 1000 & & 4000 & -4997 \\\\\n\\hline \\(x_{11}=5\\) & & & 4000 & -3995 \\\\\n\\hline \\(x_{12}=8\\) & 1000 & 2000 & & -2992 \\\\\n\\hline \\(x_{13}=9\\) & & 2000 & & -1991 \\\\\n\\hline \\(x_{14}=7\\) & 1000 & & & -993 \\\\\n\\hline \\(x_{15}=9\\) & \\multicolumn{4}{|r|}{9} \\\\\n\\hline\n\\end{tabular}\n\nThe general case is handled in the same way with powers of 10 replaced by powers of \\(B\\), for a sufficiently large number \\(B\\).", "source_pdf": "USAMO_2022.pdf", "notes": ""}
{"id": "USAMO-2022-6", "contest": "USAMO", "year": "2022", "problem_number": "6", "problem": "There are 2022 users on a social network called Mathbook, and some of them are Mathbook-friends. (On Mathbook, friendship is always mutual and permanent.)\nStarting now, Mathbook will only allow a new friendship to be formed between two users if they have at least two friends in common. What is the minimum number of friendships that must already exist so that every user could eventually become friends with every other user?", "solution": "With 2022 replaced by \\(n\\), the answer is \\(\\left\\lceil\\frac{3}{2} n\\right\\rceil-2\\).\n\nIT Terminology. Standard graph theory terms: starting from a graph \\(G\\) on \\(n\\) vertices, we're allowed to take any \\(C_{4}\\) in the graph and complete it to a \\(K_{4}\\). The problem asks the minimum number of edges needed so that this operation lets us transform \\(G\\) to \\(K_{n}\\).\n\nIT Construction. For even \\(n\\), start with an edge \\(a b\\), and then create \\(n / 2-1\\) copies of \\(C_{4}\\) that use \\(a b\\) as an edge, as shown below for \\(n=14\\) (six copies of \\(C_{4}\\) ).\n\nThis can be completed into \\(K_{n}\\) by first completing the \\(n / 2-1 C_{4}\\) 's into \\(K_{4}\\), then connecting red vertices to every gray vertex, and then finishing up.\n\nThe construction for odd \\(n\\) is the same except with one extra vertex \\(c\\) which is connected to both \\(a\\) and \\(b\\).\n\nI Bound. Notice that additional operations or connections can never hurt. So we will describe a specific algorithm that performs operations on the graph until no more operations are possible. This means that if this algorithm terminates with anything other \\(G=K_{n}\\), the graph was never completable to \\(K_{n}\\) to begin with.\n\nThe algorithm uses the following data: it keeps a list \\(\\mathcal{C}\\) of cliques of \\(G\\), and a labeling \\(\\mathcal{L}: E(G) \\rightarrow \\mathcal{C}\\) which assigns to every edge one of the cliques that contains it.\n- Initially, \\(\\mathcal{C}\\) consists of one \\(K_{2}\\) for every edge of \\(G\\), and each edge is labeled in the obvious way.\n- At each step, the algorithm arbitrarily takes any \\(C_{4}=a b c d\\) whose four edges \\(a b\\), \\(b c, c d, d a\\) do not all have the same label. Consider these labels that appear (at least two, and up to four), and let \\(V\\) be the union of all vertices in any of these 2-4 cliques.\n- Do the following graph operations: connect \\(a c\\) and \\(b d\\), then connect every vertex in \\(V-\\{a, b, c, d\\}\\) to each of \\(\\{a, b, c, d\\}\\). Finally, complete this to a clique on \\(V\\).\n- Update \\(\\mathcal{C}\\) by merging these \\(2-4\\) cliques into a single clique \\(K_{V}\\).\n- Update \\(\\mathcal{L}\\) by replacing every edge that was labeled with one of these \\(2-4\\) cliques with the label \\(K_{V}\\). Also, update every newly created edge to have label \\(K_{V}\\). However, if there were existing edges not labeled with one of the \\(2-4\\) cliques, then we do not update these!\n- Stop once every \\(C_{4}\\) has only one label appearing among its edges. When this occurs, no operations are possible at all on the graph.\n\nA few steps of the process are illustrated below for a graph on six vertices with nine initial edges. There are initially nine \\(K_{2}\\) 's labeled A, B, ..., I. Original edges are always bolder than added edges. The relabeled edges in each step are highlighted in color. Notice how we need an entirely separate operation to get G to become L , even though no new edges are drawn in the graph.\n\nAs we remarked, if the graph is going to be completable to \\(K_{n}\\) at all, then this algorithm must terminate with \\(\\mathcal{C}=\\left\\{K_{n}\\right\\}\\). We will use this to prove our bound.\n\nWe proceed by induction in the following way. For a clique \\(K\\), let \\(\\theta(K)\\) denote the number of edges of the original graph \\(G\\) which are labeled by \\(K\\) (this does not include new edges added by the algorithm); hence the problem amounts to estimating how small \\(\\theta\\left(K_{n}\\right)\\) can be. We are trying to prove:\n\nClaim - At any point in the operation, if \\(K\\) is a clique in the cover \\(\\mathcal{C}\\), then\n\\[\n\\theta(K) \\geq \\frac{3|K|}{2}-2\n\\]\nwhere \\(|K|\\) is the number of vertices in \\(K\\).\n\nProof. By induction on the time step of the algorithm. The base case is clear, because then \\(K\\) is just a single edge of \\(G\\), so \\(\\theta(K)=1\\) and \\(|K|=2\\).\n\nThe inductive step is annoying casework based on the how the merge occurred. Let \\(C_{4}=a b c d\\) be the 4 -cycle operated on. In general, the \\(\\theta\\) value of a newly created \\(K\\) is exactly the sum of the \\(\\theta\\) values of the merged cliques, by definition. Meanwhile, \\(|K|\\) is the number of vertices in the union of the merged cliques; so it's the sum of the sizes of these cliques minus some error due to overcounting of vertices appearing more than once. To be explicit:\n- Suppose we merged four cliques \\(W, X, Y, Z\\). By definition,\n\\[\n\\begin{aligned}\n\\theta(K) & =\\theta(W)+\\theta(X)+\\theta(Y)+\\theta(Z) \\\\\n& \\geq \\frac{3}{2}(|W|+|X|+|Y|+|Z|)-8=\\frac{3}{2}(|W|+|X|+|Y|+|Z|-4)-2\n\\end{aligned}\n\\]\n\nOn the other hand \\(|K| \\leq|W|+|X|+|Y|+|Z|-4\\); the -4 term comes from each of \\(\\{a, b, c, d\\}\\) being in two (or more) of \\(\\{W, X, Y, Z\\}\\). So this case is OK.\n- Suppose we merged three cliques \\(X, Y, Z\\). By definition,\n\\[\n\\begin{aligned}\n\\theta(K) & =\\theta(X)+\\theta(Y)+\\theta(Z) \\\\\n& \\geq \\frac{3}{2}(|X|+|Y|+|Z|)-6=\\frac{3}{2}\\left(|X|+|Y|+|Z|-\\frac{8}{3}\\right)-2\n\\end{aligned}\n\\]\n\nOn the other hand, \\(|K| \\leq|X|+|Y|+|Z|-3\\), since at least 3 of \\(\\{a, b, c, d\\}\\) are repeated among \\(X, Y, Z\\). Note in this case the desired inequality is actually strict.\n- Suppose we merged two cliques \\(Y, Z\\). By definition,\n\\[\n\\begin{aligned}\n\\theta(K) & =\\theta(Y)+\\theta(Z) \\\\\n& \\geq \\frac{3}{2}(|Y|+|Z|)-4=\\frac{3}{2}\\left(|Y|+|Z|-\\frac{4}{3}\\right)-2\n\\end{aligned}\n\\]\n\nOn the other hand, \\(|K| \\leq|Y|+|Z|-2\\), since at least 2 of \\(\\{a, b, c, d\\}\\) are repeated among \\(Y, Z\\). Note in this case the desired inequality is actually strict.\n\nRemark. Several subtle variations of this method do not seem to work.\n- It does not seem possible to require the cliques in \\(\\mathcal{C}\\) to be disjoint, which is why it's necessary to introduce a label function \\(\\mathcal{L}\\) as well.\n- It seems you do have to label the newly created edges, even though they do not count towards any \\(\\theta\\) value. Otherwise the termination of the algorithm doesn't tell you enough.\n- Despite this, relabeling existing edges, like G in step 1 of the example, 1 seems to cause a lot of issues. The induction becomes convoluted if \\(\\theta(K)\\) is not exactly the sum of \\(\\theta\\)-values of the subparts, while the disappearance of an edge from a clique will\nalso break induction.", "source_pdf": "USAMO_2022.pdf", "notes": ""}
{"id": "USAMO-2023-1", "contest": "USAMO", "year": "2023", "problem_number": "1", "problem": "In an acute triangle \\(A B C\\), let \\(M\\) be the midpoint of \\(\\overline{B C}\\). Let \\(P\\) be the foot of the perpendicular from \\(C\\) to \\(A M\\). Suppose that the circumcircle of triangle \\(A B P\\) intersects line \\(B C\\) at two distinct points \\(B\\) and \\(Q\\). Let \\(N\\) be the midpoint of \\(\\overline{A Q}\\). Prove that \\(N B=N C\\).", "solution": "We show several different approaches. In all solutions, let \\(D\\) denote the foot of the altitude from \\(A\\). The solution hinges on the following claim: Claim - \\(Q\\) coincides with the reflection of \\(D\\) across \\(M\\). Proof. Note that \\(\\measuredangle A D C=\\measuredangle A P C=90^{\\circ}\\), so \\(A D P C\\) is cyclic. Then by power of a point (with the lengths directed), \\[ M B \\cdot M Q=M A \\cdot M P=M C \\cdot M D \\] Since \\(M B=M C\\), the claim follows. It follows that \\(\\overline{M N} \\| \\overline{A D}\\), as \\(M\\) and \\(N\\) are respectively the midpoints of \\(\\overline{A Q}\\) and \\(\\overline{D Q}\\). Thus \\(\\overline{M N} \\perp \\overline{B C}\\), and so \\(N\\) lies on the perpendicular bisector of \\(\\overline{B C}\\), as needed.", "source_pdf": "USAMO_2023.pdf", "notes": ""}
{"id": "USAMO-2023-2", "contest": "USAMO", "year": "2023", "problem_number": "2", "problem": "Solve over the positive real numbers the functional equation \\[ f(x y+f(x))=x f(y)+2 \\]", "solution": "The answer is \\(f(x) \\equiv x+1\\), which is easily verified to be the only linear solution. We show conversely that \\(f\\) is linear. Let \\(P(x, y)\\) be the assertion. Claim - \\(f\\) is weakly increasing. Proof. Assume for contradiction \\(a>b\\) but \\(f(a)<f(b)\\). Choose \\(y\\) such that \\(a y+f(a)= b y+f(b)\\), that is \\(y=\\frac{f(b)-f(a)}{a-b}\\). Then \\(P(a, y)\\) and \\(P(b, y)\\) gives \\(a f(y)+2=b f(y)+2\\), which is impossible. Claim (Up to an error of 2, \\(f\\) is linear) - We have \\[ |f(x)-(K x+C)| \\leq 2 \\] where \\(K:=\\frac{2}{f(1)}\\) and \\(C:=f(2 f(1))-2\\) are constants. Proof. Note \\(P(1, y)\\) gives \\(f(y+f(1))=f(y)+2\\). Hence, \\(f(n f(1))=2(n-1)+f(f(1))\\) for \\(n \\geq 1\\). Combined with weakly increasing, this gives \\[ 2\\left\\lfloor\\frac{x}{f(1)}\\right\\rfloor+C \\leq f(x) \\leq 2\\left\\lceil\\frac{x}{f(1)}\\right\\rceil+C \\] which implies the result. However, we will only need to remember from the earlier claim that \\[ f(x)=K x+O(1) \\] Then for any \\(x\\) and \\(y\\), the above claim gives \\[ K(x y+K x+O(1))+O(1)=x f(y)+2 \\] which means that \\[ x \\cdot\\left(K y+K^{2}-f(y)\\right)=O(1) . \\] If we fix \\(y\\) and consider large \\(x\\), we see this can only happen if \\(K y+K^{2}-f(y)=0\\), i.e. \\(f\\) is linear.", "source_pdf": "USAMO_2023.pdf", "notes": ""}
{"id": "USAMO-2023-3", "contest": "USAMO", "year": "2023", "problem_number": "3", "problem": "Consider an \\(n\\)-by- \\(n\\) board of unit squares for some odd positive integer \\(n\\). We say that a collection \\(C\\) of identical dominoes is a maximal grid-aligned configuration on the board if \\(C\\) consists of \\(\\left(n^{2}-1\\right) / 2\\) dominoes where each domino covers exactly two neighboring squares and the dominoes don't overlap: \\(C\\) then covers all but one square on the board. We are allowed to slide (but not rotate) a domino on the board to cover the uncovered square, resulting in a new maximal grid-aligned configuration with another square uncovered. Let \\(k(C)\\) be the number of distinct maximal grid-aligned configurations obtainable from \\(C\\) by repeatedly sliding dominoes. Find all possible values of \\(k(C)\\) as a function of \\(n\\).", "solution": "The answer is that \\[ k(C) \\in\\left\\{1,2, \\ldots,\\left(\\frac{n-1}{2}\\right)^{2}\\right\\} \\cup\\left\\{\\left(\\frac{n+1}{2}\\right)^{2}\\right\\} . \\] Index the squares by coordinates \\((x, y) \\in\\{1,2, \\ldots, n\\}^{2}\\). We say a square is special if it is empty or it has the same parity in both coordinates as the empty square. We now proceed in two cases: IT The special squares have both odd coordinates. We construct a directed graph \\(G=G(C)\\) whose vertices are special squares as follows: for each domino on a special square \\(s\\), we draw a directed edge from \\(s\\) to the special square that domino points to. Thus all special squares have an outgoing edge except the empty cell. Claim - Any undirected connected component of \\(G\\) is acyclic unless the cycle contains the empty square inside it. Proof. Consider a cycle of \\(G\\); we are going to prove that the number of chessboard cells enclosed is always odd. This can be proven directly by induction, but for theatrical effect, we use Pick's theorem. Mark the center of every chessboard cell on or inside the cycle to get a lattice. The dominoes of the cycle then enclose a polyominoe which actually consists of \\(2 \\times 2\\) squares, meaning its area is a multiple of 4 . Hence \\(B / 2+I-1\\) is a multiple of 4 , in the notation of Pick's theorem. As \\(B\\) is twice the number of dominoes, and a parity argument on the special squares shows that number is even, it follows that \\(B\\) is also a multiple of 4 (these correspond to blue and black in the figure above). This means \\(I\\) is odd (the red dots in the figure above), as desired. Let \\(T\\) be the connected component containing the empty cell. By the claim, \\(T\\) is acyclic, so it's a tree. Now, notice that all the arrows point along \\(T\\) towards the empty cell, and moving a domino corresponds to flipping an arrow. Therefore: Claim - \\(k(C)\\) is exactly the number of vertices of \\(T\\). Proof. Starting with the underlying tree, the set of possible graphs is described by picking one vertex to be the sink (the empty cell) and then directing all arrows towards it. This implies that \\(k(C) \\leq\\left(\\frac{n+1}{2}\\right)^{2}\\) in this case. Equality is achieved if \\(T\\) is a spanning tree of \\(G\\). One example of a way to achieve this is using the snake configuration below. Conversely, suppose \\(T\\) was not a spanning tree, i.e. \\(T \\neq G\\). Since in this odd-odd case, \\(G\\) has one fewer edge than vertex, if \\(G\\) is not a tree, then it must contain at least one cycle. That cycle encloses every special square of \\(T\\). In particular, this means that \\(T\\) can't contain any special squares from the outermost row or column of the \\(n \\times n\\) grid. In this situation, we therefore have \\(k(C) \\leq\\left(\\frac{n-3}{2}\\right)^{2}\\). IT The special squares have both even coordinates. We construct the analogous graph \\(G\\) on the same special squares. However, in this case, some of the points may not have outgoing edges, because their domino may \"point\" outside the grid. As before, the connected component \\(T\\) containing the empty square is a tree, and \\(k(C)\\) is exactly the number of vertices of \\(T\\). Thus to finish the problem we need to give, for each \\(k \\in\\left\\{1,2, \\ldots,\\left(\\frac{n-1}{2}\\right)^{2}\\right\\}\\), an example of a configuration where \\(G\\) has exactly \\(k\\) vertices. The construction starts with a \"snake\" picture for \\(k=\\left(\\frac{n-1}{2}\\right)^{2}\\), then decreases \\(k\\) by one by perturbing a suitable set of dominoes. Rather than write out the procedure in words, we show the sequence of nine pictures for \\(n=7\\) (where \\(k=9,8, \\ldots, 1\\) ); the generalization to larger \\(n\\) is straightforward.", "source_pdf": "USAMO_2023.pdf", "notes": ""}
{"id": "USAMO-2023-4", "contest": "USAMO", "year": "2023", "problem_number": "4", "problem": "Positive integers \\(a\\) and \\(N\\) are fixed, and \\(N\\) positive integers are written on a blackboard. Alice and Bob play the following game. On Alice's turn, she must replace some integer \\(n\\) on the board with \\(n+a\\), and on Bob's turn he must replace some even integer \\(n\\) on the board with \\(n / 2\\). Alice goes first and they alternate turns. If on his turn Bob has no valid moves, the game ends. After analyzing the \\(N\\) integers on the board, Bob realizes that, regardless of what moves Alice makes, he will be able to force the game to end eventually. Show that, in fact, for this value of \\(a\\) and these \\(N\\) integers on the board, the game is guaranteed to end regardless of Alice's or Bob's moves.", "solution": "For \\(N=1\\), there is nothing to prove. We address \\(N \\geq 2\\) only henceforth. Let \\(S\\) denote the numbers on the board. Claim - When \\(N \\geq 2\\), if \\(\\nu_{2}(x)<\\nu_{2}(a)\\) for all \\(x \\in S\\), the game must terminate no matter what either player does. Proof. The \\(\\nu_{2}\\) of a number is unchanged by Alice's move and decreases by one on Bob's move. The game ends when every \\(\\nu_{2}\\) is zero. Hence, in fact the game will always terminate in exactly \\(\\sum_{x \\in S} \\nu_{2}(x)\\) moves in this case, regardless of what either player does. Claim - When \\(N \\geq 2\\), if there exists a number \\(x\\) on the board such that \\(\\nu_{2}(x) \\geq \\nu_{2}(a)\\), then Alice can cause the game to go on forever. Proof. Denote by \\(x\\) the first entry of the board (its value changes over time). Then Alice's strategy is to: - Operate on the first entry if \\(\\nu_{2}(x)=\\nu_{2}(a)\\) (the new entry thus has \\(\\nu_{2}(x+a)>\\nu_{2}(a)\\) ); - Operate on any other entry besides the first one, otherwise. A double induction then shows that - Just before each of Bob's turns, \\(\\nu_{2}(x)>\\nu_{2}(a)\\) always holds; and - After each of Bob's turns, \\(\\nu_{2}(x) \\geq \\nu_{2}(a)\\) always holds. In particular Bob will never run out of legal moves, since halving \\(x\\) is always legal.", "source_pdf": "USAMO_2023.pdf", "notes": ""}
{"id": "USAMO-2023-5", "contest": "USAMO", "year": "2023", "problem_number": "5", "problem": "Let \\(n \\geq 3\\) be an integer. We say that an arrangement of the numbers \\(1,2, \\ldots, n^{2}\\) in an \\(n \\times n\\) table is row-valid if the numbers in each row can be permuted to form an arithmetic progression, and column-valid if the numbers in each column can be permuted to form an arithmetic progression. For what values of \\(n\\) is it possible to transform any row-valid arrangement into a column-valid arrangement by permuting the numbers in each row?", "solution": "Answer: \\(n\\) prime only. IT Proof for \\(n\\) prime. Suppose \\(n=p\\). In an arithmetic progression with \\(p\\) terms, it's easy to see that either every term has a different residue modulo \\(p\\) (if the common difference is not a multiple of \\(p\\) ), or all of the residues coincide (when the common difference is a multiple of \\(p\\) ). So, look at the multiples of \\(p\\) in a row-valid table; there is either 1 or \\(p\\) per row. As there are \\(p\\) such numbers total, there are two cases: - If all the multiples of \\(p\\) are in the same row, then the common difference in each row is a multiple of \\(p\\). In fact, it must be exactly \\(p\\) for size reasons. In other words, up to permutation the rows are just the \\(k(\\bmod p)\\) numbers in some order, and this is obviously column-valid because we can now permute such that the \\(k\\) th column contains exactly \\(\\{(k-1) p+1,(k-1) p+2, \\ldots, k p\\}\\). - If all the multiples of \\(p\\) are in different rows, then it follows each row contains every residue modulo \\(p\\) exactly once. So we can permute to a column-valid arrangement by ensuring the \\(k\\) th column contains all the \\(k(\\bmod p)\\) numbers. I Counterexample for \\(n\\) composite (due to Anton Trygub). Let \\(p\\) be any prime divisor of \\(n\\). Construct the table as follows: - Row 1 contains 1 through \\(n\\). - Rows 2 through \\(p+1\\) contain the numbers from \\(p+1\\) to \\(n p+n\\) partitioned into arithmetic progressions with common difference \\(p\\). - The rest of the rows contain the remaining numbers in reading order. For example, when \\(p=2\\) and \\(n=10\\), we get the following table: \\[ \\left[\\begin{array}{cccccccccc} 1 & 2 & 3 & 4 & 5 & 6 & 7 & 8 & 9 & 10 \\\\ \\mathbf{1 1} & \\mathbf{1 3} & \\mathbf{1 5} & \\mathbf{1 7} & \\mathbf{1 9} & \\mathbf{2 1} & \\mathbf{2 3} & \\mathbf{2 5} & \\mathbf{2 7} & \\mathbf{2 9} \\\\ \\mathbf{1 2} & \\mathbf{1 4} & \\mathbf{1 6} & \\mathbf{1 8} & \\mathbf{2 0} & \\mathbf{2 2} & \\mathbf{2 4} & \\mathbf{2 6} & \\mathbf{2 8} & \\mathbf{3 0} \\\\ 31 & 32 & 33 & 34 & 35 & 36 & 37 & 38 & 39 & 40 \\\\ 41 & 42 & 43 & 44 & 45 & 46 & 47 & 48 & 49 & 50 \\\\ 51 & 52 & 53 & 54 & 55 & 56 & 57 & 58 & 59 & 60 \\\\ 61 & 62 & 63 & 64 & 65 & 66 & 67 & 68 & 69 & 70 \\\\ 71 & 72 & 73 & 74 & 75 & 76 & 77 & 78 & 79 & 80 \\\\ 81 & 82 & 83 & 84 & 85 & 86 & 87 & 88 & 89 & 90 \\\\ 91 & 92 & 93 & 94 & 95 & 96 & 97 & 98 & 99 & 100 \\end{array}\\right] \\] We claim this works fine. Assume for contradiction the rows may be permuted to obtain a column-valid arrangement. Then the \\(n\\) columns should be arithmetic progressions whose smallest element is in \\([1, n]\\) and whose largest element is in \\(\\left[n^{2}-n+1, n^{2}\\right]\\). These two elements must be congruent modulo \\(n-1\\), so in particular the column containing 2 must end with \\(n^{2}-n+2\\). Hence in that column, the common difference must in fact be exactly \\(n\\). And yet \\(n+2\\) and \\(2 n+2\\) are in the same row, contradiction.", "source_pdf": "USAMO_2023.pdf", "notes": ""}
{"id": "USAMO-2023-6", "contest": "USAMO", "year": "2023", "problem_number": "6", "problem": "Let \\(A B C\\) be a triangle with incenter \\(I\\) and excenters \\(I_{a}, I_{b}, I_{c}\\) opposite \\(A, B\\), and \\(C\\), respectively. Given an arbitrary point \\(D\\) on the circumcircle of \\(\\triangle A B C\\) that does not lie on any of the lines \\(I I_{a}, I_{b} I_{c}\\), or \\(B C\\), suppose the circumcircles of \\(\\triangle D I I_{a}\\) and \\(\\triangle D I_{b} I_{c}\\) intersect at two distinct points \\(D\\) and \\(F\\). If \\(E\\) is the intersection of lines \\(D F\\) and \\(B C\\), prove that \\(\\angle B A D=\\angle E A C\\).", "solution": "Here are two approaches. IT Barycentric coordinates (Carl Schildkraut). With reference triangle \\(\\triangle A B C\\), set \\(D=(r: s: t)\\). Claim - The equations of ( \\(D I I_{a}\\) ) and ( \\(D I_{b} I_{c}\\) ) are, respectively, \\[ \\begin{aligned} & 0=-a^{2} y z-b^{2} z x-c^{2} x y+(x+y+z) \\cdot\\left(b c x-\\frac{b c r}{c s-b t}(c y-b z)\\right) \\\\ & 0=-a^{2} y z-b^{2} z x-c^{2} x y+(x+y+z) \\cdot\\left(-b c x+\\frac{b c r}{c s+b t}(c y+b z)\\right) . \\end{aligned} \\] Proof. Since \\(D \\in(A B C)\\), we have \\(a^{2} s t+b^{2} t r+c^{2} r s=0\\). Now each equation can be verified by direct substitution of three points. By EGMO Lemma 7.24, the radical axis is then given by \\[ \\overline{D F}: b c x-\\frac{b c r}{c s-b t}(c y-b z)=-b c x+\\frac{b c r}{c s+b t}(c y+b z) . \\] Now the point \\[ \\left(0: \\frac{b^{2}}{s}: \\frac{c^{2}}{t}\\right)=\\left(0: b^{2} t: c^{2} s\\right) \\] lies on line \\(D F\\) by inspection, and is obviously on line \\(B C\\), hence it coincides with \\(E\\). This lies on the isogonal of \\(\\overline{A D}\\) (by EGMO Lemma 7.6), as needed. IT Synthetic approach (Anant Mudgal). Focus on just ( \\(D I I_{a}\\) ). Let \\(P\\) be the second intersection of ( \\(D I I_{a}\\) ) with ( \\(A B C\\) ), and let \\(M\\) be the midpoint of minor arc \\(\\widehat{B C}\\). Then by radical axis, lines \\(A M, D P\\), and \\(B C\\) are concurrent at a point \\(K\\). Let \\(E^{\\prime}=\\overline{P M} \\cap \\overline{B C}\\). Claim - We have \\(\\measuredangle B A D=\\measuredangle E^{\\prime} A C\\). Proof. By shooting lemma, \\(A K E^{\\prime} P\\) is cyclic, so \\[ \\measuredangle K A E^{\\prime}=\\measuredangle K P E^{\\prime}=\\measuredangle D P M=\\measuredangle D A M . \\] Claim - The power of point \\(E^{\\prime}\\) with respect to ( \\(D I I_{a}\\) ) is \\(2 E^{\\prime} B \\cdot E^{\\prime} C\\). Proof. Construct parallelogram \\(I E^{\\prime} I_{a} X\\). Since \\(M I^{2}=M E^{\\prime} \\cdot M P\\), we can get \\[ \\measuredangle X I_{a} I=\\measuredangle I_{a} I E^{\\prime}=\\measuredangle M I E^{\\prime}=\\measuredangle M P I=\\measuredangle X P I . \\] Hence \\(X\\) lies on ( \\(D I I_{a}\\) ), and \\(E^{\\prime} X \\cdot E^{\\prime} P=2 E^{\\prime} M \\cdot E^{\\prime} P=2 E^{\\prime} B \\cdot E^{\\prime} C\\). Repeat the argument on \\(\\left(D I_{b} I_{c}\\right)\\); the same point \\(E^{\\prime}\\) (because of the first claim) then has power \\(2 E^{\\prime} B \\cdot E^{\\prime} C\\) with respect to \\(\\left(D I_{b} I_{c}\\right)\\). Hence \\(E^{\\prime}\\) lies on the radical axis of ( \\(D I I_{a}\\) ) and \\(\\left(D I_{b} I_{c}\\right)\\), ergo \\(E^{\\prime}=E\\). The first claim then solves the problem.", "source_pdf": "USAMO_2023.pdf", "notes": ""}
{"id": "USAMO-2024-1", "contest": "USAMO", "year": "2024", "problem_number": "1", "problem": "Find all integers \\(n \\geq 3\\) such that the following property holds: if we list the divisors of \\(n!\\) in increasing order as \\(1=d_{1}<d_{2}<\\cdots<d_{k}=n!\\), then we have \\[ d_{2}-d_{1} \\leq d_{3}-d_{2} \\leq \\cdots \\leq d_{k}-d_{k-1} \\]", "solution": "The answer is \\(n \\in\\{3,4\\}\\). These can be checked by listing all the divisors: - For \\(n=3\\) we have \\((1,2,3,6)\\). - For \\(n=4\\) we have \\((1,2,3,4,6,8,12,24)\\). We prove these are the only ones. The numbers \\(5 \\leq n \\leq 12\\) all fail because: - For \\(n=5\\) we have \\(20-15>24-20\\). - For \\(n=6\\) we have \\(120-90>144-20\\). - For \\(7 \\leq n \\leq 12\\) we have because \\(14-12>15-14\\) (and \\(13 \\nmid n!\\) ). Now assume \\(n \\geq 13\\). In that case, we have \\[ \\left\\lfloor\\frac{n}{2}\\right\\rfloor^{2}-1 \\geq 2 n . \\] So by Bertrand postulate, we can find a prime \\(p\\) such that \\[ n<p<\\left\\lfloor\\frac{n}{2}\\right\\rfloor^{2}-1 . \\] However, note that \\[ \\left\\lfloor\\frac{n}{2}\\right\\rfloor^{2}-1=\\left(\\left\\lfloor\\frac{n}{2}\\right\\rfloor-1\\right)\\left(\\left\\lfloor\\frac{n}{2}\\right\\rfloor+1\\right), \\quad\\left\\lfloor\\frac{n}{2}\\right\\rfloor^{2} \\] are consecutive integers both dividing \\(n!\\) (the latter number divides \\(\\left\\lfloor\\frac{n}{2}\\right\\rfloor \\cdot\\left(2\\left\\lfloor\\frac{n}{2}\\right\\rfloor\\right)\\) ). So the prime \\(p\\) causes the desired contradiction.", "source_pdf": "USAMO_2024.pdf", "notes": ""}
{"id": "USAMO-2024-2", "contest": "USAMO", "year": "2024", "problem_number": "2", "problem": "Let \\(S_{1}, S_{2}, \\ldots, S_{100}\\) be finite sets of integers whose intersection is not empty. For each non-empty \\(T \\subseteq\\left\\{S_{1}, S_{2}, \\ldots, S_{100}\\right\\}\\), the size of the intersection of the sets in \\(T\\) is a multiple of \\(|T|\\). What is the smallest possible number of elements which are in at least 50 sets?", "solution": "The answer is \\(50\\binom{100}{50}\\). IT Rephrasing (cosmetic translation only, nothing happens yet). We encode with binary strings \\(v \\in \\mathbb{F}_{2}^{100}\\) of length 100 . Write \\(v \\subseteq w\\) if \\(w\\) has 1 's in every component \\(v\\) does, and let \\(|v|\\) denote the number of 1 's in \\(v\\). Then for each \\(v\\), we let \\(f(v)\\) denote the number of elements \\(x \\in \\bigcup S_{i}\\) such that \\(x \\in S_{i} \\Longleftrightarrow v_{i}=1\\). For example, - \\(f(1 \\ldots 1)\\) denotes \\(\\left|\\bigcap_{1}^{100} S_{i}\\right|\\), so we know \\(f(1 \\ldots 1) \\equiv 0(\\bmod 100)\\). - \\(f(1 \\ldots 10)\\) denotes the number of elements in \\(S_{1}\\) through \\(S_{99}\\) but not \\(S_{100}\\) so we know that \\(f(1 \\ldots 1)+f(1 \\ldots 10) \\equiv 0(\\bmod 99)\\). - . . .And so on. So the problem condition means that \\(f(v)\\) translates to the statement \\[ P(u): \\quad|u| \\text { divides } \\sum_{v \\supseteq u} f(v) \\] for any \\(u \\neq 0 \\ldots 0\\), plus one extra condition \\(f(1 \\ldots 1)>0\\). And the objective function is to minimize the quantity \\[ A:=\\sum_{|v| \\geq 50} f(v) . \\] So the problem is transformed into an system of equations over \\(\\mathbb{Z}_{\\geq 0}\\) (it's clear any assignment of values of \\(f(v)\\) can be translated to a sequence ( \\(S_{1}, \\ldots, S_{100}\\) ) in the original notation). Note already that: Claim - It suffices to assign \\(f(v)\\) for \\(|v| \\geq 50\\). Proof. If we have found a valid assignment of values to \\(f(v)\\) for \\(|v| \\geq 50\\), then we can always arbitrarily assign values of \\(f(v)\\) for \\(|v|<50\\) by downwards induction on \\(|v|\\) to satisfy the divisibility condition (without changing \\(M\\) ). Thus, for the rest of the solution, we altogether ignore \\(f(v)\\) for \\(|v|<50\\) and only consider \\(P(u)\\) for \\(|u| \\geq 50\\). Construction. Consider the construction \\[ f_{0}(v)=2|v|-100 \\] This construction is valid since if \\(|u|=100-k\\) for \\(k \\leq 50\\) then \\[ \\begin{aligned} \\sum_{v \\supseteq u} f_{0}(v) & =\\binom{k}{0} \\cdot 100+\\binom{k}{1} \\cdot 98+\\binom{k}{2} \\cdot 96+\\cdots+\\binom{k}{k} \\cdot(100-2 k) \\\\ & =(100-k) \\cdot 2^{k}=|u| \\cdot 2^{k} \\end{aligned} \\] is indeed a multiple of \\(|u|\\), hence \\(P(u)\\) is true. In that case, the objective function is \\[ A=\\sum_{i=50}^{100}\\binom{100}{i}(2 i-100)=50\\binom{100}{50} \\] as needed. Remark. This construction is the \"easy\" half of the problem because it coincides with what you get from a greedy algorithm by downwards induction on \\(|u|\\) (equivalently, induction on \\(k=100-|u| \\geq 0\\) ). To spell out the first three steps, - We know \\(f(1 \\ldots 1)\\) is a nonzero multiple of 100 , so it makes sense to guess \\(f(1 \\ldots 1)=\\) 100. - Then we have \\(f(1 \\ldots 10)+100 \\equiv 0(\\bmod 99)\\), and the smallest multiple of 99 which is at least 100 is 198 . So it makes sense to guess \\(f(1 \\ldots 10)=98\\), and similarly guess \\(f(v)=98\\) whenever \\(|v|=99\\). - Now when we consider, say \\(v=1 \\ldots 100\\) with \\(|v|=98\\), we get \\[ f(1 \\ldots 100)+\\underbrace{f(1 \\ldots 101)}_{=98}+\\underbrace{f(1 \\ldots 110)}_{=98}+\\underbrace{f(1 \\ldots 111)}_{=100} \\equiv 0 \\quad(\\bmod 98) . \\] we obtain \\(f(1 \\ldots 100) \\equiv 96(\\bmod 98)\\). That makes \\(f(1 \\ldots 100)=96\\) a reasonable guess. Continuing in this way gives the construction above. Proof of bound. We are going to use a smoothing argument: if we have a general working assignment \\(f\\), we will mold it into \\(f_{0}\\). We define a push-down on \\(v\\) as the following operation: - Pick any \\(v\\) such that \\(|v| \\geq 50\\) and \\(f(v) \\geq|v|\\). - Decrease \\(f(v)\\) by \\(|v|\\). - For every \\(w\\) such that \\(w \\subseteq v\\) and \\(|w|=|v|-1\\), increase \\(f(w)\\) by 1 . Claim - Apply a push-down preserves the main divisibility condition. Moreover, it doesn't change \\(A\\) unless \\(|v|=50\\), where it decreases \\(A\\) by 50 instead. Proof. The statement \\(P(u)\\) is only affected when \\(u \\subseteq v\\) : to be precise, one term on the right-hand side of \\(P(u)\\) decreases by \\(|v|\\), while \\(|v|-|u|\\) terms increase by 1 , for a net change of \\(-|u|\\). So \\(P(u)\\) still holds. To see \\(A\\) doesn't change for \\(|v|>50\\), note \\(|v|\\) terms increase by 1 while one term decreases by \\(-|v|\\). When \\(|v|=50\\), only \\(f(v)\\) decreases by 50 . Now, given a valid assignment, we can modify it as follows: - First apply pushdowns on \\(1 \\ldots 1\\) until \\(f(1 \\ldots 1)=100\\); - Then we may apply pushdowns on each \\(v\\) with \\(|v|=99\\) until \\(f(v)<99\\); - Then we may apply pushdowns on each \\(v\\) with \\(|v|=98\\) until \\(f(v)<98\\); - . . . and so on, until we have \\(f(v)<50\\) for \\(|v|=50\\). Hence we get \\(f(1 \\ldots 1)=100\\) and \\(0 \\leq f(v)<|v|\\) for all \\(50 \\leq|v| \\leq 100\\). However, by downwards induction on \\(|v|=99,98, \\ldots, 50\\), we also have \\[ f(v) \\equiv f_{0}(v) \\quad(\\bmod |v|) \\Longrightarrow f(v)=f_{0}(v) \\] since \\(f_{0}(v)\\) and \\(f(v)\\) are both strictly less than \\(|v|\\). So in fact \\(f=f_{0}\\), and we're done. Remark. The fact that push-downs actually don't change \\(A\\) shows that the equality case we described is far from unique: in fact, we could have made nearly arbitrary sub-optimal decisions during the greedy algorithm and still ended up with an equality case. For a concrete example, the construction \\[ f(v)= \\begin{cases}500 & |v|=100 \\\\ 94 & |v|=99 \\\\ 100-2|v| & 50 \\leq|v| \\leq 98\\end{cases} \\] works fine as well (where we arbitrarily chose 500 at the start, then used the greedy algorithm thereafter).", "source_pdf": "USAMO_2024.pdf", "notes": ""}
{"id": "USAMO-2024-3", "contest": "USAMO", "year": "2024", "problem_number": "3", "problem": "Let \\((m, n)\\) be positive integers with \\(n \\geq 3\\) and draw a regular \\(n\\)-gon. We wish to triangulate this \\(n\\)-gon into \\(n-2\\) triangles, each colored one of \\(m\\) colors, so that each color has an equal sum of areas. For which \\((m, n)\\) is such a triangulation and coloring possible?", "solution": "The answer is if and only if \\(m\\) is a proper divisor of \\(n\\). Throughout this solution, we let \\(\\omega=\\exp (2 \\pi i / n)\\) and let the regular \\(n\\)-gon have vertices \\(1, \\omega, \\ldots, \\omega^{n-1}\\). We cache the following frequent calculation: Lemma The triangle with vertices \\(\\omega^{k}, \\omega^{k+a}, \\omega^{k+b}\\) has signed area \\[ T(a, b):=\\frac{\\left(\\omega^{a}-1\\right)\\left(\\omega^{b}-1\\right)\\left(\\omega^{-b}-\\omega^{-a}\\right)}{4 i} . \\] Proof. Rotate by \\(\\omega^{-k}\\) to assume WLOG that \\(k=0\\). Apply complex shoelace to the triangles with vertices \\(1, \\omega^{a}, \\omega^{b}\\) to get \\[ \\frac{i}{4} \\operatorname{det}\\left[\\begin{array}{ccc} 1 & 1 & 1 \\\\ \\omega^{a} & \\omega^{-a} & 1 \\\\ \\omega^{b} & \\omega^{-b} & 1 \\end{array}\\right]=\\frac{i}{4} \\operatorname{det}\\left[\\begin{array}{ccc} 0 & 0 & 1 \\\\ \\omega^{a}-1 & \\omega^{-a}-1 & 1 \\\\ \\omega^{b}-1 & \\omega^{-b}-1 & 1 \\end{array}\\right] \\] which equals the above. IT Construction. It suffices to actually just take all the diagonals from the vertex 1, and then color the triangles with the \\(m\\) colors in cyclic order. For example, when \\(n=9\\) and \\(m=3\\), a coloring with red, green, blue would be: ![](https://cdn.mathpix.com/cropped/2025_08_23_3e2b36edf2ab6bf632c2g-07.jpg?height=607&width=601&top_left_y=1881&top_left_x=733) To see this works one can just do the shoelace calculation: fix a residue \\(r \\bmod m\\) corresponding to one of the colors. Then \\[ \\begin{aligned} \\sum_{\\substack{0 \\leq j<n \\\\ j \\equiv r \\bmod m}} \\operatorname{Area}\\left(\\omega^{0}, \\omega^{j}, \\omega^{j+1}\\right) & =\\sum_{\\substack{0 \\leq j<n \\\\ j \\equiv r \\bmod m}} T(j, j+1) \\\\ & =\\sum_{\\substack{0 \\leq j<n \\\\ j \\equiv r \\bmod m}} \\frac{\\left(\\omega^{j}-1\\right)\\left(\\omega^{j+1}-1\\right)\\left(\\omega^{-(j+1)}-\\omega^{-j}\\right)}{4 i} \\\\ & =\\frac{\\omega-1}{4 i} \\sum_{\\substack{0 \\leq j<n \\\\ j \\equiv r \\bmod m}}\\left(\\omega^{-j}-1\\right)\\left(\\omega^{j}-\\omega^{-1}\\right) \\\\ & =\\frac{\\omega-1}{4 i}\\left(\\frac{n}{m}\\left(1+\\omega^{-1}\\right)+\\sum_{\\substack{0 \\leq j<n \\\\ j \\equiv r \\bmod m}}\\left(\\omega^{-1-j}-\\omega^{j}\\right)\\right) \\end{aligned} \\] (We allow degenerate triangles where \\(j \\in\\{0, m-1\\}\\) with area zero to simplify the notation above.) However, if \\(m\\) is a proper divisor of \\(m\\), then \\(\\sum_{j} \\omega^{j}=\\omega^{r}\\left(1+\\omega^{m}+\\omega^{2 m}+\\cdots+\\omega^{n-m}\\right)=0\\). For the same reason, \\(\\sum_{j} \\omega^{-1-j}=0\\). So the inner sum vanishes, and the total area of this color equals \\[ \\sum_{\\substack{0 \\leq j<n \\\\ j \\equiv r \\bmod m}} \\operatorname{Area}\\left(\\omega^{0}, \\omega^{j}, \\omega^{j+1}\\right)=\\frac{n}{m} \\frac{(\\omega-1)\\left(\\omega^{-1}+1\\right)}{4 i}=\\frac{n}{m} \\cdot \\frac{\\omega-\\omega^{-1}}{4 i} . \\] Because the right-hand side does not depend on the residue \\(r\\), this shows all colors have equal area. IT Proof of necessity. It's obvious that \\(m<n\\) (in fact \\(m \\leq n-2\\) ). So we focus on just showing \\(m \\mid n\\). Repeating the same calculation as above, we find that if there was a valid triangulation and coloring, the total area of each color would equal \\[ S:=\\frac{n}{m} \\cdot \\frac{\\omega-\\omega^{-1}}{4 i} \\] However: Claim - The number \\(4 i \\cdot S\\) is not an algebraic integer when \\(m \\nmid n\\). Proof. This is easiest to see if one knows the advanced result that \\(K:=\\mathbb{Q}(\\omega)\\) is a number field whose ring of integers is known to be \\(\\mathcal{O}_{K}=\\mathbb{Z}[\\omega]\\), in which case it follows right away. Remark. We spell out the details in the proof a bit more explicitly here. It's enough to show that \\(\\omega \\cdot 4 i \\cdot S=\\frac{n}{m} \\omega^{2}-\\frac{n}{m}\\) is not an algebraic integer for completeness. Take \\(K=\\mathbb{Q}(\\omega)\\) of degree \\(d:=\\varphi(n) \\geq 2\\); as a \\(\\mathbb{Q}\\)-module, it obeys \\(K=\\mathbb{Q} \\oplus \\omega \\mathbb{Q} \\oplus \\cdots \\oplus \\omega^{d-1} \\mathbb{Q}\\). The theorem we are quoting is that, as \\(\\mathbb{Z}\\)-modules, we have \\(\\mathcal{O}_{K}=\\mathbb{Z}[\\omega]=\\mathbb{Z} \\oplus \\omega \\mathbb{Z} \\oplus \\cdots \\oplus \\omega^{d-1} \\mathbb{Z}\\) i.e. \\(\\mathcal{O}_{K}\\) contains exactly those numbers in \\(K\\) for which the canonical \\(\\mathbb{Q}\\)-coefficients happen to be integers. (This is quite famous, but for a print reference, see Neukirch's Algebraic Number Theory, Section I.10.) And \\(\\omega \\cdot 4 i \\cdot S\\) fails this criteria, since \\(\\frac{n}{m} \\notin \\mathbb{Z}\\). However, for any \\(a\\) and \\(b\\), the number \\[ 4 i \\cdot T(a, b)=\\left(\\omega^{a}-1\\right)\\left(\\omega^{b}-1\\right)\\left(\\omega^{-b}-\\omega^{-a}\\right) \\] is an algebraic integer. Since a finite sum of algebraic integers is also an algebraic integer, the sum of expressions of the form \\(4 i \\cdot T(a, b)\\) will never equal \\(4 i \\cdot S\\). Remark. If one wants to avoid citing the fact that \\(\\mathcal{O}_{K}=\\mathbb{Z}[\\omega]\\), then one can instead note that \\(T(a, b)\\) is actually always divisible by \\((\\omega-1)\\left(\\omega^{-1}+1\\right)=\\omega-\\omega^{-1}\\) over the algebraic integers (at least one of \\(\\left\\{\\omega^{a}-1, \\omega^{b}-1, \\omega^{-a}-\\omega^{-b}\\right\\}\\) is a multiple of \\(\\omega+1\\), by casework on \\(a, b \\bmod 2)\\). Then one using \\(\\frac{4 i}{(\\omega-1)\\left(\\omega^{-1}+1\\right)}\\) as the scaling factor instead of \\(4 i\\), one sees that we actually need \\(\\frac{n}{m}\\) to be an algebraic integer. But a rational number is an algebraic integer if and only if it's a rational integer; so \\(\\frac{n}{m}\\) is an algebraic integer exactly when \\(m\\) divides \\(n\\).", "source_pdf": "USAMO_2024.pdf", "notes": ""}
{"id": "USAMO-2024-4", "contest": "USAMO", "year": "2024", "problem_number": "4", "problem": "Let \\(m\\) and \\(n\\) be positive integers. A circular necklace contains \\(m n\\) beads, each either red or blue. It turned out that no matter how the necklace was cut into \\(m\\) blocks of \\(n\\) consecutive beads, each block had a distinct number of red beads. Determine, with proof, all possible values of the ordered pair \\((m, n)\\).", "solution": "The answer is \\(m \\leq n+1\\) only. If Proof the task requires \\(m \\leq n+1\\). Each of the \\(m\\) blocks has a red bead count between 0 and \\(n\\), each of which appears at most once, so \\(m \\leq n+1\\) is needed. If Construction when \\(m=n+1\\). For concreteness, here is the construction for \\(n=4\\), which obviously generalizes. The beads are listed in reading order as an array with \\(n+1\\) rows and \\(n\\) columns. Four of the blue beads have been labeled \\(B_{1}, \\ldots, B_{n}\\) to make them easier to track as they move. \\[ T_{0}=\\left[\\begin{array}{llll} R & R & R & R \\\\ R & R & R & B_{1} \\\\ R & R & B & B_{2} \\\\ R & B & B & B_{3} \\\\ B & B & B & B_{4} \\end{array}\\right] . \\] To prove this construction works, it suffices to consider the \\(n\\) cuts \\(T_{0}, T_{1}, T_{2}, \\ldots, T_{n-1}\\) made where \\(T_{i}\\) differs from \\(T_{i-1}\\) by having the cuts one bead later also have the property each row has a distinct red count: \\[ T_{1}=\\left[\\begin{array}{llll} R & R & R & R \\\\ R & R & B_{1} & R \\\\ R & B & B_{2} & R \\\\ B & B & B_{3} & B \\\\ B & B & B_{4} & R \\end{array}\\right] \\quad T_{2}=\\left[\\begin{array}{cccc} R & R & R & R \\\\ R & B_{1} & R & R \\\\ B & B_{2} & R & B \\\\ B & B_{3} & B & B \\\\ B & B_{4} & R & R \\end{array}\\right] \\quad T_{3}=\\left[\\begin{array}{cccc} R & R & R & R \\\\ B_{1} & R & R & B \\\\ B_{2} & R & B & B \\\\ B_{3} & B & B & B \\\\ B_{4} & R & R & R \\end{array}\\right] . \\] We can construct a table showing for each \\(1 \\leq k \\leq n+1\\) the number of red beads which are in the \\((k+1)\\) st row of \\(T_{i}\\) from the bottom: \\begin{tabular}{c|cccc} \\(k\\) & \\(T_{0}\\) & \\(T_{1}\\) & \\(T_{2}\\) & \\(T_{3}\\) \\\\ \\hline\\(k=4\\) & 4 & 4 & 4 & 4 \\\\ \\(k=3\\) & 3 & 3 & 3 & 2 \\\\ \\(k=2\\) & 2 & 2 & 1 & 1 \\\\ \\(k=1\\) & 1 & 0 & 0 & 0 \\\\ \\(k=0\\) & 0 & 1 & 2 & 3 \\end{tabular}. This suggests following explicit formula for the entry of the \\((i, k)\\) th cell which can then be checked straightforwardly: \\[ \\#\\left(\\text { red cells in } k \\text { th row of } T_{i}\\right)= \\begin{cases}k & k>i \\\\ k-1 & i \\geq k>0 \\\\ i & k=0\\end{cases} \\] And one can see for each \\(i\\), the counts are all distinct (they are ( \\(i, 0,1, \\ldots, k-1, k+1, \\ldots, k\\) ) from bottom to top). This completes the construction. Construction when \\(m<n+1\\). Fix \\(m\\). Take the construction for ( \\(m, m-1\\) ) and add \\(n+1-m\\) cyan beads to the start of each row; for example, if \\(n=7\\) and \\(m=5\\) then the new construction is \\[ T=\\left[\\begin{array}{lllllll} C & C & C & R & R & R & R \\\\ C & C & C & R & R & R & B_{1} \\\\ C & C & C & R & R & B & B_{2} \\\\ C & C & C & R & B & B & B_{3} \\\\ C & C & C & B & B & B & B_{4} \\end{array}\\right] \\] This construction still works for the same reason (the cyan beads do nothing for the first \\(n+1-m\\) shifts, then one reduces to the previous case). If we treat cyan as a shade of blue, this finishes the problem.", "source_pdf": "USAMO_2024.pdf", "notes": ""}
{"id": "USAMO-2024-5", "contest": "USAMO", "year": "2024", "problem_number": "5", "problem": "Point \\(D\\) is selected inside acute triangle \\(A B C\\) so that \\(\\angle D A C=\\angle A C B\\) and \\(\\angle B D C= 90^{\\circ}+\\angle B A C\\). Point \\(E\\) is chosen on ray \\(B D\\) so that \\(A E=E C\\). Let \\(M\\) be the midpoint of \\(B C\\). Show that line \\(A B\\) is tangent to the circumcircle of triangle \\(B E M\\).", "solution": "This problem has several approaches and we showcase a collection of them. The author's original solution. Complete isosceles trapezoid \\(A B Q C\\) (so \\(D \\in \\overline{A Q}\\) ). Reflect \\(B\\) across \\(E\\) to point \\(F\\). ![](https://cdn.mathpix.com/cropped/2025_08_23_3e2b36edf2ab6bf632c2g-12.jpg?height=653&width=700&top_left_y=964&top_left_x=685) Claim - We have \\(D Q C F\\) is cyclic. Proof. Since \\(E A=E C\\), we have \\(\\overline{Q F} \\perp \\overline{A C}\\) as line \\(Q F\\) is the image of the perpendicular bisector of \\(\\overline{A C}\\) under a homothety from \\(B\\) with scale factor 2 . Then \\[ \\begin{aligned} \\measuredangle F D C & =-\\measuredangle C D B=180^{\\circ}-\\left(90^{\\circ}+\\measuredangle C A B\\right)=90^{\\circ}-\\measuredangle C A B \\\\ & =90^{\\circ}-\\measuredangle Q C A=\\measuredangle F Q C . \\end{aligned} \\] To conclude, note that \\[ \\measuredangle B E M=\\measuredangle B F C=\\measuredangle D F C=\\measuredangle D Q C=\\measuredangle A Q C=\\measuredangle A B C=\\measuredangle A B M . \\] Remark (Motivation). Here is one possible way to come up with the construction of point \\(F\\) (at least this is what led Evan to find it). If one directs all the angles in the obvious way, there are really two points \\(D\\) and \\(D^{\\prime}\\) that are possible, although one is outside the triangle; they give corresponding points \\(E\\) and \\(E^{\\prime}\\). The circles \\(B E M\\) and \\(B E^{\\prime} M\\) must then actually coincide since they are both alleged to be tangent to line \\(A B\\). See the figure below. ![](https://cdn.mathpix.com/cropped/2025_08_23_3e2b36edf2ab6bf632c2g-13.jpg?height=1109&width=1017&top_left_y=242&top_left_x=531) One can already prove using angle chasing that \\(\\overline{A B}\\) is tangent to ( \\(B E E^{\\prime}\\) ). So the point of the problem is to show that \\(M\\) lies on this circle too. However, from looking at the diagram, one may realize that in fact it seems \\[ \\triangle M E E^{\\prime} \\stackrel{+}{\\sim} \\triangle C D D^{\\prime} \\] is going to be true from just those marked in the figure (and this would certainly imply the desired concyclic conclusion). Since \\(M\\) is a midpoint, it makes sense to dilate \\(\\triangle E M E^{\\prime}\\) from \\(B\\) by a factor of 2 to get \\(\\triangle F C F^{\\prime}\\) so that the desired similarity is actually a spiral similarity at \\(C\\). Then the spiral similarity lemma says that the desired similarity is equivalent to requiring \\(\\overline{D D^{\\prime}} \\cap \\overline{F F^{\\prime}}=Q\\) to lie on both ( \\(C D F\\) ) and ( \\(C D^{\\prime} F^{\\prime}\\) ). Hence the key construction and claim from the solution are both discovered naturally, and we find the solution above. (The points \\(D^{\\prime}, E^{\\prime}, F^{\\prime}\\) can then be deleted to hide the motivation.) If Another short solution. Let \\(Z\\) be on line \\(B D E\\) such that \\(\\angle B A Z=90^{\\circ}\\). This lets us interpret the angle condition as follows: Claim - Points \\(A, D, Z, C\\) are cyclic. Proof. Because \\(\\measuredangle Z A C=90^{\\circ}-A=180^{\\circ}-\\measuredangle C D B=\\measuredangle Z D C\\). ![](https://cdn.mathpix.com/cropped/2025_08_23_3e2b36edf2ab6bf632c2g-14.jpg?height=815&width=697&top_left_y=245&top_left_x=688) Define \\(W\\) as the midpoint of \\(\\overline{B Z}\\), so \\(\\overline{M W} \\| \\overline{C Z}\\). And let \\(O\\) denote the center of \\((A B C)\\). Claim - Points \\(M, E, O, W\\) are cyclic. Proof. Note that \\[ \\begin{aligned} \\measuredangle M O E & =\\measuredangle(\\overline{O M}, \\overline{B C})+\\measuredangle(\\overline{B C}, \\overline{A C})+\\measuredangle(\\overline{A C}, \\overline{O E}) \\\\ & =90^{\\circ}+\\measuredangle B C A+90^{\\circ} \\\\ & =\\measuredangle B C A=\\measuredangle C A D=\\measuredangle C Z D=\\measuredangle M W D=\\measuredangle M W E . \\end{aligned} \\] To finish, note \\[ \\begin{aligned} \\measuredangle M E B & =\\measuredangle M E W=\\measuredangle M O W \\\\ & =\\measuredangle(\\overline{M O}, \\overline{B C})+\\measuredangle(\\overline{B C}, \\overline{A B})+\\measuredangle(\\overline{A B}, \\overline{O W}) \\\\ & =90^{\\circ}+\\measuredangle C B A+90^{\\circ}=\\measuredangle C B A=\\measuredangle M B A . \\end{aligned} \\] This implies the desired tangency. If A Menelaus-based approach (Kevin Ren). Let \\(P\\) be on \\(\\overline{B C}\\) with \\(A P=P C\\). Let \\(Y\\) be the point on line \\(A B\\) such that \\(\\angle A C Y=90^{\\circ}\\); as \\(\\angle A Y C=90^{\\circ}-A\\) it follows \\(B D Y C\\) is cyclic. Let \\(K=\\overline{A P} \\cap \\overline{C Y}\\), so \\(\\triangle A C K\\) is a right triangle with \\(P\\) the midpoint of its hypotenuse. ![](https://cdn.mathpix.com/cropped/2025_08_23_3e2b36edf2ab6bf632c2g-15.jpg?height=1194&width=1069&top_left_y=254&top_left_x=502) Claim - Triangles \\(B P E\\) and \\(D Y K\\) are similar. Proof. We have \\(\\measuredangle M P E=\\measuredangle C P E=\\measuredangle K C P=\\measuredangle P K C\\) and \\(\\measuredangle E B P=\\measuredangle D B C= \\measuredangle D Y C=\\measuredangle D Y K\\). Claim - Triangles \\(B E M\\) and \\(Y D C\\) are similar. Proof. By Menelaus \\(\\triangle P C K\\) with respect to collinear points \\(A, B, Y\\) that \\[ \\frac{B P}{B C} \\frac{Y C}{Y K} \\frac{A K}{A P}=1 . \\] Since \\(A K / A P=2\\) (note that \\(P\\) is the midpoint of the hypotenuse of right triangle \\(A C K\\) ) and \\(B C=2 B M\\), this simplifies to \\[ \\frac{B P}{B M}=\\frac{Y K}{Y C} . \\] To finish, note that \\[ \\measuredangle D B A=\\measuredangle D B Y=\\measuredangle D C Y=\\measuredangle B M E \\] implying the desired tangency. A spiral similarity approach (Hans Yu). As in the previous solution, let \\(Y\\) be the point on line \\(A B\\) such that \\(\\angle A C Y=90^{\\circ}\\); so \\(B D Y C\\) is cyclic. Let \\(\\Gamma\\) be the circle through \\(B\\) and \\(M\\) tangent to \\(\\overline{A B}\\), and let \\(\\Omega:=(B C Y D)\\). We need to show \\(E \\in \\Gamma\\). ![](https://cdn.mathpix.com/cropped/2025_08_23_3e2b36edf2ab6bf632c2g-16.jpg?height=1104&width=1017&top_left_y=436&top_left_x=528) Denote by \\(S\\) the second intersection of \\(\\Gamma\\) and \\(\\Omega\\). The main idea behind is to consider the spiral similarity \\[ \\Psi: \\Omega \\rightarrow \\Gamma \\quad C \\mapsto M \\text { and } Y \\mapsto B \\] centered at \\(S\\) (due to the spiral similarity lemma), and show that \\(\\Psi(D)=E\\). The spiral similarity lemma already promises \\(\\Psi(D)\\) lies on line \\(B D\\). Claim - We have \\(\\Psi(A)=O\\), the circumcenter of \\(A B C\\). Proof. Note \\(\\triangle O B M \\stackrel{+}{\\sim} \\triangle A Y C\\); both are right triangles with \\(\\measuredangle B A C=\\measuredangle B O M\\). Claim - \\(\\Psi\\) maps line \\(A D\\) to line \\(O P\\). Proof. If we let \\(P\\) be on \\(\\overline{B C}\\) with \\(A P=P C\\) as before, \\[ \\measuredangle(\\overline{A D}, \\overline{O P})=\\measuredangle A P O=\\measuredangle O P C=\\measuredangle Y C P=\\measuredangle(\\overline{Y C}, \\overline{B M}) . \\] As \\(\\Psi\\) maps line \\(Y C\\) to line \\(B M\\) and \\(\\Psi(A)=O\\), we're done. Hence \\(\\Psi(D)\\) should not only lie on \\(B D\\) but also line \\(O P\\). This proves \\(\\Psi(D)=E\\), so \\(E \\in \\Gamma\\) as needed.", "source_pdf": "USAMO_2024.pdf", "notes": ""}
{"id": "USAMO-2024-6", "contest": "USAMO", "year": "2024", "problem_number": "6", "problem": "Let \\(n>2\\) be an integer and let \\(\\ell \\in\\{1,2, \\ldots, n\\}\\). A collection \\(A_{1}, \\ldots, A_{k}\\) of (not necessarily distinct) subsets of \\(\\{1,2, \\ldots, n\\}\\) is called \\(\\ell\\)-large if \\(\\left|A_{i}\\right| \\geq \\ell\\) for all \\(1 \\leq i \\leq k\\). Find, in terms of \\(n\\) and \\(\\ell\\), the largest real number \\(c\\) such that the inequality \\[ \\sum_{i=1}^{k} \\sum_{j=1}^{k} x_{i} x_{j} \\frac{\\left|A_{i} \\cap A_{j}\\right|^{2}}{\\left|A_{i}\\right| \\cdot\\left|A_{j}\\right|} \\geq c\\left(\\sum_{i=1}^{k} x_{i}\\right)^{2} \\] holds for all positive integer \\(k\\), all nonnegative real numbers \\(x_{1}, x_{2}, \\ldots, x_{k}\\), and all \\(\\ell\\)-large collections \\(A_{1}, A_{2}, \\ldots, A_{k}\\) of subsets of \\(\\{1,2, \\ldots, n\\}\\).", "solution": "The answer turns out to be \\[ c=\\frac{n+\\ell^{2}-2 \\ell}{n(n-1)} \\] The following solution using indicator functions was suggested by the language reasoning system developed by Thang Luong and the team at Google DeepMind (https://dpmd. ai/imo-silver). If Rewriting the sum. Abbreviate \\([n]:=\\{1, \\ldots, n\\}\\), and WLOG assume \\(\\sum x_{i}=1\\). To prove the bound, we first rewrite the left-hand side using indicator functions and switch the order of summation as \\[ \\begin{aligned} \\text { LHS } & =\\sum_{i=1}^{k} \\sum_{j=1}^{k} \\frac{x_{i}}{\\left|A_{i}\\right|} \\frac{x_{j}}{\\left|A_{j}\\right|}\\left|A_{i} \\cap A_{j}\\right|^{2} \\\\ & =\\sum_{i=1}^{k} \\sum_{j=1}^{k} \\frac{x_{i}}{\\left|A_{i}\\right|} \\frac{x_{j}}{\\left|A_{j}\\right|}\\left(\\sum_{p \\in[n]} \\sum_{q \\in[n]} \\mathbf{1}_{p \\in A_{i}} \\mathbf{1}_{q \\in A_{j}}\\right) \\\\ & =\\sum_{p \\in[n]} \\sum_{q \\in[n]} \\sum_{i=1}^{k} \\sum_{j=1}^{k} \\frac{x_{i} \\mathbf{1}_{p \\in A_{i}}}{\\left|A_{i}\\right|} \\cdot \\frac{x_{j} \\mathbf{1}_{q \\in A_{j}}}{\\left|A_{j}\\right|} . \\end{aligned} \\] Hence, if we define the \\(n^{2}\\) variables \\[ v_{p, q}:=\\sum_{i: p, q \\in A_{i}} \\frac{x_{i}}{\\left|A_{i}\\right|} \\] for each \\((p, q) \\in[n]^{2}\\) then the previous expression simplifies to just \\[ \\mathrm{LHS}=\\sum_{p \\in[n]} \\sum_{q \\in[n]} v_{p, q}^{2} . \\] T Proof of bound. We split the sum into \\(p=q\\) versus \\(p \\neq q\\) and bound by QM-AM separately in the obvious way. For the terms \\(p=q\\), \\[ \\sum_{p \\in[n]} v_{p, p}=\\sum_{i=1}^{k}\\left|A_{i}\\right| \\cdot \\frac{x_{i}}{\\left|A_{i}\\right|}=\\sum_{i=1}^{k} x_{i}=1 \\] \\[ \\Longrightarrow \\sum_{p \\in[n]} v_{p, p}^{2} \\geq \\frac{\\left(\\sum_{p \\in[n]} v_{p, p}\\right)^{2}}{n}=\\frac{1}{n} \\] When \\(p \\neq q\\) we instead have \\[ \\begin{aligned} \\sum_{p \\neq q \\in[n]} v_{p, q} & =\\sum_{i=1}^{k} 2\\binom{\\left|A_{i}\\right|}{2} \\cdot \\frac{x_{i}}{\\left|A_{i}\\right|}=\\sum_{i=1}^{k}\\left(\\left|A_{i}\\right|-1\\right) x_{i} \\geq \\sum_{i=1}^{k}(\\ell-1) x_{i}=\\ell-1 \\\\ \\Longrightarrow \\quad \\sum_{p \\neq q \\in[n]} v_{p, q}^{2} & \\geq \\frac{\\left(\\sum_{p \\neq q \\in[n]} v_{p, q}\\right)^{2}}{n(n-1)} \\geq \\frac{(\\ell-1)^{2}}{n(n-1)} . \\end{aligned} \\] Combining the two bounds gives \\[ \\mathrm{LHS} \\geq \\frac{1}{n}+\\frac{(\\ell-1)^{2}}{n(n-1)}=\\frac{n+\\ell^{2}-2 \\ell}{n(n-1)} \\] which matches the answer claimed above. Construction. Equality occurs if \\(v_{p, p}\\) is the same for all \\(p\\) and \\(v_{p, q}\\) is the same for all \\(p \\neq q\\), and \\(\\left|A_{i}\\right|=\\ell\\) for all \\(i\\). This occurs if one takes, say, \\(k=\\binom{n}{\\ell}\\) and \\(A_{i}\\) to be all the subsets of size \\(\\ell\\) each exactly once. Remark. Originally, the write-up I used considered vectors in \\(\\mathbb{R}^{n^{2}}\\) where entries will be indexed by ordered pairs \\((p, q) \\in\\{1, \\ldots, n\\}^{2}\\). It was equivalent to the solution above, but looking back, I think this makes the problem look harder than it actually is. For comparison, here is how the notation with vectors works, using \\(\\langle\\bullet, \\bullet\\rangle\\) for dot product, and \\(\\|\\bullet\\|\\) for the vector norm. For \\(i=1, \\ldots, n\\) define \\(\\mathbf{v}_{i}\\) by \\[ \\mathbf{v}_{i}[p, q]:=\\left\\{\\begin{array}{ll} \\frac{1}{\\left|A_{i}\\right|} & p \\in A_{i} \\text { and } q \\in A_{i} \\\\ 0 & \\text { otherwise } \\end{array} \\quad \\mathbf{v}:=\\sum_{i} x_{i} \\mathbf{v}_{i}\\right. \\] Then \\[ \\begin{aligned} \\sum_{i} \\sum_{j} x_{i} x_{j} \\frac{\\left|A_{i} \\cap A_{j}\\right|^{2}}{\\left|A_{i} \\| A_{j}\\right|} & =\\sum_{i} \\sum_{j} x_{i} x_{j}\\left\\langle\\mathbf{v}_{i}, \\mathbf{v}_{j}\\right\\rangle \\\\ & =\\langle\\mathbf{v}, \\mathbf{v}\\rangle=\\|\\mathbf{v}\\|^{2} \\end{aligned} \\] Define two more vectors \\(\\mathbf{e}\\) and \\(\\mathbf{1}\\); the vector \\(\\mathbf{e}\\) has 1 in the \\((p, q)^{\\text {th }}\\) component if \\(p=q\\), and 0 otherwise, while 1 has all-ones. In that case, note that \\[ \\begin{aligned} & \\langle\\mathbf{e}, \\mathbf{v}\\rangle=\\sum_{i} x_{i}\\left\\langle\\mathbf{e}, \\mathbf{v}_{i}\\right\\rangle=\\sum_{i} x_{i} \\\\ & \\langle\\mathbf{1}, \\mathbf{v}\\rangle=\\sum_{i} x_{i}\\left\\langle\\mathbf{1}, \\mathbf{v}_{i}\\right\\rangle=\\sum_{i} x_{i}\\left|A_{i}\\right| . \\end{aligned} \\] That means for any positive real constants \\(\\alpha\\) and \\(\\beta\\), by Cauchy-Schwarz for vectors, we should have \\[ \\begin{aligned} \\|\\alpha \\mathbf{e}+\\beta \\mathbf{1}\\|\\|\\mathbf{v}\\| & \\geq\\langle\\alpha \\mathbf{e}+\\beta \\mathbf{1}, \\mathbf{v}\\rangle=\\alpha\\langle\\mathbf{e}, \\mathbf{v}\\rangle+\\beta\\langle\\mathbf{1}, \\mathbf{v}\\rangle \\\\ & =\\alpha \\cdot \\sum x_{i}+\\beta \\cdot \\sum x_{i}\\left|A_{i}\\right| \\geq(\\alpha+\\ell \\beta) \\sum x_{i} \\end{aligned} \\] Set \\(\\mathbf{w}:=\\alpha \\mathbf{e}+\\beta \\mathbf{1}\\) for brevity. Then \\[ \\mathbf{w}[p, q]=\\left\\{\\begin{array}{ll} \\alpha+\\beta & \\text { if } p=q \\\\ \\beta & \\text { if } p \\neq q \\end{array} \\Longrightarrow\\|\\mathbf{w}\\|=\\sqrt{n \\cdot(\\alpha+\\beta)^{2}+\\left(n^{2}-n\\right) \\cdot \\beta^{2}}\\right. \\] Therefore, we get an lower bound \\[ \\frac{\\|\\mathbf{v}\\|}{\\sum x_{i}} \\geq \\frac{\\alpha+\\ell \\beta}{\\sqrt{n \\cdot(\\alpha+\\beta)^{2}+\\left(n^{2}-n\\right) \\cdot \\beta^{2}}} \\] Letting \\(\\alpha=n-\\ell\\) and \\(\\beta=\\ell-1\\) gives a proof that the constant \\[ c=\\frac{((n-\\ell)+\\ell(\\ell-1))^{2}}{n \\cdot(n-1)^{2}+\\left(n^{2}-n\\right) \\cdot(\\ell-1)^{2}}=\\frac{\\left(n+\\ell^{2}-2 \\ell\\right)^{2}}{n(n-1)\\left(n+\\ell^{2}-2 \\ell\\right)}=\\frac{n+\\ell^{2}-2 \\ell}{n(n-1)} \\] makes the original inequality always true. (The choice of \\(\\alpha: \\beta\\) is suggested by the example below.) Meanwhile, for the construction (where \\(k=\\binom{n}{\\ell}\\), etc.) it would be sufficient to show that \\(\\mathbf{w}\\) and \\(\\mathbf{v}\\) are scalar multiples, so that the above Cauchy-Schwarz is equality. However, we can compute \\[ \\mathbf{w}[p, q]=\\left\\{\\begin{array}{ll} n-1 & \\text { if } p=q \\\\ \\ell-1 & \\text { if } p \\neq q \\end{array}, \\quad \\mathbf{v}[p, q]= \\begin{cases}\\binom{n-1}{\\ell-1} \\cdot \\frac{1}{\\ell} & \\text { if } p=q \\\\ \\binom{n-2}{\\ell-2} \\cdot \\frac{1}{\\ell} & \\text { if } p \\neq q\\end{cases}\\right. \\] which are indeed scalar multiples.", "source_pdf": "USAMO_2024.pdf", "notes": ""}
